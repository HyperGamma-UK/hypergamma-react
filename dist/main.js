(()=>{var NX=Object.create;var Mv=Object.defineProperty;var LX=Object.getOwnPropertyDescriptor;var PX=Object.getOwnPropertyNames;var FX=Object.getPrototypeOf,DX=Object.prototype.hasOwnProperty;var BX=(e,t,r)=>t in e?Mv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Mr=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var ce=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),RX=(e,t)=>{for(var r in t)Mv(e,r,{get:t[r],enumerable:!0})},MX=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of PX(t))!DX.call(e,i)&&i!==r&&Mv(e,i,{get:()=>t[i],enumerable:!(n=LX(t,i))||n.enumerable});return e};var oe=(e,t,r)=>(r=e!=null?NX(FX(e)):{},MX(t||!e||!e.__esModule?Mv(r,"default",{value:e,enumerable:!0}):r,e));var dr=(e,t,r)=>(BX(e,typeof t!="symbol"?t+"":t,r),r);var lP=ce(Rt=>{"use strict";var Ch=Symbol.for("react.element"),jX=Symbol.for("react.portal"),$X=Symbol.for("react.fragment"),UX=Symbol.for("react.strict_mode"),zX=Symbol.for("react.profiler"),qX=Symbol.for("react.provider"),VX=Symbol.for("react.context"),HX=Symbol.for("react.forward_ref"),WX=Symbol.for("react.suspense"),JX=Symbol.for("react.memo"),GX=Symbol.for("react.lazy"),ZL=Symbol.iterator;function YX(e){return e===null||typeof e!="object"?null:(e=ZL&&e[ZL]||e["@@iterator"],typeof e=="function"?e:null)}var tP={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rP=Object.assign,nP={};function df(e,t,r){this.props=e,this.context=t,this.refs=nP,this.updater=r||tP}df.prototype.isReactComponent={};df.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};df.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function iP(){}iP.prototype=df.prototype;function PS(e,t,r){this.props=e,this.context=t,this.refs=nP,this.updater=r||tP}var FS=PS.prototype=new iP;FS.constructor=PS;rP(FS,df.prototype);FS.isPureReactComponent=!0;var QL=Array.isArray,aP=Object.prototype.hasOwnProperty,DS={current:null},oP={key:!0,ref:!0,__self:!0,__source:!0};function sP(e,t,r){var n,i={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)aP.call(t,n)&&!oP.hasOwnProperty(n)&&(i[n]=t[n]);var s=arguments.length-2;if(s===1)i.children=r;else if(1<s){for(var l=Array(s),c=0;c<s;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in s=e.defaultProps,s)i[n]===void 0&&(i[n]=s[n]);return{$$typeof:Ch,type:e,key:a,ref:o,props:i,_owner:DS.current}}function KX(e,t){return{$$typeof:Ch,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function BS(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ch}function XX(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var eP=/\/+/g;function LS(e,t){return typeof e=="object"&&e!==null&&e.key!=null?XX(""+e.key):t.toString(36)}function $v(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Ch:case jX:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+LS(o,0):n,QL(i)?(r="",e!=null&&(r=e.replace(eP,"$&/")+"/"),$v(i,t,r,"",function(c){return c})):i!=null&&(BS(i)&&(i=KX(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(eP,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",QL(e))for(var s=0;s<e.length;s++){a=e[s];var l=n+LS(a,s);o+=$v(a,t,r,l,i)}else if(l=YX(e),typeof l=="function")for(e=l.call(e),s=0;!(a=e.next()).done;)a=a.value,l=n+LS(a,s++),o+=$v(a,t,r,l,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function jv(e,t,r){if(e==null)return e;var n=[],i=0;return $v(e,n,"","",function(a){return t.call(r,a,i++)}),n}function ZX(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var fi={current:null},Uv={transition:null},QX={ReactCurrentDispatcher:fi,ReactCurrentBatchConfig:Uv,ReactCurrentOwner:DS};Rt.Children={map:jv,forEach:function(e,t,r){jv(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return jv(e,function(){t++}),t},toArray:function(e){return jv(e,function(t){return t})||[]},only:function(e){if(!BS(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Rt.Component=df;Rt.Fragment=$X;Rt.Profiler=zX;Rt.PureComponent=PS;Rt.StrictMode=UX;Rt.Suspense=WX;Rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QX;Rt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=rP({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=DS.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)aP.call(t,l)&&!oP.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){s=Array(l);for(var c=0;c<l;c++)s[c]=arguments[c+2];n.children=s}return{$$typeof:Ch,type:e.type,key:i,ref:a,props:n,_owner:o}};Rt.createContext=function(e){return e={$$typeof:VX,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:qX,_context:e},e.Consumer=e};Rt.createElement=sP;Rt.createFactory=function(e){var t=sP.bind(null,e);return t.type=e,t};Rt.createRef=function(){return{current:null}};Rt.forwardRef=function(e){return{$$typeof:HX,render:e}};Rt.isValidElement=BS;Rt.lazy=function(e){return{$$typeof:GX,_payload:{_status:-1,_result:e},_init:ZX}};Rt.memo=function(e,t){return{$$typeof:JX,type:e,compare:t===void 0?null:t}};Rt.startTransition=function(e){var t=Uv.transition;Uv.transition={};try{e()}finally{Uv.transition=t}};Rt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Rt.useCallback=function(e,t){return fi.current.useCallback(e,t)};Rt.useContext=function(e){return fi.current.useContext(e)};Rt.useDebugValue=function(){};Rt.useDeferredValue=function(e){return fi.current.useDeferredValue(e)};Rt.useEffect=function(e,t){return fi.current.useEffect(e,t)};Rt.useId=function(){return fi.current.useId()};Rt.useImperativeHandle=function(e,t,r){return fi.current.useImperativeHandle(e,t,r)};Rt.useInsertionEffect=function(e,t){return fi.current.useInsertionEffect(e,t)};Rt.useLayoutEffect=function(e,t){return fi.current.useLayoutEffect(e,t)};Rt.useMemo=function(e,t){return fi.current.useMemo(e,t)};Rt.useReducer=function(e,t,r){return fi.current.useReducer(e,t,r)};Rt.useRef=function(e){return fi.current.useRef(e)};Rt.useState=function(e){return fi.current.useState(e)};Rt.useSyncExternalStore=function(e,t,r){return fi.current.useSyncExternalStore(e,t,r)};Rt.useTransition=function(){return fi.current.useTransition()};Rt.version="18.2.0"});var He=ce((WIe,cP)=>{"use strict";cP.exports=lP()});var bP=ce(vr=>{"use strict";function $S(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(0<zv(i,t))e[n]=t,e[r]=i,r=n;else break e}}function Ua(e){return e.length===0?null:e[0]}function Vv(e){if(e.length===0)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,a=i>>>1;n<a;){var o=2*(n+1)-1,s=e[o],l=o+1,c=e[l];if(0>zv(s,r))l<i&&0>zv(c,s)?(e[n]=c,e[l]=r,n=l):(e[n]=s,e[o]=r,n=o);else if(l<i&&0>zv(c,r))e[n]=c,e[l]=r,n=l;else break e}}return t}function zv(e,t){var r=e.sortIndex-t.sortIndex;return r!==0?r:e.id-t.id}typeof performance=="object"&&typeof performance.now=="function"?(uP=performance,vr.unstable_now=function(){return uP.now()}):(RS=Date,fP=RS.now(),vr.unstable_now=function(){return RS.now()-fP});var uP,RS,fP,So=[],nl=[],eZ=1,ya=null,Jn=3,Hv=!1,xc=!1,Nh=!1,hP=typeof setTimeout=="function"?setTimeout:null,gP=typeof clearTimeout=="function"?clearTimeout:null,dP=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function US(e){for(var t=Ua(nl);t!==null;){if(t.callback===null)Vv(nl);else if(t.startTime<=e)Vv(nl),t.sortIndex=t.expirationTime,$S(So,t);else break;t=Ua(nl)}}function zS(e){if(Nh=!1,US(e),!xc)if(Ua(So)!==null)xc=!0,VS(qS);else{var t=Ua(nl);t!==null&&HS(zS,t.startTime-e)}}function qS(e,t){xc=!1,Nh&&(Nh=!1,gP(Lh),Lh=-1),Hv=!0;var r=Jn;try{for(US(t),ya=Ua(So);ya!==null&&(!(ya.expirationTime>t)||e&&!vP());){var n=ya.callback;if(typeof n=="function"){ya.callback=null,Jn=ya.priorityLevel;var i=n(ya.expirationTime<=t);t=vr.unstable_now(),typeof i=="function"?ya.callback=i:ya===Ua(So)&&Vv(So),US(t)}else Vv(So);ya=Ua(So)}if(ya!==null)var a=!0;else{var o=Ua(nl);o!==null&&HS(zS,o.startTime-t),a=!1}return a}finally{ya=null,Jn=r,Hv=!1}}var Wv=!1,qv=null,Lh=-1,yP=5,mP=-1;function vP(){return!(vr.unstable_now()-mP<yP)}function MS(){if(qv!==null){var e=vr.unstable_now();mP=e;var t=!0;try{t=qv(!0,e)}finally{t?Th():(Wv=!1,qv=null)}}else Wv=!1}var Th;typeof dP=="function"?Th=function(){dP(MS)}:typeof MessageChannel<"u"?(jS=new MessageChannel,pP=jS.port2,jS.port1.onmessage=MS,Th=function(){pP.postMessage(null)}):Th=function(){hP(MS,0)};var jS,pP;function VS(e){qv=e,Wv||(Wv=!0,Th())}function HS(e,t){Lh=hP(function(){e(vr.unstable_now())},t)}vr.unstable_IdlePriority=5;vr.unstable_ImmediatePriority=1;vr.unstable_LowPriority=4;vr.unstable_NormalPriority=3;vr.unstable_Profiling=null;vr.unstable_UserBlockingPriority=2;vr.unstable_cancelCallback=function(e){e.callback=null};vr.unstable_continueExecution=function(){xc||Hv||(xc=!0,VS(qS))};vr.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):yP=0<e?Math.floor(1e3/e):5};vr.unstable_getCurrentPriorityLevel=function(){return Jn};vr.unstable_getFirstCallbackNode=function(){return Ua(So)};vr.unstable_next=function(e){switch(Jn){case 1:case 2:case 3:var t=3;break;default:t=Jn}var r=Jn;Jn=t;try{return e()}finally{Jn=r}};vr.unstable_pauseExecution=function(){};vr.unstable_requestPaint=function(){};vr.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=Jn;Jn=e;try{return t()}finally{Jn=r}};vr.unstable_scheduleCallback=function(e,t,r){var n=vr.unstable_now();switch(typeof r=="object"&&r!==null?(r=r.delay,r=typeof r=="number"&&0<r?n+r:n):r=n,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return i=r+i,e={id:eZ++,callback:t,priorityLevel:e,startTime:r,expirationTime:i,sortIndex:-1},r>n?(e.sortIndex=r,$S(nl,e),Ua(So)===null&&e===Ua(nl)&&(Nh?(gP(Lh),Lh=-1):Nh=!0,HS(zS,r-n))):(e.sortIndex=i,$S(So,e),xc||Hv||(xc=!0,VS(qS))),e};vr.unstable_shouldYield=vP;vr.unstable_wrapCallback=function(e){var t=Jn;return function(){var r=Jn;Jn=t;try{return e.apply(this,arguments)}finally{Jn=r}}}});var wP=ce((GIe,_P)=>{"use strict";_P.exports=bP()});var AB=ce(ra=>{"use strict";var IF=He(),ea=wP();function ze(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var CF=new Set,eg={};function Bc(e,t){Pf(e,t),Pf(e+"Capture",t)}function Pf(e,t){for(eg[e]=t,e=0;e<t.length;e++)CF.add(t[e])}var ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hx=Object.prototype.hasOwnProperty,tZ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,SP={},xP={};function rZ(e){return hx.call(xP,e)?!0:hx.call(SP,e)?!1:tZ.test(e)?xP[e]=!0:(SP[e]=!0,!1)}function nZ(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function iZ(e,t,r,n){if(t===null||typeof t>"u"||nZ(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function hi(e,t,r,n,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var $n={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){$n[e]=new hi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];$n[t]=new hi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){$n[e]=new hi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){$n[e]=new hi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){$n[e]=new hi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){$n[e]=new hi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){$n[e]=new hi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){$n[e]=new hi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){$n[e]=new hi(e,5,!1,e.toLowerCase(),null,!1,!1)});var ok=/[\-:]([a-z])/g;function sk(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ok,sk);$n[t]=new hi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ok,sk);$n[t]=new hi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ok,sk);$n[t]=new hi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){$n[e]=new hi(e,1,!1,e.toLowerCase(),null,!1,!1)});$n.xlinkHref=new hi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){$n[e]=new hi(e,1,!1,e.toLowerCase(),null,!0,!0)});function lk(e,t,r,n){var i=$n.hasOwnProperty(t)?$n[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(iZ(t,r,i,n)&&(r=null),n||i===null?rZ(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ys=IF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jv=Symbol.for("react.element"),gf=Symbol.for("react.portal"),yf=Symbol.for("react.fragment"),ck=Symbol.for("react.strict_mode"),gx=Symbol.for("react.profiler"),TF=Symbol.for("react.provider"),NF=Symbol.for("react.context"),uk=Symbol.for("react.forward_ref"),yx=Symbol.for("react.suspense"),mx=Symbol.for("react.suspense_list"),fk=Symbol.for("react.memo"),al=Symbol.for("react.lazy");Symbol.for("react.scope");Symbol.for("react.debug_trace_mode");var LF=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden");Symbol.for("react.cache");Symbol.for("react.tracing_marker");var kP=Symbol.iterator;function Ph(e){return e===null||typeof e!="object"?null:(e=kP&&e[kP]||e["@@iterator"],typeof e=="function"?e:null)}var Ur=Object.assign,WS;function Uh(e){if(WS===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);WS=t&&t[1]||""}return`
`+WS+e}var JS=!1;function GS(e,t){if(!e||JS)return"";JS=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),a=n.stack.split(`
`),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(o!==1||s!==1)do if(o--,s--,0>s||i[o]!==a[s]){var l=`
`+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=s);break}}}finally{JS=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Uh(e):""}function aZ(e){switch(e.tag){case 5:return Uh(e.type);case 16:return Uh("Lazy");case 13:return Uh("Suspense");case 19:return Uh("SuspenseList");case 0:case 2:case 15:return e=GS(e.type,!1),e;case 11:return e=GS(e.type.render,!1),e;case 1:return e=GS(e.type,!0),e;default:return""}}function vx(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yf:return"Fragment";case gf:return"Portal";case gx:return"Profiler";case ck:return"StrictMode";case yx:return"Suspense";case mx:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case NF:return(e.displayName||"Context")+".Consumer";case TF:return(e._context.displayName||"Context")+".Provider";case uk:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case fk:return t=e.displayName||null,t!==null?t:vx(e.type)||"Memo";case al:t=e._payload,e=e._init;try{return vx(e(t))}catch{}}return null}function oZ(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vx(t);case 8:return t===ck?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function bl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function PF(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function sZ(e){var t=PF(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Gv(e){e._valueTracker||(e._valueTracker=sZ(e))}function FF(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=PF(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Sb(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function bx(e,t){var r=t.checked;return Ur({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function EP(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=bl(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function DF(e,t){t=t.checked,t!=null&&lk(e,"checked",t,!1)}function _x(e,t){DF(e,t);var r=bl(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?wx(e,t.type,r):t.hasOwnProperty("defaultValue")&&wx(e,t.type,bl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function OP(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function wx(e,t,r){(t!=="number"||Sb(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var zh=Array.isArray;function Af(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+bl(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Sx(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ze(91));return Ur({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function AP(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ze(92));if(zh(r)){if(1<r.length)throw Error(ze(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:bl(r)}}function BF(e,t){var r=bl(t.value),n=bl(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function IP(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function RF(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xx(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?RF(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Yv,MF=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Yv=Yv||document.createElement("div"),Yv.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Yv.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function tg(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Hh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lZ=["Webkit","ms","Moz","O"];Object.keys(Hh).forEach(function(e){lZ.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Hh[t]=Hh[e]})});function jF(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Hh.hasOwnProperty(e)&&Hh[e]?(""+t).trim():t+"px"}function $F(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=jF(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var cZ=Ur({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kx(e,t){if(t){if(cZ[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ze(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ze(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ze(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ze(62))}}function Ex(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ox=null;function dk(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ax=null,If=null,Cf=null;function CP(e){if(e=bg(e)){if(typeof Ax!="function")throw Error(ze(280));var t=e.stateNode;t&&(t=Kb(t),Ax(e.stateNode,e.type,t))}}function UF(e){If?Cf?Cf.push(e):Cf=[e]:If=e}function zF(){if(If){var e=If,t=Cf;if(Cf=If=null,CP(e),t)for(e=0;e<t.length;e++)CP(t[e])}}function qF(e,t){return e(t)}function VF(){}var YS=!1;function HF(e,t,r){if(YS)return e(t,r);YS=!0;try{return qF(e,t,r)}finally{YS=!1,(If!==null||Cf!==null)&&(VF(),zF())}}function rg(e,t){var r=e.stateNode;if(r===null)return null;var n=Kb(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ze(231,t,typeof r));return r}var Ix=!1;if(ds)try{pf={},Object.defineProperty(pf,"passive",{get:function(){Ix=!0}}),window.addEventListener("test",pf,pf),window.removeEventListener("test",pf,pf)}catch{Ix=!1}var pf;function uZ(e,t,r,n,i,a,o,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var Wh=!1,xb=null,kb=!1,Cx=null,fZ={onError:function(e){Wh=!0,xb=e}};function dZ(e,t,r,n,i,a,o,s,l){Wh=!1,xb=null,uZ.apply(fZ,arguments)}function pZ(e,t,r,n,i,a,o,s,l){if(dZ.apply(this,arguments),Wh){if(Wh){var c=xb;Wh=!1,xb=null}else throw Error(ze(198));kb||(kb=!0,Cx=c)}}function Rc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function WF(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function TP(e){if(Rc(e)!==e)throw Error(ze(188))}function hZ(e){var t=e.alternate;if(!t){if(t=Rc(e),t===null)throw Error(ze(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return TP(i),e;if(a===n)return TP(i),t;a=a.sibling}throw Error(ze(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,s=i.child;s;){if(s===r){o=!0,r=i,n=a;break}if(s===n){o=!0,n=i,r=a;break}s=s.sibling}if(!o){for(s=a.child;s;){if(s===r){o=!0,r=a,n=i;break}if(s===n){o=!0,n=a,r=i;break}s=s.sibling}if(!o)throw Error(ze(189))}}if(r.alternate!==n)throw Error(ze(190))}if(r.tag!==3)throw Error(ze(188));return r.stateNode.current===r?e:t}function JF(e){return e=hZ(e),e!==null?GF(e):null}function GF(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=GF(e);if(t!==null)return t;e=e.sibling}return null}var YF=ea.unstable_scheduleCallback,NP=ea.unstable_cancelCallback,gZ=ea.unstable_shouldYield,yZ=ea.unstable_requestPaint,en=ea.unstable_now,mZ=ea.unstable_getCurrentPriorityLevel,pk=ea.unstable_ImmediatePriority,KF=ea.unstable_UserBlockingPriority,Eb=ea.unstable_NormalPriority,vZ=ea.unstable_LowPriority,XF=ea.unstable_IdlePriority,Wb=null,Oo=null;function bZ(e){if(Oo&&typeof Oo.onCommitFiberRoot=="function")try{Oo.onCommitFiberRoot(Wb,e,void 0,(e.current.flags&128)===128)}catch{}}var Wa=Math.clz32?Math.clz32:SZ,_Z=Math.log,wZ=Math.LN2;function SZ(e){return e>>>=0,e===0?32:31-(_Z(e)/wZ|0)|0}var Kv=64,Xv=4194304;function qh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ob(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var s=o&~i;s!==0?n=qh(s):(a&=o,a!==0&&(n=qh(a)))}else o=r&~i,o!==0?n=qh(o):a!==0&&(n=qh(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Wa(t),i=1<<r,n|=e[r],t&=~i;return n}function xZ(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kZ(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Wa(a),s=1<<o,l=i[o];l===-1?(!(s&r)||s&n)&&(i[o]=xZ(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}function Tx(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ZF(){var e=Kv;return Kv<<=1,!(Kv&4194240)&&(Kv=64),e}function KS(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function mg(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Wa(t),e[t]=r}function EZ(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Wa(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function hk(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Wa(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var sr=0;function QF(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var eD,gk,tD,rD,nD,Nx=!1,Zv=[],fl=null,dl=null,pl=null,ng=new Map,ig=new Map,sl=[],OZ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function LP(e,t){switch(e){case"focusin":case"focusout":fl=null;break;case"dragenter":case"dragleave":dl=null;break;case"mouseover":case"mouseout":pl=null;break;case"pointerover":case"pointerout":ng.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ig.delete(t.pointerId)}}function Fh(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=bg(t),t!==null&&gk(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function AZ(e,t,r,n,i){switch(t){case"focusin":return fl=Fh(fl,e,t,r,n,i),!0;case"dragenter":return dl=Fh(dl,e,t,r,n,i),!0;case"mouseover":return pl=Fh(pl,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return ng.set(a,Fh(ng.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,ig.set(a,Fh(ig.get(a)||null,e,t,r,n,i)),!0}return!1}function iD(e){var t=Oc(e.target);if(t!==null){var r=Rc(t);if(r!==null){if(t=r.tag,t===13){if(t=WF(r),t!==null){e.blockedOn=t,nD(e.priority,function(){tD(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function db(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Lx(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ox=n,r.target.dispatchEvent(n),Ox=null}else return t=bg(r),t!==null&&gk(t),e.blockedOn=r,!1;t.shift()}return!0}function PP(e,t,r){db(e)&&r.delete(t)}function IZ(){Nx=!1,fl!==null&&db(fl)&&(fl=null),dl!==null&&db(dl)&&(dl=null),pl!==null&&db(pl)&&(pl=null),ng.forEach(PP),ig.forEach(PP)}function Dh(e,t){e.blockedOn===t&&(e.blockedOn=null,Nx||(Nx=!0,ea.unstable_scheduleCallback(ea.unstable_NormalPriority,IZ)))}function ag(e){function t(i){return Dh(i,e)}if(0<Zv.length){Dh(Zv[0],e);for(var r=1;r<Zv.length;r++){var n=Zv[r];n.blockedOn===e&&(n.blockedOn=null)}}for(fl!==null&&Dh(fl,e),dl!==null&&Dh(dl,e),pl!==null&&Dh(pl,e),ng.forEach(t),ig.forEach(t),r=0;r<sl.length;r++)n=sl[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<sl.length&&(r=sl[0],r.blockedOn===null);)iD(r),r.blockedOn===null&&sl.shift()}var Tf=ys.ReactCurrentBatchConfig,Ab=!0;function CZ(e,t,r,n){var i=sr,a=Tf.transition;Tf.transition=null;try{sr=1,yk(e,t,r,n)}finally{sr=i,Tf.transition=a}}function TZ(e,t,r,n){var i=sr,a=Tf.transition;Tf.transition=null;try{sr=4,yk(e,t,r,n)}finally{sr=i,Tf.transition=a}}function yk(e,t,r,n){if(Ab){var i=Lx(e,t,r,n);if(i===null)nx(e,t,n,Ib,r),LP(e,n);else if(AZ(i,e,t,r,n))n.stopPropagation();else if(LP(e,n),t&4&&-1<OZ.indexOf(e)){for(;i!==null;){var a=bg(i);if(a!==null&&eD(a),a=Lx(e,t,r,n),a===null&&nx(e,t,n,Ib,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else nx(e,t,n,null,r)}}var Ib=null;function Lx(e,t,r,n){if(Ib=null,e=dk(n),e=Oc(e),e!==null)if(t=Rc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=WF(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ib=e,null}function aD(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mZ()){case pk:return 1;case KF:return 4;case Eb:case vZ:return 16;case XF:return 536870912;default:return 16}default:return 16}}var cl=null,mk=null,pb=null;function oD(){if(pb)return pb;var e,t=mk,r=t.length,n,i="value"in cl?cl.value:cl.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[a-n];n++);return pb=i.slice(e,1<n?1-n:void 0)}function hb(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Qv(){return!0}function FP(){return!1}function ta(e){function t(r,n,i,a,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(a):a[s]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Qv:FP,this.isPropagationStopped=FP,this}return Ur(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Qv)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Qv)},persist:function(){},isPersistent:Qv}),t}var $f={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vk=ta($f),vg=Ur({},$f,{view:0,detail:0}),NZ=ta(vg),XS,ZS,Bh,Jb=Ur({},vg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bk,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bh&&(Bh&&e.type==="mousemove"?(XS=e.screenX-Bh.screenX,ZS=e.screenY-Bh.screenY):ZS=XS=0,Bh=e),XS)},movementY:function(e){return"movementY"in e?e.movementY:ZS}}),DP=ta(Jb),LZ=Ur({},Jb,{dataTransfer:0}),PZ=ta(LZ),FZ=Ur({},vg,{relatedTarget:0}),QS=ta(FZ),DZ=Ur({},$f,{animationName:0,elapsedTime:0,pseudoElement:0}),BZ=ta(DZ),RZ=Ur({},$f,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),MZ=ta(RZ),jZ=Ur({},$f,{data:0}),BP=ta(jZ),$Z={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UZ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zZ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qZ(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zZ[e])?!!t[e]:!1}function bk(){return qZ}var VZ=Ur({},vg,{key:function(e){if(e.key){var t=$Z[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=hb(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?UZ[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bk,charCode:function(e){return e.type==="keypress"?hb(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?hb(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),HZ=ta(VZ),WZ=Ur({},Jb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),RP=ta(WZ),JZ=Ur({},vg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bk}),GZ=ta(JZ),YZ=Ur({},$f,{propertyName:0,elapsedTime:0,pseudoElement:0}),KZ=ta(YZ),XZ=Ur({},Jb,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ZZ=ta(XZ),QZ=[9,13,27,32],_k=ds&&"CompositionEvent"in window,Jh=null;ds&&"documentMode"in document&&(Jh=document.documentMode);var eQ=ds&&"TextEvent"in window&&!Jh,sD=ds&&(!_k||Jh&&8<Jh&&11>=Jh),MP=String.fromCharCode(32),jP=!1;function lD(e,t){switch(e){case"keyup":return QZ.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cD(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var mf=!1;function tQ(e,t){switch(e){case"compositionend":return cD(t);case"keypress":return t.which!==32?null:(jP=!0,MP);case"textInput":return e=t.data,e===MP&&jP?null:e;default:return null}}function rQ(e,t){if(mf)return e==="compositionend"||!_k&&lD(e,t)?(e=oD(),pb=mk=cl=null,mf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return sD&&t.locale!=="ko"?null:t.data;default:return null}}var nQ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $P(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!nQ[e.type]:t==="textarea"}function uD(e,t,r,n){UF(n),t=Cb(t,"onChange"),0<t.length&&(r=new vk("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Gh=null,og=null;function iQ(e){wD(e,0)}function Gb(e){var t=_f(e);if(FF(t))return e}function aQ(e,t){if(e==="change")return t}var fD=!1;ds&&(ds?(tb="oninput"in document,tb||(ex=document.createElement("div"),ex.setAttribute("oninput","return;"),tb=typeof ex.oninput=="function"),eb=tb):eb=!1,fD=eb&&(!document.documentMode||9<document.documentMode));var eb,tb,ex;function UP(){Gh&&(Gh.detachEvent("onpropertychange",dD),og=Gh=null)}function dD(e){if(e.propertyName==="value"&&Gb(og)){var t=[];uD(t,og,e,dk(e)),HF(iQ,t)}}function oQ(e,t,r){e==="focusin"?(UP(),Gh=t,og=r,Gh.attachEvent("onpropertychange",dD)):e==="focusout"&&UP()}function sQ(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Gb(og)}function lQ(e,t){if(e==="click")return Gb(t)}function cQ(e,t){if(e==="input"||e==="change")return Gb(t)}function uQ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ga=typeof Object.is=="function"?Object.is:uQ;function sg(e,t){if(Ga(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!hx.call(t,i)||!Ga(e[i],t[i]))return!1}return!0}function zP(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function qP(e,t){var r=zP(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=zP(r)}}function pD(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?pD(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function hD(){for(var e=window,t=Sb();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Sb(e.document)}return t}function wk(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function fQ(e){var t=hD(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&pD(r.ownerDocument.documentElement,r)){if(n!==null&&wk(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=qP(r,a);var o=qP(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var dQ=ds&&"documentMode"in document&&11>=document.documentMode,vf=null,Px=null,Yh=null,Fx=!1;function VP(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Fx||vf==null||vf!==Sb(n)||(n=vf,"selectionStart"in n&&wk(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Yh&&sg(Yh,n)||(Yh=n,n=Cb(Px,"onSelect"),0<n.length&&(t=new vk("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=vf)))}function rb(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var bf={animationend:rb("Animation","AnimationEnd"),animationiteration:rb("Animation","AnimationIteration"),animationstart:rb("Animation","AnimationStart"),transitionend:rb("Transition","TransitionEnd")},tx={},gD={};ds&&(gD=document.createElement("div").style,"AnimationEvent"in window||(delete bf.animationend.animation,delete bf.animationiteration.animation,delete bf.animationstart.animation),"TransitionEvent"in window||delete bf.transitionend.transition);function Yb(e){if(tx[e])return tx[e];if(!bf[e])return e;var t=bf[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in gD)return tx[e]=t[r];return e}var yD=Yb("animationend"),mD=Yb("animationiteration"),vD=Yb("animationstart"),bD=Yb("transitionend"),_D=new Map,HP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wl(e,t){_D.set(e,t),Bc(t,[e])}for(nb=0;nb<HP.length;nb++)ib=HP[nb],WP=ib.toLowerCase(),JP=ib[0].toUpperCase()+ib.slice(1),wl(WP,"on"+JP);var ib,WP,JP,nb;wl(yD,"onAnimationEnd");wl(mD,"onAnimationIteration");wl(vD,"onAnimationStart");wl("dblclick","onDoubleClick");wl("focusin","onFocus");wl("focusout","onBlur");wl(bD,"onTransitionEnd");Pf("onMouseEnter",["mouseout","mouseover"]);Pf("onMouseLeave",["mouseout","mouseover"]);Pf("onPointerEnter",["pointerout","pointerover"]);Pf("onPointerLeave",["pointerout","pointerover"]);Bc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Bc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Bc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Bc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Bc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Bc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vh));function GP(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,pZ(n,t,void 0,e),e.currentTarget=null}function wD(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&i.isPropagationStopped())break e;GP(i,s,c),a=l}else for(o=0;o<n.length;o++){if(s=n[o],l=s.instance,c=s.currentTarget,s=s.listener,l!==a&&i.isPropagationStopped())break e;GP(i,s,c),a=l}}}if(kb)throw e=Cx,kb=!1,Cx=null,e}function Ar(e,t){var r=t[jx];r===void 0&&(r=t[jx]=new Set);var n=e+"__bubble";r.has(n)||(SD(t,e,2,!1),r.add(n))}function rx(e,t,r){var n=0;t&&(n|=4),SD(r,e,n,t)}var ab="_reactListening"+Math.random().toString(36).slice(2);function lg(e){if(!e[ab]){e[ab]=!0,CF.forEach(function(r){r!=="selectionchange"&&(pQ.has(r)||rx(r,!1,e),rx(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ab]||(t[ab]=!0,rx("selectionchange",!1,t))}}function SD(e,t,r,n){switch(aD(t)){case 1:var i=CZ;break;case 4:i=TZ;break;default:i=yk}r=i.bind(null,t,r,e),i=void 0,!Ix||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function nx(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var s=n.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;s!==null;){if(o=Oc(s),o===null)return;if(l=o.tag,l===5||l===6){n=a=o;continue e}s=s.parentNode}}n=n.return}HF(function(){var c=a,f=dk(r),u=[];e:{var h=_D.get(e);if(h!==void 0){var g=vk,_=e;switch(e){case"keypress":if(hb(r)===0)break e;case"keydown":case"keyup":g=HZ;break;case"focusin":_="focus",g=QS;break;case"focusout":_="blur",g=QS;break;case"beforeblur":case"afterblur":g=QS;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=DP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=PZ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=GZ;break;case yD:case mD:case vD:g=BZ;break;case bD:g=KZ;break;case"scroll":g=NZ;break;case"wheel":g=ZZ;break;case"copy":case"cut":case"paste":g=MZ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=RP}var w=(t&4)!==0,E=!w&&e==="scroll",S=w?h!==null?h+"Capture":null:h;w=[];for(var A=c,O;A!==null;){O=A;var C=O.stateNode;if(O.tag===5&&C!==null&&(O=C,S!==null&&(C=rg(A,S),C!=null&&w.push(cg(A,C,O)))),E)break;A=A.return}0<w.length&&(h=new g(h,_,null,r,f),u.push({event:h,listeners:w}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",h&&r!==Ox&&(_=r.relatedTarget||r.fromElement)&&(Oc(_)||_[ps]))break e;if((g||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,g?(_=r.relatedTarget||r.toElement,g=c,_=_?Oc(_):null,_!==null&&(E=Rc(_),_!==E||_.tag!==5&&_.tag!==6)&&(_=null)):(g=null,_=c),g!==_)){if(w=DP,C="onMouseLeave",S="onMouseEnter",A="mouse",(e==="pointerout"||e==="pointerover")&&(w=RP,C="onPointerLeave",S="onPointerEnter",A="pointer"),E=g==null?h:_f(g),O=_==null?h:_f(_),h=new w(C,A+"leave",g,r,f),h.target=E,h.relatedTarget=O,C=null,Oc(f)===c&&(w=new w(S,A+"enter",_,r,f),w.target=O,w.relatedTarget=E,C=w),E=C,g&&_)t:{for(w=g,S=_,A=0,O=w;O;O=hf(O))A++;for(O=0,C=S;C;C=hf(C))O++;for(;0<A-O;)w=hf(w),A--;for(;0<O-A;)S=hf(S),O--;for(;A--;){if(w===S||S!==null&&w===S.alternate)break t;w=hf(w),S=hf(S)}w=null}else w=null;g!==null&&YP(u,h,g,w,!1),_!==null&&E!==null&&YP(u,E,_,w,!0)}}e:{if(h=c?_f(c):window,g=h.nodeName&&h.nodeName.toLowerCase(),g==="select"||g==="input"&&h.type==="file")var T=aQ;else if($P(h))if(fD)T=cQ;else{T=sQ;var D=oQ}else(g=h.nodeName)&&g.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(T=lQ);if(T&&(T=T(e,c))){uD(u,T,r,f);break e}D&&D(e,h,c),e==="focusout"&&(D=h._wrapperState)&&D.controlled&&h.type==="number"&&wx(h,"number",h.value)}switch(D=c?_f(c):window,e){case"focusin":($P(D)||D.contentEditable==="true")&&(vf=D,Px=c,Yh=null);break;case"focusout":Yh=Px=vf=null;break;case"mousedown":Fx=!0;break;case"contextmenu":case"mouseup":case"dragend":Fx=!1,VP(u,r,f);break;case"selectionchange":if(dQ)break;case"keydown":case"keyup":VP(u,r,f)}var P;if(_k)e:{switch(e){case"compositionstart":var z="onCompositionStart";break e;case"compositionend":z="onCompositionEnd";break e;case"compositionupdate":z="onCompositionUpdate";break e}z=void 0}else mf?lD(e,r)&&(z="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(z="onCompositionStart");z&&(sD&&r.locale!=="ko"&&(mf||z!=="onCompositionStart"?z==="onCompositionEnd"&&mf&&(P=oD()):(cl=f,mk="value"in cl?cl.value:cl.textContent,mf=!0)),D=Cb(c,z),0<D.length&&(z=new BP(z,e,null,r,f),u.push({event:z,listeners:D}),P?z.data=P:(P=cD(r),P!==null&&(z.data=P)))),(P=eQ?tQ(e,r):rQ(e,r))&&(c=Cb(c,"onBeforeInput"),0<c.length&&(f=new BP("onBeforeInput","beforeinput",null,r,f),u.push({event:f,listeners:c}),f.data=P))}wD(u,t)})}function cg(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Cb(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=rg(e,r),a!=null&&n.unshift(cg(e,a,i)),a=rg(e,t),a!=null&&n.push(cg(e,a,i))),e=e.return}return n}function hf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function YP(e,t,r,n,i){for(var a=t._reactName,o=[];r!==null&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(l!==null&&l===n)break;s.tag===5&&c!==null&&(s=c,i?(l=rg(r,a),l!=null&&o.unshift(cg(r,l,s))):i||(l=rg(r,a),l!=null&&o.push(cg(r,l,s)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var hQ=/\r\n?/g,gQ=/\u0000|\uFFFD/g;function KP(e){return(typeof e=="string"?e:""+e).replace(hQ,`
`).replace(gQ,"")}function ob(e,t,r){if(t=KP(t),KP(e)!==t&&r)throw Error(ze(425))}function Tb(){}var Dx=null,Bx=null;function Rx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Mx=typeof setTimeout=="function"?setTimeout:void 0,yQ=typeof clearTimeout=="function"?clearTimeout:void 0,XP=typeof Promise=="function"?Promise:void 0,mQ=typeof queueMicrotask=="function"?queueMicrotask:typeof XP<"u"?function(e){return XP.resolve(null).then(e).catch(vQ)}:Mx;function vQ(e){setTimeout(function(){throw e})}function ix(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),ag(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);ag(t)}function hl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ZP(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Uf=Math.random().toString(36).slice(2),Eo="__reactFiber$"+Uf,ug="__reactProps$"+Uf,ps="__reactContainer$"+Uf,jx="__reactEvents$"+Uf,bQ="__reactListeners$"+Uf,_Q="__reactHandles$"+Uf;function Oc(e){var t=e[Eo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ps]||r[Eo]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=ZP(e);e!==null;){if(r=e[Eo])return r;e=ZP(e)}return t}e=r,r=e.parentNode}return null}function bg(e){return e=e[Eo]||e[ps],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function _f(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ze(33))}function Kb(e){return e[ug]||null}var $x=[],wf=-1;function Sl(e){return{current:e}}function Ir(e){0>wf||(e.current=$x[wf],$x[wf]=null,wf--)}function br(e,t){wf++,$x[wf]=e.current,e.current=t}var _l={},Xn=Sl(_l),Fi=Sl(!1),Nc=_l;function Ff(e,t){var r=e.type.contextTypes;if(!r)return _l;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Di(e){return e=e.childContextTypes,e!=null}function Nb(){Ir(Fi),Ir(Xn)}function QP(e,t,r){if(Xn.current!==_l)throw Error(ze(168));br(Xn,t),br(Fi,r)}function xD(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(ze(108,oZ(e)||"Unknown",i));return Ur({},r,n)}function Lb(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_l,Nc=Xn.current,br(Xn,e),br(Fi,Fi.current),!0}function eF(e,t,r){var n=e.stateNode;if(!n)throw Error(ze(169));r?(e=xD(e,t,Nc),n.__reactInternalMemoizedMergedChildContext=e,Ir(Fi),Ir(Xn),br(Xn,e)):Ir(Fi),br(Fi,r)}var ss=null,Xb=!1,ax=!1;function kD(e){ss===null?ss=[e]:ss.push(e)}function wQ(e){Xb=!0,kD(e)}function xl(){if(!ax&&ss!==null){ax=!0;var e=0,t=sr;try{var r=ss;for(sr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ss=null,Xb=!1}catch(i){throw ss!==null&&(ss=ss.slice(e+1)),YF(pk,xl),i}finally{sr=t,ax=!1}}return null}var Sf=[],xf=0,Pb=null,Fb=0,ma=[],va=0,Lc=null,ls=1,cs="";function kc(e,t){Sf[xf++]=Fb,Sf[xf++]=Pb,Pb=e,Fb=t}function ED(e,t,r){ma[va++]=ls,ma[va++]=cs,ma[va++]=Lc,Lc=e;var n=ls;e=cs;var i=32-Wa(n)-1;n&=~(1<<i),r+=1;var a=32-Wa(t)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,ls=1<<32-Wa(t)+i|r<<i|n,cs=a+e}else ls=1<<a|r<<i|n,cs=e}function Sk(e){e.return!==null&&(kc(e,1),ED(e,1,0))}function xk(e){for(;e===Pb;)Pb=Sf[--xf],Sf[xf]=null,Fb=Sf[--xf],Sf[xf]=null;for(;e===Lc;)Lc=ma[--va],ma[va]=null,cs=ma[--va],ma[va]=null,ls=ma[--va],ma[va]=null}var Qi=null,Zi=null,Pr=!1,Ha=null;function OD(e,t){var r=ba(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function tF(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Qi=e,Zi=hl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Qi=e,Zi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Lc!==null?{id:ls,overflow:cs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ba(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Qi=e,Zi=null,!0):!1;default:return!1}}function Ux(e){return(e.mode&1)!==0&&(e.flags&128)===0}function zx(e){if(Pr){var t=Zi;if(t){var r=t;if(!tF(e,t)){if(Ux(e))throw Error(ze(418));t=hl(r.nextSibling);var n=Qi;t&&tF(e,t)?OD(n,r):(e.flags=e.flags&-4097|2,Pr=!1,Qi=e)}}else{if(Ux(e))throw Error(ze(418));e.flags=e.flags&-4097|2,Pr=!1,Qi=e}}}function rF(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Qi=e}function sb(e){if(e!==Qi)return!1;if(!Pr)return rF(e),Pr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Rx(e.type,e.memoizedProps)),t&&(t=Zi)){if(Ux(e))throw AD(),Error(ze(418));for(;t;)OD(e,t),t=hl(t.nextSibling)}if(rF(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ze(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Zi=hl(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Zi=null}}else Zi=Qi?hl(e.stateNode.nextSibling):null;return!0}function AD(){for(var e=Zi;e;)e=hl(e.nextSibling)}function Df(){Zi=Qi=null,Pr=!1}function kk(e){Ha===null?Ha=[e]:Ha.push(e)}var SQ=ys.ReactCurrentBatchConfig;function qa(e,t){if(e&&e.defaultProps){t=Ur({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var Db=Sl(null),Bb=null,kf=null,Ek=null;function Ok(){Ek=kf=Bb=null}function Ak(e){var t=Db.current;Ir(Db),e._currentValue=t}function qx(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Nf(e,t){Bb=e,Ek=kf=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Pi=!0),e.firstContext=null)}function wa(e){var t=e._currentValue;if(Ek!==e)if(e={context:e,memoizedValue:t,next:null},kf===null){if(Bb===null)throw Error(ze(308));kf=e,Bb.dependencies={lanes:0,firstContext:e}}else kf=kf.next=e;return t}var Ac=null;function Ik(e){Ac===null?Ac=[e]:Ac.push(e)}function ID(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,Ik(t)):(r.next=i.next,i.next=r),t.interleaved=r,hs(e,n)}function hs(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ol=!1;function Ck(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CD(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function us(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function gl(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ht&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,hs(e,r)}return i=n.interleaved,i===null?(t.next=t,Ik(n)):(t.next=i.next,i.next=t),n.interleaved=t,hs(e,r)}function gb(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hk(e,r)}}function nF(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Rb(e,t,r,n){var i=e.updateQueue;ol=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var l=s,c=l.next;l.next=null,o===null?a=c:o.next=c,o=l;var f=e.alternate;f!==null&&(f=f.updateQueue,s=f.lastBaseUpdate,s!==o&&(s===null?f.firstBaseUpdate=c:s.next=c,f.lastBaseUpdate=l))}if(a!==null){var u=i.baseState;o=0,f=c=l=null,s=a;do{var h=s.lane,g=s.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:g,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var _=e,w=s;switch(h=t,g=r,w.tag){case 1:if(_=w.payload,typeof _=="function"){u=_.call(g,u,h);break e}u=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=w.payload,h=typeof _=="function"?_.call(g,u,h):_,h==null)break e;u=Ur({},u,h);break e;case 2:ol=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[s]:h.push(s))}else g={eventTime:g,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},f===null?(c=f=g,l=u):f=f.next=g,o|=h;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;h=s,s=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(f===null&&(l=u),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=f,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Fc|=o,e.lanes=o,e.memoizedState=u}}function iF(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ze(191,i));i.call(n)}}}var TD=new IF.Component().refs;function Vx(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ur({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Zb={isMounted:function(e){return(e=e._reactInternals)?Rc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=pi(),i=ml(e),a=us(n,i);a.payload=t,r!=null&&(a.callback=r),t=gl(e,a,i),t!==null&&(Ja(t,e,i,n),gb(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=pi(),i=ml(e),a=us(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=gl(e,a,i),t!==null&&(Ja(t,e,i,n),gb(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=pi(),n=ml(e),i=us(r,n);i.tag=2,t!=null&&(i.callback=t),t=gl(e,i,n),t!==null&&(Ja(t,e,n,r),gb(t,e,n))}};function aF(e,t,r,n,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!sg(r,n)||!sg(i,a):!0}function ND(e,t,r){var n=!1,i=_l,a=t.contextType;return typeof a=="object"&&a!==null?a=wa(a):(i=Di(t)?Nc:Xn.current,n=t.contextTypes,a=(n=n!=null)?Ff(e,i):_l),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Zb,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function oF(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Zb.enqueueReplaceState(t,t.state,null)}function Hx(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=TD,Ck(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=wa(a):(a=Di(t)?Nc:Xn.current,i.context=Ff(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Vx(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Zb.enqueueReplaceState(i,i.state,null),Rb(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Rh(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ze(309));var n=r.stateNode}if(!n)throw Error(ze(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var s=i.refs;s===TD&&(s=i.refs={}),o===null?delete s[a]:s[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(ze(284));if(!r._owner)throw Error(ze(290,e))}return e}function lb(e,t){throw e=Object.prototype.toString.call(t),Error(ze(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function sF(e){var t=e._init;return t(e._payload)}function LD(e){function t(S,A){if(e){var O=S.deletions;O===null?(S.deletions=[A],S.flags|=16):O.push(A)}}function r(S,A){if(!e)return null;for(;A!==null;)t(S,A),A=A.sibling;return null}function n(S,A){for(S=new Map;A!==null;)A.key!==null?S.set(A.key,A):S.set(A.index,A),A=A.sibling;return S}function i(S,A){return S=vl(S,A),S.index=0,S.sibling=null,S}function a(S,A,O){return S.index=O,e?(O=S.alternate,O!==null?(O=O.index,O<A?(S.flags|=2,A):O):(S.flags|=2,A)):(S.flags|=1048576,A)}function o(S){return e&&S.alternate===null&&(S.flags|=2),S}function s(S,A,O,C){return A===null||A.tag!==6?(A=dx(O,S.mode,C),A.return=S,A):(A=i(A,O),A.return=S,A)}function l(S,A,O,C){var T=O.type;return T===yf?f(S,A,O.props.children,C,O.key):A!==null&&(A.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===al&&sF(T)===A.type)?(C=i(A,O.props),C.ref=Rh(S,A,O),C.return=S,C):(C=wb(O.type,O.key,O.props,null,S.mode,C),C.ref=Rh(S,A,O),C.return=S,C)}function c(S,A,O,C){return A===null||A.tag!==4||A.stateNode.containerInfo!==O.containerInfo||A.stateNode.implementation!==O.implementation?(A=px(O,S.mode,C),A.return=S,A):(A=i(A,O.children||[]),A.return=S,A)}function f(S,A,O,C,T){return A===null||A.tag!==7?(A=Tc(O,S.mode,C,T),A.return=S,A):(A=i(A,O),A.return=S,A)}function u(S,A,O){if(typeof A=="string"&&A!==""||typeof A=="number")return A=dx(""+A,S.mode,O),A.return=S,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Jv:return O=wb(A.type,A.key,A.props,null,S.mode,O),O.ref=Rh(S,null,A),O.return=S,O;case gf:return A=px(A,S.mode,O),A.return=S,A;case al:var C=A._init;return u(S,C(A._payload),O)}if(zh(A)||Ph(A))return A=Tc(A,S.mode,O,null),A.return=S,A;lb(S,A)}return null}function h(S,A,O,C){var T=A!==null?A.key:null;if(typeof O=="string"&&O!==""||typeof O=="number")return T!==null?null:s(S,A,""+O,C);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Jv:return O.key===T?l(S,A,O,C):null;case gf:return O.key===T?c(S,A,O,C):null;case al:return T=O._init,h(S,A,T(O._payload),C)}if(zh(O)||Ph(O))return T!==null?null:f(S,A,O,C,null);lb(S,O)}return null}function g(S,A,O,C,T){if(typeof C=="string"&&C!==""||typeof C=="number")return S=S.get(O)||null,s(A,S,""+C,T);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Jv:return S=S.get(C.key===null?O:C.key)||null,l(A,S,C,T);case gf:return S=S.get(C.key===null?O:C.key)||null,c(A,S,C,T);case al:var D=C._init;return g(S,A,O,D(C._payload),T)}if(zh(C)||Ph(C))return S=S.get(O)||null,f(A,S,C,T,null);lb(A,C)}return null}function _(S,A,O,C){for(var T=null,D=null,P=A,z=A=0,ne=null;P!==null&&z<O.length;z++){P.index>z?(ne=P,P=null):ne=P.sibling;var V=h(S,P,O[z],C);if(V===null){P===null&&(P=ne);break}e&&P&&V.alternate===null&&t(S,P),A=a(V,A,z),D===null?T=V:D.sibling=V,D=V,P=ne}if(z===O.length)return r(S,P),Pr&&kc(S,z),T;if(P===null){for(;z<O.length;z++)P=u(S,O[z],C),P!==null&&(A=a(P,A,z),D===null?T=P:D.sibling=P,D=P);return Pr&&kc(S,z),T}for(P=n(S,P);z<O.length;z++)ne=g(P,S,z,O[z],C),ne!==null&&(e&&ne.alternate!==null&&P.delete(ne.key===null?z:ne.key),A=a(ne,A,z),D===null?T=ne:D.sibling=ne,D=ne);return e&&P.forEach(function(X){return t(S,X)}),Pr&&kc(S,z),T}function w(S,A,O,C){var T=Ph(O);if(typeof T!="function")throw Error(ze(150));if(O=T.call(O),O==null)throw Error(ze(151));for(var D=T=null,P=A,z=A=0,ne=null,V=O.next();P!==null&&!V.done;z++,V=O.next()){P.index>z?(ne=P,P=null):ne=P.sibling;var X=h(S,P,V.value,C);if(X===null){P===null&&(P=ne);break}e&&P&&X.alternate===null&&t(S,P),A=a(X,A,z),D===null?T=X:D.sibling=X,D=X,P=ne}if(V.done)return r(S,P),Pr&&kc(S,z),T;if(P===null){for(;!V.done;z++,V=O.next())V=u(S,V.value,C),V!==null&&(A=a(V,A,z),D===null?T=V:D.sibling=V,D=V);return Pr&&kc(S,z),T}for(P=n(S,P);!V.done;z++,V=O.next())V=g(P,S,z,V.value,C),V!==null&&(e&&V.alternate!==null&&P.delete(V.key===null?z:V.key),A=a(V,A,z),D===null?T=V:D.sibling=V,D=V);return e&&P.forEach(function(Q){return t(S,Q)}),Pr&&kc(S,z),T}function E(S,A,O,C){if(typeof O=="object"&&O!==null&&O.type===yf&&O.key===null&&(O=O.props.children),typeof O=="object"&&O!==null){switch(O.$$typeof){case Jv:e:{for(var T=O.key,D=A;D!==null;){if(D.key===T){if(T=O.type,T===yf){if(D.tag===7){r(S,D.sibling),A=i(D,O.props.children),A.return=S,S=A;break e}}else if(D.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===al&&sF(T)===D.type){r(S,D.sibling),A=i(D,O.props),A.ref=Rh(S,D,O),A.return=S,S=A;break e}r(S,D);break}else t(S,D);D=D.sibling}O.type===yf?(A=Tc(O.props.children,S.mode,C,O.key),A.return=S,S=A):(C=wb(O.type,O.key,O.props,null,S.mode,C),C.ref=Rh(S,A,O),C.return=S,S=C)}return o(S);case gf:e:{for(D=O.key;A!==null;){if(A.key===D)if(A.tag===4&&A.stateNode.containerInfo===O.containerInfo&&A.stateNode.implementation===O.implementation){r(S,A.sibling),A=i(A,O.children||[]),A.return=S,S=A;break e}else{r(S,A);break}else t(S,A);A=A.sibling}A=px(O,S.mode,C),A.return=S,S=A}return o(S);case al:return D=O._init,E(S,A,D(O._payload),C)}if(zh(O))return _(S,A,O,C);if(Ph(O))return w(S,A,O,C);lb(S,O)}return typeof O=="string"&&O!==""||typeof O=="number"?(O=""+O,A!==null&&A.tag===6?(r(S,A.sibling),A=i(A,O),A.return=S,S=A):(r(S,A),A=dx(O,S.mode,C),A.return=S,S=A),o(S)):r(S,A)}return E}var Bf=LD(!0),PD=LD(!1),_g={},Ao=Sl(_g),fg=Sl(_g),dg=Sl(_g);function Ic(e){if(e===_g)throw Error(ze(174));return e}function Tk(e,t){switch(br(dg,t),br(fg,e),br(Ao,_g),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:xx(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=xx(t,e)}Ir(Ao),br(Ao,t)}function Rf(){Ir(Ao),Ir(fg),Ir(dg)}function FD(e){Ic(dg.current);var t=Ic(Ao.current),r=xx(t,e.type);t!==r&&(br(fg,e),br(Ao,r))}function Nk(e){fg.current===e&&(Ir(Ao),Ir(fg))}var jr=Sl(0);function Mb(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ox=[];function Lk(){for(var e=0;e<ox.length;e++)ox[e]._workInProgressVersionPrimary=null;ox.length=0}var yb=ys.ReactCurrentDispatcher,sx=ys.ReactCurrentBatchConfig,Pc=0,$r=null,yn=null,Sn=null,jb=!1,Kh=!1,pg=0,xQ=0;function Gn(){throw Error(ze(321))}function Pk(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ga(e[r],t[r]))return!1;return!0}function Fk(e,t,r,n,i,a){if(Pc=a,$r=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,yb.current=e===null||e.memoizedState===null?AQ:IQ,e=r(n,i),Kh){a=0;do{if(Kh=!1,pg=0,25<=a)throw Error(ze(301));a+=1,Sn=yn=null,t.updateQueue=null,yb.current=CQ,e=r(n,i)}while(Kh)}if(yb.current=$b,t=yn!==null&&yn.next!==null,Pc=0,Sn=yn=$r=null,jb=!1,t)throw Error(ze(300));return e}function Dk(){var e=pg!==0;return pg=0,e}function ko(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sn===null?$r.memoizedState=Sn=e:Sn=Sn.next=e,Sn}function Sa(){if(yn===null){var e=$r.alternate;e=e!==null?e.memoizedState:null}else e=yn.next;var t=Sn===null?$r.memoizedState:Sn.next;if(t!==null)Sn=t,yn=e;else{if(e===null)throw Error(ze(310));yn=e,e={memoizedState:yn.memoizedState,baseState:yn.baseState,baseQueue:yn.baseQueue,queue:yn.queue,next:null},Sn===null?$r.memoizedState=Sn=e:Sn=Sn.next=e}return Sn}function hg(e,t){return typeof t=="function"?t(e):t}function lx(e){var t=Sa(),r=t.queue;if(r===null)throw Error(ze(311));r.lastRenderedReducer=e;var n=yn,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var s=o=null,l=null,c=a;do{var f=c.lane;if((Pc&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var u={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(s=l=u,o=n):l=l.next=u,$r.lanes|=f,Fc|=f}c=c.next}while(c!==null&&c!==a);l===null?o=n:l.next=s,Ga(n,t.memoizedState)||(Pi=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,$r.lanes|=a,Fc|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function cx(e){var t=Sa(),r=t.queue;if(r===null)throw Error(ze(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Ga(a,t.memoizedState)||(Pi=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function DD(){}function BD(e,t){var r=$r,n=Sa(),i=t(),a=!Ga(n.memoizedState,i);if(a&&(n.memoizedState=i,Pi=!0),n=n.queue,Bk(jD.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Sn!==null&&Sn.memoizedState.tag&1){if(r.flags|=2048,gg(9,MD.bind(null,r,n,i,t),void 0,null),xn===null)throw Error(ze(349));Pc&30||RD(r,t,i)}return i}function RD(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=$r.updateQueue,t===null?(t={lastEffect:null,stores:null},$r.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function MD(e,t,r,n){t.value=r,t.getSnapshot=n,$D(t)&&UD(e)}function jD(e,t,r){return r(function(){$D(t)&&UD(e)})}function $D(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ga(e,r)}catch{return!0}}function UD(e){var t=hs(e,1);t!==null&&Ja(t,e,1,-1)}function lF(e){var t=ko();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hg,lastRenderedState:e},t.queue=e,e=e.dispatch=OQ.bind(null,$r,e),[t.memoizedState,e]}function gg(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=$r.updateQueue,t===null?(t={lastEffect:null,stores:null},$r.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function zD(){return Sa().memoizedState}function mb(e,t,r,n){var i=ko();$r.flags|=e,i.memoizedState=gg(1|t,r,void 0,n===void 0?null:n)}function Qb(e,t,r,n){var i=Sa();n=n===void 0?null:n;var a=void 0;if(yn!==null){var o=yn.memoizedState;if(a=o.destroy,n!==null&&Pk(n,o.deps)){i.memoizedState=gg(t,r,a,n);return}}$r.flags|=e,i.memoizedState=gg(1|t,r,a,n)}function cF(e,t){return mb(8390656,8,e,t)}function Bk(e,t){return Qb(2048,8,e,t)}function qD(e,t){return Qb(4,2,e,t)}function VD(e,t){return Qb(4,4,e,t)}function HD(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function WD(e,t,r){return r=r!=null?r.concat([e]):null,Qb(4,4,HD.bind(null,t,e),r)}function Rk(){}function JD(e,t){var r=Sa();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Pk(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function GD(e,t){var r=Sa();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Pk(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function YD(e,t,r){return Pc&21?(Ga(r,t)||(r=ZF(),$r.lanes|=r,Fc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Pi=!0),e.memoizedState=r)}function kQ(e,t){var r=sr;sr=r!==0&&4>r?r:4,e(!0);var n=sx.transition;sx.transition={};try{e(!1),t()}finally{sr=r,sx.transition=n}}function KD(){return Sa().memoizedState}function EQ(e,t,r){var n=ml(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},XD(e))ZD(t,r);else if(r=ID(e,t,r,n),r!==null){var i=pi();Ja(r,e,n,i),QD(r,t,n)}}function OQ(e,t,r){var n=ml(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(XD(e))ZD(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,s=a(o,r);if(i.hasEagerState=!0,i.eagerState=s,Ga(s,o)){var l=t.interleaved;l===null?(i.next=i,Ik(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=ID(e,t,i,n),r!==null&&(i=pi(),Ja(r,e,n,i),QD(r,t,n))}}function XD(e){var t=e.alternate;return e===$r||t!==null&&t===$r}function ZD(e,t){Kh=jb=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function QD(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hk(e,r)}}var $b={readContext:wa,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useInsertionEffect:Gn,useLayoutEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useMutableSource:Gn,useSyncExternalStore:Gn,useId:Gn,unstable_isNewReconciler:!1},AQ={readContext:wa,useCallback:function(e,t){return ko().memoizedState=[e,t===void 0?null:t],e},useContext:wa,useEffect:cF,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,mb(4194308,4,HD.bind(null,t,e),r)},useLayoutEffect:function(e,t){return mb(4194308,4,e,t)},useInsertionEffect:function(e,t){return mb(4,2,e,t)},useMemo:function(e,t){var r=ko();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ko();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=EQ.bind(null,$r,e),[n.memoizedState,e]},useRef:function(e){var t=ko();return e={current:e},t.memoizedState=e},useState:lF,useDebugValue:Rk,useDeferredValue:function(e){return ko().memoizedState=e},useTransition:function(){var e=lF(!1),t=e[0];return e=kQ.bind(null,e[1]),ko().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=$r,i=ko();if(Pr){if(r===void 0)throw Error(ze(407));r=r()}else{if(r=t(),xn===null)throw Error(ze(349));Pc&30||RD(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,cF(jD.bind(null,n,a,e),[e]),n.flags|=2048,gg(9,MD.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=ko(),t=xn.identifierPrefix;if(Pr){var r=cs,n=ls;r=(n&~(1<<32-Wa(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=pg++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=xQ++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},IQ={readContext:wa,useCallback:JD,useContext:wa,useEffect:Bk,useImperativeHandle:WD,useInsertionEffect:qD,useLayoutEffect:VD,useMemo:GD,useReducer:lx,useRef:zD,useState:function(){return lx(hg)},useDebugValue:Rk,useDeferredValue:function(e){var t=Sa();return YD(t,yn.memoizedState,e)},useTransition:function(){var e=lx(hg)[0],t=Sa().memoizedState;return[e,t]},useMutableSource:DD,useSyncExternalStore:BD,useId:KD,unstable_isNewReconciler:!1},CQ={readContext:wa,useCallback:JD,useContext:wa,useEffect:Bk,useImperativeHandle:WD,useInsertionEffect:qD,useLayoutEffect:VD,useMemo:GD,useReducer:cx,useRef:zD,useState:function(){return cx(hg)},useDebugValue:Rk,useDeferredValue:function(e){var t=Sa();return yn===null?t.memoizedState=e:YD(t,yn.memoizedState,e)},useTransition:function(){var e=cx(hg)[0],t=Sa().memoizedState;return[e,t]},useMutableSource:DD,useSyncExternalStore:BD,useId:KD,unstable_isNewReconciler:!1};function Mf(e,t){try{var r="",n=t;do r+=aZ(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function ux(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Wx(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var TQ=typeof WeakMap=="function"?WeakMap:Map;function eB(e,t,r){r=us(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){zb||(zb=!0,rk=n),Wx(e,t)},r}function tB(e,t,r){r=us(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Wx(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Wx(e,t),typeof n!="function"&&(yl===null?yl=new Set([this]):yl.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function uF(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new TQ;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=VQ.bind(null,e,t,r),t.then(e,e))}function fF(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function dF(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=us(-1,1),t.tag=2,gl(r,t,1))),r.lanes|=1),e)}var NQ=ys.ReactCurrentOwner,Pi=!1;function di(e,t,r,n){t.child=e===null?PD(t,null,r,n):Bf(t,e.child,r,n)}function pF(e,t,r,n,i){r=r.render;var a=t.ref;return Nf(t,i),n=Fk(e,t,r,n,a,i),r=Dk(),e!==null&&!Pi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,gs(e,t,i)):(Pr&&r&&Sk(t),t.flags|=1,di(e,t,n,i),t.child)}function hF(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!Hk(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,rB(e,t,a,n,i)):(e=wb(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:sg,r(o,n)&&e.ref===t.ref)return gs(e,t,i)}return t.flags|=1,e=vl(a,n),e.ref=t.ref,e.return=t,t.child=e}function rB(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(sg(a,n)&&e.ref===t.ref)if(Pi=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(Pi=!0);else return t.lanes=e.lanes,gs(e,t,i)}return Jx(e,t,r,n,i)}function nB(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},br(Of,Xi),Xi|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,br(Of,Xi),Xi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,br(Of,Xi),Xi|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,br(Of,Xi),Xi|=n;return di(e,t,i,r),t.child}function iB(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Jx(e,t,r,n,i){var a=Di(r)?Nc:Xn.current;return a=Ff(t,a),Nf(t,i),r=Fk(e,t,r,n,a,i),n=Dk(),e!==null&&!Pi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,gs(e,t,i)):(Pr&&n&&Sk(t),t.flags|=1,di(e,t,r,i),t.child)}function gF(e,t,r,n,i){if(Di(r)){var a=!0;Lb(t)}else a=!1;if(Nf(t,i),t.stateNode===null)vb(e,t),ND(t,r,n),Hx(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=wa(c):(c=Di(r)?Nc:Xn.current,c=Ff(t,c));var f=r.getDerivedStateFromProps,u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==n||l!==c)&&oF(t,o,n,c),ol=!1;var h=t.memoizedState;o.state=h,Rb(t,n,o,i),l=t.memoizedState,s!==n||h!==l||Fi.current||ol?(typeof f=="function"&&(Vx(t,r,f,n),l=t.memoizedState),(s=ol||aF(t,r,s,n,h,l,c))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=s):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,CD(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:qa(t.type,s),o.props=c,u=t.pendingProps,h=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=wa(l):(l=Di(r)?Nc:Xn.current,l=Ff(t,l));var g=r.getDerivedStateFromProps;(f=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==u||h!==l)&&oF(t,o,n,l),ol=!1,h=t.memoizedState,o.state=h,Rb(t,n,o,i);var _=t.memoizedState;s!==u||h!==_||Fi.current||ol?(typeof g=="function"&&(Vx(t,r,g,n),_=t.memoizedState),(c=ol||aF(t,r,c,n,h,_,l)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,_,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,_,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=_),o.props=n,o.state=_,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Gx(e,t,r,n,a,i)}function Gx(e,t,r,n,i,a){iB(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&eF(t,r,!1),gs(e,t,a);n=t.stateNode,NQ.current=t;var s=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Bf(t,e.child,null,a),t.child=Bf(t,null,s,a)):di(e,t,s,a),t.memoizedState=n.state,i&&eF(t,r,!0),t.child}function aB(e){var t=e.stateNode;t.pendingContext?QP(e,t.pendingContext,t.pendingContext!==t.context):t.context&&QP(e,t.context,!1),Tk(e,t.containerInfo)}function yF(e,t,r,n,i){return Df(),kk(i),t.flags|=256,di(e,t,r,n),t.child}var Yx={dehydrated:null,treeContext:null,retryLane:0};function Kx(e){return{baseLanes:e,cachePool:null,transitions:null}}function oB(e,t,r){var n=t.pendingProps,i=jr.current,a=!1,o=(t.flags&128)!==0,s;if((s=o)||(s=e!==null&&e.memoizedState===null?!1:(i&2)!==0),s?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),br(jr,i&1),e===null)return zx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=r_(o,n,0,null),e=Tc(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Kx(r),t.memoizedState=Yx,e):Mk(t,o));if(i=e.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return LQ(e,t,o,n,s,i,r);if(a){a=n.fallback,o=t.mode,i=e.child,s=i.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=vl(i,l),n.subtreeFlags=i.subtreeFlags&14680064),s!==null?a=vl(s,a):(a=Tc(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?Kx(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=Yx,n}return a=e.child,e=a.sibling,n=vl(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Mk(e,t){return t=r_({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function cb(e,t,r,n){return n!==null&&kk(n),Bf(t,e.child,null,r),e=Mk(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function LQ(e,t,r,n,i,a,o){if(r)return t.flags&256?(t.flags&=-257,n=ux(Error(ze(422))),cb(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=r_({mode:"visible",children:n.children},i,0,null),a=Tc(a,i,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Bf(t,e.child,null,o),t.child.memoizedState=Kx(o),t.memoizedState=Yx,a);if(!(t.mode&1))return cb(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var s=n.dgst;return n=s,a=Error(ze(419)),n=ux(a,n,void 0),cb(e,t,o,n)}if(s=(o&e.childLanes)!==0,Pi||s){if(n=xn,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,hs(e,i),Ja(n,e,i,-1))}return Vk(),n=ux(Error(ze(421))),cb(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=HQ.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Zi=hl(i.nextSibling),Qi=t,Pr=!0,Ha=null,e!==null&&(ma[va++]=ls,ma[va++]=cs,ma[va++]=Lc,ls=e.id,cs=e.overflow,Lc=t),t=Mk(t,n.children),t.flags|=4096,t)}function mF(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),qx(e.return,t,r)}function fx(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function sB(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(di(e,t,n.children,r),n=jr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&mF(e,r,t);else if(e.tag===19)mF(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(br(jr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Mb(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),fx(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Mb(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}fx(t,!0,r,null,a);break;case"together":fx(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function vb(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function gs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Fc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ze(153));if(t.child!==null){for(e=t.child,r=vl(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=vl(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function PQ(e,t,r){switch(t.tag){case 3:aB(t),Df();break;case 5:FD(t);break;case 1:Di(t.type)&&Lb(t);break;case 4:Tk(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;br(Db,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(br(jr,jr.current&1),t.flags|=128,null):r&t.child.childLanes?oB(e,t,r):(br(jr,jr.current&1),e=gs(e,t,r),e!==null?e.sibling:null);br(jr,jr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return sB(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),br(jr,jr.current),n)break;return null;case 22:case 23:return t.lanes=0,nB(e,t,r)}return gs(e,t,r)}var lB,Xx,cB,uB;lB=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Xx=function(){};cB=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Ic(Ao.current);var a=null;switch(r){case"input":i=bx(e,i),n=bx(e,n),a=[];break;case"select":i=Ur({},i,{value:void 0}),n=Ur({},n,{value:void 0}),a=[];break;case"textarea":i=Sx(e,i),n=Sx(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Tb)}kx(r,n);var o;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var s=i[c];for(o in s)s.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(eg.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(s=i?.[c],n.hasOwnProperty(c)&&l!==s&&(l!=null||s!=null))if(c==="style")if(s){for(o in s)!s.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&s[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(eg.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ar("scroll",e),a||s===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(t.updateQueue=c)&&(t.flags|=4)}};uB=function(e,t,r,n){r!==n&&(t.flags|=4)};function Mh(e,t){if(!Pr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Yn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function FQ(e,t,r){var n=t.pendingProps;switch(xk(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yn(t),null;case 1:return Di(t.type)&&Nb(),Yn(t),null;case 3:return n=t.stateNode,Rf(),Ir(Fi),Ir(Xn),Lk(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(sb(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ha!==null&&(ak(Ha),Ha=null))),Xx(e,t),Yn(t),null;case 5:Nk(t);var i=Ic(dg.current);if(r=t.type,e!==null&&t.stateNode!=null)cB(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ze(166));return Yn(t),null}if(e=Ic(Ao.current),sb(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Eo]=t,n[ug]=a,e=(t.mode&1)!==0,r){case"dialog":Ar("cancel",n),Ar("close",n);break;case"iframe":case"object":case"embed":Ar("load",n);break;case"video":case"audio":for(i=0;i<Vh.length;i++)Ar(Vh[i],n);break;case"source":Ar("error",n);break;case"img":case"image":case"link":Ar("error",n),Ar("load",n);break;case"details":Ar("toggle",n);break;case"input":EP(n,a),Ar("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Ar("invalid",n);break;case"textarea":AP(n,a),Ar("invalid",n)}kx(r,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var s=a[o];o==="children"?typeof s=="string"?n.textContent!==s&&(a.suppressHydrationWarning!==!0&&ob(n.textContent,s,e),i=["children",s]):typeof s=="number"&&n.textContent!==""+s&&(a.suppressHydrationWarning!==!0&&ob(n.textContent,s,e),i=["children",""+s]):eg.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&Ar("scroll",n)}switch(r){case"input":Gv(n),OP(n,a,!0);break;case"textarea":Gv(n),IP(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Tb)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=RF(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Eo]=t,e[ug]=n,lB(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ex(r,n),r){case"dialog":Ar("cancel",e),Ar("close",e),i=n;break;case"iframe":case"object":case"embed":Ar("load",e),i=n;break;case"video":case"audio":for(i=0;i<Vh.length;i++)Ar(Vh[i],e);i=n;break;case"source":Ar("error",e),i=n;break;case"img":case"image":case"link":Ar("error",e),Ar("load",e),i=n;break;case"details":Ar("toggle",e),i=n;break;case"input":EP(e,n),i=bx(e,n),Ar("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ur({},n,{value:void 0}),Ar("invalid",e);break;case"textarea":AP(e,n),i=Sx(e,n),Ar("invalid",e);break;default:i=n}kx(r,i),s=i;for(a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="style"?$F(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&MF(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&tg(e,l):typeof l=="number"&&tg(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(eg.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Ar("scroll",e):l!=null&&lk(e,a,l,o))}switch(r){case"input":Gv(e),OP(e,n,!1);break;case"textarea":Gv(e),IP(e);break;case"option":n.value!=null&&e.setAttribute("value",""+bl(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Af(e,!!n.multiple,a,!1):n.defaultValue!=null&&Af(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Tb)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Yn(t),null;case 6:if(e&&t.stateNode!=null)uB(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ze(166));if(r=Ic(dg.current),Ic(Ao.current),sb(t)){if(n=t.stateNode,r=t.memoizedProps,n[Eo]=t,(a=n.nodeValue!==r)&&(e=Qi,e!==null))switch(e.tag){case 3:ob(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ob(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Eo]=t,t.stateNode=n}return Yn(t),null;case 13:if(Ir(jr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Pr&&Zi!==null&&t.mode&1&&!(t.flags&128))AD(),Df(),t.flags|=98560,a=!1;else if(a=sb(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(ze(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ze(317));a[Eo]=t}else Df(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Yn(t),a=!1}else Ha!==null&&(ak(Ha),Ha=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||jr.current&1?mn===0&&(mn=3):Vk())),t.updateQueue!==null&&(t.flags|=4),Yn(t),null);case 4:return Rf(),Xx(e,t),e===null&&lg(t.stateNode.containerInfo),Yn(t),null;case 10:return Ak(t.type._context),Yn(t),null;case 17:return Di(t.type)&&Nb(),Yn(t),null;case 19:if(Ir(jr),a=t.memoizedState,a===null)return Yn(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)Mh(a,!1);else{if(mn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Mb(e),o!==null){for(t.flags|=128,Mh(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return br(jr,jr.current&1|2),t.child}e=e.sibling}a.tail!==null&&en()>jf&&(t.flags|=128,n=!0,Mh(a,!1),t.lanes=4194304)}else{if(!n)if(e=Mb(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Mh(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Pr)return Yn(t),null}else 2*en()-a.renderingStartTime>jf&&r!==1073741824&&(t.flags|=128,n=!0,Mh(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=en(),t.sibling=null,r=jr.current,br(jr,n?r&1|2:r&1),t):(Yn(t),null);case 22:case 23:return qk(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Xi&1073741824&&(Yn(t),t.subtreeFlags&6&&(t.flags|=8192)):Yn(t),null;case 24:return null;case 25:return null}throw Error(ze(156,t.tag))}function DQ(e,t){switch(xk(t),t.tag){case 1:return Di(t.type)&&Nb(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Rf(),Ir(Fi),Ir(Xn),Lk(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Nk(t),null;case 13:if(Ir(jr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ze(340));Df()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ir(jr),null;case 4:return Rf(),null;case 10:return Ak(t.type._context),null;case 22:case 23:return qk(),null;case 24:return null;default:return null}}var ub=!1,Kn=!1,BQ=typeof WeakSet=="function"?WeakSet:Set,ot=null;function Ef(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Hr(e,t,n)}else r.current=null}function Zx(e,t,r){try{r()}catch(n){Hr(e,t,n)}}var vF=!1;function RQ(e,t){if(Dx=Ab,e=hD(),wk(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,s=-1,l=-1,c=0,f=0,u=e,h=null;t:for(;;){for(var g;u!==r||i!==0&&u.nodeType!==3||(s=o+i),u!==a||n!==0&&u.nodeType!==3||(l=o+n),u.nodeType===3&&(o+=u.nodeValue.length),(g=u.firstChild)!==null;)h=u,u=g;for(;;){if(u===e)break t;if(h===r&&++c===i&&(s=o),h===a&&++f===n&&(l=o),(g=u.nextSibling)!==null)break;u=h,h=u.parentNode}u=g}r=s===-1||l===-1?null:{start:s,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Bx={focusedElem:e,selectionRange:r},Ab=!1,ot=t;ot!==null;)if(t=ot,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ot=e;else for(;ot!==null;){t=ot;try{var _=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var w=_.memoizedProps,E=_.memoizedState,S=t.stateNode,A=S.getSnapshotBeforeUpdate(t.elementType===t.type?w:qa(t.type,w),E);S.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var O=t.stateNode.containerInfo;O.nodeType===1?O.textContent="":O.nodeType===9&&O.documentElement&&O.removeChild(O.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ze(163))}}catch(C){Hr(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,ot=e;break}ot=t.return}return _=vF,vF=!1,_}function Xh(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&Zx(t,r,a)}i=i.next}while(i!==n)}}function e_(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Qx(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function fB(e){var t=e.alternate;t!==null&&(e.alternate=null,fB(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Eo],delete t[ug],delete t[jx],delete t[bQ],delete t[_Q])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dB(e){return e.tag===5||e.tag===3||e.tag===4}function bF(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dB(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ek(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Tb));else if(n!==4&&(e=e.child,e!==null))for(ek(e,t,r),e=e.sibling;e!==null;)ek(e,t,r),e=e.sibling}function tk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(tk(e,t,r),e=e.sibling;e!==null;)tk(e,t,r),e=e.sibling}var Mn=null,Va=!1;function il(e,t,r){for(r=r.child;r!==null;)pB(e,t,r),r=r.sibling}function pB(e,t,r){if(Oo&&typeof Oo.onCommitFiberUnmount=="function")try{Oo.onCommitFiberUnmount(Wb,r)}catch{}switch(r.tag){case 5:Kn||Ef(r,t);case 6:var n=Mn,i=Va;Mn=null,il(e,t,r),Mn=n,Va=i,Mn!==null&&(Va?(e=Mn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Mn.removeChild(r.stateNode));break;case 18:Mn!==null&&(Va?(e=Mn,r=r.stateNode,e.nodeType===8?ix(e.parentNode,r):e.nodeType===1&&ix(e,r),ag(e)):ix(Mn,r.stateNode));break;case 4:n=Mn,i=Va,Mn=r.stateNode.containerInfo,Va=!0,il(e,t,r),Mn=n,Va=i;break;case 0:case 11:case 14:case 15:if(!Kn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Zx(r,t,o),i=i.next}while(i!==n)}il(e,t,r);break;case 1:if(!Kn&&(Ef(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){Hr(r,t,s)}il(e,t,r);break;case 21:il(e,t,r);break;case 22:r.mode&1?(Kn=(n=Kn)||r.memoizedState!==null,il(e,t,r),Kn=n):il(e,t,r);break;default:il(e,t,r)}}function _F(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new BQ),t.forEach(function(n){var i=WQ.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function za(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,o=t,s=o;e:for(;s!==null;){switch(s.tag){case 5:Mn=s.stateNode,Va=!1;break e;case 3:Mn=s.stateNode.containerInfo,Va=!0;break e;case 4:Mn=s.stateNode.containerInfo,Va=!0;break e}s=s.return}if(Mn===null)throw Error(ze(160));pB(a,o,i),Mn=null,Va=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Hr(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)hB(t,e),t=t.sibling}function hB(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(za(t,e),xo(e),n&4){try{Xh(3,e,e.return),e_(3,e)}catch(w){Hr(e,e.return,w)}try{Xh(5,e,e.return)}catch(w){Hr(e,e.return,w)}}break;case 1:za(t,e),xo(e),n&512&&r!==null&&Ef(r,r.return);break;case 5:if(za(t,e),xo(e),n&512&&r!==null&&Ef(r,r.return),e.flags&32){var i=e.stateNode;try{tg(i,"")}catch(w){Hr(e,e.return,w)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&a.type==="radio"&&a.name!=null&&DF(i,a),Ex(s,o);var c=Ex(s,a);for(o=0;o<l.length;o+=2){var f=l[o],u=l[o+1];f==="style"?$F(i,u):f==="dangerouslySetInnerHTML"?MF(i,u):f==="children"?tg(i,u):lk(i,f,u,c)}switch(s){case"input":_x(i,a);break;case"textarea":BF(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var g=a.value;g!=null?Af(i,!!a.multiple,g,!1):h!==!!a.multiple&&(a.defaultValue!=null?Af(i,!!a.multiple,a.defaultValue,!0):Af(i,!!a.multiple,a.multiple?[]:"",!1))}i[ug]=a}catch(w){Hr(e,e.return,w)}}break;case 6:if(za(t,e),xo(e),n&4){if(e.stateNode===null)throw Error(ze(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(w){Hr(e,e.return,w)}}break;case 3:if(za(t,e),xo(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ag(t.containerInfo)}catch(w){Hr(e,e.return,w)}break;case 4:za(t,e),xo(e);break;case 13:za(t,e),xo(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Uk=en())),n&4&&_F(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Kn=(c=Kn)||f,za(t,e),Kn=c):za(t,e),xo(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(ot=e,f=e.child;f!==null;){for(u=ot=f;ot!==null;){switch(h=ot,g=h.child,h.tag){case 0:case 11:case 14:case 15:Xh(4,h,h.return);break;case 1:Ef(h,h.return);var _=h.stateNode;if(typeof _.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,_.props=t.memoizedProps,_.state=t.memoizedState,_.componentWillUnmount()}catch(w){Hr(n,r,w)}}break;case 5:Ef(h,h.return);break;case 22:if(h.memoizedState!==null){SF(u);continue}}g!==null?(g.return=h,ot=g):SF(u)}f=f.sibling}e:for(f=null,u=e;;){if(u.tag===5){if(f===null){f=u;try{i=u.stateNode,c?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(s=u.stateNode,l=u.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=jF("display",o))}catch(w){Hr(e,e.return,w)}}}else if(u.tag===6){if(f===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(w){Hr(e,e.return,w)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;f===u&&(f=null),u=u.return}f===u&&(f=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:za(t,e),xo(e),n&4&&_F(e);break;case 21:break;default:za(t,e),xo(e)}}function xo(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(dB(r)){var n=r;break e}r=r.return}throw Error(ze(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(tg(i,""),n.flags&=-33);var a=bF(e);tk(e,a,i);break;case 3:case 4:var o=n.stateNode.containerInfo,s=bF(e);ek(e,s,o);break;default:throw Error(ze(161))}}catch(l){Hr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function MQ(e,t,r){ot=e,gB(e,t,r)}function gB(e,t,r){for(var n=(e.mode&1)!==0;ot!==null;){var i=ot,a=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||ub;if(!o){var s=i.alternate,l=s!==null&&s.memoizedState!==null||Kn;s=ub;var c=Kn;if(ub=o,(Kn=l)&&!c)for(ot=i;ot!==null;)o=ot,l=o.child,o.tag===22&&o.memoizedState!==null?xF(i):l!==null?(l.return=o,ot=l):xF(i);for(;a!==null;)ot=a,gB(a,t,r),a=a.sibling;ot=i,ub=s,Kn=c}wF(e,t,r)}else i.subtreeFlags&8772&&a!==null?(a.return=i,ot=a):wF(e,t,r)}}function wF(e){for(;ot!==null;){var t=ot;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Kn||e_(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Kn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:qa(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&iF(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}iF(t,o,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var u=f.dehydrated;u!==null&&ag(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ze(163))}Kn||t.flags&512&&Qx(t)}catch(h){Hr(t,t.return,h)}}if(t===e){ot=null;break}if(r=t.sibling,r!==null){r.return=t.return,ot=r;break}ot=t.return}}function SF(e){for(;ot!==null;){var t=ot;if(t===e){ot=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ot=r;break}ot=t.return}}function xF(e){for(;ot!==null;){var t=ot;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{e_(4,t)}catch(l){Hr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){Hr(t,i,l)}}var a=t.return;try{Qx(t)}catch(l){Hr(t,a,l)}break;case 5:var o=t.return;try{Qx(t)}catch(l){Hr(t,o,l)}}}catch(l){Hr(t,t.return,l)}if(t===e){ot=null;break}var s=t.sibling;if(s!==null){s.return=t.return,ot=s;break}ot=t.return}}var jQ=Math.ceil,Ub=ys.ReactCurrentDispatcher,jk=ys.ReactCurrentOwner,_a=ys.ReactCurrentBatchConfig,Ht=0,xn=null,un=null,jn=0,Xi=0,Of=Sl(0),mn=0,yg=null,Fc=0,t_=0,$k=0,Zh=null,Li=null,Uk=0,jf=1/0,os=null,zb=!1,rk=null,yl=null,fb=!1,ul=null,qb=0,Qh=0,nk=null,bb=-1,_b=0;function pi(){return Ht&6?en():bb!==-1?bb:bb=en()}function ml(e){return e.mode&1?Ht&2&&jn!==0?jn&-jn:SQ.transition!==null?(_b===0&&(_b=ZF()),_b):(e=sr,e!==0||(e=window.event,e=e===void 0?16:aD(e.type)),e):1}function Ja(e,t,r,n){if(50<Qh)throw Qh=0,nk=null,Error(ze(185));mg(e,r,n),(!(Ht&2)||e!==xn)&&(e===xn&&(!(Ht&2)&&(t_|=r),mn===4&&ll(e,jn)),Bi(e,n),r===1&&Ht===0&&!(t.mode&1)&&(jf=en()+500,Xb&&xl()))}function Bi(e,t){var r=e.callbackNode;kZ(e,t);var n=Ob(e,e===xn?jn:0);if(n===0)r!==null&&NP(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&NP(r),t===1)e.tag===0?wQ(kF.bind(null,e)):kD(kF.bind(null,e)),mQ(function(){!(Ht&6)&&xl()}),r=null;else{switch(QF(n)){case 1:r=pk;break;case 4:r=KF;break;case 16:r=Eb;break;case 536870912:r=XF;break;default:r=Eb}r=xB(r,yB.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function yB(e,t){if(bb=-1,_b=0,Ht&6)throw Error(ze(327));var r=e.callbackNode;if(Lf()&&e.callbackNode!==r)return null;var n=Ob(e,e===xn?jn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Vb(e,n);else{t=n;var i=Ht;Ht|=2;var a=vB();(xn!==e||jn!==t)&&(os=null,jf=en()+500,Cc(e,t));do try{zQ();break}catch(s){mB(e,s)}while(1);Ok(),Ub.current=a,Ht=i,un!==null?t=0:(xn=null,jn=0,t=mn)}if(t!==0){if(t===2&&(i=Tx(e),i!==0&&(n=i,t=ik(e,i))),t===1)throw r=yg,Cc(e,0),ll(e,n),Bi(e,en()),r;if(t===6)ll(e,n);else{if(i=e.current.alternate,!(n&30)&&!$Q(i)&&(t=Vb(e,n),t===2&&(a=Tx(e),a!==0&&(n=a,t=ik(e,a))),t===1))throw r=yg,Cc(e,0),ll(e,n),Bi(e,en()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(ze(345));case 2:Ec(e,Li,os);break;case 3:if(ll(e,n),(n&130023424)===n&&(t=Uk+500-en(),10<t)){if(Ob(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){pi(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Mx(Ec.bind(null,e,Li,os),t);break}Ec(e,Li,os);break;case 4:if(ll(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Wa(n);a=1<<o,o=t[o],o>i&&(i=o),n&=~a}if(n=i,n=en()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*jQ(n/1960))-n,10<n){e.timeoutHandle=Mx(Ec.bind(null,e,Li,os),n);break}Ec(e,Li,os);break;case 5:Ec(e,Li,os);break;default:throw Error(ze(329))}}}return Bi(e,en()),e.callbackNode===r?yB.bind(null,e):null}function ik(e,t){var r=Zh;return e.current.memoizedState.isDehydrated&&(Cc(e,t).flags|=256),e=Vb(e,t),e!==2&&(t=Li,Li=r,t!==null&&ak(t)),e}function ak(e){Li===null?Li=e:Li.push.apply(Li,e)}function $Q(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Ga(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ll(e,t){for(t&=~$k,t&=~t_,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Wa(t),n=1<<r;e[r]=-1,t&=~n}}function kF(e){if(Ht&6)throw Error(ze(327));Lf();var t=Ob(e,0);if(!(t&1))return Bi(e,en()),null;var r=Vb(e,t);if(e.tag!==0&&r===2){var n=Tx(e);n!==0&&(t=n,r=ik(e,n))}if(r===1)throw r=yg,Cc(e,0),ll(e,t),Bi(e,en()),r;if(r===6)throw Error(ze(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ec(e,Li,os),Bi(e,en()),null}function zk(e,t){var r=Ht;Ht|=1;try{return e(t)}finally{Ht=r,Ht===0&&(jf=en()+500,Xb&&xl())}}function Dc(e){ul!==null&&ul.tag===0&&!(Ht&6)&&Lf();var t=Ht;Ht|=1;var r=_a.transition,n=sr;try{if(_a.transition=null,sr=1,e)return e()}finally{sr=n,_a.transition=r,Ht=t,!(Ht&6)&&xl()}}function qk(){Xi=Of.current,Ir(Of)}function Cc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,yQ(r)),un!==null)for(r=un.return;r!==null;){var n=r;switch(xk(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Nb();break;case 3:Rf(),Ir(Fi),Ir(Xn),Lk();break;case 5:Nk(n);break;case 4:Rf();break;case 13:Ir(jr);break;case 19:Ir(jr);break;case 10:Ak(n.type._context);break;case 22:case 23:qk()}r=r.return}if(xn=e,un=e=vl(e.current,null),jn=Xi=t,mn=0,yg=null,$k=t_=Fc=0,Li=Zh=null,Ac!==null){for(t=0;t<Ac.length;t++)if(r=Ac[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=i,n.next=o}r.pending=n}Ac=null}return e}function mB(e,t){do{var r=un;try{if(Ok(),yb.current=$b,jb){for(var n=$r.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}jb=!1}if(Pc=0,Sn=yn=$r=null,Kh=!1,pg=0,jk.current=null,r===null||r.return===null){mn=1,yg=t,un=null;break}e:{var a=e,o=r.return,s=r,l=t;if(t=jn,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=s,u=f.tag;if(!(f.mode&1)&&(u===0||u===11||u===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var g=fF(o);if(g!==null){g.flags&=-257,dF(g,o,s,a,t),g.mode&1&&uF(a,c,t),t=g,l=c;var _=t.updateQueue;if(_===null){var w=new Set;w.add(l),t.updateQueue=w}else _.add(l);break e}else{if(!(t&1)){uF(a,c,t),Vk();break e}l=Error(ze(426))}}else if(Pr&&s.mode&1){var E=fF(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),dF(E,o,s,a,t),kk(Mf(l,s));break e}}a=l=Mf(l,s),mn!==4&&(mn=2),Zh===null?Zh=[a]:Zh.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var S=eB(a,l,t);nF(a,S);break e;case 1:s=l;var A=a.type,O=a.stateNode;if(!(a.flags&128)&&(typeof A.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(yl===null||!yl.has(O)))){a.flags|=65536,t&=-t,a.lanes|=t;var C=tB(a,s,t);nF(a,C);break e}}a=a.return}while(a!==null)}_B(r)}catch(T){t=T,un===r&&r!==null&&(un=r=r.return);continue}break}while(1)}function vB(){var e=Ub.current;return Ub.current=$b,e===null?$b:e}function Vk(){(mn===0||mn===3||mn===2)&&(mn=4),xn===null||!(Fc&268435455)&&!(t_&268435455)||ll(xn,jn)}function Vb(e,t){var r=Ht;Ht|=2;var n=vB();(xn!==e||jn!==t)&&(os=null,Cc(e,t));do try{UQ();break}catch(i){mB(e,i)}while(1);if(Ok(),Ht=r,Ub.current=n,un!==null)throw Error(ze(261));return xn=null,jn=0,mn}function UQ(){for(;un!==null;)bB(un)}function zQ(){for(;un!==null&&!gZ();)bB(un)}function bB(e){var t=SB(e.alternate,e,Xi);e.memoizedProps=e.pendingProps,t===null?_B(e):un=t,jk.current=null}function _B(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=DQ(r,t),r!==null){r.flags&=32767,un=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mn=6,un=null;return}}else if(r=FQ(r,t,Xi),r!==null){un=r;return}if(t=t.sibling,t!==null){un=t;return}un=t=e}while(t!==null);mn===0&&(mn=5)}function Ec(e,t,r){var n=sr,i=_a.transition;try{_a.transition=null,sr=1,qQ(e,t,r,n)}finally{_a.transition=i,sr=n}return null}function qQ(e,t,r,n){do Lf();while(ul!==null);if(Ht&6)throw Error(ze(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ze(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(EZ(e,a),e===xn&&(un=xn=null,jn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||fb||(fb=!0,xB(Eb,function(){return Lf(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=_a.transition,_a.transition=null;var o=sr;sr=1;var s=Ht;Ht|=4,jk.current=null,RQ(e,r),hB(r,e),fQ(Bx),Ab=!!Dx,Bx=Dx=null,e.current=r,MQ(r,e,i),yZ(),Ht=s,sr=o,_a.transition=a}else e.current=r;if(fb&&(fb=!1,ul=e,qb=i),a=e.pendingLanes,a===0&&(yl=null),bZ(r.stateNode,n),Bi(e,en()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(zb)throw zb=!1,e=rk,rk=null,e;return qb&1&&e.tag!==0&&Lf(),a=e.pendingLanes,a&1?e===nk?Qh++:(Qh=0,nk=e):Qh=0,xl(),null}function Lf(){if(ul!==null){var e=QF(qb),t=_a.transition,r=sr;try{if(_a.transition=null,sr=16>e?16:e,ul===null)var n=!1;else{if(e=ul,ul=null,qb=0,Ht&6)throw Error(ze(331));var i=Ht;for(Ht|=4,ot=e.current;ot!==null;){var a=ot,o=a.child;if(ot.flags&16){var s=a.deletions;if(s!==null){for(var l=0;l<s.length;l++){var c=s[l];for(ot=c;ot!==null;){var f=ot;switch(f.tag){case 0:case 11:case 15:Xh(8,f,a)}var u=f.child;if(u!==null)u.return=f,ot=u;else for(;ot!==null;){f=ot;var h=f.sibling,g=f.return;if(fB(f),f===c){ot=null;break}if(h!==null){h.return=g,ot=h;break}ot=g}}}var _=a.alternate;if(_!==null){var w=_.child;if(w!==null){_.child=null;do{var E=w.sibling;w.sibling=null,w=E}while(w!==null)}}ot=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,ot=o;else e:for(;ot!==null;){if(a=ot,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Xh(9,a,a.return)}var S=a.sibling;if(S!==null){S.return=a.return,ot=S;break e}ot=a.return}}var A=e.current;for(ot=A;ot!==null;){o=ot;var O=o.child;if(o.subtreeFlags&2064&&O!==null)O.return=o,ot=O;else e:for(o=A;ot!==null;){if(s=ot,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:e_(9,s)}}catch(T){Hr(s,s.return,T)}if(s===o){ot=null;break e}var C=s.sibling;if(C!==null){C.return=s.return,ot=C;break e}ot=s.return}}if(Ht=i,xl(),Oo&&typeof Oo.onPostCommitFiberRoot=="function")try{Oo.onPostCommitFiberRoot(Wb,e)}catch{}n=!0}return n}finally{sr=r,_a.transition=t}}return!1}function EF(e,t,r){t=Mf(r,t),t=eB(e,t,1),e=gl(e,t,1),t=pi(),e!==null&&(mg(e,1,t),Bi(e,t))}function Hr(e,t,r){if(e.tag===3)EF(e,e,r);else for(;t!==null;){if(t.tag===3){EF(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(yl===null||!yl.has(n))){e=Mf(r,e),e=tB(t,e,1),t=gl(t,e,1),e=pi(),t!==null&&(mg(t,1,e),Bi(t,e));break}}t=t.return}}function VQ(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=pi(),e.pingedLanes|=e.suspendedLanes&r,xn===e&&(jn&r)===r&&(mn===4||mn===3&&(jn&130023424)===jn&&500>en()-Uk?Cc(e,0):$k|=r),Bi(e,t)}function wB(e,t){t===0&&(e.mode&1?(t=Xv,Xv<<=1,!(Xv&130023424)&&(Xv=4194304)):t=1);var r=pi();e=hs(e,t),e!==null&&(mg(e,t,r),Bi(e,r))}function HQ(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),wB(e,r)}function WQ(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ze(314))}n!==null&&n.delete(t),wB(e,r)}var SB;SB=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Fi.current)Pi=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Pi=!1,PQ(e,t,r);Pi=!!(e.flags&131072)}else Pi=!1,Pr&&t.flags&1048576&&ED(t,Fb,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;vb(e,t),e=t.pendingProps;var i=Ff(t,Xn.current);Nf(t,r),i=Fk(null,t,n,e,i,r);var a=Dk();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Di(n)?(a=!0,Lb(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Ck(t),i.updater=Zb,t.stateNode=i,i._reactInternals=t,Hx(t,n,e,r),t=Gx(null,t,n,!0,a,r)):(t.tag=0,Pr&&a&&Sk(t),di(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(vb(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=GQ(n),e=qa(n,e),i){case 0:t=Jx(null,t,n,e,r);break e;case 1:t=gF(null,t,n,e,r);break e;case 11:t=pF(null,t,n,e,r);break e;case 14:t=hF(null,t,n,qa(n.type,e),r);break e}throw Error(ze(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:qa(n,i),Jx(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:qa(n,i),gF(e,t,n,i,r);case 3:e:{if(aB(t),e===null)throw Error(ze(387));n=t.pendingProps,a=t.memoizedState,i=a.element,CD(e,t),Rb(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Mf(Error(ze(423)),t),t=yF(e,t,n,r,i);break e}else if(n!==i){i=Mf(Error(ze(424)),t),t=yF(e,t,n,r,i);break e}else for(Zi=hl(t.stateNode.containerInfo.firstChild),Qi=t,Pr=!0,Ha=null,r=PD(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Df(),n===i){t=gs(e,t,r);break e}di(e,t,n,r)}t=t.child}return t;case 5:return FD(t),e===null&&zx(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,Rx(n,i)?o=null:a!==null&&Rx(n,a)&&(t.flags|=32),iB(e,t),di(e,t,o,r),t.child;case 6:return e===null&&zx(t),null;case 13:return oB(e,t,r);case 4:return Tk(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Bf(t,null,n,r):di(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:qa(n,i),pF(e,t,n,i,r);case 7:return di(e,t,t.pendingProps,r),t.child;case 8:return di(e,t,t.pendingProps.children,r),t.child;case 12:return di(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,br(Db,n._currentValue),n._currentValue=o,a!==null)if(Ga(a.value,o)){if(a.children===i.children&&!Fi.current){t=gs(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var s=a.dependencies;if(s!==null){o=a.child;for(var l=s.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=us(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),qx(a.return,r,t),s.lanes|=r;break}l=l.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(ze(341));o.lanes|=r,s=o.alternate,s!==null&&(s.lanes|=r),qx(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}di(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Nf(t,r),i=wa(i),n=n(i),t.flags|=1,di(e,t,n,r),t.child;case 14:return n=t.type,i=qa(n,t.pendingProps),i=qa(n.type,i),hF(e,t,n,i,r);case 15:return rB(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:qa(n,i),vb(e,t),t.tag=1,Di(n)?(e=!0,Lb(t)):e=!1,Nf(t,r),ND(t,n,i),Hx(t,n,i,r),Gx(null,t,n,!0,e,r);case 19:return sB(e,t,r);case 22:return nB(e,t,r)}throw Error(ze(156,t.tag))};function xB(e,t){return YF(e,t)}function JQ(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ba(e,t,r,n){return new JQ(e,t,r,n)}function Hk(e){return e=e.prototype,!(!e||!e.isReactComponent)}function GQ(e){if(typeof e=="function")return Hk(e)?1:0;if(e!=null){if(e=e.$$typeof,e===uk)return 11;if(e===fk)return 14}return 2}function vl(e,t){var r=e.alternate;return r===null?(r=ba(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function wb(e,t,r,n,i,a){var o=2;if(n=e,typeof e=="function")Hk(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case yf:return Tc(r.children,i,a,t);case ck:o=8,i|=8;break;case gx:return e=ba(12,r,t,i|2),e.elementType=gx,e.lanes=a,e;case yx:return e=ba(13,r,t,i),e.elementType=yx,e.lanes=a,e;case mx:return e=ba(19,r,t,i),e.elementType=mx,e.lanes=a,e;case LF:return r_(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case TF:o=10;break e;case NF:o=9;break e;case uk:o=11;break e;case fk:o=14;break e;case al:o=16,n=null;break e}throw Error(ze(130,e==null?e:typeof e,""))}return t=ba(o,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function Tc(e,t,r,n){return e=ba(7,e,n,t),e.lanes=r,e}function r_(e,t,r,n){return e=ba(22,e,n,t),e.elementType=LF,e.lanes=r,e.stateNode={isHidden:!1},e}function dx(e,t,r){return e=ba(6,e,null,t),e.lanes=r,e}function px(e,t,r){return t=ba(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function YQ(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=KS(0),this.expirationTimes=KS(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=KS(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Wk(e,t,r,n,i,a,o,s,l){return e=new YQ(e,t,r,s,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=ba(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ck(a),e}function KQ(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gf,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function kB(e){if(!e)return _l;e=e._reactInternals;e:{if(Rc(e)!==e||e.tag!==1)throw Error(ze(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Di(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ze(171))}if(e.tag===1){var r=e.type;if(Di(r))return xD(e,r,t)}return t}function EB(e,t,r,n,i,a,o,s,l){return e=Wk(r,n,!0,e,i,a,o,s,l),e.context=kB(null),r=e.current,n=pi(),i=ml(r),a=us(n,i),a.callback=t??null,gl(r,a,i),e.current.lanes=i,mg(e,i,n),Bi(e,n),e}function n_(e,t,r,n){var i=t.current,a=pi(),o=ml(i);return r=kB(r),t.context===null?t.context=r:t.pendingContext=r,t=us(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=gl(i,t,o),e!==null&&(Ja(e,i,o,a),gb(e,i,o)),o}function Hb(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function OF(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Jk(e,t){OF(e,t),(e=e.alternate)&&OF(e,t)}function XQ(){return null}var OB=typeof reportError=="function"?reportError:function(e){console.error(e)};function Gk(e){this._internalRoot=e}i_.prototype.render=Gk.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ze(409));n_(e,t,null,null)};i_.prototype.unmount=Gk.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Dc(function(){n_(null,e,null,null)}),t[ps]=null}};function i_(e){this._internalRoot=e}i_.prototype.unstable_scheduleHydration=function(e){if(e){var t=rD();e={blockedOn:null,target:e,priority:t};for(var r=0;r<sl.length&&t!==0&&t<sl[r].priority;r++);sl.splice(r,0,e),r===0&&iD(e)}};function Yk(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function a_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function AF(){}function ZQ(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var c=Hb(o);a.call(c)}}var o=EB(t,n,e,0,null,!1,!1,"",AF);return e._reactRootContainer=o,e[ps]=o.current,lg(e.nodeType===8?e.parentNode:e),Dc(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var s=n;n=function(){var c=Hb(l);s.call(c)}}var l=Wk(e,0,!1,null,null,!1,!1,"",AF);return e._reactRootContainer=l,e[ps]=l.current,lg(e.nodeType===8?e.parentNode:e),Dc(function(){n_(t,l,r,n)}),l}function o_(e,t,r,n,i){var a=r._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var s=i;i=function(){var l=Hb(o);s.call(l)}}n_(t,o,e,i)}else o=ZQ(r,t,e,i,n);return Hb(o)}eD=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=qh(t.pendingLanes);r!==0&&(hk(t,r|1),Bi(t,en()),!(Ht&6)&&(jf=en()+500,xl()))}break;case 13:Dc(function(){var n=hs(e,1);if(n!==null){var i=pi();Ja(n,e,1,i)}}),Jk(e,1)}};gk=function(e){if(e.tag===13){var t=hs(e,134217728);if(t!==null){var r=pi();Ja(t,e,134217728,r)}Jk(e,134217728)}};tD=function(e){if(e.tag===13){var t=ml(e),r=hs(e,t);if(r!==null){var n=pi();Ja(r,e,t,n)}Jk(e,t)}};rD=function(){return sr};nD=function(e,t){var r=sr;try{return sr=e,t()}finally{sr=r}};Ax=function(e,t,r){switch(t){case"input":if(_x(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Kb(n);if(!i)throw Error(ze(90));FF(n),_x(n,i)}}}break;case"textarea":BF(e,r);break;case"select":t=r.value,t!=null&&Af(e,!!r.multiple,t,!1)}};qF=zk;VF=Dc;var QQ={usingClientEntryPoint:!1,Events:[bg,_f,Kb,UF,zF,zk]},jh={findFiberByHostInstance:Oc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},eee={bundleType:jh.bundleType,version:jh.version,rendererPackageName:jh.rendererPackageName,rendererConfig:jh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ys.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=JF(e),e===null?null:e.stateNode},findFiberByHostInstance:jh.findFiberByHostInstance||XQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&($h=__REACT_DEVTOOLS_GLOBAL_HOOK__,!$h.isDisabled&&$h.supportsFiber))try{Wb=$h.inject(eee),Oo=$h}catch{}var $h;ra.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QQ;ra.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yk(t))throw Error(ze(200));return KQ(e,t,null,r)};ra.createRoot=function(e,t){if(!Yk(e))throw Error(ze(299));var r=!1,n="",i=OB;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Wk(e,1,!1,null,null,r,!1,n,i),e[ps]=t.current,lg(e.nodeType===8?e.parentNode:e),new Gk(t)};ra.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ze(188)):(e=Object.keys(e).join(","),Error(ze(268,e)));return e=JF(t),e=e===null?null:e.stateNode,e};ra.flushSync=function(e){return Dc(e)};ra.hydrate=function(e,t,r){if(!a_(t))throw Error(ze(200));return o_(null,e,t,!0,r)};ra.hydrateRoot=function(e,t,r){if(!Yk(e))throw Error(ze(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",o=OB;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=EB(t,null,e,1,r??null,i,!1,a,o),e[ps]=t.current,lg(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new i_(t)};ra.render=function(e,t,r){if(!a_(t))throw Error(ze(200));return o_(null,e,t,!1,r)};ra.unmountComponentAtNode=function(e){if(!a_(e))throw Error(ze(40));return e._reactRootContainer?(Dc(function(){o_(null,null,e,!1,function(){e._reactRootContainer=null,e[ps]=null})}),!0):!1};ra.unstable_batchedUpdates=zk;ra.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!a_(r))throw Error(ze(200));if(e==null||e._reactInternals===void 0)throw Error(ze(38));return o_(e,t,r,!1,n)};ra.version="18.2.0-next-9e3b772b8-20220608"});var Io=ce((KIe,CB)=>{"use strict";function IB(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(IB)}catch(e){console.error(e)}}IB(),CB.exports=AB()});var NB=ce(Kk=>{"use strict";var TB=Io();Kk.createRoot=TB.createRoot,Kk.hydrateRoot=TB.hydrateRoot;var XIe});var JR=ce(C_=>{"use strict";var fre=He(),dre=Symbol.for("react.element"),pre=Symbol.for("react.fragment"),hre=Object.prototype.hasOwnProperty,gre=fre.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yre={key:!0,ref:!0,__self:!0,__source:!0};function WR(e,t,r){var n,i={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)hre.call(t,n)&&!yre.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:dre,type:e,key:a,ref:o,props:i,_owner:gre.current}}C_.Fragment=pre;C_.jsx=WR;C_.jsxs=WR});var mt=ce((DTe,GR)=>{"use strict";GR.exports=JR()});var qr=ce((N3e,R_)=>{(function(){"use strict";var e={}.hasOwnProperty,t="[native code]";function r(){for(var n=[],i=0;i<arguments.length;i++){var a=arguments[i];if(a){var o=typeof a;if(o==="string"||o==="number")n.push(a);else if(Array.isArray(a)){if(a.length){var s=r.apply(null,a);s&&n.push(s)}}else if(o==="object"){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){n.push(a.toString());continue}for(var l in a)e.call(a,l)&&a[l]&&n.push(l)}}}return n.join(" ")}typeof R_<"u"&&R_.exports?(r.default=r,R_.exports=r):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return r}):window.classNames=r})()});var Oa=ce((L3e,sM)=>{function Qre(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}sM.exports=Qre});var JE=ce((P3e,lM)=>{var ene=typeof global=="object"&&global&&global.Object===Object&&global;lM.exports=ene});var Qa=ce((F3e,cM)=>{var tne=JE(),rne=typeof self=="object"&&self&&self.Object===Object&&self,nne=tne||rne||Function("return this")();cM.exports=nne});var rd=ce((D3e,uM)=>{var ine=Qa(),ane=ine.Symbol;uM.exports=ane});var hM=ce((B3e,pM)=>{var fM=rd(),dM=Object.prototype,one=dM.hasOwnProperty,sne=dM.toString,Rg=fM?fM.toStringTag:void 0;function lne(e){var t=one.call(e,Rg),r=e[Rg];try{e[Rg]=void 0;var n=!0}catch{}var i=sne.call(e);return n&&(t?e[Rg]=r:delete e[Rg]),i}pM.exports=lne});var yM=ce((R3e,gM)=>{var cne=Object.prototype,une=cne.toString;function fne(e){return une.call(e)}gM.exports=fne});var Es=ce((M3e,bM)=>{var mM=rd(),dne=hM(),pne=yM(),hne="[object Null]",gne="[object Undefined]",vM=mM?mM.toStringTag:void 0;function yne(e){return e==null?e===void 0?gne:hne:vM&&vM in Object(e)?dne(e):pne(e)}bM.exports=yne});var fn=ce((j3e,_M)=>{var mne=Es(),vne=Oa(),bne="[object AsyncFunction]",_ne="[object Function]",wne="[object GeneratorFunction]",Sne="[object Proxy]";function xne(e){if(!vne(e))return!1;var t=mne(e);return t==_ne||t==wne||t==bne||t==Sne}_M.exports=xne});var Vr=ce(($3e,wM)=>{var kne=Array.isArray;wM.exports=kne});var Os=ce((U3e,SM)=>{function Ene(e){return e!=null&&typeof e=="object"}SM.exports=Ene});var M_=ce((z3e,xM)=>{var One=Es(),Ane=Vr(),Ine=Os(),Cne="[object String]";function Tne(e){return typeof e=="string"||!Ane(e)&&Ine(e)&&One(e)==Cne}xM.exports=Tne});var Wc=ce((q3e,kM)=>{var Nne=Es(),Lne=Os(),Pne="[object Symbol]";function Fne(e){return typeof e=="symbol"||Lne(e)&&Nne(e)==Pne}kM.exports=Fne});var j_=ce((V3e,EM)=>{var Dne=Vr(),Bne=Wc(),Rne=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Mne=/^\w*$/;function jne(e,t){if(Dne(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Bne(e)?!0:Mne.test(e)||!Rne.test(e)||t!=null&&e in Object(t)}EM.exports=jne});var AM=ce((H3e,OM)=>{var $ne=Qa(),Une=$ne["__core-js_shared__"];OM.exports=Une});var TM=ce((W3e,CM)=>{var GE=AM(),IM=function(){var e=/[^.]+$/.exec(GE&&GE.keys&&GE.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function zne(e){return!!IM&&IM in e}CM.exports=zne});var YE=ce((J3e,NM)=>{var qne=Function.prototype,Vne=qne.toString;function Hne(e){if(e!=null){try{return Vne.call(e)}catch{}try{return e+""}catch{}}return""}NM.exports=Hne});var PM=ce((G3e,LM)=>{var Wne=fn(),Jne=TM(),Gne=Oa(),Yne=YE(),Kne=/[\\^$.*+?()[\]{}|]/g,Xne=/^\[object .+?Constructor\]$/,Zne=Function.prototype,Qne=Object.prototype,eie=Zne.toString,tie=Qne.hasOwnProperty,rie=RegExp("^"+eie.call(tie).replace(Kne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function nie(e){if(!Gne(e)||Jne(e))return!1;var t=Wne(e)?rie:Xne;return t.test(Yne(e))}LM.exports=nie});var DM=ce((Y3e,FM)=>{function iie(e,t){return e?.[t]}FM.exports=iie});var Cl=ce((K3e,BM)=>{var aie=PM(),oie=DM();function sie(e,t){var r=oie(e,t);return aie(r)?r:void 0}BM.exports=sie});var Mg=ce((X3e,RM)=>{var lie=Cl(),cie=lie(Object,"create");RM.exports=cie});var $M=ce((Z3e,jM)=>{var MM=Mg();function uie(){this.__data__=MM?MM(null):{},this.size=0}jM.exports=uie});var zM=ce((Q3e,UM)=>{function fie(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}UM.exports=fie});var VM=ce((eNe,qM)=>{var die=Mg(),pie="__lodash_hash_undefined__",hie=Object.prototype,gie=hie.hasOwnProperty;function yie(e){var t=this.__data__;if(die){var r=t[e];return r===pie?void 0:r}return gie.call(t,e)?t[e]:void 0}qM.exports=yie});var WM=ce((tNe,HM)=>{var mie=Mg(),vie=Object.prototype,bie=vie.hasOwnProperty;function _ie(e){var t=this.__data__;return mie?t[e]!==void 0:bie.call(t,e)}HM.exports=_ie});var GM=ce((rNe,JM)=>{var wie=Mg(),Sie="__lodash_hash_undefined__";function xie(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=wie&&t===void 0?Sie:t,this}JM.exports=xie});var KM=ce((nNe,YM)=>{var kie=$M(),Eie=zM(),Oie=VM(),Aie=WM(),Iie=GM();function nd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}nd.prototype.clear=kie;nd.prototype.delete=Eie;nd.prototype.get=Oie;nd.prototype.has=Aie;nd.prototype.set=Iie;YM.exports=nd});var ZM=ce((iNe,XM)=>{function Cie(){this.__data__=[],this.size=0}XM.exports=Cie});var $_=ce((aNe,QM)=>{function Tie(e,t){return e===t||e!==e&&t!==t}QM.exports=Tie});var jg=ce((oNe,ej)=>{var Nie=$_();function Lie(e,t){for(var r=e.length;r--;)if(Nie(e[r][0],t))return r;return-1}ej.exports=Lie});var rj=ce((sNe,tj)=>{var Pie=jg(),Fie=Array.prototype,Die=Fie.splice;function Bie(e){var t=this.__data__,r=Pie(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Die.call(t,r,1),--this.size,!0}tj.exports=Bie});var ij=ce((lNe,nj)=>{var Rie=jg();function Mie(e){var t=this.__data__,r=Rie(t,e);return r<0?void 0:t[r][1]}nj.exports=Mie});var oj=ce((cNe,aj)=>{var jie=jg();function $ie(e){return jie(this.__data__,e)>-1}aj.exports=$ie});var lj=ce((uNe,sj)=>{var Uie=jg();function zie(e,t){var r=this.__data__,n=Uie(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}sj.exports=zie});var $g=ce((fNe,cj)=>{var qie=ZM(),Vie=rj(),Hie=ij(),Wie=oj(),Jie=lj();function id(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}id.prototype.clear=qie;id.prototype.delete=Vie;id.prototype.get=Hie;id.prototype.has=Wie;id.prototype.set=Jie;cj.exports=id});var U_=ce((dNe,uj)=>{var Gie=Cl(),Yie=Qa(),Kie=Gie(Yie,"Map");uj.exports=Kie});var pj=ce((pNe,dj)=>{var fj=KM(),Xie=$g(),Zie=U_();function Qie(){this.size=0,this.__data__={hash:new fj,map:new(Zie||Xie),string:new fj}}dj.exports=Qie});var gj=ce((hNe,hj)=>{function eae(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}hj.exports=eae});var Ug=ce((gNe,yj)=>{var tae=gj();function rae(e,t){var r=e.__data__;return tae(t)?r[typeof t=="string"?"string":"hash"]:r.map}yj.exports=rae});var vj=ce((yNe,mj)=>{var nae=Ug();function iae(e){var t=nae(this,e).delete(e);return this.size-=t?1:0,t}mj.exports=iae});var _j=ce((mNe,bj)=>{var aae=Ug();function oae(e){return aae(this,e).get(e)}bj.exports=oae});var Sj=ce((vNe,wj)=>{var sae=Ug();function lae(e){return sae(this,e).has(e)}wj.exports=lae});var kj=ce((bNe,xj)=>{var cae=Ug();function uae(e,t){var r=cae(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}xj.exports=uae});var z_=ce((_Ne,Ej)=>{var fae=pj(),dae=vj(),pae=_j(),hae=Sj(),gae=kj();function ad(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ad.prototype.clear=fae;ad.prototype.delete=dae;ad.prototype.get=pae;ad.prototype.has=hae;ad.prototype.set=gae;Ej.exports=ad});var Ij=ce((wNe,Aj)=>{var Oj=z_(),yae="Expected a function";function KE(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(yae);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var o=e.apply(this,n);return r.cache=a.set(i,o)||a,o};return r.cache=new(KE.Cache||Oj),r}KE.Cache=Oj;Aj.exports=KE});var Tj=ce((SNe,Cj)=>{var mae=Ij(),vae=500;function bae(e){var t=mae(e,function(n){return r.size===vae&&r.clear(),n}),r=t.cache;return t}Cj.exports=bae});var Lj=ce((xNe,Nj)=>{var _ae=Tj(),wae=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sae=/\\(\\)?/g,xae=_ae(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(wae,function(r,n,i,a){t.push(i?a.replace(Sae,"$1"):n||r)}),t});Nj.exports=xae});var q_=ce((kNe,Pj)=>{function kae(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}Pj.exports=kae});var jj=ce((ENe,Mj)=>{var Fj=rd(),Eae=q_(),Oae=Vr(),Aae=Wc(),Iae=1/0,Dj=Fj?Fj.prototype:void 0,Bj=Dj?Dj.toString:void 0;function Rj(e){if(typeof e=="string")return e;if(Oae(e))return Eae(e,Rj)+"";if(Aae(e))return Bj?Bj.call(e):"";var t=e+"";return t=="0"&&1/e==-Iae?"-0":t}Mj.exports=Rj});var XE=ce((ONe,$j)=>{var Cae=jj();function Tae(e){return e==null?"":Cae(e)}$j.exports=Tae});var ZE=ce((ANe,Uj)=>{var Nae=Vr(),Lae=j_(),Pae=Lj(),Fae=XE();function Dae(e,t){return Nae(e)?e:Lae(e,t)?[e]:Pae(Fae(e))}Uj.exports=Dae});var zg=ce((INe,zj)=>{var Bae=Wc(),Rae=1/0;function Mae(e){if(typeof e=="string"||Bae(e))return e;var t=e+"";return t=="0"&&1/e==-Rae?"-0":t}zj.exports=Mae});var V_=ce((CNe,qj)=>{var jae=ZE(),$ae=zg();function Uae(e,t){t=jae(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[$ae(t[r++])];return r&&r==n?e:void 0}qj.exports=Uae});var Jc=ce((TNe,Vj)=>{var zae=V_();function qae(e,t,r){var n=e==null?void 0:zae(e,t);return n===void 0?r:n}Vj.exports=qae});var Aa=ce((NNe,Hj)=>{function Vae(e){return e==null}Hj.exports=Vae});var Jj=ce(cr=>{"use strict";var On=typeof Symbol=="function"&&Symbol.for,QE=On?Symbol.for("react.element"):60103,eO=On?Symbol.for("react.portal"):60106,H_=On?Symbol.for("react.fragment"):60107,W_=On?Symbol.for("react.strict_mode"):60108,J_=On?Symbol.for("react.profiler"):60114,G_=On?Symbol.for("react.provider"):60109,Y_=On?Symbol.for("react.context"):60110,tO=On?Symbol.for("react.async_mode"):60111,K_=On?Symbol.for("react.concurrent_mode"):60111,X_=On?Symbol.for("react.forward_ref"):60112,Z_=On?Symbol.for("react.suspense"):60113,Hae=On?Symbol.for("react.suspense_list"):60120,Q_=On?Symbol.for("react.memo"):60115,e0=On?Symbol.for("react.lazy"):60116,Wae=On?Symbol.for("react.block"):60121,Jae=On?Symbol.for("react.fundamental"):60117,Gae=On?Symbol.for("react.responder"):60118,Yae=On?Symbol.for("react.scope"):60119;function na(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case QE:switch(e=e.type,e){case tO:case K_:case H_:case J_:case W_:case Z_:return e;default:switch(e=e&&e.$$typeof,e){case Y_:case X_:case e0:case Q_:case G_:return e;default:return t}}case eO:return t}}}function Wj(e){return na(e)===K_}cr.AsyncMode=tO;cr.ConcurrentMode=K_;cr.ContextConsumer=Y_;cr.ContextProvider=G_;cr.Element=QE;cr.ForwardRef=X_;cr.Fragment=H_;cr.Lazy=e0;cr.Memo=Q_;cr.Portal=eO;cr.Profiler=J_;cr.StrictMode=W_;cr.Suspense=Z_;cr.isAsyncMode=function(e){return Wj(e)||na(e)===tO};cr.isConcurrentMode=Wj;cr.isContextConsumer=function(e){return na(e)===Y_};cr.isContextProvider=function(e){return na(e)===G_};cr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===QE};cr.isForwardRef=function(e){return na(e)===X_};cr.isFragment=function(e){return na(e)===H_};cr.isLazy=function(e){return na(e)===e0};cr.isMemo=function(e){return na(e)===Q_};cr.isPortal=function(e){return na(e)===eO};cr.isProfiler=function(e){return na(e)===J_};cr.isStrictMode=function(e){return na(e)===W_};cr.isSuspense=function(e){return na(e)===Z_};cr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===H_||e===K_||e===J_||e===W_||e===Z_||e===Hae||typeof e=="object"&&e!==null&&(e.$$typeof===e0||e.$$typeof===Q_||e.$$typeof===G_||e.$$typeof===Y_||e.$$typeof===X_||e.$$typeof===Jae||e.$$typeof===Gae||e.$$typeof===Yae||e.$$typeof===Wae)};cr.typeOf=na});var Yj=ce((PNe,Gj)=>{"use strict";Gj.exports=Jj()});var rO=ce((FNe,Kj)=>{var Kae=Es(),Xae=Os(),Zae="[object Number]";function Qae(e){return typeof e=="number"||Xae(e)&&Kae(e)==Zae}Kj.exports=Qae});var nO=ce((DNe,Xj)=>{var eoe=rO();function toe(e){return eoe(e)&&e!=+e}Xj.exports=toe});var v4=ce((JNe,m4)=>{var moe=$g();function voe(){this.__data__=new moe,this.size=0}m4.exports=voe});var _4=ce((GNe,b4)=>{function boe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}b4.exports=boe});var S4=ce((YNe,w4)=>{function _oe(e){return this.__data__.get(e)}w4.exports=_oe});var k4=ce((KNe,x4)=>{function woe(e){return this.__data__.has(e)}x4.exports=woe});var O4=ce((XNe,E4)=>{var Soe=$g(),xoe=U_(),koe=z_(),Eoe=200;function Ooe(e,t){var r=this.__data__;if(r instanceof Soe){var n=r.__data__;if(!xoe||n.length<Eoe-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new koe(n)}return r.set(e,t),this.size=r.size,this}E4.exports=Ooe});var yO=ce((ZNe,A4)=>{var Aoe=$g(),Ioe=v4(),Coe=_4(),Toe=S4(),Noe=k4(),Loe=O4();function cd(e){var t=this.__data__=new Aoe(e);this.size=t.size}cd.prototype.clear=Ioe;cd.prototype.delete=Coe;cd.prototype.get=Toe;cd.prototype.has=Noe;cd.prototype.set=Loe;A4.exports=cd});var C4=ce((QNe,I4)=>{var Poe="__lodash_hash_undefined__";function Foe(e){return this.__data__.set(e,Poe),this}I4.exports=Foe});var N4=ce((eLe,T4)=>{function Doe(e){return this.__data__.has(e)}T4.exports=Doe});var mO=ce((tLe,L4)=>{var Boe=z_(),Roe=C4(),Moe=N4();function a0(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Boe;++t<r;)this.add(e[t])}a0.prototype.add=a0.prototype.push=Roe;a0.prototype.has=Moe;L4.exports=a0});var vO=ce((rLe,P4)=>{function joe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}P4.exports=joe});var bO=ce((nLe,F4)=>{function $oe(e,t){return e.has(t)}F4.exports=$oe});var _O=ce((iLe,D4)=>{var Uoe=mO(),zoe=vO(),qoe=bO(),Voe=1,Hoe=2;function Woe(e,t,r,n,i,a){var o=r&Voe,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var c=a.get(e),f=a.get(t);if(c&&f)return c==t&&f==e;var u=-1,h=!0,g=r&Hoe?new Uoe:void 0;for(a.set(e,t),a.set(t,e);++u<s;){var _=e[u],w=t[u];if(n)var E=o?n(w,_,u,t,e,a):n(_,w,u,e,t,a);if(E!==void 0){if(E)continue;h=!1;break}if(g){if(!zoe(t,function(S,A){if(!qoe(g,A)&&(_===S||i(_,S,r,n,a)))return g.push(A)})){h=!1;break}}else if(!(_===w||i(_,w,r,n,a))){h=!1;break}}return a.delete(e),a.delete(t),h}D4.exports=Woe});var R4=ce((aLe,B4)=>{var Joe=Qa(),Goe=Joe.Uint8Array;B4.exports=Goe});var j4=ce((oLe,M4)=>{function Yoe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}M4.exports=Yoe});var o0=ce((sLe,$4)=>{function Koe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}$4.exports=Koe});var H4=ce((lLe,V4)=>{var U4=rd(),z4=R4(),Xoe=$_(),Zoe=_O(),Qoe=j4(),ese=o0(),tse=1,rse=2,nse="[object Boolean]",ise="[object Date]",ase="[object Error]",ose="[object Map]",sse="[object Number]",lse="[object RegExp]",cse="[object Set]",use="[object String]",fse="[object Symbol]",dse="[object ArrayBuffer]",pse="[object DataView]",q4=U4?U4.prototype:void 0,wO=q4?q4.valueOf:void 0;function hse(e,t,r,n,i,a,o){switch(r){case pse:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case dse:return!(e.byteLength!=t.byteLength||!a(new z4(e),new z4(t)));case nse:case ise:case sse:return Xoe(+e,+t);case ase:return e.name==t.name&&e.message==t.message;case lse:case use:return e==t+"";case ose:var s=Qoe;case cse:var l=n&tse;if(s||(s=ese),e.size!=t.size&&!l)return!1;var c=o.get(e);if(c)return c==t;n|=rse,o.set(e,t);var f=Zoe(s(e),s(t),n,i,a,o);return o.delete(e),f;case fse:if(wO)return wO.call(e)==wO.call(t)}return!1}V4.exports=hse});var SO=ce((cLe,W4)=>{function gse(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}W4.exports=gse});var G4=ce((uLe,J4)=>{var yse=SO(),mse=Vr();function vse(e,t,r){var n=t(e);return mse(e)?n:yse(n,r(e))}J4.exports=vse});var K4=ce((fLe,Y4)=>{function bse(e,t){for(var r=-1,n=e==null?0:e.length,i=0,a=[];++r<n;){var o=e[r];t(o,r,e)&&(a[i++]=o)}return a}Y4.exports=bse});var Z4=ce((dLe,X4)=>{function _se(){return[]}X4.exports=_se});var t5=ce((pLe,e5)=>{var wse=K4(),Sse=Z4(),xse=Object.prototype,kse=xse.propertyIsEnumerable,Q4=Object.getOwnPropertySymbols,Ese=Q4?function(e){return e==null?[]:(e=Object(e),wse(Q4(e),function(t){return kse.call(e,t)}))}:Sse;e5.exports=Ese});var n5=ce((hLe,r5)=>{function Ose(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}r5.exports=Ose});var a5=ce((gLe,i5)=>{var Ase=Es(),Ise=Os(),Cse="[object Arguments]";function Tse(e){return Ise(e)&&Ase(e)==Cse}i5.exports=Tse});var s0=ce((yLe,l5)=>{var o5=a5(),Nse=Os(),s5=Object.prototype,Lse=s5.hasOwnProperty,Pse=s5.propertyIsEnumerable,Fse=o5(function(){return arguments}())?o5:function(e){return Nse(e)&&Lse.call(e,"callee")&&!Pse.call(e,"callee")};l5.exports=Fse});var u5=ce((mLe,c5)=>{function Dse(){return!1}c5.exports=Dse});var xO=ce((Vg,ud)=>{var Bse=Qa(),Rse=u5(),p5=typeof Vg=="object"&&Vg&&!Vg.nodeType&&Vg,f5=p5&&typeof ud=="object"&&ud&&!ud.nodeType&&ud,Mse=f5&&f5.exports===p5,d5=Mse?Bse.Buffer:void 0,jse=d5?d5.isBuffer:void 0,$se=jse||Rse;ud.exports=$se});var l0=ce((vLe,h5)=>{var Use=9007199254740991,zse=/^(?:0|[1-9]\d*)$/;function qse(e,t){var r=typeof e;return t=t??Use,!!t&&(r=="number"||r!="symbol"&&zse.test(e))&&e>-1&&e%1==0&&e<t}h5.exports=qse});var c0=ce((bLe,g5)=>{var Vse=9007199254740991;function Hse(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Vse}g5.exports=Hse});var m5=ce((_Le,y5)=>{var Wse=Es(),Jse=c0(),Gse=Os(),Yse="[object Arguments]",Kse="[object Array]",Xse="[object Boolean]",Zse="[object Date]",Qse="[object Error]",ele="[object Function]",tle="[object Map]",rle="[object Number]",nle="[object Object]",ile="[object RegExp]",ale="[object Set]",ole="[object String]",sle="[object WeakMap]",lle="[object ArrayBuffer]",cle="[object DataView]",ule="[object Float32Array]",fle="[object Float64Array]",dle="[object Int8Array]",ple="[object Int16Array]",hle="[object Int32Array]",gle="[object Uint8Array]",yle="[object Uint8ClampedArray]",mle="[object Uint16Array]",vle="[object Uint32Array]",Cr={};Cr[ule]=Cr[fle]=Cr[dle]=Cr[ple]=Cr[hle]=Cr[gle]=Cr[yle]=Cr[mle]=Cr[vle]=!0;Cr[Yse]=Cr[Kse]=Cr[lle]=Cr[Xse]=Cr[cle]=Cr[Zse]=Cr[Qse]=Cr[ele]=Cr[tle]=Cr[rle]=Cr[nle]=Cr[ile]=Cr[ale]=Cr[ole]=Cr[sle]=!1;function ble(e){return Gse(e)&&Jse(e.length)&&!!Cr[Wse(e)]}y5.exports=ble});var kO=ce((wLe,v5)=>{function _le(e){return function(t){return e(t)}}v5.exports=_le});var _5=ce((Hg,fd)=>{var wle=JE(),b5=typeof Hg=="object"&&Hg&&!Hg.nodeType&&Hg,Wg=b5&&typeof fd=="object"&&fd&&!fd.nodeType&&fd,Sle=Wg&&Wg.exports===b5,EO=Sle&&wle.process,xle=function(){try{var e=Wg&&Wg.require&&Wg.require("util").types;return e||EO&&EO.binding&&EO.binding("util")}catch{}}();fd.exports=xle});var OO=ce((SLe,x5)=>{var kle=m5(),Ele=kO(),w5=_5(),S5=w5&&w5.isTypedArray,Ole=S5?Ele(S5):kle;x5.exports=Ole});var E5=ce((xLe,k5)=>{var Ale=n5(),Ile=s0(),Cle=Vr(),Tle=xO(),Nle=l0(),Lle=OO(),Ple=Object.prototype,Fle=Ple.hasOwnProperty;function Dle(e,t){var r=Cle(e),n=!r&&Ile(e),i=!r&&!n&&Tle(e),a=!r&&!n&&!i&&Lle(e),o=r||n||i||a,s=o?Ale(e.length,String):[],l=s.length;for(var c in e)(t||Fle.call(e,c))&&!(o&&(c=="length"||i&&(c=="offset"||c=="parent")||a&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Nle(c,l)))&&s.push(c);return s}k5.exports=Dle});var A5=ce((kLe,O5)=>{var Ble=Object.prototype;function Rle(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Ble;return e===r}O5.exports=Rle});var C5=ce((ELe,I5)=>{function Mle(e,t){return function(r){return e(t(r))}}I5.exports=Mle});var N5=ce((OLe,T5)=>{var jle=C5(),$le=jle(Object.keys,Object);T5.exports=$le});var P5=ce((ALe,L5)=>{var Ule=A5(),zle=N5(),qle=Object.prototype,Vle=qle.hasOwnProperty;function Hle(e){if(!Ule(e))return zle(e);var t=[];for(var r in Object(e))Vle.call(e,r)&&r!="constructor"&&t.push(r);return t}L5.exports=Hle});var dd=ce((ILe,F5)=>{var Wle=fn(),Jle=c0();function Gle(e){return e!=null&&Jle(e.length)&&!Wle(e)}F5.exports=Gle});var Jg=ce((CLe,D5)=>{var Yle=E5(),Kle=P5(),Xle=dd();function Zle(e){return Xle(e)?Yle(e):Kle(e)}D5.exports=Zle});var R5=ce((TLe,B5)=>{var Qle=G4(),ece=t5(),tce=Jg();function rce(e){return Qle(e,tce,ece)}B5.exports=rce});var $5=ce((NLe,j5)=>{var M5=R5(),nce=1,ice=Object.prototype,ace=ice.hasOwnProperty;function oce(e,t,r,n,i,a){var o=r&nce,s=M5(e),l=s.length,c=M5(t),f=c.length;if(l!=f&&!o)return!1;for(var u=l;u--;){var h=s[u];if(!(o?h in t:ace.call(t,h)))return!1}var g=a.get(e),_=a.get(t);if(g&&_)return g==t&&_==e;var w=!0;a.set(e,t),a.set(t,e);for(var E=o;++u<l;){h=s[u];var S=e[h],A=t[h];if(n)var O=o?n(A,S,h,t,e,a):n(S,A,h,e,t,a);if(!(O===void 0?S===A||i(S,A,r,n,a):O)){w=!1;break}E||(E=h=="constructor")}if(w&&!E){var C=e.constructor,T=t.constructor;C!=T&&"constructor"in e&&"constructor"in t&&!(typeof C=="function"&&C instanceof C&&typeof T=="function"&&T instanceof T)&&(w=!1)}return a.delete(e),a.delete(t),w}j5.exports=oce});var z5=ce((LLe,U5)=>{var sce=Cl(),lce=Qa(),cce=sce(lce,"DataView");U5.exports=cce});var V5=ce((PLe,q5)=>{var uce=Cl(),fce=Qa(),dce=uce(fce,"Promise");q5.exports=dce});var AO=ce((FLe,H5)=>{var pce=Cl(),hce=Qa(),gce=pce(hce,"Set");H5.exports=gce});var J5=ce((DLe,W5)=>{var yce=Cl(),mce=Qa(),vce=yce(mce,"WeakMap");W5.exports=vce});var t6=ce((BLe,e6)=>{var IO=z5(),CO=U_(),TO=V5(),NO=AO(),LO=J5(),Q5=Es(),pd=YE(),G5="[object Map]",bce="[object Object]",Y5="[object Promise]",K5="[object Set]",X5="[object WeakMap]",Z5="[object DataView]",_ce=pd(IO),wce=pd(CO),Sce=pd(TO),xce=pd(NO),kce=pd(LO),Xc=Q5;(IO&&Xc(new IO(new ArrayBuffer(1)))!=Z5||CO&&Xc(new CO)!=G5||TO&&Xc(TO.resolve())!=Y5||NO&&Xc(new NO)!=K5||LO&&Xc(new LO)!=X5)&&(Xc=function(e){var t=Q5(e),r=t==bce?e.constructor:void 0,n=r?pd(r):"";if(n)switch(n){case _ce:return Z5;case wce:return G5;case Sce:return Y5;case xce:return K5;case kce:return X5}return t});e6.exports=Xc});var c6=ce((RLe,l6)=>{var PO=yO(),Ece=_O(),Oce=H4(),Ace=$5(),r6=t6(),n6=Vr(),i6=xO(),Ice=OO(),Cce=1,a6="[object Arguments]",o6="[object Array]",u0="[object Object]",Tce=Object.prototype,s6=Tce.hasOwnProperty;function Nce(e,t,r,n,i,a){var o=n6(e),s=n6(t),l=o?o6:r6(e),c=s?o6:r6(t);l=l==a6?u0:l,c=c==a6?u0:c;var f=l==u0,u=c==u0,h=l==c;if(h&&i6(e)){if(!i6(t))return!1;o=!0,f=!1}if(h&&!f)return a||(a=new PO),o||Ice(e)?Ece(e,t,r,n,i,a):Oce(e,t,l,r,n,i,a);if(!(r&Cce)){var g=f&&s6.call(e,"__wrapped__"),_=u&&s6.call(t,"__wrapped__");if(g||_){var w=g?e.value():e,E=_?t.value():t;return a||(a=new PO),i(w,E,r,n,a)}}return h?(a||(a=new PO),Ace(e,t,r,n,i,a)):!1}l6.exports=Nce});var f0=ce((MLe,d6)=>{var Lce=c6(),u6=Os();function f6(e,t,r,n,i){return e===t?!0:e==null||t==null||!u6(e)&&!u6(t)?e!==e&&t!==t:Lce(e,t,r,n,f6,i)}d6.exports=f6});var h6=ce((jLe,p6)=>{var Pce=yO(),Fce=f0(),Dce=1,Bce=2;function Rce(e,t,r,n){var i=r.length,a=i,o=!n;if(e==null)return!a;for(e=Object(e);i--;){var s=r[i];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<a;){s=r[i];var l=s[0],c=e[l],f=s[1];if(o&&s[2]){if(c===void 0&&!(l in e))return!1}else{var u=new Pce;if(n)var h=n(c,f,l,e,t,u);if(!(h===void 0?Fce(f,c,Dce|Bce,n,u):h))return!1}}return!0}p6.exports=Rce});var FO=ce(($Le,g6)=>{var Mce=Oa();function jce(e){return e===e&&!Mce(e)}g6.exports=jce});var m6=ce((ULe,y6)=>{var $ce=FO(),Uce=Jg();function zce(e){for(var t=Uce(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,$ce(i)]}return t}y6.exports=zce});var DO=ce((zLe,v6)=>{function qce(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}v6.exports=qce});var _6=ce((qLe,b6)=>{var Vce=h6(),Hce=m6(),Wce=DO();function Jce(e){var t=Hce(e);return t.length==1&&t[0][2]?Wce(t[0][0],t[0][1]):function(r){return r===e||Vce(r,e,t)}}b6.exports=Jce});var S6=ce((VLe,w6)=>{function Gce(e,t){return e!=null&&t in Object(e)}w6.exports=Gce});var k6=ce((HLe,x6)=>{var Yce=ZE(),Kce=s0(),Xce=Vr(),Zce=l0(),Qce=c0(),eue=zg();function tue(e,t,r){t=Yce(t,e);for(var n=-1,i=t.length,a=!1;++n<i;){var o=eue(t[n]);if(!(a=e!=null&&r(e,o)))break;e=e[o]}return a||++n!=i?a:(i=e==null?0:e.length,!!i&&Qce(i)&&Zce(o,i)&&(Xce(e)||Kce(e)))}x6.exports=tue});var O6=ce((WLe,E6)=>{var rue=S6(),nue=k6();function iue(e,t){return e!=null&&nue(e,t,rue)}E6.exports=iue});var I6=ce((JLe,A6)=>{var aue=f0(),oue=Jc(),sue=O6(),lue=j_(),cue=FO(),uue=DO(),fue=zg(),due=1,pue=2;function hue(e,t){return lue(e)&&cue(t)?uue(fue(e),t):function(r){var n=oue(r,e);return n===void 0&&n===t?sue(r,e):aue(t,n,due|pue)}}A6.exports=hue});var Zc=ce((GLe,C6)=>{function gue(e){return e}C6.exports=gue});var N6=ce((YLe,T6)=>{function yue(e){return function(t){return t?.[e]}}T6.exports=yue});var P6=ce((KLe,L6)=>{var mue=V_();function vue(e){return function(t){return mue(t,e)}}L6.exports=vue});var D6=ce((XLe,F6)=>{var bue=N6(),_ue=P6(),wue=j_(),Sue=zg();function xue(e){return wue(e)?bue(Sue(e)):_ue(e)}F6.exports=xue});var Ts=ce((ZLe,B6)=>{var kue=_6(),Eue=I6(),Oue=Zc(),Aue=Vr(),Iue=D6();function Cue(e){return typeof e=="function"?e:e==null?Oue:typeof e=="object"?Aue(e)?Eue(e[0],e[1]):kue(e):Iue(e)}B6.exports=Cue});var BO=ce((QLe,R6)=>{function Tue(e,t,r,n){for(var i=e.length,a=r+(n?1:-1);n?a--:++a<i;)if(t(e[a],a,e))return a;return-1}R6.exports=Tue});var j6=ce((ePe,M6)=>{function Nue(e){return e!==e}M6.exports=Nue});var U6=ce((tPe,$6)=>{function Lue(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}$6.exports=Lue});var q6=ce((rPe,z6)=>{var Pue=BO(),Fue=j6(),Due=U6();function Bue(e,t,r){return t===t?Due(e,t,r):Pue(e,Fue,r)}z6.exports=Bue});var H6=ce((nPe,V6)=>{var Rue=q6();function Mue(e,t){var r=e==null?0:e.length;return!!r&&Rue(e,t,0)>-1}V6.exports=Mue});var J6=ce((iPe,W6)=>{function jue(e,t,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}W6.exports=jue});var Y6=ce((aPe,G6)=>{function $ue(){}G6.exports=$ue});var X6=ce((oPe,K6)=>{var RO=AO(),Uue=Y6(),zue=o0(),que=1/0,Vue=RO&&1/zue(new RO([,-0]))[1]==que?function(e){return new RO(e)}:Uue;K6.exports=Vue});var Q6=ce((sPe,Z6)=>{var Hue=mO(),Wue=H6(),Jue=J6(),Gue=bO(),Yue=X6(),Kue=o0(),Xue=200;function Zue(e,t,r){var n=-1,i=Wue,a=e.length,o=!0,s=[],l=s;if(r)o=!1,i=Jue;else if(a>=Xue){var c=t?null:Yue(e);if(c)return Kue(c);o=!1,i=Gue,l=new Hue}else l=t?[]:s;e:for(;++n<a;){var f=e[n],u=t?t(f):f;if(f=r||f!==0?f:0,o&&u===u){for(var h=l.length;h--;)if(l[h]===u)continue e;t&&l.push(u),s.push(f)}else i(l,u,r)||(l!==s&&l.push(u),s.push(f))}return s}Z6.exports=Zue});var MO=ce((lPe,e8)=>{var Que=Ts(),efe=Q6();function tfe(e,t){return e&&e.length?efe(e,Que(t,2)):[]}e8.exports=tfe});var r8=ce((cPe,t8)=>{function rfe(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),r=r>i?i:r,r<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(i);++n<i;)a[n]=e[n+t];return a}t8.exports=rfe});var i8=ce((uPe,n8)=>{var nfe=r8();function ife(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:nfe(e,t,r)}n8.exports=ife});var jO=ce((fPe,a8)=>{var afe="\\ud800-\\udfff",ofe="\\u0300-\\u036f",sfe="\\ufe20-\\ufe2f",lfe="\\u20d0-\\u20ff",cfe=ofe+sfe+lfe,ufe="\\ufe0e\\ufe0f",ffe="\\u200d",dfe=RegExp("["+ffe+afe+cfe+ufe+"]");function pfe(e){return dfe.test(e)}a8.exports=pfe});var s8=ce((dPe,o8)=>{function hfe(e){return e.split("")}o8.exports=hfe});var g8=ce((pPe,h8)=>{var l8="\\ud800-\\udfff",gfe="\\u0300-\\u036f",yfe="\\ufe20-\\ufe2f",mfe="\\u20d0-\\u20ff",vfe=gfe+yfe+mfe,bfe="\\ufe0e\\ufe0f",_fe="["+l8+"]",$O="["+vfe+"]",UO="\\ud83c[\\udffb-\\udfff]",wfe="(?:"+$O+"|"+UO+")",c8="[^"+l8+"]",u8="(?:\\ud83c[\\udde6-\\uddff]){2}",f8="[\\ud800-\\udbff][\\udc00-\\udfff]",Sfe="\\u200d",d8=wfe+"?",p8="["+bfe+"]?",xfe="(?:"+Sfe+"(?:"+[c8,u8,f8].join("|")+")"+p8+d8+")*",kfe=p8+d8+xfe,Efe="(?:"+[c8+$O+"?",$O,u8,f8,_fe].join("|")+")",Ofe=RegExp(UO+"(?="+UO+")|"+Efe+kfe,"g");function Afe(e){return e.match(Ofe)||[]}h8.exports=Afe});var m8=ce((hPe,y8)=>{var Ife=s8(),Cfe=jO(),Tfe=g8();function Nfe(e){return Cfe(e)?Tfe(e):Ife(e)}y8.exports=Nfe});var b8=ce((gPe,v8)=>{var Lfe=i8(),Pfe=jO(),Ffe=m8(),Dfe=XE();function Bfe(e){return function(t){t=Dfe(t);var r=Pfe(t)?Ffe(t):void 0,n=r?r[0]:t.charAt(0),i=r?Lfe(r,1).join(""):t.slice(1);return n[e]()+i}}v8.exports=Bfe});var d0=ce((yPe,_8)=>{var Rfe=b8(),Mfe=Rfe("toUpperCase");_8.exports=Mfe});var Z8=ce((yDe,X8)=>{"use strict";var Ide="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";X8.exports=Ide});var r$=ce((mDe,t$)=>{"use strict";var Cde=Z8();function Q8(){}function e$(){}e$.resetWarningCache=Q8;t$.exports=function(){function e(n,i,a,o,s,l){if(l!==Cde){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:e$,resetWarningCache:Q8};return r.PropTypes=r,r}});var Ns=ce((_De,n$)=>{n$.exports=r$()();var vDe,bDe});var L$=ce((qDe,ry)=>{function Hpe(e){return e&&e.__esModule?e:{default:e}}ry.exports=Hpe,ry.exports.__esModule=!0,ry.exports.default=ry.exports});var F$=ce((P0,P$)=>{"use strict";P0.__esModule=!0;P0.default=Wpe;function Wpe(e,t){return e.classList?!!t&&e.classList.contains(t):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")!==-1}P$.exports=P0.default});var B$=ce((F0,D$)=>{"use strict";var Jpe=L$();F0.__esModule=!0;F0.default=Ype;var Gpe=Jpe(F$());function Ype(e,t){e.classList?e.classList.add(t):(0,Gpe.default)(e,t)||(typeof e.className=="string"?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}D$.exports=F0.default});var j$=ce((VDe,M$)=>{"use strict";function R$(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}M$.exports=function(t,r){t.classList?t.classList.remove(r):typeof t.className=="string"?t.className=R$(t.className,r):t.setAttribute("class",R$(t.className&&t.className.baseVal||"",r))}});var BA=ce(DA=>{"use strict";Object.defineProperty(DA,"__esModule",{value:!0});function $$(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function U$(e){function t(r){var n=this.constructor.getDerivedStateFromProps(e,r);return n??null}this.setState(t.bind(this))}function z$(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}$$.__suppressDeprecationWarning=!0;U$.__suppressDeprecationWarning=!0;z$.__suppressDeprecationWarning=!0;function Kpe(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var r=null,n=null,i=null;if(typeof t.componentWillMount=="function"?r="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(r="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?i="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(i="UNSAFE_componentWillUpdate"),r!==null||n!==null||i!==null){var a=e.displayName||e.name,o=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+a+" uses "+o+" but also contains the following legacy lifecycles:"+(r!==null?`
  `+r:"")+(n!==null?`
  `+n:"")+(i!==null?`
  `+i:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=$$,t.componentWillReceiveProps=U$),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=z$;var s=t.componentDidUpdate;t.componentDidUpdate=function(c,f,u){var h=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:u;s.call(this,c,f,h)}}return e}DA.polyfill=Kpe});var RA=ce(Nd=>{"use strict";Nd.__esModule=!0;Nd.classNamesShape=Nd.timeoutsShape=void 0;var WDe=Xpe(Ns());function Xpe(e){return e&&e.__esModule?e:{default:e}}var Zpe=null;Nd.timeoutsShape=Zpe;var Qpe=null;Nd.classNamesShape=Qpe});var $A=ce(Ri=>{"use strict";Ri.__esModule=!0;Ri.default=Ri.EXITING=Ri.ENTERED=Ri.ENTERING=Ri.EXITED=Ri.UNMOUNTED=void 0;var ehe=nhe(Ns()),MA=q$(He()),the=q$(Io()),rhe=BA(),GDe=RA();function q$(e){return e&&e.__esModule?e:{default:e}}function nhe(e){if(e&&e.__esModule)return e;var t={};if(e!=null){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}}return t.default=e,t}function ihe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function ahe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var ny="unmounted";Ri.UNMOUNTED=ny;var nu="exited";Ri.EXITED=nu;var iu="entering";Ri.ENTERING=iu;var Pd="entered";Ri.ENTERED=Pd;var jA="exiting";Ri.EXITING=jA;var Bo=function(e){ahe(t,e);function t(n,i){var a;a=e.call(this,n,i)||this;var o=i.transitionGroup,s=o&&!o.isMounting?n.enter:n.appear,l;return a.appearStatus=null,n.in?s?(l=nu,a.appearStatus=iu):l=Pd:n.unmountOnExit||n.mountOnEnter?l=ny:l=nu,a.state={status:l},a.nextCallback=null,a}var r=t.prototype;return r.getChildContext=function(){return{transitionGroup:null}},t.getDerivedStateFromProps=function(i,a){var o=i.in;return o&&a.status===ny?{status:nu}:null},r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(i){var a=null;if(i!==this.props){var o=this.state.status;this.props.in?o!==iu&&o!==Pd&&(a=iu):(o===iu||o===Pd)&&(a=jA)}this.updateStatus(!1,a)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var i=this.props.timeout,a,o,s;return a=o=s=i,i!=null&&typeof i!="number"&&(a=i.exit,o=i.enter,s=i.appear!==void 0?i.appear:o),{exit:a,enter:o,appear:s}},r.updateStatus=function(i,a){if(i===void 0&&(i=!1),a!==null){this.cancelNextCallback();var o=the.default.findDOMNode(this);a===iu?this.performEnter(o,i):this.performExit(o)}else this.props.unmountOnExit&&this.state.status===nu&&this.setState({status:ny})},r.performEnter=function(i,a){var o=this,s=this.props.enter,l=this.context.transitionGroup?this.context.transitionGroup.isMounting:a,c=this.getTimeouts(),f=l?c.appear:c.enter;if(!a&&!s){this.safeSetState({status:Pd},function(){o.props.onEntered(i)});return}this.props.onEnter(i,l),this.safeSetState({status:iu},function(){o.props.onEntering(i,l),o.onTransitionEnd(i,f,function(){o.safeSetState({status:Pd},function(){o.props.onEntered(i,l)})})})},r.performExit=function(i){var a=this,o=this.props.exit,s=this.getTimeouts();if(!o){this.safeSetState({status:nu},function(){a.props.onExited(i)});return}this.props.onExit(i),this.safeSetState({status:jA},function(){a.props.onExiting(i),a.onTransitionEnd(i,s.exit,function(){a.safeSetState({status:nu},function(){a.props.onExited(i)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(i,a){a=this.setNextCallback(a),this.setState(i,a)},r.setNextCallback=function(i){var a=this,o=!0;return this.nextCallback=function(s){o&&(o=!1,a.nextCallback=null,i(s))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},r.onTransitionEnd=function(i,a,o){this.setNextCallback(o);var s=a==null&&!this.props.addEndListener;if(!i||s){setTimeout(this.nextCallback,0);return}this.props.addEndListener&&this.props.addEndListener(i,this.nextCallback),a!=null&&setTimeout(this.nextCallback,a)},r.render=function(){var i=this.state.status;if(i===ny)return null;var a=this.props,o=a.children,s=ihe(a,["children"]);if(delete s.in,delete s.mountOnEnter,delete s.unmountOnExit,delete s.appear,delete s.enter,delete s.exit,delete s.timeout,delete s.addEndListener,delete s.onEnter,delete s.onEntering,delete s.onEntered,delete s.onExit,delete s.onExiting,delete s.onExited,typeof o=="function")return o(i,s);var l=MA.default.Children.only(o);return MA.default.cloneElement(l,s)},t}(MA.default.Component);Bo.contextTypes={transitionGroup:ehe.object};Bo.childContextTypes={transitionGroup:function(){}};Bo.propTypes={};function Ld(){}Bo.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Ld,onEntering:Ld,onEntered:Ld,onExit:Ld,onExiting:Ld,onExited:Ld};Bo.UNMOUNTED=0;Bo.EXITED=1;Bo.ENTERING=2;Bo.ENTERED=3;Bo.EXITING=4;var ohe=(0,rhe.polyfill)(Bo);Ri.default=ohe});var W$=ce((ay,H$)=>{"use strict";ay.__esModule=!0;ay.default=void 0;var KDe=uhe(Ns()),she=B0(B$()),lhe=B0(j$()),V$=B0(He()),che=B0($A()),XDe=RA();function B0(e){return e&&e.__esModule?e:{default:e}}function uhe(e){if(e&&e.__esModule)return e;var t={};if(e!=null){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}}return t.default=e,t}function D0(){return D0=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D0.apply(this,arguments)}function fhe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var iy=function(t,r){return t&&r&&r.split(" ").forEach(function(n){return(0,she.default)(t,n)})},UA=function(t,r){return t&&r&&r.split(" ").forEach(function(n){return(0,lhe.default)(t,n)})},zA=function(e){fhe(t,e);function t(){for(var n,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a))||this,n.onEnter=function(s,l){var c=n.getClassNames(l?"appear":"enter"),f=c.className;n.removeClasses(s,"exit"),iy(s,f),n.props.onEnter&&n.props.onEnter(s,l)},n.onEntering=function(s,l){var c=n.getClassNames(l?"appear":"enter"),f=c.activeClassName;n.reflowAndAddClass(s,f),n.props.onEntering&&n.props.onEntering(s,l)},n.onEntered=function(s,l){var c=n.getClassNames("appear").doneClassName,f=n.getClassNames("enter").doneClassName,u=l?c+" "+f:f;n.removeClasses(s,l?"appear":"enter"),iy(s,u),n.props.onEntered&&n.props.onEntered(s,l)},n.onExit=function(s){var l=n.getClassNames("exit"),c=l.className;n.removeClasses(s,"appear"),n.removeClasses(s,"enter"),iy(s,c),n.props.onExit&&n.props.onExit(s)},n.onExiting=function(s){var l=n.getClassNames("exit"),c=l.activeClassName;n.reflowAndAddClass(s,c),n.props.onExiting&&n.props.onExiting(s)},n.onExited=function(s){var l=n.getClassNames("exit"),c=l.doneClassName;n.removeClasses(s,"exit"),iy(s,c),n.props.onExited&&n.props.onExited(s)},n.getClassNames=function(s){var l=n.props.classNames,c=typeof l=="string",f=c&&l?l+"-":"",u=c?f+s:l[s],h=c?u+"-active":l[s+"Active"],g=c?u+"-done":l[s+"Done"];return{className:u,activeClassName:h,doneClassName:g}},n}var r=t.prototype;return r.removeClasses=function(i,a){var o=this.getClassNames(a),s=o.className,l=o.activeClassName,c=o.doneClassName;s&&UA(i,s),l&&UA(i,l),c&&UA(i,c)},r.reflowAndAddClass=function(i,a){a&&(i&&i.scrollTop,iy(i,a))},r.render=function(){var i=D0({},this.props);return delete i.classNames,V$.default.createElement(che.default,D0({},i,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(V$.default.Component);zA.defaultProps={classNames:""};zA.propTypes={};var dhe=zA;ay.default=dhe;H$.exports=ay.default});var G$=ce(Fd=>{"use strict";Fd.__esModule=!0;Fd.getChildMapping=qA;Fd.mergeChildMappings=J$;Fd.getInitialChildMapping=phe;Fd.getNextChildMapping=hhe;var Ls=He();function qA(e,t){var r=function(a){return t&&(0,Ls.isValidElement)(a)?t(a):a},n=Object.create(null);return e&&Ls.Children.map(e,function(i){return i}).forEach(function(i){n[i.key]=r(i)}),n}function J$(e,t){e=e||{},t=t||{};function r(f){return f in t?t[f]:e[f]}var n=Object.create(null),i=[];for(var a in e)a in t?i.length&&(n[a]=i,i=[]):i.push(a);var o,s={};for(var l in t){if(n[l])for(o=0;o<n[l].length;o++){var c=n[l][o];s[n[l][o]]=r(c)}s[l]=r(l)}for(o=0;o<i.length;o++)s[i[o]]=r(i[o]);return s}function au(e,t,r){return r[t]!=null?r[t]:e.props[t]}function phe(e,t){return qA(e.children,function(r){return(0,Ls.cloneElement)(r,{onExited:t.bind(null,r),in:!0,appear:au(r,"appear",e),enter:au(r,"enter",e),exit:au(r,"exit",e)})})}function hhe(e,t,r){var n=qA(e.children),i=J$(t,n);return Object.keys(i).forEach(function(a){var o=i[a];if((0,Ls.isValidElement)(o)){var s=a in t,l=a in n,c=t[a],f=(0,Ls.isValidElement)(c)&&!c.props.in;l&&(!s||f)?i[a]=(0,Ls.cloneElement)(o,{onExited:r.bind(null,o),in:!0,exit:au(o,"exit",e),enter:au(o,"enter",e)}):!l&&s&&!f?i[a]=(0,Ls.cloneElement)(o,{in:!1}):l&&s&&(0,Ls.isValidElement)(c)&&(i[a]=(0,Ls.cloneElement)(o,{onExited:r.bind(null,o),in:c.props.in,exit:au(o,"exit",e),enter:au(o,"enter",e)}))}}),i}});var WA=ce((oy,Z$)=>{"use strict";oy.__esModule=!0;oy.default=void 0;var ghe=X$(Ns()),Y$=X$(He()),yhe=BA(),VA=G$();function X$(e){return e&&e.__esModule?e:{default:e}}function mhe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function HA(){return HA=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HA.apply(this,arguments)}function vhe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function K$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var bhe=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},_he={component:"div",childFactory:function(t){return t}},R0=function(e){vhe(t,e);function t(n,i){var a;a=e.call(this,n,i)||this;var o=a.handleExited.bind(K$(K$(a)));return a.state={handleExited:o,firstRender:!0},a}var r=t.prototype;return r.getChildContext=function(){return{transitionGroup:{isMounting:!this.appeared}}},r.componentDidMount=function(){this.appeared=!0,this.mounted=!0},r.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(i,a){var o=a.children,s=a.handleExited,l=a.firstRender;return{children:l?(0,VA.getInitialChildMapping)(i,s):(0,VA.getNextChildMapping)(i,o,s),firstRender:!1}},r.handleExited=function(i,a){var o=(0,VA.getChildMapping)(this.props.children);i.key in o||(i.props.onExited&&i.props.onExited(a),this.mounted&&this.setState(function(s){var l=HA({},s.children);return delete l[i.key],{children:l}}))},r.render=function(){var i=this.props,a=i.component,o=i.childFactory,s=mhe(i,["component","childFactory"]),l=bhe(this.state.children).map(o);return delete s.appear,delete s.enter,delete s.exit,a===null?l:Y$.default.createElement(a,s,l)},t}(Y$.default.Component);R0.childContextTypes={transitionGroup:ghe.default.object.isRequired};R0.propTypes={};R0.defaultProps=_he;var whe=(0,yhe.polyfill)(R0);oy.default=whe;Z$.exports=oy.default});var tU=ce((sy,eU)=>{"use strict";sy.__esModule=!0;sy.default=void 0;var QDe=JA(Ns()),Dd=JA(He()),She=Io(),xhe=JA(WA());function JA(e){return e&&e.__esModule?e:{default:e}}function khe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Ehe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Q$=function(e){Ehe(t,e);function t(){for(var n,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a))||this,n.handleEnter=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return n.handleLifecycle("onEnter",0,l)},n.handleEntering=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return n.handleLifecycle("onEntering",0,l)},n.handleEntered=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return n.handleLifecycle("onEntered",0,l)},n.handleExit=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return n.handleLifecycle("onExit",1,l)},n.handleExiting=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return n.handleLifecycle("onExiting",1,l)},n.handleExited=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return n.handleLifecycle("onExited",1,l)},n}var r=t.prototype;return r.handleLifecycle=function(i,a,o){var s,l=this.props.children,c=Dd.default.Children.toArray(l)[a];c.props[i]&&(s=c.props)[i].apply(s,o),this.props[i]&&this.props[i]((0,She.findDOMNode)(this))},r.render=function(){var i=this.props,a=i.children,o=i.in,s=khe(i,["children","in"]),l=Dd.default.Children.toArray(a),c=l[0],f=l[1];return delete s.onEnter,delete s.onEntering,delete s.onEntered,delete s.onExit,delete s.onExiting,delete s.onExited,Dd.default.createElement(xhe.default,s,o?Dd.default.cloneElement(c,{key:"first",onEnter:this.handleEnter,onEntering:this.handleEntering,onEntered:this.handleEntered}):Dd.default.cloneElement(f,{key:"second",onEnter:this.handleExit,onEntering:this.handleExiting,onEntered:this.handleExited}))},t}(Dd.default.Component);Q$.propTypes={};var Ohe=Q$;sy.default=Ohe;eU.exports=sy.default});var GA=ce((eBe,rU)=>{"use strict";var Ahe=M0(W$()),Ihe=M0(tU()),Che=M0(WA()),The=M0($A());function M0(e){return e&&e.__esModule?e:{default:e}}rU.exports={Transition:The.default,TransitionGroup:Che.default,ReplaceTransition:Ihe.default,CSSTransition:Ahe.default}});var gU=ce((fBe,hU)=>{var dU=rd(),Uhe=s0(),zhe=Vr(),pU=dU?dU.isConcatSpreadable:void 0;function qhe(e){return zhe(e)||Uhe(e)||!!(pU&&e&&e[pU])}hU.exports=qhe});var eI=ce((dBe,mU)=>{var Vhe=SO(),Hhe=gU();function yU(e,t,r,n,i){var a=-1,o=e.length;for(r||(r=Hhe),i||(i=[]);++a<o;){var s=e[a];t>0&&r(s)?t>1?yU(s,t-1,r,n,i):Vhe(i,s):n||(i[i.length]=s)}return i}mU.exports=yU});var bU=ce((pBe,vU)=>{function Whe(e){return function(t,r,n){for(var i=-1,a=Object(t),o=n(t),s=o.length;s--;){var l=o[e?s:++i];if(r(a[l],l,a)===!1)break}return t}}vU.exports=Whe});var wU=ce((hBe,_U)=>{var Jhe=bU(),Ghe=Jhe();_U.exports=Ghe});var tI=ce((gBe,SU)=>{var Yhe=wU(),Khe=Jg();function Xhe(e,t){return e&&Yhe(e,t,Khe)}SU.exports=Xhe});var kU=ce((yBe,xU)=>{var Zhe=dd();function Qhe(e,t){return function(r,n){if(r==null)return r;if(!Zhe(r))return e(r,n);for(var i=r.length,a=t?i:-1,o=Object(r);(t?a--:++a<i)&&n(o[a],a,o)!==!1;);return r}}xU.exports=Qhe});var $0=ce((mBe,EU)=>{var ege=tI(),tge=kU(),rge=tge(ege);EU.exports=rge});var rI=ce((vBe,OU)=>{var nge=$0(),ige=dd();function age(e,t){var r=-1,n=ige(e)?Array(e.length):[];return nge(e,function(i,a,o){n[++r]=t(i,a,o)}),n}OU.exports=age});var IU=ce((bBe,AU)=>{function oge(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}AU.exports=oge});var NU=ce((_Be,TU)=>{var CU=Wc();function sge(e,t){if(e!==t){var r=e!==void 0,n=e===null,i=e===e,a=CU(e),o=t!==void 0,s=t===null,l=t===t,c=CU(t);if(!s&&!c&&!a&&e>t||a&&o&&l&&!s&&!c||n&&o&&l||!r&&l||!i)return 1;if(!n&&!a&&!c&&e<t||c&&r&&i&&!n&&!a||s&&r&&i||!o&&i||!l)return-1}return 0}TU.exports=sge});var PU=ce((wBe,LU)=>{var lge=NU();function cge(e,t,r){for(var n=-1,i=e.criteria,a=t.criteria,o=i.length,s=r.length;++n<o;){var l=lge(i[n],a[n]);if(l){if(n>=s)return l;var c=r[n];return l*(c=="desc"?-1:1)}}return e.index-t.index}LU.exports=cge});var DU=ce((SBe,FU)=>{var nI=q_(),uge=V_(),fge=Ts(),dge=rI(),pge=IU(),hge=kO(),gge=PU(),yge=Zc(),mge=Vr();function vge(e,t,r){t.length?t=nI(t,function(a){return mge(a)?function(o){return uge(o,a.length===1?a[0]:a)}:a}):t=[yge];var n=-1;t=nI(t,hge(fge));var i=dge(e,function(a,o,s){var l=nI(t,function(c){return c(a)});return{criteria:l,index:++n,value:a}});return pge(i,function(a,o){return gge(a,o,r)})}FU.exports=vge});var RU=ce((xBe,BU)=>{function bge(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}BU.exports=bge});var $U=ce((kBe,jU)=>{var _ge=RU(),MU=Math.max;function wge(e,t,r){return t=MU(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,a=MU(n.length-t,0),o=Array(a);++i<a;)o[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(o),_ge(e,this,s)}}jU.exports=wge});var zU=ce((EBe,UU)=>{function Sge(e){return function(){return e}}UU.exports=Sge});var iI=ce((OBe,qU)=>{var xge=Cl(),kge=function(){try{var e=xge(Object,"defineProperty");return e({},"",{}),e}catch{}}();qU.exports=kge});var WU=ce((ABe,HU)=>{var Ege=zU(),VU=iI(),Oge=Zc(),Age=VU?function(e,t){return VU(e,"toString",{configurable:!0,enumerable:!1,value:Ege(t),writable:!0})}:Oge;HU.exports=Age});var GU=ce((IBe,JU)=>{var Ige=800,Cge=16,Tge=Date.now;function Nge(e){var t=0,r=0;return function(){var n=Tge(),i=Cge-(n-r);if(r=n,i>0){if(++t>=Ige)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}JU.exports=Nge});var KU=ce((CBe,YU)=>{var Lge=WU(),Pge=GU(),Fge=Pge(Lge);YU.exports=Fge});var ZU=ce((TBe,XU)=>{var Dge=Zc(),Bge=$U(),Rge=KU();function Mge(e,t){return Rge(Bge(e,t,Dge),e+"")}XU.exports=Mge});var uy=ce((NBe,QU)=>{var jge=$_(),$ge=dd(),Uge=l0(),zge=Oa();function qge(e,t,r){if(!zge(r))return!1;var n=typeof t;return(n=="number"?$ge(r)&&Uge(t,r.length):n=="string"&&t in r)?jge(r[t],e):!1}QU.exports=qge});var U0=ce((LBe,tz)=>{var Vge=eI(),Hge=DU(),Wge=ZU(),ez=uy(),Jge=Wge(function(e,t){if(e==null)return[];var r=t.length;return r>1&&ez(e,t[0],t[1])?t=[]:r>2&&ez(t[0],t[1],t[2])&&(t=[t[0]]),Hge(e,Vge(t,1),[])});tz.exports=Jge});var gz=ce((UBe,hz)=>{var bye=Qa(),_ye=function(){return bye.Date.now()};hz.exports=_ye});var mz=ce((zBe,yz)=>{var wye=/\s/;function Sye(e){for(var t=e.length;t--&&wye.test(e.charAt(t)););return t}yz.exports=Sye});var bz=ce((qBe,vz)=>{var xye=mz(),kye=/^\s+/;function Eye(e){return e&&e.slice(0,xye(e)+1).replace(kye,"")}vz.exports=Eye});var fI=ce((VBe,Sz)=>{var Oye=bz(),_z=Oa(),Aye=Wc(),wz=0/0,Iye=/^[-+]0x[0-9a-f]+$/i,Cye=/^0b[01]+$/i,Tye=/^0o[0-7]+$/i,Nye=parseInt;function Lye(e){if(typeof e=="number")return e;if(Aye(e))return wz;if(_z(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=_z(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Oye(e);var r=Cye.test(e);return r||Tye.test(e)?Nye(e.slice(2),r?2:8):Iye.test(e)?wz:+e}Sz.exports=Lye});var pI=ce((HBe,kz)=>{var Pye=Oa(),dI=gz(),xz=fI(),Fye="Expected a function",Dye=Math.max,Bye=Math.min;function Rye(e,t,r){var n,i,a,o,s,l,c=0,f=!1,u=!1,h=!0;if(typeof e!="function")throw new TypeError(Fye);t=xz(t)||0,Pye(r)&&(f=!!r.leading,u="maxWait"in r,a=u?Dye(xz(r.maxWait)||0,t):a,h="trailing"in r?!!r.trailing:h);function g(D){var P=n,z=i;return n=i=void 0,c=D,o=e.apply(z,P),o}function _(D){return c=D,s=setTimeout(S,t),f?g(D):o}function w(D){var P=D-l,z=D-c,ne=t-P;return u?Bye(ne,a-z):ne}function E(D){var P=D-l,z=D-c;return l===void 0||P>=t||P<0||u&&z>=a}function S(){var D=dI();if(E(D))return A(D);s=setTimeout(S,w(D))}function A(D){return s=void 0,h&&n?g(D):(n=i=void 0,o)}function O(){s!==void 0&&clearTimeout(s),c=0,n=l=i=s=void 0}function C(){return s===void 0?o:A(dI())}function T(){var D=dI(),P=E(D);if(n=arguments,i=this,l=D,P){if(s===void 0)return _(l);if(u)return clearTimeout(s),s=setTimeout(S,t),g(l)}return s===void 0&&(s=setTimeout(S,t)),o}return T.cancel=O,T.flush=C,T}kz.exports=Rye});var hI=ce((WBe,Ez)=>{var Mye=pI(),jye=Oa(),$ye="Expected a function";function Uye(e,t,r){var n=!0,i=!0;if(typeof e!="function")throw new TypeError($ye);return jye(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),Mye(e,t,{leading:n,maxWait:t,trailing:i})}Ez.exports=Uye});var Bz=ce((tRe,Dz)=>{var vI="(".charCodeAt(0),bI=")".charCodeAt(0),H0="'".charCodeAt(0),_I='"'.charCodeAt(0),wI="\\".charCodeAt(0),W0="/".charCodeAt(0),SI=",".charCodeAt(0),xI=":".charCodeAt(0),Fz="*".charCodeAt(0);Dz.exports=function(e){for(var t=[],r=e,n,i,a,o,s,l,c,f=0,u=r.charCodeAt(f),h=r.length,g=[{nodes:t}],_=0,w,E="",S="",A="";f<h;)if(u<=32){n=f;do n+=1,u=r.charCodeAt(n);while(u<=32);o=r.slice(f,n),a=t[t.length-1],u===bI&&_?A=o:a&&a.type==="div"?a.after=o:u===SI||u===xI||u===W0&&r.charCodeAt(n+1)!==Fz?S=o:t.push({type:"space",sourceIndex:f,value:o}),f=n}else if(u===H0||u===_I){n=f,i=u===H0?"'":'"',o={type:"string",sourceIndex:f,quote:i};do if(s=!1,n=r.indexOf(i,n+1),~n)for(l=n;r.charCodeAt(l-1)===wI;)l-=1,s=!s;else r+=i,n=r.length-1,o.unclosed=!0;while(s);o.value=r.slice(f+1,n),t.push(o),f=n+1,u=r.charCodeAt(f)}else if(u===W0&&r.charCodeAt(f+1)===Fz)o={type:"comment",sourceIndex:f},n=r.indexOf("*/",f),n===-1&&(o.unclosed=!0,n=r.length),o.value=r.slice(f+2,n),t.push(o),f=n+2,u=r.charCodeAt(f);else if(u===W0||u===SI||u===xI)o=r[f],t.push({type:"div",sourceIndex:f-S.length,value:o,before:S,after:""}),S="",f+=1,u=r.charCodeAt(f);else if(vI===u){n=f;do n+=1,u=r.charCodeAt(n);while(u<=32);if(o={type:"function",sourceIndex:f-E.length,value:E,before:r.slice(f+1,n)},f=n,E==="url"&&u!==H0&&u!==_I){n-=1;do if(s=!1,n=r.indexOf(")",n+1),~n)for(l=n;r.charCodeAt(l-1)===wI;)l-=1,s=!s;else r+=")",n=r.length-1,o.unclosed=!0;while(s);c=n;do c-=1,u=r.charCodeAt(c);while(u<=32);f!==c+1?o.nodes=[{type:"word",sourceIndex:f,value:r.slice(f,c+1)}]:o.nodes=[],o.unclosed&&c+1!==n?(o.after="",o.nodes.push({type:"space",sourceIndex:c+1,value:r.slice(c+1,n)})):o.after=r.slice(c+1,n),f=n+1,u=r.charCodeAt(f),t.push(o)}else _+=1,o.after="",t.push(o),g.push(o),t=o.nodes=[],w=o;E=""}else if(bI===u&&_)f+=1,u=r.charCodeAt(f),w.after=A,A="",_-=1,g.pop(),w=g[_],t=w.nodes;else{n=f;do u===wI&&(n+=1),n+=1,u=r.charCodeAt(n);while(n<h&&!(u<=32||u===H0||u===_I||u===SI||u===xI||u===W0||u===vI||u===bI&&_));o=r.slice(f,n),vI===u?E=o:t.push({type:"word",sourceIndex:f,value:o}),f=n}for(f=g.length-1;f;f-=1)g[f].unclosed=!0;return g[0].nodes}});var Mz=ce((rRe,Rz)=>{Rz.exports=function e(t,r,n){var i,a,o,s;for(i=0,a=t.length;i<a;i+=1)o=t[i],n||(s=r(o,i,t)),s!==!1&&o.type==="function"&&Array.isArray(o.nodes)&&e(o.nodes,r,n),n&&r(o,i,t)}});var zz=ce((nRe,Uz)=>{function jz(e,t){var r=e.type,n=e.value,i,a;return t&&(a=t(e))!==void 0?a:r==="word"||r==="space"?n:r==="string"?(i=e.quote||"",i+n+(e.unclosed?"":i)):r==="comment"?"/*"+n+(e.unclosed?"":"*/"):r==="div"?(e.before||"")+n+(e.after||""):Array.isArray(e.nodes)?(i=$z(e.nodes),r!=="function"?i:n+"("+(e.before||"")+i+(e.after||"")+(e.unclosed?"":")")):n}function $z(e,t){var r,n;if(Array.isArray(e)){for(r="",n=e.length-1;~n;n-=1)r=jz(e[n],t)+r;return r}return jz(e,t)}Uz.exports=$z});var Vz=ce((iRe,qz)=>{var Zye="-".charCodeAt(0),Qye="+".charCodeAt(0),eme=".".charCodeAt(0),tme="e".charCodeAt(0),rme="E".charCodeAt(0);qz.exports=function(e){for(var t=0,r=e.length,n=!1,i=-1,a=!1,o;t<r;){if(o=e.charCodeAt(t),o>=48&&o<=57)a=!0;else if(o===tme||o===rme){if(i>-1)break;i=t}else if(o===eme){if(n)break;n=!0}else if(o===Qye||o===Zye){if(t!==0)break}else break;t+=1}return i+1===t&&t--,a?{number:e.slice(0,t),unit:e.slice(t)}:!1}});var Gz=ce((aRe,Jz)=>{var nme=Bz(),Hz=Mz(),Wz=zz();function Fl(e){return this instanceof Fl?(this.nodes=nme(e),this):new Fl(e)}Fl.prototype.toString=function(){return Array.isArray(this.nodes)?Wz(this.nodes):""};Fl.prototype.walk=function(e,t){return Hz(this.nodes,e,t),this};Fl.unit=Vz();Fl.walk=Hz;Fl.stringify=Wz;Jz.exports=Fl});var Yz=ce(hy=>{var J0=function(){function e(f,u){Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonParserError"}),f==null&&(f="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:f}),this.hash=u;var h;if(u&&u.exception instanceof Error){var g=u.exception;this.message=g.message||f,h=g.stack}h||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):h=new Error(f).stack),h&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:h})}typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(e.prototype,Error.prototype):e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e.prototype.name="JisonParserError";function t(f){for(var u=[],h=f.pop,g=f.rule,_=0,w=h.length;_<w;_++)u.push([h[_],g[_]]);return u}function r(f){for(var u={},h=f.idx,g=f.goto,_=0,w=h.length;_<w;_++){var E=h[_];u[E]=g[_]}return u}function n(f){for(var u=[],h=f.len,g=f.symbol,_=f.type,w=f.state,E=f.mode,S=f.goto,A=0,O=h.length;A<O;A++){for(var C=h[A],T={},D=0;D<C;D++){var P=g.shift();switch(_.shift()){case 2:T[P]=[E.shift(),S.shift()];break;case 0:T[P]=w.shift();break;default:T[P]=[3]}}u.push(T)}return u}function i(f,u,h){h=h||0;for(var g=0;g<u;g++)this.push(f),f+=h}function a(f,u){for(f=this.length-f,u+=f;f<u;f++)this.push(this[f])}function o(f){for(var u=[],h=0,g=f.length;h<g;h++){var _=f[h];typeof _=="function"?(h++,_.apply(u,f[h])):u.push(_)}return u}var s={trace:function(){},JisonParserError:e,yy:{},options:{type:"lalr",hasPartialLrUpgradeOnConflict:!0,errorRecoveryTokenDiscardCount:3},symbols_:{$accept:0,$end:1,ADD:3,ANGLE:16,CHS:22,COMMA:14,CSS_CPROP:13,CSS_VAR:12,DIV:6,EMS:20,EOF:1,EXS:21,FREQ:18,LENGTH:15,LPAREN:7,MUL:5,NESTED_CALC:9,NUMBER:11,PERCENTAGE:28,PREFIX:10,REMS:23,RES:19,RPAREN:8,SUB:4,TIME:17,VHS:24,VMAXS:27,VMINS:26,VWS:25,css_value:33,css_variable:32,error:2,expression:29,math_expression:30,value:31},terminals_:{1:"EOF",2:"error",3:"ADD",4:"SUB",5:"MUL",6:"DIV",7:"LPAREN",8:"RPAREN",9:"NESTED_CALC",10:"PREFIX",11:"NUMBER",12:"CSS_VAR",13:"CSS_CPROP",14:"COMMA",15:"LENGTH",16:"ANGLE",17:"TIME",18:"FREQ",19:"RES",20:"EMS",21:"EXS",22:"CHS",23:"REMS",24:"VHS",25:"VWS",26:"VMINS",27:"VMAXS",28:"PERCENTAGE"},TERROR:2,EOF:1,originalQuoteName:null,originalParseError:null,cleanupAfterParse:null,constructParseErrorInfo:null,yyMergeLocationInfo:null,__reentrant_call_depth:0,__error_infos:[],__error_recovery_infos:[],quoteName:function(u){return'"'+u+'"'},getSymbolName:function(u){if(this.terminals_[u])return this.terminals_[u];var h=this.symbols_;for(var g in h)if(h[g]===u)return g;return null},describeSymbol:function(u){if(u!==this.EOF&&this.terminal_descriptions_&&this.terminal_descriptions_[u])return this.terminal_descriptions_[u];if(u===this.EOF)return"end of input";var h=this.getSymbolName(u);return h?this.quoteName(h):null},collect_expected_token_set:function(u,h){var g=this.TERROR,_=[],w={};if(!h&&this.state_descriptions_&&this.state_descriptions_[u])return[this.state_descriptions_[u]];for(var E in this.table[u])if(E=+E,E!==g){var S=h?E:this.describeSymbol(E);S&&!w[S]&&(_.push(S),w[S]=!0)}return _},productions_:t({pop:o([29,i,[30,10],31,31,32,32,i,[33,15]]),rule:o([2,i,[3,5],4,7,i,[1,4],2,4,6,i,[1,14],2])}),performAction:function(u,h,g){var _=this.yy,w=_.parser,E=_.lexer;switch(u){case 0:this.$=g[h-1];break;case 1:return this.$=g[h-1],g[h-1];break;case 2:case 3:case 4:case 5:this.$={type:"MathExpression",operator:g[h-1],left:g[h-2],right:g[h]};break;case 6:this.$=g[h-1];break;case 7:this.$={type:"Calc",value:g[h-1]};break;case 8:this.$={type:"Calc",value:g[h-1],prefix:g[h-5]};break;case 9:case 10:case 11:this.$=g[h];break;case 12:this.$={type:"Value",value:parseFloat(g[h])};break;case 13:this.$={type:"Value",value:parseFloat(g[h])*-1};break;case 14:this.$={type:"CssVariable",value:g[h-1]};break;case 15:this.$={type:"CssVariable",value:g[h-3],fallback:g[h-1]};break;case 16:this.$={type:"LengthValue",value:parseFloat(g[h]),unit:/[a-z]+/.exec(g[h])[0]};break;case 17:this.$={type:"AngleValue",value:parseFloat(g[h]),unit:/[a-z]+/.exec(g[h])[0]};break;case 18:this.$={type:"TimeValue",value:parseFloat(g[h]),unit:/[a-z]+/.exec(g[h])[0]};break;case 19:this.$={type:"FrequencyValue",value:parseFloat(g[h]),unit:/[a-z]+/.exec(g[h])[0]};break;case 20:this.$={type:"ResolutionValue",value:parseFloat(g[h]),unit:/[a-z]+/.exec(g[h])[0]};break;case 21:this.$={type:"EmValue",value:parseFloat(g[h]),unit:"em"};break;case 22:this.$={type:"ExValue",value:parseFloat(g[h]),unit:"ex"};break;case 23:this.$={type:"ChValue",value:parseFloat(g[h]),unit:"ch"};break;case 24:this.$={type:"RemValue",value:parseFloat(g[h]),unit:"rem"};break;case 25:this.$={type:"VhValue",value:parseFloat(g[h]),unit:"vh"};break;case 26:this.$={type:"VwValue",value:parseFloat(g[h]),unit:"vw"};break;case 27:this.$={type:"VminValue",value:parseFloat(g[h]),unit:"vmin"};break;case 28:this.$={type:"VmaxValue",value:parseFloat(g[h]),unit:"vmax"};break;case 29:this.$={type:"PercentageValue",value:parseFloat(g[h]),unit:"%"};break;case 30:var S=g[h];S.value*=-1,this.$=S;break}},table:n({len:o([24,1,5,23,1,18,i,[0,3],1,i,[0,16],i,[23,4],a,[28,3],0,0,16,1,6,6,i,[0,3],5,1,2,a,[37,3],a,[20,3],5,0,0]),symbol:o([4,7,9,11,12,i,[15,19,1],1,1,i,[3,4,1],a,[30,19],a,[29,4],7,4,10,11,a,[22,14],a,[19,3],a,[43,22],a,[23,69],a,[139,4],8,a,[51,24],4,a,[138,15],13,a,[186,5],8,a,[6,6],a,[5,5],9,8,14,a,[159,47],a,[60,10]]),type:o([i,[2,19],i,[0,5],1,i,[2,24],i,[0,4],a,[22,19],a,[43,42],a,[23,70],a,[28,25],a,[45,25],a,[113,54]]),state:o([1,2,8,6,7,30,a,[4,3],33,37,a,[5,3],38,a,[4,3],39,a,[4,3],40,a,[4,3],42,a,[21,4],50,a,[5,3],51,a,[4,3]]),mode:o([i,[1,179],i,[2,3],a,[5,5],a,[6,4],i,[1,57]]),goto:o([5,3,4,24,i,[9,15,1],i,[25,5,1],a,[24,19],31,35,32,34,a,[18,14],36,a,[38,19],a,[19,57],a,[118,4],41,a,[24,19],43,35,a,[16,14],44,i,[2,3],28,29,2,i,[3,3],28,29,3,a,[53,4],i,[45,5,1],a,[100,42],52,a,[5,4],53])}),defaultActions:r({idx:o([6,7,8,i,[10,16,1],33,34,39,40,41,45,47,52,53]),goto:o([9,10,11,i,[16,14,1],12,1,30,13,i,[4,4,1],14,15,8])}),parseError:function(u,h,g){if(h.recoverable)typeof this.trace=="function"&&this.trace(u),h.destroy();else throw typeof this.trace=="function"&&this.trace(u),g||(g=this.JisonParserError),new g(u,h)},parse:function(u){var h=this,g=new Array(128),_=new Array(128),w=new Array(128),E=this.table,S=0,A=0,O=this.TERROR,C=this.EOF,T=this.options.errorRecoveryTokenDiscardCount|0||3,D=[0,54],P;this.__lexer__?P=this.__lexer__:P=this.__lexer__=Object.create(this.lexer);var z={parseError:void 0,quoteName:void 0,lexer:void 0,parser:void 0,pre_parse:void 0,post_parse:void 0,pre_lex:void 0,post_lex:void 0},ne;typeof assert!="function"?ne=function(J,re){if(!J)throw new Error("assertion failed: "+(re||"***"))}:ne=assert,this.yyGetSharedState=function(){return z};function V(W,J){for(var re in J)typeof W[re]>"u"&&Object.prototype.hasOwnProperty.call(J,re)&&(W[re]=J[re])}V(z,this.yy),z.lexer=P,z.parser=this,typeof z.parseError=="function"?this.parseError=function(J,re,Ee){return Ee||(Ee=this.JisonParserError),z.parseError.call(this,J,re,Ee)}:this.parseError=this.originalParseError,typeof z.quoteName=="function"?this.quoteName=function(J){return z.quoteName.call(this,J)}:this.quoteName=this.originalQuoteName,this.cleanupAfterParse=function(J,re,Ee){var Te;if(re){var Ie;(z.post_parse||this.post_parse)&&(Ie=this.constructParseErrorInfo(null,null,null,!1)),z.post_parse&&(Te=z.post_parse.call(this,z,J,Ie),typeof Te<"u"&&(J=Te)),this.post_parse&&(Te=this.post_parse.call(this,z,J,Ie),typeof Te<"u"&&(J=Te)),Ie&&Ie.destroy&&Ie.destroy()}if(this.__reentrant_call_depth>1)return J;if(P.cleanupAfterLex&&P.cleanupAfterLex(Ee),z&&(z.lexer=void 0,z.parser=void 0,P.yy===z&&(P.yy=void 0)),z=void 0,this.parseError=this.originalParseError,this.quoteName=this.originalQuoteName,g.length=0,_.length=0,w.length=0,S=0,!Ee){for(var Ye=this.__error_infos.length-1;Ye>=0;Ye--){var Ke=this.__error_infos[Ye];Ke&&typeof Ke.destroy=="function"&&Ke.destroy()}this.__error_infos.length=0}return J},this.constructParseErrorInfo=function(J,re,Ee,Te){var Ie={errStr:J,exception:re,text:P.match,value:P.yytext,token:this.describeSymbol(A)||A,token_id:A,line:P.yylineno,expected:Ee,recoverable:Te,state:de,action:F,new_state:le,symbol_stack:g,state_stack:_,value_stack:w,stack_pointer:S,yy:z,lexer:P,parser:this,destroy:function(){var Ke=!!this.recoverable;for(var St in this)this.hasOwnProperty(St)&&typeof St=="object"&&(this[St]=void 0);this.recoverable=Ke}};return this.__error_infos.push(Ie),Ie};function X(W){var J=h.getSymbolName(W);return J||(J=W),J}function Q(){var W=P.lex();return typeof W!="number"&&(W=h.symbols_[W]||W),W||C}function ie(){var W=P.fastLex();return typeof W!="number"&&(W=h.symbols_[W]||W),W||C}var pe=Q,de,F,H,Z,j={$:!0,_$:void 0,yy:z},$,q,ae,le,fe=!1;try{if(this.__reentrant_call_depth++,P.setInput(u,z),typeof P.canIUse=="function"){var Se=P.canIUse();Se.fastLex&&typeof ie=="function"&&(pe=ie)}for(w[S]=null,_[S]=0,g[S]=0,++S,this.pre_parse&&this.pre_parse.call(this,z),z.pre_parse&&z.pre_parse.call(this,z),le=_[S-1];;){if(de=le,this.defaultActions[de])F=2,le=this.defaultActions[de];else if(A||(A=pe()),Z=E[de]&&E[de][A]||D,le=Z[1],F=Z[0],!F){var ke,xe=this.describeSymbol(A)||A,se=this.collect_expected_token_set(de);typeof P.yylineno=="number"?ke="Parse error on line "+(P.yylineno+1)+": ":ke="Parse error: ",typeof P.showPosition=="function"&&(ke+=`
`+P.showPosition(79-10,10)+`
`),se.length?ke+="Expecting "+se.join(", ")+", got unexpected "+xe:ke+="Unexpected "+xe,$=this.constructParseErrorInfo(ke,null,se,!1),H=this.parseError($.errStr,$,this.JisonParserError),typeof H<"u"&&(fe=H);break}switch(F){default:if(F instanceof Array){$=this.constructParseErrorInfo("Parse Error: multiple actions possible at state: "+de+", token: "+A,null,null,!1),H=this.parseError($.errStr,$,this.JisonParserError),typeof H<"u"&&(fe=H);break}$=this.constructParseErrorInfo("Parsing halted. No viable error recovery approach available due to internal system failure.",null,null,!1),H=this.parseError($.errStr,$,this.JisonParserError),typeof H<"u"&&(fe=H);break;case 1:g[S]=A,w[S]=P.yytext,_[S]=le,++S,A=0;continue;case 2:if(ae=this.productions_[le-1],q=ae[1],H=this.performAction.call(j,le,S-1,w),typeof H<"u"){fe=H;break}S-=q;var be=ae[0];g[S]=be,w[S]=j.$,le=E[_[S-1]][be],_[S]=le,++S;continue;case 3:S!==-2&&(fe=!0,S--,typeof w[S]<"u"&&(fe=w[S]));break}break}}catch(W){if(W instanceof this.JisonParserError)throw W;if(P&&typeof P.JisonLexerError=="function"&&W instanceof P.JisonLexerError)throw W;$=this.constructParseErrorInfo("Parsing aborted due to exception.",W,null,!1),fe=!1,H=this.parseError($.errStr,$,this.JisonParserError),typeof H<"u"&&(fe=H)}finally{fe=this.cleanupAfterParse(fe,!0,!0),this.__reentrant_call_depth--}return fe}};s.originalParseError=s.parseError,s.originalQuoteName=s.quoteName;var l=function(){function f(h,g){Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonLexerError"}),h==null&&(h="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:h}),this.hash=g;var _;if(g&&g.exception instanceof Error){var w=g.exception;this.message=w.message||h,_=w.stack}_||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):_=new Error(h).stack),_&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:_})}typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(f.prototype,Error.prototype):f.prototype=Object.create(Error.prototype),f.prototype.constructor=f,f.prototype.name="JisonLexerError";var u={EOF:1,ERROR:2,__currentRuleSet__:null,__error_infos:[],__decompressed:!1,done:!1,_backtrack:!1,_input:"",_more:!1,_signaled_error_token:!1,conditionStack:[],match:"",matched:"",matches:!1,yytext:"",offset:0,yyleng:0,yylineno:0,yylloc:null,constructLexErrorInfo:function(g,_,w){if(g=""+g,w==null&&(w=!(g.indexOf(`
`)>0&&g.indexOf("^")>0)),this.yylloc&&w){if(typeof this.prettyPrintRange=="function"){var E=this.prettyPrintRange(this.yylloc);/\n\s*$/.test(g)||(g+=`
`),g+=`
  Erroneous area:
`+this.prettyPrintRange(this.yylloc)}else if(typeof this.showPosition=="function"){var S=this.showPosition();S&&(g.length&&g[g.length-1]!==`
`&&S[0]!==`
`?g+=`
`+S:g+=S)}}var A={errStr:g,recoverable:!!_,text:this.match,token:null,line:this.yylineno,loc:this.yylloc,yy:this.yy,lexer:this,destroy:function(){var C=!!this.recoverable;for(var T in this)this.hasOwnProperty(T)&&typeof T=="object"&&(this[T]=void 0);this.recoverable=C}};return this.__error_infos.push(A),A},parseError:function(g,_,w){if(w||(w=this.JisonLexerError),this.yy){if(this.yy.parser&&typeof this.yy.parser.parseError=="function")return this.yy.parser.parseError.call(this,g,_,w)||this.ERROR;if(typeof this.yy.parseError=="function")return this.yy.parseError.call(this,g,_,w)||this.ERROR}throw new w(g,_)},yyerror:function(g){var _="";this.yylloc&&(_=" on line "+(this.yylineno+1));var w=this.constructLexErrorInfo("Lexical error"+_+": "+g,this.options.lexerErrorsAreRecoverable),E=Array.prototype.slice.call(arguments,1);return E.length&&(w.extra_error_attributes=E),this.parseError(w.errStr,w,this.JisonLexerError)||this.ERROR},cleanupAfterLex:function(g){if(this.setInput("",{}),!g){for(var _=this.__error_infos.length-1;_>=0;_--){var w=this.__error_infos[_];w&&typeof w.destroy=="function"&&w.destroy()}this.__error_infos.length=0}return this},clear:function(){this.yytext="",this.yyleng=0,this.match="",this.matches=!1,this._more=!1,this._backtrack=!1;var g=this.yylloc?this.yylloc.last_column:0;this.yylloc={first_line:this.yylineno+1,first_column:g,last_line:this.yylineno+1,last_column:g,range:[this.offset,this.offset]}},setInput:function(g,_){if(this.yy=_||this.yy||{},!this.__decompressed){for(var w=this.rules,E=0,S=w.length;E<S;E++){var A=w[E];typeof A=="number"&&(w[E]=w[A])}var O=this.conditions;for(var C in O){for(var T=O[C],D=T.rules,S=D.length,P=new Array(S+1),z=new Array(S+1),E=0;E<S;E++){var ne=D[E],A=w[ne];P[E+1]=A,z[E+1]=ne}T.rules=z,T.__rule_regexes=P,T.__rule_count=S}this.__decompressed=!0}return this._input=g||"",this.clear(),this._signaled_error_token=!1,this.done=!1,this.yylineno=0,this.matched="",this.conditionStack=["INITIAL"],this.__currentRuleSet__=null,this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]},this.offset=0,this},editRemainingInput:function(g,_){var w=g.call(this,this._input,_);return typeof w!="string"?w&&(this._input=""+w):this._input=w,this},input:function(){if(!this._input)return null;var g=this._input[0];this.yytext+=g,this.yyleng++,this.offset++,this.match+=g,this.matched+=g;var _=1,w=!1;if(g===`
`)w=!0;else if(g==="\r"){w=!0;var E=this._input[1];E===`
`&&(_++,g+=E,this.yytext+=E,this.yyleng++,this.offset++,this.match+=E,this.matched+=E,this.yylloc.range[1]++)}return w?(this.yylineno++,this.yylloc.last_line++,this.yylloc.last_column=0):this.yylloc.last_column++,this.yylloc.range[1]++,this._input=this._input.slice(_),g},unput:function(g){var _=g.length,w=g.split(/(?:\r\n?|\n)/g);if(this._input=g+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-_),this.yyleng=this.yytext.length,this.offset-=_,this.match=this.match.substr(0,this.match.length-_),this.matched=this.matched.substr(0,this.matched.length-_),w.length>1){this.yylineno-=w.length-1,this.yylloc.last_line=this.yylineno+1;var E=this.match,S=E.split(/(?:\r\n?|\n)/g);S.length===1&&(E=this.matched,S=E.split(/(?:\r\n?|\n)/g)),this.yylloc.last_column=S[S.length-1].length}else this.yylloc.last_column-=_;return this.yylloc.range[1]=this.yylloc.range[0]+this.yyleng,this.done=!1,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else{var g="";this.yylloc&&(g=" on line "+(this.yylineno+1));var _=this.constructLexErrorInfo("Lexical error"+g+": You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).",!1);this._signaled_error_token=this.parseError(_.errStr,_,this.JisonLexerError)||this.ERROR}return this},less:function(g){return this.unput(this.match.slice(g))},pastInput:function(g,_){var w=this.matched.substring(0,this.matched.length-this.match.length);g<0?g=w.length:g||(g=20),_<0?_=w.length:_||(_=1),w=w.substr(-g*2-2);var E=w.replace(/\r\n|\r/g,`
`).split(`
`);return E=E.slice(-_),w=E.join(`
`),w.length>g&&(w="..."+w.substr(-g)),w},upcomingInput:function(g,_){var w=this.match;g<0?g=w.length+this._input.length:g||(g=20),_<0?_=g:_||(_=1),w.length<g*2+2&&(w+=this._input.substring(0,g*2+2));var E=w.replace(/\r\n|\r/g,`
`).split(`
`);return E=E.slice(0,_),w=E.join(`
`),w.length>g&&(w=w.substring(0,g)+"..."),w},showPosition:function(g,_){var w=this.pastInput(g).replace(/\s/g," "),E=new Array(w.length+1).join("-");return w+this.upcomingInput(_).replace(/\s/g," ")+`
`+E+"^"},deriveLocationInfo:function(g,_,w,E){var S={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]};return g&&(S.first_line=g.first_line|0,S.last_line=g.last_line|0,S.first_column=g.first_column|0,S.last_column=g.last_column|0,g.range&&(S.range[0]=g.range[0]|0,S.range[1]=g.range[1]|0)),(S.first_line<=0||S.last_line<S.first_line)&&(S.first_line<=0&&_&&(S.first_line=_.last_line|0,S.first_column=_.last_column|0,_.range&&(S.range[0]=g.range[1]|0)),(S.last_line<=0||S.last_line<S.first_line)&&w&&(S.last_line=w.first_line|0,S.last_column=w.first_column|0,w.range&&(S.range[1]=g.range[0]|0)),S.first_line<=0&&E&&(S.last_line<=0||E.last_line<=S.last_line)&&(S.first_line=E.first_line|0,S.first_column=E.first_column|0,E.range&&(S.range[0]=E.range[0]|0)),S.last_line<=0&&E&&(S.first_line<=0||E.first_line>=S.first_line)&&(S.last_line=E.last_line|0,S.last_column=E.last_column|0,E.range&&(S.range[1]=E.range[1]|0))),S.last_line<=0&&(S.first_line<=0?(S.first_line=this.yylloc.first_line,S.last_line=this.yylloc.last_line,S.first_column=this.yylloc.first_column,S.last_column=this.yylloc.last_column,S.range[0]=this.yylloc.range[0],S.range[1]=this.yylloc.range[1]):(S.last_line=this.yylloc.last_line,S.last_column=this.yylloc.last_column,S.range[1]=this.yylloc.range[1])),S.first_line<=0&&(S.first_line=S.last_line,S.first_column=0,S.range[1]=S.range[0]),S.first_column<0&&(S.first_column=0),S.last_column<0&&(S.last_column=S.first_column>0?S.first_column:80),S},prettyPrintRange:function(g,_,w){g=this.deriveLocationInfo(g,_,w);let E=3,S=1,A=2;var O=this.matched+this._input,C=O.split(`
`),T=Math.max(1,_?_.first_line:g.first_line-E),D=Math.max(1,w?w.last_line:g.last_line+S),P=1+Math.log10(D|1)|0,z=new Array(P).join(" "),ne=[],V=C.slice(T-1,D+1).map(function(de,F){var H=F+T,Z=(z+H).substr(-P),j=Z+": "+de,$=new Array(P+1).join("^"),q=2+1,ae=0;if(H===g.first_line?(q+=g.first_column,ae=Math.max(2,(H===g.last_line?g.last_column:de.length)-g.first_column+1)):H===g.last_line?ae=Math.max(2,g.last_column+1):H>g.first_line&&H<g.last_line&&(ae=Math.max(2,de.length+1)),ae){var le=new Array(q).join("."),fe=new Array(ae).join("^");j+=`
`+$+le+fe,de.trim().length>0&&ne.push(F)}return j=j.replace(/\t/g," "),j});if(ne.length>2*A){var X=ne[A-1]+1,Q=ne[ne.length-A]-1,ie=new Array(P+1).join(" ")+"  (...continued...)";ie+=`
`+new Array(P+1).join("-")+"  (---------------)",V.splice(X,Q-X+1,ie)}return V.join(`
`)},describeYYLLOC:function(g,_){var w=g.first_line,E=g.last_line,S=g.first_column,A=g.last_column,O=E-w,C=A-S,T;if(O===0?(T="line "+w+", ",C<=1?T+="column "+S:T+="columns "+S+" .. "+A):T="lines "+w+"(column "+S+") .. "+E+"(column "+A+")",g.range&&_){var D=g.range[0],P=g.range[1]-1;P<=D?T+=" {String Offset: "+D+"}":T+=" {String Offset range: "+D+" .. "+P+"}"}return T},test_match:function(g,_){var w,E,S,A,O;if(this.options.backtrack_lexer&&(S={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.yylloc.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column,range:this.yylloc.range.slice(0)},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done}),A=g[0],O=A.length,E=A.split(/(?:\r\n?|\n)/g),E.length>1?(this.yylineno+=E.length-1,this.yylloc.last_line=this.yylineno+1,this.yylloc.last_column=E[E.length-1].length):this.yylloc.last_column+=O,this.yytext+=A,this.match+=A,this.matched+=A,this.matches=g,this.yyleng=this.yytext.length,this.yylloc.range[1]+=O,this.offset+=O,this._more=!1,this._backtrack=!1,this._input=this._input.slice(O),w=this.performAction.call(this,this.yy,_,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),w)return w;if(this._backtrack){for(var C in S)this[C]=S[C];return this.__currentRuleSet__=null,!1}else if(this._signaled_error_token)return w=this._signaled_error_token,this._signaled_error_token=!1,w;return!1},next:function(){if(this.done)return this.clear(),this.EOF;this._input||(this.done=!0);var g,_,w,E;this._more||this.clear();var S=this.__currentRuleSet__;if(!S&&(S=this.__currentRuleSet__=this._currentRules(),!S||!S.rules)){var A="";this.options.trackPosition&&(A=" on line "+(this.yylineno+1));var O=this.constructLexErrorInfo("Internal lexer engine error"+A+': The lex grammar programmer pushed a non-existing condition name "'+this.topState()+'"; this is a fatal error and should be reported to the application programmer team!',!1);return this.parseError(O.errStr,O,this.JisonLexerError)||this.ERROR}for(var C=S.rules,T=S.__rule_regexes,D=S.__rule_count,P=1;P<=D;P++)if(w=this._input.match(T[P]),w&&(!_||w[0].length>_[0].length)){if(_=w,E=P,this.options.backtrack_lexer){if(g=this.test_match(w,C[P]),g!==!1)return g;if(this._backtrack){_=void 0;continue}else return!1}else if(!this.options.flex)break}if(_)return g=this.test_match(_,C[E]),g!==!1?g:!1;if(this._input){var A="";this.options.trackPosition&&(A=" on line "+(this.yylineno+1));var O=this.constructLexErrorInfo("Lexical error"+A+": Unrecognized text.",this.options.lexerErrorsAreRecoverable),z=this._input,ne=this.topState(),V=this.conditionStack.length;return g=this.parseError(O.errStr,O,this.JisonLexerError)||this.ERROR,g===this.ERROR&&!this.matches&&z===this._input&&ne===this.topState()&&V===this.conditionStack.length&&this.input(),g}else return this.done=!0,this.clear(),this.EOF},lex:function(){var g;for(typeof this.pre_lex=="function"&&(g=this.pre_lex.call(this,0)),typeof this.options.pre_lex=="function"&&(g=this.options.pre_lex.call(this,g)||g),this.yy&&typeof this.yy.pre_lex=="function"&&(g=this.yy.pre_lex.call(this,g)||g);!g;)g=this.next();return this.yy&&typeof this.yy.post_lex=="function"&&(g=this.yy.post_lex.call(this,g)||g),typeof this.options.post_lex=="function"&&(g=this.options.post_lex.call(this,g)||g),typeof this.post_lex=="function"&&(g=this.post_lex.call(this,g)||g),g},fastLex:function(){for(var g;!g;)g=this.next();return g},canIUse:function(){var g={fastLex:!(typeof this.pre_lex=="function"||typeof this.options.pre_lex=="function"||this.yy&&typeof this.yy.pre_lex=="function"||this.yy&&typeof this.yy.post_lex=="function"||typeof this.options.post_lex=="function"||typeof this.post_lex=="function")&&typeof this.fastLex=="function"};return g},begin:function(g){return this.pushState(g)},pushState:function(g){return this.conditionStack.push(g),this.__currentRuleSet__=null,this},popState:function(){var g=this.conditionStack.length-1;return g>0?(this.__currentRuleSet__=null,this.conditionStack.pop()):this.conditionStack[0]},topState:function(g){return g=this.conditionStack.length-1-Math.abs(g||0),g>=0?this.conditionStack[g]:"INITIAL"},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL},stateStackSize:function(){return this.conditionStack.length},options:{trackPosition:!0},JisonLexerError:f,performAction:function(g,_,w){var E=this,S=w;switch(_){case 1:break;default:return this.simpleCaseActionClusters[_]}},simpleCaseActionClusters:{0:13,2:5,3:6,4:3,5:4,6:15,7:15,8:15,9:15,10:15,11:15,12:16,13:16,14:16,15:16,16:17,17:17,18:18,19:18,20:19,21:19,22:19,23:20,24:21,25:22,26:23,27:25,28:24,29:26,30:27,31:28,32:11,33:9,34:12,35:10,36:7,37:8,38:14,39:1},rules:[/^(?:(--[\d\-A-Za-z]*))/,/^(?:\s+)/,/^(?:\*)/,/^(?:\/)/,/^(?:\+)/,/^(?:-)/,/^(?:(\d+(\.\d*)?|\.\d+)px\b)/,/^(?:(\d+(\.\d*)?|\.\d+)cm\b)/,/^(?:(\d+(\.\d*)?|\.\d+)mm\b)/,/^(?:(\d+(\.\d*)?|\.\d+)in\b)/,/^(?:(\d+(\.\d*)?|\.\d+)pt\b)/,/^(?:(\d+(\.\d*)?|\.\d+)pc\b)/,/^(?:(\d+(\.\d*)?|\.\d+)deg\b)/,/^(?:(\d+(\.\d*)?|\.\d+)grad\b)/,/^(?:(\d+(\.\d*)?|\.\d+)rad\b)/,/^(?:(\d+(\.\d*)?|\.\d+)turn\b)/,/^(?:(\d+(\.\d*)?|\.\d+)s\b)/,/^(?:(\d+(\.\d*)?|\.\d+)ms\b)/,/^(?:(\d+(\.\d*)?|\.\d+)Hz\b)/,/^(?:(\d+(\.\d*)?|\.\d+)kHz\b)/,/^(?:(\d+(\.\d*)?|\.\d+)dpi\b)/,/^(?:(\d+(\.\d*)?|\.\d+)dpcm\b)/,/^(?:(\d+(\.\d*)?|\.\d+)dppx\b)/,/^(?:(\d+(\.\d*)?|\.\d+)em\b)/,/^(?:(\d+(\.\d*)?|\.\d+)ex\b)/,/^(?:(\d+(\.\d*)?|\.\d+)ch\b)/,/^(?:(\d+(\.\d*)?|\.\d+)rem\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vw\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vh\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vmin\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vmax\b)/,/^(?:(\d+(\.\d*)?|\.\d+)%)/,/^(?:(\d+(\.\d*)?|\.\d+)\b)/,/^(?:(calc))/,/^(?:(var))/,/^(?:([a-z]+))/,/^(?:\()/,/^(?:\))/,/^(?:,)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39],inclusive:!0}}};return u}();s.lexer=l;function c(){this.yy={}}return c.prototype=s,s.Parser=c,new c}();typeof Mr<"u"&&typeof hy<"u"&&(hy.parser=J0,hy.Parser=J0.Parser,hy.parse=function(){return J0.parse.apply(J0,arguments)})});var Xz=ce((lRe,Kz)=>{var kI={px:{px:1,cm:37.79527559055118,mm:3.7795275590551185,in:96,pt:1.3333333333333333,pc:16},cm:{px:.026458333333333334,cm:1,mm:.1,in:2.54,pt:.035277777777777776,pc:.42333333333333334},mm:{px:.26458333333333334,cm:10,mm:1,in:25.4,pt:.35277777777777775,pc:4.233333333333333},in:{px:.010416666666666666,cm:.39370078740157477,mm:.03937007874015748,in:1,pt:.013888888888888888,pc:.16666666666666666},pt:{px:.75,cm:28.346456692913385,mm:2.834645669291339,in:72,pt:1,pc:12},pc:{px:.0625,cm:2.3622047244094486,mm:.2362204724409449,in:6,pt:.08333333333333333,pc:1},deg:{deg:1,grad:.9,rad:180/Math.PI,turn:360},grad:{deg:1.1111111111111112,grad:1,rad:200/Math.PI,turn:400},rad:{deg:Math.PI/180,grad:Math.PI/200,rad:1,turn:Math.PI*2},turn:{deg:.002777777777777778,grad:.0025,rad:.5/Math.PI,turn:1},s:{s:1,ms:.001},ms:{s:1e3,ms:1},Hz:{Hz:1,kHz:1e3},kHz:{Hz:.001,kHz:1},dpi:{dpi:1,dpcm:.39370078740157477,dppx:.010416666666666666},dpcm:{dpi:2.54,dpcm:1,dppx:.026458333333333334},dppx:{dpi:96,dpcm:37.79527559055118,dppx:1}};Kz.exports=function(e,t,r,n){if(!kI.hasOwnProperty(r))throw new Error("Cannot convert to "+r);if(!kI[r].hasOwnProperty(t))throw new Error("Cannot convert from "+t+" to "+r);var i=kI[r][t]*e;return n!==!1?(n=Math.pow(10,parseInt(n)||5),Math.round(i*n)/n):i}});var Qz=ce((G0,Zz)=>{"use strict";Object.defineProperty(G0,"__esModule",{value:!0});var ime=Xz(),ame=ome(ime);function ome(e){return e&&e.__esModule?e:{default:e}}function sme(e,t,r){switch(e.type){case"LengthValue":case"AngleValue":case"TimeValue":case"FrequencyValue":case"ResolutionValue":return lme(e,t,r);default:return{left:e,right:t}}}function lme(e,t,r){return t.type===e.type&&(t={type:e.type,value:(0,ame.default)(t.value,t.unit,e.unit,r),unit:e.unit}),{left:e,right:t}}G0.default=sme;Zz.exports=G0.default});var II=ce(Y0=>{"use strict";Object.defineProperty(Y0,"__esModule",{value:!0});Y0.flip=OI;var cme=Qz(),EI=ume(cme);function ume(e){return e&&e.__esModule?e:{default:e}}function ti(e,t){return e.type==="MathExpression"?gme(e,t):e.type==="Calc"?ti(e.value,t):e}function e9(e,t){return e.type===t.type&&e.value===t.value}function Mi(e){switch(e){case"LengthValue":case"AngleValue":case"TimeValue":case"FrequencyValue":case"ResolutionValue":case"EmValue":case"ExValue":case"ChValue":case"RemValue":case"VhValue":case"VwValue":case"VminValue":case"VmaxValue":case"PercentageValue":case"Value":return!0}return!1}function fme(e,t){var r=(0,EI.default)(e.left,e.right,t),n=ti(r.left,t),i=ti(r.right,t);return n.type==="MathExpression"&&i.type==="MathExpression"&&(n.operator==="/"&&i.operator==="*"||n.operator==="-"&&i.operator==="+"||n.operator==="*"&&i.operator==="/"||n.operator==="+"&&i.operator==="-")&&(e9(n.right,i.right)?r=(0,EI.default)(n.left,i.left,t):e9(n.right,i.left)&&(r=(0,EI.default)(n.left,i.right,t)),n=ti(r.left,t),i=ti(r.right,t)),e.left=n,e.right=i,e}function OI(e){return e==="+"?"-":"+"}function AI(e){return Mi(e.type)?e.value=-e.value:e.type=="MathExpression"&&(e.left=AI(e.left),e.right=AI(e.right)),e}function dme(e,t){var r=e,n=r.left,i=r.right,a=r.operator;if(n.type==="CssVariable"||i.type==="CssVariable")return e;if(i.value===0)return n;if(n.value===0&&a==="+")return i;if(n.value===0&&a==="-")return AI(i);if(n.type===i.type&&Mi(n.type)&&(e=Object.assign({},n),a==="+"?e.value=n.value+i.value:e.value=n.value-i.value),Mi(n.type)&&(i.operator==="+"||i.operator==="-")&&i.type==="MathExpression"){if(n.type===i.left.type)return e=Object.assign({},e),e.left=ti({type:"MathExpression",operator:a,left:n,right:i.left},t),e.right=i.right,e.operator=a==="-"?OI(i.operator):i.operator,ti(e,t);if(n.type===i.right.type)return e=Object.assign({},e),e.left=ti({type:"MathExpression",operator:a==="-"?OI(i.operator):i.operator,left:n,right:i.right},t),e.right=i.left,ti(e,t)}if(n.type==="MathExpression"&&(n.operator==="+"||n.operator==="-")&&Mi(i.type)){if(i.type===n.left.type)return e=Object.assign({},n),e.left=ti({type:"MathExpression",operator:a,left:n.left,right:i},t),ti(e,t);if(i.type===n.right.type)return e=Object.assign({},n),n.operator==="-"?(e.right=ti({type:"MathExpression",operator:a==="-"?"+":"-",left:i,right:n.right},t),e.operator=a==="-"?"-":"+"):e.right=ti({type:"MathExpression",operator:a,left:n.right,right:i},t),e.right.value<0&&(e.right.value*=-1,e.operator=e.operator==="-"?"+":"-"),ti(e,t)}return e}function pme(e,t){if(!Mi(e.right.type))return e;if(e.right.type!=="Value")throw new Error('Cannot divide by "'+e.right.unit+'", number expected');if(e.right.value===0)throw new Error("Cannot divide by zero");return e.left.type==="MathExpression"?Mi(e.left.left.type)&&Mi(e.left.right.type)?(e.left.left.value/=e.right.value,e.left.right.value/=e.right.value,ti(e.left,t)):e:Mi(e.left.type)?(e.left.value/=e.right.value,e.left):e}function hme(e){if(e.left.type==="MathExpression"&&e.right.type==="Value"){if(Mi(e.left.left.type)&&Mi(e.left.right.type))return e.left.left.value*=e.right.value,e.left.right.value*=e.right.value,e.left}else{if(Mi(e.left.type)&&e.right.type==="Value")return e.left.value*=e.right.value,e.left;if(e.left.type==="Value"&&e.right.type==="MathExpression"){if(Mi(e.right.left.type)&&Mi(e.right.right.type))return e.right.left.value*=e.left.value,e.right.right.value*=e.left.value,e.right}else if(e.left.type==="Value"&&Mi(e.right.type))return e.right.value*=e.left.value,e.right}return e}function gme(e,t){switch(e=fme(e,t),e.operator){case"+":case"-":return dme(e,t);case"/":return pme(e,t);case"*":return hme(e)}return e}Y0.default=ti});var n9=ce((X0,r9)=>{"use strict";Object.defineProperty(X0,"__esModule",{value:!0});X0.default=function(e,t,r){var n=Fs(t,r);return t.type==="MathExpression"&&(n=e+"("+n+")"),n};var yme=II(),K0={"*":0,"/":0,"+":1,"-":1};function t9(e,t){if(t!==!1){var r=Math.pow(10,t);return Math.round(e*r)/r}return e}function Fs(e,t){switch(e.type){case"MathExpression":{var r=e.left,n=e.right,i=e.operator,a="";return r.type==="MathExpression"&&K0[i]<K0[r.operator]?a+="("+Fs(r,t)+")":a+=Fs(r,t),a+=" "+e.operator+" ",n.type==="MathExpression"&&K0[i]<K0[n.operator]?a+="("+Fs(n,t)+")":(n.type==="MathExpression"&&i==="-"&&["+","-"].includes(n.operator)&&(n.operator=(0,yme.flip)(n.operator)),a+=Fs(n,t)),a}case"Value":return t9(e.value,t);case"CssVariable":return e.fallback?"var("+e.value+", "+Fs(e.fallback,t,!0)+")":"var("+e.value+")";case"Calc":return e.prefix?"-"+e.prefix+"-calc("+Fs(e.value,t)+")":"calc("+Fs(e.value,t)+")";default:return t9(e.value,t)+e.unit}}r9.exports=X0.default});var o9=ce((Z0,a9)=>{"use strict";Object.defineProperty(Z0,"__esModule",{value:!0});var mme=Gz(),i9=CI(mme),vme=Yz(),bme=II(),_me=CI(bme),wme=n9(),Sme=CI(wme);function CI(e){return e&&e.__esModule?e:{default:e}}var xme=/((?:\-[a-z]+\-)?calc)/;Z0.default=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return(0,i9.default)(e).walk(function(r){if(!(r.type!=="function"||!xme.test(r.value))){var n=i9.default.stringify(r.nodes);if(!(n.indexOf("constant")>=0||n.indexOf("env")>=0)){var i=vme.parser.parse(n),a=(0,_me.default)(i,t);r.type="word",r.value=(0,Sme.default)(r.value,a,t)}}},!0).toString()};a9.exports=Z0.default});var e2=ce((mRe,_9)=>{var Wme=f0();function Jme(e,t){return Wme(e,t)}_9.exports=Jme});var PI=ce((vRe,w9)=>{var Gme=Wc();function Yme(e,t,r){for(var n=-1,i=e.length;++n<i;){var a=e[n],o=t(a);if(o!=null&&(s===void 0?o===o&&!Gme(o):r(o,s)))var s=o,l=a}return l}w9.exports=Yme});var x9=ce((bRe,S9)=>{function Kme(e,t){return e>t}S9.exports=Kme});var E9=ce((_Re,k9)=>{var Xme=PI(),Zme=x9(),Qme=Zc();function eve(e){return e&&e.length?Xme(e,Qme,Zme):void 0}k9.exports=eve});var A9=ce((wRe,O9)=>{function tve(e,t){return e<t}O9.exports=tve});var C9=ce((SRe,I9)=>{var rve=PI(),nve=A9(),ive=Zc();function ave(e){return e&&e.length?rve(e,ive,nve):void 0}I9.exports=ave});var N9=ce((xRe,T9)=>{var ove=q_(),sve=Ts(),lve=rI(),cve=Vr();function uve(e,t){var r=cve(e)?ove:lve;return r(e,sve(t,3))}T9.exports=uve});var P9=ce((kRe,L9)=>{var fve=eI(),dve=N9();function pve(e,t){return fve(dve(e,t),1)}L9.exports=pve});var gC=ce((t7,R2)=>{(function(e){"use strict";var t=1e9,r={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},n=!0,i="[DecimalError] ",a=i+"Invalid argument: ",o=i+"Exponent out of range: ",s=Math.floor,l=Math.pow,c=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,f,u=1e7,h=7,g=9007199254740991,_=s(g/h),w={};w.absoluteValue=w.abs=function(){var F=new this.constructor(this);return F.s&&(F.s=1),F},w.comparedTo=w.cmp=function(F){var H,Z,j,$,q=this;if(F=new q.constructor(F),q.s!==F.s)return q.s||-F.s;if(q.e!==F.e)return q.e>F.e^q.s<0?1:-1;for(j=q.d.length,$=F.d.length,H=0,Z=j<$?j:$;H<Z;++H)if(q.d[H]!==F.d[H])return q.d[H]>F.d[H]^q.s<0?1:-1;return j===$?0:j>$^q.s<0?1:-1},w.decimalPlaces=w.dp=function(){var F=this,H=F.d.length-1,Z=(H-F.e)*h;if(H=F.d[H],H)for(;H%10==0;H/=10)Z--;return Z<0?0:Z},w.dividedBy=w.div=function(F){return O(this,new this.constructor(F))},w.dividedToIntegerBy=w.idiv=function(F){var H=this,Z=H.constructor;return V(O(H,new Z(F),0,1),Z.precision)},w.equals=w.eq=function(F){return!this.cmp(F)},w.exponent=function(){return T(this)},w.greaterThan=w.gt=function(F){return this.cmp(F)>0},w.greaterThanOrEqualTo=w.gte=function(F){return this.cmp(F)>=0},w.isInteger=w.isint=function(){return this.e>this.d.length-2},w.isNegative=w.isneg=function(){return this.s<0},w.isPositive=w.ispos=function(){return this.s>0},w.isZero=function(){return this.s===0},w.lessThan=w.lt=function(F){return this.cmp(F)<0},w.lessThanOrEqualTo=w.lte=function(F){return this.cmp(F)<1},w.logarithm=w.log=function(F){var H,Z=this,j=Z.constructor,$=j.precision,q=$+5;if(F===void 0)F=new j(10);else if(F=new j(F),F.s<1||F.eq(f))throw Error(i+"NaN");if(Z.s<1)throw Error(i+(Z.s?"NaN":"-Infinity"));return Z.eq(f)?new j(0):(n=!1,H=O(z(Z,q),z(F,q),q),n=!0,V(H,$))},w.minus=w.sub=function(F){var H=this;return F=new H.constructor(F),H.s==F.s?X(H,F):E(H,(F.s=-F.s,F))},w.modulo=w.mod=function(F){var H,Z=this,j=Z.constructor,$=j.precision;if(F=new j(F),!F.s)throw Error(i+"NaN");return Z.s?(n=!1,H=O(Z,F,0,1).times(F),n=!0,Z.minus(H)):V(new j(Z),$)},w.naturalExponential=w.exp=function(){return C(this)},w.naturalLogarithm=w.ln=function(){return z(this)},w.negated=w.neg=function(){var F=new this.constructor(this);return F.s=-F.s||0,F},w.plus=w.add=function(F){var H=this;return F=new H.constructor(F),H.s==F.s?E(H,F):X(H,(F.s=-F.s,F))},w.precision=w.sd=function(F){var H,Z,j,$=this;if(F!==void 0&&F!==!!F&&F!==1&&F!==0)throw Error(a+F);if(H=T($)+1,j=$.d.length-1,Z=j*h+1,j=$.d[j],j){for(;j%10==0;j/=10)Z--;for(j=$.d[0];j>=10;j/=10)Z++}return F&&H>Z?H:Z},w.squareRoot=w.sqrt=function(){var F,H,Z,j,$,q,ae,le=this,fe=le.constructor;if(le.s<1){if(!le.s)return new fe(0);throw Error(i+"NaN")}for(F=T(le),n=!1,$=Math.sqrt(+le),$==0||$==1/0?(H=A(le.d),(H.length+F)%2==0&&(H+="0"),$=Math.sqrt(H),F=s((F+1)/2)-(F<0||F%2),$==1/0?H="5e"+F:(H=$.toExponential(),H=H.slice(0,H.indexOf("e")+1)+F),j=new fe(H)):j=new fe($.toString()),Z=fe.precision,$=ae=Z+3;;)if(q=j,j=q.plus(O(le,q,ae+2)).times(.5),A(q.d).slice(0,ae)===(H=A(j.d)).slice(0,ae)){if(H=H.slice(ae-3,ae+1),$==ae&&H=="4999"){if(V(q,Z+1,0),q.times(q).eq(le)){j=q;break}}else if(H!="9999")break;ae+=4}return n=!0,V(j,Z)},w.times=w.mul=function(F){var H,Z,j,$,q,ae,le,fe,Se,ke=this,xe=ke.constructor,se=ke.d,be=(F=new xe(F)).d;if(!ke.s||!F.s)return new xe(0);for(F.s*=ke.s,Z=ke.e+F.e,fe=se.length,Se=be.length,fe<Se&&(q=se,se=be,be=q,ae=fe,fe=Se,Se=ae),q=[],ae=fe+Se,j=ae;j--;)q.push(0);for(j=Se;--j>=0;){for(H=0,$=fe+j;$>j;)le=q[$]+be[j]*se[$-j-1]+H,q[$--]=le%u|0,H=le/u|0;q[$]=(q[$]+H)%u|0}for(;!q[--ae];)q.pop();return H?++Z:q.shift(),F.d=q,F.e=Z,n?V(F,xe.precision):F},w.toDecimalPlaces=w.todp=function(F,H){var Z=this,j=Z.constructor;return Z=new j(Z),F===void 0?Z:(S(F,0,t),H===void 0?H=j.rounding:S(H,0,8),V(Z,F+T(Z)+1,H))},w.toExponential=function(F,H){var Z,j=this,$=j.constructor;return F===void 0?Z=Q(j,!0):(S(F,0,t),H===void 0?H=$.rounding:S(H,0,8),j=V(new $(j),F+1,H),Z=Q(j,!0,F+1)),Z},w.toFixed=function(F,H){var Z,j,$=this,q=$.constructor;return F===void 0?Q($):(S(F,0,t),H===void 0?H=q.rounding:S(H,0,8),j=V(new q($),F+T($)+1,H),Z=Q(j.abs(),!1,F+T(j)+1),$.isneg()&&!$.isZero()?"-"+Z:Z)},w.toInteger=w.toint=function(){var F=this,H=F.constructor;return V(new H(F),T(F)+1,H.rounding)},w.toNumber=function(){return+this},w.toPower=w.pow=function(F){var H,Z,j,$,q,ae,le=this,fe=le.constructor,Se=12,ke=+(F=new fe(F));if(!F.s)return new fe(f);if(le=new fe(le),!le.s){if(F.s<1)throw Error(i+"Infinity");return le}if(le.eq(f))return le;if(j=fe.precision,F.eq(f))return V(le,j);if(H=F.e,Z=F.d.length-1,ae=H>=Z,q=le.s,ae){if((Z=ke<0?-ke:ke)<=g){for($=new fe(f),H=Math.ceil(j/h+4),n=!1;Z%2&&($=$.times(le),ie($.d,H)),Z=s(Z/2),Z!==0;)le=le.times(le),ie(le.d,H);return n=!0,F.s<0?new fe(f).div($):V($,j)}}else if(q<0)throw Error(i+"NaN");return q=q<0&&F.d[Math.max(H,Z)]&1?-1:1,le.s=1,n=!1,$=F.times(z(le,j+Se)),n=!0,$=C($),$.s=q,$},w.toPrecision=function(F,H){var Z,j,$=this,q=$.constructor;return F===void 0?(Z=T($),j=Q($,Z<=q.toExpNeg||Z>=q.toExpPos)):(S(F,1,t),H===void 0?H=q.rounding:S(H,0,8),$=V(new q($),F,H),Z=T($),j=Q($,F<=Z||Z<=q.toExpNeg,F)),j},w.toSignificantDigits=w.tosd=function(F,H){var Z=this,j=Z.constructor;return F===void 0?(F=j.precision,H=j.rounding):(S(F,1,t),H===void 0?H=j.rounding:S(H,0,8)),V(new j(Z),F,H)},w.toString=w.valueOf=w.val=w.toJSON=function(){var F=this,H=T(F),Z=F.constructor;return Q(F,H<=Z.toExpNeg||H>=Z.toExpPos)};function E(F,H){var Z,j,$,q,ae,le,fe,Se,ke=F.constructor,xe=ke.precision;if(!F.s||!H.s)return H.s||(H=new ke(F)),n?V(H,xe):H;if(fe=F.d,Se=H.d,ae=F.e,$=H.e,fe=fe.slice(),q=ae-$,q){for(q<0?(j=fe,q=-q,le=Se.length):(j=Se,$=ae,le=fe.length),ae=Math.ceil(xe/h),le=ae>le?ae+1:le+1,q>le&&(q=le,j.length=1),j.reverse();q--;)j.push(0);j.reverse()}for(le=fe.length,q=Se.length,le-q<0&&(q=le,j=Se,Se=fe,fe=j),Z=0;q;)Z=(fe[--q]=fe[q]+Se[q]+Z)/u|0,fe[q]%=u;for(Z&&(fe.unshift(Z),++$),le=fe.length;fe[--le]==0;)fe.pop();return H.d=fe,H.e=$,n?V(H,xe):H}function S(F,H,Z){if(F!==~~F||F<H||F>Z)throw Error(a+F)}function A(F){var H,Z,j,$=F.length-1,q="",ae=F[0];if($>0){for(q+=ae,H=1;H<$;H++)j=F[H]+"",Z=h-j.length,Z&&(q+=P(Z)),q+=j;ae=F[H],j=ae+"",Z=h-j.length,Z&&(q+=P(Z))}else if(ae===0)return"0";for(;ae%10===0;)ae/=10;return q+ae}var O=function(){function F(j,$){var q,ae=0,le=j.length;for(j=j.slice();le--;)q=j[le]*$+ae,j[le]=q%u|0,ae=q/u|0;return ae&&j.unshift(ae),j}function H(j,$,q,ae){var le,fe;if(q!=ae)fe=q>ae?1:-1;else for(le=fe=0;le<q;le++)if(j[le]!=$[le]){fe=j[le]>$[le]?1:-1;break}return fe}function Z(j,$,q){for(var ae=0;q--;)j[q]-=ae,ae=j[q]<$[q]?1:0,j[q]=ae*u+j[q]-$[q];for(;!j[0]&&j.length>1;)j.shift()}return function(j,$,q,ae){var le,fe,Se,ke,xe,se,be,W,J,re,Ee,Te,Ie,Ye,Ke,St,_t,ft,ee=j.constructor,B=j.s==$.s?1:-1,R=j.d,te=$.d;if(!j.s)return new ee(j);if(!$.s)throw Error(i+"Division by zero");for(fe=j.e-$.e,_t=te.length,Ke=R.length,be=new ee(B),W=be.d=[],Se=0;te[Se]==(R[Se]||0);)++Se;if(te[Se]>(R[Se]||0)&&--fe,q==null?Te=q=ee.precision:ae?Te=q+(T(j)-T($))+1:Te=q,Te<0)return new ee(0);if(Te=Te/h+2|0,Se=0,_t==1)for(ke=0,te=te[0],Te++;(Se<Ke||ke)&&Te--;Se++)Ie=ke*u+(R[Se]||0),W[Se]=Ie/te|0,ke=Ie%te|0;else{for(ke=u/(te[0]+1)|0,ke>1&&(te=F(te,ke),R=F(R,ke),_t=te.length,Ke=R.length),Ye=_t,J=R.slice(0,_t),re=J.length;re<_t;)J[re++]=0;ft=te.slice(),ft.unshift(0),St=te[0],te[1]>=u/2&&++St;do ke=0,le=H(te,J,_t,re),le<0?(Ee=J[0],_t!=re&&(Ee=Ee*u+(J[1]||0)),ke=Ee/St|0,ke>1?(ke>=u&&(ke=u-1),xe=F(te,ke),se=xe.length,re=J.length,le=H(xe,J,se,re),le==1&&(ke--,Z(xe,_t<se?ft:te,se))):(ke==0&&(le=ke=1),xe=te.slice()),se=xe.length,se<re&&xe.unshift(0),Z(J,xe,re),le==-1&&(re=J.length,le=H(te,J,_t,re),le<1&&(ke++,Z(J,_t<re?ft:te,re))),re=J.length):le===0&&(ke++,J=[0]),W[Se++]=ke,le&&J[0]?J[re++]=R[Ye]||0:(J=[R[Ye]],re=1);while((Ye++<Ke||J[0]!==void 0)&&Te--)}return W[0]||W.shift(),be.e=fe,V(be,ae?q+T(be)+1:q)}}();function C(F,H){var Z,j,$,q,ae,le,fe=0,Se=0,ke=F.constructor,xe=ke.precision;if(T(F)>16)throw Error(o+T(F));if(!F.s)return new ke(f);for(H==null?(n=!1,le=xe):le=H,ae=new ke(.03125);F.abs().gte(.1);)F=F.times(ae),Se+=5;for(j=Math.log(l(2,Se))/Math.LN10*2+5|0,le+=j,Z=$=q=new ke(f),ke.precision=le;;){if($=V($.times(F),le),Z=Z.times(++fe),ae=q.plus(O($,Z,le)),A(ae.d).slice(0,le)===A(q.d).slice(0,le)){for(;Se--;)q=V(q.times(q),le);return ke.precision=xe,H==null?(n=!0,V(q,xe)):q}q=ae}}function T(F){for(var H=F.e*h,Z=F.d[0];Z>=10;Z/=10)H++;return H}function D(F,H,Z){if(H>F.LN10.sd())throw n=!0,Z&&(F.precision=Z),Error(i+"LN10 precision limit exceeded");return V(new F(F.LN10),H)}function P(F){for(var H="";F--;)H+="0";return H}function z(F,H){var Z,j,$,q,ae,le,fe,Se,ke,xe=1,se=10,be=F,W=be.d,J=be.constructor,re=J.precision;if(be.s<1)throw Error(i+(be.s?"NaN":"-Infinity"));if(be.eq(f))return new J(0);if(H==null?(n=!1,Se=re):Se=H,be.eq(10))return H==null&&(n=!0),D(J,Se);if(Se+=se,J.precision=Se,Z=A(W),j=Z.charAt(0),q=T(be),Math.abs(q)<15e14){for(;j<7&&j!=1||j==1&&Z.charAt(1)>3;)be=be.times(F),Z=A(be.d),j=Z.charAt(0),xe++;q=T(be),j>1?(be=new J("0."+Z),q++):be=new J(j+"."+Z.slice(1))}else return fe=D(J,Se+2,re).times(q+""),be=z(new J(j+"."+Z.slice(1)),Se-se).plus(fe),J.precision=re,H==null?(n=!0,V(be,re)):be;for(le=ae=be=O(be.minus(f),be.plus(f),Se),ke=V(be.times(be),Se),$=3;;){if(ae=V(ae.times(ke),Se),fe=le.plus(O(ae,new J($),Se)),A(fe.d).slice(0,Se)===A(le.d).slice(0,Se))return le=le.times(2),q!==0&&(le=le.plus(D(J,Se+2,re).times(q+""))),le=O(le,new J(xe),Se),J.precision=re,H==null?(n=!0,V(le,re)):le;le=fe,$+=2}}function ne(F,H){var Z,j,$;for((Z=H.indexOf("."))>-1&&(H=H.replace(".","")),(j=H.search(/e/i))>0?(Z<0&&(Z=j),Z+=+H.slice(j+1),H=H.substring(0,j)):Z<0&&(Z=H.length),j=0;H.charCodeAt(j)===48;)++j;for($=H.length;H.charCodeAt($-1)===48;)--$;if(H=H.slice(j,$),H){if($-=j,Z=Z-j-1,F.e=s(Z/h),F.d=[],j=(Z+1)%h,Z<0&&(j+=h),j<$){for(j&&F.d.push(+H.slice(0,j)),$-=h;j<$;)F.d.push(+H.slice(j,j+=h));H=H.slice(j),j=h-H.length}else j-=$;for(;j--;)H+="0";if(F.d.push(+H),n&&(F.e>_||F.e<-_))throw Error(o+Z)}else F.s=0,F.e=0,F.d=[0];return F}function V(F,H,Z){var j,$,q,ae,le,fe,Se,ke,xe=F.d;for(ae=1,q=xe[0];q>=10;q/=10)ae++;if(j=H-ae,j<0)j+=h,$=H,Se=xe[ke=0];else{if(ke=Math.ceil((j+1)/h),q=xe.length,ke>=q)return F;for(Se=q=xe[ke],ae=1;q>=10;q/=10)ae++;j%=h,$=j-h+ae}if(Z!==void 0&&(q=l(10,ae-$-1),le=Se/q%10|0,fe=H<0||xe[ke+1]!==void 0||Se%q,fe=Z<4?(le||fe)&&(Z==0||Z==(F.s<0?3:2)):le>5||le==5&&(Z==4||fe||Z==6&&(j>0?$>0?Se/l(10,ae-$):0:xe[ke-1])%10&1||Z==(F.s<0?8:7))),H<1||!xe[0])return fe?(q=T(F),xe.length=1,H=H-q-1,xe[0]=l(10,(h-H%h)%h),F.e=s(-H/h)||0):(xe.length=1,xe[0]=F.e=F.s=0),F;if(j==0?(xe.length=ke,q=1,ke--):(xe.length=ke+1,q=l(10,h-j),xe[ke]=$>0?(Se/l(10,ae-$)%l(10,$)|0)*q:0),fe)for(;;)if(ke==0){(xe[0]+=q)==u&&(xe[0]=1,++F.e);break}else{if(xe[ke]+=q,xe[ke]!=u)break;xe[ke--]=0,q=1}for(j=xe.length;xe[--j]===0;)xe.pop();if(n&&(F.e>_||F.e<-_))throw Error(o+T(F));return F}function X(F,H){var Z,j,$,q,ae,le,fe,Se,ke,xe,se=F.constructor,be=se.precision;if(!F.s||!H.s)return H.s?H.s=-H.s:H=new se(F),n?V(H,be):H;if(fe=F.d,xe=H.d,j=H.e,Se=F.e,fe=fe.slice(),ae=Se-j,ae){for(ke=ae<0,ke?(Z=fe,ae=-ae,le=xe.length):(Z=xe,j=Se,le=fe.length),$=Math.max(Math.ceil(be/h),le)+2,ae>$&&(ae=$,Z.length=1),Z.reverse(),$=ae;$--;)Z.push(0);Z.reverse()}else{for($=fe.length,le=xe.length,ke=$<le,ke&&(le=$),$=0;$<le;$++)if(fe[$]!=xe[$]){ke=fe[$]<xe[$];break}ae=0}for(ke&&(Z=fe,fe=xe,xe=Z,H.s=-H.s),le=fe.length,$=xe.length-le;$>0;--$)fe[le++]=0;for($=xe.length;$>ae;){if(fe[--$]<xe[$]){for(q=$;q&&fe[--q]===0;)fe[q]=u-1;--fe[q],fe[$]+=u}fe[$]-=xe[$]}for(;fe[--le]===0;)fe.pop();for(;fe[0]===0;fe.shift())--j;return fe[0]?(H.d=fe,H.e=j,n?V(H,be):H):new se(0)}function Q(F,H,Z){var j,$=T(F),q=A(F.d),ae=q.length;return H?(Z&&(j=Z-ae)>0?q=q.charAt(0)+"."+q.slice(1)+P(j):ae>1&&(q=q.charAt(0)+"."+q.slice(1)),q=q+($<0?"e":"e+")+$):$<0?(q="0."+P(-$-1)+q,Z&&(j=Z-ae)>0&&(q+=P(j))):$>=ae?(q+=P($+1-ae),Z&&(j=Z-$-1)>0&&(q=q+"."+P(j))):((j=$+1)<ae&&(q=q.slice(0,j)+"."+q.slice(j)),Z&&(j=Z-ae)>0&&($+1===ae&&(q+="."),q+=P(j))),F.s<0?"-"+q:q}function ie(F,H){if(F.length>H)return F.length=H,!0}function pe(F){var H,Z,j;function $(q){var ae=this;if(!(ae instanceof $))return new $(q);if(ae.constructor=$,q instanceof $){ae.s=q.s,ae.e=q.e,ae.d=(q=q.d)?q.slice():q;return}if(typeof q=="number"){if(q*0!==0)throw Error(a+q);if(q>0)ae.s=1;else if(q<0)q=-q,ae.s=-1;else{ae.s=0,ae.e=0,ae.d=[0];return}if(q===~~q&&q<1e7){ae.e=0,ae.d=[q];return}return ne(ae,q.toString())}else if(typeof q!="string")throw Error(a+q);if(q.charCodeAt(0)===45?(q=q.slice(1),ae.s=-1):ae.s=1,c.test(q))ne(ae,q);else throw Error(a+q)}if($.prototype=w,$.ROUND_UP=0,$.ROUND_DOWN=1,$.ROUND_CEIL=2,$.ROUND_FLOOR=3,$.ROUND_HALF_UP=4,$.ROUND_HALF_DOWN=5,$.ROUND_HALF_EVEN=6,$.ROUND_HALF_CEIL=7,$.ROUND_HALF_FLOOR=8,$.clone=pe,$.config=$.set=de,F===void 0&&(F={}),F)for(j=["precision","rounding","toExpNeg","toExpPos","LN10"],H=0;H<j.length;)F.hasOwnProperty(Z=j[H++])||(F[Z]=this[Z]);return $.config(F),$}function de(F){if(!F||typeof F!="object")throw Error(i+"Object expected");var H,Z,j,$=["precision",1,t,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(H=0;H<$.length;H+=3)if((j=F[Z=$[H]])!==void 0)if(s(j)===j&&j>=$[H+1]&&j<=$[H+2])this[Z]=j;else throw Error(a+Z+": "+j);if((j=F[Z="LN10"])!==void 0)if(j==Math.LN10)this[Z]=new this(j);else throw Error(a+Z+": "+j);return this}r=pe(r),r.default=r.Decimal=r,f=new r(1),typeof define=="function"&&define.amd?define(function(){return r}):typeof R2<"u"&&R2.exports?R2.exports=r:(e||(e=typeof self<"u"&&self&&self.self==self?self:Function("return this")()),e.Decimal=r)})(t7)});var M7=ce((J6e,R7)=>{function F0e(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}R7.exports=F0e});var gV=ce((m8e,hV)=>{var I2e=Math.ceil,C2e=Math.max;function T2e(e,t,r,n){for(var i=-1,a=C2e(I2e((t-e)/(r||1)),0),o=Array(a);a--;)o[n?a:++i]=e,e+=r;return o}hV.exports=T2e});var KC=ce((v8e,mV)=>{var N2e=fI(),yV=1/0,L2e=17976931348623157e292;function P2e(e){if(!e)return e===0?e:0;if(e=N2e(e),e===yV||e===-yV){var t=e<0?-1:1;return t*L2e}return e===e?e:0}mV.exports=P2e});var bV=ce((b8e,vV)=>{var F2e=gV(),D2e=uy(),XC=KC();function B2e(e){return function(t,r,n){return n&&typeof n!="number"&&D2e(t,r,n)&&(r=n=void 0),t=XC(t),r===void 0?(r=t,t=0):r=XC(r),n=n===void 0?t<r?1:-1:XC(n),F2e(t,r,n,e)}}vV.exports=B2e});var ZC=ce((_8e,_V)=>{var R2e=bV(),M2e=R2e();_V.exports=M2e});var LV=ce((T8e,NV)=>{var K2e=$0();function X2e(e,t){var r;return K2e(e,function(n,i,a){return r=t(n,i,a),!r}),!!r}NV.exports=X2e});var FV=ce((N8e,PV)=>{var Z2e=vO(),Q2e=Ts(),ewe=LV(),twe=Vr(),rwe=uy();function nwe(e,t,r){var n=twe(e)?Z2e:ewe;return r&&rwe(e,t,r)&&(t=void 0),n(e,Q2e(t,3))}PV.exports=nwe});var BV=ce((P8e,DV)=>{function iwe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}DV.exports=iwe});var MV=ce((F8e,RV)=>{var awe=$0();function owe(e,t){var r=!0;return awe(e,function(n,i,a){return r=!!t(n,i,a),r}),r}RV.exports=owe});var rT=ce((D8e,jV)=>{var swe=BV(),lwe=MV(),cwe=Ts(),uwe=Vr(),fwe=uy();function dwe(e,t,r){var n=uwe(e)?swe:lwe;return r&&fwe(e,t,r)&&(t=void 0),n(e,cwe(t,3))}jV.exports=dwe});var zV=ce((B8e,UV)=>{var $V=iI();function pwe(e,t,r){t=="__proto__"&&$V?$V(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}UV.exports=pwe});var VV=ce((R8e,qV)=>{var hwe=zV(),gwe=tI(),ywe=Ts();function mwe(e,t){var r={};return t=ywe(t,3),gwe(e,function(n,i,a){hwe(r,i,t(n,i,a))}),r}qV.exports=mwe});var FH=ce((iUe,PH)=>{var M1e=Ts(),j1e=dd(),$1e=Jg();function U1e(e){return function(t,r,n){var i=Object(t);if(!j1e(t)){var a=M1e(r,3);t=$1e(t),r=function(s){return a(i[s],s,i)}}var o=e(t,r,n);return o>-1?i[a?t[o]:o]:void 0}}PH.exports=U1e});var BH=ce((aUe,DH)=>{var z1e=KC();function q1e(e){var t=z1e(e),r=t%1;return t===t?r?t-r:t:0}DH.exports=q1e});var MH=ce((oUe,RH)=>{var V1e=BO(),H1e=Ts(),W1e=BH(),J1e=Math.max;function G1e(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var i=r==null?0:W1e(r);return i<0&&(i=J1e(n+i,0)),V1e(e,H1e(t,3),i)}RH.exports=G1e});var $H=ce((sUe,jH)=>{var Y1e=FH(),K1e=MH(),X1e=Y1e(K1e);jH.exports=X1e});var zH=ce((lUe,UH)=>{var Z1e=Es(),Q1e=Os(),eSe="[object Boolean]";function tSe(e){return e===!0||e===!1||Q1e(e)&&Z1e(e)==eSe}UH.exports=tSe});var HH=ce((yUe,_T)=>{"use strict";var oSe=Object.prototype.hasOwnProperty,xi="~";function pm(){}Object.create&&(pm.prototype=Object.create(null),new pm().__proto__||(xi=!1));function sSe(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function VH(e,t,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var a=new sSe(r,n||e,i),o=xi?xi+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],a]:e._events[o].push(a):(e._events[o]=a,e._eventsCount++),e}function vw(e,t){--e._eventsCount===0?e._events=new pm:delete e._events[t]}function ii(){this._events=new pm,this._eventsCount=0}ii.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)oSe.call(r,n)&&t.push(xi?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};ii.prototype.listeners=function(t){var r=xi?xi+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,o=new Array(a);i<a;i++)o[i]=n[i].fn;return o};ii.prototype.listenerCount=function(t){var r=xi?xi+t:t,n=this._events[r];return n?n.fn?1:n.length:0};ii.prototype.emit=function(t,r,n,i,a,o){var s=xi?xi+t:t;if(!this._events[s])return!1;var l=this._events[s],c=arguments.length,f,u;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,r),!0;case 3:return l.fn.call(l.context,r,n),!0;case 4:return l.fn.call(l.context,r,n,i),!0;case 5:return l.fn.call(l.context,r,n,i,a),!0;case 6:return l.fn.call(l.context,r,n,i,a,o),!0}for(u=1,f=new Array(c-1);u<c;u++)f[u-1]=arguments[u];l.fn.apply(l.context,f)}else{var h=l.length,g;for(u=0;u<h;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,r);break;case 3:l[u].fn.call(l[u].context,r,n);break;case 4:l[u].fn.call(l[u].context,r,n,i);break;default:if(!f)for(g=1,f=new Array(c-1);g<c;g++)f[g-1]=arguments[g];l[u].fn.apply(l[u].context,f)}}return!0};ii.prototype.on=function(t,r,n){return VH(this,t,r,n,!1)};ii.prototype.once=function(t,r,n){return VH(this,t,r,n,!0)};ii.prototype.removeListener=function(t,r,n,i){var a=xi?xi+t:t;if(!this._events[a])return this;if(!r)return vw(this,a),this;var o=this._events[a];if(o.fn)o.fn===r&&(!i||o.once)&&(!n||o.context===n)&&vw(this,a);else{for(var s=0,l=[],c=o.length;s<c;s++)(o[s].fn!==r||i&&!o[s].once||n&&o[s].context!==n)&&l.push(o[s]);l.length?this._events[a]=l.length===1?l[0]:l:vw(this,a)}return this};ii.prototype.removeAllListeners=function(t){var r;return t?(r=xi?xi+t:t,this._events[r]&&vw(this,r)):(this._events=new pm,this._eventsCount=0),this};ii.prototype.off=ii.prototype.removeListener;ii.prototype.addListener=ii.prototype.on;ii.prefixed=xi;ii.EventEmitter=ii;typeof _T<"u"&&(_T.exports=ii)});var MK=oe(He(),1),jK=oe(NB(),1);var s_={services:{csgo:"./services/csgo/index.ts"},plugins:{bluetooth:!0},electron:{window:{width:1200}}};var tee=Object.create,LB=Object.defineProperty,ree=Object.getOwnPropertyDescriptor,PB=Object.getOwnPropertyNames,nee=Object.getPrototypeOf,iee=Object.prototype.hasOwnProperty,aee=(e,t)=>function(){return t||(0,e[PB(e)[0]])((t={exports:{}}).exports,t),t.exports},oee=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of PB(t))!iee.call(e,i)&&i!==r&&LB(e,i,{get:()=>t[i],enumerable:!(n=ree(t,i))||n.enumerable});return e},see=(e,t,r)=>(r=e!=null?tee(nee(e)):{},oee(t||!e||!e.__esModule?LB(r,"default",{value:e,enumerable:!0}):r,e)),lee=aee({"node_modules/browserfs/dist/browserfs.js"(e,t){(function(n,i){typeof e=="object"&&typeof t=="object"?t.exports=i():typeof define=="function"&&define.amd?define([],i):typeof e=="object"?e.BrowserFS=i():n.BrowserFS=i()})(e,function(){return function(r){var n={};function i(a){if(n[a])return n[a].exports;var o=n[a]={exports:{},id:a,loaded:!1};return r[a].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}return i.m=r,i.c=n,i.p="",i(0)}([function(r,n,i){(function(a,o,s,l){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var c=i(2),f=i(9),u;(function(v){v[v.EPERM=1]="EPERM",v[v.ENOENT=2]="ENOENT",v[v.EIO=5]="EIO",v[v.EBADF=9]="EBADF",v[v.EACCES=13]="EACCES",v[v.EBUSY=16]="EBUSY",v[v.EEXIST=17]="EEXIST",v[v.ENOTDIR=20]="ENOTDIR",v[v.EISDIR=21]="EISDIR",v[v.EINVAL=22]="EINVAL",v[v.EFBIG=27]="EFBIG",v[v.ENOSPC=28]="ENOSPC",v[v.EROFS=30]="EROFS",v[v.ENOTEMPTY=39]="ENOTEMPTY",v[v.ENOTSUP=95]="ENOTSUP"})(u||(u={}));var h={};h[u.EPERM]="Operation not permitted.",h[u.ENOENT]="No such file or directory.",h[u.EIO]="Input/output error.",h[u.EBADF]="Bad file descriptor.",h[u.EACCES]="Permission denied.",h[u.EBUSY]="Resource busy or locked.",h[u.EEXIST]="File exists.",h[u.ENOTDIR]="File is not a directory.",h[u.EISDIR]="File is a directory.",h[u.EINVAL]="Invalid argument.",h[u.EFBIG]="File is too big.",h[u.ENOSPC]="No space left on disk.",h[u.EROFS]="Cannot modify a read-only file system.",h[u.ENOTEMPTY]="Directory is not empty.",h[u.ENOTSUP]="Operation is not supported.";var g=function(v){function d(y,p,b){p===void 0&&(p=h[y]),v.call(this,p),this.syscall="",this.errno=y,this.code=u[y],this.path=b,this.stack=new v().stack,this.message="Error: "+this.code+": "+p+(this.path?", '"+this.path+"'":"")}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.fromJSON=function(p){var b=new d(0);return b.errno=p.errno,b.code=p.code,b.path=p.path,b.stack=p.stack,b.message=p.message,b},d.fromBuffer=function(p,b){return b===void 0&&(b=0),d.fromJSON(JSON.parse(p.toString("utf8",b+4,b+4+p.readUInt32LE(b))))},d.FileError=function(p,b){return new d(p,h[p],b)},d.ENOENT=function(p){return this.FileError(u.ENOENT,p)},d.EEXIST=function(p){return this.FileError(u.EEXIST,p)},d.EISDIR=function(p){return this.FileError(u.EISDIR,p)},d.ENOTDIR=function(p){return this.FileError(u.ENOTDIR,p)},d.EPERM=function(p){return this.FileError(u.EPERM,p)},d.ENOTEMPTY=function(p){return this.FileError(u.ENOTEMPTY,p)},d.prototype.toString=function(){return this.message},d.prototype.toJSON=function(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message}},d.prototype.writeToBuffer=function(p,b){p===void 0&&(p=a.alloc(this.bufferSize())),b===void 0&&(b=0);var k=p.write(JSON.stringify(this.toJSON()),b+4);return p.writeUInt32LE(k,b),p},d.prototype.bufferSize=function(){return 4+a.byteLength(JSON.stringify(this.toJSON()))},d}(Error),_=Object.freeze({get ErrorCode(){return u},ErrorStrings:h,ApiError:g}),w;(function(v){v[v.NOP=0]="NOP",v[v.THROW_EXCEPTION=1]="THROW_EXCEPTION",v[v.TRUNCATE_FILE=2]="TRUNCATE_FILE",v[v.CREATE_FILE=3]="CREATE_FILE"})(w||(w={}));var E=function v(d){if(this.flagStr=d,v.validFlagStrs.indexOf(d)<0)throw new g(u.EINVAL,"Invalid flag: "+d)};E.getFileFlag=function(d){return E.flagCache.hasOwnProperty(d)?E.flagCache[d]:E.flagCache[d]=new E(d)},E.prototype.getFlagString=function(){return this.flagStr},E.prototype.isReadable=function(){return this.flagStr.indexOf("r")!==-1||this.flagStr.indexOf("+")!==-1},E.prototype.isWriteable=function(){return this.flagStr.indexOf("w")!==-1||this.flagStr.indexOf("a")!==-1||this.flagStr.indexOf("+")!==-1},E.prototype.isTruncating=function(){return this.flagStr.indexOf("w")!==-1},E.prototype.isAppendable=function(){return this.flagStr.indexOf("a")!==-1},E.prototype.isSynchronous=function(){return this.flagStr.indexOf("s")!==-1},E.prototype.isExclusive=function(){return this.flagStr.indexOf("x")!==-1},E.prototype.pathExistsAction=function(){return this.isExclusive()?w.THROW_EXCEPTION:this.isTruncating()?w.TRUNCATE_FILE:w.NOP},E.prototype.pathNotExistsAction=function(){return(this.isWriteable()||this.isAppendable())&&this.flagStr!=="r+"?w.CREATE_FILE:w.THROW_EXCEPTION},E.flagCache={},E.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"];var S;(function(v){v[v.FILE=32768]="FILE",v[v.DIRECTORY=16384]="DIRECTORY",v[v.SYMLINK=40960]="SYMLINK"})(S||(S={}));var A=function(d,y,p,b,k,I){if(b===void 0&&(b=new Date),k===void 0&&(k=new Date),I===void 0&&(I=new Date),this.size=y,this.atime=b,this.mtime=k,this.ctime=I,this.dev=0,this.ino=0,this.rdev=0,this.nlink=1,this.blksize=4096,this.uid=0,this.gid=0,this.birthtime=new Date(0),this.fileData=null,p)this.mode=p;else switch(d){case S.FILE:this.mode=420;break;case S.DIRECTORY:default:this.mode=511}this.blocks=Math.ceil(y/512),this.mode<4096&&(this.mode|=d)};A.fromBuffer=function(d){var y=d.readUInt32LE(0),p=d.readUInt32LE(4),b=d.readDoubleLE(8),k=d.readDoubleLE(16),I=d.readDoubleLE(24);return new A(p&61440,y,p&4095,new Date(b),new Date(k),new Date(I))},A.prototype.toBuffer=function(){var d=a.alloc(32);return d.writeUInt32LE(this.size,0),d.writeUInt32LE(this.mode,4),d.writeDoubleLE(this.atime.getTime(),8),d.writeDoubleLE(this.mtime.getTime(),16),d.writeDoubleLE(this.ctime.getTime(),24),d},A.prototype.clone=function(){return new A(this.mode&61440,this.size,this.mode&4095,this.atime,this.mtime,this.ctime)},A.prototype.isFile=function(){return(this.mode&61440)===S.FILE},A.prototype.isDirectory=function(){return(this.mode&61440)===S.DIRECTORY},A.prototype.isSymbolicLink=function(){return(this.mode&61440)===S.SYMLINK},A.prototype.chmod=function(d){this.mode=this.mode&61440|d},A.prototype.isSocket=function(){return!1},A.prototype.isBlockDevice=function(){return!1},A.prototype.isCharacterDevice=function(){return!1},A.prototype.isFIFO=function(){return!1};var O=function(v,d){return v};function C(v){if(v)return v;throw new g(u.EIO,"Initialize BrowserFS with a file system using BrowserFS.initialize(filesystem)")}function T(v,d){switch(typeof v){case"number":return v;case"string":var y=parseInt(v,8);return isNaN(y)?d:y;default:return d}}function D(v){if(v instanceof Date)return v;if(typeof v=="number")return new Date(v*1e3);throw new g(u.EINVAL,"Invalid time.")}function P(v){if(v.indexOf("\0")>=0)throw new g(u.EINVAL,"Path must be a string without null bytes.");if(v==="")throw new g(u.EINVAL,"Path must not be empty.");return f.resolve(v)}function z(v,d,y,p){switch(typeof v){case"object":return{encoding:typeof v.encoding<"u"?v.encoding:d,flag:typeof v.flag<"u"?v.flag:y,mode:T(v.mode,p)};case"string":return{encoding:v,flag:y,mode:p};default:return{encoding:d,flag:y,mode:p}}}function ne(){}var V=function(){this.F_OK=0,this.R_OK=4,this.W_OK=2,this.X_OK=1,this.root=null,this.fdMap={},this.nextFd=100};V.prototype.initialize=function(d){if(!d.constructor.isAvailable())throw new g(u.EINVAL,"Tried to instantiate BrowserFS with an unavailable file system.");return this.root=d},V.prototype._toUnixTimestamp=function(d){if(typeof d=="number")return d;if(d instanceof Date)return d.getTime()/1e3;throw new Error("Cannot parse time: "+d)},V.prototype.getRootFS=function(){return this.root?this.root:null},V.prototype.rename=function(d,y,p){p===void 0&&(p=ne);var b=O(p,1);try{C(this.root).rename(P(d),P(y),b)}catch(k){b(k)}},V.prototype.renameSync=function(d,y){C(this.root).renameSync(P(d),P(y))},V.prototype.exists=function(d,y){y===void 0&&(y=ne);var p=O(y,1);try{return C(this.root).exists(P(d),p)}catch{return p(!1)}},V.prototype.existsSync=function(d){try{return C(this.root).existsSync(P(d))}catch{return!1}},V.prototype.stat=function(d,y){y===void 0&&(y=ne);var p=O(y,2);try{return C(this.root).stat(P(d),!1,p)}catch(b){return p(b)}},V.prototype.statSync=function(d){return C(this.root).statSync(P(d),!1)},V.prototype.lstat=function(d,y){y===void 0&&(y=ne);var p=O(y,2);try{return C(this.root).stat(P(d),!0,p)}catch(b){return p(b)}},V.prototype.lstatSync=function(d){return C(this.root).statSync(P(d),!0)},V.prototype.truncate=function(d,y,p){y===void 0&&(y=0),p===void 0&&(p=ne);var b=0;typeof y=="function"?p=y:typeof y=="number"&&(b=y);var k=O(p,1);try{if(b<0)throw new g(u.EINVAL);return C(this.root).truncate(P(d),b,k)}catch(I){return k(I)}},V.prototype.truncateSync=function(d,y){if(y===void 0&&(y=0),y<0)throw new g(u.EINVAL);return C(this.root).truncateSync(P(d),y)},V.prototype.unlink=function(d,y){y===void 0&&(y=ne);var p=O(y,1);try{return C(this.root).unlink(P(d),p)}catch(b){return p(b)}},V.prototype.unlinkSync=function(d){return C(this.root).unlinkSync(P(d))},V.prototype.open=function(d,y,p,b){var k=this;b===void 0&&(b=ne);var I=T(p,420);b=typeof p=="function"?p:b;var L=O(b,2);try{C(this.root).open(P(d),E.getFileFlag(y),I,function(U,G){G?L(U,k.getFdForFile(G)):L(U)})}catch(U){L(U)}},V.prototype.openSync=function(d,y,p){return p===void 0&&(p=420),this.getFdForFile(C(this.root).openSync(P(d),E.getFileFlag(y),T(p,420)))},V.prototype.readFile=function(d,y,p){y===void 0&&(y={}),p===void 0&&(p=ne);var b=z(y,null,"r",null);p=typeof y=="function"?y:p;var k=O(p,2);try{var I=E.getFileFlag(b.flag);return I.isReadable()?C(this.root).readFile(P(d),b.encoding,I,k):k(new g(u.EINVAL,"Flag passed to readFile must allow for reading."))}catch(L){return k(L)}},V.prototype.readFileSync=function(d,y){y===void 0&&(y={});var p=z(y,null,"r",null),b=E.getFileFlag(p.flag);if(!b.isReadable())throw new g(u.EINVAL,"Flag passed to readFile must allow for reading.");return C(this.root).readFileSync(P(d),p.encoding,b)},V.prototype.writeFile=function(d,y,p,b){p===void 0&&(p={}),b===void 0&&(b=ne);var k=z(p,"utf8","w",420);b=typeof p=="function"?p:b;var I=O(b,1);try{var L=E.getFileFlag(k.flag);return L.isWriteable()?C(this.root).writeFile(P(d),y,k.encoding,L,k.mode,I):I(new g(u.EINVAL,"Flag passed to writeFile must allow for writing."))}catch(U){return I(U)}},V.prototype.writeFileSync=function(d,y,p){var b=z(p,"utf8","w",420),k=E.getFileFlag(b.flag);if(!k.isWriteable())throw new g(u.EINVAL,"Flag passed to writeFile must allow for writing.");return C(this.root).writeFileSync(P(d),y,b.encoding,k,b.mode)},V.prototype.appendFile=function(d,y,p,b){b===void 0&&(b=ne);var k=z(p,"utf8","a",420);b=typeof p=="function"?p:b;var I=O(b,1);try{var L=E.getFileFlag(k.flag);if(!L.isAppendable())return I(new g(u.EINVAL,"Flag passed to appendFile must allow for appending."));C(this.root).appendFile(P(d),y,k.encoding,L,k.mode,I)}catch(U){I(U)}},V.prototype.appendFileSync=function(d,y,p){var b=z(p,"utf8","a",420),k=E.getFileFlag(b.flag);if(!k.isAppendable())throw new g(u.EINVAL,"Flag passed to appendFile must allow for appending.");return C(this.root).appendFileSync(P(d),y,b.encoding,k,b.mode)},V.prototype.fstat=function(d,y){y===void 0&&(y=ne);var p=O(y,2);try{var b=this.fd2file(d);b.stat(p)}catch(k){p(k)}},V.prototype.fstatSync=function(d){return this.fd2file(d).statSync()},V.prototype.close=function(d,y){var p=this;y===void 0&&(y=ne);var b=O(y,1);try{this.fd2file(d).close(function(k){k||p.closeFd(d),b(k)})}catch(k){b(k)}},V.prototype.closeSync=function(d){this.fd2file(d).closeSync(),this.closeFd(d)},V.prototype.ftruncate=function(d,y,p){p===void 0&&(p=ne);var b=typeof y=="number"?y:0;p=typeof y=="function"?y:p;var k=O(p,1);try{var I=this.fd2file(d);if(b<0)throw new g(u.EINVAL);I.truncate(b,k)}catch(L){k(L)}},V.prototype.ftruncateSync=function(d,y){y===void 0&&(y=0);var p=this.fd2file(d);if(y<0)throw new g(u.EINVAL);p.truncateSync(y)},V.prototype.fsync=function(d,y){y===void 0&&(y=ne);var p=O(y,1);try{this.fd2file(d).sync(p)}catch(b){p(b)}},V.prototype.fsyncSync=function(d){this.fd2file(d).syncSync()},V.prototype.fdatasync=function(d,y){y===void 0&&(y=ne);var p=O(y,1);try{this.fd2file(d).datasync(p)}catch(b){p(b)}},V.prototype.fdatasyncSync=function(d){this.fd2file(d).datasyncSync()},V.prototype.write=function(d,y,p,b,k,I){I===void 0&&(I=ne);var L,U,G,ue=null;if(typeof y=="string"){var _e="utf8";switch(typeof p){case"function":I=p;break;case"number":ue=p,_e=typeof b=="string"?b:"utf8",I=typeof k=="function"?k:I;break;default:return I=typeof b=="function"?b:typeof k=="function"?k:I,I(new g(u.EINVAL,"Invalid arguments."))}L=a.from(y,_e),U=0,G=L.length}else L=y,U=p,G=b,ue=typeof k=="number"?k:null,I=typeof k=="function"?k:I;var Ne=O(I,3);try{var Ve=this.fd2file(d);ue==null&&(ue=Ve.getPos()),Ve.write(L,U,G,ue,Ne)}catch(Je){Ne(Je)}},V.prototype.writeSync=function(d,y,p,b,k){var I,L=0,U,G;if(typeof y=="string"){G=typeof p=="number"?p:null;var ue=typeof b=="string"?b:"utf8";L=0,I=a.from(y,ue),U=I.length}else I=y,L=p,U=b,G=typeof k=="number"?k:null;var _e=this.fd2file(d);return G==null&&(G=_e.getPos()),_e.writeSync(I,L,U,G)},V.prototype.read=function(d,y,p,b,k,I){I===void 0&&(I=ne);var L,U,G,ue,_e;if(typeof y=="number"){G=y,L=p;var Ne=b;I=typeof k=="function"?k:I,U=0,ue=a.alloc(G),_e=O(function(Je,dt,yt){if(Je)return I(Je);I(Je,yt.toString(Ne),dt)},3)}else ue=y,U=p,G=b,L=k,_e=O(I,3);try{var Ve=this.fd2file(d);L==null&&(L=Ve.getPos()),Ve.read(ue,U,G,L,_e)}catch(Je){_e(Je)}},V.prototype.readSync=function(d,y,p,b,k){var I=!1,L,U,G,ue,_e="utf8";typeof y=="number"?(G=y,ue=p,_e=b,U=0,L=a.alloc(G),I=!0):(L=y,U=p,G=b,ue=k);var Ne=this.fd2file(d);ue==null&&(ue=Ne.getPos());var Ve=Ne.readSync(L,U,G,ue);return I?[L.toString(_e),Ve]:Ve},V.prototype.fchown=function(d,y,p,b){b===void 0&&(b=ne);var k=O(b,1);try{this.fd2file(d).chown(y,p,k)}catch(I){k(I)}},V.prototype.fchownSync=function(d,y,p){this.fd2file(d).chownSync(y,p)},V.prototype.fchmod=function(d,y,p){var b=O(p,1);try{var k=typeof y=="string"?parseInt(y,8):y;this.fd2file(d).chmod(k,b)}catch(I){b(I)}},V.prototype.fchmodSync=function(d,y){var p=typeof y=="string"?parseInt(y,8):y;this.fd2file(d).chmodSync(p)},V.prototype.futimes=function(d,y,p,b){b===void 0&&(b=ne);var k=O(b,1);try{var I=this.fd2file(d);typeof y=="number"&&(y=new Date(y*1e3)),typeof p=="number"&&(p=new Date(p*1e3)),I.utimes(y,p,k)}catch(L){k(L)}},V.prototype.futimesSync=function(d,y,p){this.fd2file(d).utimesSync(D(y),D(p))},V.prototype.rmdir=function(d,y){y===void 0&&(y=ne);var p=O(y,1);try{d=P(d),C(this.root).rmdir(d,p)}catch(b){p(b)}},V.prototype.rmdirSync=function(d){return d=P(d),C(this.root).rmdirSync(d)},V.prototype.mkdir=function(d,y,p){p===void 0&&(p=ne),typeof y=="function"&&(p=y,y=511);var b=O(p,1);try{d=P(d),C(this.root).mkdir(d,y,b)}catch(k){b(k)}},V.prototype.mkdirSync=function(d,y){C(this.root).mkdirSync(P(d),T(y,511))},V.prototype.readdir=function(d,y){y===void 0&&(y=ne);var p=O(y,2);try{d=P(d),C(this.root).readdir(d,p)}catch(b){p(b)}},V.prototype.readdirSync=function(d){return d=P(d),C(this.root).readdirSync(d)},V.prototype.link=function(d,y,p){p===void 0&&(p=ne);var b=O(p,1);try{d=P(d),y=P(y),C(this.root).link(d,y,b)}catch(k){b(k)}},V.prototype.linkSync=function(d,y){return d=P(d),y=P(y),C(this.root).linkSync(d,y)},V.prototype.symlink=function(d,y,p,b){b===void 0&&(b=ne);var k=typeof p=="string"?p:"file";b=typeof p=="function"?p:b;var I=O(b,1);try{if(k!=="file"&&k!=="dir")return I(new g(u.EINVAL,"Invalid type: "+k));d=P(d),y=P(y),C(this.root).symlink(d,y,k,I)}catch(L){I(L)}},V.prototype.symlinkSync=function(d,y,p){if(!p)p="file";else if(p!=="file"&&p!=="dir")throw new g(u.EINVAL,"Invalid type: "+p);return d=P(d),y=P(y),C(this.root).symlinkSync(d,y,p)},V.prototype.readlink=function(d,y){y===void 0&&(y=ne);var p=O(y,2);try{d=P(d),C(this.root).readlink(d,p)}catch(b){p(b)}},V.prototype.readlinkSync=function(d){return d=P(d),C(this.root).readlinkSync(d)},V.prototype.chown=function(d,y,p,b){b===void 0&&(b=ne);var k=O(b,1);try{d=P(d),C(this.root).chown(d,!1,y,p,k)}catch(I){k(I)}},V.prototype.chownSync=function(d,y,p){d=P(d),C(this.root).chownSync(d,!1,y,p)},V.prototype.lchown=function(d,y,p,b){b===void 0&&(b=ne);var k=O(b,1);try{d=P(d),C(this.root).chown(d,!0,y,p,k)}catch(I){k(I)}},V.prototype.lchownSync=function(d,y,p){d=P(d),C(this.root).chownSync(d,!0,y,p)},V.prototype.chmod=function(d,y,p){p===void 0&&(p=ne);var b=O(p,1);try{var k=T(y,-1);if(k<0)throw new g(u.EINVAL,"Invalid mode.");C(this.root).chmod(P(d),!1,k,b)}catch(I){b(I)}},V.prototype.chmodSync=function(d,y){var p=T(y,-1);if(p<0)throw new g(u.EINVAL,"Invalid mode.");d=P(d),C(this.root).chmodSync(d,!1,p)},V.prototype.lchmod=function(d,y,p){p===void 0&&(p=ne);var b=O(p,1);try{var k=T(y,-1);if(k<0)throw new g(u.EINVAL,"Invalid mode.");C(this.root).chmod(P(d),!0,k,b)}catch(I){b(I)}},V.prototype.lchmodSync=function(d,y){var p=T(y,-1);if(p<1)throw new g(u.EINVAL,"Invalid mode.");C(this.root).chmodSync(P(d),!0,p)},V.prototype.utimes=function(d,y,p,b){b===void 0&&(b=ne);var k=O(b,1);try{C(this.root).utimes(P(d),D(y),D(p),k)}catch(I){k(I)}},V.prototype.utimesSync=function(d,y,p){C(this.root).utimesSync(P(d),D(y),D(p))},V.prototype.realpath=function(d,y,p){p===void 0&&(p=ne);var b=typeof y=="object"?y:{};p=typeof y=="function"?y:ne;var k=O(p,2);try{d=P(d),C(this.root).realpath(d,b,k)}catch(I){k(I)}},V.prototype.realpathSync=function(d,y){return y===void 0&&(y={}),d=P(d),C(this.root).realpathSync(d,y)},V.prototype.watchFile=function(d,y,p){throw p===void 0&&(p=ne),new g(u.ENOTSUP)},V.prototype.unwatchFile=function(d,y){throw y===void 0&&(y=ne),new g(u.ENOTSUP)},V.prototype.watch=function(d,y,p){throw p===void 0&&(p=ne),new g(u.ENOTSUP)},V.prototype.access=function(d,y,p){throw p===void 0&&(p=ne),new g(u.ENOTSUP)},V.prototype.accessSync=function(d,y){throw new g(u.ENOTSUP)},V.prototype.createReadStream=function(d,y){throw new g(u.ENOTSUP)},V.prototype.createWriteStream=function(d,y){throw new g(u.ENOTSUP)},V.prototype.wrapCallbacks=function(d){O=d},V.prototype.getFdForFile=function(d){var y=this.nextFd++;return this.fdMap[y]=d,y},V.prototype.fd2file=function(d){var y=this.fdMap[d];if(y)return y;throw new g(u.EBADF,"Invalid file descriptor.")},V.prototype.closeFd=function(d){delete this.fdMap[d]},V.Stats=A;var X=new V,Q={},ie=V.prototype;Object.keys(ie).forEach(function(v){typeof X[v]=="function"?Q[v]=function(){return X[v].apply(X,arguments)}:Q[v]=X[v]}),Q.changeFSModule=function(v){X=v},Q.getFSModule=function(){return X},Q.FS=V;function pe(v,d,y,p,b){return v<d||y<d?v>y?y+1:v+1:p===b?d:d+1}function de(v,d){if(v===d)return 0;if(v.length>d.length){var y=v;v=d,d=y}for(var p=v.length,b=d.length;p>0&&v.charCodeAt(p-1)===d.charCodeAt(b-1);)p--,b--;for(var k=0;k<p&&v.charCodeAt(k)===d.charCodeAt(k);)k++;if(p-=k,b-=k,p===0||b===1)return b;for(var I=new Array(p<<1),L=0;L<p;)I[p+L]=v.charCodeAt(k+L),I[L]=++L;var U,G,ue,_e,Ne;for(U=0;U+3<b;)for(var Ve=d.charCodeAt(k+(G=U)),Je=d.charCodeAt(k+(ue=U+1)),dt=d.charCodeAt(k+(_e=U+2)),yt=d.charCodeAt(k+(Ne=U+3)),Tt=U+=4,Lr=0;Lr<p;){var Rn=I[p+Lr],_o=I[Lr];G=pe(_o,G,ue,Ve,Rn),ue=pe(G,ue,_e,Je,Rn),_e=pe(ue,_e,Ne,dt,Rn),Tt=pe(_e,Ne,Tt,yt,Rn),I[Lr++]=Tt,Ne=_e,_e=ue,ue=G,G=_o}for(var wo=0;U<b;){var ff=d.charCodeAt(k+(G=U));wo=++U;for(var is=0;is<p;is++){var as=I[is];I[is]=wo=as<G||wo<G?as>wo?wo+1:as+1:ff===I[p+is]?G:G+1,G=as}}return wo}function F(v,d,y){v&&console.warn("["+d+"] Direct file system constructor usage is deprecated for this file system, and will be removed in the next major version. Please use the '"+d+".Create("+JSON.stringify(y)+", callback)' method instead. See https://github.com/jvilk/BrowserFS/issues/176 for more details.")}var H=typeof navigator<"u"&&!!(/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||navigator.userAgent.indexOf("Trident")!==-1),Z=typeof window>"u";function j(){throw new Error("BFS has reached an impossible code path; please file a bug.")}function $(v,d,y){y.existsSync(v)||($(f.dirname(v),d,y),y.mkdirSync(v,d))}function q(v){var d=ae(v),y=d.byteOffset,p=d.byteLength;return y===0&&p===d.buffer.byteLength?d.buffer:d.buffer.slice(y,y+p)}function ae(v){return v instanceof Uint8Array?v:new Uint8Array(v)}function le(v){return v instanceof a?v:v instanceof Uint8Array?fe(v):a.from(v)}function fe(v){return v instanceof a?v:v.byteOffset===0&&v.byteLength===v.buffer.byteLength?Se(v.buffer):a.from(v.buffer,v.byteOffset,v.byteLength)}function Se(v){return a.from(v)}function ke(v,d,y){if(d===void 0&&(d=0),y===void 0&&(y=v.length),d<0||y<0||y>v.length||d>y)throw new TypeError("Invalid slice bounds on buffer of length "+v.length+": ["+d+", "+y+"]");if(v.length===0)return se();var p=ae(v),b=v[0],k=(b+1)%255;return v[0]=k,p[0]===k?(p[0]=b,fe(p.slice(d,y))):(v[0]=b,fe(p.subarray(d,y)))}var xe=null;function se(){return xe||(xe=a.alloc(0))}function be(v,d){a.isBuffer(v)?d():d(new g(u.EINVAL,"option must be a Buffer."))}function W(v,d,y){var p=v.Options,b=v.Name,k=0,I=!1,L=!1;function U(Ne){I||(Ne&&(I=!0,y(Ne)),k--,k===0&&L&&y())}var G=function(Ne){if(p.hasOwnProperty(Ne)){var Ve=p[Ne],Je=d[Ne];if(Je==null){if(!Ve.optional){var dt=Object.keys(d).filter(function(Tt){return!(Tt in p)}).map(function(Tt){return{str:Tt,distance:de(Ne,Tt)}}).filter(function(Tt){return Tt.distance<5}).sort(function(Tt,Lr){return Tt.distance-Lr.distance});return I?{}:(I=!0,{v:y(new g(u.EINVAL,"["+b+"] Required option '"+Ne+"' not provided."+(dt.length>0?" You provided unrecognized option '"+dt[0].str+"'; perhaps you meant to type '"+Ne+"'.":"")+`
Option description: `+Ve.description))})}}else{var yt=!1;if(Array.isArray(Ve.type)?yt=Ve.type.indexOf(typeof Je)!==-1:yt=typeof Je===Ve.type,yt)Ve.validator&&(k++,Ve.validator(Je,U));else return I?{}:(I=!0,{v:y(new g(u.EINVAL,"["+b+"] Value provided for option "+Ne+" is not the proper type. Expected "+(Array.isArray(Ve.type)?"one of {"+Ve.type.join(", ")+"}":Ve.type)+", but received "+typeof Je+`
Option description: `+Ve.description))})}}};for(var ue in p){var _e=G(ue);if(_e)return _e.v}L=!0,k===0&&!I&&y()}var J=Object.freeze({deprecationMessage:F,isIE:H,isWebWorker:Z,fail:j,mkdirpSync:$,buffer2ArrayBuffer:q,buffer2Uint8array:ae,arrayish2Buffer:le,uint8Array2Buffer:fe,arrayBuffer2Buffer:Se,copyingSlice:ke,emptyBuffer:se,bufferValidator:be,checkOptions:W}),re=function(d){this.fs=d,this.nodefs=d.getNodeFS(),this.FS=d.getFS(),this.PATH=d.getPATH(),this.ERRNO_CODES=d.getERRNO_CODES()};re.prototype.open=function(d){var y=this.fs.realPath(d.node),p=this.FS;try{p.isFile(d.node.mode)&&(d.nfd=this.nodefs.openSync(y,this.fs.flagsToPermissionString(d.flags)))}catch(b){throw b.code?new p.ErrnoError(this.ERRNO_CODES[b.code]):b}},re.prototype.close=function(d){var y=this.FS;try{y.isFile(d.node.mode)&&d.nfd&&this.nodefs.closeSync(d.nfd)}catch(p){throw p.code?new y.ErrnoError(this.ERRNO_CODES[p.code]):p}},re.prototype.read=function(d,y,p,b,k){try{return this.nodefs.readSync(d.nfd,fe(y),p,b,k)}catch(I){throw new this.FS.ErrnoError(this.ERRNO_CODES[I.code])}},re.prototype.write=function(d,y,p,b,k){try{return this.nodefs.writeSync(d.nfd,fe(y),p,b,k)}catch(I){throw new this.FS.ErrnoError(this.ERRNO_CODES[I.code])}},re.prototype.llseek=function(d,y,p){var b=y;if(p===1)b+=d.position;else if(p===2&&this.FS.isFile(d.node.mode))try{var k=this.nodefs.fstatSync(d.nfd);b+=k.size}catch(I){throw new this.FS.ErrnoError(this.ERRNO_CODES[I.code])}if(b<0)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return d.position=b,b};var Ee=function(d){this.fs=d,this.nodefs=d.getNodeFS(),this.FS=d.getFS(),this.PATH=d.getPATH(),this.ERRNO_CODES=d.getERRNO_CODES()};Ee.prototype.getattr=function(d){var y=this.fs.realPath(d),p;try{p=this.nodefs.lstatSync(y)}catch(b){throw b.code?new this.FS.ErrnoError(this.ERRNO_CODES[b.code]):b}return{dev:p.dev,ino:p.ino,mode:p.mode,nlink:p.nlink,uid:p.uid,gid:p.gid,rdev:p.rdev,size:p.size,atime:p.atime,mtime:p.mtime,ctime:p.ctime,blksize:p.blksize,blocks:p.blocks}},Ee.prototype.setattr=function(d,y){var p=this.fs.realPath(d);try{if(y.mode!==void 0&&(this.nodefs.chmodSync(p,y.mode),d.mode=y.mode),y.timestamp!==void 0){var b=new Date(y.timestamp);this.nodefs.utimesSync(p,b,b)}}catch(k){if(!k.code)throw k;if(k.code!=="ENOTSUP")throw new this.FS.ErrnoError(this.ERRNO_CODES[k.code])}if(y.size!==void 0)try{this.nodefs.truncateSync(p,y.size)}catch(k){throw k.code?new this.FS.ErrnoError(this.ERRNO_CODES[k.code]):k}},Ee.prototype.lookup=function(d,y){var p=this.PATH.join2(this.fs.realPath(d),y),b=this.fs.getMode(p);return this.fs.createNode(d,y,b)},Ee.prototype.mknod=function(d,y,p,b){var k=this.fs.createNode(d,y,p,b),I=this.fs.realPath(k);try{this.FS.isDir(k.mode)?this.nodefs.mkdirSync(I,k.mode):this.nodefs.writeFileSync(I,"",{mode:k.mode})}catch(L){throw L.code?new this.FS.ErrnoError(this.ERRNO_CODES[L.code]):L}return k},Ee.prototype.rename=function(d,y,p){var b=this.fs.realPath(d),k=this.PATH.join2(this.fs.realPath(y),p);try{this.nodefs.renameSync(b,k),d.name=p,d.parent=y}catch(I){throw I.code?new this.FS.ErrnoError(this.ERRNO_CODES[I.code]):I}},Ee.prototype.unlink=function(d,y){var p=this.PATH.join2(this.fs.realPath(d),y);try{this.nodefs.unlinkSync(p)}catch(b){throw b.code?new this.FS.ErrnoError(this.ERRNO_CODES[b.code]):b}},Ee.prototype.rmdir=function(d,y){var p=this.PATH.join2(this.fs.realPath(d),y);try{this.nodefs.rmdirSync(p)}catch(b){throw b.code?new this.FS.ErrnoError(this.ERRNO_CODES[b.code]):b}},Ee.prototype.readdir=function(d){var y=this.fs.realPath(d);try{var p=this.nodefs.readdirSync(y);return p.push(".",".."),p}catch(b){throw b.code?new this.FS.ErrnoError(this.ERRNO_CODES[b.code]):b}},Ee.prototype.symlink=function(d,y,p){var b=this.PATH.join2(this.fs.realPath(d),y);try{this.nodefs.symlinkSync(p,b)}catch(k){throw k.code?new this.FS.ErrnoError(this.ERRNO_CODES[k.code]):k}},Ee.prototype.readlink=function(d){var y=this.fs.realPath(d);try{return this.nodefs.readlinkSync(y)}catch(p){throw p.code?new this.FS.ErrnoError(this.ERRNO_CODES[p.code]):p}};var Te=function(d,y,p,b){d===void 0&&(d=self.FS),y===void 0&&(y=self.PATH),p===void 0&&(p=self.ERRNO_CODES),b===void 0&&(b=Q),this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"},this.nodefs=b,this.FS=d,this.PATH=y,this.ERRNO_CODES=p,this.node_ops=new Ee(this),this.stream_ops=new re(this)};Te.prototype.mount=function(d){return this.createNode(null,"/",this.getMode(d.opts.root),0)},Te.prototype.createNode=function(d,y,p,b){var k=this.FS;if(!k.isDir(p)&&!k.isFile(p)&&!k.isLink(p))throw new k.ErrnoError(this.ERRNO_CODES.EINVAL);var I=k.createNode(d,y,p);return I.node_ops=this.node_ops,I.stream_ops=this.stream_ops,I},Te.prototype.getMode=function(d){var y;try{y=this.nodefs.lstatSync(d)}catch(p){throw p.code?new this.FS.ErrnoError(this.ERRNO_CODES[p.code]):p}return y.mode},Te.prototype.realPath=function(d){for(var y=[];d.parent!==d;)y.push(d.name),d=d.parent;return y.push(d.mount.opts.root),y.reverse(),this.PATH.join.apply(null,y)},Te.prototype.flagsToPermissionString=function(d){var y=typeof d=="string"?parseInt(d,10):d;return y&=8191,y in this.flagsToPermissionStringMap?this.flagsToPermissionStringMap[y]:d},Te.prototype.getNodeFS=function(){return this.nodefs},Te.prototype.getFS=function(){return this.FS},Te.prototype.getPATH=function(){return this.PATH},Te.prototype.getERRNO_CODES=function(){return this.ERRNO_CODES};var Ie=function(){};Ie.prototype.supportsLinks=function(){return!1},Ie.prototype.diskSpace=function(d,y){y(0,0)},Ie.prototype.openFile=function(d,y,p){throw new g(u.ENOTSUP)},Ie.prototype.createFile=function(d,y,p,b){throw new g(u.ENOTSUP)},Ie.prototype.open=function(d,y,p,b){var k=this,I=function(L,U){if(L)switch(y.pathNotExistsAction()){case w.CREATE_FILE:return k.stat(f.dirname(d),!1,function(G,ue){G?b(G):ue&&!ue.isDirectory()?b(g.ENOTDIR(f.dirname(d))):k.createFile(d,y,p,b)});case w.THROW_EXCEPTION:return b(g.ENOENT(d));default:return b(new g(u.EINVAL,"Invalid FileFlag object."))}else{if(U&&U.isDirectory())return b(g.EISDIR(d));switch(y.pathExistsAction()){case w.THROW_EXCEPTION:return b(g.EEXIST(d));case w.TRUNCATE_FILE:return k.openFile(d,y,function(G,ue){G?b(G):ue?ue.truncate(0,function(){ue.sync(function(){b(null,ue)})}):j()});case w.NOP:return k.openFile(d,y,b);default:return b(new g(u.EINVAL,"Invalid FileFlag object."))}}};this.stat(d,!1,I)},Ie.prototype.rename=function(d,y,p){p(new g(u.ENOTSUP))},Ie.prototype.renameSync=function(d,y){throw new g(u.ENOTSUP)},Ie.prototype.stat=function(d,y,p){p(new g(u.ENOTSUP))},Ie.prototype.statSync=function(d,y){throw new g(u.ENOTSUP)},Ie.prototype.openFileSync=function(d,y,p){throw new g(u.ENOTSUP)},Ie.prototype.createFileSync=function(d,y,p){throw new g(u.ENOTSUP)},Ie.prototype.openSync=function(d,y,p){var b;try{b=this.statSync(d,!1)}catch{switch(y.pathNotExistsAction()){case w.CREATE_FILE:var k=this.statSync(f.dirname(d),!1);if(!k.isDirectory())throw g.ENOTDIR(f.dirname(d));return this.createFileSync(d,y,p);case w.THROW_EXCEPTION:throw g.ENOENT(d);default:throw new g(u.EINVAL,"Invalid FileFlag object.")}}if(b.isDirectory())throw g.EISDIR(d);switch(y.pathExistsAction()){case w.THROW_EXCEPTION:throw g.EEXIST(d);case w.TRUNCATE_FILE:return this.unlinkSync(d),this.createFileSync(d,y,b.mode);case w.NOP:return this.openFileSync(d,y,p);default:throw new g(u.EINVAL,"Invalid FileFlag object.")}},Ie.prototype.unlink=function(d,y){y(new g(u.ENOTSUP))},Ie.prototype.unlinkSync=function(d){throw new g(u.ENOTSUP)},Ie.prototype.rmdir=function(d,y){y(new g(u.ENOTSUP))},Ie.prototype.rmdirSync=function(d){throw new g(u.ENOTSUP)},Ie.prototype.mkdir=function(d,y,p){p(new g(u.ENOTSUP))},Ie.prototype.mkdirSync=function(d,y){throw new g(u.ENOTSUP)},Ie.prototype.readdir=function(d,y){y(new g(u.ENOTSUP))},Ie.prototype.readdirSync=function(d){throw new g(u.ENOTSUP)},Ie.prototype.exists=function(d,y){this.stat(d,null,function(p){y(!p)})},Ie.prototype.existsSync=function(d){try{return this.statSync(d,!0),!0}catch{return!1}},Ie.prototype.realpath=function(d,y,p){if(this.supportsLinks())for(var b=d.split(f.sep),k=0;k<b.length;k++){var I=b.slice(0,k+1);b[k]=f.join.apply(null,I)}else this.exists(d,function(L){L?p(null,d):p(g.ENOENT(d))})},Ie.prototype.realpathSync=function(d,y){if(this.supportsLinks()){for(var p=d.split(f.sep),b=0;b<p.length;b++){var k=p.slice(0,b+1);p[b]=f.join.apply(f,k)}return p.join(f.sep)}else{if(this.existsSync(d))return d;throw g.ENOENT(d)}},Ie.prototype.truncate=function(d,y,p){this.open(d,E.getFileFlag("r+"),420,function(b,k){if(b)return p(b);k.truncate(y,function(I){k.close(function(L){p(I||L)})})})},Ie.prototype.truncateSync=function(d,y){var p=this.openSync(d,E.getFileFlag("r+"),420);try{p.truncateSync(y)}catch(b){throw b}finally{p.closeSync()}},Ie.prototype.readFile=function(d,y,p,b){var k=b;this.open(d,p,420,function(I,L){if(I)return b(I);b=function(U,G){L.close(function(ue){return U||(U=ue),k(U,G)})},L.stat(function(U,G){if(U)return b(U);var ue=a.alloc(G.size);L.read(ue,0,G.size,0,function(_e){if(_e)return b(_e);if(y===null)return b(_e,ue);try{b(null,ue.toString(y))}catch(Ne){b(Ne)}})})})},Ie.prototype.readFileSync=function(d,y,p){var b=this.openSync(d,p,420);try{var k=b.statSync(),I=a.alloc(k.size);return b.readSync(I,0,k.size,0),b.closeSync(),y===null?I:I.toString(y)}finally{b.closeSync()}},Ie.prototype.writeFile=function(d,y,p,b,k,I){var L=I;this.open(d,b,420,function(U,G){if(U)return I(U);I=function(ue){G.close(function(_e){L(ue||_e)})};try{typeof y=="string"&&(y=a.from(y,p))}catch(ue){return I(ue)}G.write(y,0,y.length,0,I)})},Ie.prototype.writeFileSync=function(d,y,p,b,k){var I=this.openSync(d,b,k);try{typeof y=="string"&&(y=a.from(y,p)),I.writeSync(y,0,y.length,0)}finally{I.closeSync()}},Ie.prototype.appendFile=function(d,y,p,b,k,I){var L=I;this.open(d,b,k,function(U,G){if(U)return I(U);I=function(ue){G.close(function(_e){L(ue||_e)})},typeof y=="string"&&(y=a.from(y,p)),G.write(y,0,y.length,null,I)})},Ie.prototype.appendFileSync=function(d,y,p,b,k){var I=this.openSync(d,b,k);try{typeof y=="string"&&(y=a.from(y,p)),I.writeSync(y,0,y.length,null)}finally{I.closeSync()}},Ie.prototype.chmod=function(d,y,p,b){b(new g(u.ENOTSUP))},Ie.prototype.chmodSync=function(d,y,p){throw new g(u.ENOTSUP)},Ie.prototype.chown=function(d,y,p,b,k){k(new g(u.ENOTSUP))},Ie.prototype.chownSync=function(d,y,p,b){throw new g(u.ENOTSUP)},Ie.prototype.utimes=function(d,y,p,b){b(new g(u.ENOTSUP))},Ie.prototype.utimesSync=function(d,y,p){throw new g(u.ENOTSUP)},Ie.prototype.link=function(d,y,p){p(new g(u.ENOTSUP))},Ie.prototype.linkSync=function(d,y){throw new g(u.ENOTSUP)},Ie.prototype.symlink=function(d,y,p,b){b(new g(u.ENOTSUP))},Ie.prototype.symlinkSync=function(d,y,p){throw new g(u.ENOTSUP)},Ie.prototype.readlink=function(d,y){y(new g(u.ENOTSUP))},Ie.prototype.readlinkSync=function(d){throw new g(u.ENOTSUP)};var Ye=function(v){function d(){v.apply(this,arguments)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.supportsSynch=function(){return!0},d.prototype.rename=function(p,b,k){try{this.renameSync(p,b),k()}catch(I){k(I)}},d.prototype.stat=function(p,b,k){try{k(null,this.statSync(p,b))}catch(I){k(I)}},d.prototype.open=function(p,b,k,I){try{I(null,this.openSync(p,b,k))}catch(L){I(L)}},d.prototype.unlink=function(p,b){try{this.unlinkSync(p),b()}catch(k){b(k)}},d.prototype.rmdir=function(p,b){try{this.rmdirSync(p),b()}catch(k){b(k)}},d.prototype.mkdir=function(p,b,k){try{this.mkdirSync(p,b),k()}catch(I){k(I)}},d.prototype.readdir=function(p,b){try{b(null,this.readdirSync(p))}catch(k){b(k)}},d.prototype.chmod=function(p,b,k,I){try{this.chmodSync(p,b,k),I()}catch(L){I(L)}},d.prototype.chown=function(p,b,k,I,L){try{this.chownSync(p,b,k,I),L()}catch(U){L(U)}},d.prototype.utimes=function(p,b,k,I){try{this.utimesSync(p,b,k),I()}catch(L){I(L)}},d.prototype.link=function(p,b,k){try{this.linkSync(p,b),k()}catch(I){k(I)}},d.prototype.symlink=function(p,b,k,I){try{this.symlinkSync(p,b,k),I()}catch(L){I(L)}},d.prototype.readlink=function(p,b){try{b(null,this.readlinkSync(p))}catch(k){b(k)}},d}(Ie),Ke=function(){};Ke.prototype.sync=function(d){d(new g(u.ENOTSUP))},Ke.prototype.syncSync=function(){throw new g(u.ENOTSUP)},Ke.prototype.datasync=function(d){this.sync(d)},Ke.prototype.datasyncSync=function(){return this.syncSync()},Ke.prototype.chown=function(d,y,p){p(new g(u.ENOTSUP))},Ke.prototype.chownSync=function(d,y){throw new g(u.ENOTSUP)},Ke.prototype.chmod=function(d,y){y(new g(u.ENOTSUP))},Ke.prototype.chmodSync=function(d){throw new g(u.ENOTSUP)},Ke.prototype.utimes=function(d,y,p){p(new g(u.ENOTSUP))},Ke.prototype.utimesSync=function(d,y){throw new g(u.ENOTSUP)};var St=function(v){function d(y,p,b,k,I){if(v.call(this),this._pos=0,this._dirty=!1,this._fs=y,this._path=p,this._flag=b,this._stat=k,I?this._buffer=I:this._buffer=se(),this._stat.size!==this._buffer.length&&this._flag.isReadable())throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.getBuffer=function(){return this._buffer},d.prototype.getStats=function(){return this._stat},d.prototype.getFlag=function(){return this._flag},d.prototype.getPath=function(){return this._path},d.prototype.getPos=function(){return this._flag.isAppendable()?this._stat.size:this._pos},d.prototype.advancePos=function(p){return this._pos+=p},d.prototype.setPos=function(p){return this._pos=p},d.prototype.sync=function(p){try{this.syncSync(),p()}catch(b){p(b)}},d.prototype.syncSync=function(){throw new g(u.ENOTSUP)},d.prototype.close=function(p){try{this.closeSync(),p()}catch(b){p(b)}},d.prototype.closeSync=function(){throw new g(u.ENOTSUP)},d.prototype.stat=function(p){try{p(null,this._stat.clone())}catch(b){p(b)}},d.prototype.statSync=function(){return this._stat.clone()},d.prototype.truncate=function(p,b){try{this.truncateSync(p),this._flag.isSynchronous()&&!Q.getRootFS().supportsSynch()&&this.sync(b),b()}catch(k){return b(k)}},d.prototype.truncateSync=function(p){if(this._dirty=!0,!this._flag.isWriteable())throw new g(u.EPERM,"File not opened with a writeable mode.");if(this._stat.mtime=new Date,p>this._buffer.length){var b=a.alloc(p-this._buffer.length,0);this.writeSync(b,0,b.length,this._buffer.length),this._flag.isSynchronous()&&Q.getRootFS().supportsSynch()&&this.syncSync();return}this._stat.size=p;var k=a.alloc(p);this._buffer.copy(k,0,0,p),this._buffer=k,this._flag.isSynchronous()&&Q.getRootFS().supportsSynch()&&this.syncSync()},d.prototype.write=function(p,b,k,I,L){try{L(null,this.writeSync(p,b,k,I),p)}catch(U){L(U)}},d.prototype.writeSync=function(p,b,k,I){if(this._dirty=!0,I==null&&(I=this.getPos()),!this._flag.isWriteable())throw new g(u.EPERM,"File not opened with a writeable mode.");var L=I+k;if(L>this._stat.size&&(this._stat.size=L,L>this._buffer.length)){var U=a.alloc(L);this._buffer.copy(U),this._buffer=U}var G=p.copy(this._buffer,I,b,b+k);return this._stat.mtime=new Date,this._flag.isSynchronous()?(this.syncSync(),G):(this.setPos(I+G),G)},d.prototype.read=function(p,b,k,I,L){try{L(null,this.readSync(p,b,k,I),p)}catch(U){L(U)}},d.prototype.readSync=function(p,b,k,I){if(!this._flag.isReadable())throw new g(u.EPERM,"File not opened with a readable mode.");I==null&&(I=this.getPos());var L=I+k;L>this._stat.size&&(k=this._stat.size-I);var U=this._buffer.copy(p,b,I,I+k);return this._stat.atime=new Date,this._pos=I+k,U},d.prototype.chmod=function(p,b){try{this.chmodSync(p),b()}catch(k){b(k)}},d.prototype.chmodSync=function(p){if(!this._fs.supportsProps())throw new g(u.ENOTSUP);this._dirty=!0,this._stat.chmod(p),this.syncSync()},d.prototype.isDirty=function(){return this._dirty},d.prototype.resetDirty=function(){this._dirty=!1},d}(Ke),_t=function(v){function d(y,p,b,k,I){v.call(this,y,p,b,k,I)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.sync=function(p){p()},d.prototype.syncSync=function(){},d.prototype.close=function(p){p()},d.prototype.closeSync=function(){},d}(St),ft=function(v){function d(y,p,b,k,I){v.call(this,y,p,b,k,I)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},d.prototype.closeSync=function(){this.syncSync()},d}(St),ee=function(v){function d(y,p,b){if(b===void 0&&(b=!0),v.call(this),this._queue=[],this._queueRunning=!1,this._isInitialized=!1,this._initializeCallbacks=[],this._sync=y,this._async=p,!y.supportsSynch())throw new Error("The first argument to AsyncMirror needs to be a synchronous file system.");F(b,d.Name,{sync:"sync file system instance",async:"async file system instance"})}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){try{var k=new d(p.sync,p.async,!1);k.initialize(function(I){I?b(I):b(null,k)},!1)}catch(I){b(I)}},d.isAvailable=function(){return!0},d.prototype.getName=function(){return d.Name},d.prototype._syncSync=function(p){this._sync.writeFileSync(p.getPath(),p.getBuffer(),null,E.getFileFlag("w"),p.getStats().mode),this.enqueueOp({apiMethod:"writeFile",arguments:[p.getPath(),p.getBuffer(),null,p.getFlag(),p.getStats().mode]})},d.prototype.initialize=function(p,b){var k=this;b===void 0&&(b=!0),b&&console.warn("[AsyncMirror] AsyncMirror.initialize() is deprecated and will be removed in the next major version. Please use 'AsyncMirror.Create({ sync: (sync file system instance), async: (async file system instance)}, cb)' to create and initialize AsyncMirror instances.");var I=this._initializeCallbacks,L=function(_e){k._isInitialized=!_e,k._initializeCallbacks=[],I.forEach(function(Ne){return Ne(_e)})};if(this._isInitialized)p();else if(I.push(p)===1){var U=function(_e,Ne,Ve){_e!=="/"&&k._sync.mkdirSync(_e,Ne),k._async.readdir(_e,function(Je,dt){var yt=0;function Tt(Lr){Lr?Ve(Lr):yt<dt.length?(ue(f.join(_e,dt[yt]),Tt),yt++):Ve()}Je?Ve(Je):Tt()})},G=function(_e,Ne,Ve){k._async.readFile(_e,null,E.getFileFlag("r"),function(Je,dt){if(Je)Ve(Je);else try{k._sync.writeFileSync(_e,dt,null,E.getFileFlag("w"),Ne)}catch(yt){Je=yt}finally{Ve(Je)}})},ue=function(_e,Ne){k._async.stat(_e,!1,function(Ve,Je){Ve?Ne(Ve):Je.isDirectory()?U(_e,Je.mode,Ne):G(_e,Je.mode,Ne)})};U("/",0,L)}},d.prototype.isReadOnly=function(){return!1},d.prototype.supportsSynch=function(){return!0},d.prototype.supportsLinks=function(){return!1},d.prototype.supportsProps=function(){return this._sync.supportsProps()&&this._async.supportsProps()},d.prototype.renameSync=function(p,b){this.checkInitialized(),this._sync.renameSync(p,b),this.enqueueOp({apiMethod:"rename",arguments:[p,b]})},d.prototype.statSync=function(p,b){return this.checkInitialized(),this._sync.statSync(p,b)},d.prototype.openSync=function(p,b,k){this.checkInitialized();var I=this._sync.openSync(p,b,k);return I.closeSync(),new ft(this,p,b,this._sync.statSync(p,!1),this._sync.readFileSync(p,null,E.getFileFlag("r")))},d.prototype.unlinkSync=function(p){this.checkInitialized(),this._sync.unlinkSync(p),this.enqueueOp({apiMethod:"unlink",arguments:[p]})},d.prototype.rmdirSync=function(p){this.checkInitialized(),this._sync.rmdirSync(p),this.enqueueOp({apiMethod:"rmdir",arguments:[p]})},d.prototype.mkdirSync=function(p,b){this.checkInitialized(),this._sync.mkdirSync(p,b),this.enqueueOp({apiMethod:"mkdir",arguments:[p,b]})},d.prototype.readdirSync=function(p){return this.checkInitialized(),this._sync.readdirSync(p)},d.prototype.existsSync=function(p){return this.checkInitialized(),this._sync.existsSync(p)},d.prototype.chmodSync=function(p,b,k){this.checkInitialized(),this._sync.chmodSync(p,b,k),this.enqueueOp({apiMethod:"chmod",arguments:[p,b,k]})},d.prototype.chownSync=function(p,b,k,I){this.checkInitialized(),this._sync.chownSync(p,b,k,I),this.enqueueOp({apiMethod:"chown",arguments:[p,b,k,I]})},d.prototype.utimesSync=function(p,b,k){this.checkInitialized(),this._sync.utimesSync(p,b,k),this.enqueueOp({apiMethod:"utimes",arguments:[p,b,k]})},d.prototype.checkInitialized=function(){if(!this._isInitialized)throw new g(u.EPERM,"AsyncMirrorFS is not initialized. Please initialize AsyncMirrorFS using its initialize() method before using it.")},d.prototype.enqueueOp=function(p){var b=this;if(this._queue.push(p),!this._queueRunning){this._queueRunning=!0;var k=function(I){if(I&&console.error("WARNING: File system has desynchronized. Received following error: "+I+`
$`),b._queue.length>0){var L=b._queue.shift(),U=L.arguments;U.push(k),b._async[L.apiMethod].apply(b._async,U)}else b._queueRunning=!1};k()}},d}(Ye);ee.Name="AsyncMirror",ee.Options={sync:{type:"object",description:"The synchronous file system to mirror the asynchronous file system to."},async:{type:"object",description:"The asynchronous file system to mirror."}};function B(v,d,y){switch(y.length){case 0:return v.call(d);case 1:return v.call(d,y[0]);case 2:return v.call(d,y[0],y[1]);case 3:return v.call(d,y[0],y[1],y[2])}return v.apply(d,y)}var R=Math.max;function te(v,d,y){return d=R(d===void 0?v.length-1:d,0),function(){for(var p=arguments,b=-1,k=R(p.length-d,0),I=Array(k);++b<k;)I[b]=p[d+b];b=-1;for(var L=Array(d+1);++b<d;)L[b]=p[b];return L[d]=y(I),B(v,this,L)}}function we(v){return v}function Ae(v,d){return te(v,d,we)}var Re=function(v){return Ae(function(d){var y=d.pop();v.call(this,d,y)})};function It(v){return Ae(function(d,y){var p=Re(function(b,k){var I=this;return v(d,function(L,U){L.apply(I,b.concat(U))},k)});return y.length?p.apply(this,y):p})}var Pt=typeof o=="object"&&o&&o.Object===Object&&o,Gt=typeof self=="object"&&self&&self.Object===Object&&self,xr=Pt||Gt||Function("return this")(),zt=xr.Symbol,Ei=Object.prototype,Xs=Ei.hasOwnProperty,Xo=Ei.toString,he=zt?zt.toStringTag:void 0;function Xp(v){var d=Xs.call(v,he),y=v[he];try{v[he]=void 0;var p=!0}catch{}var b=Xo.call(v);return p&&(d?v[he]=y:delete v[he]),b}var Zp=Object.prototype,Qp=Zp.toString;function Oe(v){return Qp.call(v)}var tt="[object Null]",K="[object Undefined]",at=zt?zt.toStringTag:void 0;function Yt(v){return v==null?v===void 0?K:tt:at&&at in Object(v)?Xp(v):Oe(v)}function rt(v){var d=typeof v;return v!=null&&(d=="object"||d=="function")}var Pn="[object AsyncFunction]",it="[object Function]",Dr="[object GeneratorFunction]",Fe="[object Proxy]";function De(v){if(!rt(v))return!1;var d=Yt(v);return d==it||d==Dr||d==Pn||d==Fe}var Zs=9007199254740991;function ir(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=Zs}function ct(v){return v!=null&&ir(v.length)&&!De(v)}var Zo={};function ja(){}function Kt(v){return function(){if(v!==null){var d=v;v=null,d.apply(this,arguments)}}}var xt=typeof Symbol=="function"&&Symbol.iterator,mr=function(v){return xt&&v[xt]&&v[xt]()};function Br(v,d){for(var y=-1,p=Array(v);++y<v;)p[y]=d(y);return p}function kr(v){return v!=null&&typeof v=="object"}var Ji="[object Arguments]";function Qo(v){return kr(v)&&Yt(v)==Ji}var Xt=Object.prototype,Er=Xt.hasOwnProperty,At=Xt.propertyIsEnumerable,Wn=Qo(function(){return arguments}())?Qo:function(v){return kr(v)&&Er.call(v,"callee")&&!At.call(v,"callee")},ui=Array.isArray;function Wu(){return!1}var Oi=typeof n=="object"&&n&&!n.nodeType&&n,es=Oi&&typeof s=="object"&&s&&!s.nodeType&&s,Q1=es&&es.exports===Oi,Ai=Q1?xr.Buffer:void 0,eS=Ai?Ai.isBuffer:void 0,tS=eS||Wu,rS=9007199254740991,nS=/^(?:0|[1-9]\d*)$/;function iS(v,d){return d=d??rS,!!d&&(typeof v=="number"||nS.test(v))&&v>-1&&v%1==0&&v<d}var aS="[object Arguments]",oS="[object Array]",sS="[object Boolean]",lS="[object Date]",uv="[object Error]",cS="[object Function]",uS="[object Map]",fv="[object Number]",fS="[object Object]",Ju="[object RegExp]",Gu="[object Set]",Yu="[object String]",dv="[object WeakMap]",eh="[object ArrayBuffer]",Qs="[object DataView]",dS="[object Float32Array]",Ku="[object Float64Array]",th="[object Int8Array]",rh="[object Int16Array]",dc="[object Int32Array]",nh="[object Uint8Array]",ih="[object Uint8ClampedArray]",ah="[object Uint16Array]",oh="[object Uint32Array]",ar={};ar[dS]=ar[Ku]=ar[th]=ar[rh]=ar[dc]=ar[nh]=ar[ih]=ar[ah]=ar[oh]=!0,ar[aS]=ar[oS]=ar[eh]=ar[sS]=ar[Qs]=ar[lS]=ar[uv]=ar[cS]=ar[uS]=ar[fv]=ar[fS]=ar[Ju]=ar[Gu]=ar[Yu]=ar[dv]=!1;function sh(v){return kr(v)&&ir(v.length)&&!!ar[Yt(v)]}function lh(v){return function(d){return v(d)}}var Xu=typeof n=="object"&&n&&!n.nodeType&&n,Zu=Xu&&typeof s=="object"&&s&&!s.nodeType&&s,ch=Zu&&Zu.exports===Xu,pc=ch&&Pt.process,Qu=function(){try{return pc&&pc.binding&&pc.binding("util")}catch{}}(),ef=Qu&&Qu.isTypedArray,uh=ef?lh(ef):sh,fh=Object.prototype,dh=fh.hasOwnProperty;function ph(v,d){var y=ui(v),p=!y&&Wn(v),b=!y&&!p&&tS(v),k=!y&&!p&&!b&&uh(v),I=y||p||b||k,L=I?Br(v.length,String):[],U=L.length;for(var G in v)(d||dh.call(v,G))&&!(I&&(G=="length"||b&&(G=="offset"||G=="parent")||k&&(G=="buffer"||G=="byteLength"||G=="byteOffset")||iS(G,U)))&&L.push(G);return L}var hc=Object.prototype;function pS(v){var d=v&&v.constructor,y=typeof d=="function"&&d.prototype||hc;return v===y}function hS(v,d){return function(y){return v(d(y))}}var pv=hS(Object.keys,Object),gS=Object.prototype,hv=gS.hasOwnProperty;function $a(v){if(!pS(v))return pv(v);var d=[];for(var y in Object(v))hv.call(v,y)&&y!="constructor"&&d.push(y);return d}function gv(v){return ct(v)?ph(v):$a(v)}function yS(v){var d=-1,y=v.length;return function(){return++d<y?{value:v[d],key:d}:null}}function yv(v){var d=-1;return function(){var p=v.next();return p.done?null:(d++,{value:p.value,key:d})}}function mv(v){var d=gv(v),y=-1,p=d.length;return function(){var k=d[++y];return y<p?{value:v[k],key:k}:null}}function mS(v){if(ct(v))return yS(v);var d=mr(v);return d?yv(d):mv(v)}function vv(v){return function(){if(v===null)throw new Error("Callback was already called.");var d=v;v=null,d.apply(this,arguments)}}function yo(v){return function(d,y,p){if(p=Kt(p||ja),v<=0||!d)return p(null);var b=mS(d),k=!1,I=0;function L(G,ue){if(I-=1,G)k=!0,p(G);else{if(ue===Zo||k&&I<=0)return k=!0,p(null);U()}}function U(){for(;I<v&&!k;){var G=b();if(G===null){k=!0,I<=0&&p(null);return}I+=1,y(G.value,G.key,vv(L))}}U()}}function hh(v,d,y,p){yo(d)(v,y,p)}function pa(v,d){return function(y,p,b){return v(y,d,p,b)}}function bv(v,d,y){y=Kt(y||ja);var p=0,b=0,k=v.length;k===0&&y(null);function I(L,U){L?y(L):(++b===k||U===Zo)&&y(null)}for(;p<k;p++)d(v[p],p,vv(I))}var _v=pa(hh,1/0),gh=function(v,d,y){var p=ct(v)?bv:_v;p(v,d,y)};function wv(v){return function(d,y,p){return v(gh,d,y,p)}}function yh(v,d,y,p){p=p||ja,d=d||[];var b=[],k=0;v(d,function(I,L,U){var G=k++;y(I,function(ue,_e){b[G]=_e,U(ue)})},function(I){p(I,b)})}var Sv=wv(yh);It(Sv);function vS(v){return function(d,y,p,b){return v(yo(y),d,p,b)}}var m=vS(yh),N=pa(m,1);It(N),Ae(function(v,d){return Ae(function(y){return v.apply(null,d.concat(y))})});function Y(v,d){for(var y=-1,p=v==null?0:v.length;++y<p&&d(v[y],y,v)!==!1;);return v}function M(v){return function(d,y,p){for(var b=-1,k=Object(d),I=p(d),L=I.length;L--;){var U=I[v?L:++b];if(y(k[U],U,k)===!1)break}return d}}var ve=M();function Ce(v,d){return v&&ve(v,d,gv)}function Le(v,d,y,p){for(var b=v.length,k=y+(p?1:-1);p?k--:++k<b;)if(d(v[k],k,v))return k;return-1}function et(v){return v!==v}function me(v,d,y){for(var p=y-1,b=v.length;++p<b;)if(v[p]===d)return p;return-1}function Xe(v,d,y){return d===d?me(v,d,y):Le(v,et,y)}var Be="\\ud800-\\udfff",Pe="\\u0300-\\u036f",$e="\\ufe20-\\ufe2f",lt="\\u20d0-\\u20ff",We=Pe+$e+lt,sn="\\ufe0e\\ufe0f",Fn="["+Be+"]",Zt="["+We+"]",Xr="\\ud83c[\\udffb-\\udfff]",st="(?:"+Zt+"|"+Xr+")",ln="[^"+Be+"]",el="(?:\\ud83c[\\udde6-\\uddff]){2}",gc="[\\ud800-\\udbff][\\udc00-\\udfff]",bt="\\u200d",Ze=st+"?",or="["+sn+"]?",Ft="(?:"+bt+"(?:"+[ln,el,gc].join("|")+")"+or+Ze+")*",Ct=or+Ze+Ft,nt="(?:"+[ln+Zt+"?",Zt,el,gc,Fn].join("|")+")",gt=typeof setImmediate=="function"&&setImmediate,er=typeof l=="object"&&typeof l.nextTick=="function";function Dn(v){setTimeout(v,0)}function tf(v){return Ae(function(d,y){v(function(){d.apply(null,y)})})}var rf;gt?rf=setImmediate:er?rf=l.nextTick:rf=Dn,tf(rf);var UK=pa(hh,1);function zK(v,d,y,p){p=Kt(p||ja),UK(v,function(b,k,I){y(d,b,function(L,U){d=U,I(L)})},function(b){p(b,d)})}var qK=Ae(function(d){return Ae(function(y){var p=this,b=y[y.length-1];typeof b=="function"?y.pop():b=ja,zK(d,y,function(k,I,L){I.apply(p,k.concat(Ae(function(U,G){L(U,G)})))},function(k,I){b.apply(p,[k].concat(I))})})});Ae(function(v){return qK.apply(null,v.reverse())}),Ae(function(v){var d=[null].concat(v);return Re(function(y,p){return p.apply(this,d)})});function tL(v){return Ae(function(d,y){d.apply(null,y.concat(Ae(function(p,b){typeof console=="object"&&(p?console.error&&console.error(p):console[v]&&Y(b,function(k){console[v](k)}))})))})}tL("dir");function VK(v){return function(d,y,p){return v(d,p)}}function rL(v,d,y){gh(v,VK(d),y)}tL("log");var xv;er?xv=l.nextTick:gt?xv=setImmediate:xv=Dn,tf(xv);var zIe=Math.ceil,qIe=Math.max,Ii;function HK(){Ii||(Ii={},Ii[Dropbox.ApiError.NETWORK_ERROR]=u.EIO,Ii[Dropbox.ApiError.INVALID_PARAM]=u.EINVAL,Ii[Dropbox.ApiError.INVALID_TOKEN]=u.EPERM,Ii[Dropbox.ApiError.OAUTH_ERROR]=u.EPERM,Ii[Dropbox.ApiError.NOT_FOUND]=u.ENOENT,Ii[Dropbox.ApiError.INVALID_METHOD]=u.EINVAL,Ii[Dropbox.ApiError.NOT_ACCEPTABLE]=u.EINVAL,Ii[Dropbox.ApiError.CONFLICT]=u.EINVAL,Ii[Dropbox.ApiError.RATE_LIMITED]=u.EBUSY,Ii[Dropbox.ApiError.SERVER_ERROR]=u.EBUSY,Ii[Dropbox.ApiError.OVER_QUOTA]=u.ENOSPC)}function WK(v){return v&&v.stat.isFile}function JK(v){return v&&v.stat.isFolder}function GK(v){return v==null||typeof v=="object"&&typeof v.byteLength=="number"}var Bn=function(d){this._cache={},this._client=d};Bn.prototype.readdir=function(d,y){var p=this,b=this.getCachedDirInfo(d);this._wrap(function(k){b!==null&&b.contents?p._client.readdir(d,{contentHash:b.stat.contentHash},k):p._client.readdir(d,k)},function(k,I,L,U){k?k.status===Dropbox.ApiError.NO_CONTENT&&b!==null?y(null,b.contents.slice(0)):y(k):(p.updateCachedDirInfo(d,L,I.slice(0)),U.forEach(function(G){p.updateCachedInfo(f.join(d,G.name),G)}),y(null,I))})},Bn.prototype.remove=function(d,y){var p=this;this._wrap(function(b){p._client.remove(d,b)},function(b,k){b||p.updateCachedInfo(d,k),y(b)})},Bn.prototype.move=function(d,y,p){var b=this;this._wrap(function(k){b._client.move(d,y,k)},function(k,I){k||(b.deleteCachedInfo(d),b.updateCachedInfo(y,I)),p(k)})},Bn.prototype.stat=function(d,y){var p=this;this._wrap(function(b){p._client.stat(d,b)},function(b,k){b||p.updateCachedInfo(d,k),y(b,k)})},Bn.prototype.readFile=function(d,y){var p=this,b=this.getCachedFileInfo(d);b!==null&&b.contents!==null?this.stat(d,function(k,I){k?y(k):I.contentHash===b.stat.contentHash?y(k,b.contents.slice(0),b.stat):p.readFile(d,y)}):this._wrap(function(k){p._client.readFile(d,{arrayBuffer:!0},k)},function(k,I,L){k||p.updateCachedInfo(d,L,I.slice(0)),y(k,I,L)})},Bn.prototype.writeFile=function(d,y,p){var b=this;this._wrap(function(k){b._client.writeFile(d,y,k)},function(k,I){k||b.updateCachedInfo(d,I,y.slice(0)),p(k,I)})},Bn.prototype.mkdir=function(d,y){var p=this;this._wrap(function(b){p._client.mkdir(d,b)},function(b,k){b||p.updateCachedInfo(d,k,[]),y(b)})},Bn.prototype._wrap=function(d,y){var p=0,b=function(k){var I=2;if(k&&3>++p)switch(k.status){case Dropbox.ApiError.SERVER_ERROR:case Dropbox.ApiError.NETWORK_ERROR:case Dropbox.ApiError.RATE_LIMITED:setTimeout(function(){d(b)},I*1e3);break;default:y.apply(null,arguments);break}else y.apply(null,arguments)};d(b)},Bn.prototype.getCachedInfo=function(d){return this._cache[d.toLowerCase()]},Bn.prototype.putCachedInfo=function(d,y){this._cache[d.toLowerCase()]=y},Bn.prototype.deleteCachedInfo=function(d){delete this._cache[d.toLowerCase()]},Bn.prototype.getCachedDirInfo=function(d){var y=this.getCachedInfo(d);return JK(y)?y:null},Bn.prototype.getCachedFileInfo=function(d){var y=this.getCachedInfo(d);return WK(y)?y:null},Bn.prototype.updateCachedDirInfo=function(d,y,p){p===void 0&&(p=null);var b=this.getCachedInfo(d);y.contentHash!==null&&(b===void 0||b.stat.contentHash!==y.contentHash)&&this.putCachedInfo(d,{stat:y,contents:p})},Bn.prototype.updateCachedFileInfo=function(d,y,p){p===void 0&&(p=null);var b=this.getCachedInfo(d);y.versionTag!==null&&(b===void 0||b.stat.versionTag!==y.versionTag)&&this.putCachedInfo(d,{stat:y,contents:p})},Bn.prototype.updateCachedInfo=function(d,y,p){p===void 0&&(p=null),y.isFile&&GK(p)?this.updateCachedFileInfo(d,y,p):y.isFolder&&Array.isArray(p)&&this.updateCachedDirInfo(d,y,p)};var YK=function(v){function d(y,p,b,k,I){v.call(this,y,p,b,k,I)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.sync=function(p){var b=this;if(this.isDirty()){var k=this.getBuffer(),I=q(k);this._fs._writeFileStrict(this.getPath(),I,function(L){L||b.resetDirty(),p(L)})}else p()},d.prototype.close=function(p){this.sync(p)},d}(St),kv=function(v){function d(y,p){p===void 0&&(p=!0),v.call(this),this._client=new Bn(y),F(p,d.Name,{client:"authenticated dropbox client instance"}),HK()}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){b(null,new d(p.client,!1))},d.isAvailable=function(){return typeof Dropbox<"u"},d.prototype.getName=function(){return d.Name},d.prototype.isReadOnly=function(){return!1},d.prototype.supportsSymlinks=function(){return!1},d.prototype.supportsProps=function(){return!1},d.prototype.supportsSynch=function(){return!1},d.prototype.empty=function(p){var b=this;this._client.readdir("/",function(k,I){if(k)p(b.convert(k,"/"));else{var L=function(G,ue){var _e=f.join("/",G);b._client.remove(_e,function(Ne){ue(Ne?b.convert(Ne,_e):null)})},U=function(G){G?p(G):p()};rL(I,L,U)}})},d.prototype.rename=function(p,b,k){var I=this;this._client.move(p,b,function(L){L?I._client.stat(b,function(U,G){if(U||G.isFolder){var ue=L.response.error.indexOf(p)>-1?p:b;k(I.convert(L,ue))}else I._client.remove(b,function(_e){_e?k(I.convert(_e,b)):I.rename(p,b,k)})}):k()})},d.prototype.stat=function(p,b,k){var I=this;this._client.stat(p,function(L,U){if(L)k(I.convert(L,p));else if(U&&U.isRemoved)k(g.FileError(u.ENOENT,p));else{var G=new A(I._statType(U),U.size);return k(null,G)}})},d.prototype.open=function(p,b,k,I){var L=this;this._client.readFile(p,function(U,G,ue){if(U)if(b.isReadable())I(L.convert(U,p));else switch(U.status){case Dropbox.ApiError.NOT_FOUND:var _e=new ArrayBuffer(0);return L._writeFileStrict(p,_e,function(Je,dt){if(Je)I(Je);else{var yt=L._makeFile(p,b,dt,Se(_e));I(null,yt)}});default:return I(L.convert(U,p))}else{var Ne;G===null?Ne=se():Ne=Se(G);var Ve=L._makeFile(p,b,ue,Ne);return I(null,Ve)}})},d.prototype._writeFileStrict=function(p,b,k){var I=this,L=f.dirname(p);this.stat(L,!1,function(U,G){U?k(g.FileError(u.ENOENT,L)):I._client.writeFile(p,b,function(ue,_e){ue?k(I.convert(ue,p)):k(null,_e)})})},d.prototype._statType=function(p){return p.isFile?S.FILE:S.DIRECTORY},d.prototype._makeFile=function(p,b,k,I){var L=this._statType(k),U=new A(L,k.size);return new YK(this,p,b,U,I)},d.prototype._remove=function(p,b,k){var I=this;this._client.stat(p,function(L,U){L?b(I.convert(L,p)):U.isFile&&!k?b(g.FileError(u.ENOTDIR,p)):!U.isFile&&k?b(g.FileError(u.EISDIR,p)):I._client.remove(p,function(G){b(G?I.convert(G,p):null)})})},d.prototype.unlink=function(p,b){this._remove(p,b,!0)},d.prototype.rmdir=function(p,b){this._remove(p,b,!1)},d.prototype.mkdir=function(p,b,k){var I=this,L=f.dirname(p);this._client.stat(L,function(U,G){U?k(I.convert(U,L)):I._client.mkdir(p,function(ue){k(ue?g.FileError(u.EEXIST,p):null)})})},d.prototype.readdir=function(p,b){var k=this;this._client.readdir(p,function(I,L){return I?b(k.convert(I)):b(null,L)})},d.prototype.convert=function(p,b){b===void 0&&(b=null);var k=Ii[p.status];return k===void 0&&(k=u.EIO),b?g.FileError(k,b):new g(k)},d}(Ie);kv.Name="Dropbox",kv.Options={client:{type:"object",description:"An *authenticated* Dropbox client. Must be from the 0.10 JS SDK.",validator:function(v,d){v.isAuthenticated&&v.isAuthenticated()?d():d(new g(u.EINVAL,"'client' option must be an authenticated Dropbox client from the v0.10 JS SDK."))}}};function Rr(v,d){d===void 0&&(d="");for(var y=v.errno,p=v.node,b=[];p&&(b.unshift(p.name),p!==p.parent);)p=p.parent;return new g(y,h[y],b.length>0?"/"+b.join("/"):d)}var KK=function(v){function d(y,p,b,k){v.call(this),this._fs=y,this._FS=p,this._path=b,this._stream=k}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.getPos=function(){},d.prototype.close=function(p){var b=null;try{this.closeSync()}catch(k){b=k}finally{p(b)}},d.prototype.closeSync=function(){try{this._FS.close(this._stream)}catch(p){throw Rr(p,this._path)}},d.prototype.stat=function(p){try{p(null,this.statSync())}catch(b){p(b)}},d.prototype.statSync=function(){try{return this._fs.statSync(this._path,!1)}catch(p){throw Rr(p,this._path)}},d.prototype.truncate=function(p,b){var k=null;try{this.truncateSync(p)}catch(I){k=I}finally{b(k)}},d.prototype.truncateSync=function(p){try{this._FS.ftruncate(this._stream.fd,p)}catch(b){throw Rr(b,this._path)}},d.prototype.write=function(p,b,k,I,L){try{L(null,this.writeSync(p,b,k,I),p)}catch(U){L(U)}},d.prototype.writeSync=function(p,b,k,I){try{var L=ae(p),U=I===null?void 0:I;return this._FS.write(this._stream,L,b,k,U)}catch(G){throw Rr(G,this._path)}},d.prototype.read=function(p,b,k,I,L){try{L(null,this.readSync(p,b,k,I),p)}catch(U){L(U)}},d.prototype.readSync=function(p,b,k,I){try{var L=ae(p),U=I===null?void 0:I;return this._FS.read(this._stream,L,b,k,U)}catch(G){throw Rr(G,this._path)}},d.prototype.sync=function(p){p()},d.prototype.syncSync=function(){},d.prototype.chown=function(p,b,k){var I=null;try{this.chownSync(p,b)}catch(L){I=L}finally{k(I)}},d.prototype.chownSync=function(p,b){try{this._FS.fchown(this._stream.fd,p,b)}catch(k){throw Rr(k,this._path)}},d.prototype.chmod=function(p,b){var k=null;try{this.chmodSync(p)}catch(I){k=I}finally{b(k)}},d.prototype.chmodSync=function(p){try{this._FS.fchmod(this._stream.fd,p)}catch(b){throw Rr(b,this._path)}},d.prototype.utimes=function(p,b,k){var I=null;try{this.utimesSync(p,b)}catch(L){I=L}finally{k(I)}},d.prototype.utimesSync=function(p,b){this._fs.utimesSync(this._path,p,b)},d}(Ke),Ev=function(v){function d(y){v.call(this),this._FS=y}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){b(null,new d(p.FS))},d.isAvailable=function(){return!0},d.prototype.getName=function(){return this._FS.DB_NAME()},d.prototype.isReadOnly=function(){return!1},d.prototype.supportsLinks=function(){return!0},d.prototype.supportsProps=function(){return!0},d.prototype.supportsSynch=function(){return!0},d.prototype.renameSync=function(p,b){try{this._FS.rename(p,b)}catch(k){throw k.errno===u.ENOENT?Rr(k,this.existsSync(p)?b:p):Rr(k)}},d.prototype.statSync=function(p,b){try{var k=b?this._FS.lstat(p):this._FS.stat(p),I=this.modeToFileType(k.mode);return new A(I,k.size,k.mode,k.atime,k.mtime,k.ctime)}catch(L){throw Rr(L,p)}},d.prototype.openSync=function(p,b,k){try{var I=this._FS.open(p,b.getFlagString(),k);if(this._FS.isDir(I.node.mode))throw this._FS.close(I),g.EISDIR(p);return new KK(this,this._FS,p,I)}catch(L){throw Rr(L,p)}},d.prototype.unlinkSync=function(p){try{this._FS.unlink(p)}catch(b){throw Rr(b,p)}},d.prototype.rmdirSync=function(p){try{this._FS.rmdir(p)}catch(b){throw Rr(b,p)}},d.prototype.mkdirSync=function(p,b){try{this._FS.mkdir(p,b)}catch(k){throw Rr(k,p)}},d.prototype.readdirSync=function(p){try{return this._FS.readdir(p).filter(function(b){return b!=="."&&b!==".."})}catch(b){throw Rr(b,p)}},d.prototype.truncateSync=function(p,b){try{this._FS.truncate(p,b)}catch(k){throw Rr(k,p)}},d.prototype.readFileSync=function(p,b,k){try{var I=this._FS.readFile(p,{flags:k.getFlagString()}),L=fe(I);return b?L.toString(b):L}catch(U){throw Rr(U,p)}},d.prototype.writeFileSync=function(p,b,k,I,L){try{k&&(b=a.from(b,k));var U=ae(b);this._FS.writeFile(p,U,{flags:I.getFlagString(),encoding:"binary"}),this._FS.chmod(p,L)}catch(G){throw Rr(G,p)}},d.prototype.chmodSync=function(p,b,k){try{b?this._FS.lchmod(p,k):this._FS.chmod(p,k)}catch(I){throw Rr(I,p)}},d.prototype.chownSync=function(p,b,k,I){try{b?this._FS.lchown(p,k,I):this._FS.chown(p,k,I)}catch(L){throw Rr(L,p)}},d.prototype.symlinkSync=function(p,b,k){try{this._FS.symlink(p,b)}catch(I){throw Rr(I)}},d.prototype.readlinkSync=function(p){try{return this._FS.readlink(p)}catch(b){throw Rr(b,p)}},d.prototype.utimesSync=function(p,b,k){try{this._FS.utime(p,b.getTime(),k.getTime())}catch(I){throw Rr(I,p)}},d.prototype.modeToFileType=function(p){if(this._FS.isDir(p))return S.DIRECTORY;if(this._FS.isFile(p))return S.FILE;if(this._FS.isLink(p))return S.SYMLINK;throw g.EPERM("Invalid mode: "+p)},d}(Ye);Ev.Name="EmscriptenFileSystem",Ev.Options={FS:{type:"object",description:"The Emscripten file system to use (the `FS` variable)"}};var nf=function(v){function d(y,p){v.call(this),this._folder=y,this._wrapped=p}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){b(null,new d(p.folder,p.wrapped))},d.isAvailable=function(){return!0},d.prototype.initialize=function(p){var b=this;this._wrapped.exists(this._folder,function(k){k?p():b._wrapped.isReadOnly()?p(g.ENOENT(b._folder)):b._wrapped.mkdir(b._folder,511,p)})},d.prototype.getName=function(){return this._wrapped.getName()},d.prototype.isReadOnly=function(){return this._wrapped.isReadOnly()},d.prototype.supportsProps=function(){return this._wrapped.supportsProps()},d.prototype.supportsSynch=function(){return this._wrapped.supportsSynch()},d.prototype.supportsLinks=function(){return!1},d}(Ie);nf.Name="FolderAdapter",nf.Options={folder:{type:"string",description:"The folder to use as the root directory"},wrapped:{type:"object",description:"The file system to wrap"}};function nL(v,d){if(d!==null&&typeof d=="object"){var y=d,p=y.path;p&&(p="/"+f.relative(v,p),y.message=y.message.replace(y.path,p),y.path=p)}return d}function XK(v,d){return typeof d=="function"?function(y){arguments.length>0&&(arguments[0]=nL(v,y)),d.apply(null,arguments)}:d}function iL(v,d,y){return v.slice(v.length-4)!=="Sync"?function(){return arguments.length>0&&(d&&(arguments[0]=f.join(this._folder,arguments[0])),y&&(arguments[1]=f.join(this._folder,arguments[1])),arguments[arguments.length-1]=XK(this._folder,arguments[arguments.length-1])),this._wrapped[v].apply(this._wrapped,arguments)}:function(){try{return d&&(arguments[0]=f.join(this._folder,arguments[0])),y&&(arguments[1]=f.join(this._folder,arguments[1])),this._wrapped[v].apply(this._wrapped,arguments)}catch(p){throw nL(this._folder,p)}}}["diskSpace","stat","statSync","open","openSync","unlink","unlinkSync","rmdir","rmdirSync","mkdir","mkdirSync","readdir","readdirSync","exists","existsSync","realpath","realpathSync","truncate","truncateSync","readFile","readFileSync","writeFile","writeFileSync","appendFile","appendFileSync","chmod","chmodSync","chown","chownSync","utimes","utimesSync","readlink","readlinkSync"].forEach(function(v){nf.prototype[v]=iL(v,!0,!1)}),["rename","renameSync","link","linkSync","symlink","symlinkSync"].forEach(function(v){nf.prototype[v]=iL(v,!0,!0)});var Ov;typeof window<"u"?Ov=window:typeof self<"u"?Ov=self:Ov=o;var Zr=Ov;function ZK(v){return v.isDirectory}var bS=Zr.webkitRequestFileSystem||Zr.requestFileSystem||null;function QK(v,d,y,p){if(typeof navigator.webkitPersistentStorage<"u")switch(v){case Zr.PERSISTENT:navigator.webkitPersistentStorage.requestQuota(d,y,p);break;case Zr.TEMPORARY:navigator.webkitTemporaryStorage.requestQuota(d,y,p);break;default:p(new TypeError("Invalid storage type: "+v));break}else Zr.webkitStorageInfo.requestQuota(v,d,y,p)}function eX(v){return Array.prototype.slice.call(v||[],0)}function mo(v,d,y){switch(v.name){case"PathExistsError":return g.EEXIST(d);case"QuotaExceededError":return g.FileError(u.ENOSPC,d);case"NotFoundError":return g.ENOENT(d);case"SecurityError":return g.FileError(u.EACCES,d);case"InvalidModificationError":return g.FileError(u.EPERM,d);case"TypeMismatchError":return g.FileError(y?u.ENOTDIR:u.EISDIR,d);case"EncodingError":case"InvalidStateError":case"NoModificationAllowedError":default:return g.FileError(u.EINVAL,d)}}var tX=function(v){function d(y,p,b,k,I,L){v.call(this,y,b,k,I,L),this._entry=p}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.sync=function(p){var b=this;if(!this.isDirty())return p();this._entry.createWriter(function(k){var I=b.getBuffer(),L=new Blob([q(I)]),U=L.size;k.onwriteend=function(G){k.onwriteend=null,k.onerror=null,k.truncate(U),b.resetDirty(),p()},k.onerror=function(G){p(mo(G,b.getPath(),!1))},k.write(L)})},d.prototype.close=function(p){this.sync(p)},d}(St),Av=function(v){function d(y,p,b){y===void 0&&(y=5),p===void 0&&(p=Zr.PERSISTENT),b===void 0&&(b=!0),v.call(this),this.size=1024*1024*y,this.type=p,F(b,d.Name,{size:y,type:p})}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){var k=new d(p.size,p.type,!1);k.allocate(function(I){return I?b(I):b(null,k)},!1)},d.isAvailable=function(){return!!bS},d.prototype.getName=function(){return d.Name},d.prototype.isReadOnly=function(){return!1},d.prototype.supportsSymlinks=function(){return!1},d.prototype.supportsProps=function(){return!1},d.prototype.supportsSynch=function(){return!1},d.prototype.allocate=function(p,b){var k=this;p===void 0&&(p=function(){}),b===void 0&&(b=!0),b&&console.warn("[HTML5FS] HTML5FS.allocate() is deprecated and will be removed in the next major release. Please use 'HTML5FS.Create({type: "+this.type+", size: "+this.size+"}, cb)' to create and allocate HTML5FS instances.");var I=function(U){k.fs=U,p()},L=function(U){p(mo(U,"/",!0))};this.type===Zr.PERSISTENT?QK(this.type,this.size,function(U){bS(k.type,U,I,L)},L):bS(this.type,this.size,I,L)},d.prototype.empty=function(p){this._readdir("/",function(b,k){if(b)console.error("Failed to empty FS"),p(b);else{var I=function(U){b?(console.error("Failed to empty FS"),p(b)):p()},L=function(U,G){var ue=function(){G()},_e=function(Ne){G(mo(Ne,U.fullPath,!U.isDirectory))};ZK(U)?U.removeRecursively(ue,_e):U.remove(ue,_e)};rL(k,L,I)}})},d.prototype.rename=function(p,b,k){var I=this,L=2,U=0,G=this.fs.root,ue=p,_e=function(Ve){--L<=0&&k(mo(Ve,ue,!1))},Ne=function(Ve){if(++U===2)return k(new g(u.EINVAL,"Something was identified as both a file and a directory. This should never happen."));if(p===b)return k();ue=f.dirname(b),G.getDirectory(ue,{},function(Je){ue=f.basename(b),Ve.moveTo(Je,ue,function(dt){k()},function(dt){Ve.isDirectory?(ue=b,I.unlink(b,function(yt){yt?_e(dt):I.rename(p,b,k)})):_e(dt)})},_e)};G.getFile(p,{},Ne,_e),G.getDirectory(p,{},Ne,_e)},d.prototype.stat=function(p,b,k){var I=this,L={create:!1},U=function(Ne){var Ve=function(Je){var dt=new A(S.FILE,Je.size);k(null,dt)};Ne.file(Ve,ue)},G=function(Ne){var Ve=4096,Je=new A(S.DIRECTORY,Ve);k(null,Je)},ue=function(Ne){k(mo(Ne,p,!1))},_e=function(){I.fs.root.getDirectory(p,L,G,ue)};this.fs.root.getFile(p,L,U,_e)},d.prototype.open=function(p,b,k,I){var L=this,U=function(G){G.name==="InvalidModificationError"&&b.isExclusive()?I(g.EEXIST(p)):I(mo(G,p,!1))};this.fs.root.getFile(p,{create:b.pathNotExistsAction()===w.CREATE_FILE,exclusive:b.isExclusive()},function(G){G.file(function(ue){var _e=new FileReader;_e.onloadend=function(Ne){var Ve=L._makeFile(p,G,b,ue,_e.result);I(null,Ve)},_e.onerror=function(Ne){U(_e.error)},_e.readAsArrayBuffer(ue)},U)},U)},d.prototype.unlink=function(p,b){this._remove(p,b,!0)},d.prototype.rmdir=function(p,b){var k=this;this.readdir(p,function(I,L){I?b(I):L.length>0?b(g.ENOTEMPTY(p)):k._remove(p,b,!1)})},d.prototype.mkdir=function(p,b,k){var I={create:!0,exclusive:!0},L=function(G){k()},U=function(G){k(mo(G,p,!0))};this.fs.root.getDirectory(p,I,L,U)},d.prototype.readdir=function(p,b){this._readdir(p,function(k,I){if(I){for(var L=[],U=0,G=I;U<G.length;U+=1){var ue=G[U];L.push(ue.name)}b(null,L)}else return b(k)})},d.prototype._makeFile=function(p,b,k,I,L){L===void 0&&(L=new ArrayBuffer(0));var U=new A(S.FILE,I.size),G=Se(L);return new tX(this,b,p,k,U,G)},d.prototype._readdir=function(p,b){var k=function(I){b(mo(I,p,!0))};this.fs.root.getDirectory(p,{create:!1},function(I){var L=I.createReader(),U=[],G=function(){L.readEntries(function(ue){ue.length?(U=U.concat(eX(ue)),G()):b(null,U)},k)};G()},k)},d.prototype._remove=function(p,b,k){var I=function(G){var ue=function(){b()},_e=function(Ne){b(mo(Ne,p,!k))};G.remove(ue,_e)},L=function(G){b(mo(G,p,!k))},U={create:!1};k?this.fs.root.getFile(p,U,I,L):this.fs.root.getDirectory(p,U,I,L)},d}(Ie);Av.Name="HTML5FS",Av.Options={size:{type:"number",optional:!0,description:"Storage quota to request, in megabytes. Allocated value may be less. Defaults to 5."},type:{type:"number",optional:!0,description:"window.PERSISTENT or window.TEMPORARY. Defaults to PERSISTENT."}};var Ci=function(d,y,p,b,k,I){this.id=d,this.size=y,this.mode=p,this.atime=b,this.mtime=k,this.ctime=I};Ci.fromBuffer=function(d){if(d===void 0)throw new Error("NO");return new Ci(d.toString("ascii",30),d.readUInt32LE(0),d.readUInt16LE(4),d.readDoubleLE(6),d.readDoubleLE(14),d.readDoubleLE(22))},Ci.prototype.toStats=function(){return new A((this.mode&61440)===S.DIRECTORY?S.DIRECTORY:S.FILE,this.size,this.mode,new Date(this.atime),new Date(this.mtime),new Date(this.ctime))},Ci.prototype.getSize=function(){return 30+this.id.length},Ci.prototype.toBuffer=function(d){return d===void 0&&(d=a.alloc(this.getSize())),d.writeUInt32LE(this.size,0),d.writeUInt16LE(this.mode,4),d.writeDoubleLE(this.atime,6),d.writeDoubleLE(this.mtime,14),d.writeDoubleLE(this.ctime,22),d.write(this.id,30,this.id.length,"ascii"),d},Ci.prototype.update=function(d){var y=!1;this.size!==d.size&&(this.size=d.size,y=!0),this.mode!==d.mode&&(this.mode=d.mode,y=!0);var p=d.atime.getTime();this.atime!==p&&(this.atime=p,y=!0);var b=d.mtime.getTime();this.mtime!==b&&(this.mtime=b,y=!0);var k=d.ctime.getTime();return this.ctime!==k&&(this.ctime=k,y=!0),y},Ci.prototype.isFile=function(){return(this.mode&61440)===S.FILE},Ci.prototype.isDirectory=function(){return(this.mode&61440)===S.DIRECTORY};var tl="/",_S=null;function aL(){return _S||(_S=a.from("{}"))}function Iv(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(v){var d=Math.random()*16|0,y=v==="x"?d:d&3|8;return y.toString(16)})}function Gi(v,d){return v?(d(v),!1):!0}function cn(v,d,y){return v?(d.abort(function(){y(v)}),!1):!0}var ts=function(d){this.store=d,this.originalData={},this.modifiedKeys=[]};ts.prototype.get=function(d){var y=this.store.get(d);return this.stashOldValue(d,y),y},ts.prototype.put=function(d,y,p){return this.markModified(d),this.store.put(d,y,p)},ts.prototype.del=function(d){this.markModified(d),this.store.del(d)},ts.prototype.commit=function(){},ts.prototype.abort=function(){for(var d=this,y=0,p=d.modifiedKeys;y<p.length;y+=1){var b=p[y],k=d.originalData[b];k?d.store.put(b,k,!0):d.store.del(b)}},ts.prototype.stashOldValue=function(d,y){this.originalData.hasOwnProperty(d)||(this.originalData[d]=y)},ts.prototype.markModified=function(d){this.modifiedKeys.indexOf(d)===-1&&(this.modifiedKeys.push(d),this.originalData.hasOwnProperty(d)||(this.originalData[d]=this.store.get(d)))};var oL=function(v){function d(y,p,b,k,I){v.call(this,y,p,b,k,I)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this.getPath(),this.getBuffer(),this.getStats()),this.resetDirty())},d.prototype.closeSync=function(){this.syncSync()},d}(St),sL=function(v){function d(y){v.call(this),this.store=y.store,this.makeRootDirectory()}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.isAvailable=function(){return!0},d.prototype.getName=function(){return this.store.name()},d.prototype.isReadOnly=function(){return!1},d.prototype.supportsSymlinks=function(){return!1},d.prototype.supportsProps=function(){return!1},d.prototype.supportsSynch=function(){return!0},d.prototype.empty=function(){this.store.clear(),this.makeRootDirectory()},d.prototype.renameSync=function(p,b){var k=this.store.beginTransaction("readwrite"),I=f.dirname(p),L=f.basename(p),U=f.dirname(b),G=f.basename(b),ue=this.findINode(k,I),_e=this.getDirListing(k,I,ue);if(!_e[L])throw g.ENOENT(p);var Ne=_e[L];if(delete _e[L],(U+"/").indexOf(p+"/")===0)throw new g(u.EBUSY,I);var Ve,Je;if(U===I?(Ve=ue,Je=_e):(Ve=this.findINode(k,U),Je=this.getDirListing(k,U,Ve)),Je[G]){var dt=this.getINode(k,b,Je[G]);if(dt.isFile())try{k.del(dt.id),k.del(Je[G])}catch(yt){throw k.abort(),yt}else throw g.EPERM(b)}Je[G]=Ne;try{k.put(ue.id,a.from(JSON.stringify(_e)),!0),k.put(Ve.id,a.from(JSON.stringify(Je)),!0)}catch(yt){throw k.abort(),yt}k.commit()},d.prototype.statSync=function(p,b){return this.findINode(this.store.beginTransaction("readonly"),p).toStats()},d.prototype.createFileSync=function(p,b,k){var I=this.store.beginTransaction("readwrite"),L=se(),U=this.commitNewFile(I,p,S.FILE,k,L);return new oL(this,p,b,U.toStats(),L)},d.prototype.openFileSync=function(p,b){var k=this.store.beginTransaction("readonly"),I=this.findINode(k,p),L=k.get(I.id);if(L===void 0)throw g.ENOENT(p);return new oL(this,p,b,I.toStats(),L)},d.prototype.unlinkSync=function(p){this.removeEntry(p,!1)},d.prototype.rmdirSync=function(p){if(this.readdirSync(p).length>0)throw g.ENOTEMPTY(p);this.removeEntry(p,!0)},d.prototype.mkdirSync=function(p,b){var k=this.store.beginTransaction("readwrite"),I=a.from("{}");this.commitNewFile(k,p,S.DIRECTORY,b,I)},d.prototype.readdirSync=function(p){var b=this.store.beginTransaction("readonly");return Object.keys(this.getDirListing(b,p,this.findINode(b,p)))},d.prototype._syncSync=function(p,b,k){var I=this.store.beginTransaction("readwrite"),L=this._findINode(I,f.dirname(p),f.basename(p)),U=this.getINode(I,p,L),G=U.update(k);try{I.put(U.id,b,!0),G&&I.put(L,U.toBuffer(),!0)}catch(ue){throw I.abort(),ue}I.commit()},d.prototype.makeRootDirectory=function(){var p=this.store.beginTransaction("readwrite");if(p.get(tl)===void 0){var b=new Date().getTime(),k=new Ci(Iv(),4096,511|S.DIRECTORY,b,b,b);p.put(k.id,aL(),!1),p.put(tl,k.toBuffer(),!1),p.commit()}},d.prototype._findINode=function(p,b,k){var I=this,L=function(U){var G=I.getDirListing(p,b,U);if(G[k])return G[k];throw g.ENOENT(f.resolve(b,k))};return b==="/"?k===""?tl:L(this.getINode(p,b,tl)):L(this.getINode(p,b+f.sep+k,this._findINode(p,f.dirname(b),f.basename(b))))},d.prototype.findINode=function(p,b){return this.getINode(p,b,this._findINode(p,f.dirname(b),f.basename(b)))},d.prototype.getINode=function(p,b,k){var I=p.get(k);if(I===void 0)throw g.ENOENT(b);return Ci.fromBuffer(I)},d.prototype.getDirListing=function(p,b,k){if(!k.isDirectory())throw g.ENOTDIR(b);var I=p.get(k.id);if(I===void 0)throw g.ENOENT(b);return JSON.parse(I.toString())},d.prototype.addNewNode=function(p,b){for(var k=0,I;k<5;)try{return I=Iv(),p.put(I,b,!1),I}catch{}throw new g(u.EIO,"Unable to commit data to key-value store.")},d.prototype.commitNewFile=function(p,b,k,I,L){var U=f.dirname(b),G=f.basename(b),ue=this.findINode(p,U),_e=this.getDirListing(p,U,ue),Ne=new Date().getTime();if(b==="/"||_e[G])throw g.EEXIST(b);var Ve;try{var Je=this.addNewNode(p,L);Ve=new Ci(Je,L.length,I|k,Ne,Ne,Ne);var dt=this.addNewNode(p,Ve.toBuffer());_e[G]=dt,p.put(ue.id,a.from(JSON.stringify(_e)),!0)}catch(yt){throw p.abort(),yt}return p.commit(),Ve},d.prototype.removeEntry=function(p,b){var k=this.store.beginTransaction("readwrite"),I=f.dirname(p),L=this.findINode(k,I),U=this.getDirListing(k,I,L),G=f.basename(p);if(!U[G])throw g.ENOENT(p);var ue=U[G];delete U[G];var _e=this.getINode(k,p,ue);if(!b&&_e.isDirectory())throw g.EISDIR(p);if(b&&!_e.isDirectory())throw g.ENOTDIR(p);try{k.del(_e.id),k.del(ue),k.put(L.id,a.from(JSON.stringify(U)),!0)}catch(Ne){throw k.abort(),Ne}k.commit()},d}(Ye),lL=function(v){function d(y,p,b,k,I){v.call(this,y,p,b,k,I)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.sync=function(p){var b=this;this.isDirty()?this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),function(k){k||b.resetDirty(),p(k)}):p()},d.prototype.close=function(p){this.sync(p)},d}(St),rX=function(v){function d(){v.apply(this,arguments)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.isAvailable=function(){return!0},d.prototype.init=function(p,b){this.store=p,this.makeRootDirectory(b)},d.prototype.getName=function(){return this.store.name()},d.prototype.isReadOnly=function(){return!1},d.prototype.supportsSymlinks=function(){return!1},d.prototype.supportsProps=function(){return!1},d.prototype.supportsSynch=function(){return!1},d.prototype.empty=function(p){var b=this;this.store.clear(function(k){Gi(k,p)&&b.makeRootDirectory(p)})},d.prototype.rename=function(p,b,k){var I=this,L=this.store.beginTransaction("readwrite"),U=f.dirname(p),G=f.basename(p),ue=f.dirname(b),_e=f.basename(b),Ne={},Ve={},Je=!1;if((ue+"/").indexOf(p+"/")===0)return k(new g(u.EBUSY,U));var dt=function(){if(!(Je||!Ve.hasOwnProperty(U)||!Ve.hasOwnProperty(ue))){var Tt=Ve[U],Lr=Ne[U],Rn=Ve[ue],_o=Ne[ue];if(!Tt[G])k(g.ENOENT(p));else{var wo=Tt[G];delete Tt[G];var ff=function(){Rn[_e]=wo,L.put(Lr.id,a.from(JSON.stringify(Tt)),!0,function(is){cn(is,L,k)&&(U===ue?L.commit(k):L.put(_o.id,a.from(JSON.stringify(Rn)),!0,function(as){cn(as,L,k)&&L.commit(k)}))})};Rn[_e]?I.getINode(L,b,Rn[_e],function(is,as){cn(is,L,k)&&(as.isFile()?L.del(as.id,function(XL){cn(XL,L,k)&&L.del(Rn[_e],function(TX){cn(TX,L,k)&&ff()})}):L.abort(function(XL){k(g.EPERM(b))}))}):ff()}}},yt=function(Tt){I.findINodeAndDirListing(L,Tt,function(Lr,Rn,_o){Lr?Je||(Je=!0,L.abort(function(){k(Lr)})):(Ne[Tt]=Rn,Ve[Tt]=_o,dt())})};yt(U),U!==ue&&yt(ue)},d.prototype.stat=function(p,b,k){var I=this.store.beginTransaction("readonly");this.findINode(I,p,function(L,U){Gi(L,k)&&k(null,U.toStats())})},d.prototype.createFile=function(p,b,k,I){var L=this,U=this.store.beginTransaction("readwrite"),G=se();this.commitNewFile(U,p,S.FILE,k,G,function(ue,_e){Gi(ue,I)&&I(null,new lL(L,p,b,_e.toStats(),G))})},d.prototype.openFile=function(p,b,k){var I=this,L=this.store.beginTransaction("readonly");this.findINode(L,p,function(U,G){Gi(U,k)&&L.get(G.id,function(ue,_e){Gi(ue,k)&&(_e===void 0?k(g.ENOENT(p)):k(null,new lL(I,p,b,G.toStats(),_e)))})})},d.prototype.unlink=function(p,b){this.removeEntry(p,!1,b)},d.prototype.rmdir=function(p,b){var k=this;this.readdir(p,function(I,L){I?b(I):L.length>0?b(g.ENOTEMPTY(p)):k.removeEntry(p,!0,b)})},d.prototype.mkdir=function(p,b,k){var I=this.store.beginTransaction("readwrite"),L=a.from("{}");this.commitNewFile(I,p,S.DIRECTORY,b,L,k)},d.prototype.readdir=function(p,b){var k=this,I=this.store.beginTransaction("readonly");this.findINode(I,p,function(L,U){Gi(L,b)&&k.getDirListing(I,p,U,function(G,ue){Gi(G,b)&&b(null,Object.keys(ue))})})},d.prototype._sync=function(p,b,k,I){var L=this,U=this.store.beginTransaction("readwrite");this._findINode(U,f.dirname(p),f.basename(p),function(G,ue){cn(G,U,I)&&L.getINode(U,p,ue,function(_e,Ne){if(cn(_e,U,I)){var Ve=Ne.update(k);U.put(Ne.id,b,!0,function(Je){cn(Je,U,I)&&(Ve?U.put(ue,Ne.toBuffer(),!0,function(dt){cn(dt,U,I)&&U.commit(I)}):U.commit(I))})}})})},d.prototype.makeRootDirectory=function(p){var b=this.store.beginTransaction("readwrite");b.get(tl,function(k,I){if(k||I===void 0){var L=new Date().getTime(),U=new Ci(Iv(),4096,511|S.DIRECTORY,L,L,L);b.put(U.id,aL(),!1,function(G){cn(G,b,p)&&b.put(tl,U.toBuffer(),!1,function(ue){ue?b.abort(function(){p(ue)}):b.commit(p)})})}else b.commit(p)})},d.prototype._findINode=function(p,b,k,I){var L=this,U=function(G,ue,_e){G?I(G):_e[k]?I(null,_e[k]):I(g.ENOENT(f.resolve(b,k)))};b==="/"?k===""?I(null,tl):this.getINode(p,b,tl,function(G,ue){Gi(G,I)&&L.getDirListing(p,b,ue,function(_e,Ne){U(_e,ue,Ne)})}):this.findINodeAndDirListing(p,b,U)},d.prototype.findINode=function(p,b,k){var I=this;this._findINode(p,f.dirname(b),f.basename(b),function(L,U){Gi(L,k)&&I.getINode(p,b,U,k)})},d.prototype.getINode=function(p,b,k,I){p.get(k,function(L,U){Gi(L,I)&&(U===void 0?I(g.ENOENT(b)):I(null,Ci.fromBuffer(U)))})},d.prototype.getDirListing=function(p,b,k,I){k.isDirectory()?p.get(k.id,function(L,U){if(Gi(L,I))try{I(null,JSON.parse(U.toString()))}catch{I(g.ENOENT(b))}}):I(g.ENOTDIR(b))},d.prototype.findINodeAndDirListing=function(p,b,k){var I=this;this.findINode(p,b,function(L,U){Gi(L,k)&&I.getDirListing(p,b,U,function(G,ue){Gi(G,k)&&k(null,U,ue)})})},d.prototype.addNewNode=function(p,b,k){var I=0,L,U=function(){++I===5?k(new g(u.EIO,"Unable to commit data to key-value store.")):(L=Iv(),p.put(L,b,!1,function(G,ue){G||!ue?U():k(null,L)}))};U()},d.prototype.commitNewFile=function(p,b,k,I,L,U){var G=this,ue=f.dirname(b),_e=f.basename(b),Ne=new Date().getTime();if(b==="/")return U(g.EEXIST(b));this.findINodeAndDirListing(p,ue,function(Ve,Je,dt){cn(Ve,p,U)&&(dt[_e]?p.abort(function(){U(g.EEXIST(b))}):G.addNewNode(p,L,function(yt,Tt){if(cn(yt,p,U)){var Lr=new Ci(Tt,L.length,I|k,Ne,Ne,Ne);G.addNewNode(p,Lr.toBuffer(),function(Rn,_o){cn(Rn,p,U)&&(dt[_e]=_o,p.put(Je.id,a.from(JSON.stringify(dt)),!0,function(wo){cn(wo,p,U)&&p.commit(function(ff){cn(ff,p,U)&&U(null,Lr)})}))})}}))})},d.prototype.removeEntry=function(p,b,k){var I=this,L=this.store.beginTransaction("readwrite"),U=f.dirname(p),G=f.basename(p);this.findINodeAndDirListing(L,U,function(ue,_e,Ne){if(cn(ue,L,k))if(!Ne[G])L.abort(function(){k(g.ENOENT(p))});else{var Ve=Ne[G];delete Ne[G],I.getINode(L,p,Ve,function(Je,dt){cn(Je,L,k)&&(!b&&dt.isDirectory()?L.abort(function(){k(g.EISDIR(p))}):b&&!dt.isDirectory()?L.abort(function(){k(g.ENOTDIR(p))}):L.del(dt.id,function(yt){cn(yt,L,k)&&L.del(Ve,function(Tt){cn(Tt,L,k)&&L.put(_e.id,a.from(JSON.stringify(Ne)),!0,function(Lr){cn(Lr,L,k)&&L.commit(k)})})}))})}})},d}(Ie),yc=function(){this.store={}};yc.prototype.name=function(){return af.Name},yc.prototype.clear=function(){this.store={}},yc.prototype.beginTransaction=function(d){return new ts(this)},yc.prototype.get=function(d){return this.store[d]},yc.prototype.put=function(d,y,p){return!p&&this.store.hasOwnProperty(d)?!1:(this.store[d]=y,!0)},yc.prototype.del=function(d){delete this.store[d]};var af=function(v){function d(){v.call(this,{store:new yc})}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){b(null,new d)},d}(sL);af.Name="InMemory",af.Options={};var wS=Zr.indexedDB||Zr.mozIndexedDB||Zr.webkitIndexedDB||Zr.msIndexedDB;function mh(v,d){switch(d===void 0&&(d=v.toString()),v.name){case"NotFoundError":return new g(u.ENOENT,d);case"QuotaExceededError":return new g(u.ENOSPC,d);default:return new g(u.EIO,d)}}function vh(v,d,y){return d===void 0&&(d=u.EIO),y===void 0&&(y=null),function(p){p.preventDefault(),v(new g(d,y!==null?y:void 0))}}var SS=function(d,y){this.tx=d,this.store=y};SS.prototype.get=function(d,y){try{var p=this.store.get(d);p.onerror=vh(y),p.onsuccess=function(b){var k=b.target.result;k===void 0?y(null,k):y(null,Se(k))}}catch(b){y(mh(b))}};var nX=function(v){function d(y,p){v.call(this,y,p)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.put=function(p,b,k,I){try{var L=q(b),U;k?U=this.store.put(L,p):U=this.store.add(L,p),U.onerror=vh(I),U.onsuccess=function(G){I(null,!0)}}catch(G){I(mh(G))}},d.prototype.del=function(p,b){try{var k=this.store.delete(p);k.onerror=vh(b),k.onsuccess=function(I){b()}}catch(I){b(mh(I))}},d.prototype.commit=function(p){setTimeout(p,0)},d.prototype.abort=function(p){var b=null;try{this.tx.abort()}catch(k){b=mh(k)}finally{p(b)}},d}(SS),Cv=function(d,y){var p=this;y===void 0&&(y="browserfs"),this.storeName=y;var b=wS.open(this.storeName,1);b.onupgradeneeded=function(k){var I=k.target.result;I.objectStoreNames.contains(p.storeName)&&I.deleteObjectStore(p.storeName),I.createObjectStore(p.storeName)},b.onsuccess=function(k){p.db=k.target.result,d(null,p)},b.onerror=vh(d,u.EACCES)};Cv.prototype.name=function(){return bh.Name+" - "+this.storeName},Cv.prototype.clear=function(d){try{var y=this.db.transaction(this.storeName,"readwrite"),p=y.objectStore(this.storeName),b=p.clear();b.onsuccess=function(k){setTimeout(d,0)},b.onerror=vh(d)}catch(k){d(mh(k))}},Cv.prototype.beginTransaction=function(d){d===void 0&&(d="readonly");var y=this.db.transaction(this.storeName,d),p=y.objectStore(this.storeName);if(d==="readwrite")return new nX(y,p);if(d==="readonly")return new SS(y,p);throw new g(u.EINVAL,"Invalid transaction type.")};var bh=function(v){function d(y,p,b){var k=this;b===void 0&&(b=!0),v.call(this),this.store=new Cv(function(I){I?y(I):k.init(k.store,function(L){y(L,k)})},p),F(b,d.Name,{storeName:p})}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){new d(b,p.storeName,!1)},d.isAvailable=function(){try{return typeof wS<"u"&&wS.open("__browserfs_test__")!==null}catch{return!1}},d}(rX);bh.Name="IndexedDB",bh.Options={storeName:{type:"string",optional:!0,description:"The name of this file system. You can have multiple IndexedDB file systems operating at once, but each must have a different name."}};var xS=!1,_h;try{Zr.localStorage.setItem("__test__",String.fromCharCode(55296)),xS=Zr.localStorage.getItem("__test__")===String.fromCharCode(55296)}catch{xS=!1}_h=xS?"binary_string":"binary_string_ie",a.isEncoding(_h)||(_h="base64");var mc=function(){};mc.prototype.name=function(){return wh.Name},mc.prototype.clear=function(){Zr.localStorage.clear()},mc.prototype.beginTransaction=function(d){return new ts(this)},mc.prototype.get=function(d){try{var y=Zr.localStorage.getItem(d);if(y!==null)return a.from(y,_h)}catch{}},mc.prototype.put=function(d,y,p){try{return!p&&Zr.localStorage.getItem(d)!==null?!1:(Zr.localStorage.setItem(d,y.toString(_h)),!0)}catch{throw new g(u.ENOSPC,"LocalStorage is full.")}},mc.prototype.del=function(d){try{Zr.localStorage.removeItem(d)}catch(y){throw new g(u.EIO,"Unable to delete key "+d+": "+y)}};var wh=function(v){function d(){v.call(this,{store:new mc})}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){b(null,new d)},d.isAvailable=function(){return typeof Zr.localStorage<"u"},d}(sL);wh.Name="LocalStorage",wh.Options={};var of=function(v){function d(){v.call(this),this.mountList=[],this.mntMap={},this.rootFs=new af}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){var k=new d;Object.keys(p).forEach(function(I){k.mount(I,p[I])}),b(null,k)},d.isAvailable=function(){return!0},d.prototype.mount=function(p,b){if(p[0]!=="/"&&(p="/"+p),p=f.resolve(p),this.mntMap[p])throw new g(u.EINVAL,"Mount point "+p+" is already taken.");$(p,511,this.rootFs),this.mntMap[p]=b,this.mountList.push(p),this.mountList=this.mountList.sort(function(k,I){return I.length-k.length})},d.prototype.umount=function(p){var b=this;if(p[0]!=="/"&&(p="/"+p),p=f.resolve(p),!this.mntMap[p])throw new g(u.EINVAL,"Mount point "+p+" is already unmounted.");for(delete this.mntMap[p],this.mountList.splice(this.mountList.indexOf(p),1);p!=="/"&&b.rootFs.readdirSync(p).length===0;)b.rootFs.rmdirSync(p),p=f.dirname(p)},d.prototype._getFs=function(p){for(var b=this,k=this.mountList,I=k.length,L=0;L<I;L++){var U=k[L];if(U.length<=p.length&&p.indexOf(U)===0)return p=p.substr(U.length>1?U.length:0),p===""&&(p="/"),{fs:b.mntMap[U],path:p}}return{fs:this.rootFs,path:p}},d.prototype.getName=function(){return d.Name},d.prototype.diskSpace=function(p,b){b(0,0)},d.prototype.isReadOnly=function(){return!1},d.prototype.supportsLinks=function(){return!1},d.prototype.supportsProps=function(){return!1},d.prototype.supportsSynch=function(){return!0},d.prototype.standardizeError=function(p,b,k){var I=p.message.indexOf(b);return I!==-1&&(p.message=p.message.substr(0,I)+k+p.message.substr(I+b.length),p.path=k),p},d.prototype.rename=function(p,b,k){var I=this,L=this._getFs(p),U=this._getFs(b);return L.fs===U.fs?L.fs.rename(L.path,U.path,function(G){G&&I.standardizeError(I.standardizeError(G,L.path,p),U.path,b),k(G)}):Q.readFile(p,function(G,ue){if(G)return k(G);Q.writeFile(b,ue,function(_e){if(_e)return k(_e);Q.unlink(p,k)})})},d.prototype.renameSync=function(p,b){var k=this._getFs(p),I=this._getFs(b);if(k.fs===I.fs)try{return k.fs.renameSync(k.path,I.path)}catch(U){throw this.standardizeError(this.standardizeError(U,k.path,p),I.path,b),U}var L=Q.readFileSync(p);return Q.writeFileSync(b,L),Q.unlinkSync(p)},d.prototype.readdirSync=function(p){var b=this._getFs(p),k=null;if(b.fs!==this.rootFs)try{k=this.rootFs.readdirSync(p)}catch{}try{var I=b.fs.readdirSync(b.path);return k===null?I:I.concat(k.filter(function(L){return I.indexOf(L)===-1}))}catch(L){if(k===null)throw this.standardizeError(L,b.path,p);return k}},d.prototype.readdir=function(p,b){var k=this,I=this._getFs(p);I.fs.readdir(I.path,function(L,U){if(I.fs!==k.rootFs)try{var G=k.rootFs.readdirSync(p);U?U=U.concat(G.filter(function(ue){return U.indexOf(ue)===-1})):U=G}catch{if(L)return b(k.standardizeError(L,I.path,p))}else if(L)return b(k.standardizeError(L,I.path,p));b(null,U)})},d.prototype.rmdirSync=function(p){var b=this._getFs(p);if(this._containsMountPt(p))throw g.ENOTEMPTY(p);try{b.fs.rmdirSync(b.path)}catch(k){throw this.standardizeError(k,b.path,p)}},d.prototype.rmdir=function(p,b){var k=this,I=this._getFs(p);this._containsMountPt(p)?b(g.ENOTEMPTY(p)):I.fs.rmdir(I.path,function(L){b(L?k.standardizeError(L,I.path,p):null)})},d.prototype._containsMountPt=function(p){for(var b=this.mountList,k=b.length,I=0;I<k;I++){var L=b[I];if(L.length>=p.length&&L.slice(0,p.length)===p)return!0}return!1},d}(Ie);of.Name="MountableFileSystem",of.Options={};function cL(v,d,y){return d?function(){for(var p=[],b=arguments.length;b--;)p[b]=arguments[b];var k=p[0],I=this._getFs(k);p[0]=I.path;try{return I.fs[v].apply(I.fs,p)}catch(L){throw this.standardizeError(L,I.path,k),L}}:function(){for(var p=this,b=[],k=arguments.length;k--;)b[k]=arguments[k];var I=b[0],L=this._getFs(I);if(b[0]=L.path,typeof b[b.length-1]=="function"){var U=b[b.length-1];b[b.length-1]=function(){for(var G=[],ue=arguments.length;ue--;)G[ue]=arguments[ue];G.length>0&&G[0]instanceof g&&p.standardizeError(G[0],L.path,I),U.apply(null,G)}}return L.fs[v].apply(L.fs,b)}}for(var uL=[["exists","unlink","readlink"],["stat","mkdir","realpath","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]],Sh=0;Sh<uL.length;Sh++)for(var iX=uL[Sh],kS=0,fL=iX;kS<fL.length;kS+=1){var Tv=fL[kS];of.prototype[Tv]=cL(Tv,!1,Sh+1),of.prototype[Tv+"Sync"]=cL(Tv+"Sync",!0,Sh+1)}var xh;if(typeof setImmediate<"u")xh=setImmediate;else{var ha=Zr,sf=[],dL="zero-timeout-message",aX=function(){if(typeof ha.importScripts<"u"||!ha.postMessage)return!1;var v=!0,d=ha.onmessage;return ha.onmessage=function(){v=!1},ha.postMessage("","*"),ha.onmessage=d,v};if(aX()){xh=function(v){sf.push(v),ha.postMessage(dL,"*")};var pL=function(v){if(v.source===self&&v.data===dL&&(v.stopPropagation?v.stopPropagation():v.cancelBubble=!0,sf.length>0)){var d=sf.shift();return d()}};ha.addEventListener?ha.addEventListener("message",pL,!0):ha.attachEvent("onmessage",pL)}else if(ha.MessageChannel){var hL=new ha.MessageChannel;hL.port1.onmessage=function(v){if(sf.length>0)return sf.shift()()},xh=function(v){sf.push(v),hL.port2.postMessage("")}}else xh=function(v){return setTimeout(v,0)}}var ES=xh,kh=function(){this._locked=!1,this._waiters=[]};kh.prototype.lock=function(d){if(this._locked){this._waiters.push(d);return}this._locked=!0,d()},kh.prototype.unlock=function(){if(!this._locked)throw new Error("unlock of a non-locked mutex");var d=this._waiters.shift();if(d){ES(d);return}this._locked=!1},kh.prototype.tryLock=function(){return this._locked?!1:(this._locked=!0,!0)},kh.prototype.isLocked=function(){return this._locked};var kt=function(d){this._fs=d,this._mu=new kh};kt.prototype.getName=function(){return"LockedFS<"+this._fs.getName()+">"},kt.prototype.getFSUnlocked=function(){return this._fs},kt.prototype.initialize=function(d){this._fs.initialize(d)},kt.prototype.diskSpace=function(d,y){this._fs.diskSpace(d,y)},kt.prototype.isReadOnly=function(){return this._fs.isReadOnly()},kt.prototype.supportsLinks=function(){return this._fs.supportsLinks()},kt.prototype.supportsProps=function(){return this._fs.supportsProps()},kt.prototype.supportsSynch=function(){return this._fs.supportsSynch()},kt.prototype.rename=function(d,y,p){var b=this;this._mu.lock(function(){b._fs.rename(d,y,function(k){b._mu.unlock(),p(k)})})},kt.prototype.renameSync=function(d,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.renameSync(d,y)},kt.prototype.stat=function(d,y,p){var b=this;this._mu.lock(function(){b._fs.stat(d,y,function(k,I){b._mu.unlock(),p(k,I)})})},kt.prototype.statSync=function(d,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.statSync(d,y)},kt.prototype.open=function(d,y,p,b){var k=this;this._mu.lock(function(){k._fs.open(d,y,p,function(I,L){k._mu.unlock(),b(I,L)})})},kt.prototype.openSync=function(d,y,p){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.openSync(d,y,p)},kt.prototype.unlink=function(d,y){var p=this;this._mu.lock(function(){p._fs.unlink(d,function(b){p._mu.unlock(),y(b)})})},kt.prototype.unlinkSync=function(d){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.unlinkSync(d)},kt.prototype.rmdir=function(d,y){var p=this;this._mu.lock(function(){p._fs.rmdir(d,function(b){p._mu.unlock(),y(b)})})},kt.prototype.rmdirSync=function(d){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.rmdirSync(d)},kt.prototype.mkdir=function(d,y,p){var b=this;this._mu.lock(function(){b._fs.mkdir(d,y,function(k){b._mu.unlock(),p(k)})})},kt.prototype.mkdirSync=function(d,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.mkdirSync(d,y)},kt.prototype.readdir=function(d,y){var p=this;this._mu.lock(function(){p._fs.readdir(d,function(b,k){p._mu.unlock(),y(b,k)})})},kt.prototype.readdirSync=function(d){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readdirSync(d)},kt.prototype.exists=function(d,y){var p=this;this._mu.lock(function(){p._fs.exists(d,function(b){p._mu.unlock(),y(b)})})},kt.prototype.existsSync=function(d){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.existsSync(d)},kt.prototype.realpath=function(d,y,p){var b=this;this._mu.lock(function(){b._fs.realpath(d,y,function(k,I){b._mu.unlock(),p(k,I)})})},kt.prototype.realpathSync=function(d,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.realpathSync(d,y)},kt.prototype.truncate=function(d,y,p){var b=this;this._mu.lock(function(){b._fs.truncate(d,y,function(k){b._mu.unlock(),p(k)})})},kt.prototype.truncateSync=function(d,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.truncateSync(d,y)},kt.prototype.readFile=function(d,y,p,b){var k=this;this._mu.lock(function(){k._fs.readFile(d,y,p,function(I,L){k._mu.unlock(),b(I,L)})})},kt.prototype.readFileSync=function(d,y,p){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readFileSync(d,y,p)},kt.prototype.writeFile=function(d,y,p,b,k,I){var L=this;this._mu.lock(function(){L._fs.writeFile(d,y,p,b,k,function(U){L._mu.unlock(),I(U)})})},kt.prototype.writeFileSync=function(d,y,p,b,k){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.writeFileSync(d,y,p,b,k)},kt.prototype.appendFile=function(d,y,p,b,k,I){var L=this;this._mu.lock(function(){L._fs.appendFile(d,y,p,b,k,function(U){L._mu.unlock(),I(U)})})},kt.prototype.appendFileSync=function(d,y,p,b,k){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.appendFileSync(d,y,p,b,k)},kt.prototype.chmod=function(d,y,p,b){var k=this;this._mu.lock(function(){k._fs.chmod(d,y,p,function(I){k._mu.unlock(),b(I)})})},kt.prototype.chmodSync=function(d,y,p){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chmodSync(d,y,p)},kt.prototype.chown=function(d,y,p,b,k){var I=this;this._mu.lock(function(){I._fs.chown(d,y,p,b,function(L){I._mu.unlock(),k(L)})})},kt.prototype.chownSync=function(d,y,p,b){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chownSync(d,y,p,b)},kt.prototype.utimes=function(d,y,p,b){var k=this;this._mu.lock(function(){k._fs.utimes(d,y,p,function(I){k._mu.unlock(),b(I)})})},kt.prototype.utimesSync=function(d,y,p){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.utimesSync(d,y,p)},kt.prototype.link=function(d,y,p){var b=this;this._mu.lock(function(){b._fs.link(d,y,function(k){b._mu.unlock(),p(k)})})},kt.prototype.linkSync=function(d,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.linkSync(d,y)},kt.prototype.symlink=function(d,y,p,b){var k=this;this._mu.lock(function(){k._fs.symlink(d,y,p,function(I){k._mu.unlock(),b(I)})})},kt.prototype.symlinkSync=function(d,y,p){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.symlinkSync(d,y,p)},kt.prototype.readlink=function(d,y){var p=this;this._mu.lock(function(){p._fs.readlink(d,function(b,k){p._mu.unlock(),y(b,k)})})},kt.prototype.readlinkSync=function(d){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readlinkSync(d)};var rs="/.deletedFiles.log";function gL(v){return 146|v}function Yi(v){return E.getFileFlag(v)}var yL=function(v){function d(y,p,b,k,I){v.call(this,y,p,b,k,I)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.sync=function(p){var b=this;if(!this.isDirty()){p(null);return}this._fs._syncAsync(this,function(k){b.resetDirty(),p(k)})},d.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},d.prototype.close=function(p){this.sync(p)},d.prototype.closeSync=function(){this.syncSync()},d}(St),mL=function(v){function d(y,p){if(v.call(this),this._isInitialized=!1,this._initializeCallbacks=[],this._deletedFiles={},this._deleteLog="",this._deleteLogUpdatePending=!1,this._deleteLogUpdateNeeded=!1,this._deleteLogError=null,this._writable=y,this._readable=p,this._writable.isReadOnly())throw new g(u.EINVAL,"Writable file system must be writable.")}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.isAvailable=function(){return!0},d.prototype.getOverlayedFileSystems=function(){return{readable:this._readable,writable:this._writable}},d.prototype._syncAsync=function(p,b){var k=this;this.createParentDirectoriesAsync(p.getPath(),function(I){if(I)return b(I);k._writable.writeFile(p.getPath(),p.getBuffer(),null,Yi("w"),p.getStats().mode,b)})},d.prototype._syncSync=function(p){this.createParentDirectories(p.getPath()),this._writable.writeFileSync(p.getPath(),p.getBuffer(),null,Yi("w"),p.getStats().mode)},d.prototype.getName=function(){return Eh.Name},d.prototype.initialize=function(p){var b=this,k=this._initializeCallbacks,I=function(L){b._isInitialized=!L,b._initializeCallbacks=[],k.forEach(function(U){return U(L)})};if(this._isInitialized)return p();k.push(p),k.length===1&&this._writable.readFile(rs,"utf8",Yi("r"),function(L,U){if(L){if(L.errno!==u.ENOENT)return I(L)}else b._deleteLog=U;b._reparseDeletionLog(),I()})},d.prototype.isReadOnly=function(){return!1},d.prototype.supportsSynch=function(){return this._readable.supportsSynch()&&this._writable.supportsSynch()},d.prototype.supportsLinks=function(){return!1},d.prototype.supportsProps=function(){return this._readable.supportsProps()&&this._writable.supportsProps()},d.prototype.getDeletionLog=function(){return this._deleteLog},d.prototype.restoreDeletionLog=function(p){this._deleteLog=p,this._reparseDeletionLog(),this.updateLog("")},d.prototype.rename=function(p,b,k){var I=this;if(!(!this.checkInitAsync(k)||this.checkPathAsync(p,k)||this.checkPathAsync(b,k))){if(p===rs||b===rs)return k(g.EPERM("Cannot rename deletion log."));if(p===b)return k();this.stat(p,!1,function(L,U){return L?k(L):I.stat(b,!1,function(G,ue){var _e=I;function Ne(Je){var dt=Je.shift();if(!dt)return k();var yt=f.resolve(p,dt),Tt=f.resolve(b,dt);_e.rename(yt,Tt,function(Lr){if(Lr)return k(Lr);Ne(Je)})}var Ve=511;if(U.isDirectory()){if(G)return G.errno!==u.ENOENT?k(G):I._writable.exists(p,function(Je){if(Je)return I._writable.rename(p,b,k);I._writable.mkdir(b,Ve,function(dt){if(dt)return k(dt);I._readable.readdir(p,function(yt,Tt){if(yt)return k();Ne(Tt)})})});if(Ve=ue.mode,!ue.isDirectory())return k(g.ENOTDIR(b));I.readdir(b,function(Je,dt){if(dt&&dt.length)return k(g.ENOTEMPTY(b));I._readable.readdir(p,function(yt,Tt){if(yt)return k();Ne(Tt)})})}if(ue&&ue.isDirectory())return k(g.EISDIR(b));I.readFile(p,null,Yi("r"),function(Je,dt){return Je?k(Je):I.writeFile(b,dt,null,Yi("w"),U.mode,function(yt){return yt?k(yt):I.unlink(p,k)})})})})}},d.prototype.renameSync=function(p,b){var k=this;if(this.checkInitialized(),this.checkPath(p),this.checkPath(b),p===rs||b===rs)throw g.EPERM("Cannot rename deletion log.");var I=this.statSync(p,!1);if(I.isDirectory()){if(p===b)return;var L=511;if(this.existsSync(b)){var U=this.statSync(b,!1);if(L=U.mode,U.isDirectory()){if(this.readdirSync(b).length>0)throw g.ENOTEMPTY(b)}else throw g.ENOTDIR(b)}this._writable.existsSync(p)?this._writable.renameSync(p,b):this._writable.existsSync(b)||this._writable.mkdirSync(b,L),this._readable.existsSync(p)&&this._readable.readdirSync(p).forEach(function(G){k.renameSync(f.resolve(p,G),f.resolve(b,G))})}else{if(this.existsSync(b)&&this.statSync(b,!1).isDirectory())throw g.EISDIR(b);this.writeFileSync(b,this.readFileSync(p,null,Yi("r")),null,Yi("w"),I.mode)}p!==b&&this.existsSync(p)&&this.unlinkSync(p)},d.prototype.stat=function(p,b,k){var I=this;this.checkInitAsync(k)&&this._writable.stat(p,b,function(L,U){L&&L.errno===u.ENOENT?(I._deletedFiles[p]&&k(g.ENOENT(p)),I._readable.stat(p,b,function(G,ue){ue&&(ue=ue.clone(),ue.mode=gL(ue.mode)),k(G,ue)})):k(L,U)})},d.prototype.statSync=function(p,b){this.checkInitialized();try{return this._writable.statSync(p,b)}catch{if(this._deletedFiles[p])throw g.ENOENT(p);var k=this._readable.statSync(p,b).clone();return k.mode=gL(k.mode),k}},d.prototype.open=function(p,b,k,I){var L=this;!this.checkInitAsync(I)||this.checkPathAsync(p,I)||this.stat(p,!1,function(U,G){if(G)switch(b.pathExistsAction()){case w.TRUNCATE_FILE:return L.createParentDirectoriesAsync(p,function(ue){if(ue)return I(ue);L._writable.open(p,b,k,I)});case w.NOP:return L._writable.exists(p,function(ue){ue?L._writable.open(p,b,k,I):(G=G.clone(),G.mode=k,L._readable.readFile(p,null,Yi("r"),function(_e,Ne){if(_e)return I(_e);G.size===-1&&(G.size=Ne.length);var Ve=new yL(L,p,b,G,Ne);I(null,Ve)}))});default:return I(g.EEXIST(p))}else switch(b.pathNotExistsAction()){case w.CREATE_FILE:return L.createParentDirectoriesAsync(p,function(ue){return ue?I(ue):L._writable.open(p,b,k,I)});default:return I(g.ENOENT(p))}})},d.prototype.openSync=function(p,b,k){if(this.checkInitialized(),this.checkPath(p),p===rs)throw g.EPERM("Cannot open deletion log.");if(this.existsSync(p))switch(b.pathExistsAction()){case w.TRUNCATE_FILE:return this.createParentDirectories(p),this._writable.openSync(p,b,k);case w.NOP:if(this._writable.existsSync(p))return this._writable.openSync(p,b,k);var I=this._readable.readFileSync(p,null,Yi("r")),L=this._readable.statSync(p,!1).clone();return L.mode=k,new yL(this,p,b,L,I);default:throw g.EEXIST(p)}else switch(b.pathNotExistsAction()){case w.CREATE_FILE:return this.createParentDirectories(p),this._writable.openSync(p,b,k);default:throw g.ENOENT(p)}},d.prototype.unlink=function(p,b){var k=this;!this.checkInitAsync(b)||this.checkPathAsync(p,b)||this.exists(p,function(I){if(!I)return b(g.ENOENT(p));k._writable.exists(p,function(L){if(L)return k._writable.unlink(p,function(U){if(U)return b(U);k.exists(p,function(G){G&&k.deletePath(p),b(null)})});k.deletePath(p),b(null)})})},d.prototype.unlinkSync=function(p){if(this.checkInitialized(),this.checkPath(p),this.existsSync(p))this._writable.existsSync(p)&&this._writable.unlinkSync(p),this.existsSync(p)&&this.deletePath(p);else throw g.ENOENT(p)},d.prototype.rmdir=function(p,b){var k=this;if(this.checkInitAsync(b)){var I=function(){k.readdir(p,function(L,U){if(L)return b(L);if(U.length)return b(g.ENOTEMPTY(p));k.deletePath(p),b(null)})};this.exists(p,function(L){if(!L)return b(g.ENOENT(p));k._writable.exists(p,function(U){U?k._writable.rmdir(p,function(G){if(G)return b(G);k._readable.exists(p,function(ue){ue?I():b()})}):I()})})}},d.prototype.rmdirSync=function(p){if(this.checkInitialized(),this.existsSync(p)){if(this._writable.existsSync(p)&&this._writable.rmdirSync(p),this.existsSync(p)){if(this.readdirSync(p).length>0)throw g.ENOTEMPTY(p);this.deletePath(p)}}else throw g.ENOENT(p)},d.prototype.mkdir=function(p,b,k){var I=this;this.checkInitAsync(k)&&this.exists(p,function(L){if(L)return k(g.EEXIST(p));I.createParentDirectoriesAsync(p,function(U){if(U)return k(U);I._writable.mkdir(p,b,k)})})},d.prototype.mkdirSync=function(p,b){if(this.checkInitialized(),this.existsSync(p))throw g.EEXIST(p);this.createParentDirectories(p),this._writable.mkdirSync(p,b)},d.prototype.readdir=function(p,b){var k=this;this.checkInitAsync(b)&&this.stat(p,!1,function(I,L){if(I)return b(I);if(!L.isDirectory())return b(g.ENOTDIR(p));k._writable.readdir(p,function(U,G){if(U&&U.code!=="ENOENT")return b(U);(U||!G)&&(G=[]),k._readable.readdir(p,function(ue,_e){(ue||!_e)&&(_e=[]);var Ne={},Ve=G.concat(_e.filter(function(Je){return!k._deletedFiles[p+"/"+Je]})).filter(function(Je){var dt=!Ne[Je];return Ne[Je]=!0,dt});b(null,Ve)})})})},d.prototype.readdirSync=function(p){var b=this;this.checkInitialized();var k=this.statSync(p,!1);if(!k.isDirectory())throw g.ENOTDIR(p);var I=[];try{I=I.concat(this._writable.readdirSync(p))}catch{}try{I=I.concat(this._readable.readdirSync(p).filter(function(U){return!b._deletedFiles[p+"/"+U]}))}catch{}var L={};return I.filter(function(U){var G=!L[U];return L[U]=!0,G})},d.prototype.exists=function(p,b){var k=this;this.checkInitialized(),this._writable.exists(p,function(I){if(I)return b(!0);k._readable.exists(p,function(L){b(L&&k._deletedFiles[p]!==!0)})})},d.prototype.existsSync=function(p){return this.checkInitialized(),this._writable.existsSync(p)||this._readable.existsSync(p)&&this._deletedFiles[p]!==!0},d.prototype.chmod=function(p,b,k,I){var L=this;this.checkInitAsync(I)&&this.operateOnWritableAsync(p,function(U){if(U)return I(U);L._writable.chmod(p,b,k,I)})},d.prototype.chmodSync=function(p,b,k){var I=this;this.checkInitialized(),this.operateOnWritable(p,function(){I._writable.chmodSync(p,b,k)})},d.prototype.chown=function(p,b,k,I,L){var U=this;this.checkInitAsync(L)&&this.operateOnWritableAsync(p,function(G){if(G)return L(G);U._writable.chown(p,b,k,I,L)})},d.prototype.chownSync=function(p,b,k,I){var L=this;this.checkInitialized(),this.operateOnWritable(p,function(){L._writable.chownSync(p,b,k,I)})},d.prototype.utimes=function(p,b,k,I){var L=this;this.checkInitAsync(I)&&this.operateOnWritableAsync(p,function(U){if(U)return I(U);L._writable.utimes(p,b,k,I)})},d.prototype.utimesSync=function(p,b,k){var I=this;this.checkInitialized(),this.operateOnWritable(p,function(){I._writable.utimesSync(p,b,k)})},d.prototype.deletePath=function(p){this._deletedFiles[p]=!0,this.updateLog("d"+p+`
`)},d.prototype.updateLog=function(p){var b=this;this._deleteLog+=p,this._deleteLogUpdatePending?this._deleteLogUpdateNeeded=!0:(this._deleteLogUpdatePending=!0,this._writable.writeFile(rs,this._deleteLog,"utf8",E.getFileFlag("w"),420,function(k){b._deleteLogUpdatePending=!1,k?b._deleteLogError=k:b._deleteLogUpdateNeeded&&(b._deleteLogUpdateNeeded=!1,b.updateLog(""))}))},d.prototype._reparseDeletionLog=function(){var p=this;this._deletedFiles={},this._deleteLog.split(`
`).forEach(function(b){p._deletedFiles[b.slice(1)]=b.slice(0,1)==="d"})},d.prototype.checkInitialized=function(){if(this._isInitialized){if(this._deleteLogError!==null){var p=this._deleteLogError;throw this._deleteLogError=null,p}}else throw new g(u.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")},d.prototype.checkInitAsync=function(p){if(this._isInitialized){if(this._deleteLogError!==null){var b=this._deleteLogError;return this._deleteLogError=null,p(b),!1}}else return p(new g(u.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")),!1;return!0},d.prototype.checkPath=function(p){if(p===rs)throw g.EPERM(p)},d.prototype.checkPathAsync=function(p,b){return p===rs?(b(g.EPERM(p)),!0):!1},d.prototype.createParentDirectoriesAsync=function(p,b){var k=f.dirname(p),I=[],L=this;this._writable.stat(k,!1,U);function U(ue,_e){ue?(I.push(k),k=f.dirname(k),L._writable.stat(k,!1,U)):G()}function G(){if(!I.length)return b();var ue=I.pop();L._readable.stat(ue,!1,function(_e,Ne){if(!Ne)return b();L._writable.mkdir(ue,Ne.mode,function(Ve){if(Ve)return b(Ve);G()})})}},d.prototype.createParentDirectories=function(p){for(var b=this,k=f.dirname(p),I=[];!this._writable.existsSync(k);)I.push(k),k=f.dirname(k);I=I.reverse(),I.forEach(function(L){b._writable.mkdirSync(L,b.statSync(L,!1).mode)})},d.prototype.operateOnWritable=function(p,b){if(this.existsSync(p))this._writable.existsSync(p)||this.copyToWritable(p),b();else throw g.ENOENT(p)},d.prototype.operateOnWritableAsync=function(p,b){var k=this;this.exists(p,function(I){if(!I)return b(g.ENOENT(p));k._writable.exists(p,function(L){if(L)b();else return k.copyToWritableAsync(p,b)})})},d.prototype.copyToWritable=function(p){var b=this.statSync(p,!1);b.isDirectory()?this._writable.mkdirSync(p,b.mode):this.writeFileSync(p,this._readable.readFileSync(p,null,Yi("r")),null,Yi("w"),this.statSync(p,!1).mode)},d.prototype.copyToWritableAsync=function(p,b){var k=this;this.stat(p,!1,function(I,L){if(I)return b(I);if(L.isDirectory())return k._writable.mkdir(p,L.mode,b);k._readable.readFile(p,null,Yi("r"),function(U,G){if(U)return b(U);k.writeFile(p,G,null,Yi("w"),L.mode,b)})})},d}(Ie),Eh=function(v){function d(y,p,b){b===void 0&&(b=!0),v.call(this,new mL(y,p)),F(b,d.Name,{readable:"readable file system",writable:"writable file system"})}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){try{var k=new d(p.writable,p.readable,!1);k.initialize(function(I){b(I,k)},!1)}catch(I){b(I)}},d.isAvailable=function(){return mL.isAvailable()},d.prototype.initialize=function(p,b){b===void 0&&(b=!0),b&&console.warn("[OverlayFS] OverlayFS.initialize() is deprecated and will be removed in the next major release. Please use 'OverlayFS.Create({readable: readable file system instance, writable: writable file system instance}, cb)' to create and initialize OverlayFS instances."),v.prototype.initialize.call(this,p)},d.prototype.getOverlayedFileSystems=function(){return v.prototype.getFSUnlocked.call(this).getOverlayedFileSystems()},d.prototype.unwrap=function(){return v.prototype.getFSUnlocked.call(this)},d}(kt);Eh.Name="OverlayFS",Eh.Options={writable:{type:"object",description:"The file system to write modified files to."},readable:{type:"object",description:"The file system that initially populates this file system."}};var Nr;(function(v){v[v.CB=0]="CB",v[v.FD=1]="FD",v[v.API_ERROR=2]="API_ERROR",v[v.STATS=3]="STATS",v[v.PROBE=4]="PROBE",v[v.FILEFLAG=5]="FILEFLAG",v[v.BUFFER=6]="BUFFER",v[v.ERROR=7]="ERROR"})(Nr||(Nr={}));var OS=function(){this._callbacks={},this._nextId=0};OS.prototype.toRemoteArg=function(d){var y=this._nextId++;return this._callbacks[y]=d,{type:Nr.CB,id:y}},OS.prototype.toLocalArg=function(d){var y=this._callbacks[d];return delete this._callbacks[d],y};var Nv=function(){this._fileDescriptors={},this._nextId=0};Nv.prototype.toRemoteArg=function(d,y,p,b){var k=this._nextId++,I,L;this._fileDescriptors[k]=d,d.stat(function(U,G){U?b(U):(L=vc(G.toBuffer()),p.isReadable()?d.read(a.alloc(G.size),0,G.size,0,function(ue,_e,Ne){ue?b(ue):(I=vc(Ne),b(null,{type:Nr.FD,id:k,data:I,stat:L,path:y,flag:p.getFlagString()}))}):b(null,{type:Nr.FD,id:k,data:new ArrayBuffer(0),stat:L,path:y,flag:p.getFlagString()}))})},Nv.prototype.applyFdAPIRequest=function(d,y){var p=this,b=d.args[0];this._applyFdChanges(b,function(k,I){k?y(k):I[d.method](function(L){d.method==="close"&&delete p._fileDescriptors[b.id],y(L)})})},Nv.prototype._applyFdChanges=function(d,y){var p=this._fileDescriptors[d.id],b=bc(d.data),k=A.fromBuffer(bc(d.stat)),I=E.getFileFlag(d.flag);I.isWriteable()?p.write(b,0,b.length,I.isAppendable()?p.getPos():0,function(L){function U(){p.stat(function(G,ue){G?y(G):ue.mode!==k.mode?p.chmod(k.mode,function(_e){y(_e,p)}):y(G,p)})}L?y(L):I.isAppendable()?U():p.truncate(b.length,function(){U()})}):y(null,p)};function Lv(v){return{type:Nr.API_ERROR,errorData:vc(v.writeToBuffer())}}function vL(v){return g.fromBuffer(bc(v.errorData))}function bL(v){return{type:Nr.ERROR,name:v.name,message:v.message,stack:v.stack}}function _L(v){var d=Zr[v.name];typeof d!="function"&&(d=Error);var y=new d(v.message);return y.stack=v.stack,y}function wL(v){return{type:Nr.STATS,statsData:vc(v.toBuffer())}}function SL(v){return A.fromBuffer(bc(v.statsData))}function xL(v){return{type:Nr.FILEFLAG,flagStr:v.getFlagString()}}function kL(v){return E.getFileFlag(v.flagStr)}function vc(v){return q(v)}function bc(v){return Se(v)}function EL(v){return{type:Nr.BUFFER,data:vc(v)}}function OL(v){return bc(v.data)}function oX(v){return v&&typeof v=="object"&&v.hasOwnProperty("browserfsMessage")&&v.browserfsMessage}function sX(v){return v&&typeof v=="object"&&v.hasOwnProperty("browserfsMessage")&&v.browserfsMessage}var AL=function(v){function d(y,p,b,k,I,L){v.call(this,y,p,b,k,L),this._remoteFdId=I}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.getRemoteFdId=function(){return this._remoteFdId},d.prototype.toRemoteArg=function(){return{type:Nr.FD,id:this._remoteFdId,data:vc(this.getBuffer()),stat:vc(this.getStats().toBuffer()),path:this.getPath(),flag:this.getFlag().getFlagString()}},d.prototype.sync=function(p){this._syncClose("sync",p)},d.prototype.close=function(p){this._syncClose("close",p)},d.prototype._syncClose=function(p,b){var k=this;this.isDirty()?this._fs.syncClose(p,this,function(I){I||k.resetDirty(),b(I)}):b()},d}(St),Pv=function(v){function d(y,p){var b=this;p===void 0&&(p=!0),v.call(this),this._callbackConverter=new OS,this._isInitialized=!1,this._isReadOnly=!1,this._supportLinks=!1,this._supportProps=!1,this._worker=y,F(p,d.Name,{worker:"Web Worker instance"}),this._worker.addEventListener("message",function(k){var I=k.data;if(sX(I)){var L,U=I.args,G=new Array(U.length);for(L=0;L<G.length;L++)G[L]=b._argRemote2Local(U[L]);b._callbackConverter.toLocalArg(I.cbId).apply(null,G)}})}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){var k=new d(p.worker,!1);k.initialize(function(){b(null,k)})},d.isAvailable=function(){return typeof importScripts<"u"||typeof Worker<"u"},d.attachRemoteListener=function(p){var b=new Nv;function k(L,U,G){switch(typeof L){case"object":L instanceof A?G(null,wL(L)):L instanceof g?G(null,Lv(L)):L instanceof Ke?G(null,b.toRemoteArg(L,U[0],U[1],G)):L instanceof E?G(null,xL(L)):L instanceof a?G(null,EL(L)):L instanceof Error?G(null,bL(L)):G(null,L);break;default:G(null,L);break}}function I(L,U){if(!L)return L;switch(typeof L){case"object":if(typeof L.type=="number"){var G=L;switch(G.type){case Nr.CB:var ue=L.id;return function(){var _e=arguments,Ne,Ve=new Array(arguments.length),Je,dt=arguments.length;function yt(Tt){dt>0&&(dt=-1,Je={browserfsMessage:!0,cbId:ue,args:[Lv(Tt)]},p.postMessage(Je))}for(Ne=0;Ne<arguments.length;Ne++)(function(Tt,Lr){k(Lr,U,function(Rn,_o){Ve[Tt]=_o,Rn?yt(Rn):--dt===0&&(Je={browserfsMessage:!0,cbId:ue,args:Ve},p.postMessage(Je))})})(Ne,_e[Ne]);arguments.length===0&&(Je={browserfsMessage:!0,cbId:ue,args:Ve},p.postMessage(Je))};case Nr.API_ERROR:return vL(G);case Nr.STATS:return SL(G);case Nr.FILEFLAG:return kL(G);case Nr.BUFFER:return OL(G);case Nr.ERROR:return _L(G);default:return L}}else return L;default:return L}}p.addEventListener("message",function(L){var U=L.data;if(oX(U)){var G=U.args,ue=new Array(G.length);switch(U.method){case"close":case"sync":(function(){var Ve=G[1];b.applyFdAPIRequest(U,function(Je){var dt={browserfsMessage:!0,cbId:Ve.id,args:Je?[Lv(Je)]:[]};p.postMessage(dt)})})();break;case"probe":(function(){var Ve=Q.getRootFS(),Je=G[1],dt={type:Nr.PROBE,isReadOnly:Ve.isReadOnly(),supportsLinks:Ve.supportsLinks(),supportsProps:Ve.supportsProps()},yt={browserfsMessage:!0,cbId:Je.id,args:[dt]};p.postMessage(yt)})();break;default:for(var _e=0;_e<G.length;_e++)ue[_e]=I(G[_e],ue);var Ne=Q.getRootFS();Ne[U.method].apply(Ne,ue);break}}})},d.prototype.getName=function(){return d.Name},d.prototype.initialize=function(p){var b=this;if(this._isInitialized)p();else{var k={browserfsMessage:!0,method:"probe",args:[this._argLocal2Remote(se()),this._callbackConverter.toRemoteArg(function(I){b._isInitialized=!0,b._isReadOnly=I.isReadOnly,b._supportLinks=I.supportsLinks,b._supportProps=I.supportsProps,p()})]};this._worker.postMessage(k)}},d.prototype.isReadOnly=function(){return this._isReadOnly},d.prototype.supportsSynch=function(){return!1},d.prototype.supportsLinks=function(){return this._supportLinks},d.prototype.supportsProps=function(){return this._supportProps},d.prototype.rename=function(p,b,k){this._rpc("rename",arguments)},d.prototype.stat=function(p,b,k){this._rpc("stat",arguments)},d.prototype.open=function(p,b,k,I){this._rpc("open",arguments)},d.prototype.unlink=function(p,b){this._rpc("unlink",arguments)},d.prototype.rmdir=function(p,b){this._rpc("rmdir",arguments)},d.prototype.mkdir=function(p,b,k){this._rpc("mkdir",arguments)},d.prototype.readdir=function(p,b){this._rpc("readdir",arguments)},d.prototype.exists=function(p,b){this._rpc("exists",arguments)},d.prototype.realpath=function(p,b,k){this._rpc("realpath",arguments)},d.prototype.truncate=function(p,b,k){this._rpc("truncate",arguments)},d.prototype.readFile=function(p,b,k,I){this._rpc("readFile",arguments)},d.prototype.writeFile=function(p,b,k,I,L,U){this._rpc("writeFile",arguments)},d.prototype.appendFile=function(p,b,k,I,L,U){this._rpc("appendFile",arguments)},d.prototype.chmod=function(p,b,k,I){this._rpc("chmod",arguments)},d.prototype.chown=function(p,b,k,I,L){this._rpc("chown",arguments)},d.prototype.utimes=function(p,b,k,I){this._rpc("utimes",arguments)},d.prototype.link=function(p,b,k){this._rpc("link",arguments)},d.prototype.symlink=function(p,b,k,I){this._rpc("symlink",arguments)},d.prototype.readlink=function(p,b){this._rpc("readlink",arguments)},d.prototype.syncClose=function(p,b,k){this._worker.postMessage({browserfsMessage:!0,method:p,args:[b.toRemoteArg(),this._callbackConverter.toRemoteArg(k)]})},d.prototype._argRemote2Local=function(p){if(!p)return p;switch(typeof p){case"object":if(typeof p.type=="number"){var b=p;switch(b.type){case Nr.API_ERROR:return vL(b);case Nr.FD:var k=b;return new AL(this,k.path,E.getFileFlag(k.flag),A.fromBuffer(bc(k.stat)),k.id,bc(k.data));case Nr.STATS:return SL(b);case Nr.FILEFLAG:return kL(b);case Nr.BUFFER:return OL(b);case Nr.ERROR:return _L(b);default:return p}}else return p;default:return p}},d.prototype._rpc=function(p,b){for(var k=this,I=new Array(b.length),L=0;L<b.length;L++)I[L]=k._argLocal2Remote(b[L]);var U={browserfsMessage:!0,method:p,args:I};this._worker.postMessage(U)},d.prototype._argLocal2Remote=function(p){if(!p)return p;switch(typeof p){case"object":return p instanceof A?wL(p):p instanceof g?Lv(p):p instanceof AL?p.toRemoteArg():p instanceof E?xL(p):p instanceof a?EL(p):p instanceof Error?bL(p):"Unknown argument";case"function":return this._callbackConverter.toRemoteArg(p);default:return p}},d}(Ie);Pv.Name="WorkerFS",Pv.Options={worker:{type:"object",description:"The target worker that you want to connect to, or the current worker if in a worker context.",validator:function(v,d){v.postMessage?d():d(new g(u.EINVAL,"option must be a Web Worker instance."))}}};function lX(v,d,y){var p=new XMLHttpRequest;p.open("GET",v,!0);var b=!0;switch(d){case"buffer":p.responseType="arraybuffer";break;case"json":try{p.responseType="json",b=p.responseType==="json"}catch{b=!1}break;default:return y(new g(u.EINVAL,"Invalid download type: "+d))}p.onreadystatechange=function(k){if(p.readyState===4)if(p.status===200)switch(d){case"buffer":return y(null,p.response?a.from(p.response):se());case"json":return b?y(null,p.response):y(null,JSON.parse(p.responseText))}else return y(new g(p.status,"XHR error."))},p.send()}function cX(v,d){var y=new XMLHttpRequest;y.open("GET",v,!1);var p=null,b=null;if(y.overrideMimeType("text/plain; charset=x-user-defined"),y.onreadystatechange=function(k){if(y.readyState===4)if(y.status===200)switch(d){case"buffer":var I=y.responseText;p=a.alloc(I.length);for(var L=0;L<I.length;L++)p[L]=I.charCodeAt(L);return;case"json":p=JSON.parse(y.responseText);return}else{b=new g(y.status,"XHR error.");return}},y.send(),b)throw b;return p}function uX(v,d){var y=new XMLHttpRequest;switch(y.open("GET",v,!1),d){case"buffer":y.responseType="arraybuffer";break;case"json":break;default:throw new g(u.EINVAL,"Invalid download type: "+d)}var p,b;if(y.onreadystatechange=function(k){if(y.readyState===4)if(y.status===200)switch(d){case"buffer":p=a.from(y.response);break;case"json":p=JSON.parse(y.response);break}else b=new g(y.status,"XHR error.")},y.send(),b)throw b;return p}function IL(v,d,y){var p=new XMLHttpRequest;p.open("HEAD",d,v),p.onreadystatechange=function(b){if(p.readyState===4)if(p.status===200)try{return y(null,parseInt(p.getResponseHeader("Content-Length")||"-1",10))}catch{return y(new g(u.EIO,"XHR HEAD error: Could not read content-length."))}else return y(new g(p.status,"XHR HEAD error."))},p.send()}var CL=lX,fX=H&&typeof Blob<"u"?uX:cX;function dX(v){var d=-1;return IL(!1,v,function(y,p){if(y)throw y;d=p}),d}function pX(v,d){IL(!0,v,d)}var ga=function(){this._index={},this.addPath("/",new Ti)};ga.fromListing=function(d){var y=new ga,p=new Ti;y._index["/"]=p;for(var b=[["",d,p]];b.length>0;){var k=void 0,I=b.pop(),L=I[0],U=I[1],G=I[2];for(var ue in U)if(U.hasOwnProperty(ue)){var _e=U[ue],Ne=L+"/"+ue;_e?(y._index[Ne]=k=new Ti,b.push([Ne,_e,k])):k=new lf(new A(S.FILE,-1,365)),G&&(G._ls[ue]=k)}}return y},ga.prototype.fileIterator=function(d){var y=this;for(var p in y._index)if(y._index.hasOwnProperty(p))for(var b=y._index[p],k=b.getListing(),I=0,L=k;I<L.length;I+=1){var U=L[I],G=b.getItem(U);ns(G)&&d(G.getData())}},ga.prototype.addPath=function(d,y){if(!y)throw new Error("Inode must be specified");if(d[0]!=="/")throw new Error("Path must be absolute, got: "+d);if(this._index.hasOwnProperty(d))return this._index[d]===y;var p=this._split_path(d),b=p[0],k=p[1],I=this._index[b];return I===void 0&&d!=="/"&&(I=new Ti,!this.addPath(b,I))||d!=="/"&&!I.addItem(k,y)?!1:(rl(y)&&(this._index[d]=y),!0)},ga.prototype.addPathFast=function(d,y){var p=d.lastIndexOf("/"),b=p===0?"/":d.substring(0,p),k=d.substring(p+1),I=this._index[b];return I===void 0&&(I=new Ti,this.addPathFast(b,I)),I.addItem(k,y)?(y.isDir()&&(this._index[d]=y),!0):!1},ga.prototype.removePath=function(d){var y=this,p=this._split_path(d),b=p[0],k=p[1],I=this._index[b];if(I===void 0)return null;var L=I.remItem(k);if(L===null)return null;if(rl(L)){for(var U=L.getListing(),G=0,ue=U;G<ue.length;G+=1){var _e=ue[G];y.removePath(d+"/"+_e)}d!=="/"&&delete this._index[d]}return L},ga.prototype.ls=function(d){var y=this._index[d];return y===void 0?null:y.getListing()},ga.prototype.getInode=function(d){var y=this._split_path(d),p=y[0],b=y[1],k=this._index[p];return k===void 0?null:p===d?k:k.getItem(b)},ga.prototype._split_path=function(d){var y=f.dirname(d),p=d.substr(y.length+(y==="/"?0:1));return[y,p]};var lf=function(d){this.data=d};lf.prototype.isFile=function(){return!0},lf.prototype.isDir=function(){return!1},lf.prototype.getData=function(){return this.data},lf.prototype.setData=function(d){this.data=d};var Ti=function(d){d===void 0&&(d=null),this.data=d,this._ls={}};Ti.prototype.isFile=function(){return!1},Ti.prototype.isDir=function(){return!0},Ti.prototype.getData=function(){return this.data},Ti.prototype.getStats=function(){return new A(S.DIRECTORY,4096,365)},Ti.prototype.getListing=function(){return Object.keys(this._ls)},Ti.prototype.getItem=function(d){var y=this._ls[d];return y||null},Ti.prototype.addItem=function(d,y){return d in this._ls?!1:(this._ls[d]=y,!0)},Ti.prototype.remItem=function(d){var y=this._ls[d];return y===void 0?null:(delete this._ls[d],y)};function ns(v){return!!v&&v.isFile()}function rl(v){return!!v&&v.isDir()}function hX(v,d,y){try{y(null,v.toString(d))}catch(p){y(p)}}var Fv=function(v){function d(y,p,b){p===void 0&&(p=""),b===void 0&&(b=!0),v.call(this),y||(y="index.json"),p.length>0&&p.charAt(p.length-1)!=="/"&&(p=p+"/"),this.prefixUrl=p;var k=null;if(typeof y=="string"){if(k=this._requestFileSync(y,"json"),!k)throw new Error("Unable to find listing at URL: ${listingUrlOrObj}")}else k=y;F(b,d.Name,{index:typeof y=="string"?y:"file index as an object",baseUrl:p}),this._index=ga.fromListing(k)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){p.index===void 0&&(p.index="index.json"),typeof p.index=="string"?d.FromURL(p.index,b,p.baseUrl,!1):b(null,new d(p.index,p.baseUrl,!1))},d.isAvailable=function(){return typeof XMLHttpRequest<"u"&&XMLHttpRequest!==null},d.FromURL=function(p,b,k,I){k===void 0&&(k=p.slice(0,p.lastIndexOf("/")+1)),I===void 0&&(I=!0),I&&console.warn(`[XmlHttpRequest] XmlHttpRequest.FromURL() is deprecated and will be removed in the next major release. Please use 'XmlHttpRequest.Create({ index: "`+p+'", baseUrl: "'+k+`" }, cb)' instead.`),CL(p,"json",function(L,U){L?b(L):b(null,new d(U,k,!1))})},d.prototype.empty=function(){this._index.fileIterator(function(p){p.fileData=null})},d.prototype.getName=function(){return d.Name},d.prototype.diskSpace=function(p,b){b(0,0)},d.prototype.isReadOnly=function(){return!0},d.prototype.supportsLinks=function(){return!1},d.prototype.supportsProps=function(){return!1},d.prototype.supportsSynch=function(){return!0},d.prototype.preloadFile=function(p,b){var k=this._index.getInode(p);if(ns(k)){if(k===null)throw g.ENOENT(p);var I=k.getData();I.size=b.length,I.fileData=b}else throw g.EISDIR(p)},d.prototype.stat=function(p,b,k){var I=this._index.getInode(p);if(I===null)return k(g.ENOENT(p));var L;ns(I)?(L=I.getData(),L.size<0?this._requestFileSizeAsync(p,function(U,G){if(U)return k(U);L.size=G,k(null,L.clone())}):k(null,L.clone())):rl(I)?(L=I.getStats(),k(null,L)):k(g.FileError(u.EINVAL,p))},d.prototype.statSync=function(p,b){var k=this._index.getInode(p);if(k===null)throw g.ENOENT(p);var I;if(ns(k))I=k.getData(),I.size<0&&(I.size=this._requestFileSizeSync(p));else if(rl(k))I=k.getStats();else throw g.FileError(u.EINVAL,p);return I},d.prototype.open=function(p,b,k,I){if(b.isWriteable())return I(new g(u.EPERM,p));var L=this,U=this._index.getInode(p);if(U===null)return I(g.ENOENT(p));if(ns(U)){var G=U.getData();switch(b.pathExistsAction()){case w.THROW_EXCEPTION:case w.TRUNCATE_FILE:return I(g.EEXIST(p));case w.NOP:if(G.fileData)return I(null,new _t(L,p,b,G.clone(),G.fileData));this._requestFileAsync(p,"buffer",function(ue,_e){return ue?I(ue):(G.size=_e.length,G.fileData=_e,I(null,new _t(L,p,b,G.clone(),_e)))});break;default:return I(new g(u.EINVAL,"Invalid FileMode object."))}}else return I(g.EISDIR(p))},d.prototype.openSync=function(p,b,k){if(b.isWriteable())throw new g(u.EPERM,p);var I=this._index.getInode(p);if(I===null)throw g.ENOENT(p);if(ns(I)){var L=I.getData();switch(b.pathExistsAction()){case w.THROW_EXCEPTION:case w.TRUNCATE_FILE:throw g.EEXIST(p);case w.NOP:if(L.fileData)return new _t(this,p,b,L.clone(),L.fileData);var U=this._requestFileSync(p,"buffer");return L.size=U.length,L.fileData=U,new _t(this,p,b,L.clone(),U);default:throw new g(u.EINVAL,"Invalid FileMode object.")}}else throw g.EISDIR(p)},d.prototype.readdir=function(p,b){try{b(null,this.readdirSync(p))}catch(k){b(k)}},d.prototype.readdirSync=function(p){var b=this._index.getInode(p);if(b===null)throw g.ENOENT(p);if(rl(b))return b.getListing();throw g.ENOTDIR(p)},d.prototype.readFile=function(p,b,k,I){var L=I;this.open(p,k,420,function(U,G){if(U)return I(U);I=function(Ne,Ve){G.close(function(Je){return Ne||(Ne=Je),L(Ne,Ve)})};var ue=G,_e=ue.getBuffer();b===null?I(U,ke(_e)):hX(_e,b,I)})},d.prototype.readFileSync=function(p,b,k){var I=this.openSync(p,k,420);try{var L=I,U=L.getBuffer();return b===null?ke(U):U.toString(b)}finally{I.closeSync()}},d.prototype.getXhrPath=function(p){return p.charAt(0)==="/"&&(p=p.slice(1)),this.prefixUrl+p},d.prototype._requestFileAsync=function(p,b,k){CL(this.getXhrPath(p),b,k)},d.prototype._requestFileSync=function(p,b){return fX(this.getXhrPath(p),b)},d.prototype._requestFileSizeAsync=function(p,b){pX(this.getXhrPath(p),b)},d.prototype._requestFileSizeSync=function(p){return dX(this.getXhrPath(p))},d}(Ie);Fv.Name="XmlHttpRequest",Fv.Options={index:{type:["string","object"],optional:!0,description:"URL to a file index as a JSON file or the file index object itself, generated with the make_xhrfs_index script. Defaults to `index.json`."},baseUrl:{type:"string",optional:!0,description:"Used as the URL prefix for fetched files. Default: Fetch files relative to the index."}};var _c=function(){};_c.str2byte=function(d,y){for(var p=d.length>y.length?y.length:d.length,b=0;b<p;b++){var k=d.charCodeAt(b);if(k>127){var I=_c.extendedChars.indexOf(d.charAt(b));I>-1&&(k=I+128)}y[k]=b}return p},_c.byte2str=function(d){for(var y=new Array(d.length),p=0;p<d.length;p++){var b=d[p];b>127?y[p]=_c.extendedChars[b-128]:y[p]=String.fromCharCode(b)}return y.join("")},_c.byteLength=function(d){return d.length},_c.extendedChars=["\xC7","\xFC","\xE9","\xE2","\xE4","\xE0","\xE5","\xE7","\xEA","\xEB","\xE8","\xEF","\xEE","\xEC","\xC4","\xC5","\xC9","\xE6","\xC6","\xF4","\xF6","\xF2","\xFB","\xF9","\xFF","\xD6","\xDC","\xF8","\xA3","\xD8","\xD7","\u0192","\xE1","\xED","\xF3","\xFA","\xF1","\xD1","\xAA","\xBA","\xBF","\xAE","\xAC","\xBD","\xBC","\xA1","\xAB","\xBB","_","_","_","\xA6","\xA6","\xC1","\xC2","\xC0","\xA9","\xA6","\xA6","+","+","\xA2","\xA5","+","+","-","-","+","-","+","\xE3","\xC3","+","+","-","-","\xA6","-","+","\xA4","\xF0","\xD0","\xCA","\xCB","\xC8","i","\xCD","\xCE","\xCF","+","+","_","_","\xA6","\xCC","_","\xD3","\xDF","\xD4","\xD2","\xF5","\xD5","\xB5","\xFE","\xDE","\xDA","\xDB","\xD9","\xFD","\xDD","\xAF","\xB4","\xAD","\xB1","_","\xBE","\xB6","\xA7","\xF7","\xB8","\xB0","\xA8","\xB7","\xB9","\xB3","\xB2","_"," "];var gX=i(31).inflateRaw,TL={},NL;(function(v){v[v.MSDOS=0]="MSDOS",v[v.AMIGA=1]="AMIGA",v[v.OPENVMS=2]="OPENVMS",v[v.UNIX=3]="UNIX",v[v.VM_CMS=4]="VM_CMS",v[v.ATARI_ST=5]="ATARI_ST",v[v.OS2_HPFS=6]="OS2_HPFS",v[v.MAC=7]="MAC",v[v.Z_SYSTEM=8]="Z_SYSTEM",v[v.CP_M=9]="CP_M",v[v.NTFS=10]="NTFS",v[v.MVS=11]="MVS",v[v.VSE=12]="VSE",v[v.ACORN_RISC=13]="ACORN_RISC",v[v.VFAT=14]="VFAT",v[v.ALT_MVS=15]="ALT_MVS",v[v.BEOS=16]="BEOS",v[v.TANDEM=17]="TANDEM",v[v.OS_400=18]="OS_400",v[v.OSX=19]="OSX"})(NL||(NL={}));var cf;(function(v){v[v.STORED=0]="STORED",v[v.SHRUNK=1]="SHRUNK",v[v.REDUCED_1=2]="REDUCED_1",v[v.REDUCED_2=3]="REDUCED_2",v[v.REDUCED_3=4]="REDUCED_3",v[v.REDUCED_4=5]="REDUCED_4",v[v.IMPLODE=6]="IMPLODE",v[v.DEFLATE=8]="DEFLATE",v[v.DEFLATE64=9]="DEFLATE64",v[v.TERSE_OLD=10]="TERSE_OLD",v[v.BZIP2=12]="BZIP2",v[v.LZMA=14]="LZMA",v[v.TERSE_NEW=18]="TERSE_NEW",v[v.LZ77=19]="LZ77",v[v.WAVPACK=97]="WAVPACK",v[v.PPMD=98]="PPMD"})(cf||(cf={}));function LL(v,d){var y=d&31,p=(d>>5&15)-1,b=(d>>9)+1980,k=v&31,I=v>>5&63,L=v>>11;return new Date(b,p,y,L,I,k)}function Dv(v,d,y,p){return p===0?"":d?v.toString("utf8",y,y+p):_c.byte2str(v.slice(y,y+p))}var Ki=function(d){if(this.data=d,d.readUInt32LE(0)!==67324752)throw new g(u.EINVAL,"Invalid Zip file: Local file header has invalid signature: "+this.data.readUInt32LE(0))};Ki.prototype.versionNeeded=function(){return this.data.readUInt16LE(4)},Ki.prototype.flags=function(){return this.data.readUInt16LE(6)},Ki.prototype.compressionMethod=function(){return this.data.readUInt16LE(8)},Ki.prototype.lastModFileTime=function(){return LL(this.data.readUInt16LE(10),this.data.readUInt16LE(12))},Ki.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(10)},Ki.prototype.crc32=function(){return this.data.readUInt32LE(14)},Ki.prototype.fileNameLength=function(){return this.data.readUInt16LE(26)},Ki.prototype.extraFieldLength=function(){return this.data.readUInt16LE(28)},Ki.prototype.fileName=function(){return Dv(this.data,this.useUTF8(),30,this.fileNameLength())},Ki.prototype.extraField=function(){var d=30+this.fileNameLength();return this.data.slice(d,d+this.extraFieldLength())},Ki.prototype.totalSize=function(){return 30+this.fileNameLength()+this.extraFieldLength()},Ki.prototype.useUTF8=function(){return(this.flags()&2048)===2048};var Oh=function(d,y,p){this.header=d,this.record=y,this.data=p};Oh.prototype.decompress=function(){var d=this.header.compressionMethod(),y=TL[d];if(y)return y(this.data,this.record.compressedSize(),this.record.uncompressedSize(),this.record.flag());var p=cf[d];throw p||(p="Unknown: "+d),new g(u.EINVAL,"Invalid compression method on file '"+this.header.fileName()+"': "+p)},Oh.prototype.getHeader=function(){return this.header},Oh.prototype.getRecord=function(){return this.record},Oh.prototype.getRawData=function(){return this.data};var AS=function(d){this.data=d};AS.prototype.crc32=function(){return this.data.readUInt32LE(0)},AS.prototype.compressedSize=function(){return this.data.readUInt32LE(4)},AS.prototype.uncompressedSize=function(){return this.data.readUInt32LE(8)};var PL=function(d){if(this.data=d,this.data.readUInt32LE(0)!==134630224)throw new g(u.EINVAL,"Invalid archive extra data record signature: "+this.data.readUInt32LE(0))};PL.prototype.length=function(){return this.data.readUInt32LE(4)},PL.prototype.extraFieldData=function(){return this.data.slice(8,8+this.length())};var FL=function(d){if(this.data=d,this.data.readUInt32LE(0)!==84233040)throw new g(u.EINVAL,"Invalid digital signature signature: "+this.data.readUInt32LE(0))};FL.prototype.size=function(){return this.data.readUInt16LE(4)},FL.prototype.signatureData=function(){return this.data.slice(6,6+this.size())};var Vt=function(d,y){if(this.zipData=d,this.data=y,this.data.readUInt32LE(0)!==33639248)throw new g(u.EINVAL,"Invalid Zip file: Central directory record has invalid signature: "+this.data.readUInt32LE(0));this._filename=this.produceFilename()};Vt.prototype.versionMadeBy=function(){return this.data.readUInt16LE(4)},Vt.prototype.versionNeeded=function(){return this.data.readUInt16LE(6)},Vt.prototype.flag=function(){return this.data.readUInt16LE(8)},Vt.prototype.compressionMethod=function(){return this.data.readUInt16LE(10)},Vt.prototype.lastModFileTime=function(){return LL(this.data.readUInt16LE(12),this.data.readUInt16LE(14))},Vt.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(12)},Vt.prototype.crc32=function(){return this.data.readUInt32LE(16)},Vt.prototype.compressedSize=function(){return this.data.readUInt32LE(20)},Vt.prototype.uncompressedSize=function(){return this.data.readUInt32LE(24)},Vt.prototype.fileNameLength=function(){return this.data.readUInt16LE(28)},Vt.prototype.extraFieldLength=function(){return this.data.readUInt16LE(30)},Vt.prototype.fileCommentLength=function(){return this.data.readUInt16LE(32)},Vt.prototype.diskNumberStart=function(){return this.data.readUInt16LE(34)},Vt.prototype.internalAttributes=function(){return this.data.readUInt16LE(36)},Vt.prototype.externalAttributes=function(){return this.data.readUInt32LE(38)},Vt.prototype.headerRelativeOffset=function(){return this.data.readUInt32LE(42)},Vt.prototype.produceFilename=function(){var d=Dv(this.data,this.useUTF8(),46,this.fileNameLength());return d.replace(/\\/g,"/")},Vt.prototype.fileName=function(){return this._filename},Vt.prototype.rawFileName=function(){return this.data.slice(46,46+this.fileNameLength())},Vt.prototype.extraField=function(){var d=44+this.fileNameLength();return this.data.slice(d,d+this.extraFieldLength())},Vt.prototype.fileComment=function(){var d=46+this.fileNameLength()+this.extraFieldLength();return Dv(this.data,this.useUTF8(),d,this.fileCommentLength())},Vt.prototype.rawFileComment=function(){var d=46+this.fileNameLength()+this.extraFieldLength();return this.data.slice(d,d+this.fileCommentLength())},Vt.prototype.totalSize=function(){return 46+this.fileNameLength()+this.extraFieldLength()+this.fileCommentLength()},Vt.prototype.isDirectory=function(){var d=this.fileName();return!!(this.externalAttributes()&16)||d.charAt(d.length-1)==="/"},Vt.prototype.isFile=function(){return!this.isDirectory()},Vt.prototype.useUTF8=function(){return(this.flag()&2048)===2048},Vt.prototype.isEncrypted=function(){return(this.flag()&1)===1},Vt.prototype.getFileData=function(){var d=this.headerRelativeOffset(),y=new Ki(this.zipData.slice(d));return new Oh(y,this,this.zipData.slice(d+y.totalSize()))},Vt.prototype.getData=function(){return this.getFileData().decompress()},Vt.prototype.getRawData=function(){return this.getFileData().getRawData()},Vt.prototype.getStats=function(){return new A(S.FILE,this.uncompressedSize(),365,new Date,this.lastModFileTime())};var vo=function(d){if(this.data=d,this.data.readUInt32LE(0)!==101010256)throw new g(u.EINVAL,"Invalid Zip file: End of central directory record has invalid signature: "+this.data.readUInt32LE(0))};vo.prototype.diskNumber=function(){return this.data.readUInt16LE(4)},vo.prototype.cdDiskNumber=function(){return this.data.readUInt16LE(6)},vo.prototype.cdDiskEntryCount=function(){return this.data.readUInt16LE(8)},vo.prototype.cdTotalEntryCount=function(){return this.data.readUInt16LE(10)},vo.prototype.cdSize=function(){return this.data.readUInt32LE(12)},vo.prototype.cdOffset=function(){return this.data.readUInt32LE(16)},vo.prototype.cdZipCommentLength=function(){return this.data.readUInt16LE(20)},vo.prototype.cdZipComment=function(){return Dv(this.data,!0,22,this.cdZipCommentLength())},vo.prototype.rawCdZipComment=function(){return this.data.slice(22,22+this.cdZipCommentLength())};var DL=function(d,y,p,b){this.index=d,this.directoryEntries=y,this.eocd=p,this.data=b},wc=function(v){function d(y,p,b){p===void 0&&(p=""),b===void 0&&(b=!0),v.call(this),this.name=p,this._index=new ga,this._directoryEntries=[],this._eocd=null,F(b,d.Name,{zipData:"zip data as a Buffer",name:p}),y instanceof DL?(this._index=y.index,this._directoryEntries=y.directoryEntries,this._eocd=y.eocd,this.data=y.data):(this.data=y,this.populateIndex())}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){try{d.computeIndex(p.zipData,function(k){var I=new d(k,p.name,!1);b(null,I)},!1)}catch(k){b(k)}},d.isAvailable=function(){return!0},d.RegisterDecompressionMethod=function(p,b){TL[p]=b},d.computeIndex=function(p,b,k){k===void 0&&(k=!0),k&&console.warn("[ZipFS] ZipFS.computeIndex is now deprecated, and will be removed in the next major release. Please update your code to use 'ZipFS.Create({ zipData: zip file as a Buffer}, cb)' instead.");var I=new ga,L=d.getEOCD(p);if(L.diskNumber()!==L.cdDiskNumber())throw new g(u.EINVAL,"ZipFS does not support spanned zip files.");var U=L.cdOffset();if(U===4294967295)throw new g(u.EINVAL,"ZipFS does not support Zip64.");var G=U+L.cdSize();d.computeIndexResponsive(p,I,U,G,b,[],L)},d.getEOCD=function(p){for(var b=22,k=Math.min(b+65535,p.length-1),I=b;I<k;I++)if(p.readUInt32LE(p.length-I)===101010256)return new vo(p.slice(p.length-I));throw new g(u.EINVAL,"Invalid ZIP file: Could not locate End of Central Directory signature.")},d.addToIndex=function(p,b){var k=p.fileName();if(k.charAt(0)==="/")throw new Error("WHY IS THIS ABSOLUTE");k.charAt(k.length-1)==="/"&&(k=k.substr(0,k.length-1)),p.isDirectory()?b.addPathFast("/"+k,new Ti(p)):b.addPathFast("/"+k,new lf(p))},d.computeIndexResponsive=function(p,b,k,I,L,U,G){if(k<I){for(var ue=0;ue++<200&&k<I;){var _e=new Vt(p,p.slice(k));d.addToIndex(_e,b),k+=_e.totalSize(),U.push(_e)}ES(function(){d.computeIndexResponsive(p,b,k,I,L,U,G)})}else L(new DL(b,U,G,p))},d.prototype.getName=function(){return d.Name+(this.name!==""?" "+this.name:"")},d.prototype.getCentralDirectoryEntry=function(p){var b=this._index.getInode(p);if(b===null)throw g.ENOENT(p);if(ns(b))return b.getData();if(rl(b))return b.getData();throw g.EPERM("Invalid inode: "+b)},d.prototype.getCentralDirectoryEntryAt=function(p){var b=this._directoryEntries[p];if(!b)throw new RangeError("Invalid directory index: "+p+".");return b},d.prototype.getNumberOfCentralDirectoryEntries=function(){return this._directoryEntries.length},d.prototype.getEndOfCentralDirectory=function(){return this._eocd},d.prototype.diskSpace=function(p,b){b(this.data.length,0)},d.prototype.isReadOnly=function(){return!0},d.prototype.supportsLinks=function(){return!1},d.prototype.supportsProps=function(){return!1},d.prototype.supportsSynch=function(){return!0},d.prototype.statSync=function(p,b){var k=this._index.getInode(p);if(k===null)throw g.ENOENT(p);var I;if(ns(k))I=k.getData().getStats();else if(rl(k))I=k.getStats();else throw new g(u.EINVAL,"Invalid inode.");return I},d.prototype.openSync=function(p,b,k){if(b.isWriteable())throw new g(u.EPERM,p);var I=this._index.getInode(p);if(I)if(ns(I)){var L=I.getData(),U=L.getStats();switch(b.pathExistsAction()){case w.THROW_EXCEPTION:case w.TRUNCATE_FILE:throw g.EEXIST(p);case w.NOP:return new _t(this,p,b,U,L.getData());default:throw new g(u.EINVAL,"Invalid FileMode object.")}}else throw g.EISDIR(p);else throw g.ENOENT(p)},d.prototype.readdirSync=function(p){var b=this._index.getInode(p);if(b){if(rl(b))return b.getListing();throw g.ENOTDIR(p)}else throw g.ENOENT(p)},d.prototype.readFileSync=function(p,b,k){var I=this.openSync(p,k,420);try{var L=I,U=L.getBuffer();return b===null?ke(U):U.toString(b)}finally{I.closeSync()}},d.prototype.populateIndex=function(){var p=this,b=this._eocd=d.getEOCD(this.data);if(b.diskNumber()!==b.cdDiskNumber())throw new g(u.EINVAL,"ZipFS does not support spanned zip files.");var k=b.cdOffset();if(k===4294967295)throw new g(u.EINVAL,"ZipFS does not support Zip64.");for(var I=k+b.cdSize();k<I;){var L=new Vt(p.data,p.data.slice(k));k+=L.totalSize(),d.addToIndex(L,p._index),p._directoryEntries.push(L)}},d}(Ye);wc.Name="ZipFS",wc.Options={zipData:{type:"object",description:"The zip file as a Buffer object.",validator:be},name:{type:"string",optional:!0,description:"The name of the zip file (optional)."}},wc.CompressionMethod=cf,wc.RegisterDecompressionMethod(cf.DEFLATE,function(v,d,y){return le(gX(v.slice(0,d),{chunkSize:y}))}),wc.RegisterDecompressionMethod(cf.STORED,function(v,d,y){return ke(v,0,y)});var yX="IEEE_P1282";function Ni(v,d,y){return v.toString("ascii",d,d+y).trim()}function IS(v,d,y){if(y===1)return String.fromCharCode(v[d]);for(var p=Math.floor(y/2),b=new Array(p),k=0;k<p;k++){var I=d+(k<<1);b[k]=String.fromCharCode(v[I+1]|v[I]<<8)}return b.join("")}function bo(v,d){var y=parseInt(Ni(v,d,4),10),p=parseInt(Ni(v,d+4,2),10),b=parseInt(Ni(v,d+6,2),10),k=parseInt(Ni(v,d+8,2),10),I=parseInt(Ni(v,d+10,2),10),L=parseInt(Ni(v,d+12,2),10),U=parseInt(Ni(v,d+14,2),10);return new Date(y,p,b,k,I,L,U*100)}function Sc(v,d){var y=v[d],p=v[d+1],b=v[d+2],k=v[d+3],I=v[d+4],L=v[d+5];return new Date(y,p-1,b,k,I,L)}function mX(v,d){var y=v.slice(d),p=new Qr(y);switch(p.signatureWord()){case 17221:return new $L(y);case 20548:return new _X(y);case 21328:return new UL(y);case 21332:return new zL(y);case 17746:return new qL(y);case 17747:return new wX(y);case 20568:return new HL(y);case 20558:return new SX(y);case 21324:return new CS(y);case 20045:return new WL(y);case 17228:return new TS(y);case 20556:return new xX(y);case 21061:return new JL(y);case 21574:return new GL(y);case 21318:return new kX(y);case 21074:return new VL(y);default:return p}}function BL(v,d,y,p){y=y-4;for(var b=new Array;d<y;){var k=mX(v,d),I=k.length();if(I===0)return b;if(d+=I,k instanceof zL)break;k instanceof $L?b=b.concat(k.getEntries(p)):b.push(k)}return b}var uf=function(d){this._data=d};uf.prototype.type=function(){return this._data[0]},uf.prototype.standardIdentifier=function(){return Ni(this._data,1,5)},uf.prototype.version=function(){return this._data[6]},uf.prototype.data=function(){return this._data.slice(7,2048)};var RL=function(v){function d(y){v.call(this,y),this._root=null}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.systemIdentifier=function(){return this._getString32(8)},d.prototype.volumeIdentifier=function(){return this._getString32(40)},d.prototype.volumeSpaceSize=function(){return this._data.readUInt32LE(80)},d.prototype.volumeSetSize=function(){return this._data.readUInt16LE(120)},d.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(124)},d.prototype.logicalBlockSize=function(){return this._data.readUInt16LE(128)},d.prototype.pathTableSize=function(){return this._data.readUInt32LE(132)},d.prototype.locationOfTypeLPathTable=function(){return this._data.readUInt32LE(140)},d.prototype.locationOfOptionalTypeLPathTable=function(){return this._data.readUInt32LE(144)},d.prototype.locationOfTypeMPathTable=function(){return this._data.readUInt32BE(148)},d.prototype.locationOfOptionalTypeMPathTable=function(){return this._data.readUInt32BE(152)},d.prototype.rootDirectoryEntry=function(p){return this._root===null&&(this._root=this._constructRootDirectoryRecord(this._data.slice(156)),this._root.rootCheckForRockRidge(p)),this._root},d.prototype.volumeSetIdentifier=function(){return this._getString(190,128)},d.prototype.publisherIdentifier=function(){return this._getString(318,128)},d.prototype.dataPreparerIdentifier=function(){return this._getString(446,128)},d.prototype.applicationIdentifier=function(){return this._getString(574,128)},d.prototype.copyrightFileIdentifier=function(){return this._getString(702,38)},d.prototype.abstractFileIdentifier=function(){return this._getString(740,36)},d.prototype.bibliographicFileIdentifier=function(){return this._getString(776,37)},d.prototype.volumeCreationDate=function(){return bo(this._data,813)},d.prototype.volumeModificationDate=function(){return bo(this._data,830)},d.prototype.volumeExpirationDate=function(){return bo(this._data,847)},d.prototype.volumeEffectiveDate=function(){return bo(this._data,864)},d.prototype.fileStructureVersion=function(){return this._data[881]},d.prototype.applicationUsed=function(){return this._data.slice(883,883+512)},d.prototype.reserved=function(){return this._data.slice(1395,1395+653)},d.prototype._getString32=function(p){return this._getString(p,32)},d}(uf),vX=function(v){function d(y){if(v.call(this,y),this.type()!==1)throw new g(u.EIO,"Invalid primary volume descriptor.")}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.name=function(){return"ISO9660"},d.prototype._constructRootDirectoryRecord=function(p){return new ML(p,-1)},d.prototype._getString=function(p,b){return this._getString(p,b)},d}(RL),bX=function(v){function d(y){if(v.call(this,y),this.type()!==2)throw new g(u.EIO,"Invalid supplementary volume descriptor.");var p=this.escapeSequence(),b=p[2];if(p[0]!==37||p[1]!==47||b!==64&&b!==67&&b!==69)throw new g(u.EIO,"Unrecognized escape sequence for SupplementaryVolumeDescriptor: "+p.toString())}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.name=function(){return"Joliet"},d.prototype.escapeSequence=function(){return this._data.slice(88,120)},d.prototype._constructRootDirectoryRecord=function(p){return new jL(p,-1)},d.prototype._getString=function(p,b){return IS(this._data,p,b)},d}(RL),Or=function(d,y){this._suEntries=null,this._fileOrDir=null,this._data=d,this._rockRidgeOffset=y};Or.prototype.hasRockRidge=function(){return this._rockRidgeOffset>-1},Or.prototype.getRockRidgeOffset=function(){return this._rockRidgeOffset},Or.prototype.rootCheckForRockRidge=function(d){var y=this.getDirectory(d);this._rockRidgeOffset=y.getDotEntry(d)._getRockRidgeOffset(d),this._rockRidgeOffset>-1&&(this._fileOrDir=null)},Or.prototype.length=function(){return this._data[0]},Or.prototype.extendedAttributeRecordLength=function(){return this._data[1]},Or.prototype.lba=function(){return this._data.readUInt32LE(2)*2048},Or.prototype.dataLength=function(){return this._data.readUInt32LE(10)},Or.prototype.recordingDate=function(){return Sc(this._data,18)},Or.prototype.fileFlags=function(){return this._data[25]},Or.prototype.fileUnitSize=function(){return this._data[26]},Or.prototype.interleaveGapSize=function(){return this._data[27]},Or.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(28)},Or.prototype.identifier=function(){return this._getString(33,this._data[32])},Or.prototype.fileName=function(d){if(this.hasRockRidge()){var y=this._rockRidgeFilename(d);if(y!==null)return y}var p=this.identifier();if(this.isDirectory(d))return p;var b=p.indexOf(";");return b===-1?p:p[b-1]==="."?p.slice(0,b-1):p.slice(0,b)},Or.prototype.isDirectory=function(d){var y=!!(this.fileFlags()&2);return!y&&this.hasRockRidge()&&(y=this.getSUEntries(d).filter(function(p){return p instanceof TS}).length>0),y},Or.prototype.isSymlink=function(d){return this.hasRockRidge()&&this.getSUEntries(d).filter(function(y){return y instanceof CS}).length>0},Or.prototype.getSymlinkPath=function(d){for(var y="",p=this.getSUEntries(d),b=this._getGetString(),k=0,I=p;k<I.length;k+=1){var L=I[k];if(L instanceof CS){for(var U=L.componentRecords(),G=0,ue=U;G<ue.length;G+=1){var _e=ue[G],Ne=_e.flags();Ne&2?y+="./":Ne&4?y+="../":Ne&8?y+="/":(y+=_e.content(b),Ne&1||(y+="/"))}if(!L.continueFlag())break}}return y.length>1&&y[y.length-1]==="/"?y.slice(0,y.length-1):y},Or.prototype.getFile=function(d){if(this.isDirectory(d))throw new Error("Tried to get a File from a directory.");return this._fileOrDir===null&&(this._fileOrDir=d.slice(this.lba(),this.lba()+this.dataLength())),this._fileOrDir},Or.prototype.getDirectory=function(d){if(!this.isDirectory(d))throw new Error("Tried to get a Directory from a file.");return this._fileOrDir===null&&(this._fileOrDir=this._constructDirectory(d)),this._fileOrDir},Or.prototype.getSUEntries=function(d){return this._suEntries||this._constructSUEntries(d),this._suEntries},Or.prototype._rockRidgeFilename=function(d){var y=this.getSUEntries(d).filter(function(U){return U instanceof WL});if(y.length===0||y[0].flags()&6)return null;for(var p="",b=this._getGetString(),k=0,I=y;k<I.length;k+=1){var L=I[k];if(p+=L.name(b),!(L.flags()&1))break}return p},Or.prototype._constructSUEntries=function(d){var y=33+this._data[32];y%2===1&&y++,y+=this._rockRidgeOffset,this._suEntries=BL(this._data,y,this.length(),d)},Or.prototype._getRockRidgeOffset=function(d){this._rockRidgeOffset=0;var y=this.getSUEntries(d);if(y.length>0){var p=y[0];if(p instanceof UL&&p.checkBytesPass())for(var b=1;b<y.length;b++){var k=y[b];if(k instanceof VL||k instanceof qL&&k.extensionIdentifier()===yX)return p.bytesSkipped()}}return this._rockRidgeOffset=-1,-1};var ML=function(v){function d(y,p){v.call(this,y,p)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype._getString=function(p,b){return Ni(this._data,p,b)},d.prototype._constructDirectory=function(p){return new EX(this,p)},d.prototype._getGetString=function(){return Ni},d}(Or),jL=function(v){function d(y,p){v.call(this,y,p)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype._getString=function(p,b){return IS(this._data,p,b)},d.prototype._constructDirectory=function(p){return new OX(this,p)},d.prototype._getGetString=function(){return IS},d}(Or),Qr=function(d){this._data=d};Qr.prototype.signatureWord=function(){return this._data.readUInt16BE(0)},Qr.prototype.signatureWordString=function(){return Ni(this._data,0,2)},Qr.prototype.length=function(){return this._data[2]},Qr.prototype.suVersion=function(){return this._data[3]};var $L=function(v){function d(y){v.call(this,y),this._entries=null}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.continuationLba=function(){return this._data.readUInt32LE(4)},d.prototype.continuationLbaOffset=function(){return this._data.readUInt32LE(12)},d.prototype.continuationLength=function(){return this._data.readUInt32LE(20)},d.prototype.getEntries=function(p){if(!this._entries){var b=this.continuationLba()*2048+this.continuationLbaOffset();this._entries=BL(p,b,this.continuationLength(),p)}return this._entries},d}(Qr),_X=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d}(Qr),UL=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.checkBytesPass=function(){return this._data[4]===190&&this._data[5]===239},d.prototype.bytesSkipped=function(){return this._data[6]},d}(Qr),zL=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d}(Qr),qL=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.identifierLength=function(){return this._data[4]},d.prototype.descriptorLength=function(){return this._data[5]},d.prototype.sourceLength=function(){return this._data[6]},d.prototype.extensionVersion=function(){return this._data[7]},d.prototype.extensionIdentifier=function(){return Ni(this._data,8,this.identifierLength())},d.prototype.extensionDescriptor=function(){return Ni(this._data,8+this.identifierLength(),this.descriptorLength())},d.prototype.extensionSource=function(){return Ni(this._data,8+this.identifierLength()+this.descriptorLength(),this.sourceLength())},d}(Qr),wX=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.extensionSequence=function(){return this._data[4]},d}(Qr),VL=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d}(Qr),HL=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.mode=function(){return this._data.readUInt32LE(4)},d.prototype.fileLinks=function(){return this._data.readUInt32LE(12)},d.prototype.uid=function(){return this._data.readUInt32LE(20)},d.prototype.gid=function(){return this._data.readUInt32LE(28)},d.prototype.inode=function(){return this._data.readUInt32LE(36)},d}(Qr),SX=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.devTHigh=function(){return this._data.readUInt32LE(4)},d.prototype.devTLow=function(){return this._data.readUInt32LE(12)},d}(Qr),CS=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.flags=function(){return this._data[4]},d.prototype.continueFlag=function(){return this.flags()&1},d.prototype.componentRecords=function(){for(var p=this,b=new Array,k=5;k<this.length();){var I=new Ah(p._data.slice(k));b.push(I),k+=I.length()}return b},d}(Qr),Ah=function(d){this._data=d};Ah.prototype.flags=function(){return this._data[0]},Ah.prototype.length=function(){return 2+this.componentLength()},Ah.prototype.componentLength=function(){return this._data[1]},Ah.prototype.content=function(d){return d(this._data,2,this.componentLength())};var WL=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.flags=function(){return this._data[4]},d.prototype.name=function(p){return p(this._data,5,this.length()-5)},d}(Qr),TS=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.childDirectoryLba=function(){return this._data.readUInt32LE(4)},d}(Qr),xX=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.parentDirectoryLba=function(){return this._data.readUInt32LE(4)},d}(Qr),JL=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d}(Qr),GL=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.flags=function(){return this._data[4]},d.prototype.creation=function(){return this.flags()&1?this._longFormDates()?bo(this._data,5):Sc(this._data,5):null},d.prototype.modify=function(){if(this.flags()&2){var p=this.flags()&1?1:0;return this._longFormDates?bo(this._data,5+p*17):Sc(this._data,5+p*7)}else return null},d.prototype.access=function(){if(this.flags()&4){var p=this.flags()&1?1:0;return p+=this.flags()&2?1:0,this._longFormDates?bo(this._data,5+p*17):Sc(this._data,5+p*7)}else return null},d.prototype.backup=function(){if(this.flags()&16){var p=this.flags()&1?1:0;return p+=this.flags()&2?1:0,p+=this.flags()&4?1:0,this._longFormDates?bo(this._data,5+p*17):Sc(this._data,5+p*7)}else return null},d.prototype.expiration=function(){if(this.flags()&32){var p=this.flags()&1?1:0;return p+=this.flags()&2?1:0,p+=this.flags()&4?1:0,p+=this.flags()&16?1:0,this._longFormDates?bo(this._data,5+p*17):Sc(this._data,5+p*7)}else return null},d.prototype.effective=function(){if(this.flags()&64){var p=this.flags()&1?1:0;return p+=this.flags()&2?1:0,p+=this.flags()&4?1:0,p+=this.flags()&16?1:0,p+=this.flags()&32?1:0,this._longFormDates?bo(this._data,5+p*17):Sc(this._data,5+p*7)}else return null},d.prototype._longFormDates=function(){return!!this.flags()},d}(Qr),kX=function(v){function d(y){v.call(this,y)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype.virtualSizeHigh=function(){return this._data.readUInt32LE(4)},d.prototype.virtualSizeLow=function(){return this._data.readUInt32LE(12)},d.prototype.tableDepth=function(){return this._data[20]},d}(Qr),Ih=function(d,y){var p=this;this._fileList=[],this._fileMap={},this._record=d;var b=d.lba(),k=b+d.dataLength();if(!(d.fileFlags()&2)){var I=d.getSUEntries(y).filter(function(ue){return ue instanceof TS})[0];b=I.childDirectoryLba()*2048,k=1/0}for(;b<k;){var L=y[b];if(L===0){b++;continue}var U=p._constructDirectoryRecord(y.slice(b)),G=U.fileName(y);G!=="\0"&&G!==""?(!U.hasRockRidge()||U.getSUEntries(y).filter(function(ue){return ue instanceof JL}).length===0)&&(p._fileMap[G]=U,p._fileList.push(G)):k===1/0&&(k=b+U.dataLength()),b+=U.length()}};Ih.prototype.getRecord=function(d){return this._fileMap[d]},Ih.prototype.getFileList=function(){return this._fileList},Ih.prototype.getDotEntry=function(d){return this._constructDirectoryRecord(d.slice(this._record.lba()))};var EX=function(v){function d(y,p){v.call(this,y,p)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype._constructDirectoryRecord=function(p){return new ML(p,this._record.getRockRidgeOffset())},d}(Ih),OX=function(v){function d(y,p){v.call(this,y,p)}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.prototype._constructDirectoryRecord=function(p){return new jL(p,this._record.getRockRidgeOffset())},d}(Ih),Bv=function(v){function d(y,p,b){var k=this;p===void 0&&(p=""),b===void 0&&(b=!0),v.call(this),this._data=y,F(b,d.Name,{data:"ISO data as a Buffer",name:p});for(var I=!1,L=16*2048,U=new Array;!I;){var G=y.slice(L),ue=new uf(G);switch(ue.type()){case 1:U.push(new vX(G));break;case 2:U.push(new bX(G));break;case 255:I=!0;break}L+=2048}if(U.length===0)throw new g(u.EIO,"Unable to find a suitable volume descriptor.");U.forEach(function(_e){(!k._pvd||k._pvd.type()!==2)&&(k._pvd=_e)}),this._root=this._pvd.rootDirectoryEntry(y),this._name=p}return v&&(d.__proto__=v),d.prototype=Object.create(v&&v.prototype),d.prototype.constructor=d,d.Create=function(p,b){var k,I;try{k=new d(p.data,p.name,!1)}catch(L){L=L}finally{b(I,k)}},d.isAvailable=function(){return!0},d.prototype.getName=function(){var p="IsoFS"+this._name+(this._pvd?"-"+this._pvd.name():"");return this._root&&this._root.hasRockRidge()&&(p+="-RockRidge"),p},d.prototype.diskSpace=function(p,b){b(this._data.length,0)},d.prototype.isReadOnly=function(){return!0},d.prototype.supportsLinks=function(){return!1},d.prototype.supportsProps=function(){return!1},d.prototype.supportsSynch=function(){return!0},d.prototype.statSync=function(p,b){var k=this._getDirectoryRecord(p);if(k===null)throw g.ENOENT(p);return this._getStats(p,k)},d.prototype.openSync=function(p,b,k){if(b.isWriteable())throw new g(u.EPERM,p);var I=this._getDirectoryRecord(p);if(I){if(I.isSymlink(this._data))return this.openSync(f.resolve(p,I.getSymlinkPath(this._data)),b,k);if(I.isDirectory(this._data))throw g.EISDIR(p);var L=I.getFile(this._data),U=this._getStats(p,I);switch(b.pathExistsAction()){case w.THROW_EXCEPTION:case w.TRUNCATE_FILE:throw g.EEXIST(p);case w.NOP:return new _t(this,p,b,U,L);default:throw new g(u.EINVAL,"Invalid FileMode object.")}}else throw g.ENOENT(p)},d.prototype.readdirSync=function(p){var b=this._getDirectoryRecord(p);if(b){if(b.isDirectory(this._data))return b.getDirectory(this._data).getFileList().slice(0);throw g.ENOTDIR(p)}else throw g.ENOENT(p)},d.prototype.readFileSync=function(p,b,k){var I=this.openSync(p,k,420);try{var L=I,U=L.getBuffer();return b===null?ke(U):U.toString(b)}finally{I.closeSync()}},d.prototype._getDirectoryRecord=function(p){var b=this;if(p==="/")return this._root;for(var k=p.split("/").slice(1),I=this._root,L=0,U=k;L<U.length;L+=1){var G=U[L];if(I.isDirectory(b._data)){if(I=I.getDirectory(b._data).getRecord(G),!I)return null}else return null}return I},d.prototype._getStats=function(p,b){if(b.isSymlink(this._data)){var k=f.resolve(p,b.getSymlinkPath(this._data)),I=this._getDirectoryRecord(k);return I?this._getStats(k,I):null}else{var L=b.dataLength(),U=365,G=b.recordingDate(),ue=G,_e=G,Ne=G;if(b.hasRockRidge())for(var Ve=b.getSUEntries(this._data),Je=0,dt=Ve;Je<dt.length;Je+=1){var yt=dt[Je];if(yt instanceof HL)U=yt.mode();else if(yt instanceof GL){var Tt=yt.flags();Tt&4&&(ue=yt.access()),Tt&2&&(_e=yt.modify()),Tt&1&&(Ne=yt.creation())}}return U=U&365,new A(b.isDirectory(this._data)?S.DIRECTORY:S.FILE,L,U,ue,_e,Ne)}},d}(Ye);Bv.Name="IsoFS",Bv.Options={data:{type:"object",description:"The ISO file in a buffer",validator:be}},[ee,kv,Ev,nf,Av,af,bh,Bv,wh,of,Eh,Pv,Fv,wc].forEach(function(v){var d=v.Create;v.Create=function(y,p){var b=typeof y=="function",k=b?y:p,I=b?{}:y;function L(U){U?k(U):d.call(v,I,k)}W(v,I,L)}});var Rv={AsyncMirror:ee,Dropbox:kv,Emscripten:Ev,FolderAdapter:nf,HTML5FS:Av,InMemory:af,IndexedDB:bh,IsoFS:Bv,LocalStorage:wh,MountableFileSystem:of,OverlayFS:Eh,WorkerFS:Pv,XmlHttpRequest:Fv,ZipFS:wc};l.initializeTTYs&&l.initializeTTYs();function AX(v){v.Buffer=a,v.process=l;var d=v.require?v.require:null;v.require=function(y){var p=YL(y);return p||d.apply(null,Array.prototype.slice.call(arguments,0))}}function IX(v,d){Rv[v]=d}function YL(v){switch(v){case"fs":return Q;case"path":return f;case"buffer":return c;case"process":return l;case"bfs_utils":return J;default:return Rv[v]}}function KL(v){return Q.initialize(v)}function CX(v,d){NS(v,function(y,p){p?(KL(p),d()):d(y)})}function NS(v,d){var y=v.fs;if(!y)return d(new g(u.EPERM,'Missing "fs" property on configuration object.'));var p=v.options,b=0,k=!1;function I(){if(!k){k=!0;var G=Rv[y];G?G.Create(p,d):d(new g(u.EPERM,"File system "+y+" is not available in BrowserFS."))}}if(p!==null&&typeof p=="object"){var L=!1,U=Object.keys(p).filter(function(G){return G!=="fs"});U.forEach(function(G){var ue=p[G];ue!==null&&typeof ue=="object"&&ue.fs&&(b++,NS(ue,function(_e,Ne){if(b--,_e){if(k)return;k=!0,d(_e)}else p[G]=Ne,b===0&&L&&I()}))}),L=!0}b===0&&I()}"ab".substr(-1)!=="b"&&(String.prototype.substr=function(v){return function(d,y){return d<0&&(d=this.length+d),v.call(this,d,y)}}(String.prototype.substr)),typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&(Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(v,d){v===void 0&&(v=0),d===void 0&&(d=this.length);var y=this;return v<0&&(v=this.length+v,v<0&&(v=0)),d<0&&(d=this.length+d,d<0&&(d=0)),d<v&&(d=v),new Uint8Array(y.buffer,y.byteOffset+v,d-v)})),n.install=AX,n.registerFileSystem=IX,n.BFSRequire=YL,n.initialize=KL,n.configure=CX,n.getFileSystem=NS,n.EmscriptenFS=Te,n.FileSystem=Rv,n.Errors=_,n.setImmediate=ES}).call(n,i(1),function(){return this}(),i(5)(r),i(6))},function(r,n,i){r.exports=i(2).Buffer},function(r,n,i){(function(u){"use strict";var o=i(3),s=i(4);n.Buffer=u,n.SlowBuffer=T,n.INSPECT_MAX_BYTES=50;var l=2147483647;n.kMaxLength=l,u.TYPED_ARRAY_SUPPORT=c(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{var ee=new Uint8Array(1);return ee.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ee.foo()===42}catch{return!1}}function f(ee){if(ee>l)throw new RangeError("Invalid typed array length");var B=new Uint8Array(ee);return B.__proto__=u.prototype,B}function u(ee,B,R){if(typeof ee=="number"){if(typeof B=="string")throw new Error("If encoding is specified then the first argument must be a string");return w(ee)}return h(ee,B,R)}typeof Symbol<"u"&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),u.poolSize=8192;function h(ee,B,R){if(typeof ee=="number")throw new TypeError('"value" argument must not be a number');return St(ee)?A(ee,B,R):typeof ee=="string"?E(ee,B):O(ee)}u.from=function(ee,B,R){return h(ee,B,R)},u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array;function g(ee){if(typeof ee!="number")throw new TypeError('"size" argument must be a number');if(ee<0)throw new RangeError('"size" argument must not be negative')}function _(ee,B,R){return g(ee),ee<=0?f(ee):B!==void 0?typeof R=="string"?f(ee).fill(B,R):f(ee).fill(B):f(ee)}u.alloc=function(ee,B,R){return _(ee,B,R)};function w(ee){return g(ee),f(ee<0?0:C(ee)|0)}u.allocUnsafe=function(ee){return w(ee)},u.allocUnsafeSlow=function(ee){return w(ee)};function E(ee,B){if((typeof B!="string"||B==="")&&(B="utf8"),!u.isEncoding(B))throw new TypeError('"encoding" must be a valid string encoding');var R=D(ee,B)|0,te=f(R),we=te.write(ee,B);return we!==R&&(te=te.slice(0,we)),te}function S(ee){for(var B=ee.length<0?0:C(ee.length)|0,R=f(B),te=0;te<B;te+=1)R[te]=ee[te]&255;return R}function A(ee,B,R){if(B<0||ee.byteLength<B)throw new RangeError("'offset' is out of bounds");if(ee.byteLength<B+(R||0))throw new RangeError("'length' is out of bounds");var te;return B===void 0&&R===void 0?te=new Uint8Array(ee):R===void 0?te=new Uint8Array(ee,B):te=new Uint8Array(ee,B,R),te.__proto__=u.prototype,te}function O(ee){if(u.isBuffer(ee)){var B=C(ee.length)|0,R=f(B);return R.length===0||ee.copy(R,0,0,B),R}if(ee){if(_t(ee)||"length"in ee)return typeof ee.length!="number"||ft(ee.length)?f(0):S(ee);if(ee.type==="Buffer"&&Array.isArray(ee.data))return S(ee.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function C(ee){if(ee>=l)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l.toString(16)+" bytes");return ee|0}function T(ee){return+ee!=ee&&(ee=0),u.alloc(+ee)}u.isBuffer=function(B){return B!=null&&B._isBuffer===!0},u.compare=function(B,R){if(!u.isBuffer(B)||!u.isBuffer(R))throw new TypeError("Arguments must be Buffers");if(B===R)return 0;for(var te=B.length,we=R.length,Ae=0,Re=Math.min(te,we);Ae<Re;++Ae)if(B[Ae]!==R[Ae]){te=B[Ae],we=R[Ae];break}return te<we?-1:we<te?1:0},u.isEncoding=function(B){switch(String(B).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(B,R){if(!Array.isArray(B))throw new TypeError('"list" argument must be an Array of Buffers');if(B.length===0)return u.alloc(0);var te;if(R===void 0)for(R=0,te=0;te<B.length;++te)R+=B[te].length;var we=u.allocUnsafe(R),Ae=0;for(te=0;te<B.length;++te){var Re=B[te];if(!u.isBuffer(Re))throw new TypeError('"list" argument must be an Array of Buffers');Re.copy(we,Ae),Ae+=Re.length}return we};function D(ee,B){if(u.isBuffer(ee))return ee.length;if(_t(ee)||St(ee))return ee.byteLength;typeof ee!="string"&&(ee=""+ee);var R=ee.length;if(R===0)return 0;for(var te=!1;;)switch(B){case"ascii":case"latin1":case"binary":return R;case"utf8":case"utf-8":case void 0:return Ee(ee).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R*2;case"hex":return R>>>1;case"base64":return Ye(ee).length;default:if(te)return Ee(ee).length;B=(""+B).toLowerCase(),te=!0}}u.byteLength=D;function P(ee,B,R){var te=!1;if((B===void 0||B<0)&&(B=0),B>this.length||((R===void 0||R>this.length)&&(R=this.length),R<=0)||(R>>>=0,B>>>=0,R<=B))return"";for(ee||(ee="utf8");;)switch(ee){case"hex":return le(this,B,R);case"utf8":case"utf-8":return Z(this,B,R);case"ascii":return q(this,B,R);case"latin1":case"binary":return ae(this,B,R);case"base64":return H(this,B,R);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,B,R);default:if(te)throw new TypeError("Unknown encoding: "+ee);ee=(ee+"").toLowerCase(),te=!0}}u.prototype._isBuffer=!0;function z(ee,B,R){var te=ee[B];ee[B]=ee[R],ee[R]=te}u.prototype.swap16=function(){var B=this.length;if(B%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var R=0;R<B;R+=2)z(this,R,R+1);return this},u.prototype.swap32=function(){var B=this.length;if(B%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var R=0;R<B;R+=4)z(this,R,R+3),z(this,R+1,R+2);return this},u.prototype.swap64=function(){var B=this.length;if(B%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var R=0;R<B;R+=8)z(this,R,R+7),z(this,R+1,R+6),z(this,R+2,R+5),z(this,R+3,R+4);return this},u.prototype.toString=function(){var B=this.length;return B===0?"":arguments.length===0?Z(this,0,B):P.apply(this,arguments)},u.prototype.equals=function(B){if(!u.isBuffer(B))throw new TypeError("Argument must be a Buffer");return this===B?!0:u.compare(this,B)===0},u.prototype.inspect=function(){var B="",R=n.INSPECT_MAX_BYTES;return this.length>0&&(B=this.toString("hex",0,R).match(/.{2}/g).join(" "),this.length>R&&(B+=" ... ")),"<Buffer "+B+">"},u.prototype.compare=function(B,R,te,we,Ae){if(!u.isBuffer(B))throw new TypeError("Argument must be a Buffer");if(R===void 0&&(R=0),te===void 0&&(te=B?B.length:0),we===void 0&&(we=0),Ae===void 0&&(Ae=this.length),R<0||te>B.length||we<0||Ae>this.length)throw new RangeError("out of range index");if(we>=Ae&&R>=te)return 0;if(we>=Ae)return-1;if(R>=te)return 1;if(R>>>=0,te>>>=0,we>>>=0,Ae>>>=0,this===B)return 0;for(var Re=Ae-we,It=te-R,Pt=Math.min(Re,It),Gt=this.slice(we,Ae),xr=B.slice(R,te),zt=0;zt<Pt;++zt)if(Gt[zt]!==xr[zt]){Re=Gt[zt],It=xr[zt];break}return Re<It?-1:It<Re?1:0};function ne(ee,B,R,te,we){if(ee.length===0)return-1;if(typeof R=="string"?(te=R,R=0):R>2147483647?R=2147483647:R<-2147483648&&(R=-2147483648),R=+R,ft(R)&&(R=we?0:ee.length-1),R<0&&(R=ee.length+R),R>=ee.length){if(we)return-1;R=ee.length-1}else if(R<0)if(we)R=0;else return-1;if(typeof B=="string"&&(B=u.from(B,te)),u.isBuffer(B))return B.length===0?-1:V(ee,B,R,te,we);if(typeof B=="number")return B=B&255,typeof Uint8Array.prototype.indexOf=="function"?we?Uint8Array.prototype.indexOf.call(ee,B,R):Uint8Array.prototype.lastIndexOf.call(ee,B,R):V(ee,[B],R,te,we);throw new TypeError("val must be string, number or Buffer")}function V(ee,B,R,te,we){var Ae=1,Re=ee.length,It=B.length;if(te!==void 0&&(te=String(te).toLowerCase(),te==="ucs2"||te==="ucs-2"||te==="utf16le"||te==="utf-16le")){if(ee.length<2||B.length<2)return-1;Ae=2,Re/=2,It/=2,R/=2}function Pt(Xs,Xo){return Ae===1?Xs[Xo]:Xs.readUInt16BE(Xo*Ae)}var Gt;if(we){var xr=-1;for(Gt=R;Gt<Re;Gt++)if(Pt(ee,Gt)===Pt(B,xr===-1?0:Gt-xr)){if(xr===-1&&(xr=Gt),Gt-xr+1===It)return xr*Ae}else xr!==-1&&(Gt-=Gt-xr),xr=-1}else for(R+It>Re&&(R=Re-It),Gt=R;Gt>=0;Gt--){for(var zt=!0,Ei=0;Ei<It;Ei++)if(Pt(ee,Gt+Ei)!==Pt(B,Ei)){zt=!1;break}if(zt)return Gt}return-1}u.prototype.includes=function(B,R,te){return this.indexOf(B,R,te)!==-1},u.prototype.indexOf=function(B,R,te){return ne(this,B,R,te,!0)},u.prototype.lastIndexOf=function(B,R,te){return ne(this,B,R,te,!1)};function X(ee,B,R,te){R=Number(R)||0;var we=ee.length-R;te?(te=Number(te),te>we&&(te=we)):te=we;var Ae=B.length;if(Ae%2!==0)throw new TypeError("Invalid hex string");te>Ae/2&&(te=Ae/2);for(var Re=0;Re<te;++Re){var It=parseInt(B.substr(Re*2,2),16);if(ft(It))return Re;ee[R+Re]=It}return Re}function Q(ee,B,R,te){return Ke(Ee(B,ee.length-R),ee,R,te)}function ie(ee,B,R,te){return Ke(Te(B),ee,R,te)}function pe(ee,B,R,te){return ie(ee,B,R,te)}function de(ee,B,R,te){return Ke(Ye(B),ee,R,te)}function F(ee,B,R,te){return Ke(Ie(B,ee.length-R),ee,R,te)}u.prototype.write=function(B,R,te,we){if(R===void 0)we="utf8",te=this.length,R=0;else if(te===void 0&&typeof R=="string")we=R,te=this.length,R=0;else if(isFinite(R))R=R>>>0,isFinite(te)?(te=te>>>0,we===void 0&&(we="utf8")):(we=te,te=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Ae=this.length-R;if((te===void 0||te>Ae)&&(te=Ae),B.length>0&&(te<0||R<0)||R>this.length)throw new RangeError("Attempt to write outside buffer bounds");we||(we="utf8");for(var Re=!1;;)switch(we){case"hex":return X(this,B,R,te);case"utf8":case"utf-8":return Q(this,B,R,te);case"ascii":return ie(this,B,R,te);case"latin1":case"binary":return pe(this,B,R,te);case"base64":return de(this,B,R,te);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,B,R,te);default:if(Re)throw new TypeError("Unknown encoding: "+we);we=(""+we).toLowerCase(),Re=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function H(ee,B,R){return B===0&&R===ee.length?o.fromByteArray(ee):o.fromByteArray(ee.slice(B,R))}function Z(ee,B,R){R=Math.min(ee.length,R);for(var te=[],we=B;we<R;){var Ae=ee[we],Re=null,It=Ae>239?4:Ae>223?3:Ae>191?2:1;if(we+It<=R){var Pt,Gt,xr,zt;switch(It){case 1:Ae<128&&(Re=Ae);break;case 2:Pt=ee[we+1],(Pt&192)===128&&(zt=(Ae&31)<<6|Pt&63,zt>127&&(Re=zt));break;case 3:Pt=ee[we+1],Gt=ee[we+2],(Pt&192)===128&&(Gt&192)===128&&(zt=(Ae&15)<<12|(Pt&63)<<6|Gt&63,zt>2047&&(zt<55296||zt>57343)&&(Re=zt));break;case 4:Pt=ee[we+1],Gt=ee[we+2],xr=ee[we+3],(Pt&192)===128&&(Gt&192)===128&&(xr&192)===128&&(zt=(Ae&15)<<18|(Pt&63)<<12|(Gt&63)<<6|xr&63,zt>65535&&zt<1114112&&(Re=zt))}}Re===null?(Re=65533,It=1):Re>65535&&(Re-=65536,te.push(Re>>>10&1023|55296),Re=56320|Re&1023),te.push(Re),we+=It}return $(te)}var j=4096;function $(ee){var B=ee.length;if(B<=j)return String.fromCharCode.apply(String,ee);for(var R="",te=0;te<B;)R+=String.fromCharCode.apply(String,ee.slice(te,te+=j));return R}function q(ee,B,R){var te="";R=Math.min(ee.length,R);for(var we=B;we<R;++we)te+=String.fromCharCode(ee[we]&127);return te}function ae(ee,B,R){var te="";R=Math.min(ee.length,R);for(var we=B;we<R;++we)te+=String.fromCharCode(ee[we]);return te}function le(ee,B,R){var te=ee.length;(!B||B<0)&&(B=0),(!R||R<0||R>te)&&(R=te);for(var we="",Ae=B;Ae<R;++Ae)we+=re(ee[Ae]);return we}function fe(ee,B,R){for(var te=ee.slice(B,R),we="",Ae=0;Ae<te.length;Ae+=2)we+=String.fromCharCode(te[Ae]+te[Ae+1]*256);return we}u.prototype.slice=function(B,R){var te=this.length;B=~~B,R=R===void 0?te:~~R,B<0?(B+=te,B<0&&(B=0)):B>te&&(B=te),R<0?(R+=te,R<0&&(R=0)):R>te&&(R=te),R<B&&(R=B);var we=this.subarray(B,R);return we.__proto__=u.prototype,we};function Se(ee,B,R){if(ee%1!==0||ee<0)throw new RangeError("offset is not uint");if(ee+B>R)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUIntLE=function(B,R,te){B=B>>>0,R=R>>>0,te||Se(B,R,this.length);for(var we=this[B],Ae=1,Re=0;++Re<R&&(Ae*=256);)we+=this[B+Re]*Ae;return we},u.prototype.readUIntBE=function(B,R,te){B=B>>>0,R=R>>>0,te||Se(B,R,this.length);for(var we=this[B+--R],Ae=1;R>0&&(Ae*=256);)we+=this[B+--R]*Ae;return we},u.prototype.readUInt8=function(B,R){return B=B>>>0,R||Se(B,1,this.length),this[B]},u.prototype.readUInt16LE=function(B,R){return B=B>>>0,R||Se(B,2,this.length),this[B]|this[B+1]<<8},u.prototype.readUInt16BE=function(B,R){return B=B>>>0,R||Se(B,2,this.length),this[B]<<8|this[B+1]},u.prototype.readUInt32LE=function(B,R){return B=B>>>0,R||Se(B,4,this.length),(this[B]|this[B+1]<<8|this[B+2]<<16)+this[B+3]*16777216},u.prototype.readUInt32BE=function(B,R){return B=B>>>0,R||Se(B,4,this.length),this[B]*16777216+(this[B+1]<<16|this[B+2]<<8|this[B+3])},u.prototype.readIntLE=function(B,R,te){B=B>>>0,R=R>>>0,te||Se(B,R,this.length);for(var we=this[B],Ae=1,Re=0;++Re<R&&(Ae*=256);)we+=this[B+Re]*Ae;return Ae*=128,we>=Ae&&(we-=Math.pow(2,8*R)),we},u.prototype.readIntBE=function(B,R,te){B=B>>>0,R=R>>>0,te||Se(B,R,this.length);for(var we=R,Ae=1,Re=this[B+--we];we>0&&(Ae*=256);)Re+=this[B+--we]*Ae;return Ae*=128,Re>=Ae&&(Re-=Math.pow(2,8*R)),Re},u.prototype.readInt8=function(B,R){return B=B>>>0,R||Se(B,1,this.length),this[B]&128?(255-this[B]+1)*-1:this[B]},u.prototype.readInt16LE=function(B,R){B=B>>>0,R||Se(B,2,this.length);var te=this[B]|this[B+1]<<8;return te&32768?te|4294901760:te},u.prototype.readInt16BE=function(B,R){B=B>>>0,R||Se(B,2,this.length);var te=this[B+1]|this[B]<<8;return te&32768?te|4294901760:te},u.prototype.readInt32LE=function(B,R){return B=B>>>0,R||Se(B,4,this.length),this[B]|this[B+1]<<8|this[B+2]<<16|this[B+3]<<24},u.prototype.readInt32BE=function(B,R){return B=B>>>0,R||Se(B,4,this.length),this[B]<<24|this[B+1]<<16|this[B+2]<<8|this[B+3]},u.prototype.readFloatLE=function(B,R){return B=B>>>0,R||Se(B,4,this.length),s.read(this,B,!0,23,4)},u.prototype.readFloatBE=function(B,R){return B=B>>>0,R||Se(B,4,this.length),s.read(this,B,!1,23,4)},u.prototype.readDoubleLE=function(B,R){return B=B>>>0,R||Se(B,8,this.length),s.read(this,B,!0,52,8)},u.prototype.readDoubleBE=function(B,R){return B=B>>>0,R||Se(B,8,this.length),s.read(this,B,!1,52,8)};function ke(ee,B,R,te,we,Ae){if(!u.isBuffer(ee))throw new TypeError('"buffer" argument must be a Buffer instance');if(B>we||B<Ae)throw new RangeError('"value" argument is out of bounds');if(R+te>ee.length)throw new RangeError("Index out of range")}u.prototype.writeUIntLE=function(B,R,te,we){if(B=+B,R=R>>>0,te=te>>>0,!we){var Ae=Math.pow(2,8*te)-1;ke(this,B,R,te,Ae,0)}var Re=1,It=0;for(this[R]=B&255;++It<te&&(Re*=256);)this[R+It]=B/Re&255;return R+te},u.prototype.writeUIntBE=function(B,R,te,we){if(B=+B,R=R>>>0,te=te>>>0,!we){var Ae=Math.pow(2,8*te)-1;ke(this,B,R,te,Ae,0)}var Re=te-1,It=1;for(this[R+Re]=B&255;--Re>=0&&(It*=256);)this[R+Re]=B/It&255;return R+te},u.prototype.writeUInt8=function(B,R,te){return B=+B,R=R>>>0,te||ke(this,B,R,1,255,0),this[R]=B&255,R+1},u.prototype.writeUInt16LE=function(B,R,te){return B=+B,R=R>>>0,te||ke(this,B,R,2,65535,0),this[R]=B&255,this[R+1]=B>>>8,R+2},u.prototype.writeUInt16BE=function(B,R,te){return B=+B,R=R>>>0,te||ke(this,B,R,2,65535,0),this[R]=B>>>8,this[R+1]=B&255,R+2},u.prototype.writeUInt32LE=function(B,R,te){return B=+B,R=R>>>0,te||ke(this,B,R,4,4294967295,0),this[R+3]=B>>>24,this[R+2]=B>>>16,this[R+1]=B>>>8,this[R]=B&255,R+4},u.prototype.writeUInt32BE=function(B,R,te){return B=+B,R=R>>>0,te||ke(this,B,R,4,4294967295,0),this[R]=B>>>24,this[R+1]=B>>>16,this[R+2]=B>>>8,this[R+3]=B&255,R+4},u.prototype.writeIntLE=function(B,R,te,we){if(B=+B,R=R>>>0,!we){var Ae=Math.pow(2,8*te-1);ke(this,B,R,te,Ae-1,-Ae)}var Re=0,It=1,Pt=0;for(this[R]=B&255;++Re<te&&(It*=256);)B<0&&Pt===0&&this[R+Re-1]!==0&&(Pt=1),this[R+Re]=(B/It>>0)-Pt&255;return R+te},u.prototype.writeIntBE=function(B,R,te,we){if(B=+B,R=R>>>0,!we){var Ae=Math.pow(2,8*te-1);ke(this,B,R,te,Ae-1,-Ae)}var Re=te-1,It=1,Pt=0;for(this[R+Re]=B&255;--Re>=0&&(It*=256);)B<0&&Pt===0&&this[R+Re+1]!==0&&(Pt=1),this[R+Re]=(B/It>>0)-Pt&255;return R+te},u.prototype.writeInt8=function(B,R,te){return B=+B,R=R>>>0,te||ke(this,B,R,1,127,-128),B<0&&(B=255+B+1),this[R]=B&255,R+1},u.prototype.writeInt16LE=function(B,R,te){return B=+B,R=R>>>0,te||ke(this,B,R,2,32767,-32768),this[R]=B&255,this[R+1]=B>>>8,R+2},u.prototype.writeInt16BE=function(B,R,te){return B=+B,R=R>>>0,te||ke(this,B,R,2,32767,-32768),this[R]=B>>>8,this[R+1]=B&255,R+2},u.prototype.writeInt32LE=function(B,R,te){return B=+B,R=R>>>0,te||ke(this,B,R,4,2147483647,-2147483648),this[R]=B&255,this[R+1]=B>>>8,this[R+2]=B>>>16,this[R+3]=B>>>24,R+4},u.prototype.writeInt32BE=function(B,R,te){return B=+B,R=R>>>0,te||ke(this,B,R,4,2147483647,-2147483648),B<0&&(B=4294967295+B+1),this[R]=B>>>24,this[R+1]=B>>>16,this[R+2]=B>>>8,this[R+3]=B&255,R+4};function xe(ee,B,R,te,we,Ae){if(R+te>ee.length)throw new RangeError("Index out of range");if(R<0)throw new RangeError("Index out of range")}function se(ee,B,R,te,we){return B=+B,R=R>>>0,we||xe(ee,B,R,4,34028234663852886e22,-34028234663852886e22),s.write(ee,B,R,te,23,4),R+4}u.prototype.writeFloatLE=function(B,R,te){return se(this,B,R,!0,te)},u.prototype.writeFloatBE=function(B,R,te){return se(this,B,R,!1,te)};function be(ee,B,R,te,we){return B=+B,R=R>>>0,we||xe(ee,B,R,8,17976931348623157e292,-17976931348623157e292),s.write(ee,B,R,te,52,8),R+8}u.prototype.writeDoubleLE=function(B,R,te){return be(this,B,R,!0,te)},u.prototype.writeDoubleBE=function(B,R,te){return be(this,B,R,!1,te)},u.prototype.copy=function(B,R,te,we){if(te||(te=0),!we&&we!==0&&(we=this.length),R>=B.length&&(R=B.length),R||(R=0),we>0&&we<te&&(we=te),we===te||B.length===0||this.length===0)return 0;if(R<0)throw new RangeError("targetStart out of bounds");if(te<0||te>=this.length)throw new RangeError("sourceStart out of bounds");if(we<0)throw new RangeError("sourceEnd out of bounds");we>this.length&&(we=this.length),B.length-R<we-te&&(we=B.length-R+te);var Ae=we-te,Re;if(this===B&&te<R&&R<we)for(Re=Ae-1;Re>=0;--Re)B[Re+R]=this[Re+te];else if(Ae<1e3)for(Re=0;Re<Ae;++Re)B[Re+R]=this[Re+te];else Uint8Array.prototype.set.call(B,this.subarray(te,te+Ae),R);return Ae},u.prototype.fill=function(B,R,te,we){if(typeof B=="string"){if(typeof R=="string"?(we=R,R=0,te=this.length):typeof te=="string"&&(we=te,te=this.length),B.length===1){var Ae=B.charCodeAt(0);Ae<256&&(B=Ae)}if(we!==void 0&&typeof we!="string")throw new TypeError("encoding must be a string");if(typeof we=="string"&&!u.isEncoding(we))throw new TypeError("Unknown encoding: "+we)}else typeof B=="number"&&(B=B&255);if(R<0||this.length<R||this.length<te)throw new RangeError("Out of range index");if(te<=R)return this;R=R>>>0,te=te===void 0?this.length:te>>>0,B||(B=0);var Re;if(typeof B=="number")for(Re=R;Re<te;++Re)this[Re]=B;else{var It=u.isBuffer(B)?B:new u(B,we),Pt=It.length;for(Re=0;Re<te-R;++Re)this[Re+R]=It[Re%Pt]}return this};var W=/[^+/0-9A-Za-z-_]/g;function J(ee){if(ee=ee.trim().replace(W,""),ee.length<2)return"";for(;ee.length%4!==0;)ee=ee+"=";return ee}function re(ee){return ee<16?"0"+ee.toString(16):ee.toString(16)}function Ee(ee,B){B=B||1/0;for(var R,te=ee.length,we=null,Ae=[],Re=0;Re<te;++Re){if(R=ee.charCodeAt(Re),R>55295&&R<57344){if(!we){if(R>56319){(B-=3)>-1&&Ae.push(239,191,189);continue}else if(Re+1===te){(B-=3)>-1&&Ae.push(239,191,189);continue}we=R;continue}if(R<56320){(B-=3)>-1&&Ae.push(239,191,189),we=R;continue}R=(we-55296<<10|R-56320)+65536}else we&&(B-=3)>-1&&Ae.push(239,191,189);if(we=null,R<128){if((B-=1)<0)break;Ae.push(R)}else if(R<2048){if((B-=2)<0)break;Ae.push(R>>6|192,R&63|128)}else if(R<65536){if((B-=3)<0)break;Ae.push(R>>12|224,R>>6&63|128,R&63|128)}else if(R<1114112){if((B-=4)<0)break;Ae.push(R>>18|240,R>>12&63|128,R>>6&63|128,R&63|128)}else throw new Error("Invalid code point")}return Ae}function Te(ee){for(var B=[],R=0;R<ee.length;++R)B.push(ee.charCodeAt(R)&255);return B}function Ie(ee,B){for(var R,te,we,Ae=[],Re=0;Re<ee.length&&!((B-=2)<0);++Re)R=ee.charCodeAt(Re),te=R>>8,we=R%256,Ae.push(we),Ae.push(te);return Ae}function Ye(ee){return o.toByteArray(J(ee))}function Ke(ee,B,R,te){for(var we=0;we<te&&!(we+R>=B.length||we>=ee.length);++we)B[we+R]=ee[we];return we}function St(ee){return ee instanceof ArrayBuffer||ee!=null&&ee.constructor!=null&&ee.constructor.name==="ArrayBuffer"&&typeof ee.byteLength=="number"}function _t(ee){return typeof ArrayBuffer.isView=="function"&&ArrayBuffer.isView(ee)}function ft(ee){return ee!==ee}}).call(n,i(1))},function(r,n){"use strict";n.byteLength=u,n.toByteArray=h,n.fromByteArray=w;for(var i=[],a=[],o=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,c=s.length;l<c;++l)i[l]=s[l],a[s.charCodeAt(l)]=l;a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63;function f(E){var S=E.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return E[S-2]==="="?2:E[S-1]==="="?1:0}function u(E){return E.length*3/4-f(E)}function h(E){var S,A,O,C,T,D,P=E.length;T=f(E),D=new o(P*3/4-T),O=T>0?P-4:P;var z=0;for(S=0,A=0;S<O;S+=4,A+=3)C=a[E.charCodeAt(S)]<<18|a[E.charCodeAt(S+1)]<<12|a[E.charCodeAt(S+2)]<<6|a[E.charCodeAt(S+3)],D[z++]=C>>16&255,D[z++]=C>>8&255,D[z++]=C&255;return T===2?(C=a[E.charCodeAt(S)]<<2|a[E.charCodeAt(S+1)]>>4,D[z++]=C&255):T===1&&(C=a[E.charCodeAt(S)]<<10|a[E.charCodeAt(S+1)]<<4|a[E.charCodeAt(S+2)]>>2,D[z++]=C>>8&255,D[z++]=C&255),D}function g(E){return i[E>>18&63]+i[E>>12&63]+i[E>>6&63]+i[E&63]}function _(E,S,A){for(var O,C=[],T=S;T<A;T+=3)O=(E[T]<<16)+(E[T+1]<<8)+E[T+2],C.push(g(O));return C.join("")}function w(E){for(var S,A=E.length,O=A%3,C="",T=[],D=16383,P=0,z=A-O;P<z;P+=D)T.push(_(E,P,P+D>z?z:P+D));return O===1?(S=E[A-1],C+=i[S>>2],C+=i[S<<4&63],C+="=="):O===2&&(S=(E[A-2]<<8)+E[A-1],C+=i[S>>10],C+=i[S>>4&63],C+=i[S<<2&63],C+="="),T.push(C),T.join("")}},function(r,n){n.read=function(i,a,o,s,l){var c,f,u=l*8-s-1,h=(1<<u)-1,g=h>>1,_=-7,w=o?l-1:0,E=o?-1:1,S=i[a+w];for(w+=E,c=S&(1<<-_)-1,S>>=-_,_+=u;_>0;c=c*256+i[a+w],w+=E,_-=8);for(f=c&(1<<-_)-1,c>>=-_,_+=s;_>0;f=f*256+i[a+w],w+=E,_-=8);if(c===0)c=1-g;else{if(c===h)return f?NaN:(S?-1:1)*(1/0);f=f+Math.pow(2,s),c=c-g}return(S?-1:1)*f*Math.pow(2,c-s)},n.write=function(i,a,o,s,l,c){var f,u,h,g=c*8-l-1,_=(1<<g)-1,w=_>>1,E=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=s?0:c-1,A=s?1:-1,O=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(u=isNaN(a)?1:0,f=_):(f=Math.floor(Math.log(a)/Math.LN2),a*(h=Math.pow(2,-f))<1&&(f--,h*=2),f+w>=1?a+=E/h:a+=E*Math.pow(2,1-w),a*h>=2&&(f++,h/=2),f+w>=_?(u=0,f=_):f+w>=1?(u=(a*h-1)*Math.pow(2,l),f=f+w):(u=a*Math.pow(2,w-1)*Math.pow(2,l),f=0));l>=8;i[o+S]=u&255,S+=A,u/=256,l-=8);for(f=f<<l|u,g+=l;g>0;i[o+S]=f&255,S+=A,f/=256,g-=8);i[o+S-A]|=O*128}},function(r,n){r.exports=function(i){return i.webpackPolyfill||(i.deprecate=function(){},i.paths=[],i.children=[],i.webpackPolyfill=1),i}},function(r,n,i){"use strict";var a=i(7),o=new a,s={};function l(f){s[f]||(typeof o[f]=="function"?s[f]=function(){return o[f].apply(o,arguments)}:s[f]=o[f])}for(var c in o)l(c);s.initializeTTYs=function(){o.stdin===null&&(o.initializeTTYs(),s.stdin=o.stdin,s.stdout=o.stdout,s.stderr=o.stderr)},o.nextTick(function(){s.initializeTTYs()}),r.exports=s},function(r,n,i){(function(a){"use strict";var o=this&&this.__extends||function(h,g){for(var _ in g)g.hasOwnProperty(_)&&(h[_]=g[_]);function w(){this.constructor=h}h.prototype=g===null?Object.create(g):(w.prototype=g.prototype,new w)},s=i(8),l=null,c=function(){function h(g,_){this.fun=g,this.array=_}return h.prototype.run=function(){this.fun.apply(null,this.array)},h}(),f=function(){function h(){this._queue=[],this._draining=!1,this._currentQueue=null,this._queueIndex=-1}return h.prototype.push=function(g){var _=this;this._queue.push(g)===1&&!this._draining&&setTimeout(function(){return _._drainQueue()},0)},h.prototype._cleanUpNextTick=function(){this._draining=!1,this._currentQueue&&this._currentQueue.length?this._queue=this._currentQueue.concat(this._queue):this._queueIndex=-1,this._queue.length&&this._drainQueue()},h.prototype._drainQueue=function(){var g=this;if(!this._draining){var _=setTimeout(function(){return g._cleanUpNextTick()});this._draining=!0;for(var w=this._queue.length;w;){for(this._currentQueue=this._queue,this._queue=[];++this._queueIndex<w;)this._currentQueue&&this._currentQueue[this._queueIndex].run();this._queueIndex=-1,w=this._queue.length}this._currentQueue=null,this._draining=!1,clearTimeout(_)}},h}(),u=function(h){o(g,h);function g(){h.apply(this,arguments),this.startTime=Date.now(),this._cwd="/",this.platform="browser",this.argv=[],this.execArgv=[],this.stdout=null,this.stderr=null,this.stdin=null,this.domain=null,this._queue=new f,this.execPath=a,this.env={},this.exitCode=0,this._gid=1,this._uid=1,this.version="v5.0",this.versions={http_parser:"0.0",node:"5.0",v8:"0.0",uv:"0.0",zlib:"0.0",ares:"0.0",icu:"0.0",modules:"0",openssl:"0.0"},this.config={target_defaults:{cflags:[],default_configuration:"Release",defines:[],include_dirs:[],libraries:[]},variables:{clang:0,host_arch:"x32",node_install_npm:!1,node_install_waf:!1,node_prefix:"",node_shared_cares:!1,node_shared_http_parser:!1,node_shared_libuv:!1,node_shared_zlib:!1,node_shared_v8:!1,node_use_dtrace:!1,node_use_etw:!1,node_use_openssl:!1,node_shared_openssl:!1,strict_aliasing:!1,target_arch:"x32",v8_use_snapshot:!1,v8_no_strict_aliasing:0,visibility:""}},this.pid=Math.random()*1e3|0,this.title="node",this.arch="x32",this._mask=18,this.connected=void 0}return g.prototype.chdir=function(_){l===null&&(l=i(9)),this._cwd=l.resolve(_)},g.prototype.cwd=function(){return this._cwd},g.prototype.uptime=function(){return(Date.now()-this.startTime)/1e3|0},g.prototype.nextTick=function(_){for(var w=[],E=1;E<arguments.length;E++)w[E-1]=arguments[E];this._queue.push(new c(_,w))},g.prototype.abort=function(){this.emit("abort")},g.prototype.exit=function(_){this.exitCode=_,this.emit("exit",[_])},g.prototype.getgid=function(){return this._gid},g.prototype.setgid=function(_){typeof _=="number"?this._gid=_:this._gid=1},g.prototype.getuid=function(){return this._uid},g.prototype.setuid=function(_){typeof _=="number"?this._uid=_:this._uid=1},g.prototype.kill=function(_,w){this.emit("kill",[_,w])},g.prototype.memoryUsage=function(){return{rss:0,heapTotal:0,heapUsed:0}},g.prototype.umask=function(_){_===void 0&&(_=this._mask);var w=this._mask;return this._mask=_,this.emit("umask",[_]),w},g.prototype.hrtime=function(){var _;typeof performance<"u"?_=performance.now():Date.now?_=Date.now():_=new Date().getTime();var w=_/1e3|0;return _-=w*1e3,_=_*1e6|0,[w,_]},g.prototype.initializeTTYs=function(){if(this.stdout===null){var _=i(10);this.stdout=new _,this.stderr=new _,this.stdin=new _}},g.prototype.disconnect=function(){},g}(s.EventEmitter);r.exports=u}).call(n,"/")},function(r,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}r.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(c){if(!o(c)||c<0||isNaN(c))throw TypeError("n must be a positive number");return this._maxListeners=c,this},i.prototype.emit=function(c){var f,u,h,g,_,w;if(this._events||(this._events={}),c==="error"&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(f=arguments[1],f instanceof Error)throw f;var E=new Error('Uncaught, unspecified "error" event. ('+f+")");throw E.context=f,E}if(u=this._events[c],l(u))return!1;if(a(u))switch(arguments.length){case 1:u.call(this);break;case 2:u.call(this,arguments[1]);break;case 3:u.call(this,arguments[1],arguments[2]);break;default:g=Array.prototype.slice.call(arguments,1),u.apply(this,g)}else if(s(u))for(g=Array.prototype.slice.call(arguments,1),w=u.slice(),h=w.length,_=0;_<h;_++)w[_].apply(this,g);return!0},i.prototype.addListener=function(c,f){var u;if(!a(f))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",c,a(f.listener)?f.listener:f),this._events[c]?s(this._events[c])?this._events[c].push(f):this._events[c]=[this._events[c],f]:this._events[c]=f,s(this._events[c])&&!this._events[c].warned&&(l(this._maxListeners)?u=i.defaultMaxListeners:u=this._maxListeners,u&&u>0&&this._events[c].length>u&&(this._events[c].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[c].length),typeof console.trace=="function"&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(c,f){if(!a(f))throw TypeError("listener must be a function");var u=!1;function h(){this.removeListener(c,h),u||(u=!0,f.apply(this,arguments))}return h.listener=f,this.on(c,h),this},i.prototype.removeListener=function(c,f){var u,h,g,_;if(!a(f))throw TypeError("listener must be a function");if(!this._events||!this._events[c])return this;if(u=this._events[c],g=u.length,h=-1,u===f||a(u.listener)&&u.listener===f)delete this._events[c],this._events.removeListener&&this.emit("removeListener",c,f);else if(s(u)){for(_=g;_-- >0;)if(u[_]===f||u[_].listener&&u[_].listener===f){h=_;break}if(h<0)return this;u.length===1?(u.length=0,delete this._events[c]):u.splice(h,1),this._events.removeListener&&this.emit("removeListener",c,f)}return this},i.prototype.removeAllListeners=function(c){var f,u;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[c]&&delete this._events[c],this;if(arguments.length===0){for(f in this._events)f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events={},this}if(u=this._events[c],a(u))this.removeListener(c,u);else if(u)for(;u.length;)this.removeListener(c,u[u.length-1]);return delete this._events[c],this},i.prototype.listeners=function(c){var f;return!this._events||!this._events[c]?f=[]:a(this._events[c])?f=[this._events[c]]:f=this._events[c].slice(),f},i.prototype.listenerCount=function(c){if(this._events){var f=this._events[c];if(a(f))return 1;if(f)return f.length}return 0},i.listenerCount=function(c,f){return c.listenerCount(f)};function a(c){return typeof c=="function"}function o(c){return typeof c=="number"}function s(c){return typeof c=="object"&&c!==null}function l(c){return c===void 0}},function(r,n,i){(function(a){"use strict";var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function s(f){var u=o.exec(f);return u.shift(),u}var l=function(){function f(){}return f.normalize=function(u){u===""&&(u=".");var h=u.charAt(0)===f.sep;u=f._removeDuplicateSeps(u);for(var g=u.split(f.sep),_=[],w=0;w<g.length;w++){var E=g[w];E!=="."&&(E===".."&&(h||!h&&_.length>0&&_[0]!=="..")?_.pop():_.push(E))}if(!h&&_.length<2)switch(_.length){case 1:_[0]===""&&_.unshift(".");break;default:_.push(".")}return u=_.join(f.sep),h&&u.charAt(0)!==f.sep&&(u=f.sep+u),u},f.join=function(){for(var u=[],h=0;h<arguments.length;h++)u[h-0]=arguments[h];for(var g=[],_=0;_<u.length;_++){var w=u[_];if(typeof w!="string")throw new TypeError("Invalid argument type to path.join: "+typeof w);w!==""&&g.push(w)}return f.normalize(g.join(f.sep))},f.resolve=function(){for(var u=[],h=0;h<arguments.length;h++)u[h-0]=arguments[h];for(var g=[],_=0;_<u.length;_++){var w=u[_];if(typeof w!="string")throw new TypeError("Invalid argument type to path.join: "+typeof w);w!==""&&(w.charAt(0)===f.sep&&(g=[]),g.push(w))}var E=f.normalize(g.join(f.sep));if(E.length>1&&E.charAt(E.length-1)===f.sep)return E.substr(0,E.length-1);if(E.charAt(0)!==f.sep){E.charAt(0)==="."&&(E.length===1||E.charAt(1)===f.sep)&&(E=E.length===1?"":E.substr(2));var S=a.cwd();E!==""?E=this.normalize(S+(S!=="/"?f.sep:"")+E):E=S}return E},f.relative=function(u,h){var g;u=f.resolve(u),h=f.resolve(h);var _=u.split(f.sep),w=h.split(f.sep);w.shift(),_.shift();var E=0,S=[];for(g=0;g<_.length;g++){var A=_[g];if(A!==w[g]){E=_.length-g;break}}S=w.slice(g),_.length===1&&_[0]===""&&(E=0),E>_.length&&(E=_.length);var O="";for(g=0;g<E;g++)O+="../";return O+=S.join(f.sep),O.length>1&&O.charAt(O.length-1)===f.sep&&(O=O.substr(0,O.length-1)),O},f.dirname=function(u){u=f._removeDuplicateSeps(u);var h=u.charAt(0)===f.sep,g=u.split(f.sep);return g.pop()===""&&g.length>0&&g.pop(),g.length>1||g.length===1&&!h?g.join(f.sep):h?f.sep:"."},f.basename=function(u,h){if(h===void 0&&(h=""),u==="")return u;u=f.normalize(u);var g=u.split(f.sep),_=g[g.length-1];if(_===""&&g.length>1)return g[g.length-2];if(h.length>0){var w=_.substr(_.length-h.length);if(w===h)return _.substr(0,_.length-h.length)}return _},f.extname=function(u){u=f.normalize(u);var h=u.split(f.sep);if(u=h.pop(),u===""&&h.length>0&&(u=h.pop()),u==="..")return"";var g=u.lastIndexOf(".");return g===-1||g===0?"":u.substr(g)},f.isAbsolute=function(u){return u.length>0&&u.charAt(0)===f.sep},f._makeLong=function(u){return u},f.parse=function(u){var h=s(u);return{root:h[0],dir:h[0]+h[1].slice(0,-1),base:h[2],ext:h[3],name:h[2].slice(0,h[2].length-h[3].length)}},f.format=function(u){if(u===null||typeof u!="object")throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof u);var h=u.root||"";if(typeof h!="string")throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof u.root);var g=u.dir?u.dir+f.sep:"",_=u.base||"";return g+_},f._removeDuplicateSeps=function(u){return u=u.replace(this._replaceRegex,this.sep),u},f.sep="/",f._replaceRegex=new RegExp("//+","g"),f.delimiter=":",f.posix=f,f.win32=f,f}(),c=l;r.exports=l}).call(n,i(6))},function(r,n,i){(function(a){"use strict";var o=this&&this.__extends||function(c,f){for(var u in f)f.hasOwnProperty(u)&&(c[u]=f[u]);function h(){this.constructor=c}c.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)},s=i(11),l=function(c){o(f,c);function f(){c.call(this),this.isRaw=!1,this.columns=80,this.rows=120,this.isTTY=!0,this._bufferedWrites=[],this._waitingForWrites=!1}return f.prototype.setRawMode=function(u){this.isRaw!==u&&(this.isRaw=u,this.emit("modeChange"))},f.prototype.changeColumns=function(u){u!==this.columns&&(this.columns=u,this.emit("resize"))},f.prototype.changeRows=function(u){u!==this.rows&&(this.rows=u,this.emit("resize"))},f.isatty=function(u){return u&&u instanceof f},f.prototype._write=function(u,h,g){var _;try{var w;typeof u=="string"?w=new a(u,h):w=u,this._bufferedWrites.push(w),this._waitingForWrites&&this._read(1024)}catch(E){_=E}finally{g(_)}},f.prototype._read=function(u){if(this._bufferedWrites.length===0)this._waitingForWrites=!0;else for(;this._bufferedWrites.length>0&&(this._waitingForWrites=this.push(this._bufferedWrites.shift()),!!this._waitingForWrites););},f}(s.Duplex);r.exports=l}).call(n,i(1))},function(r,n,i){r.exports=s;var a=i(8).EventEmitter,o=i(12);o(s,a),s.Readable=i(13),s.Writable=i(27),s.Duplex=i(28),s.Transform=i(29),s.PassThrough=i(30),s.Stream=s;function s(){a.call(this)}s.prototype.pipe=function(l,c){var f=this;function u(A){l.writable&&l.write(A)===!1&&f.pause&&f.pause()}f.on("data",u);function h(){f.readable&&f.resume&&f.resume()}l.on("drain",h),!l._isStdio&&(!c||c.end!==!1)&&(f.on("end",_),f.on("close",w));var g=!1;function _(){g||(g=!0,l.end())}function w(){g||(g=!0,typeof l.destroy=="function"&&l.destroy())}function E(A){if(S(),a.listenerCount(this,"error")===0)throw A}f.on("error",E),l.on("error",E);function S(){f.removeListener("data",u),l.removeListener("drain",h),f.removeListener("end",_),f.removeListener("close",w),f.removeListener("error",E),l.removeListener("error",E),f.removeListener("end",S),f.removeListener("close",S),l.removeListener("close",S)}return f.on("end",S),f.on("close",S),l.on("close",S),l.emit("pipe",f),l}},function(r,n){typeof Object.create=="function"?r.exports=function(a,o){a.super_=o,a.prototype=Object.create(o.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:r.exports=function(a,o){a.super_=o;var s=function(){};s.prototype=o.prototype,a.prototype=new s,a.prototype.constructor=a}},function(r,n,i){(function(a){var o=function(){try{return i(11)}catch{}}();n=r.exports=i(14),n.Stream=o||n,n.Readable=n,n.Writable=i(22),n.Duplex=i(21),n.Transform=i(25),n.PassThrough=i(26),!a.browser&&a.env.READABLE_STREAM==="disable"&&o&&(r.exports=o)}).call(n,i(6))},function(r,n,i){(function(a){"use strict";r.exports=T;var o=i(15),s=i(16),l;T.ReadableState=C;var c=i(8).EventEmitter,f=function(W,J){return W.listeners(J).length},u;(function(){try{u=i(11)}catch{}finally{u||(u=i(8).EventEmitter)}})();var h=i(2).Buffer,g=i(17),_=i(18);_.inherits=i(12);var w=i(19),E=void 0;w&&w.debuglog?E=w.debuglog("stream"):E=function(){};var S=i(20),A;_.inherits(T,u);function O(W,J,re){if(typeof W.prependListener=="function")return W.prependListener(J,re);!W._events||!W._events[J]?W.on(J,re):s(W._events[J])?W._events[J].unshift(re):W._events[J]=[re,W._events[J]]}function C(W,J){l=l||i(21),W=W||{},this.objectMode=!!W.objectMode,J instanceof l&&(this.objectMode=this.objectMode||!!W.readableObjectMode);var re=W.highWaterMark,Ee=this.objectMode?16:16*1024;this.highWaterMark=re||re===0?re:Ee,this.highWaterMark=~~this.highWaterMark,this.buffer=new S,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=W.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,W.encoding&&(A||(A=i(24).StringDecoder),this.decoder=new A(W.encoding),this.encoding=W.encoding)}function T(W){if(l=l||i(21),!(this instanceof T))return new T(W);this._readableState=new C(W,this),this.readable=!0,W&&typeof W.read=="function"&&(this._read=W.read),u.call(this)}T.prototype.push=function(W,J){var re=this._readableState;return!re.objectMode&&typeof W=="string"&&(J=J||re.defaultEncoding,J!==re.encoding&&(W=g.from(W,J),J="")),D(this,re,W,J,!1)},T.prototype.unshift=function(W){var J=this._readableState;return D(this,J,W,"",!0)},T.prototype.isPaused=function(){return this._readableState.flowing===!1};function D(W,J,re,Ee,Te){var Ie=X(J,re);if(Ie)W.emit("error",Ie);else if(re===null)J.reading=!1,Q(W,J);else if(J.objectMode||re&&re.length>0)if(J.ended&&!Te){var Ye=new Error("stream.push() after EOF");W.emit("error",Ye)}else if(J.endEmitted&&Te){var Ke=new Error("stream.unshift() after end event");W.emit("error",Ke)}else{var St;J.decoder&&!Te&&!Ee&&(re=J.decoder.write(re),St=!J.objectMode&&re.length===0),Te||(J.reading=!1),St||(J.flowing&&J.length===0&&!J.sync?(W.emit("data",re),W.read(0)):(J.length+=J.objectMode?1:re.length,Te?J.buffer.unshift(re):J.buffer.push(re),J.needReadable&&ie(W))),de(W,J)}else Te||(J.reading=!1);return P(J)}function P(W){return!W.ended&&(W.needReadable||W.length<W.highWaterMark||W.length===0)}T.prototype.setEncoding=function(W){return A||(A=i(24).StringDecoder),this._readableState.decoder=new A(W),this._readableState.encoding=W,this};var z=8388608;function ne(W){return W>=z?W=z:(W--,W|=W>>>1,W|=W>>>2,W|=W>>>4,W|=W>>>8,W|=W>>>16,W++),W}function V(W,J){return W<=0||J.length===0&&J.ended?0:J.objectMode?1:W!==W?J.flowing&&J.length?J.buffer.head.data.length:J.length:(W>J.highWaterMark&&(J.highWaterMark=ne(W)),W<=J.length?W:J.ended?J.length:(J.needReadable=!0,0))}T.prototype.read=function(W){E("read",W),W=parseInt(W,10);var J=this._readableState,re=W;if(W!==0&&(J.emittedReadable=!1),W===0&&J.needReadable&&(J.length>=J.highWaterMark||J.ended))return E("read: emitReadable",J.length,J.ended),J.length===0&&J.ended?ke(this):ie(this),null;if(W=V(W,J),W===0&&J.ended)return J.length===0&&ke(this),null;var Ee=J.needReadable;E("need readable",Ee),(J.length===0||J.length-W<J.highWaterMark)&&(Ee=!0,E("length less than watermark",Ee)),J.ended||J.reading?(Ee=!1,E("reading or ended",Ee)):Ee&&(E("do read"),J.reading=!0,J.sync=!0,J.length===0&&(J.needReadable=!0),this._read(J.highWaterMark),J.sync=!1,J.reading||(W=V(re,J)));var Te;return W>0?Te=ae(W,J):Te=null,Te===null?(J.needReadable=!0,W=0):J.length-=W,J.length===0&&(J.ended||(J.needReadable=!0),re!==W&&J.ended&&ke(this)),Te!==null&&this.emit("data",Te),Te};function X(W,J){var re=null;return!h.isBuffer(J)&&typeof J!="string"&&J!==null&&J!==void 0&&!W.objectMode&&(re=new TypeError("Invalid non-string/buffer chunk")),re}function Q(W,J){if(!J.ended){if(J.decoder){var re=J.decoder.end();re&&re.length&&(J.buffer.push(re),J.length+=J.objectMode?1:re.length)}J.ended=!0,ie(W)}}function ie(W){var J=W._readableState;J.needReadable=!1,J.emittedReadable||(E("emitReadable",J.flowing),J.emittedReadable=!0,J.sync?o(pe,W):pe(W))}function pe(W){E("emit readable"),W.emit("readable"),q(W)}function de(W,J){J.readingMore||(J.readingMore=!0,o(F,W,J))}function F(W,J){for(var re=J.length;!J.reading&&!J.flowing&&!J.ended&&J.length<J.highWaterMark&&(E("maybeReadMore read 0"),W.read(0),re!==J.length);)re=J.length;J.readingMore=!1}T.prototype._read=function(W){this.emit("error",new Error("_read() is not implemented"))},T.prototype.pipe=function(W,J){var re=this,Ee=this._readableState;switch(Ee.pipesCount){case 0:Ee.pipes=W;break;case 1:Ee.pipes=[Ee.pipes,W];break;default:Ee.pipes.push(W);break}Ee.pipesCount+=1,E("pipe count=%d opts=%j",Ee.pipesCount,J);var Te=(!J||J.end!==!1)&&W!==a.stdout&&W!==a.stderr,Ie=Te?Ke:ft;Ee.endEmitted?o(Ie):re.once("end",Ie),W.on("unpipe",Ye);function Ye(Re){E("onunpipe"),Re===re&&ft()}function Ke(){E("onend"),W.end()}var St=H(re);W.on("drain",St);var _t=!1;function ft(){E("cleanup"),W.removeListener("close",te),W.removeListener("finish",we),W.removeListener("drain",St),W.removeListener("error",R),W.removeListener("unpipe",Ye),re.removeListener("end",Ke),re.removeListener("end",ft),re.removeListener("data",B),_t=!0,Ee.awaitDrain&&(!W._writableState||W._writableState.needDrain)&&St()}var ee=!1;re.on("data",B);function B(Re){E("ondata"),ee=!1;var It=W.write(Re);It===!1&&!ee&&((Ee.pipesCount===1&&Ee.pipes===W||Ee.pipesCount>1&&be(Ee.pipes,W)!==-1)&&!_t&&(E("false write response, pause",re._readableState.awaitDrain),re._readableState.awaitDrain++,ee=!0),re.pause())}function R(Re){E("onerror",Re),Ae(),W.removeListener("error",R),f(W,"error")===0&&W.emit("error",Re)}O(W,"error",R);function te(){W.removeListener("finish",we),Ae()}W.once("close",te);function we(){E("onfinish"),W.removeListener("close",te),Ae()}W.once("finish",we);function Ae(){E("unpipe"),re.unpipe(W)}return W.emit("pipe",re),Ee.flowing||(E("pipe resume"),re.resume()),W};function H(W){return function(){var J=W._readableState;E("pipeOnDrain",J.awaitDrain),J.awaitDrain&&J.awaitDrain--,J.awaitDrain===0&&f(W,"data")&&(J.flowing=!0,q(W))}}T.prototype.unpipe=function(W){var J=this._readableState;if(J.pipesCount===0)return this;if(J.pipesCount===1)return W&&W!==J.pipes?this:(W||(W=J.pipes),J.pipes=null,J.pipesCount=0,J.flowing=!1,W&&W.emit("unpipe",this),this);if(!W){var re=J.pipes,Ee=J.pipesCount;J.pipes=null,J.pipesCount=0,J.flowing=!1;for(var Te=0;Te<Ee;Te++)re[Te].emit("unpipe",this);return this}var Ie=be(J.pipes,W);return Ie===-1?this:(J.pipes.splice(Ie,1),J.pipesCount-=1,J.pipesCount===1&&(J.pipes=J.pipes[0]),W.emit("unpipe",this),this)},T.prototype.on=function(W,J){var re=u.prototype.on.call(this,W,J);if(W==="data")this._readableState.flowing!==!1&&this.resume();else if(W==="readable"){var Ee=this._readableState;!Ee.endEmitted&&!Ee.readableListening&&(Ee.readableListening=Ee.needReadable=!0,Ee.emittedReadable=!1,Ee.reading?Ee.length&&ie(this,Ee):o(Z,this))}return re},T.prototype.addListener=T.prototype.on;function Z(W){E("readable nexttick read 0"),W.read(0)}T.prototype.resume=function(){var W=this._readableState;return W.flowing||(E("resume"),W.flowing=!0,j(this,W)),this};function j(W,J){J.resumeScheduled||(J.resumeScheduled=!0,o($,W,J))}function $(W,J){J.reading||(E("resume read 0"),W.read(0)),J.resumeScheduled=!1,J.awaitDrain=0,W.emit("resume"),q(W),J.flowing&&!J.reading&&W.read(0)}T.prototype.pause=function(){return E("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(E("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function q(W){var J=W._readableState;for(E("flow",J.flowing);J.flowing&&W.read()!==null;);}T.prototype.wrap=function(W){var J=this._readableState,re=!1,Ee=this;W.on("end",function(){if(E("wrapped end"),J.decoder&&!J.ended){var Ye=J.decoder.end();Ye&&Ye.length&&Ee.push(Ye)}Ee.push(null)}),W.on("data",function(Ye){if(E("wrapped data"),J.decoder&&(Ye=J.decoder.write(Ye)),!(J.objectMode&&Ye==null)&&!(!J.objectMode&&(!Ye||!Ye.length))){var Ke=Ee.push(Ye);Ke||(re=!0,W.pause())}});for(var Te in W)this[Te]===void 0&&typeof W[Te]=="function"&&(this[Te]=function(Ye){return function(){return W[Ye].apply(W,arguments)}}(Te));var Ie=["error","close","destroy","pause","resume"];return se(Ie,function(Ye){W.on(Ye,Ee.emit.bind(Ee,Ye))}),Ee._read=function(Ye){E("wrapped _read",Ye),re&&(re=!1,W.resume())},Ee},T._fromList=ae;function ae(W,J){if(J.length===0)return null;var re;return J.objectMode?re=J.buffer.shift():!W||W>=J.length?(J.decoder?re=J.buffer.join(""):J.buffer.length===1?re=J.buffer.head.data:re=J.buffer.concat(J.length),J.buffer.clear()):re=le(W,J.buffer,J.decoder),re}function le(W,J,re){var Ee;return W<J.head.data.length?(Ee=J.head.data.slice(0,W),J.head.data=J.head.data.slice(W)):W===J.head.data.length?Ee=J.shift():Ee=re?fe(W,J):Se(W,J),Ee}function fe(W,J){var re=J.head,Ee=1,Te=re.data;for(W-=Te.length;re=re.next;){var Ie=re.data,Ye=W>Ie.length?Ie.length:W;if(Ye===Ie.length?Te+=Ie:Te+=Ie.slice(0,W),W-=Ye,W===0){Ye===Ie.length?(++Ee,re.next?J.head=re.next:J.head=J.tail=null):(J.head=re,re.data=Ie.slice(Ye));break}++Ee}return J.length-=Ee,Te}function Se(W,J){var re=g.allocUnsafe(W),Ee=J.head,Te=1;for(Ee.data.copy(re),W-=Ee.data.length;Ee=Ee.next;){var Ie=Ee.data,Ye=W>Ie.length?Ie.length:W;if(Ie.copy(re,re.length-W,0,Ye),W-=Ye,W===0){Ye===Ie.length?(++Te,Ee.next?J.head=Ee.next:J.head=J.tail=null):(J.head=Ee,Ee.data=Ie.slice(Ye));break}++Te}return J.length-=Te,re}function ke(W){var J=W._readableState;if(J.length>0)throw new Error('"endReadable()" called on non-empty stream');J.endEmitted||(J.ended=!0,o(xe,J,W))}function xe(W,J){!W.endEmitted&&W.length===0&&(W.endEmitted=!0,J.readable=!1,J.emit("end"))}function se(W,J){for(var re=0,Ee=W.length;re<Ee;re++)J(W[re],re)}function be(W,J){for(var re=0,Ee=W.length;re<Ee;re++)if(W[re]===J)return re;return-1}}).call(n,i(6))},function(r,n,i){(function(a){"use strict";!a.version||a.version.indexOf("v0.")===0||a.version.indexOf("v1.")===0&&a.version.indexOf("v1.8.")!==0?r.exports=o:r.exports=a.nextTick;function o(s,l,c,f){if(typeof s!="function")throw new TypeError('"callback" argument must be a function');var u=arguments.length,h,g;switch(u){case 0:case 1:return a.nextTick(s);case 2:return a.nextTick(function(){s.call(null,l)});case 3:return a.nextTick(function(){s.call(null,l,c)});case 4:return a.nextTick(function(){s.call(null,l,c,f)});default:for(h=new Array(u-1),g=0;g<h.length;)h[g++]=arguments[g];return a.nextTick(function(){s.apply(null,h)})}}}).call(n,i(6))},function(r,n){var i={}.toString;r.exports=Array.isArray||function(a){return i.call(a)=="[object Array]"}},function(r,n,i){(function(a){"use strict";var o=i(2),s=o.Buffer,l=o.SlowBuffer,c=o.kMaxLength||2147483647;n.alloc=function(u,h,g){if(typeof s.alloc=="function")return s.alloc(u,h,g);if(typeof g=="number")throw new TypeError("encoding must not be number");if(typeof u!="number")throw new TypeError("size must be a number");if(u>c)throw new RangeError("size is too large");var _=g,w=h;w===void 0&&(_=void 0,w=0);var E=new s(u);if(typeof w=="string")for(var S=new s(w,_),A=S.length,O=-1;++O<u;)E[O]=S[O%A];else E.fill(w);return E},n.allocUnsafe=function(u){if(typeof s.allocUnsafe=="function")return s.allocUnsafe(u);if(typeof u!="number")throw new TypeError("size must be a number");if(u>c)throw new RangeError("size is too large");return new s(u)},n.from=function(u,h,g){if(typeof s.from=="function"&&(!a.Uint8Array||Uint8Array.from!==s.from))return s.from(u,h,g);if(typeof u=="number")throw new TypeError('"value" argument must not be a number');if(typeof u=="string")return new s(u,h);if(typeof ArrayBuffer<"u"&&u instanceof ArrayBuffer){var _=h;if(arguments.length===1)return new s(u);typeof _>"u"&&(_=0);var w=g;if(typeof w>"u"&&(w=u.byteLength-_),_>=u.byteLength)throw new RangeError("'offset' is out of bounds");if(w>u.byteLength-_)throw new RangeError("'length' is out of bounds");return new s(u.slice(_,_+w))}if(s.isBuffer(u)){var E=new s(u.length);return u.copy(E,0,0,u.length),E}if(u){if(Array.isArray(u)||typeof ArrayBuffer<"u"&&u.buffer instanceof ArrayBuffer||"length"in u)return new s(u);if(u.type==="Buffer"&&Array.isArray(u.data))return new s(u.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},n.allocUnsafeSlow=function(u){if(typeof s.allocUnsafeSlow=="function")return s.allocUnsafeSlow(u);if(typeof u!="number")throw new TypeError("size must be a number");if(u>=c)throw new RangeError("size is too large");return new l(u)}}).call(n,function(){return this}())},function(r,n,i){(function(a){function o(T){return Array.isArray?Array.isArray(T):C(T)==="[object Array]"}n.isArray=o;function s(T){return typeof T=="boolean"}n.isBoolean=s;function l(T){return T===null}n.isNull=l;function c(T){return T==null}n.isNullOrUndefined=c;function f(T){return typeof T=="number"}n.isNumber=f;function u(T){return typeof T=="string"}n.isString=u;function h(T){return typeof T=="symbol"}n.isSymbol=h;function g(T){return T===void 0}n.isUndefined=g;function _(T){return C(T)==="[object RegExp]"}n.isRegExp=_;function w(T){return typeof T=="object"&&T!==null}n.isObject=w;function E(T){return C(T)==="[object Date]"}n.isDate=E;function S(T){return C(T)==="[object Error]"||T instanceof Error}n.isError=S;function A(T){return typeof T=="function"}n.isFunction=A;function O(T){return T===null||typeof T=="boolean"||typeof T=="number"||typeof T=="string"||typeof T=="symbol"||typeof T>"u"}n.isPrimitive=O,n.isBuffer=a.isBuffer;function C(T){return Object.prototype.toString.call(T)}}).call(n,i(1))},function(r,n){},function(r,n,i){"use strict";var a=i(2).Buffer,o=i(17);r.exports=s;function s(){this.head=null,this.tail=null,this.length=0}s.prototype.push=function(l){var c={data:l,next:null};this.length>0?this.tail.next=c:this.head=c,this.tail=c,++this.length},s.prototype.unshift=function(l){var c={data:l,next:this.head};this.length===0&&(this.tail=c),this.head=c,++this.length},s.prototype.shift=function(){if(this.length!==0){var l=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,l}},s.prototype.clear=function(){this.head=this.tail=null,this.length=0},s.prototype.join=function(l){if(this.length===0)return"";for(var c=this.head,f=""+c.data;c=c.next;)f+=l+c.data;return f},s.prototype.concat=function(l){if(this.length===0)return o.alloc(0);if(this.length===1)return this.head.data;for(var c=o.allocUnsafe(l>>>0),f=this.head,u=0;f;)f.data.copy(c,u),u+=f.data.length,f=f.next;return c}},function(r,n,i){"use strict";var a=Object.keys||function(S){var A=[];for(var O in S)A.push(O);return A};r.exports=g;var o=i(15),s=i(18);s.inherits=i(12);var l=i(14),c=i(22);s.inherits(g,l);for(var f=a(c.prototype),u=0;u<f.length;u++){var h=f[u];g.prototype[h]||(g.prototype[h]=c.prototype[h])}function g(S){if(!(this instanceof g))return new g(S);l.call(this,S),c.call(this,S),S&&S.readable===!1&&(this.readable=!1),S&&S.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,S&&S.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",_)}function _(){this.allowHalfOpen||this._writableState.ended||o(w,this)}function w(S){S.end()}function E(S,A){for(var O=0,C=S.length;O<C;O++)A(S[O],O)}},function(r,n,i){(function(a){"use strict";r.exports=A;var o=i(15),s=!a.browser&&["v0.10","v0.9."].indexOf(a.version.slice(0,5))>-1?setImmediate:o,l;A.WritableState=E;var c=i(18);c.inherits=i(12);var f={deprecate:i(23)},u;(function(){try{u=i(11)}catch{}finally{u||(u=i(8).EventEmitter)}})();var h=i(2).Buffer,g=i(17);c.inherits(A,u);function _(){}function w(j,$,q){this.chunk=j,this.encoding=$,this.callback=q,this.next=null}function E(j,$){l=l||i(21),j=j||{},this.objectMode=!!j.objectMode,$ instanceof l&&(this.objectMode=this.objectMode||!!j.writableObjectMode);var q=j.highWaterMark,ae=this.objectMode?16:16*1024;this.highWaterMark=q||q===0?q:ae,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var le=j.decodeStrings===!1;this.decodeStrings=!le,this.defaultEncoding=j.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(fe){V($,fe)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Z(this)}E.prototype.getBuffer=function(){for(var $=this.bufferedRequest,q=[];$;)q.push($),$=$.next;return q},function(){try{Object.defineProperty(E.prototype,"buffer",{get:f.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch{}}();var S;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(S=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(j){return S.call(this,j)?!0:j&&j._writableState instanceof E}})):S=function(j){return j instanceof this};function A(j){if(l=l||i(21),!S.call(A,this)&&!(this instanceof l))return new A(j);this._writableState=new E(j,this),this.writable=!0,j&&(typeof j.write=="function"&&(this._write=j.write),typeof j.writev=="function"&&(this._writev=j.writev)),u.call(this)}A.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function O(j,$){var q=new Error("write after end");j.emit("error",q),o($,q)}function C(j,$,q,ae){var le=!0,fe=!1;return q===null?fe=new TypeError("May not write null values to stream"):typeof q!="string"&&q!==void 0&&!$.objectMode&&(fe=new TypeError("Invalid non-string/buffer chunk")),fe&&(j.emit("error",fe),o(ae,fe),le=!1),le}A.prototype.write=function(j,$,q){var ae=this._writableState,le=!1,fe=h.isBuffer(j);return typeof $=="function"&&(q=$,$=null),fe?$="buffer":$||($=ae.defaultEncoding),typeof q!="function"&&(q=_),ae.ended?O(this,q):(fe||C(this,ae,j,q))&&(ae.pendingcb++,le=D(this,ae,fe,j,$,q)),le},A.prototype.cork=function(){var j=this._writableState;j.corked++},A.prototype.uncork=function(){var j=this._writableState;j.corked&&(j.corked--,!j.writing&&!j.corked&&!j.finished&&!j.bufferProcessing&&j.bufferedRequest&&ie(this,j))},A.prototype.setDefaultEncoding=function($){if(typeof $=="string"&&($=$.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf(($+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+$);return this._writableState.defaultEncoding=$,this};function T(j,$,q){return!j.objectMode&&j.decodeStrings!==!1&&typeof $=="string"&&($=g.from($,q)),$}function D(j,$,q,ae,le,fe){q||(ae=T($,ae,le),h.isBuffer(ae)&&(le="buffer"));var Se=$.objectMode?1:ae.length;$.length+=Se;var ke=$.length<$.highWaterMark;if(ke||($.needDrain=!0),$.writing||$.corked){var xe=$.lastBufferedRequest;$.lastBufferedRequest=new w(ae,le,fe),xe?xe.next=$.lastBufferedRequest:$.bufferedRequest=$.lastBufferedRequest,$.bufferedRequestCount+=1}else P(j,$,!1,Se,ae,le,fe);return ke}function P(j,$,q,ae,le,fe,Se){$.writelen=ae,$.writecb=Se,$.writing=!0,$.sync=!0,q?j._writev(le,$.onwrite):j._write(le,fe,$.onwrite),$.sync=!1}function z(j,$,q,ae,le){--$.pendingcb,q?o(le,ae):le(ae),j._writableState.errorEmitted=!0,j.emit("error",ae)}function ne(j){j.writing=!1,j.writecb=null,j.length-=j.writelen,j.writelen=0}function V(j,$){var q=j._writableState,ae=q.sync,le=q.writecb;if(ne(q),$)z(j,q,ae,$,le);else{var fe=pe(q);!fe&&!q.corked&&!q.bufferProcessing&&q.bufferedRequest&&ie(j,q),ae?s(X,j,q,fe,le):X(j,q,fe,le)}}function X(j,$,q,ae){q||Q(j,$),$.pendingcb--,ae(),F(j,$)}function Q(j,$){$.length===0&&$.needDrain&&($.needDrain=!1,j.emit("drain"))}function ie(j,$){$.bufferProcessing=!0;var q=$.bufferedRequest;if(j._writev&&q&&q.next){var ae=$.bufferedRequestCount,le=new Array(ae),fe=$.corkedRequestsFree;fe.entry=q;for(var Se=0;q;)le[Se]=q,q=q.next,Se+=1;P(j,$,!0,$.length,le,"",fe.finish),$.pendingcb++,$.lastBufferedRequest=null,fe.next?($.corkedRequestsFree=fe.next,fe.next=null):$.corkedRequestsFree=new Z($)}else{for(;q;){var ke=q.chunk,xe=q.encoding,se=q.callback,be=$.objectMode?1:ke.length;if(P(j,$,!1,be,ke,xe,se),q=q.next,$.writing)break}q===null&&($.lastBufferedRequest=null)}$.bufferedRequestCount=0,$.bufferedRequest=q,$.bufferProcessing=!1}A.prototype._write=function(j,$,q){q(new Error("_write() is not implemented"))},A.prototype._writev=null,A.prototype.end=function(j,$,q){var ae=this._writableState;typeof j=="function"?(q=j,j=null,$=null):typeof $=="function"&&(q=$,$=null),j!=null&&this.write(j,$),ae.corked&&(ae.corked=1,this.uncork()),!ae.ending&&!ae.finished&&H(this,ae,q)};function pe(j){return j.ending&&j.length===0&&j.bufferedRequest===null&&!j.finished&&!j.writing}function de(j,$){$.prefinished||($.prefinished=!0,j.emit("prefinish"))}function F(j,$){var q=pe($);return q&&($.pendingcb===0?(de(j,$),$.finished=!0,j.emit("finish")):de(j,$)),q}function H(j,$,q){$.ending=!0,F(j,$),q&&($.finished?o(q):j.once("finish",q)),$.ended=!0,j.writable=!1}function Z(j){var $=this;this.next=null,this.entry=null,this.finish=function(q){var ae=$.entry;for($.entry=null;ae;){var le=ae.callback;j.pendingcb--,le(q),ae=ae.next}j.corkedRequestsFree?j.corkedRequestsFree.next=$:j.corkedRequestsFree=$}}}).call(n,i(6))},function(r,n){(function(i){r.exports=a;function a(s,l){if(o("noDeprecation"))return s;var c=!1;function f(){if(!c){if(o("throwDeprecation"))throw new Error(l);o("traceDeprecation")?console.trace(l):console.warn(l),c=!0}return s.apply(this,arguments)}return f}function o(s){try{if(!i.localStorage)return!1}catch{return!1}var l=i.localStorage[s];return l==null?!1:String(l).toLowerCase()==="true"}}).call(n,function(){return this}())},function(r,n,i){var a=i(2).Buffer,o=a.isEncoding||function(h){switch(h&&h.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(h){if(h&&!o(h))throw new Error("Unknown encoding: "+h)}var l=n.StringDecoder=function(h){switch(this.encoding=(h||"utf8").toLowerCase().replace(/[-_]/,""),s(h),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=u;break;default:this.write=c;return}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};l.prototype.write=function(h){for(var g="";this.charLength;){var _=h.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:h.length;if(h.copy(this.charBuffer,this.charReceived,0,_),this.charReceived+=_,this.charReceived<this.charLength)return"";h=h.slice(_,h.length),g=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var E=g.charCodeAt(g.length-1);if(E>=55296&&E<=56319){this.charLength+=this.surrogateSize,g="";continue}if(this.charReceived=this.charLength=0,h.length===0)return g;break}this.detectIncompleteChar(h);var w=h.length;this.charLength&&(h.copy(this.charBuffer,0,h.length-this.charReceived,w),w-=this.charReceived),g+=h.toString(this.encoding,0,w);var w=g.length-1,E=g.charCodeAt(w);if(E>=55296&&E<=56319){var S=this.surrogateSize;return this.charLength+=S,this.charReceived+=S,this.charBuffer.copy(this.charBuffer,S,0,S),h.copy(this.charBuffer,0,0,S),g.substring(0,w)}return g},l.prototype.detectIncompleteChar=function(h){for(var g=h.length>=3?3:h.length;g>0;g--){var _=h[h.length-g];if(g==1&&_>>5==6){this.charLength=2;break}if(g<=2&&_>>4==14){this.charLength=3;break}if(g<=3&&_>>3==30){this.charLength=4;break}}this.charReceived=g},l.prototype.end=function(h){var g="";if(h&&h.length&&(g=this.write(h)),this.charReceived){var _=this.charReceived,w=this.charBuffer,E=this.encoding;g+=w.slice(0,_).toString(E)}return g};function c(h){return h.toString(this.encoding)}function f(h){this.charReceived=h.length%2,this.charLength=this.charReceived?2:0}function u(h){this.charReceived=h.length%3,this.charLength=this.charReceived?3:0}},function(r,n,i){"use strict";r.exports=c;var a=i(21),o=i(18);o.inherits=i(12),o.inherits(c,a);function s(u){this.afterTransform=function(h,g){return l(u,h,g)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function l(u,h,g){var _=u._transformState;_.transforming=!1;var w=_.writecb;if(!w)return u.emit("error",new Error("no writecb in Transform class"));_.writechunk=null,_.writecb=null,g!=null&&u.push(g),w(h);var E=u._readableState;E.reading=!1,(E.needReadable||E.length<E.highWaterMark)&&u._read(E.highWaterMark)}function c(u){if(!(this instanceof c))return new c(u);a.call(this,u),this._transformState=new s(this);var h=this;this._readableState.needReadable=!0,this._readableState.sync=!1,u&&(typeof u.transform=="function"&&(this._transform=u.transform),typeof u.flush=="function"&&(this._flush=u.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(g,_){f(h,g,_)}):f(h)})}c.prototype.push=function(u,h){return this._transformState.needTransform=!1,a.prototype.push.call(this,u,h)},c.prototype._transform=function(u,h,g){throw new Error("_transform() is not implemented")},c.prototype._write=function(u,h,g){var _=this._transformState;if(_.writecb=g,_.writechunk=u,_.writeencoding=h,!_.transforming){var w=this._readableState;(_.needTransform||w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}},c.prototype._read=function(u){var h=this._transformState;h.writechunk!==null&&h.writecb&&!h.transforming?(h.transforming=!0,this._transform(h.writechunk,h.writeencoding,h.afterTransform)):h.needTransform=!0};function f(u,h,g){if(h)return u.emit("error",h);g!=null&&u.push(g);var _=u._writableState,w=u._transformState;if(_.length)throw new Error("Calling transform done when ws.length != 0");if(w.transforming)throw new Error("Calling transform done when still transforming");return u.push(null)}},function(r,n,i){"use strict";r.exports=s;var a=i(25),o=i(18);o.inherits=i(12),o.inherits(s,a);function s(l){if(!(this instanceof s))return new s(l);a.call(this,l)}s.prototype._transform=function(l,c,f){f(null,l)}},function(r,n,i){r.exports=i(22)},function(r,n,i){r.exports=i(21)},function(r,n,i){r.exports=i(25)},function(r,n,i){r.exports=i(26)},function(r,n,i){"use strict";var a=i(32),o=i(33),s=i(38),l=i(39),c=i(40),f=i(41),u=i(42),h=Object.prototype.toString;function g(E){if(!(this instanceof g))return new g(E);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},E||{});var S=this.options;S.raw&&S.windowBits>=0&&S.windowBits<16&&(S.windowBits=-S.windowBits,S.windowBits===0&&(S.windowBits=-15)),S.windowBits>=0&&S.windowBits<16&&!(E&&E.windowBits)&&(S.windowBits+=32),S.windowBits>15&&S.windowBits<48&&(S.windowBits&15||(S.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var A=a.inflateInit2(this.strm,S.windowBits);if(A!==l.Z_OK)throw new Error(c[A]);this.header=new u,a.inflateGetHeader(this.strm,this.header)}g.prototype.push=function(E,S){var A=this.strm,O=this.options.chunkSize,C=this.options.dictionary,T,D,P,z,ne,V,X=!1;if(this.ended)return!1;D=S===~~S?S:S===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof E=="string"?A.input=s.binstring2buf(E):h.call(E)==="[object ArrayBuffer]"?A.input=new Uint8Array(E):A.input=E,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new o.Buf8(O),A.next_out=0,A.avail_out=O),T=a.inflate(A,l.Z_NO_FLUSH),T===l.Z_NEED_DICT&&C&&(typeof C=="string"?V=s.string2buf(C):h.call(C)==="[object ArrayBuffer]"?V=new Uint8Array(C):V=C,T=a.inflateSetDictionary(this.strm,V)),T===l.Z_BUF_ERROR&&X===!0&&(T=l.Z_OK,X=!1),T!==l.Z_STREAM_END&&T!==l.Z_OK)return this.onEnd(T),this.ended=!0,!1;A.next_out&&(A.avail_out===0||T===l.Z_STREAM_END||A.avail_in===0&&(D===l.Z_FINISH||D===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(P=s.utf8border(A.output,A.next_out),z=A.next_out-P,ne=s.buf2string(A.output,P),A.next_out=z,A.avail_out=O-z,z&&o.arraySet(A.output,A.output,P,z,0),this.onData(ne)):this.onData(o.shrinkBuf(A.output,A.next_out))),A.avail_in===0&&A.avail_out===0&&(X=!0)}while((A.avail_in>0||A.avail_out===0)&&T!==l.Z_STREAM_END);return T===l.Z_STREAM_END&&(D=l.Z_FINISH),D===l.Z_FINISH?(T=a.inflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===l.Z_OK):(D===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),A.avail_out=0),!0)},g.prototype.onData=function(E){this.chunks.push(E)},g.prototype.onEnd=function(E){E===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg};function _(E,S){var A=new g(S);if(A.push(E,!0),A.err)throw A.msg||c[A.err];return A.result}function w(E,S){return S=S||{},S.raw=!0,_(E,S)}n.Inflate=g,n.inflate=_,n.inflateRaw=w,n.ungzip=_},function(r,n,i){"use strict";var a=i(33),o=i(34),s=i(35),l=i(36),c=i(37),f=0,u=1,h=2,g=4,_=5,w=6,E=0,S=1,A=2,O=-2,C=-3,T=-4,D=-5,P=8,z=1,ne=2,V=3,X=4,Q=5,ie=6,pe=7,de=8,F=9,H=10,Z=11,j=12,$=13,q=14,ae=15,le=16,fe=17,Se=18,ke=19,xe=20,se=21,be=22,W=23,J=24,re=25,Ee=26,Te=27,Ie=28,Ye=29,Ke=30,St=31,_t=32,ft=852,ee=592,B=15,R=B;function te(Oe){return(Oe>>>24&255)+(Oe>>>8&65280)+((Oe&65280)<<8)+((Oe&255)<<24)}function we(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Ae(Oe){var tt;return!Oe||!Oe.state?O:(tt=Oe.state,Oe.total_in=Oe.total_out=tt.total=0,Oe.msg="",tt.wrap&&(Oe.adler=tt.wrap&1),tt.mode=z,tt.last=0,tt.havedict=0,tt.dmax=32768,tt.head=null,tt.hold=0,tt.bits=0,tt.lencode=tt.lendyn=new a.Buf32(ft),tt.distcode=tt.distdyn=new a.Buf32(ee),tt.sane=1,tt.back=-1,E)}function Re(Oe){var tt;return!Oe||!Oe.state?O:(tt=Oe.state,tt.wsize=0,tt.whave=0,tt.wnext=0,Ae(Oe))}function It(Oe,tt){var K,at;return!Oe||!Oe.state||(at=Oe.state,tt<0?(K=0,tt=-tt):(K=(tt>>4)+1,tt<48&&(tt&=15)),tt&&(tt<8||tt>15))?O:(at.window!==null&&at.wbits!==tt&&(at.window=null),at.wrap=K,at.wbits=tt,Re(Oe))}function Pt(Oe,tt){var K,at;return Oe?(at=new we,Oe.state=at,at.window=null,K=It(Oe,tt),K!==E&&(Oe.state=null),K):O}function Gt(Oe){return Pt(Oe,R)}var xr=!0,zt,Ei;function Xs(Oe){if(xr){var tt;for(zt=new a.Buf32(512),Ei=new a.Buf32(32),tt=0;tt<144;)Oe.lens[tt++]=8;for(;tt<256;)Oe.lens[tt++]=9;for(;tt<280;)Oe.lens[tt++]=7;for(;tt<288;)Oe.lens[tt++]=8;for(c(u,Oe.lens,0,288,zt,0,Oe.work,{bits:9}),tt=0;tt<32;)Oe.lens[tt++]=5;c(h,Oe.lens,0,32,Ei,0,Oe.work,{bits:5}),xr=!1}Oe.lencode=zt,Oe.lenbits=9,Oe.distcode=Ei,Oe.distbits=5}function Xo(Oe,tt,K,at){var Yt,rt=Oe.state;return rt.window===null&&(rt.wsize=1<<rt.wbits,rt.wnext=0,rt.whave=0,rt.window=new a.Buf8(rt.wsize)),at>=rt.wsize?(a.arraySet(rt.window,tt,K-rt.wsize,rt.wsize,0),rt.wnext=0,rt.whave=rt.wsize):(Yt=rt.wsize-rt.wnext,Yt>at&&(Yt=at),a.arraySet(rt.window,tt,K-at,Yt,rt.wnext),at-=Yt,at?(a.arraySet(rt.window,tt,K-at,at,0),rt.wnext=at,rt.whave=rt.wsize):(rt.wnext+=Yt,rt.wnext===rt.wsize&&(rt.wnext=0),rt.whave<rt.wsize&&(rt.whave+=Yt))),0}function he(Oe,tt){var K,at,Yt,rt,Pn,it,Dr,Fe,De,Zs,ir,ct,Zo,ja,Kt=0,xt,mr,Br,kr,Ji,Qo,Xt,Er,At=new a.Buf8(4),Wn,ui,Wu=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Oe||!Oe.state||!Oe.output||!Oe.input&&Oe.avail_in!==0)return O;K=Oe.state,K.mode===j&&(K.mode=$),Pn=Oe.next_out,Yt=Oe.output,Dr=Oe.avail_out,rt=Oe.next_in,at=Oe.input,it=Oe.avail_in,Fe=K.hold,De=K.bits,Zs=it,ir=Dr,Er=E;e:for(;;)switch(K.mode){case z:if(K.wrap===0){K.mode=$;break}for(;De<16;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}if(K.wrap&2&&Fe===35615){K.check=0,At[0]=Fe&255,At[1]=Fe>>>8&255,K.check=s(K.check,At,2,0),Fe=0,De=0,K.mode=ne;break}if(K.flags=0,K.head&&(K.head.done=!1),!(K.wrap&1)||(((Fe&255)<<8)+(Fe>>8))%31){Oe.msg="incorrect header check",K.mode=Ke;break}if((Fe&15)!==P){Oe.msg="unknown compression method",K.mode=Ke;break}if(Fe>>>=4,De-=4,Xt=(Fe&15)+8,K.wbits===0)K.wbits=Xt;else if(Xt>K.wbits){Oe.msg="invalid window size",K.mode=Ke;break}K.dmax=1<<Xt,Oe.adler=K.check=1,K.mode=Fe&512?H:j,Fe=0,De=0;break;case ne:for(;De<16;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}if(K.flags=Fe,(K.flags&255)!==P){Oe.msg="unknown compression method",K.mode=Ke;break}if(K.flags&57344){Oe.msg="unknown header flags set",K.mode=Ke;break}K.head&&(K.head.text=Fe>>8&1),K.flags&512&&(At[0]=Fe&255,At[1]=Fe>>>8&255,K.check=s(K.check,At,2,0)),Fe=0,De=0,K.mode=V;case V:for(;De<32;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}K.head&&(K.head.time=Fe),K.flags&512&&(At[0]=Fe&255,At[1]=Fe>>>8&255,At[2]=Fe>>>16&255,At[3]=Fe>>>24&255,K.check=s(K.check,At,4,0)),Fe=0,De=0,K.mode=X;case X:for(;De<16;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}K.head&&(K.head.xflags=Fe&255,K.head.os=Fe>>8),K.flags&512&&(At[0]=Fe&255,At[1]=Fe>>>8&255,K.check=s(K.check,At,2,0)),Fe=0,De=0,K.mode=Q;case Q:if(K.flags&1024){for(;De<16;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}K.length=Fe,K.head&&(K.head.extra_len=Fe),K.flags&512&&(At[0]=Fe&255,At[1]=Fe>>>8&255,K.check=s(K.check,At,2,0)),Fe=0,De=0}else K.head&&(K.head.extra=null);K.mode=ie;case ie:if(K.flags&1024&&(ct=K.length,ct>it&&(ct=it),ct&&(K.head&&(Xt=K.head.extra_len-K.length,K.head.extra||(K.head.extra=new Array(K.head.extra_len)),a.arraySet(K.head.extra,at,rt,ct,Xt)),K.flags&512&&(K.check=s(K.check,at,ct,rt)),it-=ct,rt+=ct,K.length-=ct),K.length))break e;K.length=0,K.mode=pe;case pe:if(K.flags&2048){if(it===0)break e;ct=0;do Xt=at[rt+ct++],K.head&&Xt&&K.length<65536&&(K.head.name+=String.fromCharCode(Xt));while(Xt&&ct<it);if(K.flags&512&&(K.check=s(K.check,at,ct,rt)),it-=ct,rt+=ct,Xt)break e}else K.head&&(K.head.name=null);K.length=0,K.mode=de;case de:if(K.flags&4096){if(it===0)break e;ct=0;do Xt=at[rt+ct++],K.head&&Xt&&K.length<65536&&(K.head.comment+=String.fromCharCode(Xt));while(Xt&&ct<it);if(K.flags&512&&(K.check=s(K.check,at,ct,rt)),it-=ct,rt+=ct,Xt)break e}else K.head&&(K.head.comment=null);K.mode=F;case F:if(K.flags&512){for(;De<16;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}if(Fe!==(K.check&65535)){Oe.msg="header crc mismatch",K.mode=Ke;break}Fe=0,De=0}K.head&&(K.head.hcrc=K.flags>>9&1,K.head.done=!0),Oe.adler=K.check=0,K.mode=j;break;case H:for(;De<32;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}Oe.adler=K.check=te(Fe),Fe=0,De=0,K.mode=Z;case Z:if(K.havedict===0)return Oe.next_out=Pn,Oe.avail_out=Dr,Oe.next_in=rt,Oe.avail_in=it,K.hold=Fe,K.bits=De,A;Oe.adler=K.check=1,K.mode=j;case j:if(tt===_||tt===w)break e;case $:if(K.last){Fe>>>=De&7,De-=De&7,K.mode=Te;break}for(;De<3;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}switch(K.last=Fe&1,Fe>>>=1,De-=1,Fe&3){case 0:K.mode=q;break;case 1:if(Xs(K),K.mode=xe,tt===w){Fe>>>=2,De-=2;break e}break;case 2:K.mode=fe;break;case 3:Oe.msg="invalid block type",K.mode=Ke}Fe>>>=2,De-=2;break;case q:for(Fe>>>=De&7,De-=De&7;De<32;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}if((Fe&65535)!==(Fe>>>16^65535)){Oe.msg="invalid stored block lengths",K.mode=Ke;break}if(K.length=Fe&65535,Fe=0,De=0,K.mode=ae,tt===w)break e;case ae:K.mode=le;case le:if(ct=K.length,ct){if(ct>it&&(ct=it),ct>Dr&&(ct=Dr),ct===0)break e;a.arraySet(Yt,at,rt,ct,Pn),it-=ct,rt+=ct,Dr-=ct,Pn+=ct,K.length-=ct;break}K.mode=j;break;case fe:for(;De<14;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}if(K.nlen=(Fe&31)+257,Fe>>>=5,De-=5,K.ndist=(Fe&31)+1,Fe>>>=5,De-=5,K.ncode=(Fe&15)+4,Fe>>>=4,De-=4,K.nlen>286||K.ndist>30){Oe.msg="too many length or distance symbols",K.mode=Ke;break}K.have=0,K.mode=Se;case Se:for(;K.have<K.ncode;){for(;De<3;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}K.lens[Wu[K.have++]]=Fe&7,Fe>>>=3,De-=3}for(;K.have<19;)K.lens[Wu[K.have++]]=0;if(K.lencode=K.lendyn,K.lenbits=7,Wn={bits:K.lenbits},Er=c(f,K.lens,0,19,K.lencode,0,K.work,Wn),K.lenbits=Wn.bits,Er){Oe.msg="invalid code lengths set",K.mode=Ke;break}K.have=0,K.mode=ke;case ke:for(;K.have<K.nlen+K.ndist;){for(;Kt=K.lencode[Fe&(1<<K.lenbits)-1],xt=Kt>>>24,mr=Kt>>>16&255,Br=Kt&65535,!(xt<=De);){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}if(Br<16)Fe>>>=xt,De-=xt,K.lens[K.have++]=Br;else{if(Br===16){for(ui=xt+2;De<ui;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}if(Fe>>>=xt,De-=xt,K.have===0){Oe.msg="invalid bit length repeat",K.mode=Ke;break}Xt=K.lens[K.have-1],ct=3+(Fe&3),Fe>>>=2,De-=2}else if(Br===17){for(ui=xt+3;De<ui;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}Fe>>>=xt,De-=xt,Xt=0,ct=3+(Fe&7),Fe>>>=3,De-=3}else{for(ui=xt+7;De<ui;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}Fe>>>=xt,De-=xt,Xt=0,ct=11+(Fe&127),Fe>>>=7,De-=7}if(K.have+ct>K.nlen+K.ndist){Oe.msg="invalid bit length repeat",K.mode=Ke;break}for(;ct--;)K.lens[K.have++]=Xt}}if(K.mode===Ke)break;if(K.lens[256]===0){Oe.msg="invalid code -- missing end-of-block",K.mode=Ke;break}if(K.lenbits=9,Wn={bits:K.lenbits},Er=c(u,K.lens,0,K.nlen,K.lencode,0,K.work,Wn),K.lenbits=Wn.bits,Er){Oe.msg="invalid literal/lengths set",K.mode=Ke;break}if(K.distbits=6,K.distcode=K.distdyn,Wn={bits:K.distbits},Er=c(h,K.lens,K.nlen,K.ndist,K.distcode,0,K.work,Wn),K.distbits=Wn.bits,Er){Oe.msg="invalid distances set",K.mode=Ke;break}if(K.mode=xe,tt===w)break e;case xe:K.mode=se;case se:if(it>=6&&Dr>=258){Oe.next_out=Pn,Oe.avail_out=Dr,Oe.next_in=rt,Oe.avail_in=it,K.hold=Fe,K.bits=De,l(Oe,ir),Pn=Oe.next_out,Yt=Oe.output,Dr=Oe.avail_out,rt=Oe.next_in,at=Oe.input,it=Oe.avail_in,Fe=K.hold,De=K.bits,K.mode===j&&(K.back=-1);break}for(K.back=0;Kt=K.lencode[Fe&(1<<K.lenbits)-1],xt=Kt>>>24,mr=Kt>>>16&255,Br=Kt&65535,!(xt<=De);){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}if(mr&&!(mr&240)){for(kr=xt,Ji=mr,Qo=Br;Kt=K.lencode[Qo+((Fe&(1<<kr+Ji)-1)>>kr)],xt=Kt>>>24,mr=Kt>>>16&255,Br=Kt&65535,!(kr+xt<=De);){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}Fe>>>=kr,De-=kr,K.back+=kr}if(Fe>>>=xt,De-=xt,K.back+=xt,K.length=Br,mr===0){K.mode=Ee;break}if(mr&32){K.back=-1,K.mode=j;break}if(mr&64){Oe.msg="invalid literal/length code",K.mode=Ke;break}K.extra=mr&15,K.mode=be;case be:if(K.extra){for(ui=K.extra;De<ui;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}K.length+=Fe&(1<<K.extra)-1,Fe>>>=K.extra,De-=K.extra,K.back+=K.extra}K.was=K.length,K.mode=W;case W:for(;Kt=K.distcode[Fe&(1<<K.distbits)-1],xt=Kt>>>24,mr=Kt>>>16&255,Br=Kt&65535,!(xt<=De);){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}if(!(mr&240)){for(kr=xt,Ji=mr,Qo=Br;Kt=K.distcode[Qo+((Fe&(1<<kr+Ji)-1)>>kr)],xt=Kt>>>24,mr=Kt>>>16&255,Br=Kt&65535,!(kr+xt<=De);){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}Fe>>>=kr,De-=kr,K.back+=kr}if(Fe>>>=xt,De-=xt,K.back+=xt,mr&64){Oe.msg="invalid distance code",K.mode=Ke;break}K.offset=Br,K.extra=mr&15,K.mode=J;case J:if(K.extra){for(ui=K.extra;De<ui;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}K.offset+=Fe&(1<<K.extra)-1,Fe>>>=K.extra,De-=K.extra,K.back+=K.extra}if(K.offset>K.dmax){Oe.msg="invalid distance too far back",K.mode=Ke;break}K.mode=re;case re:if(Dr===0)break e;if(ct=ir-Dr,K.offset>ct){if(ct=K.offset-ct,ct>K.whave&&K.sane){Oe.msg="invalid distance too far back",K.mode=Ke;break}ct>K.wnext?(ct-=K.wnext,Zo=K.wsize-ct):Zo=K.wnext-ct,ct>K.length&&(ct=K.length),ja=K.window}else ja=Yt,Zo=Pn-K.offset,ct=K.length;ct>Dr&&(ct=Dr),Dr-=ct,K.length-=ct;do Yt[Pn++]=ja[Zo++];while(--ct);K.length===0&&(K.mode=se);break;case Ee:if(Dr===0)break e;Yt[Pn++]=K.length,Dr--,K.mode=se;break;case Te:if(K.wrap){for(;De<32;){if(it===0)break e;it--,Fe|=at[rt++]<<De,De+=8}if(ir-=Dr,Oe.total_out+=ir,K.total+=ir,ir&&(Oe.adler=K.check=K.flags?s(K.check,Yt,ir,Pn-ir):o(K.check,Yt,ir,Pn-ir)),ir=Dr,(K.flags?Fe:te(Fe))!==K.check){Oe.msg="incorrect data check",K.mode=Ke;break}Fe=0,De=0}K.mode=Ie;case Ie:if(K.wrap&&K.flags){for(;De<32;){if(it===0)break e;it--,Fe+=at[rt++]<<De,De+=8}if(Fe!==(K.total&4294967295)){Oe.msg="incorrect length check",K.mode=Ke;break}Fe=0,De=0}K.mode=Ye;case Ye:Er=S;break e;case Ke:Er=C;break e;case St:return T;case _t:default:return O}return Oe.next_out=Pn,Oe.avail_out=Dr,Oe.next_in=rt,Oe.avail_in=it,K.hold=Fe,K.bits=De,(K.wsize||ir!==Oe.avail_out&&K.mode<Ke&&(K.mode<Te||tt!==g))&&Xo(Oe,Oe.output,Oe.next_out,ir-Oe.avail_out)?(K.mode=St,T):(Zs-=Oe.avail_in,ir-=Oe.avail_out,Oe.total_in+=Zs,Oe.total_out+=ir,K.total+=ir,K.wrap&&ir&&(Oe.adler=K.check=K.flags?s(K.check,Yt,ir,Oe.next_out-ir):o(K.check,Yt,ir,Oe.next_out-ir)),Oe.data_type=K.bits+(K.last?64:0)+(K.mode===j?128:0)+(K.mode===xe||K.mode===ae?256:0),(Zs===0&&ir===0||tt===g)&&Er===E&&(Er=D),Er)}function Xp(Oe){if(!Oe||!Oe.state)return O;var tt=Oe.state;return tt.window&&(tt.window=null),Oe.state=null,E}function Zp(Oe,tt){var K;return!Oe||!Oe.state||(K=Oe.state,!(K.wrap&2))?O:(K.head=tt,tt.done=!1,E)}function Qp(Oe,tt){var K=tt.length,at,Yt,rt;return!Oe||!Oe.state||(at=Oe.state,at.wrap!==0&&at.mode!==Z)?O:at.mode===Z&&(Yt=1,Yt=o(Yt,tt,K,0),Yt!==at.check)?C:(rt=Xo(Oe,tt,K,K),rt?(at.mode=St,T):(at.havedict=1,E))}n.inflateReset=Re,n.inflateReset2=It,n.inflateResetKeep=Ae,n.inflateInit=Gt,n.inflateInit2=Pt,n.inflate=he,n.inflateEnd=Xp,n.inflateGetHeader=Zp,n.inflateSetDictionary=Qp,n.inflateInfo="pako inflate (from Nodeca project)"},function(r,n){"use strict";var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(s){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var c=l.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var f in c)c.hasOwnProperty(f)&&(s[f]=c[f])}}return s},n.shrinkBuf=function(s,l){return s.length===l?s:s.subarray?s.subarray(0,l):(s.length=l,s)};var a={arraySet:function(s,l,c,f,u){if(l.subarray&&s.subarray){s.set(l.subarray(c,c+f),u);return}for(var h=0;h<f;h++)s[u+h]=l[c+h]},flattenChunks:function(s){var l,c,f,u,h,g;for(f=0,l=0,c=s.length;l<c;l++)f+=s[l].length;for(g=new Uint8Array(f),u=0,l=0,c=s.length;l<c;l++)h=s[l],g.set(h,u),u+=h.length;return g}},o={arraySet:function(s,l,c,f,u){for(var h=0;h<f;h++)s[u+h]=l[c+h]},flattenChunks:function(s){return[].concat.apply([],s)}};n.setTyped=function(s){s?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,a)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(i)},function(r,n){"use strict";function i(a,o,s,l){for(var c=a&65535|0,f=a>>>16&65535|0,u=0;s!==0;){u=s>2e3?2e3:s,s-=u;do c=c+o[l++]|0,f=f+c|0;while(--u);c%=65521,f%=65521}return c|f<<16|0}r.exports=i},function(r,n){"use strict";function i(){for(var s,l=[],c=0;c<256;c++){s=c;for(var f=0;f<8;f++)s=s&1?3988292384^s>>>1:s>>>1;l[c]=s}return l}var a=i();function o(s,l,c,f){var u=a,h=f+c;s^=-1;for(var g=f;g<h;g++)s=s>>>8^u[(s^l[g])&255];return s^-1}r.exports=o},function(r,n){"use strict";var i=30,a=12;r.exports=function(s,l){var c,f,u,h,g,_,w,E,S,A,O,C,T,D,P,z,ne,V,X,Q,ie,pe,de,F,H;c=s.state,f=s.next_in,F=s.input,u=f+(s.avail_in-5),h=s.next_out,H=s.output,g=h-(l-s.avail_out),_=h+(s.avail_out-257),w=c.dmax,E=c.wsize,S=c.whave,A=c.wnext,O=c.window,C=c.hold,T=c.bits,D=c.lencode,P=c.distcode,z=(1<<c.lenbits)-1,ne=(1<<c.distbits)-1;e:do{T<15&&(C+=F[f++]<<T,T+=8,C+=F[f++]<<T,T+=8),V=D[C&z];t:for(;;){if(X=V>>>24,C>>>=X,T-=X,X=V>>>16&255,X===0)H[h++]=V&65535;else if(X&16){Q=V&65535,X&=15,X&&(T<X&&(C+=F[f++]<<T,T+=8),Q+=C&(1<<X)-1,C>>>=X,T-=X),T<15&&(C+=F[f++]<<T,T+=8,C+=F[f++]<<T,T+=8),V=P[C&ne];r:for(;;){if(X=V>>>24,C>>>=X,T-=X,X=V>>>16&255,X&16){if(ie=V&65535,X&=15,T<X&&(C+=F[f++]<<T,T+=8,T<X&&(C+=F[f++]<<T,T+=8)),ie+=C&(1<<X)-1,ie>w){s.msg="invalid distance too far back",c.mode=i;break e}if(C>>>=X,T-=X,X=h-g,ie>X){if(X=ie-X,X>S&&c.sane){s.msg="invalid distance too far back",c.mode=i;break e}if(pe=0,de=O,A===0){if(pe+=E-X,X<Q){Q-=X;do H[h++]=O[pe++];while(--X);pe=h-ie,de=H}}else if(A<X){if(pe+=E+A-X,X-=A,X<Q){Q-=X;do H[h++]=O[pe++];while(--X);if(pe=0,A<Q){X=A,Q-=X;do H[h++]=O[pe++];while(--X);pe=h-ie,de=H}}}else if(pe+=A-X,X<Q){Q-=X;do H[h++]=O[pe++];while(--X);pe=h-ie,de=H}for(;Q>2;)H[h++]=de[pe++],H[h++]=de[pe++],H[h++]=de[pe++],Q-=3;Q&&(H[h++]=de[pe++],Q>1&&(H[h++]=de[pe++]))}else{pe=h-ie;do H[h++]=H[pe++],H[h++]=H[pe++],H[h++]=H[pe++],Q-=3;while(Q>2);Q&&(H[h++]=H[pe++],Q>1&&(H[h++]=H[pe++]))}}else if(X&64){s.msg="invalid distance code",c.mode=i;break e}else{V=P[(V&65535)+(C&(1<<X)-1)];continue r}break}}else if(X&64)if(X&32){c.mode=a;break e}else{s.msg="invalid literal/length code",c.mode=i;break e}else{V=D[(V&65535)+(C&(1<<X)-1)];continue t}break}}while(f<u&&h<_);Q=T>>3,f-=Q,T-=Q<<3,C&=(1<<T)-1,s.next_in=f,s.next_out=h,s.avail_in=f<u?5+(u-f):5-(f-u),s.avail_out=h<_?257+(_-h):257-(h-_),c.hold=C,c.bits=T}},function(r,n,i){"use strict";var a=i(33),o=15,s=852,l=592,c=0,f=1,u=2,h=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],_=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],w=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(S,A,O,C,T,D,P,z){var ne=z.bits,V=0,X=0,Q=0,ie=0,pe=0,de=0,F=0,H=0,Z=0,j=0,$,q,ae,le,fe,Se=null,ke=0,xe,se=new a.Buf16(o+1),be=new a.Buf16(o+1),W=null,J=0,re,Ee,Te;for(V=0;V<=o;V++)se[V]=0;for(X=0;X<C;X++)se[A[O+X]]++;for(pe=ne,ie=o;ie>=1&&se[ie]===0;ie--);if(pe>ie&&(pe=ie),ie===0)return T[D++]=1<<24|64<<16|0,T[D++]=1<<24|64<<16|0,z.bits=1,0;for(Q=1;Q<ie&&se[Q]===0;Q++);for(pe<Q&&(pe=Q),H=1,V=1;V<=o;V++)if(H<<=1,H-=se[V],H<0)return-1;if(H>0&&(S===c||ie!==1))return-1;for(be[1]=0,V=1;V<o;V++)be[V+1]=be[V]+se[V];for(X=0;X<C;X++)A[O+X]!==0&&(P[be[A[O+X]]++]=X);if(S===c?(Se=W=P,xe=19):S===f?(Se=h,ke-=257,W=g,J-=257,xe=256):(Se=_,W=w,xe=-1),j=0,X=0,V=Q,fe=D,de=pe,F=0,ae=-1,Z=1<<pe,le=Z-1,S===f&&Z>s||S===u&&Z>l)return 1;for(;;){re=V-F,P[X]<xe?(Ee=0,Te=P[X]):P[X]>xe?(Ee=W[J+P[X]],Te=Se[ke+P[X]]):(Ee=32+64,Te=0),$=1<<V-F,q=1<<de,Q=q;do q-=$,T[fe+(j>>F)+q]=re<<24|Ee<<16|Te|0;while(q!==0);for($=1<<V-1;j&$;)$>>=1;if($!==0?(j&=$-1,j+=$):j=0,X++,--se[V]===0){if(V===ie)break;V=A[O+P[X]]}if(V>pe&&(j&le)!==ae){for(F===0&&(F=pe),fe+=Q,de=V-F,H=1<<de;de+F<ie&&(H-=se[de+F],!(H<=0));)de++,H<<=1;if(Z+=1<<de,S===f&&Z>s||S===u&&Z>l)return 1;ae=j&le,T[ae]=pe<<24|de<<16|fe-D|0}}return j!==0&&(T[fe+j]=V-F<<24|64<<16|0),z.bits=pe,0}},function(r,n,i){"use strict";var a=i(33),o=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new a.Buf8(256),c=0;c<256;c++)l[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;l[254]=l[254]=1,n.string2buf=function(u){var h,g,_,w,E,S=u.length,A=0;for(w=0;w<S;w++)g=u.charCodeAt(w),(g&64512)===55296&&w+1<S&&(_=u.charCodeAt(w+1),(_&64512)===56320&&(g=65536+(g-55296<<10)+(_-56320),w++)),A+=g<128?1:g<2048?2:g<65536?3:4;for(h=new a.Buf8(A),E=0,w=0;E<A;w++)g=u.charCodeAt(w),(g&64512)===55296&&w+1<S&&(_=u.charCodeAt(w+1),(_&64512)===56320&&(g=65536+(g-55296<<10)+(_-56320),w++)),g<128?h[E++]=g:g<2048?(h[E++]=192|g>>>6,h[E++]=128|g&63):g<65536?(h[E++]=224|g>>>12,h[E++]=128|g>>>6&63,h[E++]=128|g&63):(h[E++]=240|g>>>18,h[E++]=128|g>>>12&63,h[E++]=128|g>>>6&63,h[E++]=128|g&63);return h};function f(u,h){if(h<65537&&(u.subarray&&s||!u.subarray&&o))return String.fromCharCode.apply(null,a.shrinkBuf(u,h));for(var g="",_=0;_<h;_++)g+=String.fromCharCode(u[_]);return g}n.buf2binstring=function(u){return f(u,u.length)},n.binstring2buf=function(u){for(var h=new a.Buf8(u.length),g=0,_=h.length;g<_;g++)h[g]=u.charCodeAt(g);return h},n.buf2string=function(u,h){var g,_,w,E,S=h||u.length,A=new Array(S*2);for(_=0,g=0;g<S;){if(w=u[g++],w<128){A[_++]=w;continue}if(E=l[w],E>4){A[_++]=65533,g+=E-1;continue}for(w&=E===2?31:E===3?15:7;E>1&&g<S;)w=w<<6|u[g++]&63,E--;if(E>1){A[_++]=65533;continue}w<65536?A[_++]=w:(w-=65536,A[_++]=55296|w>>10&1023,A[_++]=56320|w&1023)}return f(A,_)},n.utf8border=function(u,h){var g;for(h=h||u.length,h>u.length&&(h=u.length),g=h-1;g>=0&&(u[g]&192)===128;)g--;return g<0||g===0?h:g+l[u[g]]>h?g:h}},function(r,n){"use strict";r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(r,n){"use strict";r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(r,n){"use strict";function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=i},function(r,n){"use strict";function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=i}])})}}),wg=class{constructor(e=this.onOpen,t=null,r=null){this.onOpen=e,this.notes=[],t!==null&&document.getElementById(t).addEventListener("click",this.saveCSV),r!==null&&document.getElementById(r).addEventListener("click",this.openCSV)}processArraysForCSV(e=["1|2|3","3|2|1"],t="|",r="a,b,c",n=!1){let i=r+`
`,a=0;return e.forEach((o,s)=>{e[s]==="string"&&t!==","?i+=o.split(t).join(","):csvData+=o.join(","),n===!0&&this.notes[a].idx===s&&(o+=this.notes[a].text,a++),o.indexOf(`
`)<0&&(i+=`
`)}),i}static saveCSV(e=`a,b,c
1,2,3
3,2,1
`,t=new Date().toISOString()){var r=document.createElement("a");r.href="data:text/csv;charset=utf-8,"+encodeURI(e),r.target="_blank",t!==""?r.download=t:r.download=new Date().toISOString()+".csv",r.click()}static openCSV(e=",",t=(r,n,i)=>i){return new Promise((r,n)=>{var i=document.createElement("input");i.accept=".csv",i.type="file",i.onchange=a=>{var o=a.target.files[0],s=new FileReader;s.onload=l=>{var c=l.target.result,f=c.split(`
`);let u=[];var h=[];f.pop(),f.forEach((g,_)=>{if(_==0)u=g.split(e);else{var w=g.split(e);h.push(w)}}),t(h,u,i.value),i.value="",r({data:h,header:u,filename:i.value})},s.readAsText(o)},i.click()})}static openCSVRaw(e=(t,r)=>r){return new Promise((t,r)=>{var n=document.createElement("input");n.accept=".csv",n.type="file",n.onchange=i=>{var a=i.target.files[0],o=new FileReader;o.onload=s=>{var l=s.target.result;e(l,n.value),n.value="",t({data:l,filename:n.value})},o.readAsText(a)},n.click()})}onOpen(e=[],t=[]){console.log("CSV Opened!",t,e)}},eE=(e,t,r,n=!0,i=(a,o,s)=>{let l={filename:o},c=s;typeof s=="string"&&(c=s.split(",")),l.header=c;for(let f=0;f<a.length;f++){let u=a[f].split(",");for(let h=0;h<u.length;h++)l[c[h]]||(l[c[h]]=[]),l[c[h]].push(u[h])}return l})=>{let a;return e.includes("\r")?a=e.split(`\r
`):a=e.split(`
`),r||(r=a[0]),a.shift(),n===!1&&a.pop(),i(a,t,r)};function Zk(e){e=new Date(e);var t=a=>("0"+a).slice(-2),r=a=>("00"+a).slice(-3),n=e.getTimezoneOffset(),i=n<0?"+":"-";return n=Math.abs(n),e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"T"+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+r(e.getMilliseconds())+"(UTC"+i+t(n/60|0)+":00)"}var c_=see(lee()),Zn=!1,Dt=c_.BFSRequire("fs"),rCe=c_.BFSRequire("buffer").Buffer,l_,gi=async(e=["data"],t=(i=[])=>{},r=i=>{},n="IndexedDB")=>Zn?(l_&&await l_,!0):(Zn=!0,l_=new Promise((i,a)=>{c_.FileSystem[n].Create({},(o,s)=>{if(o){a(o);return}if(!s){r(o),a(new Error("Error creating BrowserFS"));return}c_.initialize(s);let l=[];e.forEach(async c=>{l.push(yi(Dt,c))}),Promise.all(l).then(c=>{t(c),i(!0)})})}),await l_),u_=async(e="")=>(Zn?await yi(Dt,e.split("/")[0]):await gi([e.split("/")[0]]),await new Promise(t=>{Dt.exists("/"+e,function(r){t(r)})})),cee=async(e="data")=>(Zn?await yi(Dt,e.split("/")[0]):await gi([e.split("/")[0]]),await new Promise(t=>{Dt.readFile("/"+e,function(r,n){t(n)})}));async function FB(e="data",t=0,r=5120,n=i=>{}){if(Zn?await yi(Dt,e.split("/")[0]):await gi([e.split("/")[0]]),e!="")return await new Promise(async(i,a)=>{Dt.open("/"+e,"r",(o,s)=>{if(o){a(o);return}Dt.read(s,r,t,"utf-8",(l,c,f)=>{if(l){a(l);return}if(f!==0){let u=c.toString();Dt.close(s,()=>{n(u,e),i(u)})}else i(void 0)})})});console.error("Path name is not defined")}var uee=async(e="data",t=r=>{})=>(Zn?await yi(Dt,e):await gi([e]),await new Promise((r,n)=>{Dt.readdir("/"+e,(i,a)=>{if(i){n(i);return}a?(t(a),r(a)):r(void 0)})})),f_=async(e,t,r=n=>{})=>(Zn?await yi(Dt,e.split("/")[0]):await gi([e.split("/")[0]]),await new Promise((n,i)=>{Dt.writeFile("/"+e,t,a=>{if(a){i(a);return}r(t),n(!0)})})),Qk=async(e,t,r=n=>{})=>(Zn?await yi(Dt,e.split("/")[0]):await gi([e.split("/")[0]]),await new Promise((n,i)=>{Dt.appendFile("/"+e,t,a=>{if(a){i(a);return}r(t),n(!0)})})),DB=async(e="data",t=()=>{})=>(Zn?await yi(Dt,e.split("/")[0]):await gi([e.split("/")[0]]),await new Promise(r=>{e!=""?Dt.unlink("/"+e,n=>{n&&console.error(n),t(),r(!0)}):(console.error("Path name is not defined"),r(!1))})),fee=async(e="data",t="end",r=0,n=(i,a)=>{})=>(Zn?await yi(Dt,e.split("/")[0]):await gi([e.split("/")[0]]),await new Promise(async(i,a)=>{let o=await d_(e);(t==="end"||typeof t=="number"&&t>o)&&(t=o),Dt.open("/"+e,"r",(s,l)=>{if(s){a(s);return}Dt.read(l,t,r,"utf-8",(c,f,u)=>{if(c){a(c);return}if(u!==0){let h=f.toString();Dt.close(l,()=>{n(h,e),i(h)})}else i(void 0)})})})),BB=async(e="data",t=r=>{})=>(Zn?await yi(Dt,e):await gi([e]),await new Promise((r,n)=>{Dt.readdir("/"+e,(i,a)=>{if(i){n(i);return}a&&t(a),r(a)})})),d_=async(e="data",t=r=>{})=>(Zn?await yi(Dt,e.split("/")[0]):await gi([e.split("/")[0]]),await new Promise((r,n)=>{Dt.stat("/"+e,(i,a)=>{if(i){n(i);return}let o=a.size;t(o),r(o)})})),p_=async(e="data",t=(r,n)=>{})=>(Zn?await yi(Dt,e.split("/")[0]):await gi([e.split("/")[0]]),await new Promise((r,n)=>{Dt.open("/"+e,"r",(i,a)=>{if(i){n(i);return}Dt.read(a,65535,0,"utf-8",(o,s,l)=>{if(o){n(o);return}if(l!==0){let u=s.toString().split(`
`)[0];Dt.close(a,()=>{t(u,e),r(u)})}else r(void 0)})})})),RB=async(e="data",t=10)=>(Zn?await yi(Dt,e.split("/")[0]):await gi([e.split("/")[0]]),await new Promise((r,n)=>{e!=""?Dt.stat("/"+e,(i,a)=>{if(i){n(i);return}let o=a.size;Dt.open(e,"r",(s,l)=>{if(s){n(s);return}let c=0,f=t*1024*1024,u=f;if(o<f)u=o,Dt.read(l,u,0,"utf-8",(h,g,_)=>{if(h){n(h);return}_!==0&&wg.saveCSV(g.toString(),e.split("/")[1]),Dt.close(l),r(!0)});else{let h=async()=>{if(c<o){c+u>o&&(u=o-c);let g=0;Dt.read(l,u,c,"utf-8",(_,w,E)=>{if(_){n(_);return}E!==0&&(wg.saveCSV(w.toString(),e.split("/")[1]+"_"+g),c+=f,g++,h(),Dt.close(l),r(!0))})}}}})}):(console.error("File name is not defined."),r(!1))}));async function dee(e="data",t=(o,s,l,c)=>{},r=1e4,n=0,i="end",a={}){let o=await d_(e),s=n;return await new Promise((l,c)=>{let f=()=>{let u=s+r;u>o&&(u=o),MB(e,s,u,a).then(async h=>{await t(h,s,u,o),s=u,s!==o?f():l(!0)}).catch(c)};f()})}async function MB(e="data",t=0,r="end",n={}){Zn?await yi(Dt,e.split("/")[0]):await gi([e.split("/")[0]]);let i=n.transpose||!1,a=await p_(e);if(a)a=a.split(",");else return;let o=[],s=[],l=i?[]:{};a.forEach(h=>{h?(s.push(h),o.push(1)):o[o.length-1]++});let c=await d_(e);r==="end"?r=c:r>c&&(t=c-(r-t),r=c);let f=(await FB(e,t,r))?.split(`
`).slice(1,-1),u=h=>{try{h=JSON.parse(h)}catch{}return h};return f&&f.forEach((h,g)=>{let _=h.split(",");if(i){let w={};n.json&&_.forEach((E,S)=>{n.json?w[s[S]]=u(E):w[s[S]]=E}),l.push(w)}else _.forEach((w,E)=>{let S=s[E];l[S]||(l[S]=[]),n.json?l[S].push(u(w)):l[S].push(w)})}),l}var zf={},yi=async(e,t)=>(Zn||await gi([t]),await new Promise((r,n)=>{t||n(!1),zf[t]==="exists"||zf[t]==="created"?r():(t[0]==="/"&&(t=t.substring(1)),t||n(!1),e.exists(`/${t}`,i=>{i?(zf[t]="exists",r()):zf[t]==="creating"?r():(zf[t]="creating",e.mkdir(`/${t}`,1,a=>{if(a){n(a);return}zf[t]="created",setTimeout(r,500)}))}))})),tE={initFS:gi,dirExists:yi,exists:u_,readFile:cee,readFileChunk:FB,getFilenames:uee,writeFile:f_,appendFile:Qk,deleteFile:DB,readFileAsText:fee,getFileSize:d_,getCSVHeader:p_,listFiles:BB},xa={};function pee(e,t,r){return(1-r)*e+r*t}function Xk(e,t,r,n=!0){if(r<=2)return[e,t];let i=1/r,a=new Array(r);a[0]=e;for(let o=1;o<=r;o++)a[o]=pee(e,t,i*o),n&&(a[o]=Math.floor(a[o]));return a}var hee=async(e,t,r,n)=>{if(!t){let c=Object.keys(xa);c.length>0?t=c[c.length-1]:t=`csv${new Date().toISOString()}`}let i=xa[t];if(!i){let c=Array.from(Object.keys(e));c.indexOf("timestamp")>-1&&c.splice(c.indexOf("timestamp"),1),xa[t]={header:r||["timestamp","localized",...c],lastX:void 0,buffer:"",buffered:0,bufferSize:n?.bufferSize?n.bufferSize:0,toFixed:n?.toFixed?n.toFixed:0,xIncrement:n?.xIncrement?n.xIncrement:0},i=xa[t];let f=await p_(t).catch(()=>null);(!f||f!==i.header.join(","))&&(r=i.header)}if(!i.header||i.header?.length===0){let c=Array.from(Object.keys(e));c.indexOf("timestamp")>-1&&c.splice(c.indexOf("timestamp"),1),i.header=r||["timestamp","localized",...c]}else r&&(i.header=r);let a=1;for(let c in e){let f=e[c];i.header.indexOf(c)>-1&&f&&Array.isArray(f)&&f?.length>a&&(a=f?.length)}let o;if(i.xIncrement?i.lastX?e[i.header[2]]?Array.isArray(e[i.header[2]])?o=i.lastX+i.xIncrement*e[i.header[2]].length:o=i.lastX+i.xIncrement:e[i.header[0]]&&Array.isArray(e[i.header[0]])?o=i.lastX+i.xIncrement*e[i.header[0]].length:o=i.lastX+i.xIncrement:typeof e[i.header[0]]<"u"?o=e[i.header[0]]:(i.header[0].toLowerCase().includes("time")||i.header[0].toLowerCase().includes("unix"))&&(o=Date.now()):e[i.header[0]]?o=e[i.header[0]]:o=Date.now(),typeof i.lastX>"u"&&(i.lastX=Array.isArray(o)?o[0]:o),typeof o>"u")if(i.header[0].includes("time")){let c=Date.now();a===1?o=Date.now():(o=Xk(i.lastX,c,a),o.shift())}else{let c=i.lastX+1;a>1?(o=new Array(a).fill(""),o[a-1]=c):o=c}else a>1&&o?.length!==a&&(!Array.isArray(o)||o.length===1?(o=Xk(i.lastX,o,a,!0),o.shift()):(o=Xk(o[0],o[o.length-1],a,!0),o.shift()));let s=[];if(Array.isArray(o)){let c={};for(let f=0;f<o.length;f++){s.push([]);for(let u=0;u<i.header.length;u++){let h=e[i.header[u]];if(u===0){s[f][0]=o[f],i.header[u+1]==="localized"&&(u++,s[f][u]=Zk(o[f]));continue}h===void 0?s[f][u]="":Array.isArray(h)?h.length===o.length?s[f][u]=h[f]:i.header[u]in c?h.length===1&&f===o.length-1?s[f][u]=h[c[i.header[u]]]:Math.floor(h.length*f/o.length)>c[i.header[u]]?(c[i.header[u]]++,s[f][u]=h[c[i.header[u]]]):s[f][u]="":(c[i.header[u]]=f,h.length!==1&&(s[f][u]=h[f])):f===o.length-1?s[f][u]=h:s[f][u]="",typeof s[f][u]=="number"&&Math.floor(s[f][u])!==s[f][u]&&(s[f][u]=s[f][u].toFixed(xa[t].toFixed))}}}else{s.push([]);for(let c=0;c<i.header.length;c++){if(c===0){s[0][0]=o,i.header[c+1]==="localized"&&(c++,s[0][c]=Zk(o));continue}i.header[c]in e?s[0][c]=e[i.header[c]]:s[0][c]="",typeof s[0][c]=="number"&&Math.floor(s[0][c])!==s[0][c]&&(s[0][c]=s[0][c].toFixed(xa[t].toFixed))}}let l="";if(r&&(l+=r.join(",")+`
`),s.forEach(c=>{l+=(n?.json?c.map(f=>JSON.stringify(f)):c).join(",")+`
`,i.bufferSize&&i.buffered++}),i.lastX=s[s.length-1][0],i.bufferSize)if(i.buffer+=l,i.buffered>i.bufferSize){let c=new Promise((f,u)=>{u_(t).then(h=>{h?Qk(t,i.buffer,g=>{f(g)}):f_(t,i.buffer,g=>{f(g)})})});return await c,i.buffer="",i.buffered=0,c}else return await Promise.resolve(!0);else return await new Promise((c,f)=>{u_(t).then(u=>{u?Qk(t,l,h=>{c(h)}):f_(t,l,h=>{c(h)})})})},gee=(e,t)=>{xa[t]&&(xa[t].header=e)},yee=(e,t,r=5,n=0,i)=>{if(!xa[e])return t?.indexOf("timestamp")>1&&(t.splice(t.indexOf("timestamp"),1),t.unshift("timestamp")),(t?.[0].toLowerCase().includes("time")||t?.[0].toLowerCase().includes("unix"))&&t[1]!=="localized"&&t.splice(1,0,"localized"),xa[e]={header:t,lastX:t[1]==="localized"?Date.now():0,bufferSize:n,buffer:"",buffered:0,toFixed:r,xIncrement:i},new Promise((a,o)=>{u_(e).then(s=>{s||f_(e,xa[e].header?xa[e].header.join(",")+`
`:"",l=>{a(l)}).catch(o)})})},jB=(e,t=document.body)=>new Promise(async(r,n)=>{t.querySelector("#bfs"+e)&&t.querySelector("#bfs"+e)?.remove(),t.insertAdjacentHTML("beforeend",`<div id='bfs${e}' class='bfs${e}'></div>`);let i=t.querySelector("#bfs"+e);await BB(e).then(a=>{a.length===0?i.innerHTML="No Files!":a.forEach(o=>{i?.insertAdjacentHTML("beforeend",`<div id='${o}' class='bfsfilediv'>
                        <span class='bfsfiletitle'>Data: </span>
                        <span>${o}</span>
                        <button class='bfsdownloadbtn' id='download${o}'>Download CSV</button>
                        ${o.indexOf(".")>-1?`<button class='bfsdeletebtn' id='delete${o}'>Delete</button>`:""}
                    </div>`),document.getElementById(`delete${o}`)&&(document.getElementById(`delete${o}`).onclick=()=>{DB(e+"/"+o,()=>{jB(e,t)})}),document.getElementById(`download${o}`)&&(document.getElementById(`download${o}`).onclick=()=>{RB(e+"/"+o,10)})}),r(a)}).catch(n)}),$B={appendCSV:hee,updateCSVHeader:gee,createCSV:yee,visualizeDirectory:jB,openCSV:wg.openCSV,saveCSV:wg.saveCSV,openCSVRaw:wg.openCSVRaw,parseCSVData:eE,getCSVHeader:p_,writeToCSVFromDB:RB,readCSVChunkFromDB:MB,processCSVChunksFromDB:dee,toISOLocal:Zk};var mee=Object.create,hE=Object.defineProperty,vee=Object.getOwnPropertyDescriptor,GB=Object.getOwnPropertyNames,bee=Object.getPrototypeOf,_ee=Object.prototype.hasOwnProperty,wee=(e,t,r)=>t in e?hE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,See=(e=>typeof Mr<"u"?Mr:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof Mr<"u"?Mr:t)[r]}):e)(function(e){if(typeof Mr<"u")return Mr.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),xee=(e,t)=>function(){return t||(0,e[GB(e)[0]])((t={exports:{}}).exports,t),t.exports},kee=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of GB(t))!_ee.call(e,i)&&i!==r&&hE(e,i,{get:()=>t[i],enumerable:!(n=vee(t,i))||n.enumerable});return e},Eee=(e,t,r)=>(r=e!=null?mee(bee(e)):{},kee(t||!e||!e.__esModule?hE(r,"default",{value:e,enumerable:!0}):r,e)),Oee=(e,t,r)=>(wee(e,typeof t!="symbol"?t+"":t,r),r),Aee=xee({"node_modules/web-worker/cjs/browser.js"(e,t){t.exports=Worker}}),Iee=class{data={};triggers={};ctr=0;constructor(e){typeof e=="object"&&(this.data=e)}setState=e=>{Object.assign(this.data,e);let t=Object.getOwnPropertyNames(e);for(let r of t)this.triggerEvent(r,this.data[r]);if(this.triggers[Sg]){let r=i=>{i(e)},n=this.triggers[Sg].length;for(let i=n-1;i>=0;i--)r(this.triggers[Sg][i].onchange)}return this.data};setValue=(e,t)=>{this.data[e]=t,this.triggerEvent(e,t)};triggerEvent=(e,t)=>{if(this.triggers[e]){let r=i=>{i.onchange(t)},n=this.triggers[e].length;for(let i=n-1;i>=0;i--)r(this.triggers[e][i])}};subscribeState=e=>this.subscribeEvent(Sg,e);unsubscribeState=e=>this.unsubscribeEvent(Sg,e);subscribeEvent=(e,t,r,n)=>{if(e){r&&n&&!this.triggers[e]&&Object.defineProperty(this.data,e,{get:()=>r[n],set:a=>{r[n]=a},enumerable:!0,configurable:!0}),this.triggers[e]||(this.triggers[e]=[]);let i=this.ctr;return this.ctr++,this.triggers[e].push({sub:i,onchange:t}),i}else return};unsubscribeEvent=(e,t)=>{let r=this.triggers[e];if(r)if(t===void 0)delete this.triggers[e],delete this.data[e];else{let n,i=r.find((a,o)=>{if(a.sub===t)return n=o,!0});return i&&r.splice(n,1),Object.keys(r).length===0&&(delete this.triggers[e],delete this.data[e]),this.onRemoved&&this.onRemoved(i),!0}};subscribeEventOnce=(e,t)=>{let r,n=i=>{t(i),this.unsubscribeEvent(e,r)};return r=this.subscribeEvent(e,n),r};getEvent=(e,t)=>{for(let r in this.triggers[e])if(this.triggers[e][r].sub===t)return this.triggers[e][r]};getSnapshot=()=>{let e={};for(let t in this.data)e[t]=this.data[t]};onRemoved},Sg="*s",wt=new Iee,hr=class{__node={tag:`node${Math.floor(Math.random()*1e15)}`,unique:`${Math.floor(Math.random()*1e15)}`,state:wt};__children;__parent;__operator;__listeners;__props;__args;constructor(e,t,r){this.__setProperties(e,t,r)}__setProperties=(e,t,r)=>{if((()=>{let i=e;typeof e=="function"?lE(e)?e=new e:e={__operator:e,__node:{forward:!0,tag:e.name}}:typeof e=="string"&&r?.get(e)&&(e=r.get(e)),"__node"in e||(e.__node={}),e.__node.initial||(e.__node.initial=i)})(),typeof e=="object"){let i=()=>{e.__node?.state?this.__node.state=e.__node.state:r&&(e.__node.state=r.__node.state)},a=()=>{e.__props&&(typeof e.__props=="function"&&(e.__props=new e.__props),typeof e.__props=="object"&&this.__proxyObject(e.__props))},o=()=>{e.__node.tag||(e.__operator?.name?e.__node.tag=e.__operator.name:e.__node.tag=`node${Math.floor(Math.random()*1e15)}`)},s=()=>{typeof e.__node=="string"?r?.get(e.__node.tag)?e=r.get(e.__node.tag):e.__node={}:e.__node||(e.__node={}),r&&(e.__node.graph=r),e instanceof Mc&&(e.__node.source=e)},l=()=>{if(!e.__parent&&t&&(e.__parent=t),t?.__node&&!(t instanceof Mc||e instanceof Mc)&&(e.__node.tag=t.__node.tag+"."+e.__node.tag),t instanceof Mc&&e instanceof Mc&&(e.__node.loaders&&Object.assign(t.__node.loaders?t.__node.loaders:{},e.__node.loaders),t.__node.mapGraphs)){e.__node.nodes.forEach(g=>{t.set(e.__node.tag+"."+g.__node.tag,g)});let h=()=>{e.__node.nodes.forEach(g=>{t.__node.nodes.delete(e.__node.tag+"."+g.__node.tag)})};this.__addOndisconnected(h)}},c=()=>{if(typeof e.default=="function"&&!e.__operator&&(e.__operator=e.default),e.__operator){if(typeof e.__operator=="string"&&r){let h=r.get(e.__operator);h&&(e.__operator=h.__operator),!e.__node.tag&&e.__operator.name&&(e.__node.tag=e.__operator.name)}typeof e.__operator=="function"&&(e.__operator=this.__setOperator(e.__operator)),e.default&&(e.default=e.__operator)}},f=()=>{e.__node=Object.assign(this.__node,e.__node);let h=Object.getOwnPropertyNames(e).filter(g=>{if(!uE[g])return!0});for(let g of h)g in e&&(this[g]=e[g])},u=()=>{this.__onconnected&&(typeof this.__onconnected=="function"?this.__onconnected=this.__onconnected.bind(this):Array.isArray(this.__onconnected)&&(this.__onconnected=this.__onconnected.map(h=>h.bind(this))),typeof this.__ondisconnected=="function"?this.__ondisconnected=this.__ondisconnected.bind(this):Array.isArray(this.__ondisconnected)&&(this.__ondisconnected=this.__ondisconnected.map(h=>h.bind(this))))};i(),o(),a(),s(),l(),f(),u(),c()}};__subscribe=(e,t,r,n,i,a)=>{let o=(l,c=(u,h)=>h||u,f=e)=>{let u;if(a){let _=cE(f,a,this.__node.graph);f=_.__callback,u=_.__args}let h=this.__node.state.subscribeEvent(l,f,this,t),g=this.__node.state.getEvent(l,h);return this.__listeners||(this.__listeners={}),this.__listeners[l]=this.__node.state.triggers[l],g&&(g.source=this.__node.tag,t&&(g.key=t),g.target=c(e,n),r&&(g.subInput=r),a&&(g.arguments=a,g.__args=u),i&&(g.tkey=i),g.node=this,g.graph=this.__node.graph),h},s=l=>{let c=this.__node.graph.get(l);if(!c&&l.includes(".")){n=l.substring(0,l.lastIndexOf("."));let f=this.__node.graph.get(l.substring(0,n));i=l.lastIndexOf(".")+1,f&&typeof f[t]=="function"&&(l=(...u)=>f[i](...u))}else c.__operator&&(l=c.__operator,i="__operator")};if(t){if((!this.__node.localState||!this.__node.localState[t])&&this.__addLocalState(this,t),typeof e=="string"){if(i=e,n){if(this.__node.graph?.get(n)){let f=this.__node.graph?.get(n);if(typeof f[e]=="function"){let u=f[e];e=(...h)=>{u(...h)}}else{let u=e;e=g=>{f[u]=g}}}}else if(typeof this[e]=="function"){let f=this[e];e=(...u)=>{f(...u)}}else this.__node.graph?.get(e)&&s(e);if(typeof e!="function")return}let l,c=r?this.__node.unique+"."+t+"input":this.__node.unique+"."+t;return typeof e=="function"?l=o(c,(f,u)=>u||f,e):e?.__node&&(l=o(c,(f,u)=>u||f.__node.unique,(...f)=>{e.__operator&&e.__operator(...f)})),l}else{if(typeof e=="string"&&(this.__node.graph.get(e)&&(e=this.__node.graph.get(e)),i="__operator",typeof e!="object"))return;let l,c=r?this.__node.unique+"input":this.__node.unique;return typeof e=="function"?l=o(c,(f,u)=>u||f,e):e?.__node&&(l=o(c,(f,u)=>u||f.__node.unique,(...f)=>{e.__operator&&e.__operator(...f)})),l}};__unsubscribe=(e,t,r)=>t?this.__node.state.unsubscribeEvent(r?this.__node.unique+"."+t+"input":this.__node.unique+"."+t,e):this.__node.state.unsubscribeEvent(r?this.__node.unique+"input":this.__node.unique,e);__setOperator=e=>{e=e.bind(this),this.__args&&this.__node.graph&&(e=cE(e,this.__args,this.__node.graph).__callback);let t=`${this.__node.unique}input`;if(this.__operator=(...r)=>{this.__node.state.triggers[t]&&this.__node.state.setValue(t,r);let n=e(...r);return this.__node.state.triggers[this.__node.unique]&&(typeof n?.then=="function"?n.then(i=>{i!==void 0&&this.__node.state.setValue(this.__node.unique,i)}).catch(console.error):n!==void 0&&this.__node.state.setValue(this.__node.unique,n)),n},this.__parent instanceof hr&&!this.__subscribedToParent&&this.__parent.__operator){let r=this.__parent.__subscribe(this),n=()=>{this.__parent?.__unsubscribe(r),delete this.__subscribedToParent};this.__addOndisconnected(n),this.__subscribedToParent=!0}return this.__operator};__addLocalState=(e,t)=>{if(!e)return;this.__node.localState||(this.__node.localState={});let r=this.__node.localState,n=(i,a)=>{let o=this.__node.unique+"."+a,s=`${o}input`,l,c,f,u;if(typeof i[a]=="function"&&a!=="__operator")this.__props?.[a]?f=this.__props:f=r,l=()=>f[a],c=h=>{this.__props?.[a]||(h=h.bind(this)),f[a]=(...g)=>{this.__node.state.triggers[s]&&this.__node.state.setValue(s,g);let _=h(...g);return this.__node.state.triggers[o]&&(typeof _?.then=="function"?_.then(w=>{this.__node.state.triggerEvent(o,w)}).catch(console.error):this.__node.state.triggerEvent(o,_)),_}},r[a]=i[a].bind(this),u={get:l,set:c,enumerable:!0,configurable:!0};else{let h,g,_;this.__props?.[a]?_=this.__props:_=r,h=()=>_[a],g=w=>{_[a]=w,this.__node.state.triggers[o]&&this.__node.state.triggerEvent(o,w)},r[a]=i[a],u={get:h,set:g,enumerable:!0,configurable:!0}}if(Object.defineProperty(i,a,u),typeof this.__node.initial=="object"){let h=Object.getOwnPropertyDescriptor(this.__node.initial,a);(h===void 0||h?.configurable)&&Object.defineProperty(this.__node.initial,a,u)}};if(t)n(e,t);else for(let i in e)n(e,i)};__proxyObject=e=>{let t=Cee(e);for(let r of t){let n={get:()=>e[r],set:i=>{e[r]=i},enumerable:!0,configurable:!0};if(Object.defineProperty(this,r,n),typeof this.__node.initial=="object"){let i=Object.getOwnPropertyDescriptor(this.__node.initial,r);(i===void 0||i?.configurable)&&Object.defineProperty(this.__node.initial,r,n)}}};__addOnconnected(e){e=e.bind(this),Array.isArray(this.__onconnected)?this.__onconnected.push(e):typeof this.__onconnected=="function"?this.__onconnected=[e,this.__onconnected]:this.__onconnected=e}__addOndisconnected(e){e=e.bind(this),Array.isArray(this.__ondisconnected)?this.__ondisconnected.push(e):typeof this.__ondisconnected=="function"?this.__ondisconnected=[e,this.__ondisconnected]:this.__ondisconnected=e}__callConnected(e=this){if(typeof this.__onconnected=="function")this.__onconnected(this);else if(Array.isArray(this.__onconnected)){let t=r=>{r(this)};this.__onconnected.forEach(t)}}__callDisconnected(e=this){if(typeof this.__ondisconnected=="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let t=r=>{r(this)};this.__ondisconnected.forEach(t)}}},Mc=class{__node={tag:`graph${Math.floor(Math.random()*1e15)}`,unique:`${Math.random()}`,nodes:new Map,state:wt,roots:{}};constructor(e){this.init(e)}init=e=>{if(e){let t=Object.assign({},e);delete t.roots,Og(this.__node,t),e.roots&&this.load(e.roots)}};load=e=>{function t(i,a,o=!0,s=!0){if(s&&(i?Object.assign(i,a):i=Object.assign({},a),t(i,a,!0,!1)),a?.__children&&!o)a.__children?.constructor.name==="Object"?i.__children?.constructor.name==="Object"?t(i.__children,a.__children,!0,!1):i.__children=t({},a.__children,!0,!1):i.__children=a.__children;else if(o)for(let l in a)i[l]=Object.assign({},a[l]),a[l]?.__children&&t({},a[l].__children,!1,!1);return i}this.__node.roots=t(this.__node.roots?this.__node.roots:{},e);let r=Object.assign({},e);r.__node&&delete r.__node;let n=this.recursiveSet(r,this,void 0,e);if(e.__node){if(!e.__node.tag)e.__node._tag=`roots${Math.floor(Math.random()*1e15)}`;else if(!this.get(e.__node.tag)){let i=new hr(e,this,this);this.set(i.__node.tag,i),this.runLoaders(i,this,e,e.__node.tag),i.__listeners&&(n[i.__node.tag]=i.__listeners)}}else e.__listeners&&this.setListeners(e.__listeners);return this.setListeners(n),r};setLoaders=(e,t)=>(t?this.__node.loaders=e:Object.assign(this.__node.loaders,e),this.__node.loaders);runLoaders=(e,t,r,n)=>{for(let i in this.__node.loaders)typeof this.__node.loaders[i]=="object"?(this.__node.loaders[i].init&&this.__node.loaders[i](e,t,this,this.__node.roots,r,n),this.__node.loaders[i].connected&&e.__addOnconnected(this.__node.loaders[i].connect),this.__node.loaders[i].disconnected&&e.__addOndisconnected(this.__node.loaders[i].disconnect)):typeof this.__node.loaders[i]=="function"&&this.__node.loaders[i](e,t,this,this.__node.roots,r,n)};add=(e,t)=>{let r={};typeof t=="string"&&(t=this.get(t));let n;if(typeof e=="function"?lE(e)?e.prototype instanceof hr?(e=e.prototype.constructor(e,t,this),n=!0):e=new e:e={__operator:e}:typeof e=="string"&&(e=this.__node.roots[e]),!!e){if(!n){let i=Object.getOwnPropertyNames(e),a=Object.getOwnPropertyNames(Object.getPrototypeOf(e));i.push(...a),i=i.filter(s=>!uE.includes(s));let o={};for(let s of i)o[s]=e[s];e=o}if(e.__node||(e.__node={}),e.__node.initial=e,typeof e=="object"&&!this.get(e.__node.tag)){let i,a=Og({},e,2);if(n?i=e:i=new hr(e,t,this),this.set(i.__node.tag,i),this.runLoaders(i,t,e,i.__node.tag),this.__node.roots[i.__node.tag]=a,i.__children&&(i.__children=Object.assign({},i.__children),this.recursiveSet(i.__children,i,r,i.__children)),i.__listeners){r[i.__node.tag]=Object.assign({},i.__listeners);for(let o in i.__listeners){let s=i.__listeners[o];i[o]&&(delete r[i.__node.tag][o],r[i.__node.tag][i.__node.tag+"."+o]=s),typeof s=="string"&&(i.__children?.[s]?r[i.__node.tag][o]=i.__node.tag+"."+s:t instanceof hr&&(t.__node.tag===s||t.__node.tag.includes(".")&&t.__node.tag.split(".").pop()===s)&&(r[i.__node.tag][o]=t.__node.tag))}}return this.setListeners(r),i.__callConnected(),i}else if(e.__node.tag)return this.get(e.__node.tag)}};recursiveSet=(e,t,r={},n)=>{let i=Object.getOwnPropertyNames(n),a=Object.getOwnPropertyNames(Object.getPrototypeOf(n)).filter(o=>!uE.includes(o));i.push(...a);for(let o of i){if(o.includes("__"))continue;let s=n[o];if(Array.isArray(s))continue;let l;if(typeof s=="function"?lE(s)?(s=new s,s instanceof hr&&(s=s.prototype.constructor(s,t,this),l=!0)):s={__operator:s}:typeof s=="string"?this.__node.nodes.get(s)?s=this.__node.nodes.get(s):s=this.__node.roots[s]:typeof s=="boolean"&&(this.__node.nodes.get(o)?s=this.__node.nodes.get(o):s=this.__node.roots[o]),s instanceof Object){if(!l&&!(s instanceof hr)){let h=Object.getOwnPropertyNames(s),g=Object.getOwnPropertyNames(Object.getPrototypeOf(s));g.splice(g.indexOf("constructor"),1),h.push(...g);let _={};for(let w of h)_[w]=s[w];s=_}if(s.__node||(s.__node={}),s.__node.tag||(s.__node.tag=o),s.__node.initial||(s.__node.initial=e[o]),this.get(s.__node.tag)&&!(!(t instanceof Mc)&&t?.__node)||t?.__node&&this.get(t.__node.tag+"."+s.__node.tag))continue;let c,f=!1,u=Og({},s,2);if(l||s instanceof hr?c=s:(c=new hr(s,t,this),f=!0),!f&&s instanceof hr&&!l&&t instanceof hr){let h=this.subscribe(t.__node.tag,c.__node.tag),g=_=>{this.unsubscribe(t.__node.tag,h)};c.__addOndisconnected(g)}else if(c){if(this.set(c.__node.tag,c),this.runLoaders(c,t,e[o],o),e[o]=c,this.__node.roots[c.__node.tag]=u,c.__children&&(c.__children=Object.assign({},c.__children),this.recursiveSet(c.__children,c,r,c.__children)),c.__listeners){r[c.__node.tag]=Object.assign({},c.__listeners);for(let h in c.__listeners){let g=c.__listeners[h],_=h;c[h]&&(delete r[c.__node.tag][h],_=c.__node.tag+"."+h,r[c.__node.tag][_]=g),typeof g=="string"&&(c.__children?.[g]?r[c.__node.tag][_]=c.__node.tag+"."+g:t instanceof hr&&(t.__node.tag===g||t.__node.tag.includes(".")&&t.__node.tag.split(".").pop()===g)&&(r[c.__node.tag][_]=t.__node.tag))}}c.__callConnected()}}}return r};remove=(e,t=!0)=>{if(this.unsubscribe(e),typeof e=="string"&&(e=this.get(e)),e instanceof hr){this.delete(e.__node.tag),delete this.__node.roots[e.__node.tag],t&&this.clearListeners(e),e.__callDisconnected();let r=n=>{for(let i in n)this.unsubscribe(n[i]),this.delete(n[i].__node.tag),delete this.__node.roots[n[i].__node.tag],this.delete(i),delete this.__node.roots[i],n[i].__node.tag=n[i].__node.tag.substring(n[i].__node.tag.lastIndexOf(".")+1),t&&this.clearListeners(n[i]),n[i].__callDisconnected(),n[i].__children&&r(n[i].__children)};e.__children&&r(e.__children)}return e?.__node.tag&&e?.__parent&&(delete e?.__parent,e.__node.tag=e.__node.tag.substring(e.__node.tag.indexOf(".")+1)),e?.__node.graph&&(e.__node.graph=void 0),e};run=(e,...t)=>{if(typeof e=="string"){let r=this.get(e);if(!r&&e.includes(".")){if(r=this.get(e.substring(0,e.lastIndexOf("."))),typeof r?.[e.substring(e.lastIndexOf(".")+1)]=="function")return r[e.substring(e.lastIndexOf(".")+1)](...t)}else if(r?.__operator)return r.__operator(...t)}if(e?.__operator)return e?.__operator(...t)};setListeners=e=>{for(let t in e){let r=this.get(t);if(typeof e[t]=="object")for(let n in e[t]){let i=this.get(n),a;if(typeof e[t][n]!="object")e[t][n]={__callback:e[t][n]};else if(!e[t][n].__callback)for(let o in e[t][n]){typeof e[t][n][o]!="object"&&(e[t][n][o]={__callback:e[t][n][o]},r.__operator&&(e[t][n][o].__callback===!0||typeof e[t][n][o].__callback>"u")&&(e[t][n][o].__callback=r.__operator));let s=this.get(o);if(s)a=this.subscribe(s,e[t][n][o].__callback,e[t][n].__args,void 0,e[t][n].inputState,t,n);else{let l=n.substring(0,n.lastIndexOf("."));if(s=this.get(l),s){let c=n.substring(n.lastIndexOf(".")+1);a=this.subscribe(s,e[t][n][o].__callback,e[t][n][o].__args,c,e[t][n][o].inputState,t,n)}}}if("__callback"in e[t][n])if(r&&((e[t][n].__callback===!0||typeof e[t][n].__callback>"u")&&(e[t][n].__callback=r.__operator),typeof e[t][n].__callback=="function"&&(e[t][n].__callback=e[t][n].__callback.bind(r))),i)a=this.subscribe(i,e[t][n].__callback,e[t][n].__args,void 0,e[t][n].inputState,t,n);else{let o=n.substring(0,n.lastIndexOf("."));i=this.get(o),i&&(a=this.subscribe(i,e[t][n].__callback,e[t][n].__args,n.substring(n.lastIndexOf(".")+1),e[t][n].inputState,t,n))}}}};clearListeners=(e,t)=>{if(typeof e=="string"&&(e=this.get(e)),e?.__listeners)for(let r in e.__listeners){if(t&&r!==t||typeof e.__listeners[r]?.sub!="number")continue;let n=this.get(r);if(n)if(typeof!e.__listeners[r]?.__callback=="number")for(let i in e.__listeners[r])e.__listeners[r][i]?.sub&&(this.unsubscribe(n,e.__listeners[r][i].sub,void 0,e.__listeners[r][i].inputState),e.__listeners[r][i].sub=void 0);else typeof e.__listeners[r]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r].sub,void 0,e.__listeners[r].inputState),e.__listeners[r].sub=void 0);else if(n=this.get(r.substring(0,r.lastIndexOf("."))),n)if(typeof e.__listeners[r]=="object"&&!e.__listeners[r]?.__callback)for(let i in e.__listeners[r])typeof e.__listeners[r][i]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r][i].sub,r.substring(r.lastIndexOf(".")+1),e.__listeners[r][i].inputState),e.__listeners[r][i].sub=void 0);else typeof e.__listeners[r]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r].sub,r.substring(r.lastIndexOf(".")+1),e.__listeners[r].inputState),e.__listeners[r].sub=void 0)}};get=e=>this.__node.nodes.get(e);set=(e,t)=>this.__node.nodes.set(e,t);delete=e=>this.__node.nodes.delete(e);getProps=(e,t)=>{if(typeof e=="string"&&(e=this.get(e)),e instanceof hr){let r;if(t)r=Object.assign({},this.__node.roots[e.__node.tag]);else{r=Object.assign({},e);for(let n in r)n.includes("__")&&delete r[n]}}};subscribe=(e,t,r,n,i,a,o,s)=>{let l=e;if(typeof e=="string"&&(l=this.get(e),!l&&e.includes(".")&&(l=this.get(e.substring(0,e.lastIndexOf("."))),n=e.substring(e.lastIndexOf(".")+1))),a instanceof hr&&(a=a.__node.tag),typeof t=="string"){let f=u=>{if(this.get(u)?.__operator){let h=this.get(u);a=u,u=function(...g){return h.__operator(...g)}}else if(u.includes(".")){a=u.substring(0,u.lastIndexOf("."));let h=this.get(a),g=u.substring(u.lastIndexOf(".")+1);s=g,typeof h[g]=="function"?h[g]instanceof hr?u=h[g]:u=function(..._){return h[g](..._)}:u=function(_){return h[g]=_,h[g]}}return u};if(a){let u=this.get(a);typeof u?.[t]=="function"?(s=t,t=function(...h){return u[n](...h)}):u[n]?(s=n,u[n]instanceof hr?t=u[n]:t=function(h){return u[n]=h,u[n]}):t=f(t)}else t=f(t)}let c;if(l instanceof hr){let f=()=>{c=l.__subscribe(t,n,i,a,s,r);let u=()=>{c!==void 0&&l.__unsubscribe(c,n,i),c=void 0};l.__addOndisconnected(()=>{u(),l.__addOnconnected(()=>{c===void 0&&l.__node.graph.__node.tag===this.__node.tag&&f()})}),typeof t=="string"&&this.get(t)&&(t=this.get(t)),t instanceof hr&&t.__addOndisconnected(()=>{u()})};f()}else if(typeof e=="string"){let f=this.get(e);if(f){if(t instanceof hr&&t.__operator){let u=()=>{c=f.__subscribe(t.__operator,n,i,a,s,r);let h=()=>{c!==void 0&&f.__unsubscribe(c,n,i)};f.__addOndisconnected(()=>{h(),f.__addOnconnected(()=>{c===void 0&&f.__node.graph.__node.tag===this.__node.tag&&u()})}),t.__addOndisconnected(h)};u()}else if(typeof t=="function"||typeof t=="string"){let u=()=>{c=f.__subscribe(t,n,i,a,s,r);let h=()=>{c!==void 0&&f.__unsubscribe(c,n,i),c=void 0};f.__addOndisconnected(()=>{h(),f.__addOnconnected(()=>{c===void 0&&f.__node.graph.__node.tag===this.__node.tag&&u()})}),typeof t=="string"&&this.get(t)&&this.get(t).__addOndisconnected(h)};u()}}else typeof t=="string"&&(t=this.__node.nodes.get(t).__operator),typeof t=="function"&&(c=this.__node.state.subscribeEvent(e,t))}return c};unsubscribe=(e,t,r,n)=>e instanceof hr?e.__unsubscribe(t,r,n):this.get(e)?.__unsubscribe(t,r,n);setState=e=>{this.__node.state.setState(e)}};function Og(e,t,r=1/0,n=0){for(let i in t)t[i]?.constructor.name==="Object"&&n<r?(n++,e[i]?.constructor.name==="Object"?Og(e[i],t[i],r,n):e[i]=Og({},t[i],r,n)):e[i]=t[i];return e}function Cee(e){var t=[],r=e;do{var n=Object.getOwnPropertyNames(r);let i=function(a){t.indexOf(a)===-1&&t.push(a)};n.forEach(i)}while(r=Object.getPrototypeOf(r));return t}function lE(e){return Tee(e)==="class"}function Tee(e){return typeof e=="function"?e.prototype?Object.getOwnPropertyDescriptor(e,"prototype")?.writable?"function":"class":e.constructor.name==="AsyncFunction"?"async":"arrow":""}var h_=(e,t)=>{if(t.get(e)?.__operator){let r=t.get(e);return(...n)=>{r.__operator(...n)}}else if(e.includes(".")){let r=e.split("."),n=r.pop(),i=r.join("."),a=t.get(i);return typeof t.get(i)?.[n]=="function"?(...o)=>a[n](...o):()=>a[n]}else if(t.get(e)){let r=t.get(e);return()=>r}else{let r=e;return()=>r}},cE=(e,t,r)=>{let n=[],i=(o,s)=>{if(o==="__output"||o==="__input"||o==="__callback")n[s]={__callback:l=>l,__args:void 0,idx:s};else if(typeof o=="string")n[s]={__callback:h_(o,r),__args:void 0,idx:s};else if(typeof o=="function"){let l=o;n[s]={__callback:(...c)=>l(...c),__args:void 0,idx:s}}else if(typeof o=="object"&&(o.__input||o.__callback)){let l=function(c){let f=c.__input?c.__input:c.__callback;if(typeof c.__input=="string"&&(f={__callback:h_(c.__input,r),__args:void 0,idx:s}),c.__args){let u=cE(f,c.__args,r);f={__callback:u.__callback,__args:u.__args,idx:s}}else f={__callback:f,__args:void 0,idx:s};if(c.__output){let u=c.__output;if(typeof c.__output=="string"?u={__callback:h_(u,r),__args:void 0,idx:s}:typeof o.__output=="object"&&(u=l(u)),typeof u?.__callback=="function"){let h=f.__callback,g=u.__callback;f={__callback:(..._)=>g(h(..._)),__args:u.__args,idx:s}}}return f};n[s]=l(o)}else{let l=o;n[s]={__callback:()=>l,__args:void 0,idx:s}}};t.forEach(i),typeof e=="string"&&(e={__callback:h_(e,r),__args:void 0});let a=typeof e=="function"?e:e.__callback;return e=function(...o){let s=c=>c.__callback(...o);return a(...n.map(s))},{__callback:e,__args:n}},uE=Object.getOwnPropertyNames(Object.getPrototypeOf({})),Nee=(e,t,r)=>{e.__node.backward&&t instanceof hr&&r.setListeners({[t.__node.tag]:{[e.__node.tag]:t}})},Lee=(e,t,r)=>{if(e.__operator&&!e.__node.looperSet){if(typeof e.__node.delay=="number"){let n=e.__operator;e.__setOperator((...i)=>new Promise((a,o)=>{setTimeout(async()=>{a(await n(...i))},e.__node.delay)}))}else if(e.__node.frame===!0){let n=e.__operator;e.__setOperator((...i)=>new Promise((a,o)=>{requestAnimationFrame(async()=>{a(await n(...i))})}))}if(typeof e.__node.repeat=="number"||typeof e.__node.recursive=="number"){let n=e.__operator;e.__setOperator(async(...i)=>{let a=e.__node.repeat?e.__node.repeat:e.__node.recursive,o,s=async(l,...c)=>{for(;l>0;){if(e.__node.delay||e.__node.frame){n(...c).then(async f=>{e.__node.recursive?await s(l,f):await s(l,...c)});break}else o=await n(...i);l--}};return await s(a,...i),o})}if(e.__node.loop&&typeof e.__node.loop=="number"){e.__node.looperSet=!0;let n=e.__operator,i=e.__node.loop;e.__setOperator((...o)=>{if("looping"in e.__node||(e.__node.looping=!0),e.__node.looping){let s=performance.now();n(...o),setTimeout(()=>{let c=performance.now()-s-e.__node.loop;c>0?i=e.__node.loop-c:i=e.__node.loop,i<=0&&(i=e.__node.loop),e.__operator(...o)},i)}}),e.__node.looping&&e.__operator();let a=o=>{o.__node.looping&&(o.__node.looping=!1)};e.__addOndisconnected(a)}}},Pee=(e,t,r)=>{if(e.__node.animate===!0||e.__animation){let n=e.__operator;e.__setOperator((...a)=>{"animating"in e.__node||(e.__node.animating=!0),e.__node.animating&&(typeof e.__animation=="function"?e.__animation(...a):n(...a),requestAnimationFrame(()=>{e.__operator(...a)}))}),(e.__node.animating||(!("animating"in e.__node)||e.__node.animating)&&e.__animation)&&setTimeout(()=>{requestAnimationFrame(e.__operator)},10);let i=a=>{a.__node.animating&&(a.__node.animating=!1)};e.__addOndisconnected(i)}},Fee=(e,t,r)=>{if(typeof e.__branch=="object"&&e.__operator&&!e.__branchApplied){let n=e.__operator;e.__branchApplied=!0,e.__operator=(...i)=>{let a=n(...i);for(let o in e.__branch){let s=()=>{typeof e.__branch[o].then=="function"?e.__branch[o].then(a):e.__branch[o].then instanceof hr&&e.__branch[o].then.__operator?e.__branch[o].then.__operator(a):a=e.__branch[o].then};typeof e.__branch[o].if=="function"?e.__branch[o].if(a)==!0&&s():e.__branch[o].if===a&&s()}return a}}if(e.__listeners){for(let n in e.__listeners)if(typeof e.__listeners[n]=="object"&&e.__listeners[n].branch&&!e.__listeners[n].branchApplied){let i=e.__listeners[n].callback;e.__listeners[n].branchApplied=!0,e.__listeners.callback=a=>{let o=()=>{typeof e.__listeners[n].branch.then=="function"?a=e.__listeners[n].branch.then(a):e.__listeners[n].branch.then instanceof hr&&e.__listeners[n].branch.then.__operator?a=e.__listeners[n].branch.then.__operator(a):a=e.__listeners[n].branch.then};return typeof e.__listeners[n].branch.if=="function"?e.__listeners[n].branch.if(a)&&o():e.__listeners[n].branch.if===a&&o(),i(a)}}}},Dee=(e,t,r)=>{if(e.__listeners)for(let n in e.__listeners)typeof e.__listeners[n]=="object"&&e.__listeners[n].oncreate&&e.__listeners[n].callback(e.__listeners[n].oncreate)},Bee=(e,t,r)=>{if(e.__listeners)for(let n in e.__listeners)typeof e.__listeners[n]=="object"&&typeof e.__listeners[n].binding=="object"&&(e.__listeners.callback=e.__listeners.callback.bind(e.__listeners[n].binding))},Ree=(e,t,r)=>{if(e.__listeners){for(let n in e.__listeners)if(typeof e.__listeners[n]=="object"&&typeof e.__listeners[n].transform=="function"&&!e.__listeners[n].transformApplied){let i=e.__listeners[n].callback;e.__listeners[n].transformApplied=!0,e.__listeners.callback=a=>(a=e.__listeners[n].transform(a),i(a))}}},Mee=(e,t,r)=>{e.post&&!e.__operator?e.__setOperator(e.post):!e.__operator&&typeof e.get=="function"&&e.__setOperator(e.get),!e.get&&e.__operator&&(e.get=e.__operator),e.aliases&&e.aliases.forEach(n=>{r.set(n,e);let i=a=>{r.__node.nodes.delete(n)};e.__addOndisconnected(i)}),typeof r.__node.roots?.[e.__node.tag]=="object"&&e.get&&(r.__node.roots[e.__node.tag].get=e.get)},UB={backprop:Nee,loop:Lee,animate:Pee,branching:Fee,triggerListenerOncreate:Dee,bindListener:Bee,transformListenerResult:Ree,substitute__operator:Mee};var jee=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(o,s){var l=t.length-1,c=t[l];if(typeof c=="object")if(c[o]===s||l===0)r.push(o),t.push(s.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[o]===s){l+=2,t.length=l,r.length=l,--l,t[l]=s,r[l]=o;break}l--}}function a(o,s){if(s!=null&&typeof s=="object"){o&&i(o,s);let l=e.get(s);if(l)return"[Circular Reference]"+l;e.set(s,r.join("."))}return s}return function(s,l){try{return t.push(s),JSON.stringify(s,a,l)}finally{n()}}}();JSON.stringifyWithCircularRefs===void 0&&(JSON.stringifyWithCircularRefs=jee);var $ee=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(o,s){var l=t.length-1;if(t[l]){var c=t[l];if(typeof c=="object")if(c[o]===s||l===0)r.push(o),t.push(s.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[o]===s){l+=2,t.length=l,r.length=l,--l,t[l]=s,r[l]=o;break}l++}}}function a(o,s){let l;if(s!=null)if(typeof s=="object"){let c=s.constructor.name;o&&c==="Object"&&i(o,s);let f=e.get(s);if(f)return"[Circular Reference]"+f;if(e.set(s,r.join(".")),c==="Array")s.length>20?l=s.slice(s.length-20):l=s;else if(c.includes("Set"))l=Array.from(s);else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean")l="instanceof_"+c;else if(c==="Object"){let u={};for(let h in s)if(s[h]==null)u[h]=s[h];else if(Array.isArray(s[h]))s[h].length>20?u[h]=s[h].slice(s[h].length-20):u[h]=s[h];else if(s[h].constructor.name==="Object"){u[h]={};for(let g in s[h])if(Array.isArray(s[h][g]))s[h][g].length>20?u[h][g]=s[h][g].slice(s[h][g].length-20):u[h][g]=s[h][g];else if(s[h][g]!=null){let _=s[h][g].constructor.name;_.includes("Set")?u[h][g]=Array.from(s[h][g]):_!=="Number"&&_!=="String"&&_!=="Boolean"?u[h][g]="instanceof_"+_:u[h][g]=s[h][g]}else u[h][g]=s[h][g]}else{let g=s[h].constructor.name;g.includes("Set")?u[h]=Array.from(s[h]):g!=="Number"&&g!=="String"&&g!=="Boolean"?u[h]="instanceof_"+g:u[h]=s[h]}l=u}else l=s}else l=s;return l}return function(s,l){t.push(s);let c=JSON.stringify(s,a,l);return n(),c}}();JSON.stringifyFast===void 0&&(JSON.stringifyFast=$ee);var Uee=class extends Mc{name=`service${Math.floor(Math.random()*1e15)}`;constructor(e){super({...e,loaders:e?.loaders?Object.assign({...UB},e.loaders):{...UB}}),e?.services&&this.addServices(e.services),this.load(this)}addServices=e=>{for(let t in e)if(typeof e[t]=="function"&&(e[t]=new e[t]),e[t]?.__node?.loaders&&Object.assign(this.__node.loaders,e[t].__node.loaders),e[t]?.__node?.nodes){e[t].__node.nodes.forEach((i,a)=>{this.get(a)?this.set(t+"."+a,i):this.set(a,i)}),this.__node.nodes.forEach((i,a)=>{e[t].__node.nodes.get(a)||e[t].__node.nodes.set(a,i)});let r=this.set;this.set=(i,a)=>(e[t].set(i,a),r(i,a));let n=this.delete;this.delete=i=>(e[t].delete(i),n(i))}else typeof e[t]=="object"&&this.load(e[t])};handleMethod=(e,t,r)=>{let n=t.toLowerCase(),i=this.__node.nodes.get(e);if(i||(i=this.__node.roots[e]),i?.[n])if(typeof i[n]!="function"){if(r){Array.isArray(r)&&r.length===1?i[n]=r[0]:i[n]=r;return}return i[n]}else return Array.isArray(r)?i[n](...r):i[n](r);else return this.handleServiceMessage({route:e,args:r,method:t})};handleServiceMessage(e){let t;return typeof e=="object"&&(e.route?t=e.route:e.node&&(t=e.node)),t?Array.isArray(e.args)?this.run(t,...e.args):this.run(t,e.args):e}handleGraphNodeCall(e,t){if(!e)return t;if(t?.args)this.handleServiceMessage(t);else return Array.isArray(t)?this.run(e,...t):this.run(e,t)}transmit=(...e)=>typeof e[0]=="object"?e[0].method?this.handleMethod(e[0].route,e[0].method,e[0].args):e[0].route?this.handleServiceMessage(e[0]):e[0].node?this.handleGraphNodeCall(e[0].node,e[0].args):(this.__node.keepState&&(e[0].route&&this.setState({[e[0].route]:e[0].args}),e[0].node&&this.setState({[e[0].node]:e[0].args})),e):e;receive=(...e)=>{if(e[0]&&typeof e[0]=="string"){let t=e[0].substring(0,8);(t.includes("{")||t.includes("["))&&(t.includes("\\")&&(e[0]=e[0].replace(/\\/g,"")),e[0][0]==='"'&&(e[0]=e[0].substring(1,e[0].length-1)),e[0]=JSON.parse(e[0]))}return typeof e[0]=="object"?e[0].method?this.handleMethod(e[0].route,e[0].method,e[0].args):e[0].route?this.handleServiceMessage(e[0]):e[0].node?this.handleGraphNodeCall(e[0].node,e[0].args):(this.__node.keepState&&(e[0].route&&this.setState({[e[0].route]:e[0].args}),e[0].node&&this.setState({[e[0].node]:e[0].args})),e):e};pipe=(e,t,r,n,i)=>{if(e instanceof hr)return i?this.subscribe(e,a=>{let o=i(a);o!==void 0?this.transmit({route:t,args:o,method:n}):this.transmit({route:t,args:a,method:n},r)}):this.subscribe(e,a=>{this.transmit({route:t,args:a,method:n},r)});if(typeof e=="string")return this.subscribe(e,a=>{this.transmit({route:t,args:a,method:n},r)})};pipeOnce=(e,t,r,n,i)=>{if(e instanceof hr)return i?e.__node.state.subscribeEventOnce(e.__node.unique,a=>{let o=i(a);o!==void 0?this.transmit({route:t,args:o,method:n}):this.transmit({route:t,args:a,method:n},r)}):this.__node.state.subscribeEventOnce(e.__node.unique,a=>{this.transmit({route:t,args:a,method:n},r)});if(typeof e=="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(e).__node.unique,a=>{this.transmit({route:t,args:a,method:n},r)})};terminate=(...e)=>{};isTypedArray=zee;recursivelyAssign=fE;spliceTypedArray=qee;ping=()=>(console.log("pinged!"),"pong");echo=(...e)=>(this.transmit(...e),e);log=(...e)=>(console.log(...e),!0);error=(...e)=>(console.error(...e),!0)};function zee(e){return ArrayBuffer.isView(e)&&Object.prototype.toString.call(e)!=="[object DataView]"}var fE=(e,t)=>{for(let r in t)t[r]?.constructor.name==="Object"&&!Array.isArray(t[r])?e[r]?.constructor.name==="Object"&&!Array.isArray(e[r])?fE(e[r],t[r]):e[r]=fE({},t[r]):e[r]=t[r];return e};function qee(e,t,r){let n=e.subarray(0,t),i;r&&(i=e.subarray(r+1));let a;return(n.length>0||i?.length>0)&&(a=new e.constructor(n.length+i.length)),a&&(n.length>0&&a.set(n),i&&i.length>0&&a.set(i,n.length)),a}function Vee(e,...t){return function(n=document.createElement("div")){let i=document.createElement("template");e.map(function(s,l){if(i.innerHTML+=s,t[l]instanceof HTMLElement){let c='<span id="dummyNode12345"></span>';c.id="dummyNode12345",i.innerHTML+=c}else i.innerHTML+=t[l]});let a=i.content.querySelectorAll("#dummyNode12345"),o=0;return t.forEach((s,l)=>{s instanceof HTMLElement&&(console.log(s,a[o]),i.content.replaceChild(s,a[o]),o++)}),n.appendChild(i.content),n}}var aCe=Vee``;var ge={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};ge.cipher.aes=function(e){this.s[0][0][0]||this.O();var t,r,n,i,a=this.s[0][4],o=this.s[1];t=e.length;var s=1;if(t!==4&&t!==6&&t!==8)throw new ge.exception.invalid("invalid aes key size");for(this.b=[n=e.slice(0),i=[]],e=t;e<4*t+28;e++)r=n[e-1],(e%t===0||t===8&&e%t===4)&&(r=a[r>>>24]<<24^a[r>>16&255]<<16^a[r>>8&255]<<8^a[r&255],e%t===0&&(r=r<<8^r>>>24^s<<24,s=s<<1^283*(s>>7))),n[e]=n[e-t]^r;for(t=0;e;t++,e--)r=n[t&3?e:e-4],i[t]=4>=e||4>t?r:o[0][a[r>>>24]]^o[1][a[r>>16&255]]^o[2][a[r>>8&255]]^o[3][a[r&255]]};ge.cipher.aes.prototype={encrypt:function(e){return zB(this,e,0)},decrypt:function(e){return zB(this,e,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var e=this.s[0],t=this.s[1],r=e[4],n=t[4],i,a,o,s=[],l=[],c,f,u,h;for(i=0;256>i;i++)l[(s[i]=i<<1^283*(i>>7))^i]=i;for(a=o=0;!r[a];a^=c||1,o=l[o]||1)for(u=o^o<<1^o<<2^o<<3^o<<4,u=u>>8^u&255^99,r[a]=u,n[u]=a,f=s[i=s[c=s[a]]],h=16843009*f^65537*i^257*c^16843008*a,f=257*s[u]^16843008*u,i=0;4>i;i++)e[i][a]=f=f<<24^f>>>8,t[i][u]=h=h<<24^h>>>8;for(i=0;5>i;i++)e[i]=e[i].slice(0),t[i]=t[i].slice(0)}};function zB(e,t,r){if(t.length!==4)throw new ge.exception.invalid("invalid aes block size");var n=e.b[r],i=t[0]^n[0],a=t[r?3:1]^n[1],o=t[2]^n[2];t=t[r?1:3]^n[3];var s,l,c,f=n.length/4-2,u,h=4,g=[0,0,0,0];s=e.s[r],e=s[0];var _=s[1],w=s[2],E=s[3],S=s[4];for(u=0;u<f;u++)s=e[i>>>24]^_[a>>16&255]^w[o>>8&255]^E[t&255]^n[h],l=e[a>>>24]^_[o>>16&255]^w[t>>8&255]^E[i&255]^n[h+1],c=e[o>>>24]^_[t>>16&255]^w[i>>8&255]^E[a&255]^n[h+2],t=e[t>>>24]^_[i>>16&255]^w[a>>8&255]^E[o&255]^n[h+3],h+=4,i=s,a=l,o=c;for(u=0;4>u;u++)g[r?3&-u:u]=S[i>>>24]<<24^S[a>>16&255]<<16^S[o>>8&255]<<8^S[t&255]^n[h++],s=i,i=a,a=o,o=t,t=s;return g}ge.bitArray={bitSlice:function(e,t,r){return e=ge.bitArray.$(e.slice(t/32),32-(t&31)).slice(1),r===void 0?e:ge.bitArray.clamp(e,r-t)},extract:function(e,t,r){var n=Math.floor(-t-r&31);return((t+r-1^t)&-32?e[t/32|0]<<32-n^e[t/32+1|0]>>>n:e[t/32|0]>>>n)&(1<<r)-1},concat:function(e,t){if(e.length===0||t.length===0)return e.concat(t);var r=e[e.length-1],n=ge.bitArray.getPartial(r);return n===32?e.concat(t):ge.bitArray.$(t,n,r|0,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return t===0?0:32*(t-1)+ge.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;e=e.slice(0,Math.ceil(t/32));var r=e.length;return t=t&31,0<r&&t&&(e[r-1]=ge.bitArray.partial(t,e[r-1]&2147483648>>t-1,1)),e},partial:function(e,t,r){return e===32?t:(r?t|0:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(ge.bitArray.bitLength(e)!==ge.bitArray.bitLength(t))return!1;var r=0,n;for(n=0;n<e.length;n++)r|=e[n]^t[n];return r===0},$:function(e,t,r,n){var i;for(i=0,n===void 0&&(n=[]);32<=t;t-=32)n.push(r),r=0;if(t===0)return n.concat(e);for(i=0;i<e.length;i++)n.push(r|e[i]>>>t),r=e[i]<<32-t;return i=e.length?e[e.length-1]:0,e=ge.bitArray.getPartial(i),n.push(ge.bitArray.partial(t+e&31,32<t+e?r:n.pop(),1)),n},i:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,r;for(t=0;t<e.length;++t)r=e[t],e[t]=r>>>24|r>>>8&65280|(r&65280)<<8|r<<24;return e}};ge.codec.utf8String={fromBits:function(e){var t="",r=ge.bitArray.bitLength(e),n,i;for(n=0;n<r/8;n++)!(n&3)&&(i=e[n/4]),t+=String.fromCharCode(i>>>8>>>8>>>8),i<<=8;return decodeURIComponent(escape(t))},toBits:function(e){e=unescape(encodeURIComponent(e));var t=[],r,n=0;for(r=0;r<e.length;r++)n=n<<8|e.charCodeAt(r),(r&3)===3&&(t.push(n),n=0);return r&3&&t.push(ge.bitArray.partial(8*(r&3),n)),t}};ge.codec.hex={fromBits:function(e){var t="",r;for(r=0;r<e.length;r++)t+=((e[r]|0)+0xf00000000000).toString(16).substr(4);return t.substr(0,ge.bitArray.bitLength(e)/4)},toBits:function(e){var t,r=[],n;for(e=e.replace(/\s|0x/g,""),n=e.length,e=e+"00000000",t=0;t<e.length;t+=8)r.push(parseInt(e.substr(t,8),16)^0);return ge.bitArray.clamp(r,4*n)}};ge.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(e,t,r){var n=ge.codec.base32.BASE,i=ge.codec.base32.REMAINING,a="",o=0,s=ge.codec.base32.B,l=0,c=ge.bitArray.bitLength(e);for(r&&(s=ge.codec.base32.X),r=0;a.length*n<c;)a+=s.charAt((l^e[r]>>>o)>>>i),o<n?(l=e[r]<<n-o,o+=i,r++):(l<<=n,o-=n);for(;a.length&7&&!t;)a+="=";return a},toBits:function(e,t){e=e.replace(/\s|=/g,"").toUpperCase();var r=ge.codec.base32.BITS,n=ge.codec.base32.BASE,i=ge.codec.base32.REMAINING,a=[],o,s=0,l=ge.codec.base32.B,c=0,f,u="base32";for(t&&(l=ge.codec.base32.X,u="base32hex"),o=0;o<e.length;o++){if(f=l.indexOf(e.charAt(o)),0>f){if(!t)try{return ge.codec.base32hex.toBits(e)}catch{}throw new ge.exception.invalid("this isn't "+u+"!")}s>i?(s-=i,a.push(c^f>>>s),c=f<<r-s):(s+=n,c^=f<<r-s)}return s&56&&a.push(ge.bitArray.partial(s&56,c,1)),a}};ge.codec.base32hex={fromBits:function(e,t){return ge.codec.base32.fromBits(e,t,1)},toBits:function(e){return ge.codec.base32.toBits(e,1)}};ge.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,r){var n="",i=0,a=ge.codec.base64.B,o=0,s=ge.bitArray.bitLength(e);for(r&&(a=a.substr(0,62)+"-_"),r=0;6*n.length<s;)n+=a.charAt((o^e[r]>>>i)>>>26),6>i?(o=e[r]<<6-i,i+=26,r++):(o<<=6,i-=6);for(;n.length&3&&!t;)n+="=";return n},toBits:function(e,t){e=e.replace(/\s|=/g,"");var r=[],n,i=0,a=ge.codec.base64.B,o=0,s;for(t&&(a=a.substr(0,62)+"-_"),n=0;n<e.length;n++){if(s=a.indexOf(e.charAt(n)),0>s)throw new ge.exception.invalid("this isn't base64!");26<i?(i-=26,r.push(o^s>>>i),o=s<<32-i):(i+=6,o^=s<<32-i)}return i&56&&r.push(ge.bitArray.partial(i&56,o,1)),r}};ge.codec.base64url={fromBits:function(e){return ge.codec.base64.fromBits(e,1,1)},toBits:function(e){return ge.codec.base64.toBits(e,1)}};ge.hash.sha256=function(e){this.b[0]||this.O(),e?(this.F=e.F.slice(0),this.A=e.A.slice(0),this.l=e.l):this.reset()};ge.hash.sha256.hash=function(e){return new ge.hash.sha256().update(e).finalize()};ge.hash.sha256.prototype={blockSize:512,reset:function(){return this.F=this.Y.slice(0),this.A=[],this.l=0,this},update:function(e){typeof e=="string"&&(e=ge.codec.utf8String.toBits(e));var t,r=this.A=ge.bitArray.concat(this.A,e);if(t=this.l,e=this.l=t+ge.bitArray.bitLength(e),9007199254740991<e)throw new ge.exception.invalid("Cannot hash more than 2^53 - 1 bits");if(typeof Uint32Array<"u"){var n=new Uint32Array(r),i=0;for(t=512+t-(512+t&511);t<=e;t+=512)rE(this,n.subarray(16*i,16*(i+1))),i+=1;r.splice(0,16*i)}else for(t=512+t-(512+t&511);t<=e;t+=512)rE(this,r.splice(0,16));return this},finalize:function(){var e,r=this.A,t=this.F,r=ge.bitArray.concat(r,[ge.bitArray.partial(1,1)]);for(e=r.length+2;e&15;e++)r.push(0);for(r.push(Math.floor(this.l/4294967296)),r.push(this.l|0);r.length;)rE(this,r.splice(0,16));return this.reset(),t},Y:[],b:[],O:function(){function e(a){return 4294967296*(a-Math.floor(a))|0}for(var t=0,r=2,n,i;64>t;r++){for(i=!0,n=2;n*n<=r;n++)if(r%n===0){i=!1;break}i&&(8>t&&(this.Y[t]=e(Math.pow(r,.5))),this.b[t]=e(Math.pow(r,1/3)),t++)}}};function rE(e,t){var r,n,i,a=e.F,o=e.b,s=a[0],l=a[1],c=a[2],f=a[3],u=a[4],h=a[5],g=a[6],_=a[7];for(r=0;64>r;r++)16>r?n=t[r]:(n=t[r+1&15],i=t[r+14&15],n=t[r&15]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+t[r&15]+t[r+9&15]|0),n=n+_+(u>>>6^u>>>11^u>>>25^u<<26^u<<21^u<<7)+(g^u&(h^g))+o[r],_=g,g=h,h=u,u=f+n|0,f=c,c=l,l=s,s=n+(l&c^f&(l^c))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;a[0]=a[0]+s|0,a[1]=a[1]+l|0,a[2]=a[2]+c|0,a[3]=a[3]+f|0,a[4]=a[4]+u|0,a[5]=a[5]+h|0,a[6]=a[6]+g|0,a[7]=a[7]+_|0}ge.mode.ccm={name:"ccm",G:[],listenProgress:function(e){ge.mode.ccm.G.push(e)},unListenProgress:function(e){e=ge.mode.ccm.G.indexOf(e),-1<e&&ge.mode.ccm.G.splice(e,1)},fa:function(e){var t=ge.mode.ccm.G.slice(),r;for(r=0;r<t.length;r+=1)t[r](e)},encrypt:function(e,t,r,n,i){var a,o=t.slice(0),s=ge.bitArray,l=s.bitLength(r)/8,c=s.bitLength(o)/8;if(i=i||64,n=n||[],7>l)throw new ge.exception.invalid("ccm: iv must be at least 7 bytes");for(a=2;4>a&&c>>>8*a;a++);return a<15-l&&(a=15-l),r=s.clamp(r,8*(15-a)),t=ge.mode.ccm.V(e,t,r,n,i,a),o=ge.mode.ccm.C(e,o,r,t,i,a),s.concat(o.data,o.tag)},decrypt:function(e,t,r,n,i){i=i||64,n=n||[];var a=ge.bitArray,o=a.bitLength(r)/8,c=a.bitLength(t),s=a.clamp(t,c-i),l=a.bitSlice(t,c-i),c=(c-i)/8;if(7>o)throw new ge.exception.invalid("ccm: iv must be at least 7 bytes");for(t=2;4>t&&c>>>8*t;t++);if(t<15-o&&(t=15-o),r=a.clamp(r,8*(15-t)),s=ge.mode.ccm.C(e,s,r,l,i,t),e=ge.mode.ccm.V(e,s.data,r,n,i,t),!a.equal(s.tag,e))throw new ge.exception.corrupt("ccm: tag doesn't match");return s.data},na:function(e,t,r,n,i,a){var o=[],s=ge.bitArray,l=s.i;if(n=[s.partial(8,(t.length?64:0)|n-2<<2|a-1)],n=s.concat(n,r),n[3]|=i,n=e.encrypt(n),t.length)for(r=s.bitLength(t)/8,65279>=r?o=[s.partial(16,r)]:4294967295>=r&&(o=s.concat([s.partial(16,65534)],[r])),o=s.concat(o,t),t=0;t<o.length;t+=4)n=e.encrypt(l(n,o.slice(t,t+4).concat([0,0,0])));return n},V:function(e,t,r,n,i,a){var o=ge.bitArray,s=o.i;if(i/=8,i%2||4>i||16<i)throw new ge.exception.invalid("ccm: invalid tag length");if(4294967295<n.length||4294967295<t.length)throw new ge.exception.bug("ccm: can't deal with 4GiB or more data");for(r=ge.mode.ccm.na(e,n,r,i,o.bitLength(t)/8,a),n=0;n<t.length;n+=4)r=e.encrypt(s(r,t.slice(n,n+4).concat([0,0,0])));return o.clamp(r,8*i)},C:function(e,t,r,n,i,a){var o,s=ge.bitArray;o=s.i;var l=t.length,c=s.bitLength(t),f=l/50,u=f;if(r=s.concat([s.partial(8,a-1)],r).concat([0,0,0]).slice(0,4),n=s.bitSlice(o(n,e.encrypt(r)),0,i),!l)return{tag:n,data:[]};for(o=0;o<l;o+=4)o>f&&(ge.mode.ccm.fa(o/l),f+=u),r[3]++,i=e.encrypt(r),t[o]^=i[0],t[o+1]^=i[1],t[o+2]^=i[2],t[o+3]^=i[3];return{tag:n,data:s.clamp(t,c)}}};ge.mode.ocb2={name:"ocb2",encrypt:function(e,t,r,n,i,a){if(ge.bitArray.bitLength(r)!==128)throw new ge.exception.invalid("ocb iv must be 128 bits");var o,s=ge.mode.ocb2.S,l=ge.bitArray,c=l.i,f=[0,0,0,0];r=s(e.encrypt(r));var u,h=[];for(n=n||[],i=i||64,o=0;o+4<t.length;o+=4)u=t.slice(o,o+4),f=c(f,u),h=h.concat(c(r,e.encrypt(c(r,u)))),r=s(r);return u=t.slice(o),t=l.bitLength(u),o=e.encrypt(c(r,[0,0,0,t])),u=l.clamp(c(u.concat([0,0,0]),o),t),f=c(f,c(u.concat([0,0,0]),o)),f=e.encrypt(c(f,c(r,s(r)))),n.length&&(f=c(f,a?n:ge.mode.ocb2.pmac(e,n))),h.concat(l.concat(u,l.clamp(f,i)))},decrypt:function(e,t,r,n,i,a){if(ge.bitArray.bitLength(r)!==128)throw new ge.exception.invalid("ocb iv must be 128 bits");i=i||64;var o=ge.mode.ocb2.S,s=ge.bitArray,l=s.i,c=[0,0,0,0],f=o(e.encrypt(r)),u,h,g=ge.bitArray.bitLength(t)-i,_=[];for(n=n||[],r=0;r+4<g/32;r+=4)u=l(f,e.decrypt(l(f,t.slice(r,r+4)))),c=l(c,u),_=_.concat(u),f=o(f);if(h=g-32*r,u=e.encrypt(l(f,[0,0,0,h])),u=l(u,s.clamp(t.slice(r),h).concat([0,0,0])),c=l(c,u),c=e.encrypt(l(c,l(f,o(f)))),n.length&&(c=l(c,a?n:ge.mode.ocb2.pmac(e,n))),!s.equal(s.clamp(c,i),s.bitSlice(t,g)))throw new ge.exception.corrupt("ocb: tag doesn't match");return _.concat(s.clamp(u,h))},pmac:function(e,t){var r,n=ge.mode.ocb2.S,i=ge.bitArray,a=i.i,o=[0,0,0,0],s=e.encrypt([0,0,0,0]),s=a(s,n(n(s)));for(r=0;r+4<t.length;r+=4)s=n(s),o=a(o,e.encrypt(a(s,t.slice(r,r+4))));return r=t.slice(r),128>i.bitLength(r)&&(s=a(s,n(s)),r=i.concat(r,[-2147483648,0,0,0])),o=a(o,r),e.encrypt(a(n(a(s,n(s))),o))},S:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}};ge.mode.gcm={name:"gcm",encrypt:function(e,t,r,n,i){var a=t.slice(0);return t=ge.bitArray,n=n||[],e=ge.mode.gcm.C(!0,e,a,n,r,i||128),t.concat(e.data,e.tag)},decrypt:function(e,t,r,n,i){var a=t.slice(0),o=ge.bitArray,s=o.bitLength(a);if(i=i||128,n=n||[],i<=s?(t=o.bitSlice(a,s-i),a=o.bitSlice(a,0,s-i)):(t=a,a=[]),e=ge.mode.gcm.C(!1,e,a,n,r,i),!o.equal(e.tag,t))throw new ge.exception.corrupt("gcm: tag doesn't match");return e.data},ka:function(e,t){var r,n,i,a,o,s=ge.bitArray.i;for(i=[0,0,0,0],a=t.slice(0),r=0;128>r;r++){for((n=(e[Math.floor(r/32)]&1<<31-r%32)!==0)&&(i=s(i,a)),o=(a[3]&1)!==0,n=3;0<n;n--)a[n]=a[n]>>>1|(a[n-1]&1)<<31;a[0]>>>=1,o&&(a[0]^=-520093696)}return i},j:function(e,t,r){var n,i=r.length;for(t=t.slice(0),n=0;n<i;n+=4)t[0]^=4294967295&r[n],t[1]^=4294967295&r[n+1],t[2]^=4294967295&r[n+2],t[3]^=4294967295&r[n+3],t=ge.mode.gcm.ka(t,e);return t},C:function(e,t,r,n,i,a){var o,s,l,c,f,u,h,g,_=ge.bitArray;for(u=r.length,h=_.bitLength(r),g=_.bitLength(n),s=_.bitLength(i),o=t.encrypt([0,0,0,0]),s===96?(i=i.slice(0),i=_.concat(i,[1])):(i=ge.mode.gcm.j(o,[0,0,0,0],i),i=ge.mode.gcm.j(o,i,[0,0,Math.floor(s/4294967296),s&4294967295])),s=ge.mode.gcm.j(o,[0,0,0,0],n),f=i.slice(0),n=s.slice(0),e||(n=ge.mode.gcm.j(o,s,r)),c=0;c<u;c+=4)f[3]++,l=t.encrypt(f),r[c]^=l[0],r[c+1]^=l[1],r[c+2]^=l[2],r[c+3]^=l[3];return r=_.clamp(r,h),e&&(n=ge.mode.gcm.j(o,s,r)),e=[Math.floor(g/4294967296),g&4294967295,Math.floor(h/4294967296),h&4294967295],n=ge.mode.gcm.j(o,n,e),l=t.encrypt(i),n[0]^=l[0],n[1]^=l[1],n[2]^=l[2],n[3]^=l[3],{tag:_.bitSlice(n,0,a),data:r}}};ge.misc.hmac=function(e,t){this.W=t=t||ge.hash.sha256;var r=[[],[]],n,i=t.prototype.blockSize/32;for(this.w=[new t,new t],e.length>i&&(e=t.hash(e)),n=0;n<i;n++)r[0][n]=e[n]^909522486,r[1][n]=e[n]^1549556828;this.w[0].update(r[0]),this.w[1].update(r[1]),this.R=new t(this.w[0])};ge.misc.hmac.prototype.encrypt=ge.misc.hmac.prototype.mac=function(e){if(this.aa)throw new ge.exception.invalid("encrypt on already updated hmac called!");return this.update(e),this.digest(e)};ge.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]),this.aa=!1};ge.misc.hmac.prototype.update=function(e){this.aa=!0,this.R.update(e)};ge.misc.hmac.prototype.digest=function(){var e=this.R.finalize(),e=new this.W(this.w[1]).update(e).finalize();return this.reset(),e};ge.misc.pbkdf2=function(e,t,r,n,i){if(r=r||1e4,0>n||0>r)throw new ge.exception.invalid("invalid params to pbkdf2");typeof e=="string"&&(e=ge.codec.utf8String.toBits(e)),typeof t=="string"&&(t=ge.codec.utf8String.toBits(t)),i=i||ge.misc.hmac,e=new i(e);var a,o,s,l,c=[],f=ge.bitArray;for(l=1;32*c.length<(n||1);l++){for(i=a=e.encrypt(f.concat(t,[l])),o=1;o<r;o++)for(a=e.encrypt(a),s=0;s<a.length;s++)i[s]^=a[s];c=c.concat(i)}return n&&(c=f.clamp(c,n)),c};ge.prng=function(e){this.c=[new ge.hash.sha256],this.m=[0],this.P=0,this.H={},this.N=0,this.U={},this.Z=this.f=this.o=this.ha=0,this.b=[0,0,0,0,0,0,0,0],this.h=[0,0,0,0],this.L=void 0,this.M=e,this.D=!1,this.K={progress:{},seeded:{}},this.u=this.ga=0,this.I=1,this.J=2,this.ca=65536,this.T=[0,48,64,96,128,192,256,384,512,768,1024],this.da=3e4,this.ba=80};ge.prng.prototype={randomWords:function(e,t){var r=[],n;n=this.isReady(t);var i;if(n===this.u)throw new ge.exception.notReady("generator isn't seeded");if(n&this.J){n=!(n&this.I),i=[];var a=0,o;for(this.Z=i[0]=new Date().valueOf()+this.da,o=0;16>o;o++)i.push(4294967296*Math.random()|0);for(o=0;o<this.c.length&&(i=i.concat(this.c[o].finalize()),a+=this.m[o],this.m[o]=0,n||!(this.P&1<<o));o++);for(this.P>=1<<this.c.length&&(this.c.push(new ge.hash.sha256),this.m.push(0)),this.f-=a,a>this.o&&(this.o=a),this.P++,this.b=ge.hash.sha256.hash(this.b.concat(i)),this.L=new ge.cipher.aes(this.b),n=0;4>n&&(this.h[n]=this.h[n]+1|0,!this.h[n]);n++);}for(n=0;n<e;n+=4)(n+1)%this.ca===0&&VB(this),i=dE(this),r.push(i[0],i[1],i[2],i[3]);return VB(this),r.slice(0,e)},setDefaultParanoia:function(e,t){if(e===0&&t!=="Setting paranoia=0 will ruin your security; use it only for testing")throw new ge.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=e},addEntropy:function(e,t,r){r=r||"user";var n,i,a=new Date().valueOf(),o=this.H[r],s=this.isReady(),l=0;switch(n=this.U[r],n===void 0&&(n=this.U[r]=this.ha++),o===void 0&&(o=this.H[r]=0),this.H[r]=(this.H[r]+1)%this.c.length,typeof e){case"number":t===void 0&&(t=1),this.c[o].update([n,this.N++,1,t,a,1,e|0]);break;case"object":if(r=Object.prototype.toString.call(e),r==="[object Uint32Array]"){for(i=[],r=0;r<e.length;r++)i.push(e[r]);e=i}else for(r!=="[object Array]"&&(l=1),r=0;r<e.length&&!l;r++)typeof e[r]!="number"&&(l=1);if(!l){if(t===void 0)for(r=t=0;r<e.length;r++)for(i=e[r];0<i;)t++,i=i>>>1;this.c[o].update([n,this.N++,2,t,a,e.length].concat(e))}break;case"string":t===void 0&&(t=e.length),this.c[o].update([n,this.N++,3,t,a,e.length]),this.c[o].update(e);break;default:l=1}if(l)throw new ge.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[o]+=t,this.f+=t,s===this.u&&(this.isReady()!==this.u&&qB("seeded",Math.max(this.o,this.f)),qB("progress",this.getProgress()))},isReady:function(e){return e=this.T[e!==void 0?e:this.M],this.o&&this.o>=e?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=e?this.J|this.u:this.u},getProgress:function(e){return e=this.T[e||this.M],this.o>=e||this.f>e?1:this.f/e},startCollectors:function(){if(!this.D){if(this.a={loadTimeCollector:kg(this,this.ma),mouseCollector:kg(this,this.oa),keyboardCollector:kg(this,this.la),accelerometerCollector:kg(this,this.ea),touchCollector:kg(this,this.qa)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new ge.exception.bug("can't attach event");this.D=!0}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=!1)},addEventListener:function(e,t){this.K[e][this.ga++]=t},removeEventListener:function(e,t){var r,n,i=this.K[e],a=[];for(n in i)i.hasOwnProperty(n)&&i[n]===t&&a.push(n);for(r=0;r<a.length;r++)n=a[r],delete i[n]},la:function(){xg(this,1)},oa:function(e){var t,r;try{t=e.x||e.clientX||e.offsetX||0,r=e.y||e.clientY||e.offsetY||0}catch{r=t=0}t!=0&&r!=0&&this.addEntropy([t,r],2,"mouse"),xg(this,0)},qa:function(e){e=e.touches[0]||e.changedTouches[0],this.addEntropy([e.pageX||e.clientX,e.pageY||e.clientY],1,"touch"),xg(this,0)},ma:function(){xg(this,2)},ea:function(e){if(e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,window.orientation){var t=window.orientation;typeof t=="number"&&this.addEntropy(t,1,"accelerometer")}e&&this.addEntropy(e,2,"accelerometer"),xg(this,0)}};function qB(e,t){var r,n=ge.random.K[e],i=[];for(r in n)n.hasOwnProperty(r)&&i.push(n[r]);for(r=0;r<i.length;r++)i[r](t)}function xg(e,t){typeof window<"u"&&window.performance&&typeof window.performance.now=="function"?e.addEntropy(window.performance.now(),t,"loadtime"):e.addEntropy(new Date().valueOf(),t,"loadtime")}function VB(e){e.b=dE(e).concat(dE(e)),e.L=new ge.cipher.aes(e.b)}function dE(e){for(var t=0;4>t&&(e.h[t]=e.h[t]+1|0,!e.h[t]);t++);return e.L.encrypt(e.h)}function kg(e,t){return function(){t.apply(e,arguments)}}ge.random=new ge.prng(6);e:try{if(iE=typeof module<"u"&&module.exports){try{aE=See("crypto")}catch{aE=null}iE=nE=aE}if(iE&&nE.randomBytes)g_=nE.randomBytes(128),g_=new Uint32Array(new Uint8Array(g_).buffer),ge.random.addEntropy(g_,1024,"crypto['randomBytes']");else if(typeof window<"u"&&typeof Uint32Array<"u"){if(y_=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(y_);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(y_);else break e;ge.random.addEntropy(y_,1024,"crypto['getRandomValues']")}}catch(e){typeof window<"u"&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}var g_,nE,y_,iE,aE;ge.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(e,t,r,n){r=r||{},n=n||{};var i=ge.json,a=i.g({iv:ge.random.randomWords(4,0)},i.defaults),o;if(i.g(a,r),r=a.adata,typeof a.salt=="string"&&(a.salt=ge.codec.base64.toBits(a.salt)),typeof a.iv=="string"&&(a.iv=ge.codec.base64.toBits(a.iv)),!ge.mode[a.mode]||!ge.cipher[a.cipher]||typeof e=="string"&&100>=a.iter||a.ts!==64&&a.ts!==96&&a.ts!==128||a.ks!==128&&a.ks!==192&&a.ks!==256||2>a.iv.length||4<a.iv.length)throw new ge.exception.invalid("json encrypt: invalid parameters");return typeof e=="string"?(o=ge.misc.cachedPbkdf2(e,a),e=o.key.slice(0,a.ks/32),a.salt=o.salt):ge.ecc&&e instanceof ge.ecc.elGamal.publicKey&&(o=e.kem(),a.kemtag=o.tag,e=o.key.slice(0,a.ks/32)),typeof t=="string"&&(t=ge.codec.utf8String.toBits(t)),typeof r=="string"&&(a.adata=r=ge.codec.utf8String.toBits(r)),o=new ge.cipher[a.cipher](e),i.g(n,a),n.key=e,a.ct=a.mode==="ccm"&&ge.arrayBuffer&&ge.arrayBuffer.ccm&&t instanceof ArrayBuffer?ge.arrayBuffer.ccm.encrypt(o,t,a.iv,r,a.ts):ge.mode[a.mode].encrypt(o,t,a.iv,r,a.ts),a},encrypt:function(e,t,r,n){var i=ge.json,a=i.ja.apply(i,arguments);return i.encode(a)},ia:function(e,t,r,n){r=r||{},n=n||{};var i=ge.json;t=i.g(i.g(i.g({},i.defaults),t),r,!0);var a,o;if(a=t.adata,typeof t.salt=="string"&&(t.salt=ge.codec.base64.toBits(t.salt)),typeof t.iv=="string"&&(t.iv=ge.codec.base64.toBits(t.iv)),!ge.mode[t.mode]||!ge.cipher[t.cipher]||typeof e=="string"&&100>=t.iter||t.ts!==64&&t.ts!==96&&t.ts!==128||t.ks!==128&&t.ks!==192&&t.ks!==256||!t.iv||2>t.iv.length||4<t.iv.length)throw new ge.exception.invalid("json decrypt: invalid parameters");return typeof e=="string"?(o=ge.misc.cachedPbkdf2(e,t),e=o.key.slice(0,t.ks/32),t.salt=o.salt):ge.ecc&&e instanceof ge.ecc.elGamal.secretKey&&(e=e.unkem(ge.codec.base64.toBits(t.kemtag)).slice(0,t.ks/32)),typeof a=="string"&&(a=ge.codec.utf8String.toBits(a)),o=new ge.cipher[t.cipher](e),a=t.mode==="ccm"&&ge.arrayBuffer&&ge.arrayBuffer.ccm&&t.ct instanceof ArrayBuffer?ge.arrayBuffer.ccm.decrypt(o,t.ct,t.iv,t.tag,a,t.ts):ge.mode[t.mode].decrypt(o,t.ct,t.iv,a,t.ts),i.g(n,t),n.key=e,r.raw===1?a:ge.codec.utf8String.fromBits(a)},decrypt:function(e,t,r,n){var i=ge.json;return i.ia(e,i.decode(t),r,n)},encode:function(e){var t,r="{",n="";for(t in e)if(e.hasOwnProperty(t)){if(!t.match(/^[a-z0-9]+$/i))throw new ge.exception.invalid("json encode: invalid property name");switch(r+=n+'"'+t+'":',n=",",typeof e[t]){case"number":case"boolean":r+=e[t];break;case"string":r+='"'+escape(e[t])+'"';break;case"object":r+='"'+ge.codec.base64.fromBits(e[t],0)+'"';break;default:throw new ge.exception.bug("json encode: unsupported type")}}return r+"}"},decode:function(e){if(e=e.replace(/\s/g,""),!e.match(/^\{.*\}$/))throw new ge.exception.invalid("json decode: this isn't json!");e=e.replace(/^\{|\}$/g,"").split(/,/);var t={},r,n;for(r=0;r<e.length;r++){if(!(n=e[r].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new ge.exception.invalid("json decode: this isn't json!");n[3]!=null?t[n[2]]=parseInt(n[3],10):n[4]!=null?t[n[2]]=n[2].match(/^(ct|adata|salt|iv)$/)?ge.codec.base64.toBits(n[4]):unescape(n[4]):n[5]!=null&&(t[n[2]]=n[5]==="true")}return t},g:function(e,t,r){if(e===void 0&&(e={}),t===void 0)return e;for(var n in t)if(t.hasOwnProperty(n)){if(r&&e[n]!==void 0&&e[n]!==t[n])throw new ge.exception.invalid("required parameter overridden");e[n]=t[n]}return e},sa:function(e,t){var r={},n;for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(r[n]=e[n]);return r},ra:function(e,t){var r={},n;for(n=0;n<t.length;n++)e[t[n]]!==void 0&&(r[t[n]]=e[t[n]]);return r}};ge.encrypt=ge.json.encrypt;ge.decrypt=ge.json.decrypt;ge.misc.pa={};ge.misc.cachedPbkdf2=function(e,t){var r=ge.misc.pa,n;return t=t||{},n=t.iter||1e3,r=r[e]=r[e]||{},n=r[n]=r[n]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):ge.random.randomWords(2,0)},r=t.salt===void 0?n.firstSalt:t.salt,n[r]=n[r]||ge.misc.pbkdf2(e,r,t.iter),{key:n[r].slice(0),salt:r.slice(0)}};var m_=class extends Uee{name="http";fetchProxied=!1;listening={};constructor(e,t,r){super(e),this.load(this),this.listen(t,r)}GET=(e="http://localhost:8080/ping",t="",r)=>(t==="json"&&(r="application/json"),new Promise((n,i)=>{let a=m_.request({method:"GET",url:e,responseType:t,mimeType:r,onload:o=>{let s;a.responseType===""||a.responseType==="text"?s=a.responseText:s=a.response,e instanceof URL&&(e=e.toString()),this.setState({[e]:s}),n(s)},onabort:o=>{i(o)}})}).catch(console.error));POST=(e,t="http://localhost:8080/echo",r="",n)=>(typeof e=="object"&&(r==="json"||r==="text"||!r)&&(e=JSON.stringify(e)),r==="json"&&(n="application/json"),new Promise((i,a)=>{let o=m_.request({method:"POST",url:t,data:e,responseType:r,mimeType:n,onload:s=>{let l;o.responseType===""||o.responseType==="text"?l=o.responseText:l=o.response,t instanceof URL&&(t=t.toString()),this.setState({[t]:l}),i(l)},onabort:s=>{a(s)}})}).catch(console.error));transmit=(e,t)=>{let r=e;return typeof r=="object"&&(e=JSON.stringify(r)),r?.method?.toLowerCase()=="get"||e?.toLowerCase()==="get"?this.GET(t):this.POST(e,t)};transponder=(e,t,r="",n)=>{typeof t=="object"&&(t=JSON.stringify(t));let i="GET";if(t&&(i="POST"),r==="json")n="application/json";else return new Promise((a,o)=>{let s=m_.request({method:i,url:e,data:t,responseType:r,onload:l=>{let c=s.response;if(typeof c=="string"){let f=c.substring(0,8);(f.includes("{")||f.includes("["))&&(f.includes("\\")&&(c=c.replace(/\\/g,"")),c[0]==='"'&&(c=c.substring(1,c.length-1)),c=JSON.parse(c))}return typeof c?.method=="string"?a(this.handleMethod(c.route,c.method,c.args)):typeof c?.route=="string"?a(this.handleServiceMessage(c)):typeof c?.node=="string"||c.node instanceof hr?a(this.handleGraphNodeCall(c.node,c.args)):a(c)},onabort:l=>{o(l)}})}).catch(console.error)};listen=(e="0",t=async(r,n,i)=>{let a=await r.text(),o=this.receive(a);this.setState({[i.url]:o})})=>{this.listening[e]={};let r=`${e}${Math.floor(Math.random()*1e15)}`;return this.listening[e][r]=t,this.fetchProxied||(globalThis.fetch=new Proxy(globalThis.fetch,{apply(n,i,a){let o=n.apply(i,a);return o.then(s=>{if(s.ok){if(this.listening[0])for(let l in this.listeners){let c=s.clone();this.listening[0][l](c,a,s)}else for(let l in this.listening)if(s.url.includes(l)){for(let c in this.listening[e]){let f=s.clone();this.listening[e][c](f,a,s)}break}}}).catch(s=>{console.error(s)}),o}}),this.fetchProxied=!0),r};stopListening=(e,t)=>{if(!e&&e!==0)for(let r in this.listening)delete this.listening[r];else t?delete this.listening[t]:delete this.listening[e]}},Hee=m_;Oee(Hee,"request",e=>{let t=new XMLHttpRequest;return e.responseType?t.responseType=e.responseType:e.responseType="json",e.mimeType&&t.overrideMimeType(e.mimeType),e.onload&&t.addEventListener("load",e.onload,!1),e.onprogress&&t.addEventListener("progress",e.onprogress,!1),e.onabort&&t.addEventListener("abort",e.onabort,!1),e.onloadend&&t.addEventListener("loadend",e.onloadend,!1),e.onerror&&t.addEventListener("error",e.onerror,!1),t.open(e.method,e.url,!0,e.user,e.pass),e.onerror||(t.onerror=function(){t.abort()}),t.send(e.data),t});var oCe=Eee(Aee());var ms=gE(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]),Wee=gE(["deltaX","deltaY"]),Jee=gE(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function HB(e,t){let r={type:e.type};r.isTrusted=e.isTrusted,r.bubbles=e.bubbles,r.cancelBubble=e.cancelBubble,r.cancelable=e.cancelable,r.composed=e.composed,r.defaultPrevent=e.defaultPrevented,r.eventPhase=e.eventPhase,r.returnValue=e.returnValue,r.currentTarget=e.currentTarget.id?e.currentTarget.id:e.currentTarget.constructor.name,r.target=r.currentTarget,r.srcElement=r.currentTarget,t(r)}function Gee(e,t,r){r&&e.preventDefault&&e.preventDefault(),Wee(e,t)}function Yee(e,t,r){r&&e.preventDefault&&e.preventDefault()}function Kee(e,t,r){for(let n of t)r[n]=e[n]}function gE(e){return function(r,n){let i={type:r.type};Kee(r,e,i),n(i)}}function oE(e,t,r){r&&e.preventDefault&&e.preventDefault();let n=[],i={type:e.type,touches:n};for(let a=0;a<e.touches.length;++a){let o=e.touches[a];n.push({pageX:o.pageX,pageY:o.pageY})}t(i)}var sE=1,YB={};for(;sE<222;)YB[sE]=!0,sE++;function WB(e,t,r){let{keyCode:n}=e;YB[n]&&(r&&e.preventDefault&&(n<110||n>123)&&e.preventDefault(),Jee(e,t))}var Eg={contextmenu:Yee,mousedown:ms,mousemove:ms,mouseup:ms,pointerdown:ms,pointermove:ms,pointerup:ms,pointerlockchange:ms,webkitpointerlockchange:ms,focus:HB,blur:HB,pointerout:ms,touchstart:oE,touchmove:oE,touchend:oE,wheel:Gee,keydown:WB,keyup:WB};function yE(e,t,r,n){r||(r="proxy"+Math.floor(Math.random()*1e15));let i=s=>{t?t.postMessage({route:"handleProxyEvent",args:[s,r]}):KB(s,r)},a=Object.entries(Eg);for(let[s,l]of a)e.addEventListener(s,function(c){l(c,i,n)});Eg.keydown&&globalThis.addEventListener("keydown",function(s){Eg.keydown(s,i,n)}),Eg.keyup&&globalThis.addEventListener("keyup",function(s){Eg.keyup(s,i,n)});let o=()=>{let s=e.getBoundingClientRect();i({type:"resize",left:s.left,top:s.top,width:e.clientWidth,height:e.clientHeight})};return o(),globalThis.addEventListener("resize",o),r}var Xee=class{__listeners;addEventListener(e,t){this.__listeners===void 0&&(this.__listeners={});let r=this.__listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this.__listeners===void 0)return!1;let r=this.__listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this.__listeners===void 0)return;let n=this.__listeners[e];if(n!==void 0){let i=n.indexOf(t);i!==-1&&n.splice(i,1)}}dispatchEvent(e,t){if(this.__listeners===void 0)return;let n=this.__listeners[e.type];if(n!==void 0){t?e.target=t:e.target=this;let i=n.slice(0);for(let a=0,o=i.length;a<o;a++)i[a].call(this,e)}}};function JB(){}var Zee=class extends Xee{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super(),this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>({left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height});handleEvent=e=>{e.type==="resize"&&(this.left=e.left,this.top=e.top,this.width=e.width,this.height=e.height,typeof this.proxied=="object"&&(this.proxied.style.width=this.width+"px",this.proxied.style.height=this.height+"px",this.proxied.clientWidth=this.width,this.proxied.clientHeight=this.height)),e.preventDefault=JB,e.stopPropagation=JB,this.dispatchEvent(e,this.proxied)};focus(){}blur(){}},__=class{targets={};constructor(){globalThis.document||(globalThis.document={elementFromPoint:(...e)=>this.targets[Object.keys(this.targets)[0]].proxied})}makeProxy=(e,t=void 0)=>{e||(e=`proxyReceiver${Math.floor(Math.random()*1e15)}`);let r;this.targets[e]?r=this.targets[e]:(r=new Zee,this.targets[e]=r),typeof t=="object"&&(t.proxy=r,r.proxied=t,typeof WorkerGlobalScope<"u"&&(t.style=r.style),r.width&&(t.style.width=r.width+"px",t.clientWidth=r.width),r.height&&(t.style.height=r.height+"px",t.clientHeight=r.height),t.setPointerCapture=r.setPointerCapture.bind(r),t.releasePointerCapture=r.releasePointerCapture.bind(r),t.getBoundingClientRect=r.getBoundingClientRect.bind(r),t.addEventListener=r.addEventListener.bind(r),t.removeEventListener=r.removeEventListener.bind(r),t.handleEvent=r.handleEvent.bind(r),t.dispatchEvent=r.dispatchEvent.bind(r),t.focus=r.focus.bind(r),t.blur=r.blur.bind(r))};getProxy=e=>this.targets[e];handleEvent=(e,t)=>{if(this.targets[t]||this.makeProxy(t),this.targets[t])return this.targets[t].handleEvent(e),!0}};function Qee(e,t){return this?.__node?.graph?(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new __),this.__node.graph.ProxyManager.makeProxy(e,t)):(globalThis.ProxyManager||(globalThis.ProxyManager=new __),globalThis.ProxyManager.makeProxy(e,t)),e}function KB(e,t){if(this?.__node?.graph){if(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new __),this.__node.graph.ProxyManager.handleEvent(e,t))return e}else if(globalThis.ProxyManager||(globalThis.ProxyManager=new __),globalThis.ProxyManager.handleEvent(e,t))return e}var mE={initProxyElement:yE,makeProxy:Qee,handleProxyEvent:KB};function ete(e){if(e.worker){let t=e.worker,r=e.route;return(t instanceof Blob||typeof t=="string")&&(t=new Worker(t)),delete e.worker,delete e.route,XB(t,e,r)}else return yE(e.canvas,void 0,e._id,e.preventDefault),ZB(e)}function XB(e,t,r){if(!t)return;t._id||(t._id=`canvas${Math.floor(Math.random()*1e15)}`);let n=t.canvas.transferControlToOffscreen();t.width||(t.width=t.canvas.clientWidth),t.height||(t.height=t.canvas.clientHeight);let i={route:r||"setupCanvas",args:{...t,canvas:n}};this?.__node?.graph?this.__node.graph.run("initProxyElement",t.canvas,e,t._id,t.preventDefault):yE(t.canvas,e,t._id,t.preventDefault),t.draw&&(typeof t.draw=="function"?i.args.draw=t.draw.toString():i.args.draw=t.draw),t.update&&(typeof t.update=="function"?i.args.update=t.update.toString():i.args.update=t.update),t.init&&(typeof t.init=="function"?i.args.init=t.init.toString():i.args.init=t.init),t.clear&&(typeof t.clear=="function"?i.args.clear=t.clear.toString():i.args.clear=t.clear);let a=[n];return t.transfer&&(a.push(...t.transfer),delete t.transfer),e.postMessage(i,a),{_id:t._id,width:t.width,height:t.height,worker:e,draw:(s,l)=>{e.postMessage({route:"drawFrame",args:[s,t._id]},l)},update:(s,l)=>{e.postMessage({route:"updateCanvas",args:[s,t._id]},l)},clear:()=>{e.postMessage({route:"clearCanvas",args:t._id})},init:()=>{e.postMessage({route:"initCanvas",args:t._id})},stop:()=>{e.postMessage({route:"stopAnim",args:t._id})},start:()=>{e.postMessage({route:"startAnim",args:t._id})},set:(s,l)=>{e.postMessage({route:"setDraw",args:[s,t._id]},l)},terminate:()=>{e.terminate()}}}function v_(e,t){let r;if(this?.__node?.graph?t?r=this.__node.graph.CANVASES?.[e._id]:e._id?r=this.__node.graph.CANVASES?.[e._id]:r=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:t||e._id?r=globalThis.CANVASES?.[e._id]:r=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],r)return e.canvas&&(r.canvas=e.canvas,this?.__node?.graph?this.__node.graph.run("makeProxy",r._id,r.canvas):mE.makeProxy(r._id,r.canvas)),typeof e.context=="string"?r.context=r.canvas.getContext(e.context):e.context&&(r.context=e.context),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),typeof e.draw=="string"&&(e.draw=vs(e.draw)),typeof e.draw=="function"&&(r.draw=e.draw.bind(e)),typeof e.update=="string"&&(e.update=vs(e.update)),typeof e.update=="function"&&(r.update=e.update.bind(e)),typeof e.init=="string"&&(e.init=vs(e.init)),typeof e.init=="function"&&(r.init=e.init.bind(e)),typeof e.clear=="string"&&(e.clear=vs(e.clear)),typeof e.clear=="function"&&(r.clear=e.clear.bind(e)),e._id}function ZB(e){this?.__node?.graph?this.__node.graph.CANVASES||(this.__node.graph.CANVASES={}):globalThis.CANVASES||(globalThis.CANVASES={});let t=e;if(e._id?t._id=e._id:t._id=`canvas${Math.floor(Math.random()*1e15)}`,typeof e.context=="string"?t.context=e.canvas.getContext(e.context):t.context=e.context,"animating"in e?t.animating=e.animating:t.animating=!0,this?.__node?.graph?.CANVASES[t._id])this.__node.graph.run("setDraw",t);else if(globalThis.CANVASES?.[t._id])v_(t);else if(this?.__node?.graph&&(t.graph=this.__node.graph,t.__node||(t.__node={}),t.__node.tag||(t.__node.tag=t._id),t=this.__node.graph.add(t),t.__addOndisconnected=()=>{t.stop(),delete this.__node.graph.CANVASES[t._id]}),this?.__node?.graph?this.__node.graph.CANVASES[t._id]=t:globalThis.CANVASES[t._id]=t,this?.__node?.graph?this.__node.graph.run("makeProxy",t._id,t.canvas):mE.makeProxy(t._id,t.canvas),e.width&&(t.canvas.width=e.width),e.height&&(t.canvas.height=e.height),typeof t.draw=="string"?t.draw=vs(t.draw):typeof t.draw=="function"&&(t.draw=t.draw.bind(t)),typeof t.update=="string"?t.update=vs(t.update):typeof t.update=="function"&&(t.update=t.update.bind(t)),typeof t.init=="string"?t.init=vs(t.init):typeof t.init=="function"&&(t.init=t.init.bind(t)),typeof t.clear=="string"?t.clear=vs(t.clear):typeof t.clear=="function"&&(t.clear=t.clear.bind(t)),typeof t.init=="function"&&t.init(t,t.canvas,t.context),t.stop=()=>{b_(t._id)},t.start=r=>{pE(t._id,r)},t.set=r=>{v_(r,t._id)},typeof t.draw=="function"&&t.animating){let r=(n,i,a)=>{n.animating&&(n.draw(n,i,a),requestAnimationFrame(()=>{r(n,i,a)}))};r(t,t.canvas,t.context)}return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?t._id:{_id:e._id,width:e.width,height:e.height,draw:n=>{QB(n,e._id)},update:n=>{rR(n,e._id)},clear:()=>{eR(e._id)},init:()=>{tR(e._id)},stop:()=>{b_(e._id)},start:()=>{pE(e._id)},set:n=>{v_(n,e._id)},terminate:()=>{this.__node?.graph?this.__node.graph.remove(e._id):(b_(e._id),this?.__node?.graph?delete this.__node.graph.CANVASES[t._id]:delete globalThis.CANVASES[t._id])}}}function QB(e,t){let r=kl.call(this,t);if(r&&(e&&Object.assign(r,e),r.draw))return r.draw(r,r.canvas,r.context),t}function eR(e){let t=kl.call(this,e);if(t?.clear)return t.clear(t,t.canvas,t.context),e}function tR(e){let t=kl.call(this,e);if(t?.init)return t.init(t,t.canvas,t.context),e}function rR(e,t){let r=kl.call(this,t);if(r?.update)return r.update(r,r.canvas,r.context,e),t}function tte(e,t){let r=kl.call(this,t);if(r)return Object.assign(r,e),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),t}function pE(e,t){let r=kl.call(this,e);if(r.animating=!0,r&&t)return typeof t=="string"&&(t=vs(t)),typeof t=="function"&&(r.draw=t),e;if(typeof r?.draw=="function"){let n=(i,a,o)=>{i.animating&&(i.draw(i,a,o),requestAnimationFrame(()=>{n(i,a,o)}))};return typeof r.clear=="function"&&r.clear(r,r.canvas,r.context),typeof r.init=="function"&&r.init(r,r.canvas,r.context),n(r,r.canvas,r.context),e}}function b_(e){let t=kl.call(this,e);if(t)return t.animating=!1,typeof t.clear=="function"&&requestAnimationFrame(t.clear(t,t.canvas,t.context)),e}function kl(e){let t;return this?.__node?.graph?e?t=this.__node.graph.CANVASES?.[e]:t=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:e?t=globalThis.CANVASES?.[e]:t=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],t}var sCe={...mE,Renderer:ete,transferCanvas:XB,setupCanvas:ZB,setDraw:v_,drawFrame:QB,clearCanvas:eR,initCanvas:tR,updateCanvas:rR,setProps:tte,startAnim:pE,stopAnim:b_,getCanvas:kl};function vs(e=""){let t=o=>o.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),n=(o=>{let s=o.indexOf("=>")+1;return s<=0&&(s=o.indexOf("){")),s<=0&&(s=o.indexOf(") {")),o.slice(0,o.indexOf("{",s)+1)})(e),i=t(e),a;if(n.includes("function")){let o=n.split("(")[1].split(")")[0];a=new Function(o,i)}else if(n.substring(0,6)===i.substring(0,6)){let o=n.split("(")[1].split(")")[0];a=new Function(o,i.substring(i.indexOf("{")+1,i.length-1))}else try{a=(0,eval)(n+i+"}")}catch{}return a}var jc=wt.subscribeEvent,Ag=wt.unsubscribeEvent,vE=wt.setState,bE=e=>wt.data[e],qf=vE;var rte={heg:"./recordings/JoshuaBrewster_PPG_2023-05-16T03_00_47.662Z.csv",hr:"./recordings/JoshuaBrewster_HRV_2023-05-16T03_00_47.662Z.csv",breath:"./recordings/JoshuaBrewster_BREATH_2023-05-16T03_00_47.662Z.csv",fnirs:"./recordings/JoshuaBrewster_PPG_2023-05-16T03_00_47.662Z.csv"};async function nte(e){let t=await fetch(e);if(t.status===200||t.status===0)return await t.text()}var ite={};function ate(e,t,r,n=1/0){let i=rte[e];t||(e==="fnirs"?t=20:e==="heg"?t=10:e==="hr"?t=1:e==="breath"?t=.166667:e==="imu"&&(r=100)),r||(e==="fnirs"||e==="heg"?r=1e3/20:e==="imu"?r=333:e==="hr"?r=1e3:e==="breath"&&(r=1e3/.166667)),nte(i).then(a=>{let o=eE(a,i,void 0),s={};function l(u=250,h=1e3,g){let _=Math.floor(u*(h/1e3)),w={};function E(S){w[S]=[],s[S]||(s[S]=0),new Array(_).fill(0).map((A,O)=>{w[S].push(parseFloat(o[S][s[S]+O]))}),s[S]+=_,s[S]+_>o[S].length&&(s[S]=0)}if(g)E(g),E("timestamp");else for(let S in o)S!=="header"&&S!=="filename"&&S!=="localized"&&E(S);return w}let c={running:!0};((u=250,h=1e3*9/250,g=5e3)=>{let _=Date.now(),w=_,E=async()=>{if(c.running){let A=l(u,h),O=e;wt.setState({[O]:A}),_+=h,_<=w+g&&(await new Promise(C=>setTimeout(C,h)),E())}};E()})(t,r,n),ite[e]=c})}function nR(e=["fnirs","heg","breath","hr"]){let t={};for(let r of e)ate(r),t["detected"+r.toUpperCase()]=!0;wt.setState({deviceConnected:!0,demoing:!0,...t})}var tn=oe(He());var ut=oe(He());function Ig(){return Ig=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ig.apply(this,arguments)}var Ya;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ya||(Ya={}));var iR="popstate";function lR(e){e===void 0&&(e={});function t(i,a){let{pathname:o="/",search:s="",hash:l=""}=To(i.location.hash.substr(1));return wE("",{pathname:o,search:s,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(i,a){let o=i.document.querySelector("base"),s="";if(o&&o.getAttribute("href")){let l=i.location.href,c=l.indexOf("#");s=c===-1?l:l.slice(0,c)}return s+"#"+(typeof a=="string"?a:$c(a))}function n(i,a){w_(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(a)+")")}return ste(t,r,n,e)}function Wr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function w_(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function ote(){return Math.random().toString(36).substr(2,8)}function aR(e,t){return{usr:e.state,key:e.key,idx:t}}function wE(e,t,r,n){return r===void 0&&(r=null),Ig({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?To(t):t,{state:r,key:t&&t.key||n||ote()})}function $c(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function To(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function ste(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,o=i.history,s=Ya.Pop,l=null,c=f();c==null&&(c=0,o.replaceState(Ig({},o.state,{idx:c}),""));function f(){return(o.state||{idx:null}).idx}function u(){s=Ya.Pop;let E=f(),S=E==null?null:E-c;c=E,l&&l({action:s,location:w.location,delta:S})}function h(E,S){s=Ya.Push;let A=wE(w.location,E,S);r&&r(A,E),c=f()+1;let O=aR(A,c),C=w.createHref(A);try{o.pushState(O,"",C)}catch{i.location.assign(C)}a&&l&&l({action:s,location:w.location,delta:1})}function g(E,S){s=Ya.Replace;let A=wE(w.location,E,S);r&&r(A,E),c=f();let O=aR(A,c),C=w.createHref(A);o.replaceState(O,"",C),a&&l&&l({action:s,location:w.location,delta:0})}function _(E){let S=i.location.origin!=="null"?i.location.origin:i.location.href,A=typeof E=="string"?E:$c(E);return Wr(S,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,S)}let w={get action(){return s},get location(){return e(i,o)},listen(E){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(iR,u),l=E,()=>{i.removeEventListener(iR,u),l=null}},createHref(E){return t(i,E)},createURL:_,encodeLocation(E){let S=_(E);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:h,replace:g,go(E){return o.go(E)}};return w}var oR;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(oR||(oR={}));function S_(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?To(t):t,i=Cg(n.pathname||"/",r);if(i==null)return null;let a=cR(e);lte(a);let o=null;for(let s=0;o==null&&s<a.length;++s)o=mte(a[s],bte(i));return o}function cR(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,o,s)=>{let l={relativePath:s===void 0?a.path||"":s,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};l.relativePath.startsWith("/")&&(Wr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Co([n,l.relativePath]),f=r.concat(l);a.children&&a.children.length>0&&(Wr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),cR(a.children,t,f,c)),!(a.path==null&&!a.index)&&t.push({path:c,score:gte(c,a.index),routesMeta:f})};return e.forEach((a,o)=>{var s;if(a.path===""||!((s=a.path)!=null&&s.includes("?")))i(a,o);else for(let l of uR(a.path))i(a,o,l)}),t}function uR(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let o=uR(n.join("/")),s=[];return s.push(...o.map(l=>l===""?a:[a,l].join("/"))),i&&s.push(...o),s.map(l=>e.startsWith("/")&&l===""?"/":l)}function lte(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:yte(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var cte=/^:\w+$/,ute=3,fte=2,dte=1,pte=10,hte=-2,sR=e=>e==="*";function gte(e,t){let r=e.split("/"),n=r.length;return r.some(sR)&&(n+=hte),t&&(n+=fte),r.filter(i=>!sR(i)).reduce((i,a)=>i+(cte.test(a)?ute:a===""?dte:pte),n)}function yte(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function mte(e,t){let{routesMeta:r}=e,n={},i="/",a=[];for(let o=0;o<r.length;++o){let s=r[o],l=o===r.length-1,c=i==="/"?t:t.slice(i.length)||"/",f=x_({path:s.relativePath,caseSensitive:s.caseSensitive,end:l},c);if(!f)return null;Object.assign(n,f.params);let u=s.route;a.push({params:n,pathname:Co([i,f.pathname]),pathnameBase:Ste(Co([i,f.pathnameBase])),route:u}),f.pathnameBase!=="/"&&(i=Co([i,f.pathnameBase]))}return a}function x_(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=vte(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:n.reduce((c,f,u)=>{if(f==="*"){let h=s[u]||"";o=a.slice(0,a.length-h.length).replace(/(.)\/+$/,"$1")}return c[f]=_te(s[u]||"",f),c},{}),pathname:a,pathnameBase:o,pattern:e}}function vte(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),w_(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(o,s)=>(n.push(s),"/([^\\/]+)"));return e.endsWith("*")?(n.push("*"),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function bte(e){try{return decodeURI(e)}catch(t){return w_(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function _te(e,t){try{return decodeURIComponent(e)}catch(r){return w_(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function Cg(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function SE(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?To(e):e;return{pathname:r?r.startsWith("/")?r:wte(r,t):t,search:xte(n),hash:kte(i)}}function wte(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function _E(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function xE(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function kE(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=To(e):(i=Ig({},e),Wr(!i.pathname||!i.pathname.includes("?"),_E("?","pathname","search",i)),Wr(!i.pathname||!i.pathname.includes("#"),_E("#","pathname","hash",i)),Wr(!i.search||!i.search.includes("#"),_E("#","search","hash",i)));let a=e===""||i.pathname==="",o=a?"/":i.pathname,s;if(n||o==null)s=r;else{let u=t.length-1;if(o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),u-=1;i.pathname=h.join("/")}s=u>=0?t[u]:"/"}let l=SE(i,s),c=o&&o!=="/"&&o.endsWith("/"),f=(a||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}var Co=e=>e.join("/").replace(/\/\/+/g,"/"),Ste=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),xte=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,kte=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function k_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var fR=["post","put","patch","delete"],xCe=new Set(fR),Ete=["get",...fR],kCe=new Set(Ete);var ECe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";var OCe=Symbol("deferred");function E_(){return E_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E_.apply(this,arguments)}var Lg=ut.createContext(null),O_=ut.createContext(null);var bs=ut.createContext(null),Pg=ut.createContext(null),_s=ut.createContext({outlet:null,matches:[],isDataRoute:!1}),hR=ut.createContext(null);function AE(e,t){let{relative:r}=t===void 0?{}:t;Vf()||Wr(!1);let{basename:n,navigator:i}=ut.useContext(bs),{hash:a,pathname:o,search:s}=Fg(e,{relative:r}),l=o;return n!=="/"&&(l=o==="/"?n:Co([n,o])),i.createHref({pathname:l,search:s,hash:a})}function Vf(){return ut.useContext(Pg)!=null}function ws(){return Vf()||Wr(!1),ut.useContext(Pg).location}function gR(e){ut.useContext(bs).static||ut.useLayoutEffect(e)}function IE(){let{isDataRoute:e}=ut.useContext(_s);return e?$te():Nte()}function Nte(){Vf()||Wr(!1);let e=ut.useContext(Lg),{basename:t,navigator:r}=ut.useContext(bs),{matches:n}=ut.useContext(_s),{pathname:i}=ws(),a=JSON.stringify(xE(n).map(l=>l.pathnameBase)),o=ut.useRef(!1);return gR(()=>{o.current=!0}),ut.useCallback(function(l,c){if(c===void 0&&(c={}),!o.current)return;if(typeof l=="number"){r.go(l);return}let f=kE(l,JSON.parse(a),i,c.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Co([t,f.pathname])),(c.replace?r.replace:r.push)(f,c.state,c)},[t,r,a,i,e])}function Fg(e,t){let{relative:r}=t===void 0?{}:t,{matches:n}=ut.useContext(_s),{pathname:i}=ws(),a=JSON.stringify(xE(n).map(o=>o.pathnameBase));return ut.useMemo(()=>kE(e,JSON.parse(a),i,r==="path"),[e,a,i,r])}function yR(e,t){return Lte(e,t)}function Lte(e,t,r){Vf()||Wr(!1);let{navigator:n}=ut.useContext(bs),{matches:i}=ut.useContext(_s),a=i[i.length-1],o=a?a.params:{},s=a?a.pathname:"/",l=a?a.pathnameBase:"/",c=a&&a.route,f=ws(),u;if(t){var h;let S=typeof t=="string"?To(t):t;l==="/"||(h=S.pathname)!=null&&h.startsWith(l)||Wr(!1),u=S}else u=f;let g=u.pathname||"/",_=l==="/"?g:g.slice(l.length)||"/",w=S_(e,{pathname:_}),E=Bte(w&&w.map(S=>Object.assign({},S,{params:Object.assign({},o,S.params),pathname:Co([l,n.encodeLocation?n.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?l:Co([l,n.encodeLocation?n.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),i,r);return t&&E?ut.createElement(Pg.Provider,{value:{location:E_({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Ya.Pop}},E):E}function Pte(){let e=A_(),t=k_(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n};return ut.createElement(ut.Fragment,null,ut.createElement("h2",null,"Unexpected Application Error!"),ut.createElement("h3",{style:{fontStyle:"italic"}},t),r?ut.createElement("pre",{style:i},r):null,null)}var Fte=ut.createElement(Pte,null),EE=class extends ut.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?ut.createElement(_s.Provider,{value:this.props.routeContext},ut.createElement(hR.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Dte(e){let{routeContext:t,match:r,children:n}=e,i=ut.useContext(Lg);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),ut.createElement(_s.Provider,{value:t},n)}function Bte(e,t,r){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var i;if((i=r)!=null&&i.errors)e=r.matches;else return null}let a=e,o=(n=r)==null?void 0:n.errors;if(o!=null){let s=a.findIndex(l=>l.route.id&&o?.[l.route.id]);s>=0||Wr(!1),a=a.slice(0,Math.min(a.length,s+1))}return a.reduceRight((s,l,c)=>{let f=l.route.id?o?.[l.route.id]:null,u=null;r&&(u=l.route.errorElement||Fte);let h=t.concat(a.slice(0,c+1)),g=()=>{let _;return f?_=u:l.route.Component?_=ut.createElement(l.route.Component,null):l.route.element?_=l.route.element:_=s,ut.createElement(Dte,{match:l,routeContext:{outlet:s,matches:h,isDataRoute:r!=null},children:_})};return r&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?ut.createElement(EE,{location:r.location,revalidation:r.revalidation,component:u,error:f,children:g(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):g()},null)}var OE;(function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate"})(OE||(OE={}));var Tg;(function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId"})(Tg||(Tg={}));function Rte(e){let t=ut.useContext(Lg);return t||Wr(!1),t}function Mte(e){let t=ut.useContext(O_);return t||Wr(!1),t}function jte(e){let t=ut.useContext(_s);return t||Wr(!1),t}function mR(e){let t=jte(e),r=t.matches[t.matches.length-1];return r.route.id||Wr(!1),r.route.id}function A_(){var e;let t=ut.useContext(hR),r=Mte(Tg.UseRouteError),n=mR(Tg.UseRouteError);return t||((e=r.errors)==null?void 0:e[n])}function $te(){let{router:e}=Rte(OE.UseNavigateStable),t=mR(Tg.UseNavigateStable),r=ut.useRef(!1);return gR(()=>{r.current=!0}),ut.useCallback(function(i,a){a===void 0&&(a={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,E_({fromRouteId:t},a)))},[e,t])}function Uc(e){Wr(!1)}function CE(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Ya.Pop,navigator:a,static:o=!1}=e;Vf()&&Wr(!1);let s=t.replace(/^\/*/,"/"),l=ut.useMemo(()=>({basename:s,navigator:a,static:o}),[s,a,o]);typeof n=="string"&&(n=To(n));let{pathname:c="/",search:f="",hash:u="",state:h=null,key:g="default"}=n,_=ut.useMemo(()=>{let w=Cg(c,s);return w==null?null:{location:{pathname:w,search:f,hash:u,state:h,key:g},navigationType:i}},[s,c,f,u,h,g,i]);return _==null?null:ut.createElement(bs.Provider,{value:l},ut.createElement(Pg.Provider,{children:r,value:_}))}function TE(e){let{children:t,location:r}=e;return yR(Ng(t),r)}var dR;(function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"})(dR||(dR={}));var NCe=new Promise(()=>{});function Ng(e,t){t===void 0&&(t=[]);let r=[];return ut.Children.forEach(e,(n,i)=>{if(!ut.isValidElement(n))return;let a=[...t,i];if(n.type===ut.Fragment){r.push.apply(r,Ng(n.props.children,a));return}n.type!==Uc&&Wr(!1),!n.props.index||!n.props.children||Wr(!1);let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Ng(n.props.children,a)),r.push(o)}),r}function I_(){return I_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I_.apply(this,arguments)}function _R(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Hte(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Wte(e,t){return e.button===0&&(!t||t==="_self")&&!Hte(e)}var Jte=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],Gte=["aria-current","caseSensitive","className","end","style","to","children"];function wR(e){let{basename:t,children:r,window:n}=e,i=tn.useRef();i.current==null&&(i.current=lR({window:n,v5Compat:!0}));let a=i.current,[o,s]=tn.useState({action:a.action,location:a.location});return tn.useLayoutEffect(()=>a.listen(s),[a]),tn.createElement(CE,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a})}var Yte=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Kte=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,No=tn.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:a,replace:o,state:s,target:l,to:c,preventScrollReset:f}=t,u=_R(t,Jte),{basename:h}=tn.useContext(bs),g,_=!1;if(typeof c=="string"&&Kte.test(c)&&(g=c,Yte))try{let A=new URL(window.location.href),O=c.startsWith("//")?new URL(A.protocol+c):new URL(c),C=Cg(O.pathname,h);O.origin===A.origin&&C!=null?c=C+O.search+O.hash:_=!0}catch{}let w=AE(c,{relative:i}),E=Xte(c,{replace:o,state:s,target:l,preventScrollReset:f,relative:i});function S(A){n&&n(A),A.defaultPrevented||E(A)}return tn.createElement("a",I_({},u,{href:g||w,onClick:_||a?n:S,ref:r,target:l}))}),SR=tn.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:i=!1,className:a="",end:o=!1,style:s,to:l,children:c}=t,f=_R(t,Gte),u=Fg(l,{relative:f.relative}),h=ws(),g=tn.useContext(O_),{navigator:_}=tn.useContext(bs),w=_.encodeLocation?_.encodeLocation(u).pathname:u.pathname,E=h.pathname,S=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;i||(E=E.toLowerCase(),S=S?S.toLowerCase():null,w=w.toLowerCase());let A=E===w||!o&&E.startsWith(w)&&E.charAt(w.length)==="/",O=S!=null&&(S===w||!o&&S.startsWith(w)&&S.charAt(w.length)==="/"),C=A?n:void 0,T;typeof a=="function"?T=a({isActive:A,isPending:O}):T=[a,A?"active":null,O?"pending":null].filter(Boolean).join(" ");let D=typeof s=="function"?s({isActive:A,isPending:O}):s;return tn.createElement(No,I_({},f,{"aria-current":C,className:T,ref:r,style:D,to:l}),typeof c=="function"?c({isActive:A,isPending:O}):c)});var vR;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(vR||(vR={}));var bR;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(bR||(bR={}));function Xte(e,t){let{target:r,replace:n,state:i,preventScrollReset:a,relative:o}=t===void 0?{}:t,s=IE(),l=ws(),c=Fg(e,{relative:o});return tn.useCallback(f=>{if(Wte(f,r)){f.preventDefault();let u=n!==void 0?n:$c(l)===$c(c);s(e,{replace:u,state:i,preventScrollReset:a,relative:o})}},[l,s,c,n,i,r,e,a,o])}var qc=oe(He(),1);function xR(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=xR(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function NE(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=xR(e))&&(n&&(n+=" "),n+=t);return n}var kR=NE;function ER(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=OR(t))&&(n&&(n+=" "),n+=r);return n}function OR(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=OR(e[n]))&&(r&&(r+=" "),r+=t);return r}var PE="-";function CR(e){var t=Qte(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,i=n===void 0?{}:n;function a(s){var l=s.split(PE);return l[0]===""&&l.length!==1&&l.shift(),TR(l,t)||Zte(s)}function o(s,l){var c=r[s]||[];return l&&i[s]?[].concat(c,i[s]):c}return{getClassGroupId:a,getConflictingClassGroupIds:o}}function TR(e,t){if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),i=n?TR(e.slice(1),n):void 0;if(i)return i;if(t.validators.length!==0){var a=e.join(PE);return t.validators.find(function(o){var s=o.validator;return s(a)})?.classGroupId}}var AR=/^\[(.+)\]$/;function Zte(e){if(AR.test(e)){var t=AR.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function Qte(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},i=tre(Object.entries(e.classGroups),r);return i.forEach(function(a){var o=a[0],s=a[1];LE(s,n,o,t)}),n}function LE(e,t,r,n){e.forEach(function(i){if(typeof i=="string"){var a=i===""?t:IR(t,i);a.classGroupId=r;return}if(typeof i=="function"){if(ere(i)){LE(i(n),t,r,n);return}t.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(function(o){var s=o[0],l=o[1];LE(l,IR(t,s),r,n)})})}function IR(e,t){var r=e;return t.split(PE).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function ere(e){return e.isThemeGetter}function tre(e,t){return t?e.map(function(r){var n=r[0],i=r[1],a=i.map(function(o){return typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(s){var l=s[0],c=s[1];return[t+l,c]})):o});return[n,a]}):e}function NR(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function i(a,o){r.set(a,o),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(o){var s=r.get(o);if(s!==void 0)return s;if((s=n.get(o))!==void 0)return i(o,s),s},set:function(o,s){r.has(o)?r.set(o,s):i(o,s)}}}var FE="!";function LR(e){var t=e.separator||":",r=t.length===1,n=t[0],i=t.length;return function(o){for(var s=[],l=0,c=0,f,u=0;u<o.length;u++){var h=o[u];if(l===0){if(h===n&&(r||o.slice(u,u+i)===t)){s.push(o.slice(c,u)),c=u+i;continue}if(h==="/"){f=u;continue}}h==="["?l++:h==="]"&&l--}var g=s.length===0?o:o.substring(c),_=g.startsWith(FE),w=_?g.substring(1):g,E=f&&f>c?f-c:void 0;return{modifiers:s,hasImportantModifier:_,baseClassName:w,maybePostfixModifierPosition:E}}}function PR(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var i=n[0]==="[";i?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function FR(e){return{cache:NR(e.cacheSize),splitModifiers:LR(e),...CR(e)}}var rre=/\s+/;function DR(e,t){var r=t.splitModifiers,n=t.getClassGroupId,i=t.getConflictingClassGroupIds,a=new Set;return e.trim().split(rre).map(function(o){var s=r(o),l=s.modifiers,c=s.hasImportantModifier,f=s.baseClassName,u=s.maybePostfixModifierPosition,h=n(u?f.substring(0,u):f),g=!!u;if(!h){if(!u)return{isTailwindClass:!1,originalClassName:o};if(h=n(f),!h)return{isTailwindClass:!1,originalClassName:o};g=!1}var _=PR(l).join(":"),w=c?_+FE:_;return{isTailwindClass:!0,modifierId:w,classGroupId:h,originalClassName:o,hasPostfixModifier:g}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var s=o.modifierId,l=o.classGroupId,c=o.hasPostfixModifier,f=s+l;return a.has(f)?!1:(a.add(f),i(l,c).forEach(function(u){return a.add(s+u)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function BR(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i,a,o=s;function s(c){var f=t[0],u=t.slice(1),h=u.reduce(function(g,_){return _(g)},f());return n=FR(h),i=n.cache.get,a=n.cache.set,o=l,l(c)}function l(c){var f=i(c);if(f)return f;var u=DR(c,n);return a(c,u),u}return function(){return o(ER.apply(null,arguments))}}function _r(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var MR=/^\[(?:([a-z-]+):)?(.+)\]$/i,nre=/^\d+\/\d+$/,ire=new Set(["px","full","screen"]),are=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ore=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|^0$/,sre=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function ka(e){return El(e)||ire.has(e)||nre.test(e)||Ss(e)}function Ss(e){return zc(e,"length",lre)}function jR(e){return zc(e,"size",VR)}function $R(e){return zc(e,"position",VR)}function UR(e){return zc(e,"url",cre)}function Dg(e){return zc(e,"number",El)}function El(e){return!Number.isNaN(Number(e))}function zR(e){return e.endsWith("%")&&El(e.slice(0,-1))}function Hf(e){return RR(e)||zc(e,"number",RR)}function Jr(e){return MR.test(e)}function Wf(){return!0}function xs(e){return are.test(e)}function qR(e){return zc(e,"",ure)}function zc(e,t,r){var n=MR.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function lre(e){return ore.test(e)}function VR(){return!1}function cre(e){return e.startsWith("url(")}function RR(e){return Number.isInteger(Number(e))}function ure(e){return sre.test(e)}function HR(){var e=_r("colors"),t=_r("spacing"),r=_r("blur"),n=_r("brightness"),i=_r("borderColor"),a=_r("borderRadius"),o=_r("borderSpacing"),s=_r("borderWidth"),l=_r("contrast"),c=_r("grayscale"),f=_r("hueRotate"),u=_r("invert"),h=_r("gap"),g=_r("gradientColorStops"),_=_r("gradientColorStopPositions"),w=_r("inset"),E=_r("margin"),S=_r("opacity"),A=_r("padding"),O=_r("saturate"),C=_r("scale"),T=_r("sepia"),D=_r("skew"),P=_r("space"),z=_r("translate"),ne=function(){return["auto","contain","none"]},V=function(){return["auto","hidden","clip","visible","scroll"]},X=function(){return["auto",t]},Q=function(){return["",ka]},ie=function(){return["auto",El,Jr]},pe=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},de=function(){return["solid","dashed","dotted","double","none"]},F=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},H=function(){return["start","end","center","between","around","evenly","stretch"]},Z=function(){return["","0",Jr]},j=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},$=function(){return[El,Dg]},q=function(){return[El,Jr]};return{cacheSize:500,theme:{colors:[Wf],spacing:[ka],blur:["none","",xs,Ss],brightness:$(),borderColor:[e],borderRadius:["none","","full",xs,Ss],borderSpacing:[t],borderWidth:Q(),contrast:$(),grayscale:Z(),hueRotate:q(),invert:Z(),gap:[t],gradientColorStops:[e],gradientColorStopPositions:[zR,Ss],inset:X(),margin:X(),opacity:$(),padding:[t],saturate:$(),scale:$(),sepia:Z(),skew:q(),space:[t],translate:[t]},classGroups:{aspect:[{aspect:["auto","square","video",Jr]}],container:["container"],columns:[{columns:[xs]}],"break-after":[{"break-after":j()}],"break-before":[{"break-before":j()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(pe(),[Jr])}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:ne()}],"overscroll-x":[{"overscroll-x":ne()}],"overscroll-y":[{"overscroll-y":ne()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[w]}],"inset-x":[{"inset-x":[w]}],"inset-y":[{"inset-y":[w]}],start:[{start:[w]}],end:[{end:[w]}],top:[{top:[w]}],right:[{right:[w]}],bottom:[{bottom:[w]}],left:[{left:[w]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Hf]}],basis:[{basis:[t]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Jr]}],grow:[{grow:Z()}],shrink:[{shrink:Z()}],order:[{order:["first","last","none",Hf]}],"grid-cols":[{"grid-cols":[Wf]}],"col-start-end":[{col:["auto",{span:[Hf]},Jr]}],"col-start":[{"col-start":ie()}],"col-end":[{"col-end":ie()}],"grid-rows":[{"grid-rows":[Wf]}],"row-start-end":[{row:["auto",{span:[Hf]},Jr]}],"row-start":[{"row-start":ie()}],"row-end":[{"row-end":ie()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Jr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Jr]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal"].concat(H())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(H(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(H(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[A]}],px:[{px:[A]}],py:[{py:[A]}],ps:[{ps:[A]}],pe:[{pe:[A]}],pt:[{pt:[A]}],pr:[{pr:[A]}],pb:[{pb:[A]}],pl:[{pl:[A]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",t]}],"min-w":[{"min-w":["min","max","fit",ka]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[xs]},xs,Ss]}],h:[{h:[t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",ka]}],"max-h":[{"max-h":[t,"min","max","fit"]}],"font-size":[{text:["base",xs,Ss]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Dg]}],"font-family":[{font:[Wf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ss]}],"line-clamp":[{"line-clamp":["none",El,Dg]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ka]}],"list-image":[{"list-image":["none",Jr]}],"list-style-type":[{list:["none","disc","decimal",Jr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[S]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[S]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(de(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",ka]}],"underline-offset":[{"underline-offset":["auto",ka]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:[t]}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ss]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Jr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[S]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(pe(),[$R])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",jR]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},UR]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[_]}],"gradient-via-pos":[{via:[_]}],"gradient-to-pos":[{to:[_]}],"gradient-from":[{from:[g]}],"gradient-via":[{via:[g]}],"gradient-to":[{to:[g]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[S]}],"border-style":[{border:[].concat(de(),["hidden"])}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[S]}],"divide-style":[{divide:de()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:[""].concat(de())}],"outline-offset":[{"outline-offset":[ka]}],"outline-w":[{outline:[ka]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[S]}],"ring-offset-w":[{"ring-offset":[ka]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",xs,qR]}],"shadow-color":[{shadow:[Wf]}],opacity:[{opacity:[S]}],"mix-blend":[{"mix-blend":F()}],"bg-blend":[{"bg-blend":F()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",xs,Jr]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[u]}],saturate:[{saturate:[O]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[S]}],"backdrop-saturate":[{"backdrop-saturate":[O]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Jr]}],duration:[{duration:q()}],ease:[{ease:["linear","in","out","in-out",Jr]}],delay:[{delay:q()}],animate:[{animate:["none","spin","ping","pulse","bounce",Jr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[Hf,Jr]}],"translate-x":[{"translate-x":[z]}],"translate-y":[{"translate-y":[z]}],"skew-x":[{"skew-x":[D]}],"skew-y":[{"skew-y":[D]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Jr]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Jr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":[t]}],"scroll-mx":[{"scroll-mx":[t]}],"scroll-my":[{"scroll-my":[t]}],"scroll-ms":[{"scroll-ms":[t]}],"scroll-me":[{"scroll-me":[t]}],"scroll-mt":[{"scroll-mt":[t]}],"scroll-mr":[{"scroll-mr":[t]}],"scroll-mb":[{"scroll-mb":[t]}],"scroll-ml":[{"scroll-ml":[t]}],"scroll-p":[{"scroll-p":[t]}],"scroll-px":[{"scroll-px":[t]}],"scroll-py":[{"scroll-py":[t]}],"scroll-ps":[{"scroll-ps":[t]}],"scroll-pe":[{"scroll-pe":[t]}],"scroll-pt":[{"scroll-pt":[t]}],"scroll-pr":[{"scroll-pr":[t]}],"scroll-pb":[{"scroll-pb":[t]}],"scroll-pl":[{"scroll-pl":[t]}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Jr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ka,Dg]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var DE=BR(HR);function Nt(...e){return DE(NE(e))}var Vc=oe(mt(),1),Jf=qc.forwardRef(({className:e,...t},r)=>(0,Vc.jsx)("div",{ref:r,className:Nt("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Jf.displayName="Card";var Gf=qc.forwardRef(({className:e,...t},r)=>(0,Vc.jsx)("div",{ref:r,className:Nt("flex flex-col space-y-1.5 p-6",e),...t}));Gf.displayName="CardHeader";var Yf=qc.forwardRef(({className:e,...t},r)=>(0,Vc.jsx)("h3",{ref:r,className:Nt("text-lg font-semibold leading-none tracking-tight",e),...t}));Yf.displayName="CardTitle";var BE=qc.forwardRef(({className:e,...t},r)=>(0,Vc.jsx)("p",{ref:r,className:Nt("text-sm text-muted-foreground",e),...t}));BE.displayName="CardDescription";var Kf=qc.forwardRef(({className:e,...t},r)=>(0,Vc.jsx)("div",{ref:r,className:Nt("p-6 pt-0",e),...t}));Kf.displayName="CardContent";var mre=qc.forwardRef(({className:e,...t},r)=>(0,Vc.jsx)("div",{ref:r,className:Nt(" flex items-center p-6 pt-0",e),...t}));mre.displayName="CardFooter";var F_=oe(He(),1);function Ge(){return Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ge.apply(this,arguments)}var En=oe(He(),1);function pt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(i){if(e?.(i),r===!1||!i.defaultPrevented)return t?.(i)}}var Ka=oe(He(),1);function Qn(e,t=[]){let r=[];function n(a,o){let s=(0,Ka.createContext)(o),l=r.length;r=[...r,o];function c(u){let{scope:h,children:g,..._}=u,w=h?.[e][l]||s,E=(0,Ka.useMemo)(()=>_,Object.values(_));return(0,Ka.createElement)(w.Provider,{value:E},g)}function f(u,h){let g=h?.[e][l]||s,_=(0,Ka.useContext)(g);if(_)return _;if(o!==void 0)return o;throw new Error(`\`${u}\` must be used within \`${a}\``)}return c.displayName=a+"Provider",[c,f]}let i=()=>{let a=r.map(o=>(0,Ka.createContext)(o));return function(s){let l=s?.[e]||a;return(0,Ka.useMemo)(()=>({[`__scope${e}`]:{...s,[e]:l}}),[s,l])}};return i.scopeName=e,[n,vre(i,...t)]}function vre(...e){let t=e[0];if(e.length===1)return t;let r=()=>{let n=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(a){let o=n.reduce((s,{useScope:l,scopeName:c})=>{let u=l(a)[`__scope${c}`];return{...s,...u}},{});return(0,Ka.useMemo)(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}var wr=oe(He(),1);var Xa=oe(He(),1);var YR=oe(He(),1);function bre(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function Hc(...e){return t=>e.forEach(r=>bre(r,t))}function lr(...e){return(0,YR.useCallback)(Hc(...e),e)}var zr=oe(He(),1);var Ea=(0,zr.forwardRef)((e,t)=>{let{children:r,...n}=e,i=zr.Children.toArray(r),a=i.find(wre);if(a){let o=a.props.children,s=i.map(l=>l===a?zr.Children.count(o)>1?zr.Children.only(null):(0,zr.isValidElement)(o)?o.props.children:null:l);return(0,zr.createElement)(RE,Ge({},n,{ref:t}),(0,zr.isValidElement)(o)?(0,zr.cloneElement)(o,void 0,s):null)}return(0,zr.createElement)(RE,Ge({},n,{ref:t}),r)});Ea.displayName="Slot";var RE=(0,zr.forwardRef)((e,t)=>{let{children:r,...n}=e;return(0,zr.isValidElement)(r)?(0,zr.cloneElement)(r,{...Sre(n,r.props),ref:t?Hc(t,r.ref):r.ref}):zr.Children.count(r)>1?zr.Children.only(null):null});RE.displayName="SlotClone";var _re=({children:e})=>(0,zr.createElement)(zr.Fragment,null,e);function wre(e){return(0,zr.isValidElement)(e)&&e.type===_re}function Sre(e,t){let r={...t};for(let n in t){let i=e[n],a=t[n];/^on[A-Z]/.test(n)?i&&a?r[n]=(...s)=>{a(...s),i(...s)}:i&&(r[n]=i):n==="style"?r[n]={...i,...a}:n==="className"&&(r[n]=[i,a].filter(Boolean).join(" "))}return{...e,...r}}function Xf(e){let t=e+"CollectionProvider",[r,n]=Qn(t),[i,a]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=g=>{let{scope:_,children:w}=g,E=Xa.default.useRef(null),S=Xa.default.useRef(new Map).current;return Xa.default.createElement(i,{scope:_,itemMap:S,collectionRef:E},w)},s=e+"CollectionSlot",l=Xa.default.forwardRef((g,_)=>{let{scope:w,children:E}=g,S=a(s,w),A=lr(_,S.collectionRef);return Xa.default.createElement(Ea,{ref:A},E)}),c=e+"CollectionItemSlot",f="data-radix-collection-item",u=Xa.default.forwardRef((g,_)=>{let{scope:w,children:E,...S}=g,A=Xa.default.useRef(null),O=lr(_,A),C=a(c,w);return Xa.default.useEffect(()=>(C.itemMap.set(A,{ref:A,...S}),()=>void C.itemMap.delete(A))),Xa.default.createElement(Ea,{[f]:"",ref:O},E)});function h(g){let _=a(e+"CollectionConsumer",g);return Xa.default.useCallback(()=>{let E=_.collectionRef.current;if(!E)return[];let S=Array.from(E.querySelectorAll(`[${f}]`));return Array.from(_.itemMap.values()).sort((C,T)=>S.indexOf(C.ref.current)-S.indexOf(T.ref.current))},[_.collectionRef,_.itemMap])}return[{Provider:o,Slot:l,ItemSlot:u},h,n]}var ME=oe(He(),1);var KR=oe(He(),1),kn=globalThis?.document?KR.useLayoutEffect:()=>{};var xre=ME["useId".toString()]||(()=>{}),kre=0;function Za(e){let[t,r]=ME.useState(xre());return kn(()=>{e||r(n=>n??String(kre++))},[e]),e||(t?`radix-${t}`:"")}var Zf=oe(He(),1),XR=oe(Io(),1);var Ere=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ot=Ere.reduce((e,t)=>{let r=(0,Zf.forwardRef)((n,i)=>{let{asChild:a,...o}=n,s=a?Ea:t;return(0,Zf.useEffect)(()=>{window[Symbol.for("radix-ui")]=!0},[]),(0,Zf.createElement)(s,Ge({},o,{ref:i}))});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function T_(e,t){e&&(0,XR.flushSync)(()=>e.dispatchEvent(t))}var Qf=oe(He(),1);function rn(e){let t=(0,Qf.useRef)(e);return(0,Qf.useEffect)(()=>{t.current=e}),(0,Qf.useMemo)(()=>(...r)=>{var n;return(n=t.current)===null||n===void 0?void 0:n.call(t,...r)},[])}var Ol=oe(He(),1);function ks({prop:e,defaultProp:t,onChange:r=()=>{}}){let[n,i]=Ore({defaultProp:t,onChange:r}),a=e!==void 0,o=a?e:n,s=rn(r),l=(0,Ol.useCallback)(c=>{if(a){let u=typeof c=="function"?c(e):c;u!==e&&s(u)}else i(c)},[a,e,i,s]);return[o,l]}function Ore({defaultProp:e,onChange:t}){let r=(0,Ol.useState)(e),[n]=r,i=(0,Ol.useRef)(n),a=rn(t);return(0,Ol.useEffect)(()=>{i.current!==n&&(a(n),i.current=n)},[n,i,a]),r}var Bg=oe(He(),1),Are=(0,Bg.createContext)(void 0);function Al(e){let t=(0,Bg.useContext)(Are);return e||t||"ltr"}var jE="rovingFocusGroup.onEntryFocus",Ire={bubbles:!1,cancelable:!0},UE="RovingFocusGroup",[$E,ZR,Cre]=Xf(UE),[Tre,ed]=Qn(UE,[Cre]),[Nre,Lre]=Tre(UE),Pre=(0,wr.forwardRef)((e,t)=>(0,wr.createElement)($E.Provider,{scope:e.__scopeRovingFocusGroup},(0,wr.createElement)($E.Slot,{scope:e.__scopeRovingFocusGroup},(0,wr.createElement)(Fre,Ge({},e,{ref:t}))))),Fre=(0,wr.forwardRef)((e,t)=>{let{__scopeRovingFocusGroup:r,orientation:n,loop:i=!1,dir:a,currentTabStopId:o,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:l,onEntryFocus:c,...f}=e,u=(0,wr.useRef)(null),h=lr(t,u),g=Al(a),[_=null,w]=ks({prop:o,defaultProp:s,onChange:l}),[E,S]=(0,wr.useState)(!1),A=rn(c),O=ZR(r),C=(0,wr.useRef)(!1),[T,D]=(0,wr.useState)(0);return(0,wr.useEffect)(()=>{let P=u.current;if(P)return P.addEventListener(jE,A),()=>P.removeEventListener(jE,A)},[A]),(0,wr.createElement)(Nre,{scope:r,orientation:n,dir:g,loop:i,currentTabStopId:_,onItemFocus:(0,wr.useCallback)(P=>w(P),[w]),onItemShiftTab:(0,wr.useCallback)(()=>S(!0),[]),onFocusableItemAdd:(0,wr.useCallback)(()=>D(P=>P+1),[]),onFocusableItemRemove:(0,wr.useCallback)(()=>D(P=>P-1),[])},(0,wr.createElement)(Ot.div,Ge({tabIndex:E||T===0?-1:0,"data-orientation":n},f,{ref:h,style:{outline:"none",...e.style},onMouseDown:pt(e.onMouseDown,()=>{C.current=!0}),onFocus:pt(e.onFocus,P=>{let z=!C.current;if(P.target===P.currentTarget&&z&&!E){let ne=new CustomEvent(jE,Ire);if(P.currentTarget.dispatchEvent(ne),!ne.defaultPrevented){let V=O().filter(de=>de.focusable),X=V.find(de=>de.active),Q=V.find(de=>de.id===_),pe=[X,Q,...V].filter(Boolean).map(de=>de.ref.current);QR(pe)}}C.current=!1}),onBlur:pt(e.onBlur,()=>S(!1))})))}),Dre="RovingFocusGroupItem",Bre=(0,wr.forwardRef)((e,t)=>{let{__scopeRovingFocusGroup:r,focusable:n=!0,active:i=!1,tabStopId:a,...o}=e,s=Za(),l=a||s,c=Lre(Dre,r),f=c.currentTabStopId===l,u=ZR(r),{onFocusableItemAdd:h,onFocusableItemRemove:g}=c;return(0,wr.useEffect)(()=>{if(n)return h(),()=>g()},[n,h,g]),(0,wr.createElement)($E.ItemSlot,{scope:r,id:l,focusable:n,active:i},(0,wr.createElement)(Ot.span,Ge({tabIndex:f?0:-1,"data-orientation":c.orientation},o,{ref:t,onMouseDown:pt(e.onMouseDown,_=>{n?c.onItemFocus(l):_.preventDefault()}),onFocus:pt(e.onFocus,()=>c.onItemFocus(l)),onKeyDown:pt(e.onKeyDown,_=>{if(_.key==="Tab"&&_.shiftKey){c.onItemShiftTab();return}if(_.target!==_.currentTarget)return;let w=jre(_,c.orientation,c.dir);if(w!==void 0){_.preventDefault();let S=u().filter(A=>A.focusable).map(A=>A.ref.current);if(w==="last")S.reverse();else if(w==="prev"||w==="next"){w==="prev"&&S.reverse();let A=S.indexOf(_.currentTarget);S=c.loop?$re(S,A+1):S.slice(A+1)}setTimeout(()=>QR(S))}})})))}),Rre={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Mre(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function jre(e,t,r){let n=Mre(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Rre[n]}function QR(e){let t=document.activeElement;for(let r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function $re(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var N_=Pre,L_=Bre;var ei=oe(He(),1),eM=oe(Io(),1);function Ure(e,t){return(0,ei.useReducer)((r,n)=>{let i=t[r][n];return i??r},e)}var Il=e=>{let{present:t,children:r}=e,n=zre(t),i=typeof r=="function"?r({present:n.isPresent}):ei.Children.only(r),a=lr(n.ref,i.ref);return typeof r=="function"||n.isPresent?(0,ei.cloneElement)(i,{ref:a}):null};Il.displayName="Presence";function zre(e){let[t,r]=(0,ei.useState)(),n=(0,ei.useRef)({}),i=(0,ei.useRef)(e),a=(0,ei.useRef)("none"),o=e?"mounted":"unmounted",[s,l]=Ure(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,ei.useEffect)(()=>{let c=P_(n.current);a.current=s==="mounted"?c:"none"},[s]),kn(()=>{let c=n.current,f=i.current;if(f!==e){let h=a.current,g=P_(c);e?l("MOUNT"):g==="none"||c?.display==="none"?l("UNMOUNT"):l(f&&h!==g?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,l]),kn(()=>{if(t){let c=u=>{let g=P_(n.current).includes(u.animationName);u.target===t&&g&&(0,eM.flushSync)(()=>l("ANIMATION_END"))},f=u=>{u.target===t&&(a.current=P_(n.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",c),t.addEventListener("animationend",c),()=>{t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",c),t.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:(0,ei.useCallback)(c=>{c&&(n.current=getComputedStyle(c)),r(c)},[])}}function P_(e){return e?.animationName||"none"}var tM="Tabs",[qre,I3e]=Qn(tM,[ed]),rM=ed(),[Vre,zE]=qre(tM),Hre=(0,En.forwardRef)((e,t)=>{let{__scopeTabs:r,value:n,onValueChange:i,defaultValue:a,orientation:o="horizontal",dir:s,activationMode:l="automatic",...c}=e,f=Al(s),[u,h]=ks({prop:n,onChange:i,defaultProp:a});return(0,En.createElement)(Vre,{scope:r,baseId:Za(),value:u,onValueChange:h,orientation:o,dir:f,activationMode:l},(0,En.createElement)(Ot.div,Ge({dir:f,"data-orientation":o},c,{ref:t})))}),Wre="TabsList",Jre=(0,En.forwardRef)((e,t)=>{let{__scopeTabs:r,loop:n=!0,...i}=e,a=zE(Wre,r),o=rM(r);return(0,En.createElement)(N_,Ge({asChild:!0},o,{orientation:a.orientation,dir:a.dir,loop:n}),(0,En.createElement)(Ot.div,Ge({role:"tablist","aria-orientation":a.orientation},i,{ref:t})))}),Gre="TabsTrigger",Yre=(0,En.forwardRef)((e,t)=>{let{__scopeTabs:r,value:n,disabled:i=!1,...a}=e,o=zE(Gre,r),s=rM(r),l=nM(o.baseId,n),c=iM(o.baseId,n),f=n===o.value;return(0,En.createElement)(L_,Ge({asChild:!0},s,{focusable:!i,active:f}),(0,En.createElement)(Ot.button,Ge({type:"button",role:"tab","aria-selected":f,"aria-controls":c,"data-state":f?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:l},a,{ref:t,onMouseDown:pt(e.onMouseDown,u=>{!i&&u.button===0&&u.ctrlKey===!1?o.onValueChange(n):u.preventDefault()}),onKeyDown:pt(e.onKeyDown,u=>{[" ","Enter"].includes(u.key)&&o.onValueChange(n)}),onFocus:pt(e.onFocus,()=>{let u=o.activationMode!=="manual";!f&&!i&&u&&o.onValueChange(n)})})))}),Kre="TabsContent",Xre=(0,En.forwardRef)((e,t)=>{let{__scopeTabs:r,value:n,forceMount:i,children:a,...o}=e,s=zE(Kre,r),l=nM(s.baseId,n),c=iM(s.baseId,n),f=n===s.value,u=(0,En.useRef)(f);return(0,En.useEffect)(()=>{let h=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(h)},[]),(0,En.createElement)(Il,{present:i||f},({present:h})=>(0,En.createElement)(Ot.div,Ge({"data-state":f?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0},o,{ref:t,style:{...e.style,animationDuration:u.current?"0s":void 0}}),h&&a))});function nM(e,t){return`${e}-trigger-${t}`}function iM(e,t){return`${e}-content-${t}`}var aM=Hre,qE=Jre,VE=Yre,HE=Xre;var B_=oe(mt(),1),oM=aM,WE=F_.forwardRef(({className:e,...t},r)=>(0,B_.jsx)(qE,{ref:r,className:Nt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));WE.displayName=qE.displayName;var td=F_.forwardRef(({className:e,...t},r)=>(0,B_.jsx)(VE,{ref:r,className:Nt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));td.displayName=VE.displayName;var D_=F_.forwardRef(({className:e,...t},r)=>(0,B_.jsx)(HE,{ref:r,className:Nt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));D_.displayName=HE.displayName;var i0=oe(He()),g4=oe(qr());var c4=oe(Oa()),u4=oe(fn()),f4=oe(M_()),lO=oe(Jc()),sd=oe(Aa()),Kc=oe(Vr()),ld=oe(He()),d4=oe(Yj());var Zj=oe(Jc()),Qj=oe(Vr()),iO=oe(nO()),e4=oe(rO()),t0=oe(M_()),Un=function(t){return t===0?0:t>0?1:-1},As=function(t){return(0,t0.default)(t)&&t.indexOf("%")===t.length-1},Ue=function(t){return(0,e4.default)(t)&&!(0,iO.default)(t)},Sr=function(t){return Ue(t)||(0,t0.default)(t)},roe=0,Lo=function(t){var r=++roe;return"".concat(t||"").concat(r)},Po=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ue(t)&&!(0,t0.default)(t))return n;var a;if(As(t)){var o=t.indexOf("%");a=r*parseFloat(t.slice(0,o))/100}else a=+t;return(0,iO.default)(a)&&(a=n),i&&a>r&&(a=r),a},Is=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},t4=function(t){if(!(0,Qj.default)(t))return!1;for(var r=t.length,n={},i=0;i<r;i++)if(!n[t[i]])n[t[i]]=!0;else return!0;return!1},ia=function(t,r){return Ue(t)&&Ue(r)?function(n){return t+n*(r-t)}:function(){return r}};function od(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):(0,Zj.default)(n,t))===r})}function Cs(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}var oO=oe(Oa()),n4=oe(He());function aO(e){"@babel/helpers - typeof";return aO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aO(e)}var noe=["viewBox","children"],i4=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],r4=["points","pathLength"],r0={svg:noe,polygon:r4,polyline:r4},n0=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Gc=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if((0,n4.isValidElement)(t)&&(n=t.props),!(0,oO.default)(n))return null;var i={};return Object.keys(n).forEach(function(a){n0.includes(a)&&(i[a]=r||function(o){return n[a](n,o)})}),i},ioe=function(t,r,n){return function(i){return t(r,n,i),null}},Yc=function(t,r,n){if(!(0,oO.default)(t)||aO(t)!=="object")return null;var i=null;return Object.keys(t).forEach(function(a){var o=t[a];n0.includes(a)&&typeof o=="function"&&(i||(i={}),i[a]=ioe(o,r,n))}),i};var aoe=["children"],ooe=["children"];function a4(e,t){if(e==null)return{};var r=soe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function soe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}var o4={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"};var Fo=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},s4=null,sO=null,cO=function e(t){if(t===s4&&(0,Kc.default)(sO))return sO;var r=[];return ld.Children.forEach(t,function(n){(0,sd.default)(n)||((0,d4.isFragment)(n)?r=r.concat(e(n.props.children)):r.push(n))}),sO=r,s4=t,r};function vn(e,t){var r=[],n=[];return(0,Kc.default)(t)?n=t.map(function(i){return Fo(i)}):n=[Fo(t)],cO(e).forEach(function(i){var a=(0,lO.default)(i,"type.displayName")||(0,lO.default)(i,"type.name");n.indexOf(a)!==-1&&r.push(i)}),r}function Ia(e,t){var r=vn(e,t);return r&&r[0]}var uO=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,i=r.height;return!(!Ue(n)||n<=0||!Ue(i)||i<=0)},loe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],coe=function(t){return t&&t.type&&(0,f4.default)(t.type)&&loe.indexOf(t.type)>=0},uoe=function(t,r,n,i){var a,o=(a=r0===null||r0===void 0?void 0:r0[i])!==null&&a!==void 0?a:[];return!(0,u4.default)(t)&&(i&&o.includes(r)||i4.includes(r))||n&&n0.includes(r)};var ht=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if((0,ld.isValidElement)(t)&&(i=t.props),!(0,c4.default)(i))return null;var a={};return Object.keys(i).forEach(function(o){var s;uoe((s=i)===null||s===void 0?void 0:s[o],o,r,n)&&(a[o]=i[o])}),a},fO=function e(t,r){if(t===r)return!0;var n=ld.Children.count(t);if(n!==ld.Children.count(r))return!1;if(n===0)return!0;if(n===1)return l4((0,Kc.default)(t)?t[0]:t,(0,Kc.default)(r)?r[0]:r);for(var i=0;i<n;i++){var a=t[i],o=r[i];if((0,Kc.default)(a)||(0,Kc.default)(o)){if(!e(a,o))return!1}else if(!l4(a,o))return!1}return!0},l4=function(t,r){if((0,sd.default)(t)&&(0,sd.default)(r))return!0;if(!(0,sd.default)(t)&&!(0,sd.default)(r)){var n=t.props||{},i=n.children,a=a4(n,aoe),o=r.props||{},s=o.children,l=a4(o,ooe);return i&&s?Cs(a,l)&&fO(i,s):!i&&!s?Cs(a,l):!1}return!1},dO=function(t,r){var n=[],i={};return cO(t).forEach(function(a,o){if(coe(a))n.push(a);else if(a){var s=Fo(a.type),l=r[s]||{},c=l.handler,f=l.once;if(c&&(!f||!i[s])){var u=c(a,s,o);n.push(u),i[s]=!0}}}),n},p4=function(t){var r=t&&t.type;return r&&o4[r]?o4[r]:null},h4=function(t,r){return cO(r).indexOf(t)};var foe=["children","width","height","viewBox","className","style"];function pO(){return pO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pO.apply(this,arguments)}function doe(e,t){if(e==null)return{};var r=poe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function poe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function qg(e){var t=e.children,r=e.width,n=e.height,i=e.viewBox,a=e.className,o=e.style,s=doe(e,foe),l=i||{width:r,height:n,x:0,y:0},c=(0,g4.default)("recharts-surface",a);return i0.default.createElement("svg",pO({},ht(s,!0,"svg"),{className:c,width:r,height:n,style:o,viewBox:"".concat(l.x," ").concat(l.y," ").concat(l.width," ").concat(l.height)}),i0.default.createElement("title",null,e.title),i0.default.createElement("desc",null,e.desc),t)}var gO=oe(He()),y4=oe(qr());var hoe=["children","className"];function hO(){return hO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hO.apply(this,arguments)}function goe(e,t){if(e==null)return{};var r=yoe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yoe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}var tr=gO.default.forwardRef(function(e,t){var r=e.children,n=e.className,i=goe(e,hoe),a=(0,y4.default)("recharts-layer",n);return gO.default.createElement("g",hO({className:a},ht(i,!0),{ref:t}),r)});var wA=oe(fn()),bA=oe(MO()),Nl=oe(He());var aa=oe(He()),H8=oe(qr());var yA=oe(d0()),b0=oe(He());function rr(e){return function(){return e}}var zO=Math.cos;var Gg=Math.sin,An=Math.sqrt;var Qc=Math.PI,vPe=Qc/2,hd=2*Qc;var qO=Math.PI,VO=2*qO,eu=1e-6,jfe=VO-eu;function w8(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function $fe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return w8;let r=10**t;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}var tu=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?w8:$fe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,a,o){this._append`C${+t},${+r},${+n},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(t,r,n,i,a){if(t=+t,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,s=this._y1,l=n-t,c=i-r,f=o-t,u=s-r,h=f*f+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>eu)if(!(Math.abs(u*l-c*f)>eu)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let g=n-o,_=i-s,w=l*l+c*c,E=g*g+_*_,S=Math.sqrt(w),A=Math.sqrt(h),O=a*Math.tan((qO-Math.acos((w+h-E)/(2*S*A)))/2),C=O/A,T=O/S;Math.abs(C-1)>eu&&this._append`L${t+C*f},${r+C*u}`,this._append`A${a},${a},0,0,${+(u*g>f*_)},${this._x1=t+T*l},${this._y1=r+T*c}`}}arc(t,r,n,i,a,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(i),l=n*Math.sin(i),c=t+s,f=r+l,u=1^o,h=o?i-a:a-i;this._x1===null?this._append`M${c},${f}`:(Math.abs(this._x1-c)>eu||Math.abs(this._y1-f)>eu)&&this._append`L${c},${f}`,n&&(h<0&&(h=h%VO+VO),h>jfe?this._append`A${n},${n},0,1,${u},${t-s},${r-l}A${n},${n},0,1,${u},${this._x1=c},${this._y1=f}`:h>eu&&this._append`A${n},${n},0,${+(h>=qO)},${u},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}};function S8(){return new tu}S8.prototype=tu.prototype;function gd(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{let n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new tu(t)}var OPe=Array.prototype.slice;function yd(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function x8(e){this._context=e}x8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Tl(e){return new x8(e)}function p0(e){return e[0]}function h0(e){return e[1]}function Yg(e,t){var r=rr(!0),n=null,i=Tl,a=null,o=gd(s);e=typeof e=="function"?e:e===void 0?p0:rr(e),t=typeof t=="function"?t:t===void 0?h0:rr(t);function s(l){var c,f=(l=yd(l)).length,u,h=!1,g;for(n==null&&(a=i(g=o())),c=0;c<=f;++c)!(c<f&&r(u=l[c],c,l))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+e(u,c,l),+t(u,c,l));if(g)return a=null,g+""||null}return s.x=function(l){return arguments.length?(e=typeof l=="function"?l:rr(+l),s):e},s.y=function(l){return arguments.length?(t=typeof l=="function"?l:rr(+l),s):t},s.defined=function(l){return arguments.length?(r=typeof l=="function"?l:rr(!!l),s):r},s.curve=function(l){return arguments.length?(i=l,n!=null&&(a=i(n)),s):i},s.context=function(l){return arguments.length?(l==null?n=a=null:a=i(n=l),s):n},s}function md(e,t,r){var n=null,i=rr(!0),a=null,o=Tl,s=null,l=gd(c);e=typeof e=="function"?e:e===void 0?p0:rr(+e),t=typeof t=="function"?t:t===void 0?rr(0):rr(+t),r=typeof r=="function"?r:r===void 0?h0:rr(+r);function c(u){var h,g,_,w=(u=yd(u)).length,E,S=!1,A,O=new Array(w),C=new Array(w);for(a==null&&(s=o(A=l())),h=0;h<=w;++h){if(!(h<w&&i(E=u[h],h,u))===S)if(S=!S)g=h,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),_=h-1;_>=g;--_)s.point(O[_],C[_]);s.lineEnd(),s.areaEnd()}S&&(O[h]=+e(E,h,u),C[h]=+t(E,h,u),s.point(n?+n(E,h,u):O[h],r?+r(E,h,u):C[h]))}if(A)return s=null,A+""||null}function f(){return Yg().defined(i).curve(o).context(a)}return c.x=function(u){return arguments.length?(e=typeof u=="function"?u:rr(+u),n=null,c):e},c.x0=function(u){return arguments.length?(e=typeof u=="function"?u:rr(+u),c):e},c.x1=function(u){return arguments.length?(n=u==null?null:typeof u=="function"?u:rr(+u),c):n},c.y=function(u){return arguments.length?(t=typeof u=="function"?u:rr(+u),r=null,c):t},c.y0=function(u){return arguments.length?(t=typeof u=="function"?u:rr(+u),c):t},c.y1=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:rr(+u),c):r},c.lineX0=c.lineY0=function(){return f().x(e).y(t)},c.lineY1=function(){return f().x(e).y(r)},c.lineX1=function(){return f().x(n).y(t)},c.defined=function(u){return arguments.length?(i=typeof u=="function"?u:rr(!!u),c):i},c.curve=function(u){return arguments.length?(o=u,a!=null&&(s=o(a)),c):o},c.context=function(u){return arguments.length?(u==null?a=s=null:s=o(a=u),c):a},c}var vd={draw(e,t){let r=An(t/Qc);e.moveTo(r,0),e.arc(0,0,r,0,hd)}};var HO={draw(e,t){let r=An(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}};var k8=An(1/3),Ufe=k8*2,WO={draw(e,t){let r=An(t/Ufe),n=r*k8;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}};var JO={draw(e,t){let r=An(t),n=-r/2;e.rect(n,n,r,r)}};var zfe=.8908130915292852,E8=Gg(Qc/10)/Gg(7*Qc/10),qfe=Gg(hd/10)*E8,Vfe=-zO(hd/10)*E8,GO={draw(e,t){let r=An(t*zfe),n=qfe*r,i=Vfe*r;e.moveTo(0,-r),e.lineTo(n,i);for(let a=1;a<5;++a){let o=hd*a/5,s=zO(o),l=Gg(o);e.lineTo(l*r,-s*r),e.lineTo(s*n-l*i,l*n+s*i)}e.closePath()}};var YO=An(3),KO={draw(e,t){let r=-An(t/(YO*3));e.moveTo(0,r*2),e.lineTo(-YO*r,-r),e.lineTo(YO*r,-r),e.closePath()}};var Ca=-.5,Ta=An(3)/2,XO=1/An(12),Hfe=(XO/2+1)*3,ZO={draw(e,t){let r=An(t/Hfe),n=r/2,i=r*XO,a=n,o=r*XO+r,s=-a,l=o;e.moveTo(n,i),e.lineTo(a,o),e.lineTo(s,l),e.lineTo(Ca*n-Ta*i,Ta*n+Ca*i),e.lineTo(Ca*a-Ta*o,Ta*a+Ca*o),e.lineTo(Ca*s-Ta*l,Ta*s+Ca*l),e.lineTo(Ca*n+Ta*i,Ca*i-Ta*n),e.lineTo(Ca*a+Ta*o,Ca*o-Ta*a),e.lineTo(Ca*s+Ta*l,Ca*l-Ta*s),e.closePath()}};function g0(e,t){let r=null,n=gd(i);e=typeof e=="function"?e:rr(e||vd),t=typeof t=="function"?t:rr(t===void 0?64:+t);function i(){let a;if(r||(r=a=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(e=typeof a=="function"?a:rr(a),i):e},i.size=function(a){return arguments.length?(t=typeof a=="function"?a:rr(+a),i):t},i.context=function(a){return arguments.length?(r=a??null,i):r},i}function bd(){}function _d(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function O8(e){this._context=e}O8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:_d(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:_d(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function QO(e){return new O8(e)}function A8(e){this._context=e}A8.prototype={areaStart:bd,areaEnd:bd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:_d(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eA(e){return new A8(e)}function I8(e){this._context=e}I8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:_d(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tA(e){return new I8(e)}function C8(e){this._context=e}C8.prototype={areaStart:bd,areaEnd:bd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function rA(e){return new C8(e)}function T8(e){return e<0?-1:1}function N8(e,t,r){var n=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(n||i<0&&-0),o=(r-e._y1)/(i||n<0&&-0),s=(a*i+o*n)/(n+i);return(T8(a)+T8(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function L8(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function nA(e,t,r){var n=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-n)/3;e._context.bezierCurveTo(n+s,i+s*t,a-s,o-s*r,a,o)}function y0(e){this._context=e}y0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:nA(this,this._t0,L8(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,nA(this,L8(this,r=N8(this,e,t)),r);break;default:nA(this,this._t0,r=N8(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function P8(e){this._context=new F8(e)}(P8.prototype=Object.create(y0.prototype)).point=function(e,t){y0.prototype.point.call(this,t,e)};function F8(e){this._context=e}F8.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,a){this._context.bezierCurveTo(t,e,n,r,a,i)}};function iA(e){return new y0(e)}function aA(e){return new P8(e)}function B8(e){this._context=e}B8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=D8(e),i=D8(t),a=0,o=1;o<r;++a,++o)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function D8(e){var t,r=e.length-1,n,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function oA(e){return new B8(e)}function m0(e,t){this._context=e,this._t=t}m0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function sA(e){return new m0(e,.5)}function lA(e){return new m0(e,0)}function cA(e){return new m0(e,1)}function Na(e,t){if((o=e.length)>1)for(var r=1,n,i,a=e[t[0]],o,s=a.length;r<o;++r)for(i=a,a=e[t[r]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function wd(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Wfe(e,t){return e[t]}function Jfe(e){let t=[];return t.key=e,t}function uA(){var e=rr([]),t=wd,r=Na,n=Wfe;function i(a){var o=Array.from(e.apply(this,arguments),Jfe),s,l=o.length,c=-1,f;for(let u of a)for(s=0,++c;s<l;++s)(o[s][c]=[0,+n(u,o[s].key,c,a)]).data=u;for(s=0,f=yd(t(o));s<l;++s)o[f[s]].index=s;return r(o,f),o}return i.keys=function(a){return arguments.length?(e=typeof a=="function"?a:rr(Array.from(a)),i):e},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:rr(+a),i):n},i.order=function(a){return arguments.length?(t=a==null?wd:typeof a=="function"?a:rr(Array.from(a)),i):t},i.offset=function(a){return arguments.length?(r=a??Na,i):r},i}function fA(e,t){if((n=e.length)>0){for(var r,n,i=0,a=e[0].length,o;i<a;++i){for(o=r=0;r<n;++r)o+=e[r][i][1]||0;if(o)for(r=0;r<n;++r)e[r][i][1]/=o}Na(e,t)}}function dA(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,a=n.length;r<a;++r){for(var o=0,s=0;o<i;++o)s+=e[o][r][1]||0;n[r][1]+=n[r][0]=-s/2}Na(e,t)}}function pA(e,t){if(!(!((o=e.length)>0)||!((a=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,a,o;n<a;++n){for(var s=0,l=0,c=0;s<o;++s){for(var f=e[t[s]],u=f[n][1]||0,h=f[n-1][1]||0,g=(u-h)/2,_=0;_<s;++_){var w=e[t[_]],E=w[n][1]||0,S=w[n-1][1]||0;g+=E-S}l+=u,c+=g*u}i[n-1][1]+=i[n-1][0]=r,l&&(r-=c/l)}i[n-1][1]+=i[n-1][0]=r,Na(e,t)}}var $8=oe(qr());function Sd(e){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}function hA(){return hA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hA.apply(this,arguments)}function Yfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j8(n.key),n)}}function Kfe(e,t,r){return t&&R8(e.prototype,t),r&&R8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gA(e,t)}function gA(e,t){return gA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gA(e,t)}function Zfe(e){var t=tde();return function(){var n=v0(e),i;if(t){var a=v0(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Qfe(this,i)}}function Qfe(e,t){if(t&&(Sd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ede(e)}function ede(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v0(e){return v0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},v0(e)}function M8(e,t,r){return t=j8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j8(e){var t=rde(e,"string");return Sd(t)==="symbol"?t:String(t)}function rde(e,t){if(Sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U8={symbolCircle:vd,symbolCross:HO,symbolDiamond:WO,symbolSquare:JO,symbolStar:GO,symbolTriangle:KO,symbolWye:ZO},nde=Math.PI/180,ide=function(t){var r="symbol".concat((0,yA.default)(t));return U8[r]||vd},ade=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var i=18*nde;return 1.25*t*t*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},_0=function(e){Xfe(r,e);var t=Zfe(r);function r(){return Yfe(this,r),t.apply(this,arguments)}return Kfe(r,[{key:"getPath",value:function(){var i=this.props,a=i.size,o=i.sizeType,s=i.type,l=ide(s),c=g0().type(l).size(ade(a,o,s));return c()}},{key:"render",value:function(){var i=this.props,a=i.className,o=i.cx,s=i.cy,l=i.size,c=ht(this.props,!0);return o===+o&&s===+s&&l===+l?b0.default.createElement("path",hA({},c,{className:(0,$8.default)("recharts-symbols",a),transform:"translate(".concat(o,", ").concat(s,")"),d:this.getPath()})):null}}]),r}(b0.PureComponent);M8(_0,"defaultProps",{type:"circle",size:64,sizeType:"area"});M8(_0,"registerSymbol",function(e,t){U8["symbol".concat((0,yA.default)(e))]=t});function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}function mA(){return mA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mA.apply(this,arguments)}function z8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ode(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z8(Object(r),!0).forEach(function(n){Kg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V8(n.key),n)}}function lde(e,t,r){return t&&q8(e.prototype,t),r&&q8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vA(e,t)}function vA(e,t){return vA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vA(e,t)}function ude(e){var t=pde();return function(){var n=w0(e),i;if(t){var a=w0(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fde(this,i)}}function fde(e,t){if(t&&(xd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dde(e)}function dde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function w0(e){return w0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},w0(e)}function Kg(e,t,r){return t=V8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V8(e){var t=hde(e,"string");return xd(t)==="symbol"?t:String(t)}function hde(e,t){if(xd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var La=32,S0=function(e){cde(r,e);var t=ude(r);function r(){return sde(this,r),t.apply(this,arguments)}return lde(r,[{key:"renderIcon",value:function(i){var a=this.props.inactiveColor,o=La/2,s=La/6,l=La/3,c=i.inactive?a:i.color;if(i.type==="plainline")return aa.default.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:i.payload.strokeDasharray,x1:0,y1:o,x2:La,y2:o,className:"recharts-legend-icon"});if(i.type==="line")return aa.default.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(o,"h").concat(l,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*l,",").concat(o,`
            H`).concat(La,"M").concat(2*l,",").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(l,",").concat(o),className:"recharts-legend-icon"});if(i.type==="rect")return aa.default.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(La/8,"h").concat(La,"v").concat(La*3/4,"h").concat(-La,"z"),className:"recharts-legend-icon"});if(aa.default.isValidElement(i.legendIcon)){var f=ode({},i);return delete f.legendIcon,aa.default.cloneElement(i.legendIcon,f)}return aa.default.createElement(_0,{fill:c,cx:o,cy:o,size:La,sizeType:"diameter",type:i.type})}},{key:"renderItems",value:function(){var i=this,a=this.props,o=a.payload,s=a.iconSize,l=a.layout,c=a.formatter,f=a.inactiveColor,u={x:0,y:0,width:La,height:La},h={display:l==="horizontal"?"inline-block":"block",marginRight:10},g={display:"inline-block",verticalAlign:"middle",marginRight:4};return o.map(function(_,w){var E,S=_.formatter||c,A=(0,H8.default)((E={"recharts-legend-item":!0},Kg(E,"legend-item-".concat(w),!0),Kg(E,"inactive",_.inactive),E));if(_.type==="none")return null;var O=_.inactive?f:_.color;return aa.default.createElement("li",mA({className:A,style:h,key:"legend-item-".concat(w)},Yc(i.props,_,w)),aa.default.createElement(qg,{width:s,height:s,viewBox:u,style:g},i.renderIcon(_)),aa.default.createElement("span",{className:"recharts-legend-item-text",style:{color:O}},S?S(_.value,_,w):_.value))})}},{key:"render",value:function(){var i=this.props,a=i.payload,o=i.layout,s=i.align;if(!a||!a.length)return null;var l={padding:0,margin:0,textAlign:o==="horizontal"?s:"left"};return aa.default.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}]),r}(aa.PureComponent);Kg(S0,"displayName","Legend");Kg(S0,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});function Ed(e){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(e)}var gde=["ref"];function W8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function kd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W8(Object(r),!0).forEach(function(n){k0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K8(n.key),n)}}function mde(e,t,r){return t&&J8(e.prototype,t),r&&J8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_A(e,t)}function _A(e,t){return _A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_A(e,t)}function bde(e){var t=wde();return function(){var n=x0(e),i;if(t){var a=x0(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _de(this,i)}}function _de(e,t){if(t&&(Ed(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y8(e)}function Y8(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function x0(e){return x0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},x0(e)}function k0(e,t,r){return t=K8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K8(e){var t=Sde(e,"string");return Ed(t)==="symbol"?t:String(t)}function Sde(e,t){if(Ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xde(e,t){if(e==null)return{};var r=kde(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kde(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Ede(e){return e.value}function Ode(e,t){return e===!0?(0,bA.default)(t,Ede):(0,wA.default)(e)?(0,bA.default)(t,e):t}function Ade(e,t){if(Nl.default.isValidElement(e))return Nl.default.cloneElement(e,t);if((0,wA.default)(e))return Nl.default.createElement(e,t);var r=t.ref,n=xde(t,gde);return Nl.default.createElement(S0,n)}var G8=1,ru=function(e){vde(r,e);var t=bde(r);function r(){var n;yde(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),k0(Y8(n),"state",{boxWidth:-1,boxHeight:-1}),n}return mde(r,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){return this.wrapperNode&&this.wrapperNode.getBoundingClientRect?this.wrapperNode.getBoundingClientRect():null}},{key:"getBBoxSnapshot",value:function(){var i=this.state,a=i.boxWidth,o=i.boxHeight;return a>=0&&o>=0?{width:a,height:o}:null}},{key:"getDefaultPosition",value:function(i){var a=this.props,o=a.layout,s=a.align,l=a.verticalAlign,c=a.margin,f=a.chartWidth,u=a.chartHeight,h,g;if(!i||(i.left===void 0||i.left===null)&&(i.right===void 0||i.right===null))if(s==="center"&&o==="vertical"){var _=this.getBBoxSnapshot()||{width:0};h={left:((f||0)-_.width)/2}}else h=s==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!i||(i.top===void 0||i.top===null)&&(i.bottom===void 0||i.bottom===null))if(l==="middle"){var w=this.getBBoxSnapshot()||{height:0};g={top:((u||0)-w.height)/2}}else g=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return kd(kd({},h),g)}},{key:"updateBBox",value:function(){var i=this.state,a=i.boxWidth,o=i.boxHeight,s=this.props.onBBoxUpdate;if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var l=this.wrapperNode.getBoundingClientRect();(Math.abs(l.width-a)>G8||Math.abs(l.height-o)>G8)&&this.setState({boxWidth:l.width,boxHeight:l.height},function(){s&&s(l)})}else(a!==-1||o!==-1)&&this.setState({boxWidth:-1,boxHeight:-1},function(){s&&s(null)})}},{key:"render",value:function(){var i=this,a=this.props,o=a.content,s=a.width,l=a.height,c=a.wrapperStyle,f=a.payloadUniqBy,u=a.payload,h=kd(kd({position:"absolute",width:s||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return Nl.default.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(_){i.wrapperNode=_}},Ade(o,kd(kd({},this.props),{},{payload:Ode(f,u)})))}}],[{key:"getWithHeight",value:function(i,a){var o=i.props.layout;return o==="vertical"&&Ue(i.props.height)?{height:i.props.height}:o==="horizontal"?{width:i.props.width||a}:null}}]),r}(Nl.PureComponent);k0(ru,"displayName","Legend");k0(ru,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var dz=oe(Aa()),uI=oe(fn()),cI=oe(MO()),qn=oe(He());var Do=oe(He()),Qt=oe(Ns());var Tde=Object.getOwnPropertyNames,Nde=Object.getOwnPropertySymbols,Lde=Object.prototype.hasOwnProperty;function i$(e,t){return function(n,i,a){return e(n,i,a)&&t(n,i,a)}}function E0(e){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,i);var a=i.cache,o=a.get(r),s=a.get(n);if(o&&s)return o===n&&s===r;a.set(r,n),a.set(n,r);var l=e(r,n,i);return a.delete(r),a.delete(n),l}}function a$(e){return Tde(e).concat(Nde(e))}var d$=Object.hasOwn||function(e,t){return Lde.call(e,t)};function Od(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var p$="_owner",o$=Object.getOwnPropertyDescriptor,s$=Object.keys;function Pde(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function Fde(e,t){return Od(e.getTime(),t.getTime())}function l$(e,t,r){if(e.size!==t.size)return!1;for(var n={},i=e.entries(),a=0,o,s;(o=i.next())&&!o.done;){for(var l=t.entries(),c=!1,f=0;(s=l.next())&&!s.done;){var u=o.value,h=u[0],g=u[1],_=s.value,w=_[0],E=_[1];!c&&!n[f]&&(c=r.equals(h,w,a,f,e,t,r)&&r.equals(g,E,h,w,e,t,r))&&(n[f]=!0),f++}if(!c)return!1;a++}return!0}function Dde(e,t,r){var n=s$(e),i=n.length;if(s$(t).length!==i)return!1;for(var a;i-- >0;)if(a=n[i],a===p$&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!d$(t,a)||!r.equals(e[a],t[a],a,a,e,t,r))return!1;return!0}function Xg(e,t,r){var n=a$(e),i=n.length;if(a$(t).length!==i)return!1;for(var a,o,s;i-- >0;)if(a=n[i],a===p$&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!d$(t,a)||!r.equals(e[a],t[a],a,a,e,t,r)||(o=o$(e,a),s=o$(t,a),(o||s)&&(!o||!s||o.configurable!==s.configurable||o.enumerable!==s.enumerable||o.writable!==s.writable)))return!1;return!0}function Bde(e,t){return Od(e.valueOf(),t.valueOf())}function Rde(e,t){return e.source===t.source&&e.flags===t.flags}function c$(e,t,r){if(e.size!==t.size)return!1;for(var n={},i=e.values(),a,o;(a=i.next())&&!a.done;){for(var s=t.values(),l=!1,c=0;(o=s.next())&&!o.done;)!l&&!n[c]&&(l=r.equals(a.value,o.value,a.value,o.value,e,t,r))&&(n[c]=!0),c++;if(!l)return!1}return!0}function Mde(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}var jde="[object Arguments]",$de="[object Boolean]",Ude="[object Date]",zde="[object Map]",qde="[object Number]",Vde="[object Object]",Hde="[object RegExp]",Wde="[object Set]",Jde="[object String]",Gde=Array.isArray,u$=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,f$=Object.assign,Yde=Object.prototype.toString.call.bind(Object.prototype.toString);function Kde(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areMapsEqual,i=e.areObjectsEqual,a=e.arePrimitiveWrappersEqual,o=e.areRegExpsEqual,s=e.areSetsEqual,l=e.areTypedArraysEqual;return function(f,u,h){if(f===u)return!0;if(f==null||u==null||typeof f!="object"||typeof u!="object")return f!==f&&u!==u;var g=f.constructor;if(g!==u.constructor)return!1;if(g===Object)return i(f,u,h);if(Gde(f))return t(f,u,h);if(u$!=null&&u$(f))return l(f,u,h);if(g===Date)return r(f,u,h);if(g===RegExp)return o(f,u,h);if(g===Map)return n(f,u,h);if(g===Set)return s(f,u,h);var _=Yde(f);return _===Ude?r(f,u,h):_===Hde?o(f,u,h):_===zde?n(f,u,h):_===Wde?s(f,u,h):_===Vde?typeof f.then!="function"&&typeof u.then!="function"&&i(f,u,h):_===jde?i(f,u,h):_===$de||_===qde||_===Jde?a(f,u,h):!1}}function Xde(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,i={areArraysEqual:n?Xg:Pde,areDatesEqual:Fde,areMapsEqual:n?i$(l$,Xg):l$,areObjectsEqual:n?Xg:Dde,arePrimitiveWrappersEqual:Bde,areRegExpsEqual:Rde,areSetsEqual:n?i$(c$,Xg):c$,areTypedArraysEqual:n?Xg:Mde};if(r&&(i=f$({},i,r(i))),t){var a=E0(i.areArraysEqual),o=E0(i.areMapsEqual),s=E0(i.areObjectsEqual),l=E0(i.areSetsEqual);i=f$({},i,{areArraysEqual:a,areMapsEqual:o,areObjectsEqual:s,areSetsEqual:l})}return i}function Zde(e){return function(t,r,n,i,a,o,s){return e(t,r,s)}}function Qde(e){var t=e.circular,r=e.comparator,n=e.createState,i=e.equals,a=e.strict;if(n)return function(l,c){var f=n(),u=f.cache,h=u===void 0?t?new WeakMap:void 0:u,g=f.meta;return r(l,c,{cache:h,equals:i,meta:g,strict:a})};if(t)return function(l,c){return r(l,c,{cache:new WeakMap,equals:i,meta:void 0,strict:a})};var o={cache:void 0,equals:i,meta:void 0,strict:a};return function(l,c){return r(l,c,o)}}var h$=Ll(),wDe=Ll({strict:!0}),SDe=Ll({circular:!0}),xDe=Ll({circular:!0,strict:!0}),kDe=Ll({createInternalComparator:function(){return Od}}),EDe=Ll({strict:!0,createInternalComparator:function(){return Od}}),ODe=Ll({circular:!0,createInternalComparator:function(){return Od}}),ADe=Ll({circular:!0,createInternalComparator:function(){return Od},strict:!0});function Ll(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,i=e.createState,a=e.strict,o=a===void 0?!1:a,s=Xde(e),l=Kde(s),c=n?n(l):Zde(l);return Qde({circular:r,comparator:l,createState:i,equals:c,strict:o})}function O0(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function i(a){r<0&&(r=a),a-r>t?(e(a),r=-1):requestAnimationFrame(i)};requestAnimationFrame(n)}function SA(e){"@babel/helpers - typeof";return SA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SA(e)}function epe(e){return ipe(e)||npe(e)||rpe(e)||tpe()}function tpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rpe(e,t){if(e){if(typeof e=="string")return g$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g$(e,t)}}function g$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function npe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ipe(e){if(Array.isArray(e))return e}function xA(){var e={},t=function(){return null},r=!1,n=function i(a){if(!r){if(Array.isArray(a)){if(!a.length)return;var o=a,s=epe(o),l=s[0],c=s.slice(1);if(typeof l=="number"){O0(i.bind(null,c),l);return}i(l),O0(i.bind(null,c));return}SA(a)==="object"&&(e=a,t(e)),typeof a=="function"&&a()}};return{stop:function(){r=!0},start:function(a){r=!1,n(a)},subscribe:function(a){return t=a,function(){t=function(){return null}}}}}function Zg(e){"@babel/helpers - typeof";return Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zg(e)}function y$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ad(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y$(Object(r),!0).forEach(function(n){A0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function A0(e,t,r){return t=ape(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ape(e){var t=ope(e,"string");return Zg(t)==="symbol"?t:String(t)}function ope(e,t){if(Zg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var spe=["Webkit","Moz","O","ms"],lpe=["-webkit-","-moz-","-o-","-ms-"],cpe=["transform","transformOrigin","transition"],m$=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,i){return n.filter(function(a){return i.includes(a)})})},v$=function(t){return t},upe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},fpe=function(t,r){if(cpe.indexOf(t)===-1)return A0({},t,Number.isNaN(r)?0:r);var n=t==="transition",i=t.replace(/(\w)/,function(o){return o.toUpperCase()}),a=r;return spe.reduce(function(o,s,l){return n&&(a=r.replace(/(transform|transform-origin)/gim,"".concat(lpe[l],"$1"))),Ad(Ad({},o),{},A0({},s+i,a))},{})};var Id=function(t,r){return Object.keys(r).reduce(function(n,i){return Ad(Ad({},n),{},A0({},i,t(i,r[i])))},{})},Cd=function(t){return Object.keys(t).reduce(function(r,n){return Ad(Ad({},r),fpe(n,r[n]))},t)};var kA=function(t,r,n){return t.map(function(i){return"".concat(upe(i)," ").concat(r,"ms ").concat(n)}).join(",")},dpe=!1,Qg=function(t,r,n,i,a,o,s,l){if(dpe&&typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,i,a,o,s,l],f=0;console.warn(r.replace(/%s/g,function(){return c[f++]}))}};function ppe(e,t){return ype(e)||gpe(e,t)||_$(e,t)||hpe()}function hpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gpe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}function ype(e){if(Array.isArray(e))return e}function mpe(e){return _pe(e)||bpe(e)||_$(e)||vpe()}function vpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _$(e,t){if(e){if(typeof e=="string")return EA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EA(e,t)}}function bpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _pe(e){if(Array.isArray(e))return EA(e)}function EA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var I0=1e-4,w$=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},S$=function(t,r){return t.map(function(n,i){return n*Math.pow(r,i)}).reduce(function(n,i){return n+i})},b$=function(t,r){return function(n){var i=w$(t,r);return S$(i,n)}},wpe=function(t,r){return function(n){var i=w$(t,r),a=[].concat(mpe(i.map(function(o,s){return o*s}).slice(1)),[0]);return S$(a,n)}},OA=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0],a=r[1],o=r[2],s=r[3];if(r.length===1)switch(r[0]){case"linear":i=0,a=0,o=1,s=1;break;case"ease":i=.25,a=.1,o=.25,s=1;break;case"ease-in":i=.42,a=0,o=1,s=1;break;case"ease-out":i=.42,a=0,o=.58,s=1;break;case"ease-in-out":i=0,a=0,o=.58,s=1;break;default:{var l=r[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var c=l[1].split(")")[0].split(",").map(function(E){return parseFloat(E)}),f=ppe(c,4);i=f[0],a=f[1],o=f[2],s=f[3]}else Qg(!1,"[configBezier]: arguments should be one of oneOf 'linear', 'ease', 'ease-in', 'ease-out', 'ease-in-out','cubic-bezier(x1,y1,x2,y2)', instead received %s",r)}}Qg([i,o,a,s].every(function(E){return typeof E=="number"&&E>=0&&E<=1}),"[configBezier]: arguments should be x1, y1, x2, y2 of [0, 1] instead received %s",r);var u=b$(i,o),h=b$(a,s),g=wpe(i,o),_=function(S){return S>1?1:S<0?0:S},w=function(S){for(var A=S>1?1:S,O=A,C=0;C<8;++C){var T=u(O)-A,D=g(O);if(Math.abs(T-A)<I0||D<I0)return h(O);O=_(O-T/D)}return h(O)};return w.isStepper=!1,w},x$=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,i=t.damping,a=i===void 0?8:i,o=t.dt,s=o===void 0?17:o,l=function(f,u,h){var g=-(f-u)*n,_=h*a,w=h+(g-_)*s/1e3,E=h*s/1e3+f;return Math.abs(E-u)<I0&&Math.abs(w)<I0?[u,0]:[E,w]};return l.isStepper=!0,l.dt=s,l},k$=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return OA(i);case"spring":return x$();default:if(i.split("(")[0]==="cubic-bezier")return OA(i);Qg(!1,"[configEasing]: first argument should be one of 'ease', 'ease-in', 'ease-out', 'ease-in-out','cubic-bezier(x1,y1,x2,y2)', 'linear' and 'spring', instead  received %s",r)}return typeof i=="function"?i:(Qg(!1,"[configEasing]: first argument type should be function or string, instead received %s",r),null)};function ey(e){"@babel/helpers - typeof";return ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ey(e)}function E$(e){return kpe(e)||xpe(e)||A$(e)||Spe()}function Spe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kpe(e){if(Array.isArray(e))return IA(e)}function O$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function zn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O$(Object(r),!0).forEach(function(n){AA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AA(e,t,r){return t=Epe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Epe(e){var t=Ope(e,"string");return ey(t)==="symbol"?t:String(t)}function Ope(e,t){if(ey(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ey(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ape(e,t){return Tpe(e)||Cpe(e,t)||A$(e,t)||Ipe()}function Ipe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A$(e,t){if(e){if(typeof e=="string")return IA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IA(e,t)}}function IA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cpe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}function Tpe(e){if(Array.isArray(e))return e}var C0=function(t,r,n){return t+(r-t)*n},CA=function(t){var r=t.from,n=t.to;return r!==n},Npe=function e(t,r,n){var i=Id(function(a,o){if(CA(o)){var s=t(o.from,o.to,o.velocity),l=Ape(s,2),c=l[0],f=l[1];return zn(zn({},o),{},{from:c,velocity:f})}return o},r);return n<1?Id(function(a,o){return CA(o)?zn(zn({},o),{},{velocity:C0(o.velocity,i[a].velocity,n),from:C0(o.from,i[a].from,n)}):o},r):e(t,i,n-1)},I$=function(e,t,r,n,i){var a=m$(e,t),o=a.reduce(function(E,S){return zn(zn({},E),{},AA({},S,[e[S],t[S]]))},{}),s=a.reduce(function(E,S){return zn(zn({},E),{},AA({},S,{from:e[S],velocity:0,to:t[S]}))},{}),l=-1,c,f,u=function(){return null},h=function(){return Id(function(S,A){return A.from},s)},g=function(){return!Object.values(s).filter(CA).length},_=function(S){c||(c=S);var A=S-c,O=A/r.dt;s=Npe(r,s,O),i(zn(zn(zn({},e),t),h(s))),c=S,g()||(l=requestAnimationFrame(u))},w=function(S){f||(f=S);var A=(S-f)/n,O=Id(function(T,D){return C0.apply(void 0,E$(D).concat([r(A)]))},o);if(i(zn(zn(zn({},e),t),O)),A<1)l=requestAnimationFrame(u);else{var C=Id(function(T,D){return C0.apply(void 0,E$(D).concat([r(1)]))},o);i(zn(zn(zn({},e),t),C))}};return u=r.isStepper?_:w,function(){return requestAnimationFrame(u),function(){cancelAnimationFrame(l)}}};function Td(e){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}var Lpe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Ppe(e,t){if(e==null)return{};var r=Fpe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Fpe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function TA(e){return Mpe(e)||Rpe(e)||Bpe(e)||Dpe()}function Dpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bpe(e,t){if(e){if(typeof e=="string")return NA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NA(e,t)}}function Rpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mpe(e){if(Array.isArray(e))return NA(e)}function NA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function eo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C$(Object(r),!0).forEach(function(n){ty(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ty(e,t,r){return t=N$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N$(n.key),n)}}function $pe(e,t,r){return t&&T$(e.prototype,t),r&&T$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N$(e){var t=Upe(e,"string");return Td(t)==="symbol"?t:String(t)}function Upe(e,t){if(Td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LA(e,t)}function LA(e,t){return LA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},LA(e,t)}function qpe(e){var t=Vpe();return function(){var n=T0(e),i;if(t){var a=T0(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return PA(this,i)}}function PA(e,t){if(t&&(Td(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FA(e)}function FA(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T0(e){return T0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},T0(e)}var N0=function(e){zpe(r,e);var t=qpe(r);function r(n,i){var a;jpe(this,r),a=t.call(this,n,i);var o=a.props,s=o.isActive,l=o.attributeName,c=o.from,f=o.to,u=o.steps,h=o.children,g=o.duration;if(a.handleStyleChange=a.handleStyleChange.bind(FA(a)),a.changeStyle=a.changeStyle.bind(FA(a)),!s||g<=0)return a.state={style:{}},typeof h=="function"&&(a.state={style:f}),PA(a);if(u&&u.length)a.state={style:u[0].style};else if(c){if(typeof h=="function")return a.state={style:c},PA(a);a.state={style:l?ty({},l,c):c}}else a.state={style:{}};return a}return $pe(r,[{key:"componentDidMount",value:function(){var i=this.props,a=i.isActive,o=i.canBegin;this.mounted=!0,!(!a||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var a=this.props,o=a.isActive,s=a.canBegin,l=a.attributeName,c=a.shouldReAnimate,f=a.to,u=a.from,h=this.state.style;if(s){if(!o){var g={style:l?ty({},l,f):f};this.state&&h&&(l&&h[l]!==f||!l&&h!==f)&&this.setState(g);return}if(!(h$(i.to,f)&&i.canBegin&&i.isActive)){var _=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var w=_||c?u:i.to;if(this.state&&h){var E={style:l?ty({},l,w):w};(l&&[l]!==w||!l&&h!==w)&&this.setState(E)}this.runAnimation(eo(eo({},this.props),{},{from:w,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var a=this,o=i.from,s=i.to,l=i.duration,c=i.easing,f=i.begin,u=i.onAnimationEnd,h=i.onAnimationStart,g=I$(o,s,k$(c),l,this.changeStyle),_=function(){a.stopJSAnimation=g()};this.manager.start([h,f,_,l,u])}},{key:"runStepAnimation",value:function(i){var a=this,o=i.steps,s=i.begin,l=i.onAnimationStart,c=o[0],f=c.style,u=c.duration,h=u===void 0?0:u,g=function(w,E,S){if(S===0)return w;var A=E.duration,O=E.easing,C=O===void 0?"ease":O,T=E.style,D=E.properties,P=E.onAnimationEnd,z=S>0?o[S-1]:E,ne=D||Object.keys(T);if(typeof C=="function"||C==="spring")return[].concat(TA(w),[a.runJSAnimation.bind(a,{from:z.style,to:T,duration:A,easing:C}),A]);var V=kA(ne,A,C),X=eo(eo(eo({},z.style),T),{},{transition:V});return[].concat(TA(w),[X,A,P]).filter(v$)};return this.manager.start([l].concat(TA(o.reduce(g,[f,Math.max(h,s)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=xA());var a=i.begin,o=i.duration,s=i.attributeName,l=i.to,c=i.easing,f=i.onAnimationStart,u=i.onAnimationEnd,h=i.steps,g=i.children,_=this.manager;if(this.unSubscribe=_.subscribe(this.handleStyleChange),typeof c=="function"||typeof g=="function"||c==="spring"){this.runJSAnimation(i);return}if(h.length>1){this.runStepAnimation(i);return}var w=s?ty({},s,l):l,E=kA(Object.keys(w),o,c);_.start([f,a,eo(eo({},w),{},{transition:E}),o,u])}},{key:"render",value:function(){var i=this.props,a=i.children,o=i.begin,s=i.duration,l=i.attributeName,c=i.easing,f=i.isActive,u=i.steps,h=i.from,g=i.to,_=i.canBegin,w=i.onAnimationEnd,E=i.shouldReAnimate,S=i.onAnimationReStart,A=Ppe(i,Lpe),O=Do.Children.count(a),C=Cd(this.state.style);if(typeof a=="function")return a(C);if(!f||O===0||s<=0)return a;var T=function(P){var z=P.props,ne=z.style,V=ne===void 0?{}:ne,X=z.className,Q=(0,Do.cloneElement)(P,eo(eo({},A),{},{style:eo(eo({},V),C),className:X}));return Q};return O===1?T(Do.Children.only(a)):Do.default.createElement("div",null,Do.Children.map(a,function(D){return T(D)}))}}]),r}(Do.PureComponent);N0.displayName="Animate";N0.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};N0.propTypes={from:Qt.default.oneOfType([Qt.default.object,Qt.default.string]),to:Qt.default.oneOfType([Qt.default.object,Qt.default.string]),attributeName:Qt.default.string,duration:Qt.default.number,begin:Qt.default.number,easing:Qt.default.oneOfType([Qt.default.string,Qt.default.func]),steps:Qt.default.arrayOf(Qt.default.shape({duration:Qt.default.number.isRequired,style:Qt.default.object.isRequired,easing:Qt.default.oneOfType([Qt.default.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Qt.default.func]),properties:Qt.default.arrayOf("string"),onAnimationEnd:Qt.default.func})),children:Qt.default.oneOfType([Qt.default.node,Qt.default.func]),isActive:Qt.default.bool,canBegin:Qt.default.bool,onAnimationEnd:Qt.default.func,shouldReAnimate:Qt.default.bool,onAnimationStart:Qt.default.func,onAnimationReStart:Qt.default.func};var L0=N0;var cy=oe(He()),uU=oe(GA()),Pl=oe(Ns());var ou=oe(He()),sU=oe(GA()),ly=oe(Ns());var Nhe=["children","appearOptions","enterOptions","leaveOptions"];function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}function KA(){return KA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KA.apply(this,arguments)}function Lhe(e,t){if(e==null)return{};var r=Phe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Phe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function nU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function iU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nU(Object(r),!0).forEach(function(n){QA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oU(n.key),n)}}function Dhe(e,t,r){return t&&aU(e.prototype,t),r&&aU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XA(e,t)}function XA(e,t){return XA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},XA(e,t)}function Rhe(e){var t=jhe();return function(){var n=j0(e),i;if(t){var a=j0(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Mhe(this,i)}}function Mhe(e,t){if(t&&(Bd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZA(e)}function ZA(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function j0(e){return j0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},j0(e)}function QA(e,t,r){return t=oU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oU(e){var t=$he(e,"string");return Bd(t)==="symbol"?t:String(t)}function $he(e,t){if(Bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}Number.isFinite===void 0&&(Number.isFinite=function(e){return typeof e=="number"&&isFinite(e)});var YA=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.steps,n=t.duration;return r&&r.length?r.reduce(function(i,a){return i+(Number.isFinite(a.duration)&&a.duration>0?a.duration:0)},0):Number.isFinite(n)?n:0},lU=function(e){Bhe(r,e);var t=Rhe(r);function r(){var n;return Fhe(this,r),n=t.call(this),QA(ZA(n),"handleEnter",function(i,a){var o=n.props,s=o.appearOptions,l=o.enterOptions;n.handleStyleActive(a?s:l)}),QA(ZA(n),"handleExit",function(){var i=n.props.leaveOptions;n.handleStyleActive(i)}),n.state={isActive:!1},n}return Dhe(r,[{key:"handleStyleActive",value:function(i){if(i){var a=i.onAnimationEnd?function(){i.onAnimationEnd()}:null;this.setState(iU(iU({},i),{},{onAnimationEnd:a,isActive:!0}))}}},{key:"parseTimeout",value:function(){var i=this.props,a=i.appearOptions,o=i.enterOptions,s=i.leaveOptions;return YA(a)+YA(o)+YA(s)}},{key:"render",value:function(){var i=this,a=this.props,o=a.children,s=a.appearOptions,l=a.enterOptions,c=a.leaveOptions,f=Lhe(a,Nhe);return ou.default.createElement(sU.Transition,KA({},f,{onEnter:this.handleEnter,onExit:this.handleExit,timeout:this.parseTimeout()}),function(){return ou.default.createElement(L0,i.state,ou.Children.only(o))})}}]),r}(ou.Component);lU.propTypes={appearOptions:ly.default.object,enterOptions:ly.default.object,leaveOptions:ly.default.object,children:ly.default.element};var cU=lU;function fU(e){var t=e.component,r=e.children,n=e.appear,i=e.enter,a=e.leave;return cy.default.createElement(uU.TransitionGroup,{component:t},cy.Children.map(r,function(o,s){return cy.default.createElement(cU,{appearOptions:n,enterOptions:i,leaveOptions:a,key:"child-".concat(s)},o)}))}fU.propTypes={appear:Pl.default.object,enter:Pl.default.object,leave:Pl.default.object,children:Pl.default.oneOfType([Pl.default.array,Pl.default.element]),component:Pl.default.any};fU.defaultProps={component:"span"};var su=L0;var pz=oe(qr());var az=oe(Aa()),oz=oe(U0()),sz=oe(Vr()),Pa=oe(He()),sI=oe(qr());function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function Gge(e,t){return Zge(e)||Xge(e,t)||Kge(e,t)||Yge()}function Yge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kge(e,t){if(e){if(typeof e=="string")return rz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rz(e,t)}}function rz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xge(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}function Zge(e){if(Array.isArray(e))return e}function nz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function aI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nz(Object(r),!0).forEach(function(n){lI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lz(n.key),n)}}function eye(e,t,r){return t&&iz(e.prototype,t),r&&iz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oI(e,t)}function oI(e,t){return oI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oI(e,t)}function rye(e){var t=aye();return function(){var n=z0(e),i;if(t){var a=z0(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nye(this,i)}}function nye(e,t){if(t&&(Rd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iye(e)}function iye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function z0(e){return z0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},z0(e)}function lI(e,t,r){return t=lz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lz(e){var t=oye(e,"string");return Rd(t)==="symbol"?t:String(t)}function oye(e,t){if(Rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sye(e){return(0,sz.default)(e)&&Sr(e[0])&&Sr(e[1])?e.join(" ~ "):e}var q0=function(e){tye(r,e);var t=rye(r);function r(){return Qge(this,r),t.apply(this,arguments)}return eye(r,[{key:"renderContent",value:function(){var i=this.props,a=i.payload,o=i.separator,s=i.formatter,l=i.itemStyle,c=i.itemSorter;if(a&&a.length){var f={padding:0,margin:0},u=(c?(0,oz.default)(a,c):a).map(function(h,g){if(h.type==="none")return null;var _=aI({display:"block",paddingTop:4,paddingBottom:4,color:h.color||"#000"},l),w=h.formatter||s||sye,E=h.value,S=h.name;if(w&&E!=null&&S!=null){var A=w(E,S,h,g,a);if(Array.isArray(A)){var O=A,C=Gge(O,2);E=C[0],S=C[1]}else E=A}return Pa.default.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(g),style:_},Sr(S)?Pa.default.createElement("span",{className:"recharts-tooltip-item-name"},S):null,Sr(S)?Pa.default.createElement("span",{className:"recharts-tooltip-item-separator"},o):null,Pa.default.createElement("span",{className:"recharts-tooltip-item-value"},E),Pa.default.createElement("span",{className:"recharts-tooltip-item-unit"},h.unit||""))});return Pa.default.createElement("ul",{className:"recharts-tooltip-item-list",style:f},u)}return null}},{key:"render",value:function(){var i=this.props,a=i.wrapperClassName,o=i.contentStyle,s=i.labelClassName,l=i.labelStyle,c=i.label,f=i.labelFormatter,u=i.payload,h=aI({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},o),g=aI({margin:0},l),_=!(0,az.default)(c),w=_?c:"",E=(0,sI.default)("recharts-default-tooltip",a),S=(0,sI.default)("recharts-tooltip-label",s);return _&&f&&u!==void 0&&u!==null&&(w=f(c,u)),Pa.default.createElement("div",{className:E,style:h},Pa.default.createElement("p",{className:S,style:g},Pa.default.isValidElement(w)?w:"".concat(w)),this.renderContent())}}]),r}(Pa.PureComponent);lI(q0,"displayName","DefaultTooltipContent");lI(q0,"defaultProps",{separator:" : ",contentStyle:{},itemStyle:{},labelStyle:{}});var lye=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},mi={isSsr:lye(),get:function(t){return mi[t]},set:function(t,r){if(typeof t=="string")mi[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(i){mi[i]=t[i]})}}};function py(e){"@babel/helpers - typeof";return py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},py(e)}function cz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ps(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cz(Object(r),!0).forEach(function(n){dy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dy(e,t,r){return t=cye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cye(e){var t=uye(e,"string");return py(t)==="symbol"?t:String(t)}function uye(e,t){if(py(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(py(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V0(e,t){return hye(e)||pye(e,t)||dye(e,t)||fye()}function fye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dye(e,t){if(e){if(typeof e=="string")return uz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uz(e,t)}}function uz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}function hye(e){if(Array.isArray(e))return e}var fy="recharts-tooltip-wrapper",fz=1;function gye(e){return e.dataKey}function yye(e,t){return e===!0?(0,cI.default)(t,gye):(0,uI.default)(e)?(0,cI.default)(t,e):t}function mye(e,t){return qn.default.isValidElement(e)?qn.default.cloneElement(e,t):(0,uI.default)(e)?qn.default.createElement(e,t):qn.default.createElement(q0,t)}var vye={active:!1,allowEscapeViewBox:{x:!1,y:!1},reverseDirection:{x:!1,y:!1},offset:10,viewBox:{x:0,y:0,height:0,width:0},coordinate:{x:0,y:0},cursorStyle:{},separator:" : ",wrapperStyle:{},contentStyle:{},itemStyle:{},labelStyle:{},cursor:!0,trigger:"hover",isAnimationActive:!mi.isSsr,animationEasing:"ease",animationDuration:400,filterNull:!0,useTranslate3d:!1},lu=function(t){var r,n=(0,qn.useState)(-1),i=V0(n,2),a=i[0],o=i[1],s=(0,qn.useState)(-1),l=V0(s,2),c=l[0],f=l[1],u=(0,qn.useState)(!1),h=V0(u,2),g=h[0],_=h[1],w=(0,qn.useState)({x:0,y:0}),E=V0(w,2),S=E[0],A=E[1],O=(0,qn.useRef)(),C=t.allowEscapeViewBox,T=t.reverseDirection,D=t.coordinate,P=t.offset,z=t.position,ne=t.viewBox,V=(0,qn.useCallback)(function(se){se.key==="Escape"&&(_(!0),A(function(be){return Ps(Ps({},be),{},{x:D?.x,y:D?.y})}))},[D?.x,D?.y]);(0,qn.useEffect)(function(){var se=function(){if(g?(document.removeEventListener("keydown",V),(D?.x!==S.x||D?.y!==S.y)&&_(!1)):document.addEventListener("keydown",V),O.current&&O.current.getBoundingClientRect){var W=O.current.getBoundingClientRect();(Math.abs(W.width-a)>fz||Math.abs(W.height-c)>fz)&&(o(W.width),f(W.height))}else(a!==-1||c!==-1)&&(o(-1),f(-1))};return se(),function(){document.removeEventListener("keydown",V)}},[c,a,D,g,S.x,S.y,V]);var X=function(be){var W=be.key,J=be.tooltipDimension,re=be.viewBoxDimension;if(z&&Ue(z[W]))return z[W];var Ee=D[W]-J-P,Te=D[W]+P;if(C!=null&&C[W])return T[W]?Ee:Te;if(T!=null&&T[W]){var Ie=Ee,Ye=ne[W];return Ie<Ye?Math.max(Te,ne[W]):Math.max(Ee,ne[W])}var Ke=Te+J,St=ne[W]+re;return Ke>St?Math.max(Ee,ne[W]):Math.max(Te,ne[W])},Q=t.payload,ie=t.payloadUniqBy,pe=t.filterNull,de=t.active,F=t.wrapperStyle,H=t.useTranslate3d,Z=t.isAnimationActive,j=t.animationDuration,$=t.animationEasing,q=yye(ie,pe&&Q&&Q.length?Q.filter(function(se){return!(0,dz.default)(se.value)}):Q),ae=q&&q.length,le=t.content,fe=Ps({pointerEvents:"none",visibility:!g&&de&&ae?"visible":"hidden",position:"absolute",top:0,left:0},F),Se,ke;z&&Ue(z.x)&&Ue(z.y)?(Se=z.x,ke=z.y):a>0&&c>0&&D?(Se=X({key:"x",tooltipDimension:a,viewBoxDimension:ne.width}),ke=X({key:"y",tooltipDimension:c,viewBoxDimension:ne.height})):fe.visibility="hidden",fe=Ps(Ps({},Cd({transform:H?"translate3d(".concat(Se,"px, ").concat(ke,"px, 0)"):"translate(".concat(Se,"px, ").concat(ke,"px)")})),fe),Z&&de&&(fe=Ps(Ps({},Cd({transition:"transform ".concat(j,"ms ").concat($)})),fe));var xe=(0,pz.default)(fy,(r={},dy(r,"".concat(fy,"-right"),Ue(Se)&&D&&Ue(D.x)&&Se>=D.x),dy(r,"".concat(fy,"-left"),Ue(Se)&&D&&Ue(D.x)&&Se<D.x),dy(r,"".concat(fy,"-bottom"),Ue(ke)&&D&&Ue(D.y)&&ke>=D.y),dy(r,"".concat(fy,"-top"),Ue(ke)&&D&&Ue(D.y)&&ke<D.y),r));return qn.default.createElement("div",{tabIndex:-1,role:"dialog",className:xe,style:fe,ref:O},mye(le,Ps(Ps({},t),{},{payload:q})))};lu.displayName="Tooltip";lu.defaultProps=vye;var Pz=oe(qr()),pn=oe(He());var dn=oe(He()),Iz=oe(Io()),Cz=oe(pI()),Tz=oe(hI());var gI=function(e,t){return gI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},gI(e,t)};function zye(e,t){gI(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function qye(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}var Vye=function(e,t,r,n){switch(t){case"debounce":return(0,Cz.default)(e,r,n);case"throttle":return(0,Tz.default)(e,r,n);default:return e}},Oz=function(e){return typeof e=="function"},Md=function(){return typeof window>"u"},Az=function(e){return e instanceof Element||e instanceof HTMLDocument},Hye=function(e,t,r){return function(n){var i=n.width,a=n.height;e(function(o){return o.width===i&&o.height===a||o.width===i&&!r||o.height===a&&!t?o:{width:i,height:a}})}},Nz=function(e){zye(t,e);function t(r){var n=e.call(this,r)||this;n.cancelHandler=function(){n.resizeHandler&&n.resizeHandler.cancel&&(n.resizeHandler.cancel(),n.resizeHandler=null)},n.attachObserver=function(){var c=n.props,f=c.targetRef,u=c.observerOptions;if(!Md()){f&&f.current&&(n.targetRef.current=f.current);var h=n.getElement();h&&(n.observableElement&&n.observableElement===h||(n.observableElement=h,n.resizeObserver.observe(h,u)))}},n.getElement=function(){var c=n.props,f=c.querySelector,u=c.targetDomEl;if(Md())return null;if(f)return document.querySelector(f);if(u&&Az(u))return u;if(n.targetRef&&Az(n.targetRef.current))return n.targetRef.current;var h=(0,Iz.findDOMNode)(n);if(!h)return null;var g=n.getRenderType();switch(g){case"renderProp":return h;case"childFunction":return h;case"child":return h;case"childArray":return h;default:return h.parentElement}},n.createResizeHandler=function(c){var f=n.props,u=f.handleWidth,h=u===void 0?!0:u,g=f.handleHeight,_=g===void 0?!0:g,w=f.onResize;if(!(!h&&!_)){var E=Hye(function(S){return n.setState(S,function(){return w?.(n.state.width,n.state.height)})},h,_);c.forEach(function(S){var A=S&&S.contentRect||{},O=A.width,C=A.height,T=!n.skipOnMount&&!Md();T&&E({width:O,height:C}),n.skipOnMount=!1})}},n.getRenderType=function(){var c=n.props,f=c.render,u=c.children;return Oz(f)?"renderProp":Oz(u)?"childFunction":(0,dn.isValidElement)(u)?"child":Array.isArray(u)?"childArray":"parent"};var i=r.skipOnMount,a=r.refreshMode,o=r.refreshRate,s=o===void 0?1e3:o,l=r.refreshOptions;return n.state={width:void 0,height:void 0},n.skipOnMount=i,n.targetRef=(0,dn.createRef)(),n.observableElement=null,Md()||(n.resizeHandler=Vye(n.createResizeHandler,a,s,l),n.resizeObserver=new window.ResizeObserver(n.resizeHandler)),n}return t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver()},t.prototype.componentWillUnmount=function(){Md()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},t.prototype.render=function(){var r=this.props,n=r.render,i=r.children,a=r.nodeType,o=a===void 0?"div":a,s=this.state,l=s.width,c=s.height,f={width:l,height:c,targetRef:this.targetRef},u=this.getRenderType();switch(u){case"renderProp":return n?.(f);case"childFunction":{var h=i;return h?.(f)}case"child":{var g=i;if(g.type&&typeof g.type=="string"){f.targetRef;var _=qye(f,["targetRef"]);return(0,dn.cloneElement)(g,_)}return(0,dn.cloneElement)(g,f)}case"childArray":{var w=i;return w.map(function(E){return!!E&&(0,dn.cloneElement)(E,f)})}default:return dn.default.createElement(o,null)}},t}(dn.PureComponent);var JBe=Md()?dn.useEffect:dn.useLayoutEffect;var Wye=!1,Ro=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];if(Wye&&typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,function(){return i[o++]}))}};function yI(){return yI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yI.apply(this,arguments)}function Jye(e,t){return Xye(e)||Kye(e,t)||Yye(e,t)||Gye()}function Gye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yye(e,t){if(e){if(typeof e=="string")return Lz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lz(e,t)}}function Lz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}function Xye(e){if(Array.isArray(e))return e}var mI=(0,pn.forwardRef)(function(e,t){var r=e.aspect,n=e.width,i=n===void 0?"100%":n,a=e.height,o=a===void 0?"100%":a,s=e.minWidth,l=s===void 0?0:s,c=e.minHeight,f=e.maxHeight,u=e.children,h=e.debounce,g=h===void 0?0:h,_=e.id,w=e.className,E=e.onResize,S=(0,pn.useState)({containerWidth:-1,containerHeight:-1}),A=Jye(S,2),O=A[0],C=A[1],T=(0,pn.useRef)(null);(0,pn.useImperativeHandle)(t,function(){return T},[T]);var D=(0,pn.useCallback)(function(){return T.current?{containerWidth:T.current.clientWidth,containerHeight:T.current.clientHeight}:null},[]),P=(0,pn.useCallback)(function(){var V=D();if(V){var X=V.containerWidth,Q=V.containerHeight;E&&E(X,Q),C(function(ie){var pe=ie.containerWidth,de=ie.containerHeight;return X!==pe||Q!==de?{containerWidth:X,containerHeight:Q}:ie})}},[D,E]),z=(0,pn.useMemo)(function(){var V=O.containerWidth,X=O.containerHeight;if(V<0||X<0)return null;Ro(As(i)||As(o),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,o),Ro(!r||r>0,"The aspect(%s) must be greater than zero.",r);var Q=As(i)?V:i,ie=As(o)?X:o;return r&&r>0&&(Q?ie=Q/r:ie&&(Q=ie*r),f&&ie>f&&(ie=f)),Ro(Q>0||ie>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Q,ie,i,o,l,c,r),(0,pn.cloneElement)(u,{width:Q,height:ie})},[r,u,o,f,c,l,O,i]);(0,pn.useEffect)(function(){var V=D();V&&C(V)},[D]);var ne={width:i,height:o,minWidth:l,minHeight:c,maxHeight:f};return pn.default.createElement(Nz,{handleWidth:!0,handleHeight:!0,onResize:P,targetRef:T,refreshMode:g>0?"debounce":void 0,refreshRate:g},pn.default.createElement("div",yI({},_!=null?{id:"".concat(_)}:{},{className:(0,Pz.default)("recharts-responsive-container",w),style:ne,ref:T}),z))});var jd=function(t){return null};jd.displayName="Cell";var LI=oe(Aa()),yy=oe(He()),Q0=oe(o9()),y9=oe(qr());function gy(e){"@babel/helpers - typeof";return gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gy(e)}function s9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function l9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s9(Object(r),!0).forEach(function(n){kme(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kme(e,t,r){return t=Eme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eme(e){var t=Ome(e,"string");return gy(t)==="symbol"?t:String(t)}function Ome(e,t){if(gy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function c9(e){return Tme(e)||Cme(e)||Ime(e)||Ame()}function Ame(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ime(e,t){if(e){if(typeof e=="string")return TI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TI(e,t)}}function Cme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tme(e){if(Array.isArray(e))return TI(e)}function TI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $d={widthCache:{},cacheCount:0},Nme=2e3,Lme={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Pme=["minWidth","maxWidth","width","minHeight","maxHeight","height","top","left","fontSize","lineHeight","padding","margin","paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom"],u9="recharts_measurement_span";function Fme(e,t){return Pme.indexOf(e)>=0&&t===+t?"".concat(t,"px"):t}function Dme(e){var t=e.split(""),r=t.reduce(function(n,i){return i===i.toUpperCase()?[].concat(c9(n),["-",i.toLowerCase()]):[].concat(c9(n),[i])},[]);return r.join("")}var Bme=function(t){return Object.keys(t).reduce(function(r,n){return"".concat(r).concat(Dme(n),":").concat(Fme(n,t[n]),";")},"")},Ds=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||mi.isSsr)return{width:0,height:0};var n="".concat(t),i=Bme(r),a="".concat(n,"-").concat(i);if($d.widthCache[a])return $d.widthCache[a];try{var o=document.getElementById(u9);o||(o=document.createElement("span"),o.setAttribute("id",u9),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var s=l9(l9({},Lme),r);Object.keys(s).map(function(f){return o.style[f]=s[f],f}),o.textContent=n;var l=o.getBoundingClientRect(),c={width:l.width,height:l.height};return $d.widthCache[a]=c,++$d.cacheCount>Nme&&($d.cacheCount=0,$d.widthCache={}),c}catch{return{width:0,height:0}}},f9=function(t){var r=t.ownerDocument.documentElement,n={top:0,left:0};return typeof t.getBoundingClientRect<"u"&&(n=t.getBoundingClientRect()),{top:n.top+window.pageYOffset-r.clientTop,left:n.left+window.pageXOffset-r.clientLeft}},d9=function(t,r){return{chartX:Math.round(t.pageX-r.left),chartY:Math.round(t.pageY-r.top)}};var Rme=["dx","dy","textAnchor","verticalAnchor","scaleToFit","angle","lineHeight","capHeight","className","breakAll"];function NI(){return NI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},NI.apply(this,arguments)}function Mme(e,t){if(e==null)return{};var r=jme(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jme(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function p9(e,t){return qme(e)||zme(e,t)||Ume(e,t)||$me()}function $me(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ume(e,t){if(e){if(typeof e=="string")return h9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h9(e,t)}}function h9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zme(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}function qme(e){if(Array.isArray(e))return e}var m9=/[ \f\n\r\t\v\u2028\u2029]+/,v9=function(t){var r=t.children,n=t.breakAll,i=t.style;try{var a=[];(0,LI.default)(r)||(n?a=r.toString().split(""):a=r.toString().split(m9));var o=a.map(function(l){return{word:l,width:Ds(l,i).width}}),s=n?0:Ds("\xA0",i).width;return{wordsWithComputedWidth:o,spaceWidth:s}}catch{return null}},Vme=function(t,r,n,i,a){var o=t.maxLines,s=t.children,l=t.style,c=t.breakAll,f=Ue(o),u=s,h=function(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return de.reduce(function(F,H){var Z=H.word,j=H.width,$=F[F.length-1];if($&&(i==null||a||$.width+j+n<Number(i)))$.words.push(Z),$.width+=j+n;else{var q={words:[Z],width:j};F.push(q)}return F},[])},g=h(r),_=function(de){return de.reduce(function(F,H){return F.width>H.width?F:H})};if(!f)return g;for(var w="\u2026",E=function(de){var F=u.slice(0,de),H=v9({breakAll:c,style:l,children:F+w}).wordsWithComputedWidth,Z=h(H),j=Z.length>o||_(Z).width>Number(i);return[j,Z]},S=0,A=u.length-1,O=0,C;S<=A&&O<=u.length-1;){var T=Math.floor((S+A)/2),D=T-1,P=E(D),z=p9(P,2),ne=z[0],V=z[1],X=E(T),Q=p9(X,1),ie=Q[0];if(!ne&&!ie&&(S=T+1),ne&&ie&&(A=T-1),!ne&&ie){C=V;break}O++}return C||g},g9=function(t){var r=(0,LI.default)(t)?[]:t.toString().split(m9);return[{words:r}]},Hme=function(t){var r=t.width,n=t.scaleToFit,i=t.children,a=t.style,o=t.breakAll,s=t.maxLines;if((r||n)&&!mi.isSsr){var l,c,f=v9({breakAll:o,children:i,style:a});if(f){var u=f.wordsWithComputedWidth,h=f.spaceWidth;l=u,c=h}else return g9(i);return Vme({breakAll:o,children:i,maxLines:s,style:a},l,c,r,n)}return g9(i)},b9={x:0,y:0,lineHeight:"1em",capHeight:"0.71em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",fill:"#808080"},Dl=function(t){var r=(0,yy.useMemo)(function(){return Hme({breakAll:t.breakAll,children:t.children,maxLines:t.maxLines,scaleToFit:t.scaleToFit,style:t.style,width:t.width})},[t.breakAll,t.children,t.maxLines,t.scaleToFit,t.style,t.width]),n=t.dx,i=t.dy,a=t.textAnchor,o=t.verticalAnchor,s=t.scaleToFit,l=t.angle,c=t.lineHeight,f=t.capHeight,u=t.className,h=t.breakAll,g=Mme(t,Rme);if(!Sr(g.x)||!Sr(g.y))return null;var _=g.x+(Ue(n)?n:0),w=g.y+(Ue(i)?i:0),E;switch(o){case"start":E=(0,Q0.default)("calc(".concat(f,")"));break;case"middle":E=(0,Q0.default)("calc(".concat((r.length-1)/2," * -").concat(c," + (").concat(f," / 2))"));break;default:E=(0,Q0.default)("calc(".concat(r.length-1," * -").concat(c,")"));break}var S=[];if(s){var A=r[0].width,O=t.width;S.push("scale(".concat((Ue(O)?O/A:1)/A,")"))}return l&&S.push("rotate(".concat(l,", ").concat(_,", ").concat(w,")")),S.length&&(g.transform=S.join(" ")),yy.default.createElement("text",NI({},ht(g,!0),{x:_,y:w,className:(0,y9.default)("recharts-text",u),textAnchor:a,fill:g.fill.includes("url")?b9.fill:g.fill}),r.map(function(C,T){return yy.default.createElement("tspan",{x:_,dy:T===0?E:c,key:T},C.words.join(h?"":" "))}))};Dl.defaultProps=b9;var MC=oe(Oa()),Jy=oe(fn()),Gy=oe(Aa()),Yr=oe(He()),jC=oe(qr());var c0e=oe(Aa());var h7=oe(e2()),g7=oe(U0()),y7=oe(d0()),m7=oe(M_()),U2=oe(nO()),jy=oe(Vr()),Uy=oe(E9()),zy=oe(C9()),v7=oe(P9()),no=oe(fn()),AC=oe(Jc()),io=oe(Aa());var B2={};RX(B2,{scaleBand:()=>Bl,scaleDiverging:()=>F2,scaleDivergingLog:()=>pC,scaleDivergingPow:()=>D2,scaleDivergingSqrt:()=>e7,scaleDivergingSymlog:()=>hC,scaleIdentity:()=>v2,scaleImplicit:()=>s2,scaleLinear:()=>mu,scaleLog:()=>b2,scaleOrdinal:()=>qd,scalePoint:()=>Rl,scalePow:()=>Cy,scaleQuantile:()=>S2,scaleQuantize:()=>x2,scaleRadial:()=>w2,scaleSequential:()=>T2,scaleSequentialLog:()=>fC,scaleSequentialPow:()=>N2,scaleSequentialQuantile:()=>L2,scaleSequentialSqrt:()=>Qq,scaleSequentialSymlog:()=>dC,scaleSqrt:()=>wq,scaleSymlog:()=>_2,scaleThreshold:()=>k2,scaleTime:()=>cC,scaleUtc:()=>uC,tickFormat:()=>ky});function vi(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function FI(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function cu(e){let t,r,n;e.length!==2?(t=vi,r=(s,l)=>vi(e(s),l),n=(s,l)=>e(s)-l):(t=e===vi||e===FI?e:hve,r=e,n=e);function i(s,l,c=0,f=s.length){if(c<f){if(t(l,l)!==0)return f;do{let u=c+f>>>1;r(s[u],l)<0?c=u+1:f=u}while(c<f)}return c}function a(s,l,c=0,f=s.length){if(c<f){if(t(l,l)!==0)return f;do{let u=c+f>>>1;r(s[u],l)<=0?c=u+1:f=u}while(c<f)}return c}function o(s,l,c=0,f=s.length){let u=i(s,l,c,f-1);return u>c&&n(s[u-1],l)>-n(s[u],l)?u-1:u}return{left:i,center:o,right:a}}function hve(){return 0}function my(e){return e===null?NaN:+e}function*F9(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}var D9=cu(vi),B9=D9.right,gve=D9.left,yve=cu(my).center,to=B9;var Ud=class extends Map{constructor(t,r=bve){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let[n,i]of t)this.set(n,i)}get(t){return super.get(R9(this,t))}has(t){return super.has(R9(this,t))}set(t,r){return super.set(mve(this,t),r)}delete(t){return super.delete(vve(this,t))}};function R9({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):r}function mve({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function vve({_intern:e,_key:t},r){let n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function bve(e){return e!==null&&typeof e=="object"?e.valueOf():e}function M9(e=vi){if(e===vi)return DI;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{let n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function DI(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}var _ve=Math.sqrt(50),wve=Math.sqrt(10),Sve=Math.sqrt(2);function t2(e,t,r){let n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),o=a>=_ve?10:a>=wve?5:a>=Sve?2:1,s,l,c;return i<0?(c=Math.pow(10,-i)/o,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*o,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=r&&r<2?t2(e,t,r*2):[s,l,c]}function uu(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];let n=t<e,[i,a,o]=n?t2(t,e,r):t2(e,t,r);if(!(a>=i))return[];let s=a-i+1,l=new Array(s);if(n)if(o<0)for(let c=0;c<s;++c)l[c]=(a-c)/-o;else for(let c=0;c<s;++c)l[c]=(a-c)*o;else if(o<0)for(let c=0;c<s;++c)l[c]=(i+c)/-o;else for(let c=0;c<s;++c)l[c]=(i+c)*o;return l}function vy(e,t,r){return t=+t,e=+e,r=+r,t2(e,t,r)[2]}function zd(e,t,r){t=+t,e=+e,r=+r;let n=t<e,i=n?vy(t,e,r):vy(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function r2(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r<i||r===void 0&&i>=i)&&(r=i)}return r}function n2(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r>i||r===void 0&&i>=i)&&(r=i)}return r}function i2(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?DI:M9(i);n>r;){if(n-r>600){let l=n-r+1,c=t-r+1,f=Math.log(l),u=.5*Math.exp(2*f/3),h=.5*Math.sqrt(f*u*(l-u)/l)*(c-l/2<0?-1:1),g=Math.max(r,Math.floor(t-c*u/l+h)),_=Math.min(n,Math.floor(t+(l-c)*u/l+h));i2(e,t,g,_,i)}let a=e[t],o=r,s=n;for(by(e,r,t),i(e[n],a)>0&&by(e,r,n);o<s;){for(by(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}i(e[r],a)===0?by(e,r,s):(++s,by(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}return e}function by(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function a2(e,t,r){if(e=Float64Array.from(F9(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return n2(e);if(t>=1)return r2(e);var n,i=(n-1)*t,a=Math.floor(i),o=r2(i2(e,a).subarray(0,a+1)),s=n2(e.subarray(a+1));return o+(s-o)*(i-a)}}function BI(e,t,r=my){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,a=Math.floor(i),o=+r(e[a],a,e),s=+r(e[a+1],a+1,e);return o+(s-o)*(i-a)}}function o2(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(i);++n<i;)a[n]=e+n*r;return a}function Fr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Fa(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var s2=Symbol("implicit");function qd(){var e=new Ud,t=[],r=[],n=s2;function i(a){let o=e.get(a);if(o===void 0){if(n!==s2)return n;e.set(a,o=t.push(a)-1)}return r[o%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Ud;for(let o of a)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return qd(t,r).unknown(n)},Fr.apply(i,arguments),i}function Bl(){var e=qd().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,a,o,s=!1,l=0,c=0,f=.5;delete e.unknown;function u(){var h=t().length,g=i<n,_=g?i:n,w=g?n:i;a=(w-_)/Math.max(1,h-l+c*2),s&&(a=Math.floor(a)),_+=(w-_-a*(h-l))*f,o=a*(1-l),s&&(_=Math.round(_),o=Math.round(o));var E=o2(h).map(function(S){return _+a*S});return r(g?E.reverse():E)}return e.domain=function(h){return arguments.length?(t(h),u()):t()},e.range=function(h){return arguments.length?([n,i]=h,n=+n,i=+i,u()):[n,i]},e.rangeRound=function(h){return[n,i]=h,n=+n,i=+i,s=!0,u()},e.bandwidth=function(){return o},e.step=function(){return a},e.round=function(h){return arguments.length?(s=!!h,u()):s},e.padding=function(h){return arguments.length?(l=Math.min(1,c=+h),u()):l},e.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),u()):l},e.paddingOuter=function(h){return arguments.length?(c=+h,u()):c},e.align=function(h){return arguments.length?(f=Math.max(0,Math.min(1,h)),u()):f},e.copy=function(){return Bl(t(),[n,i]).round(s).paddingInner(l).paddingOuter(c).align(f)},Fr.apply(u(),arguments)}function j9(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return j9(t())},e}function Rl(){return j9(Bl.apply(null,arguments).paddingInner(1))}function l2(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function RI(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Sy(){}var _y=.7,f2=1/_y,Vd="\\s*([+-]?\\d+)\\s*",wy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Mo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xve=/^#([0-9a-f]{3,8})$/,kve=new RegExp(`^rgb\\(${Vd},${Vd},${Vd}\\)$`),Eve=new RegExp(`^rgb\\(${Mo},${Mo},${Mo}\\)$`),Ove=new RegExp(`^rgba\\(${Vd},${Vd},${Vd},${wy}\\)$`),Ave=new RegExp(`^rgba\\(${Mo},${Mo},${Mo},${wy}\\)$`),Ive=new RegExp(`^hsl\\(${wy},${Mo},${Mo}\\)$`),Cve=new RegExp(`^hsla\\(${wy},${Mo},${Mo},${wy}\\)$`),$9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};l2(Sy,Ml,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:U9,formatHex:U9,formatHex8:Tve,formatHsl:Nve,formatRgb:z9,toString:z9});function U9(){return this.rgb().formatHex()}function Tve(){return this.rgb().formatHex8()}function Nve(){return G9(this).formatHsl()}function z9(){return this.rgb().formatRgb()}function Ml(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=xve.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?q9(t):r===3?new ji(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?c2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?c2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=kve.exec(e))?new ji(t[1],t[2],t[3],1):(t=Eve.exec(e))?new ji(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ove.exec(e))?c2(t[1],t[2],t[3],t[4]):(t=Ave.exec(e))?c2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Ive.exec(e))?W9(t[1],t[2]/100,t[3]/100,1):(t=Cve.exec(e))?W9(t[1],t[2]/100,t[3]/100,t[4]):$9.hasOwnProperty(e)?q9($9[e]):e==="transparent"?new ji(NaN,NaN,NaN,0):null}function q9(e){return new ji(e>>16&255,e>>8&255,e&255,1)}function c2(e,t,r,n){return n<=0&&(e=t=r=NaN),new ji(e,t,r,n)}function Lve(e){return e instanceof Sy||(e=Ml(e)),e?(e=e.rgb(),new ji(e.r,e.g,e.b,e.opacity)):new ji}function Hd(e,t,r,n){return arguments.length===1?Lve(e):new ji(e,t,r,n??1)}function ji(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}l2(ji,Hd,RI(Sy,{brighter(e){return e=e==null?f2:Math.pow(f2,e),new ji(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?_y:Math.pow(_y,e),new ji(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ji(du(this.r),du(this.g),du(this.b),d2(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:V9,formatHex:V9,formatHex8:Pve,formatRgb:H9,toString:H9}));function V9(){return`#${fu(this.r)}${fu(this.g)}${fu(this.b)}`}function Pve(){return`#${fu(this.r)}${fu(this.g)}${fu(this.b)}${fu((isNaN(this.opacity)?1:this.opacity)*255)}`}function H9(){let e=d2(this.opacity);return`${e===1?"rgb(":"rgba("}${du(this.r)}, ${du(this.g)}, ${du(this.b)}${e===1?")":`, ${e})`}`}function d2(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function du(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function fu(e){return e=du(e),(e<16?"0":"")+e.toString(16)}function W9(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ro(e,t,r,n)}function G9(e){if(e instanceof ro)return new ro(e.h,e.s,e.l,e.opacity);if(e instanceof Sy||(e=Ml(e)),!e)return new ro;if(e instanceof ro)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=NaN,s=a-i,l=(a+i)/2;return s?(t===a?o=(r-n)/s+(r<n)*6:r===a?o=(n-t)/s+2:o=(t-r)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new ro(o,s,l,e.opacity)}function Y9(e,t,r,n){return arguments.length===1?G9(e):new ro(e,t,r,n??1)}function ro(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}l2(ro,Y9,RI(Sy,{brighter(e){return e=e==null?f2:Math.pow(f2,e),new ro(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?_y:Math.pow(_y,e),new ro(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new ji(MI(e>=240?e-240:e+120,i,n),MI(e,i,n),MI(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new ro(J9(this.h),u2(this.s),u2(this.l),d2(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=d2(this.opacity);return`${e===1?"hsl(":"hsla("}${J9(this.h)}, ${u2(this.s)*100}%, ${u2(this.l)*100}%${e===1?")":`, ${e})`}`}}));function J9(e){return e=(e||0)%360,e<0?e+360:e}function u2(e){return Math.max(0,Math.min(1,e||0))}function MI(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function jI(e,t,r,n,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*r+(1+3*e+3*a-3*o)*n+o*i)/6}function K9(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],a=e[n+1],o=n>0?e[n-1]:2*i-a,s=n<t-1?e[n+2]:2*a-i;return jI((r-n/t)*t,o,i,a,s)}}function X9(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],a=e[n%t],o=e[(n+1)%t],s=e[(n+2)%t];return jI((r-n/t)*t,i,a,o,s)}}var xy=e=>()=>e;function Fve(e,t){return function(r){return e+r*t}}function Dve(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Z9(e){return(e=+e)==1?p2:function(t,r){return r-t?Dve(t,r,e):xy(isNaN(t)?r:t)}}function p2(e,t){var r=t-e;return r?Fve(e,r):xy(isNaN(e)?t:e)}var $I=function e(t){var r=Z9(t);function n(i,a){var o=r((i=Hd(i)).r,(a=Hd(a)).r),s=r(i.g,a.g),l=r(i.b,a.b),c=p2(i.opacity,a.opacity);return function(f){return i.r=o(f),i.g=s(f),i.b=l(f),i.opacity=c(f),i+""}}return n.gamma=e,n}(1);function Q9(e){return function(t){var r=t.length,n=new Array(r),i=new Array(r),a=new Array(r),o,s;for(o=0;o<r;++o)s=Hd(t[o]),n[o]=s.r||0,i[o]=s.g||0,a[o]=s.b||0;return n=e(n),i=e(i),a=e(a),s.opacity=1,function(l){return s.r=n(l),s.g=i(l),s.b=a(l),s+""}}}var IMe=Q9(K9),CMe=Q9(X9);function eq(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function tq(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function rq(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=oa(e[o],t[o]);for(;o<r;++o)a[o]=t[o];return function(s){for(o=0;o<n;++o)a[o]=i[o](s);return a}}function nq(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function jl(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function iq(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=oa(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var zI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,UI=new RegExp(zI.source,"g");function Bve(e){return function(){return e}}function Rve(e){return function(t){return e(t)+""}}function aq(e,t){var r=zI.lastIndex=UI.lastIndex=0,n,i,a,o=-1,s=[],l=[];for(e=e+"",t=t+"";(n=zI.exec(e))&&(i=UI.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:jl(n,i)})),r=UI.lastIndex;return r<t.length&&(a=t.slice(r),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?Rve(l[0].x):Bve(t):(t=l.length,function(c){for(var f=0,u;f<t;++f)s[(u=l[f]).i]=u.x(c);return s.join("")})}function oa(e,t){var r=typeof t,n;return t==null||r==="boolean"?xy(t):(r==="number"?jl:r==="string"?(n=Ml(t))?(t=n,$I):aq:t instanceof Ml?$I:t instanceof Date?nq:tq(t)?eq:Array.isArray(t)?rq:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?iq:jl)(e,t)}function pu(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function h2(e,t){t===void 0&&(t=e,e=oa);for(var r=0,n=t.length-1,i=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(i,i=t[++r]);return function(o){var s=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return a[s](o-s)}}function qI(e){return function(){return e}}function $l(e){return+e}var oq=[0,1];function bn(e){return e}function VI(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:qI(isNaN(t)?NaN:.5)}function Mve(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function jve(e,t,r){var n=e[0],i=e[1],a=t[0],o=t[1];return i<n?(n=VI(i,n),a=r(o,a)):(n=VI(n,i),a=r(a,o)),function(s){return a(n(s))}}function $ve(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=VI(e[o],e[o+1]),a[o]=r(t[o],t[o+1]);return function(s){var l=to(e,s,1,n)-1;return a[l](i[l](s))}}function jo(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function hu(){var e=oq,t=oq,r=oa,n,i,a,o=bn,s,l,c;function f(){var h=Math.min(e.length,t.length);return o!==bn&&(o=Mve(e[0],e[h-1])),s=h>2?$ve:jve,l=c=null,u}function u(h){return h==null||isNaN(h=+h)?a:(l||(l=s(e.map(n),t,r)))(n(o(h)))}return u.invert=function(h){return o(i((c||(c=s(t,e.map(n),jl)))(h)))},u.domain=function(h){return arguments.length?(e=Array.from(h,$l),f()):e.slice()},u.range=function(h){return arguments.length?(t=Array.from(h),f()):t.slice()},u.rangeRound=function(h){return t=Array.from(h),r=pu,f()},u.clamp=function(h){return arguments.length?(o=h?!0:bn,f()):o!==bn},u.interpolate=function(h){return arguments.length?(r=h,f()):r},u.unknown=function(h){return arguments.length?(a=h,u):a},function(h,g){return n=h,i=g,f()}}function gu(){return hu()(bn,bn)}function sq(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function yu(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function $o(e){return e=yu(Math.abs(e)),e?e[1]:NaN}function lq(e,t){return function(r,n){for(var i=r.length,a=[],o=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),a.push(r.substring(i-=s,i+s)),!((l+=s+1)>n));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function cq(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Uve=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Uo(e){if(!(t=Uve.exec(e)))throw new Error("invalid format: "+e);var t;return new g2({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Uo.prototype=g2.prototype;function g2(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}g2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function uq(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var HI;function fq(e,t){var r=yu(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(HI=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+yu(e,Math.max(0,t+a-1))[0]}function WI(e,t){var r=yu(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}var JI={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:sq,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>WI(e*100,t),r:WI,s:fq,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function GI(e){return e}var dq=Array.prototype.map,pq=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function hq(e){var t=e.grouping===void 0||e.thousands===void 0?GI:lq(dq.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?GI:cq(dq.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(u){u=Uo(u);var h=u.fill,g=u.align,_=u.sign,w=u.symbol,E=u.zero,S=u.width,A=u.comma,O=u.precision,C=u.trim,T=u.type;T==="n"?(A=!0,T="g"):JI[T]||(O===void 0&&(O=12),C=!0,T="g"),(E||h==="0"&&g==="=")&&(E=!0,h="0",g="=");var D=w==="$"?r:w==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",P=w==="$"?n:/[%p]/.test(T)?o:"",z=JI[T],ne=/[defgprs%]/.test(T);O=O===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,O)):Math.max(0,Math.min(20,O));function V(X){var Q=D,ie=P,pe,de,F;if(T==="c")ie=z(X)+ie,X="";else{X=+X;var H=X<0||1/X<0;if(X=isNaN(X)?l:z(Math.abs(X),O),C&&(X=uq(X)),H&&+X==0&&_!=="+"&&(H=!1),Q=(H?_==="("?_:s:_==="-"||_==="("?"":_)+Q,ie=(T==="s"?pq[8+HI/3]:"")+ie+(H&&_==="("?")":""),ne){for(pe=-1,de=X.length;++pe<de;)if(F=X.charCodeAt(pe),48>F||F>57){ie=(F===46?i+X.slice(pe+1):X.slice(pe))+ie,X=X.slice(0,pe);break}}}A&&!E&&(X=t(X,1/0));var Z=Q.length+X.length+ie.length,j=Z<S?new Array(S-Z+1).join(h):"";switch(A&&E&&(X=t(j+X,j.length?S-ie.length:1/0),j=""),g){case"<":X=Q+X+ie+j;break;case"=":X=Q+j+X+ie;break;case"^":X=j.slice(0,Z=j.length>>1)+Q+X+ie+j.slice(Z);break;default:X=j+Q+X+ie;break}return a(X)}return V.toString=function(){return u+""},V}function f(u,h){var g=c((u=Uo(u),u.type="f",u)),_=Math.max(-8,Math.min(8,Math.floor($o(h)/3)))*3,w=Math.pow(10,-_),E=pq[8+_/3];return function(S){return g(w*S)+E}}return{format:c,formatPrefix:f}}var y2,Wd,m2;YI({thousands:",",grouping:[3],currency:["$",""]});function YI(e){return y2=hq(e),Wd=y2.format,m2=y2.formatPrefix,y2}function KI(e){return Math.max(0,-$o(Math.abs(e)))}function XI(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor($o(t)/3)))*3-$o(Math.abs(e)))}function ZI(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,$o(t)-$o(e))+1}function ky(e,t,r,n){var i=zd(e,t,r),a;switch(n=Uo(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=XI(i,o))&&(n.precision=a),m2(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=ZI(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=KI(i))&&(n.precision=a-(n.type==="%")*2);break}}return Wd(n)}function bi(e){var t=e.domain;return e.ticks=function(r){var n=t();return uu(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return ky(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,o=n[i],s=n[a],l,c,f=10;for(s<o&&(c=o,o=s,s=c,c=i,i=a,a=c);f-- >0;){if(c=vy(o,s,r),c===l)return n[i]=o,n[a]=s,t(n);if(c>0)o=Math.floor(o/c)*c,s=Math.ceil(s/c)*c;else if(c<0)o=Math.ceil(o*c)/c,s=Math.floor(s*c)/c;else break;l=c}return e},e}function mu(){var e=gu();return e.copy=function(){return jo(e,mu())},Fr.apply(e,arguments),bi(e)}function v2(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,$l),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return v2(e).unknown(t)},e=arguments.length?Array.from(e,$l):[0,1],bi(r)}function Ey(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],o;return a<i&&(o=r,r=n,n=o,o=i,i=a,a=o),e[r]=t.floor(i),e[n]=t.ceil(a),e}function gq(e){return Math.log(e)}function yq(e){return Math.exp(e)}function zve(e){return-Math.log(-e)}function qve(e){return-Math.exp(-e)}function Vve(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Hve(e){return e===10?Vve:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Wve(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function mq(e){return(t,r)=>-e(-t,r)}function Oy(e){let t=e(gq,yq),r=t.domain,n=10,i,a;function o(){return i=Wve(n),a=Hve(n),r()[0]<0?(i=mq(i),a=mq(a),e(zve,qve)):e(gq,yq),t}return t.base=function(s){return arguments.length?(n=+s,o()):n},t.domain=function(s){return arguments.length?(r(s),o()):r()},t.ticks=s=>{let l=r(),c=l[0],f=l[l.length-1],u=f<c;u&&([c,f]=[f,c]);let h=i(c),g=i(f),_,w,E=s==null?10:+s,S=[];if(!(n%1)&&g-h<E){if(h=Math.floor(h),g=Math.ceil(g),c>0){for(;h<=g;++h)for(_=1;_<n;++_)if(w=h<0?_/a(-h):_*a(h),!(w<c)){if(w>f)break;S.push(w)}}else for(;h<=g;++h)for(_=n-1;_>=1;--_)if(w=h>0?_/a(-h):_*a(h),!(w<c)){if(w>f)break;S.push(w)}S.length*2<E&&(S=uu(c,f,E))}else S=uu(h,g,Math.min(g-h,E)).map(a);return u?S.reverse():S},t.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=Uo(l)).precision==null&&(l.trim=!0),l=Wd(l)),s===1/0)return l;let c=Math.max(1,n*s/t.ticks().length);return f=>{let u=f/a(Math.round(i(f)));return u*n<n-.5&&(u*=n),u<=c?l(f):""}},t.nice=()=>r(Ey(r(),{floor:s=>a(Math.floor(i(s))),ceil:s=>a(Math.ceil(i(s)))})),t}function b2(){let e=Oy(hu()).domain([1,10]);return e.copy=()=>jo(e,b2()).base(e.base()),Fr.apply(e,arguments),e}function vq(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function bq(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Ay(e){var t=1,r=e(vq(t),bq(t));return r.constant=function(n){return arguments.length?e(vq(t=+n),bq(t)):t},bi(r)}function _2(){var e=Ay(hu());return e.copy=function(){return jo(e,_2()).constant(e.constant())},Fr.apply(e,arguments)}function _q(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Jve(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Gve(e){return e<0?-e*e:e*e}function Iy(e){var t=e(bn,bn),r=1;function n(){return r===1?e(bn,bn):r===.5?e(Jve,Gve):e(_q(r),_q(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},bi(t)}function Cy(){var e=Iy(hu());return e.copy=function(){return jo(e,Cy()).exponent(e.exponent())},Fr.apply(e,arguments),e}function wq(){return Cy.apply(null,arguments).exponent(.5)}function Sq(e){return Math.sign(e)*e*e}function Yve(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function w2(){var e=gu(),t=[0,1],r=!1,n;function i(a){var o=Yve(e(a));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(a){return e.invert(Sq(a))},i.domain=function(a){return arguments.length?(e.domain(a),i):e.domain()},i.range=function(a){return arguments.length?(e.range((t=Array.from(a,$l)).map(Sq)),i):t.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(e.clamp(a),i):e.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return w2(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Fr.apply(i,arguments),bi(i)}function S2(){var e=[],t=[],r=[],n;function i(){var o=0,s=Math.max(1,t.length);for(r=new Array(s-1);++o<s;)r[o-1]=BI(e,o/s);return a}function a(o){return o==null||isNaN(o=+o)?n:t[to(r,o)]}return a.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let s of o)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(vi),i()},a.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return S2().domain(e).range(t).unknown(n)},Fr.apply(a,arguments)}function x2(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function o(l){return l!=null&&l<=l?i[to(n,l,0,r)]:a}function s(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,s()):[e,t]},o.range=function(l){return arguments.length?(r=(i=Array.from(l)).length-1,s()):i.slice()},o.invertExtent=function(l){var c=i.indexOf(l);return c<0?[NaN,NaN]:c<1?[e,n[0]]:c>=r?[n[r-1],t]:[n[c-1],n[c]]},o.unknown=function(l){return arguments.length&&(a=l),o},o.thresholds=function(){return n.slice()},o.copy=function(){return x2().domain([e,t]).range(i).unknown(a)},Fr.apply(bi(o),arguments)}function k2(){var e=[.5],t=[0,1],r,n=1;function i(a){return a!=null&&a<=a?t[to(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return k2().domain(e).range(t).unknown(r)},Fr.apply(i,arguments)}var QI=new Date,eC=new Date;function gr(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(e(a=new Date(+a)),a),i.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),i.round=a=>{let o=i(a),s=i.ceil(a);return a-o<s-a?o:s},i.offset=(a,o)=>(t(a=new Date(+a),o==null?1:Math.floor(o)),a),i.range=(a,o,s)=>{let l=[];if(a=i.ceil(a),s=s==null?1:Math.floor(s),!(a<o)||!(s>0))return l;let c;do l.push(c=new Date(+a)),t(a,s),e(a);while(c<a&&a<o);return l},i.filter=a=>gr(o=>{if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},(o,s)=>{if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!a(o););else for(;--s>=0;)for(;t(o,1),!a(o););}),r&&(i.count=(a,o)=>(QI.setTime(+a),eC.setTime(+o),e(QI),e(eC),Math.floor(r(QI,eC))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?o=>n(o)%a===0:o=>i.count(0,o)%a===0):i)),i}var Ty=gr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Ty.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?gr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Ty);var j4e=Ty.range;var Da=gr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),xq=Da.range;var Jd=gr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),Kve=Jd.range,Gd=gr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),Xve=Gd.range;var Yd=gr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),Zve=Yd.range,Kd=gr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),Qve=Kd.range;var Bs=gr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),ebe=Bs.range,_u=gr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),tbe=_u.range,E2=gr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),rbe=E2.range;function wu(e){return gr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}var Rs=wu(0),Xd=wu(1),Eq=wu(2),Oq=wu(3),Ul=wu(4),Aq=wu(5),Iq=wu(6),Cq=Rs.range,nbe=Xd.range,ibe=Eq.range,abe=Oq.range,obe=Ul.range,sbe=Aq.range,lbe=Iq.range;function Su(e){return gr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/6048e5)}var Ms=Su(0),Zd=Su(1),Tq=Su(2),Nq=Su(3),zl=Su(4),Lq=Su(5),Pq=Su(6),Fq=Ms.range,cbe=Zd.range,ube=Tq.range,fbe=Nq.range,dbe=zl.range,pbe=Lq.range,hbe=Pq.range;var Qd=gr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),gbe=Qd.range,ep=gr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),ybe=ep.range;var sa=gr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());sa.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:gr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});var mbe=sa.range,la=gr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());la.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:gr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});var vbe=la.range;function Bq(e,t,r,n,i,a){let o=[[Da,1,1e3],[Da,5,5*1e3],[Da,15,15*1e3],[Da,30,30*1e3],[a,1,6e4],[a,5,5*6e4],[a,15,15*6e4],[a,30,30*6e4],[i,1,36e5],[i,3,3*36e5],[i,6,6*36e5],[i,12,12*36e5],[n,1,864e5],[n,2,2*864e5],[r,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function s(c,f,u){let h=f<c;h&&([c,f]=[f,c]);let g=u&&typeof u.range=="function"?u:l(c,f,u),_=g?g.range(c,+f+1):[];return h?_.reverse():_}function l(c,f,u){let h=Math.abs(f-c)/u,g=cu(([,,E])=>E).right(o,h);if(g===o.length)return e.every(zd(c/31536e6,f/31536e6,u));if(g===0)return Ty.every(Math.max(zd(c,f,u),1));let[_,w]=o[h/o[g-1][2]<o[g][2]/h?g-1:g];return _.every(w)}return[s,l]}var[tC,rC]=Bq(la,ep,Ms,E2,Kd,Gd),[nC,iC]=Bq(sa,Qd,Rs,Bs,Yd,Jd);function aC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function oC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ly(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function sC(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,c=Py(i),f=Fy(i),u=Py(a),h=Fy(a),g=Py(o),_=Fy(o),w=Py(s),E=Fy(s),S=Py(l),A=Fy(l),O={a:H,A:Z,b:j,B:$,c:null,d:zq,e:zq,f:zbe,g:Zbe,G:e_e,H:jbe,I:$be,j:Ube,L:Jq,m:qbe,M:Vbe,p:q,q:ae,Q:Hq,s:Wq,S:Hbe,u:Wbe,U:Jbe,V:Gbe,w:Ybe,W:Kbe,x:null,X:null,y:Xbe,Y:Qbe,Z:t_e,"%":Vq},C={a:le,A:fe,b:Se,B:ke,c:null,d:qq,e:qq,f:a_e,g:g_e,G:m_e,H:r_e,I:n_e,j:i_e,L:Yq,m:o_e,M:s_e,p:xe,q:se,Q:Hq,s:Wq,S:l_e,u:c_e,U:u_e,V:f_e,w:d_e,W:p_e,x:null,X:null,y:h_e,Y:y_e,Z:v_e,"%":Vq},T={a:V,A:X,b:Q,B:ie,c:pe,d:$q,e:$q,f:Dbe,g:jq,G:Mq,H:Uq,I:Uq,j:Nbe,L:Fbe,m:Tbe,M:Lbe,p:ne,q:Cbe,Q:Rbe,s:Mbe,S:Pbe,u:kbe,U:Ebe,V:Obe,w:xbe,W:Abe,x:de,X:F,y:jq,Y:Mq,Z:Ibe,"%":Bbe};O.x=D(r,O),O.X=D(n,O),O.c=D(t,O),C.x=D(r,C),C.X=D(n,C),C.c=D(t,C);function D(be,W){return function(J){var re=[],Ee=-1,Te=0,Ie=be.length,Ye,Ke,St;for(J instanceof Date||(J=new Date(+J));++Ee<Ie;)be.charCodeAt(Ee)===37&&(re.push(be.slice(Te,Ee)),(Ke=Rq[Ye=be.charAt(++Ee)])!=null?Ye=be.charAt(++Ee):Ke=Ye==="e"?" ":"0",(St=W[Ye])&&(Ye=St(J,Ke)),re.push(Ye),Te=Ee+1);return re.push(be.slice(Te,Ee)),re.join("")}}function P(be,W){return function(J){var re=Ly(1900,void 0,1),Ee=z(re,be,J+="",0),Te,Ie;if(Ee!=J.length)return null;if("Q"in re)return new Date(re.Q);if("s"in re)return new Date(re.s*1e3+("L"in re?re.L:0));if(W&&!("Z"in re)&&(re.Z=0),"p"in re&&(re.H=re.H%12+re.p*12),re.m===void 0&&(re.m="q"in re?re.q:0),"V"in re){if(re.V<1||re.V>53)return null;"w"in re||(re.w=1),"Z"in re?(Te=oC(Ly(re.y,0,1)),Ie=Te.getUTCDay(),Te=Ie>4||Ie===0?Zd.ceil(Te):Zd(Te),Te=_u.offset(Te,(re.V-1)*7),re.y=Te.getUTCFullYear(),re.m=Te.getUTCMonth(),re.d=Te.getUTCDate()+(re.w+6)%7):(Te=aC(Ly(re.y,0,1)),Ie=Te.getDay(),Te=Ie>4||Ie===0?Xd.ceil(Te):Xd(Te),Te=Bs.offset(Te,(re.V-1)*7),re.y=Te.getFullYear(),re.m=Te.getMonth(),re.d=Te.getDate()+(re.w+6)%7)}else("W"in re||"U"in re)&&("w"in re||(re.w="u"in re?re.u%7:"W"in re?1:0),Ie="Z"in re?oC(Ly(re.y,0,1)).getUTCDay():aC(Ly(re.y,0,1)).getDay(),re.m=0,re.d="W"in re?(re.w+6)%7+re.W*7-(Ie+5)%7:re.w+re.U*7-(Ie+6)%7);return"Z"in re?(re.H+=re.Z/100|0,re.M+=re.Z%100,oC(re)):aC(re)}}function z(be,W,J,re){for(var Ee=0,Te=W.length,Ie=J.length,Ye,Ke;Ee<Te;){if(re>=Ie)return-1;if(Ye=W.charCodeAt(Ee++),Ye===37){if(Ye=W.charAt(Ee++),Ke=T[Ye in Rq?W.charAt(Ee++):Ye],!Ke||(re=Ke(be,J,re))<0)return-1}else if(Ye!=J.charCodeAt(re++))return-1}return re}function ne(be,W,J){var re=c.exec(W.slice(J));return re?(be.p=f.get(re[0].toLowerCase()),J+re[0].length):-1}function V(be,W,J){var re=g.exec(W.slice(J));return re?(be.w=_.get(re[0].toLowerCase()),J+re[0].length):-1}function X(be,W,J){var re=u.exec(W.slice(J));return re?(be.w=h.get(re[0].toLowerCase()),J+re[0].length):-1}function Q(be,W,J){var re=S.exec(W.slice(J));return re?(be.m=A.get(re[0].toLowerCase()),J+re[0].length):-1}function ie(be,W,J){var re=w.exec(W.slice(J));return re?(be.m=E.get(re[0].toLowerCase()),J+re[0].length):-1}function pe(be,W,J){return z(be,t,W,J)}function de(be,W,J){return z(be,r,W,J)}function F(be,W,J){return z(be,n,W,J)}function H(be){return o[be.getDay()]}function Z(be){return a[be.getDay()]}function j(be){return l[be.getMonth()]}function $(be){return s[be.getMonth()]}function q(be){return i[+(be.getHours()>=12)]}function ae(be){return 1+~~(be.getMonth()/3)}function le(be){return o[be.getUTCDay()]}function fe(be){return a[be.getUTCDay()]}function Se(be){return l[be.getUTCMonth()]}function ke(be){return s[be.getUTCMonth()]}function xe(be){return i[+(be.getUTCHours()>=12)]}function se(be){return 1+~~(be.getUTCMonth()/3)}return{format:function(be){var W=D(be+="",O);return W.toString=function(){return be},W},parse:function(be){var W=P(be+="",!1);return W.toString=function(){return be},W},utcFormat:function(be){var W=D(be+="",C);return W.toString=function(){return be},W},utcParse:function(be){var W=P(be+="",!0);return W.toString=function(){return be},W}}}var Rq={"-":"",_:" ",0:"0"},In=/^\s*\d+/,_be=/^%/,wbe=/[\\^$*+?|[\]().{}]/g;function Jt(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function Sbe(e){return e.replace(wbe,"\\$&")}function Py(e){return new RegExp("^(?:"+e.map(Sbe).join("|")+")","i")}function Fy(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function xbe(e,t,r){var n=In.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function kbe(e,t,r){var n=In.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Ebe(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function Obe(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Abe(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function Mq(e,t,r){var n=In.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function jq(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Ibe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Cbe(e,t,r){var n=In.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function Tbe(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function $q(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Nbe(e,t,r){var n=In.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function Uq(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Lbe(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function Pbe(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function Fbe(e,t,r){var n=In.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Dbe(e,t,r){var n=In.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Bbe(e,t,r){var n=_be.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Rbe(e,t,r){var n=In.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Mbe(e,t,r){var n=In.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function zq(e,t){return Jt(e.getDate(),t,2)}function jbe(e,t){return Jt(e.getHours(),t,2)}function $be(e,t){return Jt(e.getHours()%12||12,t,2)}function Ube(e,t){return Jt(1+Bs.count(sa(e),e),t,3)}function Jq(e,t){return Jt(e.getMilliseconds(),t,3)}function zbe(e,t){return Jq(e,t)+"000"}function qbe(e,t){return Jt(e.getMonth()+1,t,2)}function Vbe(e,t){return Jt(e.getMinutes(),t,2)}function Hbe(e,t){return Jt(e.getSeconds(),t,2)}function Wbe(e){var t=e.getDay();return t===0?7:t}function Jbe(e,t){return Jt(Rs.count(sa(e)-1,e),t,2)}function Gq(e){var t=e.getDay();return t>=4||t===0?Ul(e):Ul.ceil(e)}function Gbe(e,t){return e=Gq(e),Jt(Ul.count(sa(e),e)+(sa(e).getDay()===4),t,2)}function Ybe(e){return e.getDay()}function Kbe(e,t){return Jt(Xd.count(sa(e)-1,e),t,2)}function Xbe(e,t){return Jt(e.getFullYear()%100,t,2)}function Zbe(e,t){return e=Gq(e),Jt(e.getFullYear()%100,t,2)}function Qbe(e,t){return Jt(e.getFullYear()%1e4,t,4)}function e_e(e,t){var r=e.getDay();return e=r>=4||r===0?Ul(e):Ul.ceil(e),Jt(e.getFullYear()%1e4,t,4)}function t_e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Jt(t/60|0,"0",2)+Jt(t%60,"0",2)}function qq(e,t){return Jt(e.getUTCDate(),t,2)}function r_e(e,t){return Jt(e.getUTCHours(),t,2)}function n_e(e,t){return Jt(e.getUTCHours()%12||12,t,2)}function i_e(e,t){return Jt(1+_u.count(la(e),e),t,3)}function Yq(e,t){return Jt(e.getUTCMilliseconds(),t,3)}function a_e(e,t){return Yq(e,t)+"000"}function o_e(e,t){return Jt(e.getUTCMonth()+1,t,2)}function s_e(e,t){return Jt(e.getUTCMinutes(),t,2)}function l_e(e,t){return Jt(e.getUTCSeconds(),t,2)}function c_e(e){var t=e.getUTCDay();return t===0?7:t}function u_e(e,t){return Jt(Ms.count(la(e)-1,e),t,2)}function Kq(e){var t=e.getUTCDay();return t>=4||t===0?zl(e):zl.ceil(e)}function f_e(e,t){return e=Kq(e),Jt(zl.count(la(e),e)+(la(e).getUTCDay()===4),t,2)}function d_e(e){return e.getUTCDay()}function p_e(e,t){return Jt(Zd.count(la(e)-1,e),t,2)}function h_e(e,t){return Jt(e.getUTCFullYear()%100,t,2)}function g_e(e,t){return e=Kq(e),Jt(e.getUTCFullYear()%100,t,2)}function y_e(e,t){return Jt(e.getUTCFullYear()%1e4,t,4)}function m_e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?zl(e):zl.ceil(e),Jt(e.getUTCFullYear()%1e4,t,4)}function v_e(){return"+0000"}function Vq(){return"%"}function Hq(e){return+e}function Wq(e){return Math.floor(+e/1e3)}var tp,O2,Xq,A2,Zq;lC({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function lC(e){return tp=sC(e),O2=tp.format,Xq=tp.parse,A2=tp.utcFormat,Zq=tp.utcParse,tp}function b_e(e){return new Date(e)}function __e(e){return e instanceof Date?+e:+new Date(+e)}function I2(e,t,r,n,i,a,o,s,l,c){var f=gu(),u=f.invert,h=f.domain,g=c(".%L"),_=c(":%S"),w=c("%I:%M"),E=c("%I %p"),S=c("%a %d"),A=c("%b %d"),O=c("%B"),C=c("%Y");function T(D){return(l(D)<D?g:s(D)<D?_:o(D)<D?w:a(D)<D?E:n(D)<D?i(D)<D?S:A:r(D)<D?O:C)(D)}return f.invert=function(D){return new Date(u(D))},f.domain=function(D){return arguments.length?h(Array.from(D,__e)):h().map(b_e)},f.ticks=function(D){var P=h();return e(P[0],P[P.length-1],D??10)},f.tickFormat=function(D,P){return P==null?T:c(P)},f.nice=function(D){var P=h();return(!D||typeof D.range!="function")&&(D=t(P[0],P[P.length-1],D??10)),D?h(Ey(P,D)):f},f.copy=function(){return jo(f,I2(e,t,r,n,i,a,o,s,l,c))},f}function cC(){return Fr.apply(I2(nC,iC,sa,Qd,Rs,Bs,Yd,Jd,Da,O2).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function uC(){return Fr.apply(I2(tC,rC,la,ep,Ms,_u,Kd,Gd,Da,A2).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function C2(){var e=0,t=1,r,n,i,a,o=bn,s=!1,l;function c(u){return u==null||isNaN(u=+u)?l:o(i===0?.5:(u=(a(u)-r)*i,s?Math.max(0,Math.min(1,u)):u))}c.domain=function(u){return arguments.length?([e,t]=u,r=a(e=+e),n=a(t=+t),i=r===n?0:1/(n-r),c):[e,t]},c.clamp=function(u){return arguments.length?(s=!!u,c):s},c.interpolator=function(u){return arguments.length?(o=u,c):o};function f(u){return function(h){var g,_;return arguments.length?([g,_]=h,o=u(g,_),c):[o(0),o(1)]}}return c.range=f(oa),c.rangeRound=f(pu),c.unknown=function(u){return arguments.length?(l=u,c):l},function(u){return a=u,r=u(e),n=u(t),i=r===n?0:1/(n-r),c}}function js(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function T2(){var e=bi(C2()(bn));return e.copy=function(){return js(e,T2())},Fa.apply(e,arguments)}function fC(){var e=Oy(C2()).domain([1,10]);return e.copy=function(){return js(e,fC()).base(e.base())},Fa.apply(e,arguments)}function dC(){var e=Ay(C2());return e.copy=function(){return js(e,dC()).constant(e.constant())},Fa.apply(e,arguments)}function N2(){var e=Iy(C2());return e.copy=function(){return js(e,N2()).exponent(e.exponent())},Fa.apply(e,arguments)}function Qq(){return N2.apply(null,arguments).exponent(.5)}function L2(){var e=[],t=bn;function r(n){if(n!=null&&!isNaN(n=+n))return t((to(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(vi),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>a2(e,a/n))},r.copy=function(){return L2(t).domain(e)},Fa.apply(r,arguments)}function P2(){var e=0,t=.5,r=1,n=1,i,a,o,s,l,c=bn,f,u=!1,h;function g(w){return isNaN(w=+w)?h:(w=.5+((w=+f(w))-a)*(n*w<n*a?s:l),c(u?Math.max(0,Math.min(1,w)):w))}g.domain=function(w){return arguments.length?([e,t,r]=w,i=f(e=+e),a=f(t=+t),o=f(r=+r),s=i===a?0:.5/(a-i),l=a===o?0:.5/(o-a),n=a<i?-1:1,g):[e,t,r]},g.clamp=function(w){return arguments.length?(u=!!w,g):u},g.interpolator=function(w){return arguments.length?(c=w,g):c};function _(w){return function(E){var S,A,O;return arguments.length?([S,A,O]=E,c=h2(w,[S,A,O]),g):[c(0),c(.5),c(1)]}}return g.range=_(oa),g.rangeRound=_(pu),g.unknown=function(w){return arguments.length?(h=w,g):h},function(w){return f=w,i=w(e),a=w(t),o=w(r),s=i===a?0:.5/(a-i),l=a===o?0:.5/(o-a),n=a<i?-1:1,g}}function F2(){var e=bi(P2()(bn));return e.copy=function(){return js(e,F2())},Fa.apply(e,arguments)}function pC(){var e=Oy(P2()).domain([.1,1,10]);return e.copy=function(){return js(e,pC()).base(e.base())},Fa.apply(e,arguments)}function hC(){var e=Ay(P2());return e.copy=function(){return js(e,hC()).constant(e.constant())},Fa.apply(e,arguments)}function D2(){var e=Iy(P2());return e.copy=function(){return js(e,D2()).exponent(e.exponent())},Fa.apply(e,arguments)}function e7(){return D2.apply(null,arguments).exponent(.5)}var nr=oe(gC());function w_e(e){return E_e(e)||k_e(e)||x_e(e)||S_e()}function S_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x_e(e,t){if(e){if(typeof e=="string")return yC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yC(e,t)}}function k_e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function E_e(e){if(Array.isArray(e))return yC(e)}function yC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var O_e=function(t){return t},n7={"@@functional/placeholder":!0},i7=function(t){return t===n7},r7=function(t){return function r(){return arguments.length===0||arguments.length===1&&i7(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},A_e=function e(t,r){return t===1?r:r7(function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var o=i.filter(function(s){return s!==n7}).length;return o>=t?r.apply(void 0,i):e(t-o,r7(function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];var f=i.map(function(u){return i7(u)?l.shift():u});return r.apply(void 0,w_e(f).concat(l))}))})},Dy=function(t){return A_e(t.length,t)},By=function(t,r){for(var n=[],i=t;i<r;++i)n[i-t]=i;return n},mC=Dy(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),vC=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return O_e;var i=r.reverse(),a=i[0],o=i.slice(1);return function(){return o.reduce(function(s,l){return l(s)},a.apply(void 0,arguments))}},Ry=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},M2=function(t){var r=null,n=null;return function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r&&a.every(function(s,l){return s===r[l]})||(r=a,n=t.apply(void 0,a)),n}};var bC=oe(gC());function I_e(e){var t;return e===0?t=1:t=Math.floor(new bC.default(e).abs().log(10).toNumber())+1,t}function C_e(e,t,r){for(var n=new bC.default(e),i=0,a=[];n.lt(t)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}var T_e=Dy(function(e,t,r){var n=+e,i=+t;return n+r*(i-n)}),N_e=Dy(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),L_e=Dy(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))}),My={rangeStep:C_e,getDigitCount:I_e,interpolateNumber:T_e,uninterpolateNumber:N_e,uninterpolateTruncation:L_e};function _C(e){return D_e(e)||F_e(e)||a7(e)||P_e()}function P_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F_e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function D_e(e){if(Array.isArray(e))return wC(e)}function xu(e,t){return M_e(e)||R_e(e,t)||a7(e,t)||B_e()}function B_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a7(e,t){if(e){if(typeof e=="string")return wC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wC(e,t)}}function wC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R_e(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return r}}function M_e(e){if(Array.isArray(e))return e}function SC(e){var t=xu(e,2),r=t[0],n=t[1],i=r,a=n;return r>n&&(i=n,a=r),[i,a]}function xC(e,t,r){if(e.lte(0))return new nr.default(0);var n=My.getDigitCount(e.toNumber()),i=new nr.default(10).pow(n),a=e.div(i),o=n!==1?.05:.1,s=new nr.default(Math.ceil(a.div(o).toNumber())).add(r).mul(o),l=s.mul(i);return t?l:new nr.default(Math.ceil(l))}function o7(e,t,r){var n=1,i=new nr.default(e);if(!i.isint()&&r){var a=Math.abs(e);a<1?(n=new nr.default(10).pow(My.getDigitCount(e)-1),i=new nr.default(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new nr.default(Math.floor(e)))}else e===0?i=new nr.default(Math.floor((t-1)/2)):r||(i=new nr.default(Math.floor(e)));var o=Math.floor((t-1)/2),s=vC(mC(function(l){return i.add(new nr.default(l-o).mul(n)).toNumber()}),By);return s(0,t)}function s7(e,t,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new nr.default(0),tickMin:new nr.default(0),tickMax:new nr.default(0)};var a=xC(new nr.default(t).sub(e).div(r-1),n,i),o;e<=0&&t>=0?o=new nr.default(0):(o=new nr.default(e).add(t).div(2),o=o.sub(new nr.default(o).mod(a)));var s=Math.ceil(o.sub(e).div(a).toNumber()),l=Math.ceil(new nr.default(t).sub(o).div(a).toNumber()),c=s+l+1;return c>r?s7(e,t,r,n,i+1):(c<r&&(l=t>0?l+(r-c):l,s=t>0?s:s+(r-c)),{step:a,tickMin:o.sub(new nr.default(s).mul(a)),tickMax:o.add(new nr.default(l).mul(a))})}function j_e(e){var t=xu(e,2),r=t[0],n=t[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),s=SC([r,n]),l=xu(s,2),c=l[0],f=l[1];if(c===-1/0||f===1/0){var u=f===1/0?[c].concat(_C(By(0,i-1).map(function(){return 1/0}))):[].concat(_C(By(0,i-1).map(function(){return-1/0})),[f]);return r>n?Ry(u):u}if(c===f)return o7(c,i,a);var h=s7(c,f,o,a),g=h.step,_=h.tickMin,w=h.tickMax,E=My.rangeStep(_,w.add(new nr.default(.1).mul(g)),g);return r>n?Ry(E):E}function $_e(e){var t=xu(e,2),r=t[0],n=t[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),s=SC([r,n]),l=xu(s,2),c=l[0],f=l[1];if(c===-1/0||f===1/0)return[r,n];if(c===f)return o7(c,i,a);var u=xC(new nr.default(f).sub(c).div(o-1),a,0),h=vC(mC(function(_){return new nr.default(c).add(new nr.default(_).mul(u)).toNumber()}),By),g=h(0,o).filter(function(_){return _>=c&&_<=f});return r>n?Ry(g):g}function U_e(e,t){var r=xu(e,2),n=r[0],i=r[1],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=SC([n,i]),s=xu(o,2),l=s[0],c=s[1];if(l===-1/0||c===1/0)return[n,i];if(l===c)return[l];var f=Math.max(t,2),u=xC(new nr.default(c).sub(l).div(f-1),a,0),h=[].concat(_C(My.rangeStep(new nr.default(l),new nr.default(c).sub(new nr.default(.99).mul(u)),u)),[c]);return n>i?Ry(h):h}var kC=M2(j_e),z_e=M2($_e),EC=M2(U_e);var j2=oe(He());var q_e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function $2(){return $2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$2.apply(this,arguments)}function V_e(e,t){return G_e(e)||J_e(e,t)||W_e(e,t)||H_e()}function H_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W_e(e,t){if(e){if(typeof e=="string")return l7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l7(e,t)}}function l7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J_e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}function G_e(e){if(Array.isArray(e))return e}function Y_e(e,t){if(e==null)return{};var r=K_e(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function K_e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function ql(e){var t=e.offset,r=e.layout,n=e.width,i=e.dataKey,a=e.data,o=e.dataPointFormatter,s=e.xAxis,l=e.yAxis,c=Y_e(e,q_e),f=ht(c),u=a.map(function(h,g){var _=o(h,i),w=_.x,E=_.y,S=_.value,A=_.errorVal;if(!A)return null;var O=[],C,T;if(Array.isArray(A)){var D=V_e(A,2);C=D[0],T=D[1]}else C=T=A;if(r==="vertical"){var P=s.scale,z=E+t,ne=z+n,V=z-n,X=P(S-C),Q=P(S+T);O.push({x1:Q,y1:ne,x2:Q,y2:V}),O.push({x1:X,y1:z,x2:Q,y2:z}),O.push({x1:X,y1:ne,x2:X,y2:V})}else if(r==="horizontal"){var ie=l.scale,pe=w+t,de=pe-n,F=pe+n,H=ie(S-C),Z=ie(S+T);O.push({x1:de,y1:Z,x2:F,y2:Z}),O.push({x1:pe,y1:H,x2:pe,y2:Z}),O.push({x1:de,y1:H,x2:F,y2:H})}return j2.default.createElement(tr,$2({className:"recharts-errorBar",key:"bar-".concat(g)},f),O.map(function(j,$){return j2.default.createElement("line",$2({},j,{key:"line-".concat($)}))}))});return j2.default.createElement(tr,{className:"recharts-errorBars"},u)}ql.defaultProps={stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"};ql.displayName="ErrorBar";function $y(e){"@babel/helpers - typeof";return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$y(e)}function c7(e){return e0e(e)||Q_e(e)||Z_e(e)||X_e()}function X_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z_e(e,t){if(e){if(typeof e=="string")return OC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OC(e,t)}}function Q_e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function e0e(e){if(Array.isArray(e))return OC(e)}function OC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u7(Object(r),!0).forEach(function(n){rp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rp(e,t,r){return t=t0e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t0e(e){var t=r0e(e,"string");return $y(t)==="symbol"?t:String(t)}function r0e(e,t){if($y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vn(e,t,r){return(0,io.default)(e)||(0,io.default)(t)?r:Sr(t)?(0,AC.default)(e,t,r):(0,no.default)(t)?t(e):r}function np(e,t,r,n){var i=(0,v7.default)(e,function(s){return Vn(s,t)});if(r==="number"){var a=i.filter(function(s){return Ue(s)||parseFloat(s)});return a.length?[(0,zy.default)(a),(0,Uy.default)(a)]:[1/0,-1/0]}var o=n?i.filter(function(s){return!(0,io.default)(s)}):i;return o.map(function(s){return Sr(s)||s instanceof Date?s:""})}var b7=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=-1,s=(r=n?.length)!==null&&r!==void 0?r:0;if(s<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var l=a.range,c=0;c<s;c++){var f=c>0?i[c-1].coordinate:i[s-1].coordinate,u=i[c].coordinate,h=c>=s-1?i[0].coordinate:i[c+1].coordinate,g=void 0;if(Un(u-f)!==Un(h-u)){var _=[];if(Un(h-u)===Un(l[1]-l[0])){g=h;var w=u+l[1]-l[0];_[0]=Math.min(w,(w+f)/2),_[1]=Math.max(w,(w+f)/2)}else{g=f;var E=h+l[1]-l[0];_[0]=Math.min(u,(E+u)/2),_[1]=Math.max(u,(E+u)/2)}var S=[Math.min(u,(g+u)/2),Math.max(u,(g+u)/2)];if(t>S[0]&&t<=S[1]||t>=_[0]&&t<=_[1]){o=i[c].index;break}}else{var A=Math.min(f,h),O=Math.max(f,h);if(t>(A+u)/2&&t<=(O+u)/2){o=i[c].index;break}}}else for(var C=0;C<s;C++)if(C===0&&t<=(n[C].coordinate+n[C+1].coordinate)/2||C>0&&C<s-1&&t>(n[C].coordinate+n[C-1].coordinate)/2&&t<=(n[C].coordinate+n[C+1].coordinate)/2||C===s-1&&t>(n[C].coordinate+n[C-1].coordinate)/2){o=n[C].index;break}return o},z2=function(t){var r=t,n=r.type.displayName,i=t.props,a=i.stroke,o=i.fill,s;switch(n){case"Line":s=a;break;case"Area":case"Radar":s=a&&a!=="none"?a:o;break;default:s=o;break}return s},IC=function(t){var r=t.children,n=t.formattedGraphicalItems,i=t.legendWidth,a=t.legendContent,o=Ia(r,ru);if(!o)return null;var s;return o.props&&o.props.payload?s=o.props&&o.props.payload:a==="children"?s=(n||[]).reduce(function(l,c){var f=c.item,u=c.props,h=u.sectors||u.data||[];return l.concat(h.map(function(g){return{type:o.props.iconType||f.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):s=(n||[]).map(function(l){var c=l.item,f=c.props,u=f.dataKey,h=f.name,g=f.legendType,_=f.hide;return{inactive:_,dataKey:u,type:o.props.iconType||g||"square",color:z2(c),value:h||u,payload:c.props}}),_i(_i(_i({},o.props),ru.getWithHeight(o,i)),{},{payload:s,item:o})},_7=function(t){var r=t.barSize,n=t.stackGroups,i=n===void 0?{}:n;if(!i)return{};for(var a={},o=Object.keys(i),s=0,l=o.length;s<l;s++)for(var c=i[o[s]].stackGroups,f=Object.keys(c),u=0,h=f.length;u<h;u++){var g=c[f[u]],_=g.items,w=g.cateAxisId,E=_.filter(function(O){return Fo(O.type).indexOf("Bar")>=0});if(E&&E.length){var S=E[0].props.barSize,A=E[0].props[w];a[A]||(a[A]=[]),a[A].push({item:E[0],stackList:E.slice(1),barSize:(0,io.default)(S)?r:S})}}return a},w7=function(t){var r=t.barGap,n=t.barCategoryGap,i=t.bandSize,a=t.sizeList,o=a===void 0?[]:a,s=t.maxBarSize,l=o.length;if(l<1)return null;var c=Po(r,i,0,!0),f;if(o[0].barSize===+o[0].barSize){var u=!1,h=i/l,g=o.reduce(function(O,C){return O+C.barSize||0},0);g+=(l-1)*c,g>=i&&(g-=(l-1)*c,c=0),g>=i&&h>0&&(u=!0,h*=.9,g=l*h);var _=(i-g)/2>>0,w={offset:_-c,size:0};f=o.reduce(function(O,C){var T=[].concat(c7(O),[{item:C.item,position:{offset:w.offset+w.size+c,size:u?h:C.barSize}}]);return w=T[T.length-1].position,C.stackList&&C.stackList.length&&C.stackList.forEach(function(D){T.push({item:D,position:w})}),T},[])}else{var E=Po(n,i,0,!0);i-2*E-(l-1)*c<=0&&(c=0);var S=(i-2*E-(l-1)*c)/l;S>1&&(S>>=0);var A=s===+s?Math.min(S,s):S;f=o.reduce(function(O,C,T){var D=[].concat(c7(O),[{item:C.item,position:{offset:E+(S+c)*T+(S-A)/2,size:A}}]);return C.stackList&&C.stackList.length&&C.stackList.forEach(function(P){D.push({item:P,position:D[D.length-1].position})}),D},[])}return f},S7=function(t,r,n,i){var a=n.children,o=n.width,s=n.margin,l=o-(s.left||0)-(s.right||0),c=IC({children:a,legendWidth:l}),f=t;if(c){var u=i||{},h=c.align,g=c.verticalAlign,_=c.layout;(_==="vertical"||_==="horizontal"&&g==="middle")&&Ue(t[h])&&(f=_i(_i({},t),{},rp({},h,f[h]+(u.width||0)))),(_==="horizontal"||_==="vertical"&&h==="center")&&Ue(t[g])&&(f=_i(_i({},t),{},rp({},g,f[g]+(u.height||0))))}return f},n0e=function(t,r,n){return(0,io.default)(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},x7=function(t,r,n,i,a){var o=r.props.children,s=vn(o,ql).filter(function(c){return n0e(i,a,c.props.direction)});if(s&&s.length){var l=s.map(function(c){return c.props.dataKey});return t.reduce(function(c,f){var u=Vn(f,n,0),h=(0,jy.default)(u)?[(0,zy.default)(u),(0,Uy.default)(u)]:[u,u],g=l.reduce(function(_,w){var E=Vn(f,w,0),S=h[0]-Math.abs((0,jy.default)(E)?E[0]:E),A=h[1]+Math.abs((0,jy.default)(E)?E[1]:E);return[Math.min(S,_[0]),Math.max(A,_[1])]},[1/0,-1/0]);return[Math.min(g[0],c[0]),Math.max(g[1],c[1])]},[1/0,-1/0])}return null},k7=function(t,r,n,i,a){var o=r.map(function(s){return x7(t,s,n,a,i)}).filter(function(s){return!(0,io.default)(s)});return o&&o.length?o.reduce(function(s,l){return[Math.min(s[0],l[0]),Math.max(s[1],l[1])]},[1/0,-1/0]):null},CC=function(t,r,n,i,a){var o=r.map(function(l){var c=l.props.dataKey;return n==="number"&&c&&x7(t,l,c,i)||np(t,c,n,a)});if(n==="number")return o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]);var s={};return o.reduce(function(l,c){for(var f=0,u=c.length;f<u;f++)s[c[f]]||(s[c[f]]=!0,l.push(c[f]));return l},[])},TC=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},NC=function(t,r,n){var i,a,o=t.map(function(s){return s.coordinate===r&&(i=!0),s.coordinate===n&&(a=!0),s.coordinate});return i||o.push(r),a||o.push(n),o},$s=function(t,r,n){if(!t)return null;var i=t.scale,a=t.duplicateDomain,o=t.type,s=t.range,l=t.realScaleType==="scaleBand"?i.bandwidth()/2:2,c=(r||n)&&o==="category"&&i.bandwidth?i.bandwidth()/l:0;if(c=t.axisType==="angleAxis"&&s?.length>=2?Un(s[0]-s[1])*2*c:c,r&&(t.ticks||t.niceTicks)){var f=(t.ticks||t.niceTicks).map(function(u){var h=a?a.indexOf(u):u;return{coordinate:i(h)+c,value:u,offset:c}});return f.filter(function(u){return!(0,U2.default)(u.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(u,h){return{coordinate:i(u)+c,value:u,index:h,offset:c}}):i.ticks&&!n?i.ticks(t.tickCount).map(function(u){return{coordinate:i(u)+c,value:u,offset:c}}):i.domain().map(function(u,h){return{coordinate:i(u)+c,value:a?a[u]:u,index:h,offset:c}})},qy=function(t,r,n){var i;return(0,no.default)(n)?i=n:(0,no.default)(r)&&(i=r),(0,no.default)(t)||i?function(a,o,s,l){(0,no.default)(t)&&t(a,o,s,l),(0,no.default)(i)&&i(a,o,s,l)}:null},E7=function(t,r,n){var i=t.scale,a=t.type,o=t.layout,s=t.axisType;if(i==="auto")return o==="radial"&&s==="radiusAxis"?{scale:Bl(),realScaleType:"band"}:o==="radial"&&s==="angleAxis"?{scale:mu(),realScaleType:"linear"}:a==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Rl(),realScaleType:"point"}:a==="category"?{scale:Bl(),realScaleType:"band"}:{scale:mu(),realScaleType:"linear"};if((0,m7.default)(i)){var l="scale".concat((0,y7.default)(i));return{scale:(B2[l]||Rl)(),realScaleType:B2[l]?l:"point"}}return(0,no.default)(i)?{scale:i}:{scale:Rl(),realScaleType:"point"}},f7=1e-4,O7=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,i=t.range(),a=Math.min(i[0],i[1])-f7,o=Math.max(i[0],i[1])+f7,s=t(r[0]),l=t(r[n-1]);(s<a||s>o||l<a||l>o)&&t.domain([r[0],r[n-1]])}},A7=function(t,r){if(!t)return null;for(var n=0,i=t.length;n<i;n++)if(t[n].item===r)return t[n].position;return null},I7=function(t,r){if(!r||r.length!==2||!Ue(r[0])||!Ue(r[1]))return t;var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]),a=[t[0],t[1]];return(!Ue(t[0])||t[0]<n)&&(a[0]=n),(!Ue(t[1])||t[1]>i)&&(a[1]=i),a[0]>i&&(a[0]=i),a[1]<n&&(a[1]=n),a},i0e=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var a=0,o=0,s=0;s<r;++s){var l=(0,U2.default)(t[s][n][1])?t[s][n][0]:t[s][n][1];l>=0?(t[s][n][0]=a,t[s][n][1]=a+l,a=t[s][n][1]):(t[s][n][0]=o,t[s][n][1]=o+l,o=t[s][n][1])}},a0e=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var a=0,o=0;o<r;++o){var s=(0,U2.default)(t[o][n][1])?t[o][n][0]:t[o][n][1];s>=0?(t[o][n][0]=a,t[o][n][1]=a+s,a=t[o][n][1]):(t[o][n][0]=0,t[o][n][1]=0)}},o0e={sign:i0e,expand:fA,none:Na,silhouette:dA,wiggle:pA,positive:a0e},s0e=function(t,r,n){var i=r.map(function(o){return o.props.dataKey}),a=uA().keys(i).value(function(o,s){return+Vn(o,s,0)}).order(wd).offset(o0e[n]);return a(t)},C7=function(t,r,n,i,a,o){if(!t)return null;var s=o?r.reverse():r,l=s.reduce(function(c,f){var u=f.props,h=u.stackId,g=u.hide;if(g)return c;var _=f.props[n],w=c[_]||{hasStack:!1,stackGroups:{}};if(Sr(h)){var E=w.stackGroups[h]||{numericAxisId:n,cateAxisId:i,items:[]};E.items.push(f),w.hasStack=!0,w.stackGroups[h]=E}else w.stackGroups[Lo("_stackId_")]={numericAxisId:n,cateAxisId:i,items:[f]};return _i(_i({},c),{},rp({},_,w))},{});return Object.keys(l).reduce(function(c,f){var u=l[f];return u.hasStack&&(u.stackGroups=Object.keys(u.stackGroups).reduce(function(h,g){var _=u.stackGroups[g];return _i(_i({},h),{},rp({},g,{numericAxisId:n,cateAxisId:i,items:_.items,stackedData:s0e(t,_.items,a)}))},{})),_i(_i({},c),{},rp({},f,u))},{})},T7=function(t,r){var n=r.realScaleType,i=r.type,a=r.tickCount,o=r.originalDomain,s=r.allowDecimals,l=n||r.scale;if(l!=="auto"&&l!=="linear")return null;if(a&&i==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var c=t.domain();if(!c.length)return null;var f=kC(c,a,s);return t.domain([(0,zy.default)(f),(0,Uy.default)(f)]),{niceTicks:f}}if(a&&i==="number"){var u=t.domain(),h=EC(u,a,s);return{niceTicks:h}}return null},LC=function(t){var r=t.axis,n=t.ticks,i=t.bandSize,a=t.entry,o=t.index,s=t.dataKey;if(r.type==="category"){if(!r.allowDuplicatedCategory&&r.dataKey&&!(0,io.default)(a[r.dataKey])){var l=od(n,"value",a[r.dataKey]);if(l)return l.coordinate+i/2}return n[o]?n[o].coordinate+i/2:null}var c=Vn(a,(0,io.default)(s)?r.dataKey:s);return(0,io.default)(c)?null:r.scale(c)},PC=function(t){var r=t.axis,n=t.ticks,i=t.offset,a=t.bandSize,o=t.entry,s=t.index;if(r.type==="category")return n[s]?n[s].coordinate+i:null;var l=Vn(o,r.dataKey,r.domain[s]);return(0,io.default)(l)?null:r.scale(l)-a/2+i},N7=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var i=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return i<=0&&a>=0?0:a<0?a:i}return n[0]},L7=function(t,r){var n=t.props.stackId;if(Sr(n)){var i=r[n];if(i&&i.items.length){for(var a=-1,o=0,s=i.items.length;o<s;o++)if(i.items[o]===t){a=o;break}return a>=0?i.stackedData[a]:null}}return null},l0e=function(t){return t.reduce(function(r,n){return[(0,zy.default)(n.concat([r[0]]).filter(Ue)),(0,Uy.default)(n.concat([r[1]]).filter(Ue))]},[1/0,-1/0])},FC=function(t,r,n){return Object.keys(t).reduce(function(i,a){var o=t[a],s=o.stackedData,l=s.reduce(function(c,f){var u=l0e(f.slice(r,n+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(l[0],i[0]),Math.max(l[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},d7=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,p7=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,q2=function(t,r,n){if((0,no.default)(t))return t(r,n);if(!(0,jy.default)(t))return r;var i=[];if(Ue(t[0]))i[0]=n?t[0]:Math.min(t[0],r[0]);else if(d7.test(t[0])){var a=+d7.exec(t[0])[1];i[0]=r[0]-a}else(0,no.default)(t[0])?i[0]=t[0](r[0]):i[0]=r[0];if(Ue(t[1]))i[1]=n?t[1]:Math.max(t[1],r[1]);else if(p7.test(t[1])){var o=+p7.exec(t[1])[1];i[1]=r[1]+o}else(0,no.default)(t[1])?i[1]=t[1](r[1]):i[1]=r[1];return i},ip=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var i=t.scale.bandwidth();if(!n||i>0)return i}if(t&&r&&r.length>=2){for(var a=(0,g7.default)(r,function(u){return u.coordinate}),o=1/0,s=1,l=a.length;s<l;s++){var c=a[s],f=a[s-1];o=Math.min((c.coordinate||0)-(f.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},DC=function(t,r,n){return!t||!t.length||(0,h7.default)(t,(0,AC.default)(n,"type.defaultProps.domain"))?r:t},V2=function(t,r){var n=t.props,i=n.dataKey,a=n.name,o=n.unit,s=n.formatter,l=n.tooltipType,c=n.chartType;return _i(_i({},ht(t)),{},{dataKey:i,unit:o,formatter:s,name:a||i,color:z2(t),value:Vn(r,i),type:l,payload:r,chartType:c})};function Vy(e){"@babel/helpers - typeof";return Vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vy(e)}function P7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function F7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P7(Object(r),!0).forEach(function(n){u0e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u0e(e,t,r){return t=f0e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f0e(e){var t=d0e(e,"string");return Vy(t)==="symbol"?t:String(t)}function d0e(e,t){if(Vy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hy=Math.PI/180;var p0e=function(t){return t*180/Math.PI},hn=function(t,r,n,i){return{x:t+Math.cos(-Hy*i)*n,y:r+Math.sin(-Hy*i)*n}};var h0e=function(t,r){var n=t.x,i=t.y,a=r.x,o=r.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(i-o,2))},g0e=function(t,r){var n=t.x,i=t.y,a=r.cx,o=r.cy,s=h0e({x:n,y:i},{x:a,y:o});if(s<=0)return{radius:s};var l=(n-a)/s,c=Math.acos(l);return i>o&&(c=2*Math.PI-c),{radius:s,angle:p0e(c),angleInRadian:c}},y0e=function(t){var r=t.startAngle,n=t.endAngle,i=Math.floor(r/360),a=Math.floor(n/360),o=Math.min(i,a);return{startAngle:r-o*360,endAngle:n-o*360}},m0e=function(t,r){var n=r.startAngle,i=r.endAngle,a=Math.floor(n/360),o=Math.floor(i/360),s=Math.min(a,o);return t+s*360},BC=function(t,r){var n=t.x,i=t.y,a=g0e({x:n,y:i},r),o=a.radius,s=a.angle,l=r.innerRadius,c=r.outerRadius;if(o<l||o>c)return!1;if(o===0)return!0;var f=y0e(r),u=f.startAngle,h=f.endAngle,g=s,_;if(u<=h){for(;g>h;)g-=360;for(;g<u;)g+=360;_=g>=u&&g<=h}else{for(;g>u;)g-=360;for(;g<h;)g+=360;_=g>=h&&g<=u}return _?F7(F7({},r),{},{radius:o,angle:m0e(g,r)}):null};function Wy(e){"@babel/helpers - typeof";return Wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wy(e)}function v0e(e){return S0e(e)||w0e(e)||_0e(e)||b0e()}function b0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _0e(e,t){if(e){if(typeof e=="string")return RC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RC(e,t)}}function w0e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function S0e(e){if(Array.isArray(e))return RC(e)}function RC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Cn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D7(Object(r),!0).forEach(function(n){x0e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x0e(e,t,r){return t=k0e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k0e(e){var t=E0e(e,"string");return Wy(t)==="symbol"?t:String(t)}function E0e(e,t){if(Wy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yy(){return Yy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yy.apply(this,arguments)}var O0e=function(t){var r=t.value,n=t.formatter,i=(0,Gy.default)(t.children)?r:t.children;return(0,Jy.default)(n)?n(i):i},A0e=function(t,r){var n=Un(r-t),i=Math.min(Math.abs(r-t),360);return n*i},I0e=function(t,r,n){var i=t.position,a=t.viewBox,o=t.offset,s=t.className,l=a,c=l.cx,f=l.cy,u=l.innerRadius,h=l.outerRadius,g=l.startAngle,_=l.endAngle,w=l.clockWise,E=(u+h)/2,S=A0e(g,_),A=S>=0?1:-1,O,C;i==="insideStart"?(O=g+A*o,C=w):i==="insideEnd"?(O=_-A*o,C=!w):i==="end"&&(O=_+A*o,C=w),C=S<=0?C:!C;var T=hn(c,f,E,O),D=hn(c,f,E,O+(C?1:-1)*359),P="M".concat(T.x,",").concat(T.y,`
    A`).concat(E,",").concat(E,",0,1,").concat(C?0:1,`,
    `).concat(D.x,",").concat(D.y),z=(0,Gy.default)(t.id)?Lo("recharts-radial-line-"):t.id;return Yr.default.createElement("text",Yy({},n,{dominantBaseline:"central",className:(0,jC.default)("recharts-radial-bar-label",s)}),Yr.default.createElement("defs",null,Yr.default.createElement("path",{id:z,d:P})),Yr.default.createElement("textPath",{xlinkHref:"#".concat(z)},r))},C0e=function(t){var r=t.viewBox,n=t.offset,i=t.position,a=r,o=a.cx,s=a.cy,l=a.innerRadius,c=a.outerRadius,f=a.startAngle,u=a.endAngle,h=(f+u)/2;if(i==="outside"){var g=hn(o,s,c+n,h),_=g.x,w=g.y;return{x:_,y:w,textAnchor:_>=o?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"end"};var E=(l+c)/2,S=hn(o,s,E,h),A=S.x,O=S.y;return{x:A,y:O,textAnchor:"middle",verticalAnchor:"middle"}},T0e=function(t){var r=t.viewBox,n=t.parentViewBox,i=t.offset,a=t.position,o=r,s=o.x,l=o.y,c=o.width,f=o.height,u=f>=0?1:-1,h=u*i,g=u>0?"end":"start",_=u>0?"start":"end",w=c>=0?1:-1,E=w*i,S=w>0?"end":"start",A=w>0?"start":"end";if(a==="top"){var O={x:s+c/2,y:l-u*i,textAnchor:"middle",verticalAnchor:g};return Cn(Cn({},O),n?{height:Math.max(l-n.y,0),width:c}:{})}if(a==="bottom"){var C={x:s+c/2,y:l+f+h,textAnchor:"middle",verticalAnchor:_};return Cn(Cn({},C),n?{height:Math.max(n.y+n.height-(l+f),0),width:c}:{})}if(a==="left"){var T={x:s-E,y:l+f/2,textAnchor:S,verticalAnchor:"middle"};return Cn(Cn({},T),n?{width:Math.max(T.x-n.x,0),height:f}:{})}if(a==="right"){var D={x:s+c+E,y:l+f/2,textAnchor:A,verticalAnchor:"middle"};return Cn(Cn({},D),n?{width:Math.max(n.x+n.width-D.x,0),height:f}:{})}var P=n?{width:c,height:f}:{};return a==="insideLeft"?Cn({x:s+E,y:l+f/2,textAnchor:A,verticalAnchor:"middle"},P):a==="insideRight"?Cn({x:s+c-E,y:l+f/2,textAnchor:S,verticalAnchor:"middle"},P):a==="insideTop"?Cn({x:s+c/2,y:l+h,textAnchor:"middle",verticalAnchor:_},P):a==="insideBottom"?Cn({x:s+c/2,y:l+f-h,textAnchor:"middle",verticalAnchor:g},P):a==="insideTopLeft"?Cn({x:s+E,y:l+h,textAnchor:A,verticalAnchor:_},P):a==="insideTopRight"?Cn({x:s+c-E,y:l+h,textAnchor:S,verticalAnchor:_},P):a==="insideBottomLeft"?Cn({x:s+E,y:l+f-h,textAnchor:A,verticalAnchor:g},P):a==="insideBottomRight"?Cn({x:s+c-E,y:l+f-h,textAnchor:S,verticalAnchor:g},P):(0,MC.default)(a)&&(Ue(a.x)||As(a.x))&&(Ue(a.y)||As(a.y))?Cn({x:s+Po(a.x,c),y:l+Po(a.y,f),textAnchor:"end",verticalAnchor:"end"},P):Cn({x:s+c/2,y:l+f/2,textAnchor:"middle",verticalAnchor:"middle"},P)},N0e=function(t){return"cx"in t&&Ue(t.cx)};function Gr(e){var t=e.viewBox,r=e.position,n=e.value,i=e.children,a=e.content,o=e.className,s=o===void 0?"":o,l=e.textBreakAll;if(!t||(0,Gy.default)(n)&&(0,Gy.default)(i)&&!(0,Yr.isValidElement)(a)&&!(0,Jy.default)(a))return null;if((0,Yr.isValidElement)(a))return(0,Yr.cloneElement)(a,e);var c;if((0,Jy.default)(a)){if(c=(0,Yr.createElement)(a,e),(0,Yr.isValidElement)(c))return c}else c=O0e(e);var f=N0e(t),u=ht(e,!0);if(f&&(r==="insideStart"||r==="insideEnd"||r==="end"))return I0e(e,c,u);var h=f?C0e(e):T0e(e);return Yr.default.createElement(Dl,Yy({className:(0,jC.default)("recharts-label",s)},u,h,{breakAll:l}),c)}Gr.displayName="Label";Gr.defaultProps={offset:5};var B7=function(t){var r=t.cx,n=t.cy,i=t.angle,a=t.startAngle,o=t.endAngle,s=t.r,l=t.radius,c=t.innerRadius,f=t.outerRadius,u=t.x,h=t.y,g=t.top,_=t.left,w=t.width,E=t.height,S=t.clockWise,A=t.labelViewBox;if(A)return A;if(Ue(w)&&Ue(E)){if(Ue(u)&&Ue(h))return{x:u,y:h,width:w,height:E};if(Ue(g)&&Ue(_))return{x:g,y:_,width:w,height:E}}return Ue(u)&&Ue(h)?{x:u,y:h,width:0,height:0}:Ue(r)&&Ue(n)?{cx:r,cy:n,startAngle:a||i||0,endAngle:o||i||0,innerRadius:c||0,outerRadius:f||l||s||0,clockWise:S}:t.viewBox?t.viewBox:{}},L0e=function(t,r){return t?t===!0?Yr.default.createElement(Gr,{key:"label-implicit",viewBox:r}):Sr(t)?Yr.default.createElement(Gr,{key:"label-implicit",viewBox:r,value:t}):(0,Yr.isValidElement)(t)?t.type===Gr?(0,Yr.cloneElement)(t,{key:"label-implicit",viewBox:r}):Yr.default.createElement(Gr,{key:"label-implicit",content:t,viewBox:r}):(0,Jy.default)(t)?Yr.default.createElement(Gr,{key:"label-implicit",content:t,viewBox:r}):(0,MC.default)(t)?Yr.default.createElement(Gr,Yy({viewBox:r},t,{key:"label-implicit"})):null:null},P0e=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var i=t.children,a=B7(t),o=vn(i,Gr).map(function(l,c){return(0,Yr.cloneElement)(l,{viewBox:r||a,key:"label-".concat(c)})});if(!n)return o;var s=L0e(t.label,r||a);return[s].concat(v0e(o))};Gr.parseViewBox=B7;Gr.renderCallByParent=P0e;var U7=oe(Oa()),z7=oe(fn()),H2=oe(Aa()),q7=oe(M7()),V7=oe(Vr()),Us=oe(He());function Ky(e){"@babel/helpers - typeof";return Ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ky(e)}var D0e=["data","valueAccessor","dataKey","clockWise","id","textBreakAll"];function B0e(e){return $0e(e)||j0e(e)||M0e(e)||R0e()}function R0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M0e(e,t){if(e){if(typeof e=="string")return $C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $C(e,t)}}function j0e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $0e(e){if(Array.isArray(e))return $C(e)}function $C(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function W2(){return W2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},W2.apply(this,arguments)}function j7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j7(Object(r),!0).forEach(function(n){U0e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U0e(e,t,r){return t=z0e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z0e(e){var t=q0e(e,"string");return Ky(t)==="symbol"?t:String(t)}function q0e(e,t){if(Ky(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ky(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V0e(e,t){if(e==null)return{};var r=H0e(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function H0e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}var W0e={valueAccessor:function(t){return(0,V7.default)(t.value)?(0,q7.default)(t.value):t.value}};function ao(e){var t=e.data,r=e.valueAccessor,n=e.dataKey,i=e.clockWise,a=e.id,o=e.textBreakAll,s=V0e(e,D0e);return!t||!t.length?null:Us.default.createElement(tr,{className:"recharts-label-list"},t.map(function(l,c){var f=(0,H2.default)(n)?r(l,c):Vn(l&&l.payload,n),u=(0,H2.default)(a)?{}:{id:"".concat(a,"-").concat(c)};return Us.default.createElement(Gr,W2({},ht(l,!0),s,u,{parentViewBox:l.parentViewBox,index:c,value:f,textBreakAll:o,viewBox:Gr.parseViewBox((0,H2.default)(i)?l:$7($7({},l),{},{clockWise:i})),key:"label-".concat(c)}))}))}ao.displayName="LabelList";function J0e(e,t){return e?e===!0?Us.default.createElement(ao,{key:"labelList-implicit",data:t}):Us.default.isValidElement(e)||(0,z7.default)(e)?Us.default.createElement(ao,{key:"labelList-implicit",data:t,content:e}):(0,U7.default)(e)?Us.default.createElement(ao,W2({data:t},e,{key:"labelList-implicit"})):null:null}function G0e(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,i=vn(n,ao).map(function(o,s){return(0,Us.cloneElement)(o,{data:t,key:"labelList-".concat(s)})});if(!r)return i;var a=J0e(e.label,t);return[a].concat(B0e(i))}ao.renderCallByParent=G0e;ao.defaultProps=W0e;var Y2=oe(He()),J7=oe(qr());function ap(e){"@babel/helpers - typeof";return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function UC(){return UC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UC.apply(this,arguments)}function Y0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W7(n.key),n)}}function K0e(e,t,r){return t&&H7(e.prototype,t),r&&H7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zC(e,t)}function zC(e,t){return zC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zC(e,t)}function Z0e(e){var t=t2e();return function(){var n=G2(e),i;if(t){var a=G2(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Q0e(this,i)}}function Q0e(e,t){if(t&&(ap(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e2e(e)}function e2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function G2(e){return G2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},G2(e)}function r2e(e,t,r){return t=W7(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W7(e){var t=n2e(e,"string");return ap(t)==="symbol"?t:String(t)}function n2e(e,t){if(ap(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ap(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i2e=function(t,r){var n=Un(r-t),i=Math.min(Math.abs(r-t),359.999);return n*i},J2=function(t){var r=t.cx,n=t.cy,i=t.radius,a=t.angle,o=t.sign,s=t.isExternal,l=t.cornerRadius,c=t.cornerIsExternal,f=l*(s?1:-1)+i,u=Math.asin(l/f)/Hy,h=c?a:a+o*u,g=hn(r,n,f,h),_=hn(r,n,i,h),w=c?a-o*u:a,E=hn(r,n,f*Math.cos(u*Hy),w);return{center:g,circleTangency:_,lineTangency:E,theta:u}},G7=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,a=t.outerRadius,o=t.startAngle,s=t.endAngle,l=i2e(o,s),c=o+l,f=hn(r,n,a,o),u=hn(r,n,a,c),h="M ".concat(f.x,",").concat(f.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(o>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(i>0){var g=hn(r,n,i,o),_=hn(r,n,i,c);h+="L ".concat(_.x,",").concat(_.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(o<=c),`,
            `).concat(g.x,",").concat(g.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},a2e=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,a=t.outerRadius,o=t.cornerRadius,s=t.forceCornerRadius,l=t.cornerIsExternal,c=t.startAngle,f=t.endAngle,u=Un(f-c),h=J2({cx:r,cy:n,radius:a,angle:c,sign:u,cornerRadius:o,cornerIsExternal:l}),g=h.circleTangency,_=h.lineTangency,w=h.theta,E=J2({cx:r,cy:n,radius:a,angle:f,sign:-u,cornerRadius:o,cornerIsExternal:l}),S=E.circleTangency,A=E.lineTangency,O=E.theta,C=l?Math.abs(c-f):Math.abs(c-f)-w-O;if(C<0)return s?"M ".concat(_.x,",").concat(_.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):G7({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:c,endAngle:f});var T="M ".concat(_.x,",").concat(_.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(g.x,",").concat(g.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(C>180),",").concat(+(u<0),",").concat(S.x,",").concat(S.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(A.x,",").concat(A.y,`
  `);if(i>0){var D=J2({cx:r,cy:n,radius:i,angle:c,sign:u,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),P=D.circleTangency,z=D.lineTangency,ne=D.theta,V=J2({cx:r,cy:n,radius:i,angle:f,sign:-u,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),X=V.circleTangency,Q=V.lineTangency,ie=V.theta,pe=l?Math.abs(c-f):Math.abs(c-f)-ne-ie;if(pe<0&&o===0)return"".concat(T,"L").concat(r,",").concat(n,"Z");T+="L".concat(Q.x,",").concat(Q.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(X.x,",").concat(X.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(pe>180),",").concat(+(u>0),",").concat(P.x,",").concat(P.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(z.x,",").concat(z.y,"Z")}else T+="L".concat(r,",").concat(n,"Z");return T},qC=function(e){X0e(r,e);var t=Z0e(r);function r(){return Y0e(this,r),t.apply(this,arguments)}return K0e(r,[{key:"render",value:function(){var i=this.props,a=i.cx,o=i.cy,s=i.innerRadius,l=i.outerRadius,c=i.cornerRadius,f=i.forceCornerRadius,u=i.cornerIsExternal,h=i.startAngle,g=i.endAngle,_=i.className;if(l<s||h===g)return null;var w=(0,J7.default)("recharts-sector",_),E=l-s,S=Po(c,E,0,!0),A;return S>0&&Math.abs(h-g)<360?A=a2e({cx:a,cy:o,innerRadius:s,outerRadius:l,cornerRadius:Math.min(S,E/2),forceCornerRadius:f,cornerIsExternal:u,startAngle:h,endAngle:g}):A=G7({cx:a,cy:o,innerRadius:s,outerRadius:l,startAngle:h,endAngle:g}),Y2.default.createElement("path",UC({},ht(this.props,!0),{className:w,d:A,role:"img"}))}}]),r}(Y2.PureComponent);r2e(qC,"defaultProps",{cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1});var Z7=oe(Vr()),Q7=oe(d0()),eV=oe(fn()),tV=oe(He());var rV=oe(qr());function Qy(e){"@babel/helpers - typeof";return Qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qy(e)}function VC(){return VC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VC.apply(this,arguments)}function Y7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function K7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y7(Object(r),!0).forEach(function(n){o2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o2e(e,t,r){return t=s2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s2e(e){var t=l2e(e,"string");return Qy(t)==="symbol"?t:String(t)}function l2e(e,t){if(Qy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var X7={curveBasisClosed:eA,curveBasisOpen:tA,curveBasis:QO,curveLinearClosed:rA,curveLinear:Tl,curveMonotoneX:iA,curveMonotoneY:aA,curveNatural:oA,curveStep:sA,curveStepAfter:cA,curveStepBefore:lA},K2=function(t){return t.x===+t.x&&t.y===+t.y},Xy=function(t){return t.x},Zy=function(t){return t.y},c2e=function(t,r){if((0,eV.default)(t))return t;var n="curve".concat((0,Q7.default)(t));return n==="curveMonotone"&&r?X7["".concat(n).concat(r==="vertical"?"Y":"X")]:X7[n]||Tl},u2e=function(t){var r=t.type,n=t.points,i=t.baseLine,a=t.layout,o=t.connectNulls,s=c2e(r,a),l=o?n.filter(function(h){return K2(h)}):n,c;if((0,Z7.default)(i)){var f=o?i.filter(function(h){return K2(h)}):i,u=l.map(function(h,g){return K7(K7({},h),{},{base:f[g]})});return a==="vertical"?c=md().y(Zy).x1(Xy).x0(function(h){return h.base.x}):c=md().x(Xy).y1(Zy).y0(function(h){return h.base.y}),c.defined(K2).curve(s),c(u)}return a==="vertical"&&Ue(i)?c=md().y(Zy).x1(Xy).x0(i):Ue(i)?c=md().x(Xy).y1(Zy).y0(i):c=Yg().x(Xy).y(Zy),c.defined(K2).curve(s),c(l)},op=function(t){var r=t.className,n=t.points,i=t.path,a=t.pathRef;if((!n||!n.length)&&!i)return null;var o=n&&n.length?u2e(t):i;return tV.default.createElement("path",VC({},ht(t),Gc(t),{className:(0,rV.default)("recharts-curve",r),d:o,ref:a}))};op.defaultProps={type:"linear",points:[],connectNulls:!1};var ku=oe(He()),lV=oe(qr());function sp(e){"@babel/helpers - typeof";return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sp(e)}function X2(){return X2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},X2.apply(this,arguments)}function f2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sV(n.key),n)}}function d2e(e,t,r){return t&&nV(e.prototype,t),r&&nV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HC(e,t)}function HC(e,t){return HC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},HC(e,t)}function h2e(e){var t=y2e();return function(){var n=Z2(e),i;if(t){var a=Z2(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return g2e(this,i)}}function g2e(e,t){if(t&&(sp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aV(e)}function aV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Z2(e){return Z2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Z2(e)}function oV(e,t,r){return t=sV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sV(e){var t=m2e(e,"string");return sp(t)==="symbol"?t:String(t)}function m2e(e,t){if(sp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iV=function(t,r,n,i,a){var o=Math.min(Math.abs(n)/2,Math.abs(i)/2),s=i>=0?1:-1,l=n>=0?1:-1,c=i>=0&&n>=0||i<0&&n<0?1:0,f;if(o>0&&a instanceof Array){for(var u=[0,0,0,0],h=0,g=4;h<g;h++)u[h]=a[h]>o?o:a[h];f="M".concat(t,",").concat(r+s*u[0]),u[0]>0&&(f+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(t+l*u[0],",").concat(r)),f+="L ".concat(t+n-l*u[1],",").concat(r),u[1]>0&&(f+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(t+n,",").concat(r+s*u[1])),f+="L ".concat(t+n,",").concat(r+i-s*u[2]),u[2]>0&&(f+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(t+n-l*u[2],",").concat(r+i)),f+="L ".concat(t+l*u[3],",").concat(r+i),u[3]>0&&(f+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(t,",").concat(r+i-s*u[3])),f+="Z"}else if(o>0&&a===+a&&a>0){var _=Math.min(o,a);f="M ".concat(t,",").concat(r+s*_,`
            A `).concat(_,",").concat(_,",0,0,").concat(c,",").concat(t+l*_,",").concat(r,`
            L `).concat(t+n-l*_,",").concat(r,`
            A `).concat(_,",").concat(_,",0,0,").concat(c,",").concat(t+n,",").concat(r+s*_,`
            L `).concat(t+n,",").concat(r+i-s*_,`
            A `).concat(_,",").concat(_,",0,0,").concat(c,",").concat(t+n-l*_,",").concat(r+i,`
            L `).concat(t+l*_,",").concat(r+i,`
            A `).concat(_,",").concat(_,",0,0,").concat(c,",").concat(t,",").concat(r+i-s*_," Z")}else f="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(i," h ").concat(-n," Z");return f},cV=function(t,r){if(!t||!r)return!1;var n=t.x,i=t.y,a=r.x,o=r.y,s=r.width,l=r.height;if(Math.abs(s)>0&&Math.abs(l)>0){var c=Math.min(a,a+s),f=Math.max(a,a+s),u=Math.min(o,o+l),h=Math.max(o,o+l);return n>=c&&n<=f&&i>=u&&i<=h}return!1},Eu=function(e){p2e(r,e);var t=h2e(r);function r(){var n;f2e(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),oV(aV(n),"state",{totalLength:-1}),n}return d2e(r,[{key:"componentDidMount",value:function(){if(this.node&&this.node.getTotalLength)try{var i=this.node.getTotalLength();i&&this.setState({totalLength:i})}catch{}}},{key:"render",value:function(){var i=this,a=this.props,o=a.x,s=a.y,l=a.width,c=a.height,f=a.radius,u=a.className,h=this.state.totalLength,g=this.props,_=g.animationEasing,w=g.animationDuration,E=g.animationBegin,S=g.isAnimationActive,A=g.isUpdateAnimationActive;if(o!==+o||s!==+s||l!==+l||c!==+c||l===0||c===0)return null;var O=(0,lV.default)("recharts-rectangle",u);return A?ku.default.createElement(su,{canBegin:h>0,from:{width:l,height:c,x:o,y:s},to:{width:l,height:c,x:o,y:s},duration:w,animationEasing:_,isActive:A},function(C){var T=C.width,D=C.height,P=C.x,z=C.y;return ku.default.createElement(su,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:E,duration:w,isActive:S,easing:_},ku.default.createElement("path",X2({},ht(i.props,!0),{className:O,d:iV(P,z,T,D,f),ref:function(V){i.node=V}})))}):ku.default.createElement("path",X2({},ht(this.props,!0),{className:O,d:iV(o,s,l,c,f)}))}}]),r}(ku.PureComponent);oV(Eu,"defaultProps",{x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"});var ew=oe(He()),fV=oe(qr());function lp(e){"@babel/helpers - typeof";return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lp(e)}function WC(){return WC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WC.apply(this,arguments)}function v2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_2e(n.key),n)}}function b2e(e,t,r){return t&&uV(e.prototype,t),r&&uV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _2e(e){var t=w2e(e,"string");return lp(t)==="symbol"?t:String(t)}function w2e(e,t){if(lp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JC(e,t)}function JC(e,t){return JC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},JC(e,t)}function x2e(e){var t=O2e();return function(){var n=Q2(e),i;if(t){var a=Q2(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return k2e(this,i)}}function k2e(e,t){if(t&&(lp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E2e(e)}function E2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Q2(e){return Q2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Q2(e)}var cp=function(e){S2e(r,e);var t=x2e(r);function r(){return v2e(this,r),t.apply(this,arguments)}return b2e(r,[{key:"render",value:function(){var i=this.props,a=i.cx,o=i.cy,s=i.r,l=i.className,c=(0,fV.default)("recharts-dot",l);return a===+a&&o===+o&&s===+s?ew.default.createElement("circle",WC({},ht(this.props),Gc(this.props),{className:c,cx:a,cy:o,r:s})):null}}]),r}(ew.PureComponent);var dV=oe(He()),pV=oe(qr());function GC(){return GC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GC.apply(this,arguments)}var A2e=function(t,r,n,i,a,o){return"M".concat(t,",").concat(a,"v").concat(i,"M").concat(o,",").concat(r,"h").concat(n)},YC=function(t){var r=t.x,n=t.y,i=t.width,a=t.height,o=t.top,s=t.left,l=t.className;return!Ue(r)||!Ue(n)||!Ue(i)||!Ue(a)||!Ue(o)||!Ue(s)?null:dV.default.createElement("path",GC({},ht(t,!0),{className:(0,pV.default)("recharts-cross",l),d:A2e(r,n,i,a,o,s)}))};YC.defaultProps={x:0,y:0,top:0,left:0,width:0,height:0};var eT=oe(fn()),IV=oe(ZC()),nn=oe(He()),TV=oe(qr());function em(e){"@babel/helpers - typeof";return em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},em(e)}function wV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function SV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wV(Object(r),!0).forEach(function(n){xV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xV(e,t,r){return t=j2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j2e(e){var t=$2e(e,"string");return em(t)==="symbol"?t:String(t)}function $2e(e,t){if(em(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(em(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U2e=["Webkit","Moz","O","ms"],kV=function(t,r){if(!t)return null;var n=t.replace(/(\w)/,function(a){return a.toUpperCase()}),i=U2e.reduce(function(a,o){return SV(SV({},a),{},xV({},o+n,r))},{});return i[t]=r,i};function up(e){"@babel/helpers - typeof";return up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},up(e)}function tw(){return tw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tw.apply(this,arguments)}function EV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function QC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EV(Object(r),!0).forEach(function(n){Ba(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CV(n.key),n)}}function q2e(e,t,r){return t&&OV(e.prototype,t),r&&OV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function V2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tT(e,t)}function tT(e,t){return tT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tT(e,t)}function H2e(e){var t=J2e();return function(){var n=rw(e),i;if(t){var a=rw(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return W2e(this,i)}}function W2e(e,t){if(t&&(up(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qo(e)}function qo(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rw(e){return rw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rw(e)}function Ba(e,t,r){return t=CV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CV(e){var t=G2e(e,"string");return up(t)==="symbol"?t:String(t)}function G2e(e,t){if(up(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(up(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y2e=function(t){var r=t.data,n=t.startIndex,i=t.endIndex,a=t.x,o=t.width,s=t.travellerWidth;if(!r||!r.length)return{};var l=r.length,c=Rl().domain((0,IV.default)(0,l)).range([a,a+o-s]),f=c.domain().map(function(u){return c(u)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,startX:c(n),endX:c(i),scale:c,scaleValues:f}},AV=function(t){return t.changedTouches&&!!t.changedTouches.length},fp=function(e){V2e(r,e);var t=H2e(r);function r(n){var i;return z2e(this,r),i=t.call(this,n),Ba(qo(i),"handleDrag",function(a){i.leaveTimer&&(clearTimeout(i.leaveTimer),i.leaveTimer=null),i.state.isTravellerMoving?i.handleTravellerMove(a):i.state.isSlideMoving&&i.handleSlideDrag(a)}),Ba(qo(i),"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&i.handleDrag(a.changedTouches[0])}),Ba(qo(i),"handleDragEnd",function(){i.setState({isTravellerMoving:!1,isSlideMoving:!1}),i.detachDragEndListener()}),Ba(qo(i),"handleLeaveWrapper",function(){(i.state.isTravellerMoving||i.state.isSlideMoving)&&(i.leaveTimer=window.setTimeout(i.handleDragEnd,i.props.leaveTimeOut))}),Ba(qo(i),"handleEnterSlideOrTraveller",function(){i.setState({isTextActive:!0})}),Ba(qo(i),"handleLeaveSlideOrTraveller",function(){i.setState({isTextActive:!1})}),Ba(qo(i),"handleSlideDragStart",function(a){var o=AV(a)?a.changedTouches[0]:a;i.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),i.attachDragEndListener()}),i.travellerDragStartHandlers={startX:i.handleTravellerDragStart.bind(qo(i),"startX"),endX:i.handleTravellerDragStart.bind(qo(i),"endX")},i.state={},i}return q2e(r,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(i){var a=i.startX,o=i.endX,s=this.state.scaleValues,l=this.props,c=l.gap,f=l.data,u=f.length-1,h=Math.min(a,o),g=Math.max(a,o),_=r.getIndexInRange(s,h),w=r.getIndexInRange(s,g);return{startIndex:_-_%c,endIndex:w===u?u:w-w%c}}},{key:"getTextOfTick",value:function(i){var a=this.props,o=a.data,s=a.tickFormatter,l=a.dataKey,c=Vn(o[i],l,i);return(0,eT.default)(s)?s(c,i):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(i){var a=this.state,o=a.slideMoveStartX,s=a.startX,l=a.endX,c=this.props,f=c.x,u=c.width,h=c.travellerWidth,g=c.startIndex,_=c.endIndex,w=c.onChange,E=i.pageX-o;E>0?E=Math.min(E,f+u-h-l,f+u-h-s):E<0&&(E=Math.max(E,f-s,f-l));var S=this.getIndex({startX:s+E,endX:l+E});(S.startIndex!==g||S.endIndex!==_)&&w&&w(S),this.setState({startX:s+E,endX:l+E,slideMoveStartX:i.pageX})}},{key:"handleTravellerDragStart",value:function(i,a){var o=AV(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:i,brushMoveStartX:o.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(i){var a,o=this.state,s=o.brushMoveStartX,l=o.movingTravellerId,c=o.endX,f=o.startX,u=this.state[l],h=this.props,g=h.x,_=h.width,w=h.travellerWidth,E=h.onChange,S=h.gap,A=h.data,O={startX:this.state.startX,endX:this.state.endX},C=i.pageX-s;C>0?C=Math.min(C,g+_-w-u):C<0&&(C=Math.max(C,g-u)),O[l]=u+C;var T=this.getIndex(O),D=T.startIndex,P=T.endIndex,z=function(){var V=A.length-1;return l==="startX"&&(c>f?D%S===0:P%S===0)||c<f&&P===V||l==="endX"&&(c>f?P%S===0:D%S===0)||c>f&&P===V};this.setState((a={},Ba(a,l,u+C),Ba(a,"brushMoveStartX",i.pageX),a),function(){E&&z()&&E(T)})}},{key:"renderBackground",value:function(){var i=this.props,a=i.x,o=i.y,s=i.width,l=i.height,c=i.fill,f=i.stroke;return nn.default.createElement("rect",{stroke:f,fill:c,x:a,y:o,width:s,height:l})}},{key:"renderPanorama",value:function(){var i=this.props,a=i.x,o=i.y,s=i.width,l=i.height,c=i.data,f=i.children,u=i.padding,h=nn.Children.only(f);return h?nn.default.cloneElement(h,{x:a,y:o,width:s,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(i,a){var o=this.props,s=o.y,l=o.travellerWidth,c=o.height,f=o.traveller,u=Math.max(i,this.props.x),h=QC(QC({},ht(this.props)),{},{x:u,y:s,width:l,height:c});return nn.default.createElement(tr,{className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],style:{cursor:"col-resize"}},r.renderTraveller(f,h))}},{key:"renderSlide",value:function(i,a){var o=this.props,s=o.y,l=o.height,c=o.stroke,f=o.travellerWidth,u=Math.min(i,a)+f,h=Math.max(Math.abs(a-i)-f,0);return nn.default.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:s,width:h,height:l})}},{key:"renderText",value:function(){var i=this.props,a=i.startIndex,o=i.endIndex,s=i.y,l=i.height,c=i.travellerWidth,f=i.stroke,u=this.state,h=u.startX,g=u.endX,_=5,w={pointerEvents:"none",fill:f};return nn.default.createElement(tr,{className:"recharts-brush-texts"},nn.default.createElement(Dl,tw({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,g)-_,y:s+l/2},w),this.getTextOfTick(a)),nn.default.createElement(Dl,tw({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,g)+c+_,y:s+l/2},w),this.getTextOfTick(o)))}},{key:"render",value:function(){var i=this.props,a=i.data,o=i.className,s=i.children,l=i.x,c=i.y,f=i.width,u=i.height,h=i.alwaysShowText,g=this.state,_=g.startX,w=g.endX,E=g.isTextActive,S=g.isSlideMoving,A=g.isTravellerMoving;if(!a||!a.length||!Ue(l)||!Ue(c)||!Ue(f)||!Ue(u)||f<=0||u<=0)return null;var O=(0,TV.default)("recharts-brush",o),C=nn.default.Children.count(s)===1,T=kV("userSelect","none");return nn.default.createElement(tr,{className:O,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:T},this.renderBackground(),C&&this.renderPanorama(),this.renderSlide(_,w),this.renderTravellerLayer(_,"startX"),this.renderTravellerLayer(w,"endX"),(E||S||A||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(i){var a=i.x,o=i.y,s=i.width,l=i.height,c=i.stroke,f=Math.floor(o+l/2)-1;return nn.default.createElement(nn.default.Fragment,null,nn.default.createElement("rect",{x:a,y:o,width:s,height:l,fill:c,stroke:"none"}),nn.default.createElement("line",{x1:a+1,y1:f,x2:a+s-1,y2:f,fill:"none",stroke:"#fff"}),nn.default.createElement("line",{x1:a+1,y1:f+2,x2:a+s-1,y2:f+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(i,a){var o;return nn.default.isValidElement(i)?o=nn.default.cloneElement(i,a):(0,eT.default)(i)?o=i(a):o=r.renderDefaultTraveller(a),o}},{key:"getDerivedStateFromProps",value:function(i,a){var o=i.data,s=i.width,l=i.x,c=i.travellerWidth,f=i.updateId,u=i.startIndex,h=i.endIndex;if(o!==a.prevData||f!==a.prevUpdateId)return QC({prevData:o,prevTravellerWidth:c,prevUpdateId:f,prevX:l,prevWidth:s},o&&o.length?Y2e({data:o,width:s,x:l,travellerWidth:c,startIndex:u,endIndex:h}):{scale:null,scaleValues:null});if(a.scale&&(s!==a.prevWidth||l!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([l,l+s-c]);var g=a.scale.domain().map(function(_){return a.scale(_)});return{prevData:o,prevTravellerWidth:c,prevUpdateId:f,prevX:l,prevWidth:s,startX:a.scale(i.startIndex),endX:a.scale(i.endIndex),scaleValues:g}}return null}},{key:"getIndexInRange",value:function(i,a){for(var o=i.length,s=0,l=o-1;l-s>1;){var c=Math.floor((s+l)/2);i[c]>a?l=c:s=c}return a>=i[l]?l:s}}]),r}(nn.PureComponent);Ba(fp,"displayName","Brush");Ba(fp,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var cH=oe(FV()),uH=oe(fn()),nm=oe(He()),fH=oe(qr());var $i=function(t,r){var n=t.alwaysShow,i=t.ifOverflow;return n&&(i="extendDomain"),i===r};var tH=oe(rT()),rH=oe(VV());var JV=oe(Aa()),GV=oe(e2()),YV=oe(fn()),KV=oe(Vr()),ri=oe(He()),ZV=oe(qr());var vwe=["value","background"];function dp(e){"@babel/helpers - typeof";return dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dp(e)}function bwe(e,t){if(e==null)return{};var r=_we(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _we(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function nT(){return nT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nT.apply(this,arguments)}function HV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HV(Object(r),!0).forEach(function(n){Vl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XV(n.key),n)}}function Swe(e,t,r){return t&&WV(e.prototype,t),r&&WV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iT(e,t)}function iT(e,t){return iT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},iT(e,t)}function kwe(e){var t=Owe();return function(){var n=nw(e),i;if(t){var a=nw(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ewe(this,i)}}function Ewe(e,t){if(t&&(dp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tm(e)}function tm(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Owe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nw(e){return nw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nw(e)}function Vl(e,t,r){return t=XV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XV(e){var t=Awe(e,"string");return dp(t)==="symbol"?t:String(t)}function Awe(e,t){if(dp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vo=function(e){xwe(r,e);var t=kwe(r);function r(){var n;wwe(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),Vl(tm(n),"state",{isAnimationFinished:!1}),Vl(tm(n),"id",Lo("recharts-bar-")),Vl(tm(n),"handleAnimationEnd",function(){var s=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),s&&s()}),Vl(tm(n),"handleAnimationStart",function(){var s=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),s&&s()}),n}return Swe(r,[{key:"renderRectanglesStatically",value:function(i){var a=this,o=this.props.shape,s=ht(this.props);return i&&i.map(function(l,c){var f=Tn(Tn(Tn({},s),l),{},{index:c});return ri.default.createElement(tr,nT({className:"recharts-bar-rectangle"},Yc(a.props,l,c),{key:"rectangle-".concat(c),role:"img"}),r.renderRectangle(o,f))})}},{key:"renderRectanglesWithAnimation",value:function(){var i=this,a=this.props,o=a.data,s=a.layout,l=a.isAnimationActive,c=a.animationBegin,f=a.animationDuration,u=a.animationEasing,h=a.animationId,g=this.state.prevData;return ri.default.createElement(su,{begin:c,duration:f,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_){var w=_.t,E=o.map(function(S,A){var O=g&&g[A];if(O){var C=ia(O.x,S.x),T=ia(O.y,S.y),D=ia(O.width,S.width),P=ia(O.height,S.height);return Tn(Tn({},S),{},{x:C(w),y:T(w),width:D(w),height:P(w)})}if(s==="horizontal"){var z=ia(0,S.height),ne=z(w);return Tn(Tn({},S),{},{y:S.y+S.height-ne,height:ne})}var V=ia(0,S.width),X=V(w);return Tn(Tn({},S),{},{width:X})});return ri.default.createElement(tr,null,i.renderRectanglesStatically(E))})}},{key:"renderRectangles",value:function(){var i=this.props,a=i.data,o=i.isAnimationActive,s=this.state.prevData;return o&&a&&a.length&&(!s||!(0,GV.default)(s,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var i=this,a=this.props.data,o=ht(this.props.background);return a.map(function(s,l){var c=s.value,f=s.background,u=bwe(s,vwe);if(!f)return null;var h=Tn(Tn(Tn(Tn(Tn({},u),{},{fill:"#eee"},f),o),Yc(i.props,s,l)),{},{index:l,key:"background-bar-".concat(l),className:"recharts-bar-background-rectangle"});return r.renderRectangle(i.props.background,h)})}},{key:"renderErrorBar",value:function(i,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,s=o.data,l=o.xAxis,c=o.yAxis,f=o.layout,u=o.children,h=vn(u,ql);if(!h)return null;var g=f==="vertical"?s[0].height/2:s[0].width/2;function _(E,S){return{x:E.x,y:E.y,value:E.value,errorVal:Vn(E,S)}}var w={clipPath:i?"url(#clipPath-".concat(a,")"):null};return ri.default.createElement(tr,w,h.map(function(E,S){return ri.default.cloneElement(E,{key:"error-bar-".concat(S),data:s,xAxis:l,yAxis:c,layout:f,offset:g,dataPointFormatter:_})}))}},{key:"render",value:function(){var i=this.props,a=i.hide,o=i.data,s=i.className,l=i.xAxis,c=i.yAxis,f=i.left,u=i.top,h=i.width,g=i.height,_=i.isAnimationActive,w=i.background,E=i.id;if(a||!o||!o.length)return null;var S=this.state.isAnimationFinished,A=(0,ZV.default)("recharts-bar",s),O=l&&l.allowDataOverflow||c&&c.allowDataOverflow,C=(0,JV.default)(E)?this.id:E;return ri.default.createElement(tr,{className:A},O?ri.default.createElement("defs",null,ri.default.createElement("clipPath",{id:"clipPath-".concat(C)},ri.default.createElement("rect",{x:f,y:u,width:h,height:g}))):null,ri.default.createElement(tr,{className:"recharts-bar-rectangles",clipPath:O?"url(#clipPath-".concat(C,")"):null},w?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(O,C),(!_||S)&&ao.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(i,a){return i.animationId!==a.prevAnimationId?{prevAnimationId:i.animationId,curData:i.data,prevData:a.curData}:i.data!==a.curData?{curData:i.data}:null}},{key:"renderRectangle",value:function(i,a){var o;return ri.default.isValidElement(i)?o=ri.default.cloneElement(i,a):(0,YV.default)(i)?o=i(a):o=ri.default.createElement(Eu,a),o}}]),r}(ri.PureComponent);Vl(Vo,"displayName","Bar");Vl(Vo,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",isAnimationActive:!mi.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Vl(Vo,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,i=e.bandSize,a=e.xAxis,o=e.yAxis,s=e.xAxisTicks,l=e.yAxisTicks,c=e.stackedData,f=e.dataStartIndex,u=e.displayedData,h=e.offset,g=A7(n,r);if(!g)return null;var _=t.layout,w=r.props,E=w.dataKey,S=w.children,A=w.minPointSize,O=_==="horizontal"?o:a,C=c?O.scale.domain():null,T=N7({numericAxis:O}),D=vn(S,jd),P=u.map(function(z,ne){var V,X,Q,ie,pe,de;if(c?V=I7(c[f+ne],C):(V=Vn(z,E),(0,KV.default)(V)||(V=[T,V])),_==="horizontal"){var F,H=[o.scale(V[0]),o.scale(V[1])],Z=H[0],j=H[1];X=PC({axis:a,ticks:s,bandSize:i,offset:g.offset,entry:z,index:ne}),Q=(F=j??Z)!==null&&F!==void 0?F:void 0,ie=g.size;var $=Z-j;if(pe=Number.isNaN($)?0:$,de={x:X,y:o.y,width:ie,height:o.height},Math.abs(A)>0&&Math.abs(pe)<Math.abs(A)){var q=Un(pe||A)*(Math.abs(A)-Math.abs(pe));Q-=q,pe+=q}}else{var ae=[a.scale(V[0]),a.scale(V[1])],le=ae[0],fe=ae[1];if(X=le,Q=PC({axis:o,ticks:l,bandSize:i,offset:g.offset,entry:z,index:ne}),ie=fe-le,pe=g.size,de={x:a.x,y:Q,width:a.width,height:pe},Math.abs(A)>0&&Math.abs(ie)<Math.abs(A)){var Se=Un(ie||A)*(Math.abs(A)-Math.abs(ie));ie+=Se}}return Tn(Tn(Tn({},z),{},{x:X,y:Q,width:ie,height:pe,value:c?V:V[1],payload:z,background:de},D&&D[ne]&&D[ne].props),{},{tooltipPayload:[V2(r,z)],tooltipPosition:{x:X+ie/2,y:Q+pe/2}})});return Tn({data:P,layout:_},h)});function rm(e){"@babel/helpers - typeof";return rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rm(e)}function Iwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nH(n.key),n)}}function Cwe(e,t,r){return t&&QV(e.prototype,t),r&&QV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eH(Object(r),!0).forEach(function(n){iw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iw(e,t,r){return t=nH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nH(e){var t=Twe(e,"string");return rm(t)==="symbol"?t:String(t)}function Twe(e,t){if(rm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aw=function(t,r,n,i,a){var o=t.width,s=t.height,l=t.layout,c=t.children,f=Object.keys(r),u={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:s-n.bottom,bottomMirror:s-n.bottom},h=!!Ia(c,Vo);return f.reduce(function(g,_){var w=r[_],E=w.orientation,S=w.domain,A=w.padding,O=A===void 0?{}:A,C=w.mirror,T=w.reversed,D="".concat(E).concat(C?"Mirror":""),P,z,ne,V,X;if(w.type==="number"&&(w.padding==="gap"||w.padding==="no-gap")){var Q=S[1]-S[0],ie=1/0,pe=w.categoricalDomain.sort();pe.forEach(function(fe,Se){Se>0&&(ie=Math.min((fe||0)-(pe[Se-1]||0),ie))});var de=ie/Q,F=w.layout==="vertical"?n.height:n.width;if(w.padding==="gap"&&(P=de*F/2),w.padding==="no-gap"){var H=Po(t.barCategoryGap,de*F),Z=de*F/2;P=Z-H-(Z-H)/F*H}}i==="xAxis"?z=[n.left+(O.left||0)+(P||0),n.left+n.width-(O.right||0)-(P||0)]:i==="yAxis"?z=l==="horizontal"?[n.top+n.height-(O.bottom||0),n.top+(O.top||0)]:[n.top+(O.top||0)+(P||0),n.top+n.height-(O.bottom||0)-(P||0)]:z=w.range,T&&(z=[z[1],z[0]]);var j=E7(w,a,h),$=j.scale,q=j.realScaleType;$.domain(S).range(z),O7($);var ae=T7($,oo(oo({},w),{},{realScaleType:q}));i==="xAxis"?(X=E==="top"&&!C||E==="bottom"&&C,ne=n.left,V=u[D]-X*w.height):i==="yAxis"&&(X=E==="left"&&!C||E==="right"&&C,ne=u[D]-X*w.width,V=n.top);var le=oo(oo(oo({},w),ae),{},{realScaleType:q,x:ne,y:V,scale:$,width:i==="xAxis"?n.width:w.width,height:i==="yAxis"?n.height:w.height});return le.bandSize=ip(le,ae),!w.hide&&i==="xAxis"?u[D]+=(X?-1:1)*le.height:w.hide||(u[D]+=(X?-1:1)*le.width),oo(oo({},g),{},iw({},_,le))},{})},aT=function(t,r){var n=t.x,i=t.y,a=r.x,o=r.y;return{x:Math.min(n,a),y:Math.min(i,o),width:Math.abs(a-n),height:Math.abs(o-i)}},iH=function(t){var r=t.x1,n=t.y1,i=t.x2,a=t.y2;return aT({x:r,y:n},{x:i,y:a})},aH=function(){function e(t){Iwe(this,e),this.scale=t}return Cwe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.bandAware,a=n.position;if(r!==void 0){if(a)switch(a){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(r)+s}default:return this.scale(r)}if(i){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+l}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),i=n[0],a=n[n.length-1];return i<=a?r>=i&&r<=a:r>=a&&r<=i}}],[{key:"create",value:function(r){return new e(r)}}]),e}();iw(aH,"EPS",1e-4);var pp=function(t){var r=Object.keys(t).reduce(function(n,i){return oo(oo({},n),{},iw({},i,aH.create(t[i])))},{});return oo(oo({},r),{},{apply:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=a.bandAware,s=a.position;return(0,rH.default)(i,function(l,c){return r[c].apply(l,{bandAware:o,position:s})})},isInRange:function(i){return(0,tH.default)(i,function(a,o){return r[o].isInRange(a)})}})};function im(e){"@babel/helpers - typeof";return im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},im(e)}function oH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function sH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oH(Object(r),!0).forEach(function(n){Nwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nwe(e,t,r){return t=Lwe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lwe(e){var t=Pwe(e,"string");return im(t)==="symbol"?t:String(t)}function Pwe(e,t){if(im(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(im(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fwe(e,t){return Mwe(e)||Rwe(e,t)||Bwe(e,t)||Dwe()}function Dwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bwe(e,t){if(e){if(typeof e=="string")return lH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lH(e,t)}}function lH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Rwe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}function Mwe(e){if(Array.isArray(e))return e}function oT(){return oT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oT.apply(this,arguments)}var jwe=function(t,r){var n;return nm.default.isValidElement(t)?n=nm.default.cloneElement(t,r):(0,uH.default)(t)?n=t(r):n=nm.default.createElement("line",oT({},r,{className:"recharts-reference-line-line"})),n},$we=function(t,r,n,i,a){var o=a.viewBox,s=o.x,l=o.y,c=o.width,f=o.height,u=a.position;if(n){var h=a.y,g=a.yAxis.orientation,_=t.y.apply(h,{position:u});if($i(a,"discard")&&!t.y.isInRange(_))return null;var w=[{x:s+c,y:_},{x:s,y:_}];return g==="left"?w.reverse():w}if(r){var E=a.x,S=a.xAxis.orientation,A=t.x.apply(E,{position:u});if($i(a,"discard")&&!t.x.isInRange(A))return null;var O=[{x:A,y:l+f},{x:A,y:l}];return S==="top"?O.reverse():O}if(i){var C=a.segment,T=C.map(function(D){return t.apply(D,{position:u})});return $i(a,"discard")&&(0,cH.default)(T,function(D){return!t.isInRange(D)})?null:T}return null};function ow(e){var t=e.x,r=e.y,n=e.segment,i=e.xAxis,a=e.yAxis,o=e.shape,s=e.className,l=e.alwaysShow,c=e.clipPathId;Ro(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=pp({x:i.scale,y:a.scale}),u=Sr(t),h=Sr(r),g=n&&n.length===2,_=$we(f,u,h,g,e);if(!_)return null;var w=Fwe(_,2),E=w[0],S=E.x,A=E.y,O=w[1],C=O.x,T=O.y,D=$i(e,"hidden")?"url(#".concat(c,")"):void 0,P=sH(sH({clipPath:D},ht(e,!0)),{},{x1:S,y1:A,x2:C,y2:T});return nm.default.createElement(tr,{className:(0,fH.default)("recharts-reference-line",s)},jwe(o,P),Gr.renderCallByParent(e,iH({x1:S,y1:A,x2:C,y2:T})))}ow.displayName="ReferenceLine";ow.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"};var hH=oe(fn()),am=oe(He()),gH=oe(qr());function om(e){"@babel/helpers - typeof";return om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},om(e)}function sT(){return sT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sT.apply(this,arguments)}function dH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dH(Object(r),!0).forEach(function(n){Uwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Uwe(e,t,r){return t=zwe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zwe(e){var t=qwe(e,"string");return om(t)==="symbol"?t:String(t)}function qwe(e,t){if(om(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(om(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vwe=function(t){var r=t.x,n=t.y,i=t.xAxis,a=t.yAxis,o=pp({x:i.scale,y:a.scale}),s=o.apply({x:r,y:n},{bandAware:!0});return $i(t,"discard")&&!o.isInRange(s)?null:s};function hp(e){var t=e.x,r=e.y,n=e.r,i=e.alwaysShow,a=e.clipPathId,o=Sr(t),s=Sr(r);if(Ro(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!o||!s)return null;var l=Vwe(e);if(!l)return null;var c=l.x,f=l.y,u=e.shape,h=e.className,g=$i(e,"hidden")?"url(#".concat(a,")"):void 0,_=pH(pH({clipPath:g},ht(e,!0)),{},{cx:c,cy:f});return am.default.createElement(tr,{className:(0,gH.default)("recharts-reference-dot",h)},hp.renderDot(u,_),Gr.renderCallByParent(e,{x:c-n,y:f-n,width:2*n,height:2*n}))}hp.displayName="ReferenceDot";hp.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1};hp.renderDot=function(e,t){var r;return am.default.isValidElement(e)?r=am.default.cloneElement(e,t):(0,hH.default)(e)?r=e(t):r=am.default.createElement(cp,sT({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r};var vH=oe(fn()),sm=oe(He()),bH=oe(qr());function lm(e){"@babel/helpers - typeof";return lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lm(e)}function lT(){return lT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lT.apply(this,arguments)}function yH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function mH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yH(Object(r),!0).forEach(function(n){Hwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hwe(e,t,r){return t=Wwe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wwe(e){var t=Jwe(e,"string");return lm(t)==="symbol"?t:String(t)}function Jwe(e,t){if(lm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gwe=function(t,r,n,i,a){var o=a.x1,s=a.x2,l=a.y1,c=a.y2,f=a.xAxis,u=a.yAxis;if(!f||!u)return null;var h=pp({x:f.scale,y:u.scale}),g={x:t?h.x.apply(o,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(l,{position:"start"}):h.y.rangeMin},_={x:r?h.x.apply(s,{position:"end"}):h.x.rangeMax,y:i?h.y.apply(c,{position:"end"}):h.y.rangeMax};return $i(a,"discard")&&(!h.isInRange(g)||!h.isInRange(_))?null:aT(g,_)};function gp(e){var t=e.x1,r=e.x2,n=e.y1,i=e.y2,a=e.className,o=e.alwaysShow,s=e.clipPathId;Ro(o===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var l=Sr(t),c=Sr(r),f=Sr(n),u=Sr(i),h=e.shape;if(!l&&!c&&!f&&!u&&!h)return null;var g=Gwe(l,c,f,u,e);if(!g&&!h)return null;var _=$i(e,"hidden")?"url(#".concat(s,")"):void 0;return sm.default.createElement(tr,{className:(0,bH.default)("recharts-reference-area",a)},gp.renderRect(h,mH(mH({clipPath:_},ht(e,!0)),g)),Gr.renderCallByParent(e,g))}gp.displayName="ReferenceArea";gp.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1};gp.renderRect=function(e,t){var r;return sm.default.isValidElement(e)?r=sm.default.cloneElement(e,t):(0,vH.default)(e)?r=e(t):r=sm.default.createElement(Eu,lT({},t,{className:"recharts-reference-area-rect"})),r};var cw=oe(fn()),uT=oe(Jc()),so=oe(He()),uw=oe(qr());var lw=oe(fn());function sw(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],i=0;i<e.length;i+=t)if(r===void 0||r(e[i])===!0)n.push(e[i]);else return;return n}function cm(e){"@babel/helpers - typeof";return cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cm(e)}function _H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_H(Object(r),!0).forEach(function(n){Ywe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_H(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ywe(e,t,r){return t=Kwe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kwe(e){var t=Xwe(e,"string");return cm(t)==="symbol"?t:String(t)}function Xwe(e,t){if(cm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zwe(e){for(var t=1,r=sw(e,t,function(n){return n.isShow});t<=e.length;){if(r!==void 0)return r;t++,r=sw(e,t,function(n){return n.isShow})}return e.slice(0,1)}function Qwe(e,t){return sw(e,t+1)}function e1e(e){var t=e.ticks,r=e.tickFormatter,n=e.viewBox,i=e.orientation,a=e.minTickGap,o=e.unit,s=e.fontSize,l=e.letterSpacing,c=n.x,f=n.y,u=n.width,h=n.height,g=i==="top"||i==="bottom"?"width":"height",_=o&&g==="width"?Ds(o,{fontSize:s,letterSpacing:l})[g]:0,w=(t||[]).slice(),E=w.length,S=E>=2?Un(w[1].coordinate-w[0].coordinate):1,A,O;S===1?(A=g==="width"?c:f,O=g==="width"?c+u:f+h):(A=g==="width"?c+u:f+h,O=g==="width"?c:f);for(var C=E-1;C>=0;C--){var T=w[C],D=(0,lw.default)(r)?r(T.value,E-C-1):T.value,P=Ds(D,{fontSize:s,letterSpacing:l})[g]+_;if(C===E-1){var z=S*(T.coordinate+S*P/2-O);w[C]=T=ni(ni({},T),{},{tickCoord:z>0?T.coordinate-z*S:T.coordinate})}else w[C]=T=ni(ni({},T),{},{tickCoord:T.coordinate});var ne=S*(T.tickCoord-S*P/2-A)>=0&&S*(T.tickCoord+S*P/2-O)<=0;ne&&(O=T.tickCoord-S*(P/2+a),w[C]=ni(ni({},T),{},{isShow:!0}))}return w}function wH(e,t){var r=e.ticks,n=e.tickFormatter,i=e.viewBox,a=e.orientation,o=e.minTickGap,s=e.unit,l=e.fontSize,c=e.letterSpacing,f=i.x,u=i.y,h=i.width,g=i.height,_=a==="top"||a==="bottom"?"width":"height",w=(r||[]).slice(),E=s&&_==="width"?Ds(s,{fontSize:l,letterSpacing:c})[_]:0,S=w.length,A=S>=2?Un(w[1].coordinate-w[0].coordinate):1,O,C;if(A===1?(O=_==="width"?f:u,C=_==="width"?f+h:u+g):(O=_==="width"?f+h:u+g,C=_==="width"?f:u),t){var T=r[S-1],D=(0,lw.default)(n)?n(T.value,S-1):T.value,P=Ds(D,{fontSize:l,letterSpacing:c})[_]+E,z=A*(T.coordinate+A*P/2-C);w[S-1]=T=ni(ni({},T),{},{tickCoord:z>0?T.coordinate-z*A:T.coordinate});var ne=A*(T.tickCoord-A*P/2-O)>=0&&A*(T.tickCoord+A*P/2-C)<=0;ne&&(C=T.tickCoord-A*(P/2+o),w[S-1]=ni(ni({},T),{},{isShow:!0}))}for(var V=t?S-1:S,X=0;X<V;X++){var Q=w[X],ie=(0,lw.default)(n)?n(Q.value,X):Q.value,pe=Ds(ie,{fontSize:l,letterSpacing:c})[_]+E;if(X===0){var de=A*(Q.coordinate-A*pe/2-O);w[X]=Q=ni(ni({},Q),{},{tickCoord:de<0?Q.coordinate-de*A:Q.coordinate})}else w[X]=Q=ni(ni({},Q),{},{tickCoord:Q.coordinate});var F=A*(Q.tickCoord-A*pe/2-O)>=0&&A*(Q.tickCoord+A*pe/2-C)<=0;F&&(O=Q.tickCoord+A*(pe/2+o),w[X]=ni(ni({},Q),{},{isShow:!0}))}return w}function um(e,t,r){var n=e.tick,i=e.ticks,a=e.viewBox,o=e.minTickGap,s=e.orientation,l=e.interval,c=e.tickFormatter,f=e.unit;if(!i||!i.length||!n)return[];if(Ue(l)||mi.isSsr)return Qwe(i,typeof l=="number"&&Ue(l)?l:0);var u=[];return l==="equidistantPreserveStart"?(u=wH({ticks:i,tickFormatter:c,viewBox:a,orientation:s,minTickGap:o,unit:f,fontSize:t,letterSpacing:r}),Zwe(u)):(l==="preserveStart"||l==="preserveStartEnd"?u=wH({ticks:i,tickFormatter:c,viewBox:a,orientation:s,minTickGap:o,unit:f,fontSize:t,letterSpacing:r},l==="preserveStartEnd"):u=e1e({ticks:i,tickFormatter:c,viewBox:a,orientation:s,minTickGap:o,unit:f,fontSize:t,letterSpacing:r}),u.filter(function(h){return h.isShow}))}var t1e=["viewBox"],r1e=["viewBox"],n1e=["ticks"];function mp(e){"@babel/helpers - typeof";return mp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mp(e)}function yp(){return yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yp.apply(this,arguments)}function SH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SH(Object(r),!0).forEach(function(n){dT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cT(e,t){if(e==null)return{};var r=i1e(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function i1e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function a1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kH(n.key),n)}}function o1e(e,t,r){return t&&xH(e.prototype,t),r&&xH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fT(e,t)}function fT(e,t){return fT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fT(e,t)}function l1e(e){var t=f1e();return function(){var n=fw(e),i;if(t){var a=fw(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return c1e(this,i)}}function c1e(e,t){if(t&&(mp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u1e(e)}function u1e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fw(e){return fw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fw(e)}function dT(e,t,r){return t=kH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kH(e){var t=d1e(e,"string");return mp(t)==="symbol"?t:String(t)}function d1e(e,t){if(mp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vp=function(e){s1e(r,e);var t=l1e(r);function r(n){var i;return a1e(this,r),i=t.call(this,n),i.state={fontSize:"",letterSpacing:""},i}return o1e(r,[{key:"shouldComponentUpdate",value:function(i,a){var o=i.viewBox,s=cT(i,t1e),l=this.props,c=l.viewBox,f=cT(l,r1e);return!Cs(o,c)||!Cs(s,f)||!Cs(a,this.state)}},{key:"componentDidMount",value:function(){var i=this.layerReference;if(i){var a=i.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(i){var a=this.props,o=a.x,s=a.y,l=a.width,c=a.height,f=a.orientation,u=a.tickSize,h=a.mirror,g=a.tickMargin,_,w,E,S,A,O,C=h?-1:1,T=i.tickSize||u,D=Ue(i.tickCoord)?i.tickCoord:i.coordinate;switch(f){case"top":_=w=i.coordinate,S=s+ +!h*c,E=S-C*T,O=E-C*g,A=D;break;case"left":E=S=i.coordinate,w=o+ +!h*l,_=w-C*T,A=_-C*g,O=D;break;case"right":E=S=i.coordinate,w=o+ +h*l,_=w+C*T,A=_+C*g,O=D;break;default:_=w=i.coordinate,S=s+ +h*c,E=S+C*T,O=E+C*g,A=D;break}return{line:{x1:_,y1:E,x2:w,y2:S},tick:{x:A,y:O}}}},{key:"getTickTextAnchor",value:function(){var i=this.props,a=i.orientation,o=i.mirror,s;switch(a){case"left":s=o?"start":"end";break;case"right":s=o?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var i=this.props,a=i.orientation,o=i.mirror,s="end";switch(a){case"left":case"right":s="middle";break;case"top":s=o?"start":"end";break;default:s=o?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var i=this.props,a=i.x,o=i.y,s=i.width,l=i.height,c=i.orientation,f=i.mirror,u=i.axisLine,h=wi(wi(wi({},ht(this.props)),ht(u)),{},{fill:"none"});if(c==="top"||c==="bottom"){var g=+(c==="top"&&!f||c==="bottom"&&f);h=wi(wi({},h),{},{x1:a,y1:o+g*l,x2:a+s,y2:o+g*l})}else{var _=+(c==="left"&&!f||c==="right"&&f);h=wi(wi({},h),{},{x1:a+_*s,y1:o,x2:a+_*s,y2:o+l})}return so.default.createElement("line",yp({},h,{className:(0,uw.default)("recharts-cartesian-axis-line",(0,uT.default)(u,"className"))}))}},{key:"renderTicks",value:function(i,a,o){var s=this,l=this.props,c=l.tickLine,f=l.stroke,u=l.tick,h=l.tickFormatter,g=l.unit,_=um(wi(wi({},this.props),{},{ticks:i}),a,o),w=this.getTickTextAnchor(),E=this.getTickVerticalAnchor(),S=ht(this.props),A=ht(u),O=wi(wi({},S),{},{fill:"none"},ht(c)),C=_.map(function(T,D){var P=s.getTickLineCoord(T),z=P.line,ne=P.tick,V=wi(wi(wi(wi({textAnchor:w,verticalAnchor:E},S),{},{stroke:"none",fill:f},A),ne),{},{index:D,payload:T,visibleTicksCount:_.length,tickFormatter:h});return so.default.createElement(tr,yp({className:"recharts-cartesian-axis-tick",key:"tick-".concat(D)},Yc(s.props,T,D)),c&&so.default.createElement("line",yp({},O,z,{className:(0,uw.default)("recharts-cartesian-axis-tick-line",(0,uT.default)(c,"className"))})),u&&r.renderTickItem(u,V,"".concat((0,cw.default)(h)?h(T.value,D):T.value).concat(g||"")))});return so.default.createElement("g",{className:"recharts-cartesian-axis-ticks"},C)}},{key:"render",value:function(){var i=this,a=this.props,o=a.axisLine,s=a.width,l=a.height,c=a.ticksGenerator,f=a.className,u=a.hide;if(u)return null;var h=this.props,g=h.ticks,_=cT(h,n1e),w=g;return(0,cw.default)(c)&&(w=g&&g.length>0?c(this.props):c(_)),s<=0||l<=0||!w||!w.length?null:so.default.createElement(tr,{className:(0,uw.default)("recharts-cartesian-axis",f),ref:function(S){i.layerReference=S}},o&&this.renderAxisLine(),this.renderTicks(w,this.state.fontSize,this.state.letterSpacing),Gr.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(i,a,o){var s;return so.default.isValidElement(i)?s=so.default.cloneElement(i,a):(0,cw.default)(i)?s=i(a):s=so.default.createElement(Dl,yp({},a,{className:"recharts-cartesian-axis-tick-value"}),o),s}}]),r}(so.Component);dT(vp,"displayName","CartesianAxis");dT(vp,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var pw=oe(fn()),Ui=oe(He());var p1e=["x1","y1","x2","y2","key"];function bp(e){"@babel/helpers - typeof";return bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bp(e)}function pT(){return pT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pT.apply(this,arguments)}function h1e(e,t){if(e==null)return{};var r=g1e(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function g1e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function EH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function dw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EH(Object(r),!0).forEach(function(n){gT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AH(n.key),n)}}function m1e(e,t,r){return t&&OH(e.prototype,t),r&&OH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hT(e,t)}function hT(e,t){return hT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hT(e,t)}function b1e(e){var t=S1e();return function(){var n=hw(e),i;if(t){var a=hw(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _1e(this,i)}}function _1e(e,t){if(t&&(bp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w1e(e)}function w1e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hw(e){return hw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hw(e)}function gT(e,t,r){return t=AH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AH(e){var t=x1e(e,"string");return bp(t)==="symbol"?t:String(t)}function x1e(e,t){if(bp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fm=function(e){v1e(r,e);var t=b1e(r);function r(){return y1e(this,r),t.apply(this,arguments)}return m1e(r,[{key:"renderHorizontal",value:function(i){var a=this,o=this.props,s=o.x,l=o.width,c=o.horizontal;if(!i||!i.length)return null;var f=i.map(function(u,h){var g=dw(dw({},a.props),{},{x1:s,y1:u,x2:s+l,y2:u,key:"line-".concat(h),index:h});return r.renderLineItem(c,g)});return Ui.default.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}},{key:"renderVertical",value:function(i){var a=this,o=this.props,s=o.y,l=o.height,c=o.vertical;if(!i||!i.length)return null;var f=i.map(function(u,h){var g=dw(dw({},a.props),{},{x1:u,y1:s,x2:u,y2:s+l,key:"line-".concat(h),index:h});return r.renderLineItem(c,g)});return Ui.default.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}},{key:"renderVerticalStripes",value:function(i){var a=this.props.verticalFill;if(!a||!a.length)return null;var o=this.props,s=o.fillOpacity,l=o.x,c=o.y,f=o.width,u=o.height,h=i.map(function(_){return Math.round(_+l-l)}).sort(function(_,w){return _-w});l!==h[0]&&h.unshift(0);var g=h.map(function(_,w){var E=!h[w+1],S=E?l+f-_:h[w+1]-_;if(S<=0)return null;var A=w%a.length;return Ui.default.createElement("rect",{key:"react-".concat(w),x:_,y:c,width:S,height:u,stroke:"none",fill:a[A],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return Ui.default.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},g)}},{key:"renderHorizontalStripes",value:function(i){var a=this.props.horizontalFill;if(!a||!a.length)return null;var o=this.props,s=o.fillOpacity,l=o.x,c=o.y,f=o.width,u=o.height,h=i.map(function(_){return Math.round(_+c-c)}).sort(function(_,w){return _-w});c!==h[0]&&h.unshift(0);var g=h.map(function(_,w){var E=!h[w+1],S=E?c+u-_:h[w+1]-_;if(S<=0)return null;var A=w%a.length;return Ui.default.createElement("rect",{key:"react-".concat(w),y:_,x:l,height:S,width:f,stroke:"none",fill:a[A],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return Ui.default.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},g)}},{key:"renderBackground",value:function(){var i=this.props.fill;if(!i||i==="none")return null;var a=this.props,o=a.fillOpacity,s=a.x,l=a.y,c=a.width,f=a.height;return Ui.default.createElement("rect",{x:s,y:l,width:c,height:f,stroke:"none",fill:i,fillOpacity:o,className:"recharts-cartesian-grid-bg"})}},{key:"render",value:function(){var i=this.props,a=i.x,o=i.y,s=i.width,l=i.height,c=i.horizontal,f=i.vertical,u=i.horizontalCoordinatesGenerator,h=i.verticalCoordinatesGenerator,g=i.xAxis,_=i.yAxis,w=i.offset,E=i.chartWidth,S=i.chartHeight;if(!Ue(s)||s<=0||!Ue(l)||l<=0||!Ue(a)||a!==+a||!Ue(o)||o!==+o)return null;var A=this.props,O=A.horizontalPoints,C=A.verticalPoints;return(!O||!O.length)&&(0,pw.default)(u)&&(O=u({yAxis:_,width:E,height:S,offset:w})),(!C||!C.length)&&(0,pw.default)(h)&&(C=h({xAxis:g,width:E,height:S,offset:w})),Ui.default.createElement("g",{className:"recharts-cartesian-grid"},this.renderBackground(),c&&this.renderHorizontal(O),f&&this.renderVertical(C),c&&this.renderHorizontalStripes(O),f&&this.renderVerticalStripes(C))}}],[{key:"renderLineItem",value:function(i,a){var o;if(Ui.default.isValidElement(i))o=Ui.default.cloneElement(i,a);else if((0,pw.default)(i))o=i(a);else{var s=a.x1,l=a.y1,c=a.x2,f=a.y2,u=a.key,h=h1e(a,p1e);o=Ui.default.createElement("line",pT({},ht(h),{x1:s,y1:l,x2:c,y2:f,fill:"none",key:u}))}return o}}]),r}(Ui.PureComponent);gT(fm,"displayName","CartesianGrid");gT(fm,"defaultProps",{horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]});var TH=oe(e2()),NH=oe(fn()),gw=oe(Aa()),Si=oe(He());var vT=oe(qr());var k1e=["type","layout","connectNulls","ref"];function wp(e){"@babel/helpers - typeof";return wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wp(e)}function E1e(e,t){if(e==null)return{};var r=O1e(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function O1e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function dm(){return dm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dm.apply(this,arguments)}function IH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ca(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IH(Object(r),!0).forEach(function(n){Ho(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _p(e){return T1e(e)||C1e(e)||I1e(e)||A1e()}function A1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I1e(e,t){if(e){if(typeof e=="string")return yT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yT(e,t)}}function C1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function T1e(e){if(Array.isArray(e))return yT(e)}function yT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LH(n.key),n)}}function L1e(e,t,r){return t&&CH(e.prototype,t),r&&CH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mT(e,t)}function mT(e,t){return mT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mT(e,t)}function F1e(e){var t=B1e();return function(){var n=yw(e),i;if(t){var a=yw(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return D1e(this,i)}}function D1e(e,t){if(t&&(wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ou(e)}function Ou(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yw(e){return yw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yw(e)}function Ho(e,t,r){return t=LH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LH(e){var t=R1e(e,"string");return wp(t)==="symbol"?t:String(t)}function R1e(e,t){if(wp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hl=function(e){P1e(r,e);var t=F1e(r);function r(){var n;N1e(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),Ho(Ou(n),"state",{isAnimationFinished:!0,totalLength:0}),Ho(Ou(n),"getStrokeDasharray",function(s,l,c){for(var f=c.reduce(function(A,O){return A+O}),u=Math.floor(s/f),h=s%f,g=l-s,_=[],w=0,E=0;;E+=c[w],++w)if(E+c[w]>h){_=[].concat(_p(c.slice(0,w)),[h-E]);break}var S=_.length%2===0?[0,g]:[g];return[].concat(_p(r.repeat(c,u)),_p(_),S).map(function(A){return"".concat(A,"px")}).join(", ")}),Ho(Ou(n),"id",Lo("recharts-line-")),Ho(Ou(n),"pathRef",function(s){n.mainCurve=s}),Ho(Ou(n),"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),Ho(Ou(n),"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return L1e(r,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var i=this.getTotalLength();this.setState({totalLength:i})}}},{key:"getTotalLength",value:function(){var i=this.mainCurve;try{return i&&i.getTotalLength&&i.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(i,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,s=o.points,l=o.xAxis,c=o.yAxis,f=o.layout,u=o.children,h=vn(u,ql);if(!h)return null;function g(w,E){return{x:w.x,y:w.y,value:w.value,errorVal:Vn(w.payload,E)}}var _={clipPath:i?"url(#clipPath-".concat(a,")"):null};return Si.default.createElement(tr,_,h.map(function(w,E){return Si.default.cloneElement(w,{key:"bar-".concat(E),data:s,xAxis:l,yAxis:c,layout:f,dataPointFormatter:g})}))}},{key:"renderDots",value:function(i,a){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var s=this.props,l=s.dot,c=s.points,f=s.dataKey,u=ht(this.props),h=ht(l,!0),g=c.map(function(w,E){var S=ca(ca(ca({key:"dot-".concat(E),r:3},u),h),{},{value:w.value,dataKey:f,cx:w.x,cy:w.y,index:E,payload:w.payload});return r.renderDotItem(l,S)}),_={clipPath:i?"url(#clipPath-".concat(a,")"):null};return Si.default.createElement(tr,dm({className:"recharts-line-dots",key:"dots"},_,{role:"img"}),g)}},{key:"renderCurveStatically",value:function(i,a,o,s){var l=this.props,c=l.type,f=l.layout,u=l.connectNulls,h=l.ref,g=E1e(l,k1e),_=ca(ca(ca({},ht(g,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(o,")"):null,points:i},s),{},{type:c,layout:f,connectNulls:u});return Si.default.createElement(op,dm({},_,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(i,a){var o=this,s=this.props,l=s.points,c=s.strokeDasharray,f=s.isAnimationActive,u=s.animationBegin,h=s.animationDuration,g=s.animationEasing,_=s.animationId,w=s.animateNewValues,E=s.width,S=s.height,A=this.state,O=A.prevPoints,C=A.totalLength;return Si.default.createElement(su,{begin:u,duration:h,isActive:f,easing:g,from:{t:0},to:{t:1},key:"line-".concat(_),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(T){var D=T.t;if(O){var P=O.length/l.length,z=l.map(function(ie,pe){var de=Math.floor(pe*P);if(O[de]){var F=O[de],H=ia(F.x,ie.x),Z=ia(F.y,ie.y);return ca(ca({},ie),{},{x:H(D),y:Z(D)})}if(w){var j=ia(E*2,ie.x),$=ia(S/2,ie.y);return ca(ca({},ie),{},{x:j(D),y:$(D)})}return ca(ca({},ie),{},{x:ie.x,y:ie.y})});return o.renderCurveStatically(z,i,a)}var ne=ia(0,C),V=ne(D),X;if(c){var Q="".concat(c).split(/[,\s]+/gim).map(function(ie){return parseFloat(ie)});X=o.getStrokeDasharray(V,C,Q)}else X="".concat(V,"px ").concat(C-V,"px");return o.renderCurveStatically(l,i,a,{strokeDasharray:X})})}},{key:"renderCurve",value:function(i,a){var o=this.props,s=o.points,l=o.isAnimationActive,c=this.state,f=c.prevPoints,u=c.totalLength;return l&&s&&s.length&&(!f&&u>0||!(0,TH.default)(f,s))?this.renderCurveWithAnimation(i,a):this.renderCurveStatically(s,i,a)}},{key:"render",value:function(){var i=this.props,a=i.hide,o=i.dot,s=i.points,l=i.className,c=i.xAxis,f=i.yAxis,u=i.top,h=i.left,g=i.width,_=i.height,w=i.isAnimationActive,E=i.id;if(a||!s||!s.length)return null;var S=this.state.isAnimationFinished,A=s.length===1,O=(0,vT.default)("recharts-line",l),C=c&&c.allowDataOverflow||f&&f.allowDataOverflow,T=(0,gw.default)(E)?this.id:E;return Si.default.createElement(tr,{className:O},C?Si.default.createElement("defs",null,Si.default.createElement("clipPath",{id:"clipPath-".concat(T)},Si.default.createElement("rect",{x:h,y:u,width:g,height:_}))):null,!A&&this.renderCurve(C,T),this.renderErrorBar(C,T),(A||o)&&this.renderDots(C,T),(!w||S)&&ao.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(i,a){return i.animationId!==a.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,prevPoints:a.curPoints}:i.points!==a.curPoints?{curPoints:i.points}:null}},{key:"repeat",value:function(i,a){for(var o=i.length%2!==0?[].concat(_p(i),[0]):i,s=[],l=0;l<a;++l)s=[].concat(_p(s),_p(o));return s}},{key:"renderDotItem",value:function(i,a){var o;if(Si.default.isValidElement(i))o=Si.default.cloneElement(i,a);else if((0,NH.default)(i))o=i(a);else{var s=(0,vT.default)("recharts-line-dot",i?i.className:"");o=Si.default.createElement(cp,dm({},a,{className:s}))}return o}}]),r}(Si.PureComponent);Ho(Hl,"displayName","Line");Ho(Hl,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!mi.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Ho(Hl,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,i=e.xAxisTicks,a=e.yAxisTicks,o=e.dataKey,s=e.bandSize,l=e.displayedData,c=e.offset,f=t.layout,u=l.map(function(h,g){var _=Vn(h,o);return f==="horizontal"?{x:LC({axis:r,ticks:i,bandSize:s,entry:h,index:g}),y:(0,gw.default)(_)?null:n.scale(_),value:_,payload:h}:{x:(0,gw.default)(_)?null:r.scale(_),y:LC({axis:n,ticks:a,bandSize:s,entry:h,index:g}),value:_,payload:h}});return ca({points:u,layout:f},c)});var zs=function(){return null};zs.displayName="XAxis";zs.defaultProps={allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0};var lo=function(){return null};lo.displayName="YAxis";lo.defaultProps={allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1};var aW=oe(rT()),oW=oe($H()),Wo=oe(fn()),sW=oe(hI()),lW=oe(U0()),xp=oe(Jc()),_w=oe(ZC()),Kr=oe(Aa()),cW=oe(zH()),ST=oe(Vr()),ur=oe(He()),dW=oe(qr());function qH(e){return aSe(e)||iSe(e)||nSe(e)||rSe()}function rSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nSe(e,t){if(e){if(typeof e=="string")return bT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bT(e,t)}}function iSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aSe(e){if(Array.isArray(e))return bT(e)}function bT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var mw=function(t,r,n,i,a){var o=vn(t,ow),s=vn(t,hp),l=[].concat(qH(o),qH(s)),c=vn(t,gp),f="".concat(i,"Id"),u=i[0],h=r;if(l.length&&(h=l.reduce(function(w,E){if(E.props[f]===n&&$i(E.props,"extendDomain")&&Ue(E.props[u])){var S=E.props[u];return[Math.min(w[0],S),Math.max(w[1],S)]}return w},h)),c.length){var g="".concat(u,"1"),_="".concat(u,"2");h=c.reduce(function(w,E){if(E.props[f]===n&&$i(E.props,"extendDomain")&&Ue(E.props[g])&&Ue(E.props[_])){var S=E.props[g],A=E.props[_];return[Math.min(w[0],S,A),Math.max(w[1],S,A)]}return w},h)}return a&&a.length&&(h=a.reduce(function(w,E){return Ue(E)?[Math.min(w[0],E),Math.max(w[1],E)]:w},h)),h};var WH=oe(HH()),zi=new WH.default;zi.setMaxListeners&&zi.setMaxListeners(10);var bw="recharts.syncMouseEvents";function hm(e){"@babel/helpers - typeof";return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hm(e)}function lSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GH(n.key),n)}}function cSe(e,t,r){return t&&JH(e.prototype,t),r&&JH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wT(e,t,r){return t=GH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GH(e){var t=uSe(e,"string");return hm(t)==="symbol"?t:String(t)}function uSe(e,t){if(hm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YH=function(){function e(){lSe(this,e),wT(this,"activeIndex",0),wT(this,"coordinateList",[]),wT(this,"layout","horizontal")}return cSe(e,[{key:"setDetails",value:function(r){var n=r.coordinateList,i=n===void 0?[]:n,a=r.container,o=a===void 0?null:a,s=r.layout,l=s===void 0?null:s,c=r.offset,f=c===void 0?null:c,u=r.mouseHandlerCallback,h=u===void 0?null:u;this.coordinateList=i??this.coordinateList,this.container=o??this.container,this.layout=l??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=h??this.mouseHandlerCallback,this.activeIndex>=this.coordinateList.length&&(this.activeIndex=this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}default:break}}},{key:"spoofMouse",value:function(){if(this.layout==="horizontal"){var r=this.container.getBoundingClientRect(),n=r.x,i=r.y,a=this.coordinateList[this.activeIndex].coordinate,o=n+a,s=i+this.offset.top;this.mouseHandlerCallback({pageX:o,pageY:s})}}}]),e}();var fSe=["item"],dSe=["children","className","width","height","style","compact","title","desc"];function kp(e){"@babel/helpers - typeof";return kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kp(e)}function KH(e,t){return gSe(e)||hSe(e,t)||uW(e,t)||pSe()}function pSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}function gSe(e){if(Array.isArray(e))return e}function Sp(){return Sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sp.apply(this,arguments)}function XH(e,t){if(e==null)return{};var r=ySe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ySe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function mSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fW(n.key),n)}}function vSe(e,t,r){return t&&ZH(e.prototype,t),r&&ZH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xT(e,t)}function xT(e,t){return xT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},xT(e,t)}function _Se(e){var t=SSe();return function(){var n=ww(e),i;if(t){var a=ww(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return wSe(this,i)}}function wSe(e,t){if(t&&(kp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bt(e)}function Bt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ww(e){return ww=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ww(e)}function Ep(e){return ESe(e)||kSe(e)||uW(e)||xSe()}function xSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uW(e,t){if(e){if(typeof e=="string")return kT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kT(e,t)}}function kSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ESe(e){if(Array.isArray(e))return kT(e)}function kT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Me(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QH(Object(r),!0).forEach(function(n){vt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vt(e,t,r){return t=fW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fW(e){var t=OSe(e,"string");return kp(t)==="symbol"?t:String(t)}function OSe(e,t){if(kp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ASe={xAxis:["bottom","top"],yAxis:["left","right"]},pW={x:0,y:0},ISe=Number.isFinite?Number.isFinite:isFinite,eW=typeof requestAnimationFrame=="function"?requestAnimationFrame:typeof setImmediate=="function"?setImmediate:setTimeout,tW=typeof cancelAnimationFrame=="function"?cancelAnimationFrame:typeof clearImmediate=="function"?clearImmediate:clearTimeout,CSe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},TSe=function(t,r,n,i){var a=r.find(function(f){return f&&f.index===n});if(a){if(t==="horizontal")return{x:a.coordinate,y:i.y};if(t==="vertical")return{x:i.x,y:a.coordinate};if(t==="centric"){var o=a.coordinate,s=i.radius;return Me(Me(Me({},i),hn(i.cx,i.cy,s,o)),{},{angle:o,radius:s})}var l=a.coordinate,c=i.angle;return Me(Me(Me({},i),hn(i.cx,i.cy,l,c)),{},{angle:c,radius:l})}return pW},Sw=function(t,r,n){var i=r.graphicalItems,a=r.dataStartIndex,o=r.dataEndIndex,s=(i||[]).reduce(function(l,c){var f=c.props.data;return f&&f.length?[].concat(Ep(l),Ep(f)):l},[]);return s&&s.length>0?s:n&&n.props&&n.props.data&&n.props.data.length>0?n.props.data:t&&t.length&&Ue(a)&&Ue(o)?t.slice(a,o+1):[]};function NSe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e?.[0],i=e?.[1];if(n&&i&&Ue(n)&&Ue(i))return!0}return!1}function hW(e){return e==="number"?[0,"auto"]:void 0}var gW=function(t,r,n,i){var a=t.graphicalItems,o=t.tooltipAxis,s=Sw(r,t);return n<0||!a||!a.length||n>=s.length?null:a.reduce(function(l,c){var f=c.props.hide;if(f)return l;var u=c.props.data,h;if(o.dataKey&&!o.allowDuplicatedCategory){var g=u===void 0?s:u;h=od(g,o.dataKey,i)}else h=u&&u[n]||s[n];return h?[].concat(Ep(l),[V2(c,h)]):l},[])},rW=function(t,r,n,i){var a=i||{x:t.chartX,y:t.chartY},o=CSe(a,n),s=t.orderedTooltipTicks,l=t.tooltipAxis,c=t.tooltipTicks,f=b7(o,s,c,l);if(f>=0&&c){var u=c[f]&&c[f].value,h=gW(t,r,f,u),g=TSe(n,s,f,a);return{activeTooltipIndex:f,activeLabel:u,activePayload:h,activeCoordinate:g}}return null},LSe=function(t,r){var n=r.axes,i=r.graphicalItems,a=r.axisType,o=r.axisIdKey,s=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,f=t.layout,u=t.children,h=t.stackOffset,g=TC(f,a),_=n.reduce(function(w,E){var S,A=E.props,O=A.type,C=A.dataKey,T=A.allowDataOverflow,D=A.allowDuplicatedCategory,P=A.scale,z=A.ticks,ne=A.includeHidden,V=E.props[o];if(w[V])return w;var X=Sw(t.data,{graphicalItems:i.filter(function(le){return le.props[o]===V}),dataStartIndex:l,dataEndIndex:c}),Q=X.length,ie,pe,de;NSe(E.props.domain,T,O)&&(ie=q2(E.props.domain,null,T),g&&(O==="number"||P!=="auto")&&(de=np(X,C,"category")));var F=hW(O);if(!ie||ie.length===0){var H,Z=(H=E.props.domain)!==null&&H!==void 0?H:F;if(C){if(ie=np(X,C,O),O==="category"&&g){var j=t4(ie);D&&j?(pe=ie,ie=(0,_w.default)(0,Q)):D||(ie=DC(Z,ie,E).reduce(function(le,fe){return le.indexOf(fe)>=0?le:[].concat(Ep(le),[fe])},[]))}else if(O==="category")D?ie=ie.filter(function(le){return le!==""&&!(0,Kr.default)(le)}):ie=DC(Z,ie,E).reduce(function(le,fe){return le.indexOf(fe)>=0||fe===""||(0,Kr.default)(fe)?le:[].concat(Ep(le),[fe])},[]);else if(O==="number"){var $=k7(X,i.filter(function(le){return le.props[o]===V&&(ne||!le.props.hide)}),C,a,f);$&&(ie=$)}g&&(O==="number"||P!=="auto")&&(de=np(X,C,"category"))}else g?ie=(0,_w.default)(0,Q):s&&s[V]&&s[V].hasStack&&O==="number"?ie=h==="expand"?[0,1]:FC(s[V].stackGroups,l,c):ie=CC(X,i.filter(function(le){return le.props[o]===V&&(ne||!le.props.hide)}),O,f,!0);if(O==="number")ie=mw(u,ie,V,a,z),Z&&(ie=q2(Z,ie,T));else if(O==="category"&&Z){var q=Z,ae=ie.every(function(le){return q.indexOf(le)>=0});ae&&(ie=q)}}return Me(Me({},w),{},vt({},V,Me(Me({},E.props),{},{axisType:a,domain:ie,categoricalDomain:de,duplicateDomain:pe,originalDomain:(S=E.props.domain)!==null&&S!==void 0?S:F,isCategorical:g,layout:f})))},{});return _},PSe=function(t,r){var n=r.graphicalItems,i=r.Axis,a=r.axisType,o=r.axisIdKey,s=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,f=t.layout,u=t.children,h=Sw(t.data,{graphicalItems:n,dataStartIndex:l,dataEndIndex:c}),g=h.length,_=TC(f,a),w=-1,E=n.reduce(function(S,A){var O=A.props[o],C=hW("number");if(!S[O]){w++;var T;return _?T=(0,_w.default)(0,g):s&&s[O]&&s[O].hasStack?(T=FC(s[O].stackGroups,l,c),T=mw(u,T,O,a)):(T=q2(C,CC(h,n.filter(function(D){return D.props[o]===O&&!D.props.hide}),"number",f),i.defaultProps.allowDataOverflow),T=mw(u,T,O,a)),Me(Me({},S),{},vt({},O,Me(Me({axisType:a},i.defaultProps),{},{hide:!0,orientation:(0,xp.default)(ASe,"".concat(a,".").concat(w%2),null),domain:T,originalDomain:C,isCategorical:_,layout:f})))}return S},{});return E},FSe=function(t,r){var n=r.axisType,i=n===void 0?"xAxis":n,a=r.AxisComp,o=r.graphicalItems,s=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,f=t.children,u="".concat(i,"Id"),h=vn(f,a),g={};return h&&h.length?g=LSe(t,{axes:h,graphicalItems:o,axisType:i,axisIdKey:u,stackGroups:s,dataStartIndex:l,dataEndIndex:c}):o&&o.length&&(g=PSe(t,{Axis:a,graphicalItems:o,axisType:i,axisIdKey:u,stackGroups:s,dataStartIndex:l,dataEndIndex:c})),g},DSe=function(t){var r=Is(t),n=$s(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:(0,lW.default)(n,function(i){return i.coordinate}),tooltipAxis:r,tooltipAxisBandSize:ip(r,n)}},nW=function(t){var r,n,i=t.children,a=t.defaultShowTooltip,o=Ia(i,fp),s=o&&o.props&&o.props.startIndex||0,l=(o==null||(r=o.props)===null||r===void 0?void 0:r.endIndex)!==void 0?o==null||(n=o.props)===null||n===void 0?void 0:n.endIndex:t.data&&t.data.length-1||0;return{chartX:0,chartY:0,dataStartIndex:s,dataEndIndex:l,activeTooltipIndex:-1,isTooltipActive:(0,Kr.default)(a)?!1:a}},BSe=function(t){return!t||!t.length?!1:t.some(function(r){var n=Fo(r&&r.type);return n&&n.indexOf("Bar")>=0})},iW=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},RSe=function(t,r){var n=t.props,i=t.graphicalItems,a=t.xAxisMap,o=a===void 0?{}:a,s=t.yAxisMap,l=s===void 0?{}:s,c=n.width,f=n.height,u=n.children,h=n.margin||{},g=Ia(u,fp),_=Ia(u,ru),w=Object.keys(l).reduce(function(O,C){var T=l[C],D=T.orientation;return!T.mirror&&!T.hide?Me(Me({},O),{},vt({},D,O[D]+T.width)):O},{left:h.left||0,right:h.right||0}),E=Object.keys(o).reduce(function(O,C){var T=o[C],D=T.orientation;return!T.mirror&&!T.hide?Me(Me({},O),{},vt({},D,(0,xp.default)(O,"".concat(D))+T.height)):O},{top:h.top||0,bottom:h.bottom||0}),S=Me(Me({},E),w),A=S.bottom;return g&&(S.bottom+=g.props.height||fp.defaultProps.height),_&&r&&(S=S7(S,i,n,r)),Me(Me({brushBottom:A},S),{},{width:c-S.left-S.right,height:f-S.top-S.bottom})},xw=function(t){var r,n=t.chartName,i=t.GraphicalChild,a=t.defaultTooltipEventType,o=a===void 0?"axis":a,s=t.validateTooltipEventTypes,l=s===void 0?["axis"]:s,c=t.axisComponents,f=t.legendContent,u=t.formatAxisMap,h=t.defaultProps,g=function(E,S){var A=S.graphicalItems,O=S.stackGroups,C=S.offset,T=S.updateId,D=S.dataStartIndex,P=S.dataEndIndex,z=E.barSize,ne=E.layout,V=E.barGap,X=E.barCategoryGap,Q=E.maxBarSize,ie=iW(ne),pe=ie.numericAxisName,de=ie.cateAxisName,F=BSe(A),H=F&&_7({barSize:z,stackGroups:O}),Z=[];return A.forEach(function(j,$){var q=Sw(E.data,{dataStartIndex:D,dataEndIndex:P},j),ae=j.props,le=ae.dataKey,fe=ae.maxBarSize,Se=j.props["".concat(pe,"Id")],ke=j.props["".concat(de,"Id")],xe=c.reduce(function(ft,ee){var B,R=S["".concat(ee.axisType,"Map")],te=j.props["".concat(ee.axisType,"Id")],we=R&&R[te];return Me(Me({},ft),{},(B={},vt(B,ee.axisType,we),vt(B,"".concat(ee.axisType,"Ticks"),$s(we)),B))},{}),se=xe[de],be=xe["".concat(de,"Ticks")],W=O&&O[Se]&&O[Se].hasStack&&L7(j,O[Se].stackGroups),J=Fo(j.type).indexOf("Bar")>=0,re=ip(se,be),Ee=[];if(J){var Te,Ie,Ye=(0,Kr.default)(fe)?Q:fe,Ke=(Te=(Ie=ip(se,be,!0))!==null&&Ie!==void 0?Ie:Ye)!==null&&Te!==void 0?Te:0;Ee=w7({barGap:V,barCategoryGap:X,bandSize:Ke!==re?Ke:re,sizeList:H[ke],maxBarSize:Ye}),Ke!==re&&(Ee=Ee.map(function(ft){return Me(Me({},ft),{},{position:Me(Me({},ft.position),{},{offset:ft.position.offset-Ke/2})})}))}var St=j&&j.type&&j.type.getComposedData;if(St){var _t;Z.push({props:Me(Me({},St(Me(Me({},xe),{},{displayedData:q,props:E,dataKey:le,item:j,bandSize:re,barPosition:Ee,offset:C,stackedData:W,layout:ne,dataStartIndex:D,dataEndIndex:P}))),{},(_t={key:j.key||"item-".concat($)},vt(_t,pe,xe[pe]),vt(_t,de,xe[de]),vt(_t,"animationId",T),_t)),childIndex:h4(j,E.children),item:j})}}),Z},_=function(E,S){var A=E.props,O=E.dataStartIndex,C=E.dataEndIndex,T=E.updateId;if(!uO({props:A}))return null;var D=A.children,P=A.layout,z=A.stackOffset,ne=A.data,V=A.reverseStackOrder,X=iW(P),Q=X.numericAxisName,ie=X.cateAxisName,pe=vn(D,i),de=C7(ne,pe,"".concat(Q,"Id"),"".concat(ie,"Id"),z,V),F=c.reduce(function(q,ae){var le="".concat(ae.axisType,"Map");return Me(Me({},q),{},vt({},le,FSe(A,Me(Me({},ae),{},{graphicalItems:pe,stackGroups:ae.axisType===Q&&de,dataStartIndex:O,dataEndIndex:C}))))},{}),H=RSe(Me(Me({},F),{},{props:A,graphicalItems:pe}),S?.legendBBox);Object.keys(F).forEach(function(q){F[q]=u(A,F[q],H,q.replace("Map",""),n)});var Z=F["".concat(ie,"Map")],j=DSe(Z),$=g(A,Me(Me({},F),{},{dataStartIndex:O,dataEndIndex:C,updateId:T,graphicalItems:pe,stackGroups:de,offset:H}));return Me(Me({formattedGraphicalItems:$,graphicalItems:pe,offset:H,stackGroups:de},j),F)};return r=function(w){bSe(S,w);var E=_Se(S);function S(A){var O;return mSe(this,S),O=E.call(this,A),vt(Bt(O),"accessibilityManager",new YH),vt(Bt(O),"clearDeferId",function(){!(0,Kr.default)(O.deferId)&&tW&&tW(O.deferId),O.deferId=null}),vt(Bt(O),"handleLegendBBoxUpdate",function(C){if(C){var T=O.state,D=T.dataStartIndex,P=T.dataEndIndex,z=T.updateId;O.setState(Me({legendBBox:C},_({props:O.props,dataStartIndex:D,dataEndIndex:P,updateId:z},Me(Me({},O.state),{},{legendBBox:C}))))}}),vt(Bt(O),"handleReceiveSyncEvent",function(C,T,D){var P=O.props.syncId;P===C&&T!==O.uniqueChartId&&(O.clearDeferId(),O.deferId=eW&&eW(O.applySyncEvent.bind(Bt(O),D)))}),vt(Bt(O),"handleBrushChange",function(C){var T=C.startIndex,D=C.endIndex;if(T!==O.state.dataStartIndex||D!==O.state.dataEndIndex){var P=O.state.updateId;O.setState(function(){return Me({dataStartIndex:T,dataEndIndex:D},_({props:O.props,dataStartIndex:T,dataEndIndex:D,updateId:P},O.state))}),O.triggerSyncEvent({dataStartIndex:T,dataEndIndex:D})}}),vt(Bt(O),"handleMouseEnter",function(C){var T=O.props.onMouseEnter,D=O.getMouseInfo(C);if(D){var P=Me(Me({},D),{},{isTooltipActive:!0});O.setState(P),O.triggerSyncEvent(P),(0,Wo.default)(T)&&T(P,C)}}),vt(Bt(O),"triggeredAfterMouseMove",function(C){var T=O.props.onMouseMove,D=O.getMouseInfo(C),P=D?Me(Me({},D),{},{isTooltipActive:!0}):{isTooltipActive:!1};O.setState(P),O.triggerSyncEvent(P),(0,Wo.default)(T)&&T(P,C)}),vt(Bt(O),"handleItemMouseEnter",function(C){O.setState(function(){return{isTooltipActive:!0,activeItem:C,activePayload:C.tooltipPayload,activeCoordinate:C.tooltipPosition||{x:C.cx,y:C.cy}}})}),vt(Bt(O),"handleItemMouseLeave",function(){O.setState(function(){return{isTooltipActive:!1}})}),vt(Bt(O),"handleMouseMove",function(C){C&&(0,Wo.default)(C.persist)&&C.persist(),O.triggeredAfterMouseMove(C)}),vt(Bt(O),"handleMouseLeave",function(C){var T=O.props.onMouseLeave,D={isTooltipActive:!1};O.setState(D),O.triggerSyncEvent(D),(0,Wo.default)(T)&&T(D,C),O.cancelThrottledTriggerAfterMouseMove()}),vt(Bt(O),"handleOuterEvent",function(C){var T=p4(C),D=(0,xp.default)(O.props,"".concat(T));if(T&&(0,Wo.default)(D)){var P;/.*touch.*/i.test(T)?P=O.getMouseInfo(C.changedTouches[0]):P=O.getMouseInfo(C);var z=D;z(P,C)}}),vt(Bt(O),"handleClick",function(C){var T=O.props.onClick,D=O.getMouseInfo(C);if(D){var P=Me(Me({},D),{},{isTooltipActive:!0});O.setState(P),O.triggerSyncEvent(P),(0,Wo.default)(T)&&T(P,C)}}),vt(Bt(O),"handleMouseDown",function(C){var T=O.props.onMouseDown;if((0,Wo.default)(T)){var D=O.getMouseInfo(C);T(D,C)}}),vt(Bt(O),"handleMouseUp",function(C){var T=O.props.onMouseUp;if((0,Wo.default)(T)){var D=O.getMouseInfo(C);T(D,C)}}),vt(Bt(O),"handleTouchMove",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&O.handleMouseMove(C.changedTouches[0])}),vt(Bt(O),"handleTouchStart",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&O.handleMouseDown(C.changedTouches[0])}),vt(Bt(O),"handleTouchEnd",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&O.handleMouseUp(C.changedTouches[0])}),vt(Bt(O),"verticalCoordinatesGenerator",function(C){var T=C.xAxis,D=C.width,P=C.height,z=C.offset;return NC(um(Me(Me(Me({},vp.defaultProps),T),{},{ticks:$s(T,!0),viewBox:{x:0,y:0,width:D,height:P}})),z.left,z.left+z.width)}),vt(Bt(O),"horizontalCoordinatesGenerator",function(C){var T=C.yAxis,D=C.width,P=C.height,z=C.offset;return NC(um(Me(Me(Me({},vp.defaultProps),T),{},{ticks:$s(T,!0),viewBox:{x:0,y:0,width:D,height:P}})),z.top,z.top+z.height)}),vt(Bt(O),"axesTicksGenerator",function(C){return $s(C,!0)}),vt(Bt(O),"renderCursor",function(C){var T=O.state,D=T.isTooltipActive,P=T.activeCoordinate,z=T.activePayload,ne=T.offset,V=T.activeTooltipIndex,X=O.getTooltipEventType();if(!C||!C.props.cursor||!D||!P||n!=="ScatterChart"&&X!=="axis")return null;var Q=O.props.layout,ie,pe=op;if(n==="ScatterChart")ie=P,pe=YC;else if(n==="BarChart")ie=O.getCursorRectangle(),pe=Eu;else if(Q==="radial"){var de=O.getCursorPoints(),F=de.cx,H=de.cy,Z=de.radius,j=de.startAngle,$=de.endAngle;ie={cx:F,cy:H,startAngle:j,endAngle:$,innerRadius:Z,outerRadius:Z},pe=qC}else ie={points:O.getCursorPoints()},pe=op;var q=C.key||"_recharts-cursor",ae=Me(Me(Me(Me({stroke:"#ccc",pointerEvents:"none"},ne),ie),ht(C.props.cursor)),{},{payload:z,payloadIndex:V,key:q,className:"recharts-tooltip-cursor"});return(0,ur.isValidElement)(C.props.cursor)?(0,ur.cloneElement)(C.props.cursor,ae):(0,ur.createElement)(pe,ae)}),vt(Bt(O),"renderPolarAxis",function(C,T,D){var P=(0,xp.default)(C,"type.axisType"),z=(0,xp.default)(O.state,"".concat(P,"Map")),ne=z&&z[C.props["".concat(P,"Id")]];return(0,ur.cloneElement)(C,Me(Me({},ne),{},{className:P,key:C.key||"".concat(T,"-").concat(D),ticks:$s(ne,!0)}))}),vt(Bt(O),"renderXAxis",function(C,T,D){var P=O.state.xAxisMap,z=P[C.props.xAxisId];return O.renderAxis(z,C,T,D)}),vt(Bt(O),"renderYAxis",function(C,T,D){var P=O.state.yAxisMap,z=P[C.props.yAxisId];return O.renderAxis(z,C,T,D)}),vt(Bt(O),"renderGrid",function(C){var T=O.state,D=T.xAxisMap,P=T.yAxisMap,z=T.offset,ne=O.props,V=ne.width,X=ne.height,Q=Is(D),ie=(0,oW.default)(P,function(F){return(0,aW.default)(F.domain,ISe)}),pe=ie||Is(P),de=C.props||{};return(0,ur.cloneElement)(C,{key:C.key||"grid",x:Ue(de.x)?de.x:z.left,y:Ue(de.y)?de.y:z.top,width:Ue(de.width)?de.width:z.width,height:Ue(de.height)?de.height:z.height,xAxis:Q,yAxis:pe,offset:z,chartWidth:V,chartHeight:X,verticalCoordinatesGenerator:de.verticalCoordinatesGenerator||O.verticalCoordinatesGenerator,horizontalCoordinatesGenerator:de.horizontalCoordinatesGenerator||O.horizontalCoordinatesGenerator})}),vt(Bt(O),"renderPolarGrid",function(C){var T=C.props,D=T.radialLines,P=T.polarAngles,z=T.polarRadius,ne=O.state,V=ne.radiusAxisMap,X=ne.angleAxisMap,Q=Is(V),ie=Is(X),pe=ie.cx,de=ie.cy,F=ie.innerRadius,H=ie.outerRadius;return(0,ur.cloneElement)(C,{polarAngles:(0,ST.default)(P)?P:$s(ie,!0).map(function(Z){return Z.coordinate}),polarRadius:(0,ST.default)(z)?z:$s(Q,!0).map(function(Z){return Z.coordinate}),cx:pe,cy:de,innerRadius:F,outerRadius:H,key:C.key||"polar-grid",radialLines:D})}),vt(Bt(O),"renderLegend",function(){var C=O.state.formattedGraphicalItems,T=O.props,D=T.children,P=T.width,z=T.height,ne=O.props.margin||{},V=P-(ne.left||0)-(ne.right||0),X=IC({children:D,formattedGraphicalItems:C,legendWidth:V,legendContent:f});if(!X)return null;var Q=X.item,ie=XH(X,fSe);return(0,ur.cloneElement)(Q,Me(Me({},ie),{},{chartWidth:P,chartHeight:z,margin:ne,ref:function(de){O.legendInstance=de},onBBoxUpdate:O.handleLegendBBoxUpdate}))}),vt(Bt(O),"renderTooltip",function(){var C=O.props.children,T=Ia(C,lu);if(!T)return null;var D=O.state,P=D.isTooltipActive,z=D.activeCoordinate,ne=D.activePayload,V=D.activeLabel,X=D.offset;return(0,ur.cloneElement)(T,{viewBox:Me(Me({},X),{},{x:X.left,y:X.top}),active:P,label:V,payload:P?ne:[],coordinate:z})}),vt(Bt(O),"renderBrush",function(C){var T=O.props,D=T.margin,P=T.data,z=O.state,ne=z.offset,V=z.dataStartIndex,X=z.dataEndIndex,Q=z.updateId;return(0,ur.cloneElement)(C,{key:C.key||"_recharts-brush",onChange:qy(O.handleBrushChange,null,C.props.onChange),data:P,x:Ue(C.props.x)?C.props.x:ne.left,y:Ue(C.props.y)?C.props.y:ne.top+ne.height+ne.brushBottom-(D.bottom||0),width:Ue(C.props.width)?C.props.width:ne.width,startIndex:V,endIndex:X,updateId:"brush-".concat(Q)})}),vt(Bt(O),"renderReferenceElement",function(C,T,D){if(!C)return null;var P=Bt(O),z=P.clipPathId,ne=O.state,V=ne.xAxisMap,X=ne.yAxisMap,Q=ne.offset,ie=C.props,pe=ie.xAxisId,de=ie.yAxisId;return(0,ur.cloneElement)(C,{key:C.key||"".concat(T,"-").concat(D),xAxis:V[pe],yAxis:X[de],viewBox:{x:Q.left,y:Q.top,width:Q.width,height:Q.height},clipPathId:z})}),vt(Bt(O),"renderActivePoints",function(C){var T=C.item,D=C.activePoint,P=C.basePoint,z=C.childIndex,ne=C.isRange,V=[],X=T.props.key,Q=T.item.props,ie=Q.activeDot,pe=Q.dataKey,de=Me(Me({index:z,dataKey:pe,cx:D.x,cy:D.y,r:4,fill:z2(T.item),strokeWidth:2,stroke:"#fff",payload:D.payload,value:D.value,key:"".concat(X,"-activePoint-").concat(z)},ht(ie)),Gc(ie));return V.push(S.renderActiveDot(ie,de)),P?V.push(S.renderActiveDot(ie,Me(Me({},de),{},{cx:P.x,cy:P.y,key:"".concat(X,"-basePoint-").concat(z)}))):ne&&V.push(null),V}),vt(Bt(O),"renderGraphicChild",function(C,T,D){var P=O.filterFormatItem(C,T,D);if(!P)return null;var z=O.getTooltipEventType(),ne=O.state,V=ne.isTooltipActive,X=ne.tooltipAxis,Q=ne.activeTooltipIndex,ie=ne.activeLabel,pe=O.props.children,de=Ia(pe,lu),F=P.props,H=F.points,Z=F.isRange,j=F.baseLine,$=P.item.props,q=$.activeDot,ae=$.hide,le=!ae&&V&&de&&q&&Q>=0,fe={};z!=="axis"&&de&&de.props.trigger==="click"?fe={onClick:qy(O.handleItemMouseEnter,null,C.props.onCLick)}:z!=="axis"&&(fe={onMouseLeave:qy(O.handleItemMouseLeave,null,C.props.onMouseLeave),onMouseEnter:qy(O.handleItemMouseEnter,null,C.props.onMouseEnter)});var Se=(0,ur.cloneElement)(C,Me(Me({},P.props),fe));function ke(W){return typeof X.dataKey=="function"?X.dataKey(W.payload):null}if(le){var xe,se;if(X.dataKey&&!X.allowDuplicatedCategory){var be=typeof X.dataKey=="function"?ke:"payload.".concat(X.dataKey.toString());xe=od(H,be,ie),se=Z&&j&&od(j,be,ie)}else xe=H[Q],se=Z&&j&&j[Q];if(!(0,Kr.default)(xe))return[Se].concat(Ep(O.renderActivePoints({item:P,activePoint:xe,basePoint:se,childIndex:Q,isRange:Z})))}return Z?[Se,null,null]:[Se,null]}),vt(Bt(O),"renderCustomized",function(C,T,D){return(0,ur.cloneElement)(C,Me(Me({key:"recharts-customized-".concat(D)},O.props),O.state))}),O.uniqueChartId=(0,Kr.default)(A.id)?Lo("recharts"):A.id,O.clipPathId="".concat(O.uniqueChartId,"-clip"),A.throttleDelay&&(O.triggeredAfterMouseMove=(0,sW.default)(O.triggeredAfterMouseMove,A.throttleDelay)),O.state={},O}return vSe(S,[{key:"componentDidMount",value:function(){var O,C;(0,Kr.default)(this.props.syncId)||this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(O=this.props.margin.left)!==null&&O!==void 0?O:0,top:(C=this.props.margin.top)!==null&&C!==void 0?C:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.handleMouseMove,layout:this.props.layout})}},{key:"getSnapshotBeforeUpdate",value:function(O,C){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==C.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==O.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==O.margin){var T,D;this.accessibilityManager.setDetails({offset:{left:(T=this.props.margin.left)!==null&&T!==void 0?T:0,top:(D=this.props.margin.top)!==null&&D!==void 0?D:0}})}return null}},{key:"componentDidUpdate",value:function(O){(0,Kr.default)(O.syncId)&&!(0,Kr.default)(this.props.syncId)&&this.addListener(),!(0,Kr.default)(O.syncId)&&(0,Kr.default)(this.props.syncId)&&this.removeListener()}},{key:"componentWillUnmount",value:function(){this.clearDeferId(),(0,Kr.default)(this.props.syncId)||this.removeListener(),this.cancelThrottledTriggerAfterMouseMove()}},{key:"cancelThrottledTriggerAfterMouseMove",value:function(){typeof this.triggeredAfterMouseMove.cancel=="function"&&this.triggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var O=Ia(this.props.children,lu);if(O&&(0,cW.default)(O.props.shared)){var C=O.props.shared?"axis":"item";return l.indexOf(C)>=0?C:o}return o}},{key:"getMouseInfo",value:function(O){if(!this.container)return null;var C=f9(this.container),T=d9(O,C),D=this.inRange(T.chartX,T.chartY);if(!D)return null;var P=this.state,z=P.xAxisMap,ne=P.yAxisMap,V=this.getTooltipEventType();if(V!=="axis"&&z&&ne){var X=Is(z).scale,Q=Is(ne).scale,ie=X&&X.invert?X.invert(T.chartX):null,pe=Q&&Q.invert?Q.invert(T.chartY):null;return Me(Me({},T),{},{xValue:ie,yValue:pe})}var de=rW(this.state,this.props.data,this.props.layout,D);return de?Me(Me({},T),de):null}},{key:"getCursorRectangle",value:function(){var O=this.props.layout,C=this.state,T=C.activeCoordinate,D=C.offset,P=C.tooltipAxisBandSize,z=P/2;return{stroke:"none",fill:"#ccc",x:O==="horizontal"?T.x-z:D.left+.5,y:O==="horizontal"?D.top+.5:T.y-z,width:O==="horizontal"?P:D.width-1,height:O==="horizontal"?D.height-1:P}}},{key:"getCursorPoints",value:function(){var O=this.props.layout,C=this.state,T=C.activeCoordinate,D=C.offset,P,z,ne,V;if(O==="horizontal")P=T.x,ne=P,z=D.top,V=D.top+D.height;else if(O==="vertical")z=T.y,V=z,P=D.left,ne=D.left+D.width;else if(!(0,Kr.default)(T.cx)||!(0,Kr.default)(T.cy))if(O==="centric"){var X=T.cx,Q=T.cy,ie=T.innerRadius,pe=T.outerRadius,de=T.angle,F=hn(X,Q,ie,de),H=hn(X,Q,pe,de);P=F.x,z=F.y,ne=H.x,V=H.y}else{var Z=T.cx,j=T.cy,$=T.radius,q=T.startAngle,ae=T.endAngle,le=hn(Z,j,$,q),fe=hn(Z,j,$,ae);return{points:[le,fe],cx:Z,cy:j,radius:$,startAngle:q,endAngle:ae}}return[{x:P,y:z},{x:ne,y:V}]}},{key:"inRange",value:function(O,C){var T=this.props.layout;if(T==="horizontal"||T==="vertical"){var D=this.state.offset,P=O>=D.left&&O<=D.left+D.width&&C>=D.top&&C<=D.top+D.height;return P?{x:O,y:C}:null}var z=this.state,ne=z.angleAxisMap,V=z.radiusAxisMap;if(ne&&V){var X=Is(ne);return BC({x:O,y:C},X)}return null}},{key:"parseEventsOfWrapper",value:function(){var O=this.props.children,C=this.getTooltipEventType(),T=Ia(O,lu),D={};T&&C==="axis"&&(T.props.trigger==="click"?D={onClick:this.handleClick}:D={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var P=Gc(this.props,this.handleOuterEvent);return Me(Me({},P),D)}},{key:"addListener",value:function(){zi.on(bw,this.handleReceiveSyncEvent),zi.setMaxListeners&&zi._maxListeners&&zi.setMaxListeners(zi._maxListeners+1)}},{key:"removeListener",value:function(){zi.removeListener(bw,this.handleReceiveSyncEvent),zi.setMaxListeners&&zi._maxListeners&&zi.setMaxListeners(zi._maxListeners-1)}},{key:"triggerSyncEvent",value:function(O){var C=this.props.syncId;(0,Kr.default)(C)||zi.emit(bw,C,this.uniqueChartId,O)}},{key:"applySyncEvent",value:function(O){var C=this.props,T=C.layout,D=C.syncMethod,P=this.state.updateId,z=O.dataStartIndex,ne=O.dataEndIndex;if(!(0,Kr.default)(O.dataStartIndex)||!(0,Kr.default)(O.dataEndIndex))this.setState(Me({dataStartIndex:z,dataEndIndex:ne},_({props:this.props,dataStartIndex:z,dataEndIndex:ne,updateId:P},this.state)));else if((0,Kr.default)(O.activeTooltipIndex))this.setState(O);else{var V=O.chartX,X=O.chartY,Q=O.activeTooltipIndex,ie=this.state,pe=ie.offset,de=ie.tooltipTicks;if(!pe)return;if(typeof D=="function")Q=D(de,O);else if(D==="value"){Q=-1;for(var F=0;F<de.length;F++)if(de[F].value===O.activeLabel){Q=F;break}}var H=Me(Me({},pe),{},{x:pe.left,y:pe.top}),Z=Math.min(V,H.x+H.width),j=Math.min(X,H.y+H.height),$=de[Q]&&de[Q].value,q=gW(this.state,this.props.data,Q),ae=de[Q]?{x:T==="horizontal"?de[Q].coordinate:Z,y:T==="horizontal"?j:de[Q].coordinate}:pW;this.setState(Me(Me({},O),{},{activeLabel:$,activeCoordinate:ae,activePayload:q,activeTooltipIndex:Q}))}}},{key:"filterFormatItem",value:function(O,C,T){for(var D=this.state.formattedGraphicalItems,P=0,z=D.length;P<z;P++){var ne=D[P];if(ne.item===O||ne.props.key===O.key||C===Fo(ne.item.type)&&T===ne.childIndex)return ne}return null}},{key:"renderAxis",value:function(O,C,T,D){var P=this.props,z=P.width,ne=P.height;return ur.default.createElement(vp,Sp({},O,{className:"recharts-".concat(O.axisType," ").concat(O.axisType),key:C.key||"".concat(T,"-").concat(D),viewBox:{x:0,y:0,width:z,height:ne},ticksGenerator:this.axesTicksGenerator}))}},{key:"renderClipPath",value:function(){var O=this.clipPathId,C=this.state.offset,T=C.left,D=C.top,P=C.height,z=C.width;return ur.default.createElement("defs",null,ur.default.createElement("clipPath",{id:O},ur.default.createElement("rect",{x:T,y:D,height:P,width:z})))}},{key:"getXScales",value:function(){var O=this.state.xAxisMap;return O?Object.entries(O).reduce(function(C,T){var D=KH(T,2),P=D[0],z=D[1];return Me(Me({},C),{},vt({},P,z.scale))},{}):null}},{key:"getYScales",value:function(){var O=this.state.yAxisMap;return O?Object.entries(O).reduce(function(C,T){var D=KH(T,2),P=D[0],z=D[1];return Me(Me({},C),{},vt({},P,z.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(O){var C,T;return(C=this.state.xAxisMap)===null||C===void 0||(T=C[O])===null||T===void 0?void 0:T.scale}},{key:"getYScaleByAxisId",value:function(O){var C,T;return(C=this.state.yAxisMap)===null||C===void 0||(T=C[O])===null||T===void 0?void 0:T.scale}},{key:"getItemByXY",value:function(O){var C=this.state.formattedGraphicalItems;if(C&&C.length)for(var T=0,D=C.length;T<D;T++){var P=C[T],z=P.props,ne=P.item,V=Fo(ne.type);if(V==="Bar"){var X=(z.data||[]).find(function(ie){return cV(O,ie)});if(X)return{graphicalItem:P,payload:X}}else if(V==="RadialBar"){var Q=(z.data||[]).find(function(ie){return BC(O,ie)});if(Q)return{graphicalItem:P,payload:Q}}}return null}},{key:"render",value:function(){var O=this;if(!uO(this))return null;var C=this.props,T=C.children,D=C.className,P=C.width,z=C.height,ne=C.style,V=C.compact,X=C.title,Q=C.desc,ie=XH(C,dSe),pe=ht(ie),de={CartesianGrid:{handler:this.renderGrid,once:!0},ReferenceArea:{handler:this.renderReferenceElement},ReferenceLine:{handler:this.renderReferenceElement},ReferenceDot:{handler:this.renderReferenceElement},XAxis:{handler:this.renderXAxis},YAxis:{handler:this.renderYAxis},Brush:{handler:this.renderBrush,once:!0},Bar:{handler:this.renderGraphicChild},Line:{handler:this.renderGraphicChild},Area:{handler:this.renderGraphicChild},Radar:{handler:this.renderGraphicChild},RadialBar:{handler:this.renderGraphicChild},Scatter:{handler:this.renderGraphicChild},Pie:{handler:this.renderGraphicChild},Funnel:{handler:this.renderGraphicChild},Tooltip:{handler:this.renderCursor,once:!0},PolarGrid:{handler:this.renderPolarGrid,once:!0},PolarAngleAxis:{handler:this.renderPolarAxis},PolarRadiusAxis:{handler:this.renderPolarAxis},Customized:{handler:this.renderCustomized}};if(V)return ur.default.createElement(qg,Sp({},pe,{width:P,height:z,title:X,desc:Q}),this.renderClipPath(),dO(T,de));if(this.props.accessibilityLayer){var F,H;pe.tabIndex=(F=0)!==null&&F!==void 0?F:this.props.tabIndex,pe.role=(H="img")!==null&&H!==void 0?H:this.props.role,pe.onKeyDown=function(j){O.accessibilityManager.keyboardEvent(j)},pe.onFocus=function(){O.accessibilityManager.focus()}}var Z=this.parseEventsOfWrapper();return ur.default.createElement("div",Sp({className:(0,dW.default)("recharts-wrapper",D),style:Me({position:"relative",cursor:"default",width:P,height:z},ne)},Z,{ref:function($){O.container=$},role:"region"}),ur.default.createElement(qg,Sp({},pe,{width:P,height:z,title:X,desc:Q}),this.renderClipPath(),dO(T,de)),this.renderLegend(),this.renderTooltip())}}]),S}(ur.Component),vt(r,"displayName",n),vt(r,"defaultProps",Me({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),vt(r,"getDerivedStateFromProps",function(w,E){var S=w.data,A=w.children,O=w.width,C=w.height,T=w.layout,D=w.stackOffset,P=w.margin;if((0,Kr.default)(E.updateId)){var z=nW(w);return Me(Me(Me({},z),{},{updateId:0},_(Me(Me({props:w},z),{},{updateId:0}),E)),{},{prevData:S,prevWidth:O,prevHeight:C,prevLayout:T,prevStackOffset:D,prevMargin:P,prevChildren:A})}if(S!==E.prevData||O!==E.prevWidth||C!==E.prevHeight||T!==E.prevLayout||D!==E.prevStackOffset||!Cs(P,E.prevMargin)){var ne=nW(w),V={chartX:E.chartX,chartY:E.chartY,isTooltipActive:E.isTooltipActive},X=Me(Me({},rW(E,S,T)),{},{updateId:E.updateId+1}),Q=Me(Me(Me({},ne),V),X);return Me(Me(Me({},Q),_(Me({props:w},Q),E)),{},{prevData:S,prevWidth:O,prevHeight:C,prevLayout:T,prevStackOffset:D,prevMargin:P,prevChildren:A})}if(!fO(A,E.prevChildren)){var ie=!(0,Kr.default)(S),pe=ie?E.updateId:E.updateId+1;return Me(Me({updateId:pe},_(Me(Me({props:w},E),{},{updateId:pe}),E)),{},{prevChildren:A})}return null}),vt(r,"renderActiveDot",function(w,E){var S;return(0,ur.isValidElement)(w)?S=(0,ur.cloneElement)(w,E):(0,Wo.default)(w)?S=w(E):S=ur.default.createElement(cp,E),ur.default.createElement(tr,{className:"recharts-active-dot",key:E.key},S)}),r};var ET=xw({chartName:"LineChart",GraphicalChild:Hl,axisComponents:[{axisType:"xAxis",AxisComp:zs},{axisType:"yAxis",AxisComp:lo}],formatAxisMap:aw});var OT=xw({chartName:"BarChart",GraphicalChild:Vo,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:zs},{axisType:"yAxis",AxisComp:lo}],formatAxisMap:aw});var Wl=oe(mt(),1),MSe=[{name:"Jan",total:Math.floor(Math.random()*5e3)+1e3},{name:"Feb",total:Math.floor(Math.random()*5e3)+1e3},{name:"Mar",total:Math.floor(Math.random()*5e3)+1e3},{name:"Apr",total:Math.floor(Math.random()*5e3)+1e3},{name:"May",total:Math.floor(Math.random()*5e3)+1e3},{name:"Jun",total:Math.floor(Math.random()*5e3)+1e3},{name:"Jul",total:Math.floor(Math.random()*5e3)+1e3},{name:"Aug",total:Math.floor(Math.random()*5e3)+1e3},{name:"Sep",total:Math.floor(Math.random()*5e3)+1e3},{name:"Oct",total:Math.floor(Math.random()*5e3)+1e3},{name:"Nov",total:Math.floor(Math.random()*5e3)+1e3},{name:"Dec",total:Math.floor(Math.random()*5e3)+1e3}];function yW({toPlot:e=MSe}){return(0,Wl.jsx)(mI,{width:"100%",height:350,children:(0,Wl.jsxs)(OT,{data:e,children:[(0,Wl.jsx)(zs,{dataKey:"name",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,Wl.jsx)(lo,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:t=>t,domain:[-1,1]}),(0,Wl.jsx)(Vo,{dataKey:"total",children:e.map((t,r)=>(0,Wl.jsx)(jd,{fill:t.total<0?"#FF886D":"#adfa1d",strokeWidth:r===2?4:1},`cell-${r}`))})]})})}var kw=oe(He(),1);var ai=oe(He(),1);var mW="Avatar",[jSe,mze]=Qn(mW),[$Se,vW]=jSe(mW),USe=(0,ai.forwardRef)((e,t)=>{let{__scopeAvatar:r,...n}=e,[i,a]=(0,ai.useState)("idle");return(0,ai.createElement)($Se,{scope:r,imageLoadingStatus:i,onImageLoadingStatusChange:a},(0,ai.createElement)(Ot.span,Ge({},n,{ref:t})))}),zSe="AvatarImage",qSe=(0,ai.forwardRef)((e,t)=>{let{__scopeAvatar:r,src:n,onLoadingStatusChange:i=()=>{},...a}=e,o=vW(zSe,r),s=WSe(n),l=rn(c=>{i(c),o.onImageLoadingStatusChange(c)});return kn(()=>{s!=="idle"&&l(s)},[s,l]),s==="loaded"?(0,ai.createElement)(Ot.img,Ge({},a,{ref:t,src:n})):null}),VSe="AvatarFallback",HSe=(0,ai.forwardRef)((e,t)=>{let{__scopeAvatar:r,delayMs:n,...i}=e,a=vW(VSe,r),[o,s]=(0,ai.useState)(n===void 0);return(0,ai.useEffect)(()=>{if(n!==void 0){let l=window.setTimeout(()=>s(!0),n);return()=>window.clearTimeout(l)}},[n]),o&&a.imageLoadingStatus!=="loaded"?(0,ai.createElement)(Ot.span,Ge({},i,{ref:t})):null});function WSe(e){let[t,r]=(0,ai.useState)("idle");return(0,ai.useEffect)(()=>{if(!e){r("error");return}let n=!0,i=new window.Image,a=o=>()=>{n&&r(o)};return r("loading"),i.onload=a("loaded"),i.onerror=a("error"),i.src=e,()=>{n=!1}},[e]),t}var AT=USe,IT=qSe,CT=HSe;var Ew=oe(mt(),1),gm=kw.forwardRef(({className:e,...t},r)=>(0,Ew.jsx)(AT,{ref:r,className:Nt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));gm.displayName=AT.displayName;var ym=kw.forwardRef(({className:e,...t},r)=>(0,Ew.jsx)(IT,{ref:r,className:Nt("aspect-square h-full w-full",e),...t}));ym.displayName=IT.displayName;var mm=kw.forwardRef(({className:e,...t},r)=>(0,Ew.jsx)(CT,{ref:r,className:Nt("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));mm.displayName=CT.displayName;var co=oe(mt(),1);var GSe=({name:e,total:t})=>{let r=t.toFixed(2),n=r===0?r:Math.sign(r)===1?`+${r}`:r;return(0,co.jsxs)("div",{className:"flex items-center",children:[(0,co.jsxs)(gm,{className:"h-9 w-9",children:[(0,co.jsx)(ym,{src:"/app/assets/csgo.png",alt:"CSGO Logo"}),(0,co.jsx)(mm,{children:"GO"})]}),(0,co.jsxs)("div",{className:"ml-4 space-y-1",children:[(0,co.jsx)("p",{className:"text-sm font-medium leading-none",children:"CS:GO"}),(0,co.jsx)("p",{className:"text-sm text-muted-foreground",children:e})]}),(0,co.jsx)("div",{className:"ml-auto font-medium",children:n})]})};function bW({data:e=[]}){return(0,co.jsx)("div",{className:"space-y-8",children:e.slice(0,5).map(t=>GSe(t))})}var TT=oe(He(),1);var vm=oe(He());var _W={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};var YSe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Mt=(e,t)=>{let r=(0,vm.forwardRef)(({color:n="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:o,children:s,...l},c)=>(0,vm.createElement)("svg",{ref:c,..._W,width:i,height:i,stroke:n,strokeWidth:o?Number(a)*24/Number(i):a,className:`lucide lucide-${YSe(e)}`,...l},[...t.map(([f,u])=>(0,vm.createElement)(f,u)),...(Array.isArray(s)?s:[s])||[]]));return r.displayName=`${e}`,r};var bm=Mt("Activity",[["polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12",key:"xez52g"}]]);var _m=Mt("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);var Au=Mt("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]);var wm=Mt("ChevronDown",[["polyline",{points:"6 9 12 15 18 9",key:"1do0m2"}]]);var Sm=Mt("ChevronRight",[["polyline",{points:"9 18 15 12 9 6",key:"1rtp27"}]]);var xm=Mt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var Iu=Mt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var km=Mt("Dumbbell",[["path",{d:"m6.5 6.5 11 11",key:"f7oqzb"}],["path",{d:"m21 21-1-1",key:"cpc6if"}],["path",{d:"m3 3 1 1",key:"d3rpuf"}],["path",{d:"m18 22 4-4",key:"1e32o6"}],["path",{d:"m2 6 4-4",key:"189tqz"}],["path",{d:"m3 10 7-7",key:"1bxui2"}],["path",{d:"m14 21 7-7",key:"16x78n"}]]);var Em=Mt("Focus",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);var Om=Mt("Gamepad",[["line",{x1:"6",x2:"10",y1:"12",y2:"12",key:"161bw2"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"15",x2:"15.01",y1:"13",y2:"13",key:"dqpgro"}],["line",{x1:"18",x2:"18.01",y1:"11",y2:"11",key:"meh2c"}],["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]]);var Am=Mt("GlassWater",[["path",{d:"M15.2 22H8.8a2 2 0 0 1-2-1.79L5 3h14l-1.81 17.21A2 2 0 0 1 15.2 22Z",key:"48rfw3"}],["path",{d:"M6 12a5 5 0 0 1 6 0 5 5 0 0 0 6 0",key:"mjntcy"}]]);var Im=Mt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var Cm=Mt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var Tm=Mt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var Nm=Mt("PersonStanding",[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]]);var Lm=Mt("Power",[["path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0",key:"phirl6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"12",key:"aemgbe"}]]);var Pm=Mt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var Fm=Mt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var Jo=oe(mt(),1);function ua({name:e="Card",Icon:t=Iu,primaryState:r="",secondaryState:n="",onPrimaryUpdate:i=o=>o,onSecondaryUpdate:a=o=>o}){return(0,Jo.jsxs)(Jf,{children:[(0,Jo.jsxs)(Gf,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,Jo.jsx)(Yf,{className:"text-sm font-medium",children:e}),(0,Jo.jsx)(t,{className:"h-4 w-4 text-muted-foreground"})]}),(0,Jo.jsx)(KSe,{primaryState:r,secondaryState:n,onPrimaryUpdate:i,onSecondaryUpdate:a})]})}function KSe({primaryState:e="",secondaryState:t="",onPrimaryUpdate:r=i=>i,onSecondaryUpdate:n=i=>i}){let[i,a]=(0,TT.useState)(e?bE(e):{});if(e){let l=jc(e,c=>{Ag(e,l),a(c)})}let[o,s]=(0,TT.useState)(t?bE(t):{});if(t){let l=jc(t,c=>{Ag(e,l),s(c)})}return(0,Jo.jsxs)(Kf,{children:[(0,Jo.jsx)("div",{className:"text-2xl font-bold",children:i.value?r(i.value):"N/A"}),t?(0,Jo.jsx)("p",{className:"text-xs text-muted-foreground",children:o.value?n(o.value):"No additional information"}):""]})}var Go=oe(mt(),1);function NT(){return(0,Go.jsxs)(Go.Fragment,{children:[(0,Go.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,Go.jsx)(ua,{name:"Focus",Icon:Em,primaryState:"focus",onPrimaryUpdate:e=>`${e}%`}),(0,Go.jsx)(ua,{name:"Cognitive Load",Icon:km,primaryState:"cognitiveload",onPrimaryUpdate:e=>`${e}%`}),(0,Go.jsx)(ua,{name:"Mental Fatigue",Icon:Am,primaryState:"mentalfatigue",onPrimaryUpdate:e=>`${e}%`})]}),(0,Go.jsx)("br",{})]})}var LT=oe(mt(),1);function wW({className:e,...t}){let r=[{name:"Home",path:"/"},{name:"Devices",path:"/devices"},{name:"Hyper+",path:"/plus"}],n=ws();return(0,LT.jsx)("nav",{className:Nt("flex items-center space-x-4 lg:space-x-6",e),...t,children:r.map(i=>(0,LT.jsx)(SR,{to:i.path,className:`text-sm font-medium transition-colors hover:text-primary ${n.pathname===i.path?"":"text-muted-foreground"}`,children:i.name}))})}var EW=oe(He(),1);var SW=e=>typeof e=="boolean"?"".concat(e):e===0?"0":e,xW=kR,kW=(e,t)=>r=>{var n;if(t?.variants==null)return xW(e,r?.class,r?.className);let{variants:i,defaultVariants:a}=t,o=Object.keys(i).map(c=>{let f=r?.[c],u=a?.[c];if(f===null)return null;let h=SW(f)||SW(u);return i[c][h]}),s=r&&Object.entries(r).reduce((c,f)=>{let[u,h]=f;return h===void 0||(c[u]=h),c},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,f)=>{let{class:u,className:h,...g}=f;return Object.entries(g).every(_=>{let[w,E]=_;return Array.isArray(E)?E.includes({...a,...s}[w]):{...a,...s}[w]===E})?[...c,u,h]:c},[]);return xW(e,o,l,r?.class,r?.className)};var OW=oe(mt(),1),Op=kW("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),Cu=EW.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...i},a)=>(0,OW.jsx)(n?Ea:"button",{className:Nt(Op({variant:t,size:r,className:e})),ref:a,...i}));Cu.displayName="Button";var Vs=oe(He(),1);var Wt=oe(He(),1);var qe=oe(He(),1);var an=oe(He(),1);var AW=oe(He(),1);function IW(e,t=globalThis?.document){let r=rn(e);(0,AW.useEffect)(()=>{let n=i=>{i.key==="Escape"&&r(i)};return t.addEventListener("keydown",n),()=>t.removeEventListener("keydown",n)},[r,t])}var PT="dismissableLayer.update",XSe="dismissableLayer.pointerDownOutside",ZSe="dismissableLayer.focusOutside",CW,QSe=(0,an.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ow=(0,an.forwardRef)((e,t)=>{var r;let{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:s,onDismiss:l,...c}=e,f=(0,an.useContext)(QSe),[u,h]=(0,an.useState)(null),g=(r=u?.ownerDocument)!==null&&r!==void 0?r:globalThis?.document,[,_]=(0,an.useState)({}),w=lr(t,z=>h(z)),E=Array.from(f.layers),[S]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),A=E.indexOf(S),O=u?E.indexOf(u):-1,C=f.layersWithOutsidePointerEventsDisabled.size>0,T=O>=A,D=exe(z=>{let ne=z.target,V=[...f.branches].some(X=>X.contains(ne));!T||V||(a?.(z),s?.(z),z.defaultPrevented||l?.())},g),P=txe(z=>{let ne=z.target;[...f.branches].some(X=>X.contains(ne))||(o?.(z),s?.(z),z.defaultPrevented||l?.())},g);return IW(z=>{O===f.layers.size-1&&(i?.(z),!z.defaultPrevented&&l&&(z.preventDefault(),l()))},g),(0,an.useEffect)(()=>{if(u)return n&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(CW=g.body.style.pointerEvents,g.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(u)),f.layers.add(u),TW(),()=>{n&&f.layersWithOutsidePointerEventsDisabled.size===1&&(g.body.style.pointerEvents=CW)}},[u,g,n,f]),(0,an.useEffect)(()=>()=>{u&&(f.layers.delete(u),f.layersWithOutsidePointerEventsDisabled.delete(u),TW())},[u,f]),(0,an.useEffect)(()=>{let z=()=>_({});return document.addEventListener(PT,z),()=>document.removeEventListener(PT,z)},[]),(0,an.createElement)(Ot.div,Ge({},c,{ref:w,style:{pointerEvents:C?T?"auto":"none":void 0,...e.style},onFocusCapture:pt(e.onFocusCapture,P.onFocusCapture),onBlurCapture:pt(e.onBlurCapture,P.onBlurCapture),onPointerDownCapture:pt(e.onPointerDownCapture,D.onPointerDownCapture)}))});function exe(e,t=globalThis?.document){let r=rn(e),n=(0,an.useRef)(!1),i=(0,an.useRef)(()=>{});return(0,an.useEffect)(()=>{let a=s=>{if(s.target&&!n.current){let c=function(){NW(XSe,r,l,{discrete:!0})},l={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=c,t.addEventListener("click",i.current,{once:!0})):c()}n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",a),t.removeEventListener("click",i.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function txe(e,t=globalThis?.document){let r=rn(e),n=(0,an.useRef)(!1);return(0,an.useEffect)(()=>{let i=a=>{a.target&&!n.current&&NW(ZSe,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function TW(){let e=new CustomEvent(PT);document.dispatchEvent(e)}function NW(e,t,r,{discrete:n}){let i=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?T_(i,a):i.dispatchEvent(a)}var PW=oe(He(),1),FT=0;function Aw(){(0,PW.useEffect)(()=>{var e,t;let r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=r[0])!==null&&e!==void 0?e:LW()),document.body.insertAdjacentElement("beforeend",(t=r[1])!==null&&t!==void 0?t:LW()),FT++,()=>{FT===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),FT--}},[])}function LW(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var qi=oe(He(),1);var DT="focusScope.autoFocusOnMount",BT="focusScope.autoFocusOnUnmount",FW={bubbles:!1,cancelable:!0};var Iw=(0,qi.forwardRef)((e,t)=>{let{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:a,...o}=e,[s,l]=(0,qi.useState)(null),c=rn(i),f=rn(a),u=(0,qi.useRef)(null),h=lr(t,w=>l(w)),g=(0,qi.useRef)({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;(0,qi.useEffect)(()=>{if(n){let w=function(O){if(g.paused||!s)return;let C=O.target;s.contains(C)?u.current=C:Jl(u.current,{select:!0})},E=function(O){if(g.paused||!s)return;let C=O.relatedTarget;C!==null&&(s.contains(C)||Jl(u.current,{select:!0}))},S=function(O){let C=document.activeElement;for(let T of O)T.removedNodes.length>0&&(s!=null&&s.contains(C)||Jl(s))};document.addEventListener("focusin",w),document.addEventListener("focusout",E);let A=new MutationObserver(S);return s&&A.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",w),document.removeEventListener("focusout",E),A.disconnect()}}},[n,s,g.paused]),(0,qi.useEffect)(()=>{if(s){BW.add(g);let w=document.activeElement;if(!s.contains(w)){let S=new CustomEvent(DT,FW);s.addEventListener(DT,c),s.dispatchEvent(S),S.defaultPrevented||(rxe(sxe(MW(s)),{select:!0}),document.activeElement===w&&Jl(s))}return()=>{s.removeEventListener(DT,c),setTimeout(()=>{let S=new CustomEvent(BT,FW);s.addEventListener(BT,f),s.dispatchEvent(S),S.defaultPrevented||Jl(w??document.body,{select:!0}),s.removeEventListener(BT,f),BW.remove(g)},0)}}},[s,c,f,g]);let _=(0,qi.useCallback)(w=>{if(!r&&!n||g.paused)return;let E=w.key==="Tab"&&!w.altKey&&!w.ctrlKey&&!w.metaKey,S=document.activeElement;if(E&&S){let A=w.currentTarget,[O,C]=nxe(A);O&&C?!w.shiftKey&&S===C?(w.preventDefault(),r&&Jl(O,{select:!0})):w.shiftKey&&S===O&&(w.preventDefault(),r&&Jl(C,{select:!0})):S===A&&w.preventDefault()}},[r,n,g.paused]);return(0,qi.createElement)(Ot.div,Ge({tabIndex:-1},o,{ref:h,onKeyDown:_}))});function rxe(e,{select:t=!1}={}){let r=document.activeElement;for(let n of e)if(Jl(n,{select:t}),document.activeElement!==r)return}function nxe(e){let t=MW(e),r=DW(t,e),n=DW(t.reverse(),e);return[r,n]}function MW(e){let t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{let i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function DW(e,t){for(let r of e)if(!ixe(r,{upTo:t}))return r}function ixe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function axe(e){return e instanceof HTMLInputElement&&"select"in e}function Jl(e,{select:t=!1}={}){if(e&&e.focus){let r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&axe(e)&&t&&e.select()}}var BW=oxe();function oxe(){let e=[];return{add(t){let r=e[0];t!==r&&r?.pause(),e=RW(e,t),e.unshift(t)},remove(t){var r;e=RW(e,t),(r=e[0])===null||r===void 0||r.resume()}}}function RW(e,t){let r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function sxe(e){return e.filter(t=>t.tagName!=="A")}var Nn=oe(He(),1);function Ap(e){return e.split("-")[1]}function $T(e){return e==="y"?"height":"width"}function qs(e){return e.split("-")[0]}function Lu(e){return["top","bottom"].includes(qs(e))?"x":"y"}function jW(e,t,r){let{reference:n,floating:i}=e,a=n.x+n.width/2-i.width/2,o=n.y+n.height/2-i.height/2,s=Lu(t),l=$T(s),c=n[l]/2-i[l]/2,f=s==="x",u;switch(qs(t)){case"top":u={x:a,y:n.y-i.height};break;case"bottom":u={x:a,y:n.y+n.height};break;case"right":u={x:n.x+n.width,y:o};break;case"left":u={x:n.x-i.width,y:o};break;default:u={x:n.x,y:n.y}}switch(Ap(t)){case"start":u[s]-=c*(r&&f?-1:1);break;case"end":u[s]+=c*(r&&f?-1:1)}return u}var zW=async(e,t,r)=>{let{placement:n="bottom",strategy:i="absolute",middleware:a=[],platform:o}=r,s=a.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(t)),c=await o.getElementRects({reference:e,floating:t,strategy:i}),{x:f,y:u}=jW(c,n,l),h=n,g={},_=0;for(let w=0;w<s.length;w++){let{name:E,fn:S}=s[w],{x:A,y:O,data:C,reset:T}=await S({x:f,y:u,initialPlacement:n,placement:h,strategy:i,middlewareData:g,rects:c,platform:o,elements:{reference:e,floating:t}});f=A??f,u=O??u,g={...g,[E]:{...g[E],...C}},T&&_<=50&&(_++,typeof T=="object"&&(T.placement&&(h=T.placement),T.rects&&(c=T.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:i}):T.rects),{x:f,y:u}=jW(c,h,l)),w=-1)}return{x:f,y:u,placement:h,strategy:i,middlewareData:g}};function qW(e){return typeof e!="number"?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(e):{top:e,right:e,bottom:e,left:e}}function Dm(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function Nu(e,t){var r;t===void 0&&(t={});let{x:n,y:i,platform:a,rects:o,elements:s,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:f="viewport",elementContext:u="floating",altBoundary:h=!1,padding:g=0}=t,_=qW(g),w=s[h?u==="floating"?"reference":"floating":u],E=Dm(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(w)))==null||r?w:w.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(s.floating)),boundary:c,rootBoundary:f,strategy:l})),S=u==="floating"?{...o.floating,x:n,y:i}:o.reference,A=await(a.getOffsetParent==null?void 0:a.getOffsetParent(s.floating)),O=await(a.isElement==null?void 0:a.isElement(A))&&await(a.getScale==null?void 0:a.getScale(A))||{x:1,y:1},C=Dm(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({rect:S,offsetParent:A,strategy:l}):S);return{top:(E.top-C.top+_.top)/O.y,bottom:(C.bottom-E.bottom+_.bottom)/O.y,left:(E.left-C.left+_.left)/O.x,right:(C.right-E.right+_.right)/O.x}}var MT=Math.min,Tu=Math.max;function jT(e,t,r){return Tu(e,MT(t,r))}var Tw=e=>({name:"arrow",options:e,async fn(t){let{element:r,padding:n=0}=e||{},{x:i,y:a,placement:o,rects:s,platform:l,elements:c}=t;if(r==null)return{};let f=qW(n),u={x:i,y:a},h=Lu(o),g=$T(h),_=await l.getDimensions(r),w=h==="y",E=w?"top":"left",S=w?"bottom":"right",A=w?"clientHeight":"clientWidth",O=s.reference[g]+s.reference[h]-u[h]-s.floating[g],C=u[h]-s.reference[h],T=await(l.getOffsetParent==null?void 0:l.getOffsetParent(r)),D=T?T[A]:0;D&&await(l.isElement==null?void 0:l.isElement(T))||(D=c.floating[A]||s.floating[g]);let P=O/2-C/2,z=f[E],ne=D-_[g]-f[S],V=D/2-_[g]/2+P,X=jT(z,V,ne),Q=Ap(o)!=null&&V!=X&&s.reference[g]/2-(V<z?f[E]:f[S])-_[g]/2<0;return{[h]:u[h]-(Q?V<z?z-V:ne-V:0),data:{[h]:X,centerOffset:V-X}}}}),VW=["top","right","bottom","left"],nqe=VW.reduce((e,t)=>e.concat(t,t+"-start",t+"-end"),[]),lxe={left:"right",right:"left",bottom:"top",top:"bottom"};function Cw(e){return e.replace(/left|right|bottom|top/g,t=>lxe[t])}function cxe(e,t,r){r===void 0&&(r=!1);let n=Ap(e),i=Lu(e),a=$T(i),o=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(o=Cw(o)),{main:o,cross:Cw(o)}}var uxe={start:"end",end:"start"};function RT(e){return e.replace(/start|end/g,t=>uxe[t])}var Nw=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r;let{placement:n,middlewareData:i,rects:a,initialPlacement:o,platform:s,elements:l}=t,{mainAxis:c=!0,crossAxis:f=!0,fallbackPlacements:u,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:_=!0,...w}=e,E=qs(n),S=qs(o)===o,A=await(s.isRTL==null?void 0:s.isRTL(l.floating)),O=u||(S||!_?[Cw(o)]:function(X){let Q=Cw(X);return[RT(X),Q,RT(Q)]}(o));u||g==="none"||O.push(...function(X,Q,ie,pe){let de=Ap(X),F=function(H,Z,j){let $=["left","right"],q=["right","left"],ae=["top","bottom"],le=["bottom","top"];switch(H){case"top":case"bottom":return j?Z?q:$:Z?$:q;case"left":case"right":return Z?ae:le;default:return[]}}(qs(X),ie==="start",pe);return de&&(F=F.map(H=>H+"-"+de),Q&&(F=F.concat(F.map(RT)))),F}(o,_,g,A));let C=[o,...O],T=await Nu(t,w),D=[],P=((r=i.flip)==null?void 0:r.overflows)||[];if(c&&D.push(T[E]),f){let{main:X,cross:Q}=cxe(n,a,A);D.push(T[X],T[Q])}if(P=[...P,{placement:n,overflows:D}],!D.every(X=>X<=0)){var z,ne;let X=(((z=i.flip)==null?void 0:z.index)||0)+1,Q=C[X];if(Q)return{data:{index:X,overflows:P},reset:{placement:Q}};let ie=(ne=P.filter(pe=>pe.overflows[0]<=0).sort((pe,de)=>pe.overflows[1]-de.overflows[1])[0])==null?void 0:ne.placement;if(!ie)switch(h){case"bestFit":{var V;let pe=(V=P.map(de=>[de.placement,de.overflows.filter(F=>F>0).reduce((F,H)=>F+H,0)]).sort((de,F)=>de[1]-F[1])[0])==null?void 0:V[0];pe&&(ie=pe);break}case"initialPlacement":ie=o}if(n!==ie)return{reset:{placement:ie}}}return{}}}};function $W(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function UW(e){return VW.some(t=>e[t]>=0)}var Lw=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){let{strategy:r="referenceHidden",...n}=e,{rects:i}=t;switch(r){case"referenceHidden":{let a=$W(await Nu(t,{...n,elementContext:"reference"}),i.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:UW(a)}}}case"escaped":{let a=$W(await Nu(t,{...n,altBoundary:!0}),i.floating);return{data:{escapedOffsets:a,escaped:UW(a)}}}default:return{}}}}};var Pw=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){let{x:r,y:n}=t,i=await async function(a,o){let{placement:s,platform:l,elements:c}=a,f=await(l.isRTL==null?void 0:l.isRTL(c.floating)),u=qs(s),h=Ap(s),g=Lu(s)==="x",_=["left","top"].includes(u)?-1:1,w=f&&g?-1:1,E=typeof o=="function"?o(a):o,{mainAxis:S,crossAxis:A,alignmentAxis:O}=typeof E=="number"?{mainAxis:E,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...E};return h&&typeof O=="number"&&(A=h==="end"?-1*O:O),g?{x:A*w,y:S*_}:{x:S*_,y:A*w}}(t,e);return{x:r+i.x,y:n+i.y,data:i}}}};function HW(e){return e==="x"?"y":"x"}var Fw=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){let{x:r,y:n,placement:i}=t,{mainAxis:a=!0,crossAxis:o=!1,limiter:s={fn:E=>{let{x:S,y:A}=E;return{x:S,y:A}}},...l}=e,c={x:r,y:n},f=await Nu(t,l),u=Lu(qs(i)),h=HW(u),g=c[u],_=c[h];if(a){let E=u==="y"?"bottom":"right";g=jT(g+f[u==="y"?"top":"left"],g,g-f[E])}if(o){let E=h==="y"?"bottom":"right";_=jT(_+f[h==="y"?"top":"left"],_,_-f[E])}let w=s.fn({...t,[u]:g,[h]:_});return{...w,data:{x:w.x-r,y:w.y-n}}}}},Dw=function(e){return e===void 0&&(e={}),{options:e,fn(t){let{x:r,y:n,placement:i,rects:a,middlewareData:o}=t,{offset:s=0,mainAxis:l=!0,crossAxis:c=!0}=e,f={x:r,y:n},u=Lu(i),h=HW(u),g=f[u],_=f[h],w=typeof s=="function"?s(t):s,E=typeof w=="number"?{mainAxis:w,crossAxis:0}:{mainAxis:0,crossAxis:0,...w};if(l){let O=u==="y"?"height":"width",C=a.reference[u]-a.floating[O]+E.mainAxis,T=a.reference[u]+a.reference[O]-E.mainAxis;g<C?g=C:g>T&&(g=T)}if(c){var S,A;let O=u==="y"?"width":"height",C=["top","left"].includes(qs(i)),T=a.reference[h]-a.floating[O]+(C&&((S=o.offset)==null?void 0:S[h])||0)+(C?0:E.crossAxis),D=a.reference[h]+a.reference[O]+(C?0:((A=o.offset)==null?void 0:A[h])||0)-(C?E.crossAxis:0);_<T?_=T:_>D&&(_=D)}return{[u]:g,[h]:_}}}},Bw=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){let{placement:r,rects:n,platform:i,elements:a}=t,{apply:o=()=>{},...s}=e,l=await Nu(t,s),c=qs(r),f=Ap(r),u=Lu(r)==="x",{width:h,height:g}=n.floating,_,w;c==="top"||c==="bottom"?(_=c,w=f===(await(i.isRTL==null?void 0:i.isRTL(a.floating))?"start":"end")?"left":"right"):(w=c,_=f==="end"?"top":"bottom");let E=g-l[_],S=h-l[w],A=!t.middlewareData.shift,O=E,C=S;if(u){let D=h-l.left-l.right;C=f||A?MT(S,D):D}else{let D=g-l.top-l.bottom;O=f||A?MT(E,D):D}if(A&&!f){let D=Tu(l.left,0),P=Tu(l.right,0),z=Tu(l.top,0),ne=Tu(l.bottom,0);u?C=h-2*(D!==0||P!==0?D+P:Tu(l.left,l.right)):O=g-2*(z!==0||ne!==0?z+ne:Tu(l.top,l.bottom))}await o({...t,availableWidth:C,availableHeight:O});let T=await i.getDimensions(a.floating);return h!==T.width||g!==T.height?{reset:{rects:!0}}:{}}}};function Ra(e){var t;return((t=e.ownerDocument)==null?void 0:t.defaultView)||window}function uo(e){return Ra(e).getComputedStyle(e)}function ZW(e){return e instanceof Ra(e).Node}function Yl(e){return ZW(e)?(e.nodeName||"").toLowerCase():""}function fo(e){return e instanceof Ra(e).HTMLElement}function fa(e){return e instanceof Ra(e).Element}function WW(e){return typeof ShadowRoot>"u"?!1:e instanceof Ra(e).ShadowRoot||e instanceof ShadowRoot}function Rm(e){let{overflow:t,overflowX:r,overflowY:n,display:i}=uo(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(i)}function pxe(e){return["table","td","th"].includes(Yl(e))}function UT(e){let t=zT(),r=uo(e);return r.transform!=="none"||r.perspective!=="none"||!t&&!!r.backdropFilter&&r.backdropFilter!=="none"||!t&&!!r.filter&&r.filter!=="none"||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function zT(){return!(typeof CSS>"u"||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function Mw(e){return["html","body","#document"].includes(Yl(e))}var JW=Math.min,Bm=Math.max,Rw=Math.round;function QW(e){let t=uo(e),r=parseFloat(t.width)||0,n=parseFloat(t.height)||0,i=fo(e),a=i?e.offsetWidth:r,o=i?e.offsetHeight:n,s=Rw(r)!==a||Rw(n)!==o;return s&&(r=a,n=o),{width:r,height:n,fallback:s}}function eJ(e){return fa(e)?e:e.contextElement}var tJ={x:1,y:1};function Ip(e){let t=eJ(e);if(!fo(t))return tJ;let r=t.getBoundingClientRect(),{width:n,height:i,fallback:a}=QW(t),o=(a?Rw(r.width):r.width)/n,s=(a?Rw(r.height):r.height)/i;return o&&Number.isFinite(o)||(o=1),s&&Number.isFinite(s)||(s=1),{x:o,y:s}}var GW={x:0,y:0};function rJ(e,t,r){var n,i;if(t===void 0&&(t=!0),!zT())return GW;let a=e?Ra(e):window;return!r||t&&r!==a?GW:{x:((n=a.visualViewport)==null?void 0:n.offsetLeft)||0,y:((i=a.visualViewport)==null?void 0:i.offsetTop)||0}}function Pu(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);let i=e.getBoundingClientRect(),a=eJ(e),o=tJ;t&&(n?fa(n)&&(o=Ip(n)):o=Ip(e));let s=rJ(a,r,n),l=(i.left+s.x)/o.x,c=(i.top+s.y)/o.y,f=i.width/o.x,u=i.height/o.y;if(a){let h=Ra(a),g=n&&fa(n)?Ra(n):n,_=h.frameElement;for(;_&&n&&g!==h;){let w=Ip(_),E=_.getBoundingClientRect(),S=getComputedStyle(_);E.x+=(_.clientLeft+parseFloat(S.paddingLeft))*w.x,E.y+=(_.clientTop+parseFloat(S.paddingTop))*w.y,l*=w.x,c*=w.y,f*=w.x,u*=w.y,l+=E.x,c+=E.y,_=Ra(_).frameElement}}return Dm({width:f,height:u,x:l,y:c})}function Gl(e){return((ZW(e)?e.ownerDocument:e.document)||window.document).documentElement}function jw(e){return fa(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function nJ(e){return Pu(Gl(e)).left+jw(e).scrollLeft}function Tp(e){if(Yl(e)==="html")return e;let t=e.assignedSlot||e.parentNode||WW(e)&&e.host||Gl(e);return WW(t)?t.host:t}function iJ(e){let t=Tp(e);return Mw(t)?t.ownerDocument.body:fo(t)&&Rm(t)?t:iJ(t)}function Cp(e,t){var r;t===void 0&&(t=[]);let n=iJ(e),i=n===((r=e.ownerDocument)==null?void 0:r.body),a=Ra(n);return i?t.concat(a,a.visualViewport||[],Rm(n)?n:[]):t.concat(n,Cp(n))}function YW(e,t,r){let n;if(t==="viewport")n=function(i,a){let o=Ra(i),s=Gl(i),l=o.visualViewport,c=s.clientWidth,f=s.clientHeight,u=0,h=0;if(l){c=l.width,f=l.height;let g=zT();(!g||g&&a==="fixed")&&(u=l.offsetLeft,h=l.offsetTop)}return{width:c,height:f,x:u,y:h}}(e,r);else if(t==="document")n=function(i){let a=Gl(i),o=jw(i),s=i.ownerDocument.body,l=Bm(a.scrollWidth,a.clientWidth,s.scrollWidth,s.clientWidth),c=Bm(a.scrollHeight,a.clientHeight,s.scrollHeight,s.clientHeight),f=-o.scrollLeft+nJ(i),u=-o.scrollTop;return uo(s).direction==="rtl"&&(f+=Bm(a.clientWidth,s.clientWidth)-l),{width:l,height:c,x:f,y:u}}(Gl(e));else if(fa(t))n=function(i,a){let o=Pu(i,!0,a==="fixed"),s=o.top+i.clientTop,l=o.left+i.clientLeft,c=fo(i)?Ip(i):{x:1,y:1};return{width:i.clientWidth*c.x,height:i.clientHeight*c.y,x:l*c.x,y:s*c.y}}(t,r);else{let i=rJ(e);n={...t,x:t.x-i.x,y:t.y-i.y}}return Dm(n)}function aJ(e,t){let r=Tp(e);return!(r===t||!fa(r)||Mw(r))&&(uo(r).position==="fixed"||aJ(r,t))}function KW(e,t){return fo(e)&&uo(e).position!=="fixed"?t?t(e):e.offsetParent:null}function XW(e,t){let r=Ra(e);if(!fo(e))return r;let n=KW(e,t);for(;n&&pxe(n)&&uo(n).position==="static";)n=KW(n,t);return n&&(Yl(n)==="html"||Yl(n)==="body"&&uo(n).position==="static"&&!UT(n))?r:n||function(i){let a=Tp(i);for(;fo(a)&&!Mw(a);){if(UT(a))return a;a=Tp(a)}return null}(e)||r}function hxe(e,t,r){let n=fo(t),i=Gl(t),a=r==="fixed",o=Pu(e,!0,a,t),s={scrollLeft:0,scrollTop:0},l={x:0,y:0};if(n||!n&&!a)if((Yl(t)!=="body"||Rm(i))&&(s=jw(t)),fo(t)){let c=Pu(t,!0,a,t);l.x=c.x+t.clientLeft,l.y=c.y+t.clientTop}else i&&(l.x=nJ(i));return{x:o.left+s.scrollLeft-l.x,y:o.top+s.scrollTop-l.y,width:o.width,height:o.height}}var oJ={getClippingRect:function(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e,a=r==="clippingAncestors"?function(c,f){let u=f.get(c);if(u)return u;let h=Cp(c).filter(E=>fa(E)&&Yl(E)!=="body"),g=null,_=uo(c).position==="fixed",w=_?Tp(c):c;for(;fa(w)&&!Mw(w);){let E=uo(w),S=UT(w);S||E.position!=="fixed"||(g=null),(_?!S&&!g:!S&&E.position==="static"&&g&&["absolute","fixed"].includes(g.position)||Rm(w)&&!S&&aJ(c,w))?h=h.filter(A=>A!==w):g=E,w=Tp(w)}return f.set(c,h),h}(t,this._c):[].concat(r),o=[...a,n],s=o[0],l=o.reduce((c,f)=>{let u=YW(t,f,i);return c.top=Bm(u.top,c.top),c.right=JW(u.right,c.right),c.bottom=JW(u.bottom,c.bottom),c.left=Bm(u.left,c.left),c},YW(t,s,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:r,strategy:n}=e,i=fo(r),a=Gl(r);if(r===a)return t;let o={scrollLeft:0,scrollTop:0},s={x:1,y:1},l={x:0,y:0};if((i||!i&&n!=="fixed")&&((Yl(r)!=="body"||Rm(a))&&(o=jw(r)),fo(r))){let c=Pu(r);s=Ip(r),l.x=c.x+r.clientLeft,l.y=c.y+r.clientTop}return{width:t.width*s.x,height:t.height*s.y,x:t.x*s.x-o.scrollLeft*s.x+l.x,y:t.y*s.y-o.scrollTop*s.y+l.y}},isElement:fa,getDimensions:function(e){return QW(e)},getOffsetParent:XW,getDocumentElement:Gl,getScale:Ip,async getElementRects(e){let{reference:t,floating:r,strategy:n}=e,i=this.getOffsetParent||XW,a=this.getDimensions;return{reference:hxe(t,await i(r),n),floating:{x:0,y:0,...await a(r)}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>uo(e).direction==="rtl"};function qT(e,t,r,n){n===void 0&&(n={});let{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:o=!0,animationFrame:s=!1}=n,l=i||a?[...fa(e)?Cp(e):e.contextElement?Cp(e.contextElement):[],...Cp(t)]:[];l.forEach(h=>{let g=!fa(h)&&h.toString().includes("V");!i||s&&!g||h.addEventListener("scroll",r,{passive:!0}),a&&h.addEventListener("resize",r)});let c,f=null;o&&(f=new ResizeObserver(()=>{r()}),fa(e)&&!s&&f.observe(e),fa(e)||!e.contextElement||s||f.observe(e.contextElement),f.observe(t));let u=s?Pu(e):null;return s&&function h(){let g=Pu(e);!u||g.x===u.x&&g.y===u.y&&g.width===u.width&&g.height===u.height||r(),u=g,c=requestAnimationFrame(h)}(),r(),()=>{var h;l.forEach(g=>{i&&g.removeEventListener("scroll",r),a&&g.removeEventListener("resize",r)}),(h=f)==null||h.disconnect(),f=null,s&&cancelAnimationFrame(c)}}var VT=(e,t,r)=>{let n=new Map,i={platform:oJ,...r},a={...i.platform,_c:n};return zW(e,t,{...i,platform:a})};var gn=oe(He()),zw=oe(He()),cJ=oe(Io()),uJ=e=>{let{element:t,padding:r}=e;function n(i){return{}.hasOwnProperty.call(i,"current")}return{name:"arrow",options:e,fn(i){return t&&n(t)?t.current!=null?Tw({element:t.current,padding:r}).fn(i):{}:t?Tw({element:t,padding:r}).fn(i):{}}}},$w=typeof document<"u"?zw.useLayoutEffect:zw.useEffect;function Uw(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!Uw(e[n],t[n]))return!1;return!0}if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){let a=i[n];if(!(a==="_owner"&&e.$$typeof)&&!Uw(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function fJ(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function sJ(e,t){let r=fJ(e);return Math.round(t*r)/r}function lJ(e){let t=gn.useRef(e);return $w(()=>{t.current=e}),t}function dJ(e){e===void 0&&(e={});let{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:a,floating:o}={},transform:s=!0,whileElementsMounted:l,open:c}=e,[f,u]=gn.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,g]=gn.useState(n);Uw(h,n)||g(n);let[_,w]=gn.useState(null),[E,S]=gn.useState(null),A=gn.useCallback(F=>{F!=D.current&&(D.current=F,w(F))},[w]),O=gn.useCallback(F=>{F!==P.current&&(P.current=F,S(F))},[S]),C=a||_,T=o||E,D=gn.useRef(null),P=gn.useRef(null),z=gn.useRef(f),ne=lJ(l),V=lJ(i),X=gn.useCallback(()=>{if(!D.current||!P.current)return;let F={placement:t,strategy:r,middleware:h};V.current&&(F.platform=V.current),VT(D.current,P.current,F).then(H=>{let Z={...H,isPositioned:!0};Q.current&&!Uw(z.current,Z)&&(z.current=Z,cJ.flushSync(()=>{u(Z)}))})},[h,t,r,V]);$w(()=>{c===!1&&z.current.isPositioned&&(z.current.isPositioned=!1,u(F=>({...F,isPositioned:!1})))},[c]);let Q=gn.useRef(!1);$w(()=>(Q.current=!0,()=>{Q.current=!1}),[]),$w(()=>{if(C&&(D.current=C),T&&(P.current=T),C&&T){if(ne.current)return ne.current(C,T,X);X()}},[C,T,X,ne]);let ie=gn.useMemo(()=>({reference:D,floating:P,setReference:A,setFloating:O}),[A,O]),pe=gn.useMemo(()=>({reference:C,floating:T}),[C,T]),de=gn.useMemo(()=>{let F={position:r,left:0,top:0};if(!pe.floating)return F;let H=sJ(pe.floating,f.x),Z=sJ(pe.floating,f.y);return s?{...F,transform:"translate("+H+"px, "+Z+"px)",...fJ(pe.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:H,top:Z}},[r,s,pe.floating,f.x,f.y]);return gn.useMemo(()=>({...f,update:X,refs:ie,elements:pe,floatingStyles:de}),[f,X,ie,pe,de])}var pJ=oe(He(),1);function hJ(e){let[t,r]=(0,pJ.useState)(void 0);return kn(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;let a=i[0],o,s;if("borderBoxSize"in a){let l=a.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,s=c.blockSize}else o=e.offsetWidth,s=e.offsetHeight;r({width:o,height:s})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var gJ="Popper",[yJ,Np]=Qn(gJ),[gxe,mJ]=yJ(gJ),yxe=e=>{let{__scopePopper:t,children:r}=e,[n,i]=(0,Nn.useState)(null);return(0,Nn.createElement)(gxe,{scope:t,anchor:n,onAnchorChange:i},r)},mxe="PopperAnchor",vxe=(0,Nn.forwardRef)((e,t)=>{let{__scopePopper:r,virtualRef:n,...i}=e,a=mJ(mxe,r),o=(0,Nn.useRef)(null),s=lr(t,o);return(0,Nn.useEffect)(()=>{a.onAnchorChange(n?.current||o.current)}),n?null:(0,Nn.createElement)(Ot.div,Ge({},i,{ref:s}))}),vJ="PopperContent",[bxe,wqe]=yJ(vJ),_xe=(0,Nn.forwardRef)((e,t)=>{var r,n,i,a,o,s,l,c;let{__scopePopper:f,side:u="bottom",sideOffset:h=0,align:g="center",alignOffset:_=0,arrowPadding:w=0,collisionBoundary:E=[],collisionPadding:S=0,sticky:A="partial",hideWhenDetached:O=!1,avoidCollisions:C=!0,onPlaced:T,...D}=e,P=mJ(vJ,f),[z,ne]=(0,Nn.useState)(null),V=lr(t,Te=>ne(Te)),[X,Q]=(0,Nn.useState)(null),ie=hJ(X),pe=(r=ie?.width)!==null&&r!==void 0?r:0,de=(n=ie?.height)!==null&&n!==void 0?n:0,F=u+(g!=="center"?"-"+g:""),H=typeof S=="number"?S:{top:0,right:0,bottom:0,left:0,...S},Z=Array.isArray(E)?E:[E],j=Z.length>0,$={padding:H,boundary:Z.filter(wxe),altBoundary:j},{refs:q,floatingStyles:ae,placement:le,isPositioned:fe,middlewareData:Se}=dJ({strategy:"fixed",placement:F,whileElementsMounted:qT,elements:{reference:P.anchor},middleware:[Pw({mainAxis:h+de,alignmentAxis:_}),C&&Fw({mainAxis:!0,crossAxis:!1,limiter:A==="partial"?Dw():void 0,...$}),C&&Nw({...$}),Bw({...$,apply:({elements:Te,rects:Ie,availableWidth:Ye,availableHeight:Ke})=>{let{width:St,height:_t}=Ie.reference,ft=Te.floating.style;ft.setProperty("--radix-popper-available-width",`${Ye}px`),ft.setProperty("--radix-popper-available-height",`${Ke}px`),ft.setProperty("--radix-popper-anchor-width",`${St}px`),ft.setProperty("--radix-popper-anchor-height",`${_t}px`)}}),X&&uJ({element:X,padding:w}),Sxe({arrowWidth:pe,arrowHeight:de}),O&&Lw({strategy:"referenceHidden"})]}),[ke,xe]=bJ(le),se=rn(T);kn(()=>{fe&&se?.()},[fe,se]);let be=(i=Se.arrow)===null||i===void 0?void 0:i.x,W=(a=Se.arrow)===null||a===void 0?void 0:a.y,J=((o=Se.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,[re,Ee]=(0,Nn.useState)();return kn(()=>{z&&Ee(window.getComputedStyle(z).zIndex)},[z]),(0,Nn.createElement)("div",{ref:q.setFloating,"data-radix-popper-content-wrapper":"",style:{...ae,transform:fe?ae.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,["--radix-popper-transform-origin"]:[(s=Se.transformOrigin)===null||s===void 0?void 0:s.x,(l=Se.transformOrigin)===null||l===void 0?void 0:l.y].join(" ")},dir:e.dir},(0,Nn.createElement)(bxe,{scope:f,placedSide:ke,onArrowChange:Q,arrowX:be,arrowY:W,shouldHideArrow:J},(0,Nn.createElement)(Ot.div,Ge({"data-side":ke,"data-align":xe},D,{ref:V,style:{...D.style,animation:fe?void 0:"none",opacity:(c=Se.hide)!==null&&c!==void 0&&c.referenceHidden?0:void 0}}))))});function wxe(e){return e!==null}var Sxe=e=>({name:"transformOrigin",options:e,fn(t){var r,n,i,a,o;let{placement:s,rects:l,middlewareData:c}=t,u=((r=c.arrow)===null||r===void 0?void 0:r.centerOffset)!==0,h=u?0:e.arrowWidth,g=u?0:e.arrowHeight,[_,w]=bJ(s),E={start:"0%",center:"50%",end:"100%"}[w],S=((n=(i=c.arrow)===null||i===void 0?void 0:i.x)!==null&&n!==void 0?n:0)+h/2,A=((a=(o=c.arrow)===null||o===void 0?void 0:o.y)!==null&&a!==void 0?a:0)+g/2,O="",C="";return _==="bottom"?(O=u?E:`${S}px`,C=`${-g}px`):_==="top"?(O=u?E:`${S}px`,C=`${l.floating.height+g}px`):_==="right"?(O=`${-g}px`,C=u?E:`${A}px`):_==="left"&&(O=`${l.floating.width+g}px`,C=u?E:`${A}px`),{data:{x:O,y:C}}}});function bJ(e){let[t,r="center"]=e.split("-");return[t,r]}var qw=yxe,Vw=vxe,Hw=_xe;var Ww=oe(He(),1),_J=oe(Io(),1);var Jw=(0,Ww.forwardRef)((e,t)=>{var r;let{container:n=globalThis==null||(r=globalThis.document)===null||r===void 0?void 0:r.body,...i}=e;return n?_J.default.createPortal((0,Ww.createElement)(Ot.div,Ge({},i,{ref:t})),n):null});var xxe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Lp=new WeakMap,Gw=new WeakMap,Yw={},HT=0,wJ=function(e){return e&&(e.host||wJ(e.parentNode))},kxe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=wJ(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Exe=function(e,t,r,n){var i=kxe(t,Array.isArray(e)?e:[e]);Yw[r]||(Yw[r]=new WeakMap);var a=Yw[r],o=[],s=new Set,l=new Set(i),c=function(u){!u||s.has(u)||(s.add(u),c(u.parentNode))};i.forEach(c);var f=function(u){!u||l.has(u)||Array.prototype.forEach.call(u.children,function(h){if(s.has(h))f(h);else{var g=h.getAttribute(n),_=g!==null&&g!=="false",w=(Lp.get(h)||0)+1,E=(a.get(h)||0)+1;Lp.set(h,w),a.set(h,E),o.push(h),w===1&&_&&Gw.set(h,!0),E===1&&h.setAttribute(r,"true"),_||h.setAttribute(n,"true")}})};return f(t),s.clear(),HT++,function(){o.forEach(function(u){var h=Lp.get(u)-1,g=a.get(u)-1;Lp.set(u,h),a.set(u,g),h||(Gw.has(u)||u.removeAttribute(n),Gw.delete(u)),g||u.removeAttribute(r)}),HT--,HT||(Lp=new WeakMap,Lp=new WeakMap,Gw=new WeakMap,Yw={})}},Kw=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),i=t||xxe(e);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live]"))),Exe(n,i,r,"aria-hidden")):function(){return null}};var Vi=function(){return Vi=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Vi.apply(this,arguments)};function Xw(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function SJ(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var t1=oe(He());var oi=oe(He());var Fu="right-scroll-bar-position",Du="width-before-scroll-bar",WT="with-scroll-bars-hidden",JT="--removed-body-scroll-bar-size";function xJ(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}var kJ=oe(He());function EJ(e,t){var r=(0,kJ.useState)(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=t,r.facade}function GT(e,t){return EJ(t||null,function(r){return e.forEach(function(n){return xJ(n,r)})})}function Oxe(e){return e}function Axe(e,t){t===void 0&&(t=Oxe);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(a){var o=t(a,n);return r.push(o),function(){r=r.filter(function(s){return s!==o})}},assignSyncMedium:function(a){for(n=!0;r.length;){var o=r;r=[],o.forEach(a)}r={push:function(s){return a(s)},filter:function(){return r}}},assignMedium:function(a){n=!0;var o=[];if(r.length){var s=r;r=[],s.forEach(a),o=r}var l=function(){var f=o;o=[],f.forEach(a)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(f){o.push(f),c()},filter:function(f){return o=o.filter(f),r}}}};return i}function YT(e){e===void 0&&(e={});var t=Axe(null);return t.options=Vi({async:!0,ssr:!1},e),t}var OJ=oe(He()),AJ=function(e){var t=e.sideCar,r=Xw(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return OJ.createElement(n,Vi({},r))};AJ.isSideCarExport=!0;function KT(e,t){return e.useMedium(t),AJ}var Zw=YT();var XT=function(){},Mm=oi.forwardRef(function(e,t){var r=oi.useRef(null),n=oi.useState({onScrollCapture:XT,onWheelCapture:XT,onTouchMoveCapture:XT}),i=n[0],a=n[1],o=e.forwardProps,s=e.children,l=e.className,c=e.removeScrollBar,f=e.enabled,u=e.shards,h=e.sideCar,g=e.noIsolation,_=e.inert,w=e.allowPinchZoom,E=e.as,S=E===void 0?"div":E,A=Xw(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),O=h,C=GT([r,t]),T=Vi(Vi({},A),i);return oi.createElement(oi.Fragment,null,f&&oi.createElement(O,{sideCar:Zw,removeScrollBar:c,shards:u,noIsolation:g,inert:_,setCallbacks:a,allowPinchZoom:!!w,lockRef:r}),o?oi.cloneElement(oi.Children.only(s),Vi(Vi({},T),{ref:C})):oi.createElement(S,Vi({},T,{className:l,ref:C}),s))});Mm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Mm.classNames={fullWidth:Du,zeroRight:Fu};var Tr=oe(He());var Qw=oe(He());var TJ=oe(He());var IJ;var CJ=function(){if(IJ)return IJ;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Ixe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=CJ();return t&&e.setAttribute("nonce",t),e}function Cxe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Txe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var ZT=function(){var e=0,t=null;return{add:function(r){e==0&&(t=Ixe())&&(Cxe(t,r),Txe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}};var QT=function(){var e=ZT();return function(t,r){TJ.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}};var jm=function(){var e=QT(),t=function(r){var n=r.styles,i=r.dynamic;return e(n,i),null};return t};var Nxe={left:0,top:0,right:0,gap:0},e3=function(e){return parseInt(e||"",10)||0},Lxe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[e3(r),e3(n),e3(i)]},t3=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Nxe;var t=Lxe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}};var Pxe=jm(),Fxe=function(e,t,r,n){var i=e.left,a=e.top,o=e.right,s=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(WT,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(s,"px ").concat(n,`;
  }
  body {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(s,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Fu,` {
    right: `).concat(s,"px ").concat(n,`;
  }
  
  .`).concat(Du,` {
    margin-right: `).concat(s,"px ").concat(n,`;
  }
  
  .`).concat(Fu," .").concat(Fu,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Du," .").concat(Du,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body {
    `).concat(JT,": ").concat(s,`px;
  }
`)},r3=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,i=n===void 0?"margin":n,a=Qw.useMemo(function(){return t3(i)},[i]);return Qw.createElement(Pxe,{styles:Fxe(a,!t,i,r?"":"!important")})};var n3=!1;if(typeof window<"u")try{$m=Object.defineProperty({},"passive",{get:function(){return n3=!0,!0}}),window.addEventListener("test",$m,$m),window.removeEventListener("test",$m,$m)}catch{n3=!1}var $m,Bu=n3?{passive:!1}:!1;var Dxe=function(e){return e.tagName==="TEXTAREA"},NJ=function(e,t){var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Dxe(e)&&r[t]==="visible")},Bxe=function(e){return NJ(e,"overflowY")},Rxe=function(e){return NJ(e,"overflowX")},i3=function(e,t){var r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var n=LJ(e,r);if(n){var i=PJ(e,r),a=i[1],o=i[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==document.body);return!1},Mxe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},jxe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},LJ=function(e,t){return e==="v"?Bxe(t):Rxe(t)},PJ=function(e,t){return e==="v"?Mxe(t):jxe(t)},$xe=function(e,t){return e==="h"&&t==="rtl"?-1:1},FJ=function(e,t,r,n,i){var a=$xe(e,window.getComputedStyle(t).direction),o=a*n,s=r.target,l=t.contains(s),c=!1,f=o>0,u=0,h=0;do{var g=PJ(e,s),_=g[0],w=g[1],E=g[2],S=w-E-a*_;(_||S)&&LJ(e,s)&&(u+=S,h+=_),s=s.parentNode}while(!l&&s!==document.body||l&&(t.contains(s)||t===s));return(f&&(i&&u===0||!i&&o>u)||!f&&(i&&h===0||!i&&-o>h))&&(c=!0),c};var e1=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},DJ=function(e){return[e.deltaX,e.deltaY]},BJ=function(e){return e&&"current"in e?e.current:e},Uxe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},zxe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},qxe=0,Pp=[];function RJ(e){var t=Tr.useRef([]),r=Tr.useRef([0,0]),n=Tr.useRef(),i=Tr.useState(qxe++)[0],a=Tr.useState(function(){return jm()})[0],o=Tr.useRef(e);Tr.useEffect(function(){o.current=e},[e]),Tr.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var w=SJ([e.lockRef.current],(e.shards||[]).map(BJ),!0).filter(Boolean);return w.forEach(function(E){return E.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),w.forEach(function(E){return E.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var s=Tr.useCallback(function(w,E){if("touches"in w&&w.touches.length===2)return!o.current.allowPinchZoom;var S=e1(w),A=r.current,O="deltaX"in w?w.deltaX:A[0]-S[0],C="deltaY"in w?w.deltaY:A[1]-S[1],T,D=w.target,P=Math.abs(O)>Math.abs(C)?"h":"v";if("touches"in w&&P==="h"&&D.type==="range")return!1;var z=i3(P,D);if(!z)return!0;if(z?T=P:(T=P==="v"?"h":"v",z=i3(P,D)),!z)return!1;if(!n.current&&"changedTouches"in w&&(O||C)&&(n.current=T),!T)return!0;var ne=n.current||T;return FJ(ne,E,w,ne==="h"?O:C,!0)},[]),l=Tr.useCallback(function(w){var E=w;if(!(!Pp.length||Pp[Pp.length-1]!==a)){var S="deltaY"in E?DJ(E):e1(E),A=t.current.filter(function(T){return T.name===E.type&&T.target===E.target&&Uxe(T.delta,S)})[0];if(A&&A.should){E.cancelable&&E.preventDefault();return}if(!A){var O=(o.current.shards||[]).map(BJ).filter(Boolean).filter(function(T){return T.contains(E.target)}),C=O.length>0?s(E,O[0]):!o.current.noIsolation;C&&E.cancelable&&E.preventDefault()}}},[]),c=Tr.useCallback(function(w,E,S,A){var O={name:w,delta:E,target:S,should:A};t.current.push(O),setTimeout(function(){t.current=t.current.filter(function(C){return C!==O})},1)},[]),f=Tr.useCallback(function(w){r.current=e1(w),n.current=void 0},[]),u=Tr.useCallback(function(w){c(w.type,DJ(w),w.target,s(w,e.lockRef.current))},[]),h=Tr.useCallback(function(w){c(w.type,e1(w),w.target,s(w,e.lockRef.current))},[]);Tr.useEffect(function(){return Pp.push(a),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Bu),document.addEventListener("touchmove",l,Bu),document.addEventListener("touchstart",f,Bu),function(){Pp=Pp.filter(function(w){return w!==a}),document.removeEventListener("wheel",l,Bu),document.removeEventListener("touchmove",l,Bu),document.removeEventListener("touchstart",f,Bu)}},[]);var g=e.removeScrollBar,_=e.inert;return Tr.createElement(Tr.Fragment,null,_?Tr.createElement(a,{styles:zxe(i)}):null,g?Tr.createElement(r3,{gapMode:"margin"}):null)}var MJ=KT(Zw,RJ);var jJ=t1.forwardRef(function(e,t){return t1.createElement(Mm,Vi({},e,{ref:t,sideCar:MJ}))});jJ.classNames=Mm.classNames;var Um=jJ;var a3=["Enter"," "],Hxe=["ArrowDown","PageUp","Home"],UJ=["ArrowUp","PageDown","End"],Wxe=[...Hxe,...UJ],Jxe={ltr:[...a3,"ArrowRight"],rtl:[...a3,"ArrowLeft"]},Gxe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},i1="Menu",[zm,Yxe,Kxe]=Xf(i1),[Ru,s3]=Qn(i1,[Kxe,Np,ed]),l3=Np(),zJ=ed(),[Xxe,Mu]=Ru(i1),[Zxe,Vm]=Ru(i1),Qxe=e=>{let{__scopeMenu:t,open:r=!1,children:n,dir:i,onOpenChange:a,modal:o=!0}=e,s=l3(t),[l,c]=(0,qe.useState)(null),f=(0,qe.useRef)(!1),u=rn(a),h=Al(i);return(0,qe.useEffect)(()=>{let g=()=>{f.current=!0,document.addEventListener("pointerdown",_,{capture:!0,once:!0}),document.addEventListener("pointermove",_,{capture:!0,once:!0})},_=()=>f.current=!1;return document.addEventListener("keydown",g,{capture:!0}),()=>{document.removeEventListener("keydown",g,{capture:!0}),document.removeEventListener("pointerdown",_,{capture:!0}),document.removeEventListener("pointermove",_,{capture:!0})}},[]),(0,qe.createElement)(qw,s,(0,qe.createElement)(Xxe,{scope:t,open:r,onOpenChange:u,content:l,onContentChange:c},(0,qe.createElement)(Zxe,{scope:t,onClose:(0,qe.useCallback)(()=>u(!1),[u]),isUsingKeyboardRef:f,dir:h,modal:o},n)))};var qJ=(0,qe.forwardRef)((e,t)=>{let{__scopeMenu:r,...n}=e,i=l3(r);return(0,qe.createElement)(Vw,Ge({},i,n,{ref:t}))}),VJ="MenuPortal",[eke,HJ]=Ru(VJ,{forceMount:void 0}),tke=e=>{let{__scopeMenu:t,forceMount:r,children:n,container:i}=e,a=Mu(VJ,t);return(0,qe.createElement)(eke,{scope:t,forceMount:r},(0,qe.createElement)(Il,{present:r||a.open},(0,qe.createElement)(Jw,{asChild:!0,container:i},n)))},po="MenuContent",[rke,c3]=Ru(po),nke=(0,qe.forwardRef)((e,t)=>{let r=HJ(po,e.__scopeMenu),{forceMount:n=r.forceMount,...i}=e,a=Mu(po,e.__scopeMenu),o=Vm(po,e.__scopeMenu);return(0,qe.createElement)(zm.Provider,{scope:e.__scopeMenu},(0,qe.createElement)(Il,{present:n||a.open},(0,qe.createElement)(zm.Slot,{scope:e.__scopeMenu},o.modal?(0,qe.createElement)(ike,Ge({},i,{ref:t})):(0,qe.createElement)(ake,Ge({},i,{ref:t})))))}),ike=(0,qe.forwardRef)((e,t)=>{let r=Mu(po,e.__scopeMenu),n=(0,qe.useRef)(null),i=lr(t,n);return(0,qe.useEffect)(()=>{let a=n.current;if(a)return Kw(a)},[]),(0,qe.createElement)(u3,Ge({},e,{ref:i,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:pt(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)}))}),ake=(0,qe.forwardRef)((e,t)=>{let r=Mu(po,e.__scopeMenu);return(0,qe.createElement)(u3,Ge({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)}))}),u3=(0,qe.forwardRef)((e,t)=>{let{__scopeMenu:r,loop:n=!1,trapFocus:i,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:u,onInteractOutside:h,onDismiss:g,disableOutsideScroll:_,...w}=e,E=Mu(po,r),S=Vm(po,r),A=l3(r),O=zJ(r),C=Yxe(r),[T,D]=(0,qe.useState)(null),P=(0,qe.useRef)(null),z=lr(t,P,E.onContentChange),ne=(0,qe.useRef)(0),V=(0,qe.useRef)(""),X=(0,qe.useRef)(0),Q=(0,qe.useRef)(null),ie=(0,qe.useRef)("right"),pe=(0,qe.useRef)(0),de=_?Um:qe.Fragment,F=_?{as:Ea,allowPinchZoom:!0}:void 0,H=j=>{var $,q;let ae=V.current+j,le=C().filter(be=>!be.disabled),fe=document.activeElement,Se=($=le.find(be=>be.ref.current===fe))===null||$===void 0?void 0:$.textValue,ke=le.map(be=>be.textValue),xe=Ske(ke,ae,Se),se=(q=le.find(be=>be.textValue===xe))===null||q===void 0?void 0:q.ref.current;(function be(W){V.current=W,window.clearTimeout(ne.current),W!==""&&(ne.current=window.setTimeout(()=>be(""),1e3))})(ae),se&&setTimeout(()=>se.focus())};(0,qe.useEffect)(()=>()=>window.clearTimeout(ne.current),[]),Aw();let Z=(0,qe.useCallback)(j=>{var $,q;return ie.current===(($=Q.current)===null||$===void 0?void 0:$.side)&&kke(j,(q=Q.current)===null||q===void 0?void 0:q.area)},[]);return(0,qe.createElement)(rke,{scope:r,searchRef:V,onItemEnter:(0,qe.useCallback)(j=>{Z(j)&&j.preventDefault()},[Z]),onItemLeave:(0,qe.useCallback)(j=>{var $;Z(j)||(($=P.current)===null||$===void 0||$.focus(),D(null))},[Z]),onTriggerLeave:(0,qe.useCallback)(j=>{Z(j)&&j.preventDefault()},[Z]),pointerGraceTimerRef:X,onPointerGraceIntentChange:(0,qe.useCallback)(j=>{Q.current=j},[])},(0,qe.createElement)(de,F,(0,qe.createElement)(Iw,{asChild:!0,trapped:i,onMountAutoFocus:pt(a,j=>{var $;j.preventDefault(),($=P.current)===null||$===void 0||$.focus()}),onUnmountAutoFocus:o},(0,qe.createElement)(Ow,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:u,onInteractOutside:h,onDismiss:g},(0,qe.createElement)(N_,Ge({asChild:!0},O,{dir:S.dir,orientation:"vertical",loop:n,currentTabStopId:T,onCurrentTabStopIdChange:D,onEntryFocus:pt(l,j=>{S.isUsingKeyboardRef.current||j.preventDefault()})}),(0,qe.createElement)(Hw,Ge({role:"menu","aria-orientation":"vertical","data-state":KJ(E.open),"data-radix-menu-content":"",dir:S.dir},A,w,{ref:z,style:{outline:"none",...w.style},onKeyDown:pt(w.onKeyDown,j=>{let q=j.target.closest("[data-radix-menu-content]")===j.currentTarget,ae=j.ctrlKey||j.altKey||j.metaKey,le=j.key.length===1;q&&(j.key==="Tab"&&j.preventDefault(),!ae&&le&&H(j.key));let fe=P.current;if(j.target!==fe||!Wxe.includes(j.key))return;j.preventDefault();let ke=C().filter(xe=>!xe.disabled).map(xe=>xe.ref.current);UJ.includes(j.key)&&ke.reverse(),_ke(ke)}),onBlur:pt(e.onBlur,j=>{j.currentTarget.contains(j.target)||(window.clearTimeout(ne.current),V.current="")}),onPointerMove:pt(e.onPointerMove,qm(j=>{let $=j.target,q=pe.current!==j.clientX;if(j.currentTarget.contains($)&&q){let ae=j.clientX>pe.current?"right":"left";ie.current=ae,pe.current=j.clientX}}))})))))))});var oke=(0,qe.forwardRef)((e,t)=>{let{__scopeMenu:r,...n}=e;return(0,qe.createElement)(Ot.div,Ge({role:"group"},n,{ref:t}))});var ske=(0,qe.forwardRef)((e,t)=>{let{__scopeMenu:r,...n}=e;return(0,qe.createElement)(Ot.div,Ge({},n,{ref:t}))}),o3="MenuItem",$J="menu.itemSelect",f3=(0,qe.forwardRef)((e,t)=>{let{disabled:r=!1,onSelect:n,...i}=e,a=(0,qe.useRef)(null),o=Vm(o3,e.__scopeMenu),s=c3(o3,e.__scopeMenu),l=lr(t,a),c=(0,qe.useRef)(!1),f=()=>{let u=a.current;if(!r&&u){let h=new CustomEvent($J,{bubbles:!0,cancelable:!0});u.addEventListener($J,g=>n?.(g),{once:!0}),T_(u,h),h.defaultPrevented?c.current=!1:o.onClose()}};return(0,qe.createElement)(WJ,Ge({},i,{ref:l,disabled:r,onClick:pt(e.onClick,f),onPointerDown:u=>{var h;(h=e.onPointerDown)===null||h===void 0||h.call(e,u),c.current=!0},onPointerUp:pt(e.onPointerUp,u=>{var h;c.current||(h=u.currentTarget)===null||h===void 0||h.click()}),onKeyDown:pt(e.onKeyDown,u=>{let h=s.searchRef.current!=="";r||h&&u.key===" "||a3.includes(u.key)&&(u.currentTarget.click(),u.preventDefault())})}))}),WJ=(0,qe.forwardRef)((e,t)=>{let{__scopeMenu:r,disabled:n=!1,textValue:i,...a}=e,o=c3(o3,r),s=zJ(r),l=(0,qe.useRef)(null),c=lr(t,l),[f,u]=(0,qe.useState)(!1),[h,g]=(0,qe.useState)("");return(0,qe.useEffect)(()=>{let _=l.current;if(_){var w;g(((w=_.textContent)!==null&&w!==void 0?w:"").trim())}},[a.children]),(0,qe.createElement)(zm.ItemSlot,{scope:r,disabled:n,textValue:i??h},(0,qe.createElement)(L_,Ge({asChild:!0},s,{focusable:!n}),(0,qe.createElement)(Ot.div,Ge({role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0},a,{ref:c,onPointerMove:pt(e.onPointerMove,qm(_=>{n?o.onItemLeave(_):(o.onItemEnter(_),_.defaultPrevented||_.currentTarget.focus())})),onPointerLeave:pt(e.onPointerLeave,qm(_=>o.onItemLeave(_))),onFocus:pt(e.onFocus,()=>u(!0)),onBlur:pt(e.onBlur,()=>u(!1))}))))});var lke=(0,qe.forwardRef)((e,t)=>{let{checked:r=!1,onCheckedChange:n,...i}=e;return(0,qe.createElement)(GJ,{scope:e.__scopeMenu,checked:r},(0,qe.createElement)(f3,Ge({role:"menuitemcheckbox","aria-checked":n1(r)?"mixed":r},i,{ref:t,"data-state":d3(r),onSelect:pt(i.onSelect,()=>n?.(n1(r)?!0:!r),{checkForDefaultPrevented:!1})})))}),cke="MenuRadioGroup",[Q7e,uke]=Ru(cke,{value:void 0,onValueChange:()=>{}});var fke="MenuRadioItem",dke=(0,qe.forwardRef)((e,t)=>{let{value:r,...n}=e,i=uke(fke,e.__scopeMenu),a=r===i.value;return(0,qe.createElement)(GJ,{scope:e.__scopeMenu,checked:a},(0,qe.createElement)(f3,Ge({role:"menuitemradio","aria-checked":a},n,{ref:t,"data-state":d3(a),onSelect:pt(n.onSelect,()=>{var o;return(o=i.onValueChange)===null||o===void 0?void 0:o.call(i,r)},{checkForDefaultPrevented:!1})})))}),JJ="MenuItemIndicator",[GJ,pke]=Ru(JJ,{checked:!1}),hke=(0,qe.forwardRef)((e,t)=>{let{__scopeMenu:r,forceMount:n,...i}=e,a=pke(JJ,r);return(0,qe.createElement)(Il,{present:n||n1(a.checked)||a.checked===!0},(0,qe.createElement)(Ot.span,Ge({},i,{ref:t,"data-state":d3(a.checked)})))});var gke=(0,qe.forwardRef)((e,t)=>{let{__scopeMenu:r,...n}=e;return(0,qe.createElement)(Ot.div,Ge({role:"separator","aria-orientation":"horizontal"},n,{ref:t}))});var yke="MenuSub",[eVe,YJ]=Ru(yke);var r1="MenuSubTrigger",mke=(0,qe.forwardRef)((e,t)=>{let r=Mu(r1,e.__scopeMenu),n=Vm(r1,e.__scopeMenu),i=YJ(r1,e.__scopeMenu),a=c3(r1,e.__scopeMenu),o=(0,qe.useRef)(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:l}=a,c={__scopeMenu:e.__scopeMenu},f=(0,qe.useCallback)(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return(0,qe.useEffect)(()=>f,[f]),(0,qe.useEffect)(()=>{let u=s.current;return()=>{window.clearTimeout(u),l(null)}},[s,l]),(0,qe.createElement)(qJ,Ge({asChild:!0},c),(0,qe.createElement)(WJ,Ge({id:i.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":i.contentId,"data-state":KJ(r.open)},e,{ref:Hc(t,i.onTriggerChange),onClick:u=>{var h;(h=e.onClick)===null||h===void 0||h.call(e,u),!(e.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:pt(e.onPointerMove,qm(u=>{a.onItemEnter(u),!u.defaultPrevented&&!e.disabled&&!r.open&&!o.current&&(a.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),f()},100))})),onPointerLeave:pt(e.onPointerLeave,qm(u=>{var h;f();let g=(h=r.content)===null||h===void 0?void 0:h.getBoundingClientRect();if(g){var _;let w=(_=r.content)===null||_===void 0?void 0:_.dataset.side,E=w==="right",S=E?-5:5,A=g[E?"left":"right"],O=g[E?"right":"left"];a.onPointerGraceIntentChange({area:[{x:u.clientX+S,y:u.clientY},{x:A,y:g.top},{x:O,y:g.top},{x:O,y:g.bottom},{x:A,y:g.bottom}],side:w}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(u),u.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:pt(e.onKeyDown,u=>{let h=a.searchRef.current!=="";if(!(e.disabled||h&&u.key===" ")&&Jxe[n.dir].includes(u.key)){var g;r.onOpenChange(!0),(g=r.content)===null||g===void 0||g.focus(),u.preventDefault()}})})))}),vke="MenuSubContent",bke=(0,qe.forwardRef)((e,t)=>{let r=HJ(po,e.__scopeMenu),{forceMount:n=r.forceMount,...i}=e,a=Mu(po,e.__scopeMenu),o=Vm(po,e.__scopeMenu),s=YJ(vke,e.__scopeMenu),l=(0,qe.useRef)(null),c=lr(t,l);return(0,qe.createElement)(zm.Provider,{scope:e.__scopeMenu},(0,qe.createElement)(Il,{present:n||a.open},(0,qe.createElement)(zm.Slot,{scope:e.__scopeMenu},(0,qe.createElement)(u3,Ge({id:s.contentId,"aria-labelledby":s.triggerId},i,{ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var u;o.isUsingKeyboardRef.current&&((u=l.current)===null||u===void 0||u.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:pt(e.onFocusOutside,f=>{f.target!==s.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:pt(e.onEscapeKeyDown,f=>{o.onClose(),f.preventDefault()}),onKeyDown:pt(e.onKeyDown,f=>{let u=f.currentTarget.contains(f.target),h=Gxe[o.dir].includes(f.key);if(u&&h){var g;a.onOpenChange(!1),(g=s.trigger)===null||g===void 0||g.focus(),f.preventDefault()}})})))))});function KJ(e){return e?"open":"closed"}function n1(e){return e==="indeterminate"}function d3(e){return n1(e)?"indeterminate":e?"checked":"unchecked"}function _ke(e){let t=document.activeElement;for(let r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function wke(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function Ske(e,t,r){let i=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,a=r?e.indexOf(r):-1,o=wke(e,Math.max(a,0));i.length===1&&(o=o.filter(c=>c!==r));let l=o.find(c=>c.toLowerCase().startsWith(i.toLowerCase()));return l!==r?l:void 0}function xke(e,t){let{x:r,y:n}=e,i=!1;for(let a=0,o=t.length-1;a<t.length;o=a++){let s=t[a].x,l=t[a].y,c=t[o].x,f=t[o].y;l>n!=f>n&&r<(c-s)*(n-l)/(f-l)+s&&(i=!i)}return i}function kke(e,t){if(!t)return!1;let r={x:e.clientX,y:e.clientY};return xke(r,t)}function qm(e){return t=>t.pointerType==="mouse"?e(t):void 0}var XJ=Qxe,ZJ=qJ,QJ=tke,eG=nke,tG=oke,rG=ske,nG=f3,iG=lke;var aG=dke,oG=hke,sG=gke;var lG=mke,cG=bke;var uG="DropdownMenu",[Eke,pVe]=Qn(uG,[s3]),da=s3(),[Oke,fG]=Eke(uG),Ake=e=>{let{__scopeDropdownMenu:t,children:r,dir:n,open:i,defaultOpen:a,onOpenChange:o,modal:s=!0}=e,l=da(t),c=(0,Wt.useRef)(null),[f=!1,u]=ks({prop:i,defaultProp:a,onChange:o});return(0,Wt.createElement)(Oke,{scope:t,triggerId:Za(),triggerRef:c,contentId:Za(),open:f,onOpenChange:u,onOpenToggle:(0,Wt.useCallback)(()=>u(h=>!h),[u]),modal:s},(0,Wt.createElement)(XJ,Ge({},l,{open:f,onOpenChange:u,dir:n,modal:s}),r))},Ike="DropdownMenuTrigger",Cke=(0,Wt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,disabled:n=!1,...i}=e,a=fG(Ike,r),o=da(r);return(0,Wt.createElement)(ZJ,Ge({asChild:!0},o),(0,Wt.createElement)(Ot.button,Ge({type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":n?"":void 0,disabled:n},i,{ref:Hc(t,a.triggerRef),onPointerDown:pt(e.onPointerDown,s=>{!n&&s.button===0&&s.ctrlKey===!1&&(a.onOpenToggle(),a.open||s.preventDefault())}),onKeyDown:pt(e.onKeyDown,s=>{n||(["Enter"," "].includes(s.key)&&a.onOpenToggle(),s.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})))});var Tke=e=>{let{__scopeDropdownMenu:t,...r}=e,n=da(t);return(0,Wt.createElement)(QJ,Ge({},n,r))},Nke="DropdownMenuContent",Lke=(0,Wt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=fG(Nke,r),a=da(r),o=(0,Wt.useRef)(!1);return(0,Wt.createElement)(eG,Ge({id:i.contentId,"aria-labelledby":i.triggerId},a,n,{ref:t,onCloseAutoFocus:pt(e.onCloseAutoFocus,s=>{var l;o.current||(l=i.triggerRef.current)===null||l===void 0||l.focus(),o.current=!1,s.preventDefault()}),onInteractOutside:pt(e.onInteractOutside,s=>{let l=s.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,f=l.button===2||c;(!i.modal||f)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))});var Pke=(0,Wt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=da(r);return(0,Wt.createElement)(tG,Ge({},i,n,{ref:t}))});var Fke=(0,Wt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=da(r);return(0,Wt.createElement)(rG,Ge({},i,n,{ref:t}))});var Dke=(0,Wt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=da(r);return(0,Wt.createElement)(nG,Ge({},i,n,{ref:t}))});var Bke=(0,Wt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=da(r);return(0,Wt.createElement)(iG,Ge({},i,n,{ref:t}))});var Rke=(0,Wt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=da(r);return(0,Wt.createElement)(aG,Ge({},i,n,{ref:t}))});var Mke=(0,Wt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=da(r);return(0,Wt.createElement)(oG,Ge({},i,n,{ref:t}))});var jke=(0,Wt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=da(r);return(0,Wt.createElement)(sG,Ge({},i,n,{ref:t}))});var $ke=(0,Wt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=da(r);return(0,Wt.createElement)(lG,Ge({},i,n,{ref:t}))});var Uke=(0,Wt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=da(r);return(0,Wt.createElement)(cG,Ge({},i,n,{ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),dG=Ake,pG=Cke,hG=Tke,p3=Lke,gG=Pke,h3=Fke,g3=Dke,y3=Bke;var m3=Rke,v3=Mke,b3=jke;var _3=$ke,w3=Uke;var _n=oe(mt(),1),yG=dG,mG=pG,vG=gG;var qke=Vs.forwardRef(({className:e,inset:t,children:r,...n},i)=>(0,_n.jsxs)(_3,{ref:i,className:Nt("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,(0,_n.jsx)(Sm,{className:"ml-auto h-4 w-4"})]}));qke.displayName=_3.displayName;var Vke=Vs.forwardRef(({className:e,...t},r)=>(0,_n.jsx)(w3,{ref:r,className:Nt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1",e),...t}));Vke.displayName=w3.displayName;var S3=Vs.forwardRef(({className:e,sideOffset:t=4,...r},n)=>(0,_n.jsx)(hG,{children:(0,_n.jsx)(p3,{ref:n,sideOffset:t,className:Nt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));S3.displayName=p3.displayName;var Fp=Vs.forwardRef(({className:e,inset:t,...r},n)=>(0,_n.jsx)(g3,{ref:n,className:Nt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));Fp.displayName=g3.displayName;var Hke=Vs.forwardRef(({className:e,children:t,checked:r,...n},i)=>(0,_n.jsxs)(y3,{ref:i,className:Nt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[(0,_n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,_n.jsx)(v3,{children:(0,_n.jsx)(Au,{className:"h-4 w-4"})})}),t]}));Hke.displayName=y3.displayName;var Wke=Vs.forwardRef(({className:e,children:t,...r},n)=>(0,_n.jsxs)(m3,{ref:n,className:Nt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[(0,_n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,_n.jsx)(v3,{children:(0,_n.jsx)(xm,{className:"h-2 w-2 fill-current"})})}),t]}));Wke.displayName=m3.displayName;var x3=Vs.forwardRef(({className:e,inset:t,...r},n)=>(0,_n.jsx)(h3,{ref:n,className:Nt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));x3.displayName=h3.displayName;var a1=Vs.forwardRef(({className:e,...t},r)=>(0,_n.jsx)(b3,{ref:r,className:Nt("-mx-1 my-1 h-px bg-muted",e),...t}));a1.displayName=b3.displayName;var Dp=({className:e,...t})=>(0,_n.jsx)("span",{className:Nt("ml-auto text-xs tracking-widest opacity-60",e),...t});Dp.displayName="DropdownMenuShortcut";var $t=oe(mt(),1);function bG(){return(0,$t.jsxs)(yG,{children:[(0,$t.jsx)(mG,{asChild:!0,children:(0,$t.jsx)(Cu,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,$t.jsxs)(gm,{className:"h-8 w-8",children:[(0,$t.jsx)(ym,{src:"/avatars/01.png",alt:"@shadcn"}),(0,$t.jsx)(mm,{children:"GF"})]})})}),(0,$t.jsxs)(S3,{className:"w-56",align:"end",forceMount:!0,children:[(0,$t.jsx)(x3,{className:"font-normal",children:(0,$t.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,$t.jsx)("p",{className:"text-sm font-medium leading-none",children:"Garrett Flynn"}),(0,$t.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:"GarrettFlynn@hypergamma.co.uk"})]})}),(0,$t.jsx)(a1,{}),(0,$t.jsxs)(vG,{children:[(0,$t.jsx)(No,{to:"/profile",className:"disabled",children:(0,$t.jsxs)(Fp,{children:[(0,$t.jsx)(Fm,{className:"mr-2 h-4 w-4"}),(0,$t.jsx)("span",{children:"Profile"}),(0,$t.jsx)(Dp,{children:"\u21E7\u2318P"})]})}),(0,$t.jsx)(No,{to:"/billing",className:"disabled",children:(0,$t.jsxs)(Fp,{children:[(0,$t.jsx)(Iu,{className:"mr-2 h-4 w-4"}),(0,$t.jsx)("span",{children:"Billing"}),(0,$t.jsx)(Dp,{children:"\u2318B"})]})}),(0,$t.jsx)(No,{to:"/settings",className:"disabled",children:(0,$t.jsxs)(Fp,{children:[(0,$t.jsx)(Pm,{className:"mr-2 h-4 w-4"}),(0,$t.jsx)("span",{children:"Settings"}),(0,$t.jsx)(Dp,{children:"\u2318S"})]})})]}),(0,$t.jsx)(a1,{}),(0,$t.jsxs)(Fp,{children:[(0,$t.jsx)(Tm,{className:"mr-2 h-4 w-4"}),(0,$t.jsx)("span",{children:"Log out"}),(0,$t.jsx)(Dp,{children:"\u21E7\u2318Q"})]})]})]})}var Kl=oe(mt(),1);function Yo(){return(0,Kl.jsx)("div",{className:"border-b sticky top-0 left-0 bg-background z-10",children:(0,Kl.jsxs)("div",{className:"flex h-16 items-center px-4",children:[(0,Kl.jsx)("span",{className:"font-semibold text-xl tracking-tight",children:"Hypergamma"}),(0,Kl.jsx)(wW,{className:"mx-6"}),(0,Kl.jsx)("div",{className:"ml-auto flex items-center space-x-4",children:(0,Kl.jsx)(bG,{})})]})})}var fr=oe(mt(),1),Jke=(e=0)=>{let t=new Date;return t.setDate(t.getDate()+e),t.toDateString()},Gke=()=>(2*Math.random()-1)*.7,_G=Array.from({length:12},(e,t)=>({name:Jke(-(t+1)),total:Gke()}));function k3(){return(0,fr.jsxs)(fr.Fragment,{children:[(0,fr.jsx)(Yo,{}),(0,fr.jsx)("div",{className:"flex-col md:flex",children:(0,fr.jsx)("div",{className:"flex-1 space-y-4 p-8 pt-6",children:(0,fr.jsxs)(oM,{defaultValue:"overview",className:"space-y-4",children:[(0,fr.jsxs)(WE,{children:[(0,fr.jsx)(td,{value:"overview",children:"Overview"}),(0,fr.jsx)(td,{value:"analytics",children:"Analytics"}),(0,fr.jsx)(td,{value:"reports",disabled:!0,children:"Reports"}),(0,fr.jsx)(td,{value:"experiments",disabled:!0,children:"Experiments"})]}),(0,fr.jsx)(D_,{value:"overview",className:"space-y-4",children:(0,fr.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[(0,fr.jsxs)(Jf,{className:"col-span-4",children:[(0,fr.jsx)(Gf,{children:(0,fr.jsx)(Yf,{children:"Overview"})}),(0,fr.jsx)(Kf,{className:"pl-2",children:(0,fr.jsx)(yW,{toPlot:_G.slice().reverse()})})]}),(0,fr.jsxs)(Jf,{className:"col-span-3",children:[(0,fr.jsxs)(Gf,{children:[(0,fr.jsx)(Yf,{children:"Recent Sessions"}),(0,fr.jsx)(BE,{children:"You had 20 sessions in the last 30 days."})]}),(0,fr.jsx)(Kf,{children:(0,fr.jsx)(bW,{data:_G})})]})]})}),(0,fr.jsx)(D_,{value:"analytics",className:"space-y-4",children:(0,fr.jsx)(NT,{})})]})})})]})}var Xl=oe(mt(),1);function E3(){let e=A_();return console.error(e),(0,Xl.jsx)("div",{id:"error-page",children:(0,Xl.jsxs)("div",{children:[(0,Xl.jsx)("h1",{children:"Oops!"}),(0,Xl.jsx)("p",{children:"Sorry, an unexpected error has occurred."}),(0,Xl.jsx)("p",{children:(0,Xl.jsx)("i",{children:e.statusText||e.message})})]})})}var xG=oe(He(),1);var o1=oe(He(),1);var O3="horizontal",Yke=["horizontal","vertical"],wG=(0,o1.forwardRef)((e,t)=>{let{decorative:r,orientation:n=O3,...i}=e,a=SG(n)?n:O3,s=r?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return(0,o1.createElement)(Ot.div,Ge({"data-orientation":a},s,i,{ref:t}))});wG.propTypes={orientation(e,t,r){let n=e[t],i=String(n);return n&&!SG(n)?new Error(Kke(i,r)):null}};function Kke(e,t){return`Invalid prop \`orientation\` of value \`${e}\` supplied to \`${t}\`, expected one of:
  - horizontal
  - vertical

Defaulting to \`${O3}\`.`}function SG(e){return Yke.includes(e)}var A3=wG;var kG=oe(mt(),1),I3=xG.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},i)=>(0,kG.jsx)(A3,{ref:i,decorative:r,orientation:t,className:Nt("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));I3.displayName=A3.displayName;var C3=oe(mt(),1);function EG({className:e,items:t,...r}){return(0,C3.jsx)("nav",{className:Nt("flex space-x-2 lg:flex-col lg:space-x-0 lg:space-y-1",e),...r,children:t.map(n=>(0,C3.jsx)(No,{to:n.href,className:Nt(Op({variant:"ghost"}),"hover:bg-transparent hover:underline","justify-start"),children:n.title},n.href))})}var Hi=oe(mt(),1),Zke=[{title:"Profile",href:"/settings"},{title:"Account",href:"/settings/account"},{title:"Appearance",href:"/settings/appearance"},{title:"Notifications",href:"/settings/notifications"},{title:"Display",href:"/settings/display"}];function T3(){return(0,Hi.jsxs)(Hi.Fragment,{children:[(0,Hi.jsx)(Yo,{}),(0,Hi.jsxs)("div",{className:"space-y-6 p-10 pb-16 md:block",children:[(0,Hi.jsxs)("div",{className:"space-y-0.5",children:[(0,Hi.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Settings"}),(0,Hi.jsx)("p",{className:"text-muted-foreground",children:"Manage your account settings and set e-mail preferences."})]}),(0,Hi.jsx)(I3,{className:"my-6"}),(0,Hi.jsx)("div",{className:"flex flex-col space-y-8 lg:flex-row lg:space-x-12 lg:space-y-0",children:(0,Hi.jsx)("aside",{className:"-mx-4 lg:w-1/5",children:(0,Hi.jsx)(EG,{items:Zke})})})]})]})}var Mp=oe(He(),1);var je=oe(He(),1),P3=oe(Io(),1);function N3(e,[t,r]){return Math.min(r,Math.max(t,e))}var s1=oe(He(),1);function OG(e){let t=(0,s1.useRef)({value:e,previous:e});return(0,s1.useMemo)(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var l1=oe(He(),1);var AG=(0,l1.forwardRef)((e,t)=>(0,l1.createElement)(Ot.span,Ge({},e,{ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}})));var Qke=[" ","Enter","ArrowUp","ArrowDown"],eEe=[" ","Enter"],u1="Select",[f1,F3,tEe]=Xf(u1),[Rp,OHe]=Qn(u1,[tEe,Np]),D3=Np(),[rEe,ju]=Rp(u1),[nEe,iEe]=Rp(u1),aEe=e=>{let{__scopeSelect:t,children:r,open:n,defaultOpen:i,onOpenChange:a,value:o,defaultValue:s,onValueChange:l,dir:c,name:f,autoComplete:u,disabled:h,required:g}=e,_=D3(t),[w,E]=(0,je.useState)(null),[S,A]=(0,je.useState)(null),[O,C]=(0,je.useState)(!1),T=Al(c),[D=!1,P]=ks({prop:n,defaultProp:i,onChange:a}),[z,ne]=ks({prop:o,defaultProp:s,onChange:l}),V=(0,je.useRef)(null),X=w?!!w.closest("form"):!0,[Q,ie]=(0,je.useState)(new Set),pe=Array.from(Q).map(de=>de.props.value).join(";");return(0,je.createElement)(qw,_,(0,je.createElement)(rEe,{required:g,scope:t,trigger:w,onTriggerChange:E,valueNode:S,onValueNodeChange:A,valueNodeHasChildren:O,onValueNodeHasChildrenChange:C,contentId:Za(),value:z,onValueChange:ne,open:D,onOpenChange:P,dir:T,triggerPointerDownPosRef:V,disabled:h},(0,je.createElement)(f1.Provider,{scope:t},(0,je.createElement)(nEe,{scope:e.__scopeSelect,onNativeOptionAdd:(0,je.useCallback)(de=>{ie(F=>new Set(F).add(de))},[]),onNativeOptionRemove:(0,je.useCallback)(de=>{ie(F=>{let H=new Set(F);return H.delete(de),H})},[])},r)),X?(0,je.createElement)(LG,{key:pe,"aria-hidden":!0,required:g,tabIndex:-1,name:f,autoComplete:u,value:z,onChange:de=>ne(de.target.value),disabled:h},z===void 0?(0,je.createElement)("option",{value:""}):null,Array.from(Q)):null))},oEe="SelectTrigger",sEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,disabled:n=!1,...i}=e,a=D3(r),o=ju(oEe,r),s=o.disabled||n,l=lr(t,o.onTriggerChange),c=F3(r),[f,u,h]=PG(_=>{let w=c().filter(A=>!A.disabled),E=w.find(A=>A.value===o.value),S=FG(w,_,E);S!==void 0&&o.onValueChange(S.value)}),g=()=>{s||(o.onOpenChange(!0),h())};return(0,je.createElement)(Vw,Ge({asChild:!0},a),(0,je.createElement)(Ot.button,Ge({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":o.value===void 0?"":void 0},i,{ref:l,onClick:pt(i.onClick,_=>{_.currentTarget.focus()}),onPointerDown:pt(i.onPointerDown,_=>{let w=_.target;w.hasPointerCapture(_.pointerId)&&w.releasePointerCapture(_.pointerId),_.button===0&&_.ctrlKey===!1&&(g(),o.triggerPointerDownPosRef.current={x:Math.round(_.pageX),y:Math.round(_.pageY)},_.preventDefault())}),onKeyDown:pt(i.onKeyDown,_=>{let w=f.current!=="";!(_.ctrlKey||_.altKey||_.metaKey)&&_.key.length===1&&u(_.key),!(w&&_.key===" ")&&Qke.includes(_.key)&&(g(),_.preventDefault())})})))}),lEe="SelectValue",cEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,className:n,style:i,children:a,placeholder:o,...s}=e,l=ju(lEe,r),{onValueNodeHasChildrenChange:c}=l,f=a!==void 0,u=lr(t,l.onValueNodeChange);return kn(()=>{c(f)},[c,f]),(0,je.createElement)(Ot.span,Ge({},s,{ref:u,style:{pointerEvents:"none"}}),l.value===void 0&&o!==void 0?o:a)});var uEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,children:n,...i}=e;return(0,je.createElement)(Ot.span,Ge({"aria-hidden":!0},i,{ref:t}),n||"\u25BC")});var fEe=e=>(0,je.createElement)(Jw,Ge({asChild:!0},e)),Bp="SelectContent",dEe=(0,je.forwardRef)((e,t)=>{let r=ju(Bp,e.__scopeSelect),[n,i]=(0,je.useState)();if(kn(()=>{i(new DocumentFragment)},[]),!r.open){let a=n;return a?(0,P3.createPortal)((0,je.createElement)(TG,{scope:e.__scopeSelect},(0,je.createElement)(f1.Slot,{scope:e.__scopeSelect},(0,je.createElement)("div",null,e.children))),a):null}return(0,je.createElement)(pEe,Ge({},e,{ref:t}))}),Hs=10,[TG,d1]=Rp(Bp);var pEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:a,onPointerDownOutside:o,side:s,sideOffset:l,align:c,alignOffset:f,arrowPadding:u,collisionBoundary:h,collisionPadding:g,sticky:_,hideWhenDetached:w,avoidCollisions:E,...S}=e,A=ju(Bp,r),[O,C]=(0,je.useState)(null),[T,D]=(0,je.useState)(null),P=lr(t,xe=>C(xe)),[z,ne]=(0,je.useState)(null),[V,X]=(0,je.useState)(null),Q=F3(r),[ie,pe]=(0,je.useState)(!1),de=(0,je.useRef)(!1);(0,je.useEffect)(()=>{if(O)return Kw(O)},[O]),Aw();let F=(0,je.useCallback)(xe=>{let[se,...be]=Q().map(re=>re.ref.current),[W]=be.slice(-1),J=document.activeElement;for(let re of xe)if(re===J||(re?.scrollIntoView({block:"nearest"}),re===se&&T&&(T.scrollTop=0),re===W&&T&&(T.scrollTop=T.scrollHeight),re?.focus(),document.activeElement!==J))return},[Q,T]),H=(0,je.useCallback)(()=>F([z,O]),[F,z,O]);(0,je.useEffect)(()=>{ie&&H()},[ie,H]);let{onOpenChange:Z,triggerPointerDownPosRef:j}=A;(0,je.useEffect)(()=>{if(O){let xe={x:0,y:0},se=W=>{var J,re,Ee,Te;xe={x:Math.abs(Math.round(W.pageX)-((J=(re=j.current)===null||re===void 0?void 0:re.x)!==null&&J!==void 0?J:0)),y:Math.abs(Math.round(W.pageY)-((Ee=(Te=j.current)===null||Te===void 0?void 0:Te.y)!==null&&Ee!==void 0?Ee:0))}},be=W=>{xe.x<=10&&xe.y<=10?W.preventDefault():O.contains(W.target)||Z(!1),document.removeEventListener("pointermove",se),j.current=null};return j.current!==null&&(document.addEventListener("pointermove",se),document.addEventListener("pointerup",be,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",se),document.removeEventListener("pointerup",be,{capture:!0})}}},[O,Z,j]),(0,je.useEffect)(()=>{let xe=()=>Z(!1);return window.addEventListener("blur",xe),window.addEventListener("resize",xe),()=>{window.removeEventListener("blur",xe),window.removeEventListener("resize",xe)}},[Z]);let[$,q]=PG(xe=>{let se=Q().filter(J=>!J.disabled),be=se.find(J=>J.ref.current===document.activeElement),W=FG(se,xe,be);W&&setTimeout(()=>W.ref.current.focus())}),ae=(0,je.useCallback)((xe,se,be)=>{let W=!de.current&&!be;(A.value!==void 0&&A.value===se||W)&&(ne(xe),W&&(de.current=!0))},[A.value]),le=(0,je.useCallback)(()=>O?.focus(),[O]),fe=(0,je.useCallback)((xe,se,be)=>{let W=!de.current&&!be;(A.value!==void 0&&A.value===se||W)&&X(xe)},[A.value]),Se=n==="popper"?IG:hEe,ke=Se===IG?{side:s,sideOffset:l,align:c,alignOffset:f,arrowPadding:u,collisionBoundary:h,collisionPadding:g,sticky:_,hideWhenDetached:w,avoidCollisions:E}:{};return(0,je.createElement)(TG,{scope:r,content:O,viewport:T,onViewportChange:D,itemRefCallback:ae,selectedItem:z,onItemLeave:le,itemTextRefCallback:fe,focusSelectedItem:H,selectedItemText:V,position:n,isPositioned:ie,searchRef:$},(0,je.createElement)(Um,{as:Ea,allowPinchZoom:!0},(0,je.createElement)(Iw,{asChild:!0,trapped:A.open,onMountAutoFocus:xe=>{xe.preventDefault()},onUnmountAutoFocus:pt(i,xe=>{var se;(se=A.trigger)===null||se===void 0||se.focus({preventScroll:!0}),xe.preventDefault()})},(0,je.createElement)(Ow,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:xe=>xe.preventDefault(),onDismiss:()=>A.onOpenChange(!1)},(0,je.createElement)(Se,Ge({role:"listbox",id:A.contentId,"data-state":A.open?"open":"closed",dir:A.dir,onContextMenu:xe=>xe.preventDefault()},S,ke,{onPlaced:()=>pe(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...S.style},onKeyDown:pt(S.onKeyDown,xe=>{let se=xe.ctrlKey||xe.altKey||xe.metaKey;if(xe.key==="Tab"&&xe.preventDefault(),!se&&xe.key.length===1&&q(xe.key),["ArrowUp","ArrowDown","Home","End"].includes(xe.key)){let W=Q().filter(J=>!J.disabled).map(J=>J.ref.current);if(["ArrowUp","End"].includes(xe.key)&&(W=W.slice().reverse()),["ArrowUp","ArrowDown"].includes(xe.key)){let J=xe.target,re=W.indexOf(J);W=W.slice(re+1)}setTimeout(()=>F(W)),xe.preventDefault()}})}))))))});var hEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,onPlaced:n,...i}=e,a=ju(Bp,r),o=d1(Bp,r),[s,l]=(0,je.useState)(null),[c,f]=(0,je.useState)(null),u=lr(t,P=>f(P)),h=F3(r),g=(0,je.useRef)(!1),_=(0,je.useRef)(!0),{viewport:w,selectedItem:E,selectedItemText:S,focusSelectedItem:A}=o,O=(0,je.useCallback)(()=>{if(a.trigger&&a.valueNode&&s&&c&&w&&E&&S){let P=a.trigger.getBoundingClientRect(),z=c.getBoundingClientRect(),ne=a.valueNode.getBoundingClientRect(),V=S.getBoundingClientRect();if(a.dir!=="rtl"){let J=V.left-z.left,re=ne.left-J,Ee=P.left-re,Te=P.width+Ee,Ie=Math.max(Te,z.width),Ye=window.innerWidth-Hs,Ke=N3(re,[Hs,Ye-Ie]);s.style.minWidth=Te+"px",s.style.left=Ke+"px"}else{let J=z.right-V.right,re=window.innerWidth-ne.right-J,Ee=window.innerWidth-P.right-re,Te=P.width+Ee,Ie=Math.max(Te,z.width),Ye=window.innerWidth-Hs,Ke=N3(re,[Hs,Ye-Ie]);s.style.minWidth=Te+"px",s.style.right=Ke+"px"}let X=h(),Q=window.innerHeight-Hs*2,ie=w.scrollHeight,pe=window.getComputedStyle(c),de=parseInt(pe.borderTopWidth,10),F=parseInt(pe.paddingTop,10),H=parseInt(pe.borderBottomWidth,10),Z=parseInt(pe.paddingBottom,10),j=de+F+ie+Z+H,$=Math.min(E.offsetHeight*5,j),q=window.getComputedStyle(w),ae=parseInt(q.paddingTop,10),le=parseInt(q.paddingBottom,10),fe=P.top+P.height/2-Hs,Se=Q-fe,ke=E.offsetHeight/2,xe=E.offsetTop+ke,se=de+F+xe,be=j-se;if(se<=fe){let J=E===X[X.length-1].ref.current;s.style.bottom="0px";let re=c.clientHeight-w.offsetTop-w.offsetHeight,Ee=Math.max(Se,ke+(J?le:0)+re+H),Te=se+Ee;s.style.height=Te+"px"}else{let J=E===X[0].ref.current;s.style.top="0px";let Ee=Math.max(fe,de+w.offsetTop+(J?ae:0)+ke)+be;s.style.height=Ee+"px",w.scrollTop=se-fe+w.offsetTop}s.style.margin=`${Hs}px 0`,s.style.minHeight=$+"px",s.style.maxHeight=Q+"px",n?.(),requestAnimationFrame(()=>g.current=!0)}},[h,a.trigger,a.valueNode,s,c,w,E,S,a.dir,n]);kn(()=>O(),[O]);let[C,T]=(0,je.useState)();kn(()=>{c&&T(window.getComputedStyle(c).zIndex)},[c]);let D=(0,je.useCallback)(P=>{P&&_.current===!0&&(O(),A?.(),_.current=!1)},[O,A]);return(0,je.createElement)(gEe,{scope:r,contentWrapper:s,shouldExpandOnScrollRef:g,onScrollButtonChange:D},(0,je.createElement)("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C}},(0,je.createElement)(Ot.div,Ge({},i,{ref:u,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}}))))});var IG=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,align:n="start",collisionPadding:i=Hs,...a}=e,o=D3(r);return(0,je.createElement)(Hw,Ge({},o,a,{ref:t,align:n,collisionPadding:i,style:{boxSizing:"border-box",...a.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[gEe,yEe]=Rp(Bp,{}),CG="SelectViewport",mEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,...n}=e,i=d1(CG,r),a=yEe(CG,r),o=lr(t,i.onViewportChange),s=(0,je.useRef)(0);return(0,je.createElement)(je.Fragment,null,(0,je.createElement)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),(0,je.createElement)(f1.Slot,{scope:r},(0,je.createElement)(Ot.div,Ge({"data-radix-select-viewport":"",role:"presentation"},n,{ref:o,style:{position:"relative",flex:1,overflow:"auto",...n.style},onScroll:pt(n.onScroll,l=>{let c=l.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:u}=a;if(u!=null&&u.current&&f){let h=Math.abs(s.current-c.scrollTop);if(h>0){let g=window.innerHeight-Hs*2,_=parseFloat(f.style.minHeight),w=parseFloat(f.style.height),E=Math.max(_,w);if(E<g){let S=E+h,A=Math.min(g,S),O=S-A;f.style.height=A+"px",f.style.bottom==="0px"&&(c.scrollTop=O>0?O:0,f.style.justifyContent="flex-end")}}}s.current=c.scrollTop})}))))}),vEe="SelectGroup",[bEe,_Ee]=Rp(vEe),wEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,...n}=e,i=Za();return(0,je.createElement)(bEe,{scope:r,id:i},(0,je.createElement)(Ot.div,Ge({role:"group","aria-labelledby":i},n,{ref:t})))}),SEe="SelectLabel",xEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,...n}=e,i=_Ee(SEe,r);return(0,je.createElement)(Ot.div,Ge({id:i.id},n,{ref:t}))}),L3="SelectItem",[kEe,NG]=Rp(L3),EEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,value:n,disabled:i=!1,textValue:a,...o}=e,s=ju(L3,r),l=d1(L3,r),c=s.value===n,[f,u]=(0,je.useState)(a??""),[h,g]=(0,je.useState)(!1),_=lr(t,S=>{var A;return(A=l.itemRefCallback)===null||A===void 0?void 0:A.call(l,S,n,i)}),w=Za(),E=()=>{i||(s.onValueChange(n),s.onOpenChange(!1))};return(0,je.createElement)(kEe,{scope:r,value:n,disabled:i,textId:w,isSelected:c,onItemTextChange:(0,je.useCallback)(S=>{u(A=>{var O;return A||((O=S?.textContent)!==null&&O!==void 0?O:"").trim()})},[])},(0,je.createElement)(f1.ItemSlot,{scope:r,value:n,disabled:i,textValue:f},(0,je.createElement)(Ot.div,Ge({role:"option","aria-labelledby":w,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1},o,{ref:_,onFocus:pt(o.onFocus,()=>g(!0)),onBlur:pt(o.onBlur,()=>g(!1)),onPointerUp:pt(o.onPointerUp,E),onPointerMove:pt(o.onPointerMove,S=>{if(i){var A;(A=l.onItemLeave)===null||A===void 0||A.call(l)}else S.currentTarget.focus({preventScroll:!0})}),onPointerLeave:pt(o.onPointerLeave,S=>{if(S.currentTarget===document.activeElement){var A;(A=l.onItemLeave)===null||A===void 0||A.call(l)}}),onKeyDown:pt(o.onKeyDown,S=>{var A;((A=l.searchRef)===null||A===void 0?void 0:A.current)!==""&&S.key===" "||(eEe.includes(S.key)&&E(),S.key===" "&&S.preventDefault())})}))))}),c1="SelectItemText",OEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,className:n,style:i,...a}=e,o=ju(c1,r),s=d1(c1,r),l=NG(c1,r),c=iEe(c1,r),[f,u]=(0,je.useState)(null),h=lr(t,S=>u(S),l.onItemTextChange,S=>{var A;return(A=s.itemTextRefCallback)===null||A===void 0?void 0:A.call(s,S,l.value,l.disabled)}),g=f?.textContent,_=(0,je.useMemo)(()=>(0,je.createElement)("option",{key:l.value,value:l.value,disabled:l.disabled},g),[l.disabled,l.value,g]),{onNativeOptionAdd:w,onNativeOptionRemove:E}=c;return kn(()=>(w(_),()=>E(_)),[w,E,_]),(0,je.createElement)(je.Fragment,null,(0,je.createElement)(Ot.span,Ge({id:l.textId},a,{ref:h})),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?(0,P3.createPortal)(a.children,o.valueNode):null)}),AEe="SelectItemIndicator",IEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,...n}=e;return NG(AEe,r).isSelected?(0,je.createElement)(Ot.span,Ge({"aria-hidden":!0},n,{ref:t})):null});var CEe=(0,je.forwardRef)((e,t)=>{let{__scopeSelect:r,...n}=e;return(0,je.createElement)(Ot.div,Ge({"aria-hidden":!0},n,{ref:t}))});var LG=(0,je.forwardRef)((e,t)=>{let{value:r,...n}=e,i=(0,je.useRef)(null),a=lr(t,i),o=OG(r);return(0,je.useEffect)(()=>{let s=i.current,l=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==r&&f){let u=new Event("change",{bubbles:!0});f.call(s,r),s.dispatchEvent(u)}},[o,r]),(0,je.createElement)(AG,{asChild:!0},(0,je.createElement)("select",Ge({},n,{ref:a,defaultValue:r})))});LG.displayName="BubbleSelect";function PG(e){let t=rn(e),r=(0,je.useRef)(""),n=(0,je.useRef)(0),i=(0,je.useCallback)(o=>{let s=r.current+o;t(s),function l(c){r.current=c,window.clearTimeout(n.current),c!==""&&(n.current=window.setTimeout(()=>l(""),1e3))}(s)},[t]),a=(0,je.useCallback)(()=>{r.current="",window.clearTimeout(n.current)},[]);return(0,je.useEffect)(()=>()=>window.clearTimeout(n.current),[]),[r,i,a]}function FG(e,t,r){let i=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,a=r?e.indexOf(r):-1,o=TEe(e,Math.max(a,0));i.length===1&&(o=o.filter(c=>c!==r));let l=o.find(c=>c.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==r?l:void 0}function TEe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var DG=aEe,B3=sEe,BG=cEe,RG=uEe,MG=fEe,R3=dEe,jG=mEe,$G=wEe,M3=xEe,j3=EEe,UG=OEe,zG=IEe;var $3=CEe;var ki=oe(mt(),1),qG=DG,VG=$G,HG=BG,U3=Mp.forwardRef(({className:e,children:t,...r},n)=>(0,ki.jsxs)(B3,{ref:n,className:Nt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:[t,(0,ki.jsx)(RG,{asChild:!0,children:(0,ki.jsx)(wm,{className:"h-4 w-4 opacity-50"})})]}));U3.displayName=B3.displayName;var z3=Mp.forwardRef(({className:e,children:t,position:r="popper",...n},i)=>(0,ki.jsx)(MG,{children:(0,ki.jsx)(R3,{ref:i,className:Nt("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md animate-in fade-in-80",r==="popper"&&"translate-y-1",e),position:r,...n,children:(0,ki.jsx)(jG,{className:Nt("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));z3.displayName=R3.displayName;var q3=Mp.forwardRef(({className:e,...t},r)=>(0,ki.jsx)(M3,{ref:r,className:Nt("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));q3.displayName=M3.displayName;var V3=Mp.forwardRef(({className:e,children:t,...r},n)=>(0,ki.jsxs)(j3,{ref:n,className:Nt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[(0,ki.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,ki.jsx)(zG,{children:(0,ki.jsx)(Au,{className:"h-4 w-4"})})}),(0,ki.jsx)(UG,{children:t})]}));V3.displayName=j3.displayName;var LEe=Mp.forwardRef(({className:e,...t},r)=>(0,ki.jsx)($3,{ref:r,className:Nt("-mx-1 my-1 h-px bg-muted",e),...t}));LEe.displayName=$3.displayName;var PEe=Object.defineProperty,FEe=Object.getOwnPropertyNames,jp=(e=>typeof Mr<"u"?Mr:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof Mr<"u"?Mr:t)[r]}):e)(function(e){if(typeof Mr<"u")return Mr.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),L1=(e,t)=>function(){return e&&(t=(0,e[FEe(e)[0]])(e=0)),t},DEe=(e,t)=>{for(var r in t)PEe(e,r,{get:t[r],enumerable:!0})},WG,JG,H3,BEe,REe,$p,p1,GG,YG,KG,ac,w1,MEe,S1,W3,J3,XG,jEe,ZG,QG,eY,tY,rY,$Ee,yN=L1({"src/ble/node_modules/@capacitor/core/dist/index.js"(){WG=e=>{let t=new Map;t.set("web",{name:"web"});let r=e.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:t},n=(a,o)=>{r.platforms.set(a,o)},i=a=>{r.platforms.has(a)&&(r.currentPlatform=r.platforms.get(a))};return r.addPlatform=n,r.setPlatform=i,r},JG=e=>e.CapacitorPlatforms=WG(e),H3=JG(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),BEe=H3.addPlatform,REe=H3.setPlatform,function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}($p||($p={})),p1=class extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}},GG=e=>{var t,r;return e?.androidBridge?"android":!((r=(t=e?.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},YG=e=>{var t,r,n,i,a;let o=e.CapacitorCustomPlatform||null,s=e.Capacitor||{},l=s.Plugins=s.Plugins||{},c=e.CapacitorPlatforms,f=()=>o!==null?o.name:GG(e),u=((t=c?.currentPlatform)===null||t===void 0?void 0:t.getPlatform)||f,h=()=>u()!=="web",g=((r=c?.currentPlatform)===null||r===void 0?void 0:r.isNativePlatform)||h,_=P=>{let z=C.get(P);return!!(z?.platforms.has(u())||S(P))},w=((n=c?.currentPlatform)===null||n===void 0?void 0:n.isPluginAvailable)||_,E=P=>{var z;return(z=s.PluginHeaders)===null||z===void 0?void 0:z.find(ne=>ne.name===P)},S=((i=c?.currentPlatform)===null||i===void 0?void 0:i.getPluginHeader)||E,A=P=>e.console.error(P),O=(P,z,ne)=>Promise.reject(`${ne} does not have an implementation of "${z}".`),C=new Map,T=(P,z={})=>{let ne=C.get(P);if(ne)return console.warn(`Capacitor plugin "${P}" already registered. Cannot register plugins twice.`),ne.proxy;let V=u(),X=S(P),Q,ie=async()=>(!Q&&V in z?Q=typeof z[V]=="function"?Q=await z[V]():Q=z[V]:o!==null&&!Q&&"web"in z&&(Q=typeof z.web=="function"?Q=await z.web():Q=z.web),Q),pe=($,q)=>{var ae,le;if(X){let fe=X?.methods.find(Se=>q===Se.name);if(fe)return fe.rtype==="promise"?Se=>s.nativePromise(P,q.toString(),Se):(Se,ke)=>s.nativeCallback(P,q.toString(),Se,ke);if($)return(ae=$[q])===null||ae===void 0?void 0:ae.bind($)}else{if($)return(le=$[q])===null||le===void 0?void 0:le.bind($);throw new p1(`"${P}" plugin is not implemented on ${V}`,$p.Unimplemented)}},de=$=>{let q,ae=(...le)=>{let fe=ie().then(Se=>{let ke=pe(Se,$);if(ke){let xe=ke(...le);return q=xe?.remove,xe}else throw new p1(`"${P}.${$}()" is not implemented on ${V}`,$p.Unimplemented)});return $==="addListener"&&(fe.remove=async()=>q()),fe};return ae.toString=()=>`${$.toString()}() { [capacitor code] }`,Object.defineProperty(ae,"name",{value:$,writable:!1,configurable:!1}),ae},F=de("addListener"),H=de("removeListener"),Z=($,q)=>{let ae=F({eventName:$},q),le=async()=>{let Se=await ae;H({eventName:$,callbackId:Se},q)},fe=new Promise(Se=>ae.then(()=>Se({remove:le})));return fe.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await le()},fe},j=new Proxy({},{get($,q){switch(q){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return X?Z:F;case"removeListener":return H;default:return de(q)}}});return l[P]=j,C.set(P,{name:P,proxy:j,platforms:new Set([...Object.keys(z),...X?[V]:[]])}),j},D=((a=c?.currentPlatform)===null||a===void 0?void 0:a.registerPlugin)||T;return s.convertFileSrc||(s.convertFileSrc=P=>P),s.getPlatform=u,s.handleError=A,s.isNativePlatform=g,s.isPluginAvailable=w,s.pluginMethodNoop=O,s.registerPlugin=D,s.Exception=p1,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s.platform=s.getPlatform(),s.isNative=s.isNativePlatform(),s},KG=e=>e.Capacitor=YG(e),ac=KG(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),w1=ac.registerPlugin,MEe=ac.Plugins,S1=class{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);let n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n);let i=async()=>this.removeListener(e,t),a=Promise.resolve({remove:i});return Object.defineProperty(a,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await i()}}),a}async removeAllListeners(){this.listeners={};for(let e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t){let r=this.listeners[e];r&&r.forEach(n=>n(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new ac.Exception(e,$p.Unimplemented)}unavailable(e="not available"){return new ac.Exception(e,$p.Unavailable)}async removeListener(e,t){let r=this.listeners[e];if(!r)return;let n=r.indexOf(t);this.listeners[e].splice(n,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}},W3=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),J3=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent),XG=class extends S1{async getCookies(){let e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[n,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=J3(n).trim(),i=J3(i).trim(),t[n]=i}),t}async setCookie(e){try{let t=W3(e.key),r=W3(e.value),n=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),a=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${n}; path=${i}; ${a};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{let e=document.cookie.split(";")||[];for(let t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}},jEe=w1("CapacitorCookies",{web:()=>new XG}),ZG=async e=>new Promise((t,r)=>{let n=new FileReader;n.onload=()=>{let i=n.result;t(i.indexOf(",")>=0?i.split(",")[1]:i)},n.onerror=i=>r(i),n.readAsDataURL(e)}),QG=(e={})=>{let t=Object.keys(e);return Object.keys(e).map(i=>i.toLocaleLowerCase()).reduce((i,a,o)=>(i[a]=e[t[o]],i),{})},eY=(e,t=!0)=>e?Object.entries(e).reduce((n,i)=>{let[a,o]=i,s,l;return Array.isArray(o)?(l="",o.forEach(c=>{s=t?encodeURIComponent(c):c,l+=`${a}=${s}&`}),l.slice(0,-1)):(s=t?encodeURIComponent(o):o,l=`${a}=${s}`),`${n}&${l}`},"").substr(1):null,tY=(e,t={})=>{let r=Object.assign({method:e.method||"GET",headers:e.headers},t),i=QG(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(i.includes("application/x-www-form-urlencoded")){let a=new URLSearchParams;for(let[o,s]of Object.entries(e.data||{}))a.set(o,s);r.body=a.toString()}else if(i.includes("multipart/form-data")){let a=new FormData;if(e.data instanceof FormData)e.data.forEach((s,l)=>{a.append(l,s)});else for(let s of Object.keys(e.data))a.append(s,e.data[s]);r.body=a;let o=new Headers(r.headers);o.delete("content-type"),r.headers=o}else(i.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r},rY=class extends S1{async request(e){let t=tY(e,e.webFetchExtra),r=eY(e.params,e.shouldEncodeUrlParams),n=r?`${e.url}?${r}`:e.url,i=await fetch(n,t),a=i.headers.get("content-type")||"",{responseType:o="text"}=i.ok?e:{};a.includes("application/json")&&(o="json");let s,l;switch(o){case"arraybuffer":case"blob":l=await i.blob(),s=await ZG(l);break;case"json":s=await i.json();break;case"document":case"text":default:s=await i.text()}let c={};return i.headers.forEach((f,u)=>{c[u]=f}),{data:s,headers:c,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}},$Ee=w1("CapacitorHttp",{web:()=>new rY})}});function UEe(e){return new DataView(Uint8Array.from(e).buffer)}function zEe(e){return Array.from(new Uint8Array(e.buffer))}function qEe(e){return`0000${e.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}function x1(e){let t=e.trim().split(" ").filter(r=>r!=="").map(r=>parseInt(r,16));return UEe(t)}function G3(e){return zEe(e).map(t=>{let r=t.toString(16);return r.length==1&&(r="0"+r),r}).join(" ")}function VEe(e){if(typeof e=="string")return e;if(typeof e=="number")return qEe(e);throw new Error("Invalid UUID")}function nY(e){let t={};if(e)return e.forEach((r,n)=>{t[n.toString()]=r}),t}var mN=L1({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/conversion.js"(){}});async function HEe(e,t,r){let n;return Promise.race([e,new Promise((i,a)=>{n=setTimeout(()=>a(r),t)})]).finally(()=>clearTimeout(n))}var WEe=L1({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/timeout.js"(){}}),vY={};DEe(vY,{BluetoothLeWeb:()=>bY});var bY,JEe=L1({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/web.js"(){yN(),mN(),WEe(),bY=class extends S1{constructor(){super(...arguments),this.deviceMap=new Map,this.discoveredDevices=new Map,this.scan=null,this.DEFAULT_CONNECTION_TIMEOUT=1e4,this.onAdvertisementReceivedCallback=this.onAdvertisementReceived.bind(this),this.onDisconnectedCallback=this.onDisconnected.bind(this),this.onCharacteristicValueChangedCallback=this.onCharacteristicValueChanged.bind(this)}async initialize(){if(typeof navigator>"u"||!navigator.bluetooth)throw this.unavailable("Web Bluetooth API not available in this browser.");if(!await navigator.bluetooth.getAvailability())throw this.unavailable("No Bluetooth radio available.")}async isEnabled(){return{value:!0}}async enable(){throw this.unavailable("enable is not available on web.")}async disable(){throw this.unavailable("disable is not available on web.")}async startEnabledNotifications(){}async stopEnabledNotifications(){}async isLocationEnabled(){throw this.unavailable("isLocationEnabled is not available on web.")}async openLocationSettings(){throw this.unavailable("openLocationSettings is not available on web.")}async openBluetoothSettings(){throw this.unavailable("openBluetoothSettings is not available on web.")}async openAppSettings(){throw this.unavailable("openAppSettings is not available on web.")}async setDisplayStrings(){}async requestDevice(e){let t=this.getFilters(e),r=await navigator.bluetooth.requestDevice({filters:t.length?t:void 0,optionalServices:e?.optionalServices,acceptAllDevices:t.length===0});return this.deviceMap.set(r.id,r),this.getBleDevice(r)}async requestLEScan(e){this.requestBleDeviceOptions=e;let t=this.getFilters(e);await this.stopLEScan(),this.discoveredDevices=new Map,navigator.bluetooth.removeEventListener("advertisementreceived",this.onAdvertisementReceivedCallback),navigator.bluetooth.addEventListener("advertisementreceived",this.onAdvertisementReceivedCallback),this.scan=await navigator.bluetooth.requestLEScan({filters:t.length?t:void 0,acceptAllAdvertisements:t.length===0,keepRepeatedDevices:e?.allowDuplicates})}onAdvertisementReceived(e){var t,r;let n=e.device.id;if(this.deviceMap.set(n,e.device),!this.discoveredDevices.has(n)||!((t=this.requestBleDeviceOptions)===null||t===void 0)&&t.allowDuplicates){this.discoveredDevices.set(n,!0);let a=this.getBleDevice(e.device),o={device:a,localName:a.name,rssi:e.rssi,txPower:e.txPower,manufacturerData:nY(e.manufacturerData),serviceData:nY(e.serviceData),uuids:(r=e.uuids)===null||r===void 0?void 0:r.map(VEe)};this.notifyListeners("onScanResult",o)}}async stopLEScan(){var e;!((e=this.scan)===null||e===void 0)&&e.active&&this.scan.stop(),this.scan=null}async getDevices(e){return{devices:(await navigator.bluetooth.getDevices()).filter(n=>e.deviceIds.includes(n.id)).map(n=>(this.deviceMap.set(n.id,n),this.getBleDevice(n)))}}async getConnectedDevices(e){return{devices:(await navigator.bluetooth.getDevices()).filter(n=>{var i;return(i=n.gatt)===null||i===void 0?void 0:i.connected}).map(n=>(this.deviceMap.set(n.id,n),this.getBleDevice(n)))}}async connect(e){var t,r;let n=this.getDeviceFromMap(e.deviceId);n.removeEventListener("gattserverdisconnected",this.onDisconnectedCallback),n.addEventListener("gattserverdisconnected",this.onDisconnectedCallback);let i=Symbol();if(n.gatt===void 0)throw new Error("No gatt server available.");try{let a=(t=e.timeout)!==null&&t!==void 0?t:this.DEFAULT_CONNECTION_TIMEOUT;await HEe(n.gatt.connect(),a,i)}catch(a){throw await((r=n.gatt)===null||r===void 0?void 0:r.disconnect()),a===i?new Error("Connection timeout"):a}}onDisconnected(e){let r=`disconnected|${e.target.id}`;this.notifyListeners(r,null)}async createBond(e){throw this.unavailable("createBond is not available on web.")}async isBonded(e){throw this.unavailable("isBonded is not available on web.")}async disconnect(e){var t;(t=this.getDeviceFromMap(e.deviceId).gatt)===null||t===void 0||t.disconnect()}async getServices(e){var t,r;let n=(r=await((t=this.getDeviceFromMap(e.deviceId).gatt)===null||t===void 0?void 0:t.getPrimaryServices()))!==null&&r!==void 0?r:[],i=[];for(let a of n){let o=await a.getCharacteristics(),s=[];for(let l of o)s.push({uuid:l.uuid,properties:this.getProperties(l),descriptors:await this.getDescriptors(l)});i.push({uuid:a.uuid,characteristics:s})}return{services:i}}async getDescriptors(e){try{return(await e.getDescriptors()).map(r=>({uuid:r.uuid}))}catch{return[]}}getProperties(e){return{broadcast:e.properties.broadcast,read:e.properties.read,writeWithoutResponse:e.properties.writeWithoutResponse,write:e.properties.write,notify:e.properties.notify,indicate:e.properties.indicate,authenticatedSignedWrites:e.properties.authenticatedSignedWrites,reliableWrite:e.properties.reliableWrite,writableAuxiliaries:e.properties.writableAuxiliaries}}async getCharacteristic(e){var t;let r=await((t=this.getDeviceFromMap(e.deviceId).gatt)===null||t===void 0?void 0:t.getPrimaryService(e?.service));return r?.getCharacteristic(e?.characteristic)}async getDescriptor(e){let t=await this.getCharacteristic(e);return t?.getDescriptor(e?.descriptor)}async discoverServices(e){throw this.unavailable("discoverServices is not available on web.")}async getMtu(e){throw this.unavailable("getMtu is not available on web.")}async requestConnectionPriority(e){throw this.unavailable("requestConnectionPriority is not available on web.")}async readRssi(e){throw this.unavailable("readRssi is not available on web.")}async read(e){let t=await this.getCharacteristic(e);return{value:await t?.readValue()}}async write(e){let t=await this.getCharacteristic(e),r;typeof e.value=="string"?r=x1(e.value):r=e.value,await t?.writeValueWithResponse(r)}async writeWithoutResponse(e){let t=await this.getCharacteristic(e),r;typeof e.value=="string"?r=x1(e.value):r=e.value,await t?.writeValueWithoutResponse(r)}async readDescriptor(e){let t=await this.getDescriptor(e);return{value:await t?.readValue()}}async writeDescriptor(e){let t=await this.getDescriptor(e),r;typeof e.value=="string"?r=x1(e.value):r=e.value,await t?.writeValue(r)}async startNotifications(e){let t=await this.getCharacteristic(e);t?.removeEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback),t?.addEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback),await t?.startNotifications()}onCharacteristicValueChanged(e){var t,r;let n=e.target,i=`notification|${(t=n.service)===null||t===void 0?void 0:t.device.id}|${(r=n.service)===null||r===void 0?void 0:r.uuid}|${n.uuid}`;this.notifyListeners(i,{value:n.value})}async stopNotifications(e){let t=await this.getCharacteristic(e);await t?.stopNotifications()}getFilters(e){var t;let r=[];for(let n of(t=e?.services)!==null&&t!==void 0?t:[])r.push({services:[n],name:e?.name,namePrefix:e?.namePrefix});return(e?.name||e?.namePrefix)&&r.length===0&&r.push({name:e.name,namePrefix:e.namePrefix}),r}getDeviceFromMap(e){let t=this.deviceMap.get(e);if(t===void 0)throw new Error('Device not found. Call "requestDevice", "requestLEScan" or "getDevices" first.');return t}getBleDevice(e){var t;return{deviceId:e.id,name:(t=e.name)!==null&&t!==void 0?t:void 0}}}}}),GEe=Object.create,vN=Object.defineProperty,YEe=Object.getOwnPropertyDescriptor,_Y=Object.getOwnPropertyNames,KEe=Object.getPrototypeOf,XEe=Object.prototype.hasOwnProperty,ZEe=(e,t,r)=>t in e?vN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,QEe=(e=>typeof jp<"u"?jp:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof jp<"u"?jp:t)[r]}):e)(function(e){if(typeof jp<"u")return jp.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),eOe=(e,t)=>function(){return t||(0,e[_Y(e)[0]])((t={exports:{}}).exports,t),t.exports},tOe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of _Y(t))!XEe.call(e,i)&&i!==r&&vN(e,i,{get:()=>t[i],enumerable:!(n=YEe(t,i))||n.enumerable});return e},rOe=(e,t,r)=>(r=e!=null?GEe(KEe(e)):{},tOe(t||!e||!e.__esModule?vN(r,"default",{value:e,enumerable:!0}):r,e)),nOe=(e,t,r)=>(ZEe(e,typeof t!="symbol"?t+"":t,r),r),iOe=eOe({"node_modules/web-worker/cjs/browser.js"(e,t){t.exports=Worker}}),aOe=class{data={};triggers={};ctr=0;constructor(e){typeof e=="object"&&(this.data=e)}setState=e=>{Object.assign(this.data,e);let t=Object.getOwnPropertyNames(e);for(let r of t)this.triggerEvent(r,this.data[r]);if(this.triggers[Hm]){let r=i=>{i(e)},n=this.triggers[Hm].length;for(let i=n-1;i>=0;i--)r(this.triggers[Hm][i].onchange)}return this.data};setValue=(e,t)=>{this.data[e]=t,this.triggerEvent(e,t)};triggerEvent=(e,t)=>{if(this.triggers[e]){let r=i=>{i.onchange(t)},n=this.triggers[e].length;for(let i=n-1;i>=0;i--)r(this.triggers[e][i])}};subscribeState=e=>this.subscribeEvent(Hm,e);unsubscribeState=e=>this.unsubscribeEvent(Hm,e);subscribeEvent=(e,t,r,n)=>{if(e){r&&n&&!this.triggers[e]&&Object.defineProperty(this.data,e,{get:()=>r[n],set:a=>{r[n]=a},enumerable:!0,configurable:!0}),this.triggers[e]||(this.triggers[e]=[]);let i=this.ctr;return this.ctr++,this.triggers[e].push({sub:i,onchange:t}),i}else return};unsubscribeEvent=(e,t)=>{let r=this.triggers[e];if(r)if(t===void 0)delete this.triggers[e],delete this.data[e];else{let n,i=r.find((a,o)=>{if(a.sub===t)return n=o,!0});return i&&r.splice(n,1),Object.keys(r).length===0&&(delete this.triggers[e],delete this.data[e]),this.onRemoved&&this.onRemoved(i),!0}};subscribeEventOnce=(e,t)=>{let r,n=i=>{t(i),this.unsubscribeEvent(e,r)};return r=this.subscribeEvent(e,n),r};getEvent=(e,t)=>{for(let r in this.triggers[e])if(this.triggers[e][r].sub===t)return this.triggers[e][r]};getSnapshot=()=>{let e={};for(let t in this.data)e[t]=this.data[t]};onRemoved},Hm="*s",wY=new aOe,yr=class{__node={tag:`node${Math.floor(Math.random()*1e15)}`,unique:`${Math.floor(Math.random()*1e15)}`,state:wY};__children;__parent;__operator;__listeners;__props;__args;constructor(e,t,r){this.__setProperties(e,t,r)}__setProperties=(e,t,r)=>{if((()=>{let i=e;typeof e=="function"?aN(e)?e=new e:e={__operator:e,__node:{forward:!0,tag:e.name}}:typeof e=="string"&&r?.get(e)&&(e=r.get(e)),"__node"in e||(e.__node={}),e.__node.initial||(e.__node.initial=i)})(),typeof e=="object"){let i=()=>{e.__node?.state?this.__node.state=e.__node.state:r&&(e.__node.state=r.__node.state)},a=()=>{e.__props&&(typeof e.__props=="function"&&(e.__props=new e.__props),typeof e.__props=="object"&&this.__proxyObject(e.__props))},o=()=>{e.__node.tag||(e.__operator?.name?e.__node.tag=e.__operator.name:e.__node.tag=`node${Math.floor(Math.random()*1e15)}`)},s=()=>{typeof e.__node=="string"?r?.get(e.__node.tag)?e=r.get(e.__node.tag):e.__node={}:e.__node||(e.__node={}),r&&(e.__node.graph=r),e instanceof Uu&&(e.__node.source=e)},l=()=>{if(!e.__parent&&t&&(e.__parent=t),t?.__node&&!(t instanceof Uu||e instanceof Uu)&&(e.__node.tag=t.__node.tag+"."+e.__node.tag),t instanceof Uu&&e instanceof Uu&&(e.__node.loaders&&Object.assign(t.__node.loaders?t.__node.loaders:{},e.__node.loaders),t.__node.mapGraphs)){e.__node.nodes.forEach(g=>{t.set(e.__node.tag+"."+g.__node.tag,g)});let h=()=>{e.__node.nodes.forEach(g=>{t.__node.nodes.delete(e.__node.tag+"."+g.__node.tag)})};this.__addOndisconnected(h)}},c=()=>{if(typeof e.default=="function"&&!e.__operator&&(e.__operator=e.default),e.__operator){if(typeof e.__operator=="string"&&r){let h=r.get(e.__operator);h&&(e.__operator=h.__operator),!e.__node.tag&&e.__operator.name&&(e.__node.tag=e.__operator.name)}typeof e.__operator=="function"&&(e.__operator=this.__setOperator(e.__operator)),e.default&&(e.default=e.__operator)}},f=()=>{e.__node=Object.assign(this.__node,e.__node);let h=Object.getOwnPropertyNames(e).filter(g=>{if(!sN[g])return!0});for(let g of h)g in e&&(this[g]=e[g])},u=()=>{this.__onconnected&&(typeof this.__onconnected=="function"?this.__onconnected=this.__onconnected.bind(this):Array.isArray(this.__onconnected)&&(this.__onconnected=this.__onconnected.map(h=>h.bind(this))),typeof this.__ondisconnected=="function"?this.__ondisconnected=this.__ondisconnected.bind(this):Array.isArray(this.__ondisconnected)&&(this.__ondisconnected=this.__ondisconnected.map(h=>h.bind(this))))};i(),o(),a(),s(),l(),f(),u(),c()}};__subscribe=(e,t,r,n,i,a)=>{let o=(l,c=(u,h)=>h||u,f=e)=>{let u;if(a){let _=oN(f,a,this.__node.graph);f=_.__callback,u=_.__args}let h=this.__node.state.subscribeEvent(l,f,this,t),g=this.__node.state.getEvent(l,h);return this.__listeners||(this.__listeners={}),this.__listeners[l]=this.__node.state.triggers[l],g&&(g.source=this.__node.tag,t&&(g.key=t),g.target=c(e,n),r&&(g.subInput=r),a&&(g.arguments=a,g.__args=u),i&&(g.tkey=i),g.node=this,g.graph=this.__node.graph),h},s=l=>{let c=this.__node.graph.get(l);if(!c&&l.includes(".")){n=l.substring(0,l.lastIndexOf("."));let f=this.__node.graph.get(l.substring(0,n));i=l.lastIndexOf(".")+1,f&&typeof f[t]=="function"&&(l=(...u)=>f[i](...u))}else c.__operator&&(l=c.__operator,i="__operator")};if(t){if((!this.__node.localState||!this.__node.localState[t])&&this.__addLocalState(this,t),typeof e=="string"){if(i=e,n){if(this.__node.graph?.get(n)){let f=this.__node.graph?.get(n);if(typeof f[e]=="function"){let u=f[e];e=(...h)=>{u(...h)}}else{let u=e;e=g=>{f[u]=g}}}}else if(typeof this[e]=="function"){let f=this[e];e=(...u)=>{f(...u)}}else this.__node.graph?.get(e)&&s(e);if(typeof e!="function")return}let l,c=r?this.__node.unique+"."+t+"input":this.__node.unique+"."+t;return typeof e=="function"?l=o(c,(f,u)=>u||f,e):e?.__node&&(l=o(c,(f,u)=>u||f.__node.unique,(...f)=>{e.__operator&&e.__operator(...f)})),l}else{if(typeof e=="string"&&(this.__node.graph.get(e)&&(e=this.__node.graph.get(e)),i="__operator",typeof e!="object"))return;let l,c=r?this.__node.unique+"input":this.__node.unique;return typeof e=="function"?l=o(c,(f,u)=>u||f,e):e?.__node&&(l=o(c,(f,u)=>u||f.__node.unique,(...f)=>{e.__operator&&e.__operator(...f)})),l}};__unsubscribe=(e,t,r)=>t?this.__node.state.unsubscribeEvent(r?this.__node.unique+"."+t+"input":this.__node.unique+"."+t,e):this.__node.state.unsubscribeEvent(r?this.__node.unique+"input":this.__node.unique,e);__setOperator=e=>{e=e.bind(this),this.__args&&this.__node.graph&&(e=oN(e,this.__args,this.__node.graph).__callback);let t=`${this.__node.unique}input`;if(this.__operator=(...r)=>{this.__node.state.triggers[t]&&this.__node.state.setValue(t,r);let n=e(...r);return this.__node.state.triggers[this.__node.unique]&&(typeof n?.then=="function"?n.then(i=>{i!==void 0&&this.__node.state.setValue(this.__node.unique,i)}).catch(console.error):n!==void 0&&this.__node.state.setValue(this.__node.unique,n)),n},this.__parent instanceof yr&&!this.__subscribedToParent&&this.__parent.__operator){let r=this.__parent.__subscribe(this),n=()=>{this.__parent?.__unsubscribe(r),delete this.__subscribedToParent};this.__addOndisconnected(n),this.__subscribedToParent=!0}return this.__operator};__addLocalState=(e,t)=>{if(!e)return;this.__node.localState||(this.__node.localState={});let r=this.__node.localState,n=(i,a)=>{let o=this.__node.unique+"."+a,s=`${o}input`,l,c,f,u;if(typeof i[a]=="function"&&a!=="__operator")this.__props?.[a]?f=this.__props:f=r,l=()=>f[a],c=h=>{this.__props?.[a]||(h=h.bind(this)),f[a]=(...g)=>{this.__node.state.triggers[s]&&this.__node.state.setValue(s,g);let _=h(...g);return this.__node.state.triggers[o]&&(typeof _?.then=="function"?_.then(w=>{this.__node.state.triggerEvent(o,w)}).catch(console.error):this.__node.state.triggerEvent(o,_)),_}},r[a]=i[a].bind(this),u={get:l,set:c,enumerable:!0,configurable:!0};else{let h,g,_;this.__props?.[a]?_=this.__props:_=r,h=()=>_[a],g=w=>{_[a]=w,this.__node.state.triggers[o]&&this.__node.state.triggerEvent(o,w)},r[a]=i[a],u={get:h,set:g,enumerable:!0,configurable:!0}}if(Object.defineProperty(i,a,u),typeof this.__node.initial=="object"){let h=Object.getOwnPropertyDescriptor(this.__node.initial,a);(h===void 0||h?.configurable)&&Object.defineProperty(this.__node.initial,a,u)}};if(t)n(e,t);else for(let i in e)n(e,i)};__proxyObject=e=>{let t=oOe(e);for(let r of t){let n={get:()=>e[r],set:i=>{e[r]=i},enumerable:!0,configurable:!0};if(Object.defineProperty(this,r,n),typeof this.__node.initial=="object"){let i=Object.getOwnPropertyDescriptor(this.__node.initial,r);(i===void 0||i?.configurable)&&Object.defineProperty(this.__node.initial,r,n)}}};__addOnconnected(e){e=e.bind(this),Array.isArray(this.__onconnected)?this.__onconnected.push(e):typeof this.__onconnected=="function"?this.__onconnected=[e,this.__onconnected]:this.__onconnected=e}__addOndisconnected(e){e=e.bind(this),Array.isArray(this.__ondisconnected)?this.__ondisconnected.push(e):typeof this.__ondisconnected=="function"?this.__ondisconnected=[e,this.__ondisconnected]:this.__ondisconnected=e}__callConnected(e=this){if(typeof this.__onconnected=="function")this.__onconnected(this);else if(Array.isArray(this.__onconnected)){let t=r=>{r(this)};this.__onconnected.forEach(t)}}__callDisconnected(e=this){if(typeof this.__ondisconnected=="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let t=r=>{r(this)};this.__ondisconnected.forEach(t)}}},Uu=class{__node={tag:`graph${Math.floor(Math.random()*1e15)}`,unique:`${Math.random()}`,nodes:new Map,state:wY,roots:{}};constructor(e){this.init(e)}init=e=>{if(e){let t=Object.assign({},e);delete t.roots,Zm(this.__node,t),e.roots&&this.load(e.roots)}};load=e=>{function t(i,a,o=!0,s=!0){if(s&&(i?Object.assign(i,a):i=Object.assign({},a),t(i,a,!0,!1)),a?.__children&&!o)a.__children?.constructor.name==="Object"?i.__children?.constructor.name==="Object"?t(i.__children,a.__children,!0,!1):i.__children=t({},a.__children,!0,!1):i.__children=a.__children;else if(o)for(let l in a)i[l]=Object.assign({},a[l]),a[l]?.__children&&t({},a[l].__children,!1,!1);return i}this.__node.roots=t(this.__node.roots?this.__node.roots:{},e);let r=Object.assign({},e);r.__node&&delete r.__node;let n=this.recursiveSet(r,this,void 0,e);if(e.__node){if(!e.__node.tag)e.__node._tag=`roots${Math.floor(Math.random()*1e15)}`;else if(!this.get(e.__node.tag)){let i=new yr(e,this,this);this.set(i.__node.tag,i),this.runLoaders(i,this,e,e.__node.tag),i.__listeners&&(n[i.__node.tag]=i.__listeners)}}else e.__listeners&&this.setListeners(e.__listeners);return this.setListeners(n),r};setLoaders=(e,t)=>(t?this.__node.loaders=e:Object.assign(this.__node.loaders,e),this.__node.loaders);runLoaders=(e,t,r,n)=>{for(let i in this.__node.loaders)typeof this.__node.loaders[i]=="object"?(this.__node.loaders[i].init&&this.__node.loaders[i](e,t,this,this.__node.roots,r,n),this.__node.loaders[i].connected&&e.__addOnconnected(this.__node.loaders[i].connect),this.__node.loaders[i].disconnected&&e.__addOndisconnected(this.__node.loaders[i].disconnect)):typeof this.__node.loaders[i]=="function"&&this.__node.loaders[i](e,t,this,this.__node.roots,r,n)};add=(e,t)=>{let r={};typeof t=="string"&&(t=this.get(t));let n;if(typeof e=="function"?aN(e)?e.prototype instanceof yr?(e=e.prototype.constructor(e,t,this),n=!0):e=new e:e={__operator:e}:typeof e=="string"&&(e=this.__node.roots[e]),!!e){if(!n){let i=Object.getOwnPropertyNames(e),a=Object.getOwnPropertyNames(Object.getPrototypeOf(e));i.push(...a),i=i.filter(s=>!sN.includes(s));let o={};for(let s of i)o[s]=e[s];e=o}if(e.__node||(e.__node={}),e.__node.initial=e,typeof e=="object"&&!this.get(e.__node.tag)){let i,a=Zm({},e,2);if(n?i=e:i=new yr(e,t,this),this.set(i.__node.tag,i),this.runLoaders(i,t,e,i.__node.tag),this.__node.roots[i.__node.tag]=a,i.__children&&(i.__children=Object.assign({},i.__children),this.recursiveSet(i.__children,i,r,i.__children)),i.__listeners){r[i.__node.tag]=Object.assign({},i.__listeners);for(let o in i.__listeners){let s=i.__listeners[o];i[o]&&(delete r[i.__node.tag][o],r[i.__node.tag][i.__node.tag+"."+o]=s),typeof s=="string"&&(i.__children?.[s]?r[i.__node.tag][o]=i.__node.tag+"."+s:t instanceof yr&&(t.__node.tag===s||t.__node.tag.includes(".")&&t.__node.tag.split(".").pop()===s)&&(r[i.__node.tag][o]=t.__node.tag))}}return this.setListeners(r),i.__callConnected(),i}else if(e.__node.tag)return this.get(e.__node.tag)}};recursiveSet=(e,t,r={},n)=>{let i=Object.getOwnPropertyNames(n),a=Object.getOwnPropertyNames(Object.getPrototypeOf(n)).filter(o=>!sN.includes(o));i.push(...a);for(let o of i){if(o.includes("__"))continue;let s=n[o];if(Array.isArray(s))continue;let l;if(typeof s=="function"?aN(s)?(s=new s,s instanceof yr&&(s=s.prototype.constructor(s,t,this),l=!0)):s={__operator:s}:typeof s=="string"?this.__node.nodes.get(s)?s=this.__node.nodes.get(s):s=this.__node.roots[s]:typeof s=="boolean"&&(this.__node.nodes.get(o)?s=this.__node.nodes.get(o):s=this.__node.roots[o]),s instanceof Object){if(!l&&!(s instanceof yr)){let h=Object.getOwnPropertyNames(s),g=Object.getOwnPropertyNames(Object.getPrototypeOf(s));g.splice(g.indexOf("constructor"),1),h.push(...g);let _={};for(let w of h)_[w]=s[w];s=_}if(s.__node||(s.__node={}),s.__node.tag||(s.__node.tag=o),s.__node.initial||(s.__node.initial=e[o]),this.get(s.__node.tag)&&!(!(t instanceof Uu)&&t?.__node)||t?.__node&&this.get(t.__node.tag+"."+s.__node.tag))continue;let c,f=!1,u=Zm({},s,2);if(l||s instanceof yr?c=s:(c=new yr(s,t,this),f=!0),!f&&s instanceof yr&&!l&&t instanceof yr){let h=this.subscribe(t.__node.tag,c.__node.tag),g=_=>{this.unsubscribe(t.__node.tag,h)};c.__addOndisconnected(g)}else if(c){if(this.set(c.__node.tag,c),this.runLoaders(c,t,e[o],o),e[o]=c,this.__node.roots[c.__node.tag]=u,c.__children&&(c.__children=Object.assign({},c.__children),this.recursiveSet(c.__children,c,r,c.__children)),c.__listeners){r[c.__node.tag]=Object.assign({},c.__listeners);for(let h in c.__listeners){let g=c.__listeners[h],_=h;c[h]&&(delete r[c.__node.tag][h],_=c.__node.tag+"."+h,r[c.__node.tag][_]=g),typeof g=="string"&&(c.__children?.[g]?r[c.__node.tag][_]=c.__node.tag+"."+g:t instanceof yr&&(t.__node.tag===g||t.__node.tag.includes(".")&&t.__node.tag.split(".").pop()===g)&&(r[c.__node.tag][_]=t.__node.tag))}}c.__callConnected()}}}return r};remove=(e,t=!0)=>{if(this.unsubscribe(e),typeof e=="string"&&(e=this.get(e)),e instanceof yr){this.delete(e.__node.tag),delete this.__node.roots[e.__node.tag],t&&this.clearListeners(e),e.__callDisconnected();let r=n=>{for(let i in n)this.unsubscribe(n[i]),this.delete(n[i].__node.tag),delete this.__node.roots[n[i].__node.tag],this.delete(i),delete this.__node.roots[i],n[i].__node.tag=n[i].__node.tag.substring(n[i].__node.tag.lastIndexOf(".")+1),t&&this.clearListeners(n[i]),n[i].__callDisconnected(),n[i].__children&&r(n[i].__children)};e.__children&&r(e.__children)}return e?.__node.tag&&e?.__parent&&(delete e?.__parent,e.__node.tag=e.__node.tag.substring(e.__node.tag.indexOf(".")+1)),e?.__node.graph&&(e.__node.graph=void 0),e};run=(e,...t)=>{if(typeof e=="string"){let r=this.get(e);if(!r&&e.includes(".")){if(r=this.get(e.substring(0,e.lastIndexOf("."))),typeof r?.[e.substring(e.lastIndexOf(".")+1)]=="function")return r[e.substring(e.lastIndexOf(".")+1)](...t)}else if(r?.__operator)return r.__operator(...t)}if(e?.__operator)return e?.__operator(...t)};setListeners=e=>{for(let t in e){let r=this.get(t);if(typeof e[t]=="object")for(let n in e[t]){let i=this.get(n),a;if(typeof e[t][n]!="object")e[t][n]={__callback:e[t][n]};else if(!e[t][n].__callback)for(let o in e[t][n]){typeof e[t][n][o]!="object"&&(e[t][n][o]={__callback:e[t][n][o]},r.__operator&&(e[t][n][o].__callback===!0||typeof e[t][n][o].__callback>"u")&&(e[t][n][o].__callback=r.__operator));let s=this.get(o);if(s)a=this.subscribe(s,e[t][n][o].__callback,e[t][n].__args,void 0,e[t][n].inputState,t,n);else{let l=n.substring(0,n.lastIndexOf("."));if(s=this.get(l),s){let c=n.substring(n.lastIndexOf(".")+1);a=this.subscribe(s,e[t][n][o].__callback,e[t][n][o].__args,c,e[t][n][o].inputState,t,n)}}}if("__callback"in e[t][n])if(r&&((e[t][n].__callback===!0||typeof e[t][n].__callback>"u")&&(e[t][n].__callback=r.__operator),typeof e[t][n].__callback=="function"&&(e[t][n].__callback=e[t][n].__callback.bind(r))),i)a=this.subscribe(i,e[t][n].__callback,e[t][n].__args,void 0,e[t][n].inputState,t,n);else{let o=n.substring(0,n.lastIndexOf("."));i=this.get(o),i&&(a=this.subscribe(i,e[t][n].__callback,e[t][n].__args,n.substring(n.lastIndexOf(".")+1),e[t][n].inputState,t,n))}}}};clearListeners=(e,t)=>{if(typeof e=="string"&&(e=this.get(e)),e?.__listeners)for(let r in e.__listeners){if(t&&r!==t||typeof e.__listeners[r]?.sub!="number")continue;let n=this.get(r);if(n)if(typeof!e.__listeners[r]?.__callback=="number")for(let i in e.__listeners[r])e.__listeners[r][i]?.sub&&(this.unsubscribe(n,e.__listeners[r][i].sub,void 0,e.__listeners[r][i].inputState),e.__listeners[r][i].sub=void 0);else typeof e.__listeners[r]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r].sub,void 0,e.__listeners[r].inputState),e.__listeners[r].sub=void 0);else if(n=this.get(r.substring(0,r.lastIndexOf("."))),n)if(typeof e.__listeners[r]=="object"&&!e.__listeners[r]?.__callback)for(let i in e.__listeners[r])typeof e.__listeners[r][i]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r][i].sub,r.substring(r.lastIndexOf(".")+1),e.__listeners[r][i].inputState),e.__listeners[r][i].sub=void 0);else typeof e.__listeners[r]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r].sub,r.substring(r.lastIndexOf(".")+1),e.__listeners[r].inputState),e.__listeners[r].sub=void 0)}};get=e=>this.__node.nodes.get(e);set=(e,t)=>this.__node.nodes.set(e,t);delete=e=>this.__node.nodes.delete(e);getProps=(e,t)=>{if(typeof e=="string"&&(e=this.get(e)),e instanceof yr){let r;if(t)r=Object.assign({},this.__node.roots[e.__node.tag]);else{r=Object.assign({},e);for(let n in r)n.includes("__")&&delete r[n]}}};subscribe=(e,t,r,n,i,a,o,s)=>{let l=e;if(typeof e=="string"&&(l=this.get(e),!l&&e.includes(".")&&(l=this.get(e.substring(0,e.lastIndexOf("."))),n=e.substring(e.lastIndexOf(".")+1))),a instanceof yr&&(a=a.__node.tag),typeof t=="string"){let f=u=>{if(this.get(u)?.__operator){let h=this.get(u);a=u,u=function(...g){return h.__operator(...g)}}else if(u.includes(".")){a=u.substring(0,u.lastIndexOf("."));let h=this.get(a),g=u.substring(u.lastIndexOf(".")+1);s=g,typeof h[g]=="function"?h[g]instanceof yr?u=h[g]:u=function(..._){return h[g](..._)}:u=function(_){return h[g]=_,h[g]}}return u};if(a){let u=this.get(a);typeof u?.[t]=="function"?(s=t,t=function(...h){return u[n](...h)}):u[n]?(s=n,u[n]instanceof yr?t=u[n]:t=function(h){return u[n]=h,u[n]}):t=f(t)}else t=f(t)}let c;if(l instanceof yr){let f=()=>{c=l.__subscribe(t,n,i,a,s,r);let u=()=>{c!==void 0&&l.__unsubscribe(c,n,i),c=void 0};l.__addOndisconnected(()=>{u(),l.__addOnconnected(()=>{c===void 0&&l.__node.graph.__node.tag===this.__node.tag&&f()})}),typeof t=="string"&&this.get(t)&&(t=this.get(t)),t instanceof yr&&t.__addOndisconnected(()=>{u()})};f()}else if(typeof e=="string"){let f=this.get(e);if(f){if(t instanceof yr&&t.__operator){let u=()=>{c=f.__subscribe(t.__operator,n,i,a,s,r);let h=()=>{c!==void 0&&f.__unsubscribe(c,n,i)};f.__addOndisconnected(()=>{h(),f.__addOnconnected(()=>{c===void 0&&f.__node.graph.__node.tag===this.__node.tag&&u()})}),t.__addOndisconnected(h)};u()}else if(typeof t=="function"||typeof t=="string"){let u=()=>{c=f.__subscribe(t,n,i,a,s,r);let h=()=>{c!==void 0&&f.__unsubscribe(c,n,i),c=void 0};f.__addOndisconnected(()=>{h(),f.__addOnconnected(()=>{c===void 0&&f.__node.graph.__node.tag===this.__node.tag&&u()})}),typeof t=="string"&&this.get(t)&&this.get(t).__addOndisconnected(h)};u()}}else typeof t=="string"&&(t=this.__node.nodes.get(t).__operator),typeof t=="function"&&(c=this.__node.state.subscribeEvent(e,t))}return c};unsubscribe=(e,t,r,n)=>e instanceof yr?e.__unsubscribe(t,r,n):this.get(e)?.__unsubscribe(t,r,n);setState=e=>{this.__node.state.setState(e)}};function Zm(e,t,r=1/0,n=0){for(let i in t)t[i]?.constructor.name==="Object"&&n<r?(n++,e[i]?.constructor.name==="Object"?Zm(e[i],t[i],r,n):e[i]=Zm({},t[i],r,n)):e[i]=t[i];return e}function oOe(e){var t=[],r=e;do{var n=Object.getOwnPropertyNames(r);let i=function(a){t.indexOf(a)===-1&&t.push(a)};n.forEach(i)}while(r=Object.getPrototypeOf(r));return t}function aN(e){return sOe(e)==="class"}function sOe(e){return typeof e=="function"?e.prototype?Object.getOwnPropertyDescriptor(e,"prototype")?.writable?"function":"class":e.constructor.name==="AsyncFunction"?"async":"arrow":""}var h1=(e,t)=>{if(t.get(e)?.__operator){let r=t.get(e);return(...n)=>{r.__operator(...n)}}else if(e.includes(".")){let r=e.split("."),n=r.pop(),i=r.join("."),a=t.get(i);return typeof t.get(i)?.[n]=="function"?(...o)=>a[n](...o):()=>a[n]}else if(t.get(e)){let r=t.get(e);return()=>r}else{let r=e;return()=>r}},oN=(e,t,r)=>{let n=[],i=(o,s)=>{if(o==="__output"||o==="__input"||o==="__callback")n[s]={__callback:l=>l,__args:void 0,idx:s};else if(typeof o=="string")n[s]={__callback:h1(o,r),__args:void 0,idx:s};else if(typeof o=="function"){let l=o;n[s]={__callback:(...c)=>l(...c),__args:void 0,idx:s}}else if(typeof o=="object"&&(o.__input||o.__callback)){let l=function(c){let f=c.__input?c.__input:c.__callback;if(typeof c.__input=="string"&&(f={__callback:h1(c.__input,r),__args:void 0,idx:s}),c.__args){let u=oN(f,c.__args,r);f={__callback:u.__callback,__args:u.__args,idx:s}}else f={__callback:f,__args:void 0,idx:s};if(c.__output){let u=c.__output;if(typeof c.__output=="string"?u={__callback:h1(u,r),__args:void 0,idx:s}:typeof o.__output=="object"&&(u=l(u)),typeof u?.__callback=="function"){let h=f.__callback,g=u.__callback;f={__callback:(..._)=>g(h(..._)),__args:u.__args,idx:s}}}return f};n[s]=l(o)}else{let l=o;n[s]={__callback:()=>l,__args:void 0,idx:s}}};t.forEach(i),typeof e=="string"&&(e={__callback:h1(e,r),__args:void 0});let a=typeof e=="function"?e:e.__callback;return e=function(...o){let s=c=>c.__callback(...o);return a(...n.map(s))},{__callback:e,__args:n}},sN=Object.getOwnPropertyNames(Object.getPrototypeOf({})),lOe=(e,t,r)=>{e.__node.backward&&t instanceof yr&&r.setListeners({[t.__node.tag]:{[e.__node.tag]:t}})},cOe=(e,t,r)=>{if(e.__operator&&!e.__node.looperSet){if(typeof e.__node.delay=="number"){let n=e.__operator;e.__setOperator((...i)=>new Promise((a,o)=>{setTimeout(async()=>{a(await n(...i))},e.__node.delay)}))}else if(e.__node.frame===!0){let n=e.__operator;e.__setOperator((...i)=>new Promise((a,o)=>{requestAnimationFrame(async()=>{a(await n(...i))})}))}if(typeof e.__node.repeat=="number"||typeof e.__node.recursive=="number"){let n=e.__operator;e.__setOperator(async(...i)=>{let a=e.__node.repeat?e.__node.repeat:e.__node.recursive,o,s=async(l,...c)=>{for(;l>0;){if(e.__node.delay||e.__node.frame){n(...c).then(async f=>{e.__node.recursive?await s(l,f):await s(l,...c)});break}else o=await n(...i);l--}};return await s(a,...i),o})}if(e.__node.loop&&typeof e.__node.loop=="number"){e.__node.looperSet=!0;let n=e.__operator,i=e.__node.loop;e.__setOperator((...o)=>{if("looping"in e.__node||(e.__node.looping=!0),e.__node.looping){let s=performance.now();n(...o),setTimeout(()=>{let c=performance.now()-s-e.__node.loop;c>0?i=e.__node.loop-c:i=e.__node.loop,i<=0&&(i=e.__node.loop),e.__operator(...o)},i)}}),e.__node.looping&&e.__operator();let a=o=>{o.__node.looping&&(o.__node.looping=!1)};e.__addOndisconnected(a)}}},uOe=(e,t,r)=>{if(e.__node.animate===!0||e.__animation){let n=e.__operator;e.__setOperator((...a)=>{"animating"in e.__node||(e.__node.animating=!0),e.__node.animating&&(typeof e.__animation=="function"?e.__animation(...a):n(...a),requestAnimationFrame(()=>{e.__operator(...a)}))}),(e.__node.animating||(!("animating"in e.__node)||e.__node.animating)&&e.__animation)&&setTimeout(()=>{requestAnimationFrame(e.__operator)},10);let i=a=>{a.__node.animating&&(a.__node.animating=!1)};e.__addOndisconnected(i)}},fOe=(e,t,r)=>{if(typeof e.__branch=="object"&&e.__operator&&!e.__branchApplied){let n=e.__operator;e.__branchApplied=!0,e.__operator=(...i)=>{let a=n(...i);for(let o in e.__branch){let s=()=>{typeof e.__branch[o].then=="function"?e.__branch[o].then(a):e.__branch[o].then instanceof yr&&e.__branch[o].then.__operator?e.__branch[o].then.__operator(a):a=e.__branch[o].then};typeof e.__branch[o].if=="function"?e.__branch[o].if(a)==!0&&s():e.__branch[o].if===a&&s()}return a}}if(e.__listeners){for(let n in e.__listeners)if(typeof e.__listeners[n]=="object"&&e.__listeners[n].branch&&!e.__listeners[n].branchApplied){let i=e.__listeners[n].callback;e.__listeners[n].branchApplied=!0,e.__listeners.callback=a=>{let o=()=>{typeof e.__listeners[n].branch.then=="function"?a=e.__listeners[n].branch.then(a):e.__listeners[n].branch.then instanceof yr&&e.__listeners[n].branch.then.__operator?a=e.__listeners[n].branch.then.__operator(a):a=e.__listeners[n].branch.then};return typeof e.__listeners[n].branch.if=="function"?e.__listeners[n].branch.if(a)&&o():e.__listeners[n].branch.if===a&&o(),i(a)}}}},dOe=(e,t,r)=>{if(e.__listeners)for(let n in e.__listeners)typeof e.__listeners[n]=="object"&&e.__listeners[n].oncreate&&e.__listeners[n].callback(e.__listeners[n].oncreate)},pOe=(e,t,r)=>{if(e.__listeners)for(let n in e.__listeners)typeof e.__listeners[n]=="object"&&typeof e.__listeners[n].binding=="object"&&(e.__listeners.callback=e.__listeners.callback.bind(e.__listeners[n].binding))},hOe=(e,t,r)=>{if(e.__listeners){for(let n in e.__listeners)if(typeof e.__listeners[n]=="object"&&typeof e.__listeners[n].transform=="function"&&!e.__listeners[n].transformApplied){let i=e.__listeners[n].callback;e.__listeners[n].transformApplied=!0,e.__listeners.callback=a=>(a=e.__listeners[n].transform(a),i(a))}}},gOe=(e,t,r)=>{e.post&&!e.__operator?e.__setOperator(e.post):!e.__operator&&typeof e.get=="function"&&e.__setOperator(e.get),!e.get&&e.__operator&&(e.get=e.__operator),e.aliases&&e.aliases.forEach(n=>{r.set(n,e);let i=a=>{r.__node.nodes.delete(n)};e.__addOndisconnected(i)}),typeof r.__node.roots?.[e.__node.tag]=="object"&&e.get&&(r.__node.roots[e.__node.tag].get=e.get)},iY={backprop:lOe,loop:cOe,animate:uOe,branching:fOe,triggerListenerOncreate:dOe,bindListener:pOe,transformListenerResult:hOe,substitute__operator:gOe},lN=e=>{let t={};for(let r in e)typeof e[r]=="object"?t[r]=lN(e[r]):typeof e[r]=="function"?t[r]=e[r].toString():t[r]=e[r];return t};function Hp(e=""){let t=o=>o.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),n=(o=>{let s=o.indexOf("=>")+1;return s<=0&&(s=o.indexOf("){")),s<=0&&(s=o.indexOf(") {")),o.slice(0,o.indexOf("{",s)+1)})(e),i=t(e),a;if(n.includes("function")){let o=n.split("(")[1].split(")")[0];a=new Function(o,i)}else if(n.substring(0,6)===i.substring(0,6)){let o=n.split("(")[1].split(")")[0];a=new Function(o,i.substring(i.indexOf("{")+1,i.length-1))}else try{a=(0,eval)(e)}catch{}return a}var yOe=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(o,s){var l=t.length-1,c=t[l];if(typeof c=="object")if(c[o]===s||l===0)r.push(o),t.push(s.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[o]===s){l+=2,t.length=l,r.length=l,--l,t[l]=s,r[l]=o;break}l--}}function a(o,s){if(s!=null&&typeof s=="object"){o&&i(o,s);let l=e.get(s);if(l)return"[Circular Reference]"+l;e.set(s,r.join("."))}return s}return function(s,l){try{return t.push(s),JSON.stringify(s,a,l)}finally{n()}}}();JSON.stringifyWithCircularRefs===void 0&&(JSON.stringifyWithCircularRefs=yOe);var mOe=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(o,s){var l=t.length-1;if(t[l]){var c=t[l];if(typeof c=="object")if(c[o]===s||l===0)r.push(o),t.push(s.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[o]===s){l+=2,t.length=l,r.length=l,--l,t[l]=s,r[l]=o;break}l++}}}function a(o,s){let l;if(s!=null)if(typeof s=="object"){let c=s.constructor.name;o&&c==="Object"&&i(o,s);let f=e.get(s);if(f)return"[Circular Reference]"+f;if(e.set(s,r.join(".")),c==="Array")s.length>20?l=s.slice(s.length-20):l=s;else if(c.includes("Set"))l=Array.from(s);else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean")l="instanceof_"+c;else if(c==="Object"){let u={};for(let h in s)if(s[h]==null)u[h]=s[h];else if(Array.isArray(s[h]))s[h].length>20?u[h]=s[h].slice(s[h].length-20):u[h]=s[h];else if(s[h].constructor.name==="Object"){u[h]={};for(let g in s[h])if(Array.isArray(s[h][g]))s[h][g].length>20?u[h][g]=s[h][g].slice(s[h][g].length-20):u[h][g]=s[h][g];else if(s[h][g]!=null){let _=s[h][g].constructor.name;_.includes("Set")?u[h][g]=Array.from(s[h][g]):_!=="Number"&&_!=="String"&&_!=="Boolean"?u[h][g]="instanceof_"+_:u[h][g]=s[h][g]}else u[h][g]=s[h][g]}else{let g=s[h].constructor.name;g.includes("Set")?u[h]=Array.from(s[h]):g!=="Number"&&g!=="String"&&g!=="Boolean"?u[h]="instanceof_"+g:u[h]=s[h]}l=u}else l=s}else l=s;return l}return function(s,l){t.push(s);let c=JSON.stringify(s,a,l);return n(),c}}();JSON.stringifyFast===void 0&&(JSON.stringifyFast=mOe);function aY(e){if(typeof e.__methods=="object")for(let t in e.__methods){let r=e.__methods[t],n=typeof r=="function"?r:Hp(r);t==="__operator"?e.__setOperator(n):e[t]=n.bind(e)}}var SY=class extends Uu{name=`service${Math.floor(Math.random()*1e15)}`;constructor(e){super({...e,loaders:e?.loaders?Object.assign({...iY},e.loaders):{...iY}}),e?.services&&this.addServices(e.services),this.load(this)}addServices=e=>{for(let t in e)if(typeof e[t]=="function"&&(e[t]=new e[t]),e[t]?.__node?.loaders&&Object.assign(this.__node.loaders,e[t].__node.loaders),e[t]?.__node?.nodes){e[t].__node.nodes.forEach((i,a)=>{this.get(a)?this.set(t+"."+a,i):this.set(a,i)}),this.__node.nodes.forEach((i,a)=>{e[t].__node.nodes.get(a)||e[t].__node.nodes.set(a,i)});let r=this.set;this.set=(i,a)=>(e[t].set(i,a),r(i,a));let n=this.delete;this.delete=i=>(e[t].delete(i),n(i))}else typeof e[t]=="object"&&this.load(e[t])};handleMethod=(e,t,r)=>{let n=t.toLowerCase(),i=this.__node.nodes.get(e);if(i||(i=this.__node.roots[e]),i?.[n])if(typeof i[n]!="function"){if(r){Array.isArray(r)&&r.length===1?i[n]=r[0]:i[n]=r;return}return i[n]}else return Array.isArray(r)?i[n](...r):i[n](r);else return this.handleServiceMessage({route:e,args:r,method:t})};handleServiceMessage(e){let t;return typeof e=="object"&&(e.route?t=e.route:e.node&&(t=e.node)),t?Array.isArray(e.args)?this.run(t,...e.args):this.run(t,e.args):e}handleGraphNodeCall(e,t){if(!e)return t;if(t?.args)this.handleServiceMessage(t);else return Array.isArray(t)?this.run(e,...t):this.run(e,t)}transmit=(...e)=>typeof e[0]=="object"?e[0].method?this.handleMethod(e[0].route,e[0].method,e[0].args):e[0].route?this.handleServiceMessage(e[0]):e[0].node?this.handleGraphNodeCall(e[0].node,e[0].args):(this.__node.keepState&&(e[0].route&&this.setState({[e[0].route]:e[0].args}),e[0].node&&this.setState({[e[0].node]:e[0].args})),e):e;receive=(...e)=>{if(e[0]&&typeof e[0]=="string"){let t=e[0].substring(0,8);(t.includes("{")||t.includes("["))&&(t.includes("\\")&&(e[0]=e[0].replace(/\\/g,"")),e[0][0]==='"'&&(e[0]=e[0].substring(1,e[0].length-1)),e[0]=JSON.parse(e[0]))}return typeof e[0]=="object"?e[0].method?this.handleMethod(e[0].route,e[0].method,e[0].args):e[0].route?this.handleServiceMessage(e[0]):e[0].node?this.handleGraphNodeCall(e[0].node,e[0].args):(this.__node.keepState&&(e[0].route&&this.setState({[e[0].route]:e[0].args}),e[0].node&&this.setState({[e[0].node]:e[0].args})),e):e};pipe=(e,t,r,n,i)=>{if(e instanceof yr)return i?this.subscribe(e,a=>{let o=i(a);o!==void 0?this.transmit({route:t,args:o,method:n}):this.transmit({route:t,args:a,method:n},r)}):this.subscribe(e,a=>{this.transmit({route:t,args:a,method:n},r)});if(typeof e=="string")return this.subscribe(e,a=>{this.transmit({route:t,args:a,method:n},r)})};pipeOnce=(e,t,r,n,i)=>{if(e instanceof yr)return i?e.__node.state.subscribeEventOnce(e.__node.unique,a=>{let o=i(a);o!==void 0?this.transmit({route:t,args:o,method:n}):this.transmit({route:t,args:a,method:n},r)}):this.__node.state.subscribeEventOnce(e.__node.unique,a=>{this.transmit({route:t,args:a,method:n},r)});if(typeof e=="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(e).__node.unique,a=>{this.transmit({route:t,args:a,method:n},r)})};terminate=(...e)=>{};isTypedArray=vOe;recursivelyAssign=I1;spliceTypedArray=bOe;ping=()=>(console.log("pinged!"),"pong");echo=(...e)=>(this.transmit(...e),e);log=(...e)=>(console.log(...e),!0);error=(...e)=>(console.error(...e),!0)};function vOe(e){return ArrayBuffer.isView(e)&&Object.prototype.toString.call(e)!=="[object DataView]"}var I1=(e,t)=>{for(let r in t)t[r]?.constructor.name==="Object"&&!Array.isArray(t[r])?e[r]?.constructor.name==="Object"&&!Array.isArray(e[r])?I1(e[r],t[r]):e[r]=I1({},t[r]):e[r]=t[r];return e};function bOe(e,t,r){let n=e.subarray(0,t),i;r&&(i=e.subarray(r+1));let a;return(n.length>0||i?.length>0)&&(a=new e.constructor(n.length+i.length)),a&&(n.length>0&&a.set(n),i&&i.length>0&&a.set(i,n.length)),a}var g1={},_Oe={transferNode:(e,t,r)=>{let n;if(typeof e=="object"){e.__node||(e.__node={}),r&&(e.__node.tag=r);for(let i in e)typeof e[i]=="function"&&(e.__methods||(e.__methods={}),e.__methods[i]=e[i].toString());n=lN(e)}else typeof e=="function"?n=e.toString():typeof e=="string"&&(n=e);if(n){if(t.run)return t.run("setNode",[n]);if(t.postMessage)return t.postMessage({route:"setNode",args:n},void 0),new Promise(i=>i(r));if(t.send)return t.send(JSON.stringify({route:"setNode",args:n})),new Promise(i=>i(r))}},setNode:function(e,t){if(typeof e=="object"&&e.__methods&&(this.__node.graph.__node.loaders.methodstrings||(this.__node.graph.__node.loaders.methodstrings=aY)),typeof e=="string"){let r=Hp(e);typeof r=="function"?e={__operator:r,__node:{tag:t||r.name}}:(r=JSON.parse(e),typeof r=="object"&&(e=r))}if(typeof e=="object"||typeof e=="function"){let r={};typeof e=="object"?Object.assign(r,e):r.__operator=e;let n=this.__node.graph.add(r);return n?(g1[n.__node.tag]=r,n.__node?.tag):!1}else return!1},proxyRemoteNode:function(e,t){return new Promise((r,n)=>{t.run("getNodeProperties",e).then(i=>{let a={};if(typeof i=="object")for(let o in i)i[o]==="function"?a[o]=(...s)=>new Promise(l=>{t.run(e,s,o).then(l)}):Object.defineProperty(a,o,{get:()=>new Promise(s=>{t.run(e,void 0,o).then(s)}),set:s=>{t.post(e,s,o)},configurable:!0,enumerable:!0});r(a)})})},makeNodeTransferrable:function(e,t){e.__node||(e.__node={}),t&&(e.__node.tag=t);for(let n in e)typeof e[n]=="function"&&(e.__methods||(e.__methods={}),e.__methods[n]=e[n].toString());return lN(e)},setTemplate:function(e,t){if(typeof e=="object"&&e.__methods&&(this.__node.graph.__node.loaders.methodstrings||(this.__node.graph.__node.loaders.methodstrings=aY)),typeof e=="string"){let r=Hp(e);typeof r=="function"?(t||(t=r.name),e={__operator:r,__node:{tag:t}}):(r=JSON.parse(e),typeof r=="object"&&(e=r,!t&&r.__node?.tag&&(t=r.__node.tag)))}return t||(t=`node${Math.floor(Math.random()*1e15)}`),typeof e=="object"||typeof e=="function"?(g1[t]=e,t):!1},loadFromTemplate:function(e,t,r){if(g1[e]){let n=I1({},g1[e]);return t&&(n.__node||(n.__node={}),n.__node.tag=t),r&&Object.assign(n,r),this.__node.graph.add(n).__node.tag}},setMethod:function(e,t,r){if(typeof t=="string"){let n=Hp(t);typeof n=="function"&&(t=n)}return!r&&typeof t=="function"&&(r=t.name),this.__node.graph.get(e)?this.__node.graph.get(e)[r]=t:this.__node.graph.add({__node:{tag:r,[r]:t}}),!0},assignNode:function(e,t){this.__node.graph.get(e)&&typeof t=="object"&&Object.assign(this.__node.graph.get(e),t)},getNodeProperties:function(e){let t=this.__node.graph.get(e);if(t){let r=Object.getOwnPropertyNames(t),n={};for(let i in r)n[i]=typeof t[i];return n}},transferClass:(e,t,r)=>{if(typeof e=="object"){let n=e.toString(),i={route:"receiveClass",args:[n,r]};return t.run?t.run("receiveClass",[n,r]):t.postMessage?(t.postMessage({route:"receiveClass",args:[n,r]},void 0),new Promise(a=>a(name))):t.send?(t.send(JSON.stringify({route:"receiveClass",args:[n,r]})),new Promise(a=>a(name))):i}return!1},receiveClass:function(e,t){if(typeof e=="string"&&e.indexOf("class")===0){let r=(0,eval)("("+e+")"),n=t;return n||(n=r.name),this.__node.graph[n]=r,!0}return!1},transferFunction:(e,t,r)=>{r||(r=e.name);let n=e.toString(),i={route:"setNode",args:[n,r]};return t.run?t.run("setNode",[n,r]):t.postMessage?(t.postMessage({route:"setNode",args:[n,r]},void 0),new Promise(a=>a(name))):t.send?(t.send(JSON.stringify({route:"setNode",args:[n,r]})),new Promise(a=>a(name))):i},setGlobal:(e,t)=>(globalThis[e]=t,!0),assignGlobalObject:(e,t)=>globalThis[e]?(typeof t=="object"&&Object.assign(globalThis[e],t),!0):!1,setValue:function(e,t){return this.__node.graph[e]=t,!0},assignObject:function(e,t){return this.__node.graph[e]?(typeof t=="object"&&Object.assign(this.__node.graph[e],t),!0):!1},setGlobalFunction:(e,t)=>(typeof e=="string"&&(e=Hp(e)),typeof e=="function"?(t||(t=e.name),globalThis[t]=e,!0):!1),setGraphFunction:function(e,t){return typeof e=="string"&&(e=Hp(e)),typeof e=="function"?(t||(t=e.name),this.__node.graph[t]=e,!0):!1}};function wOe(e,...t){return function(n=document.createElement("div")){let i=document.createElement("template");e.map(function(s,l){if(i.innerHTML+=s,t[l]instanceof HTMLElement){let c='<span id="dummyNode12345"></span>';c.id="dummyNode12345",i.innerHTML+=c}else i.innerHTML+=t[l]});let a=i.content.querySelectorAll("#dummyNode12345"),o=0;return t.forEach((s,l)=>{s instanceof HTMLElement&&(console.log(s,a[o]),i.content.replaceChild(s,a[o]),o++)}),n.appendChild(i.content),n}}var THe=wOe``,ye={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};ye.cipher.aes=function(e){this.s[0][0][0]||this.O();var t,r,n,i,a=this.s[0][4],o=this.s[1];t=e.length;var s=1;if(t!==4&&t!==6&&t!==8)throw new ye.exception.invalid("invalid aes key size");for(this.b=[n=e.slice(0),i=[]],e=t;e<4*t+28;e++)r=n[e-1],(e%t===0||t===8&&e%t===4)&&(r=a[r>>>24]<<24^a[r>>16&255]<<16^a[r>>8&255]<<8^a[r&255],e%t===0&&(r=r<<8^r>>>24^s<<24,s=s<<1^283*(s>>7))),n[e]=n[e-t]^r;for(t=0;e;t++,e--)r=n[t&3?e:e-4],i[t]=4>=e||4>t?r:o[0][a[r>>>24]]^o[1][a[r>>16&255]]^o[2][a[r>>8&255]]^o[3][a[r&255]]};ye.cipher.aes.prototype={encrypt:function(e){return oY(this,e,0)},decrypt:function(e){return oY(this,e,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var e=this.s[0],t=this.s[1],r=e[4],n=t[4],i,a,o,s=[],l=[],c,f,u,h;for(i=0;256>i;i++)l[(s[i]=i<<1^283*(i>>7))^i]=i;for(a=o=0;!r[a];a^=c||1,o=l[o]||1)for(u=o^o<<1^o<<2^o<<3^o<<4,u=u>>8^u&255^99,r[a]=u,n[u]=a,f=s[i=s[c=s[a]]],h=16843009*f^65537*i^257*c^16843008*a,f=257*s[u]^16843008*u,i=0;4>i;i++)e[i][a]=f=f<<24^f>>>8,t[i][u]=h=h<<24^h>>>8;for(i=0;5>i;i++)e[i]=e[i].slice(0),t[i]=t[i].slice(0)}};function oY(e,t,r){if(t.length!==4)throw new ye.exception.invalid("invalid aes block size");var n=e.b[r],i=t[0]^n[0],a=t[r?3:1]^n[1],o=t[2]^n[2];t=t[r?1:3]^n[3];var s,l,c,f=n.length/4-2,u,h=4,g=[0,0,0,0];s=e.s[r],e=s[0];var _=s[1],w=s[2],E=s[3],S=s[4];for(u=0;u<f;u++)s=e[i>>>24]^_[a>>16&255]^w[o>>8&255]^E[t&255]^n[h],l=e[a>>>24]^_[o>>16&255]^w[t>>8&255]^E[i&255]^n[h+1],c=e[o>>>24]^_[t>>16&255]^w[i>>8&255]^E[a&255]^n[h+2],t=e[t>>>24]^_[i>>16&255]^w[a>>8&255]^E[o&255]^n[h+3],h+=4,i=s,a=l,o=c;for(u=0;4>u;u++)g[r?3&-u:u]=S[i>>>24]<<24^S[a>>16&255]<<16^S[o>>8&255]<<8^S[t&255]^n[h++],s=i,i=a,a=o,o=t,t=s;return g}ye.bitArray={bitSlice:function(e,t,r){return e=ye.bitArray.$(e.slice(t/32),32-(t&31)).slice(1),r===void 0?e:ye.bitArray.clamp(e,r-t)},extract:function(e,t,r){var n=Math.floor(-t-r&31);return((t+r-1^t)&-32?e[t/32|0]<<32-n^e[t/32+1|0]>>>n:e[t/32|0]>>>n)&(1<<r)-1},concat:function(e,t){if(e.length===0||t.length===0)return e.concat(t);var r=e[e.length-1],n=ye.bitArray.getPartial(r);return n===32?e.concat(t):ye.bitArray.$(t,n,r|0,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return t===0?0:32*(t-1)+ye.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;e=e.slice(0,Math.ceil(t/32));var r=e.length;return t=t&31,0<r&&t&&(e[r-1]=ye.bitArray.partial(t,e[r-1]&2147483648>>t-1,1)),e},partial:function(e,t,r){return e===32?t:(r?t|0:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(ye.bitArray.bitLength(e)!==ye.bitArray.bitLength(t))return!1;var r=0,n;for(n=0;n<e.length;n++)r|=e[n]^t[n];return r===0},$:function(e,t,r,n){var i;for(i=0,n===void 0&&(n=[]);32<=t;t-=32)n.push(r),r=0;if(t===0)return n.concat(e);for(i=0;i<e.length;i++)n.push(r|e[i]>>>t),r=e[i]<<32-t;return i=e.length?e[e.length-1]:0,e=ye.bitArray.getPartial(i),n.push(ye.bitArray.partial(t+e&31,32<t+e?r:n.pop(),1)),n},i:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,r;for(t=0;t<e.length;++t)r=e[t],e[t]=r>>>24|r>>>8&65280|(r&65280)<<8|r<<24;return e}};ye.codec.utf8String={fromBits:function(e){var t="",r=ye.bitArray.bitLength(e),n,i;for(n=0;n<r/8;n++)!(n&3)&&(i=e[n/4]),t+=String.fromCharCode(i>>>8>>>8>>>8),i<<=8;return decodeURIComponent(escape(t))},toBits:function(e){e=unescape(encodeURIComponent(e));var t=[],r,n=0;for(r=0;r<e.length;r++)n=n<<8|e.charCodeAt(r),(r&3)===3&&(t.push(n),n=0);return r&3&&t.push(ye.bitArray.partial(8*(r&3),n)),t}};ye.codec.hex={fromBits:function(e){var t="",r;for(r=0;r<e.length;r++)t+=((e[r]|0)+0xf00000000000).toString(16).substr(4);return t.substr(0,ye.bitArray.bitLength(e)/4)},toBits:function(e){var t,r=[],n;for(e=e.replace(/\s|0x/g,""),n=e.length,e=e+"00000000",t=0;t<e.length;t+=8)r.push(parseInt(e.substr(t,8),16)^0);return ye.bitArray.clamp(r,4*n)}};ye.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(e,t,r){var n=ye.codec.base32.BASE,i=ye.codec.base32.REMAINING,a="",o=0,s=ye.codec.base32.B,l=0,c=ye.bitArray.bitLength(e);for(r&&(s=ye.codec.base32.X),r=0;a.length*n<c;)a+=s.charAt((l^e[r]>>>o)>>>i),o<n?(l=e[r]<<n-o,o+=i,r++):(l<<=n,o-=n);for(;a.length&7&&!t;)a+="=";return a},toBits:function(e,t){e=e.replace(/\s|=/g,"").toUpperCase();var r=ye.codec.base32.BITS,n=ye.codec.base32.BASE,i=ye.codec.base32.REMAINING,a=[],o,s=0,l=ye.codec.base32.B,c=0,f,u="base32";for(t&&(l=ye.codec.base32.X,u="base32hex"),o=0;o<e.length;o++){if(f=l.indexOf(e.charAt(o)),0>f){if(!t)try{return ye.codec.base32hex.toBits(e)}catch{}throw new ye.exception.invalid("this isn't "+u+"!")}s>i?(s-=i,a.push(c^f>>>s),c=f<<r-s):(s+=n,c^=f<<r-s)}return s&56&&a.push(ye.bitArray.partial(s&56,c,1)),a}};ye.codec.base32hex={fromBits:function(e,t){return ye.codec.base32.fromBits(e,t,1)},toBits:function(e){return ye.codec.base32.toBits(e,1)}};ye.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,r){var n="",i=0,a=ye.codec.base64.B,o=0,s=ye.bitArray.bitLength(e);for(r&&(a=a.substr(0,62)+"-_"),r=0;6*n.length<s;)n+=a.charAt((o^e[r]>>>i)>>>26),6>i?(o=e[r]<<6-i,i+=26,r++):(o<<=6,i-=6);for(;n.length&3&&!t;)n+="=";return n},toBits:function(e,t){e=e.replace(/\s|=/g,"");var r=[],n,i=0,a=ye.codec.base64.B,o=0,s;for(t&&(a=a.substr(0,62)+"-_"),n=0;n<e.length;n++){if(s=a.indexOf(e.charAt(n)),0>s)throw new ye.exception.invalid("this isn't base64!");26<i?(i-=26,r.push(o^s>>>i),o=s<<32-i):(i+=6,o^=s<<32-i)}return i&56&&r.push(ye.bitArray.partial(i&56,o,1)),r}};ye.codec.base64url={fromBits:function(e){return ye.codec.base64.fromBits(e,1,1)},toBits:function(e){return ye.codec.base64.toBits(e,1)}};ye.hash.sha256=function(e){this.b[0]||this.O(),e?(this.F=e.F.slice(0),this.A=e.A.slice(0),this.l=e.l):this.reset()};ye.hash.sha256.hash=function(e){return new ye.hash.sha256().update(e).finalize()};ye.hash.sha256.prototype={blockSize:512,reset:function(){return this.F=this.Y.slice(0),this.A=[],this.l=0,this},update:function(e){typeof e=="string"&&(e=ye.codec.utf8String.toBits(e));var t,r=this.A=ye.bitArray.concat(this.A,e);if(t=this.l,e=this.l=t+ye.bitArray.bitLength(e),9007199254740991<e)throw new ye.exception.invalid("Cannot hash more than 2^53 - 1 bits");if(typeof Uint32Array<"u"){var n=new Uint32Array(r),i=0;for(t=512+t-(512+t&511);t<=e;t+=512)Y3(this,n.subarray(16*i,16*(i+1))),i+=1;r.splice(0,16*i)}else for(t=512+t-(512+t&511);t<=e;t+=512)Y3(this,r.splice(0,16));return this},finalize:function(){var e,r=this.A,t=this.F,r=ye.bitArray.concat(r,[ye.bitArray.partial(1,1)]);for(e=r.length+2;e&15;e++)r.push(0);for(r.push(Math.floor(this.l/4294967296)),r.push(this.l|0);r.length;)Y3(this,r.splice(0,16));return this.reset(),t},Y:[],b:[],O:function(){function e(a){return 4294967296*(a-Math.floor(a))|0}for(var t=0,r=2,n,i;64>t;r++){for(i=!0,n=2;n*n<=r;n++)if(r%n===0){i=!1;break}i&&(8>t&&(this.Y[t]=e(Math.pow(r,.5))),this.b[t]=e(Math.pow(r,1/3)),t++)}}};function Y3(e,t){var r,n,i,a=e.F,o=e.b,s=a[0],l=a[1],c=a[2],f=a[3],u=a[4],h=a[5],g=a[6],_=a[7];for(r=0;64>r;r++)16>r?n=t[r]:(n=t[r+1&15],i=t[r+14&15],n=t[r&15]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+t[r&15]+t[r+9&15]|0),n=n+_+(u>>>6^u>>>11^u>>>25^u<<26^u<<21^u<<7)+(g^u&(h^g))+o[r],_=g,g=h,h=u,u=f+n|0,f=c,c=l,l=s,s=n+(l&c^f&(l^c))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;a[0]=a[0]+s|0,a[1]=a[1]+l|0,a[2]=a[2]+c|0,a[3]=a[3]+f|0,a[4]=a[4]+u|0,a[5]=a[5]+h|0,a[6]=a[6]+g|0,a[7]=a[7]+_|0}ye.mode.ccm={name:"ccm",G:[],listenProgress:function(e){ye.mode.ccm.G.push(e)},unListenProgress:function(e){e=ye.mode.ccm.G.indexOf(e),-1<e&&ye.mode.ccm.G.splice(e,1)},fa:function(e){var t=ye.mode.ccm.G.slice(),r;for(r=0;r<t.length;r+=1)t[r](e)},encrypt:function(e,t,r,n,i){var a,o=t.slice(0),s=ye.bitArray,l=s.bitLength(r)/8,c=s.bitLength(o)/8;if(i=i||64,n=n||[],7>l)throw new ye.exception.invalid("ccm: iv must be at least 7 bytes");for(a=2;4>a&&c>>>8*a;a++);return a<15-l&&(a=15-l),r=s.clamp(r,8*(15-a)),t=ye.mode.ccm.V(e,t,r,n,i,a),o=ye.mode.ccm.C(e,o,r,t,i,a),s.concat(o.data,o.tag)},decrypt:function(e,t,r,n,i){i=i||64,n=n||[];var a=ye.bitArray,o=a.bitLength(r)/8,c=a.bitLength(t),s=a.clamp(t,c-i),l=a.bitSlice(t,c-i),c=(c-i)/8;if(7>o)throw new ye.exception.invalid("ccm: iv must be at least 7 bytes");for(t=2;4>t&&c>>>8*t;t++);if(t<15-o&&(t=15-o),r=a.clamp(r,8*(15-t)),s=ye.mode.ccm.C(e,s,r,l,i,t),e=ye.mode.ccm.V(e,s.data,r,n,i,t),!a.equal(s.tag,e))throw new ye.exception.corrupt("ccm: tag doesn't match");return s.data},na:function(e,t,r,n,i,a){var o=[],s=ye.bitArray,l=s.i;if(n=[s.partial(8,(t.length?64:0)|n-2<<2|a-1)],n=s.concat(n,r),n[3]|=i,n=e.encrypt(n),t.length)for(r=s.bitLength(t)/8,65279>=r?o=[s.partial(16,r)]:4294967295>=r&&(o=s.concat([s.partial(16,65534)],[r])),o=s.concat(o,t),t=0;t<o.length;t+=4)n=e.encrypt(l(n,o.slice(t,t+4).concat([0,0,0])));return n},V:function(e,t,r,n,i,a){var o=ye.bitArray,s=o.i;if(i/=8,i%2||4>i||16<i)throw new ye.exception.invalid("ccm: invalid tag length");if(4294967295<n.length||4294967295<t.length)throw new ye.exception.bug("ccm: can't deal with 4GiB or more data");for(r=ye.mode.ccm.na(e,n,r,i,o.bitLength(t)/8,a),n=0;n<t.length;n+=4)r=e.encrypt(s(r,t.slice(n,n+4).concat([0,0,0])));return o.clamp(r,8*i)},C:function(e,t,r,n,i,a){var o,s=ye.bitArray;o=s.i;var l=t.length,c=s.bitLength(t),f=l/50,u=f;if(r=s.concat([s.partial(8,a-1)],r).concat([0,0,0]).slice(0,4),n=s.bitSlice(o(n,e.encrypt(r)),0,i),!l)return{tag:n,data:[]};for(o=0;o<l;o+=4)o>f&&(ye.mode.ccm.fa(o/l),f+=u),r[3]++,i=e.encrypt(r),t[o]^=i[0],t[o+1]^=i[1],t[o+2]^=i[2],t[o+3]^=i[3];return{tag:n,data:s.clamp(t,c)}}};ye.mode.ocb2={name:"ocb2",encrypt:function(e,t,r,n,i,a){if(ye.bitArray.bitLength(r)!==128)throw new ye.exception.invalid("ocb iv must be 128 bits");var o,s=ye.mode.ocb2.S,l=ye.bitArray,c=l.i,f=[0,0,0,0];r=s(e.encrypt(r));var u,h=[];for(n=n||[],i=i||64,o=0;o+4<t.length;o+=4)u=t.slice(o,o+4),f=c(f,u),h=h.concat(c(r,e.encrypt(c(r,u)))),r=s(r);return u=t.slice(o),t=l.bitLength(u),o=e.encrypt(c(r,[0,0,0,t])),u=l.clamp(c(u.concat([0,0,0]),o),t),f=c(f,c(u.concat([0,0,0]),o)),f=e.encrypt(c(f,c(r,s(r)))),n.length&&(f=c(f,a?n:ye.mode.ocb2.pmac(e,n))),h.concat(l.concat(u,l.clamp(f,i)))},decrypt:function(e,t,r,n,i,a){if(ye.bitArray.bitLength(r)!==128)throw new ye.exception.invalid("ocb iv must be 128 bits");i=i||64;var o=ye.mode.ocb2.S,s=ye.bitArray,l=s.i,c=[0,0,0,0],f=o(e.encrypt(r)),u,h,g=ye.bitArray.bitLength(t)-i,_=[];for(n=n||[],r=0;r+4<g/32;r+=4)u=l(f,e.decrypt(l(f,t.slice(r,r+4)))),c=l(c,u),_=_.concat(u),f=o(f);if(h=g-32*r,u=e.encrypt(l(f,[0,0,0,h])),u=l(u,s.clamp(t.slice(r),h).concat([0,0,0])),c=l(c,u),c=e.encrypt(l(c,l(f,o(f)))),n.length&&(c=l(c,a?n:ye.mode.ocb2.pmac(e,n))),!s.equal(s.clamp(c,i),s.bitSlice(t,g)))throw new ye.exception.corrupt("ocb: tag doesn't match");return _.concat(s.clamp(u,h))},pmac:function(e,t){var r,n=ye.mode.ocb2.S,i=ye.bitArray,a=i.i,o=[0,0,0,0],s=e.encrypt([0,0,0,0]),s=a(s,n(n(s)));for(r=0;r+4<t.length;r+=4)s=n(s),o=a(o,e.encrypt(a(s,t.slice(r,r+4))));return r=t.slice(r),128>i.bitLength(r)&&(s=a(s,n(s)),r=i.concat(r,[-2147483648,0,0,0])),o=a(o,r),e.encrypt(a(n(a(s,n(s))),o))},S:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}};ye.mode.gcm={name:"gcm",encrypt:function(e,t,r,n,i){var a=t.slice(0);return t=ye.bitArray,n=n||[],e=ye.mode.gcm.C(!0,e,a,n,r,i||128),t.concat(e.data,e.tag)},decrypt:function(e,t,r,n,i){var a=t.slice(0),o=ye.bitArray,s=o.bitLength(a);if(i=i||128,n=n||[],i<=s?(t=o.bitSlice(a,s-i),a=o.bitSlice(a,0,s-i)):(t=a,a=[]),e=ye.mode.gcm.C(!1,e,a,n,r,i),!o.equal(e.tag,t))throw new ye.exception.corrupt("gcm: tag doesn't match");return e.data},ka:function(e,t){var r,n,i,a,o,s=ye.bitArray.i;for(i=[0,0,0,0],a=t.slice(0),r=0;128>r;r++){for((n=(e[Math.floor(r/32)]&1<<31-r%32)!==0)&&(i=s(i,a)),o=(a[3]&1)!==0,n=3;0<n;n--)a[n]=a[n]>>>1|(a[n-1]&1)<<31;a[0]>>>=1,o&&(a[0]^=-520093696)}return i},j:function(e,t,r){var n,i=r.length;for(t=t.slice(0),n=0;n<i;n+=4)t[0]^=4294967295&r[n],t[1]^=4294967295&r[n+1],t[2]^=4294967295&r[n+2],t[3]^=4294967295&r[n+3],t=ye.mode.gcm.ka(t,e);return t},C:function(e,t,r,n,i,a){var o,s,l,c,f,u,h,g,_=ye.bitArray;for(u=r.length,h=_.bitLength(r),g=_.bitLength(n),s=_.bitLength(i),o=t.encrypt([0,0,0,0]),s===96?(i=i.slice(0),i=_.concat(i,[1])):(i=ye.mode.gcm.j(o,[0,0,0,0],i),i=ye.mode.gcm.j(o,i,[0,0,Math.floor(s/4294967296),s&4294967295])),s=ye.mode.gcm.j(o,[0,0,0,0],n),f=i.slice(0),n=s.slice(0),e||(n=ye.mode.gcm.j(o,s,r)),c=0;c<u;c+=4)f[3]++,l=t.encrypt(f),r[c]^=l[0],r[c+1]^=l[1],r[c+2]^=l[2],r[c+3]^=l[3];return r=_.clamp(r,h),e&&(n=ye.mode.gcm.j(o,s,r)),e=[Math.floor(g/4294967296),g&4294967295,Math.floor(h/4294967296),h&4294967295],n=ye.mode.gcm.j(o,n,e),l=t.encrypt(i),n[0]^=l[0],n[1]^=l[1],n[2]^=l[2],n[3]^=l[3],{tag:_.bitSlice(n,0,a),data:r}}};ye.misc.hmac=function(e,t){this.W=t=t||ye.hash.sha256;var r=[[],[]],n,i=t.prototype.blockSize/32;for(this.w=[new t,new t],e.length>i&&(e=t.hash(e)),n=0;n<i;n++)r[0][n]=e[n]^909522486,r[1][n]=e[n]^1549556828;this.w[0].update(r[0]),this.w[1].update(r[1]),this.R=new t(this.w[0])};ye.misc.hmac.prototype.encrypt=ye.misc.hmac.prototype.mac=function(e){if(this.aa)throw new ye.exception.invalid("encrypt on already updated hmac called!");return this.update(e),this.digest(e)};ye.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]),this.aa=!1};ye.misc.hmac.prototype.update=function(e){this.aa=!0,this.R.update(e)};ye.misc.hmac.prototype.digest=function(){var e=this.R.finalize(),e=new this.W(this.w[1]).update(e).finalize();return this.reset(),e};ye.misc.pbkdf2=function(e,t,r,n,i){if(r=r||1e4,0>n||0>r)throw new ye.exception.invalid("invalid params to pbkdf2");typeof e=="string"&&(e=ye.codec.utf8String.toBits(e)),typeof t=="string"&&(t=ye.codec.utf8String.toBits(t)),i=i||ye.misc.hmac,e=new i(e);var a,o,s,l,c=[],f=ye.bitArray;for(l=1;32*c.length<(n||1);l++){for(i=a=e.encrypt(f.concat(t,[l])),o=1;o<r;o++)for(a=e.encrypt(a),s=0;s<a.length;s++)i[s]^=a[s];c=c.concat(i)}return n&&(c=f.clamp(c,n)),c};ye.prng=function(e){this.c=[new ye.hash.sha256],this.m=[0],this.P=0,this.H={},this.N=0,this.U={},this.Z=this.f=this.o=this.ha=0,this.b=[0,0,0,0,0,0,0,0],this.h=[0,0,0,0],this.L=void 0,this.M=e,this.D=!1,this.K={progress:{},seeded:{}},this.u=this.ga=0,this.I=1,this.J=2,this.ca=65536,this.T=[0,48,64,96,128,192,256,384,512,768,1024],this.da=3e4,this.ba=80};ye.prng.prototype={randomWords:function(e,t){var r=[],n;n=this.isReady(t);var i;if(n===this.u)throw new ye.exception.notReady("generator isn't seeded");if(n&this.J){n=!(n&this.I),i=[];var a=0,o;for(this.Z=i[0]=new Date().valueOf()+this.da,o=0;16>o;o++)i.push(4294967296*Math.random()|0);for(o=0;o<this.c.length&&(i=i.concat(this.c[o].finalize()),a+=this.m[o],this.m[o]=0,n||!(this.P&1<<o));o++);for(this.P>=1<<this.c.length&&(this.c.push(new ye.hash.sha256),this.m.push(0)),this.f-=a,a>this.o&&(this.o=a),this.P++,this.b=ye.hash.sha256.hash(this.b.concat(i)),this.L=new ye.cipher.aes(this.b),n=0;4>n&&(this.h[n]=this.h[n]+1|0,!this.h[n]);n++);}for(n=0;n<e;n+=4)(n+1)%this.ca===0&&lY(this),i=cN(this),r.push(i[0],i[1],i[2],i[3]);return lY(this),r.slice(0,e)},setDefaultParanoia:function(e,t){if(e===0&&t!=="Setting paranoia=0 will ruin your security; use it only for testing")throw new ye.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=e},addEntropy:function(e,t,r){r=r||"user";var n,i,a=new Date().valueOf(),o=this.H[r],s=this.isReady(),l=0;switch(n=this.U[r],n===void 0&&(n=this.U[r]=this.ha++),o===void 0&&(o=this.H[r]=0),this.H[r]=(this.H[r]+1)%this.c.length,typeof e){case"number":t===void 0&&(t=1),this.c[o].update([n,this.N++,1,t,a,1,e|0]);break;case"object":if(r=Object.prototype.toString.call(e),r==="[object Uint32Array]"){for(i=[],r=0;r<e.length;r++)i.push(e[r]);e=i}else for(r!=="[object Array]"&&(l=1),r=0;r<e.length&&!l;r++)typeof e[r]!="number"&&(l=1);if(!l){if(t===void 0)for(r=t=0;r<e.length;r++)for(i=e[r];0<i;)t++,i=i>>>1;this.c[o].update([n,this.N++,2,t,a,e.length].concat(e))}break;case"string":t===void 0&&(t=e.length),this.c[o].update([n,this.N++,3,t,a,e.length]),this.c[o].update(e);break;default:l=1}if(l)throw new ye.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[o]+=t,this.f+=t,s===this.u&&(this.isReady()!==this.u&&sY("seeded",Math.max(this.o,this.f)),sY("progress",this.getProgress()))},isReady:function(e){return e=this.T[e!==void 0?e:this.M],this.o&&this.o>=e?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=e?this.J|this.u:this.u},getProgress:function(e){return e=this.T[e||this.M],this.o>=e||this.f>e?1:this.f/e},startCollectors:function(){if(!this.D){if(this.a={loadTimeCollector:Jm(this,this.ma),mouseCollector:Jm(this,this.oa),keyboardCollector:Jm(this,this.la),accelerometerCollector:Jm(this,this.ea),touchCollector:Jm(this,this.qa)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new ye.exception.bug("can't attach event");this.D=!0}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=!1)},addEventListener:function(e,t){this.K[e][this.ga++]=t},removeEventListener:function(e,t){var r,n,i=this.K[e],a=[];for(n in i)i.hasOwnProperty(n)&&i[n]===t&&a.push(n);for(r=0;r<a.length;r++)n=a[r],delete i[n]},la:function(){Wm(this,1)},oa:function(e){var t,r;try{t=e.x||e.clientX||e.offsetX||0,r=e.y||e.clientY||e.offsetY||0}catch{r=t=0}t!=0&&r!=0&&this.addEntropy([t,r],2,"mouse"),Wm(this,0)},qa:function(e){e=e.touches[0]||e.changedTouches[0],this.addEntropy([e.pageX||e.clientX,e.pageY||e.clientY],1,"touch"),Wm(this,0)},ma:function(){Wm(this,2)},ea:function(e){if(e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,window.orientation){var t=window.orientation;typeof t=="number"&&this.addEntropy(t,1,"accelerometer")}e&&this.addEntropy(e,2,"accelerometer"),Wm(this,0)}};function sY(e,t){var r,n=ye.random.K[e],i=[];for(r in n)n.hasOwnProperty(r)&&i.push(n[r]);for(r=0;r<i.length;r++)i[r](t)}function Wm(e,t){typeof window<"u"&&window.performance&&typeof window.performance.now=="function"?e.addEntropy(window.performance.now(),t,"loadtime"):e.addEntropy(new Date().valueOf(),t,"loadtime")}function lY(e){e.b=cN(e).concat(cN(e)),e.L=new ye.cipher.aes(e.b)}function cN(e){for(var t=0;4>t&&(e.h[t]=e.h[t]+1|0,!e.h[t]);t++);return e.L.encrypt(e.h)}function Jm(e,t){return function(){t.apply(e,arguments)}}ye.random=new ye.prng(6);e:try{if(X3=typeof module<"u"&&module.exports){try{Z3=QEe("crypto")}catch{Z3=null}X3=K3=Z3}if(X3&&K3.randomBytes)y1=K3.randomBytes(128),y1=new Uint32Array(new Uint8Array(y1).buffer),ye.random.addEntropy(y1,1024,"crypto['randomBytes']");else if(typeof window<"u"&&typeof Uint32Array<"u"){if(m1=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(m1);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(m1);else break e;ye.random.addEntropy(m1,1024,"crypto['getRandomValues']")}}catch(e){typeof window<"u"&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}var y1,K3,m1,X3,Z3;ye.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(e,t,r,n){r=r||{},n=n||{};var i=ye.json,a=i.g({iv:ye.random.randomWords(4,0)},i.defaults),o;if(i.g(a,r),r=a.adata,typeof a.salt=="string"&&(a.salt=ye.codec.base64.toBits(a.salt)),typeof a.iv=="string"&&(a.iv=ye.codec.base64.toBits(a.iv)),!ye.mode[a.mode]||!ye.cipher[a.cipher]||typeof e=="string"&&100>=a.iter||a.ts!==64&&a.ts!==96&&a.ts!==128||a.ks!==128&&a.ks!==192&&a.ks!==256||2>a.iv.length||4<a.iv.length)throw new ye.exception.invalid("json encrypt: invalid parameters");return typeof e=="string"?(o=ye.misc.cachedPbkdf2(e,a),e=o.key.slice(0,a.ks/32),a.salt=o.salt):ye.ecc&&e instanceof ye.ecc.elGamal.publicKey&&(o=e.kem(),a.kemtag=o.tag,e=o.key.slice(0,a.ks/32)),typeof t=="string"&&(t=ye.codec.utf8String.toBits(t)),typeof r=="string"&&(a.adata=r=ye.codec.utf8String.toBits(r)),o=new ye.cipher[a.cipher](e),i.g(n,a),n.key=e,a.ct=a.mode==="ccm"&&ye.arrayBuffer&&ye.arrayBuffer.ccm&&t instanceof ArrayBuffer?ye.arrayBuffer.ccm.encrypt(o,t,a.iv,r,a.ts):ye.mode[a.mode].encrypt(o,t,a.iv,r,a.ts),a},encrypt:function(e,t,r,n){var i=ye.json,a=i.ja.apply(i,arguments);return i.encode(a)},ia:function(e,t,r,n){r=r||{},n=n||{};var i=ye.json;t=i.g(i.g(i.g({},i.defaults),t),r,!0);var a,o;if(a=t.adata,typeof t.salt=="string"&&(t.salt=ye.codec.base64.toBits(t.salt)),typeof t.iv=="string"&&(t.iv=ye.codec.base64.toBits(t.iv)),!ye.mode[t.mode]||!ye.cipher[t.cipher]||typeof e=="string"&&100>=t.iter||t.ts!==64&&t.ts!==96&&t.ts!==128||t.ks!==128&&t.ks!==192&&t.ks!==256||!t.iv||2>t.iv.length||4<t.iv.length)throw new ye.exception.invalid("json decrypt: invalid parameters");return typeof e=="string"?(o=ye.misc.cachedPbkdf2(e,t),e=o.key.slice(0,t.ks/32),t.salt=o.salt):ye.ecc&&e instanceof ye.ecc.elGamal.secretKey&&(e=e.unkem(ye.codec.base64.toBits(t.kemtag)).slice(0,t.ks/32)),typeof a=="string"&&(a=ye.codec.utf8String.toBits(a)),o=new ye.cipher[t.cipher](e),a=t.mode==="ccm"&&ye.arrayBuffer&&ye.arrayBuffer.ccm&&t.ct instanceof ArrayBuffer?ye.arrayBuffer.ccm.decrypt(o,t.ct,t.iv,t.tag,a,t.ts):ye.mode[t.mode].decrypt(o,t.ct,t.iv,a,t.ts),i.g(n,t),n.key=e,r.raw===1?a:ye.codec.utf8String.fromBits(a)},decrypt:function(e,t,r,n){var i=ye.json;return i.ia(e,i.decode(t),r,n)},encode:function(e){var t,r="{",n="";for(t in e)if(e.hasOwnProperty(t)){if(!t.match(/^[a-z0-9]+$/i))throw new ye.exception.invalid("json encode: invalid property name");switch(r+=n+'"'+t+'":',n=",",typeof e[t]){case"number":case"boolean":r+=e[t];break;case"string":r+='"'+escape(e[t])+'"';break;case"object":r+='"'+ye.codec.base64.fromBits(e[t],0)+'"';break;default:throw new ye.exception.bug("json encode: unsupported type")}}return r+"}"},decode:function(e){if(e=e.replace(/\s/g,""),!e.match(/^\{.*\}$/))throw new ye.exception.invalid("json decode: this isn't json!");e=e.replace(/^\{|\}$/g,"").split(/,/);var t={},r,n;for(r=0;r<e.length;r++){if(!(n=e[r].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new ye.exception.invalid("json decode: this isn't json!");n[3]!=null?t[n[2]]=parseInt(n[3],10):n[4]!=null?t[n[2]]=n[2].match(/^(ct|adata|salt|iv)$/)?ye.codec.base64.toBits(n[4]):unescape(n[4]):n[5]!=null&&(t[n[2]]=n[5]==="true")}return t},g:function(e,t,r){if(e===void 0&&(e={}),t===void 0)return e;for(var n in t)if(t.hasOwnProperty(n)){if(r&&e[n]!==void 0&&e[n]!==t[n])throw new ye.exception.invalid("required parameter overridden");e[n]=t[n]}return e},sa:function(e,t){var r={},n;for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(r[n]=e[n]);return r},ra:function(e,t){var r={},n;for(n=0;n<t.length;n++)e[t[n]]!==void 0&&(r[t[n]]=e[t[n]]);return r}};ye.encrypt=ye.json.encrypt;ye.decrypt=ye.json.decrypt;ye.misc.pa={};ye.misc.cachedPbkdf2=function(e,t){var r=ye.misc.pa,n;return t=t||{},n=t.iter||1e3,r=r[e]=r[e]||{},n=r[n]=r[n]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):ye.random.randomWords(2,0)},r=t.salt===void 0?n.firstSalt:t.salt,n[r]=n[r]||ye.misc.pbkdf2(e,r,t.iter),{key:n[r].slice(0),salt:r.slice(0)}};var k1=class extends SY{name="http";fetchProxied=!1;listening={};constructor(e,t,r){super(e),this.load(this),this.listen(t,r)}GET=(e="http://localhost:8080/ping",t="",r)=>(t==="json"&&(r="application/json"),new Promise((n,i)=>{let a=k1.request({method:"GET",url:e,responseType:t,mimeType:r,onload:o=>{let s;a.responseType===""||a.responseType==="text"?s=a.responseText:s=a.response,e instanceof URL&&(e=e.toString()),this.setState({[e]:s}),n(s)},onabort:o=>{i(o)}})}).catch(console.error));POST=(e,t="http://localhost:8080/echo",r="",n)=>(typeof e=="object"&&(r==="json"||r==="text"||!r)&&(e=JSON.stringify(e)),r==="json"&&(n="application/json"),new Promise((i,a)=>{let o=k1.request({method:"POST",url:t,data:e,responseType:r,mimeType:n,onload:s=>{let l;o.responseType===""||o.responseType==="text"?l=o.responseText:l=o.response,t instanceof URL&&(t=t.toString()),this.setState({[t]:l}),i(l)},onabort:s=>{a(s)}})}).catch(console.error));transmit=(e,t)=>{let r=e;return typeof r=="object"&&(e=JSON.stringify(r)),r?.method?.toLowerCase()=="get"||e?.toLowerCase()==="get"?this.GET(t):this.POST(e,t)};transponder=(e,t,r="",n)=>{typeof t=="object"&&(t=JSON.stringify(t));let i="GET";if(t&&(i="POST"),r==="json")n="application/json";else return new Promise((a,o)=>{let s=k1.request({method:i,url:e,data:t,responseType:r,onload:l=>{let c=s.response;if(typeof c=="string"){let f=c.substring(0,8);(f.includes("{")||f.includes("["))&&(f.includes("\\")&&(c=c.replace(/\\/g,"")),c[0]==='"'&&(c=c.substring(1,c.length-1)),c=JSON.parse(c))}return typeof c?.method=="string"?a(this.handleMethod(c.route,c.method,c.args)):typeof c?.route=="string"?a(this.handleServiceMessage(c)):typeof c?.node=="string"||c.node instanceof yr?a(this.handleGraphNodeCall(c.node,c.args)):a(c)},onabort:l=>{o(l)}})}).catch(console.error)};listen=(e="0",t=async(r,n,i)=>{let a=await r.text(),o=this.receive(a);this.setState({[i.url]:o})})=>{this.listening[e]={};let r=`${e}${Math.floor(Math.random()*1e15)}`;return this.listening[e][r]=t,this.fetchProxied||(globalThis.fetch=new Proxy(globalThis.fetch,{apply(n,i,a){let o=n.apply(i,a);return o.then(s=>{if(s.ok){if(this.listening[0])for(let l in this.listeners){let c=s.clone();this.listening[0][l](c,a,s)}else for(let l in this.listening)if(s.url.includes(l)){for(let c in this.listening[e]){let f=s.clone();this.listening[e][c](f,a,s)}break}}}).catch(s=>{console.error(s)}),o}}),this.fetchProxied=!0),r};stopListening=(e,t)=>{if(!e&&e!==0)for(let r in this.listening)delete this.listening[r];else t?delete this.listening[t]:delete this.listening[e]}},SOe=k1;nOe(SOe,"request",e=>{let t=new XMLHttpRequest;return e.responseType?t.responseType=e.responseType:e.responseType="json",e.mimeType&&t.overrideMimeType(e.mimeType),e.onload&&t.addEventListener("load",e.onload,!1),e.onprogress&&t.addEventListener("progress",e.onprogress,!1),e.onabort&&t.addEventListener("abort",e.onabort,!1),e.onloadend&&t.addEventListener("loadend",e.onloadend,!1),e.onerror&&t.addEventListener("error",e.onerror,!1),t.open(e.method,e.url,!0,e.user,e.pass),e.onerror||(t.onerror=function(){t.abort()}),t.send(e.data),t});var $u=rOe(iOe()),xOe=class extends SY{name="worker";workers={};threadRot=0;connections;constructor(e){super(),this.connections={workers:this.workers},e?.services&&this.addServices(e.services),this.load(this),this.setLoaders(this.workerloader),e&&this.init(e),typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope&&this.addDefaultMessageListener()}loadWorkerRoute=(e,t)=>{e.workerUrl&&(e.url=e.workerUrl),e.workerId&&(e.__node.tag=e.workerId),e.__node.tag||(e.__node.tag=t),e._id=e.__node.tag;let r;if(this.workers[e._id]?r=this.workers[e._id]:e.worker&&(r=e.worker),r||(r=this.addWorker(e)),e.worker=r,!e.worker.__ondisconnected){let n=i=>{i.worker?.terminate()};e.__addOndisconnected(n)}if(e.transferFunctions)for(let n in e.transferFunctions)this.transferFunction(r,e.transferFunctions[n],n);if(e.transferClasses)for(let n in e.transferClasses)this.transferClass(r,e.transferClasses[n],n);if(r)return e.__operator||(e.__operator=(...n)=>{if(e.callback)if(!this.__node.nodes.get(e.__node.tag)?.__children)r.post(e.callback,n);else return r.run(e.callback,n);else if(!this.__node.nodes.get(e.__node.tag)?.__children)r.send(n);else return r.request(n)}),e.init&&r.run(e.init,e.initArgs,void 0,e.initTransfer),r};workerloader={workers:(e,t,r,n)=>{let i=e;if(!e.parentRoute&&t?.callback&&t?.worker&&(e.parentRoute=t?.callback),i?.worker||i?.workerId||i?.workerUrl){let a=this.loadWorkerRoute(i,i.__node.tag);a&&(!i.parentRoute&&i.__parent?.callback&&(i.parentRoute=i.__parent.callback),i.__parent&&!i.portId&&(typeof i.__parent=="string"?i.__node.tag!==i.__parent&&a._id!==i.__parent&&(i.portId=this.establishMessageChannel(a,i.__parent)):i.__node.tag!==i.__parent?.__node?.tag&&a._id!==i.__parent?.tag&&(i.portId=this.establishMessageChannel(a,i.__parent.worker))),i.parentRoute?(i.stopped||(typeof i.__parent=="string"&&i.__parent===a._id?a.run("subscribe",[i.parentRoute,void 0,void 0,i.callback]):i.__node.tag===i.__parent?.__node?.tag||a._id===i.__parent?.__node?.tag?a.run("subscribe",[i.parentRoute,void 0,void 0,i.callback]):a.run("subscribeToWorker",[i.parentRoute,i.portId,void 0,i.callback,void 0,void 0,i.blocking]).then(o=>{a.workerSubs[i.parentRoute+i.portId].sub=o})),!(typeof i.__parent=="string"&&i.__parent===a._id)&&!(i.__node.tag===i.__parent?.__node?.tag||a._id===i.__parent?.__node?.tag)&&(a.workerSubs[i.parentRoute+i.portId]={sub:null,route:i.parentRoute,portId:i.portId,callback:i.callback,blocking:i.blocking})):i.__parent&&(typeof i.__parent=="string"?(i.stopped||(i.__parent===a._id?a.run("subscribe",[i.__parent,void 0,i.callback]):a.run("subscribeToWorker",[i.__parent,i.portId,void 0,i.callback,void 0,void 0,i.blocking]).then(o=>{a.workerSubs[i.__parent+i.portId].sub=o})),typeof i.__parent=="string"&&i.__parent===a._id||(a.workerSubs[i.__parent+i.portId]={sub:null,route:a._id,portId:i.portId,callback:i.callback,blocking:i.blocking})):i.__parent?.__node?.tag&&i.__parent?.worker&&(i.stopped||(i.__node.tag===i.__parent.__node.tag||a._id===i.__parent.__node.tag?a.run("subscribe",[i.__parent.__node.tag,void 0,void 0,i.callback]):a.run("subscribeToWorker",[i.__parent.__node.tag,i.portId,void 0,i.callback,void 0,void 0,i.blocking]).then(o=>{a.workerSubs[i.__parent.__node.tag+i.portId].sub=o})),i.__node.tag===i.__parent?.__node?.tag||a._id===i.__parent?.__node?.tag||(a.workerSubs[i.__parent.__node.tag+i.portId]={sub:null,route:i.__parent.__node.tag,portId:i.portId,callback:i.callback,blocking:i.blocking}))))}else i.__parent&&i.parentRoute&&(typeof i.__parent=="string"&&n[i.__parent]?.worker?n[i.__parent].worker.subscribe(i.parentRoute,i.__operator,void 0,void 0,void 0,i.blocking):i.__parent?.worker&&i.__parent.worker.subscribe(i.parentRoute,i.__operator,void 0,void 0,void 0,i.blocking));return i}};addDefaultMessageListener=()=>{globalThis.onmessage=e=>{let t=this.receive(e.data);this.__node.keepState&&this.setState({[this.name]:t})}};postMessage=(e,t,r)=>{this.workers[t]?this.workers[t].send(e,r):globalThis.postMessage(e,t,r)};addWorker=e=>{let t;if(e._id||(e._id=`worker${Math.floor(Math.random()*1e15)}`),e.url?t=new $u.default(e.url):e.port?t=e.port:this.workers[e._id]&&(this.workers[e._id].port?t=this.workers[e._id].port:t=this.workers[e._id].worker),!t)return;let r=(h,g)=>this.transmit(h,t,g),n=(h,g,_,w)=>{let E={route:h,args:g};return _&&(E.method=_),this.transmit(E,t,w)},i=(h,g,_,w)=>new Promise((E,S)=>{let A=Math.random(),O={route:"runRequest",args:[{route:h,args:g},e._id,A]};_&&(O.args[0].method=_);let C=T=>{typeof T.data=="object"&&T.data.callbackId===A&&(t.removeEventListener("message",C),E(T.data.args))};t.addEventListener("message",C),this.transmit(O,t,w)}),a=(h,g,_)=>new Promise((w,E)=>{let S=Math.random(),A={route:"runRequest",args:[h,e._id,S]};g&&(A.method=g);let O=C=>{typeof C.data=="object"&&C.data.callbackId===S&&(t.removeEventListener("message",O),w(C.data.args))};t.addEventListener("message",O),this.transmit(A,t,_)}),o={},s=(h,g,_,w,E,S)=>this.subscribeToWorker(h,e._id,g,_,w,E,S),l=(h,g)=>i("unsubscribe",[h,g]),c=async(h,g,_,w)=>{if(h)await i("subscribeToWorker",[h,g,void 0,_,w]).then(E=>{E&&(o[h+g]={sub:E,route:h,portId:g,callback:_,blocking:w})});else for(let E in o)typeof o[E].sub!="number"&&await i("subscribeToWorker",[o[E].route,o[E].portId,void 0,o[E].callback,void 0,o[E].blocking]).then(S=>{o[E].sub=S}),console.log(JSON.stringify(o));return!0},f=async(h,g)=>{if(h&&g&&o[h+g])await i("unsubscribe",[h,o[h+g].sub]),o[h+g].sub=!1;else for(let _ in o)typeof o[_].sub=="number"&&await i("unpipeWorkers",[o[_].route,o[_].portId,o[_].sub]).then(console.log),o[_].sub=!1;return!0},u=()=>{for(let h in o)typeof o[h].sub=="number"&&i("unpipeWorkers",[o[h].route,o[h].portId,o[h].sub]),o[h].sub=!1;return this.terminate(e._id)};return e.onmessage||(e.onmessage=h=>{this.receive(h.data),this.setState({[e._id]:h.data})}),e.onerror||(e.onerror=h=>{console.error(h.data)}),t.onmessage=e.onmessage,t.onerror=e.onerror,this.workers[e._id]={worker:t,send:r,post:n,run:i,request:a,subscribe:s,unsubscribe:l,terminate:u,start:c,stop:f,postMessage:t.postMessage,workerSubs:o,graph:this,...e},this.workers[e._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=e=>{let t=new Blob([e],{type:"text/javascript"});return URL.createObjectURL(t)};getTransferable(e){let t;if(typeof e=="object")if(e.args)if(e.args?.constructor?.name==="Object")for(let r in e.args)ArrayBuffer.isView(e.args[r])?t?t.push(e.args[r].buffer):t=[e.args[r].buffer]:e.args[r]?.constructor?.name==="ArrayBuffer"&&(t?t.push(e.args[r]):t=[e.args[r]]);else Array.isArray(e.args)&&e.args.length<11?e.args.forEach(r=>{ArrayBuffer.isView(r)?t=[r.buffer]:r?.constructor?.name==="ArrayBuffer"&&(t=[r])}):ArrayBuffer.isView(e.args)?t=[e.args.buffer]:e.args?.constructor?.name==="ArrayBuffer"&&(t=[e]);else if(e?.constructor?.name==="Object")for(let r in e)ArrayBuffer.isView(e[r])?t?t.push(e[r].buffer):t=[e[r].buffer]:e[r]?.constructor?.name==="ArrayBuffer"&&(t?t.push(e[r]):t=[e[r]]);else Array.isArray(e)&&e.length<11?e.forEach(r=>{ArrayBuffer.isView(r)?t=[r.buffer]:r.constructor?.name==="ArrayBuffer"&&(t=[r])}):ArrayBuffer.isView(e)?t=[e.buffer]:e.constructor?.name==="ArrayBuffer"&&(t=[e]);return t}transmit=(e,t,r)=>{if(r||(r=this.getTransferable(e)),t instanceof $u.default||t instanceof MessagePort)t.postMessage(e,r);else if(typeof t=="string")this.workers[t]&&(this.workers[t].port?this.workers[t].port.postMessage(e,r):this.workers[t].worker&&this.workers[t].worker.postMessage(e,r));else{let n=Object.keys(this.workers);this.workers[n[this.threadRot]].worker.postMessage(e,r),this.threadRot++,this.threadRot===n.length&&(this.threadRot=0)}return e};terminate=e=>{let t;if(typeof e=="string"){let r=this.workers[e];r&&(delete this.workers[e],e=r.worker,r.onclose&&(t=r.onclose))}else typeof e=="object"&&e?._id&&(e=e.worker,delete this.workers[e?._id]);return e instanceof $u.default?(e.terminate(),t&&t(e),!0):e instanceof MessagePort?(e.close(),t&&t(e),!0):!1};establishMessageChannel=(e,t)=>{let r;if(typeof e=="string"?(r=e,this.workers[e]&&(this.workers[e].port?e=this.workers[e].port:t=this.workers[e].worker)):e?.worker&&(e=e.worker),typeof t=="string"?this.workers[t]&&(this.workers[t].port?t=this.workers[t].port:t=this.workers[t].worker):t?.worker&&(t=t.worker),e instanceof $u.default||e instanceof MessagePort){let n=new MessageChannel,i=`port${Math.floor(Math.random()*1e15)}`;return e.postMessage({route:"addWorker",args:{port:n.port1,_id:i}},[n.port1]),t instanceof $u.default||t instanceof MessagePort?t.postMessage({route:"addWorker",args:{port:n.port2,_id:i}},[n.port2]):r&&this.workers[r]&&(n.port2.onmessage=this.workers[r].onmessage,this.workers[r].port=n.port2),i}return!1};request=(e,t,r,n)=>{let i=this.workers[t].worker;return new Promise((a,o)=>{let s=Math.random(),l={route:"runRequest",args:[e,s]};n&&(l.method=n);let c=f=>{typeof f.data=="object"&&f.data.callbackId===s&&(i.removeEventListener("message",c),a(f.data.args))};i.addEventListener("message",c),this.transmit(l,i,r)})};runRequest=(e,t,r)=>{let n=this.receive(e);return typeof t=="string"&&this.workers[t]&&(this.workers[t].port?t=this.workers[t].port:t=this.workers[t].worker),n instanceof Promise?n.then(i=>{t instanceof $u.default||t instanceof MessagePort?t.postMessage({args:i,callbackId:r}):typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&globalThis.postMessage({args:i,callbackId:r})}):t instanceof $u.default||t instanceof MessagePort?t.postMessage({args:n,callbackId:r}):typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&globalThis.postMessage({args:n,callbackId:r}),n};subscribeWorker=(e,t,r,n,i,a)=>{let o;if(a){let s=!1;o=l=>{s||(s=!0,l instanceof Promise?l.then(c=>{t?.run&&t.run("triggerSubscription",[e,t._id,c]).then(f=>{s=!1})}):t?.run&&t.run("triggerSubscription",[e,t._id,l]).then(c=>{s=!1}))}}else o=s=>{s instanceof Promise?s.then(l=>{t?.postMessage?t.postMessage({args:l,callbackId:e}):globalThis.postMessage&&globalThis.postMessage({args:l,callbackId:e})}):t?.postMessage?t.postMessage({args:s,callbackId:e}):globalThis.postMessage&&globalThis.postMessage({args:s,callbackId:e})};return!a&&t?.port?t=t.port:!a&&t?.worker?t=t.worker:typeof t=="string"&&this.workers[t]&&(a?t=this.workers[t]:this.workers[t].port?t=this.workers[t].port:t=this.workers[t].worker),this.subscribe(e,o,r,n,i)};subscribeToWorker=(e,t,r,n,i,a,o)=>{if(typeof t=="string"&&this.workers[t])return this.__node.state.subscribeEvent(t,s=>{s?.callbackId===e&&(r?typeof r=="string"?this.run(r,s.args):r(s.args):this.setState({[t]:s.args}))}),this.workers[t].run("subscribeWorker",[e,t,n,i,a,o])};triggerSubscription=async(e,t,r)=>{if(this.__node.state.triggers[t])for(let n=0;n<this.__node.state.triggers[t].length;n++)await this.__node.state.triggers[t][n].onchange({args:r,callbackId:e});return!0};pipeWorkers=(e,t,r,n,i,a,o,s,l)=>(typeof e=="string"&&(e=this.workers[e]),typeof t=="string"&&(t=this.workers[t]),i||(i=this.establishMessageChannel(e.worker,t.worker)),t.run("subscribeToWorker",[r,i,n,a,o,s,l]));unpipeWorkers=(e,t,r)=>{if(typeof t=="string"&&(t=this.workers[t]),typeof t=="object")return t.run("unsubscribe",[e,r])}},Ws=bN(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]),kOe=bN(["deltaX","deltaY"]),EOe=bN(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function cY(e,t){let r={type:e.type};r.isTrusted=e.isTrusted,r.bubbles=e.bubbles,r.cancelBubble=e.cancelBubble,r.cancelable=e.cancelable,r.composed=e.composed,r.defaultPrevent=e.defaultPrevented,r.eventPhase=e.eventPhase,r.returnValue=e.returnValue,r.currentTarget=e.currentTarget.id?e.currentTarget.id:e.currentTarget.constructor.name,r.target=r.currentTarget,r.srcElement=r.currentTarget,t(r)}function OOe(e,t,r){r&&e.preventDefault&&e.preventDefault(),kOe(e,t)}function AOe(e,t,r){r&&e.preventDefault&&e.preventDefault()}function IOe(e,t,r){for(let n of t)r[n]=e[n]}function bN(e){return function(r,n){let i={type:r.type};IOe(r,e,i),n(i)}}function Q3(e,t,r){r&&e.preventDefault&&e.preventDefault();let n=[],i={type:e.type,touches:n};for(let a=0;a<e.touches.length;++a){let o=e.touches[a];n.push({pageX:o.pageX,pageY:o.pageY})}t(i)}var eN=1,xY={};for(;eN<222;)xY[eN]=!0,eN++;function uY(e,t,r){let{keyCode:n}=e;xY[n]&&(r&&e.preventDefault&&(n<110||n>123)&&e.preventDefault(),EOe(e,t))}var Gm={contextmenu:AOe,mousedown:Ws,mousemove:Ws,mouseup:Ws,pointerdown:Ws,pointermove:Ws,pointerup:Ws,pointerlockchange:Ws,webkitpointerlockchange:Ws,focus:cY,blur:cY,pointerout:Ws,touchstart:Q3,touchmove:Q3,touchend:Q3,wheel:OOe,keydown:uY,keyup:uY};function _N(e,t,r,n){r||(r="proxy"+Math.floor(Math.random()*1e15));let i=s=>{t?t.postMessage({route:"handleProxyEvent",args:[s,r]}):kY(s,r)},a=Object.entries(Gm);for(let[s,l]of a)e.addEventListener(s,function(c){l(c,i,n)});Gm.keydown&&globalThis.addEventListener("keydown",function(s){Gm.keydown(s,i,n)}),Gm.keyup&&globalThis.addEventListener("keyup",function(s){Gm.keyup(s,i,n)});let o=()=>{let s=e.getBoundingClientRect();i({type:"resize",left:s.left,top:s.top,width:e.clientWidth,height:e.clientHeight})};return o(),globalThis.addEventListener("resize",o),r}var COe=class{__listeners;addEventListener(e,t){this.__listeners===void 0&&(this.__listeners={});let r=this.__listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this.__listeners===void 0)return!1;let r=this.__listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this.__listeners===void 0)return;let n=this.__listeners[e];if(n!==void 0){let i=n.indexOf(t);i!==-1&&n.splice(i,1)}}dispatchEvent(e,t){if(this.__listeners===void 0)return;let n=this.__listeners[e.type];if(n!==void 0){t?e.target=t:e.target=this;let i=n.slice(0);for(let a=0,o=i.length;a<o;a++)i[a].call(this,e)}}};function fY(){}var TOe=class extends COe{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super(),this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>({left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height});handleEvent=e=>{e.type==="resize"&&(this.left=e.left,this.top=e.top,this.width=e.width,this.height=e.height,typeof this.proxied=="object"&&(this.proxied.style.width=this.width+"px",this.proxied.style.height=this.height+"px",this.proxied.clientWidth=this.width,this.proxied.clientHeight=this.height)),e.preventDefault=fY,e.stopPropagation=fY,this.dispatchEvent(e,this.proxied)};focus(){}blur(){}},C1=class{targets={};constructor(){globalThis.document||(globalThis.document={elementFromPoint:(...e)=>this.targets[Object.keys(this.targets)[0]].proxied})}makeProxy=(e,t=void 0)=>{e||(e=`proxyReceiver${Math.floor(Math.random()*1e15)}`);let r;this.targets[e]?r=this.targets[e]:(r=new TOe,this.targets[e]=r),typeof t=="object"&&(t.proxy=r,r.proxied=t,typeof WorkerGlobalScope<"u"&&(t.style=r.style),r.width&&(t.style.width=r.width+"px",t.clientWidth=r.width),r.height&&(t.style.height=r.height+"px",t.clientHeight=r.height),t.setPointerCapture=r.setPointerCapture.bind(r),t.releasePointerCapture=r.releasePointerCapture.bind(r),t.getBoundingClientRect=r.getBoundingClientRect.bind(r),t.addEventListener=r.addEventListener.bind(r),t.removeEventListener=r.removeEventListener.bind(r),t.handleEvent=r.handleEvent.bind(r),t.dispatchEvent=r.dispatchEvent.bind(r),t.focus=r.focus.bind(r),t.blur=r.blur.bind(r))};getProxy=e=>this.targets[e];handleEvent=(e,t)=>{if(this.targets[t]||this.makeProxy(t),this.targets[t])return this.targets[t].handleEvent(e),!0}};function NOe(e,t){return this?.__node?.graph?(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new C1),this.__node.graph.ProxyManager.makeProxy(e,t)):(globalThis.ProxyManager||(globalThis.ProxyManager=new C1),globalThis.ProxyManager.makeProxy(e,t)),e}function kY(e,t){if(this?.__node?.graph){if(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new C1),this.__node.graph.ProxyManager.handleEvent(e,t))return e}else if(globalThis.ProxyManager||(globalThis.ProxyManager=new C1),globalThis.ProxyManager.handleEvent(e,t))return e}var wN={initProxyElement:_N,makeProxy:NOe,handleProxyEvent:kY};function LOe(e){if(e.worker){let t=e.worker,r=e.route;return(t instanceof Blob||typeof t=="string")&&(t=new Worker(t)),delete e.worker,delete e.route,EY(t,e,r)}else return _N(e.canvas,void 0,e._id,e.preventDefault),OY(e)}function EY(e,t,r){if(!t)return;t._id||(t._id=`canvas${Math.floor(Math.random()*1e15)}`);let n=t.canvas.transferControlToOffscreen();t.width||(t.width=t.canvas.clientWidth),t.height||(t.height=t.canvas.clientHeight);let i={route:r||"setupCanvas",args:{...t,canvas:n}};this?.__node?.graph?this.__node.graph.run("initProxyElement",t.canvas,e,t._id,t.preventDefault):_N(t.canvas,e,t._id,t.preventDefault),t.draw&&(typeof t.draw=="function"?i.args.draw=t.draw.toString():i.args.draw=t.draw),t.update&&(typeof t.update=="function"?i.args.update=t.update.toString():i.args.update=t.update),t.init&&(typeof t.init=="function"?i.args.init=t.init.toString():i.args.init=t.init),t.clear&&(typeof t.clear=="function"?i.args.clear=t.clear.toString():i.args.clear=t.clear);let a=[n];return t.transfer&&(a.push(...t.transfer),delete t.transfer),e.postMessage(i,a),{_id:t._id,width:t.width,height:t.height,worker:e,draw:(s,l)=>{e.postMessage({route:"drawFrame",args:[s,t._id]},l)},update:(s,l)=>{e.postMessage({route:"updateCanvas",args:[s,t._id]},l)},clear:()=>{e.postMessage({route:"clearCanvas",args:t._id})},init:()=>{e.postMessage({route:"initCanvas",args:t._id})},stop:()=>{e.postMessage({route:"stopAnim",args:t._id})},start:()=>{e.postMessage({route:"startAnim",args:t._id})},set:(s,l)=>{e.postMessage({route:"setDraw",args:[s,t._id]},l)},terminate:()=>{e.terminate()}}}function E1(e,t){let r;if(this?.__node?.graph?t?r=this.__node.graph.CANVASES?.[e._id]:e._id?r=this.__node.graph.CANVASES?.[e._id]:r=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:t||e._id?r=globalThis.CANVASES?.[e._id]:r=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],r)return e.canvas&&(r.canvas=e.canvas,this?.__node?.graph?this.__node.graph.run("makeProxy",r._id,r.canvas):wN.makeProxy(r._id,r.canvas)),typeof e.context=="string"?r.context=r.canvas.getContext(e.context):e.context&&(r.context=e.context),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),typeof e.draw=="string"&&(e.draw=Js(e.draw)),typeof e.draw=="function"&&(r.draw=e.draw.bind(e)),typeof e.update=="string"&&(e.update=Js(e.update)),typeof e.update=="function"&&(r.update=e.update.bind(e)),typeof e.init=="string"&&(e.init=Js(e.init)),typeof e.init=="function"&&(r.init=e.init.bind(e)),typeof e.clear=="string"&&(e.clear=Js(e.clear)),typeof e.clear=="function"&&(r.clear=e.clear.bind(e)),e._id}function OY(e){this?.__node?.graph?this.__node.graph.CANVASES||(this.__node.graph.CANVASES={}):globalThis.CANVASES||(globalThis.CANVASES={});let t=e;if(e._id?t._id=e._id:t._id=`canvas${Math.floor(Math.random()*1e15)}`,typeof e.context=="string"?t.context=e.canvas.getContext(e.context):t.context=e.context,"animating"in e?t.animating=e.animating:t.animating=!0,this?.__node?.graph?.CANVASES[t._id])this.__node.graph.run("setDraw",t);else if(globalThis.CANVASES?.[t._id])E1(t);else if(this?.__node?.graph&&(t.graph=this.__node.graph,t.__node||(t.__node={}),t.__node.tag||(t.__node.tag=t._id),t=this.__node.graph.add(t),t.__addOndisconnected=()=>{t.stop(),delete this.__node.graph.CANVASES[t._id]}),this?.__node?.graph?this.__node.graph.CANVASES[t._id]=t:globalThis.CANVASES[t._id]=t,this?.__node?.graph?this.__node.graph.run("makeProxy",t._id,t.canvas):wN.makeProxy(t._id,t.canvas),e.width&&(t.canvas.width=e.width),e.height&&(t.canvas.height=e.height),typeof t.draw=="string"?t.draw=Js(t.draw):typeof t.draw=="function"&&(t.draw=t.draw.bind(t)),typeof t.update=="string"?t.update=Js(t.update):typeof t.update=="function"&&(t.update=t.update.bind(t)),typeof t.init=="string"?t.init=Js(t.init):typeof t.init=="function"&&(t.init=t.init.bind(t)),typeof t.clear=="string"?t.clear=Js(t.clear):typeof t.clear=="function"&&(t.clear=t.clear.bind(t)),typeof t.init=="function"&&t.init(t,t.canvas,t.context),t.stop=()=>{O1(t._id)},t.start=r=>{uN(t._id,r)},t.set=r=>{E1(r,t._id)},typeof t.draw=="function"&&t.animating){let r=(n,i,a)=>{n.animating&&(n.draw(n,i,a),requestAnimationFrame(()=>{r(n,i,a)}))};r(t,t.canvas,t.context)}return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?t._id:{_id:e._id,width:e.width,height:e.height,draw:n=>{AY(n,e._id)},update:n=>{TY(n,e._id)},clear:()=>{IY(e._id)},init:()=>{CY(e._id)},stop:()=>{O1(e._id)},start:()=>{uN(e._id)},set:n=>{E1(n,e._id)},terminate:()=>{this.__node?.graph?this.__node.graph.remove(e._id):(O1(e._id),this?.__node?.graph?delete this.__node.graph.CANVASES[t._id]:delete globalThis.CANVASES[t._id])}}}function AY(e,t){let r=oc.call(this,t);if(r&&(e&&Object.assign(r,e),r.draw))return r.draw(r,r.canvas,r.context),t}function IY(e){let t=oc.call(this,e);if(t?.clear)return t.clear(t,t.canvas,t.context),e}function CY(e){let t=oc.call(this,e);if(t?.init)return t.init(t,t.canvas,t.context),e}function TY(e,t){let r=oc.call(this,t);if(r?.update)return r.update(r,r.canvas,r.context,e),t}function POe(e,t){let r=oc.call(this,t);if(r)return Object.assign(r,e),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),t}function uN(e,t){let r=oc.call(this,e);if(r.animating=!0,r&&t)return typeof t=="string"&&(t=Js(t)),typeof t=="function"&&(r.draw=t),e;if(typeof r?.draw=="function"){let n=(i,a,o)=>{i.animating&&(i.draw(i,a,o),requestAnimationFrame(()=>{n(i,a,o)}))};return typeof r.clear=="function"&&r.clear(r,r.canvas,r.context),typeof r.init=="function"&&r.init(r,r.canvas,r.context),n(r,r.canvas,r.context),e}}function O1(e){let t=oc.call(this,e);if(t)return t.animating=!1,typeof t.clear=="function"&&requestAnimationFrame(t.clear(t,t.canvas,t.context)),e}function oc(e){let t;return this?.__node?.graph?e?t=this.__node.graph.CANVASES?.[e]:t=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:e?t=globalThis.CANVASES?.[e]:t=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],t}var FOe={...wN,Renderer:LOe,transferCanvas:EY,setupCanvas:OY,setDraw:E1,drawFrame:AY,clearCanvas:IY,initCanvas:CY,updateCanvas:TY,setProps:POe,startAnim:uN,stopAnim:O1,getCanvas:oc};function Js(e=""){let t=o=>o.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),n=(o=>{let s=o.indexOf("=>")+1;return s<=0&&(s=o.indexOf("){")),s<=0&&(s=o.indexOf(") {")),o.slice(0,o.indexOf("{",s)+1)})(e),i=t(e),a;if(n.includes("function")){let o=n.split("(")[1].split(")")[0];a=new Function(o,i)}else if(n.substring(0,6)===i.substring(0,6)){let o=n.split("(")[1].split(")")[0];a=new Function(o,i.substring(i.indexOf("{")+1,i.length-1))}else try{a=(0,eval)(n+i+"}")}catch{}return a}var DOe=`(()=>{var __require=(x=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(x,{get:(a,b)=>(typeof require!=="undefined"?require:a)[b]}):x)(function(x){if(typeof require!=="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+x+'" is not supported')});var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __require2=(x=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x)(function(x){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error('Dynamic require of "'+x+'" is not supported')});var __commonJS=(cb,mod)=>function __require22(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:true}):target,mod));var __publicField=(obj,key,value)=>{__defNormalProp(obj,typeof key!=="symbol"?key+"":key,value);return value};var require_browser=__commonJS({"node_modules/web-worker/cjs/browser.js"(exports,module2){module2.exports=Worker}});var EventHandler=class{data={};triggers={};ctr=0;constructor(data){if(typeof data==="object")this.data=data}setState=updateObj=>{Object.assign(this.data,updateObj);let props=Object.getOwnPropertyNames(updateObj);for(const prop of props){this.triggerEvent(prop,this.data[prop])}if(this.triggers[statesubKey]){let run=fn=>{fn(updateObj)};const l=this.triggers[statesubKey].length;for(let i2=l-1;i2>=0;i2--){run(this.triggers[statesubKey][i2].onchange)}}return this.data};setValue=(key,value)=>{this.data[key]=value;this.triggerEvent(key,value)};triggerEvent=(key,value)=>{if(this.triggers[key]){let fn=obj=>{obj.onchange(value)};const l=this.triggers[key].length;for(let i2=l-1;i2>=0;i2--){fn(this.triggers[key][i2])}}};subscribeState=onchange=>{return this.subscribeEvent(statesubKey,onchange)};unsubscribeState=sub=>{return this.unsubscribeEvent(statesubKey,sub)};subscribeEvent=(key,onchange,refObject,refKey)=>{if(key){if(refObject&&refKey&&!this.triggers[key]){Object.defineProperty(this.data,key,{get:()=>{return refObject[refKey]},set:value=>{refObject[refKey]=value},enumerable:true,configurable:true})}if(!this.triggers[key]){this.triggers[key]=[]}let l=this.ctr;this.ctr++;this.triggers[key].push({sub:l,onchange});return l}else return void 0};unsubscribeEvent=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(sub===void 0){delete this.triggers[key];delete this.data[key]}else{let idx=void 0;let obj=triggers.find((o,i2)=>{if(o.sub===sub){idx=i2;return true}});if(obj)triggers.splice(idx,1);if(Object.keys(triggers).length===0){delete this.triggers[key];delete this.data[key]}if(this.onRemoved)this.onRemoved(obj);return true}}};subscribeEventOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeEvent(key,sub)};sub=this.subscribeEvent(key,changed);return sub};getEvent=(key,sub)=>{for(const s in this.triggers[key]){if(this.triggers[key][s].sub===sub)return this.triggers[key][s]}};getSnapshot=()=>{const snapshot={};for(const key in this.data){snapshot[key]=this.data[key]}};onRemoved};var statesubKey="*s";var state=new EventHandler;var GraphNode=class{__node={tag:\`node\${Math.floor(Math.random()*1e15)}\`,unique:\`\${Math.floor(Math.random()*1e15)}\`,state};__children;__parent;__operator;__listeners;__props;__args;constructor(properties,parent,graph){this.__setProperties(properties,parent,graph)}__setProperties=(properties,parent,graph)=>{let enforceProperties=()=>{let orig=properties;if(typeof properties==="function"){if(isNativeClass(properties)){properties=new properties}else properties={__operator:properties,__node:{forward:true,tag:properties.name}}}else if(typeof properties==="string"){if(graph?.get(properties)){properties=graph.get(properties)}}if(!("__node"in properties))properties.__node={};if(!properties.__node.initial)properties.__node.initial=orig};enforceProperties();if(typeof properties==="object"){let assignState=()=>{if(properties.__node?.state)this.__node.state=properties.__node.state;else if(graph){properties.__node.state=graph.__node.state}};let setProps2=()=>{if(properties.__props){if(typeof properties.__props==="function")properties.__props=new properties.__props;if(typeof properties.__props==="object"){this.__proxyObject(properties.__props)}}};let setTag=()=>{if(!properties.__node.tag){if(properties.__operator?.name)properties.__node.tag=properties.__operator.name;else properties.__node.tag=\`node\${Math.floor(Math.random()*1e15)}\`}};let setNode=()=>{if(typeof properties.__node==="string"){if(graph?.get(properties.__node.tag)){properties=graph.get(properties.__node.tag)}else properties.__node={}}else if(!properties.__node)properties.__node={};if(graph){properties.__node.graph=graph}if(properties instanceof Graph)properties.__node.source=properties};let setParent=()=>{if(!properties.__parent&&parent)properties.__parent=parent;if(parent?.__node&&!(parent instanceof Graph||properties instanceof Graph))properties.__node.tag=parent.__node.tag+"."+properties.__node.tag;if(parent instanceof Graph&&properties instanceof Graph){if(properties.__node.loaders)Object.assign(parent.__node.loaders?parent.__node.loaders:{},properties.__node.loaders);if(parent.__node.mapGraphs){properties.__node.nodes.forEach(n=>{parent.set(properties.__node.tag+"."+n.__node.tag,n)});let ondelete=()=>{properties.__node.nodes.forEach(n=>{parent.__node.nodes.delete(properties.__node.tag+"."+n.__node.tag)})};this.__addOndisconnected(ondelete)}}};let setOp=()=>{if(typeof properties.default==="function"&&!properties.__operator){properties.__operator=properties.default}if(properties.__operator){if(typeof properties.__operator==="string"){if(graph){let n=graph.get(properties.__operator);if(n)properties.__operator=n.__operator;if(!properties.__node.tag&&properties.__operator.name)properties.__node.tag=properties.__operator.name}}if(typeof properties.__operator==="function")properties.__operator=this.__setOperator(properties.__operator);if(properties.default)properties.default=properties.__operator}};let assignProps=()=>{properties.__node=Object.assign(this.__node,properties.__node);let keys2=Object.getOwnPropertyNames(properties).filter(v=>{if(!objProps[v])return true});for(const key of keys2){if(key in properties)this[key]=properties[key]}};let bindCallbacks=()=>{if(this.__onconnected){if(typeof this.__onconnected==="function"){this.__onconnected=this.__onconnected.bind(this)}else if(Array.isArray(this.__onconnected)){this.__onconnected=this.__onconnected.map(f=>{return f.bind(this)})}if(typeof this.__ondisconnected==="function"){this.__ondisconnected=this.__ondisconnected.bind(this)}else if(Array.isArray(this.__ondisconnected)){this.__ondisconnected=this.__ondisconnected.map(f=>{return f.bind(this)})}}};assignState();setTag();setProps2();setNode();setParent();assignProps();bindCallbacks();setOp()}};__subscribe=(callback,key,subInput,target,tkey,args)=>{const subscribeToFunction=(k,setTarget=(callback2,target2)=>target2?target2:callback2,triggerCallback=callback)=>{let wrappedArgs;if(args){let wrapped=wrapArgs(triggerCallback,args,this.__node.graph);triggerCallback=wrapped.__callback;wrappedArgs=wrapped.__args}let sub=this.__node.state.subscribeEvent(k,triggerCallback,this,key);let trigger=this.__node.state.getEvent(k,sub);if(!this.__listeners)this.__listeners={};this.__listeners[k]=this.__node.state.triggers[k];if(!trigger)return sub;trigger.source=this.__node.tag;if(key)trigger.key=key;trigger.target=setTarget(callback,target);if(subInput)trigger.subInput=subInput;if(args){trigger.arguments=args;trigger.__args=wrappedArgs}if(tkey)trigger.tkey=tkey;trigger.node=this;trigger.graph=this.__node.graph;return sub};const subscribeToGraph=callback2=>{let fn=this.__node.graph.get(callback2);if(!fn&&callback2.includes(".")){target=callback2.substring(0,callback2.lastIndexOf("."));let n=this.__node.graph.get(callback2.substring(0,target));tkey=callback2.lastIndexOf(".")+1;if(n&&typeof n[key]==="function")callback2=(...args2)=>{return n[tkey](...args2)}}else if(fn.__operator){callback2=fn.__operator;tkey="__operator"}};if(key){if(!this.__node.localState||!this.__node.localState[key]){this.__addLocalState(this,key)}if(typeof callback==="string"){tkey=callback;if(target){if(this.__node.graph?.get(target)){let n=this.__node.graph?.get(target);if(typeof n[callback]==="function"){let fn=n[callback];callback=(...inp)=>{fn(...inp)}}else{let k2=callback;let setter=inp=>{n[k2]=inp};callback=setter}}}else if(typeof this[callback]==="function"){let fn=this[callback];callback=(...inp)=>{fn(...inp)}}else if(this.__node.graph?.get(callback))subscribeToGraph(callback);if(typeof callback!=="function")return void 0}let sub;let k=subInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node)sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)});return sub}else{if(typeof callback==="string"){if(this.__node.graph.get(callback))callback=this.__node.graph.get(callback);tkey="__operator";if(typeof callback!=="object")return void 0}let sub;let k=subInput?this.__node.unique+"input":this.__node.unique;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node){sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)})}return sub}};__unsubscribe=(sub,key,unsubInput)=>{if(key){return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key,sub)}else return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"input":this.__node.unique,sub)};__setOperator=fn=>{fn=fn.bind(this);if(this.__args&&this.__node.graph){fn=wrapArgs(fn,this.__args,this.__node.graph).__callback}let inpstr=\`\${this.__node.unique}input\`;this.__operator=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[this.__node.unique]){if(typeof result?.then==="function"){result.then(res=>{if(res!==void 0)this.__node.state.setValue(this.__node.unique,res)}).catch(console.error)}else if(result!==void 0)this.__node.state.setValue(this.__node.unique,result)}return result};if(this.__parent instanceof GraphNode&&!this.__subscribedToParent){if(this.__parent.__operator){let sub=this.__parent.__subscribe(this);let ondelete=()=>{this.__parent?.__unsubscribe(sub);delete this.__subscribedToParent};this.__addOndisconnected(ondelete);this.__subscribedToParent=true}}return this.__operator};__addLocalState=(props,key)=>{if(!props)return;if(!this.__node.localState){this.__node.localState={}}const localState=this.__node.localState;const initState=(props2,k)=>{let str2=this.__node.unique+"."+k;let inpstr=\`\${str2}input\`;let get,set;let obj,descriptor;if(typeof props2[k]==="function"&&k!=="__operator"){if(this.__props?.[k]){obj=this.__props}else{obj=localState}get=()=>{return obj[k]};set=fn=>{if(!this.__props?.[k])fn=fn.bind(this);obj[k]=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[str2]){if(typeof result?.then==="function"){result.then(res=>{this.__node.state.triggerEvent(str2,res)}).catch(console.error)}else this.__node.state.triggerEvent(str2,result)}return result}};localState[k]=props2[k].bind(this);descriptor={get,set,enumerable:true,configurable:true}}else{let get2,set2;let obj2;if(this.__props?.[k]){obj2=this.__props}else{obj2=localState}get2=()=>{return obj2[k]};set2=v=>{obj2[k]=v;if(this.__node.state.triggers[str2])this.__node.state.triggerEvent(str2,v)};localState[k]=props2[k];descriptor={get:get2,set:set2,enumerable:true,configurable:true}}Object.defineProperty(props2,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}};if(key)initState(props,key);else{for(let k in props){initState(props,k)}}};__proxyObject=obj=>{const allProps=getAllProperties(obj);for(const k of allProps){const descriptor={get:()=>{return obj[k]},set:value=>{obj[k]=value},enumerable:true,configurable:true};Object.defineProperty(this,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}}};__addOnconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__onconnected)){this.__onconnected.push(callback)}else if(typeof this.__onconnected==="function"){this.__onconnected=[callback,this.__onconnected]}else this.__onconnected=callback}__addOndisconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__ondisconnected)){this.__ondisconnected.push(callback)}else if(typeof this.__ondisconnected==="function"){this.__ondisconnected=[callback,this.__ondisconnected]}else this.__ondisconnected=callback}__callConnected(node=this){if(typeof this.__onconnected==="function"){this.__onconnected(this)}else if(Array.isArray(this.__onconnected)){let fn=o=>{o(this)};this.__onconnected.forEach(fn)}}__callDisconnected(node=this){if(typeof this.__ondisconnected==="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let fn=o=>{o(this)};this.__ondisconnected.forEach(fn)}}};var Graph=class{__node={tag:\`graph\${Math.floor(Math.random()*1e15)}\`,unique:\`\${Math.random()}\`,nodes:new Map,state,roots:{}};constructor(options){this.init(options)}init=options=>{if(options){let cpy=Object.assign({},options);delete cpy.roots;recursivelyAssign(this.__node,cpy);if(options.roots)this.load(options.roots)}};load=roots=>{function recursivelyAssignChildren(target,obj,inChildren=true,top=true){if(top){if(target)Object.assign(target,obj);else target=Object.assign({},obj);recursivelyAssignChildren(target,obj,true,false)}if(obj?.__children&&!inChildren){if(obj.__children?.constructor.name==="Object"){if(target.__children?.constructor.name==="Object")recursivelyAssignChildren(target.__children,obj.__children,true,false);else target.__children=recursivelyAssignChildren({},obj.__children,true,false)}else{target.__children=obj.__children}}else if(inChildren){for(const key in obj){target[key]=Object.assign({},obj[key]);if(obj[key]?.__children){recursivelyAssignChildren({},obj[key].__children,false,false)}}}return target}this.__node.roots=recursivelyAssignChildren(this.__node.roots?this.__node.roots:{},roots);let cpy=Object.assign({},roots);if(cpy.__node)delete cpy.__node;let listeners=this.recursiveSet(cpy,this,void 0,roots);if(roots.__node){if(!roots.__node.tag)roots.__node._tag=\`roots\${Math.floor(Math.random()*1e15)}\`;else if(!this.get(roots.__node.tag)){let node=new GraphNode(roots,this,this);this.set(node.__node.tag,node);this.runLoaders(node,this,roots,roots.__node.tag);if(node.__listeners){listeners[node.__node.tag]=node.__listeners}}}else if(roots.__listeners){this.setListeners(roots.__listeners)}this.setListeners(listeners);return cpy};setLoaders=(loaders2,replace)=>{if(replace)this.__node.loaders=loaders2;else Object.assign(this.__node.loaders,loaders2);return this.__node.loaders};runLoaders=(node,parent,properties,key)=>{for(const l in this.__node.loaders){if(typeof this.__node.loaders[l]==="object"){if(this.__node.loaders[l].init)this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key);if(this.__node.loaders[l].connected)node.__addOnconnected(this.__node.loaders[l].connect);if(this.__node.loaders[l].disconnected)node.__addOndisconnected(this.__node.loaders[l].disconnect)}else if(typeof this.__node.loaders[l]==="function")this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key)}};add=(properties,parent)=>{let listeners={};if(typeof parent==="string")parent=this.get(parent);let instanced;if(typeof properties==="function"){if(isNativeClass(properties)){if(properties.prototype instanceof GraphNode){properties=properties.prototype.constructor(properties,parent,this);instanced=true}else properties=new properties}else properties={__operator:properties}}else if(typeof properties==="string"){properties=this.__node.roots[properties]}if(!properties)return;if(!instanced){let keys2=Object.getOwnPropertyNames(properties);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(properties));keys2.push(...nonArrowFunctions);keys2=keys2.filter(v=>!objProps.includes(v));let cpy={};for(const key of keys2){cpy[key]=properties[key]}properties=cpy}if(!properties.__node)properties.__node={};properties.__node.initial=properties;if(typeof properties==="object"&&!this.get(properties.__node.tag)){let node;let root=recursivelyAssign({},properties,2);if(instanced)node=properties;else node=new GraphNode(properties,parent,this);this.set(node.__node.tag,node);this.runLoaders(node,parent,properties,node.__node.tag);this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key in node.__listeners){let listener=node.__listeners[key];if(node[key]){delete listeners[node.__node.tag][key];listeners[node.__node.tag][node.__node.tag+"."+key]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][key]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][key]=parent.__node.tag}}}}this.setListeners(listeners);node.__callConnected();return node}else if(properties.__node.tag)return this.get(properties.__node.tag)};recursiveSet=(t2,parent,listeners={},origin)=>{let keys2=Object.getOwnPropertyNames(origin);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(origin)).filter(v=>!objProps.includes(v));keys2.push(...nonArrowFunctions);for(const key of keys2){if(key.includes("__"))continue;let p=origin[key];if(Array.isArray(p))continue;let instanced;if(typeof p==="function"){if(isNativeClass(p)){p=new p;if(p instanceof GraphNode){p=p.prototype.constructor(p,parent,this);instanced=true}}else p={__operator:p}}else if(typeof p==="string"){if(this.__node.nodes.get(p))p=this.__node.nodes.get(p);else p=this.__node.roots[p]}else if(typeof p==="boolean"){if(this.__node.nodes.get(key))p=this.__node.nodes.get(key);else p=this.__node.roots[key]}if(p instanceof Object){if(!instanced&&!(p instanceof GraphNode)){let ks=Object.getOwnPropertyNames(p);let nonArrowFunctions2=Object.getOwnPropertyNames(Object.getPrototypeOf(p));nonArrowFunctions2.splice(nonArrowFunctions2.indexOf("constructor"),1);ks.push(...nonArrowFunctions2);let cpy={};for(const key2 of ks){cpy[key2]=p[key2]}p=cpy}if(!p.__node)p.__node={};if(!p.__node.tag)p.__node.tag=key;if(!p.__node.initial)p.__node.initial=t2[key];if(this.get(p.__node.tag)&&!(!(parent instanceof Graph)&&parent?.__node)||parent?.__node&&this.get(parent.__node.tag+"."+p.__node.tag))continue;let node;let newnode=false;let root=recursivelyAssign({},p,2);if(instanced||p instanceof GraphNode){node=p}else{node=new GraphNode(p,parent,this);newnode=true}if(!newnode&&p instanceof GraphNode&&!instanced&&parent instanceof GraphNode){let sub=this.subscribe(parent.__node.tag,node.__node.tag);let ondelete=node2=>{this.unsubscribe(parent.__node.tag,sub)};node.__addOndisconnected(ondelete)}else if(node){this.set(node.__node.tag,node);this.runLoaders(node,parent,t2[key],key);t2[key]=node;this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key2 in node.__listeners){let listener=node.__listeners[key2];let k=key2;if(node[key2]){delete listeners[node.__node.tag][key2];k=node.__node.tag+"."+key2;listeners[node.__node.tag][k]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][k]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][k]=parent.__node.tag}}}}node.__callConnected()}}}return listeners};remove=(node,clearListeners=true)=>{this.unsubscribe(node);if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){this.delete(node.__node.tag);delete this.__node.roots[node.__node.tag];if(clearListeners){this.clearListeners(node)}node.__callDisconnected();const recursiveRemove=t2=>{for(const key in t2){this.unsubscribe(t2[key]);this.delete(t2[key].__node.tag);delete this.__node.roots[t2[key].__node.tag];this.delete(key);delete this.__node.roots[key];t2[key].__node.tag=t2[key].__node.tag.substring(t2[key].__node.tag.lastIndexOf(".")+1);if(clearListeners){this.clearListeners(t2[key])}t2[key].__callDisconnected();if(t2[key].__children){recursiveRemove(t2[key].__children)}}};if(node.__children){recursiveRemove(node.__children)}}if(node?.__node.tag&&node?.__parent){delete node?.__parent;node.__node.tag=node.__node.tag.substring(node.__node.tag.indexOf(".")+1)}if(node?.__node.graph)node.__node.graph=void 0;return node};run=(node,...args)=>{if(typeof node==="string"){let nd=this.get(node);if(!nd&&node.includes(".")){nd=this.get(node.substring(0,node.lastIndexOf(".")));if(typeof nd?.[node.substring(node.lastIndexOf(".")+1)]==="function")return nd[node.substring(node.lastIndexOf(".")+1)](...args)}else if(nd?.__operator)return nd.__operator(...args)}if(node?.__operator){return node?.__operator(...args)}};setListeners=listeners=>{for(const key in listeners){let node=this.get(key);if(typeof listeners[key]==="object"){for(const k in listeners[key]){let n=this.get(k);let sub;if(typeof listeners[key][k]!=="object")listeners[key][k]={__callback:listeners[key][k]};else if(!listeners[key][k].__callback){for(const kk in listeners[key][k]){if(typeof listeners[key][k][kk]!=="object"){listeners[key][k][kk]={__callback:listeners[key][k][kk]};if(node.__operator&&(listeners[key][k][kk].__callback===true||typeof listeners[key][k][kk].__callback==="undefined"))listeners[key][k][kk].__callback=node.__operator}let nn=this.get(kk);if(!nn){let tag=k.substring(0,k.lastIndexOf("."));nn=this.get(tag);if(nn){let prop=k.substring(k.lastIndexOf(".")+1);sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k][kk].__args,prop,listeners[key][k][kk].inputState,key,k)}}else{sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}if("__callback"in listeners[key][k]){if(node){if(listeners[key][k].__callback===true||typeof listeners[key][k].__callback==="undefined")listeners[key][k].__callback=node.__operator;if(typeof listeners[key][k].__callback==="function")listeners[key][k].__callback=listeners[key][k].__callback.bind(node)}if(!n){let tag=k.substring(0,k.lastIndexOf("."));n=this.get(tag);if(n){sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,k.substring(k.lastIndexOf(".")+1),listeners[key][k].inputState,key,k)}}else{sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}}}};clearListeners=(node,listener)=>{if(typeof node==="string")node=this.get(node);if(node?.__listeners){for(const key in node.__listeners){if(listener&&key!==listener)continue;if(typeof node.__listeners[key]?.sub!=="number")continue;let n=this.get(key);if(!n){n=this.get(key.substring(0,key.lastIndexOf(".")));if(n){if(typeof node.__listeners[key]==="object"&&!node.__listeners[key]?.__callback){for(const k in node.__listeners[key]){if(typeof node.__listeners[key][k]?.sub==="number"){this.unsubscribe(n,node.__listeners[key][k].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}else{if(typeof!node.__listeners[key]?.__callback==="number"){for(const k in node.__listeners[key]){if(node.__listeners[key][k]?.sub){this.unsubscribe(n,node.__listeners[key][k].sub,void 0,node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,void 0,node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}}};get=tag=>{return this.__node.nodes.get(tag)};set=(tag,node)=>{return this.__node.nodes.set(tag,node)};delete=tag=>{return this.__node.nodes.delete(tag)};getProps=(node,getInitial)=>{if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){let cpy;if(getInitial)cpy=Object.assign({},this.__node.roots[node.__node.tag]);else{cpy=Object.assign({},node);for(const key in cpy){if(key.includes("__"))delete cpy[key]}}}};subscribe=(nodeEvent,onEvent,args,key,subInput,target,bound,tkey)=>{let nd=nodeEvent;if(typeof nodeEvent==="string"){nd=this.get(nodeEvent);if(!nd&&nodeEvent.includes(".")){nd=this.get(nodeEvent.substring(0,nodeEvent.lastIndexOf(".")));key=nodeEvent.substring(nodeEvent.lastIndexOf(".")+1)}}if(target instanceof GraphNode)target=target.__node.tag;if(typeof onEvent==="string"){let setOnEventFromString=onEvent2=>{if(this.get(onEvent2)?.__operator){let node=this.get(onEvent2);target=onEvent2;onEvent2=function(...inp){return node.__operator(...inp)}}else if(onEvent2.includes(".")){target=onEvent2.substring(0,onEvent2.lastIndexOf("."));let n=this.get(target);let k=onEvent2.substring(onEvent2.lastIndexOf(".")+1);tkey=k;if(typeof n[k]==="function"){if(n[k]instanceof GraphNode)onEvent2=n[k];else onEvent2=function(...inp){return n[k](...inp)}}else{onEvent2=function(inp){n[k]=inp;return n[k]}}}return onEvent2};if(target){let node=this.get(target);if(typeof node?.[onEvent]==="function"){tkey=onEvent;onEvent=function(...inp){return node[key](...inp)}}else if(node[key]){tkey=key;if(node[key]instanceof GraphNode)onEvent=node[key];else onEvent=function(inp){node[key]=inp;return node[key]}}else{onEvent=setOnEventFromString(onEvent)}}else{onEvent=setOnEventFromString(onEvent)}}let sub;if(nd instanceof GraphNode){const doSub=()=>{sub=nd.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)nd.__unsubscribe(sub,key,subInput);sub=void 0};nd.__addOndisconnected(()=>{ondelete();nd.__addOnconnected(()=>{if(sub===void 0&&nd.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))onEvent=this.get(onEvent);if(onEvent instanceof GraphNode){onEvent.__addOndisconnected(()=>{ondelete()})}};doSub()}else if(typeof nodeEvent==="string"){let node=this.get(nodeEvent);if(node){if(onEvent instanceof GraphNode&&onEvent.__operator){const doSub=()=>{sub=node.__subscribe(onEvent.__operator,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput)};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});onEvent.__addOndisconnected(ondelete)};doSub()}else if(typeof onEvent==="function"||typeof onEvent==="string"){const doSub=()=>{sub=node.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput);sub=void 0};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))this.get(onEvent).__addOndisconnected(ondelete)};doSub()}}else{if(typeof onEvent==="string")onEvent=this.__node.nodes.get(onEvent).__operator;if(typeof onEvent==="function")sub=this.__node.state.subscribeEvent(nodeEvent,onEvent)}}return sub};unsubscribe=(node,sub,key,subInput)=>{if(node instanceof GraphNode){return node.__unsubscribe(sub,key,subInput)}else return this.get(node)?.__unsubscribe(sub,key,subInput)};setState=update=>{this.__node.state.setState(update)}};function recursivelyAssign(target,obj,maxDepth=Infinity,curDepth=0){for(const key in obj){if(obj[key]?.constructor.name==="Object"&&curDepth<maxDepth){curDepth++;if(target[key]?.constructor.name==="Object")recursivelyAssign(target[key],obj[key],maxDepth,curDepth);else target[key]=recursivelyAssign({},obj[key],maxDepth,curDepth)}else{target[key]=obj[key]}}return target}function getAllProperties(obj){var allProps=[],curr=obj;do{var props=Object.getOwnPropertyNames(curr);let fn=function(prop){if(allProps.indexOf(prop)===-1)allProps.push(prop)};props.forEach(fn)}while(curr=Object.getPrototypeOf(curr));return allProps}function isNativeClass(thing){return isFunction(thing)==="class"}function isFunction(x){const res=typeof x==="function"?x.prototype?Object.getOwnPropertyDescriptor(x,"prototype")?.writable?"function":"class":x.constructor.name==="AsyncFunction"?"async":"arrow":"";return res}var getCallbackFromString=(a,graph)=>{if(graph.get(a)?.__operator){let node=graph.get(a);return(...inp)=>{node.__operator(...inp)}}else if(a.includes(".")){let split=a.split(".");let popped=split.pop();let joined=split.join(".");let node=graph.get(joined);if(typeof graph.get(joined)?.[popped]==="function"){return(...inp)=>{return node[popped](...inp)}}else return()=>{return node[popped]}}else if(graph.get(a)){let node=graph.get(a);return()=>{return node}}else{let arg=a;return()=>{return arg}}};var wrapArgs=(callback,argOrder,graph)=>{let args=[];let forArg=(a,i2)=>{if(a==="__output"||a==="__input"||a==="__callback"){args[i2]={__callback:inp=>{return inp},__args:void 0,idx:i2}}else if(typeof a==="string"){args[i2]={__callback:getCallbackFromString(a,graph),__args:void 0,idx:i2}}else if(typeof a==="function"){let fn2=a;args[i2]={__callback:(...inp)=>{return fn2(...inp)},__args:void 0,idx:i2}}else if(typeof a==="object"&&(a.__input||a.__callback)){let recursivelyCreateCallback=function(c){let input=c.__input?c.__input:c.__callback;if(typeof c.__input==="string"){input={__callback:getCallbackFromString(c.__input,graph),__args:void 0,idx:i2}}if(c.__args){let wrapped=wrapArgs(input,c.__args,graph);input={__callback:wrapped.__callback,__args:wrapped.__args,idx:i2}}else{input={__callback:input,__args:void 0,idx:i2}}if(c.__output){let output=c.__output;if(typeof c.__output==="string"){output={__callback:getCallbackFromString(output,graph),__args:void 0,idx:i2}}else if(typeof a.__output==="object"){output=recursivelyCreateCallback(output)}if(typeof output?.__callback==="function"){let fn2=input.__callback;let callback2=output.__callback;input={__callback:(...inp)=>{return callback2(fn2(...inp))},__args:output.__args,idx:i2}}}return input};args[i2]=recursivelyCreateCallback(a)}else{let arg=a;args[i2]={__callback:()=>{return arg},__args:void 0,idx:i2}}};argOrder.forEach(forArg);if(typeof callback==="string")callback={__callback:getCallbackFromString(callback,graph),__args:void 0};let fn=typeof callback==="function"?callback:callback.__callback;callback=function(...inp){let mapArg=arg=>{return arg.__callback(...inp)};const result=fn(...args.map(mapArg));return result};return{__callback:callback,__args:args}};var objProps=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var backprop=(node,parent,graph)=>{if(node.__node.backward&&parent instanceof GraphNode){graph.setListeners({[parent.__node.tag]:{[node.__node.tag]:parent}})}};var loop=(node,parent,graph)=>{if(node.__operator&&!node.__node.looperSet){if(typeof node.__node.delay==="number"){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{setTimeout(async()=>{res(await fn(...args))},node.__node.delay)})})}else if(node.__node.frame===true){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{requestAnimationFrame(async()=>{res(await fn(...args))})})})}if(typeof node.__node.repeat==="number"||typeof node.__node.recursive==="number"){let fn=node.__operator;node.__setOperator(async(...args)=>{let i2=node.__node.repeat?node.__node.repeat:node.__node.recursive;let result;let repeater=async(tick,...inp)=>{while(tick>0){if(node.__node.delay||node.__node.frame){fn(...inp).then(async res=>{if(node.__node.recursive){await repeater(tick,res)}else await repeater(tick,...inp)});break}else result=await fn(...args);tick--}};await repeater(i2,...args);return result})}if(node.__node.loop&&typeof node.__node.loop==="number"){node.__node.looperSet=true;let fn=node.__operator;let time=node.__node.loop;node.__setOperator((...args)=>{if(!("looping"in node.__node))node.__node.looping=true;if(node.__node.looping){let last=performance.now();fn(...args);setTimeout(()=>{let now=performance.now();let overshoot=now-last-node.__node.loop;if(overshoot>0)time=node.__node.loop-overshoot;else time=node.__node.loop;if(time<=0)time=node.__node.loop;node.__operator(...args)},time)}});if(node.__node.looping)node.__operator();let ondelete=node2=>{if(node2.__node.looping)node2.__node.looping=false};node.__addOndisconnected(ondelete)}}};var animate=(node,parent,graph)=>{if(node.__node.animate===true||node.__animation){let fn=node.__operator;node.__setOperator((...args)=>{if(!("animating"in node.__node))node.__node.animating=true;if(node.__node.animating){if(typeof node.__animation==="function")node.__animation(...args);else fn(...args);requestAnimationFrame(()=>{node.__operator(...args)})}});if(node.__node.animating||(!("animating"in node.__node)||node.__node.animating)&&node.__animation)setTimeout(()=>{requestAnimationFrame(node.__operator)},10);let ondelete=node2=>{if(node2.__node.animating)node2.__node.animating=false};node.__addOndisconnected(ondelete)}};var branching=(node,parent,graph)=>{if(typeof node.__branch==="object"&&node.__operator&&!node.__branchApplied){let fn=node.__operator;node.__branchApplied=true;node.__operator=(...args)=>{let result=fn(...args);for(const key in node.__branch){let triggered=()=>{if(typeof node.__branch[key].then==="function"){node.__branch[key].then(result)}else if(node.__branch[key].then instanceof GraphNode&&node.__branch[key].then.__operator){node.__branch[key].then.__operator(result)}else result=node.__branch[key].then};if(typeof node.__branch[key].if==="function"){if(node.__branch[key].if(result)==true){triggered()}}else if(node.__branch[key].if===result){triggered()}}return result}}if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].branch&&!node.__listeners[key].branchApplied){let fn=node.__listeners[key].callback;node.__listeners[key].branchApplied=true;node.__listeners.callback=ret=>{let triggered=()=>{if(typeof node.__listeners[key].branch.then==="function"){ret=node.__listeners[key].branch.then(ret)}else if(node.__listeners[key].branch.then instanceof GraphNode&&node.__listeners[key].branch.then.__operator){ret=node.__listeners[key].branch.then.__operator(ret)}else ret=node.__listeners[key].branch.then};if(typeof node.__listeners[key].branch.if==="function"){if(node.__listeners[key].branch.if(ret)){triggered()}}else if(node.__listeners[key].branch.if===ret){triggered()}return fn(ret)}}}}}};var triggerListenerOncreate=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].oncreate){node.__listeners[key].callback(node.__listeners[key].oncreate)}}}}};var bindListener=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].binding==="object"){node.__listeners.callback=node.__listeners.callback.bind(node.__listeners[key].binding)}}}}};var transformListenerResult=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].transform==="function"&&!node.__listeners[key].transformApplied){let fn=node.__listeners[key].callback;node.__listeners[key].transformApplied=true;node.__listeners.callback=ret=>{ret=node.__listeners[key].transform(ret);return fn(ret)}}}}}};var substitute__operator=(node,parent,graph)=>{if(node.post&&!node.__operator){node.__setOperator(node.post)}else if(!node.__operator&&typeof node.get=="function"){node.__setOperator(node.get)}if(!node.get&&node.__operator){node.get=node.__operator}if(node.aliases){node.aliases.forEach(a=>{graph.set(a,node);let ondelete=node2=>{graph.__node.nodes.delete(a)};node.__addOndisconnected(ondelete)})}if(typeof graph.__node.roots?.[node.__node.tag]==="object"&&node.get)graph.__node.roots[node.__node.tag].get=node.get};var loaders={backprop,loop,animate,branching,triggerListenerOncreate,bindListener,transformListenerResult,substitute__operator};var recursivelyStringifyFunctions=obj=>{let cpy={};for(const key in obj){if(typeof obj[key]==="object"){cpy[key]=recursivelyStringifyFunctions(obj[key])}else if(typeof obj[key]==="function"){cpy[key]=obj[key].toString()}else cpy[key]=obj[key]}return cpy};function parseFunctionFromText(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs22(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs}var stringifyFast=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p in value[prop]){if(Array.isArray(value[prop][p])){if(value[prop][p].length>20)obj[prop][p]=value[prop][p].slice(value[prop][p].length-20);else obj[prop][p]=value[prop][p]}else{if(value[prop][p]!=null){let con=value[prop][p].constructor.name;if(con.includes("Set")){obj[prop][p]=Array.from(value[prop][p])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p]="instanceof_"+con}else{obj[prop][p]=value[prop][p]}}else{obj[prop][p]=value[prop][p]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast22(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast}function methodstrings(node){if(typeof node.__methods==="object"){for(const key in node.__methods){let fstr=node.__methods[key];let fn=typeof fstr==="function"?fstr:parseFunctionFromText(fstr);if(key==="__operator"){node.__setOperator(fn)}else{node[key]=fn.bind(node)}}}}var Service=class extends Graph{name=\`service\${Math.floor(Math.random()*1e15)}\`;constructor(options){super({...options,loaders:options?.loaders?Object.assign({...loaders},options.loaders):{...loaders}});if(options?.services)this.addServices(options.services);this.load(this)}addServices=services=>{for(const s in services){if(typeof services[s]==="function")services[s]=new services[s];if(services[s]?.__node?.loaders)Object.assign(this.__node.loaders,services[s].__node.loaders);if(services[s]?.__node?.nodes){services[s].__node.nodes.forEach((n,tag)=>{if(!this.get(tag)){this.set(tag,n)}else this.set(s+"."+tag,n)});this.__node.nodes.forEach((n,k)=>{if(!services[s].__node.nodes.get(k))services[s].__node.nodes.set(k,n)});let set=this.set;this.set=(tag,node)=>{services[s].set(tag,node);return set(tag,node)};let del=this.delete;this.delete=tag=>{services[s].delete(tag);return del(tag)}}else if(typeof services[s]==="object"){this.load(services[s])}}};handleMethod=(route,method,args)=>{let m=method.toLowerCase();let src=this.__node.nodes.get(route);if(!src){src=this.__node.roots[route]}if(src?.[m]){if(typeof src[m]!=="function"){if(args){if(Array.isArray(args)&&args.length===1)src[m]=args[0];else src[m]=args;return}return src[m]}else{if(Array.isArray(args))return src[m](...args);else return src[m](args)}}else return this.handleServiceMessage({route,args,method})};handleServiceMessage(message){let call;if(typeof message==="object"){if(message.route)call=message.route;else if(message.node)call=message.node}if(call){if(Array.isArray(message.args))return this.run(call,...message.args);else return this.run(call,message.args)}else return message}handleGraphNodeCall(route,args){if(!route)return args;if(args?.args){this.handleServiceMessage(args)}else if(Array.isArray(args))return this.run(route,...args);else return this.run(route,args)}transmit=(...args)=>{if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};receive=(...args)=>{if(args[0]){if(typeof args[0]==="string"){let substr=args[0].substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))args[0]=args[0].replace(/\\\\/g,"");if(args[0][0]==='"'){args[0]=args[0].substring(1,args[0].length-1)};args[0]=JSON.parse(args[0])}}}if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};pipe=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return this.subscribe(source,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})};pipeOnce=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return source.__node.state.subscribeEventOnce(source.__node.unique,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.__node.state.subscribeEventOnce(source.__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(source).__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})};terminate=(...args)=>{};isTypedArray=isTypedArray;recursivelyAssign=recursivelyAssign2;spliceTypedArray=spliceTypedArray;ping=()=>{console.log("pinged!");return"pong"};echo=(...args)=>{this.transmit(...args);return args};log=(...args)=>{console.log(...args);return true};error=(...args)=>{console.error(...args);return true}};function isTypedArray(x){return ArrayBuffer.isView(x)&&Object.prototype.toString.call(x)!=="[object DataView]"}var recursivelyAssign2=(target,obj)=>{for(const key in obj){if(obj[key]?.constructor.name==="Object"&&!Array.isArray(obj[key])){if(target[key]?.constructor.name==="Object"&&!Array.isArray(target[key]))recursivelyAssign2(target[key],obj[key]);else target[key]=recursivelyAssign2({},obj[key])}else target[key]=obj[key]}return target};function spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let ta;if(s.length>0||e?.length>0)ta=new arr.constructor(s.length+e.length);if(ta){if(s.length>0)ta.set(s);if(e&&e.length>0)ta.set(e,s.length)}return ta}var nodeTemplates={};var remoteGraphRoutes={transferNode:(properties,connection,name2)=>{let str2;if(typeof properties==="object"){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}str2=recursivelyStringifyFunctions(properties)}else if(typeof properties==="function")str2=properties.toString();else if(typeof properties==="string")str2=properties;if(str2){if(connection.run)return connection.run("setNode",[str2]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:str2},void 0);return new Promise(r=>r(name2))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:str2}));return new Promise(r=>r(name2))}}},setNode:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function")properties={__operator:f,__node:{tag:name2?name2:f.name}};else{f=JSON.parse(properties);if(typeof f==="object")properties=f}}if(typeof properties==="object"||typeof properties==="function"){let template={};if(typeof properties==="object")Object.assign(template,properties);else template.__operator=properties;let node=this.__node.graph.add(template);if(node){nodeTemplates[node.__node.tag]=template;return node.__node?.tag}else return false}else return false},proxyRemoteNode:function(name2,connection){return new Promise((res,rej)=>{connection.run("getNodeProperties",name2).then(props=>{let proxy={};if(typeof props==="object"){for(const key in props){if(props[key]==="function"){proxy[key]=(...args)=>{return new Promise(r=>{connection.run(name2,args,key).then(r)})}}else{Object.defineProperty(proxy,key,{get:()=>{return new Promise(r=>{connection.run(name2,void 0,key).then(r)})},set:value=>{connection.post(name2,value,key)},configurable:true,enumerable:true})}}}res(proxy)})})},makeNodeTransferrable:function(properties,name2){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}const str2=recursivelyStringifyFunctions(properties);return str2},setTemplate:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function"){if(!name2)name2=f.name;properties={__operator:f,__node:{tag:name2}}}else{f=JSON.parse(properties);if(typeof f==="object"){properties=f;if(!name2&&f.__node?.tag)name2=f.__node.tag}}}if(!name2)name2=\`node\${Math.floor(Math.random()*1e15)}\`;if(typeof properties==="object"||typeof properties==="function"){nodeTemplates[name2]=properties;return name2}else return false},loadFromTemplate:function(templateName,name2,properties){if(nodeTemplates[templateName]){let cpy=recursivelyAssign2({},nodeTemplates[templateName]);if(name2){if(!cpy.__node)cpy.__node={};cpy.__node.tag=name2}if(properties)Object.assign(cpy,properties);let node=this.__node.graph.add(cpy);return node.__node.tag}},setMethod:function(nodeTag,fn,methodKey){if(typeof fn==="string"){let f=parseFunctionFromText(fn);if(typeof f==="function")fn=f}if(!methodKey&&typeof fn==="function")methodKey=fn.name;if(this.__node.graph.get(nodeTag)){this.__node.graph.get(nodeTag)[methodKey]=fn}else this.__node.graph.add({__node:{tag:methodKey,[methodKey]:fn}});return true},assignNode:function(nodeTag,source){if(this.__node.graph.get(nodeTag)&&typeof source==="object"){Object.assign(this.__node.graph.get(nodeTag),source)}},getNodeProperties:function(nodeTag){let node=this.__node.graph.get(nodeTag);if(node){let properties=Object.getOwnPropertyNames(node);let result={};for(const key in properties){result[key]=typeof node[key]}return result}return void 0},transferClass:(classObj,connection,className)=>{if(typeof classObj==="object"){let str2=classObj.toString();let message={route:"receiveClass",args:[str2,className]};if(connection.run)return connection.run("receiveClass",[str2,className]);else if(connection.postMessage){connection.postMessage({route:"receiveClass",args:[str2,className]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"receiveClass",args:[str2,className]}));return new Promise(r=>r(name))}return message}return false},receiveClass:function(stringified,className){if(typeof stringified==="string"){if(stringified.indexOf("class")===0){let cls=(0,eval)("("+stringified+")");let name2=className;if(!name2)name2=cls.name;this.__node.graph[name2]=cls;return true}}return false},transferFunction:(fn,connection,fnName)=>{if(!fnName)fnName=fn.name;let str2=fn.toString();let message={route:"setNode",args:[str2,fnName]};if(connection.run)return connection.run("setNode",[str2,fnName]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:[str2,fnName]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:[str2,fnName]}));return new Promise(r=>r(name))}return message},setGlobal:(key,value)=>{globalThis[key]=value;return true},assignGlobalObject:(target,source)=>{if(!globalThis[target])return false;if(typeof source==="object")Object.assign(globalThis[target],source);return true},setValue:function(key,value){this.__node.graph[key]=value;return true},assignObject:function(target,source){if(!this.__node.graph[target])return false;if(typeof source==="object")Object.assign(this.__node.graph[target],source);return true},setGlobalFunction:(fn,fnName)=>{if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;globalThis[fnName]=fn;return true}return false},setGraphFunction:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.__node.graph[fnName]=fn;return true}return false}};function html(strings,...args){return function append(elm=document.createElement("div")){let template=document.createElement("template");strings.map(function(s,i2){template.innerHTML+=s;if(args[i2]instanceof HTMLElement){let dummy2=\`<span id="dummyNode12345"></span>\`;dummy2.id="dummyNode12345";template.innerHTML+=dummy2}else template.innerHTML+=args[i2]});let query=template.content.querySelectorAll("#dummyNode12345");let ctr=0;args.forEach((arg,i2)=>{if(arg instanceof HTMLElement){console.log(arg,query[ctr]);template.content.replaceChild(arg,query[ctr]);ctr++}});elm.appendChild(template.content);return elm}}var dummy=html\`\`;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl.cipher.aes=function(a){this.s[0][0][0]||this.O();var b,c,d,e,f=this.s[0][4],g=this.s[1];b=a.length;var h=1;if(4!==b&&6!==b&&8!==b)throw new sjcl.exception.invalid("invalid aes key size");this.b=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));d[a]=d[a-b]^c}for(b=0;a;b++,a--)c=d[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]]};sjcl.cipher.aes.prototype={encrypt:function(a){return t(this,a,0)},decrypt:function(a){return t(this,a,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var a=this.s[0],b=this.s[1],c=a[4],d=b[4],e,f,g,h=[],k=[],l,n,m,p;for(e=0;256>e;e++)k[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=l||1,g=k[g]||1)for(m=g^g<<1^g<<2^g<<3^g<<4,m=m>>8^m&255^99,c[f]=m,d[m]=f,n=h[e=h[l=h[f]]],p=16843009*n^65537*e^257*l^16843008*f,n=257*h[m]^16843008*m,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p=p<<24^p>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};function t(a,b,c){if(4!==b.length)throw new sjcl.exception.invalid("invalid aes block size");var d=a.b[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,k,l,n=d.length/4-2,m,p=4,r=[0,0,0,0];h=a.s[c];a=h[0];var q=h[1],v=h[2],w=h[3],x=h[4];for(m=0;m<n;m++)h=a[e>>>24]^q[f>>16&255]^v[g>>8&255]^w[b&255]^d[p],k=a[f>>>24]^q[g>>16&255]^v[b>>8&255]^w[e&255]^d[p+1],l=a[g>>>24]^q[b>>16&255]^v[e>>8&255]^w[f&255]^d[p+2],b=a[b>>>24]^q[e>>16&255]^v[f>>8&255]^w[g&255]^d[p+3],p+=4,e=h,f=k,g=l;for(m=0;4>m;m++)r[c?3&-m:m]=x[e>>>24]<<24^x[f>>16&255]<<16^x[g>>8&255]<<8^x[b&255]^d[p++],h=e,e=f,f=g,g=b,b=h;return r}sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.$(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.$(b,d,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b=b&31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return false;var c=0,d;for(d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c},$:function(a,b,c,d){var e;e=0;for(void 0===d&&(d=[]);32<=b;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1));return d},i:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&65280|(c&65280)<<8|c<<24;return a}};sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++)0===(d&3)&&(e=a[d/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++)d=d<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d),d=0);c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b}};sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d;a=a.replace(/\\s|0x/g,"");d=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,4*d)}};sjcl.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(a,b,c){var d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f="",g=0,h=sjcl.codec.base32.B,k=0,l=sjcl.bitArray.bitLength(a);c&&(h=sjcl.codec.base32.X);for(c=0;f.length*d<l;)f+=h.charAt((k^a[c]>>>g)>>>e),g<d?(k=a[c]<<d-g,g+=e,c++):(k<<=d,g-=d);for(;f.length&7&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\\s|=/g,"").toUpperCase();var c=sjcl.codec.base32.BITS,d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f=[],g,h=0,k=sjcl.codec.base32.B,l=0,n,m="base32";b&&(k=sjcl.codec.base32.X,m="base32hex");for(g=0;g<a.length;g++){n=k.indexOf(a.charAt(g));if(0>n){if(!b)try{return sjcl.codec.base32hex.toBits(a)}catch(p){}throw new sjcl.exception.invalid("this isn't "+m+"!")}h>e?(h-=e,f.push(l^n>>>h),l=n<<c-h):(h+=d,l^=n<<c-h)}h&56&&f.push(sjcl.bitArray.partial(h&56,l,1));return f}};sjcl.codec.base32hex={fromBits:function(a,b){return sjcl.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl.codec.base32.toBits(a,1)}};sjcl.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.B,g=0,h=sjcl.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;d.length&3&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\\s|=/g,"");var c=[],d,e=0,f=sjcl.codec.base64.B,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d=0;d<a.length;d++){h=f.indexOf(a.charAt(d));if(0>h)throw new sjcl.exception.invalid("this isn't base64!");26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e)}e&56&&c.push(sjcl.bitArray.partial(e&56,g,1));return c}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}};sjcl.hash.sha256=function(a){this.b[0]||this.O();a?(this.F=a.F.slice(0),this.A=a.A.slice(0),this.l=a.l):this.reset()};sjcl.hash.sha256.hash=function(a){return new sjcl.hash.sha256().update(a).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.A=sjcl.bitArray.concat(this.A,a);b=this.l;a=this.l=b+sjcl.bitArray.bitLength(a);if(9007199254740991<a)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d=new Uint32Array(c),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u(this,d.subarray(16*e,16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u(this,c.splice(0,16));return this},finalize:function(){var a,b=this.A,c=this.F,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.l/4294967296));for(b.push(this.l|0);b.length;)u(this,b.splice(0,16));this.reset();return c},Y:[],b:[],O:function(){function a(a2){return 4294967296*(a2-Math.floor(a2))|0}for(var b=0,c=2,d,e;64>b;c++){e=true;for(d=2;d*d<=c;d++)if(0===c%d){e=false;break}e&&(8>b&&(this.Y[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}};function u(a,b){var c,d,e,f=a.F,g=a.b,h=f[0],k=f[1],l=f[2],n=f[3],m=f[4],p=f[5],r=f[6],q=f[7];for(c=0;64>c;c++)16>c?d=b[c]:(d=b[c+1&15],e=b[c+14&15],d=b[c&15]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c&15]+b[c+9&15]|0),d=d+q+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(r^m&(p^r))+g[c],q=r,r=p,p=m,m=n+d|0,n=l,l=k,k=h,h=d+(k&l^n&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+n|0;f[4]=f[4]+m|0;f[5]=f[5]+p|0;f[6]=f[6]+r|0;f[7]=f[7]+q|0}sjcl.mode.ccm={name:"ccm",G:[],listenProgress:function(a){sjcl.mode.ccm.G.push(a)},unListenProgress:function(a){a=sjcl.mode.ccm.G.indexOf(a);-1<a&&sjcl.mode.ccm.G.splice(a,1)},fa:function(a){var b=sjcl.mode.ccm.G.slice(),c;for(c=0;c<b.length;c+=1)b[c](a)},encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,k=h.bitLength(c)/8,l=h.bitLength(g)/8;e=e||64;d=d||[];if(7>k)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&l>>>8*f;f++);f<15-k&&(f=15-k);c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.V(a,b,c,d,e,f);g=sjcl.mode.ccm.C(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/8;if(7>g)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&h>>>8*b;b++);b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));k=sjcl.mode.ccm.C(a,k,c,l,e,b);a=sjcl.mode.ccm.V(a,k.data,c,d,e,b);if(!f.equal(k.tag,a))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return k.data},na:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,k=h.i;d=[h.partial(8,(b.length?64:0)|d-2<<2|f-1)];d=h.concat(d,c);d[3]|=e;d=a.encrypt(d);if(b.length)for(c=h.bitLength(b)/8,65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,b),b=0;b<g.length;b+=4)d=a.encrypt(k(d,g.slice(b,b+4).concat([0,0,0])));return d},V:function(a,b,c,d,e,f){var g=sjcl.bitArray,h=g.i;e/=8;if(e%2||4>e||16<e)throw new sjcl.exception.invalid("ccm: invalid tag length");if(4294967295<d.length||4294967295<b.length)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");c=sjcl.mode.ccm.na(a,d,c,e,g.bitLength(b)/8,f);for(d=0;d<b.length;d+=4)c=a.encrypt(h(c,b.slice(d,d+4).concat([0,0,0])));return g.clamp(c,8*e)},C:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.i;var k=b.length,l=h.bitLength(b),n=k/50,m=n;c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d=h.bitSlice(g(d,a.encrypt(c)),0,e);if(!k)return{tag:d,data:[]};for(g=0;g<k;g+=4)g>n&&(sjcl.mode.ccm.fa(g/k),n+=m),c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d,data:h.clamp(b,l)}}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var g,h=sjcl.mode.ocb2.S,k=sjcl.bitArray,l=k.i,n=[0,0,0,0];c=h(a.encrypt(c));var m,p=[];d=d||[];e=e||64;for(g=0;g+4<b.length;g+=4)m=b.slice(g,g+4),n=l(n,m),p=p.concat(l(c,a.encrypt(l(c,m)))),c=h(c);m=b.slice(g);b=k.bitLength(m);g=a.encrypt(l(c,[0,0,0,b]));m=k.clamp(l(m.concat([0,0,0]),g),b);n=l(n,l(m.concat([0,0,0]),g));n=a.encrypt(l(n,l(c,h(c))));d.length&&(n=l(n,f?d:sjcl.mode.ocb2.pmac(a,d)));return p.concat(k.concat(m,k.clamp(n,e)))},decrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");e=e||64;var g=sjcl.mode.ocb2.S,h=sjcl.bitArray,k=h.i,l=[0,0,0,0],n=g(a.encrypt(c)),m,p,r=sjcl.bitArray.bitLength(b)-e,q=[];d=d||[];for(c=0;c+4<r/32;c+=4)m=k(n,a.decrypt(k(n,b.slice(c,c+4)))),l=k(l,m),q=q.concat(m),n=g(n);p=r-32*c;m=a.encrypt(k(n,[0,0,0,p]));m=k(m,h.clamp(b.slice(c),p).concat([0,0,0]));l=k(l,m);l=a.encrypt(k(l,k(n,g(n))));d.length&&(l=k(l,f?d:sjcl.mode.ocb2.pmac(a,d)));if(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))throw new sjcl.exception.corrupt("ocb: tag doesn't match");return q.concat(h.clamp(m,p))},pmac:function(a,b){var c,d=sjcl.mode.ocb2.S,e=sjcl.bitArray,f=e.i,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4)h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d(f(h,d(h))),g))},S:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);b=sjcl.bitArray;d=d||[];a=sjcl.mode.gcm.C(true,a,f,d,c,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c,d,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);e=e||128;d=d||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.C(false,a,f,d,c,e);if(!g.equal(a.tag,b))throw new sjcl.exception.corrupt("gcm: tag doesn't match");return a.data},ka:function(a,b){var c,d,e,f,g,h=sjcl.bitArray.i;e=[0,0,0,0];f=b.slice(0);for(c=0;128>c;c++){(d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d=3;0<d;d--)f[d]=f[d]>>>1|(f[d-1]&1)<<31;f[0]>>>=1;g&&(f[0]^=-520093696)}return e},j:function(a,b,c){var d,e=c.length;b=b.slice(0);for(d=0;d<e;d+=4)b[0]^=4294967295&c[d],b[1]^=4294967295&c[d+1],b[2]^=4294967295&c[d+2],b[3]^=4294967295&c[d+3],b=sjcl.mode.gcm.ka(b,a);return b},C:function(a,b,c,d,e,f){var g,h,k,l,n,m,p,r,q=sjcl.bitArray;m=c.length;p=q.bitLength(c);r=q.bitLength(d);h=q.bitLength(e);g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=q.concat(e,[1])):(e=sjcl.mode.gcm.j(g,[0,0,0,0],e),e=sjcl.mode.gcm.j(g,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl.mode.gcm.j(g,[0,0,0,0],d);n=e.slice(0);d=h.slice(0);a||(d=sjcl.mode.gcm.j(g,h,c));for(l=0;l<m;l+=4)n[3]++,k=b.encrypt(n),c[l]^=k[0],c[l+1]^=k[1],c[l+2]^=k[2],c[l+3]^=k[3];c=q.clamp(c,p);a&&(d=sjcl.mode.gcm.j(g,h,c));a=[Math.floor(r/4294967296),r&4294967295,Math.floor(p/4294967296),p&4294967295];d=sjcl.mode.gcm.j(g,d,a);k=b.encrypt(e);d[0]^=k[0];d[1]^=k[1];d[2]^=k[2];d[3]^=k[3];return{tag:q.bitSlice(d,0,f),data:c}}};sjcl.misc.hmac=function(a,b){this.W=b=b||sjcl.hash.sha256;var c=[[],[]],d,e=b.prototype.blockSize/32;this.w=[new b,new b];a.length>e&&(a=b.hash(a));for(d=0;d<e;d++)c[0][d]=a[d]^909522486,c[1][d]=a[d]^1549556828;this.w[0].update(c[0]);this.w[1].update(c[1]);this.R=new b(this.w[0])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){if(this.aa)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");this.update(a);return this.digest(a)};sjcl.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=false};sjcl.misc.hmac.prototype.update=function(a){this.aa=true;this.R.update(a)};sjcl.misc.hmac.prototype.digest=function(){var a=this.R.finalize(),a=new this.W(this.w[1]).update(a).finalize();this.reset();return a};sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1e4;if(0>d||0>c)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,k,l=[],n=sjcl.bitArray;for(k=1;32*l.length<(d||1);k++){e=f=a.encrypt(n.concat(b,[k]));for(g=1;g<c;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];l=l.concat(e)}d&&(l=n.clamp(l,d));return l};sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=a;this.D=false;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=3e4;this.ba=80};sjcl.prng.prototype={randomWords:function(a,b){var c=[],d;d=this.isReady(b);var e;if(d===this.u)throw new sjcl.exception.notReady("generator isn't seeded");if(d&this.J){d=!(d&this.I);e=[];var f=0,g;this.Z=e[0]=new Date().valueOf()+this.da;for(g=0;16>g;g++)e.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.m[g],this.m[g]=0,d||!(this.P&1<<g));g++);this.P>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.m.push(0));this.f-=f;f>this.o&&(this.o=f);this.P++;this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.L=new sjcl.cipher.aes(this.b);for(d=0;4>d&&(this.h[d]=this.h[d]+1|0,!this.h[d]);d++);}for(d=0;d<a;d+=4)0===(d+1)%this.ca&&y(this),e=z(this),c.push(e[0],e[1],e[2],e[3]);y(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=new Date().valueOf(),g=this.H[c],h=this.isReady(),k=0;d=this.U[c];void 0===d&&(d=this.U[c]=this.ha++);void 0===g&&(g=this.H[c]=0);this.H[c]=(this.H[c]+1)%this.c.length;switch(typeof a){case"number":void 0===b&&(b=1);this.c[g].update([d,this.N++,1,b,f,1,a|0]);break;case"object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(k=1),c=0;c<a.length&&!k;c++)"number"!==typeof a[c]&&(k=1);if(!k){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e=e>>>1;this.c[g].update([d,this.N++,2,b,f,a.length].concat(a))}break;case"string":void 0===b&&(b=a.length);this.c[g].update([d,this.N++,3,b,f,a.length]);this.c[g].update(a);break;default:k=1}if(k)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[g]+=b;this.f+=b;h===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},isReady:function(a){a=this.T[void 0!==a?a:this.M];return this.o&&this.o>=a?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=a?this.J|this.u:this.u},getProgress:function(a){a=this.T[a?a:this.M];return this.o>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,false),window.addEventListener("mousemove",this.a.mouseCollector,false),window.addEventListener("keypress",this.a.keyboardCollector,false),window.addEventListener("devicemotion",this.a.accelerometerCollector,false),window.addEventListener("touchmove",this.a.touchCollector,false);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl.exception.bug("can't attach event");this.D=true}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,false),window.removeEventListener("mousemove",this.a.mouseCollector,false),window.removeEventListener("keypress",this.a.keyboardCollector,false),window.removeEventListener("devicemotion",this.a.accelerometerCollector,false),window.removeEventListener("touchmove",this.a.touchCollector,false)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=false)},addEventListener:function(a,b){this.K[a][this.ga++]=b},removeEventListener:function(a,b){var c,d,e=this.K[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},la:function(){C(this,1)},oa:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,"mouse");C(this,0)},qa:function(a){a=a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C(this,0)},ma:function(){C(this,2)},ea:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C(this,0)}};function A(a,b){var c,d=sjcl.random.K[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}function C(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy(new Date().valueOf(),b,"loadtime")}function y(a){a.b=z(a).concat(z(a));a.L=new sjcl.cipher.aes(a.b)}function z(a){for(var b=0;4>b&&(a.h[b]=a.h[b]+1|0,!a.h[b]);b++);return a.L.encrypt(a.h)}function B(a,b){return function(){b.apply(a,arguments)}}sjcl.random=new sjcl.prng(6);a:try{if(G="undefined"!==typeof module&&module.exports){try{H=__require2("crypto")}catch(a){H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array(new Uint8Array(D).buffer),sjcl.random.addEntropy(D,1024,"crypto['randomBytes']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F);else break a;sjcl.random.addEntropy(F,1024,"crypto['getRandomValues']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}var D;var E;var F;var G;var H;sjcl.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json,f=e.g({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.g(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl.codec.base64.toBits(f.iv));if(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)throw new sjcl.exception.invalid("json encrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));"string"===typeof c&&(f.adata=c=sjcl.codec.utf8String.toBits(c));g=new sjcl.cipher[f.cipher](a);e.g(d,f);d.key=a;f.ct="ccm"===f.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(g,b,f.iv,c,f.ts):sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f},encrypt:function(a,b,c,d){var e=sjcl.json,f=e.ja.apply(e,arguments);return e.encode(f)},ia:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json;b=e.g(e.g(e.g({},e.defaults),b),c,true);var f,g;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv));if(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjcl.exception.invalid("json decrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl.codec.utf8String.toBits(f));g=new sjcl.cipher[b.cipher](a);f="ccm"===b.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(g,b.ct,b.iv,b.tag,f,b.ts):sjcl.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.g(d,b);d.key=a;return 1===c.raw?f:sjcl.codec.utf8String.fromBits(f)},decrypt:function(a,b,c,d){var e=sjcl.json;return e.ia(a,e.decode(b),c,d)},encode:function(a){var b,c="{",d="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");c+=d+'"'+b+'":';d=",";switch(typeof a[b]){case"number":case"boolean":c+=a[b];break;case"string":c+='"'+escape(a[b])+'"';break;case"object":c+='"'+sjcl.codec.base64.fromBits(a[b],0)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return c+"}"},decode:function(a){a=a.replace(/\\s/g,"");if(!a.match(/^\\{.*\\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");a=a.replace(/^\\{|\\}$/g,"").split(/,/);var b={},c,d;for(c=0;c<a.length;c++){if(!(d=a[c].match(/^\\s*(?:(["']?)([a-z][a-z0-9]*)\\1)\\s*:\\s*(?:(-?\\d+)|"([a-z0-9+\\/%*_.@=\\-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");null!=d[3]?b[d[2]]=parseInt(d[3],10):null!=d[4]?b[d[2]]=d[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(d[4]):unescape(d[4]):null!=d[5]&&(b[d[2]]="true"===d[5])}return b},g:function(a,b,c){void 0===a&&(a={});if(void 0===b)return a;for(var d in b)if(b.hasOwnProperty(d)){if(c&&void 0!==a[d]&&a[d]!==b[d])throw new sjcl.exception.invalid("required parameter overridden");a[d]=b[d]}return a},sa:function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&a[d]!==b[d]&&(c[d]=a[d]);return c},ra:function(a,b){var c={},d;for(d=0;d<b.length;d++)void 0!==a[b[d]]&&(c[b[d]]=a[b[d]]);return c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.pa={};sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.pa,d;b=b||{};d=b.iter||1e3;c=c[a]=c[a]||{};d=c[d]=c[d]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=void 0===b.salt?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);return{key:d[c].slice(0),salt:c.slice(0)}};var _HTTPfrontend=class extends Service{name="http";fetchProxied=false;listening={};constructor(options,path,fetched){super(options);this.load(this);this.listen(path,fetched)}GET=(url="http://localhost:8080/ping",type="",mimeType)=>{if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"GET",url,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};POST=(message,url="http://localhost:8080/echo",type="",mimeType)=>{if(typeof message==="object"&&(type==="json"||type==="text"||!type)){message=JSON.stringify(message)}if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"POST",url,data:message,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};transmit=(message,url)=>{let obj=message;if(typeof obj==="object"){message=JSON.stringify(obj)}if(obj?.method?.toLowerCase()=="get"||message?.toLowerCase()==="get")return this.GET(url);return this.POST(message,url)};transponder=(url,message,type="",mimeType)=>{if(typeof message==="object")message=JSON.stringify(message);let method="GET";if(message){method="POST"}if(type==="json")mimeType="application/json";else return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method,url,data:message,responseType:type,onload:ev=>{let body=xhr.response;if(typeof body==="string"){let substr=body.substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))body=body.replace(/\\\\/g,"");if(body[0]==='"'){body=body.substring(1,body.length-1)};body=JSON.parse(body)}}if(typeof body?.method==="string"){return resolve(this.handleMethod(body.route,body.method,body.args))}else if(typeof body?.route==="string"){return resolve(this.handleServiceMessage(body))}else if(typeof body?.node==="string"||body.node instanceof GraphNode){return resolve(this.handleGraphNodeCall(body.node,body.args))}else return resolve(body)},onabort:er=>{reject(er)}})}).catch(console.error)};listen=(path="0",fetched=async(clone,args,response)=>{const result=await clone.text();const returned=this.receive(result);this.setState({[response.url]:returned})})=>{this.listening[path]={};let listenerId=\`\${path}\${Math.floor(Math.random()*1e15)}\`;this.listening[path][listenerId]=fetched;if(!this.fetchProxied){globalThis.fetch=new Proxy(globalThis.fetch,{apply(fetch,that,args){const result=fetch.apply(that,args);result.then(response=>{if(!response.ok)return;if(this.listening["0"]){for(const key in this.listeners){const clone=response.clone();this.listening["0"][key](clone,args,response)}}else{for(const key in this.listening){if(response.url.includes(key)){for(const key2 in this.listening[path]){const clone=response.clone();this.listening[path][key2](clone,args,response)}break}}}}).catch(er=>{console.error(er)});return result}});this.fetchProxied=true}return listenerId};stopListening=(path,listener)=>{if(!path&&path!==0){for(const key in this.listening)delete this.listening[key]}else{if(!listener)delete this.listening[path];else delete this.listening[listener]}}};var HTTPfrontend=_HTTPfrontend;__publicField(HTTPfrontend,"request",options=>{const xhr=new XMLHttpRequest;if(options.responseType)xhr.responseType=options.responseType;else options.responseType="json";if(options.mimeType){xhr.overrideMimeType(options.mimeType)}if(options.onload)xhr.addEventListener("load",options.onload,false);if(options.onprogress)xhr.addEventListener("progress",options.onprogress,false);if(options.onabort)xhr.addEventListener("abort",options.onabort,false);if(options.onloadend)xhr.addEventListener("loadend",options.onloadend,false);if(options.onerror)xhr.addEventListener("error",options.onerror,false);xhr.open(options.method,options.url,true,options.user,options.pass);if(!options.onerror)xhr.onerror=function(){xhr.abort()};xhr.send(options.data);return xhr});var import_web_worker=__toESM(require_browser());var WorkerService=class extends Service{name="worker";workers={};threadRot=0;connections;constructor(options){super();this.connections={workers:this.workers};if(options?.services)this.addServices(options.services);this.load(this);this.setLoaders(this.workerloader);if(options)this.init(options);if(typeof WorkerGlobalScope!=="undefined"&&globalThis instanceof WorkerGlobalScope){this.addDefaultMessageListener()}}loadWorkerRoute=(rt,routeKey)=>{if(rt.workerUrl)rt.url=rt.workerUrl;if(rt.workerId)rt.__node.tag=rt.workerId;if(!rt.__node.tag)rt.__node.tag=routeKey;rt._id=rt.__node.tag;let worker;if(this.workers[rt._id])worker=this.workers[rt._id];else if(rt.worker)worker=rt.worker;if(!worker){worker=this.addWorker(rt)}rt.worker=worker;if(!rt.worker.__ondisconnected){let ondelete=rt2=>{rt2.worker?.terminate()};rt.__addOndisconnected(ondelete)}if(rt.transferFunctions){for(const prop in rt.transferFunctions){this.transferFunction(worker,rt.transferFunctions[prop],prop)}}if(rt.transferClasses){for(const prop in rt.transferClasses){this.transferClass(worker,rt.transferClasses[prop],prop)}}if(worker){if(!rt.__operator){rt.__operator=(...args)=>{if(rt.callback){if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.post(rt.callback,args);else return worker.run(rt.callback,args)}else{if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.send(args);else return worker.request(args)}}}if(rt.init){worker.run(rt.init,rt.initArgs,void 0,rt.initTransfer)}return worker}};workerloader={"workers":(node,parent,graph,roots)=>{let rt=node;if(!node.parentRoute&&(parent?.callback&&parent?.worker))node.parentRoute=parent?.callback;if(rt?.worker||rt?.workerId||rt?.workerUrl){let worker=this.loadWorkerRoute(rt,rt.__node.tag);if(worker){if(!rt.parentRoute&&rt.__parent?.callback)rt.parentRoute=rt.__parent.callback;if(rt.__parent&&!rt.portId){if(typeof rt.__parent==="string"){if(rt.__node.tag!==rt.__parent&&worker._id!==rt.__parent)rt.portId=this.establishMessageChannel(worker,rt.__parent)}else if(rt.__node.tag!==rt.__parent?.__node?.tag&&worker._id!==rt.__parent?.tag){rt.portId=this.establishMessageChannel(worker,rt.__parent.worker)}};if(rt.parentRoute){if(!rt.stopped){if(typeof rt.__parent==="string"&&rt.__parent===worker._id){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else if(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.parentRoute,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id)&&!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent){if(typeof rt.__parent==="string"){if(!rt.stopped){if(rt.__parent===worker._id){worker.run("subscribe",[rt.__parent,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id))worker.workerSubs[rt.__parent+rt.portId]={sub:null,route:worker._id,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent?.__node?.tag&&rt.__parent?.worker){if(!rt.stopped){if(rt.__node.tag===rt.__parent.__node.tag||worker._id===rt.__parent.__node.tag){worker.run("subscribe",[rt.__parent.__node.tag,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent.__node.tag,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent.__node.tag+rt.portId].sub=sub})}if(!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.__parent.__node.tag+rt.portId]={sub:null,route:rt.__parent.__node.tag,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}}}}else if(rt.__parent&&rt.parentRoute){if(typeof rt.__parent==="string"&&roots[rt.__parent]?.worker){roots[rt.__parent].worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}else if(rt.__parent?.worker){rt.__parent.worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}}return rt}};addDefaultMessageListener=()=>{globalThis.onmessage=ev=>{let result=this.receive(ev.data);if(this.__node.keepState)this.setState({[this.name]:result})}};postMessage=(message,target,transfer)=>{if(this.workers[target]){this.workers[target].send(message,transfer)}else{globalThis.postMessage(message,target,transfer)}};addWorker=options=>{let worker;if(!options._id)options._id=\`worker\${Math.floor(Math.random()*1e15)}\`;if(options.url)worker=new import_web_worker.default(options.url);else if(options.port){worker=options.port}else if(this.workers[options._id]){if(this.workers[options._id].port)worker=this.workers[options._id].port;else worker=this.workers[options._id].worker}if(!worker)return;let send=(message,transfer)=>{return this.transmit(message,worker,transfer)};let post=(route,args,method,transfer)=>{let message={route,args};if(method)message.method=method;return this.transmit(message,worker,transfer)};let run=(route,args,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[{route,args},options._id,callbackId]};if(method)req.args[0].method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let request=(message,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,options._id,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let workerSubs={};let subscribe=(route,callback,args,key,subInput,blocking)=>{return this.subscribeToWorker(route,options._id,callback,args,key,subInput,blocking)};let unsubscribe=(route,sub)=>{return run("unsubscribe",[route,sub])};let start=async(route,portId,callback,blocking)=>{if(route)await run("subscribeToWorker",[route,portId,void 0,callback,blocking]).then(sub=>{if(sub)workerSubs[route+portId]={sub,route,portId,callback,blocking}});else for(const key in workerSubs){if(typeof workerSubs[key].sub!=="number")await run("subscribeToWorker",[workerSubs[key].route,workerSubs[key].portId,void 0,workerSubs[key].callback,void 0,workerSubs[key].blocking]).then(sub=>{workerSubs[key].sub=sub});console.log(JSON.stringify(workerSubs))}return true};let stop=async(route,portId)=>{if(route&&portId&&workerSubs[route+portId]){await run("unsubscribe",[route,workerSubs[route+portId].sub]);workerSubs[route+portId].sub=false}else{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){await run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub]).then(console.log)}workerSubs[key].sub=false}}return true};let terminate=()=>{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub])}workerSubs[key].sub=false}return this.terminate(options._id)};if(!options.onmessage)options.onmessage=ev=>{this.receive(ev.data);this.setState({[options._id]:ev.data})};if(!options.onerror){options.onerror=ev=>{console.error(ev.data)}}worker.onmessage=options.onmessage;worker.onerror=options.onerror;this.workers[options._id]={worker,send,post,run,request,subscribe,unsubscribe,terminate,start,stop,postMessage:worker.postMessage,workerSubs,graph:this,...options};return this.workers[options._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=scriptTemplate=>{let blob=new Blob([scriptTemplate],{type:"text/javascript"});return URL.createObjectURL(blob)};getTransferable(message){let transfer;if(typeof message==="object"){if(message.args){if(message.args?.constructor?.name==="Object"){for(const key in message.args){if(ArrayBuffer.isView(message.args[key])){if(!transfer)transfer=[message.args[key].buffer];else transfer.push(message.args[key].buffer)}else if(message.args[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message.args[key]];else transfer.push(message.args[key])}}}else if(Array.isArray(message.args)&&message.args.length<11){message.args.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg?.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message.args)){transfer=[message.args.buffer]}else if(message.args?.constructor?.name==="ArrayBuffer"){transfer=[message]}}else if(message?.constructor?.name==="Object"){for(const key in message){if(ArrayBuffer.isView(message[key])){if(!transfer)transfer=[message[key].buffer];else transfer.push(message[key].buffer)}else if(message[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message[key]];else transfer.push(message[key])}}}else if(Array.isArray(message)&&message.length<11){message.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message)){transfer=[message.buffer]}else if(message.constructor?.name==="ArrayBuffer"){transfer=[message]}}return transfer}transmit=(message,worker,transfer)=>{if(!transfer){transfer=this.getTransferable(message)}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){worker.postMessage(message,transfer)}else if(typeof worker==="string"){if(this.workers[worker]){if(this.workers[worker].port)this.workers[worker].port.postMessage(message,transfer);else if(this.workers[worker].worker)this.workers[worker].worker.postMessage(message,transfer)}}else{let keys2=Object.keys(this.workers);this.workers[keys2[this.threadRot]].worker.postMessage(message,transfer);this.threadRot++;if(this.threadRot===keys2.length)this.threadRot=0}return message};terminate=worker=>{let onclose;if(typeof worker==="string"){let obj=this.workers[worker];if(obj){delete this.workers[worker];worker=obj.worker;if(obj.onclose)onclose=obj.onclose}}else if(typeof worker==="object"){if(worker?._id){worker=worker.worker;delete this.workers[worker?._id]}}if(worker instanceof import_web_worker.default){worker.terminate();if(onclose)onclose(worker);return true}if(worker instanceof MessagePort){worker.close();if(onclose)onclose(worker);return true}return false};establishMessageChannel=(worker,worker2)=>{let workerId;if(typeof worker==="string"){workerId=worker;if(this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker2=this.workers[worker].worker}}else if(worker?.worker){worker=worker.worker}if(typeof worker2==="string"){if(this.workers[worker2]){if(this.workers[worker2].port)worker2=this.workers[worker2].port;else worker2=this.workers[worker2].worker}}else if(worker2?.worker){worker2=worker2.worker}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){let channel=new MessageChannel;let portId=\`port\${Math.floor(Math.random()*1e15)}\`;worker.postMessage({route:"addWorker",args:{port:channel.port1,_id:portId}},[channel.port1]);if(worker2 instanceof import_web_worker.default||worker2 instanceof MessagePort){worker2.postMessage({route:"addWorker",args:{port:channel.port2,_id:portId}},[channel.port2])}else if(workerId&&this.workers[workerId]){channel.port2.onmessage=this.workers[workerId].onmessage;this.workers[workerId].port=channel.port2}return portId}return false};request=(message,workerId,transfer,method)=>{let worker=this.workers[workerId].worker;return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};runRequest=(message,worker,callbackId)=>{let res=this.receive(message);if(typeof worker==="string"&&this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}if(res instanceof Promise){res.then(r=>{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:r,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:r,callbackId})})}else{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:res,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:res,callbackId})}return res};subscribeWorker=(route,worker,args,key,subInput,blocking)=>{let callback;if(blocking){let blocked=false;callback=res=>{if(!blocked){blocked=true;if(res instanceof Promise){res.then(r=>{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,r]).then(ret=>{blocked=false})})}else{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,res]).then(ret=>{blocked=false})}}}}else{callback=res=>{if(res instanceof Promise){res.then(r=>{if(worker?.postMessage)worker.postMessage({args:r,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:r,callbackId:route})})}else{if(worker?.postMessage)worker.postMessage({args:res,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:res,callbackId:route})}}}if(!blocking&&worker?.port){worker=worker.port}else if(!blocking&&worker?.worker){worker=worker.worker}else if(typeof worker==="string"&&this.workers[worker]){if(blocking)worker=this.workers[worker];else if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}return this.subscribe(route,callback,args,key,subInput)};subscribeToWorker=(route,workerId,callback,args,key,subInput,blocking)=>{if(typeof workerId==="string"&&this.workers[workerId]){this.__node.state.subscribeEvent(workerId,res=>{if(res?.callbackId===route){if(!callback)this.setState({[workerId]:res.args});else if(typeof callback==="string"){this.run(callback,res.args)}else callback(res.args)}});return this.workers[workerId].run("subscribeWorker",[route,workerId,args,key,subInput,blocking])}};triggerSubscription=async(route,workerId,result)=>{if(this.__node.state.triggers[workerId])for(let i2=0;i2<this.__node.state.triggers[workerId].length;i2++){await this.__node.state.triggers[workerId][i2].onchange({args:result,callbackId:route})}return true};pipeWorkers=(sourceWorker,listenerWorker,sourceRoute,listenerRoute,portId,args,key,subInput,blocking)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof listenerWorker==="string")listenerWorker=this.workers[listenerWorker];if(!portId){portId=this.establishMessageChannel(sourceWorker.worker,listenerWorker.worker)}return listenerWorker.run("subscribeToWorker",[sourceRoute,portId,listenerRoute,args,key,subInput,blocking])};unpipeWorkers=(sourceRoute,sourceWorker,sub)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof sourceWorker==="object"){return sourceWorker.run("unsubscribe",[sourceRoute,sub])}}};var mouseEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]);var wheelEventHandlerImpl=makeSendPropertiesHandler(["deltaX","deltaY"]);var keydownEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function focusEventHandler(event,sendFn){const data={type:event.type};data.isTrusted=event.isTrusted;data.bubbles=event.bubbles;data.cancelBubble=event.cancelBubble;data.cancelable=event.cancelable;data.composed=event.composed;data.defaultPrevent=event.defaultPrevented;data.eventPhase=event.eventPhase;data.returnValue=event.returnValue;data.currentTarget=event.currentTarget.id?event.currentTarget.id:event.currentTarget.constructor.name;data.target=data.currentTarget;data.srcElement=data.currentTarget;sendFn(data)}function wheelEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();wheelEventHandlerImpl(event,sendFn)}function preventDefaultHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault()}function copyProperties(src,properties,dst){for(const name2 of properties){dst[name2]=src[name2]}}function makeSendPropertiesHandler(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties(event,properties,data);sendFn(data)}}function touchEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();const touches=[];const data={type:event.type,touches};for(let i2=0;i2<event.touches.length;++i2){const touch=event.touches[i2];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var i=1;var keys={};while(i<222){keys[i]=true;i++}function filteredKeydownEventHandler(event,sendFn,preventDefault){let{keyCode}=event;if(keys[keyCode]){if(preventDefault&&event.preventDefault&&(keyCode<110||keyCode>123))event.preventDefault();keydownEventHandler(event,sendFn)}}var eventHandlers={contextmenu:preventDefaultHandler,mousedown:mouseEventHandler,mousemove:mouseEventHandler,mouseup:mouseEventHandler,pointerdown:mouseEventHandler,pointermove:mouseEventHandler,pointerup:mouseEventHandler,pointerlockchange:mouseEventHandler,webkitpointerlockchange:mouseEventHandler,focus:focusEventHandler,blur:focusEventHandler,pointerout:mouseEventHandler,touchstart:touchEventHandler,touchmove:touchEventHandler,touchend:touchEventHandler,wheel:wheelEventHandler,keydown:filteredKeydownEventHandler,keyup:filteredKeydownEventHandler};function initProxyElement(element,worker,id,preventDefault){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{if(!worker){handleProxyEvent(data,id)}else worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent,preventDefault)})}if(eventHandlers.keydown){globalThis.addEventListener("keydown",function(ev){eventHandlers.keydown(ev,sendEvent,preventDefault)})}if(eventHandlers.keyup){globalThis.addEventListener("keyup",function(ev){eventHandlers.keyup(ev,sendEvent,preventDefault)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher=class{__listeners;addEventListener(type,listener){if(this.__listeners===void 0)this.__listeners={};const listeners=this.__listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this.__listeners===void 0)return false;const listeners=this.__listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i2=0,l=array.length;i2<l;i2++){array[i2].call(this,event)}}}};function noop(){}var ElementProxyReceiver=class extends EventDispatcher{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super();this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.style.width=this.width+"px";this.proxied.style.height=this.height+"px";this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop;data.stopPropagation=noop;this.dispatchEvent(data,this.proxied)};focus(){}blur(){}};var ProxyManager=class{targets={};constructor(){if(!globalThis.document)globalThis.document={elementFromPoint:(...args)=>{return this.targets[Object.keys(this.targets)[0]].proxied}}}makeProxy=(id,addTo=void 0)=>{if(!id)id=\`proxyReceiver\${Math.floor(Math.random()*1e15)}\`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;if(typeof WorkerGlobalScope!=="undefined")addTo.style=proxy.style;if(proxy.width){addTo.style.width=proxy.width+"px";addTo.clientWidth=proxy.width}if(proxy.height){addTo.style.height=proxy.height+"px";addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy);addTo.blur=proxy.blur.bind(proxy)}};getProxy=id=>{return this.targets[id]};handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0}};function makeProxy(id,elm){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;this.__node.graph.ProxyManager.makeProxy(id,elm)}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;globalThis.ProxyManager.makeProxy(id,elm)}return id}function handleProxyEvent(data,id){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;if(this.__node.graph.ProxyManager.handleEvent(data,id))return data}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;if(globalThis.ProxyManager.handleEvent(data,id))return data}}var proxyElementWorkerRoutes={initProxyElement,makeProxy,handleProxyEvent};function Renderer(options){if(options.worker){let worker=options.worker;let route=options.route;if(worker instanceof Blob||typeof worker==="string"){worker=new Worker(worker)}delete options.worker;delete options.route;return transferCanvas(worker,options,route)}else{initProxyElement(options.canvas,void 0,options._id,options.preventDefault);return setupCanvas(options)}}function transferCanvas(worker,options,route){if(!options)return void 0;if(!options._id)options._id=\`canvas\${Math.floor(Math.random()*1e15)}\`;let offscreen=options.canvas.transferControlToOffscreen();if(!options.width)options.width=options.canvas.clientWidth;if(!options.height)options.height=options.canvas.clientHeight;let message={route:route?route:"setupCanvas",args:{...options,canvas:offscreen}};if(this?.__node?.graph)this.__node.graph.run("initProxyElement",options.canvas,worker,options._id,options.preventDefault);else initProxyElement(options.canvas,worker,options._id,options.preventDefault);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let tr=[offscreen];if(options.transfer){tr.push(...options.transfer);delete options.transfer}worker.postMessage(message,tr);const canvascontrols={_id:options._id,width:options.width,height:options.height,worker,draw:(props,transfer)=>{worker.postMessage({route:"drawFrame",args:[props,options._id]},transfer)},update:(props,transfer)=>{worker.postMessage({route:"updateCanvas",args:[props,options._id]},transfer)},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:(newDrawProps,transfer)=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]},transfer)},terminate:()=>{worker.terminate()}};return canvascontrols}function setDraw(settings,_id){let canvasopts;if(this?.__node?.graph){if(_id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]}else{if(_id)canvasopts=globalThis.CANVASES?.[settings._id];else if(settings._id)canvasopts=globalThis.CANVASES?.[settings._id];else canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]]}if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasopts._id,canvasopts.canvas);else proxyElementWorkerRoutes.makeProxy(canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText3(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw.bind(settings)}if(typeof settings.update==="string")settings.update=parseFunctionFromText3(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update.bind(settings)}if(typeof settings.init==="string")settings.init=parseFunctionFromText3(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init.bind(settings)}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText3(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear.bind(settings)}return settings._id}return void 0}function setupCanvas(options){if(this?.__node?.graph){if(!this.__node.graph.CANVASES)this.__node.graph.CANVASES={}}else if(!globalThis.CANVASES)globalThis.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=\`canvas\${Math.floor(Math.random()*1e15)}\`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this?.__node?.graph?.CANVASES[canvasOptions._id]){this.__node.graph.run("setDraw",canvasOptions)}else if(globalThis.CANVASES?.[canvasOptions._id]){setDraw(canvasOptions)}else{if(this?.__node?.graph){canvasOptions.graph=this.__node.graph;if(!canvasOptions.__node){canvasOptions.__node={}}if(!canvasOptions.__node.tag)canvasOptions.__node.tag=canvasOptions._id;canvasOptions=this.__node.graph.add(canvasOptions);canvasOptions.__addOndisconnected=()=>{canvasOptions.stop();delete this.__node.graph.CANVASES[canvasOptions._id]}}if(this?.__node?.graph)this.__node.graph.CANVASES[canvasOptions._id]=canvasOptions;else globalThis.CANVASES[canvasOptions._id]=canvasOptions;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);else proxyElementWorkerRoutes.makeProxy(canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText3(canvasOptions.draw)}else if(typeof canvasOptions.draw==="function"){canvasOptions.draw=canvasOptions.draw.bind(canvasOptions)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText3(canvasOptions.update)}else if(typeof canvasOptions.update==="function"){canvasOptions.update=canvasOptions.update.bind(canvasOptions)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText3(canvasOptions.init)}else if(typeof canvasOptions.init==="function"){canvasOptions.init=canvasOptions.init.bind(canvasOptions)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText3(canvasOptions.clear)}else if(typeof canvasOptions.clear==="function"){canvasOptions.clear=canvasOptions.clear.bind(canvasOptions)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);canvasOptions.stop=()=>{stopAnim(canvasOptions._id)};canvasOptions.start=draw=>{startAnim(canvasOptions._id,draw)};canvasOptions.set=settings=>{setDraw(settings,canvasOptions._id)};if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)return canvasOptions._id;else{const canvascontrols={_id:options._id,width:options.width,height:options.height,draw:props=>{drawFrame(props,options._id)},update:props=>{updateCanvas(props,options._id)},clear:()=>{clearCanvas(options._id)},init:()=>{initCanvas(options._id)},stop:()=>{stopAnim(options._id)},start:()=>{startAnim(options._id)},set:newDrawProps=>{setDraw(newDrawProps,options._id)},terminate:()=>{if(this.__node?.graph)this.__node.graph.remove(options._id);else{stopAnim(options._id);if(this?.__node?.graph)delete this.__node.graph.CANVASES[canvasOptions._id];else delete globalThis.CANVASES[canvasOptions._id]}}};return canvascontrols}}function drawFrame(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0}function clearCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function initCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function updateCanvas(input,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0}function setProps(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0}function startAnim(_id,draw){let canvasopts=getCanvas.call(this,_id);canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText3(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function stopAnim(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")requestAnimationFrame(canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context));return _id}return void 0}function getCanvas(_id){let canvasopts;if(this?.__node?.graph){if(!_id)canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]];else canvasopts=this.__node.graph.CANVASES?.[_id]}else{if(!_id)canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]];else canvasopts=globalThis.CANVASES?.[_id]}return canvasopts}var workerCanvasRoutes={...proxyElementWorkerRoutes,Renderer,transferCanvas,setupCanvas,setDraw,drawFrame,clearCanvas,initCanvas,updateCanvas,setProps,startAnim,stopAnim,getCanvas};function parseFunctionFromText3(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var _ArrayManip=class{constructor(){this.recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"){if(typeof target[key]==="object")this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target}}static autoscale(array,lineIdx=0,nLines=1,centerZero=false,ymin,ymax,clamp){if(array?.length===0)return array;let max=ymax?ymax:Math.max(...array);let min=ymin?ymin:Math.min(...array);let _lines=1/nLines;let scalar=1;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));if(absmax!==0)scalar=_lines/absmax;return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return y2*scalar+(_lines*(lineIdx+1)*2-1-_lines)})}else{if(max===min){if(max!==0){scalar=_lines/max}else if(min!==0){scalar=_lines/Math.abs(min)}}else scalar=_lines/(max-min);return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return 2*((y2-min)*scalar-1/(2*nLines))+(_lines*(lineIdx+1)*2-1-_lines)})}}static genTimestamps(ct,sps10){let now=Date.now();let toInterp=[now-ct*1e3/sps10,now];return _ArrayManip.upsample(toInterp,ct)}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i2=incr;i2<array.length;i2+=incr){let rounded=Math.round(i2);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static upsample(array,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array(fitCount);var springFactor=(array.length-1)/(fitCount-1);newData[0]=array[0];for(var i2=1;i2<fitCount-1;i2++){var tmp=i2*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i2]=linearInterpolate(array[before],array[after],atPoint)}newData[fitCount-1]=array[array.length-1];return newData}static interpolate(array,fitCount,scalar=1){if(array.length>fitCount){return _ArrayManip.downsample(array,fitCount,scalar)}else if(array.length<fitCount){return _ArrayManip.upsample(array,fitCount,scalar)}return array}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x;b=0}else if(60<=h&&h<120){r=x;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x}else if(180<=h&&h<240){r=0;g=x;b=c}else if(240<=h&&h<300){r=x;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static circularBuffer(arr,newEntries){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,newEntries.slice(len-newEntries.length))}else{arr.splice(0,arr.length,...newEntries)}return arr}static reformatData(data,key){if(Array.isArray(data)){if(Array.isArray(data[0])){let d={};data.forEach((arr,i2)=>{d[i2]=arr});data=d;if(isNaN(data[0][0]))return void 0}else if(key){data={[key]:data};if(isNaN(data[key][0]))return void 0}else{data={0:data};if(isNaN(data[0][0]))return void 0}}else if(typeof data==="object"){for(const key2 in data){if(typeof data[key2]==="number")data[key2]=[data[key2]];else if(data[key2]?.values){if(typeof data[key2].values==="number")data[key2].values=[data[key2].values]}if(isNaN(data[key2][0]))return void 0}}else if(typeof data==="string"){let split;if(data.includes("\\r\\n")){let lines=data.split("\\r\\n");data={};lines.forEach((l,j)=>{if(l.includes("	")){split=l.split("	")}else if(l.includes(",")){split=l.split(",")}else if(l.includes("|")){split=l.split("|")}if(Array.isArray(split)){split.forEach((val,i2)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl=parseFloat(v);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i2]=[fl];else return void 0}})}})}else if(data.includes("	")){split=data.split("	")}else if(data.includes(",")){split=data.split(",")}else if(data.includes("|")){split=data.split("|")}data={};if(Array.isArray(split)){split.forEach((val,i2)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl=parseFloat(v);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i2]=[fl];else return void 0}})}}else if(typeof data==="number"){if(key)data={[key]:[data]};else data={0:[data]}}return data}static padTime(data,lastValue,time,targetFit){let slopeIncr=(data[0]-lastValue)/time/targetFit;let padded=[...new Array(targetFit-data.length).map((_,i2)=>lastValue+slopeIncr*(i2+1)),...data];return padded}static interpolateForTime(data,time,targetSPS){return _ArrayManip.interpolate(data,Math.ceil(targetSPS*time))}isTypedArray(x){return ArrayBuffer.isView(x)&&Object.prototype.toString.call(x)!=="[object DataView]"}spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var ArrayManip=_ArrayManip;ArrayManip.bufferValues=(objects,property,keys2,buffer)=>{if(!Array.isArray(keys2)&&typeof keys2==="object")keys2=Object.keys(keys2);if(!buffer){let object_keys=Object.keys(objects);if(keys2)buffer=new Float32Array(object_keys.length*keys2.length);else{if(typeof objects[object_keys[0]][property]==="object"){keys2=Object.keys(objects[object_keys[0]][property]);buffer=new Float32Array(object_keys.length*keys2.length)}else buffer=new Float32Array(object_keys.length)}}let i2=0;for(const key in objects){if(objects[key][property]){if(keys2){for(let j=0;j<keys2.length;j++){buffer[i2]=objects[key][property][keys2[j]];i2++}}else{buffer[i2]=objects[key][property];i2++}}}return buffer};var rechk=/^([<>])?(([1-9]\\d*)?([xcbB?hHiIfdsp]))*$/;var refmt=/([1-9]\\d*)?([xcbB?hHiIfdsp])/g;var str=(v,o,c)=>String.fromCharCode(...new Uint8Array(v.buffer,v.byteOffset+o,c));var rts=(v,o,c,s)=>new Uint8Array(v.buffer,v.byteOffset+o,c).set(s.split("").map(str2=>str2.charCodeAt(0)));var pst=(v,o,c)=>str(v,o+1,Math.min(v.getUint8(o),c-1));var tsp=(v,o,c,s)=>{v.setUint8(o,s.length);rts(v,o+1,c-1,s)};var lut=le=>({x:c=>[1,c,0],c:c=>[c,1,o=>({u:v=>str(v,o,1),p:(v,c2)=>rts(v,o,1,c2)})],"?":c=>[c,1,o=>({u:v=>Boolean(v.getUint8(o)),p:(v,B2)=>v.setUint8(o,B2)})],b:c=>[c,1,o=>({u:v=>v.getInt8(o),p:(v,b)=>v.setInt8(o,b)})],B:c=>[c,1,o=>({u:v=>v.getUint8(o),p:(v,B2)=>v.setUint8(o,B2)})],h:c=>[c,2,o=>({u:v=>v.getInt16(o,le),p:(v,h)=>v.setInt16(o,h,le)})],H:c=>[c,2,o=>({u:v=>v.getUint16(o,le),p:(v,H2)=>v.setUint16(o,H2,le)})],i:c=>[c,4,o=>({u:v=>v.getInt32(o,le),p:(v,i2)=>v.setInt32(o,i2,le)})],I:c=>[c,4,o=>({u:v=>v.getUint32(o,le),p:(v,I)=>v.setUint32(o,I,le)})],f:c=>[c,4,o=>({u:v=>v.getFloat32(o,le),p:(v,f)=>v.setFloat32(o,f,le)})],d:c=>[c,8,o=>({u:v=>v.getFloat64(o,le),p:(v,d)=>v.setFloat64(o,d,le)})],s:c=>[1,c,o=>({u:v=>str(v,o,c),p:(v,s)=>rts(v,o,c,s.slice(0,c))})],p:c=>[1,c,o=>({u:v=>pst(v,o,c),p:(v,s)=>tsp(v,o,c,s.slice(0,c-1))})]});var errbuf=new RangeError("Structure larger than remaining buffer");var errval=new RangeError("Not enough values for structure");var _ByteParser=class extends ArrayManip{static toDataView(value){if(!(value instanceof DataView)){if(typeof value==="string"&&parseInt(value))value=parseInt(value);if(typeof value==="string"){let enc=new TextEncoder;let hascodes={};for(const code in _ByteParser.codes){while(value.indexOf(code)>-1){let idx=value.indexOf(code);value=value.replace(code,"");hascodes[idx]=code}}let encoded=Array.from(enc.encode(value));for(const key in hascodes){encoded.splice(parseInt(key),0,_ByteParser.codes[hascodes[key]])}value=new DataView(new Uint8Array(encoded).buffer)}else if(typeof value==="number"){let tmp=value;if(value<256){value=new DataView(new ArrayBuffer(1));value.setUint8(0,tmp)}else if(value<65536){value=new DataView(new ArrayBuffer(2));value.setInt16(0,tmp)}else{value=new DataView(new ArrayBuffer(4));value.setUint32(0,tmp)}}else if(value instanceof ArrayBuffer||typeof SharedArrayBuffer!=="undefined"&&value instanceof SharedArrayBuffer){value=new DataView(value)}else if(Array.isArray(value)){value=new DataView(Uint8Array.from(value).buffer)}else if(typeof value==="object"){value=new TextEncoder().encode(JSON.stringify(value))}}return value}static searchBuffer(buffer,searchString,limit){var needle=searchString;var haystack=buffer;var search=_ByteParser.boyerMoore(needle);var skip=search.byteLength;var indices=[];for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){indices.push(i2);if(limit){if(indices.length>=limit)break}}return indices}static bytesToInt16(x0,x1){let int16=(255&x0)<<8|255&x1;if((int16&32768)>0){int16|=4294901760}else{int16&=65535}return int16}static bytesToUInt16(x0,x1){return x0*256+x1}static Uint16ToBytes(y2){return[y2&255,y2>>8&255]}static bytesToInt24(x0,x1,x2){let int24=(255&x0)<<16|(255&x1)<<8|255&x2;if((int24&8388608)>0){int24|=4278190080}else{int24&=16777215}return int24}static bytesToUInt24(x0,x1,x2){return x0*65536+x1*256+x2}static Uint24ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255]}static bytesToInt32(x0,x1,x2,x3){let int32=(255&x0)<<24|(255&x1)<<16|(255&x2)<<8|255&x3;if((int32&2147483648)>0){int32|=0}else{int32&=4294967295}return int32}static bytesToUInt32(x0,x1,x2,x3){return x0*16777216+x1*65536+x2*256+x3}static Uint32ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255,y2>>24&255]}static get2sCompliment(val,nbits4){if(val>4294967296)return null;return val<<32-nbits4>>32-nbits4}static getSignedInt(...args){let pos=0;function getInt(size){var value=0;var first=true;while(size--){if(first){let byte=args[pos++];value+=byte&127;if(byte&128){value-=128}first=false}else{value*=256;value+=args[pos++]}}return value}return getInt(args.length)}static asUint8Array(input){if(input instanceof Uint8Array){return input}else if(typeof input==="string"){var arr=new Uint8Array(input.length);for(var i2=0;i2<input.length;i2++){var c=input.charCodeAt(i2);if(c>127){throw new TypeError("Only ASCII patterns are supported")}arr[i2]=c}return arr}else{return new Uint8Array(input)}}static boyerMoore(patternBuffer){var pattern=_ByteParser.asUint8Array(patternBuffer);var M=pattern.length;if(M===0){throw new TypeError("patternBuffer must be at least 1 byte long")}var R=256;var rightmost_positions=new Int32Array(R);for(var c=0;c<R;c++){rightmost_positions[c]=-1}for(var j=0;j<M;j++){rightmost_positions[pattern[j]]=j}var boyerMooreSearch=(txtBuffer,start,end)=>{var txt=_ByteParser.asUint8Array(txtBuffer);if(start===void 0)start=0;if(end===void 0)end=txt.length;var pat=pattern;var right=rightmost_positions;var lastIndex=end-pat.length;var lastPatIndex=pat.length-1;var skip;for(var i2=start;i2<=lastIndex;i2+=skip){skip=0;for(var j2=lastPatIndex;j2>=0;j2--){var c2=txt[i2+j2];if(pat[j2]!==c2){skip=Math.max(1,j2-right[c2]);break}}if(skip===0){return i2}}return-1};boyerMooreSearch.byteLength=pattern.byteLength;return boyerMooreSearch}static struct(format){let fns=[],size=0,m=rechk.exec(format);if(!m){throw new RangeError("Invalid format string")}const t2=lut("<"===m[1]),lu=(n,c)=>t2[c](n?parseInt(n,10):1);while(m=refmt.exec(format)){((r,s,f)=>{for(let i2=0;i2<r;++i2,size+=s){if(f){fns.push(f(size))}}})(...lu(...m.slice(1)))}const unpack_from=(arrb,offs)=>{if(arrb.byteLength<(offs|0)+size){throw errbuf}let v=new DataView(arrb,offs|0);return fns.map(f=>f.u(v))};const pack_into=(arrb,offs,...values)=>{if(values.length<fns.length){throw errval}if(arrb.byteLength<offs+size){throw errbuf}const v=new DataView(arrb,offs);new Uint8Array(arrb,offs,size).fill(0);fns.forEach((f,i2)=>f.p(v,values[i2]))};const pack=(...values)=>{let b=new ArrayBuffer(size);pack_into(b,0,...values);return b};const unpack=arrb=>unpack_from(arrb,0);function*iter_unpack(arrb){for(let offs=0;offs+size<=arrb.byteLength;offs+=size){yield unpack_from(arrb,offs)}}return Object.freeze({unpack,pack,unpack_from,pack_into,iter_unpack,format,size})}};var ByteParser=_ByteParser;ByteParser.codes={"\\\\n":10,"\\\\r":13,"\\\\t":9,"\\\\s":32,"\\\\b":8,"\\\\f":12,"\\\\":92};(function(s){var w,f={},l=console,m=Math,z2="postMessage",x="HackTimer.js by turuslan: ",v="Initialisation failed",p=0,r="hasOwnProperty",y2=[].slice,b=Worker;function d(){do{p=2147483647>p?p+1:0}while(f[r](p));return p}if(!/MSIE 10/i.test(navigator.userAgent)){try{s=URL.createObjectURL(new Blob(["var f={},p=postMessage,r='hasOwnProperty';onmessage=function(e){var d=e.data,i=d.i,t=d[r]('t')?d.t:0;switch(d.n){case'a':f[i]=setInterval(function(){p(i)},t);break;case'b':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case'c':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case'd':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch(e){}}if(typeof b!=="undefined"){try{w=new b(s);setInterval=function(c,t2){var i2=d();f[i2]={c,p:y2.call(arguments,2)};w[z2]({n:"a",i:i2,t:t2});return i2};clearInterval=function(i2){if(f[r](i2))delete f[i2],w[z2]({n:"b",i:i2})};setTimeout=function(c,t2){var i2=d();f[i2]={c,p:y2.call(arguments,2),t:true};w[z2]({n:"c",i:i2,t:t2});return i2};clearTimeout=function(i2){if(f[r](i2))delete f[i2],w[z2]({n:"d",i:i2})};w.onmessage=function(e){var i2=e.data,c,n;if(f[r](i2)){n=f[i2];c=n.c;if(n[r]("t"))delete f[i2]}if(typeof c=="string")try{c=new Function(c)}catch(k){l.log(x+"Error parsing callback code string: ",k)}if(typeof c=="function")c.apply(globalThis,n.p)};w.onerror=function(e){l.log(e)}}catch(e){l.log(x+v);l.error(e)}}else l.log(x+v+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js");var WebSerial=class extends ByteParser{constructor(){super(...arguments);this.streams={};this.createStream=options=>{let stream={_id:options._id?options._id:\`stream\${Math.floor(Math.random()*1e15)}\`,info:options.port.getInfo(),running:false,...options};if(options.port?.readable){if(options.transforms){stream.reader=WebSerial.setStreamTransforms(options.port.readable,options.transforms).getReader()}else{stream.reader=options.port.readable.getReader()}}this.streams[stream._id]=stream;return stream}}getPorts(){return navigator.serial.getPorts()}requestPort(usbVendorId,usbProductId){let options={};if(usbVendorId){options.usbVendorId=usbVendorId}if(usbProductId){options.usbProductId=usbProductId}if(options.usbVendorId)return navigator.serial.requestPort({filters:[options]});else return navigator.serial.requestPort()}openPort(port,options){if(options)options=Object.assign({},options);if(options?.ondisconnect){port.ondisconnect=options.ondisconnect;delete options.ondisconnect}return port.open(options).then(()=>{if(options?.onconnect)options.onconnect(port)})}async readWithTimeout(port,timeout){const reader=port.readable.getReader();const timer=setTimeout(()=>{reader.releaseLock()},timeout);const result=await reader.read();clearTimeout(timer);reader.releaseLock();return result}async writePort(port,message){const writer=port.writable.getWriter();await writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}getSignals(port){return port.getSignals()}setSignals(port,signals){return port.setSignals(signals)}readStream(stream){if(stream.reader&&!stream.running){let reader=stream.reader;if(stream.buffering){if(typeof stream.buffering!=="object")stream.buffering={};if(!stream.buffering.buffer){stream.buffering.buffer=[]}if(!stream.buffering.searchBytes)stream.buffering.searchBytes=new Uint8Array([13,10])}let readLoop=()=>{if(stream.port.readable&&stream.running){reader.read().then(result=>{if(result.done)reader.releaseLock();else{if(stream.buffering){stream.buffering.buffer.push(...result.value);const needle=stream.buffering.searchBytes;const haystack=stream.buffering.buffer;const search=WebSerial.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=stream.buffering.lockIdx??0;for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){if(!stream.buffering.locked&&!("lockIdx"in stream.buffering))used=stream.buffering.lockIdx=i2;else{nextIndex=i2;if(nextIndex>=0){const len=nextIndex-used;if(!stream.buffering.locked){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(data);stream.buffering.locked=true}else if(len>0){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(new Uint8Array(data))}used=nextIndex}}}}else stream.ondata(result.value);setTimeout(()=>{readLoop()},stream.frequency)}}).catch(er=>{console.error(stream._id," Read error:",er);if(er.message.includes("overrun")||er.message.includes("framing")){delete stream.reader;this.reconnect(stream)}})}else if(!stream.running&&stream.port.readable){try{reader.releaseLock()}catch(er){console.error(er)}}};stream.running=true;readLoop();return stream}return void 0}writeStream(stream,message){if(typeof stream==="string")stream=this.streams[stream];if(stream.port.writable){let writer=stream.port.writable.getWriter();writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}return void 0}closeStream(stream,onclose){if(typeof stream==="string")stream=this.streams[stream];stream.running=false;return new Promise((res,rej)=>{if(stream.settings.beforedisconnect){stream.settings.beforedisconnect(this,stream.port)}setTimeout(async()=>{if(stream.port.readable&&stream.reader){try{stream.reader.releaseLock()}catch(er){console.error(er)}if(stream.transforms)try{await stream.reader.cancel()}catch(err){console.error(err)}}try{await stream.port.close().then(()=>{if(onclose)onclose(this.streams[stream._id])});delete this.streams[stream._id];res(true)}catch(er){rej(er)}},300)})}reconnect(stream,options){if(typeof stream==="string")stream=this.streams[stream];return new Promise((res,rej)=>{if(typeof stream!=="object"){rej(void 0);return}let info=stream.port.getInfo();this.closeStream(stream._id).then(closed=>{setTimeout(()=>{this.getPorts().then(ports=>{for(let i2=0;i2<ports.length;i2++){if(ports[i2].getInfo().usbVendorId===info.usbVendorId&&ports[i2].getInfo().usbProductId===info.usbProductId){if(!options)options=stream;else options._id=stream._id;delete options.port;this.openPort(ports[i2],options.settings).then(()=>{const stream2=this.createStream({...options,port:ports[i2]});this.readStream(stream2);res(stream2)}).catch(rej)}}}).catch(rej)},100)})})}static setStreamTransforms(stream,transforms){let transform=[];Object.keys(transforms).forEach(t2=>{let opt=transforms[t2];if(opt instanceof TransformStream){transform.push(opt)}else{if(!opt.start)opt.start=function start(){};if(!opt.flush)opt.flush=function flush(){};let transformer=new TransformStream({start:opt.start,transform:opt.transform,flush:opt.flush},opt.writableStrategy,opt.readableStrategy);transform.push(transformer)}});let str2=stream;transform.forEach(transform2=>{str2=str2.pipeThrough(transform2)});return str2}};var sps=250;var gain=32;var nbits=24;var vref=1.2;var half24bit=Math.pow(2,24)/2;function ads131m08codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i2=0;i2<9;i2++){let j=i2*25;output[0][i2]=ByteParser.bytesToInt24(arr[j],arr[j+1],arr[j+2]);output[1][i2]=ByteParser.bytesToInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i2]=ByteParser.bytesToInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i2]=ByteParser.bytesToInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i2]=ByteParser.bytesToInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i2]=ByteParser.bytesToInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i2]=ByteParser.bytesToInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i2]=ByteParser.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])}if(arr.length>225){output.leds=arr.slice(225)}return output}function ads131m08codec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i2=0;i2<9;i2++){let j=i2*25;output[0][i2]=ByteParser.bytesToInt24(arr[j],arr[j+1],arr[j+2])+half24bit;output[1][i2]=ByteParser.bytesToInt24(arr[j+3],arr[j+4],arr[j+5])+half24bit;output[2][i2]=ByteParser.bytesToInt24(arr[j+6],arr[j+7],arr[j+8])+half24bit;output[3][i2]=ByteParser.bytesToInt24(arr[j+9],arr[j+10],arr[j+11])+half24bit;output[4][i2]=ByteParser.bytesToInt24(arr[j+12],arr[j+13],arr[j+14])+half24bit;output[5][i2]=ByteParser.bytesToInt24(arr[j+15],arr[j+16],arr[j+17])+half24bit;output[6][i2]=ByteParser.bytesToInt24(arr[j+18],arr[j+19],arr[j+20])+half24bit;output[7][i2]=ByteParser.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])+half24bit}if(arr.length>225){output.leds=arr.slice(225)}return output}var decoder=new TextDecoder;function ads131m08_arduinocodec(data){const parsed=decoder.decode(data);let split;if(parsed.includes("|"))split=parsed.split("|");else if(split.includes(","))split=parsed.split(",");else split=parsed.split("	");return{"0":parseInt(split[0]),"1":parseInt(split[1]),"2":parseInt(split[2]),"3":parseInt(split[3]),"4":parseInt(split[4]),"5":parseInt(split[5]),"6":parseInt(split[6]),"7":parseInt(split[7]),timestamp:Date.now()}}var defaultChartSetting={nSec:10,sps,units:"mV"};var ads131m08ChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting)),"1":JSON.parse(JSON.stringify(defaultChartSetting)),"2":JSON.parse(JSON.stringify(defaultChartSetting)),"3":JSON.parse(JSON.stringify(defaultChartSetting)),"4":JSON.parse(JSON.stringify(defaultChartSetting)),"5":JSON.parse(JSON.stringify(defaultChartSetting)),"6":JSON.parse(JSON.stringify(defaultChartSetting)),"7":JSON.parse(JSON.stringify(defaultChartSetting))}};var defaultsetting={sps,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))};var halfOffset=.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))*(Math.pow(2,nbits)-1)*.5;var ads131m08FilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting)),"1":JSON.parse(JSON.stringify(defaultsetting)),"2":JSON.parse(JSON.stringify(defaultsetting)),"3":JSON.parse(JSON.stringify(defaultsetting)),"4":JSON.parse(JSON.stringify(defaultsetting)),"5":JSON.parse(JSON.stringify(defaultsetting)),"6":JSON.parse(JSON.stringify(defaultsetting)),"7":JSON.parse(JSON.stringify(defaultsetting))};var accScale=.002/Math.pow(2,4);var getAcc=(arr,output,channels=8)=>{const accIdx=channels*3+1;const sum=(a,b)=>a+b;const accSum=arr.slice(accIdx).reduce(sum,0);if(accSum!==0){output.ax=accScale*ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output.ay=accScale*ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output.az=accScale*ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5])}};function cytoncodec(data){let arr;if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<8;i2++){let idx=1+3*i2;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);output.timestamp=Date.now();return output}function daisycytoncodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<8;i2++){let idx=1+3*i2;if(arr[0]%2===0)output[i2+7]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2]);else output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);return output}var sps2=250;var cytonSerialSettings={deviceType:"USB",deviceName:"cyton",baudRate:115200,codec:cytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var daisycytonSerialSettings={deviceType:"USB",deviceName:"cyton_daisy",baudRate:115200,codec:daisycytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var defaultChartSetting2={nSec:10,sps:sps2,units:"mV"};var defaultChartSetting22={nSec:10,sps:sps2};var cytonChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting2)),"1":JSON.parse(JSON.stringify(defaultChartSetting2)),"2":JSON.parse(JSON.stringify(defaultChartSetting2)),"3":JSON.parse(JSON.stringify(defaultChartSetting2)),"4":JSON.parse(JSON.stringify(defaultChartSetting2)),"5":JSON.parse(JSON.stringify(defaultChartSetting2)),"6":JSON.parse(JSON.stringify(defaultChartSetting2)),"7":JSON.parse(JSON.stringify(defaultChartSetting2)),"ax":JSON.parse(JSON.stringify(defaultChartSetting22)),"ay":JSON.parse(JSON.stringify(defaultChartSetting22)),"az":JSON.parse(JSON.stringify(defaultChartSetting22))},generateNewLines:true};var defaultsetting2={sps:sps2,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))};var cytonFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting2)),"1":JSON.parse(JSON.stringify(defaultsetting2)),"2":JSON.parse(JSON.stringify(defaultsetting2)),"3":JSON.parse(JSON.stringify(defaultsetting2)),"4":JSON.parse(JSON.stringify(defaultsetting2)),"5":JSON.parse(JSON.stringify(defaultsetting2)),"6":JSON.parse(JSON.stringify(defaultsetting2)),"7":JSON.parse(JSON.stringify(defaultsetting2)),"8":JSON.parse(JSON.stringify(defaultsetting2)),"9":JSON.parse(JSON.stringify(defaultsetting2)),"10":JSON.parse(JSON.stringify(defaultsetting2)),"11":JSON.parse(JSON.stringify(defaultsetting2)),"12":JSON.parse(JSON.stringify(defaultsetting2)),"13":JSON.parse(JSON.stringify(defaultsetting2)),"14":JSON.parse(JSON.stringify(defaultsetting2)),"15":JSON.parse(JSON.stringify(defaultsetting2))};function freeeeg128codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<128;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=385;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps3=250;var freeeeg128SerialSettings={deviceType:"USB",deviceName:"freeeeg128",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg128codec,sps:sps3,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg128ChartSettings={lines:{"ax":{nSec:10,sps:sps3},"ay":{nSec:10,sps:sps3},"az":{nSec:10,sps:sps3},"gx":{nSec:10,sps:sps3},"gy":{nSec:10,sps:sps3},"gz":{nSec:10,sps:sps3}}};var freeeeg128FilterSettings={};for(let i2=0;i2<128;i2++){freeeeg128ChartSettings.lines[i2]={sps:sps3,nSec:10,units:"mV"};freeeeg128FilterSettings[i2]={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))}}function freeeeg32codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<32;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=97;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps4=512;var freeeeg32SerialSettings={deviceType:"USB",deviceName:"freeeeg32",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg32_optical_SerialSettings={deviceType:"USB",deviceName:"freeeeg32_optical",baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting3={nSec:10,sps:sps4};var freeeeg32ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting3)),"ay":JSON.parse(JSON.stringify(defaultChartSetting3)),"az":JSON.parse(JSON.stringify(defaultChartSetting3)),"gx":JSON.parse(JSON.stringify(defaultChartSetting3)),"gy":JSON.parse(JSON.stringify(defaultChartSetting3)),"gz":JSON.parse(JSON.stringify(defaultChartSetting3))}};var freeeeg32FilterSettings={};for(let i2=0;i2<32;i2++){freeeeg32ChartSettings.lines[i2]={sps:sps4,nSec:10,units:"mV"};freeeeg32FilterSettings[i2]={sps:sps4,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))}}function freeeeg16codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<16;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var BLEBuffer=[];var locked;var lockIdx;function freeeeg16BLEcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;BLEBuffer.push(...data);const needle=new Uint8Array([192,160]);const haystack=BLEBuffer;const search=ByteParser.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=lockIdx??0;let pass=false;for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){if(!locked&&!(typeof lockIdx==="number"))used=lockIdx=i2;else{nextIndex=i2;if(nextIndex>=0){const len=nextIndex-used;if(!lockIdx){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true;locked=true}else if(len>0){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true}used=nextIndex}}}if(pass){let output={};for(let i3=0;i3<16;i3++){let idx=i3*3+1;output[i3]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}else return void 0}var sps5=250;var freeeeg16BLESettings={deviceType:"BLE",deviceName:"freeeeg16",services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:void 0},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:freeeeg16BLEcodec,sps:sps5}}}};var freeeeg16SerialSettings={deviceType:"USB",deviceName:"freeeeg16",baudRate:115200,bufferSize:2e3,frequency:3.5,codec:freeeeg16codec,sps:sps5,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting4={nSec:10,sps:sps5};var freeeeg16ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting4)),"ay":JSON.parse(JSON.stringify(defaultChartSetting4)),"az":JSON.parse(JSON.stringify(defaultChartSetting4)),"gx":JSON.parse(JSON.stringify(defaultChartSetting4)),"gy":JSON.parse(JSON.stringify(defaultChartSetting4)),"gz":JSON.parse(JSON.stringify(defaultChartSetting4))}};var freeeeg16FilterSettings={};var gain2=32;var nbits2=24;var vref2=1.2;for(let i2=0;i2<16;i2++){freeeeg16ChartSettings.lines[i2]={sps:sps5,nSec:10,units:"mV"};freeeeg16FilterSettings[i2]={sps:sps5,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref2/(gain2*(Math.pow(2,nbits2)-1))}}var textdecoder=new TextDecoder;function hegduinocodec(value){let output={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0};let txt=textdecoder.decode(value);let line=txt.split("|");if(line.length===3){output.timestamp=Date.now();output.red=parseInt(line[0]);output.infrared=parseInt(line[1]);output.heg=parseFloat(line[2])}else if(line.length>=2){output.timestamp=Date.now();output.red=parseInt(line[1]);output.infrared=parseInt(line[2]);output.heg=parseFloat(line[3]);if(line[4])output.ambient=parseFloat(line[4]);if(line[5])output.temperature=parseFloat(line[5]);return output}else return txt}var sps6=40;var hegduinoSerialSettings={deviceType:"USB",deviceName:"hegduino",baudRate:115200,write:"t\\n",codec:hegduinocodec,sps:sps6};var hegduinoV1SerialSettings=Object.assign({},hegduinoSerialSettings);hegduinoV1SerialSettings.sps=19;var hegduinoBLESettings={deviceType:"BLE",deviceName:"hegduino",sps:sps6,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:hegduinocodec,sps:sps6}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};var hegduinoV1BLESettings=Object.assign({},hegduinoSerialSettings);hegduinoV1BLESettings.sps=19;function max3010xcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let pktCt=32;const output={"red":new Array(pktCt),"ir":new Array(pktCt),"max_dietemp":ByteParser.get2sCompliment(arr[193],8)+.0625*arr[194],"timestamp":Date.now()};let i2=0;while(i2<pktCt){let idx=i2*6;if(i2%2===0){output["ir"][i2]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["ir"][i2+1]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}else{output["red"][i2-1]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["red"][i2]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}i2++}return output}function mpu6050codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={"ax":new Array(20),"ay":new Array(20),"az":new Array(20),"gx":new Array(20),"gy":new Array(20),"gz":new Array(20),"mpu_dietemp":(ByteParser.bytesToInt16(arr[241],arr[242])+521)/340+35,timestamp:Date.now()};for(let i2=0;i2<20;i2++){let idx=i2*12;output.ax[i2]=ByteParser.bytesToInt16(arr[idx+1],arr[idx+2]);output.ay[i2]=ByteParser.bytesToInt16(arr[idx+3],arr[idx+4]);output.az[i2]=ByteParser.bytesToInt16(arr[idx+5],arr[idx+6]);output.gx[i2]=ByteParser.bytesToInt16(arr[idx+7],arr[idx+8]);output.gy[i2]=ByteParser.bytesToInt16(arr[idx+9],arr[idx+10]);output.gz[i2]=ByteParser.bytesToInt16(arr[idx+11],arr[idx+12])}return output}function cognixionONE_EEG_codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let i2=0;i2<7;i2++){let j=i2*26+1;if(!arr[j+23])break;output[0][i2]=ByteParser.bytesToUInt24(arr[j],arr[j+1],arr[j+2]);output[1][i2]=ByteParser.bytesToUInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i2]=ByteParser.bytesToUInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i2]=ByteParser.bytesToUInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i2]=ByteParser.bytesToUInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i2]=ByteParser.bytesToUInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i2]=ByteParser.bytesToUInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i2]=ByteParser.bytesToUInt24(arr[j+21],arr[j+22],arr[j+23])}return output}var sps7=250;var cognixionONEBLESettings={deviceType:"BLE",deviceName:"cognixionONE",services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:true,notifyCallback:void 0,codec:cognixionONE_EEG_codec,sps:sps7}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:true}}},sps:sps7};var cognixionONESerialSettings=Object.assign({},cytonSerialSettings);cognixionONESerialSettings.sps=sps7;cognixionONESerialSettings.deviceName="cognixionONE";var defaultChartSetting5={nSec:10,sps:sps7,units:"mV"};var cognixionONEChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting5)),"1":JSON.parse(JSON.stringify(defaultChartSetting5)),"2":JSON.parse(JSON.stringify(defaultChartSetting5)),"3":JSON.parse(JSON.stringify(defaultChartSetting5)),"4":JSON.parse(JSON.stringify(defaultChartSetting5)),"5":JSON.parse(JSON.stringify(defaultChartSetting5)),"6":JSON.parse(JSON.stringify(defaultChartSetting5)),"7":JSON.parse(JSON.stringify(defaultChartSetting5))}};var PeanutCodes={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function peanutcodec(data){let result={};let i2=0;while(i2<data.length){if(PeanutCodes[data[i2]]&&i2+1+PeanutCodes[data[i2]].byteLength<=data.length){let slice=data.slice(i2+1,i2+1+PeanutCodes[data[i2]].byteLength).buffer;let unpacked=ByteParser.struct(PeanutCodes[data[i2]].format).unpack(slice);let code=PeanutCodes[data[i2]].type;if(code==="unfilteredHEG"||code==="heg")unpacked=unpacked[0]/256;else if(code==="POOR_SIGNAL"||code==="sampleNumber"||code==="debug0"||code==="debug1"||code==="debug2"||code==="debug3")unpacked=unpacked[0];if(!result[PeanutCodes[data[i2]].type]){if(Array.isArray(unpacked))result[PeanutCodes[data[i2]].type]=unpacked;else result[PeanutCodes[data[i2]].type]=[unpacked]}else{if(Array.isArray(unpacked))result[PeanutCodes[data[i2]].type].push(...unpacked);else result[PeanutCodes[data[i2]].type].push(unpacked)}i2+=PeanutCodes[data[i2]].byteLength+1}else i2++}result.timestamp=Date.now();return result}var peanutSerialSettings={deviceType:"USB",deviceName:"peanut",baudRate:38400,bufferSize:400,write:"protocol 3\\n",buffering:{searchBytes:new Uint8Array([170,170])},codec:peanutcodec,sps:10.101};var sealevel_hpa=1013.25;var bme280codec=data=>{let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={timestamp:Date.now(),temp:[],pressure:[],altitude:[]};let mode=0;if(arr[0].length===74)mode=1;if(!mode){for(let j=0;j<3;j++){let i2=j*16+2;let tint=ByteParser.bytesToInt32(arr[3+i2],arr[2+i2],arr[1+i2],arr[0+i2]);let tfrac=ByteParser.bytesToInt32(arr[7+i2],arr[6+i2],arr[5+i2],arr[4+i2]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser.bytesToInt32(arr[11+i2],arr[10+i2],arr[9+i2],arr[8+i2]);let pfrac=ByteParser.bytesToInt32(arr[15+i2],arr[14+i2],arr[13+i2],arr[12+i2]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}else{output.humidity=[];for(let j=0;j<3;j++){let i2=j*24+2;let tint=ByteParser.bytesToInt32(arr[3+i2],arr[2+i2],arr[1+i2],arr[0+i2]);let tfrac=ByteParser.bytesToInt32(arr[7+i2],arr[6+i2],arr[5+i2],arr[4+i2]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser.bytesToInt32(arr[11+i2],arr[10+i2],arr[9+i2],arr[8+i2]);let pfrac=ByteParser.bytesToInt32(arr[15+i2],arr[14+i2],arr[13+i2],arr[12+i2]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));let hint=ByteParser.bytesToInt32(arr[19+i2],arr[18+i2],arr[17+i2],arr[16+i2]);let hfrac=ByteParser.bytesToInt32(arr[23+i2],arr[22+i2],arr[21+i2],arr[20+i2]);output.humidity.push(hint+hfrac/Math.pow(10,Math.ceil(Math.log10(hfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}return output};function altitude(pressure,temperature){return 44330*(1-Math.pow(pressure/sealevel_hpa,.1903))}function nrf5x_usbcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i2)=>{output[i2+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec(arr.subarray(2))))}return output}function nrf5x_usbcodec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec_singleended(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i2)=>{output[i2+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec_singleended(arr.subarray(2))))}return output}var nrf5xSerialSettings={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec,sps:250};var nrf5xSerialSettings_singleended={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec_singleended,sps:250};var nrf5xBLESettings={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var nrf5xBLESettings_singleended={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var defaultChartSetting6={nSec:10,sps:250,units:"mV"};var nrf5x_usbChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting6)),"1":JSON.parse(JSON.stringify(defaultChartSetting6)),"2":JSON.parse(JSON.stringify(defaultChartSetting6)),"3":JSON.parse(JSON.stringify(defaultChartSetting6)),"4":JSON.parse(JSON.stringify(defaultChartSetting6)),"5":JSON.parse(JSON.stringify(defaultChartSetting6)),"6":JSON.parse(JSON.stringify(defaultChartSetting6)),"7":JSON.parse(JSON.stringify(defaultChartSetting6))},generateNewLines:true,cleanGeneration:false};var gain3=32;var nbits3=24;var vref3=1.2;var defaultsetting3={sps:250,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref3/(gain3*(Math.pow(2,nbits3)-1))};var nrf5x_usbFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting3)),"1":JSON.parse(JSON.stringify(defaultsetting3)),"2":JSON.parse(JSON.stringify(defaultsetting3)),"3":JSON.parse(JSON.stringify(defaultsetting3)),"4":JSON.parse(JSON.stringify(defaultsetting3)),"5":JSON.parse(JSON.stringify(defaultsetting3)),"6":JSON.parse(JSON.stringify(defaultsetting3)),"7":JSON.parse(JSON.stringify(defaultsetting3)),"8":JSON.parse(JSON.stringify(defaultsetting3)),"9":JSON.parse(JSON.stringify(defaultsetting3)),"10":JSON.parse(JSON.stringify(defaultsetting3)),"11":JSON.parse(JSON.stringify(defaultsetting3)),"12":JSON.parse(JSON.stringify(defaultsetting3)),"13":JSON.parse(JSON.stringify(defaultsetting3)),"14":JSON.parse(JSON.stringify(defaultsetting3)),"15":JSON.parse(JSON.stringify(defaultsetting3))};var textdecoder2=new TextDecoder;function statechangercodec(value){let output={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0};let txt=textdecoder2.decode(value);let line=txt.split("|");if(line.length>=5){output.timestamp=Date.now();output.left_red=parseInt(line[1]);output.left_infrared=parseInt(line[2]);output.left_heg=parseFloat(line[3]);output.center_red=parseInt(line[4]);output.center_infrared=parseInt(line[5]);output.center_heg=parseFloat(line[6]);output.right_red=parseInt(line[7]);output.right_infrared=parseInt(line[8]);output.right_heg=parseFloat(line[9]);return output}else return txt}var statechangerSerialSettings={deviceType:"USB",deviceName:"statechanger",baudRate:115200,codec:statechangercodec,sps:20};var statechangerBLESettings={deviceType:"BLE",deviceName:"statechanger",sps:20,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:statechangercodec}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};function blueberrycodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.red/(.5*(output.ir+output.ir2));return output}var sps8=40;var blueberryBLESettings={deviceType:"BLE",deviceName:"blueberry",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:true,notifyCallback:void 0,codec:blueberrycodec,sps:sps8}}},sps:sps8};function blueberryshortcodec(value){let output={sred:value.getInt32(2),sir:value.getInt32(6),sir2:value.getInt32(10),timestamp:Date.now()};output.sheg=output.sred/(.5*(output.sir+output.sir2));return output}function blueberrylongcodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.sred/(.5*(output.ir+output.ir2));return output}var sps9=40;var blueberry2BLESettings={deviceType:"BLE",deviceName:"blueberry2",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:true,notifyCallback:void 0,codec:blueberrylongcodec,sps:sps9},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:true,notifyCallback:void 0,codec:blueberryshortcodec,sps:sps9}}},sps:sps9};function hrcodec(data){return{hr:data.getInt8(1),timestamp:Date.now()}}var heartRateBLESettings={deviceType:"BLE",deviceName:"heartrate",services:{"heart_rate":{"heart_rate_measurement":{notify:true,notifyCallback:void 0,codec:hrcodec}}}};var simulatorSettings={sps:250,deviceType:"CUSTOM",deviceName:"simulator",simulate:{"0":{sps:250,freq:1,amplitude:1,offset:0},"1":{sps:250,freq:10,amplitude:1,offset:0},"2":{sps:250,freq:100,amplitude:.5,offset:.5},"3":{sps:250,freq:25,amplitude:1,offset:0}},connect:(settings={})=>{return new Promise(async(res,rej)=>{let _id=\`simulated\${Math.floor(Math.random()*1e15)}\`;let info={_id,settings:Object.assign(Object.assign({},simulatorSettings),settings)};info.settings.looping=true;let loopTime=50;let lastTime=Date.now();let loop2=()=>{if(info.settings.looping){let newData={};let now=Date.now();let frame=now-lastTime;for(const key in info.settings.simulate){let newPoints=Math.floor(info.settings.simulate[key].sps*frame/1e3);newData[key]=new Array(newPoints).fill(0);newData[key]=newData[key].map((v,i2)=>{return Math.sin(2*Math.PI*info.settings.simulate[key].freq*.001*(lastTime+frame*(i2+1)/newPoints))*info.settings.simulate[key].amplitude+info.settings.simulate[key].offset})}lastTime=now;newData.timestamp=lastTime;info.settings.ondata(newData);setTimeout(()=>{loop2()},loopTime)}};loop2();if(info.settings.onconnect)info.settings.onconnect(info);res(info)})},codec:reading=>{return reading},disconnect:info=>{console.log(info);info.settings.looping=false;info.settings.ondisconnect(info)},onconnect:info=>{console.log("simulator connected!",info)},ondisconnect:info=>{console.log("simulator disconnected!",info)},ondata:data=>{}};var BiquadChannelFilterer=class{constructor(options={sps:512,useSMA4:false,useNotch50:true,useNotch60:true,useLowpass:false,lowpassHz:100,useBandpass:false,bandpassLower:3,bandpassUpper:45,useDCBlock:true,DCBresonance:.995,trimOutliers:false,outlierTolerance:.2,useScaling:false,scalar:1}){this.idx=0;this.sps=options.sps;this.bandpassLower=options.bandpassLower?options.bandpassLower:3;this.bandpassUpper=options.bandpassUpper?options.bandpassUpper:45;this.useSMA4=options.useSMA4;this.last4=[];this.useNotch50=options.useNotch50;this.useNotch60=options.useNotch60;this.useLowpass=options.useLowpass;this.lowpassHz=options.lowpassHz?options.lowpassHz:100;this.useBandpass=options.useBandpass;this.useDCBlock=options.useDCBlock;this.DCBresonance=options.DCBresonance?options.DCBresonance:.995;this.useScaling=options.useScaling;this.scalar=options.scalar;this.trimOutliers=options.trimOutliers;this.outlierTolerance=options.outlierTolerance;let sps10=this.sps;this.notch50=[makeNotchFilter(50,sps10,2),makeNotchFilter(100,sps10,2)];this.notch60=[makeNotchFilter(60,sps10,2),makeNotchFilter(120,sps10,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1)];this.dcb=new DCBlocker(options.DCBresonance?options.DCBresonance:.995)}reset(sps10=this.sps){this.notch50=[makeNotchFilter(50,sps10,2),makeNotchFilter(100,sps10,2)];this.notch60=[makeNotchFilter(60,sps10,2),makeNotchFilter(120,sps10,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1)];this.dcb=new DCBlocker(this.DCBresonance)}setBandpass(bandpassLower=this.bandpassLower,bandpassUpper=this.bandpassUpper,sps10=this.sps){this.bandpassLower=bandpassLower;this.bandpassUpper=bandpassUpper;this.bp1=[makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10)]}apply(latestData=0){let out=latestData;if(this.useScaling===true){out*=this.scalar}if(this.filtered&&this.trimOutliers&&this.outlierTolerance){if(Math.abs(out-this.filtered)>this.outlierTolerance){out=this.filtered}}if(this.useDCBlock===true){out=this.dcb.applyFilter(out)}if(this.useSMA4===true){if(this.last4.length<4){this.last4.push(out)}else{out=this.last4.reduce((accumulator,currentValue)=>accumulator+currentValue)/this.last4.length;this.last4.shift();this.last4.push(out)}}if(this.useNotch50===true){this.notch50.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useNotch60===true){this.notch60.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useLowpass===true){this.lp1.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useBandpass===true){this.bp1.forEach((f,i2)=>{out=f.applyFilter(out)})}this.filtered=out;this.idx++;return out}};var Biquad=class{constructor(type,freq,sps10,Q=1/Math.sqrt(2),dbGain=0){this.a0=0;this.a1=0;this.a2=0;this.b0=0;this.b1=0;this.b2=0;this.x1=0;this.x2=0;this.y1=0;this.y2=0;let types=["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"];if(types.indexOf(type)<0){console.error("Valid types: 'lowpass','highpass','bandpass','notch','peak','lowshelf','highshelf'");return}this.type=type;this.freq=freq;this.sps=sps10;this.Q=Q;this.dbGain=dbGain;let A2=Math.pow(10,dbGain/40);let omega=2*Math.PI*freq/sps10;let sn=Math.sin(omega);let cs=Math.cos(omega);let alpha=sn/(2*Q);let beta=Math.sqrt(A2+A2);this[type](A2,sn,cs,alpha,beta);this.b0/=this.a0;this.b1/=this.a0;this.b2/=this.a0;this.a1/=this.a0;this.a2/=this.a0}lowpass(A2,sn,cs,alpha,beta){this.b0=(1-cs)*.5;this.b1=1-cs;this.b2=(1-cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}highpass(A2,sn,cs,alpha,beta){this.b0=(1+cs)*.5;this.b1=-(1+cs);this.b2=(1+cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}bandpass(A2,sn,cs,alpha,beta){this.b0=alpha;this.b1=0;this.b2=-alpha;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}notch(A2,sn,cs,alpha,beta){this.b0=1;this.b1=-2*cs;this.b2=1;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}peak(A2,sn,cs,alpha,beta){this.b0=1+alpha*A2;this.b1=-2*cs;this.b2=1-alpha*A2;this.a0=1+alpha/A2;this.a1=-2*cs;this.a2=1-alpha/A2}lowshelf(A2,sn,cs,alpha,beta){this.b0=A2*(A2+1-(A2-1)*cs+beta*sn);this.b1=2*A2*(A2-1-(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn);this.a0=A2+1+(A2+1)*cs+beta*sn;this.a1=2*(A2-1+(A2+1)*cs);this.a2=A2+1+(A2-1)*cs-beta*sn}highshelf(A2,sn,cs,alpha,beta){this.b0=A2*(A2+1+(A2-1)*cs+beta*sn);this.b1=2*A2*(A2-1+(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn);this.a0=A2+1-(A2+1)*cs-beta*sn;this.a1=2*(A2-1-(A2+1)*cs);this.a2=A2+1-(A2-1)*cs-beta*sn}applyFilter(signal_step){let y2=this.b0*signal_step+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;this.x2=this.x1;this.x1=signal_step;this.y2=this.y1;this.y1=y2;return y2}zResult(freq){try{let phi=Math.pow(Math.sin(Math.PI*freq*2/(2*this.sps)),2);let result=(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*phi+16*this.b0*this.b2*phi*phi)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*phi+16*this.a2*phi*phi);return result}catch(err){return-200}}static calcCenterFrequency(freqStart,freqEnd){return(freqStart+freqEnd)/2}static calcBandwidth(freqStart,freqEnd){return freqEnd-this.calcCenterFrequency(freqStart,freqEnd)}static calcBandpassQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*Math.sqrt((frequency-bandwidth)*(frequency+bandwidth))/(2*bandwidth);return Q}static calcNotchQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*frequency*bandwidth/Math.sqrt((frequency-bandwidth)*(frequency+bandwidth));return Q}};var DCBlocker=class{constructor(r=.995){this.r=r;this.y1=this.y2=this.x1=this.x2=0}applyFilter(signal_step){this.x2=this.x1;this.x1=signal_step;let y2=this.x1-this.x2+this.r*this.y1;this.y2=this.y1;this.y1=y2;return y2}};var makeNotchFilter=(frequency,sps10,bandwidth)=>{return new Biquad("notch",frequency,sps10,Biquad.calcNotchQ(frequency,bandwidth),0)};var makeBandpassFilter=(freqStart,freqEnd,sps10,resonance=Math.pow(10,Math.floor(Math.log10(Biquad.calcCenterFrequency(freqStart,freqEnd)))))=>{return new Biquad("bandpass",Biquad.calcCenterFrequency(freqStart,freqEnd),sps10,Biquad.calcBandpassQ(Biquad.calcCenterFrequency(freqStart,freqEnd),Biquad.calcBandwidth(freqStart,freqEnd),resonance),0)};var defaultsetting1={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var ganglionFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting1)),"1":JSON.parse(JSON.stringify(defaultsetting1)),"2":JSON.parse(JSON.stringify(defaultsetting1)),"3":JSON.parse(JSON.stringify(defaultsetting1))};var defaultChartSetting7={nSec:10,sps:250,units:"mV"};var ganglionChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting7)),"1":JSON.parse(JSON.stringify(defaultChartSetting7)),"2":JSON.parse(JSON.stringify(defaultChartSetting7)),"3":JSON.parse(JSON.stringify(defaultChartSetting7)),"ax":{nSec:10,sps:250,units:"mg"},"ay":{nSec:10,sps:250,units:"mg"},"az":{nSec:10,sps:250,units:"mg"}},generateNewLines:true};var defaultsetting4={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var museFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting4)),"1":JSON.parse(JSON.stringify(defaultsetting4)),"2":JSON.parse(JSON.stringify(defaultsetting4)),"3":JSON.parse(JSON.stringify(defaultsetting4)),"4":JSON.parse(JSON.stringify(defaultsetting4))};var Devices={BLE:{"nrf5x":nrf5xBLESettings,"nrf5x_singleended":nrf5xBLESettings_singleended,"hegduino":hegduinoBLESettings,"hegduinoV1":hegduinoV1BLESettings,"cognixionONE":cognixionONEBLESettings,"statechanger":statechangerBLESettings,"blueberry":blueberryBLESettings,"blueberry2":blueberry2BLESettings,"heart_rate":heartRateBLESettings,"freeEEG16":freeeeg16BLESettings},USB:{"nrf5x":nrf5xSerialSettings,"nrf5x_singleended":nrf5xSerialSettings_singleended,"freeEEG16":freeeeg16SerialSettings,"freeEEG32":freeeeg32SerialSettings,"freeEEG32_optical":freeeeg32_optical_SerialSettings,"freeEEG128":freeeeg128SerialSettings,"hegduino":hegduinoSerialSettings,"hegduinoV1":hegduinoV1SerialSettings,"cyton":cytonSerialSettings,"cyton_daisy":daisycytonSerialSettings,"peanut":peanutSerialSettings,"statechanger":statechangerSerialSettings,"cognixionONE":cytonSerialSettings},BLE_CUSTOM:{},USB_CUSTOM:{},CUSTOM:{"simulator":simulatorSettings}};var textdecoder3=new TextDecoder;var decoders={"raw":data=>{if(data?.buffer)return Array.from(new Uint8Array(data));else return data},"utf8":data=>{return textdecoder3.decode(data)},"console-f12":data=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(data);return data},"debug":(data,debugmessage)=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(debugmessage,data);return data},"ads131m08":ads131m08codec,"arduino_ads131m08":ads131m08_arduinocodec,"max3010x":max3010xcodec,"mpu6050":mpu6050codec,"bme280":bme280codec,"freeeeg16":freeeeg16codec,"freeeeg32":freeeeg32codec,"freeeeg128":freeeeg128codec,"cyton":cytoncodec,"cognixionONE_BLE":cognixionONE_EEG_codec,"hegduino":hegduinocodec,"nrf5x":nrf5x_usbcodec,"peanut":peanutcodec,"statechanger":statechangercodec,"blueberry":blueberrycodec,"heart_rate":hrcodec};function parseFunctionFromText2(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs3(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs2}var stringifyFast2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p in value[prop]){if(Array.isArray(value[prop][p])){if(value[prop][p].length>20)obj[prop][p]=value[prop][p].slice(value[prop][p].length-20);else obj[prop][p]=value[prop][p]}else{if(value[prop][p]!=null){let con=value[prop][p].constructor.name;if(con.includes("Set")){obj[prop][p]=Array.from(value[prop][p])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p]="instanceof_"+con}else{obj[prop][p]=value[prop][p]}}else{obj[prop][p]=value[prop][p]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast3(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast2}function loadStreamWorkerGlobals(){globalThis.Devices=Devices;globalThis.WebSerial=WebSerial;globalThis.decoders=decoders;globalThis.decoder="raw";globalThis.ByteParser=ByteParser;globalThis.filtering=false;globalThis.filters={};globalThis.BiquadChannelFilterer=BiquadChannelFilterer;globalThis.ArrayManip=ArrayManip}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){loadStreamWorkerGlobals()}var streamWorkerRoutes={"transferDevice":function transferDevice(device,worker){let cpy=Object.assign({},device);for(const key in cpy){if(typeof cpy[key]==="function")cpy[key]=cpy[key].toString()}worker.send({route:"receiveDevice",args:cpy})},"receiveDevice":function receiveDevice(device){for(const key in device){if(typeof device[key]==="string"){let fn=parseFunctionFromText2(device[key]);if(typeof fn==="function"){device[key]=fn}}}if(!globalThis.Devices[device.deviceType])globalThis.Devices[device.deviceType]={};globalThis.Devices[device.deviceType][device.deviceName]=device},"receiveDecoder":function receiveDecoder(decoder2,decoderName){globalThis.decoders[decoderName]=(0,eval)("("+decoder2+")")},"receiveCodec":function receiveDeviceCodec(decoder2,deviceType,device,service,characteristic){let codec=parseFunctionFromText2(decoder2);if(codec){if(deviceType==="BLE"&&service&&characteristic){if(globalThis.Devices[deviceType][device]){if(globalThis.Devices[deviceType][device][service]){if(globalThis.Devices[deviceType][device][characteristic]){globalThis.Devices[deviceType][device][characteristic].codec=codec}else{globalThis.Devices[deviceType][device][characteristic]={codec}}}else{globalThis.Devices[deviceType][device]={[characteristic]:{codec}}}}}else if(globalThis.Devices[deviceType][device]?.codec){if(globalThis.Devices[deviceType][device])globalThis.Devices[deviceType][device].codec=codec;else{globalThis.Devices[deviceType][device]={codec}}}}},"decode":function decode(data){return globalThis.decoder(data)},"decodeAndParse":function decodeAndParse(data){let decoded=this.__node.graph.run("decode",data);if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}}}}return parsed}}return decoded},"setActiveDecoder":function setActiveDecoder(deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device]?.codec;else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device][service][characteristic].codec;return true},"decodeDevice":function decodeDevice(data,deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)return globalThis.Devices[deviceType][device].codec(data);else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)return globalThis.Devices[deviceType][device][service][characteristic].codec(data)},"decodeAndParseDevice":function decodeAndParseDevice(data,deviceType,deviceName,service,characteristic){let decoded;if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][deviceName]?.services[service]?.[characteristic]?.codec)decoded=globalThis.Devices[deviceType][deviceName].services[service][characteristic].codec(data);else if(globalThis.Devices[deviceType][deviceName]?.codec)decoded=globalThis.Devices[deviceType][deviceName].codec(data);else decoded=data;if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}else if(typeof parsed[prop]==="number"){parsed[prop]=filter.apply(parsed[prop])}}}}return parsed}}return decoded},"toggleAnim":function toggleAnim(){globalThis.runningAnim=!globalThis.runningAnim;return globalThis.runningAnim},"setFilters":function setFilters(filters,clearFilters=false){if(!globalThis.filters||clearFilters){globalThis.filters={};if(clearFilters)globalThis.filtering=false}if(filters){for(const key in filters){globalThis.filters[key]=new BiquadChannelFilterer(filters[key])}globalThis.filtering=true}return true},"getFilterSettings":function getFilterSettings(){if(globalThis.filters){let filters={};for(const key in globalThis.filters){filters[key]={sps:globalThis.filters[key].sps,useScaling:globalThis.filters[key].useScaling,scalar:globalThis.filters[key].scalar,useNotch50:globalThis.filters[key].useNotch50,useNotch60:globalThis.filters[key].useNotch60,useDCBlock:globalThis.filters[key].useDCBlock,useLowpass:globalThis.filters[key].useLowpass,lowpassHz:globalThis.filters[key].lowpassHz,useBandpass:globalThis.filters[key].useBandpass,bandpassLower:globalThis.filters[key].bandpassLower,bandpassUpper:globalThis.filters[key].bandpassUpper}}return filters}return void 0},"setupSerial":function setupSerial(){globalThis.Serial=new globalThis.WebSerial;globalThis.decoder="raw";console.log("worker: Setting up Serial",globalThis.Serial);return true},"openPort":function openPort(settings){const WorkerService2=this.__node.graph;if(!globalThis.Serial)WorkerService2.run("setupSerial");return new Promise((res,rej)=>{globalThis.Serial.getPorts().then(ports=>{const Serial=globalThis.Serial;let port=ports.find(port2=>{return port2.getInfo().usbVendorId===settings.usbVendorId&&port2.getInfo().usbProductId===settings.usbProductId});if(port){let options=Object.assign({},settings);if(typeof settings.pipeTo==="object"&&settings.pipeTo.extraArgs&&globalThis.Devices?.[settings.pipeTo.extraArgs[0]]?.[settings.pipeTo.extraArgs[1]]){options.onconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].onconnect;options.ondisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].ondisconnect;options.beforedisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].beforedisconnect}Serial.openPort(port,options).then(()=>{const stream=Serial.createStream({port,settings:options,frequency:settings.frequency?settings.frequency:10,buffering:settings.buffering,ondata:value=>{if(stream.settings.pipeTo){if(stream.settings.pipeMain){WorkerService2.transmit(value,void 0,[value.buffer])}if(typeof stream.settings.pipeTo==="string")WorkerService2.transmit(value,stream.settings.pipeTo,[value.buffer]);else if(stream.settings.pipeTo?.route){let args=value;if(stream.settings.pipeTo.extraArgs)args=[value,...stream.settings.pipeTo.extraArgs];WorkerService2.transmit({route:stream.settings.pipeTo.route,args},stream.settings.pipeTo._id,[value.buffer])}}else{WorkerService2.transmit(value,void 0,[value.buffer])}}});Serial.readStream(stream);port.ondisconnect=()=>{postMessage(\`\${stream._id} disconnected\`)};res({_id:stream._id,settings,info:stream.info})}).catch(()=>{postMessage(\`disconnected\`)});;}else{rej(false)}})})},"closeStream":function closeStream(streamId){return new Promise((res,rej)=>{const Serial=globalThis.Serial;let ondisconnect;if(Serial.streams[streamId].port?.ondisconnect)ondisconnect=Serial.streams[streamId].port.ondisconnect;Serial.closeStream(Serial.streams[streamId]).then(resolved=>{if(ondisconnect)ondisconnect(void 0);res(resolved)}).catch(rej)})},"writeStream":function writeStream(streamId,message){globalThis.Serial.writeStream(globalThis.Serial.streams[streamId],message);return true},"updateStreamSettings":function updateStreamSettings(streamId,settings){if(globalThis.Serial?.streams[streamId]){for(const key in settings){if(typeof settings[key]==="object"){Object.assign(globalThis.Serial.streams[streamId].settings[key],settings[key])}else globalThis.Serial.streams[streamId][key]=settings[key]}}}};if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){globalThis.Devices=Devices;const worker=new WorkerService({roots:{...workerCanvasRoutes,...remoteGraphRoutes,...streamWorkerRoutes}})}var stream_worker_default=self;})();
`,BOe=URL.createObjectURL(new globalThis.Blob([DOe],{type:"text/javascript"})),ROe=BOe,Km=class{constructor(){this.recursivelyAssign=(e,t)=>{for(let r in t)typeof t[r]=="object"?typeof e[r]=="object"?this.recursivelyAssign(e[r],t[r]):e[r]=this.recursivelyAssign({},t[r]):e[r]=t[r];return e}}static autoscale(e,t=0,r=1,n=!1,i,a,o){if(e?.length===0)return e;let s=a||Math.max(...e),l=i||Math.min(...e),c=1/r,f=1;if(n){let u=Math.max(Math.abs(l),Math.abs(s));return u!==0&&(f=c/u),e.map(h=>(o&&(h<l&&(h=l),h>s&&(h=s)),h*f+(c*(t+1)*2-1-c)))}else return s===l?s!==0?f=c/s:l!==0&&(f=c/Math.abs(l)):f=c/(s-l),e.map(u=>(o&&(u<l&&(u=l),u>s&&(u=s)),2*((u-l)*f-1/(2*r))+(c*(t+1)*2-1-c)))}static genTimestamps(e,t){let r=Date.now(),n=[r-e*1e3/t,r];return Km.upsample(n,e)}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t,r=1){if(e.length>t){let n=new Array(t),i=e.length/t,a=e.length-1,o=0,s=0;for(let l=i;l<e.length;l+=i){let c=Math.round(l);c>a&&(c=a);for(let f=o;f<c;f++)n[s]+=e[f];n[s]/=(c-o)*r,s++,o=c}return n}else return e}static upsample(e,t,r=1){var n=function(u,h,g){return(u+(h-u)*g)*r},i=new Array(t),a=(e.length-1)/(t-1);i[0]=e[0];for(var o=1;o<t-1;o++){var s=o*a,l=Math.floor(s),c=Math.ceil(s),f=s-l;i[o]=n(e[l],e[c],f)}return i[t-1]=e[e.length-1],i}static interpolate(e,t,r=1){return e.length>t?Km.downsample(e,t,r):e.length<t?Km.upsample(e,t,r):e}static HSLToRGB(e,t,r,n=255){t/=100,r/=100;let i=(1-Math.abs(2*r-1))*t,a=i*(1-Math.abs(e/60%2-1)),o=r-i/2,s=0,l=0,c=0;return 0<=e&&e<60?(s=i,l=a,c=0):60<=e&&e<120?(s=a,l=i,c=0):120<=e&&e<180?(s=0,l=i,c=a):180<=e&&e<240?(s=0,l=a,c=i):240<=e&&e<300?(s=a,l=0,c=i):300<=e&&e<360&&(s=i,l=0,c=a),s=(s+o)*n,l=(l+o)*n,c=(c+o)*n,[s,l,c]}static circularBuffer(e,t){if(t.length<e.length){let r=e.slice(t.length),n=e.length;e.splice(0,n,...r,...t)}else if(t.length>e.length){let r=e.length;e.splice(0,r,t.slice(r-t.length))}else e.splice(0,e.length,...t);return e}static reformatData(e,t){if(Array.isArray(e)){if(Array.isArray(e[0])){let r={};if(e.forEach((n,i)=>{r[i]=n}),e=r,isNaN(e[0][0]))return}else if(t){if(e={[t]:e},isNaN(e[t][0]))return}else if(e={0:e},isNaN(e[0][0]))return}else if(typeof e=="object"){for(let r in e)if(typeof e[r]=="number"?e[r]=[e[r]]:e[r]?.values&&typeof e[r].values=="number"&&(e[r].values=[e[r].values]),isNaN(e[r][0]))return}else if(typeof e=="string"){let r;if(e.includes(`\r
`)){let n=e.split(`\r
`);e={},n.forEach((i,a)=>{i.includes("	")?r=i.split("	"):i.includes(",")?r=i.split(","):i.includes("|")&&(r=i.split("|")),Array.isArray(r)&&r.forEach((o,s)=>{if(o.includes(":")){let[l,c]=o.split(":"),f=parseFloat(c);if(f)e[l]=[f];else return}else{let l=parseFloat(o);if(l)e[s]=[l];else return}})})}else e.includes("	")?r=e.split("	"):e.includes(",")?r=e.split(","):e.includes("|")&&(r=e.split("|"));e={},Array.isArray(r)&&r.forEach((n,i)=>{if(n.includes(":")){let[a,o]=n.split(":"),s=parseFloat(o);if(s)e[a]=[s];else return}else{let a=parseFloat(n);if(a)e[i]=[a];else return}})}else typeof e=="number"&&(t?e={[t]:[e]}:e={0:[e]});return e}static padTime(e,t,r,n){let i=(e[0]-t)/r/n;return[...new Array(n-e.length).map((o,s)=>t+i*(s+1)),...e]}static interpolateForTime(e,t,r){return Km.interpolate(e,Math.ceil(r*t))}isTypedArray(e){return ArrayBuffer.isView(e)&&Object.prototype.toString.call(e)!=="[object DataView]"}spliceTypedArray(e,t,r){let n=e.subarray(0,t),i;r&&(i=e.subarray(r+1));let a;return(n.length>0||i?.length>0)&&(a=new e.constructor(n.length+i.length)),n.length>0&&a.set(n),i&&i.length>0&&a.set(i,n.length),a}},NY=Km;NY.bufferValues=(e,t,r,n)=>{if(!Array.isArray(r)&&typeof r=="object"&&(r=Object.keys(r)),!n){let a=Object.keys(e);r?n=new Float32Array(a.length*r.length):typeof e[a[0]][t]=="object"?(r=Object.keys(e[a[0]][t]),n=new Float32Array(a.length*r.length)):n=new Float32Array(a.length)}let i=0;for(let a in e)if(e[a][t])if(r)for(let o=0;o<r.length;o++)n[i]=e[a][t][r[o]],i++;else n[i]=e[a][t],i++;return n};var MOe=/^([<>])?(([1-9]\d*)?([xcbB?hHiIfdsp]))*$/,jOe=/([1-9]\d*)?([xcbB?hHiIfdsp])/g,fN=(e,t,r)=>String.fromCharCode(...new Uint8Array(e.buffer,e.byteOffset+t,r)),dN=(e,t,r,n)=>new Uint8Array(e.buffer,e.byteOffset+t,r).set(n.split("").map(i=>i.charCodeAt(0))),$Oe=(e,t,r)=>fN(e,t+1,Math.min(e.getUint8(t),r-1)),UOe=(e,t,r,n)=>{e.setUint8(t,n.length),dN(e,t+1,r-1,n)},zOe=e=>({x:t=>[1,t,0],c:t=>[t,1,r=>({u:n=>fN(n,r,1),p:(n,i)=>dN(n,r,1,i)})],"?":t=>[t,1,r=>({u:n=>!!n.getUint8(r),p:(n,i)=>n.setUint8(r,i)})],b:t=>[t,1,r=>({u:n=>n.getInt8(r),p:(n,i)=>n.setInt8(r,i)})],B:t=>[t,1,r=>({u:n=>n.getUint8(r),p:(n,i)=>n.setUint8(r,i)})],h:t=>[t,2,r=>({u:n=>n.getInt16(r,e),p:(n,i)=>n.setInt16(r,i,e)})],H:t=>[t,2,r=>({u:n=>n.getUint16(r,e),p:(n,i)=>n.setUint16(r,i,e)})],i:t=>[t,4,r=>({u:n=>n.getInt32(r,e),p:(n,i)=>n.setInt32(r,i,e)})],I:t=>[t,4,r=>({u:n=>n.getUint32(r,e),p:(n,i)=>n.setUint32(r,i,e)})],f:t=>[t,4,r=>({u:n=>n.getFloat32(r,e),p:(n,i)=>n.setFloat32(r,i,e)})],d:t=>[t,8,r=>({u:n=>n.getFloat64(r,e),p:(n,i)=>n.setFloat64(r,i,e)})],s:t=>[1,t,r=>({u:n=>fN(n,r,t),p:(n,i)=>dN(n,r,t,i.slice(0,t))})],p:t=>[1,t,r=>({u:n=>$Oe(n,r,t),p:(n,i)=>UOe(n,r,t,i.slice(0,t-1))})]}),dY=new RangeError("Structure larger than remaining buffer"),qOe=new RangeError("Not enough values for structure"),Wp=class extends NY{static toDataView(e){if(!(e instanceof DataView))if(typeof e=="string"&&parseInt(e)&&(e=parseInt(e)),typeof e=="string"){let t=new TextEncoder,r={};for(let i in Wp.codes)for(;e.indexOf(i)>-1;){let a=e.indexOf(i);e=e.replace(i,""),r[a]=i}let n=Array.from(t.encode(e));for(let i in r)n.splice(parseInt(i),0,Wp.codes[r[i]]);e=new DataView(new Uint8Array(n).buffer)}else if(typeof e=="number"){let t=e;e<256?(e=new DataView(new ArrayBuffer(1)),e.setUint8(0,t)):e<65536?(e=new DataView(new ArrayBuffer(2)),e.setInt16(0,t)):(e=new DataView(new ArrayBuffer(4)),e.setUint32(0,t))}else e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer?e=new DataView(e):Array.isArray(e)?e=new DataView(Uint8Array.from(e).buffer):typeof e=="object"&&(e=new TextEncoder().encode(JSON.stringify(e)));return e}static searchBuffer(e,t,r){for(var n=t,i=e,a=Wp.boyerMoore(n),o=a.byteLength,s=[],l=a(i);l!==-1&&(s.push(l),!(r&&s.length>=r));l=a(i,l+o));return s}static bytesToInt16(e,t){let r=(255&e)<<8|255&t;return(r&32768)>0?r|=4294901760:r&=65535,r}static bytesToUInt16(e,t){return e*256+t}static Uint16ToBytes(e){return[e&255,e>>8&255]}static bytesToInt24(e,t,r){let n=(255&e)<<16|(255&t)<<8|255&r;return(n&8388608)>0?n|=4278190080:n&=16777215,n}static bytesToUInt24(e,t,r){return e*65536+t*256+r}static Uint24ToBytes(e){return[e&255,e>>8&255,e>>16&255]}static bytesToInt32(e,t,r,n){let i=(255&e)<<24|(255&t)<<16|(255&r)<<8|255&n;return(i&2147483648)>0?i|=0:i&=4294967295,i}static bytesToUInt32(e,t,r,n){return e*16777216+t*65536+r*256+n}static Uint32ToBytes(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]}static get2sCompliment(e,t){return e>4294967296?null:e<<32-t>>32-t}static getSignedInt(...e){let t=0;function r(n){for(var i=0,a=!0;n--;)if(a){let o=e[t++];i+=o&127,o&128&&(i-=128),a=!1}else i*=256,i+=e[t++];return i}return r(e.length)}static asUint8Array(e){if(e instanceof Uint8Array)return e;if(typeof e=="string"){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n>127)throw new TypeError("Only ASCII patterns are supported");t[r]=n}return t}else return new Uint8Array(e)}static boyerMoore(e){var t=Wp.asUint8Array(e),r=t.length;if(r===0)throw new TypeError("patternBuffer must be at least 1 byte long");for(var n=256,i=new Int32Array(n),a=0;a<n;a++)i[a]=-1;for(var o=0;o<r;o++)i[t[o]]=o;var s=(l,c,f)=>{var u=Wp.asUint8Array(l);c===void 0&&(c=0),f===void 0&&(f=u.length);for(var h=t,g=i,_=f-h.length,w=h.length-1,E,S=c;S<=_;S+=E){E=0;for(var A=w;A>=0;A--){var O=u[S+A];if(h[A]!==O){E=Math.max(1,A-g[O]);break}}if(E===0)return S}return-1};return s.byteLength=t.byteLength,s}static struct(e){let t=[],r=0,n=MOe.exec(e);if(!n)throw new RangeError("Invalid format string");let i=zOe(n[1]==="<"),a=(u,h)=>i[h](u?parseInt(u,10):1);for(;n=jOe.exec(e);)((u,h,g)=>{for(let _=0;_<u;++_,r+=h)g&&t.push(g(r))})(...a(...n.slice(1)));let o=(u,h)=>{if(u.byteLength<(h|0)+r)throw dY;let g=new DataView(u,h|0);return t.map(_=>_.u(g))},s=(u,h,...g)=>{if(g.length<t.length)throw qOe;if(u.byteLength<h+r)throw dY;let _=new DataView(u,h);new Uint8Array(u,h,r).fill(0),t.forEach((w,E)=>w.p(_,g[E]))},l=(...u)=>{let h=new ArrayBuffer(r);return s(h,0,...u),h},c=u=>o(u,0);function*f(u){for(let h=0;h+r<=u.byteLength;h+=r)yield o(u,h)}return Object.freeze({unpack:c,pack:l,unpack_from:o,pack_into:s,iter_unpack:f,format:e,size:r})}},Qe=Wp;Qe.codes={"\\n":10,"\\r":13,"\\t":9,"\\s":32,"\\b":8,"\\f":12,"\\":92};var pY;(function(e){e[e.SCAN_MODE_LOW_POWER=0]="SCAN_MODE_LOW_POWER",e[e.SCAN_MODE_BALANCED=1]="SCAN_MODE_BALANCED",e[e.SCAN_MODE_LOW_LATENCY=2]="SCAN_MODE_LOW_LATENCY"})(pY||(pY={}));var hY;(function(e){e[e.CONNECTION_PRIORITY_BALANCED=0]="CONNECTION_PRIORITY_BALANCED",e[e.CONNECTION_PRIORITY_HIGH=1]="CONNECTION_PRIORITY_HIGH",e[e.CONNECTION_PRIORITY_LOW_POWER=2]="CONNECTION_PRIORITY_LOW_POWER"})(hY||(hY={}));yN();mN();yN();var jt=w1("BluetoothLe",{web:()=>Promise.resolve().then(()=>(JEe(),vY)).then(e=>new e.BluetoothLeWeb)}),VOe=()=>{let e=Promise.resolve();return t=>new Promise((r,n)=>{e=e.then(()=>t()).then(r).catch(n)})};function tN(e){return e?VOe():t=>t()}function wn(e){if(typeof e!="string")throw new Error(`Invalid UUID type ${typeof e}. Expected string.`);if(e=e.toLowerCase(),!(e.search(/^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$/)>=0))throw new Error(`Invalid UUID format ${e}. Expected 128 bit string (e.g. "0000180d-0000-1000-8000-00805f9b34fb").`);return e}var HOe=class{constructor(){this.scanListener=null,this.eventListeners=new Map,this.queue=tN(!0)}enableQueue(){this.queue=tN(!0)}disableQueue(){this.queue=tN(!1)}async initialize(e){await this.queue(async()=>{await jt.initialize(e)})}async isEnabled(){return await this.queue(async()=>(await jt.isEnabled()).value)}async enable(){await this.queue(async()=>{await jt.enable()})}async disable(){await this.queue(async()=>{await jt.disable()})}async startEnabledNotifications(e){await this.queue(async()=>{var t;let r="onEnabledChanged";await((t=this.eventListeners.get(r))===null||t===void 0?void 0:t.remove());let n=await jt.addListener(r,i=>{e(i.value)});this.eventListeners.set(r,n),await jt.startEnabledNotifications()})}async stopEnabledNotifications(){await this.queue(async()=>{var e;let t="onEnabledChanged";await((e=this.eventListeners.get(t))===null||e===void 0?void 0:e.remove()),this.eventListeners.delete(t),await jt.stopEnabledNotifications()})}async isLocationEnabled(){return await this.queue(async()=>(await jt.isLocationEnabled()).value)}async openLocationSettings(){await this.queue(async()=>{await jt.openLocationSettings()})}async openBluetoothSettings(){await this.queue(async()=>{await jt.openBluetoothSettings()})}async openAppSettings(){await this.queue(async()=>{await jt.openAppSettings()})}async setDisplayStrings(e){await this.queue(async()=>{await jt.setDisplayStrings(e)})}async requestDevice(e){return e=e?this.validateRequestBleDeviceOptions(e):void 0,await this.queue(async()=>await jt.requestDevice(e))}async requestLEScan(e,t){e=this.validateRequestBleDeviceOptions(e),await this.queue(async()=>{var r;await((r=this.scanListener)===null||r===void 0?void 0:r.remove()),this.scanListener=await jt.addListener("onScanResult",n=>{let i=Object.assign(Object.assign({},n),{manufacturerData:this.convertObject(n.manufacturerData),serviceData:this.convertObject(n.serviceData),rawAdvertisement:n.rawAdvertisement?this.convertValue(n.rawAdvertisement):void 0});t(i)}),await jt.requestLEScan(e)})}async stopLEScan(){await this.queue(async()=>{var e;await((e=this.scanListener)===null||e===void 0?void 0:e.remove()),this.scanListener=null,await jt.stopLEScan()})}async getDevices(e){if(!Array.isArray(e))throw new Error("deviceIds must be an array");return this.queue(async()=>(await jt.getDevices({deviceIds:e})).devices)}async getConnectedDevices(e){if(!Array.isArray(e))throw new Error("services must be an array");return e=e.map(wn),this.queue(async()=>(await jt.getConnectedDevices({services:e})).devices)}async connect(e,t,r){await this.queue(async()=>{var n;if(t){let i=`disconnected|${e}`;await((n=this.eventListeners.get(i))===null||n===void 0?void 0:n.remove());let a=await jt.addListener(i,()=>{t(e)});this.eventListeners.set(i,a)}await jt.connect(Object.assign({deviceId:e},r))})}async createBond(e){await this.queue(async()=>{await jt.createBond({deviceId:e})})}async isBonded(e){return await this.queue(async()=>(await jt.isBonded({deviceId:e})).value)}async disconnect(e){await this.queue(async()=>{await jt.disconnect({deviceId:e})})}async getServices(e){return await this.queue(async()=>(await jt.getServices({deviceId:e})).services)}async discoverServices(e){await this.queue(async()=>{await jt.discoverServices({deviceId:e})})}async getMtu(e){return await this.queue(async()=>(await jt.getMtu({deviceId:e})).value)}async requestConnectionPriority(e,t){await this.queue(async()=>{await jt.requestConnectionPriority({deviceId:e,connectionPriority:t})})}async readRssi(e){return await this.queue(async()=>{let r=await jt.readRssi({deviceId:e});return parseFloat(r.value)})}async read(e,t,r,n){return t=wn(t),r=wn(r),await this.queue(async()=>{let a=await jt.read(Object.assign({deviceId:e,service:t,characteristic:r},n));return this.convertValue(a.value)})}async write(e,t,r,n,i){return t=wn(t),r=wn(r),this.queue(async()=>{if(!n?.buffer)throw new Error("Invalid data.");let a=n;ac.getPlatform()!=="web"&&(a=G3(n)),await jt.write(Object.assign({deviceId:e,service:t,characteristic:r,value:a},i))})}async writeWithoutResponse(e,t,r,n,i){t=wn(t),r=wn(r),await this.queue(async()=>{if(!n?.buffer)throw new Error("Invalid data.");let a=n;ac.getPlatform()!=="web"&&(a=G3(n)),await jt.writeWithoutResponse(Object.assign({deviceId:e,service:t,characteristic:r,value:a},i))})}async readDescriptor(e,t,r,n,i){return t=wn(t),r=wn(r),n=wn(n),await this.queue(async()=>{let o=await jt.readDescriptor(Object.assign({deviceId:e,service:t,characteristic:r,descriptor:n},i));return this.convertValue(o.value)})}async writeDescriptor(e,t,r,n,i,a){return t=wn(t),r=wn(r),n=wn(n),this.queue(async()=>{if(!i?.buffer)throw new Error("Invalid data.");let o=i;ac.getPlatform()!=="web"&&(o=G3(i)),await jt.writeDescriptor(Object.assign({deviceId:e,service:t,characteristic:r,descriptor:n,value:o},a))})}async startNotifications(e,t,r,n){t=wn(t),r=wn(r),await this.queue(async()=>{var i;let a=`notification|${e}|${t}|${r}`;await((i=this.eventListeners.get(a))===null||i===void 0?void 0:i.remove());let o=await jt.addListener(a,s=>{n(this.convertValue(s?.value))});this.eventListeners.set(a,o),await jt.startNotifications({deviceId:e,service:t,characteristic:r})})}async stopNotifications(e,t,r){t=wn(t),r=wn(r),await this.queue(async()=>{var n;let i=`notification|${e}|${t}|${r}`;await((n=this.eventListeners.get(i))===null||n===void 0?void 0:n.remove()),this.eventListeners.delete(i),await jt.stopNotifications({deviceId:e,service:t,characteristic:r})})}validateRequestBleDeviceOptions(e){return e.services&&(e.services=e.services.map(wn)),e.optionalServices&&(e.optionalServices=e.optionalServices.map(wn)),e}convertValue(e){return typeof e=="string"?x1(e):e===void 0?new DataView(new ArrayBuffer(0)):e}convertObject(e){if(e===void 0)return;let t={};for(let r of Object.keys(e))t[r]=this.convertValue(e[r]);return t}},WOe=new HOe;mN();var A1=class extends Qe{constructor(e,t){super(),this.client=WOe,this.devices={},this.location=!1,this.initialized=!1,this.setupDevice=(r,n)=>new Promise(async(i,a)=>{this.devices[r.deviceId]={device:r,deviceId:r.deviceId,...n},this.client.connect(r.deviceId,o=>{this.devices[r.deviceId]?.ondisconnect&&this.devices[r.deviceId].ondisconnect(o)},n?.connectOptions).then(async()=>{let o=await this.getServices(r.deviceId);for(let s in n?.services){let l=o.find(c=>{if(c.uuid===s)return!0});if(l)for(let c in n.services[s]){if(!l.characteristics.find(u=>{if(u.uuid===c)return!0}))continue;let f=n.services[s][c];f.write&&await this.write(r,s,c,f.write,f.writeCallback,f.writeOptions),f.read&&await this.read(r,s,c,f.readCallback,f.readOptions),f.notify&&f.notifyCallback&&(await this.subscribe(r,s,c,f.notifyCallback),f.notifying=!0)}}}).catch(a),i(this.devices[r.deviceId])}),this.triangulate=(r,n=1500,i=60)=>new Promise((a,o)=>{if("Accelerometer"in globalThis){if(typeof globalThis.Accelerometer=="function"){let s=new globalThis.Accelerometer({frequency:i}),l=performance.now(),c=l,f={samples:[],vector:{}},u=()=>{if(c-l<n)this.readRssi(r).then(h=>{let g=s.x,_=s.y,w=s.z;c=performance.now(),f.samples.push({x:g,y:_,z:w,rssi:h,timestamp:c})});else{let h={x:0,y:0,z:0,rssiAvg:0};f.samples.forEach(g=>{}),s.removeEventListener("reading",u)}};s.addEventListener("reading",u)}}else o(new Error("No Accelerometer API detected"))}),t&&(this.location=t),e&&this.setup(e)}setup(e,t=this.location){let r=[];if(e)for(let i in e.services)r.push(i);let n={};return t||(n.androidNeverForLocation=!1),new Promise(async(i,a)=>{if(this.initialized||(await this.client.initialize(n),this.initialized=!0),e?.deviceId)i(await this.reconnect(e.deviceId));else if(e){let o=Array.from(Object.keys(e.services)),s={};this.isMobile()||(s.optionalServices=o),e.name&&(s.name=e.name),e.namePrefix&&(s.namePrefix=e.namePrefix),this.client.requestDevice(s).then(l=>{i(this.setupDevice(l,e))}).catch(a)}else this.client.requestDevice().then(o=>{i(this.setupDevice(o,e))}).catch(a)})}initialize(e){return new Promise((t,r)=>{this.client.initialize(e).then(()=>{t(!0)}).catch(r)})}requestDevice(e,t){return new Promise((r,n)=>{this.client.requestDevice(e).then(i=>{this.devices[i.deviceId]={device:i,deviceId:i.deviceId,...t},r(i)}).catch(n)})}getServices(e){return this.client.getServices(e)}connect(e,t){return new Promise((r,n)=>{this.client.connect(e.deviceId,i=>{t?.ondisconnect&&t.ondisconnect(i)},t?.connectOptions).then(i=>{r(e)}).catch(n)})}reconnect(e,t){return new Promise((r,n)=>{let i=t;this.devices[e]&&(i=Object.assign(Object.assign({},this.devices[e]),i)),i?.deviceId&&delete i.deviceId,this.client.getDevices([e]).then(a=>{this.setupDevice(a[0],i).then(o=>{r(o)})}).catch(n)})}disconnect(e){if(typeof e=="object"&&e?.deviceId&&(e=e.deviceId),typeof e=="string"){let t=this.devices[e];return t.beforedisconnect&&t.beforedisconnect(this,t),delete this.devices[e],this.client.disconnect(e)}}write(e,t,r,n,i,a){return typeof e=="object"&&(e=e.deviceId),i?this.client.write(e,t,r,A1.toDataView(n)).then(i):this.client.writeWithoutResponse(e,t,r,A1.toDataView(n),a)}read(e,t,r,n,i){return typeof e=="object"&&(e=e.deviceId),n?this.client.read(e,t,r,i).then(n):this.client.read(e,t,r,i)}subscribe(e,t,r,n){return typeof e=="object"&&(e=e.deviceId),this.client.startNotifications(e,t,r,n)}unsubscribe(e,t,r){return typeof e=="object"&&(e=e.deviceId),this.client.stopNotifications(e,t,r)}scan(e,t){return this.client.requestLEScan(e,t)}stopScanning(){return this.client.stopLEScan()}readDescriptor(e,t,r,n,i){return this.client.readDescriptor(e.deviceId,t,r,n,i)}writeDescriptor(e,t,r,n,i,a){return this.client.writeDescriptor(e.deviceId,t,r,n,A1.toDataView(i),a)}readRssi(e){return this.client.readRssi(e.deviceId)}isMobile(){let e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}isAndroid(){return navigator.userAgent.toLowerCase().indexOf("android")>-1}async distance(e,t,r,n,i){let a=await this.readRssi(e);if(a==0)return;let o=a/t;return o<1?Math.pow(o,10):r*Math.pow(o,n)+i}async distanceFromPhone(e,t,r){let n,i,a;return r&&(r==="nexus5"?(n=.42093,i=6.9476,a=.54992):r==="motoX"?(n=.9401940951,i=6.170094565,a=0):r==="iphone5"&&(n=.89976,i=7.7095,a=.111)),await this.distance(e,t,n,i,a)}};(function(e){var t,r={},n=console,i=Math,a="postMessage",o="HackTimer.js by turuslan: ",s="Initialisation failed",l=0,c="hasOwnProperty",f=[].slice,u=Worker;function h(){do l=2147483647>l?l+1:0;while(r[c](l));return l}if(!/MSIE 10/i.test(navigator.userAgent))try{e=URL.createObjectURL(new Blob(["var f={},p=postMessage,r='hasOwnProperty';onmessage=function(e){var d=e.data,i=d.i,t=d[r]('t')?d.t:0;switch(d.n){case'a':f[i]=setInterval(function(){p(i)},t);break;case'b':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case'c':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case'd':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch{}if(typeof u<"u")try{t=new u(e),setInterval=function(g,_){var w=h();return r[w]={c:g,p:f.call(arguments,2)},t[a]({n:"a",i:w,t:_}),w},clearInterval=function(g){r[c](g)&&(delete r[g],t[a]({n:"b",i:g}))},setTimeout=function(g,_){var w=h();return r[w]={c:g,p:f.call(arguments,2),t:!0},t[a]({n:"c",i:w,t:_}),w},clearTimeout=function(g){r[c](g)&&(delete r[g],t[a]({n:"d",i:g}))},t.onmessage=function(g){var _=g.data,w,E;if(r[c](_)&&(E=r[_],w=E.c,E[c]("t")&&delete r[_]),typeof w=="string")try{w=new Function(w)}catch(S){n.log(o+"Error parsing callback code string: ",S)}typeof w=="function"&&w.apply(globalThis,E.p)},t.onerror=function(g){n.log(g)}}catch(g){n.log(o+s),n.error(g)}else n.log(o+s+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js");var Xm=class extends Qe{constructor(){super(...arguments),this.streams={},this.createStream=e=>{let t={_id:e._id?e._id:`stream${Math.floor(Math.random()*1e15)}`,info:e.port.getInfo(),running:!1,...e};return e.port?.readable&&(e.transforms?t.reader=Xm.setStreamTransforms(e.port.readable,e.transforms).getReader():t.reader=e.port.readable.getReader()),this.streams[t._id]=t,t}}getPorts(){return navigator.serial.getPorts()}requestPort(e,t){let r={};return e&&(r.usbVendorId=e),t&&(r.usbProductId=t),r.usbVendorId?navigator.serial.requestPort({filters:[r]}):navigator.serial.requestPort()}openPort(e,t){return t&&(t=Object.assign({},t)),t?.ondisconnect&&(e.ondisconnect=t.ondisconnect,delete t.ondisconnect),e.open(t).then(()=>{t?.onconnect&&t.onconnect(e)})}async readWithTimeout(e,t){let r=e.readable.getReader(),n=setTimeout(()=>{r.releaseLock()},t),i=await r.read();return clearTimeout(n),r.releaseLock(),i}async writePort(e,t){let r=e.writable.getWriter();return await r.write(Xm.toDataView(t)),r.releaseLock(),!0}getSignals(e){return e.getSignals()}setSignals(e,t){return e.setSignals(t)}readStream(e){if(e.reader&&!e.running){let t=e.reader;e.buffering&&(typeof e.buffering!="object"&&(e.buffering={}),e.buffering.buffer||(e.buffering.buffer=[]),e.buffering.searchBytes||(e.buffering.searchBytes=new Uint8Array([13,10])));let r=()=>{if(e.port.readable&&e.running)t.read().then(n=>{if(n.done)t.releaseLock();else{if(e.buffering){e.buffering.buffer.push(...n.value);let a=e.buffering.searchBytes,o=e.buffering.buffer,s=Xm.boyerMoore(a),l=s.byteLength,c=-1,f=e.buffering.lockIdx??0;for(var i=s(o);i!==-1;i=s(o,i+l))if(!e.buffering.locked&&!("lockIdx"in e.buffering))f=e.buffering.lockIdx=i;else if(c=i,c>=0){let u=c-f;if(e.buffering.locked){if(u>0){let h=e.buffering.buffer.splice(e.buffering.lockIdx,u),g=new Uint8Array(h.slice(e.buffering.searchBytes.length));e.ondata(new Uint8Array(g))}}else{let h=e.buffering.buffer.splice(e.buffering.lockIdx,u),g=new Uint8Array(h.slice(e.buffering.searchBytes.length));e.ondata(g),e.buffering.locked=!0}f=c}}else e.ondata(n.value);setTimeout(()=>{r()},e.frequency)}}).catch(n=>{console.error(e._id," Read error:",n),(n.message.includes("overrun")||n.message.includes("framing"))&&(delete e.reader,this.reconnect(e))});else if(!e.running&&e.port.readable)try{t.releaseLock()}catch(n){console.error(n)}};return e.running=!0,r(),e}}writeStream(e,t){if(typeof e=="string"&&(e=this.streams[e]),e.port.writable){let r=e.port.writable.getWriter();return r.write(Xm.toDataView(t)),r.releaseLock(),!0}}closeStream(e,t){return typeof e=="string"&&(e=this.streams[e]),e.running=!1,new Promise((r,n)=>{e.settings.beforedisconnect&&e.settings.beforedisconnect(this,e.port),setTimeout(async()=>{if(e.port.readable&&e.reader){try{e.reader.releaseLock()}catch(i){console.error(i)}if(e.transforms)try{await e.reader.cancel()}catch(i){console.error(i)}}try{await e.port.close().then(()=>{t&&t(this.streams[e._id])}),delete this.streams[e._id],r(!0)}catch(i){n(i)}},300)})}reconnect(e,t){return typeof e=="string"&&(e=this.streams[e]),new Promise((r,n)=>{if(typeof e!="object"){n(void 0);return}let i=e.port.getInfo();this.closeStream(e._id).then(a=>{setTimeout(()=>{this.getPorts().then(o=>{for(let s=0;s<o.length;s++)o[s].getInfo().usbVendorId===i.usbVendorId&&o[s].getInfo().usbProductId===i.usbProductId&&(t?t._id=e._id:t=e,delete t.port,this.openPort(o[s],t.settings).then(()=>{let l=this.createStream({...t,port:o[s]});this.readStream(l),r(l)}).catch(n))}).catch(n)},100)})})}static setStreamTransforms(e,t){let r=[];Object.keys(t).forEach(i=>{let a=t[i];if(a instanceof TransformStream)r.push(a);else{a.start||(a.start=function(){}),a.flush||(a.flush=function(){});let o=new TransformStream({start:a.start,transform:a.transform,flush:a.flush},a.writableStrategy,a.readableStrategy);r.push(o)}});let n=e;return r.forEach(i=>{n=n.pipeThrough(i)}),n}},LY=250,PY=32,pN=24,FY=1.2,Zl=Math.pow(2,24)/2;function Jp(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let n=0;n<9;n++){let i=n*25;r[0][n]=Qe.bytesToInt24(t[i],t[i+1],t[i+2]),r[1][n]=Qe.bytesToInt24(t[i+3],t[i+4],t[i+5]),r[2][n]=Qe.bytesToInt24(t[i+6],t[i+7],t[i+8]),r[3][n]=Qe.bytesToInt24(t[i+9],t[i+10],t[i+11]),r[4][n]=Qe.bytesToInt24(t[i+12],t[i+13],t[i+14]),r[5][n]=Qe.bytesToInt24(t[i+15],t[i+16],t[i+17]),r[6][n]=Qe.bytesToInt24(t[i+18],t[i+19],t[i+20]),r[7][n]=Qe.bytesToInt24(t[i+21],t[i+22],t[i+23])}return t.length>225&&(r.leds=t.slice(225)),r}function T1(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let n=0;n<9;n++){let i=n*25;r[0][n]=Qe.bytesToInt24(t[i],t[i+1],t[i+2])+Zl,r[1][n]=Qe.bytesToInt24(t[i+3],t[i+4],t[i+5])+Zl,r[2][n]=Qe.bytesToInt24(t[i+6],t[i+7],t[i+8])+Zl,r[3][n]=Qe.bytesToInt24(t[i+9],t[i+10],t[i+11])+Zl,r[4][n]=Qe.bytesToInt24(t[i+12],t[i+13],t[i+14])+Zl,r[5][n]=Qe.bytesToInt24(t[i+15],t[i+16],t[i+17])+Zl,r[6][n]=Qe.bytesToInt24(t[i+18],t[i+19],t[i+20])+Zl,r[7][n]=Qe.bytesToInt24(t[i+21],t[i+22],t[i+23])+Zl}return t.length>225&&(r.leds=t.slice(225)),r}var NHe=new TextDecoder;var Ql={nSec:10,sps:LY,units:"mV"},LHe={lines:{0:JSON.parse(JSON.stringify(Ql)),1:JSON.parse(JSON.stringify(Ql)),2:JSON.parse(JSON.stringify(Ql)),3:JSON.parse(JSON.stringify(Ql)),4:JSON.parse(JSON.stringify(Ql)),5:JSON.parse(JSON.stringify(Ql)),6:JSON.parse(JSON.stringify(Ql)),7:JSON.parse(JSON.stringify(Ql))}},ec={sps:LY,useDCBlock:!1,useBandpass:!1,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:.96*1e3*FY/(PY*(Math.pow(2,pN)-1))},PHe=.96*1e3*FY/(PY*(Math.pow(2,pN)-1))*(Math.pow(2,pN)-1)*.5,P1={0:JSON.parse(JSON.stringify(ec)),1:JSON.parse(JSON.stringify(ec)),2:JSON.parse(JSON.stringify(ec)),3:JSON.parse(JSON.stringify(ec)),4:JSON.parse(JSON.stringify(ec)),5:JSON.parse(JSON.stringify(ec)),6:JSON.parse(JSON.stringify(ec)),7:JSON.parse(JSON.stringify(ec))},rN=.002/Math.pow(2,4),DY=(e,t,r=8)=>{let n=r*3+1,i=(o,s)=>o+s;e.slice(n).reduce(i,0)!==0&&(t.ax=rN*Qe.bytesToInt16(e[n],e[n+1]),t.ay=rN*Qe.bytesToInt16(e[n+2],e[n+3]),t.az=rN*Qe.bytesToInt16(e[n+4],e[n+5]))};function JOe(e){let t;e.buffer?t=e:t=new Uint8Array(e);let r={};for(let n=0;n<8;n++){let i=1+3*n;r[n]=Qe.bytesToInt24(t[i],t[i+1],t[i+2])}return DY(t,r),r.timestamp=Date.now(),r}function GOe(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let n=0;n<8;n++){let i=1+3*n;t[0]%2===0?r[n+7]=Qe.bytesToInt24(t[i],t[i+1],t[i+2]):r[n]=Qe.bytesToInt24(t[i],t[i+1],t[i+2])}return DY(t,r),r}var rv=250,hN={deviceType:"USB",deviceName:"cyton",baudRate:115200,codec:JOe,write:"b",beforedisconnect:(e,t)=>{e.writePort(t,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:rv},YOe={deviceType:"USB",deviceName:"cyton_daisy",baudRate:115200,codec:GOe,write:"b",beforedisconnect:(e,t)=>{e.writePort(t,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:rv},tc={nSec:10,sps:rv,units:"mV"},nN={nSec:10,sps:rv},FHe={lines:{0:JSON.parse(JSON.stringify(tc)),1:JSON.parse(JSON.stringify(tc)),2:JSON.parse(JSON.stringify(tc)),3:JSON.parse(JSON.stringify(tc)),4:JSON.parse(JSON.stringify(tc)),5:JSON.parse(JSON.stringify(tc)),6:JSON.parse(JSON.stringify(tc)),7:JSON.parse(JSON.stringify(tc)),ax:JSON.parse(JSON.stringify(nN)),ay:JSON.parse(JSON.stringify(nN)),az:JSON.parse(JSON.stringify(nN))},generateNewLines:!0},si={sps:rv,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))},DHe={0:JSON.parse(JSON.stringify(si)),1:JSON.parse(JSON.stringify(si)),2:JSON.parse(JSON.stringify(si)),3:JSON.parse(JSON.stringify(si)),4:JSON.parse(JSON.stringify(si)),5:JSON.parse(JSON.stringify(si)),6:JSON.parse(JSON.stringify(si)),7:JSON.parse(JSON.stringify(si)),8:JSON.parse(JSON.stringify(si)),9:JSON.parse(JSON.stringify(si)),10:JSON.parse(JSON.stringify(si)),11:JSON.parse(JSON.stringify(si)),12:JSON.parse(JSON.stringify(si)),13:JSON.parse(JSON.stringify(si)),14:JSON.parse(JSON.stringify(si)),15:JSON.parse(JSON.stringify(si))};function KOe(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let i=0;i<128;i++){let a=i*3+1;r[i]=Qe.bytesToInt24(t[a],t[a+1],t[a+2])}let n=385;return r.ax=Qe.bytesToInt16(t[n],t[n+1]),r.ay=Qe.bytesToInt16(t[n+2],t[n+3]),r.az=Qe.bytesToInt16(t[n+4],t[n+5]),r.gx=Qe.bytesToInt16(t[n+6],t[n+7]),r.gy=Qe.bytesToInt16(t[n+8],t[n+9]),r.gz=Qe.bytesToInt16(t[n+10],t[n+11]),r.timestamp=Date.now(),r}var ic=250,XOe={deviceType:"USB",deviceName:"freeeeg128",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:KOe,sps:ic,buffering:{searchBytes:new Uint8Array([192,160])}},ZOe={lines:{ax:{nSec:10,sps:ic},ay:{nSec:10,sps:ic},az:{nSec:10,sps:ic},gx:{nSec:10,sps:ic},gy:{nSec:10,sps:ic},gz:{nSec:10,sps:ic}}},QOe={};for(let e=0;e<128;e++)ZOe.lines[e]={sps:ic,nSec:10,units:"mV"},QOe[e]={sps:250,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))};function BY(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let i=0;i<32;i++){let a=i*3+1;r[i]=Qe.bytesToInt24(t[a],t[a+1],t[a+2])}let n=97;return r.ax=Qe.bytesToInt16(t[n],t[n+1]),r.ay=Qe.bytesToInt16(t[n+2],t[n+3]),r.az=Qe.bytesToInt16(t[n+4],t[n+5]),r.gx=Qe.bytesToInt16(t[n+6],t[n+7]),r.gy=Qe.bytesToInt16(t[n+8],t[n+9]),r.gz=Qe.bytesToInt16(t[n+10],t[n+11]),r.timestamp=Date.now(),r}var Qm=512,eAe={deviceType:"USB",deviceName:"freeeeg32",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:BY,sps:Qm,buffering:{searchBytes:new Uint8Array([192,160])}},tAe={deviceType:"USB",deviceName:"freeeeg32_optical",baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:BY,sps:Qm,buffering:{searchBytes:new Uint8Array([192,160])}},Up={nSec:10,sps:Qm},rAe={lines:{ax:JSON.parse(JSON.stringify(Up)),ay:JSON.parse(JSON.stringify(Up)),az:JSON.parse(JSON.stringify(Up)),gx:JSON.parse(JSON.stringify(Up)),gy:JSON.parse(JSON.stringify(Up)),gz:JSON.parse(JSON.stringify(Up))}},nAe={};for(let e=0;e<32;e++)rAe.lines[e]={sps:Qm,nSec:10,units:"mV"},nAe[e]={sps:Qm,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))};function iAe(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let i=0;i<16;i++){let a=i*3+1;r[i]=Qe.bytesToInt24(t[a],t[a+1],t[a+2])}let n=16*3+1;return r.ax=Qe.bytesToInt16(t[n],t[n+1]),r.ay=Qe.bytesToInt16(t[n+2],t[n+3]),r.az=Qe.bytesToInt16(t[n+4],t[n+5]),r.gx=Qe.bytesToInt16(t[n+6],t[n+7]),r.gy=Qe.bytesToInt16(t[n+8],t[n+9]),r.gz=Qe.bytesToInt16(t[n+10],t[n+11]),r.timestamp=Date.now(),r}var v1=[],gY,zp;function aAe(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e),v1.push(...e);let r=new Uint8Array([192,160]),n=v1,i=Qe.boyerMoore(r),a=i.byteLength,o=-1,s=zp??0,l=!1;for(var c=i(n);c!==-1;c=i(n,c+a))if(!gY&&typeof zp!="number")s=zp=c;else if(o=c,o>=0){let f=o-s;if(zp){if(f>0){let u=v1.splice(zp,f);t=new Uint8Array(u.slice(r.length)),l=!0}}else{let u=v1.splice(zp,f);t=new Uint8Array(u.slice(r.length)),l=!0,gY=!0}s=o}if(l){let f={};for(let h=0;h<16;h++){let g=h*3+1;f[h]=Qe.bytesToInt24(t[g],t[g+1],t[g+2])}let u=16*3+1;return f.ax=Qe.bytesToInt16(t[u],t[u+1]),f.ay=Qe.bytesToInt16(t[u+2],t[u+3]),f.az=Qe.bytesToInt16(t[u+4],t[u+5]),f.gx=Qe.bytesToInt16(t[u+6],t[u+7]),f.gy=Qe.bytesToInt16(t[u+8],t[u+9]),f.gz=Qe.bytesToInt16(t[u+10],t[u+11]),f.timestamp=Date.now(),f}else return}var tv=250,oAe={deviceType:"BLE",deviceName:"freeeeg16",services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:void 0},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:!0,notifyCallback:void 0,codec:aAe,sps:tv}}}},sAe={deviceType:"USB",deviceName:"freeeeg16",baudRate:115200,bufferSize:2e3,frequency:3.5,codec:iAe,sps:tv,buffering:{searchBytes:new Uint8Array([192,160])}},qp={nSec:10,sps:tv},lAe={lines:{ax:JSON.parse(JSON.stringify(qp)),ay:JSON.parse(JSON.stringify(qp)),az:JSON.parse(JSON.stringify(qp)),gx:JSON.parse(JSON.stringify(qp)),gy:JSON.parse(JSON.stringify(qp)),gz:JSON.parse(JSON.stringify(qp))}},cAe={},uAe=32,fAe=24,dAe=1.2;for(let e=0;e<16;e++)lAe.lines[e]={sps:tv,nSec:10,units:"mV"},cAe[e]={sps:tv,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:.96*1e3*dAe/(uAe*(Math.pow(2,fAe)-1))};var pAe=new TextDecoder;function RY(e){let t={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0},r=pAe.decode(e),n=r.split("|");if(n.length===3)t.timestamp=Date.now(),t.red=parseInt(n[0]),t.infrared=parseInt(n[1]),t.heg=parseFloat(n[2]);else return n.length>=2?(t.timestamp=Date.now(),t.red=parseInt(n[1]),t.infrared=parseInt(n[2]),t.heg=parseFloat(n[3]),n[4]&&(t.ambient=parseFloat(n[4])),n[5]&&(t.temperature=parseFloat(n[5])),t):r}var gN=40,SN={deviceType:"USB",deviceName:"hegduino",baudRate:115200,write:`t
`,codec:RY,sps:gN},MY=Object.assign({},SN);MY.sps=19;var hAe={deviceType:"BLE",deviceName:"hegduino",sps:gN,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:!0,notifyCallback:void 0,codec:RY,sps:gN}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:!0,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0}}},androidWebBLE:"o"},jY=Object.assign({},SN);jY.sps=19;function F1(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r=32,n={red:new Array(r),ir:new Array(r),max_dietemp:Qe.get2sCompliment(t[193],8)+.0625*t[194],timestamp:Date.now()},i=0;for(;i<r;){let a=i*6;i%2===0?(n.ir[i]=(t[a+1]<<16|t[a+2]<<8|t[a+3])&524287,n.ir[i+1]=(t[a+4]<<16|t[a+5]<<8|t[a+6])&524287):(n.red[i-1]=(t[a+1]<<16|t[a+2]<<8|t[a+3])&524287,n.red[i]=(t[a+4]<<16|t[a+5]<<8|t[a+6])&524287),i++}return n}function D1(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={ax:new Array(20),ay:new Array(20),az:new Array(20),gx:new Array(20),gy:new Array(20),gz:new Array(20),mpu_dietemp:(Qe.bytesToInt16(t[241],t[242])+521)/340+35,timestamp:Date.now()};for(let n=0;n<20;n++){let i=n*12;r.ax[n]=Qe.bytesToInt16(t[i+1],t[i+2]),r.ay[n]=Qe.bytesToInt16(t[i+3],t[i+4]),r.az[n]=Qe.bytesToInt16(t[i+5],t[i+6]),r.gx[n]=Qe.bytesToInt16(t[i+7],t[i+8]),r.gy[n]=Qe.bytesToInt16(t[i+9],t[i+10]),r.gz[n]=Qe.bytesToInt16(t[i+11],t[i+12])}return r}function gAe(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let n=0;n<7;n++){let i=n*26+1;if(!t[i+23])break;r[0][n]=Qe.bytesToUInt24(t[i],t[i+1],t[i+2]),r[1][n]=Qe.bytesToUInt24(t[i+3],t[i+4],t[i+5]),r[2][n]=Qe.bytesToUInt24(t[i+6],t[i+7],t[i+8]),r[3][n]=Qe.bytesToUInt24(t[i+9],t[i+10],t[i+11]),r[4][n]=Qe.bytesToUInt24(t[i+12],t[i+13],t[i+14]),r[5][n]=Qe.bytesToUInt24(t[i+15],t[i+16],t[i+17]),r[6][n]=Qe.bytesToUInt24(t[i+18],t[i+19],t[i+20]),r[7][n]=Qe.bytesToUInt24(t[i+21],t[i+22],t[i+23])}return r}var N1=250,yAe={deviceType:"BLE",deviceName:"cognixionONE",services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:!0,notifyCallback:void 0,codec:gAe,sps:N1}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:!0}}},sps:N1},$Y=Object.assign({},hN);$Y.sps=N1;$Y.deviceName="cognixionONE";var rc={nSec:10,sps:N1,units:"mV"},BHe={lines:{0:JSON.parse(JSON.stringify(rc)),1:JSON.parse(JSON.stringify(rc)),2:JSON.parse(JSON.stringify(rc)),3:JSON.parse(JSON.stringify(rc)),4:JSON.parse(JSON.stringify(rc)),5:JSON.parse(JSON.stringify(rc)),6:JSON.parse(JSON.stringify(rc)),7:JSON.parse(JSON.stringify(rc))}};var ho={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function mAe(e){let t={},r=0;for(;r<e.length;)if(ho[e[r]]&&r+1+ho[e[r]].byteLength<=e.length){let n=e.slice(r+1,r+1+ho[e[r]].byteLength).buffer,i=Qe.struct(ho[e[r]].format).unpack(n),a=ho[e[r]].type;a==="unfilteredHEG"||a==="heg"?i=i[0]/256:(a==="POOR_SIGNAL"||a==="sampleNumber"||a==="debug0"||a==="debug1"||a==="debug2"||a==="debug3")&&(i=i[0]),t[ho[e[r]].type]?Array.isArray(i)?t[ho[e[r]].type].push(...i):t[ho[e[r]].type].push(i):Array.isArray(i)?t[ho[e[r]].type]=i:t[ho[e[r]].type]=[i],r+=ho[e[r]].byteLength+1}else r++;return t.timestamp=Date.now(),t}var vAe={deviceType:"USB",deviceName:"peanut",baudRate:38400,bufferSize:400,write:`protocol 3
`,buffering:{searchBytes:new Uint8Array([170,170])},codec:mAe,sps:10.101};var bAe=1013.25,B1=e=>{let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={timestamp:Date.now(),temp:[],pressure:[],altitude:[]},n=0;if(t[0].length===74&&(n=1),n){r.humidity=[];for(let i=0;i<3;i++){let a=i*24+2,o=Qe.bytesToInt32(t[3+a],t[2+a],t[1+a],t[0+a]),s=Qe.bytesToInt32(t[7+a],t[6+a],t[5+a],t[4+a]);r.temp.push(o+s/Math.pow(10,Math.ceil(Math.log10(s))));let l=10*Qe.bytesToInt32(t[11+a],t[10+a],t[9+a],t[8+a]),c=Qe.bytesToInt32(t[15+a],t[14+a],t[13+a],t[12+a]);r.pressure.push(l+c/Math.pow(10,Math.ceil(Math.log10(c))));let f=Qe.bytesToInt32(t[19+a],t[18+a],t[17+a],t[16+a]),u=Qe.bytesToInt32(t[23+a],t[22+a],t[21+a],t[20+a]);r.humidity.push(f+u/Math.pow(10,Math.ceil(Math.log10(u)))),r.altitude.push(yY(r.pressure[i],r.temp[i]))}}else for(let i=0;i<3;i++){let a=i*16+2,o=Qe.bytesToInt32(t[3+a],t[2+a],t[1+a],t[0+a]),s=Qe.bytesToInt32(t[7+a],t[6+a],t[5+a],t[4+a]);r.temp.push(o+s/Math.pow(10,Math.ceil(Math.log10(s))));let l=10*Qe.bytesToInt32(t[11+a],t[10+a],t[9+a],t[8+a]),c=Qe.bytesToInt32(t[15+a],t[14+a],t[13+a],t[12+a]);r.pressure.push(l+c/Math.pow(10,Math.ceil(Math.log10(c)))),r.altitude.push(yY(r.pressure[i],r.temp[i]))}return r};function yY(e,t){return 44330*(1-Math.pow(e/bAe,.1903))}function _Ae(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};if(t[0]===2)Object.assign(r,Jp(t.subarray(2)));else if(t[0]===3){let n=Object.assign(r,Jp(t.subarray(2)));Object.keys(n).forEach((i,a)=>{r[a+8]=n[i]})}else t[0]===4?Object.assign(r,D1(t.subarray(2))):t[0]===5?Object.assign(r,F1(t.subarray(2))):t[0]===6?Object.assign(r,B1(t.subarray(2))):Object.assign(r,Object.assign(r,Jp(t.subarray(2))));return r}function wAe(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};if(t[0]===2)Object.assign(r,T1(t.subarray(2)));else if(t[0]===3){let n=Object.assign(r,Jp(t.subarray(2)));Object.keys(n).forEach((i,a)=>{r[a+8]=n[i]})}else t[0]===4?Object.assign(r,D1(t.subarray(2))):t[0]===5?Object.assign(r,F1(t.subarray(2))):t[0]===6?Object.assign(r,B1(t.subarray(2))):Object.assign(r,Object.assign(r,T1(t.subarray(2))));return r}var SAe={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:_Ae,sps:250},xAe={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:wAe,sps:250},kAe={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Jp,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:F1,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:D1,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Jp,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:B1,sps:3.33}}}},EAe={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:T1,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:F1,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:D1,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:T1,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:B1,sps:3.33}}}},nc={nSec:10,sps:250,units:"mV"},RHe={lines:{0:JSON.parse(JSON.stringify(nc)),1:JSON.parse(JSON.stringify(nc)),2:JSON.parse(JSON.stringify(nc)),3:JSON.parse(JSON.stringify(nc)),4:JSON.parse(JSON.stringify(nc)),5:JSON.parse(JSON.stringify(nc)),6:JSON.parse(JSON.stringify(nc)),7:JSON.parse(JSON.stringify(nc))},generateNewLines:!0,cleanGeneration:!1},OAe=32,AAe=24,IAe=1.2,li={sps:250,useDCBlock:!1,useBandpass:!1,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:.96*1e3*IAe/(OAe*(Math.pow(2,AAe)-1))},MHe={0:JSON.parse(JSON.stringify(li)),1:JSON.parse(JSON.stringify(li)),2:JSON.parse(JSON.stringify(li)),3:JSON.parse(JSON.stringify(li)),4:JSON.parse(JSON.stringify(li)),5:JSON.parse(JSON.stringify(li)),6:JSON.parse(JSON.stringify(li)),7:JSON.parse(JSON.stringify(li)),8:JSON.parse(JSON.stringify(li)),9:JSON.parse(JSON.stringify(li)),10:JSON.parse(JSON.stringify(li)),11:JSON.parse(JSON.stringify(li)),12:JSON.parse(JSON.stringify(li)),13:JSON.parse(JSON.stringify(li)),14:JSON.parse(JSON.stringify(li)),15:JSON.parse(JSON.stringify(li))},CAe=new TextDecoder;function UY(e){let t={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0},r=CAe.decode(e),n=r.split("|");return n.length>=5?(t.timestamp=Date.now(),t.left_red=parseInt(n[1]),t.left_infrared=parseInt(n[2]),t.left_heg=parseFloat(n[3]),t.center_red=parseInt(n[4]),t.center_infrared=parseInt(n[5]),t.center_heg=parseFloat(n[6]),t.right_red=parseInt(n[7]),t.right_infrared=parseInt(n[8]),t.right_heg=parseFloat(n[9]),t):r}var TAe={deviceType:"USB",deviceName:"statechanger",baudRate:115200,codec:UY,sps:20},NAe={deviceType:"BLE",deviceName:"statechanger",sps:20,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:!0,notifyCallback:void 0,codec:UY}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:!0,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0}}},androidWebBLE:"o"};function LAe(e){let t={red:e.getInt32(2),ir:e.getInt32(6),ir2:e.getInt32(10),timestamp:Date.now()};return t.heg=t.red/(.5*(t.ir+t.ir2)),t}var mY=40,PAe={deviceType:"BLE",deviceName:"blueberry",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:!0,notifyCallback:void 0,codec:LAe,sps:mY}}},sps:mY};function FAe(e){let t={sred:e.getInt32(2),sir:e.getInt32(6),sir2:e.getInt32(10),timestamp:Date.now()};return t.sheg=t.sred/(.5*(t.sir+t.sir2)),t}function DAe(e){let t={red:e.getInt32(2),ir:e.getInt32(6),ir2:e.getInt32(10),timestamp:Date.now()};return t.heg=t.sred/(.5*(t.ir+t.ir2)),t}var iN=40,BAe={deviceType:"BLE",deviceName:"blueberry2",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:!0,notifyCallback:void 0,codec:DAe,sps:iN},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:!0,notifyCallback:void 0,codec:FAe,sps:iN}}},sps:iN};function RAe(e){return{hr:e.getInt8(1),timestamp:Date.now()}}var MAe={deviceType:"BLE",deviceName:"heartrate",services:{heart_rate:{heart_rate_measurement:{notify:!0,notifyCallback:void 0,codec:RAe}}}},zY={sps:250,deviceType:"CUSTOM",deviceName:"simulator",simulate:{0:{sps:250,freq:1,amplitude:1,offset:0},1:{sps:250,freq:10,amplitude:1,offset:0},2:{sps:250,freq:100,amplitude:.5,offset:.5},3:{sps:250,freq:25,amplitude:1,offset:0}},connect:(e={})=>new Promise(async(t,r)=>{let i={_id:`simulated${Math.floor(Math.random()*1e15)}`,settings:Object.assign(Object.assign({},zY),e)};i.settings.looping=!0;let a=50,o=Date.now(),s=()=>{if(i.settings.looping){let l={},c=Date.now(),f=c-o;for(let u in i.settings.simulate){let h=Math.floor(i.settings.simulate[u].sps*f/1e3);l[u]=new Array(h).fill(0),l[u]=l[u].map((g,_)=>Math.sin(2*Math.PI*i.settings.simulate[u].freq*.001*(o+f*(_+1)/h))*i.settings.simulate[u].amplitude+i.settings.simulate[u].offset)}o=c,l.timestamp=o,i.settings.ondata(l),setTimeout(()=>{s()},a)}};s(),i.settings.onconnect&&i.settings.onconnect(i),t(i)}),codec:e=>e,disconnect:e=>{console.log(e),e.settings.looping=!1,e.settings.ondisconnect(e)},onconnect:e=>{console.log("simulator connected!",e)},ondisconnect:e=>{console.log("simulator disconnected!",e)},ondata:e=>{}};var b1={sps:250,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45},jHe={0:JSON.parse(JSON.stringify(b1)),1:JSON.parse(JSON.stringify(b1)),2:JSON.parse(JSON.stringify(b1)),3:JSON.parse(JSON.stringify(b1))},_1={nSec:10,sps:250,units:"mV"},$He={lines:{0:JSON.parse(JSON.stringify(_1)),1:JSON.parse(JSON.stringify(_1)),2:JSON.parse(JSON.stringify(_1)),3:JSON.parse(JSON.stringify(_1)),ax:{nSec:10,sps:250,units:"mg"},ay:{nSec:10,sps:250,units:"mg"},az:{nSec:10,sps:250,units:"mg"}},generateNewLines:!0},Ym={sps:250,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45},UHe={0:JSON.parse(JSON.stringify(Ym)),1:JSON.parse(JSON.stringify(Ym)),2:JSON.parse(JSON.stringify(Ym)),3:JSON.parse(JSON.stringify(Ym)),4:JSON.parse(JSON.stringify(Ym))};var zu={BLE:{nrf5x:kAe,nrf5x_singleended:EAe,hegduino:hAe,hegduinoV1:jY,cognixionONE:yAe,statechanger:NAe,blueberry:PAe,blueberry2:BAe,heart_rate:MAe,freeEEG16:oAe},USB:{nrf5x:SAe,nrf5x_singleended:xAe,freeEEG16:sAe,freeEEG32:eAe,freeEEG32_optical:tAe,freeEEG128:XOe,hegduino:SN,hegduinoV1:MY,cyton:hN,cyton_daisy:YOe,peanut:vAe,statechanger:TAe,cognixionONE:hN},BLE_CUSTOM:{},USB_CUSTOM:{},CUSTOM:{simulator:zY}};var zHe=new TextDecoder;var Vp=new A1,sc=new xOe({roots:{...FOe,..._Oe}});function R1(e,t){if(!e)return;t||(t={ondecoded:a=>{console.log(a)}});let r=e.deviceType,n=e.deviceName;t.workerUrl||(t.workerUrl=ROe),t.service||(t.service=sc);let i=t.service.addWorker({url:t.workerUrl});if(t.devices||(t.devices=zu),!t.devices[r][n]){let a=Object.assign({},e);for(let o in a)typeof a[o]=="function"&&(a[o]=a[o].toString());i.post("receiveDevice",a)}if(t.filterSettings&&i.post("setFilters",[t.filterSettings]),t.roots){for(let a in t.roots){let o={callback:"decodeAndParseDevice",worker:i};t.roots[a].__parent=t.roots[a].__parent?Object.assign(t.roots[a].__parent,o):o}t.service.load(t.roots)}if(r.includes("CUSTOM"))return new Promise(async(a,o)=>{e.ondata=c=>{t.ondata&&t.ondata(c),typeof t.ondecoded=="function"&&i.run("decodeAndParseDevice",[c,r,n]).then(f=>{t.ondecoded(f)})},e.ondisconnect=()=>{if(t.service.terminate(i._id),t.roots)for(let c in t.roots)t.service.remove(c)};let s=await e.connect(e),l={workers:{streamworker:i},disconnect:()=>{if(t.beforedisconnect&&t.beforedisconnect(l),e.disconnect(s),t.ondisconnect&&t.ondisconnect(l),t.roots)for(let c in t.roots)t.service.remove(c)},device:s,options:t,read:c=>{if(e.read)return new Promise((f,u)=>{f(e.read(e,c))})},write:c=>{if(e.write)return new Promise((f,u)=>{f(e.write(e,c))})},setFilters:(c,f)=>i.run("setFilters",[c,f]),roots:t.roots};t.onconnect&&t.onconnect(l),a(l)}).catch(a=>{if(console.error(a),t.service.terminate(i._id),t.roots)for(let o in t.roots)t.service.remove(o)});if(r==="BLE"){for(let a in e.services)for(let o in e.services[a])if(typeof t.ondecoded=="function"){if(e.services?.[a]?.[o]?.notify){e.services[a][o].notifyCallback||(e.services[a][o].notifyCallback=s=>{t.ondata&&t.ondata(s),i.run("decodeAndParseDevice",[s,r,n,a,o],void 0,[s.buffer]).then(t.ondecoded)});break}}else typeof t.ondecoded=="object"?t.ondecoded[o]&&(e.services?.[a]?.[o]?.notify&&(e.services[a][o].notifyCallback||(e.services[a][o].notifyCallback=s=>{t.ondata&&t.ondata(s),i.run("decodeAndParseDevice",[s,r,n,a,o],void 0,[s.buffer]).then(t.ondecoded[o])})),e.services?.[a]?.[o]?.read&&(e.services[a][o].readCallback||(e.services[o].readCallback=s=>{t.ondata&&t.ondata(s),i.run("decodeAndParseDevice",[s,r,n,a,o],void 0,[s.buffer]).then(t.ondecoded[o])}))):t.ondata&&(e.services?.[a]?.[o]?.notify&&(e.services[a][o].notifyCallback=t.ondata),e.services?.[a]?.[o]?.read&&(e.services[o].readCallback=t.ondata));return new Promise((a,o)=>{Vp.setup(e).then(s=>{let l={workers:{streamworker:i},options:t,device:s,subscribe:(c,f,u,h)=>Vp.subscribe(s.device,c,f,g=>{h?u?u(g):t.ondecoded?.[f]?t.ondecoded[f](g):typeof t.ondecoded=="function"&&t.ondecoded(g):i.run("decodeAndParseDevice",[g,r,n,c,f],void 0,[g.buffer]).then(u||(t.ondecoded?.[f]?t.ondecoded[f]:t.ondecoded))}),unsubscribe:(c,f)=>Vp.unsubscribe(s.device,c,f),disconnect:async()=>{if(await Vp.disconnect(s.deviceId),t.ondisconnect&&t.ondisconnect(l),i.terminate(),t.roots)for(let c in t.roots)t.service.remove(c)},read:c=>Vp.read(s.device,c.service,c.characteristic,c.ondata,c.timeout),write:c=>Vp.write(s.device,c.service,c.characteristic,c.data,c.callback,c.timeout),setFilters:(c,f)=>i.run("setFilters",[c,f]),roots:t.roots};t.onconnect&&t.onconnect(l),a(l)}).catch(s=>{if(console.error(s),i.terminate(),t.roots)for(let l in t.roots)t.service.remove(l);o(s)})})}else if(r==="USB"){let a=t.service.addWorker({url:t.workerUrl});a.worker.addEventListener("message",l=>{if(typeof l.data=="string"){if(l.data.includes("disconnected")&&(t.service.terminate(a._id),t.service.terminate(i._id),t.roots))for(let c in t.roots)t.service.remove(c)}else typeof t.ondata=="function"&&t.ondata(l.data)}),a.post("setupSerial");let o=t.service.establishMessageChannel(i.worker,a.worker),s=new Xm;return new Promise((l,c)=>{let f=h=>{if(console.error(h),t.service.terminate(a._id),t.service.terminate(i._id),t.roots)for(let g in t.roots)t.service.remove(g);c(h)},u=h=>{let g;h?g=h.getInfo():g={usbVendorId:e.usbVendorId,usbProductId:e.usbProductId},a.run("openPort",{baudRate:e.baudRate,usbVendorId:g.usbVendorId,usbProductId:g.usbProductId,bufferSize:e.bufferSize,buffering:e.buffering?e.buffering:void 0,frequency:e.frequency?e.frequency:void 0,pipeTo:{route:"decodeAndParseDevice",_id:o,extraArgs:[r,n]},pipeMain:t.ondata!==void 0}).then(_=>{e.write&&a.post("writeStream",[_._id,e.write]),typeof t.ondecoded=="function"&&i.subscribe("decodeAndParseDevice",E=>{t.ondecoded&&t.ondecoded(E)});let w={workers:{streamworker:i,serialworker:a},device:_,options:t,subscribeStream:E=>i.subscribe("decodeAndParseDevice",E),unsubscribeStream:E=>i.unsubscribe("decodeAndParseDevice",E),disconnect:()=>{a.post("closeStream",_._id),t.ondisconnect&&t.ondisconnect(w)},read:()=>new Promise((E,S)=>{let A;A=i.subscribe("decodeAndParseDevice",O=>{a.unsubscribe("decodeAndParseDevice",A),E(O)})}),write:E=>a.run("writeStream",[_._id,E]),setFilters:(E,S)=>i.run("setFilters",[E,S]),roots:t.roots};t.onconnect&&t.onconnect(w),l(w)}).catch(f)};t.reconnect?u():s.requestPort(e.usbVendorId,e.usbProductId).then(h=>{u(h)}).catch(f)})}else return}var xN=null,M1={BLE:{hegduino:"HEGduino",hegduinoV1:"HEGduino V1",statechanger:"Statechanger",blueberry2:"Blueberry",blueberry:"Blueberry V1",nrf5x:"NRF5x"},USB:{hegduino:"HEGduino",hegduinoV1:"HEGduino V1",peanut:"Biocomp Peanut",statechanger:"Statechanger",nrf5x:"NRF5x"}},VY=async(e,t)=>{if(xN)throw new Error("Already connected to a device");let r=await R1(zu[e][t],{ondecoded:n=>{qf({decoded:n})},ondisconnect:()=>{xN=null,qf({status:"disconnected"})},onconnect:n=>{xN=n,qf({status:"connected"})}});return qf({device:r}),r},qY=1e3*60*60,kN;jc("decoded.heg",({value:e})=>{kN||(kN=Date.now());let t=Date.now()-kN,r=(qY-t)/qY;qf({focus:(100*e).toFixed(2),mentalfatigue:(100*(1-r)).toFixed(1),cognitiveload:(100*(1/e)/5).toFixed(2)})});var HY=oe(He(),1),Ma=oe(mt(),1);function EN({name:e="Dummy Chart",state:t,data:r=[],stroke:n="#8884d8",maxLength:i=200}){let[a,o]=(0,HY.useState)(r),s=jc(t,l=>{Ag(t,s),Array.isArray(l.value)?l.value.forEach(f=>a.push({timestamp:Date.now(),[t]:f})):a.push({timestamp:Date.now(),[t]:l.value});let c=[...a];c.length>i?o(c.slice(-i)):o(c)});return(0,Ma.jsx)(Ma.Fragment,{children:(0,Ma.jsx)("div",{className:"flex justify-center w-full",children:(0,Ma.jsxs)("div",{children:[(0,Ma.jsx)("span",{className:"block font-semibold text-xl w-full text-center p-2",children:e}),(0,Ma.jsxs)(ET,{width:730,height:250,data:a,children:[(0,Ma.jsx)(fm,{strokeDasharray:"3 3"}),(0,Ma.jsx)(lo,{}),(0,Ma.jsx)(Hl,{type:"monotone",dataKey:t,isAnimationActive:!1,stroke:n,dot:!1})]})]})})})}var WY=oe(He(),1);var Gp=class extends WY.Component{constructor(r={state:wt}){super(r);dr(this,"statemgr",wt);dr(this,"state_subs",{});dr(this,"UPDATED",[]);dr(this,"unique",`component${Math.floor(Math.random()*1e15)}`);dr(this,"react_setState",this.setState.bind(this));r.state&&(this.statemgr=r.state),this.setState=n=>{this.UPDATED=Object.keys(n),this.react_setState(n),typeof n=="object"&&wt.setState(n)},setTimeout(()=>{let n={};for(let i in this.state)r?.doNotSubscribe&&r.doNotSubscribe.indexOf(i)>-1||(i in this.statemgr.data&&(n[i]=this.statemgr.data[i]),this.state_subs[i]=this.__subscribeComponent(i));Object.keys(n).length>0&&this.react_setState(n)},.001)}__subscribeComponent(r,n){let i=this.statemgr.subscribeEvent(r,a=>{if(typeof this>"u")this.statemgr.unsubscribeEvent(r,i);else{n&&n(a);let s=this.UPDATED.indexOf(r);s>-1?this.UPDATED.splice(s,1):this.react_setState({[r]:a})}});return i}__unsubscribeComponent(r){if(!r)for(let n in this.state_subs)this.statemgr.unsubscribeEvent(n,this.state_subs[n])}};var $Ae='(()=>{var __require=(x3=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(x3,{get:(a,b)=>(typeof require!=="undefined"?require:a)[b]}):x3)(function(x3){if(typeof require!=="undefined")return require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x3+\'" is not supported\')});var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __require2=(x3=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x3,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x3)(function(x3){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x3+\'" is not supported\')});var __commonJS=(cb,mod)=>function __require23(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:true}):target,mod));var __publicField=(obj,key,value)=>{__defNormalProp(obj,typeof key!=="symbol"?key+"":key,value);return value};var require_browser=__commonJS({"node_modules/web-worker/cjs/browser.js"(exports,module2){module2.exports=Worker}});var EventHandler=class{data={};triggers={};ctr=0;constructor(data){if(typeof data==="object")this.data=data}setState=updateObj=>{Object.assign(this.data,updateObj);let props=Object.getOwnPropertyNames(updateObj);for(const prop of props){this.triggerEvent(prop,this.data[prop])}if(this.triggers[statesubKey]){let run=fn=>{fn(updateObj)};const l=this.triggers[statesubKey].length;for(let i22=l-1;i22>=0;i22--){run(this.triggers[statesubKey][i22].onchange)}}return this.data};setValue=(key,value)=>{this.data[key]=value;this.triggerEvent(key,value)};triggerEvent=(key,value)=>{if(this.triggers[key]){let fn=obj=>{obj.onchange(value)};const l=this.triggers[key].length;for(let i22=l-1;i22>=0;i22--){fn(this.triggers[key][i22])}}};subscribeState=onchange=>{return this.subscribeEvent(statesubKey,onchange)};unsubscribeState=sub=>{return this.unsubscribeEvent(statesubKey,sub)};subscribeEvent=(key,onchange,refObject,refKey)=>{if(key){if(refObject&&refKey&&!this.triggers[key]){Object.defineProperty(this.data,key,{get:()=>{return refObject[refKey]},set:value=>{refObject[refKey]=value},enumerable:true,configurable:true})}if(!this.triggers[key]){this.triggers[key]=[]}let l=this.ctr;this.ctr++;this.triggers[key].push({sub:l,onchange});return l}else return void 0};unsubscribeEvent=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(sub===void 0){delete this.triggers[key];delete this.data[key]}else{let idx=void 0;let obj=triggers.find((o,i22)=>{if(o.sub===sub){idx=i22;return true}});if(obj)triggers.splice(idx,1);if(Object.keys(triggers).length===0){delete this.triggers[key];delete this.data[key]}if(this.onRemoved)this.onRemoved(obj);return true}}};subscribeEventOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeEvent(key,sub)};sub=this.subscribeEvent(key,changed);return sub};getEvent=(key,sub)=>{for(const s in this.triggers[key]){if(this.triggers[key][s].sub===sub)return this.triggers[key][s]}};getSnapshot=()=>{const snapshot={};for(const key in this.data){snapshot[key]=this.data[key]}};onRemoved};var statesubKey="*s";var state=new EventHandler;var GraphNode=class{__node={tag:`node${Math.floor(Math.random()*1e15)}`,unique:`${Math.floor(Math.random()*1e15)}`,state};__children;__parent;__operator;__listeners;__props;__args;constructor(properties,parent,graph){this.__setProperties(properties,parent,graph)}__setProperties=(properties,parent,graph)=>{let enforceProperties=()=>{let orig=properties;if(typeof properties==="function"){if(isNativeClass(properties)){properties=new properties}else properties={__operator:properties,__node:{forward:true,tag:properties.name}}}else if(typeof properties==="string"){if(graph?.get(properties)){properties=graph.get(properties)}}if(!("__node"in properties))properties.__node={};if(!properties.__node.initial)properties.__node.initial=orig};enforceProperties();if(typeof properties==="object"){let assignState=()=>{if(properties.__node?.state)this.__node.state=properties.__node.state;else if(graph){properties.__node.state=graph.__node.state}};let setProps22=()=>{if(properties.__props){if(typeof properties.__props==="function")properties.__props=new properties.__props;if(typeof properties.__props==="object"){this.__proxyObject(properties.__props)}}};let setTag=()=>{if(!properties.__node.tag){if(properties.__operator?.name)properties.__node.tag=properties.__operator.name;else properties.__node.tag=`node${Math.floor(Math.random()*1e15)}`}};let setNode=()=>{if(typeof properties.__node==="string"){if(graph?.get(properties.__node.tag)){properties=graph.get(properties.__node.tag)}else properties.__node={}}else if(!properties.__node)properties.__node={};if(graph){properties.__node.graph=graph}if(properties instanceof Graph)properties.__node.source=properties};let setParent=()=>{if(!properties.__parent&&parent)properties.__parent=parent;if(parent?.__node&&!(parent instanceof Graph||properties instanceof Graph))properties.__node.tag=parent.__node.tag+"."+properties.__node.tag;if(parent instanceof Graph&&properties instanceof Graph){if(properties.__node.loaders)Object.assign(parent.__node.loaders?parent.__node.loaders:{},properties.__node.loaders);if(parent.__node.mapGraphs){properties.__node.nodes.forEach(n=>{parent.set(properties.__node.tag+"."+n.__node.tag,n)});let ondelete=()=>{properties.__node.nodes.forEach(n=>{parent.__node.nodes.delete(properties.__node.tag+"."+n.__node.tag)})};this.__addOndisconnected(ondelete)}}};let setOp=()=>{if(typeof properties.default==="function"&&!properties.__operator){properties.__operator=properties.default}if(properties.__operator){if(typeof properties.__operator==="string"){if(graph){let n=graph.get(properties.__operator);if(n)properties.__operator=n.__operator;if(!properties.__node.tag&&properties.__operator.name)properties.__node.tag=properties.__operator.name}}if(typeof properties.__operator==="function")properties.__operator=this.__setOperator(properties.__operator);if(properties.default)properties.default=properties.__operator}};let assignProps=()=>{properties.__node=Object.assign(this.__node,properties.__node);let keys22=Object.getOwnPropertyNames(properties).filter(v2=>{if(!objProps[v2])return true});for(const key of keys22){if(key in properties)this[key]=properties[key]}};let bindCallbacks=()=>{if(this.__onconnected){if(typeof this.__onconnected==="function"){this.__onconnected=this.__onconnected.bind(this)}else if(Array.isArray(this.__onconnected)){this.__onconnected=this.__onconnected.map(f=>{return f.bind(this)})}if(typeof this.__ondisconnected==="function"){this.__ondisconnected=this.__ondisconnected.bind(this)}else if(Array.isArray(this.__ondisconnected)){this.__ondisconnected=this.__ondisconnected.map(f=>{return f.bind(this)})}}};assignState();setTag();setProps22();setNode();setParent();assignProps();bindCallbacks();setOp()}};__subscribe=(callback,key,subInput,target,tkey,args)=>{const subscribeToFunction=(k,setTarget=(callback2,target2)=>target2?target2:callback2,triggerCallback=callback)=>{let wrappedArgs;if(args){let wrapped=wrapArgs(triggerCallback,args,this.__node.graph);triggerCallback=wrapped.__callback;wrappedArgs=wrapped.__args}let sub=this.__node.state.subscribeEvent(k,triggerCallback,this,key);let trigger=this.__node.state.getEvent(k,sub);if(!this.__listeners)this.__listeners={};this.__listeners[k]=this.__node.state.triggers[k];if(!trigger)return sub;trigger.source=this.__node.tag;if(key)trigger.key=key;trigger.target=setTarget(callback,target);if(subInput)trigger.subInput=subInput;if(args){trigger.arguments=args;trigger.__args=wrappedArgs}if(tkey)trigger.tkey=tkey;trigger.node=this;trigger.graph=this.__node.graph;return sub};const subscribeToGraph=callback2=>{let fn=this.__node.graph.get(callback2);if(!fn&&callback2.includes(".")){target=callback2.substring(0,callback2.lastIndexOf("."));let n=this.__node.graph.get(callback2.substring(0,target));tkey=callback2.lastIndexOf(".")+1;if(n&&typeof n[key]==="function")callback2=(...args2)=>{return n[tkey](...args2)}}else if(fn.__operator){callback2=fn.__operator;tkey="__operator"}};if(key){if(!this.__node.localState||!this.__node.localState[key]){this.__addLocalState(this,key)}if(typeof callback==="string"){tkey=callback;if(target){if(this.__node.graph?.get(target)){let n=this.__node.graph?.get(target);if(typeof n[callback]==="function"){let fn=n[callback];callback=(...inp)=>{fn(...inp)}}else{let k2=callback;let setter=inp=>{n[k2]=inp};callback=setter}}}else if(typeof this[callback]==="function"){let fn=this[callback];callback=(...inp)=>{fn(...inp)}}else if(this.__node.graph?.get(callback))subscribeToGraph(callback);if(typeof callback!=="function")return void 0}let sub;let k=subInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node)sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)});return sub}else{if(typeof callback==="string"){if(this.__node.graph.get(callback))callback=this.__node.graph.get(callback);tkey="__operator";if(typeof callback!=="object")return void 0}let sub;let k=subInput?this.__node.unique+"input":this.__node.unique;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node){sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)})}return sub}};__unsubscribe=(sub,key,unsubInput)=>{if(key){return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key,sub)}else return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"input":this.__node.unique,sub)};__setOperator=fn=>{fn=fn.bind(this);if(this.__args&&this.__node.graph){fn=wrapArgs(fn,this.__args,this.__node.graph).__callback}let inpstr=`${this.__node.unique}input`;this.__operator=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[this.__node.unique]){if(typeof result?.then==="function"){result.then(res=>{if(res!==void 0)this.__node.state.setValue(this.__node.unique,res)}).catch(console.error)}else if(result!==void 0)this.__node.state.setValue(this.__node.unique,result)}return result};if(this.__parent instanceof GraphNode&&!this.__subscribedToParent){if(this.__parent.__operator){let sub=this.__parent.__subscribe(this);let ondelete=()=>{this.__parent?.__unsubscribe(sub);delete this.__subscribedToParent};this.__addOndisconnected(ondelete);this.__subscribedToParent=true}}return this.__operator};__addLocalState=(props,key)=>{if(!props)return;if(!this.__node.localState){this.__node.localState={}}const localState=this.__node.localState;const initState=(props2,k)=>{let str4=this.__node.unique+"."+k;let inpstr=`${str4}input`;let get,set;let obj,descriptor;if(typeof props2[k]==="function"&&k!=="__operator"){if(this.__props?.[k]){obj=this.__props}else{obj=localState}get=()=>{return obj[k]};set=fn=>{if(!this.__props?.[k])fn=fn.bind(this);obj[k]=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[str4]){if(typeof result?.then==="function"){result.then(res=>{this.__node.state.triggerEvent(str4,res)}).catch(console.error)}else this.__node.state.triggerEvent(str4,result)}return result}};localState[k]=props2[k].bind(this);descriptor={get,set,enumerable:true,configurable:true}}else{let get2,set2;let obj2;if(this.__props?.[k]){obj2=this.__props}else{obj2=localState}get2=()=>{return obj2[k]};set2=v2=>{obj2[k]=v2;if(this.__node.state.triggers[str4])this.__node.state.triggerEvent(str4,v2)};localState[k]=props2[k];descriptor={get:get2,set:set2,enumerable:true,configurable:true}}Object.defineProperty(props2,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}};if(key)initState(props,key);else{for(let k in props){initState(props,k)}}};__proxyObject=obj=>{const allProps=getAllProperties(obj);for(const k of allProps){const descriptor={get:()=>{return obj[k]},set:value=>{obj[k]=value},enumerable:true,configurable:true};Object.defineProperty(this,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}}};__addOnconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__onconnected)){this.__onconnected.push(callback)}else if(typeof this.__onconnected==="function"){this.__onconnected=[callback,this.__onconnected]}else this.__onconnected=callback}__addOndisconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__ondisconnected)){this.__ondisconnected.push(callback)}else if(typeof this.__ondisconnected==="function"){this.__ondisconnected=[callback,this.__ondisconnected]}else this.__ondisconnected=callback}__callConnected(node=this){if(typeof this.__onconnected==="function"){this.__onconnected(this)}else if(Array.isArray(this.__onconnected)){let fn=o=>{o(this)};this.__onconnected.forEach(fn)}}__callDisconnected(node=this){if(typeof this.__ondisconnected==="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let fn=o=>{o(this)};this.__ondisconnected.forEach(fn)}}};var Graph=class{__node={tag:`graph${Math.floor(Math.random()*1e15)}`,unique:`${Math.random()}`,nodes:new Map,state,roots:{}};constructor(options){this.init(options)}init=options=>{if(options){let cpy=Object.assign({},options);delete cpy.roots;recursivelyAssign(this.__node,cpy);if(options.roots)this.load(options.roots)}};load=roots=>{function recursivelyAssignChildren(target,obj,inChildren=true,top=true){if(top){if(target)Object.assign(target,obj);else target=Object.assign({},obj);recursivelyAssignChildren(target,obj,true,false)}if(obj?.__children&&!inChildren){if(obj.__children?.constructor.name==="Object"){if(target.__children?.constructor.name==="Object")recursivelyAssignChildren(target.__children,obj.__children,true,false);else target.__children=recursivelyAssignChildren({},obj.__children,true,false)}else{target.__children=obj.__children}}else if(inChildren){for(const key in obj){target[key]=Object.assign({},obj[key]);if(obj[key]?.__children){recursivelyAssignChildren({},obj[key].__children,false,false)}}}return target}this.__node.roots=recursivelyAssignChildren(this.__node.roots?this.__node.roots:{},roots);let cpy=Object.assign({},roots);if(cpy.__node)delete cpy.__node;let listeners=this.recursiveSet(cpy,this,void 0,roots);if(roots.__node){if(!roots.__node.tag)roots.__node._tag=`roots${Math.floor(Math.random()*1e15)}`;else if(!this.get(roots.__node.tag)){let node=new GraphNode(roots,this,this);this.set(node.__node.tag,node);this.runLoaders(node,this,roots,roots.__node.tag);if(node.__listeners){listeners[node.__node.tag]=node.__listeners}}}else if(roots.__listeners){this.setListeners(roots.__listeners)}this.setListeners(listeners);return cpy};setLoaders=(loaders22,replace)=>{if(replace)this.__node.loaders=loaders22;else Object.assign(this.__node.loaders,loaders22);return this.__node.loaders};runLoaders=(node,parent,properties,key)=>{for(const l in this.__node.loaders){if(typeof this.__node.loaders[l]==="object"){if(this.__node.loaders[l].init)this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key);if(this.__node.loaders[l].connected)node.__addOnconnected(this.__node.loaders[l].connect);if(this.__node.loaders[l].disconnected)node.__addOndisconnected(this.__node.loaders[l].disconnect)}else if(typeof this.__node.loaders[l]==="function")this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key)}};add=(properties,parent)=>{let listeners={};if(typeof parent==="string")parent=this.get(parent);let instanced;if(typeof properties==="function"){if(isNativeClass(properties)){if(properties.prototype instanceof GraphNode){properties=properties.prototype.constructor(properties,parent,this);instanced=true}else properties=new properties}else properties={__operator:properties}}else if(typeof properties==="string"){properties=this.__node.roots[properties]}if(!properties)return;if(!instanced){let keys22=Object.getOwnPropertyNames(properties);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(properties));keys22.push(...nonArrowFunctions);keys22=keys22.filter(v2=>!objProps.includes(v2));let cpy={};for(const key of keys22){cpy[key]=properties[key]}properties=cpy}if(!properties.__node)properties.__node={};properties.__node.initial=properties;if(typeof properties==="object"&&!this.get(properties.__node.tag)){let node;let root=recursivelyAssign({},properties,2);if(instanced)node=properties;else node=new GraphNode(properties,parent,this);this.set(node.__node.tag,node);this.runLoaders(node,parent,properties,node.__node.tag);this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key in node.__listeners){let listener=node.__listeners[key];if(node[key]){delete listeners[node.__node.tag][key];listeners[node.__node.tag][node.__node.tag+"."+key]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][key]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][key]=parent.__node.tag}}}}this.setListeners(listeners);node.__callConnected();return node}else if(properties.__node.tag)return this.get(properties.__node.tag)};recursiveSet=(t22,parent,listeners={},origin)=>{let keys22=Object.getOwnPropertyNames(origin);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(origin)).filter(v2=>!objProps.includes(v2));keys22.push(...nonArrowFunctions);for(const key of keys22){if(key.includes("__"))continue;let p2=origin[key];if(Array.isArray(p2))continue;let instanced;if(typeof p2==="function"){if(isNativeClass(p2)){p2=new p2;if(p2 instanceof GraphNode){p2=p2.prototype.constructor(p2,parent,this);instanced=true}}else p2={__operator:p2}}else if(typeof p2==="string"){if(this.__node.nodes.get(p2))p2=this.__node.nodes.get(p2);else p2=this.__node.roots[p2]}else if(typeof p2==="boolean"){if(this.__node.nodes.get(key))p2=this.__node.nodes.get(key);else p2=this.__node.roots[key]}if(p2 instanceof Object){if(!instanced&&!(p2 instanceof GraphNode)){let ks=Object.getOwnPropertyNames(p2);let nonArrowFunctions2=Object.getOwnPropertyNames(Object.getPrototypeOf(p2));nonArrowFunctions2.splice(nonArrowFunctions2.indexOf("constructor"),1);ks.push(...nonArrowFunctions2);let cpy={};for(const key2 of ks){cpy[key2]=p2[key2]}p2=cpy}if(!p2.__node)p2.__node={};if(!p2.__node.tag)p2.__node.tag=key;if(!p2.__node.initial)p2.__node.initial=t22[key];if(this.get(p2.__node.tag)&&!(!(parent instanceof Graph)&&parent?.__node)||parent?.__node&&this.get(parent.__node.tag+"."+p2.__node.tag))continue;let node;let newnode=false;let root=recursivelyAssign({},p2,2);if(instanced||p2 instanceof GraphNode){node=p2}else{node=new GraphNode(p2,parent,this);newnode=true}if(!newnode&&p2 instanceof GraphNode&&!instanced&&parent instanceof GraphNode){let sub=this.subscribe(parent.__node.tag,node.__node.tag);let ondelete=node2=>{this.unsubscribe(parent.__node.tag,sub)};node.__addOndisconnected(ondelete)}else if(node){this.set(node.__node.tag,node);this.runLoaders(node,parent,t22[key],key);t22[key]=node;this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key2 in node.__listeners){let listener=node.__listeners[key2];let k=key2;if(node[key2]){delete listeners[node.__node.tag][key2];k=node.__node.tag+"."+key2;listeners[node.__node.tag][k]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][k]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][k]=parent.__node.tag}}}}node.__callConnected()}}}return listeners};remove=(node,clearListeners=true)=>{this.unsubscribe(node);if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){this.delete(node.__node.tag);delete this.__node.roots[node.__node.tag];if(clearListeners){this.clearListeners(node)}node.__callDisconnected();const recursiveRemove=t22=>{for(const key in t22){this.unsubscribe(t22[key]);this.delete(t22[key].__node.tag);delete this.__node.roots[t22[key].__node.tag];this.delete(key);delete this.__node.roots[key];t22[key].__node.tag=t22[key].__node.tag.substring(t22[key].__node.tag.lastIndexOf(".")+1);if(clearListeners){this.clearListeners(t22[key])}t22[key].__callDisconnected();if(t22[key].__children){recursiveRemove(t22[key].__children)}}};if(node.__children){recursiveRemove(node.__children)}}if(node?.__node.tag&&node?.__parent){delete node?.__parent;node.__node.tag=node.__node.tag.substring(node.__node.tag.indexOf(".")+1)}if(node?.__node.graph)node.__node.graph=void 0;return node};run=(node,...args)=>{if(typeof node==="string"){let nd=this.get(node);if(!nd&&node.includes(".")){nd=this.get(node.substring(0,node.lastIndexOf(".")));if(typeof nd?.[node.substring(node.lastIndexOf(".")+1)]==="function")return nd[node.substring(node.lastIndexOf(".")+1)](...args)}else if(nd?.__operator)return nd.__operator(...args)}if(node?.__operator){return node?.__operator(...args)}};setListeners=listeners=>{for(const key in listeners){let node=this.get(key);if(typeof listeners[key]==="object"){for(const k in listeners[key]){let n=this.get(k);let sub;if(typeof listeners[key][k]!=="object")listeners[key][k]={__callback:listeners[key][k]};else if(!listeners[key][k].__callback){for(const kk in listeners[key][k]){if(typeof listeners[key][k][kk]!=="object"){listeners[key][k][kk]={__callback:listeners[key][k][kk]};if(node.__operator&&(listeners[key][k][kk].__callback===true||typeof listeners[key][k][kk].__callback==="undefined"))listeners[key][k][kk].__callback=node.__operator}let nn=this.get(kk);if(!nn){let tag=k.substring(0,k.lastIndexOf("."));nn=this.get(tag);if(nn){let prop=k.substring(k.lastIndexOf(".")+1);sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k][kk].__args,prop,listeners[key][k][kk].inputState,key,k)}}else{sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}if("__callback"in listeners[key][k]){if(node){if(listeners[key][k].__callback===true||typeof listeners[key][k].__callback==="undefined")listeners[key][k].__callback=node.__operator;if(typeof listeners[key][k].__callback==="function")listeners[key][k].__callback=listeners[key][k].__callback.bind(node)}if(!n){let tag=k.substring(0,k.lastIndexOf("."));n=this.get(tag);if(n){sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,k.substring(k.lastIndexOf(".")+1),listeners[key][k].inputState,key,k)}}else{sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}}}};clearListeners=(node,listener)=>{if(typeof node==="string")node=this.get(node);if(node?.__listeners){for(const key in node.__listeners){if(listener&&key!==listener)continue;if(typeof node.__listeners[key]?.sub!=="number")continue;let n=this.get(key);if(!n){n=this.get(key.substring(0,key.lastIndexOf(".")));if(n){if(typeof node.__listeners[key]==="object"&&!node.__listeners[key]?.__callback){for(const k in node.__listeners[key]){if(typeof node.__listeners[key][k]?.sub==="number"){this.unsubscribe(n,node.__listeners[key][k].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}else{if(typeof!node.__listeners[key]?.__callback==="number"){for(const k in node.__listeners[key]){if(node.__listeners[key][k]?.sub){this.unsubscribe(n,node.__listeners[key][k].sub,void 0,node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,void 0,node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}}};get=tag=>{return this.__node.nodes.get(tag)};set=(tag,node)=>{return this.__node.nodes.set(tag,node)};delete=tag=>{return this.__node.nodes.delete(tag)};getProps=(node,getInitial)=>{if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){let cpy;if(getInitial)cpy=Object.assign({},this.__node.roots[node.__node.tag]);else{cpy=Object.assign({},node);for(const key in cpy){if(key.includes("__"))delete cpy[key]}}}};subscribe=(nodeEvent,onEvent,args,key,subInput,target,bound,tkey)=>{let nd=nodeEvent;if(typeof nodeEvent==="string"){nd=this.get(nodeEvent);if(!nd&&nodeEvent.includes(".")){nd=this.get(nodeEvent.substring(0,nodeEvent.lastIndexOf(".")));key=nodeEvent.substring(nodeEvent.lastIndexOf(".")+1)}}if(target instanceof GraphNode)target=target.__node.tag;if(typeof onEvent==="string"){let setOnEventFromString=onEvent2=>{if(this.get(onEvent2)?.__operator){let node=this.get(onEvent2);target=onEvent2;onEvent2=function(...inp){return node.__operator(...inp)}}else if(onEvent2.includes(".")){target=onEvent2.substring(0,onEvent2.lastIndexOf("."));let n=this.get(target);let k=onEvent2.substring(onEvent2.lastIndexOf(".")+1);tkey=k;if(typeof n[k]==="function"){if(n[k]instanceof GraphNode)onEvent2=n[k];else onEvent2=function(...inp){return n[k](...inp)}}else{onEvent2=function(inp){n[k]=inp;return n[k]}}}return onEvent2};if(target){let node=this.get(target);if(typeof node?.[onEvent]==="function"){tkey=onEvent;onEvent=function(...inp){return node[key](...inp)}}else if(node[key]){tkey=key;if(node[key]instanceof GraphNode)onEvent=node[key];else onEvent=function(inp){node[key]=inp;return node[key]}}else{onEvent=setOnEventFromString(onEvent)}}else{onEvent=setOnEventFromString(onEvent)}}let sub;if(nd instanceof GraphNode){const doSub=()=>{sub=nd.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)nd.__unsubscribe(sub,key,subInput);sub=void 0};nd.__addOndisconnected(()=>{ondelete();nd.__addOnconnected(()=>{if(sub===void 0&&nd.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))onEvent=this.get(onEvent);if(onEvent instanceof GraphNode){onEvent.__addOndisconnected(()=>{ondelete()})}};doSub()}else if(typeof nodeEvent==="string"){let node=this.get(nodeEvent);if(node){if(onEvent instanceof GraphNode&&onEvent.__operator){const doSub=()=>{sub=node.__subscribe(onEvent.__operator,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput)};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});onEvent.__addOndisconnected(ondelete)};doSub()}else if(typeof onEvent==="function"||typeof onEvent==="string"){const doSub=()=>{sub=node.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput);sub=void 0};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))this.get(onEvent).__addOndisconnected(ondelete)};doSub()}}else{if(typeof onEvent==="string")onEvent=this.__node.nodes.get(onEvent).__operator;if(typeof onEvent==="function")sub=this.__node.state.subscribeEvent(nodeEvent,onEvent)}}return sub};unsubscribe=(node,sub,key,subInput)=>{if(node instanceof GraphNode){return node.__unsubscribe(sub,key,subInput)}else return this.get(node)?.__unsubscribe(sub,key,subInput)};setState=update=>{this.__node.state.setState(update)}};function recursivelyAssign(target,obj,maxDepth=Infinity,curDepth=0){for(const key in obj){if(obj[key]?.constructor.name==="Object"&&curDepth<maxDepth){curDepth++;if(target[key]?.constructor.name==="Object")recursivelyAssign(target[key],obj[key],maxDepth,curDepth);else target[key]=recursivelyAssign({},obj[key],maxDepth,curDepth)}else{target[key]=obj[key]}}return target}function getAllProperties(obj){var allProps=[],curr=obj;do{var props=Object.getOwnPropertyNames(curr);let fn=function(prop){if(allProps.indexOf(prop)===-1)allProps.push(prop)};props.forEach(fn)}while(curr=Object.getPrototypeOf(curr));return allProps}function isNativeClass(thing){return isFunction(thing)==="class"}function isFunction(x3){const res=typeof x3==="function"?x3.prototype?Object.getOwnPropertyDescriptor(x3,"prototype")?.writable?"function":"class":x3.constructor.name==="AsyncFunction"?"async":"arrow":"";return res}var getCallbackFromString=(a,graph)=>{if(graph.get(a)?.__operator){let node=graph.get(a);return(...inp)=>{node.__operator(...inp)}}else if(a.includes(".")){let split=a.split(".");let popped=split.pop();let joined=split.join(".");let node=graph.get(joined);if(typeof graph.get(joined)?.[popped]==="function"){return(...inp)=>{return node[popped](...inp)}}else return()=>{return node[popped]}}else if(graph.get(a)){let node=graph.get(a);return()=>{return node}}else{let arg=a;return()=>{return arg}}};var wrapArgs=(callback,argOrder,graph)=>{let args=[];let forArg=(a,i22)=>{if(a==="__output"||a==="__input"||a==="__callback"){args[i22]={__callback:inp=>{return inp},__args:void 0,idx:i22}}else if(typeof a==="string"){args[i22]={__callback:getCallbackFromString(a,graph),__args:void 0,idx:i22}}else if(typeof a==="function"){let fn2=a;args[i22]={__callback:(...inp)=>{return fn2(...inp)},__args:void 0,idx:i22}}else if(typeof a==="object"&&(a.__input||a.__callback)){let recursivelyCreateCallback=function(c){let input=c.__input?c.__input:c.__callback;if(typeof c.__input==="string"){input={__callback:getCallbackFromString(c.__input,graph),__args:void 0,idx:i22}}if(c.__args){let wrapped=wrapArgs(input,c.__args,graph);input={__callback:wrapped.__callback,__args:wrapped.__args,idx:i22}}else{input={__callback:input,__args:void 0,idx:i22}}if(c.__output){let output=c.__output;if(typeof c.__output==="string"){output={__callback:getCallbackFromString(output,graph),__args:void 0,idx:i22}}else if(typeof a.__output==="object"){output=recursivelyCreateCallback(output)}if(typeof output?.__callback==="function"){let fn2=input.__callback;let callback2=output.__callback;input={__callback:(...inp)=>{return callback2(fn2(...inp))},__args:output.__args,idx:i22}}}return input};args[i22]=recursivelyCreateCallback(a)}else{let arg=a;args[i22]={__callback:()=>{return arg},__args:void 0,idx:i22}}};argOrder.forEach(forArg);if(typeof callback==="string")callback={__callback:getCallbackFromString(callback,graph),__args:void 0};let fn=typeof callback==="function"?callback:callback.__callback;callback=function(...inp){let mapArg=arg=>{return arg.__callback(...inp)};const result=fn(...args.map(mapArg));return result};return{__callback:callback,__args:args}};var objProps=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var backprop=(node,parent,graph)=>{if(node.__node.backward&&parent instanceof GraphNode){graph.setListeners({[parent.__node.tag]:{[node.__node.tag]:parent}})}};var loop=(node,parent,graph)=>{if(node.__operator&&!node.__node.looperSet){if(typeof node.__node.delay==="number"){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{setTimeout(async()=>{res(await fn(...args))},node.__node.delay)})})}else if(node.__node.frame===true){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{requestAnimationFrame(async()=>{res(await fn(...args))})})})}if(typeof node.__node.repeat==="number"||typeof node.__node.recursive==="number"){let fn=node.__operator;node.__setOperator(async(...args)=>{let i22=node.__node.repeat?node.__node.repeat:node.__node.recursive;let result;let repeater=async(tick,...inp)=>{while(tick>0){if(node.__node.delay||node.__node.frame){fn(...inp).then(async res=>{if(node.__node.recursive){await repeater(tick,res)}else await repeater(tick,...inp)});break}else result=await fn(...args);tick--}};await repeater(i22,...args);return result})}if(node.__node.loop&&typeof node.__node.loop==="number"){node.__node.looperSet=true;let fn=node.__operator;let time=node.__node.loop;node.__setOperator((...args)=>{if(!("looping"in node.__node))node.__node.looping=true;if(node.__node.looping){let last=performance.now();fn(...args);setTimeout(()=>{let now=performance.now();let overshoot=now-last-node.__node.loop;if(overshoot>0)time=node.__node.loop-overshoot;else time=node.__node.loop;if(time<=0)time=node.__node.loop;node.__operator(...args)},time)}});if(node.__node.looping)node.__operator();let ondelete=node2=>{if(node2.__node.looping)node2.__node.looping=false};node.__addOndisconnected(ondelete)}}};var animate=(node,parent,graph)=>{if(node.__node.animate===true||node.__animation){let fn=node.__operator;node.__setOperator((...args)=>{if(!("animating"in node.__node))node.__node.animating=true;if(node.__node.animating){if(typeof node.__animation==="function")node.__animation(...args);else fn(...args);requestAnimationFrame(()=>{node.__operator(...args)})}});if(node.__node.animating||(!("animating"in node.__node)||node.__node.animating)&&node.__animation)setTimeout(()=>{requestAnimationFrame(node.__operator)},10);let ondelete=node2=>{if(node2.__node.animating)node2.__node.animating=false};node.__addOndisconnected(ondelete)}};var branching=(node,parent,graph)=>{if(typeof node.__branch==="object"&&node.__operator&&!node.__branchApplied){let fn=node.__operator;node.__branchApplied=true;node.__operator=(...args)=>{let result=fn(...args);for(const key in node.__branch){let triggered=()=>{if(typeof node.__branch[key].then==="function"){node.__branch[key].then(result)}else if(node.__branch[key].then instanceof GraphNode&&node.__branch[key].then.__operator){node.__branch[key].then.__operator(result)}else result=node.__branch[key].then};if(typeof node.__branch[key].if==="function"){if(node.__branch[key].if(result)==true){triggered()}}else if(node.__branch[key].if===result){triggered()}}return result}}if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].branch&&!node.__listeners[key].branchApplied){let fn=node.__listeners[key].callback;node.__listeners[key].branchApplied=true;node.__listeners.callback=ret=>{let triggered=()=>{if(typeof node.__listeners[key].branch.then==="function"){ret=node.__listeners[key].branch.then(ret)}else if(node.__listeners[key].branch.then instanceof GraphNode&&node.__listeners[key].branch.then.__operator){ret=node.__listeners[key].branch.then.__operator(ret)}else ret=node.__listeners[key].branch.then};if(typeof node.__listeners[key].branch.if==="function"){if(node.__listeners[key].branch.if(ret)){triggered()}}else if(node.__listeners[key].branch.if===ret){triggered()}return fn(ret)}}}}}};var triggerListenerOncreate=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].oncreate){node.__listeners[key].callback(node.__listeners[key].oncreate)}}}}};var bindListener=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].binding==="object"){node.__listeners.callback=node.__listeners.callback.bind(node.__listeners[key].binding)}}}}};var transformListenerResult=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].transform==="function"&&!node.__listeners[key].transformApplied){let fn=node.__listeners[key].callback;node.__listeners[key].transformApplied=true;node.__listeners.callback=ret=>{ret=node.__listeners[key].transform(ret);return fn(ret)}}}}}};var substitute__operator=(node,parent,graph)=>{if(node.post&&!node.__operator){node.__setOperator(node.post)}else if(!node.__operator&&typeof node.get=="function"){node.__setOperator(node.get)}if(!node.get&&node.__operator){node.get=node.__operator}if(node.aliases){node.aliases.forEach(a=>{graph.set(a,node);let ondelete=node2=>{graph.__node.nodes.delete(a)};node.__addOndisconnected(ondelete)})}if(typeof graph.__node.roots?.[node.__node.tag]==="object"&&node.get)graph.__node.roots[node.__node.tag].get=node.get};var loaders={backprop,loop,animate,branching,triggerListenerOncreate,bindListener,transformListenerResult,substitute__operator};var recursivelyStringifyFunctions=obj=>{let cpy={};for(const key in obj){if(typeof obj[key]==="object"){cpy[key]=recursivelyStringifyFunctions(obj[key])}else if(typeof obj[key]==="function"){cpy[key]=obj[key].toString()}else cpy[key]=obj[key]}return cpy};function parseFunctionFromText(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs22(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs}var stringifyFast=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p2 in value[prop]){if(Array.isArray(value[prop][p2])){if(value[prop][p2].length>20)obj[prop][p2]=value[prop][p2].slice(value[prop][p2].length-20);else obj[prop][p2]=value[prop][p2]}else{if(value[prop][p2]!=null){let con=value[prop][p2].constructor.name;if(con.includes("Set")){obj[prop][p2]=Array.from(value[prop][p2])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p2]="instanceof_"+con}else{obj[prop][p2]=value[prop][p2]}}else{obj[prop][p2]=value[prop][p2]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast22(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast}function methodstrings(node){if(typeof node.__methods==="object"){for(const key in node.__methods){let fstr=node.__methods[key];let fn=typeof fstr==="function"?fstr:parseFunctionFromText(fstr);if(key==="__operator"){node.__setOperator(fn)}else{node[key]=fn.bind(node)}}}}var Service=class extends Graph{name=`service${Math.floor(Math.random()*1e15)}`;constructor(options){super({...options,loaders:options?.loaders?Object.assign({...loaders},options.loaders):{...loaders}});if(options?.services)this.addServices(options.services);this.load(this)}addServices=services=>{for(const s in services){if(typeof services[s]==="function")services[s]=new services[s];if(services[s]?.__node?.loaders)Object.assign(this.__node.loaders,services[s].__node.loaders);if(services[s]?.__node?.nodes){services[s].__node.nodes.forEach((n,tag)=>{if(!this.get(tag)){this.set(tag,n)}else this.set(s+"."+tag,n)});this.__node.nodes.forEach((n,k)=>{if(!services[s].__node.nodes.get(k))services[s].__node.nodes.set(k,n)});let set=this.set;this.set=(tag,node)=>{services[s].set(tag,node);return set(tag,node)};let del=this.delete;this.delete=tag=>{services[s].delete(tag);return del(tag)}}else if(typeof services[s]==="object"){this.load(services[s])}}};handleMethod=(route,method,args)=>{let m=method.toLowerCase();let src=this.__node.nodes.get(route);if(!src){src=this.__node.roots[route]}if(src?.[m]){if(typeof src[m]!=="function"){if(args){if(Array.isArray(args)&&args.length===1)src[m]=args[0];else src[m]=args;return}return src[m]}else{if(Array.isArray(args))return src[m](...args);else return src[m](args)}}else return this.handleServiceMessage({route,args,method})};handleServiceMessage(message){let call;if(typeof message==="object"){if(message.route)call=message.route;else if(message.node)call=message.node}if(call){if(Array.isArray(message.args))return this.run(call,...message.args);else return this.run(call,message.args)}else return message}handleGraphNodeCall(route,args){if(!route)return args;if(args?.args){this.handleServiceMessage(args)}else if(Array.isArray(args))return this.run(route,...args);else return this.run(route,args)}transmit=(...args)=>{if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};receive=(...args)=>{if(args[0]){if(typeof args[0]==="string"){let substr=args[0].substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))args[0]=args[0].replace(/\\\\/g,"");if(args[0][0]===\'"\'){args[0]=args[0].substring(1,args[0].length-1)};args[0]=JSON.parse(args[0])}}}if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};pipe=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return this.subscribe(source,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})};pipeOnce=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return source.__node.state.subscribeEventOnce(source.__node.unique,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.__node.state.subscribeEventOnce(source.__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(source).__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})};terminate=(...args)=>{};isTypedArray=isTypedArray;recursivelyAssign=recursivelyAssign2;spliceTypedArray=spliceTypedArray;ping=()=>{console.log("pinged!");return"pong"};echo=(...args)=>{this.transmit(...args);return args};log=(...args)=>{console.log(...args);return true};error=(...args)=>{console.error(...args);return true}};function isTypedArray(x3){return ArrayBuffer.isView(x3)&&Object.prototype.toString.call(x3)!=="[object DataView]"}var recursivelyAssign2=(target,obj)=>{for(const key in obj){if(obj[key]?.constructor.name==="Object"&&!Array.isArray(obj[key])){if(target[key]?.constructor.name==="Object"&&!Array.isArray(target[key]))recursivelyAssign2(target[key],obj[key]);else target[key]=recursivelyAssign2({},obj[key])}else target[key]=obj[key]}return target};function spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let ta;if(s.length>0||e?.length>0)ta=new arr.constructor(s.length+e.length);if(ta){if(s.length>0)ta.set(s);if(e&&e.length>0)ta.set(e,s.length)}return ta}var nodeTemplates={};var remoteGraphRoutes={transferNode:(properties,connection,name2)=>{let str4;if(typeof properties==="object"){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}str4=recursivelyStringifyFunctions(properties)}else if(typeof properties==="function")str4=properties.toString();else if(typeof properties==="string")str4=properties;if(str4){if(connection.run)return connection.run("setNode",[str4]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:str4},void 0);return new Promise(r=>r(name2))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:str4}));return new Promise(r=>r(name2))}}},setNode:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function")properties={__operator:f,__node:{tag:name2?name2:f.name}};else{f=JSON.parse(properties);if(typeof f==="object")properties=f}}if(typeof properties==="object"||typeof properties==="function"){let template={};if(typeof properties==="object")Object.assign(template,properties);else template.__operator=properties;let node=this.__node.graph.add(template);if(node){nodeTemplates[node.__node.tag]=template;return node.__node?.tag}else return false}else return false},proxyRemoteNode:function(name2,connection){return new Promise((res,rej)=>{connection.run("getNodeProperties",name2).then(props=>{let proxy={};if(typeof props==="object"){for(const key in props){if(props[key]==="function"){proxy[key]=(...args)=>{return new Promise(r=>{connection.run(name2,args,key).then(r)})}}else{Object.defineProperty(proxy,key,{get:()=>{return new Promise(r=>{connection.run(name2,void 0,key).then(r)})},set:value=>{connection.post(name2,value,key)},configurable:true,enumerable:true})}}}res(proxy)})})},makeNodeTransferrable:function(properties,name2){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}const str4=recursivelyStringifyFunctions(properties);return str4},setTemplate:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function"){if(!name2)name2=f.name;properties={__operator:f,__node:{tag:name2}}}else{f=JSON.parse(properties);if(typeof f==="object"){properties=f;if(!name2&&f.__node?.tag)name2=f.__node.tag}}}if(!name2)name2=`node${Math.floor(Math.random()*1e15)}`;if(typeof properties==="object"||typeof properties==="function"){nodeTemplates[name2]=properties;return name2}else return false},loadFromTemplate:function(templateName,name2,properties){if(nodeTemplates[templateName]){let cpy=recursivelyAssign2({},nodeTemplates[templateName]);if(name2){if(!cpy.__node)cpy.__node={};cpy.__node.tag=name2}if(properties)Object.assign(cpy,properties);let node=this.__node.graph.add(cpy);return node.__node.tag}},setMethod:function(nodeTag,fn,methodKey){if(typeof fn==="string"){let f=parseFunctionFromText(fn);if(typeof f==="function")fn=f}if(!methodKey&&typeof fn==="function")methodKey=fn.name;if(this.__node.graph.get(nodeTag)){this.__node.graph.get(nodeTag)[methodKey]=fn}else this.__node.graph.add({__node:{tag:methodKey,[methodKey]:fn}});return true},assignNode:function(nodeTag,source){if(this.__node.graph.get(nodeTag)&&typeof source==="object"){Object.assign(this.__node.graph.get(nodeTag),source)}},getNodeProperties:function(nodeTag){let node=this.__node.graph.get(nodeTag);if(node){let properties=Object.getOwnPropertyNames(node);let result={};for(const key in properties){result[key]=typeof node[key]}return result}return void 0},transferClass:(classObj,connection,className)=>{if(typeof classObj==="object"){let str4=classObj.toString();let message={route:"receiveClass",args:[str4,className]};if(connection.run)return connection.run("receiveClass",[str4,className]);else if(connection.postMessage){connection.postMessage({route:"receiveClass",args:[str4,className]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"receiveClass",args:[str4,className]}));return new Promise(r=>r(name))}return message}return false},receiveClass:function(stringified,className){if(typeof stringified==="string"){if(stringified.indexOf("class")===0){let cls=(0,eval)("("+stringified+")");let name2=className;if(!name2)name2=cls.name;this.__node.graph[name2]=cls;return true}}return false},transferFunction:(fn,connection,fnName)=>{if(!fnName)fnName=fn.name;let str4=fn.toString();let message={route:"setNode",args:[str4,fnName]};if(connection.run)return connection.run("setNode",[str4,fnName]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:[str4,fnName]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:[str4,fnName]}));return new Promise(r=>r(name))}return message},setGlobal:(key,value)=>{globalThis[key]=value;return true},assignGlobalObject:(target,source)=>{if(!globalThis[target])return false;if(typeof source==="object")Object.assign(globalThis[target],source);return true},setValue:function(key,value){this.__node.graph[key]=value;return true},assignObject:function(target,source){if(!this.__node.graph[target])return false;if(typeof source==="object")Object.assign(this.__node.graph[target],source);return true},setGlobalFunction:(fn,fnName)=>{if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;globalThis[fnName]=fn;return true}return false},setGraphFunction:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.__node.graph[fnName]=fn;return true}return false}};function html(strings,...args){return function append(elm=document.createElement("div")){let template=document.createElement("template");strings.map(function(s,i22){template.innerHTML+=s;if(args[i22]instanceof HTMLElement){let dummy22=`<span id="dummyNode12345"></span>`;dummy22.id="dummyNode12345";template.innerHTML+=dummy22}else template.innerHTML+=args[i22]});let query=template.content.querySelectorAll("#dummyNode12345");let ctr=0;args.forEach((arg,i22)=>{if(arg instanceof HTMLElement){console.log(arg,query[ctr]);template.content.replaceChild(arg,query[ctr]);ctr++}});elm.appendChild(template.content);return elm}}var dummy=html``;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl.cipher.aes=function(a){this.s[0][0][0]||this.O();var b,c,d2,e,f=this.s[0][4],g=this.s[1];b=a.length;var h=1;if(4!==b&&6!==b&&8!==b)throw new sjcl.exception.invalid("invalid aes key size");this.b=[d2=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d2[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));d2[a]=d2[a-b]^c}for(b=0;a;b++,a--)c=d2[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]]};sjcl.cipher.aes.prototype={encrypt:function(a){return t(this,a,0)},decrypt:function(a){return t(this,a,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var a=this.s[0],b=this.s[1],c=a[4],d2=b[4],e,f,g,h=[],k=[],l,n,m,p2;for(e=0;256>e;e++)k[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=l||1,g=k[g]||1)for(m=g^g<<1^g<<2^g<<3^g<<4,m=m>>8^m&255^99,c[f]=m,d2[m]=f,n=h[e=h[l=h[f]]],p2=16843009*n^65537*e^257*l^16843008*f,n=257*h[m]^16843008*m,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p2=p2<<24^p2>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};function t(a,b,c){if(4!==b.length)throw new sjcl.exception.invalid("invalid aes block size");var d2=a.b[c],e=b[0]^d2[0],f=b[c?3:1]^d2[1],g=b[2]^d2[2];b=b[c?1:3]^d2[3];var h,k,l,n=d2.length/4-2,m,p2=4,r=[0,0,0,0];h=a.s[c];a=h[0];var q=h[1],v2=h[2],w=h[3],x3=h[4];for(m=0;m<n;m++)h=a[e>>>24]^q[f>>16&255]^v2[g>>8&255]^w[b&255]^d2[p2],k=a[f>>>24]^q[g>>16&255]^v2[b>>8&255]^w[e&255]^d2[p2+1],l=a[g>>>24]^q[b>>16&255]^v2[e>>8&255]^w[f&255]^d2[p2+2],b=a[b>>>24]^q[e>>16&255]^v2[f>>8&255]^w[g&255]^d2[p2+3],p2+=4,e=h,f=k,g=l;for(m=0;4>m;m++)r[c?3&-m:m]=x3[e>>>24]<<24^x3[f>>16&255]<<16^x3[g>>8&255]<<8^x3[b&255]^d2[p2++],h=e,e=f,f=g,g=b,b=h;return r}sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.$(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d2=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d2^a[b/32+1|0]>>>d2:a[b/32|0]>>>d2)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d2=sjcl.bitArray.getPartial(c);return 32===d2?a.concat(b):sjcl.bitArray.$(b,d2,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b=b&31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return false;var c=0,d2;for(d2=0;d2<a.length;d2++)c|=a[d2]^b[d2];return 0===c},$:function(a,b,c,d2){var e;e=0;for(void 0===d2&&(d2=[]);32<=b;b-=32)d2.push(c),c=0;if(0===b)return d2.concat(a);for(e=0;e<a.length;e++)d2.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d2.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d2.pop(),1));return d2},i:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&65280|(c&65280)<<8|c<<24;return a}};sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d2,e;for(d2=0;d2<c/8;d2++)0===(d2&3)&&(e=a[d2/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d2=0;for(c=0;c<a.length;c++)d2=d2<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d2),d2=0);c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d2));return b}};sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d2;a=a.replace(/\\s|0x/g,"");d2=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,4*d2)}};sjcl.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(a,b,c){var d2=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f="",g=0,h=sjcl.codec.base32.B,k=0,l=sjcl.bitArray.bitLength(a);c&&(h=sjcl.codec.base32.X);for(c=0;f.length*d2<l;)f+=h.charAt((k^a[c]>>>g)>>>e),g<d2?(k=a[c]<<d2-g,g+=e,c++):(k<<=d2,g-=d2);for(;f.length&7&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\\s|=/g,"").toUpperCase();var c=sjcl.codec.base32.BITS,d2=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f=[],g,h=0,k=sjcl.codec.base32.B,l=0,n,m="base32";b&&(k=sjcl.codec.base32.X,m="base32hex");for(g=0;g<a.length;g++){n=k.indexOf(a.charAt(g));if(0>n){if(!b)try{return sjcl.codec.base32hex.toBits(a)}catch(p2){}throw new sjcl.exception.invalid("this isn\'t "+m+"!")}h>e?(h-=e,f.push(l^n>>>h),l=n<<c-h):(h+=d2,l^=n<<c-h)}h&56&&f.push(sjcl.bitArray.partial(h&56,l,1));return f}};sjcl.codec.base32hex={fromBits:function(a,b){return sjcl.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl.codec.base32.toBits(a,1)}};sjcl.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d2="",e=0,f=sjcl.codec.base64.B,g=0,h=sjcl.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d2.length<h;)d2+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;d2.length&3&&!b;)d2+="=";return d2},toBits:function(a,b){a=a.replace(/\\s|=/g,"");var c=[],d2,e=0,f=sjcl.codec.base64.B,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d2=0;d2<a.length;d2++){h=f.indexOf(a.charAt(d2));if(0>h)throw new sjcl.exception.invalid("this isn\'t base64!");26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e)}e&56&&c.push(sjcl.bitArray.partial(e&56,g,1));return c}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}};sjcl.hash.sha256=function(a){this.b[0]||this.O();a?(this.F=a.F.slice(0),this.A=a.A.slice(0),this.l=a.l):this.reset()};sjcl.hash.sha256.hash=function(a){return new sjcl.hash.sha256().update(a).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.A=sjcl.bitArray.concat(this.A,a);b=this.l;a=this.l=b+sjcl.bitArray.bitLength(a);if(9007199254740991<a)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d2=new Uint32Array(c),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u(this,d2.subarray(16*e,16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u(this,c.splice(0,16));return this},finalize:function(){var a,b=this.A,c=this.F,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.l/4294967296));for(b.push(this.l|0);b.length;)u(this,b.splice(0,16));this.reset();return c},Y:[],b:[],O:function(){function a(a2){return 4294967296*(a2-Math.floor(a2))|0}for(var b=0,c=2,d2,e;64>b;c++){e=true;for(d2=2;d2*d2<=c;d2++)if(0===c%d2){e=false;break}e&&(8>b&&(this.Y[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}};function u(a,b){var c,d2,e,f=a.F,g=a.b,h=f[0],k=f[1],l=f[2],n=f[3],m=f[4],p2=f[5],r=f[6],q=f[7];for(c=0;64>c;c++)16>c?d2=b[c]:(d2=b[c+1&15],e=b[c+14&15],d2=b[c&15]=(d2>>>7^d2>>>18^d2>>>3^d2<<25^d2<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c&15]+b[c+9&15]|0),d2=d2+q+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(r^m&(p2^r))+g[c],q=r,r=p2,p2=m,m=n+d2|0,n=l,l=k,k=h,h=d2+(k&l^n&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+n|0;f[4]=f[4]+m|0;f[5]=f[5]+p2|0;f[6]=f[6]+r|0;f[7]=f[7]+q|0}sjcl.mode.ccm={name:"ccm",G:[],listenProgress:function(a){sjcl.mode.ccm.G.push(a)},unListenProgress:function(a){a=sjcl.mode.ccm.G.indexOf(a);-1<a&&sjcl.mode.ccm.G.splice(a,1)},fa:function(a){var b=sjcl.mode.ccm.G.slice(),c;for(c=0;c<b.length;c+=1)b[c](a)},encrypt:function(a,b,c,d2,e){var f,g=b.slice(0),h=sjcl.bitArray,k=h.bitLength(c)/8,l=h.bitLength(g)/8;e=e||64;d2=d2||[];if(7>k)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&l>>>8*f;f++);f<15-k&&(f=15-k);c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.V(a,b,c,d2,e,f);g=sjcl.mode.ccm.C(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d2,e){e=e||64;d2=d2||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/8;if(7>g)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&h>>>8*b;b++);b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));k=sjcl.mode.ccm.C(a,k,c,l,e,b);a=sjcl.mode.ccm.V(a,k.data,c,d2,e,b);if(!f.equal(k.tag,a))throw new sjcl.exception.corrupt("ccm: tag doesn\'t match");return k.data},na:function(a,b,c,d2,e,f){var g=[],h=sjcl.bitArray,k=h.i;d2=[h.partial(8,(b.length?64:0)|d2-2<<2|f-1)];d2=h.concat(d2,c);d2[3]|=e;d2=a.encrypt(d2);if(b.length)for(c=h.bitLength(b)/8,65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,b),b=0;b<g.length;b+=4)d2=a.encrypt(k(d2,g.slice(b,b+4).concat([0,0,0])));return d2},V:function(a,b,c,d2,e,f){var g=sjcl.bitArray,h=g.i;e/=8;if(e%2||4>e||16<e)throw new sjcl.exception.invalid("ccm: invalid tag length");if(4294967295<d2.length||4294967295<b.length)throw new sjcl.exception.bug("ccm: can\'t deal with 4GiB or more data");c=sjcl.mode.ccm.na(a,d2,c,e,g.bitLength(b)/8,f);for(d2=0;d2<b.length;d2+=4)c=a.encrypt(h(c,b.slice(d2,d2+4).concat([0,0,0])));return g.clamp(c,8*e)},C:function(a,b,c,d2,e,f){var g,h=sjcl.bitArray;g=h.i;var k=b.length,l=h.bitLength(b),n=k/50,m=n;c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d2=h.bitSlice(g(d2,a.encrypt(c)),0,e);if(!k)return{tag:d2,data:[]};for(g=0;g<k;g+=4)g>n&&(sjcl.mode.ccm.fa(g/k),n+=m),c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d2,data:h.clamp(b,l)}}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d2,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var g,h=sjcl.mode.ocb2.S,k=sjcl.bitArray,l=k.i,n=[0,0,0,0];c=h(a.encrypt(c));var m,p2=[];d2=d2||[];e=e||64;for(g=0;g+4<b.length;g+=4)m=b.slice(g,g+4),n=l(n,m),p2=p2.concat(l(c,a.encrypt(l(c,m)))),c=h(c);m=b.slice(g);b=k.bitLength(m);g=a.encrypt(l(c,[0,0,0,b]));m=k.clamp(l(m.concat([0,0,0]),g),b);n=l(n,l(m.concat([0,0,0]),g));n=a.encrypt(l(n,l(c,h(c))));d2.length&&(n=l(n,f?d2:sjcl.mode.ocb2.pmac(a,d2)));return p2.concat(k.concat(m,k.clamp(n,e)))},decrypt:function(a,b,c,d2,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");e=e||64;var g=sjcl.mode.ocb2.S,h=sjcl.bitArray,k=h.i,l=[0,0,0,0],n=g(a.encrypt(c)),m,p2,r=sjcl.bitArray.bitLength(b)-e,q=[];d2=d2||[];for(c=0;c+4<r/32;c+=4)m=k(n,a.decrypt(k(n,b.slice(c,c+4)))),l=k(l,m),q=q.concat(m),n=g(n);p2=r-32*c;m=a.encrypt(k(n,[0,0,0,p2]));m=k(m,h.clamp(b.slice(c),p2).concat([0,0,0]));l=k(l,m);l=a.encrypt(k(l,k(n,g(n))));d2.length&&(l=k(l,f?d2:sjcl.mode.ocb2.pmac(a,d2)));if(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))throw new sjcl.exception.corrupt("ocb: tag doesn\'t match");return q.concat(h.clamp(m,p2))},pmac:function(a,b){var c,d2=sjcl.mode.ocb2.S,e=sjcl.bitArray,f=e.i,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d2(d2(h)));for(c=0;c+4<b.length;c+=4)h=d2(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d2(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d2(f(h,d2(h))),g))},S:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d2,e){var f=b.slice(0);b=sjcl.bitArray;d2=d2||[];a=sjcl.mode.gcm.C(true,a,f,d2,c,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c,d2,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);e=e||128;d2=d2||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.C(false,a,f,d2,c,e);if(!g.equal(a.tag,b))throw new sjcl.exception.corrupt("gcm: tag doesn\'t match");return a.data},ka:function(a,b){var c,d2,e,f,g,h=sjcl.bitArray.i;e=[0,0,0,0];f=b.slice(0);for(c=0;128>c;c++){(d2=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d2=3;0<d2;d2--)f[d2]=f[d2]>>>1|(f[d2-1]&1)<<31;f[0]>>>=1;g&&(f[0]^=-520093696)}return e},j:function(a,b,c){var d2,e=c.length;b=b.slice(0);for(d2=0;d2<e;d2+=4)b[0]^=4294967295&c[d2],b[1]^=4294967295&c[d2+1],b[2]^=4294967295&c[d2+2],b[3]^=4294967295&c[d2+3],b=sjcl.mode.gcm.ka(b,a);return b},C:function(a,b,c,d2,e,f){var g,h,k,l,n,m,p2,r,q=sjcl.bitArray;m=c.length;p2=q.bitLength(c);r=q.bitLength(d2);h=q.bitLength(e);g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=q.concat(e,[1])):(e=sjcl.mode.gcm.j(g,[0,0,0,0],e),e=sjcl.mode.gcm.j(g,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl.mode.gcm.j(g,[0,0,0,0],d2);n=e.slice(0);d2=h.slice(0);a||(d2=sjcl.mode.gcm.j(g,h,c));for(l=0;l<m;l+=4)n[3]++,k=b.encrypt(n),c[l]^=k[0],c[l+1]^=k[1],c[l+2]^=k[2],c[l+3]^=k[3];c=q.clamp(c,p2);a&&(d2=sjcl.mode.gcm.j(g,h,c));a=[Math.floor(r/4294967296),r&4294967295,Math.floor(p2/4294967296),p2&4294967295];d2=sjcl.mode.gcm.j(g,d2,a);k=b.encrypt(e);d2[0]^=k[0];d2[1]^=k[1];d2[2]^=k[2];d2[3]^=k[3];return{tag:q.bitSlice(d2,0,f),data:c}}};sjcl.misc.hmac=function(a,b){this.W=b=b||sjcl.hash.sha256;var c=[[],[]],d2,e=b.prototype.blockSize/32;this.w=[new b,new b];a.length>e&&(a=b.hash(a));for(d2=0;d2<e;d2++)c[0][d2]=a[d2]^909522486,c[1][d2]=a[d2]^1549556828;this.w[0].update(c[0]);this.w[1].update(c[1]);this.R=new b(this.w[0])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){if(this.aa)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");this.update(a);return this.digest(a)};sjcl.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=false};sjcl.misc.hmac.prototype.update=function(a){this.aa=true;this.R.update(a)};sjcl.misc.hmac.prototype.digest=function(){var a=this.R.finalize(),a=new this.W(this.w[1]).update(a).finalize();this.reset();return a};sjcl.misc.pbkdf2=function(a,b,c,d2,e){c=c||1e4;if(0>d2||0>c)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,k,l=[],n=sjcl.bitArray;for(k=1;32*l.length<(d2||1);k++){e=f=a.encrypt(n.concat(b,[k]));for(g=1;g<c;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];l=l.concat(e)}d2&&(l=n.clamp(l,d2));return l};sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=a;this.D=false;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=3e4;this.ba=80};sjcl.prng.prototype={randomWords:function(a,b){var c=[],d2;d2=this.isReady(b);var e;if(d2===this.u)throw new sjcl.exception.notReady("generator isn\'t seeded");if(d2&this.J){d2=!(d2&this.I);e=[];var f=0,g;this.Z=e[0]=new Date().valueOf()+this.da;for(g=0;16>g;g++)e.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.m[g],this.m[g]=0,d2||!(this.P&1<<g));g++);this.P>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.m.push(0));this.f-=f;f>this.o&&(this.o=f);this.P++;this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.L=new sjcl.cipher.aes(this.b);for(d2=0;4>d2&&(this.h[d2]=this.h[d2]+1|0,!this.h[d2]);d2++);}for(d2=0;d2<a;d2+=4)0===(d2+1)%this.ca&&y(this),e=z(this),c.push(e[0],e[1],e[2],e[3]);y(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=a},addEntropy:function(a,b,c){c=c||"user";var d2,e,f=new Date().valueOf(),g=this.H[c],h=this.isReady(),k=0;d2=this.U[c];void 0===d2&&(d2=this.U[c]=this.ha++);void 0===g&&(g=this.H[c]=0);this.H[c]=(this.H[c]+1)%this.c.length;switch(typeof a){case"number":void 0===b&&(b=1);this.c[g].update([d2,this.N++,1,b,f,1,a|0]);break;case"object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(k=1),c=0;c<a.length&&!k;c++)"number"!==typeof a[c]&&(k=1);if(!k){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e=e>>>1;this.c[g].update([d2,this.N++,2,b,f,a.length].concat(a))}break;case"string":void 0===b&&(b=a.length);this.c[g].update([d2,this.N++,3,b,f,a.length]);this.c[g].update(a);break;default:k=1}if(k)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[g]+=b;this.f+=b;h===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},isReady:function(a){a=this.T[void 0!==a?a:this.M];return this.o&&this.o>=a?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=a?this.J|this.u:this.u},getProgress:function(a){a=this.T[a?a:this.M];return this.o>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,false),window.addEventListener("mousemove",this.a.mouseCollector,false),window.addEventListener("keypress",this.a.keyboardCollector,false),window.addEventListener("devicemotion",this.a.accelerometerCollector,false),window.addEventListener("touchmove",this.a.touchCollector,false);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl.exception.bug("can\'t attach event");this.D=true}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,false),window.removeEventListener("mousemove",this.a.mouseCollector,false),window.removeEventListener("keypress",this.a.keyboardCollector,false),window.removeEventListener("devicemotion",this.a.accelerometerCollector,false),window.removeEventListener("touchmove",this.a.touchCollector,false)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=false)},addEventListener:function(a,b){this.K[a][this.ga++]=b},removeEventListener:function(a,b){var c,d2,e=this.K[a],f=[];for(d2 in e)e.hasOwnProperty(d2)&&e[d2]===b&&f.push(d2);for(c=0;c<f.length;c++)d2=f[c],delete e[d2]},la:function(){C(this,1)},oa:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d2){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,"mouse");C(this,0)},qa:function(a){a=a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C(this,0)},ma:function(){C(this,2)},ea:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C(this,0)}};function A(a,b){var c,d2=sjcl.random.K[a],e=[];for(c in d2)d2.hasOwnProperty(c)&&e.push(d2[c]);for(c=0;c<e.length;c++)e[c](b)}function C(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy(new Date().valueOf(),b,"loadtime")}function y(a){a.b=z(a).concat(z(a));a.L=new sjcl.cipher.aes(a.b)}function z(a){for(var b=0;4>b&&(a.h[b]=a.h[b]+1|0,!a.h[b]);b++);return a.L.encrypt(a.h)}function B(a,b){return function(){b.apply(a,arguments)}}sjcl.random=new sjcl.prng(6);a:try{if(G="undefined"!==typeof module&&module.exports){try{H=__require2("crypto")}catch(a){H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array(new Uint8Array(D).buffer),sjcl.random.addEntropy(D,1024,"crypto[\'randomBytes\']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F);else break a;sjcl.random.addEntropy(F,1024,"crypto[\'getRandomValues\']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}var D;var E;var F;var G;var H;sjcl.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(a,b,c,d2){c=c||{};d2=d2||{};var e=sjcl.json,f=e.g({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.g(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl.codec.base64.toBits(f.iv));if(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)throw new sjcl.exception.invalid("json encrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));"string"===typeof c&&(f.adata=c=sjcl.codec.utf8String.toBits(c));g=new sjcl.cipher[f.cipher](a);e.g(d2,f);d2.key=a;f.ct="ccm"===f.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(g,b,f.iv,c,f.ts):sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f},encrypt:function(a,b,c,d2){var e=sjcl.json,f=e.ja.apply(e,arguments);return e.encode(f)},ia:function(a,b,c,d2){c=c||{};d2=d2||{};var e=sjcl.json;b=e.g(e.g(e.g({},e.defaults),b),c,true);var f,g;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv));if(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjcl.exception.invalid("json decrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl.codec.utf8String.toBits(f));g=new sjcl.cipher[b.cipher](a);f="ccm"===b.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(g,b.ct,b.iv,b.tag,f,b.ts):sjcl.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.g(d2,b);d2.key=a;return 1===c.raw?f:sjcl.codec.utf8String.fromBits(f)},decrypt:function(a,b,c,d2){var e=sjcl.json;return e.ia(a,e.decode(b),c,d2)},encode:function(a){var b,c="{",d2="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");c+=d2+\'"\'+b+\'":\';d2=",";switch(typeof a[b]){case"number":case"boolean":c+=a[b];break;case"string":c+=\'"\'+escape(a[b])+\'"\';break;case"object":c+=\'"\'+sjcl.codec.base64.fromBits(a[b],0)+\'"\';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return c+"}"},decode:function(a){a=a.replace(/\\s/g,"");if(!a.match(/^\\{.*\\}$/))throw new sjcl.exception.invalid("json decode: this isn\'t json!");a=a.replace(/^\\{|\\}$/g,"").split(/,/);var b={},c,d2;for(c=0;c<a.length;c++){if(!(d2=a[c].match(/^\\s*(?:(["\']?)([a-z][a-z0-9]*)\\1)\\s*:\\s*(?:(-?\\d+)|"([a-z0-9+\\/%*_.@=\\-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn\'t json!");null!=d2[3]?b[d2[2]]=parseInt(d2[3],10):null!=d2[4]?b[d2[2]]=d2[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(d2[4]):unescape(d2[4]):null!=d2[5]&&(b[d2[2]]="true"===d2[5])}return b},g:function(a,b,c){void 0===a&&(a={});if(void 0===b)return a;for(var d2 in b)if(b.hasOwnProperty(d2)){if(c&&void 0!==a[d2]&&a[d2]!==b[d2])throw new sjcl.exception.invalid("required parameter overridden");a[d2]=b[d2]}return a},sa:function(a,b){var c={},d2;for(d2 in a)a.hasOwnProperty(d2)&&a[d2]!==b[d2]&&(c[d2]=a[d2]);return c},ra:function(a,b){var c={},d2;for(d2=0;d2<b.length;d2++)void 0!==a[b[d2]]&&(c[b[d2]]=a[b[d2]]);return c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.pa={};sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.pa,d2;b=b||{};d2=b.iter||1e3;c=c[a]=c[a]||{};d2=c[d2]=c[d2]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=void 0===b.salt?d2.firstSalt:b.salt;d2[c]=d2[c]||sjcl.misc.pbkdf2(a,c,b.iter);return{key:d2[c].slice(0),salt:c.slice(0)}};var _HTTPfrontend=class extends Service{name="http";fetchProxied=false;listening={};constructor(options,path,fetched){super(options);this.load(this);this.listen(path,fetched)}GET=(url2="http://localhost:8080/ping",type="",mimeType)=>{if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"GET",url:url2,responseType:type,mimeType,onload:ev2=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url2 instanceof URL)url2=url2.toString();this.setState({[url2]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};POST=(message,url2="http://localhost:8080/echo",type="",mimeType)=>{if(typeof message==="object"&&(type==="json"||type==="text"||!type)){message=JSON.stringify(message)}if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"POST",url:url2,data:message,responseType:type,mimeType,onload:ev2=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url2 instanceof URL)url2=url2.toString();this.setState({[url2]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};transmit=(message,url2)=>{let obj=message;if(typeof obj==="object"){message=JSON.stringify(obj)}if(obj?.method?.toLowerCase()=="get"||message?.toLowerCase()==="get")return this.GET(url2);return this.POST(message,url2)};transponder=(url2,message,type="",mimeType)=>{if(typeof message==="object")message=JSON.stringify(message);let method="GET";if(message){method="POST"}if(type==="json")mimeType="application/json";else return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method,url:url2,data:message,responseType:type,onload:ev2=>{let body=xhr.response;if(typeof body==="string"){let substr=body.substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))body=body.replace(/\\\\/g,"");if(body[0]===\'"\'){body=body.substring(1,body.length-1)};body=JSON.parse(body)}}if(typeof body?.method==="string"){return resolve(this.handleMethod(body.route,body.method,body.args))}else if(typeof body?.route==="string"){return resolve(this.handleServiceMessage(body))}else if(typeof body?.node==="string"||body.node instanceof GraphNode){return resolve(this.handleGraphNodeCall(body.node,body.args))}else return resolve(body)},onabort:er=>{reject(er)}})}).catch(console.error)};listen=(path="0",fetched=async(clone,args,response)=>{const result=await clone.text();const returned=this.receive(result);this.setState({[response.url]:returned})})=>{this.listening[path]={};let listenerId=`${path}${Math.floor(Math.random()*1e15)}`;this.listening[path][listenerId]=fetched;if(!this.fetchProxied){globalThis.fetch=new Proxy(globalThis.fetch,{apply(fetch2,that,args){const result=fetch2.apply(that,args);result.then(response=>{if(!response.ok)return;if(this.listening["0"]){for(const key in this.listeners){const clone=response.clone();this.listening["0"][key](clone,args,response)}}else{for(const key in this.listening){if(response.url.includes(key)){for(const key2 in this.listening[path]){const clone=response.clone();this.listening[path][key2](clone,args,response)}break}}}}).catch(er=>{console.error(er)});return result}});this.fetchProxied=true}return listenerId};stopListening=(path,listener)=>{if(!path&&path!==0){for(const key in this.listening)delete this.listening[key]}else{if(!listener)delete this.listening[path];else delete this.listening[listener]}}};var HTTPfrontend=_HTTPfrontend;__publicField(HTTPfrontend,"request",options=>{const xhr=new XMLHttpRequest;if(options.responseType)xhr.responseType=options.responseType;else options.responseType="json";if(options.mimeType){xhr.overrideMimeType(options.mimeType)}if(options.onload)xhr.addEventListener("load",options.onload,false);if(options.onprogress)xhr.addEventListener("progress",options.onprogress,false);if(options.onabort)xhr.addEventListener("abort",options.onabort,false);if(options.onloadend)xhr.addEventListener("loadend",options.onloadend,false);if(options.onerror)xhr.addEventListener("error",options.onerror,false);xhr.open(options.method,options.url,true,options.user,options.pass);if(!options.onerror)xhr.onerror=function(){xhr.abort()};xhr.send(options.data);return xhr});var import_web_worker=__toESM(require_browser());var WorkerService=class extends Service{name="worker";workers={};threadRot=0;connections;constructor(options){super();this.connections={workers:this.workers};if(options?.services)this.addServices(options.services);this.load(this);this.setLoaders(this.workerloader);if(options)this.init(options);if(typeof WorkerGlobalScope!=="undefined"&&globalThis instanceof WorkerGlobalScope){this.addDefaultMessageListener()}}loadWorkerRoute=(rt,routeKey)=>{if(rt.workerUrl)rt.url=rt.workerUrl;if(rt.workerId)rt.__node.tag=rt.workerId;if(!rt.__node.tag)rt.__node.tag=routeKey;rt._id=rt.__node.tag;let worker;if(this.workers[rt._id])worker=this.workers[rt._id];else if(rt.worker)worker=rt.worker;if(!worker){worker=this.addWorker(rt)}rt.worker=worker;if(!rt.worker.__ondisconnected){let ondelete=rt2=>{rt2.worker?.terminate()};rt.__addOndisconnected(ondelete)}if(rt.transferFunctions){for(const prop in rt.transferFunctions){this.transferFunction(worker,rt.transferFunctions[prop],prop)}}if(rt.transferClasses){for(const prop in rt.transferClasses){this.transferClass(worker,rt.transferClasses[prop],prop)}}if(worker){if(!rt.__operator){rt.__operator=(...args)=>{if(rt.callback){if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.post(rt.callback,args);else return worker.run(rt.callback,args)}else{if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.send(args);else return worker.request(args)}}}if(rt.init){worker.run(rt.init,rt.initArgs,void 0,rt.initTransfer)}return worker}};workerloader={"workers":(node,parent,graph,roots)=>{let rt=node;if(!node.parentRoute&&(parent?.callback&&parent?.worker))node.parentRoute=parent?.callback;if(rt?.worker||rt?.workerId||rt?.workerUrl){let worker=this.loadWorkerRoute(rt,rt.__node.tag);if(worker){if(!rt.parentRoute&&rt.__parent?.callback)rt.parentRoute=rt.__parent.callback;if(rt.__parent&&!rt.portId){if(typeof rt.__parent==="string"){if(rt.__node.tag!==rt.__parent&&worker._id!==rt.__parent)rt.portId=this.establishMessageChannel(worker,rt.__parent)}else if(rt.__node.tag!==rt.__parent?.__node?.tag&&worker._id!==rt.__parent?.tag){rt.portId=this.establishMessageChannel(worker,rt.__parent.worker)}};if(rt.parentRoute){if(!rt.stopped){if(typeof rt.__parent==="string"&&rt.__parent===worker._id){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else if(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.parentRoute,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id)&&!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent){if(typeof rt.__parent==="string"){if(!rt.stopped){if(rt.__parent===worker._id){worker.run("subscribe",[rt.__parent,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id))worker.workerSubs[rt.__parent+rt.portId]={sub:null,route:worker._id,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent?.__node?.tag&&rt.__parent?.worker){if(!rt.stopped){if(rt.__node.tag===rt.__parent.__node.tag||worker._id===rt.__parent.__node.tag){worker.run("subscribe",[rt.__parent.__node.tag,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent.__node.tag,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent.__node.tag+rt.portId].sub=sub})}if(!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.__parent.__node.tag+rt.portId]={sub:null,route:rt.__parent.__node.tag,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}}}}else if(rt.__parent&&rt.parentRoute){if(typeof rt.__parent==="string"&&roots[rt.__parent]?.worker){roots[rt.__parent].worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}else if(rt.__parent?.worker){rt.__parent.worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}}return rt}};addDefaultMessageListener=()=>{globalThis.onmessage=ev2=>{let result=this.receive(ev2.data);if(this.__node.keepState)this.setState({[this.name]:result})}};postMessage=(message,target,transfer)=>{if(this.workers[target]){this.workers[target].send(message,transfer)}else{globalThis.postMessage(message,target,transfer)}};addWorker=options=>{let worker;if(!options._id)options._id=`worker${Math.floor(Math.random()*1e15)}`;if(options.url)worker=new import_web_worker.default(options.url);else if(options.port){worker=options.port}else if(this.workers[options._id]){if(this.workers[options._id].port)worker=this.workers[options._id].port;else worker=this.workers[options._id].worker}if(!worker)return;let send=(message,transfer)=>{return this.transmit(message,worker,transfer)};let post=(route,args,method,transfer)=>{let message={route,args};if(method)message.method=method;return this.transmit(message,worker,transfer)};let run=(route,args,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[{route,args},options._id,callbackId]};if(method)req.args[0].method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let request=(message,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,options._id,callbackId]};if(method)req.method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let workerSubs={};let subscribe=(route,callback,args,key,subInput,blocking)=>{return this.subscribeToWorker(route,options._id,callback,args,key,subInput,blocking)};let unsubscribe=(route,sub)=>{return run("unsubscribe",[route,sub])};let start=async(route,portId,callback,blocking)=>{if(route)await run("subscribeToWorker",[route,portId,void 0,callback,blocking]).then(sub=>{if(sub)workerSubs[route+portId]={sub,route,portId,callback,blocking}});else for(const key in workerSubs){if(typeof workerSubs[key].sub!=="number")await run("subscribeToWorker",[workerSubs[key].route,workerSubs[key].portId,void 0,workerSubs[key].callback,void 0,workerSubs[key].blocking]).then(sub=>{workerSubs[key].sub=sub});console.log(JSON.stringify(workerSubs))}return true};let stop=async(route,portId)=>{if(route&&portId&&workerSubs[route+portId]){await run("unsubscribe",[route,workerSubs[route+portId].sub]);workerSubs[route+portId].sub=false}else{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){await run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub]).then(console.log)}workerSubs[key].sub=false}}return true};let terminate=()=>{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub])}workerSubs[key].sub=false}return this.terminate(options._id)};if(!options.onmessage)options.onmessage=ev2=>{this.receive(ev2.data);this.setState({[options._id]:ev2.data})};if(!options.onerror){options.onerror=ev2=>{console.error(ev2.data)}}worker.onmessage=options.onmessage;worker.onerror=options.onerror;this.workers[options._id]={worker,send,post,run,request,subscribe,unsubscribe,terminate,start,stop,postMessage:worker.postMessage,workerSubs,graph:this,...options};return this.workers[options._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=scriptTemplate=>{let blob=new Blob([scriptTemplate],{type:"text/javascript"});return URL.createObjectURL(blob)};getTransferable(message){let transfer;if(typeof message==="object"){if(message.args){if(message.args?.constructor?.name==="Object"){for(const key in message.args){if(ArrayBuffer.isView(message.args[key])){if(!transfer)transfer=[message.args[key].buffer];else transfer.push(message.args[key].buffer)}else if(message.args[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message.args[key]];else transfer.push(message.args[key])}}}else if(Array.isArray(message.args)&&message.args.length<11){message.args.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg?.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message.args)){transfer=[message.args.buffer]}else if(message.args?.constructor?.name==="ArrayBuffer"){transfer=[message]}}else if(message?.constructor?.name==="Object"){for(const key in message){if(ArrayBuffer.isView(message[key])){if(!transfer)transfer=[message[key].buffer];else transfer.push(message[key].buffer)}else if(message[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message[key]];else transfer.push(message[key])}}}else if(Array.isArray(message)&&message.length<11){message.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message)){transfer=[message.buffer]}else if(message.constructor?.name==="ArrayBuffer"){transfer=[message]}}return transfer}transmit=(message,worker,transfer)=>{if(!transfer){transfer=this.getTransferable(message)}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){worker.postMessage(message,transfer)}else if(typeof worker==="string"){if(this.workers[worker]){if(this.workers[worker].port)this.workers[worker].port.postMessage(message,transfer);else if(this.workers[worker].worker)this.workers[worker].worker.postMessage(message,transfer)}}else{let keys22=Object.keys(this.workers);this.workers[keys22[this.threadRot]].worker.postMessage(message,transfer);this.threadRot++;if(this.threadRot===keys22.length)this.threadRot=0}return message};terminate=worker=>{let onclose;if(typeof worker==="string"){let obj=this.workers[worker];if(obj){delete this.workers[worker];worker=obj.worker;if(obj.onclose)onclose=obj.onclose}}else if(typeof worker==="object"){if(worker?._id){worker=worker.worker;delete this.workers[worker?._id]}}if(worker instanceof import_web_worker.default){worker.terminate();if(onclose)onclose(worker);return true}if(worker instanceof MessagePort){worker.close();if(onclose)onclose(worker);return true}return false};establishMessageChannel=(worker,worker2)=>{let workerId;if(typeof worker==="string"){workerId=worker;if(this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker2=this.workers[worker].worker}}else if(worker?.worker){worker=worker.worker}if(typeof worker2==="string"){if(this.workers[worker2]){if(this.workers[worker2].port)worker2=this.workers[worker2].port;else worker2=this.workers[worker2].worker}}else if(worker2?.worker){worker2=worker2.worker}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){let channel=new MessageChannel;let portId=`port${Math.floor(Math.random()*1e15)}`;worker.postMessage({route:"addWorker",args:{port:channel.port1,_id:portId}},[channel.port1]);if(worker2 instanceof import_web_worker.default||worker2 instanceof MessagePort){worker2.postMessage({route:"addWorker",args:{port:channel.port2,_id:portId}},[channel.port2])}else if(workerId&&this.workers[workerId]){channel.port2.onmessage=this.workers[workerId].onmessage;this.workers[workerId].port=channel.port2}return portId}return false};request=(message,workerId,transfer,method)=>{let worker=this.workers[workerId].worker;return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,callbackId]};if(method)req.method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};runRequest=(message,worker,callbackId)=>{let res=this.receive(message);if(typeof worker==="string"&&this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}if(res instanceof Promise){res.then(r=>{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:r,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:r,callbackId})})}else{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:res,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:res,callbackId})}return res};subscribeWorker=(route,worker,args,key,subInput,blocking)=>{let callback;if(blocking){let blocked=false;callback=res=>{if(!blocked){blocked=true;if(res instanceof Promise){res.then(r=>{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,r]).then(ret=>{blocked=false})})}else{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,res]).then(ret=>{blocked=false})}}}}else{callback=res=>{if(res instanceof Promise){res.then(r=>{if(worker?.postMessage)worker.postMessage({args:r,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:r,callbackId:route})})}else{if(worker?.postMessage)worker.postMessage({args:res,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:res,callbackId:route})}}}if(!blocking&&worker?.port){worker=worker.port}else if(!blocking&&worker?.worker){worker=worker.worker}else if(typeof worker==="string"&&this.workers[worker]){if(blocking)worker=this.workers[worker];else if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}return this.subscribe(route,callback,args,key,subInput)};subscribeToWorker=(route,workerId,callback,args,key,subInput,blocking)=>{if(typeof workerId==="string"&&this.workers[workerId]){this.__node.state.subscribeEvent(workerId,res=>{if(res?.callbackId===route){if(!callback)this.setState({[workerId]:res.args});else if(typeof callback==="string"){this.run(callback,res.args)}else callback(res.args)}});return this.workers[workerId].run("subscribeWorker",[route,workerId,args,key,subInput,blocking])}};triggerSubscription=async(route,workerId,result)=>{if(this.__node.state.triggers[workerId])for(let i22=0;i22<this.__node.state.triggers[workerId].length;i22++){await this.__node.state.triggers[workerId][i22].onchange({args:result,callbackId:route})}return true};pipeWorkers=(sourceWorker,listenerWorker,sourceRoute,listenerRoute,portId,args,key,subInput,blocking)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof listenerWorker==="string")listenerWorker=this.workers[listenerWorker];if(!portId){portId=this.establishMessageChannel(sourceWorker.worker,listenerWorker.worker)}return listenerWorker.run("subscribeToWorker",[sourceRoute,portId,listenerRoute,args,key,subInput,blocking])};unpipeWorkers=(sourceRoute,sourceWorker,sub)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof sourceWorker==="object"){return sourceWorker.run("unsubscribe",[sourceRoute,sub])}}};var mouseEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]);var wheelEventHandlerImpl=makeSendPropertiesHandler(["deltaX","deltaY"]);var keydownEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function focusEventHandler(event,sendFn){const data={type:event.type};data.isTrusted=event.isTrusted;data.bubbles=event.bubbles;data.cancelBubble=event.cancelBubble;data.cancelable=event.cancelable;data.composed=event.composed;data.defaultPrevent=event.defaultPrevented;data.eventPhase=event.eventPhase;data.returnValue=event.returnValue;data.currentTarget=event.currentTarget.id?event.currentTarget.id:event.currentTarget.constructor.name;data.target=data.currentTarget;data.srcElement=data.currentTarget;sendFn(data)}function wheelEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();wheelEventHandlerImpl(event,sendFn)}function preventDefaultHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault()}function copyProperties(src,properties,dst){for(const name2 of properties){dst[name2]=src[name2]}}function makeSendPropertiesHandler(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties(event,properties,data);sendFn(data)}}function touchEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();const touches=[];const data={type:event.type,touches};for(let i22=0;i22<event.touches.length;++i22){const touch=event.touches[i22];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var i=1;var keys={};while(i<222){keys[i]=true;i++}function filteredKeydownEventHandler(event,sendFn,preventDefault){let{keyCode}=event;if(keys[keyCode]){if(preventDefault&&event.preventDefault&&(keyCode<110||keyCode>123))event.preventDefault();keydownEventHandler(event,sendFn)}}var eventHandlers={contextmenu:preventDefaultHandler,mousedown:mouseEventHandler,mousemove:mouseEventHandler,mouseup:mouseEventHandler,pointerdown:mouseEventHandler,pointermove:mouseEventHandler,pointerup:mouseEventHandler,pointerlockchange:mouseEventHandler,webkitpointerlockchange:mouseEventHandler,focus:focusEventHandler,blur:focusEventHandler,pointerout:mouseEventHandler,touchstart:touchEventHandler,touchmove:touchEventHandler,touchend:touchEventHandler,wheel:wheelEventHandler,keydown:filteredKeydownEventHandler,keyup:filteredKeydownEventHandler};function initProxyElement(element,worker,id,preventDefault){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{if(!worker){handleProxyEvent(data,id)}else worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent,preventDefault)})}if(eventHandlers.keydown){globalThis.addEventListener("keydown",function(ev2){eventHandlers.keydown(ev2,sendEvent,preventDefault)})}if(eventHandlers.keyup){globalThis.addEventListener("keyup",function(ev2){eventHandlers.keyup(ev2,sendEvent,preventDefault)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher=class{__listeners;addEventListener(type,listener){if(this.__listeners===void 0)this.__listeners={};const listeners=this.__listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this.__listeners===void 0)return false;const listeners=this.__listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i22=0,l=array.length;i22<l;i22++){array[i22].call(this,event)}}}};function noop(){}var ElementProxyReceiver=class extends EventDispatcher{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super();this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.style.width=this.width+"px";this.proxied.style.height=this.height+"px";this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop;data.stopPropagation=noop;this.dispatchEvent(data,this.proxied)};focus(){}blur(){}};var ProxyManager=class{targets={};constructor(){if(!globalThis.document)globalThis.document={elementFromPoint:(...args)=>{return this.targets[Object.keys(this.targets)[0]].proxied}}}makeProxy=(id,addTo=void 0)=>{if(!id)id=`proxyReceiver${Math.floor(Math.random()*1e15)}`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;if(typeof WorkerGlobalScope!=="undefined")addTo.style=proxy.style;if(proxy.width){addTo.style.width=proxy.width+"px";addTo.clientWidth=proxy.width}if(proxy.height){addTo.style.height=proxy.height+"px";addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy);addTo.blur=proxy.blur.bind(proxy)}};getProxy=id=>{return this.targets[id]};handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0}};function makeProxy(id,elm){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;this.__node.graph.ProxyManager.makeProxy(id,elm)}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;globalThis.ProxyManager.makeProxy(id,elm)}return id}function handleProxyEvent(data,id){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;if(this.__node.graph.ProxyManager.handleEvent(data,id))return data}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;if(globalThis.ProxyManager.handleEvent(data,id))return data}}var proxyElementWorkerRoutes={initProxyElement,makeProxy,handleProxyEvent};function Renderer(options){if(options.worker){let worker=options.worker;let route=options.route;if(worker instanceof Blob||typeof worker==="string"){worker=new Worker(worker)}delete options.worker;delete options.route;return transferCanvas(worker,options,route)}else{initProxyElement(options.canvas,void 0,options._id,options.preventDefault);return setupCanvas(options)}}function transferCanvas(worker,options,route){if(!options)return void 0;if(!options._id)options._id=`canvas${Math.floor(Math.random()*1e15)}`;let offscreen=options.canvas.transferControlToOffscreen();if(!options.width)options.width=options.canvas.clientWidth;if(!options.height)options.height=options.canvas.clientHeight;let message={route:route?route:"setupCanvas",args:{...options,canvas:offscreen}};if(this?.__node?.graph)this.__node.graph.run("initProxyElement",options.canvas,worker,options._id,options.preventDefault);else initProxyElement(options.canvas,worker,options._id,options.preventDefault);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let tr=[offscreen];if(options.transfer){tr.push(...options.transfer);delete options.transfer}worker.postMessage(message,tr);const canvascontrols={_id:options._id,width:options.width,height:options.height,worker,draw:(props,transfer)=>{worker.postMessage({route:"drawFrame",args:[props,options._id]},transfer)},update:(props,transfer)=>{worker.postMessage({route:"updateCanvas",args:[props,options._id]},transfer)},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:(newDrawProps,transfer)=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]},transfer)},terminate:()=>{worker.terminate()}};return canvascontrols}function setDraw(settings,_id){let canvasopts;if(this?.__node?.graph){if(_id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]}else{if(_id)canvasopts=globalThis.CANVASES?.[settings._id];else if(settings._id)canvasopts=globalThis.CANVASES?.[settings._id];else canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]]}if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasopts._id,canvasopts.canvas);else proxyElementWorkerRoutes.makeProxy(canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText3(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw.bind(settings)}if(typeof settings.update==="string")settings.update=parseFunctionFromText3(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update.bind(settings)}if(typeof settings.init==="string")settings.init=parseFunctionFromText3(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init.bind(settings)}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText3(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear.bind(settings)}return settings._id}return void 0}function setupCanvas(options){if(this?.__node?.graph){if(!this.__node.graph.CANVASES)this.__node.graph.CANVASES={}}else if(!globalThis.CANVASES)globalThis.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=`canvas${Math.floor(Math.random()*1e15)}`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this?.__node?.graph?.CANVASES[canvasOptions._id]){this.__node.graph.run("setDraw",canvasOptions)}else if(globalThis.CANVASES?.[canvasOptions._id]){setDraw(canvasOptions)}else{if(this?.__node?.graph){canvasOptions.graph=this.__node.graph;if(!canvasOptions.__node){canvasOptions.__node={}}if(!canvasOptions.__node.tag)canvasOptions.__node.tag=canvasOptions._id;canvasOptions=this.__node.graph.add(canvasOptions);canvasOptions.__addOndisconnected=()=>{canvasOptions.stop();delete this.__node.graph.CANVASES[canvasOptions._id]}}if(this?.__node?.graph)this.__node.graph.CANVASES[canvasOptions._id]=canvasOptions;else globalThis.CANVASES[canvasOptions._id]=canvasOptions;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);else proxyElementWorkerRoutes.makeProxy(canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText3(canvasOptions.draw)}else if(typeof canvasOptions.draw==="function"){canvasOptions.draw=canvasOptions.draw.bind(canvasOptions)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText3(canvasOptions.update)}else if(typeof canvasOptions.update==="function"){canvasOptions.update=canvasOptions.update.bind(canvasOptions)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText3(canvasOptions.init)}else if(typeof canvasOptions.init==="function"){canvasOptions.init=canvasOptions.init.bind(canvasOptions)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText3(canvasOptions.clear)}else if(typeof canvasOptions.clear==="function"){canvasOptions.clear=canvasOptions.clear.bind(canvasOptions)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);canvasOptions.stop=()=>{stopAnim(canvasOptions._id)};canvasOptions.start=draw=>{startAnim(canvasOptions._id,draw)};canvasOptions.set=settings=>{setDraw(settings,canvasOptions._id)};if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)return canvasOptions._id;else{const canvascontrols={_id:options._id,width:options.width,height:options.height,draw:props=>{drawFrame(props,options._id)},update:props=>{updateCanvas(props,options._id)},clear:()=>{clearCanvas(options._id)},init:()=>{initCanvas(options._id)},stop:()=>{stopAnim(options._id)},start:()=>{startAnim(options._id)},set:newDrawProps=>{setDraw(newDrawProps,options._id)},terminate:()=>{if(this.__node?.graph)this.__node.graph.remove(options._id);else{stopAnim(options._id);if(this?.__node?.graph)delete this.__node.graph.CANVASES[canvasOptions._id];else delete globalThis.CANVASES[canvasOptions._id]}}};return canvascontrols}}function drawFrame(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0}function clearCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function initCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function updateCanvas(input,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0}function setProps(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0}function startAnim(_id,draw){let canvasopts=getCanvas.call(this,_id);canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText3(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function stopAnim(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")requestAnimationFrame(canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context));return _id}return void 0}function getCanvas(_id){let canvasopts;if(this?.__node?.graph){if(!_id)canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]];else canvasopts=this.__node.graph.CANVASES?.[_id]}else{if(!_id)canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]];else canvasopts=globalThis.CANVASES?.[_id]}return canvasopts}var workerCanvasRoutes={...proxyElementWorkerRoutes,Renderer,transferCanvas,setupCanvas,setDraw,drawFrame,clearCanvas,initCanvas,updateCanvas,setProps,startAnim,stopAnim,getCanvas};function parseFunctionFromText3(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var __create2=Object.create;var __defProp2=Object.defineProperty;var __getOwnPropDesc2=Object.getOwnPropertyDescriptor;var __getOwnPropNames2=Object.getOwnPropertyNames;var __getProtoOf2=Object.getPrototypeOf;var __hasOwnProp2=Object.prototype.hasOwnProperty;var __defNormalProp2=(obj,key,value)=>key in obj?__defProp2(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __require3=(x3=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x3,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x3)(function(x3){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x3+\'" is not supported\')});var __commonJS2=(cb,mod)=>function __require23(){return mod||(0,cb[__getOwnPropNames2(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __export=(target,all)=>{for(var name2 in all)__defProp2(target,name2,{get:all[name2],enumerable:true})};var __copyProps2=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames2(from))if(!__hasOwnProp2.call(to,key)&&key!==except)__defProp2(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc2(from,key))||desc.enumerable})}return to};var __toESM2=(mod,isNodeMode,target)=>(target=mod!=null?__create2(__getProtoOf2(mod)):{},__copyProps2(isNodeMode||!mod||!mod.__esModule?__defProp2(target,"default",{value:mod,enumerable:true}):target,mod));var __publicField2=(obj,key,value)=>{__defNormalProp2(obj,typeof key!=="symbol"?key+"":key,value);return value};var require_bson=__commonJS2({"struct/datastructures/bson.cjs"(exports){"use strict";var BSON_MAJOR_VERSION=5;var BSON_INT32_MAX=2147483647;var BSON_INT32_MIN=-2147483648;var BSON_INT64_MAX=Math.pow(2,63)-1;var BSON_INT64_MIN=-Math.pow(2,63);var JS_INT_MAX=Math.pow(2,53);var JS_INT_MIN=-Math.pow(2,53);var BSON_DATA_NUMBER=1;var BSON_DATA_STRING=2;var BSON_DATA_OBJECT=3;var BSON_DATA_ARRAY=4;var BSON_DATA_BINARY=5;var BSON_DATA_UNDEFINED=6;var BSON_DATA_OID=7;var BSON_DATA_BOOLEAN=8;var BSON_DATA_DATE=9;var BSON_DATA_NULL=10;var BSON_DATA_REGEXP=11;var BSON_DATA_DBPOINTER=12;var BSON_DATA_CODE=13;var BSON_DATA_SYMBOL=14;var BSON_DATA_CODE_W_SCOPE=15;var BSON_DATA_INT=16;var BSON_DATA_TIMESTAMP=17;var BSON_DATA_LONG=18;var BSON_DATA_DECIMAL128=19;var BSON_DATA_MIN_KEY=255;var BSON_DATA_MAX_KEY=127;var BSON_BINARY_SUBTYPE_DEFAULT=0;var BSON_BINARY_SUBTYPE_UUID_NEW=4;var BSONType=Object.freeze({double:1,string:2,object:3,array:4,binData:5,undefined:6,objectId:7,bool:8,date:9,null:10,regex:11,dbPointer:12,javascript:13,symbol:14,javascriptWithScope:15,int:16,timestamp:17,long:18,decimal:19,minKey:-1,maxKey:127});var BSONError=class extends Error{get bsonError(){return true}get name(){return"BSONError"}constructor(message){super(message)}static isBSONError(value){return value!=null&&typeof value==="object"&&"bsonError"in value&&value.bsonError===true&&"name"in value&&"message"in value&&"stack"in value}};var BSONVersionError=class extends BSONError{get name(){return"BSONVersionError"}constructor(){super(`Unsupported BSON version, bson types must be from bson ${BSON_MAJOR_VERSION}.0 or later`)}};var BSONRuntimeError=class extends BSONError{get name(){return"BSONRuntimeError"}constructor(message){super(message)}};function nodejsMathRandomBytes(byteLength){return nodeJsByteUtils.fromNumberArray(Array.from({length:byteLength},()=>Math.floor(Math.random()*256)))}var nodejsRandomBytes=(()=>{try{return __require3("crypto").randomBytes}catch{return nodejsMathRandomBytes}})();var nodeJsByteUtils={toLocalBufferType(potentialBuffer){if(Buffer.isBuffer(potentialBuffer)){return potentialBuffer}if(ArrayBuffer.isView(potentialBuffer)){return Buffer.from(potentialBuffer.buffer,potentialBuffer.byteOffset,potentialBuffer.byteLength)}const stringTag=potentialBuffer?.[Symbol.toStringTag]??Object.prototype.toString.call(potentialBuffer);if(stringTag==="ArrayBuffer"||stringTag==="SharedArrayBuffer"||stringTag==="[object ArrayBuffer]"||stringTag==="[object SharedArrayBuffer]"){return Buffer.from(potentialBuffer)}throw new BSONError(`Cannot create Buffer from ${String(potentialBuffer)}`)},allocate(size){return Buffer.alloc(size)},equals(a,b){return nodeJsByteUtils.toLocalBufferType(a).equals(b)},fromNumberArray(array){return Buffer.from(array)},fromBase64(base64){return Buffer.from(base64,"base64")},toBase64(buffer2){return nodeJsByteUtils.toLocalBufferType(buffer2).toString("base64")},fromISO88591(codePoints){return Buffer.from(codePoints,"binary")},toISO88591(buffer2){return nodeJsByteUtils.toLocalBufferType(buffer2).toString("binary")},fromHex(hex){return Buffer.from(hex,"hex")},toHex(buffer2){return nodeJsByteUtils.toLocalBufferType(buffer2).toString("hex")},fromUTF8(text){return Buffer.from(text,"utf8")},toUTF8(buffer2){return nodeJsByteUtils.toLocalBufferType(buffer2).toString("utf8")},utf8ByteLength(input){return Buffer.byteLength(input,"utf8")},encodeUTF8Into(buffer2,source,byteOffset){return nodeJsByteUtils.toLocalBufferType(buffer2).write(source,byteOffset,void 0,"utf8")},randomBytes:nodejsRandomBytes};function isReactNative(){const{navigator:navigator2}=globalThis;return typeof navigator2==="object"&&navigator2.product==="ReactNative"}function webMathRandomBytes(byteLength){if(byteLength<0){throw new RangeError(`The argument \'byteLength\' is invalid. Received ${byteLength}`)}return webByteUtils.fromNumberArray(Array.from({length:byteLength},()=>Math.floor(Math.random()*256)))}var webRandomBytes=(()=>{const{crypto}=globalThis;if(crypto!=null&&typeof crypto.getRandomValues==="function"){return byteLength=>{return crypto.getRandomValues(webByteUtils.allocate(byteLength))}}else{if(isReactNative()){const{console:console2}=globalThis;console2?.warn?.("BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.")}return webMathRandomBytes}})();var HEX_DIGIT=/(\\d|[a-f])/i;var webByteUtils={toLocalBufferType(potentialUint8array){const stringTag=potentialUint8array?.[Symbol.toStringTag]??Object.prototype.toString.call(potentialUint8array);if(stringTag==="Uint8Array"){return potentialUint8array}if(ArrayBuffer.isView(potentialUint8array)){return new Uint8Array(potentialUint8array.buffer.slice(potentialUint8array.byteOffset,potentialUint8array.byteOffset+potentialUint8array.byteLength))}if(stringTag==="ArrayBuffer"||stringTag==="SharedArrayBuffer"||stringTag==="[object ArrayBuffer]"||stringTag==="[object SharedArrayBuffer]"){return new Uint8Array(potentialUint8array)}throw new BSONError(`Cannot make a Uint8Array from ${String(potentialUint8array)}`)},allocate(size){if(typeof size!=="number"){throw new TypeError(`The "size" argument must be of type number. Received ${String(size)}`)}return new Uint8Array(size)},equals(a,b){if(a.byteLength!==b.byteLength){return false}for(let i3=0;i3<a.byteLength;i3++){if(a[i3]!==b[i3]){return false}}return true},fromNumberArray(array){return Uint8Array.from(array)},fromBase64(base64){return Uint8Array.from(atob(base64),c=>c.charCodeAt(0))},toBase64(uint8array){return btoa(webByteUtils.toISO88591(uint8array))},fromISO88591(codePoints){return Uint8Array.from(codePoints,c=>c.charCodeAt(0)&255)},toISO88591(uint8array){return Array.from(Uint16Array.from(uint8array),b=>String.fromCharCode(b)).join("")},fromHex(hex){const evenLengthHex=hex.length%2===0?hex:hex.slice(0,hex.length-1);const buffer2=[];for(let i3=0;i3<evenLengthHex.length;i3+=2){const firstDigit=evenLengthHex[i3];const secondDigit=evenLengthHex[i3+1];if(!HEX_DIGIT.test(firstDigit)){break}if(!HEX_DIGIT.test(secondDigit)){break}const hexDigit=Number.parseInt(`${firstDigit}${secondDigit}`,16);buffer2.push(hexDigit)}return Uint8Array.from(buffer2)},toHex(uint8array){return Array.from(uint8array,byte=>byte.toString(16).padStart(2,"0")).join("")},fromUTF8(text){return new TextEncoder().encode(text)},toUTF8(uint8array){return new TextDecoder("utf8",{fatal:false}).decode(uint8array)},utf8ByteLength(input){return webByteUtils.fromUTF8(input).byteLength},encodeUTF8Into(buffer2,source,byteOffset){const bytes=webByteUtils.fromUTF8(source);buffer2.set(bytes,byteOffset);return bytes.byteLength},randomBytes:webRandomBytes};var hasGlobalBuffer=typeof Buffer==="function"&&Buffer.prototype?._isBuffer!==true;var ByteUtils=hasGlobalBuffer?nodeJsByteUtils:webByteUtils;var BSONDataView=class extends DataView{static fromUint8Array(input){return new DataView(input.buffer,input.byteOffset,input.byteLength)}};var VALIDATION_REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i;var uuidValidateString=str23=>typeof str23==="string"&&VALIDATION_REGEX.test(str23);var uuidHexStringToBuffer=hexString=>{if(!uuidValidateString(hexString)){throw new BSONError(\'UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".\')}const sanitizedHexString=hexString.replace(/-/g,"");return ByteUtils.fromHex(sanitizedHexString)};function bufferToUuidHexString(buffer2,includeDashes=true){if(includeDashes){return[ByteUtils.toHex(buffer2.subarray(0,4)),ByteUtils.toHex(buffer2.subarray(4,6)),ByteUtils.toHex(buffer2.subarray(6,8)),ByteUtils.toHex(buffer2.subarray(8,10)),ByteUtils.toHex(buffer2.subarray(10,16))].join("-")}return ByteUtils.toHex(buffer2)}function isAnyArrayBuffer(value){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(value))}function isUint8Array(value){return Object.prototype.toString.call(value)==="[object Uint8Array]"}function isRegExp(d2){return Object.prototype.toString.call(d2)==="[object RegExp]"}function isMap(d2){return Object.prototype.toString.call(d2)==="[object Map]"}function isDate(d2){return Object.prototype.toString.call(d2)==="[object Date]"}var BSONValue=class{get[Symbol.for("@@mdb.bson.version")](){return BSON_MAJOR_VERSION}};var Binary=class extends BSONValue{get _bsontype(){return"Binary"}constructor(buffer2,subType){super();if(!(buffer2==null)&&!(typeof buffer2==="string")&&!ArrayBuffer.isView(buffer2)&&!(buffer2 instanceof ArrayBuffer)&&!Array.isArray(buffer2)){throw new BSONError("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>")}this.sub_type=subType??Binary.BSON_BINARY_SUBTYPE_DEFAULT;if(buffer2==null){this.buffer=ByteUtils.allocate(Binary.BUFFER_SIZE);this.position=0}else{if(typeof buffer2==="string"){this.buffer=ByteUtils.fromISO88591(buffer2)}else if(Array.isArray(buffer2)){this.buffer=ByteUtils.fromNumberArray(buffer2)}else{this.buffer=ByteUtils.toLocalBufferType(buffer2)}this.position=this.buffer.byteLength}}put(byteValue){if(typeof byteValue==="string"&&byteValue.length!==1){throw new BSONError("only accepts single character String")}else if(typeof byteValue!=="number"&&byteValue.length!==1)throw new BSONError("only accepts single character Uint8Array or Array");let decodedByte;if(typeof byteValue==="string"){decodedByte=byteValue.charCodeAt(0)}else if(typeof byteValue==="number"){decodedByte=byteValue}else{decodedByte=byteValue[0]}if(decodedByte<0||decodedByte>255){throw new BSONError("only accepts number in a valid unsigned byte range 0-255")}if(this.buffer.byteLength>this.position){this.buffer[this.position++]=decodedByte}else{const newSpace=ByteUtils.allocate(Binary.BUFFER_SIZE+this.buffer.length);newSpace.set(this.buffer,0);this.buffer=newSpace;this.buffer[this.position++]=decodedByte}}write(sequence,offset){offset=typeof offset==="number"?offset:this.position;if(this.buffer.byteLength<offset+sequence.length){const newSpace=ByteUtils.allocate(this.buffer.byteLength+sequence.length);newSpace.set(this.buffer,0);this.buffer=newSpace}if(ArrayBuffer.isView(sequence)){this.buffer.set(ByteUtils.toLocalBufferType(sequence),offset);this.position=offset+sequence.byteLength>this.position?offset+sequence.length:this.position}else if(typeof sequence==="string"){const bytes=ByteUtils.fromISO88591(sequence);this.buffer.set(bytes,offset);this.position=offset+sequence.length>this.position?offset+sequence.length:this.position}}read(position,length){length=length&&length>0?length:this.position;return this.buffer.slice(position,position+length)}value(asRaw){asRaw=!!asRaw;if(asRaw&&this.buffer.length===this.position){return this.buffer}if(asRaw){return this.buffer.slice(0,this.position)}return ByteUtils.toISO88591(this.buffer.subarray(0,this.position))}length(){return this.position}toJSON(){return ByteUtils.toBase64(this.buffer)}toString(encoding){if(encoding==="hex")return ByteUtils.toHex(this.buffer);if(encoding==="base64")return ByteUtils.toBase64(this.buffer);if(encoding==="utf8"||encoding==="utf-8")return ByteUtils.toUTF8(this.buffer);return ByteUtils.toUTF8(this.buffer)}toExtendedJSON(options){options=options||{};const base64String=ByteUtils.toBase64(this.buffer);const subType=Number(this.sub_type).toString(16);if(options.legacy){return{$binary:base64String,$type:subType.length===1?"0"+subType:subType}}return{$binary:{base64:base64String,subType:subType.length===1?"0"+subType:subType}}}toUUID(){if(this.sub_type===Binary.SUBTYPE_UUID){return new UUID(this.buffer.slice(0,this.position))}throw new BSONError(`Binary sub_type "${this.sub_type}" is not supported for converting to UUID. Only "${Binary.SUBTYPE_UUID}" is currently supported.`)}static fromExtendedJSON(doc,options){options=options||{};let data;let type;if("$binary"in doc){if(options.legacy&&typeof doc.$binary==="string"&&"$type"in doc){type=doc.$type?parseInt(doc.$type,16):0;data=ByteUtils.fromBase64(doc.$binary)}else{if(typeof doc.$binary!=="string"){type=doc.$binary.subType?parseInt(doc.$binary.subType,16):0;data=ByteUtils.fromBase64(doc.$binary.base64)}}}else if("$uuid"in doc){type=4;data=uuidHexStringToBuffer(doc.$uuid)}if(!data){throw new BSONError(`Unexpected Binary Extended JSON format ${JSON.stringify(doc)}`)}return type===BSON_BINARY_SUBTYPE_UUID_NEW?new UUID(data):new Binary(data,type)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Binary(Buffer.from("${ByteUtils.toHex(this.buffer)}", "hex"), ${this.sub_type})`}};Binary.BSON_BINARY_SUBTYPE_DEFAULT=0;Binary.BUFFER_SIZE=256;Binary.SUBTYPE_DEFAULT=0;Binary.SUBTYPE_FUNCTION=1;Binary.SUBTYPE_BYTE_ARRAY=2;Binary.SUBTYPE_UUID_OLD=3;Binary.SUBTYPE_UUID=4;Binary.SUBTYPE_MD5=5;Binary.SUBTYPE_ENCRYPTED=6;Binary.SUBTYPE_COLUMN=7;Binary.SUBTYPE_USER_DEFINED=128;var UUID_BYTE_LENGTH=16;var UUID=class extends Binary{constructor(input){let bytes;let hexStr;if(input==null){bytes=UUID.generate()}else if(input instanceof UUID){bytes=ByteUtils.toLocalBufferType(new Uint8Array(input.buffer));hexStr=input.__id}else if(ArrayBuffer.isView(input)&&input.byteLength===UUID_BYTE_LENGTH){bytes=ByteUtils.toLocalBufferType(input)}else if(typeof input==="string"){bytes=uuidHexStringToBuffer(input)}else{throw new BSONError("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).")}super(bytes,BSON_BINARY_SUBTYPE_UUID_NEW);this.__id=hexStr}get id(){return this.buffer}set id(value){this.buffer=value;if(UUID.cacheHexString){this.__id=bufferToUuidHexString(value)}}toHexString(includeDashes=true){if(UUID.cacheHexString&&this.__id){return this.__id}const uuidHexString=bufferToUuidHexString(this.id,includeDashes);if(UUID.cacheHexString){this.__id=uuidHexString}return uuidHexString}toString(encoding){if(encoding==="hex")return ByteUtils.toHex(this.id);if(encoding==="base64")return ByteUtils.toBase64(this.id);return this.toHexString()}toJSON(){return this.toHexString()}equals(otherId){if(!otherId){return false}if(otherId instanceof UUID){return ByteUtils.equals(otherId.id,this.id)}try{return ByteUtils.equals(new UUID(otherId).id,this.id)}catch{return false}}toBinary(){return new Binary(this.id,Binary.SUBTYPE_UUID)}static generate(){const bytes=ByteUtils.randomBytes(UUID_BYTE_LENGTH);bytes[6]=bytes[6]&15|64;bytes[8]=bytes[8]&63|128;return bytes}static isValid(input){if(!input){return false}if(input instanceof UUID){return true}if(typeof input==="string"){return uuidValidateString(input)}if(isUint8Array(input)){if(input.byteLength!==UUID_BYTE_LENGTH){return false}return(input[6]&240)===64&&(input[8]&128)===128}return false}static createFromHexString(hexString){const buffer2=uuidHexStringToBuffer(hexString);return new UUID(buffer2)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new UUID("${this.toHexString()}")`}};var Code=class extends BSONValue{get _bsontype(){return"Code"}constructor(code,scope){super();this.code=code.toString();this.scope=scope??null}toJSON(){if(this.scope!=null){return{code:this.code,scope:this.scope}}return{code:this.code}}toExtendedJSON(){if(this.scope){return{$code:this.code,$scope:this.scope}}return{$code:this.code}}static fromExtendedJSON(doc){return new Code(doc.$code,doc.$scope)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){const codeJson=this.toJSON();return`new Code("${String(codeJson.code)}"${codeJson.scope!=null?`, ${JSON.stringify(codeJson.scope)}`:""})`}};function isDBRefLike(value){return value!=null&&typeof value==="object"&&"$id"in value&&value.$id!=null&&"$ref"in value&&typeof value.$ref==="string"&&(!("$db"in value)||"$db"in value&&typeof value.$db==="string")}var DBRef=class extends BSONValue{get _bsontype(){return"DBRef"}constructor(collection,oid,db,fields){super();const parts=collection.split(".");if(parts.length===2){db=parts.shift();collection=parts.shift()}this.collection=collection;this.oid=oid;this.db=db;this.fields=fields||{}}get namespace(){return this.collection}set namespace(value){this.collection=value}toJSON(){const o=Object.assign({$ref:this.collection,$id:this.oid},this.fields);if(this.db!=null)o.$db=this.db;return o}toExtendedJSON(options){options=options||{};let o={$ref:this.collection,$id:this.oid};if(options.legacy){return o}if(this.db)o.$db=this.db;o=Object.assign(o,this.fields);return o}static fromExtendedJSON(doc){const copy=Object.assign({},doc);delete copy.$ref;delete copy.$id;delete copy.$db;return new DBRef(doc.$ref,doc.$id,doc.$db,copy)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){const oid=this.oid===void 0||this.oid.toString===void 0?this.oid:this.oid.toString();return`new DBRef("${this.namespace}", new ObjectId("${String(oid)}")${this.db?`, "${this.db}"`:""})`}};var wasm=void 0;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}var TWO_PWR_16_DBL=1<<16;var TWO_PWR_24_DBL=1<<24;var TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL;var TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL;var TWO_PWR_63_DBL=TWO_PWR_64_DBL/2;var INT_CACHE={};var UINT_CACHE={};var MAX_INT64_STRING_LENGTH=20;var DECIMAL_REG_EX=/^(\\+?0|(\\+|-)?[1-9][0-9]*)$/;var Long=class extends BSONValue{get _bsontype(){return"Long"}get __isLong__(){return true}constructor(low=0,high,unsigned){super();if(typeof low==="bigint"){Object.assign(this,Long.fromBigInt(low,!!high))}else if(typeof low==="string"){Object.assign(this,Long.fromString(low,!!high))}else{this.low=low|0;this.high=high|0;this.unsigned=!!unsigned}}static fromBits(lowBits,highBits,unsigned){return new Long(lowBits,highBits,unsigned)}static fromInt(value,unsigned){let obj,cachedObj,cache;if(unsigned){value>>>=0;if(cache=0<=value&&value<256){cachedObj=UINT_CACHE[value];if(cachedObj)return cachedObj}obj=Long.fromBits(value,(value|0)<0?-1:0,true);if(cache)UINT_CACHE[value]=obj;return obj}else{value|=0;if(cache=-128<=value&&value<128){cachedObj=INT_CACHE[value];if(cachedObj)return cachedObj}obj=Long.fromBits(value,value<0?-1:0,false);if(cache)INT_CACHE[value]=obj;return obj}}static fromNumber(value,unsigned){if(isNaN(value))return unsigned?Long.UZERO:Long.ZERO;if(unsigned){if(value<0)return Long.UZERO;if(value>=TWO_PWR_64_DBL)return Long.MAX_UNSIGNED_VALUE}else{if(value<=-TWO_PWR_63_DBL)return Long.MIN_VALUE;if(value+1>=TWO_PWR_63_DBL)return Long.MAX_VALUE}if(value<0)return Long.fromNumber(-value,unsigned).neg();return Long.fromBits(value%TWO_PWR_32_DBL|0,value/TWO_PWR_32_DBL|0,unsigned)}static fromBigInt(value,unsigned){return Long.fromString(value.toString(),unsigned)}static fromString(str23,unsigned,radix){if(str23.length===0)throw new BSONError("empty string");if(str23==="NaN"||str23==="Infinity"||str23==="+Infinity"||str23==="-Infinity")return Long.ZERO;if(typeof unsigned==="number"){radix=unsigned,unsigned=false}else{unsigned=!!unsigned}radix=radix||10;if(radix<2||36<radix)throw new BSONError("radix");let p2;if((p2=str23.indexOf("-"))>0)throw new BSONError("interior hyphen");else if(p2===0){return Long.fromString(str23.substring(1),unsigned,radix).neg()}const radixToPower=Long.fromNumber(Math.pow(radix,8));let result=Long.ZERO;for(let i3=0;i3<str23.length;i3+=8){const size=Math.min(8,str23.length-i3),value=parseInt(str23.substring(i3,i3+size),radix);if(size<8){const power=Long.fromNumber(Math.pow(radix,size));result=result.mul(power).add(Long.fromNumber(value))}else{result=result.mul(radixToPower);result=result.add(Long.fromNumber(value))}}result.unsigned=unsigned;return result}static fromBytes(bytes,unsigned,le){return le?Long.fromBytesLE(bytes,unsigned):Long.fromBytesBE(bytes,unsigned)}static fromBytesLE(bytes,unsigned){return new Long(bytes[0]|bytes[1]<<8|bytes[2]<<16|bytes[3]<<24,bytes[4]|bytes[5]<<8|bytes[6]<<16|bytes[7]<<24,unsigned)}static fromBytesBE(bytes,unsigned){return new Long(bytes[4]<<24|bytes[5]<<16|bytes[6]<<8|bytes[7],bytes[0]<<24|bytes[1]<<16|bytes[2]<<8|bytes[3],unsigned)}static isLong(value){return value!=null&&typeof value==="object"&&"__isLong__"in value&&value.__isLong__===true}static fromValue(val,unsigned){if(typeof val==="number")return Long.fromNumber(val,unsigned);if(typeof val==="string")return Long.fromString(val,unsigned);return Long.fromBits(val.low,val.high,typeof unsigned==="boolean"?unsigned:val.unsigned)}add(addend){if(!Long.isLong(addend))addend=Long.fromValue(addend);const a48=this.high>>>16;const a32=this.high&65535;const a16=this.low>>>16;const a00=this.low&65535;const b48=addend.high>>>16;const b32=addend.high&65535;const b16=addend.low>>>16;const b00=addend.low&65535;let c48=0,c32=0,c16=0,c00=0;c00+=a00+b00;c16+=c00>>>16;c00&=65535;c16+=a16+b16;c32+=c16>>>16;c16&=65535;c32+=a32+b32;c48+=c32>>>16;c32&=65535;c48+=a48+b48;c48&=65535;return Long.fromBits(c16<<16|c00,c48<<16|c32,this.unsigned)}and(other){if(!Long.isLong(other))other=Long.fromValue(other);return Long.fromBits(this.low&other.low,this.high&other.high,this.unsigned)}compare(other){if(!Long.isLong(other))other=Long.fromValue(other);if(this.eq(other))return 0;const thisNeg=this.isNegative(),otherNeg=other.isNegative();if(thisNeg&&!otherNeg)return-1;if(!thisNeg&&otherNeg)return 1;if(!this.unsigned)return this.sub(other).isNegative()?-1:1;return other.high>>>0>this.high>>>0||other.high===this.high&&other.low>>>0>this.low>>>0?-1:1}comp(other){return this.compare(other)}divide(divisor){if(!Long.isLong(divisor))divisor=Long.fromValue(divisor);if(divisor.isZero())throw new BSONError("division by zero");if(wasm){if(!this.unsigned&&this.high===-2147483648&&divisor.low===-1&&divisor.high===-1){return this}const low=(this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,divisor.low,divisor.high);return Long.fromBits(low,wasm.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Long.UZERO:Long.ZERO;let approx,rem,res;if(!this.unsigned){if(this.eq(Long.MIN_VALUE)){if(divisor.eq(Long.ONE)||divisor.eq(Long.NEG_ONE))return Long.MIN_VALUE;else if(divisor.eq(Long.MIN_VALUE))return Long.ONE;else{const halfThis=this.shr(1);approx=halfThis.div(divisor).shl(1);if(approx.eq(Long.ZERO)){return divisor.isNegative()?Long.ONE:Long.NEG_ONE}else{rem=this.sub(divisor.mul(approx));res=approx.add(rem.div(divisor));return res}}}else if(divisor.eq(Long.MIN_VALUE))return this.unsigned?Long.UZERO:Long.ZERO;if(this.isNegative()){if(divisor.isNegative())return this.neg().div(divisor.neg());return this.neg().div(divisor).neg()}else if(divisor.isNegative())return this.div(divisor.neg()).neg();res=Long.ZERO}else{if(!divisor.unsigned)divisor=divisor.toUnsigned();if(divisor.gt(this))return Long.UZERO;if(divisor.gt(this.shru(1)))return Long.UONE;res=Long.UZERO}rem=this;while(rem.gte(divisor)){approx=Math.max(1,Math.floor(rem.toNumber()/divisor.toNumber()));const log2=Math.ceil(Math.log(approx)/Math.LN2);const delta=log2<=48?1:Math.pow(2,log2-48);let approxRes=Long.fromNumber(approx);let approxRem=approxRes.mul(divisor);while(approxRem.isNegative()||approxRem.gt(rem)){approx-=delta;approxRes=Long.fromNumber(approx,this.unsigned);approxRem=approxRes.mul(divisor)}if(approxRes.isZero())approxRes=Long.ONE;res=res.add(approxRes);rem=rem.sub(approxRem)}return res}div(divisor){return this.divide(divisor)}equals(other){if(!Long.isLong(other))other=Long.fromValue(other);if(this.unsigned!==other.unsigned&&this.high>>>31===1&&other.high>>>31===1)return false;return this.high===other.high&&this.low===other.low}eq(other){return this.equals(other)}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative()){return this.eq(Long.MIN_VALUE)?64:this.neg().getNumBitsAbs()}const val=this.high!==0?this.high:this.low;let bit;for(bit=31;bit>0;bit--)if((val&1<<bit)!==0)break;return this.high!==0?bit+33:bit+1}greaterThan(other){return this.comp(other)>0}gt(other){return this.greaterThan(other)}greaterThanOrEqual(other){return this.comp(other)>=0}gte(other){return this.greaterThanOrEqual(other)}ge(other){return this.greaterThanOrEqual(other)}isEven(){return(this.low&1)===0}isNegative(){return!this.unsigned&&this.high<0}isOdd(){return(this.low&1)===1}isPositive(){return this.unsigned||this.high>=0}isZero(){return this.high===0&&this.low===0}lessThan(other){return this.comp(other)<0}lt(other){return this.lessThan(other)}lessThanOrEqual(other){return this.comp(other)<=0}lte(other){return this.lessThanOrEqual(other)}modulo(divisor){if(!Long.isLong(divisor))divisor=Long.fromValue(divisor);if(wasm){const low=(this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,divisor.low,divisor.high);return Long.fromBits(low,wasm.get_high(),this.unsigned)}return this.sub(this.div(divisor).mul(divisor))}mod(divisor){return this.modulo(divisor)}rem(divisor){return this.modulo(divisor)}multiply(multiplier){if(this.isZero())return Long.ZERO;if(!Long.isLong(multiplier))multiplier=Long.fromValue(multiplier);if(wasm){const low=wasm.mul(this.low,this.high,multiplier.low,multiplier.high);return Long.fromBits(low,wasm.get_high(),this.unsigned)}if(multiplier.isZero())return Long.ZERO;if(this.eq(Long.MIN_VALUE))return multiplier.isOdd()?Long.MIN_VALUE:Long.ZERO;if(multiplier.eq(Long.MIN_VALUE))return this.isOdd()?Long.MIN_VALUE:Long.ZERO;if(this.isNegative()){if(multiplier.isNegative())return this.neg().mul(multiplier.neg());else return this.neg().mul(multiplier).neg()}else if(multiplier.isNegative())return this.mul(multiplier.neg()).neg();if(this.lt(Long.TWO_PWR_24)&&multiplier.lt(Long.TWO_PWR_24))return Long.fromNumber(this.toNumber()*multiplier.toNumber(),this.unsigned);const a48=this.high>>>16;const a32=this.high&65535;const a16=this.low>>>16;const a00=this.low&65535;const b48=multiplier.high>>>16;const b32=multiplier.high&65535;const b16=multiplier.low>>>16;const b00=multiplier.low&65535;let c48=0,c32=0,c16=0,c00=0;c00+=a00*b00;c16+=c00>>>16;c00&=65535;c16+=a16*b00;c32+=c16>>>16;c16&=65535;c16+=a00*b16;c32+=c16>>>16;c16&=65535;c32+=a32*b00;c48+=c32>>>16;c32&=65535;c32+=a16*b16;c48+=c32>>>16;c32&=65535;c32+=a00*b32;c48+=c32>>>16;c32&=65535;c48+=a48*b00+a32*b16+a16*b32+a00*b48;c48&=65535;return Long.fromBits(c16<<16|c00,c48<<16|c32,this.unsigned)}mul(multiplier){return this.multiply(multiplier)}negate(){if(!this.unsigned&&this.eq(Long.MIN_VALUE))return Long.MIN_VALUE;return this.not().add(Long.ONE)}neg(){return this.negate()}not(){return Long.fromBits(~this.low,~this.high,this.unsigned)}notEquals(other){return!this.equals(other)}neq(other){return this.notEquals(other)}ne(other){return this.notEquals(other)}or(other){if(!Long.isLong(other))other=Long.fromValue(other);return Long.fromBits(this.low|other.low,this.high|other.high,this.unsigned)}shiftLeft(numBits){if(Long.isLong(numBits))numBits=numBits.toInt();if((numBits&=63)===0)return this;else if(numBits<32)return Long.fromBits(this.low<<numBits,this.high<<numBits|this.low>>>32-numBits,this.unsigned);else return Long.fromBits(0,this.low<<numBits-32,this.unsigned)}shl(numBits){return this.shiftLeft(numBits)}shiftRight(numBits){if(Long.isLong(numBits))numBits=numBits.toInt();if((numBits&=63)===0)return this;else if(numBits<32)return Long.fromBits(this.low>>>numBits|this.high<<32-numBits,this.high>>numBits,this.unsigned);else return Long.fromBits(this.high>>numBits-32,this.high>=0?0:-1,this.unsigned)}shr(numBits){return this.shiftRight(numBits)}shiftRightUnsigned(numBits){if(Long.isLong(numBits))numBits=numBits.toInt();numBits&=63;if(numBits===0)return this;else{const high=this.high;if(numBits<32){const low=this.low;return Long.fromBits(low>>>numBits|high<<32-numBits,high>>>numBits,this.unsigned)}else if(numBits===32)return Long.fromBits(high,0,this.unsigned);else return Long.fromBits(high>>>numBits-32,0,this.unsigned)}}shr_u(numBits){return this.shiftRightUnsigned(numBits)}shru(numBits){return this.shiftRightUnsigned(numBits)}subtract(subtrahend){if(!Long.isLong(subtrahend))subtrahend=Long.fromValue(subtrahend);return this.add(subtrahend.neg())}sub(subtrahend){return this.subtract(subtrahend)}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){if(this.unsigned)return(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0);return this.high*TWO_PWR_32_DBL+(this.low>>>0)}toBigInt(){return BigInt(this.toString())}toBytes(le){return le?this.toBytesLE():this.toBytesBE()}toBytesLE(){const hi=this.high,lo=this.low;return[lo&255,lo>>>8&255,lo>>>16&255,lo>>>24,hi&255,hi>>>8&255,hi>>>16&255,hi>>>24]}toBytesBE(){const hi=this.high,lo=this.low;return[hi>>>24,hi>>>16&255,hi>>>8&255,hi&255,lo>>>24,lo>>>16&255,lo>>>8&255,lo&255]}toSigned(){if(!this.unsigned)return this;return Long.fromBits(this.low,this.high,false)}toString(radix){radix=radix||10;if(radix<2||36<radix)throw new BSONError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Long.MIN_VALUE)){const radixLong=Long.fromNumber(radix),div=this.div(radixLong),rem1=div.mul(radixLong).sub(this);return div.toString(radix)+rem1.toInt().toString(radix)}else return"-"+this.neg().toString(radix)}const radixToPower=Long.fromNumber(Math.pow(radix,6),this.unsigned);let rem=this;let result="";while(true){const remDiv=rem.div(radixToPower);const intval=rem.sub(remDiv.mul(radixToPower)).toInt()>>>0;let digits=intval.toString(radix);rem=remDiv;if(rem.isZero()){return digits+result}else{while(digits.length<6)digits="0"+digits;result=""+digits+result}}}toUnsigned(){if(this.unsigned)return this;return Long.fromBits(this.low,this.high,true)}xor(other){if(!Long.isLong(other))other=Long.fromValue(other);return Long.fromBits(this.low^other.low,this.high^other.high,this.unsigned)}eqz(){return this.isZero()}le(other){return this.lessThanOrEqual(other)}toExtendedJSON(options){if(options&&options.relaxed)return this.toNumber();return{$numberLong:this.toString()}}static fromExtendedJSON(doc,options){const{useBigInt64=false,relaxed=true}={...options};if(doc.$numberLong.length>MAX_INT64_STRING_LENGTH){throw new BSONError("$numberLong string is too long")}if(!DECIMAL_REG_EX.test(doc.$numberLong)){throw new BSONError(`$numberLong string "${doc.$numberLong}" is in an invalid format`)}if(useBigInt64){const bigIntResult=BigInt(doc.$numberLong);return BigInt.asIntN(64,bigIntResult)}const longResult=Long.fromString(doc.$numberLong);if(relaxed){return longResult.toNumber()}return longResult}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Long("${this.toString()}"${this.unsigned?", true":""})`}};Long.TWO_PWR_24=Long.fromInt(TWO_PWR_24_DBL);Long.MAX_UNSIGNED_VALUE=Long.fromBits(4294967295|0,4294967295|0,true);Long.ZERO=Long.fromInt(0);Long.UZERO=Long.fromInt(0,true);Long.ONE=Long.fromInt(1);Long.UONE=Long.fromInt(1,true);Long.NEG_ONE=Long.fromInt(-1);Long.MAX_VALUE=Long.fromBits(4294967295|0,2147483647|0,false);Long.MIN_VALUE=Long.fromBits(0,2147483648|0,false);var PARSE_STRING_REGEXP=/^(\\+|-)?(\\d+|(\\d*\\.\\d*))?(E|e)?([-+])?(\\d+)?$/;var PARSE_INF_REGEXP=/^(\\+|-)?(Infinity|inf)$/i;var PARSE_NAN_REGEXP=/^(\\+|-)?NaN$/i;var EXPONENT_MAX=6111;var EXPONENT_MIN=-6176;var EXPONENT_BIAS=6176;var MAX_DIGITS=34;var NAN_BUFFER=ByteUtils.fromNumberArray([124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse());var INF_NEGATIVE_BUFFER=ByteUtils.fromNumberArray([248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse());var INF_POSITIVE_BUFFER=ByteUtils.fromNumberArray([120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse());var EXPONENT_REGEX=/^([-+])?(\\d+)?$/;var COMBINATION_MASK=31;var EXPONENT_MASK=16383;var COMBINATION_INFINITY=30;var COMBINATION_NAN=31;function isDigit(value){return!isNaN(parseInt(value,10))}function divideu128(value){const DIVISOR=Long.fromNumber(1e3*1e3*1e3);let _rem=Long.fromNumber(0);if(!value.parts[0]&&!value.parts[1]&&!value.parts[2]&&!value.parts[3]){return{quotient:value,rem:_rem}}for(let i3=0;i3<=3;i3++){_rem=_rem.shiftLeft(32);_rem=_rem.add(new Long(value.parts[i3],0));value.parts[i3]=_rem.div(DIVISOR).low;_rem=_rem.modulo(DIVISOR)}return{quotient:value,rem:_rem}}function multiply64x2(left,right){if(!left&&!right){return{high:Long.fromNumber(0),low:Long.fromNumber(0)}}const leftHigh=left.shiftRightUnsigned(32);const leftLow=new Long(left.getLowBits(),0);const rightHigh=right.shiftRightUnsigned(32);const rightLow=new Long(right.getLowBits(),0);let productHigh=leftHigh.multiply(rightHigh);let productMid=leftHigh.multiply(rightLow);const productMid2=leftLow.multiply(rightHigh);let productLow=leftLow.multiply(rightLow);productHigh=productHigh.add(productMid.shiftRightUnsigned(32));productMid=new Long(productMid.getLowBits(),0).add(productMid2).add(productLow.shiftRightUnsigned(32));productHigh=productHigh.add(productMid.shiftRightUnsigned(32));productLow=productMid.shiftLeft(32).add(new Long(productLow.getLowBits(),0));return{high:productHigh,low:productLow}}function lessThan(left,right){const uhleft=left.high>>>0;const uhright=right.high>>>0;if(uhleft<uhright){return true}else if(uhleft===uhright){const ulleft=left.low>>>0;const ulright=right.low>>>0;if(ulleft<ulright)return true}return false}function invalidErr(string,message){throw new BSONError(`"${string}" is not a valid Decimal128 string - ${message}`)}var Decimal128=class extends BSONValue{get _bsontype(){return"Decimal128"}constructor(bytes){super();if(typeof bytes==="string"){this.bytes=Decimal128.fromString(bytes).bytes}else if(isUint8Array(bytes)){if(bytes.byteLength!==16){throw new BSONError("Decimal128 must take a Buffer of 16 bytes")}this.bytes=bytes}else{throw new BSONError("Decimal128 must take a Buffer or string")}}static fromString(representation){let isNegative=false;let sawRadix=false;let foundNonZero=false;let significantDigits=0;let nDigitsRead=0;let nDigits=0;let radixPosition=0;let firstNonZero=0;const digits=[0];let nDigitsStored=0;let digitsInsert=0;let firstDigit=0;let lastDigit=0;let exponent=0;let i3=0;let significandHigh=new Long(0,0);let significandLow=new Long(0,0);let biasedExponent=0;let index=0;if(representation.length>=7e3){throw new BSONError(""+representation+" not a valid Decimal128 string")}const stringMatch=representation.match(PARSE_STRING_REGEXP);const infMatch=representation.match(PARSE_INF_REGEXP);const nanMatch=representation.match(PARSE_NAN_REGEXP);if(!stringMatch&&!infMatch&&!nanMatch||representation.length===0){throw new BSONError(""+representation+" not a valid Decimal128 string")}if(stringMatch){const unsignedNumber=stringMatch[2];const e=stringMatch[4];const expSign=stringMatch[5];const expNumber=stringMatch[6];if(e&&expNumber===void 0)invalidErr(representation,"missing exponent power");if(e&&unsignedNumber===void 0)invalidErr(representation,"missing exponent base");if(e===void 0&&(expSign||expNumber)){invalidErr(representation,"missing e before exponent")}}if(representation[index]==="+"||representation[index]==="-"){isNegative=representation[index++]==="-"}if(!isDigit(representation[index])&&representation[index]!=="."){if(representation[index]==="i"||representation[index]==="I"){return new Decimal128(isNegative?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER)}else if(representation[index]==="N"){return new Decimal128(NAN_BUFFER)}}while(isDigit(representation[index])||representation[index]==="."){if(representation[index]==="."){if(sawRadix)invalidErr(representation,"contains multiple periods");sawRadix=true;index=index+1;continue}if(nDigitsStored<34){if(representation[index]!=="0"||foundNonZero){if(!foundNonZero){firstNonZero=nDigitsRead}foundNonZero=true;digits[digitsInsert++]=parseInt(representation[index],10);nDigitsStored=nDigitsStored+1}}if(foundNonZero)nDigits=nDigits+1;if(sawRadix)radixPosition=radixPosition+1;nDigitsRead=nDigitsRead+1;index=index+1}if(sawRadix&&!nDigitsRead)throw new BSONError(""+representation+" not a valid Decimal128 string");if(representation[index]==="e"||representation[index]==="E"){const match=representation.substr(++index).match(EXPONENT_REGEX);if(!match||!match[2])return new Decimal128(NAN_BUFFER);exponent=parseInt(match[0],10);index=index+match[0].length}if(representation[index])return new Decimal128(NAN_BUFFER);firstDigit=0;if(!nDigitsStored){firstDigit=0;lastDigit=0;digits[0]=0;nDigits=1;nDigitsStored=1;significantDigits=0}else{lastDigit=nDigitsStored-1;significantDigits=nDigits;if(significantDigits!==1){while(digits[firstNonZero+significantDigits-1]===0){significantDigits=significantDigits-1}}}if(exponent<=radixPosition&&radixPosition-exponent>1<<14){exponent=EXPONENT_MIN}else{exponent=exponent-radixPosition}while(exponent>EXPONENT_MAX){lastDigit=lastDigit+1;if(lastDigit-firstDigit>MAX_DIGITS){const digitsString=digits.join("");if(digitsString.match(/^0+$/)){exponent=EXPONENT_MAX;break}invalidErr(representation,"overflow")}exponent=exponent-1}while(exponent<EXPONENT_MIN||nDigitsStored<nDigits){if(lastDigit===0&&significantDigits<nDigitsStored){exponent=EXPONENT_MIN;significantDigits=0;break}if(nDigitsStored<nDigits){nDigits=nDigits-1}else{lastDigit=lastDigit-1}if(exponent<EXPONENT_MAX){exponent=exponent+1}else{const digitsString=digits.join("");if(digitsString.match(/^0+$/)){exponent=EXPONENT_MAX;break}invalidErr(representation,"overflow")}}if(lastDigit-firstDigit+1<significantDigits){let endOfString=nDigitsRead;if(sawRadix){firstNonZero=firstNonZero+1;endOfString=endOfString+1}if(isNegative){firstNonZero=firstNonZero+1;endOfString=endOfString+1}const roundDigit=parseInt(representation[firstNonZero+lastDigit+1],10);let roundBit=0;if(roundDigit>=5){roundBit=1;if(roundDigit===5){roundBit=digits[lastDigit]%2===1?1:0;for(i3=firstNonZero+lastDigit+2;i3<endOfString;i3++){if(parseInt(representation[i3],10)){roundBit=1;break}}}}if(roundBit){let dIdx=lastDigit;for(;dIdx>=0;dIdx--){if(++digits[dIdx]>9){digits[dIdx]=0;if(dIdx===0){if(exponent<EXPONENT_MAX){exponent=exponent+1;digits[dIdx]=1}else{return new Decimal128(isNegative?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER)}}}}}}significandHigh=Long.fromNumber(0);significandLow=Long.fromNumber(0);if(significantDigits===0){significandHigh=Long.fromNumber(0);significandLow=Long.fromNumber(0)}else if(lastDigit-firstDigit<17){let dIdx=firstDigit;significandLow=Long.fromNumber(digits[dIdx++]);significandHigh=new Long(0,0);for(;dIdx<=lastDigit;dIdx++){significandLow=significandLow.multiply(Long.fromNumber(10));significandLow=significandLow.add(Long.fromNumber(digits[dIdx]))}}else{let dIdx=firstDigit;significandHigh=Long.fromNumber(digits[dIdx++]);for(;dIdx<=lastDigit-17;dIdx++){significandHigh=significandHigh.multiply(Long.fromNumber(10));significandHigh=significandHigh.add(Long.fromNumber(digits[dIdx]))}significandLow=Long.fromNumber(digits[dIdx++]);for(;dIdx<=lastDigit;dIdx++){significandLow=significandLow.multiply(Long.fromNumber(10));significandLow=significandLow.add(Long.fromNumber(digits[dIdx]))}}const significand=multiply64x2(significandHigh,Long.fromString("100000000000000000"));significand.low=significand.low.add(significandLow);if(lessThan(significand.low,significandLow)){significand.high=significand.high.add(Long.fromNumber(1))}biasedExponent=exponent+EXPONENT_BIAS;const dec={low:Long.fromNumber(0),high:Long.fromNumber(0)};if(significand.high.shiftRightUnsigned(49).and(Long.fromNumber(1)).equals(Long.fromNumber(1))){dec.high=dec.high.or(Long.fromNumber(3).shiftLeft(61));dec.high=dec.high.or(Long.fromNumber(biasedExponent).and(Long.fromNumber(16383).shiftLeft(47)));dec.high=dec.high.or(significand.high.and(Long.fromNumber(0x7fffffffffff)))}else{dec.high=dec.high.or(Long.fromNumber(biasedExponent&16383).shiftLeft(49));dec.high=dec.high.or(significand.high.and(Long.fromNumber(562949953421311)))}dec.low=significand.low;if(isNegative){dec.high=dec.high.or(Long.fromString("9223372036854775808"))}const buffer2=ByteUtils.allocate(16);index=0;buffer2[index++]=dec.low.low&255;buffer2[index++]=dec.low.low>>8&255;buffer2[index++]=dec.low.low>>16&255;buffer2[index++]=dec.low.low>>24&255;buffer2[index++]=dec.low.high&255;buffer2[index++]=dec.low.high>>8&255;buffer2[index++]=dec.low.high>>16&255;buffer2[index++]=dec.low.high>>24&255;buffer2[index++]=dec.high.low&255;buffer2[index++]=dec.high.low>>8&255;buffer2[index++]=dec.high.low>>16&255;buffer2[index++]=dec.high.low>>24&255;buffer2[index++]=dec.high.high&255;buffer2[index++]=dec.high.high>>8&255;buffer2[index++]=dec.high.high>>16&255;buffer2[index++]=dec.high.high>>24&255;return new Decimal128(buffer2)}toString(){let biased_exponent;let significand_digits=0;const significand=new Array(36);for(let i3=0;i3<significand.length;i3++)significand[i3]=0;let index=0;let is_zero=false;let significand_msb;let significand128={parts:[0,0,0,0]};let j,k;const string=[];index=0;const buffer2=this.bytes;const low=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const midl=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const midh=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const high=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;index=0;const dec={low:new Long(low,midl),high:new Long(midh,high)};if(dec.high.lessThan(Long.ZERO)){string.push("-")}const combination=high>>26&COMBINATION_MASK;if(combination>>3===3){if(combination===COMBINATION_INFINITY){return string.join("")+"Infinity"}else if(combination===COMBINATION_NAN){return"NaN"}else{biased_exponent=high>>15&EXPONENT_MASK;significand_msb=8+(high>>14&1)}}else{significand_msb=high>>14&7;biased_exponent=high>>17&EXPONENT_MASK}const exponent=biased_exponent-EXPONENT_BIAS;significand128.parts[0]=(high&16383)+((significand_msb&15)<<14);significand128.parts[1]=midh;significand128.parts[2]=midl;significand128.parts[3]=low;if(significand128.parts[0]===0&&significand128.parts[1]===0&&significand128.parts[2]===0&&significand128.parts[3]===0){is_zero=true}else{for(k=3;k>=0;k--){let least_digits=0;const result=divideu128(significand128);significand128=result.quotient;least_digits=result.rem.low;if(!least_digits)continue;for(j=8;j>=0;j--){significand[k*9+j]=least_digits%10;least_digits=Math.floor(least_digits/10)}}}if(is_zero){significand_digits=1;significand[index]=0}else{significand_digits=36;while(!significand[index]){significand_digits=significand_digits-1;index=index+1}}const scientific_exponent=significand_digits-1+exponent;if(scientific_exponent>=34||scientific_exponent<=-7||exponent>0){if(significand_digits>34){string.push(`${0}`);if(exponent>0)string.push(`E+${exponent}`);else if(exponent<0)string.push(`E${exponent}`);return string.join("")}string.push(`${significand[index++]}`);significand_digits=significand_digits-1;if(significand_digits){string.push(".")}for(let i3=0;i3<significand_digits;i3++){string.push(`${significand[index++]}`)}string.push("E");if(scientific_exponent>0){string.push(`+${scientific_exponent}`)}else{string.push(`${scientific_exponent}`)}}else{if(exponent>=0){for(let i3=0;i3<significand_digits;i3++){string.push(`${significand[index++]}`)}}else{let radix_position=significand_digits+exponent;if(radix_position>0){for(let i3=0;i3<radix_position;i3++){string.push(`${significand[index++]}`)}}else{string.push("0")}string.push(".");while(radix_position++<0){string.push("0")}for(let i3=0;i3<significand_digits-Math.max(radix_position-1,0);i3++){string.push(`${significand[index++]}`)}}}return string.join("")}toJSON(){return{$numberDecimal:this.toString()}}toExtendedJSON(){return{$numberDecimal:this.toString()}}static fromExtendedJSON(doc){return Decimal128.fromString(doc.$numberDecimal)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Decimal128("${this.toString()}")`}};var Double=class extends BSONValue{get _bsontype(){return"Double"}constructor(value){super();if(value instanceof Number){value=value.valueOf()}this.value=+value}valueOf(){return this.value}toJSON(){return this.value}toString(radix){return this.value.toString(radix)}toExtendedJSON(options){if(options&&(options.legacy||options.relaxed&&isFinite(this.value))){return this.value}if(Object.is(Math.sign(this.value),-0)){return{$numberDouble:"-0.0"}}return{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}}static fromExtendedJSON(doc,options){const doubleValue=parseFloat(doc.$numberDouble);return options&&options.relaxed?doubleValue:new Double(doubleValue)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){const eJSON=this.toExtendedJSON();return`new Double(${eJSON.$numberDouble})`}};var Int32=class extends BSONValue{get _bsontype(){return"Int32"}constructor(value){super();if(value instanceof Number){value=value.valueOf()}this.value=+value|0}valueOf(){return this.value}toString(radix){return this.value.toString(radix)}toJSON(){return this.value}toExtendedJSON(options){if(options&&(options.relaxed||options.legacy))return this.value;return{$numberInt:this.value.toString()}}static fromExtendedJSON(doc,options){return options&&options.relaxed?parseInt(doc.$numberInt,10):new Int32(doc.$numberInt)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Int32(${this.valueOf()})`}};var MaxKey=class extends BSONValue{get _bsontype(){return"MaxKey"}toExtendedJSON(){return{$maxKey:1}}static fromExtendedJSON(){return new MaxKey}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return"new MaxKey()"}};var MinKey=class extends BSONValue{get _bsontype(){return"MinKey"}toExtendedJSON(){return{$minKey:1}}static fromExtendedJSON(){return new MinKey}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return"new MinKey()"}};var checkForHexRegExp=new RegExp("^[0-9a-fA-F]{24}$");var PROCESS_UNIQUE=null;var kId=Symbol("id");var ObjectId2=class extends BSONValue{get _bsontype(){return"ObjectId"}constructor(inputId){super();let workingId;if(typeof inputId==="object"&&inputId&&"id"in inputId){if(typeof inputId.id!=="string"&&!ArrayBuffer.isView(inputId.id)){throw new BSONError("Argument passed in must have an id that is of type string or Buffer")}if("toHexString"in inputId&&typeof inputId.toHexString==="function"){workingId=ByteUtils.fromHex(inputId.toHexString())}else{workingId=inputId.id}}else{workingId=inputId}if(workingId==null||typeof workingId==="number"){this[kId]=ObjectId2.generate(typeof workingId==="number"?workingId:void 0)}else if(ArrayBuffer.isView(workingId)&&workingId.byteLength===12){this[kId]=ByteUtils.toLocalBufferType(workingId)}else if(typeof workingId==="string"){if(workingId.length===12){const bytes=ByteUtils.fromUTF8(workingId);if(bytes.byteLength===12){this[kId]=bytes}else{throw new BSONError("Argument passed in must be a string of 12 bytes")}}else if(workingId.length===24&&checkForHexRegExp.test(workingId)){this[kId]=ByteUtils.fromHex(workingId)}else{throw new BSONError("Argument passed in must be a string of 12 bytes or a string of 24 hex characters or an integer")}}else{throw new BSONError("Argument passed in does not match the accepted types")}if(ObjectId2.cacheHexString){this.__id=ByteUtils.toHex(this.id)}}get id(){return this[kId]}set id(value){this[kId]=value;if(ObjectId2.cacheHexString){this.__id=ByteUtils.toHex(value)}}toHexString(){if(ObjectId2.cacheHexString&&this.__id){return this.__id}const hexString=ByteUtils.toHex(this.id);if(ObjectId2.cacheHexString&&!this.__id){this.__id=hexString}return hexString}static getInc(){return ObjectId2.index=(ObjectId2.index+1)%16777215}static generate(time){if("number"!==typeof time){time=Math.floor(Date.now()/1e3)}const inc=ObjectId2.getInc();const buffer2=ByteUtils.allocate(12);BSONDataView.fromUint8Array(buffer2).setUint32(0,time,false);if(PROCESS_UNIQUE===null){PROCESS_UNIQUE=ByteUtils.randomBytes(5)}buffer2[4]=PROCESS_UNIQUE[0];buffer2[5]=PROCESS_UNIQUE[1];buffer2[6]=PROCESS_UNIQUE[2];buffer2[7]=PROCESS_UNIQUE[3];buffer2[8]=PROCESS_UNIQUE[4];buffer2[11]=inc&255;buffer2[10]=inc>>8&255;buffer2[9]=inc>>16&255;return buffer2}toString(encoding){if(encoding==="base64")return ByteUtils.toBase64(this.id);if(encoding==="hex")return this.toHexString();return this.toHexString()}toJSON(){return this.toHexString()}equals(otherId){if(otherId===void 0||otherId===null){return false}if(otherId instanceof ObjectId2){return this[kId][11]===otherId[kId][11]&&ByteUtils.equals(this[kId],otherId[kId])}if(typeof otherId==="string"&&ObjectId2.isValid(otherId)&&otherId.length===12&&isUint8Array(this.id)){return ByteUtils.equals(this.id,ByteUtils.fromISO88591(otherId))}if(typeof otherId==="string"&&ObjectId2.isValid(otherId)&&otherId.length===24){return otherId.toLowerCase()===this.toHexString()}if(typeof otherId==="string"&&ObjectId2.isValid(otherId)&&otherId.length===12){return ByteUtils.equals(ByteUtils.fromUTF8(otherId),this.id)}if(typeof otherId==="object"&&"toHexString"in otherId&&typeof otherId.toHexString==="function"){const otherIdString=otherId.toHexString();const thisIdString=this.toHexString().toLowerCase();return typeof otherIdString==="string"&&otherIdString.toLowerCase()===thisIdString}return false}getTimestamp(){const timestamp=new Date;const time=BSONDataView.fromUint8Array(this.id).getUint32(0,false);timestamp.setTime(Math.floor(time)*1e3);return timestamp}static createPk(){return new ObjectId2}static createFromTime(time){const buffer2=ByteUtils.fromNumberArray([0,0,0,0,0,0,0,0,0,0,0,0]);BSONDataView.fromUint8Array(buffer2).setUint32(0,time,false);return new ObjectId2(buffer2)}static createFromHexString(hexString){if(typeof hexString==="undefined"||hexString!=null&&hexString.length!==24){throw new BSONError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}return new ObjectId2(ByteUtils.fromHex(hexString))}static isValid(id){if(id==null)return false;try{new ObjectId2(id);return true}catch{return false}}toExtendedJSON(){if(this.toHexString)return{$oid:this.toHexString()};return{$oid:this.toString("hex")}}static fromExtendedJSON(doc){return new ObjectId2(doc.$oid)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new ObjectId("${this.toHexString()}")`}};ObjectId2.index=Math.floor(Math.random()*16777215);function internalCalculateObjectSize(object,serializeFunctions,ignoreUndefined){let totalLength=4+1;if(Array.isArray(object)){for(let i3=0;i3<object.length;i3++){totalLength+=calculateElement(i3.toString(),object[i3],serializeFunctions,true,ignoreUndefined)}}else{if(typeof object?.toBSON==="function"){object=object.toBSON()}for(const key of Object.keys(object)){totalLength+=calculateElement(key,object[key],serializeFunctions,false,ignoreUndefined)}}return totalLength}function calculateElement(name2,value,serializeFunctions=false,isArray=false,ignoreUndefined=false){if(typeof value?.toBSON==="function"){value=value.toBSON()}switch(typeof value){case"string":return 1+ByteUtils.utf8ByteLength(name2)+1+4+ByteUtils.utf8ByteLength(value)+1;case"number":if(Math.floor(value)===value&&value>=JS_INT_MIN&&value<=JS_INT_MAX){if(value>=BSON_INT32_MIN&&value<=BSON_INT32_MAX){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(4+1)}else{return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(8+1)}}else{return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(8+1)}case"undefined":if(isArray||!ignoreUndefined)return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1;return 0;case"boolean":return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(1+1);case"object":if(value!=null&&typeof value._bsontype==="string"&&value[Symbol.for("@@mdb.bson.version")]!==BSON_MAJOR_VERSION){throw new BSONVersionError}else if(value==null||value._bsontype==="MinKey"||value._bsontype==="MaxKey"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1}else if(value._bsontype==="ObjectId"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(12+1)}else if(value instanceof Date||isDate(value)){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(8+1)}else if(ArrayBuffer.isView(value)||value instanceof ArrayBuffer||isAnyArrayBuffer(value)){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(1+4+1)+value.byteLength}else if(value._bsontype==="Long"||value._bsontype==="Double"||value._bsontype==="Timestamp"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(8+1)}else if(value._bsontype==="Decimal128"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(16+1)}else if(value._bsontype==="Code"){if(value.scope!=null&&Object.keys(value.scope).length>0){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+4+4+ByteUtils.utf8ByteLength(value.code.toString())+1+internalCalculateObjectSize(value.scope,serializeFunctions,ignoreUndefined)}else{return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+4+ByteUtils.utf8ByteLength(value.code.toString())+1}}else if(value._bsontype==="Binary"){const binary=value;if(binary.sub_type===Binary.SUBTYPE_BYTE_ARRAY){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(binary.position+1+4+1+4)}else{return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(binary.position+1+4+1)}}else if(value._bsontype==="Symbol"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+ByteUtils.utf8ByteLength(value.value)+4+1+1}else if(value._bsontype==="DBRef"){const ordered_values=Object.assign({$ref:value.collection,$id:value.oid},value.fields);if(value.db!=null){ordered_values["$db"]=value.db}return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+internalCalculateObjectSize(ordered_values,serializeFunctions,ignoreUndefined)}else if(value instanceof RegExp||isRegExp(value)){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+ByteUtils.utf8ByteLength(value.source)+1+(value.global?1:0)+(value.ignoreCase?1:0)+(value.multiline?1:0)+1}else if(value._bsontype==="BSONRegExp"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+ByteUtils.utf8ByteLength(value.pattern)+1+ByteUtils.utf8ByteLength(value.options)+1}else{return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+internalCalculateObjectSize(value,serializeFunctions,ignoreUndefined)+1}case"function":if(serializeFunctions){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+4+ByteUtils.utf8ByteLength(value.toString())+1}}return 0}function alphabetize(str23){return str23.split("").sort().join("")}var BSONRegExp=class extends BSONValue{get _bsontype(){return"BSONRegExp"}constructor(pattern,options){super();this.pattern=pattern;this.options=alphabetize(options??"");if(this.pattern.indexOf("\\0")!==-1){throw new BSONError(`BSON Regex patterns cannot contain null bytes, found: ${JSON.stringify(this.pattern)}`)}if(this.options.indexOf("\\0")!==-1){throw new BSONError(`BSON Regex options cannot contain null bytes, found: ${JSON.stringify(this.options)}`)}for(let i3=0;i3<this.options.length;i3++){if(!(this.options[i3]==="i"||this.options[i3]==="m"||this.options[i3]==="x"||this.options[i3]==="l"||this.options[i3]==="s"||this.options[i3]==="u")){throw new BSONError(`The regular expression option [${this.options[i3]}] is not supported`)}}}static parseOptions(options){return options?options.split("").sort().join(""):""}toExtendedJSON(options){options=options||{};if(options.legacy){return{$regex:this.pattern,$options:this.options}}return{$regularExpression:{pattern:this.pattern,options:this.options}}}static fromExtendedJSON(doc){if("$regex"in doc){if(typeof doc.$regex!=="string"){if(doc.$regex._bsontype==="BSONRegExp"){return doc}}else{return new BSONRegExp(doc.$regex,BSONRegExp.parseOptions(doc.$options))}}if("$regularExpression"in doc){return new BSONRegExp(doc.$regularExpression.pattern,BSONRegExp.parseOptions(doc.$regularExpression.options))}throw new BSONError(`Unexpected BSONRegExp EJSON object form: ${JSON.stringify(doc)}`)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new BSONRegExp(${JSON.stringify(this.pattern)}, ${JSON.stringify(this.options)})`}};var BSONSymbol=class extends BSONValue{get _bsontype(){return"BSONSymbol"}constructor(value){super();this.value=value}valueOf(){return this.value}toString(){return this.value}inspect(){return`new BSONSymbol("${this.value}")`}toJSON(){return this.value}toExtendedJSON(){return{$symbol:this.value}}static fromExtendedJSON(doc){return new BSONSymbol(doc.$symbol)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}};var LongWithoutOverridesClass=Long;var Timestamp=class extends LongWithoutOverridesClass{get _bsontype(){return"Timestamp"}constructor(low){if(low==null){super(0,0,true)}else if(typeof low==="bigint"){super(low,true)}else if(Long.isLong(low)){super(low.low,low.high,true)}else if(typeof low==="object"&&"t"in low&&"i"in low){if(typeof low.t!=="number"&&(typeof low.t!=="object"||low.t._bsontype!=="Int32")){throw new BSONError("Timestamp constructed from { t, i } must provide t as a number")}if(typeof low.i!=="number"&&(typeof low.i!=="object"||low.i._bsontype!=="Int32")){throw new BSONError("Timestamp constructed from { t, i } must provide i as a number")}if(low.t<0){throw new BSONError("Timestamp constructed from { t, i } must provide a positive t")}if(low.i<0){throw new BSONError("Timestamp constructed from { t, i } must provide a positive i")}if(low.t>4294967295){throw new BSONError("Timestamp constructed from { t, i } must provide t equal or less than uint32 max")}if(low.i>4294967295){throw new BSONError("Timestamp constructed from { t, i } must provide i equal or less than uint32 max")}super(low.i.valueOf(),low.t.valueOf(),true)}else{throw new BSONError("A Timestamp can only be constructed with: bigint, Long, or { t: number; i: number }")}}toJSON(){return{$timestamp:this.toString()}}static fromInt(value){return new Timestamp(Long.fromInt(value,true))}static fromNumber(value){return new Timestamp(Long.fromNumber(value,true))}static fromBits(lowBits,highBits){return new Timestamp({i:lowBits,t:highBits})}static fromString(str23,optRadix){return new Timestamp(Long.fromString(str23,true,optRadix))}toExtendedJSON(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}}static fromExtendedJSON(doc){const i3=Long.isLong(doc.$timestamp.i)?doc.$timestamp.i.getLowBitsUnsigned():doc.$timestamp.i;const t3=Long.isLong(doc.$timestamp.t)?doc.$timestamp.t.getLowBitsUnsigned():doc.$timestamp.t;return new Timestamp({t:t3,i:i3})}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Timestamp({ t: ${this.getHighBits()}, i: ${this.getLowBits()} })`}};Timestamp.MAX_VALUE=Long.MAX_UNSIGNED_VALUE;var FIRST_BIT=128;var FIRST_TWO_BITS=192;var FIRST_THREE_BITS=224;var FIRST_FOUR_BITS=240;var FIRST_FIVE_BITS=248;var TWO_BIT_CHAR=192;var THREE_BIT_CHAR=224;var FOUR_BIT_CHAR=240;var CONTINUING_CHAR=128;function validateUtf8(bytes,start,end){let continuation=0;for(let i3=start;i3<end;i3+=1){const byte=bytes[i3];if(continuation){if((byte&FIRST_TWO_BITS)!==CONTINUING_CHAR){return false}continuation-=1}else if(byte&FIRST_BIT){if((byte&FIRST_THREE_BITS)===TWO_BIT_CHAR){continuation=1}else if((byte&FIRST_FOUR_BITS)===THREE_BIT_CHAR){continuation=2}else if((byte&FIRST_FIVE_BITS)===FOUR_BIT_CHAR){continuation=3}else{return false}}}return!continuation}var JS_INT_MAX_LONG=Long.fromNumber(JS_INT_MAX);var JS_INT_MIN_LONG=Long.fromNumber(JS_INT_MIN);function internalDeserialize(buffer2,options,isArray){options=options==null?{}:options;const index=options&&options.index?options.index:0;const size=buffer2[index]|buffer2[index+1]<<8|buffer2[index+2]<<16|buffer2[index+3]<<24;if(size<5){throw new BSONError(`bson size must be >= 5, is ${size}`)}if(options.allowObjectSmallerThanBufferSize&&buffer2.length<size){throw new BSONError(`buffer length ${buffer2.length} must be >= bson size ${size}`)}if(!options.allowObjectSmallerThanBufferSize&&buffer2.length!==size){throw new BSONError(`buffer length ${buffer2.length} must === bson size ${size}`)}if(size+index>buffer2.byteLength){throw new BSONError(`(bson size ${size} + options.index ${index} must be <= buffer length ${buffer2.byteLength})`)}if(buffer2[index+size-1]!==0){throw new BSONError("One object, sized correctly, with a spot for an EOO, but the EOO isn\'t 0x00")}return deserializeObject(buffer2,index,options,isArray)}var allowedDBRefKeys=/^\\$ref$|^\\$id$|^\\$db$/;function deserializeObject(buffer2,index,options,isArray=false){const fieldsAsRaw=options["fieldsAsRaw"]==null?null:options["fieldsAsRaw"];const raw=options["raw"]==null?false:options["raw"];const bsonRegExp=typeof options["bsonRegExp"]==="boolean"?options["bsonRegExp"]:false;const promoteBuffers=options.promoteBuffers??false;const promoteLongs=options.promoteLongs??true;const promoteValues=options.promoteValues??true;const useBigInt64=options.useBigInt64??false;if(useBigInt64&&!promoteValues){throw new BSONError("Must either request bigint or Long for int64 deserialization")}if(useBigInt64&&!promoteLongs){throw new BSONError("Must either request bigint or Long for int64 deserialization")}const validation=options.validation==null?{utf8:true}:options.validation;let globalUTFValidation=true;let validationSetting;const utf8KeysSet=new Set;const utf8ValidatedKeys=validation.utf8;if(typeof utf8ValidatedKeys==="boolean"){validationSetting=utf8ValidatedKeys}else{globalUTFValidation=false;const utf8ValidationValues=Object.keys(utf8ValidatedKeys).map(function(key){return utf8ValidatedKeys[key]});if(utf8ValidationValues.length===0){throw new BSONError("UTF-8 validation setting cannot be empty")}if(typeof utf8ValidationValues[0]!=="boolean"){throw new BSONError("Invalid UTF-8 validation option, must specify boolean values")}validationSetting=utf8ValidationValues[0];if(!utf8ValidationValues.every(item=>item===validationSetting)){throw new BSONError("Invalid UTF-8 validation option - keys must be all true or all false")}}if(!globalUTFValidation){for(const key of Object.keys(utf8ValidatedKeys)){utf8KeysSet.add(key)}}const startIndex=index;if(buffer2.length<5)throw new BSONError("corrupt bson message < 5 bytes long");const size=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(size<5||size>buffer2.length)throw new BSONError("corrupt bson message");const object=isArray?[]:{};let arrayIndex=0;const done=false;let isPossibleDBRef=isArray?false:null;const dataview=new DataView(buffer2.buffer,buffer2.byteOffset,buffer2.byteLength);while(!done){const elementType=buffer2[index++];if(elementType===0)break;let i3=index;while(buffer2[i3]!==0&&i3<buffer2.length){i3++}if(i3>=buffer2.byteLength)throw new BSONError("Bad BSON Document: illegal CString");const name2=isArray?arrayIndex++:ByteUtils.toUTF8(buffer2.subarray(index,i3));let shouldValidateKey=true;if(globalUTFValidation||utf8KeysSet.has(name2)){shouldValidateKey=validationSetting}else{shouldValidateKey=!validationSetting}if(isPossibleDBRef!==false&&name2[0]==="$"){isPossibleDBRef=allowedDBRefKeys.test(name2)}let value;index=i3+1;if(elementType===BSON_DATA_STRING){const stringSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(stringSize<=0||stringSize>buffer2.length-index||buffer2[index+stringSize-1]!==0){throw new BSONError("bad string length in bson")}value=getValidatedString(buffer2,index,index+stringSize-1,shouldValidateKey);index=index+stringSize}else if(elementType===BSON_DATA_OID){const oid=ByteUtils.allocate(12);oid.set(buffer2.subarray(index,index+12));value=new ObjectId2(oid);index=index+12}else if(elementType===BSON_DATA_INT&&promoteValues===false){value=new Int32(buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24)}else if(elementType===BSON_DATA_INT){value=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24}else if(elementType===BSON_DATA_NUMBER&&promoteValues===false){value=new Double(dataview.getFloat64(index,true));index=index+8}else if(elementType===BSON_DATA_NUMBER){value=dataview.getFloat64(index,true);index=index+8}else if(elementType===BSON_DATA_DATE){const lowBits=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const highBits=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;value=new Date(new Long(lowBits,highBits).toNumber())}else if(elementType===BSON_DATA_BOOLEAN){if(buffer2[index]!==0&&buffer2[index]!==1)throw new BSONError("illegal boolean type value");value=buffer2[index++]===1}else if(elementType===BSON_DATA_OBJECT){const _index=index;const objectSize=buffer2[index]|buffer2[index+1]<<8|buffer2[index+2]<<16|buffer2[index+3]<<24;if(objectSize<=0||objectSize>buffer2.length-index)throw new BSONError("bad embedded document length in bson");if(raw){value=buffer2.slice(index,index+objectSize)}else{let objectOptions=options;if(!globalUTFValidation){objectOptions={...options,validation:{utf8:shouldValidateKey}}}value=deserializeObject(buffer2,_index,objectOptions,false)}index=index+objectSize}else if(elementType===BSON_DATA_ARRAY){const _index=index;const objectSize=buffer2[index]|buffer2[index+1]<<8|buffer2[index+2]<<16|buffer2[index+3]<<24;let arrayOptions=options;const stopIndex=index+objectSize;if(fieldsAsRaw&&fieldsAsRaw[name2]){arrayOptions={...options,raw:true}}if(!globalUTFValidation){arrayOptions={...arrayOptions,validation:{utf8:shouldValidateKey}}}value=deserializeObject(buffer2,_index,arrayOptions,true);index=index+objectSize;if(buffer2[index-1]!==0)throw new BSONError("invalid array terminator byte");if(index!==stopIndex)throw new BSONError("corrupted array bson")}else if(elementType===BSON_DATA_UNDEFINED){value=void 0}else if(elementType===BSON_DATA_NULL){value=null}else if(elementType===BSON_DATA_LONG){const dataview2=BSONDataView.fromUint8Array(buffer2.subarray(index,index+8));const lowBits=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const highBits=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const long=new Long(lowBits,highBits);if(useBigInt64){value=dataview2.getBigInt64(0,true)}else if(promoteLongs&&promoteValues===true){value=long.lessThanOrEqual(JS_INT_MAX_LONG)&&long.greaterThanOrEqual(JS_INT_MIN_LONG)?long.toNumber():long}else{value=long}}else if(elementType===BSON_DATA_DECIMAL128){const bytes=ByteUtils.allocate(16);bytes.set(buffer2.subarray(index,index+16),0);index=index+16;value=new Decimal128(bytes)}else if(elementType===BSON_DATA_BINARY){let binarySize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const totalBinarySize=binarySize;const subType=buffer2[index++];if(binarySize<0)throw new BSONError("Negative binary type element size found");if(binarySize>buffer2.byteLength)throw new BSONError("Binary type size larger than document size");if(buffer2["slice"]!=null){if(subType===Binary.SUBTYPE_BYTE_ARRAY){binarySize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(binarySize<0)throw new BSONError("Negative binary type element size found for subtype 0x02");if(binarySize>totalBinarySize-4)throw new BSONError("Binary type with subtype 0x02 contains too long binary size");if(binarySize<totalBinarySize-4)throw new BSONError("Binary type with subtype 0x02 contains too short binary size")}if(promoteBuffers&&promoteValues){value=ByteUtils.toLocalBufferType(buffer2.slice(index,index+binarySize))}else{value=new Binary(buffer2.slice(index,index+binarySize),subType);if(subType===BSON_BINARY_SUBTYPE_UUID_NEW){value=value.toUUID()}}}else{const _buffer=ByteUtils.allocate(binarySize);if(subType===Binary.SUBTYPE_BYTE_ARRAY){binarySize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(binarySize<0)throw new BSONError("Negative binary type element size found for subtype 0x02");if(binarySize>totalBinarySize-4)throw new BSONError("Binary type with subtype 0x02 contains too long binary size");if(binarySize<totalBinarySize-4)throw new BSONError("Binary type with subtype 0x02 contains too short binary size")}for(i3=0;i3<binarySize;i3++){_buffer[i3]=buffer2[index+i3]}if(promoteBuffers&&promoteValues){value=_buffer}else if(subType===BSON_BINARY_SUBTYPE_UUID_NEW){value=new Binary(buffer2.slice(index,index+binarySize),subType).toUUID()}else{value=new Binary(buffer2.slice(index,index+binarySize),subType)}}index=index+binarySize}else if(elementType===BSON_DATA_REGEXP&&bsonRegExp===false){i3=index;while(buffer2[i3]!==0&&i3<buffer2.length){i3++}if(i3>=buffer2.length)throw new BSONError("Bad BSON Document: illegal CString");const source=ByteUtils.toUTF8(buffer2.subarray(index,i3));index=i3+1;i3=index;while(buffer2[i3]!==0&&i3<buffer2.length){i3++}if(i3>=buffer2.length)throw new BSONError("Bad BSON Document: illegal CString");const regExpOptions=ByteUtils.toUTF8(buffer2.subarray(index,i3));index=i3+1;const optionsArray=new Array(regExpOptions.length);for(i3=0;i3<regExpOptions.length;i3++){switch(regExpOptions[i3]){case"m":optionsArray[i3]="m";break;case"s":optionsArray[i3]="g";break;case"i":optionsArray[i3]="i";break}}value=new RegExp(source,optionsArray.join(""))}else if(elementType===BSON_DATA_REGEXP&&bsonRegExp===true){i3=index;while(buffer2[i3]!==0&&i3<buffer2.length){i3++}if(i3>=buffer2.length)throw new BSONError("Bad BSON Document: illegal CString");const source=ByteUtils.toUTF8(buffer2.subarray(index,i3));index=i3+1;i3=index;while(buffer2[i3]!==0&&i3<buffer2.length){i3++}if(i3>=buffer2.length)throw new BSONError("Bad BSON Document: illegal CString");const regExpOptions=ByteUtils.toUTF8(buffer2.subarray(index,i3));index=i3+1;value=new BSONRegExp(source,regExpOptions)}else if(elementType===BSON_DATA_SYMBOL){const stringSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(stringSize<=0||stringSize>buffer2.length-index||buffer2[index+stringSize-1]!==0){throw new BSONError("bad string length in bson")}const symbol=getValidatedString(buffer2,index,index+stringSize-1,shouldValidateKey);value=promoteValues?symbol:new BSONSymbol(symbol);index=index+stringSize}else if(elementType===BSON_DATA_TIMESTAMP){const i22=buffer2[index++]+buffer2[index++]*(1<<8)+buffer2[index++]*(1<<16)+buffer2[index++]*(1<<24);const t3=buffer2[index++]+buffer2[index++]*(1<<8)+buffer2[index++]*(1<<16)+buffer2[index++]*(1<<24);value=new Timestamp({i:i22,t:t3})}else if(elementType===BSON_DATA_MIN_KEY){value=new MinKey}else if(elementType===BSON_DATA_MAX_KEY){value=new MaxKey}else if(elementType===BSON_DATA_CODE){const stringSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(stringSize<=0||stringSize>buffer2.length-index||buffer2[index+stringSize-1]!==0){throw new BSONError("bad string length in bson")}const functionString=getValidatedString(buffer2,index,index+stringSize-1,shouldValidateKey);value=new Code(functionString);index=index+stringSize}else if(elementType===BSON_DATA_CODE_W_SCOPE){const totalSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(totalSize<4+4+4+1){throw new BSONError("code_w_scope total size shorter minimum expected length")}const stringSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(stringSize<=0||stringSize>buffer2.length-index||buffer2[index+stringSize-1]!==0){throw new BSONError("bad string length in bson")}const functionString=getValidatedString(buffer2,index,index+stringSize-1,shouldValidateKey);index=index+stringSize;const _index=index;const objectSize=buffer2[index]|buffer2[index+1]<<8|buffer2[index+2]<<16|buffer2[index+3]<<24;const scopeObject=deserializeObject(buffer2,_index,options,false);index=index+objectSize;if(totalSize<4+4+objectSize+stringSize){throw new BSONError("code_w_scope total size is too short, truncating scope")}if(totalSize>4+4+objectSize+stringSize){throw new BSONError("code_w_scope total size is too long, clips outer document")}value=new Code(functionString,scopeObject)}else if(elementType===BSON_DATA_DBPOINTER){const stringSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(stringSize<=0||stringSize>buffer2.length-index||buffer2[index+stringSize-1]!==0)throw new BSONError("bad string length in bson");if(validation!=null&&validation.utf8){if(!validateUtf8(buffer2,index,index+stringSize-1)){throw new BSONError("Invalid UTF-8 string in BSON document")}}const namespace=ByteUtils.toUTF8(buffer2.subarray(index,index+stringSize-1));index=index+stringSize;const oidBuffer=ByteUtils.allocate(12);oidBuffer.set(buffer2.subarray(index,index+12),0);const oid=new ObjectId2(oidBuffer);index=index+12;value=new DBRef(namespace,oid)}else{throw new BSONError(`Detected unknown BSON type ${elementType.toString(16)} for fieldname "${name2}"`)}if(name2==="__proto__"){Object.defineProperty(object,name2,{value,writable:true,enumerable:true,configurable:true})}else{object[name2]=value}}if(size!==index-startIndex){if(isArray)throw new BSONError("corrupt array bson");throw new BSONError("corrupt object bson")}if(!isPossibleDBRef)return object;if(isDBRefLike(object)){const copy=Object.assign({},object);delete copy.$ref;delete copy.$id;delete copy.$db;return new DBRef(object.$ref,object.$id,object.$db,copy)}return object}function getValidatedString(buffer2,start,end,shouldValidateUtf8){const value=ByteUtils.toUTF8(buffer2.subarray(start,end));if(shouldValidateUtf8){for(let i3=0;i3<value.length;i3++){if(value.charCodeAt(i3)===65533){if(!validateUtf8(buffer2,start,end)){throw new BSONError("Invalid UTF-8 string in BSON document")}break}}}return value}var regexp=/\\x00/;var ignoreKeys=new Set(["$db","$ref","$id","$clusterTime"]);function serializeString(buffer2,key,value,index){buffer2[index++]=BSON_DATA_STRING;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes+1;buffer2[index-1]=0;const size=ByteUtils.encodeUTF8Into(buffer2,value,index+4);buffer2[index+3]=size+1>>24&255;buffer2[index+2]=size+1>>16&255;buffer2[index+1]=size+1>>8&255;buffer2[index]=size+1&255;index=index+4+size;buffer2[index++]=0;return index}var NUMBER_SPACE=new DataView(new ArrayBuffer(8),0,8);var FOUR_BYTE_VIEW_ON_NUMBER=new Uint8Array(NUMBER_SPACE.buffer,0,4);var EIGHT_BYTE_VIEW_ON_NUMBER=new Uint8Array(NUMBER_SPACE.buffer,0,8);function serializeNumber(buffer2,key,value,index){const isNegativeZero=Object.is(value,-0);const type=!isNegativeZero&&Number.isSafeInteger(value)&&value<=BSON_INT32_MAX&&value>=BSON_INT32_MIN?BSON_DATA_INT:BSON_DATA_NUMBER;if(type===BSON_DATA_INT){NUMBER_SPACE.setInt32(0,value,true)}else{NUMBER_SPACE.setFloat64(0,value,true)}const bytes=type===BSON_DATA_INT?FOUR_BYTE_VIEW_ON_NUMBER:EIGHT_BYTE_VIEW_ON_NUMBER;buffer2[index++]=type;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;buffer2.set(bytes,index);index+=bytes.byteLength;return index}function serializeBigInt(buffer2,key,value,index){buffer2[index++]=BSON_DATA_LONG;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index+=numberOfWrittenBytes;buffer2[index++]=0;NUMBER_SPACE.setBigInt64(0,value,true);buffer2.set(EIGHT_BYTE_VIEW_ON_NUMBER,index);index+=EIGHT_BYTE_VIEW_ON_NUMBER.byteLength;return index}function serializeNull(buffer2,key,_,index){buffer2[index++]=BSON_DATA_NULL;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;return index}function serializeBoolean(buffer2,key,value,index){buffer2[index++]=BSON_DATA_BOOLEAN;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;buffer2[index++]=value?1:0;return index}function serializeDate(buffer2,key,value,index){buffer2[index++]=BSON_DATA_DATE;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const dateInMilis=Long.fromNumber(value.getTime());const lowBits=dateInMilis.getLowBits();const highBits=dateInMilis.getHighBits();buffer2[index++]=lowBits&255;buffer2[index++]=lowBits>>8&255;buffer2[index++]=lowBits>>16&255;buffer2[index++]=lowBits>>24&255;buffer2[index++]=highBits&255;buffer2[index++]=highBits>>8&255;buffer2[index++]=highBits>>16&255;buffer2[index++]=highBits>>24&255;return index}function serializeRegExp(buffer2,key,value,index){buffer2[index++]=BSON_DATA_REGEXP;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;if(value.source&&value.source.match(regexp)!=null){throw new BSONError("value "+value.source+" must not contain null bytes")}index=index+ByteUtils.encodeUTF8Into(buffer2,value.source,index);buffer2[index++]=0;if(value.ignoreCase)buffer2[index++]=105;if(value.global)buffer2[index++]=115;if(value.multiline)buffer2[index++]=109;buffer2[index++]=0;return index}function serializeBSONRegExp(buffer2,key,value,index){buffer2[index++]=BSON_DATA_REGEXP;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;if(value.pattern.match(regexp)!=null){throw new BSONError("pattern "+value.pattern+" must not contain null bytes")}index=index+ByteUtils.encodeUTF8Into(buffer2,value.pattern,index);buffer2[index++]=0;const sortedOptions=value.options.split("").sort().join("");index=index+ByteUtils.encodeUTF8Into(buffer2,sortedOptions,index);buffer2[index++]=0;return index}function serializeMinMax(buffer2,key,value,index){if(value===null){buffer2[index++]=BSON_DATA_NULL}else if(value._bsontype==="MinKey"){buffer2[index++]=BSON_DATA_MIN_KEY}else{buffer2[index++]=BSON_DATA_MAX_KEY}const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;return index}function serializeObjectId(buffer2,key,value,index){buffer2[index++]=BSON_DATA_OID;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;if(isUint8Array(value.id)){buffer2.set(value.id.subarray(0,12),index)}else{throw new BSONError("object ["+JSON.stringify(value)+"] is not a valid ObjectId")}return index+12}function serializeBuffer(buffer2,key,value,index){buffer2[index++]=BSON_DATA_BINARY;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const size=value.length;buffer2[index++]=size&255;buffer2[index++]=size>>8&255;buffer2[index++]=size>>16&255;buffer2[index++]=size>>24&255;buffer2[index++]=BSON_BINARY_SUBTYPE_DEFAULT;buffer2.set(value,index);index=index+size;return index}function serializeObject(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path){if(path.has(value)){throw new BSONError("Cannot convert circular structure to BSON")}path.add(value);buffer2[index++]=Array.isArray(value)?BSON_DATA_ARRAY:BSON_DATA_OBJECT;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const endIndex=serializeInto(buffer2,value,checkKeys,index,depth+1,serializeFunctions,ignoreUndefined,path);path.delete(value);return endIndex}function serializeDecimal128(buffer2,key,value,index){buffer2[index++]=BSON_DATA_DECIMAL128;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;buffer2.set(value.bytes.subarray(0,16),index);return index+16}function serializeLong(buffer2,key,value,index){buffer2[index++]=value._bsontype==="Long"?BSON_DATA_LONG:BSON_DATA_TIMESTAMP;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const lowBits=value.getLowBits();const highBits=value.getHighBits();buffer2[index++]=lowBits&255;buffer2[index++]=lowBits>>8&255;buffer2[index++]=lowBits>>16&255;buffer2[index++]=lowBits>>24&255;buffer2[index++]=highBits&255;buffer2[index++]=highBits>>8&255;buffer2[index++]=highBits>>16&255;buffer2[index++]=highBits>>24&255;return index}function serializeInt32(buffer2,key,value,index){value=value.valueOf();buffer2[index++]=BSON_DATA_INT;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;buffer2[index++]=value&255;buffer2[index++]=value>>8&255;buffer2[index++]=value>>16&255;buffer2[index++]=value>>24&255;return index}function serializeDouble(buffer2,key,value,index){buffer2[index++]=BSON_DATA_NUMBER;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;NUMBER_SPACE.setFloat64(0,value.value,true);buffer2.set(EIGHT_BYTE_VIEW_ON_NUMBER,index);index=index+8;return index}function serializeFunction(buffer2,key,value,index){buffer2[index++]=BSON_DATA_CODE;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const functionString=value.toString();const size=ByteUtils.encodeUTF8Into(buffer2,functionString,index+4)+1;buffer2[index]=size&255;buffer2[index+1]=size>>8&255;buffer2[index+2]=size>>16&255;buffer2[index+3]=size>>24&255;index=index+4+size-1;buffer2[index++]=0;return index}function serializeCode(buffer2,key,value,index,checkKeys=false,depth=0,serializeFunctions=false,ignoreUndefined=true,path){if(value.scope&&typeof value.scope==="object"){buffer2[index++]=BSON_DATA_CODE_W_SCOPE;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;let startIndex=index;const functionString=value.code;index=index+4;const codeSize=ByteUtils.encodeUTF8Into(buffer2,functionString,index+4)+1;buffer2[index]=codeSize&255;buffer2[index+1]=codeSize>>8&255;buffer2[index+2]=codeSize>>16&255;buffer2[index+3]=codeSize>>24&255;buffer2[index+4+codeSize-1]=0;index=index+codeSize+4;const endIndex=serializeInto(buffer2,value.scope,checkKeys,index,depth+1,serializeFunctions,ignoreUndefined,path);index=endIndex-1;const totalSize=endIndex-startIndex;buffer2[startIndex++]=totalSize&255;buffer2[startIndex++]=totalSize>>8&255;buffer2[startIndex++]=totalSize>>16&255;buffer2[startIndex++]=totalSize>>24&255;buffer2[index++]=0}else{buffer2[index++]=BSON_DATA_CODE;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const functionString=value.code.toString();const size=ByteUtils.encodeUTF8Into(buffer2,functionString,index+4)+1;buffer2[index]=size&255;buffer2[index+1]=size>>8&255;buffer2[index+2]=size>>16&255;buffer2[index+3]=size>>24&255;index=index+4+size-1;buffer2[index++]=0}return index}function serializeBinary(buffer2,key,value,index){buffer2[index++]=BSON_DATA_BINARY;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const data=value.buffer;let size=value.position;if(value.sub_type===Binary.SUBTYPE_BYTE_ARRAY)size=size+4;buffer2[index++]=size&255;buffer2[index++]=size>>8&255;buffer2[index++]=size>>16&255;buffer2[index++]=size>>24&255;buffer2[index++]=value.sub_type;if(value.sub_type===Binary.SUBTYPE_BYTE_ARRAY){size=size-4;buffer2[index++]=size&255;buffer2[index++]=size>>8&255;buffer2[index++]=size>>16&255;buffer2[index++]=size>>24&255}buffer2.set(data,index);index=index+value.position;return index}function serializeSymbol(buffer2,key,value,index){buffer2[index++]=BSON_DATA_SYMBOL;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const size=ByteUtils.encodeUTF8Into(buffer2,value.value,index+4)+1;buffer2[index]=size&255;buffer2[index+1]=size>>8&255;buffer2[index+2]=size>>16&255;buffer2[index+3]=size>>24&255;index=index+4+size-1;buffer2[index++]=0;return index}function serializeDBRef(buffer2,key,value,index,depth,serializeFunctions,path){buffer2[index++]=BSON_DATA_OBJECT;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;let startIndex=index;let output={$ref:value.collection||value.namespace,$id:value.oid};if(value.db!=null){output.$db=value.db}output=Object.assign(output,value.fields);const endIndex=serializeInto(buffer2,output,false,index,depth+1,serializeFunctions,true,path);const size=endIndex-startIndex;buffer2[startIndex++]=size&255;buffer2[startIndex++]=size>>8&255;buffer2[startIndex++]=size>>16&255;buffer2[startIndex++]=size>>24&255;return endIndex}function serializeInto(buffer2,object,checkKeys,startingIndex,depth,serializeFunctions,ignoreUndefined,path){if(path==null){if(object==null){buffer2[0]=5;buffer2[1]=0;buffer2[2]=0;buffer2[3]=0;buffer2[4]=0;return 5}if(Array.isArray(object)){throw new BSONError("serialize does not support an array as the root input")}if(typeof object!=="object"){throw new BSONError("serialize does not support non-object as the root input")}else if("_bsontype"in object&&typeof object._bsontype==="string"){throw new BSONError(`BSON types cannot be serialized as a document`)}else if(isDate(object)||isRegExp(object)||isUint8Array(object)||isAnyArrayBuffer(object)){throw new BSONError(`date, regexp, typedarray, and arraybuffer cannot be BSON documents`)}path=new Set}path.add(object);let index=startingIndex+4;if(Array.isArray(object)){for(let i3=0;i3<object.length;i3++){const key=`${i3}`;let value=object[i3];if(typeof value?.toBSON==="function"){value=value.toBSON()}if(typeof value==="string"){index=serializeString(buffer2,key,value,index)}else if(typeof value==="number"){index=serializeNumber(buffer2,key,value,index)}else if(typeof value==="bigint"){index=serializeBigInt(buffer2,key,value,index)}else if(typeof value==="boolean"){index=serializeBoolean(buffer2,key,value,index)}else if(value instanceof Date||isDate(value)){index=serializeDate(buffer2,key,value,index)}else if(value===void 0){index=serializeNull(buffer2,key,value,index)}else if(value===null){index=serializeNull(buffer2,key,value,index)}else if(isUint8Array(value)){index=serializeBuffer(buffer2,key,value,index)}else if(value instanceof RegExp||isRegExp(value)){index=serializeRegExp(buffer2,key,value,index)}else if(typeof value==="object"&&value._bsontype==null){index=serializeObject(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(typeof value==="object"&&value[Symbol.for("@@mdb.bson.version")]!==BSON_MAJOR_VERSION){throw new BSONVersionError}else if(value._bsontype==="ObjectId"){index=serializeObjectId(buffer2,key,value,index)}else if(value._bsontype==="Decimal128"){index=serializeDecimal128(buffer2,key,value,index)}else if(value._bsontype==="Long"||value._bsontype==="Timestamp"){index=serializeLong(buffer2,key,value,index)}else if(value._bsontype==="Double"){index=serializeDouble(buffer2,key,value,index)}else if(typeof value==="function"&&serializeFunctions){index=serializeFunction(buffer2,key,value,index)}else if(value._bsontype==="Code"){index=serializeCode(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(value._bsontype==="Binary"){index=serializeBinary(buffer2,key,value,index)}else if(value._bsontype==="BSONSymbol"){index=serializeSymbol(buffer2,key,value,index)}else if(value._bsontype==="DBRef"){index=serializeDBRef(buffer2,key,value,index,depth,serializeFunctions,path)}else if(value._bsontype==="BSONRegExp"){index=serializeBSONRegExp(buffer2,key,value,index)}else if(value._bsontype==="Int32"){index=serializeInt32(buffer2,key,value,index)}else if(value._bsontype==="MinKey"||value._bsontype==="MaxKey"){index=serializeMinMax(buffer2,key,value,index)}else if(typeof value._bsontype!=="undefined"){throw new BSONError(`Unrecognized or invalid _bsontype: ${String(value._bsontype)}`)}}}else if(object instanceof Map||isMap(object)){const iterator=object.entries();let done=false;while(!done){const entry=iterator.next();done=!!entry.done;if(done)continue;const key=entry.value[0];let value=entry.value[1];if(typeof value?.toBSON==="function"){value=value.toBSON()}const type=typeof value;if(typeof key==="string"&&!ignoreKeys.has(key)){if(key.match(regexp)!=null){throw new BSONError("key "+key+" must not contain null bytes")}if(checkKeys){if("$"===key[0]){throw new BSONError("key "+key+" must not start with \'$\'")}else if(~key.indexOf(".")){throw new BSONError("key "+key+" must not contain \'.\'")}}}if(type==="string"){index=serializeString(buffer2,key,value,index)}else if(type==="number"){index=serializeNumber(buffer2,key,value,index)}else if(type==="bigint"){index=serializeBigInt(buffer2,key,value,index)}else if(type==="boolean"){index=serializeBoolean(buffer2,key,value,index)}else if(value instanceof Date||isDate(value)){index=serializeDate(buffer2,key,value,index)}else if(value===null||value===void 0&&ignoreUndefined===false){index=serializeNull(buffer2,key,value,index)}else if(isUint8Array(value)){index=serializeBuffer(buffer2,key,value,index)}else if(value instanceof RegExp||isRegExp(value)){index=serializeRegExp(buffer2,key,value,index)}else if(type==="object"&&value._bsontype==null){index=serializeObject(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(typeof value==="object"&&value[Symbol.for("@@mdb.bson.version")]!==BSON_MAJOR_VERSION){throw new BSONVersionError}else if(value._bsontype==="ObjectId"){index=serializeObjectId(buffer2,key,value,index)}else if(type==="object"&&value._bsontype==="Decimal128"){index=serializeDecimal128(buffer2,key,value,index)}else if(value._bsontype==="Long"||value._bsontype==="Timestamp"){index=serializeLong(buffer2,key,value,index)}else if(value._bsontype==="Double"){index=serializeDouble(buffer2,key,value,index)}else if(value._bsontype==="Code"){index=serializeCode(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(typeof value==="function"&&serializeFunctions){index=serializeFunction(buffer2,key,value,index)}else if(value._bsontype==="Binary"){index=serializeBinary(buffer2,key,value,index)}else if(value._bsontype==="BSONSymbol"){index=serializeSymbol(buffer2,key,value,index)}else if(value._bsontype==="DBRef"){index=serializeDBRef(buffer2,key,value,index,depth,serializeFunctions,path)}else if(value._bsontype==="BSONRegExp"){index=serializeBSONRegExp(buffer2,key,value,index)}else if(value._bsontype==="Int32"){index=serializeInt32(buffer2,key,value,index)}else if(value._bsontype==="MinKey"||value._bsontype==="MaxKey"){index=serializeMinMax(buffer2,key,value,index)}else if(typeof value._bsontype!=="undefined"){throw new BSONError(`Unrecognized or invalid _bsontype: ${String(value._bsontype)}`)}}}else{if(typeof object?.toBSON==="function"){object=object.toBSON();if(object!=null&&typeof object!=="object"){throw new BSONError("toBSON function did not return an object")}}for(const key of Object.keys(object)){let value=object[key];if(typeof value?.toBSON==="function"){value=value.toBSON()}const type=typeof value;if(typeof key==="string"&&!ignoreKeys.has(key)){if(key.match(regexp)!=null){throw new BSONError("key "+key+" must not contain null bytes")}if(checkKeys){if("$"===key[0]){throw new BSONError("key "+key+" must not start with \'$\'")}else if(~key.indexOf(".")){throw new BSONError("key "+key+" must not contain \'.\'")}}}if(type==="string"){index=serializeString(buffer2,key,value,index)}else if(type==="number"){index=serializeNumber(buffer2,key,value,index)}else if(type==="bigint"){index=serializeBigInt(buffer2,key,value,index)}else if(type==="boolean"){index=serializeBoolean(buffer2,key,value,index)}else if(value instanceof Date||isDate(value)){index=serializeDate(buffer2,key,value,index)}else if(value===void 0){if(ignoreUndefined===false)index=serializeNull(buffer2,key,value,index)}else if(value===null){index=serializeNull(buffer2,key,value,index)}else if(isUint8Array(value)){index=serializeBuffer(buffer2,key,value,index)}else if(value instanceof RegExp||isRegExp(value)){index=serializeRegExp(buffer2,key,value,index)}else if(type==="object"&&value._bsontype==null){index=serializeObject(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(typeof value==="object"&&value[Symbol.for("@@mdb.bson.version")]!==BSON_MAJOR_VERSION){throw new BSONVersionError}else if(value._bsontype==="ObjectId"){index=serializeObjectId(buffer2,key,value,index)}else if(type==="object"&&value._bsontype==="Decimal128"){index=serializeDecimal128(buffer2,key,value,index)}else if(value._bsontype==="Long"||value._bsontype==="Timestamp"){index=serializeLong(buffer2,key,value,index)}else if(value._bsontype==="Double"){index=serializeDouble(buffer2,key,value,index)}else if(value._bsontype==="Code"){index=serializeCode(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(typeof value==="function"&&serializeFunctions){index=serializeFunction(buffer2,key,value,index)}else if(value._bsontype==="Binary"){index=serializeBinary(buffer2,key,value,index)}else if(value._bsontype==="BSONSymbol"){index=serializeSymbol(buffer2,key,value,index)}else if(value._bsontype==="DBRef"){index=serializeDBRef(buffer2,key,value,index,depth,serializeFunctions,path)}else if(value._bsontype==="BSONRegExp"){index=serializeBSONRegExp(buffer2,key,value,index)}else if(value._bsontype==="Int32"){index=serializeInt32(buffer2,key,value,index)}else if(value._bsontype==="MinKey"||value._bsontype==="MaxKey"){index=serializeMinMax(buffer2,key,value,index)}else if(typeof value._bsontype!=="undefined"){throw new BSONError(`Unrecognized or invalid _bsontype: ${String(value._bsontype)}`)}}}path.delete(object);buffer2[index++]=0;const size=index-startingIndex;buffer2[startingIndex++]=size&255;buffer2[startingIndex++]=size>>8&255;buffer2[startingIndex++]=size>>16&255;buffer2[startingIndex++]=size>>24&255;return index}function isBSONType(value){return value!=null&&typeof value==="object"&&"_bsontype"in value&&typeof value._bsontype==="string"}var keysToCodecs={$oid:ObjectId2,$binary:Binary,$uuid:Binary,$symbol:BSONSymbol,$numberInt:Int32,$numberDecimal:Decimal128,$numberDouble:Double,$numberLong:Long,$minKey:MinKey,$maxKey:MaxKey,$regex:BSONRegExp,$regularExpression:BSONRegExp,$timestamp:Timestamp};function deserializeValue(value,options={}){if(typeof value==="number"){const in32BitRange=value<=BSON_INT32_MAX&&value>=BSON_INT32_MIN;const in64BitRange=value<=BSON_INT64_MAX&&value>=BSON_INT64_MIN;if(options.relaxed||options.legacy){return value}if(Number.isInteger(value)&&!Object.is(value,-0)){if(in32BitRange){return new Int32(value)}if(in64BitRange){if(options.useBigInt64){return BigInt(value)}return Long.fromNumber(value)}}return new Double(value)}if(value==null||typeof value!=="object")return value;if(value.$undefined)return null;const keys3=Object.keys(value).filter(k=>k.startsWith("$")&&value[k]!=null);for(let i3=0;i3<keys3.length;i3++){const c=keysToCodecs[keys3[i3]];if(c)return c.fromExtendedJSON(value,options)}if(value.$date!=null){const d2=value.$date;const date=new Date;if(options.legacy){if(typeof d2==="number")date.setTime(d2);else if(typeof d2==="string")date.setTime(Date.parse(d2));else if(typeof d2==="bigint")date.setTime(Number(d2));else throw new BSONRuntimeError(`Unrecognized type for EJSON date: ${typeof d2}`)}else{if(typeof d2==="string")date.setTime(Date.parse(d2));else if(Long.isLong(d2))date.setTime(d2.toNumber());else if(typeof d2==="number"&&options.relaxed)date.setTime(d2);else if(typeof d2==="bigint")date.setTime(Number(d2));else throw new BSONRuntimeError(`Unrecognized type for EJSON date: ${typeof d2}`)}return date}if(value.$code!=null){const copy=Object.assign({},value);if(value.$scope){copy.$scope=deserializeValue(value.$scope)}return Code.fromExtendedJSON(value)}if(isDBRefLike(value)||value.$dbPointer){const v2=value.$ref?value:value.$dbPointer;if(v2 instanceof DBRef)return v2;const dollarKeys=Object.keys(v2).filter(k=>k.startsWith("$"));let valid=true;dollarKeys.forEach(k=>{if(["$ref","$id","$db"].indexOf(k)===-1)valid=false});if(valid)return DBRef.fromExtendedJSON(v2)}return value}function serializeArray(array,options){return array.map((v2,index)=>{options.seenObjects.push({propertyName:`index ${index}`,obj:null});try{return serializeValue(v2,options)}finally{options.seenObjects.pop()}})}function getISOString(date){const isoStr=date.toISOString();return date.getUTCMilliseconds()!==0?isoStr:isoStr.slice(0,-5)+"Z"}function serializeValue(value,options){if(value instanceof Map||isMap(value)){const obj=Object.create(null);for(const[k,v2]of value){if(typeof k!=="string"){throw new BSONError("Can only serialize maps with string keys")}obj[k]=v2}return serializeValue(obj,options)}if((typeof value==="object"||typeof value==="function")&&value!==null){const index=options.seenObjects.findIndex(entry=>entry.obj===value);if(index!==-1){const props=options.seenObjects.map(entry=>entry.propertyName);const leadingPart=props.slice(0,index).map(prop=>`${prop} -> `).join("");const alreadySeen=props[index];const circularPart=" -> "+props.slice(index+1,props.length-1).map(prop=>`${prop} -> `).join("");const current=props[props.length-1];const leadingSpace=" ".repeat(leadingPart.length+alreadySeen.length/2);const dashes="-".repeat(circularPart.length+(alreadySeen.length+current.length)/2-1);throw new BSONError(`Converting circular structure to EJSON:\n    ${leadingPart}${alreadySeen}${circularPart}${current}\n    ${leadingSpace}\\\\${dashes}/`)}options.seenObjects[options.seenObjects.length-1].obj=value}if(Array.isArray(value))return serializeArray(value,options);if(value===void 0)return null;if(value instanceof Date||isDate(value)){const dateNum=value.getTime(),inRange=dateNum>-1&&dateNum<2534023188e5;if(options.legacy){return options.relaxed&&inRange?{$date:value.getTime()}:{$date:getISOString(value)}}return options.relaxed&&inRange?{$date:getISOString(value)}:{$date:{$numberLong:value.getTime().toString()}}}if(typeof value==="number"&&(!options.relaxed||!isFinite(value))){if(Number.isInteger(value)&&!Object.is(value,-0)){if(value>=BSON_INT32_MIN&&value<=BSON_INT32_MAX){return{$numberInt:value.toString()}}if(value>=BSON_INT64_MIN&&value<=BSON_INT64_MAX){return{$numberLong:value.toString()}}}return{$numberDouble:Object.is(value,-0)?"-0.0":value.toString()}}if(typeof value==="bigint"){if(!options.relaxed){return{$numberLong:BigInt.asIntN(64,value).toString()}}return Number(BigInt.asIntN(64,value))}if(value instanceof RegExp||isRegExp(value)){let flags=value.flags;if(flags===void 0){const match=value.toString().match(/[gimuy]*$/);if(match){flags=match[0]}}const rx=new BSONRegExp(value.source,flags);return rx.toExtendedJSON(options)}if(value!=null&&typeof value==="object")return serializeDocument(value,options);return value}var BSON_TYPE_MAPPINGS={Binary:o=>new Binary(o.value(),o.sub_type),Code:o=>new Code(o.code,o.scope),DBRef:o=>new DBRef(o.collection||o.namespace,o.oid,o.db,o.fields),Decimal128:o=>new Decimal128(o.bytes),Double:o=>new Double(o.value),Int32:o=>new Int32(o.value),Long:o=>Long.fromBits(o.low!=null?o.low:o.low_,o.low!=null?o.high:o.high_,o.low!=null?o.unsigned:o.unsigned_),MaxKey:()=>new MaxKey,MinKey:()=>new MinKey,ObjectId:o=>new ObjectId2(o),BSONRegExp:o=>new BSONRegExp(o.pattern,o.options),BSONSymbol:o=>new BSONSymbol(o.value),Timestamp:o=>Timestamp.fromBits(o.low,o.high)};function serializeDocument(doc,options){if(doc==null||typeof doc!=="object")throw new BSONError("not an object instance");const bsontype=doc._bsontype;if(typeof bsontype==="undefined"){const _doc={};for(const name2 of Object.keys(doc)){options.seenObjects.push({propertyName:name2,obj:null});try{const value=serializeValue(doc[name2],options);if(name2==="__proto__"){Object.defineProperty(_doc,name2,{value,writable:true,enumerable:true,configurable:true})}else{_doc[name2]=value}}finally{options.seenObjects.pop()}}return _doc}else if(doc!=null&&typeof doc==="object"&&typeof doc._bsontype==="string"&&doc[Symbol.for("@@mdb.bson.version")]!==BSON_MAJOR_VERSION){throw new BSONVersionError}else if(isBSONType(doc)){let outDoc=doc;if(typeof outDoc.toExtendedJSON!=="function"){const mapper=BSON_TYPE_MAPPINGS[doc._bsontype];if(!mapper){throw new BSONError("Unrecognized or invalid _bsontype: "+doc._bsontype)}outDoc=mapper(outDoc)}if(bsontype==="Code"&&outDoc.scope){outDoc=new Code(outDoc.code,serializeValue(outDoc.scope,options))}else if(bsontype==="DBRef"&&outDoc.oid){outDoc=new DBRef(serializeValue(outDoc.collection,options),serializeValue(outDoc.oid,options),serializeValue(outDoc.db,options),serializeValue(outDoc.fields,options))}return outDoc.toExtendedJSON(options)}else{throw new BSONError("_bsontype must be a string, but was: "+typeof bsontype)}}function parse(text,options){const ejsonOptions={useBigInt64:options?.useBigInt64??false,relaxed:options?.relaxed??true,legacy:options?.legacy??false};return JSON.parse(text,(key,value)=>{if(key.indexOf("\\0")!==-1){throw new BSONError(`BSON Document field names cannot contain null bytes, found: ${JSON.stringify(key)}`)}return deserializeValue(value,ejsonOptions)})}function stringify(value,replacer,space,options){if(space!=null&&typeof space==="object"){options=space;space=0}if(replacer!=null&&typeof replacer==="object"&&!Array.isArray(replacer)){options=replacer;replacer=void 0;space=0}const serializeOptions=Object.assign({relaxed:true,legacy:false},options,{seenObjects:[{propertyName:"(root)",obj:null}]});const doc=serializeValue(value,serializeOptions);return JSON.stringify(doc,replacer,space)}function EJSONserialize(value,options){options=options||{};return JSON.parse(stringify(value,options))}function EJSONdeserialize(ejson,options){options=options||{};return parse(JSON.stringify(ejson),options)}var EJSON=Object.create(null);EJSON.parse=parse;EJSON.stringify=stringify;EJSON.serialize=EJSONserialize;EJSON.deserialize=EJSONdeserialize;Object.freeze(EJSON);var MAXSIZE=1024*1024*17;var buffer=ByteUtils.allocate(MAXSIZE);function setInternalBufferSize(size){if(buffer.length<size){buffer=ByteUtils.allocate(size)}}function serialize(object,options={}){const checkKeys=typeof options.checkKeys==="boolean"?options.checkKeys:false;const serializeFunctions=typeof options.serializeFunctions==="boolean"?options.serializeFunctions:false;const ignoreUndefined=typeof options.ignoreUndefined==="boolean"?options.ignoreUndefined:true;const minInternalBufferSize=typeof options.minInternalBufferSize==="number"?options.minInternalBufferSize:MAXSIZE;if(buffer.length<minInternalBufferSize){buffer=ByteUtils.allocate(minInternalBufferSize)}const serializationIndex=serializeInto(buffer,object,checkKeys,0,0,serializeFunctions,ignoreUndefined,null);const finishedBuffer=ByteUtils.allocate(serializationIndex);finishedBuffer.set(buffer.subarray(0,serializationIndex),0);return finishedBuffer}function serializeWithBufferAndIndex(object,finalBuffer,options={}){const checkKeys=typeof options.checkKeys==="boolean"?options.checkKeys:false;const serializeFunctions=typeof options.serializeFunctions==="boolean"?options.serializeFunctions:false;const ignoreUndefined=typeof options.ignoreUndefined==="boolean"?options.ignoreUndefined:true;const startIndex=typeof options.index==="number"?options.index:0;const serializationIndex=serializeInto(buffer,object,checkKeys,0,0,serializeFunctions,ignoreUndefined,null);finalBuffer.set(buffer.subarray(0,serializationIndex),startIndex);return startIndex+serializationIndex-1}function deserialize(buffer2,options={}){return internalDeserialize(ByteUtils.toLocalBufferType(buffer2),options)}function calculateObjectSize(object,options={}){options=options||{};const serializeFunctions=typeof options.serializeFunctions==="boolean"?options.serializeFunctions:false;const ignoreUndefined=typeof options.ignoreUndefined==="boolean"?options.ignoreUndefined:true;return internalCalculateObjectSize(object,serializeFunctions,ignoreUndefined)}function deserializeStream(data,startIndex,numberOfDocuments,documents,docStartIndex,options){const internalOptions=Object.assign({allowObjectSmallerThanBufferSize:true,index:0},options);const bufferData=ByteUtils.toLocalBufferType(data);let index=startIndex;for(let i3=0;i3<numberOfDocuments;i3++){const size=bufferData[index]|bufferData[index+1]<<8|bufferData[index+2]<<16|bufferData[index+3]<<24;internalOptions.index=index;documents[docStartIndex+i3]=internalDeserialize(bufferData,internalOptions);index=index+size}return index}var bson=Object.freeze({__proto__:null,Code,BSONSymbol,DBRef,Binary,ObjectId:ObjectId2,UUID,Long,Timestamp,Double,Int32,MinKey,MaxKey,BSONRegExp,Decimal128,setInternalBufferSize,serialize,serializeWithBufferAndIndex,deserialize,calculateObjectSize,deserializeStream,BSONValue,BSONError,BSONVersionError,BSONRuntimeError,BSONType,EJSON});exports.BSON=bson;exports.BSONError=BSONError;exports.BSONRegExp=BSONRegExp;exports.BSONRuntimeError=BSONRuntimeError;exports.BSONSymbol=BSONSymbol;exports.BSONType=BSONType;exports.BSONValue=BSONValue;exports.BSONVersionError=BSONVersionError;exports.Binary=Binary;exports.Code=Code;exports.DBRef=DBRef;exports.Decimal128=Decimal128;exports.Double=Double;exports.EJSON=EJSON;exports.Int32=Int32;exports.Long=Long;exports.MaxKey=MaxKey;exports.MinKey=MinKey;exports.ObjectId=ObjectId2;exports.Timestamp=Timestamp;exports.UUID=UUID;exports.calculateObjectSize=calculateObjectSize;exports.deserialize=deserialize;exports.deserializeStream=deserializeStream;exports.serialize=serialize;exports.serializeWithBufferAndIndex=serializeWithBufferAndIndex;exports.setInternalBufferSize=setInternalBufferSize}});var DataStructures_exports={};__export(DataStructures_exports,{AuthorizationStruct:()=>AuthorizationStruct,ChatroomStruct:()=>ChatroomStruct,CoherenceMap:()=>CoherenceMap,CoherenceStruct:()=>CoherenceStruct,CommentStruct:()=>CommentStruct,Data:()=>Data,DataStruct:()=>DataStruct,DateStruct:()=>DateStruct,ECGStruct:()=>ECGStruct,EDAStruct:()=>EDAStruct,EEGCoordinates:()=>EEGCoordinates,EEGStruct:()=>EEGStruct,EMGStruct:()=>EMGStruct,EventStruct:()=>EventStruct,EyeTrackerStruct:()=>EyeTrackerStruct,FNIRSStruct:()=>FNIRSStruct,FrequencyBandsStruct:()=>FrequencyBandsStruct,GroupStruct:()=>GroupStruct,HRVStruct:()=>HRVStruct,IMUStruct:()=>IMUStruct,NotificationStruct:()=>NotificationStruct,PPGStruct:()=>PPGStruct,ProfileStruct:()=>ProfileStruct,ScheduleStruct:()=>ScheduleStruct,Struct:()=>Struct,eegCoordinates:()=>eegCoordinates,setCoordinate:()=>setCoordinate,structRegistry:()=>structRegistry});function Struct(structType="struct",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){function randomId3(tag=""){return`${tag+Math.floor(Math.random()+Math.random()*Math.random()*1e16)}`}let struct={_id:randomId3(structType+"defaultId"),structType,ownerId:parentUser?._id,timestamp:Date.now(),parent:{structType:parentStruct?.structType,_id:parentStruct?._id}};if(!struct.ownerId)delete struct.ownerId;if(!struct?.parent?._id)delete struct.parent;if(Object.keys(assignProps).length>0)Object.assign(struct,assignProps);return struct}var eegCoordinates={FP1:[-21.2,66.9,12.1],FPZ:[1.4,65.1,11.3],FP2:[24.3,66.3,12.5],AF7:[-41.7,52.8,11.3],AF3:[-32.7,48.4,32.8],AFZ:[1.8,54.8,37.9],AF4:[35.1,50.1,31.1],AF8:[43.9,52.7,9.3],F5:[-51.4,26.7,24.7],F3:[-39.7,25.3,44.7],F1:[-22.1,26.8,54.9],FZ:[0,26.8,60.6],F2:[23.6,28.2,55.6],F4:[41.9,27.5,43.9],F6:[52.9,28.7,25.2],F7:[-52.1,28.6,3.8],F8:[53.2,28.4,3.1],FC5:[-59.1,3,26.1],FC3:[-45.5,2.4,51.3],FC1:[-24.7,.3,66.4],FCZ:[1,1,72.8],FC2:[26.1,3.2,66],FC4:[47.5,4.6,49.7],FC6:[60.5,4.9,25.5],FT9:[-53.8,-2.1,-29.1],FT7:[-59.2,3.4,-2.1],FT8:[60.2,4.7,-2.8],FT10:[55,-3.6,-31],T7:[-65.8,-17.8,-2.9],T5:[-61.5,-65.3,1.1],T3:[-70.2,-21.3,-10.7],T4:[71.9,-25.2,-8.2],T6:[59.3,-67.6,3.8],T8:[67.4,-18.5,-3.4],C5:[-63.6,-18.9,25.8],C3:[-49.1,-20.7,53.2],C1:[-25.1,-22.5,70.1],CZ:[.8,-21.9,77.4],C2:[26.7,-20.9,69.5],C4:[50.3,-18.8,53],C6:[65.2,-18,26.4],CP5:[-61.8,-46.2,22.5],CP3:[-46.9,-47.7,49.7],CP1:[-24,-49.1,66.1],CPZ:[.7,-47.9,72.6],CP2:[25.8,-47.1,66],CP4:[49.5,-45.5,50.7],CP6:[62.9,-44.6,24.4],TP9:[-73.6,-46.7,-4],TP7:[-63.6,-44.7,-4],TP8:[64.6,-45.4,-3.7],TP10:[74.6,-47.4,-3.7],P9:[-50.8,-51.3,-37.7],P7:[-55.9,-64.8,0],P5:[-52.7,-67.1,19.9],P3:[-41.4,-67.8,42.4],P1:[-21.6,-71.3,52.6],PZ:[.7,-69.3,56.9],P2:[24.4,-69.9,53.5],P4:[44.2,-65.8,42.7],P6:[54.4,-65.3,20.2],P8:[56.4,-64.4,.1],P10:[51,-53.9,-36.5],PO7:[-44,-81.7,1.6],PO3:[-33.3,-84.3,26.5],POZ:[0,-87.9,33.5],PO4:[35.2,-82.6,26.1],PO8:[43.3,-82,.7],O1:[-25.8,-93.3,7.7],OZ:[.3,-97.1,8.7],O2:[25,-95.2,6.2]};function setCoordinate(channelDict,assignTo={}){if(!eegCoordinates[channelDict.tag]&&channelDict.position){eegCoordinates[channelDict.tag]=[channelDict.position.x,channelDict.position.y,channelDict.position.z]}if(eegCoordinates[channelDict.tag]){let props={channel:"",position:{x:eegCoordinates[channelDict.tag][0],y:eegCoordinates[channelDict.tag][1],z:eegCoordinates[channelDict.tag][2]}};return Object.assign(assignTo,props)}else return Object.assign(assignTo,channelDict)}function EEGCoordinates(channelDicts=[],genCoherenceMap=true){let structs=[];for(let channelDict of channelDicts){let struct=EEGStruct(channelDict);structs.push(struct)}if(genCoherenceMap){structs.push(...CoherenceMap({channelDicts}))}return structs}function FrequencyBandsStruct(additionalBands=[],assignTo={}){let bands={scp:[],delta:[],theta:[],alpha1:[],alpha2:[],beta:[],lowgamma:[],highgamma:[]};additionalBands.forEach(band=>bands[band]=[]);return Object.assign(assignTo,bands)}function EEGStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let bands=FrequencyBandsStruct();let props={tag,position:{x:0,y:0,z:0},count:0,times:[],raw:[],filtered:[],fftCount:0,fftTimes:[],ffts:[],slices:JSON.parse(JSON.stringify(bands)),means:JSON.parse(JSON.stringify(bands)),startTime:Date.now()};let struct=Struct("eeg",props,parentUser,parentStruct);if(tag)setCoordinate(props,struct);return Object.assign(struct,assignProps)}function CoherenceStruct(coords={0:EEGStruct("FP1"),1:EEGStruct("FP2")},assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let bands=FrequencyBandsStruct();let props={tag:coords[0]?.tag+"::"+coords[1]?.tag,x0:coords[0]?.position?.x,y0:coords[0]?.position?.y,z0:coords[0]?.position?.z,x1:coords[1]?.position?.x,y1:coords[1]?.position?.y,z1:coords[1]?.position?.z,fftCount:0,fftTimes:[],ffts:[],slices:JSON.parse(JSON.stringify(bands)),means:JSON.parse(JSON.stringify(bands)),startTime:Date.now()};let struct=Struct("coherence",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function CoherenceMap(opts={channelDicts:[{ch:0,tag:"FP1",analyze:false},{ch:1,tag:"FP2",analyze:false}],taggedOnly:true},_={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){var cmap=[];var l=1,k=0;for(var i3=0;i3<opts.channelDicts.length*(opts.channelDicts.length+1)/2-opts.channelDicts.length;i3++){if(opts.taggedOnly===false||opts.taggedOnly===true&&(opts.channelDicts[k].tag!==null&&opts.channelDicts[k+l].tag!==null&&(opts.channelDicts[k].tag!=="other"&&opts.channelDicts[k+l].tag!=="other")&&(opts.channelDicts[k].analyze===true&&opts.channelDicts[k+l].analyze===true))){var coord0=EEGStruct(opts.channelDicts[k].tag);var coord1=EEGStruct(opts.channelDicts[k+l].tag);cmap.push(CoherenceStruct({0:coord0,1:coord1},{},parentUser,parentStruct))}l++;if(l+k===opts.channelDicts.length){k++;l=1}}return cmap}function FNIRSStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,position:{x:0,y:0,z:0},count:0,times:[],red:[],ir:[],ir2:[],ambient:[],ratio:[],temp:[],beat_detect:{beats:[],breaths:[],rir:[],rir2:[],drir_dt:[],localmins:[],localmaxs:[],val_dists:[],peak_dists:[],localmins2:[],localmaxs2:[],val_dists2:[],peak_dists2:[]},startTime:Date.now()};let struct=Struct("fnirs",props,parentUser,parentStruct);if(tag)setCoordinate(props,struct);return Object.assign(struct,assignProps)}function IMUStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,Ax:[],Ay:[],Az:[],Gx:[],Gy:[],Gz:[],startTime:Date.now()};let struct=Struct("imu",props,parentUser,parentStruct);if(tag)setCoordinate(props,struct);return Object.assign(struct,assignProps)}function EyeTrackerStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,count:0,times:[],x:[],y:[],smax:[],smay:[],startTime:Date.now()};let struct=Struct("eyetracker",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function ECGStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,count:0,times:[],raw:[],filtered:[],bpm:[],hrv:[],startTime:Date.now()};let struct=Struct("ecg",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function EDAStruct(_="",__={},___={_id:""},____={structType:"struct",_id:""}){}function PPGStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let struct=FNIRSStruct(tag,parentUser,parentStruct,assignProps);struct.structType="ppg";return struct}function HRVStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let struct=ECGStruct(tag,parentUser,parentStruct,assignProps);struct.structType="hrv";return struct}function EMGStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let struct=EEGStruct(tag,parentUser,parentStruct,assignProps);struct.structType="emg";return struct}function ProfileStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,name:"",username:"",firstName:"",lastName:"",email:"",phone:"",sex:"",birthday:"",type:"",pictureUrl:"",userRoles:{},socials:{},data:{},hidden:false,accessToken:"",refreshToken:""};let struct=Struct("profile",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function AuthorizationStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,authorizedId:"",authorizedName:"",authorizerId:"",authorizerName:"",authorizations:{},structs:{},excluded:{},groups:{},status:"PENDING",expires:false,associatedAuthId:""};let struct=Struct("authorization",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function GroupStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,name:"",details:"",admins:{},peers:{},clients:{},users:{}};let struct=Struct("group",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function Data(type,data){return{type,data,timestamp:Date.now()}}function DataStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,title:"",author:"",expires:false,type:"",data:new Array};let struct=Struct("data",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function EventStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,event:"",author:"",startTime:"",endTime:"",grade:void 0,value:void 0,units:void 0,location:void 0,notes:"",attachments:new Array,users:{}};let struct=Struct("event",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function ChatroomStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,message:"",topic:"",author:"",attachments:new Array,comments:new Array,replies:new Array,users:{},audioChatActive:false,videoChatActive:false};let struct=Struct("chatroom",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function CommentStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,author:"",replyTo:"",message:"",rating:0,replies:new Array,users:{},attachments:new Array};let struct=Struct("comment",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function NotificationStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,note:"",parentUserId:""};let struct=Struct("notification",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function ScheduleStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,title:"",author:"",attachments:new Array,dates:new Array};let struct=Struct("schedule",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function DateStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,timeSet:"",notes:"",recurs:"NEVER",attachments:new Array};let struct=Struct("date",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}var structRegistry={Struct,EEGStruct,FNIRSStruct,CoherenceStruct,CoherenceMap,FrequencyBandsStruct,IMUStruct,EyeTrackerStruct,ECGStruct,EDAStruct,PPGStruct,HRVStruct,EMGStruct,ProfileStruct,AuthorizationStruct,GroupStruct,DataStruct,EventStruct,ChatroomStruct,CommentStruct,NotificationStruct,ScheduleStruct,DateStruct};var EventHandler2=class{data={};triggers={};ctr=0;constructor(data){if(typeof data==="object")this.data=data}setState=updateObj=>{Object.assign(this.data,updateObj);let props=Object.getOwnPropertyNames(updateObj);for(const prop of props){this.triggerEvent(prop,this.data[prop])}if(this.triggers[statesubKey2]){let run=fn=>{fn(updateObj)};const l=this.triggers[statesubKey2].length;for(let i3=l-1;i3>=0;i3--){run(this.triggers[statesubKey2][i3].onchange)}}return this.data};setValue=(key,value)=>{this.data[key]=value;this.triggerEvent(key,value)};triggerEvent=(key,value)=>{if(this.triggers[key]){let fn=obj=>{obj.onchange(value)};const l=this.triggers[key].length;for(let i3=l-1;i3>=0;i3--){fn(this.triggers[key][i3])}}};subscribeState=onchange=>{return this.subscribeEvent(statesubKey2,onchange)};unsubscribeState=sub=>{return this.unsubscribeEvent(statesubKey2,sub)};subscribeEvent=(key,onchange,refObject,refKey)=>{if(key){if(refObject&&refKey&&!this.triggers[key]){Object.defineProperty(this.data,key,{get:()=>{return refObject[refKey]},set:value=>{refObject[refKey]=value},enumerable:true,configurable:true})}if(!this.triggers[key]){this.triggers[key]=[]}let l=this.ctr;this.ctr++;this.triggers[key].push({sub:l,onchange});return l}else return void 0};unsubscribeEvent=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(sub===void 0){delete this.triggers[key];delete this.data[key]}else{let idx=void 0;let obj=triggers.find((o,i3)=>{if(o.sub===sub){idx=i3;return true}});if(obj)triggers.splice(idx,1);if(Object.keys(triggers).length===0){delete this.triggers[key];delete this.data[key]}if(this.onRemoved)this.onRemoved(obj);return true}}};subscribeEventOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeEvent(key,sub)};sub=this.subscribeEvent(key,changed);return sub};getEvent=(key,sub)=>{for(const s in this.triggers[key]){if(this.triggers[key][s].sub===sub)return this.triggers[key][s]}};getSnapshot=()=>{const snapshot={};for(const key in this.data){snapshot[key]=this.data[key]}};onRemoved};var statesubKey2="*s";var state2=new EventHandler2;var objProps2=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var import_bson=__toESM2(require_bson());var shallowqueryDummy=DataStructures_exports.ProfileStruct();for(const key in shallowqueryDummy){if(key==="username"||key==="lastName"||key==="firstName"||key==="name"||key==="_id"||key==="pictureUrl")shallowqueryDummy[key]=1;else delete shallowqueryDummy[key]}var Systems={collision:{setupEntities:function(entities){for(const key in entities){const entity=entities[key];if(entity.components){if(!entity.components[this.__node.tag])continue}this.setupEntity(entity)}return entities},setupEntity:function(entity){if(!("collisionEnabled"in entity))entity.collisionEnabled=true;if(!entity.collisionType)entity.collisionType="sphere";if(!entity.collisionRadius)entity.collisionRadius=1;if(!entity.collisionBoundsScale)entity.collisionBoundsScale={x:1,y:1,z:1};if(!entity.colliding)entity.colliding={};if(!entity.position)entity.position={x:0,y:0,z:0};return entity},__node:{tag:"collision"},__operator:function(entities){let keys3=this.entityKeys;for(let i3=0;i3<keys3.length;i3++){const entity1=entities[keys3[i3]];if(entity1.components){if(!entity1.components[this.__node.tag]||!entity1.collisionEnabled)continue}if(!entity1.collisionEnabled)continue;for(let j=0;j<keys3.length;j++){if(i3===j)continue;const entity2=entities[keys3[j]];if(entity2.components){if(!entity2.components[this.__node.tag])continue}if(!entity2.collisionEnabled)continue;let colliding=Systems.collision.collisionCheck(entity1,entity2);if(colliding!==false){if(!entity1.colliding)entity1.colliding={};if(!entity2.colliding)entity2.colliding={};entity1.colliding[entity2.__node.tag]=colliding;entity2.colliding[entity1.__node.tag]=colliding}}}return entities},collisionCheck:(body1,body2)=>{if(body1.collisionEnabled===false||body2.collisionEnabled===false)return false;const dist=Systems.collision.distance(body1.position,body2.position);if(dist<Math.max(...Object.values(body1.collisionBoundsScale))*body1.collisionRadius+Math.max(...Object.values(body2.collisionBoundsScale))*body2.collisionRadius){let isColliding=false;if(body1.collisionType==="sphere"){if(body2.collisionType==="sphere"){isColliding=Systems.collision.sphereCollisionCheck(body1,body2,dist)}else if(body2.collisionType==="box"){isColliding=Systems.collision.sphereBoxCollisionCheck(body1,body2,dist)}else if(body2.collisionType==="point"){isColliding=Systems.collision.isPointInsideSphere(body2.position,body1,dist)}}else if(body1.collisionType==="box"){if(body2.collisionType==="sphere"){isColliding=Systems.collision.sphereBoxCollisionCheck(body2,body1,dist)}else if(body2.collisionType==="box"){isColliding=Systems.collision.boxCollisionCheck(body1,body2)}else if(body2.collisionType==="point"){isColliding=Systems.collision.isPointInsideBox(body1.position,body1)}}else if(body1.collisionType==="point"){if(body2.collisionType==="sphere"){isColliding=Systems.collision.isPointInsideSphere(body1.position,body2,dist)}else if(body2.collisionType==="box"){isColliding=Systems.collision.isPointInsideBox(body1.position,body2)}}if(isColliding)return dist}return false},sphereCollisionCheck:(body1,body2,dist)=>{if(dist===void 0)dist=Systems.collision.distance(body1.position,body2.position);return dist<body1.collisionRadius+body2.collisionRadius},boxCollisionCheck:(body1,body2)=>{let body1minX=(body1.position.x-body1.collisionRadius)*body1.collisionBoundsScale.x;let body1maxX=(body1.position.x+body1.collisionRadius)*body1.collisionBoundsScale.x;let body1minY=(body1.position.y-body1.collisionRadius)*body1.collisionBoundsScale.y;let body1maxY=(body1.position.y+body1.collisionRadius)*body1.collisionBoundsScale.y;let body1minZ=(body1.position.z-body1.collisionRadius)*body1.collisionBoundsScale.z;let body1maxZ=(body1.position.z+body1.collisionRadius)*body1.collisionBoundsScale.z;let body2minX=(body2.position.x-body2.collisionRadius)*body1.collisionBoundsScale.x;let body2maxX=(body2.position.x+body2.collisionRadius)*body1.collisionBoundsScale.x;let body2minY=(body2.position.y-body2.collisionRadius)*body1.collisionBoundsScale.y;let body2maxY=(body2.position.y+body2.collisionRadius)*body1.collisionBoundsScale.y;let body2minZ=(body2.position.z-body2.collisionRadius)*body1.collisionBoundsScale.z;let body2maxZ=(body2.position.z+body2.collisionRadius)*body1.collisionBoundsScale.z;return(body1maxX<=body2maxX&&body1maxX>=body2minX||body1minX<=body2maxX&&body1minX>=body2minX)&&(body1maxY<=body2maxY&&body1maxY>=body2minY||body1minY<=body2maxY&&body1minY>=body2minY)&&(body1maxZ<=body2maxZ&&body1maxZ>=body2minZ||body1minZ<=body2maxZ&&body1minZ>=body2minZ)},sphereBoxCollisionCheck:(sphere,box,dist)=>{let boxMinX=(box.position.x-box.collisionRadius)*box.collisionBoundsScale.x;let boxMaxX=(box.position.x+box.collisionRadius)*box.collisionBoundsScale.x;let boxMinY=(box.position.y-box.collisionRadius)*box.collisionBoundsScale.y;let boxMaxY=(box.position.y+box.collisionRadius)*box.collisionBoundsScale.y;let boxMinZ=(box.position.z-box.collisionRadius)*box.collisionBoundsScale.z;let boxMaxZ=(box.position.z+box.collisionRadius)*box.collisionBoundsScale.z;let clamp={x:Math.max(boxMinX,Math.min(sphere.position.x,boxMaxX)),y:Math.max(boxMinY,Math.min(sphere.position.y,boxMaxY)),z:Math.max(boxMinZ,Math.min(sphere.position.z,boxMaxZ))};if(dist===void 0)dist=Systems.collision.distance(sphere.position,clamp);return dist>sphere.collisionRadius},isPointInsideSphere:(point,sphere,dist)=>{if(dist===void 0)dist=Systems.collision.distance(point,sphere.position);return dist<sphere.collisionRadius},isPointInsideBox:(point,box)=>{let boxminX=(box.position.x-box.collisionRadius)*box.collisionBoundsScale.x;let boxmaxX=(box.position.x+box.collisionRadius)*box.collisionBoundsScale.x;let boxminY=(box.position.y-box.collisionRadius)*box.collisionBoundsScale.x;let boxmaxY=(box.position.y+box.collisionRadius)*box.collisionBoundsScale.x;let boxminZ=(box.position.z-box.collisionRadius)*box.collisionBoundsScale.x;let boxmaxZ=(box.position.z+box.collisionRadius)*box.collisionBoundsScale.x;return point.x>=boxminX&&point.x<=boxmaxX&&(point.y>=boxminY&&point.y<=boxmaxY)&&(point.z>=boxminZ&&point.z<=boxmaxZ)},closestPointOnLine:(point,lineStart,lineEnd)=>{let a={x:lineEnd.x-lineStart.x,y:lineEnd.y-lineStart.y,z:lineEnd.z-lineStart.z};let b={x:lineStart.x-point.x,y:lineStart.y-point.y,z:lineStart.z-point.z};let c={x:lineEnd.x-point.x,y:lineEnd.y-point.y,z:lineEnd.z-point.z};let bdota=Systems.collision.dot(b,a);if(bdota<=0)return lineStart;let cdota=Systems.collision.dot(c,a);if(cdota<=0)return lineEnd;let _bdotapluscdota=1/(bdota+cdota);return{x:lineStart.x+(lineEnd.x-lineStart.x)*bdota*_bdotapluscdota,y:lineStart.y+(lineEnd.y-lineStart.y)*bdota*_bdotapluscdota,z:lineStart.z+(lineEnd.z-lineStart.z)*bdota*_bdotapluscdota}},closestPointOnPolygon:(point,t0,t1,t22)=>{let n=Systems.collision.calcNormal(t0,t1,t22);let dist=Systems.collision.dot(point,n)-Systems.collision.dot(t0,n);let projection=Systems.collision.vecadd(point,Systems.collision.vecscale(n,-dist));let v0x=t22[0]-t0[0];let v0y=t22[1]-t0[1];let v0z=t22[2]-t0[2];let v1x=t1[0]-t0[0];let v1y=t1[1]-t0[1];let v1z=t1[2]-t0[2];let v2x=projection[0]-t0[0];let v2y=projection[1]-t0[1];let v2z=projection[2]-t0[2];let dot00=v0x*v0x+v0y*v0y+v0z*v0z;let dot01=v0x*v1x+v0y*v1y+v0z*v1z;let dot02=v0x*v2x+v0y*v2y+v0z*v2z;let dot11=v1x*v1x+v1y*v1y+v1z*v1z;let dot12=v1x*v2x+v1y*v2y+v1z*v2z;let denom=dot00*dot11-dot01*dot01;if(Math.abs(denom)<1e-30){return void 0}let _denom=1/denom;let u3=(dot11*dot02-dot01*dot12)*_denom;let v2=(dot00*dot12-dot01*dot02)*_denom;if(u3>=0&&v2>=0&&u3+v2<1){return projection}else return void 0},calcNormal:(t0,t1,t22,positive=true)=>{var QR=Systems.collision.makeVec(t0,t1);var QS=Systems.collision.makeVec(t0,t22);if(positive===true){return Systems.collision.normalize(Systems.collision.cross3D(QR,QS))}else{return Systems.collision.normalize(Systems.collision.cross3D(QS,QR))}},dot:(v1,v2)=>{let dot=0;for(const key in v1){dot+=v1[key]*v2[key]}return dot},makeVec(p1,p2){return{x:p2.x-p1.x,y:p2.y-p1.y,z:p2.z-p1.z}},vecadd:(v1,v2)=>{let result=Object.assign({},v1);for(const key in result){result[key]+=v2[key]}return result},vecsub:(v1,v2)=>{let result=Object.assign({},v1);for(const key in result){result[key]-=v2[key]}return result},vecmul:(v1,v2)=>{let result=Object.assign({},v1);for(const key in result){result[key]*=v2[key]}return result},vecdiv:(v1,v2)=>{let result=Object.assign({},v1);for(const key in result){result[key]/=v2[key]}return result},vecscale:(v1,scalar)=>{let result=Object.assign({},v1);for(const key in result){result[key]*=scalar}return result},distance:(v1,v2)=>{let distance=0;for(const key in v1){distance+=Math.pow(v1[key]-v2[key],2)}return Math.sqrt(distance)},magnitude:v2=>{let magnitude=0;for(const key in v2){magnitude+=v2[key]*v2[key]}return Math.sqrt(magnitude)},normalize:v2=>{let magnitude=Systems.collision.magnitude(v2);let _mag=magnitude?1/magnitude:0;let vn={};for(const key in v2){vn[key]=v2[key]*_mag}return vn},distance3D(v1,v2){return Math.sqrt((v1.x-v2.x)*(v1.x-v2.x)+(v1.y-v2.y)*(v1.y-v2.y)+(v1.z-v2.z)*(v1.z-v2.z))},cross3D(v1,v2){return{x:v1.y*v2.z-v1.z*v2.y,y:v1.z*v2.x-v1.x*v2.z,z:v1.x*v2.y-v1.y*v2.x}},nearestNeighborSearch(entities,isWithinRadius=1e15){var tree={};;for(const key in entities){let newnode={tag:key,position:void 0,neighbors:[]};newnode.position=entities[key].position;tree[key]=newnode}for(const i3 in tree){for(const j in tree){var dist=Systems.collision.distance3D(tree[i3].position,tree[j].position);if(dist<isWithinRadius){var newNeighbori={tag:j,position:entities[j].position,dist};tree[i3].neighbors.push(newNeighbori);var newNeighborj={tag:j,position:entities[i3].position,dist};tree[j].neighbors.push(newNeighborj)}}tree[i3].neighbors.sort(function(a,b){return a.dist-b.dist})}return tree},generateBoundingVolumeTree(entities,mode="octree",withinRadius=1e15,minEntities=3){let dynamicBoundingVolumeTree={proto:{parent:void 0,children:{},entities:{},collisionType:"box",collisionRadius:1,collisionBoundsScale:{x:1,y:1,z:1},position:{x:0,y:0,z:0}},tree:{}};let maxX,maxY,maxZ;let minX=0,minY=0,minZ=0;let positions={};let minRadius=withinRadius;for(const key in entities){const body=entities[key];let xx=body.position.x+body.collisionRadius*body.collisionBoundsScale.x;let yy=body.position.y+body.collisionRadius*body.collisionBoundsScale.y;let zz=body.position.z+body.collisionRadius*body.collisionBoundsScale.z;if(maxX<xx)maxX=xx;if(minX>xx)minX=xx;if(maxY<yy)maxY=yy;if(minY>yy)minY=yy;if(maxZ<zz)maxZ=zz;if(minZ>zz)minZ=zz;if(minRadius>body.collisionRadius)minRadius=body.collisionRadius;positions[key]=body.position};let head=JSON.parse(JSON.stringify(dynamicBoundingVolumeTree.proto));let boxpos={x:(maxX+minX)*.5,y:(maxY+minY)*.5,z:(maxZ+minZ)*.5};let boxbounds={x:maxX-boxpos.x,y:maxY-boxpos.y,z:maxZ-boxpos.z};head.position=boxpos;head.collisionBoundsScale=boxbounds;head.entities=entities;dynamicBoundingVolumeTree.tree=head;minRadius*=2;if(mode==="octree"){let genOct=function(parentPos,halfbounds){let oct1={x:parentPos.x+halfbounds.x,y:parentPos.y+halfbounds.y,z:parentPos.z+halfbounds.z};let oct2={x:parentPos.x-halfbounds.x,y:parentPos.y+halfbounds.y,z:parentPos.z+halfbounds.z};let oct3={x:parentPos.x+halfbounds.x,y:parentPos.y-halfbounds.y,z:parentPos.z+halfbounds.z};let oct4={x:parentPos.x+halfbounds.x,y:parentPos.y+halfbounds.y,z:parentPos.z-halfbounds.z};let oct5={x:parentPos.x-halfbounds.x,y:parentPos.y-halfbounds.y,z:parentPos.z+halfbounds.z};let oct6={x:parentPos.x-halfbounds.x,y:parentPos.y+halfbounds.y,z:parentPos.z-halfbounds.z};let oct7={x:parentPos.x+halfbounds.x,y:parentPos.y-halfbounds.y,z:parentPos.z-halfbounds.z};let oct8={x:parentPos.x-halfbounds.x,y:parentPos.y-halfbounds.y,z:parentPos.z-halfbounds.z};return[oct1,oct2,oct3,oct4,oct5,oct6,oct7,oct8]},genOctTree=function(head2){let halfbounds={x:head2.collisionBoundsScale.x*.5,y:head2.collisionBoundsScale.y*.5,z:head2.collisionBoundsScale.z*.5};let octPos=genOct(head2.position,halfbounds);let check=Object.assign({},head2.bodies);for(let i3=0;i3<8;i3++){let octquadrant=Object.assign(JSON.parse(JSON.stringify(dynamicBoundingVolumeTree.proto)),{position:octPos[i3],collisionBoundsScale:halfbounds});octquadrant.parent=head2;for(const j in check){let collided=Systems.collision.collisionCheck(check[j],octquadrant);if(collided){octquadrant.entities[j]=check[j];delete check[j]}}if(Object.keys(octquadrant.entities).length>minEntities-1){head2.children[i3]=octquadrant;octquadrant.parent=head2;if(Object.keys(octquadrant.entities).length>minEntities&&octquadrant.collisionRadius*.5>minRadius){genOctTree(octquadrant)}}}};genOctTree(head);return head}else{let tree=Systems.collision.nearestNeighborSearch(positions,withinRadius);let keys3=Object.keys(tree);let tag=keys3[Math.floor(Math.random()*keys3.length)];let searching=true;let count=0;let genBoundingBoxLevel=(tree2,volumes)=>{let newVolumes={};let foundidxs={};let treekeys=Object.keys(tree2);while(searching&&count<treekeys.length){let node=tree2[tag];let i3=0;let j=0;let ux=positions[node.tag].x-volumes[node.tag].collisionBoundsScale.x,uy=positions[node.tag].y-volumes[node.tag].collisionBoundsScale.y,uz=positions[node.tag].z-volumes[node.tag].collisionBoundsScale.z,mx=positions[node.tag].x+volumes[node.tag].collisionBoundsScale.x,my=positions[node.tag].y+volumes[node.tag].collisionBoundsScale.y,mz=positions[node.tag].z+volumes[node.tag].collisionBoundsScale.z;let newvolume=JSON.parse(JSON.stringify(dynamicBoundingVolumeTree.proto));newvolume.tag=`bound${Math.floor(Math.random()*1e15)}`;newvolume.children[node.tag]=volumes[node.tag];newvolume.bodies[node.tag]=entities[node.tag];volumes[node.tag].parent=newvolume;foundidxs[node.tag]=true;i3++;j++;let nkeys=Object.keys(node.neighbors);while(i3<nkeys.length&&j<3){if(foundidxs[node.neighbors[i3].tag]){i3++;continue}let uxn=positions[node.neighbors[i3].tag].x-volumes[node.neighbors[i3].tag].collisionBoundsScale.x,uyn=positions[node.neighbors[i3].tag].y-volumes[node.neighbors[i3].tag].collisionBoundsScale.y,uzn=positions[node.neighbors[i3].tag].z-volumes[node.neighbors[i3].tag].collisionBoundsScale.z,mxn=positions[node.neighbors[i3].tag].x+volumes[node.neighbors[i3].tag].collisionBoundsScale.x,myn=positions[node.neighbors[i3].tag].y+volumes[node.neighbors[i3].tag].collisionBoundsScale.y,mzn=positions[node.neighbors[i3].tag].z+volumes[node.neighbors[i3].tag].collisionBoundsScale.z;if(ux>uxn)ux=uxn;if(mx<mxn)mx=mxn;if(uy>uyn)uy=uyn;if(my<myn)my=myn;if(uz>uzn)uz=uzn;if(mz<mzn)mz=mzn;newvolume.children[node.neighbors[i3].tag]=volumes[node.neighbors[i3].tag];newvolume.entities[node.neighbors[i3].tag]=entities[node.neighbors[i3].tag];volumes[node.neighbors[i3].tag].parent=newvolume;foundidxs[node.neighbors[i3].tag]=true;i3++;j++}let pos={x:(mx+ux)*.5,y:(my+uy)*.5,z:(mz+uz)*.5};let bounds={x:mx-pos.x,y:my-pos.y,z:mz-pos.z};newvolume.position=pos;newvolume.collisionBoundsScale=bounds;if(newvolume.bodies.length===1)newvolume=node;newVolumes[newvolume.tag]=newvolume;while(i3<node.neighbors.length){if(!foundidxs[node.neighbors[i3].tag])break;i3++}if(i3<node.neighbors.length){tag=node.neighbors[i3].tag}else if(Object.keys(foundidxs).length<Object.keys(tree2).length){tag=keys3[0]}else searching=false;count++}return newVolumes};let result=genBoundingBoxLevel(tree,entities);while(Object.keys(result).length>2){let nextTree=Systems.collision.nearestNeighborSearch(result,withinRadius);result=genBoundingBoxLevel(nextTree,result)}head.children=result;head.children.forEach(n=>{n.parent=head});return head}}},collider:{lastTime:performance.now(),setupEntities:function(entities){for(const key in entities){const entity=entities[key];if(entity.components){if(!entity.components[this.__node.tag])continue}this.setupEntity(entity)}return entities},setupEntity:function(entity){if(!("collisionEnabled"in entity))Systems.collision.setupEntity(entity);if(!("boundingBox"in entity))entity.boundingBox={bot:0,top:100,left:0,right:100,front:0,back:100};if(!("position"in entity)){Systems.movement.setupEntity(entity)}if(!("restitution"in entity))entity.restitution=1;if(!("useBoundingBox"in entity))entity.useBoundingBox=true;if(!entity.position.x&&!entity.position.y&&!entity.position.z){entity.position.x=Math.random()*entity.boundingBox.right;entity.position.y=Math.random()*entity.boundingBox.back;entity.position.z=Math.random()*entity.boundingBox.top}return entity},__operator:function(entities){let keys3=this.entityKeys;for(let i3=0;i3<keys3.length;i3++){const entity1=entities[keys3[i3]];if(entity1.components){if(!entity1.components[this.__node.tag]||!entity1.collisionEnabled)continue}if(entity1.useBoundingBox)this.checkBoundingBox(entity1);if(!entity1.collisionEnabled)continue;if(entity1.colliding){for(const key2 in entity1.colliding){const entity2=entities[key2];if(entity1.colliding[key2]===false){delete entity1.colliding[key2];delete entity2.colliding[entity1.__node.tag];continue}if(!entity2.collisionEnabled)continue;if(entity2.collisionType==="box"){this.resolveBoxCollision(entity1,entity2,entity1.colliding[key2])}else{if(entity1.collisionType==="box"){entity1.fixed=true;this.resolveSphereCollisions(entity1,entity2,entity1.colliding[key2]);entity1.fixed=false}else{this.resolveSphereCollisions(entity1,entity2,entity1.colliding[key2]);delete entity2.colliding[entity1.__node.tag]}}delete entity1.colliding[entity2.__node.tag]}delete entity1.colliding}}return entities},__node:{tag:"collider"},checkBoundingBox:entity=>{const xsize=entity.collisionRadius*entity.collisionBoundsScale.x;const ysize=entity.collisionRadius*entity.collisionBoundsScale.y;const zsize=entity.collisionRadius*entity.collisionBoundsScale.z;if(entity.position.y-ysize<=entity.boundingBox.front){entity.velocity.y*=-entity.restitution;entity.position.y=entity.boundingBox.front+ysize}if(entity.position.y+ysize>=entity.boundingBox.back){entity.velocity.y*=-entity.restitution;entity.position.y=entity.boundingBox.back-ysize}if(entity.position.x-xsize<=entity.boundingBox.left){entity.velocity.x*=-entity.restitution;entity.position.x=entity.boundingBox.left+xsize}if(entity.position.x+xsize>=entity.boundingBox.right){entity.velocity.x*=-entity.restitution;entity.position.x=entity.boundingBox.right-xsize}if(entity.position.z-zsize<=entity.boundingBox.bot){entity.velocity.z*=-entity.restitution;entity.position.z=entity.boundingBox.bot+zsize}if(entity.position.z+zsize>=entity.boundingBox.top){entity.velocity.z*=-entity.restitution;entity.position.z=entity.boundingBox.top-zsize}},resolveBoxCollision:(body1,box,negate)=>{let positionVec=Systems.collision.makeVec(body1.position,box.position);var directionVec=Object.values(positionVec);let closestSide;let closestDist=Infinity;let mul=-1;if(directionVec[idx]<0)mul=1;if(negate)mul=-mul;for(const key in body1.position){let dist=Math.abs(box.position[key]-body1.position[key]);if(dist<closestDist&&Math.abs(box.position[key]-body1.position[key]+body1.velocity[key]*1e-17)<dist){closestSide=key;closestDist=dist}}var idx=directionVec.indexOf(closestSide);if(idx===0)idx="x";if(idx===1)idx="y";if(idx===2)idx="z";if(idx===3)idx="w";let boxEdgeAxisPosition=box.position[idx]+box.collisionRadius*box.collisionBoundsScale[idx]*mul;if(negate){let body1Offset=boxEdgeAxisPosition-body1.collisionRadius*body1.collisionBoundsScale[idx]*mul;body1.position[idx]=body1Offset}else{let body1Offset=boxEdgeAxisPosition+body1.collisionRadius*body1.collisionBoundsScale[idx]*mul;body1.position[idx]=body1Offset}body1.velocity[idx]=-body1.velocity[idx]*body1.restitution;if(negate)body1.force[idx]=-body1.velocity[idx];var body2AccelMag=Systems.collision.magnitude(box.acceleration);var body2AccelNormal=Systems.collision.normalize(box.acceleration);body1.force[idx]=-body2AccelNormal[idx]*body2AccelMag*box.mass;if(negate)body1.force[idx]=-body1.force[idx]},resolveSphereCollisions:(entity1,entity2,dist)=>{if(dist===void 0)dist=Systems.collision.distance(entity1.position,entity2.position);let vecn=Systems.collision.normalize(Systems.collision.makeVec(entity1.position,entity2.position));let sumMass=entity1.mass+entity2.mass;let ratio=entity1.mass/sumMass;let rmin=1-ratio;if(entity1.fixed===false){entity1.position.x+=vecn.x*rmin*1.01;entity1.position.y+=vecn.y*rmin*1.01;entity1.position.z+=vecn.z*rmin*1.001}else{entity2.position.x-=vecn.x*1.01;entity2.position.y-=vecn.y*1.01;entity2.position.z-=vecn.z*1.01}if(entity2.fixed===false){entity2.position.x+=vecn.x*ratio*1.01;entity2.position.y+=vecn.y*ratio*1.01;entity2.position.z+=vecn.z*ratio*1.01}else{entity1.position.x+=vecn.x*1.01;entity1.position.y+=vecn.y*1.01;entity1.position.z+=vecn.z*1.01}dist=Systems.collision.distance(entity1.position,entity2.position);let vrel={x:entity1.velocity.x-entity2.velocity.x,y:entity1.velocity.y-entity2.velocity.y,z:entity1.velocity.z-entity2.velocity.z};let speed=vrel.x*vecn.x+vrel.y*vecn.y+vrel.z*vecn.z;if(speed>0){let impulse=2*speed/sumMass;if(entity1.fixed===false){entity1.velocity.x-=impulse*vecn.x*entity2.mass*entity1.restitution;entity1.velocity.y-=impulse*vecn.y*entity2.mass*entity1.restitution;entity1.velocity.z-=impulse*vecn.z*entity2.mass*entity1.restitution}if(entity2.fixed===false){entity2.velocity.x+=impulse*vecn.x*entity2.mass*entity2.restitution/entity2.mass;entity2.velocity.y+=impulse*vecn.y*entity2.mass*entity2.restitution/entity2.mass;entity2.velocity.z+=impulse*vecn.z*entity2.mass*entity2.restitution/entity2.mass}}}},nbody:{lastTime:performance.now(),G:6674e-14,setupEntities:function(entities){for(const key in entities){const entity=entities[key];if(entity.components){if(!entity.components[this.__node.tag])continue}this.setupEntity(entity)}return entities},setupEntity:function(entity){if(!("collisionEnabled"in entity))Systems.collider.setupEntity(entity);entity.isAttractor=true;if(!("attractorGroup"in entity))entity.attractorGroup=0;if(!("attractorFrameSearchMax"in entity))entity.attractorFrameSearchMax=10;if(!("attractorGroupRules"in entity))entity.attractorGroupRules={0:{G:this.G,maxDist:void 0}};return entity},__operator:function(entities){let keys3=this.entityKeys;for(let i3=0;i3<keys3.length;i3++){const entity=entities[keys3[i3]];if(entity.components){if(!entity.components[this.__node.tag])continue}if(!entity.mass)continue;let nSearched=0;nested:for(let j=0;j<keys3.length;j++){let randKey=keys3[Math.floor(Math.random()*keys3.length)];nSearched++;const entity2=entities[randKey];if(entity2.components){if(!entity2.components[this.__node.tag])continue nested}if(!entity2.mass||!entity2.isAttractor)continue nested;this.attract(entity,entity2,void 0,this.G);if(nSearched>entity.attractorFrameSearchMax)break nested}}return entities},__node:{tag:"nbody"},attract:function(body1,body2,dist,G3=this.G,vecn){if(dist===void 0)dist=Systems.collision.distance3D(body1.position,body2.position);if(vecn===void 0)vecn=Systems.collision.normalize(Systems.collision.makeVec(body1.position,body2.position));let Fg=0;if(dist<.01)dist=.01;if(body1.attractorGroupRules[body2.attractorGroup]){if(typeof body1.attractorGroupRules[body2.attractorGroup]==="object"){if(body1.attractorGroupRules[body2.attractorGroup].maxDist&&body1.attractorGroupRules[body2.attractorGroup].maxDist<dist){}else Fg=body1.attractorGroupRules[body2.attractorGroup].G*body1.mass*body2.mass/(dist*dist)}else Fg=body1.attractorGroupRules[body2.attractorGroup]*body1.mass*body2.mass/(dist*dist)}else Fg=G3*body1.mass*body2.mass/(dist*dist);body1.force.x+=vecn.x*Fg;body1.force.y+=vecn.y*Fg;body1.force.z+=vecn.z*Fg;body2.force.x-=vecn.x*Fg;body2.force.y-=vecn.y*Fg;body2.force.z-=vecn.z*Fg}},boid:{lastTime:performance.now(),defaultAnchor:{x:Math.random(),y:Math.random(),z:Math.random(),mul:.006},setupEntities:function(entities){for(const key in entities){const entity=entities[key];this.setupEntity(entity)}return entities},setupEntity:function(entity){if(!entity.position){Systems.collider.setupEntity(entity)}let adjustedAnchor=Object.assign({},this.defaultAnchor);adjustedAnchor.x*=entity.boundingBox.right;adjustedAnchor.y*=entity.boundingBox.back;adjustedAnchor.z*=entity.boundingBox.top;let boidDefaults={cohesion:1e-5,separation:1e-4,alignment:.006,swirl:adjustedAnchor,attractor:Object.assign(adjustedAnchor,{mul:.002}),useCohesion:true,useSeparation:true,useAlignment:true,useSwirl:true,useAttractor:true,useAttraction:false,groupRadius:200,groupSize:5,searchLimit:5};if(!entity.boid){entity.boid=boidDefaults}else entity.boid=Object.assign(boidDefaults,entity.boid);if(this.entityKeys.length>1e3){entity.boid.groupSize=1;entity.boid.searchLimit=1}return entity},__operator:function(entities){let now=performance.now();let timeStep=now-this.lastTime;this.lastTime=now;let keys3=this.entityKeys;let length=keys3.length;let _timeStep=1/timeStep;let w=-1;outer:for(let i3=0;i3<keys3.length;i3++){w++;let p0=entities[keys3[i3]];const inRange=[];const distances=[];const boidVelocities=[p0.position.x,p0.position.y,p0.position.z,0,0,0,p0.velocity.x,p0.velocity.y,p0.velocity.z,0,0,0,0,0,0,0,0,0];let groupCount=1;let k=-1;nested:for(let j=0;j<keys3.length;j++){k++;if(distances.length>p0.boid.groupSize||k>p0.boid.searchLimit){break nested}let randj=keys3[Math.floor(Math.random()*length)];if(k===w||randj===keys3[i3]||inRange.indexOf(randj)>-1){continue nested}else{let pr=entities[randj];let disttemp=Math.sqrt((p0.position.x-pr.position.x)*(p0.position.x-pr.position.x)+(p0.position.y-pr.position.y)*(p0.position.y-pr.position.y)+(p0.position.z-pr.position.z)*(p0.position.z-pr.position.z));if(disttemp>p0.boid.groupRadius){continue nested}else{distances.push(disttemp);inRange.push(randj);let distInv;if(p0.boid.useSeparation||p0.boid.useAlignment){distInv=p0.boid.groupRadius/(disttemp*disttemp);if(distInv>p0.maxSpeed)distInv=p0.maxSpeed;else if(distInv<-p0.maxSpeed)distInv=-p0.maxSpeed}if(p0.boid.useCohesion){boidVelocities[0]+=(pr.position.x-p0.position.x)*.5*disttemp*_timeStep;boidVelocities[1]+=(pr.position.y-p0.position.y)*.5*disttemp*_timeStep;boidVelocities[2]+=(pr.position.z-p0.position.z)*.5*disttemp*_timeStep}if(isNaN(disttemp)||isNaN(boidVelocities[0])||isNaN(pr.position.x)){console.log(disttemp,i3,randj,p0.position,pr.position,boidVelocities);p0.position.x=NaN;return}if(p0.boid.useSeparation){boidVelocities[3]=boidVelocities[3]+(p0.position.x-pr.position.x)*distInv;boidVelocities[4]=boidVelocities[4]+(p0.position.y-pr.position.y)*distInv;boidVelocities[5]=boidVelocities[5]+(p0.position.z-pr.position.z)*distInv}if(p0.boid.useAttraction&&pr.boid.useAttraction){Systems.nbody.attract(p0,pr,disttemp)}if(p0.boid.useAlignment){boidVelocities[6]=boidVelocities[6]+pr.velocity.x*distInv;boidVelocities[7]=boidVelocities[7]+pr.velocity.y*distInv;boidVelocities[8]=boidVelocities[8]+pr.velocity.z*distInv}groupCount++}}}let _groupCount=1/groupCount;if(p0.boid.useCohesion){boidVelocities[0]=p0.boid.cohesion*(boidVelocities[0]*_groupCount);boidVelocities[1]=p0.boid.cohesion*(boidVelocities[1]*_groupCount);boidVelocities[2]=p0.boid.cohesion*(boidVelocities[2]*_groupCount)}else{boidVelocities[0]=0;boidVelocities[1]=0;boidVelocities[2]=0}if(p0.boid.useSeparation){boidVelocities[3]=p0.boid.separation*boidVelocities[3];boidVelocities[4]=p0.boid.separation*boidVelocities[4];boidVelocities[5]=p0.boid.separation*boidVelocities[5]}else{boidVelocities[3]=0;boidVelocities[4]=0;boidVelocities[5]=0}if(p0.boid.useAlignment){boidVelocities[6]=-(p0.boid.alignment*boidVelocities[6]*_groupCount);boidVelocities[7]=p0.boid.alignment*boidVelocities[7]*_groupCount;boidVelocities[8]=p0.boid.alignment*boidVelocities[8]*_groupCount}else{boidVelocities[6]=0;boidVelocities[7]=0;boidVelocities[8]=0}const swirlVec=[0,0,0];if(p0.boid.useSwirl==true){boidVelocities[9]=-(p0.position.y-p0.boid.swirl.y)*p0.boid.swirl.mul;boidVelocities[10]=(p0.position.z-p0.boid.swirl.z)*p0.boid.swirl.mul;boidVelocities[11]=(p0.position.x-p0.boid.swirl.x)*p0.boid.swirl.mul}const attractorVec=[0,0,0];if(p0.boid.useAttractor==true){boidVelocities[12]=(p0.boid.attractor.x-p0.position.x)*p0.boid.attractor.mul;if(p0.position.x>p0.boundingBox.left||p0.position.x<p0.boundingBox.right){boidVelocities[12]*=3}boidVelocities[13]=(p0.boid.attractor.y-p0.position.y)*p0.boid.attractor.mul;if(p0.position.y>p0.boundingBox.top||p0.position.y<p0.boundingBox.bottom){boidVelocities[13]*=3}boidVelocities[14]=(p0.boid.attractor.z-p0.position.z)*p0.boid.attractor.mul;if(p0.position.z>p0.boundingBox.front||p0.position.z<p0.boundingBox.back){boidVelocities[14]*=3}}p0.velocity.x=p0.velocity.x+boidVelocities[0]+boidVelocities[3]+boidVelocities[6]+boidVelocities[9]+boidVelocities[12]+boidVelocities[15],p0.velocity.y=p0.velocity.y+boidVelocities[1]+boidVelocities[4]+boidVelocities[7]+boidVelocities[10]+boidVelocities[13]+boidVelocities[16],p0.velocity.z=p0.velocity.z+boidVelocities[2]+boidVelocities[5]+boidVelocities[8]+boidVelocities[11]+boidVelocities[14]+boidVelocities[17];if(isNaN(p0.velocity.x))console.error(p0,i3,groupCount,p0.position,p0.velocity,swirlVec,attractorVec)}return entities},__node:{tag:"boid"}},movement:{__node:{tag:"movement"},lastTime:performance.now(),setupEntities:function(entities){for(const key in entities){const entity=entities[key];if(entity.components){if(!entity.components[this.__node.tag])continue}this.setupEntity(entity)}},setupEntity:function(entity){if(!("mass"in entity))entity.mass=1;if(!("fixed"in entity))entity.fixed=false;if(!entity.force)entity.force={x:0,y:0,z:0};if(!("mass"in entity))entity.mass=1;if(!("gravity"in entity))entity.gravity=-9.81;if(!entity.acceleration)entity.acceleration={x:0,y:0,z:0};if(!entity.velocity)entity.velocity={x:0,y:0,z:0};if(!("maxSpeed"in entity))entity.maxSpeed=10;if(!entity.position)entity.position={x:0,y:0,z:0};return entity},__operator:function(entities){let now=performance.now();let timeStep=(now-this.lastTime)*.001;this.lastTime=now;let keys3=this.entityKeys;for(let i3=0;i3<keys3.length;i3++){const entity=entities[keys3[i3]];if(entity.components){if(!entity.components[this.__node.tag])continue}if(entity.fixed)continue;if(entity.mass){if(entity.force.x){entity.acceleration.x+=entity.force.x/entity.mass;entity.force.x=0}if(entity.force.y){entity.acceleration.y+=entity.force.y/entity.mass;entity.force.y=0}if(entity.force.z){entity.acceleration.z+=entity.force.z/entity.mass+entity.gravity;entity.force.z=0}}if(entity.drag){if(entity.acceleration.x)entity.acceleration.x-=entity.acceleration.x*entity.drag*timeStep;if(entity.acceleration.y)entity.acceleration.y-=entity.acceleration.y*entity.drag*timeStep;if(entity.acceleration.z)entity.acceleration.z-=entity.acceleration.z*entity.drag*timeStep}if(entity.acceleration.x)entity.velocity.x+=entity.acceleration.x*timeStep;if(entity.acceleration.y)entity.velocity.y+=entity.acceleration.y*timeStep;if(entity.acceleration.z)entity.velocity.z+=entity.acceleration.z*timeStep;if(entity.maxSpeed>0){let magnitude=Systems.collision.magnitude(entity.velocity);if(magnitude>entity.maxSpeed){let scalar=entity.maxSpeed/magnitude;entity.velocity.x*=scalar;entity.velocity.y*=scalar;entity.velocity.z*=scalar}}if(entity.velocity.x)entity.position.x+=entity.velocity.x*timeStep;if(entity.velocity.y)entity.position.y+=entity.velocity.y*timeStep;if(entity.velocity.z)entity.position.z+=entity.velocity.z*timeStep}return entities}}};var v=class{constructor(e,t3,s,h){this.r=e,this.g=t3,this.b=s,this.a=h}};var A2=class{constructor(){this.scaleX=1,this.scaleY=1,this.offsetX=0,this.offsetY=0,this.loop=false,this._vbuffer=0,this._coord=0,this.visible=true,this.intensity=1,this.xy=new Float32Array([]),this.numPoints=0,this.color=new v(0,0,0,1),this.webglNumPoints=0}};var d=class extends A2{constructor(e,t3){super(),this.currentIndex=0,this.webglNumPoints=t3,this.numPoints=t3,this.color=e,this.xy=new Float32Array(2*this.webglNumPoints)}setX(e,t3){this.xy[e*2]=t3}setY(e,t3){this.xy[e*2+1]=t3}getX(e){return this.xy[e*2]}getY(e){return this.xy[e*2+1]}lineSpaceX(e,t3){for(let s=0;s<this.numPoints;s++)this.setX(s,e+t3*s)}arrangeX(){this.lineSpaceX(-1,2/this.numPoints)}constY(e){for(let t3=0;t3<this.numPoints;t3++)this.setY(t3,e)}shiftAdd(e){let t3=e.length;for(let s=0;s<this.numPoints-t3;s++)this.setY(s,this.getY(s+t3));for(let s=0;s<t3;s++)this.setY(s+this.numPoints-t3,e[s])}addArrayY(e){if(this.currentIndex+e.length<=this.numPoints)for(let t3=0;t3<e.length;t3++)this.setY(this.currentIndex,e[t3]),this.currentIndex++}replaceArrayY(e){if(e.length==this.numPoints)for(let t3=0;t3<this.numPoints;t3++)this.setY(t3,e[t3])}};var M=(c,e,t3)=>{let s={x:0,y:0};return s.x=c.x+e.x*t3,s.y=c.y+e.y*t3,s};var P=c=>Y(-c.y,c.x);var x2=(c,e)=>{let t3=T(c,e);return t3=S(t3),t3};var C2=(c,e)=>{let t3={x:0,y:0};return t3.x=c.x+e.x,t3.y=c.y+e.y,t3};var R=(c,e)=>c.x*e.x+c.y*e.y;var S=c=>{let e={x:0,y:0},t3=c.x*c.x+c.y*c.y;return t3>0&&(t3=1/Math.sqrt(t3),e.x=c.x*t3,e.y=c.y*t3),e};var Y=(c,e)=>{let t3={x:0,y:0};return t3.x=c,t3.y=e,t3};var T=(c,e)=>{let t3={x:0,y:0};return t3.x=c.x-e.x,t3.y=c.y-e.y,t3};var F2=c=>{let e,t3={x:0,y:0},s={x:0,y:0},h=[],o=(n,l)=>{h.push({vec2:n,miterLength:l})},a=n=>({x:c[n*2],y:c[n*2+1]});t3=x2(a(1),a(0)),e=P(t3),o(e,1);let r=c.length/2;for(let n=1;n<r-1;n++){let l=a(n-1),i3=a(n),u3=a(n+1);t3=x2(i3,l),e=P(t3),s=x2(u3,i3);let g=N(t3,s),f=X(t3,g,1);o(g,f)}return t3=x2(a(r-1),a(r-2)),e=P(t3),o(e,1),h};var N=(c,e)=>{let t3=C2(c,e);return t3=S(t3),Y(-t3.y,t3.x)};var X=(c,e,t3)=>{let s=Y(-c.y,c.x);return t3/R(e,s)};var p=class extends A2{constructor(e,t3,s){super(),this.currentIndex=0,this._thicknessRequested=0,this._actualThickness=0,this.webglNumPoints=t3*2,this.numPoints=t3,this.color=e,this._thicknessRequested=s,this._linePoints=new Float32Array(t3*2),this.xy=new Float32Array(2*this.webglNumPoints)}convertToTriPoints(){let e=this._actualThickness/2,t3=F2(this._linePoints);for(let s=0;s<this.numPoints;s++){let h=this._linePoints[2*s],o=this._linePoints[2*s+1],a={x:h,y:o},r=M(a,t3[s].vec2,t3[s].miterLength*e),n=M(a,t3[s].vec2,-t3[s].miterLength*e);this.xy[s*4]=r.x,this.xy[s*4+1]=r.y,this.xy[s*4+2]=n.x,this.xy[s*4+3]=n.y}}setX(e,t3){this._linePoints[e*2]=t3}setY(e,t3){this._linePoints[e*2+1]=t3}lineSpaceX(e,t3){for(let s=0;s<this.numPoints;s++)this.setX(s,e+t3*s)}setThickness(e){this._thicknessRequested=e}getThickness(){return this._thicknessRequested}setActualThickness(e){this._actualThickness=e}};var L=class{constructor(e,t3){this.debug=false,this.addLine=this.addDataLine,t3==null?this.webgl=e.getContext("webgl",{antialias:true,transparent:false}):(this.webgl=e.getContext("webgl",{antialias:t3.antialias,transparent:t3.transparent,desynchronized:t3.deSync,powerPerformance:t3.powerPerformance,preserveDrawing:t3.preserveDrawing}),this.debug=t3.debug==null?false:t3.debug),this.log("canvas type is: "+e.constructor.name),this.log(`[webgl-plot]:width=${e.width}, height=${e.height}`),this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[],this.gScaleX=1,this.gScaleY=1,this.gXYratio=1,this.gOffsetX=0,this.gOffsetY=0,this.gLog10X=false,this.gLog10Y=false,this.webgl.clear(this.webgl.COLOR_BUFFER_BIT),this.webgl.viewport(0,0,e.width,e.height),this._progLine=this.webgl.createProgram(),this.initThinLineProgram(),this.webgl.enable(this.webgl.BLEND),this.webgl.blendFunc(this.webgl.SRC_ALPHA,this.webgl.ONE_MINUS_SRC_ALPHA)}get linesData(){return this._linesData}get linesAux(){return this._linesAux}get thickLines(){return this._thickLines}get surfaces(){return this._surfaces}_drawLines(e){let t3=this.webgl;e.forEach(s=>{if(s.visible){t3.useProgram(this._progLine);let h=t3.getUniformLocation(this._progLine,"uscale");t3.uniformMatrix2fv(h,false,new Float32Array([s.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,s.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let o=t3.getUniformLocation(this._progLine,"uoffset");t3.uniform2fv(o,new Float32Array([s.offsetX+this.gOffsetX,s.offsetY+this.gOffsetY]));let a=t3.getUniformLocation(this._progLine,"is_log");t3.uniform2iv(a,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let r=t3.getUniformLocation(this._progLine,"uColor");t3.uniform4fv(r,[s.color.r,s.color.g,s.color.b,s.color.a]),t3.bufferData(t3.ARRAY_BUFFER,s.xy,t3.STREAM_DRAW),t3.drawArrays(s.loop?t3.LINE_LOOP:t3.LINE_STRIP,0,s.webglNumPoints)}})}_drawSurfaces(e){let t3=this.webgl;e.forEach(s=>{if(s.visible){t3.useProgram(this._progLine);let h=t3.getUniformLocation(this._progLine,"uscale");t3.uniformMatrix2fv(h,false,new Float32Array([s.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,s.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let o=t3.getUniformLocation(this._progLine,"uoffset");t3.uniform2fv(o,new Float32Array([s.offsetX+this.gOffsetX,s.offsetY+this.gOffsetY]));let a=t3.getUniformLocation(this._progLine,"is_log");t3.uniform2iv(a,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let r=t3.getUniformLocation(this._progLine,"uColor");t3.uniform4fv(r,[s.color.r,s.color.g,s.color.b,s.color.a]),t3.bufferData(t3.ARRAY_BUFFER,s.xy,t3.STREAM_DRAW),t3.drawArrays(t3.TRIANGLE_STRIP,0,s.webglNumPoints)}})}_drawTriangles(e){let t3=this.webgl;t3.bufferData(t3.ARRAY_BUFFER,e.xy,t3.STREAM_DRAW),t3.useProgram(this._progLine);let s=t3.getUniformLocation(this._progLine,"uscale");t3.uniformMatrix2fv(s,false,new Float32Array([e.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,e.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let h=t3.getUniformLocation(this._progLine,"uoffset");t3.uniform2fv(h,new Float32Array([e.offsetX+this.gOffsetX,e.offsetY+this.gOffsetY]));let o=t3.getUniformLocation(this._progLine,"is_log");t3.uniform2iv(o,new Int32Array([0,0]));let a=t3.getUniformLocation(this._progLine,"uColor");t3.uniform4fv(a,[e.color.r,e.color.g,e.color.b,e.color.a]),t3.drawArrays(t3.TRIANGLE_STRIP,0,e.xy.length/2)}_drawThickLines(){this._thickLines.forEach(e=>{if(e.visible){let t3=Math.min(this.gScaleX,this.gScaleY);e.setActualThickness(e.getThickness()/t3),e.convertToTriPoints(),this._drawTriangles(e)}})}update(){this.clear(),this.draw()}draw(){this._drawLines(this.linesData),this._drawLines(this.linesAux),this._drawThickLines(),this._drawSurfaces(this.surfaces)}clear(){this.webgl.clear(this.webgl.COLOR_BUFFER_BIT)}_addLine(e){e._vbuffer=this.webgl.createBuffer(),this.webgl.bindBuffer(this.webgl.ARRAY_BUFFER,e._vbuffer),this.webgl.bufferData(this.webgl.ARRAY_BUFFER,e.xy,this.webgl.STREAM_DRAW),e._coord=this.webgl.getAttribLocation(this._progLine,"coordinates"),this.webgl.vertexAttribPointer(e._coord,2,this.webgl.FLOAT,false,0,0),this.webgl.enableVertexAttribArray(e._coord)}addDataLine(e){this._addLine(e),this.linesData.push(e)}addAuxLine(e){this._addLine(e),this.linesAux.push(e)}addThickLine(e){this._addLine(e),this._thickLines.push(e)}addSurface(e){this._addLine(e),this.surfaces.push(e)}initThinLineProgram(){let e=`\n      attribute vec2 coordinates;\n      uniform mat2 uscale;\n      uniform vec2 uoffset;\n      uniform ivec2 is_log;\n\n      void main(void) {\n         float x = (is_log[0]==1) ? log(coordinates.x) : coordinates.x;\n         float y = (is_log[1]==1) ? log(coordinates.y) : coordinates.y;\n         vec2 line = vec2(x, y);\n         gl_Position = vec4(uscale*line + uoffset, 0.0, 1.0);\n      }`,t3=this.webgl.createShader(this.webgl.VERTEX_SHADER);this.webgl.shaderSource(t3,e),this.webgl.compileShader(t3);let s=`\n         precision mediump float;\n         uniform highp vec4 uColor;\n         void main(void) {\n            gl_FragColor =  uColor;\n         }`,h=this.webgl.createShader(this.webgl.FRAGMENT_SHADER);this.webgl.shaderSource(h,s),this.webgl.compileShader(h),this._progLine=this.webgl.createProgram(),this.webgl.attachShader(this._progLine,t3),this.webgl.attachShader(this._progLine,h),this.webgl.linkProgram(this._progLine)}popDataLine(){this.linesData.pop()}removeAllLines(){this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[]}removeDataLines(){this._linesData=[]}removeAuxLines(){this._linesAux=[]}viewport(e,t3,s,h){this.webgl.viewport(e,t3,s,h)}log(e){this.debug&&console.log("[webgl-plot]:"+e)}};var y2=class{constructor(){this.plots={}}initPlot(e,t3){if(t3||(t3=new L(e.canvas,e.webglOptions)),!e._id)e._id=`plot${Math.floor(Math.random()*1e15)}`;else if(this.plots[e._id]){let l=this.plots[e._id].initial;if(e.lines){for(let i3 in e.lines)if(l.lines[i3]&&Array.isArray(e.lines[i3])){let u3=e.lines[i3];e.lines[i3]=l.lines[i3]}}e=Object.assign(l,e)}e.overlay&&(typeof e.overlay!="object"&&(e.overlay=document.createElement("canvas"),e.overlay.style.position="absolute",e.overlay.width=e.canvas.width,e.overlay.height=e.canvas.height,e.canvas.appendChild(e.overlay)),e.overlayCtx||(e.overlayCtx=e.overlay.getContext("2d"))),e.width&&(e.canvas.width=e.width,e.canvas.style&&(e.canvas.style.width=e.width+"px"),typeof e.overlay=="object"&&(e.overlay.width=e.width,e.overlay.style&&(e.overlay.style.width=e.width+"px"))),e.height&&(e.canvas.height=e.height,e.canvas.style&&(e.canvas.style.height=e.height+"px"),typeof e.overlay=="object"&&(e.overlay.height=e.height,e.overlay.style&&(e.overlay.style.height=e.height+"px"))),e.lines?.timestamp&&delete e.lines.timestamp,e.lines||(e.lines={});let s={};for(let l in e.lines)s[l]=Object.assign({},s[l]),"viewing"in e.lines[l]||(e.lines[l].viewing=true),s[l].viewing=e.lines[l].viewing,s[l].sps=e.lines[l].sps,s[l].nSec=e.lines[l].nSec,s[l].nPoints=e.lines[l].nPoints,s[l].ymin=e.lines[l].ymin,s[l].ymax=e.lines[l].ymax,s[l].units=e.lines[l].units;let h={plot:t3,settings:e,initial:Object.assign(Object.assign({},e),{lines:s}),anim:()=>{t3.update()}};this.plots[e._id]=h;let o=0,a=0;Object.keys(e.lines).forEach(l=>{e.lines[l]?.viewing!==false&&a++}),e.nLines=a;let r,n;typeof e.overlay=="object"&&(r=e.overlay,n=e.overlayCtx,n.clearRect(0,0,e.overlay.width,e.overlay.height),n.font=e.overlayFont?e.overlayFont:"1em Courier",n.fillStyle=e.overlayColor?e.overlayColor:"white");for(let l in e.lines){let i3=e.lines[l];if(Array.isArray(i3)&&(i3={values:i3},e.lines[l]=i3),"viewing"in i3||(i3.viewing=true),i3.color)Array.isArray(i3.color)&&(i3.color=new v(...i3.color));else{let m=y2.HSLToRGB(360*(o/a)%360,100,50,1);h.initial.lines[l].color=[...m,1],i3.color=new v(...m,1)}let u3;if(i3.nSec&&i3.sps?u3=Math.ceil(i3.nSec*i3.sps):i3.nPoints?u3=i3.nPoints:i3.points?u3=i3.points:e.linePoints?u3=e.linePoints:i3.values?u3=i3.values.length:u3=1e3,i3.points=u3,e.lines[l].viewing===false)continue;if((i3.width||e.lineWidth)&&i3.width!==0){let m=e.lineWidth;m||(m=i3.width),i3.width?i3.line=new p(i3.color,u3,i3.width):e.lineWidth&&(i3.line=new p(i3.color,u3,e.lineWidth)),i3.line.lineSpaceX(-1,2/i3.line.numPoints)}else i3.line=new d(i3.color,u3),i3.line.arrangeX();i3.values?.length===i3.points?i3.values.length!==u3&&(i3.interpolate?i3.values.length>u3?i3.values=y2.downsample(i3.values,u3):i3.values.length<u3&&(i3.values=y2.upsample(i3.values,u3)):i3.values.length>i3.points?i3.values=i3.values.slice(i3.values.length-i3.points):i3.values=[...new Array(i3.points-i3.values.length).fill(0),...i3.values]):Array.isArray(i3.values)?i3.values.length>u3?i3.values=i3.values.slice(i3.values.length-u3):i3.values.length<u3&&(i3.values=[...new Array(u3-i3.values.length).fill(0),...i3.values]):i3.values=new Array(i3.points).fill(0);let g=i3.ymin,f=i3.ymax,b=i3.values.length<=1e5;if(g===f?(f=b?Math.max(...i3.values):1,g=b?Math.min(...i3.values):0):isNaN(f)&&(f=b?Math.max(...i3.values):1),isNaN(g)&&(g=b?Math.min(...i3.values):0),g>f){let m=g;f=g,g=m}let w=Math.abs(g);if(i3.absmax=w>f?w:f,"autoscale"in i3||(i3.autoscale=true),i3.position||(i3.position=e.nLines-o-1),i3.autoscale?i3.autoscale===2?("clamp"in i3||(i3.clamp=true),i3.scaled=y2.autoscale(i3.values,i3.position,a,i3.centerZero,g,f,i3.clamp)):(i3.scaled=i3.values,i3.line.scaleY=y2.getYScalar(i3.values,a,i3.centerZero,g,f),i3.line.offsetY=y2.getYOffset(i3.position,a,g,i3.line.scaleY)):i3.scaled=i3.values,i3.scaled.forEach((m,_)=>i3.line.setY(_,m)),i3.line instanceof p?t3.addThickLine(i3.line):i3.line instanceof d&&t3.addDataLine(i3.line),"xAxis"in i3||(i3.xAxis=true),i3.xAxis){i3.xColor?Array.isArray(i3.xColor)&&(i3.xColor=new v(...i3.xColor)):i3.xColor=new v(1,1,1,.3);let m=new d(i3.xColor,2),_=i3.autoscale?(o+1)*2/a-1-1/a:0;m.constY(_),m.arrangeX(),m.xy[2]=1,i3.x=m,t3.addAuxLine(m)}if(a>1&&i3.autoscale&&o!==a-1){e.dividerColor?Array.isArray(e.dividerColor)&&(e.dividerColor=new v(...e.dividerColor)):e.dividerColor=new v(1,1,1,1);let m=new d(e.dividerColor,2);m.constY(i3.autoscale?(o+1)*2/a-1:1),m.arrangeX(),m.xy[2]=1,i3.divider=m,t3.addAuxLine(m)}if(typeof e.overlay=="object"&&(i3.useOverlay||!("useOverlay"in i3))){let m=e.nLines-i3.position-1;n.fillText(l,20,r.height*(m+.2)/e.nLines),n.fillText(`${Math.floor(f)===f?f:f?.toFixed(5)} ${i3.units?i3.units:""}`,r.width-100,r.height*(m+.2)/e.nLines),n.fillText(`${Math.floor(g)===g?g:g?.toFixed(5)} ${i3.units?i3.units:""}`,r.width-100,r.height*(m+.9)/e.nLines)}o++}return requestAnimationFrame(h.anim),this.plots[e._id]}deinitPlot(e){return typeof e=="string"&&(e=this.plots[e]),e.plot.clear(),e.plot.removeAllLines(),true}reinitPlot(e,t3){if(typeof e=="string"){let s=e;e=this.plots[e],t3._id||(t3._id=s)}if(e.plot)return e.plot.clear(),e.plot.removeAllLines(),e.settings.overlayCtx&&e.settings.overlayCtx.clearRect(0,0,e.settings.overlay?.width,e.settings.overlay?.height),this.initPlot(t3,e.plot)}getChartSettings(e,t3){let s=this.plots[e];if(s){let h=Object.assign({},s.initial);for(let o in s.initial.lines)typeof s.initial.lines[o]?.ymax!="number"&&(h.lines[o].ymax=s.settings.lines[o]?.ymax),typeof s.initial.lines[o]?.ymin!="number"&&(h.lines[o].ymin=s.settings.lines[o]?.ymin),t3&&(h.lines[o].values=s.settings.lines[o].values);return delete h.canvas,delete h.overlay,delete h.overlayCtx,h}}update(e,t3,s=true){if(typeof e=="string"&&(e=this.plots[e]),!e)return false;if(t3){let h=false,o,a;typeof e.settings.overlay=="object"&&(o=e.settings.overlay,a=e.settings.overlayCtx,a.font=e.settings.overlayFont?e.settings.overlayFont:"1em Courier",a.fillStyle=e.settings.overlayColor?e.settings.overlayColor:"white");for(let r in t3)if(e.settings.lines[r]&&e.settings.lines[r].line){if(e.settings.lines[r]?.viewing===false)continue;let n=e.settings.lines[r];if(n.values){if(e.settings.mode&&e.settings.mode==="sweep"){"ct"in n||(n.ct=0);let f=b=>{n.ct>n.values.length&&(n.ct=0),n.values[n.ct]=b,n.ct++};Array.isArray(t3[r])?t3[r].forEach(f):typeof t3[r]=="number"?f(t3[r]):t3[r].values&&t3[r].values.forEach(f)}else Array.isArray(t3[r])&&n.values?.length<1e5?(n.values.length===0&&(n.values.length=n.points?n.points:1e3),t3[r].length===n.values.length?n.values=t3[r]:y2.circularBuffer(n.values,t3[r])):typeof t3[r]=="number"?(n.values.push(t3[r]),n.values.shift()):t3[r]?.values&&(n.values.length===0&&(n.values.length=n.points?n.points:1e3),t3[r].values.length===n.values.length?n.values=t3[r].values:y2.circularBuffer(n.values,t3[r].values));n.values.length!==n.points&&(n.interpolate?n.values.length>n.points?n.values=y2.downsample(n.values,n.points):n.scaled.length<n.points&&(n.values=y2.upsample(n.values,n.points)):n.values.length>n.points?n.values.splice(0,n.values.length-n.points):n.values=new Array(n.points).fill(0).splice(n.points-n.values.length,0,n.values));let l=n.ymin,i3=n.ymax,u3=n.values.length<=1e5;if(l===i3?(i3=u3?Math.max(...n.values):1,l=u3?Math.min(...n.values):0):isNaN(i3)&&(i3=u3?Math.max(...n.values):1),isNaN(l)&&(l=u3?Math.min(...n.values):0),l>i3){let f=l;i3=l,l=f}let g=Math.abs(l);if(n.absmax=g>i3?g:i3,n.autoscale?n.autoscale===2?n.scaled=y2.autoscale(n.values,n.position,e.settings.nLines,n.centerZero,l,i3,n.clamp):(n.scaled=n.values,n.line.scaleY=y2.getYScalar(n.values,e.settings.nLines,n.centerZero,l,i3),n.line.offsetY=y2.getYOffset(n.position,e.settings.nLines,l,n.line.scaleY)):n.scaled=n.values,n.scaled.forEach((f,b)=>{!n.autoscale&&n.absmax>1?n.line.setY(b,f/n.absmax):n.line.setY(b,f)}),typeof e.settings.overlay=="object"&&(n.useOverlay||!("useOverlay"in n))){let f=e.settings.nLines-n.position-1,b=o.height*f/e.settings.nLines,w=o.height/e.settings.nLines;if(a.clearRect(0,b,o.width,w),e.settings.mode&&e.settings.mode==="sweep"){a.fillStyle=e.settings.sweepColor?e.settings.sweepColor:"rgba(0,255,0,0.25)",a.beginPath();let m=o.width*n.ct/n.values.length;a.moveTo(m,b),a.lineTo(m,w),a.stroke()}a.fillStyle=e.settings.overlayColor?e.settings.overlayColor:"white",a.fillText(r,20,o.height*(f+.2)/e.settings.nLines),a.fillText(`${Math.floor(i3)===i3?i3:i3?.toFixed(5)} ${n.units?n.units:""}`,o.width-100,o.height*(f+.2)/e.settings.nLines),a.fillText(`${Math.floor(l)===l?l:l?.toFixed(5)} ${n.units?n.units:""}`,o.width-100,o.height*(f+.9)/e.settings.nLines)}}}else e.settings.generateNewLines&&!r.includes("timestamp")&&(Array.isArray(t3[r])&&(t3[r]={values:t3[r]}),!t3[r].nSec&&!t3[r].nPoints&&!e.settings.linePoints&&(t3[r].nPoints=1e3),h=true);if(h)return e.settings.cleanGeneration||Object.keys(e.initial.lines).forEach(r=>{t3[r]?t3[r]=Object.assign(e.initial.lines[r],t3[r]):t3[r]=e.initial.lines[r]}),this.reinitPlot(e,{_id:e.settings._id,lines:t3}),true}return s&&requestAnimationFrame(e.anim),true}updateLine(e,t3,s,h,o,a,r){return e.numPoints!==t3.length&&(s?e.numPoints>t3.length?t3=y2.downsample(t3,e.numPoints):e.numPoints<t3.length&&(t3=y2.upsample(t3,e.numPoints)):t3.length>e.numPoints?t3=t3.slice(t3.length-e.numPoints):t3=[...new Array(t3.length).fill(0),...t3]),h&&(t3=y2.autoscale(t3,o,a,r)),t3.forEach((n,l)=>e.setY(l,n)),true}static autoscale(e,t3=0,s=1,h=false,o,a,r){if(e?.length===0)return e;let n=typeof a=="number"?a:e.length<=1e5?Math.max(...e):1,l=typeof o=="number"?o:e.length<=1e5?Math.min(...e):0,i3=1/s,u3=1;if(h){let g=Math.max(Math.abs(l),Math.abs(n));return g!==0&&(u3=i3/g),e.map(f=>(r&&(f<l&&(f=l),f>n&&(f=n)),f*u3+(i3*(t3+1)*2-1-i3)))}else return n===l?n!==0?u3=i3/n:l!==0&&(u3=i3/Math.abs(l)):u3=i3/(n-l),e.map(g=>(r&&(g<l&&(g=l),g>n&&(g=n)),2*((g-l)*u3-1/(2*s))+(i3*(t3+1)*2-1-i3)))}static getYScalar(e,t3=1,s=false,h,o){if(e?.length===0)return e;let a=typeof o=="number"?o:e.length<=1e5?Math.max(...e):1,r=typeof h=="number"?h:e.length<=1e5?Math.min(...e):0,n=1/t3,l=1;if(s){let i3=Math.max(Math.abs(r),Math.abs(a));return i3!==0&&(l=n/i3),2*l}else return a===r?a!==0?l=n/a:r!==0&&(l=n/Math.abs(r)):l=n/(a-r),2*l}static getYOffset(e=0,t3=1,s=0,h=1){let o=1/t3,a=o*(e+1)*2-1-o;return s!==0?a-=s*h+1/t3:a-=h+1/t3,a}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t3,s=1){if(e.length>t3){let h=new Array(t3),o=e.length/t3,a=e.length-1,r=0,n=0;for(let l=o;l<e.length;l+=o){let i3=Math.round(l);i3>a&&(i3=a);for(let u3=r;u3<i3;u3++)h[n]+=e[u3];h[n]/=(i3-r)*s,n++,r=i3}return h}else return e}static upsample(e,t3,s=1){var h=function(g,f,b){return(g+(f-g)*b)*s},o=new Array(t3),a=(e.length-1)/(t3-1);o[0]=e[0];for(var r=1;r<t3-1;r++){var n=r*a,l=Math.floor(n),i3=Math.ceil(n),u3=n-l;o[r]=h(e[l],e[i3],u3)}return o[t3-1]=e[e.length-1],o}static interpolate(e,t3,s=1){return e.length>t3?y2.downsample(e,t3,s):e.length<t3?y2.upsample(e,t3,s):e}static HSLToRGB(e,t3,s,h=255){t3/=100,s/=100;let o=(1-Math.abs(2*s-1))*t3,a=o*(1-Math.abs(e/60%2-1)),r=s-o/2,n=0,l=0,i3=0;return 0<=e&&e<60?(n=o,l=a,i3=0):60<=e&&e<120?(n=a,l=o,i3=0):120<=e&&e<180?(n=0,l=o,i3=a):180<=e&&e<240?(n=0,l=a,i3=o):240<=e&&e<300?(n=a,l=0,i3=o):300<=e&&e<360&&(n=o,l=0,i3=a),n=(n+r)*h,l=(l+r)*h,i3=(i3+r)*h,[n,l,i3]}static circularBuffer(e,t3){if(t3.length<e.length){let s=e.slice(t3.length),h=e.length;e.splice(0,h,...s,...t3)}else if(t3.length>e.length){let s=e.length;e.splice(0,s,...t3.slice(t3.length-s))}else e.splice(0,e.length,...t3);return e}static formatDataForCharts(e,t3){if(Array.isArray(e)){if(Array.isArray(e[0])){let s={};if(e.forEach((h,o)=>{s[o]=h}),e=s,isNaN(e[0][0]))return}else if(t3){if(e={[t3]:e},isNaN(e[t3][0]))return}else if(e={0:e},isNaN(e[0][0]))return}else if(typeof e=="object"){for(let s in e)if(typeof e[s]=="number"?e[s]=[e[s]]:e[s]?.values&&typeof e[s].values=="number"&&(e[s].values=[e[s].values]),isNaN(e[s][0]))return}else if(typeof e=="string"){let s;if(e.includes(`\\r\n`)){let h=e.split(`\\r\n`);e={},h.forEach((o,a)=>{o.includes("	")?s=o.split("	"):o.includes(",")?s=o.split(","):o.includes("|")&&(s=o.split("|")),s&&s.forEach((r,n)=>{if(r.includes(":")){let[l,i3]=r.split(":"),u3=parseFloat(i3);isNaN(u3)||(e[l]=[u3])}else{let l=parseFloat(r);isNaN(l)||(e[n]=[l])}})})}else e.includes("	")?s=e.split("	"):e.includes(",")?s=e.split(","):e.includes("|")&&(s=e.split("|"));e={},s&&s.forEach((h,o)=>{if(h.includes(":")){let[a,r]=h.split(":"),n=parseFloat(r);isNaN(n)||(e[a]=[n])}else{let a=parseFloat(h);isNaN(a)||(e[o]=[a])}})}else typeof e=="number"&&(t3?e={[t3]:[e]}:e={0:[e]});return e}static padTime(e,t3,s,h){let o=(e[0]-t3)/s/h;return[...new Array(h-e.length).map((r,n)=>t3+o*(n+1)),...e]}static interpolateForTime(e,t3,s){return y2.interpolate(e,Math.ceil(s*t3))}};var webglPlotRoutes={setupChart:function setupChart(settings){console.log("initializing chart",settings);if(!this?.__node?.graph?.plotter){this.__node.graph.plotter=new y2;return this.__node.graph.plotter.initPlot(settings).settings._id}else{globalThis.plotter=new y2;return globalThis.plotter.initPlot(settings).settings._id}},updateChartData:function updateChartData(plot,lines,draw=true){if(typeof lines==="object"){if(globalThis.plotter)globalThis.plotter.update(plot,lines,draw);else if(this?.__node?.graph?.plotter)this.__node.graph.plotter.update(plot,lines,draw);return true}return false},clearChart:function clearChart(plot){if(globalThis.plotter)globalThis.plotter.deinitPlot(plot);else if(this?.__node?.graph?.plotter)this.__node.graph.plotter.deinitPlot(plot);return true},resetChart:function resetChart(plot,settings){if(globalThis.plotter)globalThis.plotter.reinitPlot(plot,settings);else if(this?.__node?.graph?.plotter)this.__node.graph.plotter.reinitPlot(plot,settings);return settings._id},getChartSettings:function getChartSettings(plotId){let settings;if(globalThis.plotter)settings=globalThis.plotter.getChartSettings(plotId);else if(this?.__node?.graph?.plotter)settings=this.__node.graph.plotter.getChartSettings(plotId);return settings}};var __defProp22=Object.defineProperty;var __defNormalProp22=(obj,key,value)=>key in obj?__defProp22(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __publicField22=(obj,key,value)=>{__defNormalProp22(obj,typeof key!=="symbol"?key+"":key,value);return value};var _Math2=class{constructor(){}static genSineWave(freq=20,peakAmp=1,nSec=1,fs3=512,freq2=0,peakAmp2=1){var sineWave=[];var t3=[];var increment=1/fs3;for(var ti=0;ti<nSec;ti+=increment){var amplitude=Math.sin(2*Math.PI*freq*ti)*peakAmp;amplitude+=Math.sin(2*Math.PI*freq2*ti)*peakAmp2;sineWave.push(amplitude);t3.push(ti)}return[t3,sineWave]}static getSineAmplitude(frequency=20,peakAmplitude=1,ti=0,tOffset=0){return Math.sin(this.TWO_PI*frequency*ti+tOffset)*peakAmplitude}static mean(arr){var sum=arr.reduce((prev,curr)=>curr+=prev);return sum/arr.length}static mode(arr){return arr.sort((a,b)=>arr.filter(v2=>v2===a).length-arr.filter(v2=>v2===b).length).pop()}static std(arr,mean=void 0){let avg=mean;if(!mean)avg=this.mean(arr);let summed=0;for(let i3=0;i3<arr.length;i3++){let subbed=arr[i3]-avg;summed+=subbed*subbed}return Math.sqrt(summed/arr.length)}static relError(actual=[],forecast=[],abs=true){if(actual.length!==forecast.length)throw new Error("Input arrays of same length!");let i3=actual.length;let d2=new Array(actual.length);for(let j=0;j<i3;j++){let dd=(actual[j]-forecast[j])/actual[j];if(abs)dd=Math.abs(dd);d2[j]=dd}return d2}static informationEntropy(probabilities=[]){let len=probabilities.length;let entropy=new Array(len);for(let i3=0;i3<len;i3++){let ent=probabilities[i3]*Math.log(probabilities[i3]);if(isNaN(ent))ent=0;entropy[i3]=ent}return entropy}static zscore(arr){let mean=this.mean(arr);let std=this.std(arr,mean);let z3=new Array().length(arr.length);for(let i3=0;i3<arr.length;i3++){z3[i3]=(arr[i3]-mean)/std}return z3}static variance(arr){var mean=this.mean(arr);return arr.reduce((a,b)=>a+(b-mean)**2,0)/arr.length}static dot(vec1,vec2){var dot=0;for(var i3=0;i3<vec1.length;i3++){dot+=vec1[i3]*vec2[i3]}return dot}static cross3D(vec1,vec2){return[vec1[1]*vec2[2]-vec1[2]*vec2[1],vec1[2]*vec2[0]-vec1[0]*vec2[2],vec1[0]*vec2[1]-vec1[1]*vec2[0]]}static magnitude(vec){var sqrd=0;vec.forEach(c=>{sqrd+=c*c});return Math.sqrt(sqrd)}static distance(point1,point2){var dsqrd=0;point1.forEach((c,i3)=>{dsqrd+=(point2[i3]-c)*(point2[i3]-c)});return Math.sqrt(dsqrd)}static midpoint(point1=[1,2,3],point2=[3,4,5]){return point1.map((c,i3)=>{return(c+point2[i3])*.5})}static normalize(vec){var norm=0;norm=this.magnitude(vec);var vecn=new Array(vec.length);vec.forEach((c,i3)=>{vecn[i3]=c*norm});return vecn}static normalizeSeries(arr=[],fromZero=true){let max=Math.max(...arr);let min=Math.min(...arr);if(fromZero==false){max=Math.max(max,Math.abs(min));min=0}if(max-min===0){min=0;if(max===0)max=1e-13}return arr.map(v2=>(v2-min)/(max-min))}static quadraticFormula(a,b,c){let bbmac4=Math.sqrt(b*b-4*a*c);if(!isNaN(bbmac4))return["complex","complex"];let _a2=1/(2*a);if(bbmac4===0)return[b*_a2];let nb=-b;return[(nb+bbmac4)*_a2,(nb-bbmac4)*_a2]}static newtonsMethod(foo=x22=>{return Math.pow(x22,5)+x22*x22-x22-.2},start=0,end=1,precision=.01,attempts=10){let roots=[];for(let i3=0;i3<attempts;i3++){let seedx=Math.random()*(end-start);let guess=foo(seedx);let guess2=foo(seedx+precision);let slope=(guess2-guess)/precision;let xn=seedx+precision;while(Math.abs(slope)>precision){let step=-guess/slope2;let xn12=xn+step;guess=guess2;guess2=foo(xn12);let slope2=(guess2-guess)/(xn12-xn)}let idx;let f=roots.find((root,i22)=>{if(Math.abs(xn1-root)<precision){idx=i22;return true}});if(f)roots[idx]=(xn1+f)*.5;else roots.push(xn1)}return roots}static makeVec(point1,point2){var vec=[];point1.forEach((c,i3)=>{vec.push(point2[i3]-c)});return vec}static getBufferedValueByCoordinates(vb=new Array(300).fill(1),dims=[10,10,2],coordinate=[1,2,1],cardinal=void 0){let getIdx=(foundIdx=0,dimIdx=0)=>{if(dimIdx===dims.length)return foundIdx;if(dimIdx==0)foundIdx+=coordinate[dimIdx];else if(dims[dimIdx]==0)dimsAt0++;else{let reMul=(val=coordinate[dimIdx],di=dimIdx-1)=>{val*=dims[di];di--;if(di==0)return val;else return reMul(val,di)};foundIdx+=reMul(coordinate[dimIdx]+1,dimIdx-1)}dimIdx++;return getIdx(foundIdx,dimIdx)};let found=getIdx();if(cardinal){if(coordinate[coordinate.length-1]===0){let lastnonzero=0;let idx=0;while(idx!==coordinate.length-1){if(coordinate[idx]!==0)lastnonzero=idx;idx++}return vb[found-lastnonzero+cardinal]}return vb[found-dims.length+cardinal]}else{if(coordinate[coordinate.length-1]===0){let lastnonzero=0;let idx=0;while(idx!==coordinate.length-1){if(coordinate[idx]!==0)lastnonzero=idx;idx++}return vb.slice(found-lastnonzero,found+1)}return vb.slice(found-dims.length,found+1)}}static forBufferedMat(vb=new Array(100).fill(1),dims=[10,10],asIndex=(v2,i3,x22,y22)=>{return v2+x22+y22}){let coordinate=[];let idx=0;let recurseFor=(depth=0,nextDepth=depth+1)=>{let result=new Array(vb.length);for(let di=0;di<dims[depth];di++){coordinate[depth]=di;if(dims[nextDepth])recurseFor(nextDepth);else{result[idx]=asIndex(vb[idx],idx,...coordinate);idx++}}return result};let recurseForArrFuncs=(depth,nextDepth=depth+1)=>{let result=new Array(vb.length);for(let di=0;di<dims[depth];di++){coordinate[depth]=di;if(dims[nextDepth])recurseFor(nextDepth);else{for(let dj=0;dj<dims.length;dj++){result[idx]=asIndex[dj](vb[idx],idx,...coordinate);idx++}}}return result};if(typeof asIndex==="function"){return recurseFor()}else if(Array.isArray(asIndex)){return recurseForArrFuncs()}}static mapBufferedMat(buffer=new Array(100).fill(1),dimensions=[10,10],asIndex=(v2,idx,i3,j)=>{console.log(`value:${v2}, idx:${idx}, x:${i3},y:${j}`);return v2+i3+j}){let coordinate=new Array(dimensions.length).fill(0);const iterateCoordinate=(coord,idx=0)=>{if(coord[idx]>=dimensions[idx]){coord[idx]=0;idx++;if(idx===dimensions.length)return;iterateCoordinate(coord,idx)}else coord[idx]++};let result=new Array(buffer.length);let i3=0;if(typeof asIndex==="function"){while(i3<buffer.length){result[i3]=asIndex(buffer[i3],i3,...coordinate);i3+=dimensions.length;iterateCoordinate(coordinate)}}else if(Array.isArray(asIndex)){while(i3<buffer.length){asIndex.forEach(func=>{result[i3]=func(buffer[i3],i3,...coordinate);i3++;iterateCoordinate(coordinate)})}}return result}static combinations(choices=["a","b","c"],vecsize=3){var result=[];if(vecsize<=0){result.push([])}else{_Math2.combinations(choices,vecsize-1).forEach(function(previousComb){choices.forEach(function(element){result.push([element].concat(previousComb))})})}return result}static generateCoordinateSpace(upperBounds=[10,10,10],lowerBounds=[-10,-10,-10],steps=[1,1,1],mutater=void 0){for(let i3=0;i3<upperBounds.length;i3++){if(lowerBounds[i3]>upperBounds[i3]){let temp=upperBounds[i3];upperBounds[i3]=lowerBounds[i3];lowerBounds[i3]=temp}}let result=[];let copy=[...upperBounds];let lastindex=copy.length-1;result.push([...copy]);while(copy[0]>=lowerBounds[0]){let checkNextIndex=decrIdx2=>{if(copy[decrIdx2]<=lowerBounds[decrIdx2]){if(decrIdx2===0)return;copy[decrIdx2]=upperBounds[decrIdx2];decrIdx2--;if(decrIdx2<0)return;if(typeof steps[decrIdx2]=="function")copy[decrIdx2]-=steps[decrIdx2](copy[decrIdx2]);else copy[decrIdx2]-=steps[decrIdx2];checkNextIndex(decrIdx2)}};let decrIdx=lastindex;if(typeof steps[decrIdx]=="function")copy[decrIdx]-=steps[decrIdx](copy[decrIdx]);else copy[decrIdx]-=steps[decrIdx];result.push([...copy]);checkNextIndex(decrIdx);if(mutater)result[result.length-1]=mutater(result[result.length-1])}return result}static calcVectorField(coordinates=[[0,0],[0,1],[1,0],[1,1]],formula=(x22,y22)=>{return[x22*10,y22*10]}){return coordinates.map(vec=>formula(...vec))}static transpose(mat){return mat[0].map((_,colIndex)=>mat.map(row=>row[colIndex]))}static matmul(a,b){var aNumRows=a.length,aNumCols=a[0].length,bNumRows=b.length,bNumCols=b[0].length,m=new Array(aNumRows);for(var r=0;r<aNumRows;++r){m[r]=new Array(bNumCols);for(var c=0;c<bNumCols;++c){m[r][c]=0;for(var i3=0;i3<aNumCols;++i3){m[r][c]+=a[r][i3]*b[i3][c]}}}return m}static matscale(mat,scalar){let m=[];for(var i3=0;i3<mat.length;i3++){m[i3]=[];for(let j=0;j<mat[0].length;j++){m[i3][j]=mat[i3][j]*scalar}}return m}static matadd(a,b){let m=[];for(let i3=0;i3<a.length;i3++){m[i3]=[];for(var j=0;j<a[0].length;j++){m[i3][j]=a[i3][j]+b[i3][j]}}return m}static matsub(a,b){let m=[];for(let i3=0;i3<a.length;i3++){m[i3]=[];for(var j=0;j<a[0].length;j++){m[i3][j]=a[i3][j]-b[i3][j]}}return m}static histogram(arr=[],binSize=1,nBins=void 0){let copy=[...arr];copy.sort(function(a,b){return a-b});let binStart=Math.min(...copy);if(typeof nBins==="number"){let binEnd=Math.max(...copy);binSize=Math.abs((binEnd-binStart)/(nBins-1))}let j=binStart;let binx=[];let biny=[];for(let i3=0;i3<copy.length;i3++){let binidx=binSize*j;if(copy[i3]>binStart+binidx){j++;binidx+=binSize;let binmin=binStart+binidx;let binmid=binmin+binidx*.5;binx.push(binmid);biny.push(0)}biny[biny.length-1]++}return[binx,biny]}static normalDistribution(samples=[],normalize=true,cutoff=1e-4){let m=this.mean(samples);let vari=this.variance(samples);let nSamples=samples.length;let probabilities=[];let denom=1/(this.TWO_PI*vari);let _variance=1/vari;let sum=0;for(let i3=0;i3<nSamples;i3++){let px=Math.exp(-.5*Math.pow((samples[i3]-m)*_variance,2))*denom;if(px<cutoff)px=0;probabilities.push(px);sum+=px}if(normalize){let _sum=1/sum;probabilities=probabilities.map(x22=>x22*_sum)}return probabilities}static expectedValue(samples=[],probabilities=this.normalDistribution(samples)){return samples.reduce((sum,item,idx)=>sum+item*probabilities[idx])}static originMoment(samples=[],probabilities=this.normalDistribution(samples),order=1){return samples.reduce((sum,item,idx)=>sum+Math.pow(item,order)*probabilities[idx])}static centralMoment(samples=[],probabilities=this.normalDistribution(samples),order=1){let m=this.mean(samples);return samples.reduce((sum,item,idx)=>sum+Math.pow(item-m,order)*probabilities[idx]/samples.length)}static linearDiscriminantAnalysis(samples=[],classifier=[]){let mean=this.mean(samples);let meank=this.mean(classifier);let covariance=this.cov1d(samples,classifier);let probs=this.normalDistribution(samples);let dk=[];for(let i3=0;i3<samples.length;i3++){dk.push(x[i3]*covariance*meank-.5*mean*covariance*meank+Math.log10(probs[i3]))}return dk}static conv1D(arr=[],kern=[1/3,1/3,1/3],pad=Math.floor(kern.length*.5)){let result=[];let _n=1/kern.length;if(pad>0){let pads=new Array(pad).fill(0);arr=[...pads,...arr,...pads]}let start=Math.floor(kern.length*.5);let end=arr.length-kern.length+start;for(let i3=start;i3<end;i3++){let acc=0;for(let j=0;j<kern.length;j++){acc+=arr[i3-start]*kern[j]}result.push(acc*_n)}return result}static conv2D(mat=[[],[],[]],kern=[[],[],[]],pad=0){let result=new Array(mat.length-Math.ceil(kern.length*.5)).fill([]);let mat_t;let kern_t=_Math2.transpose(kern_t);if(pad>0){let pads=new Array(pad).fill(0);mat_t=_Math2.transpose(mat);for(let i22=0;i22<mat_t.length;i22++){mat_t[i22]=[...pads,...mat_t[i22],...pads]}mat=_Math2.transpose(mat_t);for(let j=0;j<mat.length;j++){mat[j]=[...pads,...mat[j],...pads]}}let startr=Math.floor(kern[0].length*.5);let startl=Math.floor(kern_t[0].length*.5);let endr=mat[0].length-kern[0].length+startr;let endl=mat_t[0].length-kern_t[0].length+startl;let _n=1/(kern[0].length*kern_t[0].length);let iters=endr*endl;let i3=startr;let x22;let y22=startl;while(i3<iters){let acc=0;x22=i3%mat[0].length;if(x22===0){y22++}for(let j=0;j<kern[0].length;j++){for(let k=0;k<kern_t[0].length;j++){acc+=mat[y22-startl+k][x22-startr+j]*kern[k][j]}result[y22].push(acc*_n)}i3++}return result}static cov2d(mat){var mattransposed=this.transpose(mat);var matproducts=[];var rowmeans=[];var colmeans=[];mat.forEach((row,idx)=>{rowmeans.push(this.mean(row))});mattransposed.forEach((col,idx)=>{colmeans.push(this.mean(col))});mat.forEach((row,idx)=>{matproducts.push([]);for(var col=0;col<row.length;col++){matproducts[idx].push((mat[idx][col]-rowmeans[idx])*(mat[idx][col]-colmeans[col])/(row.length-1))}});var matproductstransposed=this.transpose(matproducts);var aNumRows=matproducts.length,aNumCols=matproducts[0].length,bNumRows=matproductstransposed.length,bNumCols=matproductstransposed[0].length,m=new Array(aNumRows);for(var r=0;r<aNumRows;++r){m[r]=new Array(bNumCols);for(var c=0;c<bNumCols;++c){m[r][c]=0;for(var i3=0;i3<aNumCols;++i3){m[r][c]+=matproducts[r][i3]*matproductstransposed[i3][c]/(mat[0].length-1)}}}return m}static cov1d(arr1=[],arr2=[]){return this.cov2d([arr1,arr2])}static cov3d(x22=[],y22=[],z3=[]){return[[this.cov1d(x22,x22),this.cov1d(x22,y22),this.cov1d(x22,z3)],[this.cov1d(y22,x22),this.cov1d(y22,y22),this.cov1d(y22,z3)],[this.cov1d(z3,x22),this.cov1d(z3,y22),this.cov1d(z3,z3)]]}static covNd(dimensionalData=[]){let covariance=[];dimensionalData.forEach((arr,i3)=>{covariance.push([]);dimensionalData.forEach((arr2,j)=>{covariance[i3].push(this.cov1d(arr,arr2))})})}static eigens2x2(mat=[[1,2],[3,4]]){let det=mat[0][0]*mat[1][1]-mat[0][1]*mat[1][0];let mean=(mat[0][0]+mat[1][1])*.5;let sqrt=Math.sqrt(mean*mean-det);let eig1=mean+sqrt;let eig2=mean-sqrt;return[eig1,eig2]}static eigenvectors2x2(mat=[[1,2],[3,4]],eigens=[1,2]){let v1=[-mat[0][1],mat[0][0]-eigens[0]];if(v1[0]===0&&v1[1]===0){v1[0]=mat[1][1]-eigens[0];v1[1]=-mat[1][0]}let v2=[-mat[0][1],mat[0][0]-eigens[1]];if(v2[0]===0&&v2[1]===0){v2[0]=mat[1][1]-eigens[1];v2[1]=-mat[1][0]}return[v1,v2]}static fastpca2d(xarr,yarr){let cov1d=this.cov1d(xarr,yarr);let eigs=this.eigens2x2(cov1d);if(eigs[1]>eigs[0])eigs.reverse();let evs=this.eigenvectors2x2(cov1d,eigs);console.log(eigs,evs);return[eigs,evs]}static crosscorrelation(arr1,arr2){var arr2buf=[...arr2,...Array(arr2.length).fill(0)];var mean1=this.mean(arr1);var mean2=this.mean(arr2);var arr1Est=arr1.reduce((sum,item)=>sum+=Math.pow(item-mean1,2));arr1Est=Math.sqrt(Math.abs(arr1Est));var arr2Est2=arr2.reduce((sum,item)=>sum+=Math.pow(item-mean1,2));arr2Est2=Math.sqrt(Math.abs(arr2Est2));let denom=arr1Est*arr2Est2;if(denom===0)denom=1e-26;var _arrEstsMul=1/denom;var correlations=new Array(arr1.length).fill(0);for(var delay=0;delay<arr1.length;delay++){var r=arr1.reduce((sum,item,i3)=>sum+=(item-mean1)*(arr2buf[delay+i3]-mean2));correlations[delay]=r*_arrEstsMul}return correlations}static autocorrelation(arr1){var delaybuf=[...arr1,...Array(arr1.length).fill(0)];var mean1=this.mean(arr1);var arr1Est=arr1.reduce((sum,item)=>sum+=Math.pow(item-mean1,2));arr1Est=Math.sqrt(Math.abs(arr1Est));let denom=arr1Est*arr2Est;if(denom===0)denom=1e-26;var _arr1estsqrd=1/denom;var correlations=new Array(arr1.length).fill(0);for(var delay=0;delay<arr1.length;delay++){var r=arr1.reduce((sum,item,i3)=>sum+=(item-mean1)*(delaybuf[delay+i3]-mean1));correlations[delay]=r*_arr1estsqrd}return correlations}static autocorrelation2dNormalized(mat2d2){let result=[];for(let y22=0;y22<mat2d2.length;y22++){result.push([]);for(let x22=0;x22<mat2d2[y22].length;x22++){let G3=0;let _G=0;for(let b=0;b<mat2d2.length;b++){for(let a=0;a<mat2d2[b].length;a++){G3+=mat2d2[y22][x22]*mat2d2[mat2d2.length-1-b][mat2d2[y22].length-1-a];_G+=mat2d2[y22][x22]*mat2d2[mat2d2.length-1][mat2d2[y22].length-1]}}result[y22][x22]=G3/_G-1}}return result}static crosscorrelation2d(mat2d1,mat2d2){let result=[];for(let y22=0;y22<mat2d1.length;y22++){result.push([]);for(let x22=0;x22<mat2d1[y22].length;x22++){let G3=0;for(let b=0;b<mat2d2.length;b++){for(let a=0;a<mat2d2[b].length;a++){G3+=mat2d1[y22][x22]*mat2d2[mat2d2.length-1-b][mat2d2[y22].length-1-a]}}result[y22][x22]=G3}}return result}static crosscorrelation2dNormalized(mat2d1,mat2d2){let result=[];for(let y22=0;y22<mat2d1.length;y22++){result.push([]);for(let x22=0;x22<mat2d1[y22].length;x22++){let G3=0;let _G=0;for(let b=0;b<mat2d2.length;b++){for(let a=0;a<mat2d2[b].length;a++){G3+=mat2d1[y22][x22]*mat2d2[mat2d.length-1-b][mat2d2[y22].length-1-a];_G+=mat2d1[y22][x22]*mat2d2[mat2d2.length-1][mat2d2[y22].length-1]}}result[y22][x22]=G3/_G-1}}return result}static correlograms(dat=[[],[]]){var correlograms=[];dat.forEach((row1,i3)=>{dat.forEach((row2,j)=>{if(j>=i3){correlograms.push(_Math2.crosscorrelation(row1,row2))}})});return correlograms}static dft(sineWave=[]){var TWOPI=2*3.141592653589793;var real=[];var imag=[];var mags=[];for(var k=0;k<sineWave.length;k++){real.push(0);imag.push(0);for(var j=0;j<sineWave.length;j++){var shared=TWOPI*k*j/sineWave.length;real[k]=real[k]+sineWave[j]*Math.cos(shared);imag[k]=imag[k]-sineWave[j]*Math.sin(shared)}mags.push(Math.sqrt(real[k]*real[k]+imag[k]*imag[k]))}function orderMagnitudes(unorderedMags){return[...unorderedMags.slice(Math.ceil(unorderedMags.length*.5),unorderedMags.length),...unorderedMags.slice(0,Math.ceil(unorderedMags.length*.5))]}mags=orderMagnitudes(mags);let halflen=mags.length*.5;let freqs=mags.map((m,i3)=>{return i3-halflen});return{real,imag,freqs,mags}}static sma(arr=[],window2){var smaArr=[];for(var i3=0;i3<arr.length;i3++){if(i3==0){smaArr.push(arr[0])}else if(i3<window2){var arrslice=arr.slice(0,i3+1);smaArr.push(arrslice.reduce((previous,current)=>current+=previous)/(i3+1))}else{var arrslice=arr.slice(i3-window2,i3);smaArr.push(arrslice.reduce((previous,current)=>current+=previous)/window2)}}return smaArr}static sum(arr=[]){if(arr.length>0){var sum=arr.reduce((prev,curr)=>curr+=prev);return sum}else{return 0}}static reduceArrByFactor(arr,factor=2){let x22=arr.filter((element,index)=>{return index%factor===0});return x22}static makeArr(startValue,stopValue,nSteps){var arr=[];var step=(stopValue-startValue)/(nSteps-1);for(var i3=0;i3<nSteps;i3++){arr.push(startValue+step*i3)}return arr}static autoscale(array,stackedLines=1,stackPosition=0,centerZero=false){if(array?.length===0)return array;let max=Math.max(...array);let min=Math.min(...array);let _lines=1/stackedLines;let scalar;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));scalar=_lines/absmax;return array.map(y22=>y22*scalar+(_lines*(stackPosition+1)*2-1-_lines))}else{scalar=_lines/(max-min);return array.map(y22=>2*((y22-min)*scalar-1/(2*stackedLines))+(_lines*(stackPosition+1)*2-1-_lines))}}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i3=incr;i3<array.length;i3+=incr){let rounded=Math.round(i3);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static interpolateArray(data,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array;var springFactor=(data.length-1)/(fitCount-1);newData[0]=data[0];for(var i3=1;i3<fitCount-1;i3++){var tmp=i3*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i3]=linearInterpolate(data[before],data[after],atPoint)}newData[fitCount-1]=data[data.length-1];return newData}static isExtrema(arr,critical="peak"){let ref=[...arr];if(ref.length%2===0)ref.pop();if(arr.length>1){let pass=true;for(let i3=0;i3<ref.length;i3++){let val=ref[i3];if(critical==="peak"){if(i3<Math.floor(ref.length*.5)&&val>=ref[Math.floor(ref.length*.5)]){pass=false;break}else if(i3>Math.floor(ref.length*.5)&&val>=ref[Math.floor(ref.length*.5)]){pass=false;break}}else if(critical==="valley"){if(i3<Math.floor(ref.length*.5)&&val<=ref[Math.floor(ref.length*.5)]){pass=false;break}else if(i3>Math.floor(ref.length*.5)&&val<=ref[Math.floor(ref.length*.5)]){pass=false;break}}else{if(i3<Math.floor(ref.length*.5)&&val<=ref[Math.floor(ref.length*.5)]){pass=false;break}else if(i3>Math.floor(ref.length*.5)&&val<=ref[Math.floor(ref.length*.5)]){pass=false;break}}}if(critical!=="peak"&&critical!=="valley"&&pass===false){pass=true;for(let i3=0;i3<ref.length;i3++){let val=ref[i3];if(i3<Math.floor(ref.length*.5)&&val>=ref[Math.floor(ref.length*.5)]){pass=false;break}else if(i3>Math.floor(ref.length*.5)&&val>=ref[Math.floor(ref.length*.5)]){pass=false;break}}}return pass}else return void 0}static isCriticalPoint(arr,critical="peak"){let ref=[...arr];if(ref.length%2===0)ref.pop();if(arr.length>1){let pass=true;for(let i3=0;i3<ref.length;i3++){let val=ref[i3];if(critical==="peak"){if(i3<ref.length*.5&&val<=0){pass=false;break}else if(i3>ref.length*.5&&val>0){pass=false;break}}else if(critical==="valley"){if(i3<ref.length*.5&&val>=0){pass=false;break}else if(i3>ref.length*.5&&val<0){pass=false;break}}else{if(i3<ref.length*.5&&val>=0){pass=false;break}else if(i3>ref.length*.5&&val<0){pass=false;break}}}if(critical!=="peak"&&critical!=="valley"&&pass===false){pass=true;for(let i3=0;i3<ref.length;i3++){let val=ref[i3];if(i3<ref.length*.5&&val<=0){pass=false;break}else if(i3>ref.length*.5&&val>0){pass=false;break}}}return pass}else return void 0}static getPeakThreshold(arr,peakIndices,thresholdVar){let threshold;let filtered=arr.filter((o,i3)=>{if(peakIndices.indexOf(i3)>-1)return true});if(thresholdVar===0){threshold=this.mean(filtered)}else threshold=(thresholdVar+this.mean(filtered))*.5;return threshold}static column(mat,x22){let col=new Array(mat.length).fill(0).map(()=>new Array(1).fill(0));for(let i3=0;i3<mat.length;i3++){col[i3][0]=mat[i3][x22]}return col}static flatten_vector(v2){let v_new=[];for(let i3=0;i3<v2.length;i3++){v_new[i3]=v2[i3][0]}return v_new}static squared_difference(v1,v2){let sum=0;for(let i3=0;i3<v1.length;i3++){sum=sum+Math.pow(v1[i3]-v2[i3],2)}return sum}static shift_deflate(mat,eigenvalue,eigenvector){let len=Math.sqrt(this.matmul(this.transpose(eigenvector),eigenvector));let U=this.matscale(eigenvector,1/len);let delta=this.matscale(this.matmul(U,this.transpose(U)),eigenvalue);let M_new=this.matsub(mat,delta);return M_new}static eigenvalue_of_vector(mat,eigenvector){ev=this.matmul(this.matmul(this.transpose(eigenvector),mat),eigenvector);return ev}static power_iteration(mat,tolerance=1e-5,max_iterations=1e3){let rank=mat.length;let eigenvector=new Array(rank).fill(0).map(()=>new Array(1).fill(Math.sqrt(rank)));let eigenvalue=this.eigenvalue_of_vector(mat,eigenvector);let epsilon=1;let iter=0;while(epsilon>tolerance&&iter<max_iterations){let old_eigenvalue=JSON.parse(JSON.stringify(eigenvalue));let Mv=this.matmul(mat,eigenvector);eigenvector=this.normalize(Mv);eigenvalue=this.eigenvalue_of_vector(mat,eigenvector);epsilon=Math.abs(eigenvalue-old_eigenvalue);iter++};return[eigenvalue,eigenvector]}static eigens(mat,tolerance=1e-4,max_iterations=1e3){let eigenvalues=[];let eigenvectors=[];for(let i3=0;i3<mat.length;i3++){let result=this.power_iteration(mat,tolerance,max_iterations);let eigenvalue=result[0];let eigenvector=result[1];eigenvalues[i3]=eigenvalue;eigenvectors[i3]=this.flatten_vector(eigenvector);mat=this.shift_deflate(mat,eigenvalue,eigenvector)}return[eigenvalues,eigenvectors]}static pca(mat,tolerance=1e-5){let dims=mat.length;let t3=new Array(dims);let p2=new Array(dims);let mat_t=this.transpose(mat);t3[0]=this.column(mat,0);let epsilon=1;let iter=0;while(espilon>tolerance){iter++;p2[0]=this.matmul(mat_t,t3[0]);let tp=this.matmul(this.transpose(t3[0]),t3[0]);p2[0]=this.matscale(p2[0],1/tp);let p_length=Math.sqrt(this.matmul(this.transpose(p2[0]),p2[0]));p2[0]=this.matscale(p2[0],1/p_length);let t_new=this.matmul(mat,p2[0]);let pp=this.matmul(this.transpose(p2[0]),p2[0]);t_new=this.matscale(t_new,1/pp);epsilon=this.squared_difference(t3[0],t_new);t3[0]=JSON.parse(JSON.stringify(t_new))}let components=this.matmul(this.transpose(t3[0]),t3[0]);return components}static circularBuffer(arr,newEntries){if(Array.isArray(newEntries)){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,newEntries.slice(len-newEntries.length))}else{arr.splice(0,arr.length,...newEntries)}}else{arr.push(newEntries);arr.shift()}return arr}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x22=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x22;b=0}else if(60<=h&&h<120){r=x22;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x22}else if(180<=h&&h<240){r=0;g=x22;b=c}else if(240<=h&&h<300){r=x22;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x22}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static p300(event_timestamps=[],raw_signal=[],signal_timestamps=[],sps11=256){let smoothingstep=Math.floor(sps11/10);let smoothed=this.sma(raw_signal,smoothingstep);let peaks=this.peakDetect(smoothed,"peak",smoothingstep);let mean=this.mean(smoothed);let std=this.std(smoothed,mean);let p_idx=0;let candidates=[];if(peaks.length>0){event_timestamps.forEach((t3,j)=>{while(signal_timestamps[peaks[p_idx]]<t3+200){p_idx++;if(!peaks[p_idx])break}let tempi=0;let tempcandidates=[];while(signal_timestamps[peaks[p_idx+tempi]]<t3+600){tempcandidates.push(p_idx+tempi);tempi++;if(!peaks[p_idx+tempi])break}if(tempcandidates.length>1){let peakvals=[];tempcandidates.forEach(tc=>{peakvals.push(smoothed[peaks[tc]])});let max=Math.max(...peakvals);let maxi=tempcandidates[peakvals.indexOf(max)];candidates.push({event_timestamp:t3,event_index:j,peak_timestamp:signal_timestamps[[peaks[maxi]]],signal_index:[peaks[maxi]],signal_amplitude:raw_signal[[peaks[maxi]]],zscore:(smoothed[peaks[maxi]]-mean)/std})}else if(tempcandidates.length===1)candidates.push({event_timestamp:t3,event_index:j,peak_timestamp:signal_timestamps[peaks[tempcandidates[0]]],signal_index:peaks[tempcandidates[0]],signal_amplitude:raw_signal[[peaks[tempcandidates[0]]]],zscore:(smoothed[peaks[tempcandidates[0]]]-mean)/std})})}return candidates}};var Math2=_Math2;__publicField22(Math2,"TWO_PI",Math.PI*2);__publicField22(Math2,"C",299792458);__publicField22(Math2,"G",66743e-15);__publicField22(Math2,"h",662607015e-42);__publicField22(Math2,"R",8314.32);__publicField22(Math2,"Ra",287);__publicField22(Math2,"H",69.3);__publicField22(Math2,"kbar",1054571817e-43);__publicField22(Math2,"kB",1380649e-29);__publicField22(Math2,"ke",89875517923e-1);__publicField22(Math2,"me",91093837015e-41);__publicField22(Math2,"mp",167262192369e-38);__publicField22(Math2,"mn",167492749804e-38);__publicField22(Math2,"P0",101325);__publicField22(Math2,"T0",288.15);__publicField22(Math2,"p0",1.225);__publicField22(Math2,"Na",60220978e16);__publicField22(Math2,"y",1.405);__publicField22(Math2,"M0",28.96643);__publicField22(Math2,"g0",9.80665);__publicField22(Math2,"Re",6378100);__publicField22(Math2,"B",1458e-9);__publicField22(Math2,"S",110.4);__publicField22(Math2,"Sigma",365e-12);__publicField22(Math2,"imgkernels",{edgeDetection:[[-1,-1,-1],[-1,8,-1],[-1,-1,-1]],boxBlur:[[1/9,1/9,1/9],[1/9,1/9,1/9],[1/9,1/9,1/9]],sobelLeft:[[1,0,-1],[2,0,-2],[1,0,-1]],sobelRight:[[-1,0,1],[-2,0,2],[-1,0,1]],sobelTop:[[1,2,1],[0,0,0],[-1,-2,-1]],sobelBottom:[[-1,2,1],[0,0,0],[1,2,1]],identity:[[0,0,0],[0,1,0],[0,0,0]],gaussian3x3:[[1,2,1],[2,4,2],[1,2,1]],guassian7x7:[[0,0,0,5,0,0,0],[0,5,18,32,18,5,0],[0,18,64,100,64,18,0],[5,32,100,100,100,32,5],[0,18,64,100,64,18,0],[0,5,18,32,18,5,0],[0,0,0,5,0,0,0]],emboss:[[-2,-1,0],[-1,1,1],[0,1,2]],sharpen:[[0,-1,0],[-1,5,-1],[0,-1,0]]});__publicField22(Math2,"integral",(func=x22=>{let y22=x22;return y22},range=[],stepx=.01)=>{let area=0;for(let i3=range[0];i3<range[1];i3+=stepx){let y22=func(i3);area+=y22*stepx}return area});__publicField22(Math2,"dintegral",(func=(x22,y22)=>{let z3=x22+y22;return z3},range=[[],[]],stepx=.01,stepy=stepx)=>{let volume=0;for(let i3=range[0][0]+stepx;i3<range[0][1];i3+=stepx){for(let j=range[1][0]+stepy;j<range[1][1];j+=stepy){let z3=func(i3,j);volume+=z3*stepx*stepy}}return volume});__publicField22(Math2,"tintegral",(func=(x22,y22,z3)=>{let w=x22+y22+z3;return w},range=[[],[],[]],stepx=.01,stepy=stepx,stepz=stepx)=>{let volume=0;for(let i3=range[0][0]+stepx;i3<range[0][1];i3+=stepx){for(let j=range[1][0]+stepy;j<range[1][1];j+=stepy){for(let k=range[2][0]+stepz;k<range[2][1];k+=stepz){let w=func(i3,j,k);volume+=w*stepx*stepy*stepz}}}return volume});__publicField22(Math2,"pintegral",(func=x22=>{let y22=x22;return y22},range=[],stepx=.01)=>{let length=0;let y0=void 0;let yi=void 0;for(let i3=range[0];i3<range[1];i3+=stepx){y0=yi;yi=func(i3);if(y0)length+=_Math2.distance([0,y0],[stepx,yi])}return length});__publicField22(Math2,"meshgrid",_Math2.generateCoordinateSpace);__publicField22(Math2,"autocorrelation2d",mat2d2=>{let result=[];for(let y22=0;y22<mat2d2.length;y22++){result.push([]);for(let x22=0;x22<mat2d2[y22].length;x22++){let G3=0;for(let b=0;b<mat2d2.length;b++){for(let a=0;a<mat2d2[b].length;a++){G3+=mat2d2[y22][x22]*mat2d2[mat2d2.length-1-b][mat2d2[y22].length-1-a]}}result[y22][x22]=G3}}return result});__publicField22(Math2,"lerp",_Math2.makeArr);__publicField22(Math2,"upsample",_Math2.interpolateArray);__publicField22(Math2,"lerp",(v0,v1,fit,floor=true)=>{function lerp2(v02,v12,t3){return(1-t3)*v02+t3*v12}function interpolerp2(v02,v12,fit2,floor2=true){if(fit2<=2)return[v02,v12];let a=1/fit2;let result=new Array(fit2);result[0]=v02;for(let i3=1;i3<=fit2;i3++){result[i3]=lerp2(v02,v12,a*i3);if(floor2)result[i3]=Math.floor(result[i3])}return result}});__publicField22(Math2,"peakDetect",(smoothedArray,type="peak",window2=49)=>{let mid=Math.floor(window2*.5);let peaks=[];for(let i3=0;i3<smoothedArray.length-window2;i3++){let isPeak=_Math2.isExtrema(smoothedArray.slice(i3,i3+window2),type);if(isPeak){peaks.push(i3+mid-1)}}return peaks});Object.assign(Math,Math2);var accel_gyro={accelConstant:1/8192,gyroConstant:1/65.5,gyroXAngle:0,gyroYAngle:0,gyroZAngle:0,px:0,py:0,pz:0,sps:100,lastAccelTime:Date.now(),lastGyroTime:Date.now(),__operator:function(data){if(!("ax"in data)&&!("gx"in data))return void 0;if(!data.timestamp){if(data.ax&&Array.isArray(data.ax)||data.gx&&Array.isArray(data.gx)){let len=data.ax?data.ax.length:data.gx.length;let now=Date.now();let toInterp=[now-len*this.sps*1e3,now];data.timestamp=Math2.upsample(toInterp,len)}else{data.timestamp=Date.now()}}let result;if(data.ax){let apass=(timestamp,ax,ay,az)=>{ax=ax*this.accelConstant;ay=ay*this.accelConstant;az=az*this.accelConstant;const accelXAngle=Math.atan(ay/Math.sqrt(ax*ax)+az*az*180/Math.PI)+this.accelXError;const accelYAngle=Math.atan(-ax/Math.sqrt(ay*ay)+az*az*180/Math.PI)+this.accelYError;return{ax,ay,az,roll:accelXAngle,pitch:accelYAngle}};if(Array.isArray(data.timestamp)){result=data.timestamp.map((v2,i3)=>{return apass(v2,data.ax[i3],data.ay[i3],data.az[i3])})}else result=apass(data.timestamp,data.ax,data.ay,data.az)}if(data.gx){let gpass=(timestamp,gx,gy,gz)=>{const elapsed=timestamp-this.lastGyroTime;this.lastGyroTime=timestamp;gx=gx*this.gyroConstant+this.gyroXError;gy=gy*this.gyroConstant+this.gyroYError;gz=gz*this.gyroConstant+this.gyroZError;this.gyroXAngle+=gx*elapsed;this.gyroYAngle+=gy*elapsed;this.gyroZAngle+=gz*elapsed;return{gx,gy,gz,roll:this.gyroXAngle,pitch:this.gyroYAngle,yaw:this.gyroZAngle}};let res;if(Array.isArray(data.timestamp)){res=data.timestamp.map((v2,i3)=>{if(result){let r=gpass(v2,data.gx[i3],data.gy[i3],data.gz[i3]);result.roll=result.roll*.04+r.roll*.96;result.pitch=result.pitch*.04+r.pitch*.96;result.yaw=res.yaw}else return gpass(v2,data.gx[i3],data.gy[i3],data.gz[i3])});if(!result)result=res}else{res=gpass(data.timestamp,data.gx,data.gy,data.gz);if(result){result.roll=result.roll*.04+res.roll*.96;result.pitch=result.pitch*.04+res.pitch*.96;result.yaw=res.yaw}else result=res}}else if(this.gyroXAngle||this.gyroYAngle||this.gyroZAngle){result.roll=result.roll*.04+this.gyroXAngle*.96;result.pitch=result.pitch*.04+this.gyroYAngle*.96;result.yaw=this.gyroXAngle}if(result.ax){const setPositionOffset=(timestamp,result2)=>{const elapsed=timestamp-this.lastAccelTime;this.lastAccelTime=timestamp;this.px+=result2.ax*elapsed*elapsed*Math.cos(this.pitch*Math.PI*.005555555555);this.py+=result2.ay*elapsed*elapsed*Math.cos(this.roll*Math.PI*.005555555555);this.pz+=result2.az*elapsed*elapsed*Math.sin(this.pitch*Math.PI*.005555555555);result2.px=this.px;result2.py=this.py;result2.pz=this.pz;return result2};if(Array.isArray(data.timestamp)){data.timestamp.map((timestamp,i3)=>{setPositionOffset(timestamp,result)})}else{setPositionOffset(data.timestamp,result)}}return result}};var Biquad=class{type;freq;sps;Q;dbGain;a0=0;a1=0;a2=0;b0=0;b1=0;b2=0;x1=0;x2=0;y1=0;y2=0;constructor(type,freq,sps11,Q=1/Math.sqrt(2),dbGain=0){let types=["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"];if(types.indexOf(type)<0){console.error("Valid types: \'lowpass\',\'highpass\',\'bandpass\',\'notch\',\'peak\',\'lowshelf\',\'highshelf\'");return}this.type=type;this.freq=freq;this.sps=sps11;this.Q=Q;this.dbGain=dbGain;let A22=Math.pow(10,dbGain/40);let omega=2*Math.PI*freq/sps11;let sn=Math.sin(omega);let cs=Math.cos(omega);let alpha=sn/(2*Q);let beta=Math.sqrt(A22+A22);this[type](A22,sn,cs,alpha,beta);this.b0/=this.a0;this.b1/=this.a0;this.b2/=this.a0;this.a1/=this.a0;this.a2/=this.a0}lowpass(A22,sn,cs,alpha,beta){this.b0=(1-cs)*.5;this.b1=1-cs;this.b2=(1-cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}highpass(A22,sn,cs,alpha,beta){this.b0=(1+cs)*.5;this.b1=-(1+cs);this.b2=(1+cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}bandpass(A22,sn,cs,alpha,beta){this.b0=alpha;this.b1=0;this.b2=-alpha;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}notch(A22,sn,cs,alpha,beta){this.b0=1;this.b1=-2*cs;this.b2=1;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}peak(A22,sn,cs,alpha,beta){this.b0=1+alpha*A22;this.b1=-2*cs;this.b2=1-alpha*A22;this.a0=1+alpha/A22;this.a1=-2*cs;this.a2=1-alpha/A22}lowshelf(A22,sn,cs,alpha,beta){this.b0=A22*(A22+1-(A22-1)*cs+beta*sn);this.b1=2*A22*(A22-1-(A22+1)*cs);this.b2=A22*(A22+1-(A22-1)*cs-beta*sn);this.a0=A22+1+(A22+1)*cs+beta*sn;this.a1=2*(A22-1+(A22+1)*cs);this.a2=A22+1+(A22-1)*cs-beta*sn}highshelf(A22,sn,cs,alpha,beta){this.b0=A22*(A22+1+(A22-1)*cs+beta*sn);this.b1=2*A22*(A22-1+(A22+1)*cs);this.b2=A22*(A22+1-(A22-1)*cs-beta*sn);this.a0=A22+1-(A22+1)*cs-beta*sn;this.a1=2*(A22-1-(A22+1)*cs);this.a2=A22+1-(A22-1)*cs-beta*sn}applyFilter(signal_step){let y22=this.b0*signal_step+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;this.x2=this.x1;this.x1=signal_step;this.y2=this.y1;this.y1=y22;return y22}zResult(freq){try{let phi=Math.pow(Math.sin(Math.PI*freq*2/(2*this.sps)),2);let result=(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*phi+16*this.b0*this.b2*phi*phi)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*phi+16*this.a2*phi*phi);return result}catch(err){return-200}}static calcCenterFrequency(freqStart,freqEnd){return(freqStart+freqEnd)/2}static calcBandwidth(freqStart,freqEnd){return freqEnd-this.calcCenterFrequency(freqStart,freqEnd)}static calcBandpassQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*Math.sqrt((frequency-bandwidth)*(frequency+bandwidth))/(2*bandwidth);return Q}static calcNotchQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*frequency*bandwidth/Math.sqrt((frequency-bandwidth)*(frequency+bandwidth));return Q}};var beat_detect={refdata:[],lowpass:void 0,smoothed:[],timestamp:[],peaks:[],valleys:[],peak_distances:[],valley_distances:[],beats:[],lastPeak:0,lastValley:0,sps:100,maxFreq:4,limit:10,__onconnected:function(){if(!this.lowpass){let freq=this.maxFreq;if(!freq)freq=1;if(freq>1)freq*=.5;this.lowpass=new Biquad("lowpass",this.maxFreq,this.sps);this.peakFinderWindow=Math.floor(this.sps/this.maxFreq);if(this.peakFinderWindow%2===0)this.peakFinderWindow+=1;if(this.peakFinderWindow<5)this.peakFinderWindow=5;this.midpoint=Math.round(this.peakFinderWindow*.5)}},__operator:function(data){if(!("red"in data)&&!("heg"in data)&&!("raw"in data))return void 0;let refdata=data.red?data.red:data.heg?data.heg:data.raw;if(!("timestamp"in data)){if(Array.isArray(refdata)){let now=Date.now();let len;if(refdata)len=refdata.length;let toInterp=[now-refdata.length*this.sps*1e3,now];data.timestamp=Math2.upsample(toInterp,refdata.length)}else{data.timestamp=Date.now()}}let pass=(amplitude,timestamp)=>{if(amplitude){this.refdata.push(amplitude)}this.timestamp.push(timestamp);let beat;if(this.refdata.length>this.peakFinderWindow){this.refdata.shift();this.timestamp.shift()}this.smoothed.push(this.lowpass.applyFilter(this.refdata[this.refdata.length-1]));if(this.smoothed.length>this.peakFinderWindow){this.smoothed.shift()}if(this.smoothed.length===this.peakFinderWindow){if(Math2.isExtrema(this.smoothed,"valley")){this.valleys.push({value:this.smoothed[this.smoothed.length-this.midpoint?this.midpoint:1],timestamp:this.timestamp[this.timestamp.length-this.midpoint?this.midpoint:1]})}else if(Math2.isExtrema(this.smoothed,"peak")){this.peaks.push({value:this.smoothed[this.smoothed.length-this.midpoint?this.midpoint:1],timestamp:this.timestamp[this.timestamp.length-this.midpoint?this.midpoint:1]})}if(this.valleys.length>2&&this.peaks.length>2){if(this.valleys[this.valleys.length-1].timestamp<this.peaks[this.peaks.length-2].timestamp)this.peaks.splice(this.peaks.length-1);if(this.peaks[this.peaks.length-1].timestamp<this.valleys[this.valleys.length-2].timestamp)this.valleys.splice(this.valleys.length-1);this.valley_distances.push({distance:this.valleys[this.valleys.length-1].timestamp-this.valleys[this.valleys.length-2].timestamp,timestamp:this.valleys[this.valleys.length-1].timestamp,peak0:this.valleys[this.valleys.length-1].value,peak1:this.valleys[this.valleys.length-2].value});this.peak_distances.push({distance:this.peaks[this.peaks.length-1].timestamp-this.peaks[this.peaks.length-2].timestamp,timestamp:this.peaks[this.peaks.length-1].timestamp,peak0:this.peaks[this.peaks.length-1].value,peak1:this.peaks[this.peaks.length-2].value});if(this.peak_distances.length>1&&this.valley_distances.length>1){if(this.lastPeak<this.peaks[this.peaks.length-1].timestamp&&this.lastValley<this.peaks[this.peaks.length-1].timestamp){if(this.valley_distances[this.valley_distances.length-1].timestamp>this.peak_distances[this.peak_distances.length-1].timestamp){let bpm,change=0;if(this.beats.length<1){bpm=60/(5e-4*(this.peak_distances[this.peak_distances.length-1].distance+this.valley_distances[this.valley_distances.length-1].distance))}else if(this.beats[this.beats.length-1].timestamp!==this.peak_distances[this.peak_distances.length-1].timestamp){bpm=60/(5e-4*(this.peak_distances[this.peak_distances.length-1].dt+this.valley_distances[this.valley_distances.length-1].dt));change=Math.abs(bpm-this.beats[this.beats.length-1].bpm)}beat={timestamp:this.peak_distances[this.peak_distances.length-1].timestamp,change,bpm,height0:this.peak_distances[this.peak_distances.length-1].peak0-this.valley_distances[this.valley_distances.length-1].peak0,height1:this.peak_distances[this.peak_distances.length-1].peak1-this.valley_distances[this.valley_distances.length-1].peak1};this.beats.push(beat);this.lastPeak=this.peaks[this.peaks.length-1].timestamp;this.lastValley=this.peaks[this.peaks.length-1].timestamp}else{let bpm,change=0;if(this.beats.length<2){bpm=60/(5e-4*(this.peak_distances[this.peak_distances.length-2].distance+this.valley_distances[this.valley_distances.length-2].distance))}else if(this.beats[this.beats.length-1].timestamp!==this.peak_distances[this.peak_distances.length-2].timestamp){bpm=60/(5e-4*(this.peak_distances[this.peak_distances.length-2].distance+this.valley_distances[this.valley_distances.length-2].distance));change=Math.abs(bpm-this.beats[this.beats.length-2].bpm)}beat={timestamp:this.peak_distances[this.peak_distances.length-2].timestamp,change,bpm,height0:this.peak_distances[this.peak_distances.length-2].peak0-this.valley_distances[this.valley_distances.length-2].peak0,height1:this.peak_distances[this.peak_distances.length-2].peak1-this.valley_distances[this.valley_distances.length-2].peak1};if(Array.isArray(beat.timestamp))beat.timestamp=beat.timestamp[0];this.beats.push(beat);this.lastPeak=this.peaks[this.peaks.length-1].timestamp;this.lastValley=this.peaks[this.peaks.length-1].timestamp}}}if(this.peaks.length>this.limit){this.peaks.shift()}if(this.valleys.length>this.limit){this.valleys.shift()}if(this.peak_distances.length>this.limit){this.peak_distances.shift()}if(this.valley_distances.length>this.limit){this.valley_distances.shift()}if(this.beats.length>this.limit){this.beats.shift()}}}return beat};if(data.red){if("ir"in data&&!Array.isArray(data.red))return pass(data.red+data.ir,data.timestamp);let result;if(data.ir)result=data.red.map((v2,i3)=>{return pass(v2+data.ir[i3],data.timestamp[i3])}).filter(v2=>{if(v2)return true});else result=data.red.map((v2,i3)=>{return pass(v2,data.timestamp[i3])}).filter(v2=>{if(v2)return true});return result}else if(data.raw){if(!Array.isArray(data.raw))return pass(data.raw,data.timestamp);let result=data.raw.map((v2,i3)=>{return pass(v2,data.timestamp[i3])}).filter(v2=>{if(v2)return true});return result}else if(Array.isArray(data.heg)){if(!Array.isArray(data.heg))return pass(data.heg,data.timestamp);let result=data.heg.map((v2,i3)=>{return pass(v2,data.timestamp[i3])}).filter(v2=>{if(v2)return true});return result}}};var blink_detect={sps:250,intervals:{},watch:["0"],tolerance:.2,__onconnected:node=>{node.watch.forEach(ch=>node.intervals[ch]={lowpass:new Biquad("lowpass",20,node.sps),filtered:[],averaged:[]})},__operator:function(data){let checkCt=5;let averageCt=50;let found={};let passed=false;let pass=(key,n)=>{let next=this.intervals[key].lowpass.applyFilter(n);this.intervals[key].filtered.push(next);this.intervals[key].averaged.push(next);if(this.intervals[key].filtered.length>checkCt){if(this.intervals[key].averaged.length>averageCt){this.intervals[key].averaged.splice(0,checkCt);let mean=Math2.mean(this.intervals[key].averaged);if(Math.abs(Math.min(...this.intervals[key].filtered))>Math.abs(mean)+this.tolerance){this.intervals[key].filtered.length=0;passed=true;found[key]=true}}else this.intervals[key].filtered.shift()}};for(const key in this.intervals){if(data[key]){if(Array.isArray(data[key])){data[key].forEach(n=>{pass(key,n)})}else if(typeof data[key]==="number")pass(key,data[key])}}if(passed)return found}};var _ArrayManip=class{static autoscale(array,lineIdx=0,nLines=1,centerZero=false,ymin,ymax,clamp){if(array?.length===0)return array;let max=ymax?ymax:Math.max(...array);let min=ymin?ymin:Math.min(...array);let _lines=1/nLines;let scalar=1;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));if(absmax!==0)scalar=_lines/absmax;return array.map(y22=>{if(clamp){if(y22<min)y22=min;if(y22>max)y22=max}return y22*scalar+(_lines*(lineIdx+1)*2-1-_lines)})}else{if(max===min){if(max!==0){scalar=_lines/max}else if(min!==0){scalar=_lines/Math.abs(min)}}else scalar=_lines/(max-min);return array.map(y22=>{if(clamp){if(y22<min)y22=min;if(y22>max)y22=max}return 2*((y22-min)*scalar-1/(2*nLines))+(_lines*(lineIdx+1)*2-1-_lines)})}}static genTimestamps(ct,sps11){let now=Date.now();let toInterp=[now-ct*1e3/sps11,now];return _ArrayManip.upsample(toInterp,ct)}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i3=incr;i3<array.length;i3+=incr){let rounded=Math.round(i3);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static upsample(array,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array(fitCount);var springFactor=(array.length-1)/(fitCount-1);newData[0]=array[0];for(var i3=1;i3<fitCount-1;i3++){var tmp=i3*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i3]=linearInterpolate(array[before],array[after],atPoint)}newData[fitCount-1]=array[array.length-1];return newData}static interpolate(array,fitCount,scalar=1){if(array.length>fitCount){return _ArrayManip.downsample(array,fitCount,scalar)}else if(array.length<fitCount){return _ArrayManip.upsample(array,fitCount,scalar)}return array}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x3=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x3;b=0}else if(60<=h&&h<120){r=x3;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x3}else if(180<=h&&h<240){r=0;g=x3;b=c}else if(240<=h&&h<300){r=x3;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x3}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static circularBuffer(arr,newEntries){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,...newEntries.slice(newEntries.length-len))}else{arr.splice(0,arr.length,...newEntries)}return arr}static reformatData(data,key){if(Array.isArray(data)){if(Array.isArray(data[0])){let d2={};data.forEach((arr,i3)=>{d2[i3]=arr});data=d2;if(isNaN(data[0][0]))return void 0}else if(key){data={[key]:data};if(isNaN(data[key][0]))return void 0}else{data={0:data};if(isNaN(data[0][0]))return void 0}}else if(typeof data==="object"){for(const key2 in data){if(typeof data[key2]==="number")data[key2]=[data[key2]];else if(data[key2]?.values){if(typeof data[key2].values==="number")data[key2].values=[data[key2].values]}if(isNaN(data[key2][0]))return void 0}}else if(typeof data==="string"){let split;if(data.includes("\\r\\n")){let lines=data.split("\\r\\n");data={};lines.forEach((l,j)=>{if(l.includes("	")){split=l.split("	")}else if(l.includes(",")){split=l.split(",")}else if(l.includes("|")){split=l.split("|")}if(Array.isArray(split)){split.forEach((val,i3)=>{if(val.includes(":")){let[key2,v2]=val.split(":");let fl=parseFloat(v2);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i3]=[fl];else return void 0}})}})}else if(data.includes("	")){split=data.split("	")}else if(data.includes(",")){split=data.split(",")}else if(data.includes("|")){split=data.split("|")}data={};if(Array.isArray(split)){split.forEach((val,i3)=>{if(val.includes(":")){let[key2,v2]=val.split(":");let fl=parseFloat(v2);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i3]=[fl];else return void 0}})}}else if(typeof data==="number"){if(key)data={[key]:[data]};else data={0:[data]}}return data}static padTime(data,lastValue,time,targetFit){let slopeIncr=(data[0]-lastValue)/time/targetFit;let padded=[...new Array(targetFit-data.length).map((_,i3)=>lastValue+slopeIncr*(i3+1)),...data];return padded}static interpolateForTime(data,time,targetSPS){return _ArrayManip.interpolate(data,Math.ceil(targetSPS*time))}isTypedArray(x3){return ArrayBuffer.isView(x3)&&Object.prototype.toString.call(x3)!=="[object DataView]"}recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"){if(typeof target[key]==="object")this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target};spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var ArrayManip=_ArrayManip;__publicField2(ArrayManip,"bufferValues",(objects,property,keys3,buffer)=>{if(!Array.isArray(keys3)&&typeof keys3==="object")keys3=Object.keys(keys3);if(!buffer){let object_keys=Object.keys(objects);if(keys3)buffer=new Float32Array(object_keys.length*keys3.length);else{if(typeof objects[object_keys[0]][property]==="object"){keys3=Object.keys(objects[object_keys[0]][property]);buffer=new Float32Array(object_keys.length*keys3.length)}else buffer=new Float32Array(object_keys.length)}}let i3=0;for(const key in objects){if(objects[key][property]){if(keys3){for(let j=0;j<keys3.length;j++){buffer[i3]=objects[key][property][keys3[j]];i3++}}else{buffer[i3]=objects[key][property];i3++}}}return buffer});var rechk=/^([<>])?(([1-9]\\d*)?([xcbB?hHiIfdsp]))*$/;var refmt=/([1-9]\\d*)?([xcbB?hHiIfdsp])/g;var str=(v2,o,c)=>String.fromCharCode(...new Uint8Array(v2.buffer,v2.byteOffset+o,c));var rts=(v2,o,c,s)=>new Uint8Array(v2.buffer,v2.byteOffset+o,c).set(s.split("").map(str23=>str23.charCodeAt(0)));var pst=(v2,o,c)=>str(v2,o+1,Math.min(v2.getUint8(o),c-1));var tsp=(v2,o,c,s)=>{v2.setUint8(o,s.length);rts(v2,o+1,c-1,s)};var lut=le=>({x:c=>[1,c,0],c:c=>[c,1,o=>({u:v2=>str(v2,o,1),p:(v2,c2)=>rts(v2,o,1,c2)})],"?":c=>[c,1,o=>({u:v2=>Boolean(v2.getUint8(o)),p:(v2,B3)=>v2.setUint8(o,B3)})],b:c=>[c,1,o=>({u:v2=>v2.getInt8(o),p:(v2,b)=>v2.setInt8(o,b)})],B:c=>[c,1,o=>({u:v2=>v2.getUint8(o),p:(v2,B3)=>v2.setUint8(o,B3)})],h:c=>[c,2,o=>({u:v2=>v2.getInt16(o,le),p:(v2,h)=>v2.setInt16(o,h,le)})],H:c=>[c,2,o=>({u:v2=>v2.getUint16(o,le),p:(v2,H3)=>v2.setUint16(o,H3,le)})],i:c=>[c,4,o=>({u:v2=>v2.getInt32(o,le),p:(v2,i3)=>v2.setInt32(o,i3,le)})],I:c=>[c,4,o=>({u:v2=>v2.getUint32(o,le),p:(v2,I)=>v2.setUint32(o,I,le)})],f:c=>[c,4,o=>({u:v2=>v2.getFloat32(o,le),p:(v2,f)=>v2.setFloat32(o,f,le)})],d:c=>[c,8,o=>({u:v2=>v2.getFloat64(o,le),p:(v2,d2)=>v2.setFloat64(o,d2,le)})],s:c=>[1,c,o=>({u:v2=>str(v2,o,c),p:(v2,s)=>rts(v2,o,c,s.slice(0,c))})],p:c=>[1,c,o=>({u:v2=>pst(v2,o,c),p:(v2,s)=>tsp(v2,o,c,s.slice(0,c-1))})]});var errbuf=new RangeError("Structure larger than remaining buffer");var errval=new RangeError("Not enough values for structure");var _ByteParser=class extends ArrayManip{static toDataView(value){if(!(value instanceof DataView)){if(typeof value==="string"&&parseInt(value))value=parseInt(value);if(typeof value==="string"){let enc=new TextEncoder;let hascodes={};for(const code in _ByteParser.codes){while(value.indexOf(code)>-1){let idx=value.indexOf(code);value=value.replace(code,"");hascodes[idx]=code}}let encoded=Array.from(enc.encode(value));for(const key in hascodes){encoded.splice(parseInt(key),0,_ByteParser.codes[hascodes[key]])}value=new DataView(new Uint8Array(encoded).buffer)}else if(typeof value==="number"){let tmp=value;if(value<256){value=new DataView(new ArrayBuffer(1));value.setUint8(0,tmp)}else if(value<65536){value=new DataView(new ArrayBuffer(2));value.setInt16(0,tmp)}else{value=new DataView(new ArrayBuffer(4));value.setUint32(0,tmp)}}else if(value instanceof ArrayBuffer||typeof SharedArrayBuffer!=="undefined"&&value instanceof SharedArrayBuffer){value=new DataView(value)}else if(Array.isArray(value)){value=new DataView(Uint8Array.from(value).buffer)}else if(typeof value==="object"){value=new TextEncoder().encode(JSON.stringify(value))}}return value}static searchBuffer(buffer,searchString,limit){var needle=searchString;var haystack=buffer;var search=_ByteParser.boyerMoore(needle);var skip=search.byteLength;var indices=[];for(var i3=search(haystack);i3!==-1;i3=search(haystack,i3+skip)){indices.push(i3);if(limit){if(indices.length>=limit)break}}return indices}static bytesToInt16(x0,x1){let int16=(255&x0)<<8|255&x1;if((int16&32768)>0){int16|=4294901760}else{int16&=65535}return int16}static bytesToUInt16(x0,x1){return x0*256+x1}static Uint16ToBytes(y22){return[y22&255,y22>>8&255]}static bytesToInt24(x0,x1,x22){let int24=(255&x0)<<16|(255&x1)<<8|255&x22;if((int24&8388608)>0){int24|=4278190080}else{int24&=16777215}return int24}static bytesToUInt24(x0,x1,x22){return x0*65536+x1*256+x22}static Uint24ToBytes(y22){return[y22&255,y22>>8&255,y22>>16&255]}static bytesToInt32(x0,x1,x22,x3){let int32=(255&x0)<<24|(255&x1)<<16|(255&x22)<<8|255&x3;if((int32&2147483648)>0){int32|=0}else{int32&=4294967295}return int32}static bytesToUInt32(x0,x1,x22,x3){return x0*16777216+x1*65536+x22*256+x3}static Uint32ToBytes(y22){return[y22&255,y22>>8&255,y22>>16&255,y22>>24&255]}static get2sCompliment(val,nbits5){if(val>4294967296)return null;return val<<32-nbits5>>32-nbits5}static getSignedInt(...args){let pos=0;function getInt(size){var value=0;var first=true;while(size--){if(first){let byte=args[pos++];value+=byte&127;if(byte&128){value-=128}first=false}else{value*=256;value+=args[pos++]}}return value}return getInt(args.length)}static asUint8Array(input){if(input instanceof Uint8Array){return input}else if(typeof input==="string"){var arr=new Uint8Array(input.length);for(var i3=0;i3<input.length;i3++){var c=input.charCodeAt(i3);if(c>127){throw new TypeError("Only ASCII patterns are supported")}arr[i3]=c}return arr}else{return new Uint8Array(input)}}static boyerMoore(patternBuffer){var pattern=_ByteParser.asUint8Array(patternBuffer);var M2=pattern.length;if(M2===0){throw new TypeError("patternBuffer must be at least 1 byte long")}var R2=256;var rightmost_positions=new Int32Array(R2);for(var c=0;c<R2;c++){rightmost_positions[c]=-1}for(var j=0;j<M2;j++){rightmost_positions[pattern[j]]=j}var boyerMooreSearch=(txtBuffer,start,end)=>{var txt=_ByteParser.asUint8Array(txtBuffer);if(start===void 0)start=0;if(end===void 0)end=txt.length;var pat=pattern;var right=rightmost_positions;var lastIndex=end-pat.length;var lastPatIndex=pat.length-1;var skip;for(var i3=start;i3<=lastIndex;i3+=skip){skip=0;for(var j2=lastPatIndex;j2>=0;j2--){var c2=txt[i3+j2];if(pat[j2]!==c2){skip=Math.max(1,j2-right[c2]);break}}if(skip===0){return i3}}return-1};boyerMooreSearch.byteLength=pattern.byteLength;return boyerMooreSearch}static struct(format){let fns=[],size=0,m=rechk.exec(format);if(!m){throw new RangeError("Invalid format string")}const t3=lut("<"===m[1]),lu=(n,c)=>t3[c](n?parseInt(n,10):1);while(m=refmt.exec(format)){((r,s,f)=>{for(let i3=0;i3<r;++i3,size+=s){if(f){fns.push(f(size))}}})(...lu(...m.slice(1)))}const unpack_from=(arrb,offs)=>{if(arrb.byteLength<(offs|0)+size){throw errbuf}let v2=new DataView(arrb,offs|0);return fns.map(f=>f.u(v2))};const pack_into=(arrb,offs,...values)=>{if(values.length<fns.length){throw errval}if(arrb.byteLength<offs+size){throw errbuf}const v2=new DataView(arrb,offs);new Uint8Array(arrb,offs,size).fill(0);fns.forEach((f,i3)=>f.p(v2,values[i3]))};const pack=(...values)=>{let b=new ArrayBuffer(size);pack_into(b,0,...values);return b};const unpack=arrb=>unpack_from(arrb,0);function*iter_unpack(arrb){for(let offs=0;offs+size<=arrb.byteLength;offs+=size){yield unpack_from(arrb,offs)}}return Object.freeze({unpack,pack,unpack_from,pack_into,iter_unpack,format,size})}};var ByteParser=_ByteParser;__publicField2(ByteParser,"codes",{"\\\\n":10,"\\\\r":13,"\\\\t":9,"\\\\s":32,"\\\\b":8,"\\\\f":12,"\\\\":92});var rms={sps:250,nSec:1,watch:["0","1","2","3"],data:{},rms:{},__operator:function(data){this.watch.forEach(key=>{if(data[key]){if(!this.data[key]){if(Array.isArray(data[key])){this.data[key]=new Array(Math.floor(this.sps*this.nSec)).fill(data[key][0])}else this.data[key]=new Array(Math.floor(this.sps*this.nSec)).fill(data[key])}ByteParser.circularBuffer(this.data[key],data[key])}});if(data.timestamp){if(Array.isArray(data.timestamp)){this.rms.timestamp=data.timestamp[data.timestamp.length-1]}else this.rms.timestamp=data.timestamp}else this.rms.timestamp=Date.now();return new Promise(async res=>{await Promise.all(this.watch.map(async key=>{if(this.data[key])this.rms[key]=Math.sqrt(Math.abs(this.data[key].reduce((p2,v2,i3)=>p2+v2*v2)/this.data[key].length));else delete this.rms[key]}));res(this.rms)})}};var circularBuffer2d={bufferSize:250,watch:["0","1","2","3"],data:{},blocking:false,__onconnected:function(node){for(const key in node.watch){node.data[key]=new Array(node.bufferSize).fill(0)}},__operator:function(data){let buffer2d=[];this.watch.forEach(key=>{if(data[key]){ByteParser.circularBuffer(this.data[key],data[key]);buffer2d.push(this.data[key])}});return buffer2d}};var algorithms={beat_detect,accel_gyro,heartrate:beat_detect,breath:Object.assign({},beat_detect),blink_detect,rms,circularBuffer2d};algorithms["breath"].maxFreq=.2;var _ArrayManip2=class{constructor(){this.recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"){if(typeof target[key]==="object")this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target}}static autoscale(array,lineIdx=0,nLines=1,centerZero=false,ymin,ymax,clamp){if(array?.length===0)return array;let max=ymax?ymax:Math.max(...array);let min=ymin?ymin:Math.min(...array);let _lines=1/nLines;let scalar=1;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));if(absmax!==0)scalar=_lines/absmax;return array.map(y4=>{if(clamp){if(y4<min)y4=min;if(y4>max)y4=max}return y4*scalar+(_lines*(lineIdx+1)*2-1-_lines)})}else{if(max===min){if(max!==0){scalar=_lines/max}else if(min!==0){scalar=_lines/Math.abs(min)}}else scalar=_lines/(max-min);return array.map(y4=>{if(clamp){if(y4<min)y4=min;if(y4>max)y4=max}return 2*((y4-min)*scalar-1/(2*nLines))+(_lines*(lineIdx+1)*2-1-_lines)})}}static genTimestamps(ct,sps11){let now=Date.now();let toInterp=[now-ct*1e3/sps11,now];return _ArrayManip2.upsample(toInterp,ct)}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i3=incr;i3<array.length;i3+=incr){let rounded=Math.round(i3);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static upsample(array,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array(fitCount);var springFactor=(array.length-1)/(fitCount-1);newData[0]=array[0];for(var i3=1;i3<fitCount-1;i3++){var tmp=i3*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i3]=linearInterpolate(array[before],array[after],atPoint)}newData[fitCount-1]=array[array.length-1];return newData}static interpolate(array,fitCount,scalar=1){if(array.length>fitCount){return _ArrayManip2.downsample(array,fitCount,scalar)}else if(array.length<fitCount){return _ArrayManip2.upsample(array,fitCount,scalar)}return array}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x3=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x3;b=0}else if(60<=h&&h<120){r=x3;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x3}else if(180<=h&&h<240){r=0;g=x3;b=c}else if(240<=h&&h<300){r=x3;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x3}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static circularBuffer(arr,newEntries){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,newEntries.slice(len-newEntries.length))}else{arr.splice(0,arr.length,...newEntries)}return arr}static reformatData(data,key){if(Array.isArray(data)){if(Array.isArray(data[0])){let d2={};data.forEach((arr,i3)=>{d2[i3]=arr});data=d2;if(isNaN(data[0][0]))return void 0}else if(key){data={[key]:data};if(isNaN(data[key][0]))return void 0}else{data={0:data};if(isNaN(data[0][0]))return void 0}}else if(typeof data==="object"){for(const key2 in data){if(typeof data[key2]==="number")data[key2]=[data[key2]];else if(data[key2]?.values){if(typeof data[key2].values==="number")data[key2].values=[data[key2].values]}if(isNaN(data[key2][0]))return void 0}}else if(typeof data==="string"){let split;if(data.includes("\\r\\n")){let lines=data.split("\\r\\n");data={};lines.forEach((l,j)=>{if(l.includes("	")){split=l.split("	")}else if(l.includes(",")){split=l.split(",")}else if(l.includes("|")){split=l.split("|")}if(Array.isArray(split)){split.forEach((val,i3)=>{if(val.includes(":")){let[key2,v2]=val.split(":");let fl=parseFloat(v2);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i3]=[fl];else return void 0}})}})}else if(data.includes("	")){split=data.split("	")}else if(data.includes(",")){split=data.split(",")}else if(data.includes("|")){split=data.split("|")}data={};if(Array.isArray(split)){split.forEach((val,i3)=>{if(val.includes(":")){let[key2,v2]=val.split(":");let fl=parseFloat(v2);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i3]=[fl];else return void 0}})}}else if(typeof data==="number"){if(key)data={[key]:[data]};else data={0:[data]}}return data}static padTime(data,lastValue,time,targetFit){let slopeIncr=(data[0]-lastValue)/time/targetFit;let padded=[...new Array(targetFit-data.length).map((_,i3)=>lastValue+slopeIncr*(i3+1)),...data];return padded}static interpolateForTime(data,time,targetSPS){return _ArrayManip2.interpolate(data,Math.ceil(targetSPS*time))}isTypedArray(x3){return ArrayBuffer.isView(x3)&&Object.prototype.toString.call(x3)!=="[object DataView]"}spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var ArrayManip2=_ArrayManip2;ArrayManip2.bufferValues=(objects,property,keys3,buffer)=>{if(!Array.isArray(keys3)&&typeof keys3==="object")keys3=Object.keys(keys3);if(!buffer){let object_keys=Object.keys(objects);if(keys3)buffer=new Float32Array(object_keys.length*keys3.length);else{if(typeof objects[object_keys[0]][property]==="object"){keys3=Object.keys(objects[object_keys[0]][property]);buffer=new Float32Array(object_keys.length*keys3.length)}else buffer=new Float32Array(object_keys.length)}}let i3=0;for(const key in objects){if(objects[key][property]){if(keys3){for(let j=0;j<keys3.length;j++){buffer[i3]=objects[key][property][keys3[j]];i3++}}else{buffer[i3]=objects[key][property];i3++}}}return buffer};var rechk2=/^([<>])?(([1-9]\\d*)?([xcbB?hHiIfdsp]))*$/;var refmt2=/([1-9]\\d*)?([xcbB?hHiIfdsp])/g;var str2=(v2,o,c)=>String.fromCharCode(...new Uint8Array(v2.buffer,v2.byteOffset+o,c));var rts2=(v2,o,c,s)=>new Uint8Array(v2.buffer,v2.byteOffset+o,c).set(s.split("").map(str4=>str4.charCodeAt(0)));var pst2=(v2,o,c)=>str2(v2,o+1,Math.min(v2.getUint8(o),c-1));var tsp2=(v2,o,c,s)=>{v2.setUint8(o,s.length);rts2(v2,o+1,c-1,s)};var lut2=le=>({x:c=>[1,c,0],c:c=>[c,1,o=>({u:v2=>str2(v2,o,1),p:(v2,c2)=>rts2(v2,o,1,c2)})],"?":c=>[c,1,o=>({u:v2=>Boolean(v2.getUint8(o)),p:(v2,B3)=>v2.setUint8(o,B3)})],b:c=>[c,1,o=>({u:v2=>v2.getInt8(o),p:(v2,b)=>v2.setInt8(o,b)})],B:c=>[c,1,o=>({u:v2=>v2.getUint8(o),p:(v2,B3)=>v2.setUint8(o,B3)})],h:c=>[c,2,o=>({u:v2=>v2.getInt16(o,le),p:(v2,h)=>v2.setInt16(o,h,le)})],H:c=>[c,2,o=>({u:v2=>v2.getUint16(o,le),p:(v2,H3)=>v2.setUint16(o,H3,le)})],i:c=>[c,4,o=>({u:v2=>v2.getInt32(o,le),p:(v2,i3)=>v2.setInt32(o,i3,le)})],I:c=>[c,4,o=>({u:v2=>v2.getUint32(o,le),p:(v2,I)=>v2.setUint32(o,I,le)})],f:c=>[c,4,o=>({u:v2=>v2.getFloat32(o,le),p:(v2,f)=>v2.setFloat32(o,f,le)})],d:c=>[c,8,o=>({u:v2=>v2.getFloat64(o,le),p:(v2,d2)=>v2.setFloat64(o,d2,le)})],s:c=>[1,c,o=>({u:v2=>str2(v2,o,c),p:(v2,s)=>rts2(v2,o,c,s.slice(0,c))})],p:c=>[1,c,o=>({u:v2=>pst2(v2,o,c),p:(v2,s)=>tsp2(v2,o,c,s.slice(0,c-1))})]});var errbuf2=new RangeError("Structure larger than remaining buffer");var errval2=new RangeError("Not enough values for structure");var _ByteParser2=class extends ArrayManip2{static toDataView(value){if(!(value instanceof DataView)){if(typeof value==="string"&&parseInt(value))value=parseInt(value);if(typeof value==="string"){let enc=new TextEncoder;let hascodes={};for(const code in _ByteParser2.codes){while(value.indexOf(code)>-1){let idx=value.indexOf(code);value=value.replace(code,"");hascodes[idx]=code}}let encoded=Array.from(enc.encode(value));for(const key in hascodes){encoded.splice(parseInt(key),0,_ByteParser2.codes[hascodes[key]])}value=new DataView(new Uint8Array(encoded).buffer)}else if(typeof value==="number"){let tmp=value;if(value<256){value=new DataView(new ArrayBuffer(1));value.setUint8(0,tmp)}else if(value<65536){value=new DataView(new ArrayBuffer(2));value.setInt16(0,tmp)}else{value=new DataView(new ArrayBuffer(4));value.setUint32(0,tmp)}}else if(value instanceof ArrayBuffer||typeof SharedArrayBuffer!=="undefined"&&value instanceof SharedArrayBuffer){value=new DataView(value)}else if(Array.isArray(value)){value=new DataView(Uint8Array.from(value).buffer)}else if(typeof value==="object"){value=new TextEncoder().encode(JSON.stringify(value))}}return value}static searchBuffer(buffer,searchString,limit){var needle=searchString;var haystack=buffer;var search=_ByteParser2.boyerMoore(needle);var skip=search.byteLength;var indices=[];for(var i3=search(haystack);i3!==-1;i3=search(haystack,i3+skip)){indices.push(i3);if(limit){if(indices.length>=limit)break}}return indices}static bytesToInt16(x0,x1){let int16=(255&x0)<<8|255&x1;if((int16&32768)>0){int16|=4294901760}else{int16&=65535}return int16}static bytesToUInt16(x0,x1){return x0*256+x1}static Uint16ToBytes(y4){return[y4&255,y4>>8&255]}static bytesToInt24(x0,x1,x22){let int24=(255&x0)<<16|(255&x1)<<8|255&x22;if((int24&8388608)>0){int24|=4278190080}else{int24&=16777215}return int24}static bytesToUInt24(x0,x1,x22){return x0*65536+x1*256+x22}static Uint24ToBytes(y4){return[y4&255,y4>>8&255,y4>>16&255]}static bytesToInt32(x0,x1,x22,x3){let int32=(255&x0)<<24|(255&x1)<<16|(255&x22)<<8|255&x3;if((int32&2147483648)>0){int32|=0}else{int32&=4294967295}return int32}static bytesToUInt32(x0,x1,x22,x3){return x0*16777216+x1*65536+x22*256+x3}static Uint32ToBytes(y4){return[y4&255,y4>>8&255,y4>>16&255,y4>>24&255]}static get2sCompliment(val,nbits5){if(val>4294967296)return null;return val<<32-nbits5>>32-nbits5}static getSignedInt(...args){let pos=0;function getInt(size){var value=0;var first=true;while(size--){if(first){let byte=args[pos++];value+=byte&127;if(byte&128){value-=128}first=false}else{value*=256;value+=args[pos++]}}return value}return getInt(args.length)}static asUint8Array(input){if(input instanceof Uint8Array){return input}else if(typeof input==="string"){var arr=new Uint8Array(input.length);for(var i3=0;i3<input.length;i3++){var c=input.charCodeAt(i3);if(c>127){throw new TypeError("Only ASCII patterns are supported")}arr[i3]=c}return arr}else{return new Uint8Array(input)}}static boyerMoore(patternBuffer){var pattern=_ByteParser2.asUint8Array(patternBuffer);var M2=pattern.length;if(M2===0){throw new TypeError("patternBuffer must be at least 1 byte long")}var R2=256;var rightmost_positions=new Int32Array(R2);for(var c=0;c<R2;c++){rightmost_positions[c]=-1}for(var j=0;j<M2;j++){rightmost_positions[pattern[j]]=j}var boyerMooreSearch=(txtBuffer,start,end)=>{var txt=_ByteParser2.asUint8Array(txtBuffer);if(start===void 0)start=0;if(end===void 0)end=txt.length;var pat=pattern;var right=rightmost_positions;var lastIndex=end-pat.length;var lastPatIndex=pat.length-1;var skip;for(var i3=start;i3<=lastIndex;i3+=skip){skip=0;for(var j2=lastPatIndex;j2>=0;j2--){var c2=txt[i3+j2];if(pat[j2]!==c2){skip=Math.max(1,j2-right[c2]);break}}if(skip===0){return i3}}return-1};boyerMooreSearch.byteLength=pattern.byteLength;return boyerMooreSearch}static struct(format){let fns=[],size=0,m=rechk2.exec(format);if(!m){throw new RangeError("Invalid format string")}const t3=lut2("<"===m[1]),lu=(n,c)=>t3[c](n?parseInt(n,10):1);while(m=refmt2.exec(format)){((r,s,f)=>{for(let i3=0;i3<r;++i3,size+=s){if(f){fns.push(f(size))}}})(...lu(...m.slice(1)))}const unpack_from=(arrb,offs)=>{if(arrb.byteLength<(offs|0)+size){throw errbuf2}let v2=new DataView(arrb,offs|0);return fns.map(f=>f.u(v2))};const pack_into=(arrb,offs,...values)=>{if(values.length<fns.length){throw errval2}if(arrb.byteLength<offs+size){throw errbuf2}const v2=new DataView(arrb,offs);new Uint8Array(arrb,offs,size).fill(0);fns.forEach((f,i3)=>f.p(v2,values[i3]))};const pack=(...values)=>{let b=new ArrayBuffer(size);pack_into(b,0,...values);return b};const unpack=arrb=>unpack_from(arrb,0);function*iter_unpack(arrb){for(let offs=0;offs+size<=arrb.byteLength;offs+=size){yield unpack_from(arrb,offs)}}return Object.freeze({unpack,pack,unpack_from,pack_into,iter_unpack,format,size})}};var ByteParser2=_ByteParser2;ByteParser2.codes={"\\\\n":10,"\\\\r":13,"\\\\t":9,"\\\\s":32,"\\\\b":8,"\\\\f":12,"\\\\":92};(function(s){var w,f={},l=console,m=Math,z3="postMessage",x3="HackTimer.js by turuslan: ",v2="Initialisation failed",p2=0,r="hasOwnProperty",y4=[].slice,b=Worker;function d2(){do{p2=2147483647>p2?p2+1:0}while(f[r](p2));return p2}if(!/MSIE 10/i.test(navigator.userAgent)){try{s=URL.createObjectURL(new Blob(["var f={},p=postMessage,r=\'hasOwnProperty\';onmessage=function(e){var d=e.data,i=d.i,t=d[r](\'t\')?d.t:0;switch(d.n){case\'a\':f[i]=setInterval(function(){p(i)},t);break;case\'b\':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case\'c\':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case\'d\':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch(e){}}if(typeof b!=="undefined"){try{w=new b(s);setInterval=function(c,t3){var i3=d2();f[i3]={c,p:y4.call(arguments,2)};w[z3]({n:"a",i:i3,t:t3});return i3};clearInterval=function(i3){if(f[r](i3))delete f[i3],w[z3]({n:"b",i:i3})};setTimeout=function(c,t3){var i3=d2();f[i3]={c,p:y4.call(arguments,2),t:true};w[z3]({n:"c",i:i3,t:t3});return i3};clearTimeout=function(i3){if(f[r](i3))delete f[i3],w[z3]({n:"d",i:i3})};w.onmessage=function(e){var i3=e.data,c,n;if(f[r](i3)){n=f[i3];c=n.c;if(n[r]("t"))delete f[i3]}if(typeof c=="string")try{c=new Function(c)}catch(k){l.log(x3+"Error parsing callback code string: ",k)}if(typeof c=="function")c.apply(globalThis,n.p)};w.onerror=function(e){l.log(e)}}catch(e){l.log(x3+v2);l.error(e)}}else l.log(x3+v2+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js");var WebSerial=class extends ByteParser2{constructor(){super(...arguments);this.streams={};this.createStream=options=>{let stream={_id:options._id?options._id:`stream${Math.floor(Math.random()*1e15)}`,info:options.port.getInfo(),running:false,...options};if(options.port?.readable){if(options.transforms){stream.reader=WebSerial.setStreamTransforms(options.port.readable,options.transforms).getReader()}else{stream.reader=options.port.readable.getReader()}}this.streams[stream._id]=stream;return stream}}getPorts(){return navigator.serial.getPorts()}requestPort(usbVendorId,usbProductId){let options={};if(usbVendorId){options.usbVendorId=usbVendorId}if(usbProductId){options.usbProductId=usbProductId}if(options.usbVendorId)return navigator.serial.requestPort({filters:[options]});else return navigator.serial.requestPort()}openPort(port,options){if(options)options=Object.assign({},options);if(options?.ondisconnect){port.ondisconnect=options.ondisconnect;delete options.ondisconnect}return port.open(options).then(()=>{if(options?.onconnect)options.onconnect(port)})}async readWithTimeout(port,timeout){const reader=port.readable.getReader();const timer=setTimeout(()=>{reader.releaseLock()},timeout);const result=await reader.read();clearTimeout(timer);reader.releaseLock();return result}async writePort(port,message){const writer=port.writable.getWriter();await writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}getSignals(port){return port.getSignals()}setSignals(port,signals){return port.setSignals(signals)}readStream(stream){if(stream.reader&&!stream.running){let reader=stream.reader;if(stream.buffering){if(typeof stream.buffering!=="object")stream.buffering={};if(!stream.buffering.buffer){stream.buffering.buffer=[]}if(!stream.buffering.searchBytes)stream.buffering.searchBytes=new Uint8Array([13,10])}let readLoop=()=>{if(stream.port.readable&&stream.running){reader.read().then(result=>{if(result.done)reader.releaseLock();else{if(stream.buffering){stream.buffering.buffer.push(...result.value);const needle=stream.buffering.searchBytes;const haystack=stream.buffering.buffer;const search=WebSerial.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=stream.buffering.lockIdx??0;for(var i3=search(haystack);i3!==-1;i3=search(haystack,i3+skip)){if(!stream.buffering.locked&&!("lockIdx"in stream.buffering))used=stream.buffering.lockIdx=i3;else{nextIndex=i3;if(nextIndex>=0){const len=nextIndex-used;if(!stream.buffering.locked){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(data);stream.buffering.locked=true}else if(len>0){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(new Uint8Array(data))}used=nextIndex}}}}else stream.ondata(result.value);setTimeout(()=>{readLoop()},stream.frequency)}}).catch(er=>{console.error(stream._id," Read error:",er);if(er.message.includes("overrun")||er.message.includes("framing")){delete stream.reader;this.reconnect(stream)}})}else if(!stream.running&&stream.port.readable){try{reader.releaseLock()}catch(er){console.error(er)}}};stream.running=true;readLoop();return stream}return void 0}writeStream(stream,message){if(typeof stream==="string")stream=this.streams[stream];if(stream.port.writable){let writer=stream.port.writable.getWriter();writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}return void 0}closeStream(stream,onclose){if(typeof stream==="string")stream=this.streams[stream];stream.running=false;return new Promise((res,rej)=>{if(stream.settings.beforedisconnect){stream.settings.beforedisconnect(this,stream.port)}setTimeout(async()=>{if(stream.port.readable&&stream.reader){try{stream.reader.releaseLock()}catch(er){console.error(er)}if(stream.transforms)try{await stream.reader.cancel()}catch(err){console.error(err)}}try{await stream.port.close().then(()=>{if(onclose)onclose(this.streams[stream._id])});delete this.streams[stream._id];res(true)}catch(er){rej(er)}},300)})}reconnect(stream,options){if(typeof stream==="string")stream=this.streams[stream];return new Promise((res,rej)=>{if(typeof stream!=="object"){rej(void 0);return}let info=stream.port.getInfo();this.closeStream(stream._id).then(closed=>{setTimeout(()=>{this.getPorts().then(ports=>{for(let i3=0;i3<ports.length;i3++){if(ports[i3].getInfo().usbVendorId===info.usbVendorId&&ports[i3].getInfo().usbProductId===info.usbProductId){if(!options)options=stream;else options._id=stream._id;delete options.port;this.openPort(ports[i3],options.settings).then(()=>{const stream2=this.createStream({...options,port:ports[i3]});this.readStream(stream2);res(stream2)}).catch(rej)}}}).catch(rej)},100)})})}static setStreamTransforms(stream,transforms){let transform=[];Object.keys(transforms).forEach(t3=>{let opt=transforms[t3];if(opt instanceof TransformStream){transform.push(opt)}else{if(!opt.start)opt.start=function start(){};if(!opt.flush)opt.flush=function flush(){};let transformer=new TransformStream({start:opt.start,transform:opt.transform,flush:opt.flush},opt.writableStrategy,opt.readableStrategy);transform.push(transformer)}});let str4=stream;transform.forEach(transform2=>{str4=str4.pipeThrough(transform2)});return str4}};var sps=250;var gain=32;var nbits=24;var vref=1.2;var half24bit=Math.pow(2,24)/2;function ads131m08codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i3=0;i3<9;i3++){let j=i3*25;output[0][i3]=ByteParser2.bytesToInt24(arr[j],arr[j+1],arr[j+2]);output[1][i3]=ByteParser2.bytesToInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i3]=ByteParser2.bytesToInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i3]=ByteParser2.bytesToInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i3]=ByteParser2.bytesToInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i3]=ByteParser2.bytesToInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i3]=ByteParser2.bytesToInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i3]=ByteParser2.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])}if(arr.length>225){output.leds=arr.slice(225)}return output}function ads131m08codec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i3=0;i3<9;i3++){let j=i3*25;output[0][i3]=ByteParser2.bytesToInt24(arr[j],arr[j+1],arr[j+2])+half24bit;output[1][i3]=ByteParser2.bytesToInt24(arr[j+3],arr[j+4],arr[j+5])+half24bit;output[2][i3]=ByteParser2.bytesToInt24(arr[j+6],arr[j+7],arr[j+8])+half24bit;output[3][i3]=ByteParser2.bytesToInt24(arr[j+9],arr[j+10],arr[j+11])+half24bit;output[4][i3]=ByteParser2.bytesToInt24(arr[j+12],arr[j+13],arr[j+14])+half24bit;output[5][i3]=ByteParser2.bytesToInt24(arr[j+15],arr[j+16],arr[j+17])+half24bit;output[6][i3]=ByteParser2.bytesToInt24(arr[j+18],arr[j+19],arr[j+20])+half24bit;output[7][i3]=ByteParser2.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])+half24bit}if(arr.length>225){output.leds=arr.slice(225)}return output}var decoder=new TextDecoder;function ads131m08_arduinocodec(data){const parsed=decoder.decode(data);let split;if(parsed.includes("|"))split=parsed.split("|");else if(split.includes(","))split=parsed.split(",");else split=parsed.split("	");return{"0":parseInt(split[0]),"1":parseInt(split[1]),"2":parseInt(split[2]),"3":parseInt(split[3]),"4":parseInt(split[4]),"5":parseInt(split[5]),"6":parseInt(split[6]),"7":parseInt(split[7]),timestamp:Date.now()}}var defaultChartSetting={nSec:10,sps,units:"mV"};var ads131m08ChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting)),"1":JSON.parse(JSON.stringify(defaultChartSetting)),"2":JSON.parse(JSON.stringify(defaultChartSetting)),"3":JSON.parse(JSON.stringify(defaultChartSetting)),"4":JSON.parse(JSON.stringify(defaultChartSetting)),"5":JSON.parse(JSON.stringify(defaultChartSetting)),"6":JSON.parse(JSON.stringify(defaultChartSetting)),"7":JSON.parse(JSON.stringify(defaultChartSetting))}};var defaultsetting={sps,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))};var halfOffset=.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))*(Math.pow(2,nbits)-1)*.5;var ads131m08FilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting)),"1":JSON.parse(JSON.stringify(defaultsetting)),"2":JSON.parse(JSON.stringify(defaultsetting)),"3":JSON.parse(JSON.stringify(defaultsetting)),"4":JSON.parse(JSON.stringify(defaultsetting)),"5":JSON.parse(JSON.stringify(defaultsetting)),"6":JSON.parse(JSON.stringify(defaultsetting)),"7":JSON.parse(JSON.stringify(defaultsetting))};var accScale=.002/Math.pow(2,4);var getAcc=(arr,output,channels=8)=>{const accIdx=channels*3+1;const sum=(a,b)=>a+b;const accSum=arr.slice(accIdx).reduce(sum,0);if(accSum!==0){output.ax=accScale*ByteParser2.bytesToInt16(arr[accIdx],arr[accIdx+1]);output.ay=accScale*ByteParser2.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output.az=accScale*ByteParser2.bytesToInt16(arr[accIdx+4],arr[accIdx+5])}};function cytoncodec(data){let arr;if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i3=0;i3<8;i3++){let idx=1+3*i3;output[i3]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);output.timestamp=Date.now();return output}function daisycytoncodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i3=0;i3<8;i3++){let idx=1+3*i3;if(arr[0]%2===0)output[i3+7]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2]);else output[i3]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);return output}var sps2=250;var cytonSerialSettings={deviceType:"USB",deviceName:"cyton",baudRate:115200,codec:cytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var daisycytonSerialSettings={deviceType:"USB",deviceName:"cyton_daisy",baudRate:115200,codec:daisycytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var defaultChartSetting2={nSec:10,sps:sps2,units:"mV"};var defaultChartSetting22={nSec:10,sps:sps2};var cytonChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting2)),"1":JSON.parse(JSON.stringify(defaultChartSetting2)),"2":JSON.parse(JSON.stringify(defaultChartSetting2)),"3":JSON.parse(JSON.stringify(defaultChartSetting2)),"4":JSON.parse(JSON.stringify(defaultChartSetting2)),"5":JSON.parse(JSON.stringify(defaultChartSetting2)),"6":JSON.parse(JSON.stringify(defaultChartSetting2)),"7":JSON.parse(JSON.stringify(defaultChartSetting2)),"ax":JSON.parse(JSON.stringify(defaultChartSetting22)),"ay":JSON.parse(JSON.stringify(defaultChartSetting22)),"az":JSON.parse(JSON.stringify(defaultChartSetting22))},generateNewLines:true};var defaultsetting2={sps:sps2,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))};var cytonFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting2)),"1":JSON.parse(JSON.stringify(defaultsetting2)),"2":JSON.parse(JSON.stringify(defaultsetting2)),"3":JSON.parse(JSON.stringify(defaultsetting2)),"4":JSON.parse(JSON.stringify(defaultsetting2)),"5":JSON.parse(JSON.stringify(defaultsetting2)),"6":JSON.parse(JSON.stringify(defaultsetting2)),"7":JSON.parse(JSON.stringify(defaultsetting2)),"8":JSON.parse(JSON.stringify(defaultsetting2)),"9":JSON.parse(JSON.stringify(defaultsetting2)),"10":JSON.parse(JSON.stringify(defaultsetting2)),"11":JSON.parse(JSON.stringify(defaultsetting2)),"12":JSON.parse(JSON.stringify(defaultsetting2)),"13":JSON.parse(JSON.stringify(defaultsetting2)),"14":JSON.parse(JSON.stringify(defaultsetting2)),"15":JSON.parse(JSON.stringify(defaultsetting2))};function freeeeg128codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i3=0;i3<128;i3++){let idx=i3*3+1;output[i3]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=385;output["ax"]=ByteParser2.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser2.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser2.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser2.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser2.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser2.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps3=250;var freeeeg128SerialSettings={deviceType:"USB",deviceName:"freeeeg128",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg128codec,sps:sps3,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg128ChartSettings={lines:{"ax":{nSec:10,sps:sps3},"ay":{nSec:10,sps:sps3},"az":{nSec:10,sps:sps3},"gx":{nSec:10,sps:sps3},"gy":{nSec:10,sps:sps3},"gz":{nSec:10,sps:sps3}}};var freeeeg128FilterSettings={};for(let i3=0;i3<128;i3++){freeeeg128ChartSettings.lines[i3]={sps:sps3,nSec:10,units:"mV"};freeeeg128FilterSettings[i3]={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))}}function freeeeg32codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i3=0;i3<32;i3++){let idx=i3*3+1;output[i3]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=97;output["ax"]=ByteParser2.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser2.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser2.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser2.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser2.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser2.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps4=512;var freeeeg32SerialSettings={deviceType:"USB",deviceName:"freeeeg32",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg32_optical_SerialSettings={deviceType:"USB",deviceName:"freeeeg32_optical",baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting3={nSec:10,sps:sps4};var freeeeg32ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting3)),"ay":JSON.parse(JSON.stringify(defaultChartSetting3)),"az":JSON.parse(JSON.stringify(defaultChartSetting3)),"gx":JSON.parse(JSON.stringify(defaultChartSetting3)),"gy":JSON.parse(JSON.stringify(defaultChartSetting3)),"gz":JSON.parse(JSON.stringify(defaultChartSetting3))}};var freeeeg32FilterSettings={};for(let i3=0;i3<32;i3++){freeeeg32ChartSettings.lines[i3]={sps:sps4,nSec:10,units:"mV"};freeeeg32FilterSettings[i3]={sps:sps4,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))}}function freeeeg16codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i3=0;i3<16;i3++){let idx=i3*3+1;output[i3]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser2.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser2.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser2.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser2.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser2.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser2.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var BLEBuffer=[];var locked;var lockIdx;function freeeeg16BLEcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;BLEBuffer.push(...data);const needle=new Uint8Array([192,160]);const haystack=BLEBuffer;const search=ByteParser2.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=lockIdx??0;let pass=false;for(var i3=search(haystack);i3!==-1;i3=search(haystack,i3+skip)){if(!locked&&!(typeof lockIdx==="number"))used=lockIdx=i3;else{nextIndex=i3;if(nextIndex>=0){const len=nextIndex-used;if(!lockIdx){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true;locked=true}else if(len>0){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true}used=nextIndex}}}if(pass){let output={};for(let i4=0;i4<16;i4++){let idx=i4*3+1;output[i4]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser2.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser2.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser2.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser2.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser2.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser2.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}else return void 0}var sps5=250;var freeeeg16BLESettings={deviceType:"BLE",deviceName:"freeeeg16",services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:void 0},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:freeeeg16BLEcodec,sps:sps5}}}};var freeeeg16SerialSettings={deviceType:"USB",deviceName:"freeeeg16",baudRate:115200,bufferSize:2e3,frequency:3.5,codec:freeeeg16codec,sps:sps5,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting4={nSec:10,sps:sps5};var freeeeg16ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting4)),"ay":JSON.parse(JSON.stringify(defaultChartSetting4)),"az":JSON.parse(JSON.stringify(defaultChartSetting4)),"gx":JSON.parse(JSON.stringify(defaultChartSetting4)),"gy":JSON.parse(JSON.stringify(defaultChartSetting4)),"gz":JSON.parse(JSON.stringify(defaultChartSetting4))}};var freeeeg16FilterSettings={};var gain2=32;var nbits2=24;var vref2=1.2;for(let i3=0;i3<16;i3++){freeeeg16ChartSettings.lines[i3]={sps:sps5,nSec:10,units:"mV"};freeeeg16FilterSettings[i3]={sps:sps5,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref2/(gain2*(Math.pow(2,nbits2)-1))}}var textdecoder=new TextDecoder;function hegduinocodec(value){let output={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0};let txt=textdecoder.decode(value);let line=txt.split("|");if(line.length===3){output.timestamp=Date.now();output.red=parseInt(line[0]);output.infrared=parseInt(line[1]);output.heg=parseFloat(line[2])}else if(line.length>=2){output.timestamp=Date.now();output.red=parseInt(line[1]);output.infrared=parseInt(line[2]);output.heg=parseFloat(line[3]);if(line[4])output.ambient=parseFloat(line[4]);if(line[5])output.temperature=parseFloat(line[5]);return output}else return txt}var sps6=40;var hegduinoSerialSettings={deviceType:"USB",deviceName:"hegduino",baudRate:115200,write:"t\\n",codec:hegduinocodec,sps:sps6};var hegduinoV1SerialSettings=Object.assign({},hegduinoSerialSettings);hegduinoV1SerialSettings.sps=19;var hegduinoBLESettings={deviceType:"BLE",deviceName:"hegduino",sps:sps6,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:hegduinocodec,sps:sps6}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};var hegduinoV1BLESettings=Object.assign({},hegduinoSerialSettings);hegduinoV1BLESettings.sps=19;function max3010xcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let pktCt=32;const output={"red":new Array(pktCt),"ir":new Array(pktCt),"max_dietemp":ByteParser2.get2sCompliment(arr[193],8)+.0625*arr[194],"timestamp":Date.now()};let i3=0;while(i3<pktCt){let idx=i3*6;if(i3%2===0){output["ir"][i3]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["ir"][i3+1]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}else{output["red"][i3-1]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["red"][i3]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}i3++}return output}function mpu6050codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={"ax":new Array(20),"ay":new Array(20),"az":new Array(20),"gx":new Array(20),"gy":new Array(20),"gz":new Array(20),"mpu_dietemp":(ByteParser2.bytesToInt16(arr[241],arr[242])+521)/340+35,timestamp:Date.now()};for(let i3=0;i3<20;i3++){let idx=i3*12;output.ax[i3]=ByteParser2.bytesToInt16(arr[idx+1],arr[idx+2]);output.ay[i3]=ByteParser2.bytesToInt16(arr[idx+3],arr[idx+4]);output.az[i3]=ByteParser2.bytesToInt16(arr[idx+5],arr[idx+6]);output.gx[i3]=ByteParser2.bytesToInt16(arr[idx+7],arr[idx+8]);output.gy[i3]=ByteParser2.bytesToInt16(arr[idx+9],arr[idx+10]);output.gz[i3]=ByteParser2.bytesToInt16(arr[idx+11],arr[idx+12])}return output}function cognixionONE_EEG_codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let i3=0;i3<7;i3++){let j=i3*26+1;if(!arr[j+23])break;output[0][i3]=ByteParser2.bytesToUInt24(arr[j],arr[j+1],arr[j+2]);output[1][i3]=ByteParser2.bytesToUInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i3]=ByteParser2.bytesToUInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i3]=ByteParser2.bytesToUInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i3]=ByteParser2.bytesToUInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i3]=ByteParser2.bytesToUInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i3]=ByteParser2.bytesToUInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i3]=ByteParser2.bytesToUInt24(arr[j+21],arr[j+22],arr[j+23])}return output}var sps7=250;var cognixionONEBLESettings={deviceType:"BLE",deviceName:"cognixionONE",services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:true,notifyCallback:void 0,codec:cognixionONE_EEG_codec,sps:sps7}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:true}}},sps:sps7};var cognixionONESerialSettings=Object.assign({},cytonSerialSettings);cognixionONESerialSettings.sps=sps7;cognixionONESerialSettings.deviceName="cognixionONE";var defaultChartSetting5={nSec:10,sps:sps7,units:"mV"};var cognixionONEChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting5)),"1":JSON.parse(JSON.stringify(defaultChartSetting5)),"2":JSON.parse(JSON.stringify(defaultChartSetting5)),"3":JSON.parse(JSON.stringify(defaultChartSetting5)),"4":JSON.parse(JSON.stringify(defaultChartSetting5)),"5":JSON.parse(JSON.stringify(defaultChartSetting5)),"6":JSON.parse(JSON.stringify(defaultChartSetting5)),"7":JSON.parse(JSON.stringify(defaultChartSetting5))}};var PeanutCodes={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function peanutcodec(data){let result={};let i3=0;while(i3<data.length){if(PeanutCodes[data[i3]]&&i3+1+PeanutCodes[data[i3]].byteLength<=data.length){let slice=data.slice(i3+1,i3+1+PeanutCodes[data[i3]].byteLength).buffer;let unpacked=ByteParser2.struct(PeanutCodes[data[i3]].format).unpack(slice);let code=PeanutCodes[data[i3]].type;if(code==="unfilteredHEG"||code==="heg")unpacked=unpacked[0]/256;else if(code==="POOR_SIGNAL"||code==="sampleNumber"||code==="debug0"||code==="debug1"||code==="debug2"||code==="debug3")unpacked=unpacked[0];if(!result[PeanutCodes[data[i3]].type]){if(Array.isArray(unpacked))result[PeanutCodes[data[i3]].type]=unpacked;else result[PeanutCodes[data[i3]].type]=[unpacked]}else{if(Array.isArray(unpacked))result[PeanutCodes[data[i3]].type].push(...unpacked);else result[PeanutCodes[data[i3]].type].push(unpacked)}i3+=PeanutCodes[data[i3]].byteLength+1}else i3++}result.timestamp=Date.now();return result}var peanutSerialSettings={deviceType:"USB",deviceName:"peanut",baudRate:38400,bufferSize:400,write:"protocol 3\\n",buffering:{searchBytes:new Uint8Array([170,170])},codec:peanutcodec,sps:10.101};var sealevel_hpa=1013.25;var bme280codec=data=>{let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={timestamp:Date.now(),temp:[],pressure:[],altitude:[]};let mode=0;if(arr[0].length===74)mode=1;if(!mode){for(let j=0;j<3;j++){let i3=j*16+2;let tint=ByteParser2.bytesToInt32(arr[3+i3],arr[2+i3],arr[1+i3],arr[0+i3]);let tfrac=ByteParser2.bytesToInt32(arr[7+i3],arr[6+i3],arr[5+i3],arr[4+i3]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser2.bytesToInt32(arr[11+i3],arr[10+i3],arr[9+i3],arr[8+i3]);let pfrac=ByteParser2.bytesToInt32(arr[15+i3],arr[14+i3],arr[13+i3],arr[12+i3]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}else{output.humidity=[];for(let j=0;j<3;j++){let i3=j*24+2;let tint=ByteParser2.bytesToInt32(arr[3+i3],arr[2+i3],arr[1+i3],arr[0+i3]);let tfrac=ByteParser2.bytesToInt32(arr[7+i3],arr[6+i3],arr[5+i3],arr[4+i3]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser2.bytesToInt32(arr[11+i3],arr[10+i3],arr[9+i3],arr[8+i3]);let pfrac=ByteParser2.bytesToInt32(arr[15+i3],arr[14+i3],arr[13+i3],arr[12+i3]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));let hint=ByteParser2.bytesToInt32(arr[19+i3],arr[18+i3],arr[17+i3],arr[16+i3]);let hfrac=ByteParser2.bytesToInt32(arr[23+i3],arr[22+i3],arr[21+i3],arr[20+i3]);output.humidity.push(hint+hfrac/Math.pow(10,Math.ceil(Math.log10(hfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}return output};function altitude(pressure,temperature){return 44330*(1-Math.pow(pressure/sealevel_hpa,.1903))}function nrf5x_usbcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i3)=>{output[i3+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec(arr.subarray(2))))}return output}function nrf5x_usbcodec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec_singleended(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i3)=>{output[i3+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec_singleended(arr.subarray(2))))}return output}var nrf5xSerialSettings={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec,sps:250};var nrf5xSerialSettings_singleended={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec_singleended,sps:250};var nrf5xBLESettings={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var nrf5xBLESettings_singleended={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var defaultChartSetting6={nSec:10,sps:250,units:"mV"};var nrf5x_usbChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting6)),"1":JSON.parse(JSON.stringify(defaultChartSetting6)),"2":JSON.parse(JSON.stringify(defaultChartSetting6)),"3":JSON.parse(JSON.stringify(defaultChartSetting6)),"4":JSON.parse(JSON.stringify(defaultChartSetting6)),"5":JSON.parse(JSON.stringify(defaultChartSetting6)),"6":JSON.parse(JSON.stringify(defaultChartSetting6)),"7":JSON.parse(JSON.stringify(defaultChartSetting6))},generateNewLines:true,cleanGeneration:false};var gain3=32;var nbits3=24;var vref3=1.2;var defaultsetting3={sps:250,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref3/(gain3*(Math.pow(2,nbits3)-1))};var nrf5x_usbFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting3)),"1":JSON.parse(JSON.stringify(defaultsetting3)),"2":JSON.parse(JSON.stringify(defaultsetting3)),"3":JSON.parse(JSON.stringify(defaultsetting3)),"4":JSON.parse(JSON.stringify(defaultsetting3)),"5":JSON.parse(JSON.stringify(defaultsetting3)),"6":JSON.parse(JSON.stringify(defaultsetting3)),"7":JSON.parse(JSON.stringify(defaultsetting3)),"8":JSON.parse(JSON.stringify(defaultsetting3)),"9":JSON.parse(JSON.stringify(defaultsetting3)),"10":JSON.parse(JSON.stringify(defaultsetting3)),"11":JSON.parse(JSON.stringify(defaultsetting3)),"12":JSON.parse(JSON.stringify(defaultsetting3)),"13":JSON.parse(JSON.stringify(defaultsetting3)),"14":JSON.parse(JSON.stringify(defaultsetting3)),"15":JSON.parse(JSON.stringify(defaultsetting3))};var textdecoder2=new TextDecoder;function statechangercodec(value){let output={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0};let txt=textdecoder2.decode(value);let line=txt.split("|");if(line.length>=5){output.timestamp=Date.now();output.left_red=parseInt(line[1]);output.left_infrared=parseInt(line[2]);output.left_heg=parseFloat(line[3]);output.center_red=parseInt(line[4]);output.center_infrared=parseInt(line[5]);output.center_heg=parseFloat(line[6]);output.right_red=parseInt(line[7]);output.right_infrared=parseInt(line[8]);output.right_heg=parseFloat(line[9]);return output}else return txt}var statechangerSerialSettings={deviceType:"USB",deviceName:"statechanger",baudRate:115200,codec:statechangercodec,sps:20};var statechangerBLESettings={deviceType:"BLE",deviceName:"statechanger",sps:20,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:statechangercodec}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};function blueberrycodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.red/(.5*(output.ir+output.ir2));return output}var sps8=40;var blueberryBLESettings={deviceType:"BLE",deviceName:"blueberry",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:true,notifyCallback:void 0,codec:blueberrycodec,sps:sps8}}},sps:sps8};function blueberryshortcodec(value){let output={sred:value.getInt32(2),sir:value.getInt32(6),sir2:value.getInt32(10),timestamp:Date.now()};output.sheg=output.sred/(.5*(output.sir+output.sir2));return output}function blueberrylongcodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.sred/(.5*(output.ir+output.ir2));return output}var sps9=40;var blueberry2BLESettings={deviceType:"BLE",deviceName:"blueberry2",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:true,notifyCallback:void 0,codec:blueberrylongcodec,sps:sps9},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:true,notifyCallback:void 0,codec:blueberryshortcodec,sps:sps9}}},sps:sps9};function hrcodec(data){return{hr:data.getInt8(1),timestamp:Date.now()}}var heartRateBLESettings={deviceType:"BLE",deviceName:"heartrate",services:{"heart_rate":{"heart_rate_measurement":{notify:true,notifyCallback:void 0,codec:hrcodec}}}};var simulatorSettings={sps:250,deviceType:"CUSTOM",deviceName:"simulator",simulate:{"0":{sps:250,freq:1,amplitude:1,offset:0},"1":{sps:250,freq:10,amplitude:1,offset:0},"2":{sps:250,freq:100,amplitude:.5,offset:.5},"3":{sps:250,freq:25,amplitude:1,offset:0}},connect:(settings={})=>{return new Promise(async(res,rej)=>{let _id=`simulated${Math.floor(Math.random()*1e15)}`;let info={_id,settings:Object.assign(Object.assign({},simulatorSettings),settings)};info.settings.looping=true;let loopTime=50;let lastTime=Date.now();let loop3=()=>{if(info.settings.looping){let newData={};let now=Date.now();let frame=now-lastTime;for(const key in info.settings.simulate){let newPoints=Math.floor(info.settings.simulate[key].sps*frame/1e3);newData[key]=new Array(newPoints).fill(0);newData[key]=newData[key].map((v2,i3)=>{return Math.sin(2*Math.PI*info.settings.simulate[key].freq*.001*(lastTime+frame*(i3+1)/newPoints))*info.settings.simulate[key].amplitude+info.settings.simulate[key].offset})}lastTime=now;newData.timestamp=lastTime;info.settings.ondata(newData);setTimeout(()=>{loop3()},loopTime)}};loop3();if(info.settings.onconnect)info.settings.onconnect(info);res(info)})},codec:reading=>{return reading},disconnect:info=>{console.log(info);info.settings.looping=false;info.settings.ondisconnect(info)},onconnect:info=>{console.log("simulator connected!",info)},ondisconnect:info=>{console.log("simulator disconnected!",info)},ondata:data=>{}};var BiquadChannelFilterer=class{constructor(options={sps:512,useSMA4:false,useNotch50:true,useNotch60:true,useLowpass:false,lowpassHz:100,useBandpass:false,bandpassLower:3,bandpassUpper:45,useDCBlock:true,DCBresonance:.995,trimOutliers:false,outlierTolerance:.2,useScaling:false,scalar:1}){this.idx=0;this.sps=options.sps;this.bandpassLower=options.bandpassLower?options.bandpassLower:3;this.bandpassUpper=options.bandpassUpper?options.bandpassUpper:45;this.useSMA4=options.useSMA4;this.last4=[];this.useNotch50=options.useNotch50;this.useNotch60=options.useNotch60;this.useLowpass=options.useLowpass;this.lowpassHz=options.lowpassHz?options.lowpassHz:100;this.useBandpass=options.useBandpass;this.useDCBlock=options.useDCBlock;this.DCBresonance=options.DCBresonance?options.DCBresonance:.995;this.useScaling=options.useScaling;this.scalar=options.scalar;this.trimOutliers=options.trimOutliers;this.outlierTolerance=options.outlierTolerance;let sps11=this.sps;this.notch50=[makeNotchFilter(50,sps11,2),makeNotchFilter(100,sps11,2)];this.notch60=[makeNotchFilter(60,sps11,2),makeNotchFilter(120,sps11,2)];this.lp1=[new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1)];this.dcb=new DCBlocker(options.DCBresonance?options.DCBresonance:.995)}reset(sps11=this.sps){this.notch50=[makeNotchFilter(50,sps11,2),makeNotchFilter(100,sps11,2)];this.notch60=[makeNotchFilter(60,sps11,2),makeNotchFilter(120,sps11,2)];this.lp1=[new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1)];this.dcb=new DCBlocker(this.DCBresonance)}setBandpass(bandpassLower=this.bandpassLower,bandpassUpper=this.bandpassUpper,sps11=this.sps){this.bandpassLower=bandpassLower;this.bandpassUpper=bandpassUpper;this.bp1=[makeBandpassFilter(bandpassLower,bandpassUpper,sps11),makeBandpassFilter(bandpassLower,bandpassUpper,sps11),makeBandpassFilter(bandpassLower,bandpassUpper,sps11),makeBandpassFilter(bandpassLower,bandpassUpper,sps11)]}apply(latestData=0){let out=latestData;if(this.useScaling===true){out*=this.scalar}if(this.filtered&&this.trimOutliers&&this.outlierTolerance){if(Math.abs(out-this.filtered)>this.outlierTolerance){out=this.filtered}}if(this.useDCBlock===true){out=this.dcb.applyFilter(out)}if(this.useSMA4===true){if(this.last4.length<4){this.last4.push(out)}else{out=this.last4.reduce((accumulator,currentValue)=>accumulator+currentValue)/this.last4.length;this.last4.shift();this.last4.push(out)}}if(this.useNotch50===true){this.notch50.forEach((f,i3)=>{out=f.applyFilter(out)})}if(this.useNotch60===true){this.notch60.forEach((f,i3)=>{out=f.applyFilter(out)})}if(this.useLowpass===true){this.lp1.forEach((f,i3)=>{out=f.applyFilter(out)})}if(this.useBandpass===true){this.bp1.forEach((f,i3)=>{out=f.applyFilter(out)})}this.filtered=out;this.idx++;return out}};var Biquad2=class{constructor(type,freq,sps11,Q=1/Math.sqrt(2),dbGain=0){this.a0=0;this.a1=0;this.a2=0;this.b0=0;this.b1=0;this.b2=0;this.x1=0;this.x2=0;this.y1=0;this.y2=0;let types=["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"];if(types.indexOf(type)<0){console.error("Valid types: \'lowpass\',\'highpass\',\'bandpass\',\'notch\',\'peak\',\'lowshelf\',\'highshelf\'");return}this.type=type;this.freq=freq;this.sps=sps11;this.Q=Q;this.dbGain=dbGain;let A4=Math.pow(10,dbGain/40);let omega=2*Math.PI*freq/sps11;let sn=Math.sin(omega);let cs=Math.cos(omega);let alpha=sn/(2*Q);let beta=Math.sqrt(A4+A4);this[type](A4,sn,cs,alpha,beta);this.b0/=this.a0;this.b1/=this.a0;this.b2/=this.a0;this.a1/=this.a0;this.a2/=this.a0}lowpass(A4,sn,cs,alpha,beta){this.b0=(1-cs)*.5;this.b1=1-cs;this.b2=(1-cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}highpass(A4,sn,cs,alpha,beta){this.b0=(1+cs)*.5;this.b1=-(1+cs);this.b2=(1+cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}bandpass(A4,sn,cs,alpha,beta){this.b0=alpha;this.b1=0;this.b2=-alpha;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}notch(A4,sn,cs,alpha,beta){this.b0=1;this.b1=-2*cs;this.b2=1;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}peak(A4,sn,cs,alpha,beta){this.b0=1+alpha*A4;this.b1=-2*cs;this.b2=1-alpha*A4;this.a0=1+alpha/A4;this.a1=-2*cs;this.a2=1-alpha/A4}lowshelf(A4,sn,cs,alpha,beta){this.b0=A4*(A4+1-(A4-1)*cs+beta*sn);this.b1=2*A4*(A4-1-(A4+1)*cs);this.b2=A4*(A4+1-(A4-1)*cs-beta*sn);this.a0=A4+1+(A4+1)*cs+beta*sn;this.a1=2*(A4-1+(A4+1)*cs);this.a2=A4+1+(A4-1)*cs-beta*sn}highshelf(A4,sn,cs,alpha,beta){this.b0=A4*(A4+1+(A4-1)*cs+beta*sn);this.b1=2*A4*(A4-1+(A4+1)*cs);this.b2=A4*(A4+1-(A4-1)*cs-beta*sn);this.a0=A4+1-(A4+1)*cs-beta*sn;this.a1=2*(A4-1-(A4+1)*cs);this.a2=A4+1-(A4-1)*cs-beta*sn}applyFilter(signal_step){let y4=this.b0*signal_step+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;this.x2=this.x1;this.x1=signal_step;this.y2=this.y1;this.y1=y4;return y4}zResult(freq){try{let phi=Math.pow(Math.sin(Math.PI*freq*2/(2*this.sps)),2);let result=(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*phi+16*this.b0*this.b2*phi*phi)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*phi+16*this.a2*phi*phi);return result}catch(err){return-200}}static calcCenterFrequency(freqStart,freqEnd){return(freqStart+freqEnd)/2}static calcBandwidth(freqStart,freqEnd){return freqEnd-this.calcCenterFrequency(freqStart,freqEnd)}static calcBandpassQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*Math.sqrt((frequency-bandwidth)*(frequency+bandwidth))/(2*bandwidth);return Q}static calcNotchQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*frequency*bandwidth/Math.sqrt((frequency-bandwidth)*(frequency+bandwidth));return Q}};var DCBlocker=class{constructor(r=.995){this.r=r;this.y1=this.y2=this.x1=this.x2=0}applyFilter(signal_step){this.x2=this.x1;this.x1=signal_step;let y4=this.x1-this.x2+this.r*this.y1;this.y2=this.y1;this.y1=y4;return y4}};var makeNotchFilter=(frequency,sps11,bandwidth)=>{return new Biquad2("notch",frequency,sps11,Biquad2.calcNotchQ(frequency,bandwidth),0)};var makeBandpassFilter=(freqStart,freqEnd,sps11,resonance=Math.pow(10,Math.floor(Math.log10(Biquad2.calcCenterFrequency(freqStart,freqEnd)))))=>{return new Biquad2("bandpass",Biquad2.calcCenterFrequency(freqStart,freqEnd),sps11,Biquad2.calcBandpassQ(Biquad2.calcCenterFrequency(freqStart,freqEnd),Biquad2.calcBandwidth(freqStart,freqEnd),resonance),0)};var defaultsetting1={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var ganglionFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting1)),"1":JSON.parse(JSON.stringify(defaultsetting1)),"2":JSON.parse(JSON.stringify(defaultsetting1)),"3":JSON.parse(JSON.stringify(defaultsetting1))};var defaultChartSetting7={nSec:10,sps:250,units:"mV"};var ganglionChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting7)),"1":JSON.parse(JSON.stringify(defaultChartSetting7)),"2":JSON.parse(JSON.stringify(defaultChartSetting7)),"3":JSON.parse(JSON.stringify(defaultChartSetting7)),"ax":{nSec:10,sps:250,units:"mg"},"ay":{nSec:10,sps:250,units:"mg"},"az":{nSec:10,sps:250,units:"mg"}},generateNewLines:true};var defaultsetting4={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var museFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting4)),"1":JSON.parse(JSON.stringify(defaultsetting4)),"2":JSON.parse(JSON.stringify(defaultsetting4)),"3":JSON.parse(JSON.stringify(defaultsetting4)),"4":JSON.parse(JSON.stringify(defaultsetting4))};var Devices={BLE:{"nrf5x":nrf5xBLESettings,"nrf5x_singleended":nrf5xBLESettings_singleended,"hegduino":hegduinoBLESettings,"hegduinoV1":hegduinoV1BLESettings,"cognixionONE":cognixionONEBLESettings,"statechanger":statechangerBLESettings,"blueberry":blueberryBLESettings,"blueberry2":blueberry2BLESettings,"heart_rate":heartRateBLESettings,"freeEEG16":freeeeg16BLESettings},USB:{"nrf5x":nrf5xSerialSettings,"nrf5x_singleended":nrf5xSerialSettings_singleended,"freeEEG16":freeeeg16SerialSettings,"freeEEG32":freeeeg32SerialSettings,"freeEEG32_optical":freeeeg32_optical_SerialSettings,"freeEEG128":freeeeg128SerialSettings,"hegduino":hegduinoSerialSettings,"hegduinoV1":hegduinoV1SerialSettings,"cyton":cytonSerialSettings,"cyton_daisy":daisycytonSerialSettings,"peanut":peanutSerialSettings,"statechanger":statechangerSerialSettings,"cognixionONE":cytonSerialSettings},BLE_CUSTOM:{},USB_CUSTOM:{},CUSTOM:{"simulator":simulatorSettings}};var textdecoder3=new TextDecoder;var decoders={"raw":data=>{if(data?.buffer)return Array.from(new Uint8Array(data));else return data},"utf8":data=>{return textdecoder3.decode(data)},"console-f12":data=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(data);return data},"debug":(data,debugmessage)=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(debugmessage,data);return data},"ads131m08":ads131m08codec,"arduino_ads131m08":ads131m08_arduinocodec,"max3010x":max3010xcodec,"mpu6050":mpu6050codec,"bme280":bme280codec,"freeeeg16":freeeeg16codec,"freeeeg32":freeeeg32codec,"freeeeg128":freeeeg128codec,"cyton":cytoncodec,"cognixionONE_BLE":cognixionONE_EEG_codec,"hegduino":hegduinocodec,"nrf5x":nrf5x_usbcodec,"peanut":peanutcodec,"statechanger":statechangercodec,"blueberry":blueberrycodec,"heart_rate":hrcodec};function parseFunctionFromText2(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs4(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs2}var stringifyFast2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p2 in value[prop]){if(Array.isArray(value[prop][p2])){if(value[prop][p2].length>20)obj[prop][p2]=value[prop][p2].slice(value[prop][p2].length-20);else obj[prop][p2]=value[prop][p2]}else{if(value[prop][p2]!=null){let con=value[prop][p2].constructor.name;if(con.includes("Set")){obj[prop][p2]=Array.from(value[prop][p2])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p2]="instanceof_"+con}else{obj[prop][p2]=value[prop][p2]}}else{obj[prop][p2]=value[prop][p2]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast4(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast2}function loadStreamWorkerGlobals(){globalThis.Devices=Devices;globalThis.WebSerial=WebSerial;globalThis.decoders=decoders;globalThis.decoder="raw";globalThis.ByteParser=ByteParser2;globalThis.filtering=false;globalThis.filters={};globalThis.BiquadChannelFilterer=BiquadChannelFilterer;globalThis.ArrayManip=ArrayManip2}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){loadStreamWorkerGlobals()}var streamWorkerRoutes={"transferDevice":function transferDevice(device,worker){let cpy=Object.assign({},device);for(const key in cpy){if(typeof cpy[key]==="function")cpy[key]=cpy[key].toString()}worker.send({route:"receiveDevice",args:cpy})},"receiveDevice":function receiveDevice(device){for(const key in device){if(typeof device[key]==="string"){let fn=parseFunctionFromText2(device[key]);if(typeof fn==="function"){device[key]=fn}}}if(!globalThis.Devices[device.deviceType])globalThis.Devices[device.deviceType]={};globalThis.Devices[device.deviceType][device.deviceName]=device},"receiveDecoder":function receiveDecoder(decoder3,decoderName){globalThis.decoders[decoderName]=(0,eval)("("+decoder3+")")},"receiveCodec":function receiveDeviceCodec(decoder3,deviceType,device,service,characteristic){let codec=parseFunctionFromText2(decoder3);if(codec){if(deviceType==="BLE"&&service&&characteristic){if(globalThis.Devices[deviceType][device]){if(globalThis.Devices[deviceType][device][service]){if(globalThis.Devices[deviceType][device][characteristic]){globalThis.Devices[deviceType][device][characteristic].codec=codec}else{globalThis.Devices[deviceType][device][characteristic]={codec}}}else{globalThis.Devices[deviceType][device]={[characteristic]:{codec}}}}}else if(globalThis.Devices[deviceType][device]?.codec){if(globalThis.Devices[deviceType][device])globalThis.Devices[deviceType][device].codec=codec;else{globalThis.Devices[deviceType][device]={codec}}}}},"decode":function decode(data){return globalThis.decoder(data)},"decodeAndParse":function decodeAndParse(data){let decoded=this.__node.graph.run("decode",data);if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v2=>filter.apply(v2))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v2=>filter.apply(v2))}}}}return parsed}}return decoded},"setActiveDecoder":function setActiveDecoder(deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device]?.codec;else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device][service][characteristic].codec;return true},"decodeDevice":function decodeDevice(data,deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)return globalThis.Devices[deviceType][device].codec(data);else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)return globalThis.Devices[deviceType][device][service][characteristic].codec(data)},"decodeAndParseDevice":function decodeAndParseDevice(data,deviceType,deviceName,service,characteristic){let decoded;if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][deviceName]?.services[service]?.[characteristic]?.codec)decoded=globalThis.Devices[deviceType][deviceName].services[service][characteristic].codec(data);else if(globalThis.Devices[deviceType][deviceName]?.codec)decoded=globalThis.Devices[deviceType][deviceName].codec(data);else decoded=data;if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v2=>filter.apply(v2))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v2=>filter.apply(v2))}else if(typeof parsed[prop]==="number"){parsed[prop]=filter.apply(parsed[prop])}}}}return parsed}}return decoded},"toggleAnim":function toggleAnim(){globalThis.runningAnim=!globalThis.runningAnim;return globalThis.runningAnim},"setFilters":function setFilters(filters,clearFilters=false){if(!globalThis.filters||clearFilters){globalThis.filters={};if(clearFilters)globalThis.filtering=false}if(filters){for(const key in filters){globalThis.filters[key]=new BiquadChannelFilterer(filters[key])}globalThis.filtering=true}return true},"getFilterSettings":function getFilterSettings(){if(globalThis.filters){let filters={};for(const key in globalThis.filters){filters[key]={sps:globalThis.filters[key].sps,useScaling:globalThis.filters[key].useScaling,scalar:globalThis.filters[key].scalar,useNotch50:globalThis.filters[key].useNotch50,useNotch60:globalThis.filters[key].useNotch60,useDCBlock:globalThis.filters[key].useDCBlock,useLowpass:globalThis.filters[key].useLowpass,lowpassHz:globalThis.filters[key].lowpassHz,useBandpass:globalThis.filters[key].useBandpass,bandpassLower:globalThis.filters[key].bandpassLower,bandpassUpper:globalThis.filters[key].bandpassUpper}}return filters}return void 0},"setupSerial":function setupSerial(){globalThis.Serial=new globalThis.WebSerial;globalThis.decoder="raw";console.log("worker: Setting up Serial",globalThis.Serial);return true},"openPort":function openPort(settings){const WorkerService3=this.__node.graph;if(!globalThis.Serial)WorkerService3.run("setupSerial");return new Promise((res,rej)=>{globalThis.Serial.getPorts().then(ports=>{const Serial=globalThis.Serial;let port=ports.find(port2=>{return port2.getInfo().usbVendorId===settings.usbVendorId&&port2.getInfo().usbProductId===settings.usbProductId});if(port){let options=Object.assign({},settings);if(typeof settings.pipeTo==="object"&&settings.pipeTo.extraArgs&&globalThis.Devices?.[settings.pipeTo.extraArgs[0]]?.[settings.pipeTo.extraArgs[1]]){options.onconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].onconnect;options.ondisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].ondisconnect;options.beforedisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].beforedisconnect}Serial.openPort(port,options).then(()=>{const stream=Serial.createStream({port,settings:options,frequency:settings.frequency?settings.frequency:10,buffering:settings.buffering,ondata:value=>{if(stream.settings.pipeTo){if(stream.settings.pipeMain){WorkerService3.transmit(value,void 0,[value.buffer])}if(typeof stream.settings.pipeTo==="string")WorkerService3.transmit(value,stream.settings.pipeTo,[value.buffer]);else if(stream.settings.pipeTo?.route){let args=value;if(stream.settings.pipeTo.extraArgs)args=[value,...stream.settings.pipeTo.extraArgs];WorkerService3.transmit({route:stream.settings.pipeTo.route,args},stream.settings.pipeTo._id,[value.buffer])}}else{WorkerService3.transmit(value,void 0,[value.buffer])}}});Serial.readStream(stream);port.ondisconnect=()=>{postMessage(`${stream._id} disconnected`)};res({_id:stream._id,settings,info:stream.info})}).catch(()=>{postMessage(`disconnected`)});;}else{rej(false)}})})},"closeStream":function closeStream(streamId){return new Promise((res,rej)=>{const Serial=globalThis.Serial;let ondisconnect;if(Serial.streams[streamId].port?.ondisconnect)ondisconnect=Serial.streams[streamId].port.ondisconnect;Serial.closeStream(Serial.streams[streamId]).then(resolved=>{if(ondisconnect)ondisconnect(void 0);res(resolved)}).catch(rej)})},"writeStream":function writeStream(streamId,message){globalThis.Serial.writeStream(globalThis.Serial.streams[streamId],message);return true},"updateStreamSettings":function updateStreamSettings(streamId,settings){if(globalThis.Serial?.streams[streamId]){for(const key in settings){if(typeof settings[key]==="object"){Object.assign(globalThis.Serial.streams[streamId].settings[key],settings[key])}else globalThis.Serial.streams[streamId][key]=settings[key]}}}};var __defProp3=Object.defineProperty;var __getOwnPropNames3=Object.getOwnPropertyNames;var __require4=(x3=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x3,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x3)(function(x3){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x3+\'" is not supported\')});var __esm=(fn,res)=>function __init(){return fn&&(res=(0,fn[__getOwnPropNames3(fn)[0]])(fn=0)),res};var __export2=(target,all)=>{for(var name2 in all)__defProp3(target,name2,{get:all[name2],enumerable:true})};var createCapacitorPlatforms;var initPlatforms;var CapacitorPlatforms;var addPlatform;var setPlatform;var ExceptionCode;var CapacitorException;var getPlatformId;var createCapacitor;var initCapacitorGlobal;var Capacitor;var registerPlugin;var Plugins;var WebPlugin;var encode;var decode2;var CapacitorCookiesPluginWeb;var CapacitorCookies;var readBlobAsBase64;var normalizeHttpHeaders;var buildUrlParams;var buildRequestInit;var CapacitorHttpPluginWeb;var CapacitorHttp;var init_dist=__esm({"src/ble/node_modules/@capacitor/core/dist/index.js"(){createCapacitorPlatforms=win=>{const defaultPlatformMap=new Map;defaultPlatformMap.set("web",{name:"web"});const capPlatforms=win.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:defaultPlatformMap};const addPlatform2=(name2,platform)=>{capPlatforms.platforms.set(name2,platform)};const setPlatform2=name2=>{if(capPlatforms.platforms.has(name2)){capPlatforms.currentPlatform=capPlatforms.platforms.get(name2)}};capPlatforms.addPlatform=addPlatform2;capPlatforms.setPlatform=setPlatform2;return capPlatforms};initPlatforms=win=>win.CapacitorPlatforms=createCapacitorPlatforms(win);CapacitorPlatforms=initPlatforms(typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{});addPlatform=CapacitorPlatforms.addPlatform;setPlatform=CapacitorPlatforms.setPlatform;(function(ExceptionCode2){ExceptionCode2["Unimplemented"]="UNIMPLEMENTED";ExceptionCode2["Unavailable"]="UNAVAILABLE"})(ExceptionCode||(ExceptionCode={}));CapacitorException=class extends Error{constructor(message,code,data){super(message);this.message=message;this.code=code;this.data=data}};getPlatformId=win=>{var _a,_b;if(win===null||win===void 0?void 0:win.androidBridge){return"android"}else if((_b=(_a=win===null||win===void 0?void 0:win.webkit)===null||_a===void 0?void 0:_a.messageHandlers)===null||_b===void 0?void 0:_b.bridge){return"ios"}else{return"web"}};createCapacitor=win=>{var _a,_b,_c,_d,_e;const capCustomPlatform=win.CapacitorCustomPlatform||null;const cap=win.Capacitor||{};const Plugins2=cap.Plugins=cap.Plugins||{};const capPlatforms=win.CapacitorPlatforms;const defaultGetPlatform=()=>{return capCustomPlatform!==null?capCustomPlatform.name:getPlatformId(win)};const getPlatform=((_a=capPlatforms===null||capPlatforms===void 0?void 0:capPlatforms.currentPlatform)===null||_a===void 0?void 0:_a.getPlatform)||defaultGetPlatform;const defaultIsNativePlatform=()=>getPlatform()!=="web";const isNativePlatform=((_b=capPlatforms===null||capPlatforms===void 0?void 0:capPlatforms.currentPlatform)===null||_b===void 0?void 0:_b.isNativePlatform)||defaultIsNativePlatform;const defaultIsPluginAvailable=pluginName=>{const plugin=registeredPlugins.get(pluginName);if(plugin===null||plugin===void 0?void 0:plugin.platforms.has(getPlatform())){return true}if(getPluginHeader(pluginName)){return true}return false};const isPluginAvailable=((_c=capPlatforms===null||capPlatforms===void 0?void 0:capPlatforms.currentPlatform)===null||_c===void 0?void 0:_c.isPluginAvailable)||defaultIsPluginAvailable;const defaultGetPluginHeader=pluginName=>{var _a2;return(_a2=cap.PluginHeaders)===null||_a2===void 0?void 0:_a2.find(h=>h.name===pluginName)};const getPluginHeader=((_d=capPlatforms===null||capPlatforms===void 0?void 0:capPlatforms.currentPlatform)===null||_d===void 0?void 0:_d.getPluginHeader)||defaultGetPluginHeader;const handleError=err=>win.console.error(err);const pluginMethodNoop=(_target,prop,pluginName)=>{return Promise.reject(`${pluginName} does not have an implementation of "${prop}".`)};const registeredPlugins=new Map;const defaultRegisterPlugin=(pluginName,jsImplementations={})=>{const registeredPlugin=registeredPlugins.get(pluginName);if(registeredPlugin){console.warn(`Capacitor plugin "${pluginName}" already registered. Cannot register plugins twice.`);return registeredPlugin.proxy}const platform=getPlatform();const pluginHeader=getPluginHeader(pluginName);let jsImplementation;const loadPluginImplementation=async()=>{if(!jsImplementation&&platform in jsImplementations){jsImplementation=typeof jsImplementations[platform]==="function"?jsImplementation=await jsImplementations[platform]():jsImplementation=jsImplementations[platform]}else if(capCustomPlatform!==null&&!jsImplementation&&"web"in jsImplementations){jsImplementation=typeof jsImplementations["web"]==="function"?jsImplementation=await jsImplementations["web"]():jsImplementation=jsImplementations["web"]}return jsImplementation};const createPluginMethod=(impl,prop)=>{var _a2,_b2;if(pluginHeader){const methodHeader=pluginHeader===null||pluginHeader===void 0?void 0:pluginHeader.methods.find(m=>prop===m.name);if(methodHeader){if(methodHeader.rtype==="promise"){return options=>cap.nativePromise(pluginName,prop.toString(),options)}else{return(options,callback)=>cap.nativeCallback(pluginName,prop.toString(),options,callback)}}else if(impl){return(_a2=impl[prop])===null||_a2===void 0?void 0:_a2.bind(impl)}}else if(impl){return(_b2=impl[prop])===null||_b2===void 0?void 0:_b2.bind(impl)}else{throw new CapacitorException(`"${pluginName}" plugin is not implemented on ${platform}`,ExceptionCode.Unimplemented)}};const createPluginMethodWrapper=prop=>{let remove;const wrapper=(...args)=>{const p2=loadPluginImplementation().then(impl=>{const fn=createPluginMethod(impl,prop);if(fn){const p22=fn(...args);remove=p22===null||p22===void 0?void 0:p22.remove;return p22}else{throw new CapacitorException(`"${pluginName}.${prop}()" is not implemented on ${platform}`,ExceptionCode.Unimplemented)}});if(prop==="addListener"){p2.remove=async()=>remove()}return p2};wrapper.toString=()=>`${prop.toString()}() { [capacitor code] }`;Object.defineProperty(wrapper,"name",{value:prop,writable:false,configurable:false});return wrapper};const addListener=createPluginMethodWrapper("addListener");const removeListener=createPluginMethodWrapper("removeListener");const addListenerNative=(eventName,callback)=>{const call=addListener({eventName},callback);const remove=async()=>{const callbackId=await call;removeListener({eventName,callbackId},callback)};const p2=new Promise(resolve=>call.then(()=>resolve({remove})));p2.remove=async()=>{console.warn(`Using addListener() without \'await\' is deprecated.`);await remove()};return p2};const proxy=new Proxy({},{get(_,prop){switch(prop){case"$$typeof":return void 0;case"toJSON":return()=>({});case"addListener":return pluginHeader?addListenerNative:addListener;case"removeListener":return removeListener;default:return createPluginMethodWrapper(prop)}}});Plugins2[pluginName]=proxy;registeredPlugins.set(pluginName,{name:pluginName,proxy,platforms:new Set([...Object.keys(jsImplementations),...pluginHeader?[platform]:[]])});return proxy};const registerPlugin2=((_e=capPlatforms===null||capPlatforms===void 0?void 0:capPlatforms.currentPlatform)===null||_e===void 0?void 0:_e.registerPlugin)||defaultRegisterPlugin;if(!cap.convertFileSrc){cap.convertFileSrc=filePath=>filePath}cap.getPlatform=getPlatform;cap.handleError=handleError;cap.isNativePlatform=isNativePlatform;cap.isPluginAvailable=isPluginAvailable;cap.pluginMethodNoop=pluginMethodNoop;cap.registerPlugin=registerPlugin2;cap.Exception=CapacitorException;cap.DEBUG=!!cap.DEBUG;cap.isLoggingEnabled=!!cap.isLoggingEnabled;cap.platform=cap.getPlatform();cap.isNative=cap.isNativePlatform();return cap};initCapacitorGlobal=win=>win.Capacitor=createCapacitor(win);Capacitor=initCapacitorGlobal(typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{});registerPlugin=Capacitor.registerPlugin;Plugins=Capacitor.Plugins;WebPlugin=class{constructor(config){this.listeners={};this.windowListeners={};if(config){console.warn(`Capacitor WebPlugin "${config.name}" config object was deprecated in v3 and will be removed in v4.`);this.config=config}}addListener(eventName,listenerFunc){const listeners=this.listeners[eventName];if(!listeners){this.listeners[eventName]=[]}this.listeners[eventName].push(listenerFunc);const windowListener=this.windowListeners[eventName];if(windowListener&&!windowListener.registered){this.addWindowListener(windowListener)}const remove=async()=>this.removeListener(eventName,listenerFunc);const p2=Promise.resolve({remove});Object.defineProperty(p2,"remove",{value:async()=>{console.warn(`Using addListener() without \'await\' is deprecated.`);await remove()}});return p2}async removeAllListeners(){this.listeners={};for(const listener in this.windowListeners){this.removeWindowListener(this.windowListeners[listener])}this.windowListeners={}}notifyListeners(eventName,data){const listeners=this.listeners[eventName];if(listeners){listeners.forEach(listener=>listener(data))}}hasListeners(eventName){return!!this.listeners[eventName].length}registerWindowListener(windowEventName,pluginEventName){this.windowListeners[pluginEventName]={registered:false,windowEventName,pluginEventName,handler:event=>{this.notifyListeners(pluginEventName,event)}}}unimplemented(msg="not implemented"){return new Capacitor.Exception(msg,ExceptionCode.Unimplemented)}unavailable(msg="not available"){return new Capacitor.Exception(msg,ExceptionCode.Unavailable)}async removeListener(eventName,listenerFunc){const listeners=this.listeners[eventName];if(!listeners){return}const index=listeners.indexOf(listenerFunc);this.listeners[eventName].splice(index,1);if(!this.listeners[eventName].length){this.removeWindowListener(this.windowListeners[eventName])}}addWindowListener(handle){window.addEventListener(handle.windowEventName,handle.handler);handle.registered=true}removeWindowListener(handle){if(!handle){return}window.removeEventListener(handle.windowEventName,handle.handler);handle.registered=false}};encode=str32=>encodeURIComponent(str32).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);decode2=str32=>str32.replace(/(%[\\dA-F]{2})+/gi,decodeURIComponent);CapacitorCookiesPluginWeb=class extends WebPlugin{async getCookies(){const cookies=document.cookie;const cookieMap={};cookies.split(";").forEach(cookie=>{if(cookie.length<=0)return;let[key,value]=cookie.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");key=decode2(key).trim();value=decode2(value).trim();cookieMap[key]=value});return cookieMap}async setCookie(options){try{const encodedKey=encode(options.key);const encodedValue=encode(options.value);const expires=`; expires=${(options.expires||"").replace("expires=","")}`;const path=(options.path||"/").replace("path=","");const domain=options.url!=null&&options.url.length>0?`domain=${options.url}`:"";document.cookie=`${encodedKey}=${encodedValue||""}${expires}; path=${path}; ${domain};`}catch(error){return Promise.reject(error)}}async deleteCookie(options){try{document.cookie=`${options.key}=; Max-Age=0`}catch(error){return Promise.reject(error)}}async clearCookies(){try{const cookies=document.cookie.split(";")||[];for(const cookie of cookies){document.cookie=cookie.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}}catch(error){return Promise.reject(error)}}async clearAllCookies(){try{await this.clearCookies()}catch(error){return Promise.reject(error)}}};CapacitorCookies=registerPlugin("CapacitorCookies",{web:()=>new CapacitorCookiesPluginWeb});readBlobAsBase64=async blob=>new Promise((resolve,reject)=>{const reader=new FileReader;reader.onload=()=>{const base64String=reader.result;resolve(base64String.indexOf(",")>=0?base64String.split(",")[1]:base64String)};reader.onerror=error=>reject(error);reader.readAsDataURL(blob)});normalizeHttpHeaders=(headers={})=>{const originalKeys=Object.keys(headers);const loweredKeys=Object.keys(headers).map(k=>k.toLocaleLowerCase());const normalized=loweredKeys.reduce((acc,key,index)=>{acc[key]=headers[originalKeys[index]];return acc},{});return normalized};buildUrlParams=(params,shouldEncode=true)=>{if(!params)return null;const output=Object.entries(params).reduce((accumulator,entry)=>{const[key,value]=entry;let encodedValue;let item;if(Array.isArray(value)){item="";value.forEach(str32=>{encodedValue=shouldEncode?encodeURIComponent(str32):str32;item+=`${key}=${encodedValue}&`});item.slice(0,-1)}else{encodedValue=shouldEncode?encodeURIComponent(value):value;item=`${key}=${encodedValue}`}return`${accumulator}&${item}`},"");return output.substr(1)};buildRequestInit=(options,extra={})=>{const output=Object.assign({method:options.method||"GET",headers:options.headers},extra);const headers=normalizeHttpHeaders(options.headers);const type=headers["content-type"]||"";if(typeof options.data==="string"){output.body=options.data}else if(type.includes("application/x-www-form-urlencoded")){const params=new URLSearchParams;for(const[key,value]of Object.entries(options.data||{})){params.set(key,value)}output.body=params.toString()}else if(type.includes("multipart/form-data")){const form=new FormData;if(options.data instanceof FormData){options.data.forEach((value,key)=>{form.append(key,value)})}else{for(const key of Object.keys(options.data)){form.append(key,options.data[key])}}output.body=form;const headers2=new Headers(output.headers);headers2.delete("content-type");output.headers=headers2}else if(type.includes("application/json")||typeof options.data==="object"){output.body=JSON.stringify(options.data)}return output};CapacitorHttpPluginWeb=class extends WebPlugin{async request(options){const requestInit=buildRequestInit(options,options.webFetchExtra);const urlParams=buildUrlParams(options.params,options.shouldEncodeUrlParams);const url2=urlParams?`${options.url}?${urlParams}`:options.url;const response=await fetch(url2,requestInit);const contentType=response.headers.get("content-type")||"";let{responseType="text"}=response.ok?options:{};if(contentType.includes("application/json")){responseType="json"}let data;let blob;switch(responseType){case"arraybuffer":case"blob":blob=await response.blob();data=await readBlobAsBase64(blob);break;case"json":data=await response.json();break;case"document":case"text":default:data=await response.text()}const headers={};response.headers.forEach((value,key)=>{headers[key]=value});return{data,headers,status:response.status,url:response.url}}async get(options){return this.request(Object.assign(Object.assign({},options),{method:"GET"}))}async post(options){return this.request(Object.assign(Object.assign({},options),{method:"POST"}))}async put(options){return this.request(Object.assign(Object.assign({},options),{method:"PUT"}))}async patch(options){return this.request(Object.assign(Object.assign({},options),{method:"PATCH"}))}async delete(options){return this.request(Object.assign(Object.assign({},options),{method:"DELETE"}))}};CapacitorHttp=registerPlugin("CapacitorHttp",{web:()=>new CapacitorHttpPluginWeb})}});function numbersToDataView(value){return new DataView(Uint8Array.from(value).buffer)}function dataViewToNumbers(value){return Array.from(new Uint8Array(value.buffer))}function numberToUUID(value){return`0000${value.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}function hexStringToDataView(value){const numbers=value.trim().split(" ").filter(e=>e!=="").map(s=>parseInt(s,16));return numbersToDataView(numbers)}function dataViewToHexString(value){return dataViewToNumbers(value).map(n=>{let s=n.toString(16);if(s.length==1){s="0"+s}return s}).join(" ")}function webUUIDToString(uuid){if(typeof uuid==="string"){return uuid}else if(typeof uuid==="number"){return numberToUUID(uuid)}else{throw new Error("Invalid UUID")}}function mapToObject(map){const obj={};if(!map){return void 0}map.forEach((value,key)=>{obj[key.toString()]=value});return obj}var init_conversion=__esm({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/conversion.js"(){}});async function runWithTimeout(promise,time,exception){let timer;return Promise.race([promise,new Promise((_,reject)=>{timer=setTimeout(()=>reject(exception),time)})]).finally(()=>clearTimeout(timer))}var init_timeout=__esm({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/timeout.js"(){}});var web_exports={};__export2(web_exports,{BluetoothLeWeb:()=>BluetoothLeWeb});var BluetoothLeWeb;var init_web=__esm({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/web.js"(){init_dist();init_conversion();init_timeout();BluetoothLeWeb=class extends WebPlugin{constructor(){super(...arguments);this.deviceMap=new Map;this.discoveredDevices=new Map;this.scan=null;this.DEFAULT_CONNECTION_TIMEOUT=1e4;this.onAdvertisementReceivedCallback=this.onAdvertisementReceived.bind(this);this.onDisconnectedCallback=this.onDisconnected.bind(this);this.onCharacteristicValueChangedCallback=this.onCharacteristicValueChanged.bind(this)}async initialize(){if(typeof navigator==="undefined"||!navigator.bluetooth){throw this.unavailable("Web Bluetooth API not available in this browser.")}const isAvailable=await navigator.bluetooth.getAvailability();if(!isAvailable){throw this.unavailable("No Bluetooth radio available.")}}async isEnabled(){return{value:true}}async enable(){throw this.unavailable("enable is not available on web.")}async disable(){throw this.unavailable("disable is not available on web.")}async startEnabledNotifications(){}async stopEnabledNotifications(){}async isLocationEnabled(){throw this.unavailable("isLocationEnabled is not available on web.")}async openLocationSettings(){throw this.unavailable("openLocationSettings is not available on web.")}async openBluetoothSettings(){throw this.unavailable("openBluetoothSettings is not available on web.")}async openAppSettings(){throw this.unavailable("openAppSettings is not available on web.")}async setDisplayStrings(){}async requestDevice(options){const filters=this.getFilters(options);const device=await navigator.bluetooth.requestDevice({filters:filters.length?filters:void 0,optionalServices:options===null||options===void 0?void 0:options.optionalServices,acceptAllDevices:filters.length===0});this.deviceMap.set(device.id,device);const bleDevice=this.getBleDevice(device);return bleDevice}async requestLEScan(options){this.requestBleDeviceOptions=options;const filters=this.getFilters(options);await this.stopLEScan();this.discoveredDevices=new Map;navigator.bluetooth.removeEventListener("advertisementreceived",this.onAdvertisementReceivedCallback);navigator.bluetooth.addEventListener("advertisementreceived",this.onAdvertisementReceivedCallback);this.scan=await navigator.bluetooth.requestLEScan({filters:filters.length?filters:void 0,acceptAllAdvertisements:filters.length===0,keepRepeatedDevices:options===null||options===void 0?void 0:options.allowDuplicates})}onAdvertisementReceived(event){var _a,_b;const deviceId=event.device.id;this.deviceMap.set(deviceId,event.device);const isNew=!this.discoveredDevices.has(deviceId);if(isNew||((_a=this.requestBleDeviceOptions)===null||_a===void 0?void 0:_a.allowDuplicates)){this.discoveredDevices.set(deviceId,true);const device=this.getBleDevice(event.device);const result={device,localName:device.name,rssi:event.rssi,txPower:event.txPower,manufacturerData:mapToObject(event.manufacturerData),serviceData:mapToObject(event.serviceData),uuids:(_b=event.uuids)===null||_b===void 0?void 0:_b.map(webUUIDToString)};this.notifyListeners("onScanResult",result)}}async stopLEScan(){var _a;if((_a=this.scan)===null||_a===void 0?void 0:_a.active){this.scan.stop()}this.scan=null}async getDevices(options){const devices=await navigator.bluetooth.getDevices();const bleDevices=devices.filter(device=>options.deviceIds.includes(device.id)).map(device=>{this.deviceMap.set(device.id,device);const bleDevice=this.getBleDevice(device);return bleDevice});return{devices:bleDevices}}async getConnectedDevices(_options){const devices=await navigator.bluetooth.getDevices();const bleDevices=devices.filter(device=>{var _a;return(_a=device.gatt)===null||_a===void 0?void 0:_a.connected}).map(device=>{this.deviceMap.set(device.id,device);const bleDevice=this.getBleDevice(device);return bleDevice});return{devices:bleDevices}}async connect(options){var _a,_b;const device=this.getDeviceFromMap(options.deviceId);device.removeEventListener("gattserverdisconnected",this.onDisconnectedCallback);device.addEventListener("gattserverdisconnected",this.onDisconnectedCallback);const timeoutError=Symbol();if(device.gatt===void 0){throw new Error("No gatt server available.")}try{const timeout=(_a=options.timeout)!==null&&_a!==void 0?_a:this.DEFAULT_CONNECTION_TIMEOUT;await runWithTimeout(device.gatt.connect(),timeout,timeoutError)}catch(error){await((_b=device.gatt)===null||_b===void 0?void 0:_b.disconnect());if(error===timeoutError){throw new Error("Connection timeout")}else{throw error}}}onDisconnected(event){const deviceId=event.target.id;const key=`disconnected|${deviceId}`;this.notifyListeners(key,null)}async createBond(_options){throw this.unavailable("createBond is not available on web.")}async isBonded(_options){throw this.unavailable("isBonded is not available on web.")}async disconnect(options){var _a;(_a=this.getDeviceFromMap(options.deviceId).gatt)===null||_a===void 0?void 0:_a.disconnect()}async getServices(options){var _a,_b;const services=(_b=await((_a=this.getDeviceFromMap(options.deviceId).gatt)===null||_a===void 0?void 0:_a.getPrimaryServices()))!==null&&_b!==void 0?_b:[];const bleServices=[];for(const service of services){const characteristics=await service.getCharacteristics();const bleCharacteristics=[];for(const characteristic of characteristics){bleCharacteristics.push({uuid:characteristic.uuid,properties:this.getProperties(characteristic),descriptors:await this.getDescriptors(characteristic)})}bleServices.push({uuid:service.uuid,characteristics:bleCharacteristics})}return{services:bleServices}}async getDescriptors(characteristic){try{const descriptors=await characteristic.getDescriptors();return descriptors.map(descriptor=>({uuid:descriptor.uuid}))}catch(_a){return[]}}getProperties(characteristic){return{broadcast:characteristic.properties.broadcast,read:characteristic.properties.read,writeWithoutResponse:characteristic.properties.writeWithoutResponse,write:characteristic.properties.write,notify:characteristic.properties.notify,indicate:characteristic.properties.indicate,authenticatedSignedWrites:characteristic.properties.authenticatedSignedWrites,reliableWrite:characteristic.properties.reliableWrite,writableAuxiliaries:characteristic.properties.writableAuxiliaries}}async getCharacteristic(options){var _a;const service=await((_a=this.getDeviceFromMap(options.deviceId).gatt)===null||_a===void 0?void 0:_a.getPrimaryService(options===null||options===void 0?void 0:options.service));return service===null||service===void 0?void 0:service.getCharacteristic(options===null||options===void 0?void 0:options.characteristic)}async getDescriptor(options){const characteristic=await this.getCharacteristic(options);return characteristic===null||characteristic===void 0?void 0:characteristic.getDescriptor(options===null||options===void 0?void 0:options.descriptor)}async discoverServices(_options){throw this.unavailable("discoverServices is not available on web.")}async getMtu(_options){throw this.unavailable("getMtu is not available on web.")}async requestConnectionPriority(_options){throw this.unavailable("requestConnectionPriority is not available on web.")}async readRssi(_options){throw this.unavailable("readRssi is not available on web.")}async read(options){const characteristic=await this.getCharacteristic(options);const value=await(characteristic===null||characteristic===void 0?void 0:characteristic.readValue());return{value}}async write(options){const characteristic=await this.getCharacteristic(options);let dataView;if(typeof options.value==="string"){dataView=hexStringToDataView(options.value)}else{dataView=options.value}await(characteristic===null||characteristic===void 0?void 0:characteristic.writeValueWithResponse(dataView))}async writeWithoutResponse(options){const characteristic=await this.getCharacteristic(options);let dataView;if(typeof options.value==="string"){dataView=hexStringToDataView(options.value)}else{dataView=options.value}await(characteristic===null||characteristic===void 0?void 0:characteristic.writeValueWithoutResponse(dataView))}async readDescriptor(options){const descriptor=await this.getDescriptor(options);const value=await(descriptor===null||descriptor===void 0?void 0:descriptor.readValue());return{value}}async writeDescriptor(options){const descriptor=await this.getDescriptor(options);let dataView;if(typeof options.value==="string"){dataView=hexStringToDataView(options.value)}else{dataView=options.value}await(descriptor===null||descriptor===void 0?void 0:descriptor.writeValue(dataView))}async startNotifications(options){const characteristic=await this.getCharacteristic(options);characteristic===null||characteristic===void 0?void 0:characteristic.removeEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback);characteristic===null||characteristic===void 0?void 0:characteristic.addEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback);await(characteristic===null||characteristic===void 0?void 0:characteristic.startNotifications())}onCharacteristicValueChanged(event){var _a,_b;const characteristic=event.target;const key=`notification|${(_a=characteristic.service)===null||_a===void 0?void 0:_a.device.id}|${(_b=characteristic.service)===null||_b===void 0?void 0:_b.uuid}|${characteristic.uuid}`;this.notifyListeners(key,{value:characteristic.value})}async stopNotifications(options){const characteristic=await this.getCharacteristic(options);await(characteristic===null||characteristic===void 0?void 0:characteristic.stopNotifications())}getFilters(options){var _a;const filters=[];for(const service of(_a=options===null||options===void 0?void 0:options.services)!==null&&_a!==void 0?_a:[]){filters.push({services:[service],name:options===null||options===void 0?void 0:options.name,namePrefix:options===null||options===void 0?void 0:options.namePrefix})}if(((options===null||options===void 0?void 0:options.name)||(options===null||options===void 0?void 0:options.namePrefix))&&filters.length===0){filters.push({name:options.name,namePrefix:options.namePrefix})}return filters}getDeviceFromMap(deviceId){const device=this.deviceMap.get(deviceId);if(device===void 0){throw new Error(\'Device not found. Call "requestDevice", "requestLEScan" or "getDevices" first.\')}return device}getBleDevice(device){var _a;const bleDevice={deviceId:device.id,name:(_a=device.name)!==null&&_a!==void 0?_a:void 0};return bleDevice}}}});var __create3=Object.create;var __defProp23=Object.defineProperty;var __getOwnPropDesc3=Object.getOwnPropertyDescriptor;var __getOwnPropNames22=Object.getOwnPropertyNames;var __getProtoOf3=Object.getPrototypeOf;var __hasOwnProp3=Object.prototype.hasOwnProperty;var __defNormalProp3=(obj,key,value)=>key in obj?__defProp23(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __require22=(x3=>typeof __require4!=="undefined"?__require4:typeof Proxy!=="undefined"?new Proxy(x3,{get:(a,b)=>(typeof __require4!=="undefined"?__require4:a)[b]}):x3)(function(x3){if(typeof __require4!=="undefined")return __require4.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x3+\'" is not supported\')});var __commonJS3=(cb,mod)=>function __require222(){return mod||(0,cb[__getOwnPropNames22(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps3=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames22(from))if(!__hasOwnProp3.call(to,key)&&key!==except)__defProp23(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc3(from,key))||desc.enumerable})}return to};var __toESM3=(mod,isNodeMode,target)=>(target=mod!=null?__create3(__getProtoOf3(mod)):{},__copyProps3(isNodeMode||!mod||!mod.__esModule?__defProp23(target,"default",{value:mod,enumerable:true}):target,mod));var __publicField3=(obj,key,value)=>{__defNormalProp3(obj,typeof key!=="symbol"?key+"":key,value);return value};var require_browser2=__commonJS3({"node_modules/web-worker/cjs/browser.js"(exports,module2){module2.exports=Worker}});var EventHandler3=class{data={};triggers={};ctr=0;constructor(data){if(typeof data==="object")this.data=data}setState=updateObj=>{Object.assign(this.data,updateObj);let props=Object.getOwnPropertyNames(updateObj);for(const prop of props){this.triggerEvent(prop,this.data[prop])}if(this.triggers[statesubKey3]){let run=fn=>{fn(updateObj)};const l=this.triggers[statesubKey3].length;for(let i22=l-1;i22>=0;i22--){run(this.triggers[statesubKey3][i22].onchange)}}return this.data};setValue=(key,value)=>{this.data[key]=value;this.triggerEvent(key,value)};triggerEvent=(key,value)=>{if(this.triggers[key]){let fn=obj=>{obj.onchange(value)};const l=this.triggers[key].length;for(let i22=l-1;i22>=0;i22--){fn(this.triggers[key][i22])}}};subscribeState=onchange=>{return this.subscribeEvent(statesubKey3,onchange)};unsubscribeState=sub=>{return this.unsubscribeEvent(statesubKey3,sub)};subscribeEvent=(key,onchange,refObject,refKey)=>{if(key){if(refObject&&refKey&&!this.triggers[key]){Object.defineProperty(this.data,key,{get:()=>{return refObject[refKey]},set:value=>{refObject[refKey]=value},enumerable:true,configurable:true})}if(!this.triggers[key]){this.triggers[key]=[]}let l=this.ctr;this.ctr++;this.triggers[key].push({sub:l,onchange});return l}else return void 0};unsubscribeEvent=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(sub===void 0){delete this.triggers[key];delete this.data[key]}else{let idx=void 0;let obj=triggers.find((o,i22)=>{if(o.sub===sub){idx=i22;return true}});if(obj)triggers.splice(idx,1);if(Object.keys(triggers).length===0){delete this.triggers[key];delete this.data[key]}if(this.onRemoved)this.onRemoved(obj);return true}}};subscribeEventOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeEvent(key,sub)};sub=this.subscribeEvent(key,changed);return sub};getEvent=(key,sub)=>{for(const s in this.triggers[key]){if(this.triggers[key][s].sub===sub)return this.triggers[key][s]}};getSnapshot=()=>{const snapshot={};for(const key in this.data){snapshot[key]=this.data[key]}};onRemoved};var statesubKey3="*s";var state3=new EventHandler3;var GraphNode2=class{__node={tag:`node${Math.floor(Math.random()*1e15)}`,unique:`${Math.floor(Math.random()*1e15)}`,state:state3};__children;__parent;__operator;__listeners;__props;__args;constructor(properties,parent,graph){this.__setProperties(properties,parent,graph)}__setProperties=(properties,parent,graph)=>{let enforceProperties=()=>{let orig=properties;if(typeof properties==="function"){if(isNativeClass2(properties)){properties=new properties}else properties={__operator:properties,__node:{forward:true,tag:properties.name}}}else if(typeof properties==="string"){if(graph?.get(properties)){properties=graph.get(properties)}}if(!("__node"in properties))properties.__node={};if(!properties.__node.initial)properties.__node.initial=orig};enforceProperties();if(typeof properties==="object"){let assignState=()=>{if(properties.__node?.state)this.__node.state=properties.__node.state;else if(graph){properties.__node.state=graph.__node.state}};let setProps22=()=>{if(properties.__props){if(typeof properties.__props==="function")properties.__props=new properties.__props;if(typeof properties.__props==="object"){this.__proxyObject(properties.__props)}}};let setTag=()=>{if(!properties.__node.tag){if(properties.__operator?.name)properties.__node.tag=properties.__operator.name;else properties.__node.tag=`node${Math.floor(Math.random()*1e15)}`}};let setNode=()=>{if(typeof properties.__node==="string"){if(graph?.get(properties.__node.tag)){properties=graph.get(properties.__node.tag)}else properties.__node={}}else if(!properties.__node)properties.__node={};if(graph){properties.__node.graph=graph}if(properties instanceof Graph2)properties.__node.source=properties};let setParent=()=>{if(!properties.__parent&&parent)properties.__parent=parent;if(parent?.__node&&!(parent instanceof Graph2||properties instanceof Graph2))properties.__node.tag=parent.__node.tag+"."+properties.__node.tag;if(parent instanceof Graph2&&properties instanceof Graph2){if(properties.__node.loaders)Object.assign(parent.__node.loaders?parent.__node.loaders:{},properties.__node.loaders);if(parent.__node.mapGraphs){properties.__node.nodes.forEach(n=>{parent.set(properties.__node.tag+"."+n.__node.tag,n)});let ondelete=()=>{properties.__node.nodes.forEach(n=>{parent.__node.nodes.delete(properties.__node.tag+"."+n.__node.tag)})};this.__addOndisconnected(ondelete)}}};let setOp=()=>{if(typeof properties.default==="function"&&!properties.__operator){properties.__operator=properties.default}if(properties.__operator){if(typeof properties.__operator==="string"){if(graph){let n=graph.get(properties.__operator);if(n)properties.__operator=n.__operator;if(!properties.__node.tag&&properties.__operator.name)properties.__node.tag=properties.__operator.name}}if(typeof properties.__operator==="function")properties.__operator=this.__setOperator(properties.__operator);if(properties.default)properties.default=properties.__operator}};let assignProps=()=>{properties.__node=Object.assign(this.__node,properties.__node);let keys22=Object.getOwnPropertyNames(properties).filter(v2=>{if(!objProps3[v2])return true});for(const key of keys22){if(key in properties)this[key]=properties[key]}};let bindCallbacks=()=>{if(this.__onconnected){if(typeof this.__onconnected==="function"){this.__onconnected=this.__onconnected.bind(this)}else if(Array.isArray(this.__onconnected)){this.__onconnected=this.__onconnected.map(f=>{return f.bind(this)})}if(typeof this.__ondisconnected==="function"){this.__ondisconnected=this.__ondisconnected.bind(this)}else if(Array.isArray(this.__ondisconnected)){this.__ondisconnected=this.__ondisconnected.map(f=>{return f.bind(this)})}}};assignState();setTag();setProps22();setNode();setParent();assignProps();bindCallbacks();setOp()}};__subscribe=(callback,key,subInput,target,tkey,args)=>{const subscribeToFunction=(k,setTarget=(callback2,target2)=>target2?target2:callback2,triggerCallback=callback)=>{let wrappedArgs;if(args){let wrapped=wrapArgs2(triggerCallback,args,this.__node.graph);triggerCallback=wrapped.__callback;wrappedArgs=wrapped.__args}let sub=this.__node.state.subscribeEvent(k,triggerCallback,this,key);let trigger=this.__node.state.getEvent(k,sub);if(!this.__listeners)this.__listeners={};this.__listeners[k]=this.__node.state.triggers[k];if(!trigger)return sub;trigger.source=this.__node.tag;if(key)trigger.key=key;trigger.target=setTarget(callback,target);if(subInput)trigger.subInput=subInput;if(args){trigger.arguments=args;trigger.__args=wrappedArgs}if(tkey)trigger.tkey=tkey;trigger.node=this;trigger.graph=this.__node.graph;return sub};const subscribeToGraph=callback2=>{let fn=this.__node.graph.get(callback2);if(!fn&&callback2.includes(".")){target=callback2.substring(0,callback2.lastIndexOf("."));let n=this.__node.graph.get(callback2.substring(0,target));tkey=callback2.lastIndexOf(".")+1;if(n&&typeof n[key]==="function")callback2=(...args2)=>{return n[tkey](...args2)}}else if(fn.__operator){callback2=fn.__operator;tkey="__operator"}};if(key){if(!this.__node.localState||!this.__node.localState[key]){this.__addLocalState(this,key)}if(typeof callback==="string"){tkey=callback;if(target){if(this.__node.graph?.get(target)){let n=this.__node.graph?.get(target);if(typeof n[callback]==="function"){let fn=n[callback];callback=(...inp)=>{fn(...inp)}}else{let k2=callback;let setter=inp=>{n[k2]=inp};callback=setter}}}else if(typeof this[callback]==="function"){let fn=this[callback];callback=(...inp)=>{fn(...inp)}}else if(this.__node.graph?.get(callback))subscribeToGraph(callback);if(typeof callback!=="function")return void 0}let sub;let k=subInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node)sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)});return sub}else{if(typeof callback==="string"){if(this.__node.graph.get(callback))callback=this.__node.graph.get(callback);tkey="__operator";if(typeof callback!=="object")return void 0}let sub;let k=subInput?this.__node.unique+"input":this.__node.unique;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node){sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)})}return sub}};__unsubscribe=(sub,key,unsubInput)=>{if(key){return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key,sub)}else return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"input":this.__node.unique,sub)};__setOperator=fn=>{fn=fn.bind(this);if(this.__args&&this.__node.graph){fn=wrapArgs2(fn,this.__args,this.__node.graph).__callback}let inpstr=`${this.__node.unique}input`;this.__operator=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[this.__node.unique]){if(typeof result?.then==="function"){result.then(res=>{if(res!==void 0)this.__node.state.setValue(this.__node.unique,res)}).catch(console.error)}else if(result!==void 0)this.__node.state.setValue(this.__node.unique,result)}return result};if(this.__parent instanceof GraphNode2&&!this.__subscribedToParent){if(this.__parent.__operator){let sub=this.__parent.__subscribe(this);let ondelete=()=>{this.__parent?.__unsubscribe(sub);delete this.__subscribedToParent};this.__addOndisconnected(ondelete);this.__subscribedToParent=true}}return this.__operator};__addLocalState=(props,key)=>{if(!props)return;if(!this.__node.localState){this.__node.localState={}}const localState=this.__node.localState;const initState=(props2,k)=>{let str32=this.__node.unique+"."+k;let inpstr=`${str32}input`;let get,set;let obj,descriptor;if(typeof props2[k]==="function"&&k!=="__operator"){if(this.__props?.[k]){obj=this.__props}else{obj=localState}get=()=>{return obj[k]};set=fn=>{if(!this.__props?.[k])fn=fn.bind(this);obj[k]=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[str32]){if(typeof result?.then==="function"){result.then(res=>{this.__node.state.triggerEvent(str32,res)}).catch(console.error)}else this.__node.state.triggerEvent(str32,result)}return result}};localState[k]=props2[k].bind(this);descriptor={get,set,enumerable:true,configurable:true}}else{let get2,set2;let obj2;if(this.__props?.[k]){obj2=this.__props}else{obj2=localState}get2=()=>{return obj2[k]};set2=v2=>{obj2[k]=v2;if(this.__node.state.triggers[str32])this.__node.state.triggerEvent(str32,v2)};localState[k]=props2[k];descriptor={get:get2,set:set2,enumerable:true,configurable:true}}Object.defineProperty(props2,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}};if(key)initState(props,key);else{for(let k in props){initState(props,k)}}};__proxyObject=obj=>{const allProps=getAllProperties2(obj);for(const k of allProps){const descriptor={get:()=>{return obj[k]},set:value=>{obj[k]=value},enumerable:true,configurable:true};Object.defineProperty(this,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}}};__addOnconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__onconnected)){this.__onconnected.push(callback)}else if(typeof this.__onconnected==="function"){this.__onconnected=[callback,this.__onconnected]}else this.__onconnected=callback}__addOndisconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__ondisconnected)){this.__ondisconnected.push(callback)}else if(typeof this.__ondisconnected==="function"){this.__ondisconnected=[callback,this.__ondisconnected]}else this.__ondisconnected=callback}__callConnected(node=this){if(typeof this.__onconnected==="function"){this.__onconnected(this)}else if(Array.isArray(this.__onconnected)){let fn=o=>{o(this)};this.__onconnected.forEach(fn)}}__callDisconnected(node=this){if(typeof this.__ondisconnected==="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let fn=o=>{o(this)};this.__ondisconnected.forEach(fn)}}};var Graph2=class{__node={tag:`graph${Math.floor(Math.random()*1e15)}`,unique:`${Math.random()}`,nodes:new Map,state:state3,roots:{}};constructor(options){this.init(options)}init=options=>{if(options){let cpy=Object.assign({},options);delete cpy.roots;recursivelyAssign3(this.__node,cpy);if(options.roots)this.load(options.roots)}};load=roots=>{function recursivelyAssignChildren(target,obj,inChildren=true,top=true){if(top){if(target)Object.assign(target,obj);else target=Object.assign({},obj);recursivelyAssignChildren(target,obj,true,false)}if(obj?.__children&&!inChildren){if(obj.__children?.constructor.name==="Object"){if(target.__children?.constructor.name==="Object")recursivelyAssignChildren(target.__children,obj.__children,true,false);else target.__children=recursivelyAssignChildren({},obj.__children,true,false)}else{target.__children=obj.__children}}else if(inChildren){for(const key in obj){target[key]=Object.assign({},obj[key]);if(obj[key]?.__children){recursivelyAssignChildren({},obj[key].__children,false,false)}}}return target}this.__node.roots=recursivelyAssignChildren(this.__node.roots?this.__node.roots:{},roots);let cpy=Object.assign({},roots);if(cpy.__node)delete cpy.__node;let listeners=this.recursiveSet(cpy,this,void 0,roots);if(roots.__node){if(!roots.__node.tag)roots.__node._tag=`roots${Math.floor(Math.random()*1e15)}`;else if(!this.get(roots.__node.tag)){let node=new GraphNode2(roots,this,this);this.set(node.__node.tag,node);this.runLoaders(node,this,roots,roots.__node.tag);if(node.__listeners){listeners[node.__node.tag]=node.__listeners}}}else if(roots.__listeners){this.setListeners(roots.__listeners)}this.setListeners(listeners);return cpy};setLoaders=(loaders22,replace)=>{if(replace)this.__node.loaders=loaders22;else Object.assign(this.__node.loaders,loaders22);return this.__node.loaders};runLoaders=(node,parent,properties,key)=>{for(const l in this.__node.loaders){if(typeof this.__node.loaders[l]==="object"){if(this.__node.loaders[l].init)this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key);if(this.__node.loaders[l].connected)node.__addOnconnected(this.__node.loaders[l].connect);if(this.__node.loaders[l].disconnected)node.__addOndisconnected(this.__node.loaders[l].disconnect)}else if(typeof this.__node.loaders[l]==="function")this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key)}};add=(properties,parent)=>{let listeners={};if(typeof parent==="string")parent=this.get(parent);let instanced;if(typeof properties==="function"){if(isNativeClass2(properties)){if(properties.prototype instanceof GraphNode2){properties=properties.prototype.constructor(properties,parent,this);instanced=true}else properties=new properties}else properties={__operator:properties}}else if(typeof properties==="string"){properties=this.__node.roots[properties]}if(!properties)return;if(!instanced){let keys22=Object.getOwnPropertyNames(properties);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(properties));keys22.push(...nonArrowFunctions);keys22=keys22.filter(v2=>!objProps3.includes(v2));let cpy={};for(const key of keys22){cpy[key]=properties[key]}properties=cpy}if(!properties.__node)properties.__node={};properties.__node.initial=properties;if(typeof properties==="object"&&!this.get(properties.__node.tag)){let node;let root=recursivelyAssign3({},properties,2);if(instanced)node=properties;else node=new GraphNode2(properties,parent,this);this.set(node.__node.tag,node);this.runLoaders(node,parent,properties,node.__node.tag);this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key in node.__listeners){let listener=node.__listeners[key];if(node[key]){delete listeners[node.__node.tag][key];listeners[node.__node.tag][node.__node.tag+"."+key]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][key]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode2&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][key]=parent.__node.tag}}}}this.setListeners(listeners);node.__callConnected();return node}else if(properties.__node.tag)return this.get(properties.__node.tag)};recursiveSet=(t22,parent,listeners={},origin)=>{let keys22=Object.getOwnPropertyNames(origin);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(origin)).filter(v2=>!objProps3.includes(v2));keys22.push(...nonArrowFunctions);for(const key of keys22){if(key.includes("__"))continue;let p2=origin[key];if(Array.isArray(p2))continue;let instanced;if(typeof p2==="function"){if(isNativeClass2(p2)){p2=new p2;if(p2 instanceof GraphNode2){p2=p2.prototype.constructor(p2,parent,this);instanced=true}}else p2={__operator:p2}}else if(typeof p2==="string"){if(this.__node.nodes.get(p2))p2=this.__node.nodes.get(p2);else p2=this.__node.roots[p2]}else if(typeof p2==="boolean"){if(this.__node.nodes.get(key))p2=this.__node.nodes.get(key);else p2=this.__node.roots[key]}if(p2 instanceof Object){if(!instanced&&!(p2 instanceof GraphNode2)){let ks=Object.getOwnPropertyNames(p2);let nonArrowFunctions2=Object.getOwnPropertyNames(Object.getPrototypeOf(p2));nonArrowFunctions2.splice(nonArrowFunctions2.indexOf("constructor"),1);ks.push(...nonArrowFunctions2);let cpy={};for(const key2 of ks){cpy[key2]=p2[key2]}p2=cpy}if(!p2.__node)p2.__node={};if(!p2.__node.tag)p2.__node.tag=key;if(!p2.__node.initial)p2.__node.initial=t22[key];if(this.get(p2.__node.tag)&&!(!(parent instanceof Graph2)&&parent?.__node)||parent?.__node&&this.get(parent.__node.tag+"."+p2.__node.tag))continue;let node;let newnode=false;let root=recursivelyAssign3({},p2,2);if(instanced||p2 instanceof GraphNode2){node=p2}else{node=new GraphNode2(p2,parent,this);newnode=true}if(!newnode&&p2 instanceof GraphNode2&&!instanced&&parent instanceof GraphNode2){let sub=this.subscribe(parent.__node.tag,node.__node.tag);let ondelete=node2=>{this.unsubscribe(parent.__node.tag,sub)};node.__addOndisconnected(ondelete)}else if(node){this.set(node.__node.tag,node);this.runLoaders(node,parent,t22[key],key);t22[key]=node;this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key2 in node.__listeners){let listener=node.__listeners[key2];let k=key2;if(node[key2]){delete listeners[node.__node.tag][key2];k=node.__node.tag+"."+key2;listeners[node.__node.tag][k]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][k]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode2&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][k]=parent.__node.tag}}}}node.__callConnected()}}}return listeners};remove=(node,clearListeners=true)=>{this.unsubscribe(node);if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode2){this.delete(node.__node.tag);delete this.__node.roots[node.__node.tag];if(clearListeners){this.clearListeners(node)}node.__callDisconnected();const recursiveRemove=t22=>{for(const key in t22){this.unsubscribe(t22[key]);this.delete(t22[key].__node.tag);delete this.__node.roots[t22[key].__node.tag];this.delete(key);delete this.__node.roots[key];t22[key].__node.tag=t22[key].__node.tag.substring(t22[key].__node.tag.lastIndexOf(".")+1);if(clearListeners){this.clearListeners(t22[key])}t22[key].__callDisconnected();if(t22[key].__children){recursiveRemove(t22[key].__children)}}};if(node.__children){recursiveRemove(node.__children)}}if(node?.__node.tag&&node?.__parent){delete node?.__parent;node.__node.tag=node.__node.tag.substring(node.__node.tag.indexOf(".")+1)}if(node?.__node.graph)node.__node.graph=void 0;return node};run=(node,...args)=>{if(typeof node==="string"){let nd=this.get(node);if(!nd&&node.includes(".")){nd=this.get(node.substring(0,node.lastIndexOf(".")));if(typeof nd?.[node.substring(node.lastIndexOf(".")+1)]==="function")return nd[node.substring(node.lastIndexOf(".")+1)](...args)}else if(nd?.__operator)return nd.__operator(...args)}if(node?.__operator){return node?.__operator(...args)}};setListeners=listeners=>{for(const key in listeners){let node=this.get(key);if(typeof listeners[key]==="object"){for(const k in listeners[key]){let n=this.get(k);let sub;if(typeof listeners[key][k]!=="object")listeners[key][k]={__callback:listeners[key][k]};else if(!listeners[key][k].__callback){for(const kk in listeners[key][k]){if(typeof listeners[key][k][kk]!=="object"){listeners[key][k][kk]={__callback:listeners[key][k][kk]};if(node.__operator&&(listeners[key][k][kk].__callback===true||typeof listeners[key][k][kk].__callback==="undefined"))listeners[key][k][kk].__callback=node.__operator}let nn=this.get(kk);if(!nn){let tag=k.substring(0,k.lastIndexOf("."));nn=this.get(tag);if(nn){let prop=k.substring(k.lastIndexOf(".")+1);sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k][kk].__args,prop,listeners[key][k][kk].inputState,key,k)}}else{sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}if("__callback"in listeners[key][k]){if(node){if(listeners[key][k].__callback===true||typeof listeners[key][k].__callback==="undefined")listeners[key][k].__callback=node.__operator;if(typeof listeners[key][k].__callback==="function")listeners[key][k].__callback=listeners[key][k].__callback.bind(node)}if(!n){let tag=k.substring(0,k.lastIndexOf("."));n=this.get(tag);if(n){sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,k.substring(k.lastIndexOf(".")+1),listeners[key][k].inputState,key,k)}}else{sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}}}};clearListeners=(node,listener)=>{if(typeof node==="string")node=this.get(node);if(node?.__listeners){for(const key in node.__listeners){if(listener&&key!==listener)continue;if(typeof node.__listeners[key]?.sub!=="number")continue;let n=this.get(key);if(!n){n=this.get(key.substring(0,key.lastIndexOf(".")));if(n){if(typeof node.__listeners[key]==="object"&&!node.__listeners[key]?.__callback){for(const k in node.__listeners[key]){if(typeof node.__listeners[key][k]?.sub==="number"){this.unsubscribe(n,node.__listeners[key][k].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}else{if(typeof!node.__listeners[key]?.__callback==="number"){for(const k in node.__listeners[key]){if(node.__listeners[key][k]?.sub){this.unsubscribe(n,node.__listeners[key][k].sub,void 0,node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,void 0,node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}}};get=tag=>{return this.__node.nodes.get(tag)};set=(tag,node)=>{return this.__node.nodes.set(tag,node)};delete=tag=>{return this.__node.nodes.delete(tag)};getProps=(node,getInitial)=>{if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode2){let cpy;if(getInitial)cpy=Object.assign({},this.__node.roots[node.__node.tag]);else{cpy=Object.assign({},node);for(const key in cpy){if(key.includes("__"))delete cpy[key]}}}};subscribe=(nodeEvent,onEvent,args,key,subInput,target,bound,tkey)=>{let nd=nodeEvent;if(typeof nodeEvent==="string"){nd=this.get(nodeEvent);if(!nd&&nodeEvent.includes(".")){nd=this.get(nodeEvent.substring(0,nodeEvent.lastIndexOf(".")));key=nodeEvent.substring(nodeEvent.lastIndexOf(".")+1)}}if(target instanceof GraphNode2)target=target.__node.tag;if(typeof onEvent==="string"){let setOnEventFromString=onEvent2=>{if(this.get(onEvent2)?.__operator){let node=this.get(onEvent2);target=onEvent2;onEvent2=function(...inp){return node.__operator(...inp)}}else if(onEvent2.includes(".")){target=onEvent2.substring(0,onEvent2.lastIndexOf("."));let n=this.get(target);let k=onEvent2.substring(onEvent2.lastIndexOf(".")+1);tkey=k;if(typeof n[k]==="function"){if(n[k]instanceof GraphNode2)onEvent2=n[k];else onEvent2=function(...inp){return n[k](...inp)}}else{onEvent2=function(inp){n[k]=inp;return n[k]}}}return onEvent2};if(target){let node=this.get(target);if(typeof node?.[onEvent]==="function"){tkey=onEvent;onEvent=function(...inp){return node[key](...inp)}}else if(node[key]){tkey=key;if(node[key]instanceof GraphNode2)onEvent=node[key];else onEvent=function(inp){node[key]=inp;return node[key]}}else{onEvent=setOnEventFromString(onEvent)}}else{onEvent=setOnEventFromString(onEvent)}}let sub;if(nd instanceof GraphNode2){const doSub=()=>{sub=nd.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)nd.__unsubscribe(sub,key,subInput);sub=void 0};nd.__addOndisconnected(()=>{ondelete();nd.__addOnconnected(()=>{if(sub===void 0&&nd.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))onEvent=this.get(onEvent);if(onEvent instanceof GraphNode2){onEvent.__addOndisconnected(()=>{ondelete()})}};doSub()}else if(typeof nodeEvent==="string"){let node=this.get(nodeEvent);if(node){if(onEvent instanceof GraphNode2&&onEvent.__operator){const doSub=()=>{sub=node.__subscribe(onEvent.__operator,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput)};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});onEvent.__addOndisconnected(ondelete)};doSub()}else if(typeof onEvent==="function"||typeof onEvent==="string"){const doSub=()=>{sub=node.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput);sub=void 0};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))this.get(onEvent).__addOndisconnected(ondelete)};doSub()}}else{if(typeof onEvent==="string")onEvent=this.__node.nodes.get(onEvent).__operator;if(typeof onEvent==="function")sub=this.__node.state.subscribeEvent(nodeEvent,onEvent)}}return sub};unsubscribe=(node,sub,key,subInput)=>{if(node instanceof GraphNode2){return node.__unsubscribe(sub,key,subInput)}else return this.get(node)?.__unsubscribe(sub,key,subInput)};setState=update=>{this.__node.state.setState(update)}};function recursivelyAssign3(target,obj,maxDepth=Infinity,curDepth=0){for(const key in obj){if(obj[key]?.constructor.name==="Object"&&curDepth<maxDepth){curDepth++;if(target[key]?.constructor.name==="Object")recursivelyAssign3(target[key],obj[key],maxDepth,curDepth);else target[key]=recursivelyAssign3({},obj[key],maxDepth,curDepth)}else{target[key]=obj[key]}}return target}function getAllProperties2(obj){var allProps=[],curr=obj;do{var props=Object.getOwnPropertyNames(curr);let fn=function(prop){if(allProps.indexOf(prop)===-1)allProps.push(prop)};props.forEach(fn)}while(curr=Object.getPrototypeOf(curr));return allProps}function isNativeClass2(thing){return isFunction2(thing)==="class"}function isFunction2(x3){const res=typeof x3==="function"?x3.prototype?Object.getOwnPropertyDescriptor(x3,"prototype")?.writable?"function":"class":x3.constructor.name==="AsyncFunction"?"async":"arrow":"";return res}var getCallbackFromString2=(a,graph)=>{if(graph.get(a)?.__operator){let node=graph.get(a);return(...inp)=>{node.__operator(...inp)}}else if(a.includes(".")){let split=a.split(".");let popped=split.pop();let joined=split.join(".");let node=graph.get(joined);if(typeof graph.get(joined)?.[popped]==="function"){return(...inp)=>{return node[popped](...inp)}}else return()=>{return node[popped]}}else if(graph.get(a)){let node=graph.get(a);return()=>{return node}}else{let arg=a;return()=>{return arg}}};var wrapArgs2=(callback,argOrder,graph)=>{let args=[];let forArg=(a,i22)=>{if(a==="__output"||a==="__input"||a==="__callback"){args[i22]={__callback:inp=>{return inp},__args:void 0,idx:i22}}else if(typeof a==="string"){args[i22]={__callback:getCallbackFromString2(a,graph),__args:void 0,idx:i22}}else if(typeof a==="function"){let fn2=a;args[i22]={__callback:(...inp)=>{return fn2(...inp)},__args:void 0,idx:i22}}else if(typeof a==="object"&&(a.__input||a.__callback)){let recursivelyCreateCallback=function(c){let input=c.__input?c.__input:c.__callback;if(typeof c.__input==="string"){input={__callback:getCallbackFromString2(c.__input,graph),__args:void 0,idx:i22}}if(c.__args){let wrapped=wrapArgs2(input,c.__args,graph);input={__callback:wrapped.__callback,__args:wrapped.__args,idx:i22}}else{input={__callback:input,__args:void 0,idx:i22}}if(c.__output){let output=c.__output;if(typeof c.__output==="string"){output={__callback:getCallbackFromString2(output,graph),__args:void 0,idx:i22}}else if(typeof a.__output==="object"){output=recursivelyCreateCallback(output)}if(typeof output?.__callback==="function"){let fn2=input.__callback;let callback2=output.__callback;input={__callback:(...inp)=>{return callback2(fn2(...inp))},__args:output.__args,idx:i22}}}return input};args[i22]=recursivelyCreateCallback(a)}else{let arg=a;args[i22]={__callback:()=>{return arg},__args:void 0,idx:i22}}};argOrder.forEach(forArg);if(typeof callback==="string")callback={__callback:getCallbackFromString2(callback,graph),__args:void 0};let fn=typeof callback==="function"?callback:callback.__callback;callback=function(...inp){let mapArg=arg=>{return arg.__callback(...inp)};const result=fn(...args.map(mapArg));return result};return{__callback:callback,__args:args}};var objProps3=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var backprop2=(node,parent,graph)=>{if(node.__node.backward&&parent instanceof GraphNode2){graph.setListeners({[parent.__node.tag]:{[node.__node.tag]:parent}})}};var loop2=(node,parent,graph)=>{if(node.__operator&&!node.__node.looperSet){if(typeof node.__node.delay==="number"){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{setTimeout(async()=>{res(await fn(...args))},node.__node.delay)})})}else if(node.__node.frame===true){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{requestAnimationFrame(async()=>{res(await fn(...args))})})})}if(typeof node.__node.repeat==="number"||typeof node.__node.recursive==="number"){let fn=node.__operator;node.__setOperator(async(...args)=>{let i22=node.__node.repeat?node.__node.repeat:node.__node.recursive;let result;let repeater=async(tick,...inp)=>{while(tick>0){if(node.__node.delay||node.__node.frame){fn(...inp).then(async res=>{if(node.__node.recursive){await repeater(tick,res)}else await repeater(tick,...inp)});break}else result=await fn(...args);tick--}};await repeater(i22,...args);return result})}if(node.__node.loop&&typeof node.__node.loop==="number"){node.__node.looperSet=true;let fn=node.__operator;let time=node.__node.loop;node.__setOperator((...args)=>{if(!("looping"in node.__node))node.__node.looping=true;if(node.__node.looping){let last=performance.now();fn(...args);setTimeout(()=>{let now=performance.now();let overshoot=now-last-node.__node.loop;if(overshoot>0)time=node.__node.loop-overshoot;else time=node.__node.loop;if(time<=0)time=node.__node.loop;node.__operator(...args)},time)}});if(node.__node.looping)node.__operator();let ondelete=node2=>{if(node2.__node.looping)node2.__node.looping=false};node.__addOndisconnected(ondelete)}}};var animate2=(node,parent,graph)=>{if(node.__node.animate===true||node.__animation){let fn=node.__operator;node.__setOperator((...args)=>{if(!("animating"in node.__node))node.__node.animating=true;if(node.__node.animating){if(typeof node.__animation==="function")node.__animation(...args);else fn(...args);requestAnimationFrame(()=>{node.__operator(...args)})}});if(node.__node.animating||(!("animating"in node.__node)||node.__node.animating)&&node.__animation)setTimeout(()=>{requestAnimationFrame(node.__operator)},10);let ondelete=node2=>{if(node2.__node.animating)node2.__node.animating=false};node.__addOndisconnected(ondelete)}};var branching2=(node,parent,graph)=>{if(typeof node.__branch==="object"&&node.__operator&&!node.__branchApplied){let fn=node.__operator;node.__branchApplied=true;node.__operator=(...args)=>{let result=fn(...args);for(const key in node.__branch){let triggered=()=>{if(typeof node.__branch[key].then==="function"){node.__branch[key].then(result)}else if(node.__branch[key].then instanceof GraphNode2&&node.__branch[key].then.__operator){node.__branch[key].then.__operator(result)}else result=node.__branch[key].then};if(typeof node.__branch[key].if==="function"){if(node.__branch[key].if(result)==true){triggered()}}else if(node.__branch[key].if===result){triggered()}}return result}}if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].branch&&!node.__listeners[key].branchApplied){let fn=node.__listeners[key].callback;node.__listeners[key].branchApplied=true;node.__listeners.callback=ret=>{let triggered=()=>{if(typeof node.__listeners[key].branch.then==="function"){ret=node.__listeners[key].branch.then(ret)}else if(node.__listeners[key].branch.then instanceof GraphNode2&&node.__listeners[key].branch.then.__operator){ret=node.__listeners[key].branch.then.__operator(ret)}else ret=node.__listeners[key].branch.then};if(typeof node.__listeners[key].branch.if==="function"){if(node.__listeners[key].branch.if(ret)){triggered()}}else if(node.__listeners[key].branch.if===ret){triggered()}return fn(ret)}}}}}};var triggerListenerOncreate2=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].oncreate){node.__listeners[key].callback(node.__listeners[key].oncreate)}}}}};var bindListener2=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].binding==="object"){node.__listeners.callback=node.__listeners.callback.bind(node.__listeners[key].binding)}}}}};var transformListenerResult2=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].transform==="function"&&!node.__listeners[key].transformApplied){let fn=node.__listeners[key].callback;node.__listeners[key].transformApplied=true;node.__listeners.callback=ret=>{ret=node.__listeners[key].transform(ret);return fn(ret)}}}}}};var substitute__operator2=(node,parent,graph)=>{if(node.post&&!node.__operator){node.__setOperator(node.post)}else if(!node.__operator&&typeof node.get=="function"){node.__setOperator(node.get)}if(!node.get&&node.__operator){node.get=node.__operator}if(node.aliases){node.aliases.forEach(a=>{graph.set(a,node);let ondelete=node2=>{graph.__node.nodes.delete(a)};node.__addOndisconnected(ondelete)})}if(typeof graph.__node.roots?.[node.__node.tag]==="object"&&node.get)graph.__node.roots[node.__node.tag].get=node.get};var loaders2={backprop:backprop2,loop:loop2,animate:animate2,branching:branching2,triggerListenerOncreate:triggerListenerOncreate2,bindListener:bindListener2,transformListenerResult:transformListenerResult2,substitute__operator:substitute__operator2};var recursivelyStringifyFunctions2=obj=>{let cpy={};for(const key in obj){if(typeof obj[key]==="object"){cpy[key]=recursivelyStringifyFunctions2(obj[key])}else if(typeof obj[key]==="function"){cpy[key]=obj[key].toString()}else cpy[key]=obj[key]}return cpy};function parseFunctionFromText4(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs3=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs22(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs3}var stringifyFast3=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p2 in value[prop]){if(Array.isArray(value[prop][p2])){if(value[prop][p2].length>20)obj[prop][p2]=value[prop][p2].slice(value[prop][p2].length-20);else obj[prop][p2]=value[prop][p2]}else{if(value[prop][p2]!=null){let con=value[prop][p2].constructor.name;if(con.includes("Set")){obj[prop][p2]=Array.from(value[prop][p2])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p2]="instanceof_"+con}else{obj[prop][p2]=value[prop][p2]}}else{obj[prop][p2]=value[prop][p2]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast22(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast3}function methodstrings2(node){if(typeof node.__methods==="object"){for(const key in node.__methods){let fstr=node.__methods[key];let fn=typeof fstr==="function"?fstr:parseFunctionFromText4(fstr);if(key==="__operator"){node.__setOperator(fn)}else{node[key]=fn.bind(node)}}}}var Service2=class extends Graph2{name=`service${Math.floor(Math.random()*1e15)}`;constructor(options){super({...options,loaders:options?.loaders?Object.assign({...loaders2},options.loaders):{...loaders2}});if(options?.services)this.addServices(options.services);this.load(this)}addServices=services=>{for(const s in services){if(typeof services[s]==="function")services[s]=new services[s];if(services[s]?.__node?.loaders)Object.assign(this.__node.loaders,services[s].__node.loaders);if(services[s]?.__node?.nodes){services[s].__node.nodes.forEach((n,tag)=>{if(!this.get(tag)){this.set(tag,n)}else this.set(s+"."+tag,n)});this.__node.nodes.forEach((n,k)=>{if(!services[s].__node.nodes.get(k))services[s].__node.nodes.set(k,n)});let set=this.set;this.set=(tag,node)=>{services[s].set(tag,node);return set(tag,node)};let del=this.delete;this.delete=tag=>{services[s].delete(tag);return del(tag)}}else if(typeof services[s]==="object"){this.load(services[s])}}};handleMethod=(route,method,args)=>{let m=method.toLowerCase();let src=this.__node.nodes.get(route);if(!src){src=this.__node.roots[route]}if(src?.[m]){if(typeof src[m]!=="function"){if(args){if(Array.isArray(args)&&args.length===1)src[m]=args[0];else src[m]=args;return}return src[m]}else{if(Array.isArray(args))return src[m](...args);else return src[m](args)}}else return this.handleServiceMessage({route,args,method})};handleServiceMessage(message){let call;if(typeof message==="object"){if(message.route)call=message.route;else if(message.node)call=message.node}if(call){if(Array.isArray(message.args))return this.run(call,...message.args);else return this.run(call,message.args)}else return message}handleGraphNodeCall(route,args){if(!route)return args;if(args?.args){this.handleServiceMessage(args)}else if(Array.isArray(args))return this.run(route,...args);else return this.run(route,args)}transmit=(...args)=>{if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};receive=(...args)=>{if(args[0]){if(typeof args[0]==="string"){let substr=args[0].substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))args[0]=args[0].replace(/\\\\/g,"");if(args[0][0]===\'"\'){args[0]=args[0].substring(1,args[0].length-1)};args[0]=JSON.parse(args[0])}}}if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};pipe=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode2){if(callback)return this.subscribe(source,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})};pipeOnce=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode2){if(callback)return source.__node.state.subscribeEventOnce(source.__node.unique,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.__node.state.subscribeEventOnce(source.__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(source).__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})};terminate=(...args)=>{};isTypedArray=isTypedArray2;recursivelyAssign=recursivelyAssign22;spliceTypedArray=spliceTypedArray2;ping=()=>{console.log("pinged!");return"pong"};echo=(...args)=>{this.transmit(...args);return args};log=(...args)=>{console.log(...args);return true};error=(...args)=>{console.error(...args);return true}};function isTypedArray2(x3){return ArrayBuffer.isView(x3)&&Object.prototype.toString.call(x3)!=="[object DataView]"}var recursivelyAssign22=(target,obj)=>{for(const key in obj){if(obj[key]?.constructor.name==="Object"&&!Array.isArray(obj[key])){if(target[key]?.constructor.name==="Object"&&!Array.isArray(target[key]))recursivelyAssign22(target[key],obj[key]);else target[key]=recursivelyAssign22({},obj[key])}else target[key]=obj[key]}return target};function spliceTypedArray2(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let ta;if(s.length>0||e?.length>0)ta=new arr.constructor(s.length+e.length);if(ta){if(s.length>0)ta.set(s);if(e&&e.length>0)ta.set(e,s.length)}return ta}var nodeTemplates2={};var remoteGraphRoutes2={transferNode:(properties,connection,name2)=>{let str32;if(typeof properties==="object"){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}str32=recursivelyStringifyFunctions2(properties)}else if(typeof properties==="function")str32=properties.toString();else if(typeof properties==="string")str32=properties;if(str32){if(connection.run)return connection.run("setNode",[str32]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:str32},void 0);return new Promise(r=>r(name2))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:str32}));return new Promise(r=>r(name2))}}},setNode:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings2}}}if(typeof properties==="string"){let f=parseFunctionFromText4(properties);if(typeof f==="function")properties={__operator:f,__node:{tag:name2?name2:f.name}};else{f=JSON.parse(properties);if(typeof f==="object")properties=f}}if(typeof properties==="object"||typeof properties==="function"){let template={};if(typeof properties==="object")Object.assign(template,properties);else template.__operator=properties;let node=this.__node.graph.add(template);if(node){nodeTemplates2[node.__node.tag]=template;return node.__node?.tag}else return false}else return false},proxyRemoteNode:function(name2,connection){return new Promise((res,rej)=>{connection.run("getNodeProperties",name2).then(props=>{let proxy={};if(typeof props==="object"){for(const key in props){if(props[key]==="function"){proxy[key]=(...args)=>{return new Promise(r=>{connection.run(name2,args,key).then(r)})}}else{Object.defineProperty(proxy,key,{get:()=>{return new Promise(r=>{connection.run(name2,void 0,key).then(r)})},set:value=>{connection.post(name2,value,key)},configurable:true,enumerable:true})}}}res(proxy)})})},makeNodeTransferrable:function(properties,name2){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}const str32=recursivelyStringifyFunctions2(properties);return str32},setTemplate:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings2}}}if(typeof properties==="string"){let f=parseFunctionFromText4(properties);if(typeof f==="function"){if(!name2)name2=f.name;properties={__operator:f,__node:{tag:name2}}}else{f=JSON.parse(properties);if(typeof f==="object"){properties=f;if(!name2&&f.__node?.tag)name2=f.__node.tag}}}if(!name2)name2=`node${Math.floor(Math.random()*1e15)}`;if(typeof properties==="object"||typeof properties==="function"){nodeTemplates2[name2]=properties;return name2}else return false},loadFromTemplate:function(templateName,name2,properties){if(nodeTemplates2[templateName]){let cpy=recursivelyAssign22({},nodeTemplates2[templateName]);if(name2){if(!cpy.__node)cpy.__node={};cpy.__node.tag=name2}if(properties)Object.assign(cpy,properties);let node=this.__node.graph.add(cpy);return node.__node.tag}},setMethod:function(nodeTag,fn,methodKey){if(typeof fn==="string"){let f=parseFunctionFromText4(fn);if(typeof f==="function")fn=f}if(!methodKey&&typeof fn==="function")methodKey=fn.name;if(this.__node.graph.get(nodeTag)){this.__node.graph.get(nodeTag)[methodKey]=fn}else this.__node.graph.add({__node:{tag:methodKey,[methodKey]:fn}});return true},assignNode:function(nodeTag,source){if(this.__node.graph.get(nodeTag)&&typeof source==="object"){Object.assign(this.__node.graph.get(nodeTag),source)}},getNodeProperties:function(nodeTag){let node=this.__node.graph.get(nodeTag);if(node){let properties=Object.getOwnPropertyNames(node);let result={};for(const key in properties){result[key]=typeof node[key]}return result}return void 0},transferClass:(classObj,connection,className)=>{if(typeof classObj==="object"){let str32=classObj.toString();let message={route:"receiveClass",args:[str32,className]};if(connection.run)return connection.run("receiveClass",[str32,className]);else if(connection.postMessage){connection.postMessage({route:"receiveClass",args:[str32,className]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"receiveClass",args:[str32,className]}));return new Promise(r=>r(name))}return message}return false},receiveClass:function(stringified,className){if(typeof stringified==="string"){if(stringified.indexOf("class")===0){let cls=(0,eval)("("+stringified+")");let name2=className;if(!name2)name2=cls.name;this.__node.graph[name2]=cls;return true}}return false},transferFunction:(fn,connection,fnName)=>{if(!fnName)fnName=fn.name;let str32=fn.toString();let message={route:"setNode",args:[str32,fnName]};if(connection.run)return connection.run("setNode",[str32,fnName]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:[str32,fnName]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:[str32,fnName]}));return new Promise(r=>r(name))}return message},setGlobal:(key,value)=>{globalThis[key]=value;return true},assignGlobalObject:(target,source)=>{if(!globalThis[target])return false;if(typeof source==="object")Object.assign(globalThis[target],source);return true},setValue:function(key,value){this.__node.graph[key]=value;return true},assignObject:function(target,source){if(!this.__node.graph[target])return false;if(typeof source==="object")Object.assign(this.__node.graph[target],source);return true},setGlobalFunction:(fn,fnName)=>{if(typeof fn==="string")fn=parseFunctionFromText4(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;globalThis[fnName]=fn;return true}return false},setGraphFunction:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText4(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.__node.graph[fnName]=fn;return true}return false}};function html2(strings,...args){return function append(elm=document.createElement("div")){let template=document.createElement("template");strings.map(function(s,i22){template.innerHTML+=s;if(args[i22]instanceof HTMLElement){let dummy22=`<span id="dummyNode12345"></span>`;dummy22.id="dummyNode12345";template.innerHTML+=dummy22}else template.innerHTML+=args[i22]});let query=template.content.querySelectorAll("#dummyNode12345");let ctr=0;args.forEach((arg,i22)=>{if(arg instanceof HTMLElement){console.log(arg,query[ctr]);template.content.replaceChild(arg,query[ctr]);ctr++}});elm.appendChild(template.content);return elm}}var dummy2=html2``;var sjcl2={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl2.cipher.aes=function(a){this.s[0][0][0]||this.O();var b,c,d2,e,f=this.s[0][4],g=this.s[1];b=a.length;var h=1;if(4!==b&&6!==b&&8!==b)throw new sjcl2.exception.invalid("invalid aes key size");this.b=[d2=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d2[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));d2[a]=d2[a-b]^c}for(b=0;a;b++,a--)c=d2[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]]};sjcl2.cipher.aes.prototype={encrypt:function(a){return t2(this,a,0)},decrypt:function(a){return t2(this,a,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var a=this.s[0],b=this.s[1],c=a[4],d2=b[4],e,f,g,h=[],k=[],l,n,m,p2;for(e=0;256>e;e++)k[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=l||1,g=k[g]||1)for(m=g^g<<1^g<<2^g<<3^g<<4,m=m>>8^m&255^99,c[f]=m,d2[m]=f,n=h[e=h[l=h[f]]],p2=16843009*n^65537*e^257*l^16843008*f,n=257*h[m]^16843008*m,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p2=p2<<24^p2>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};function t2(a,b,c){if(4!==b.length)throw new sjcl2.exception.invalid("invalid aes block size");var d2=a.b[c],e=b[0]^d2[0],f=b[c?3:1]^d2[1],g=b[2]^d2[2];b=b[c?1:3]^d2[3];var h,k,l,n=d2.length/4-2,m,p2=4,r=[0,0,0,0];h=a.s[c];a=h[0];var q=h[1],v2=h[2],w=h[3],x3=h[4];for(m=0;m<n;m++)h=a[e>>>24]^q[f>>16&255]^v2[g>>8&255]^w[b&255]^d2[p2],k=a[f>>>24]^q[g>>16&255]^v2[b>>8&255]^w[e&255]^d2[p2+1],l=a[g>>>24]^q[b>>16&255]^v2[e>>8&255]^w[f&255]^d2[p2+2],b=a[b>>>24]^q[e>>16&255]^v2[f>>8&255]^w[g&255]^d2[p2+3],p2+=4,e=h,f=k,g=l;for(m=0;4>m;m++)r[c?3&-m:m]=x3[e>>>24]<<24^x3[f>>16&255]<<16^x3[g>>8&255]<<8^x3[b&255]^d2[p2++],h=e,e=f,f=g,g=b,b=h;return r}sjcl2.bitArray={bitSlice:function(a,b,c){a=sjcl2.bitArray.$(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl2.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d2=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d2^a[b/32+1|0]>>>d2:a[b/32|0]>>>d2)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d2=sjcl2.bitArray.getPartial(c);return 32===d2?a.concat(b):sjcl2.bitArray.$(b,d2,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl2.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b=b&31;0<c&&b&&(a[c-1]=sjcl2.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl2.bitArray.bitLength(a)!==sjcl2.bitArray.bitLength(b))return false;var c=0,d2;for(d2=0;d2<a.length;d2++)c|=a[d2]^b[d2];return 0===c},$:function(a,b,c,d2){var e;e=0;for(void 0===d2&&(d2=[]);32<=b;b-=32)d2.push(c),c=0;if(0===b)return d2.concat(a);for(e=0;e<a.length;e++)d2.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl2.bitArray.getPartial(e);d2.push(sjcl2.bitArray.partial(b+a&31,32<b+a?c:d2.pop(),1));return d2},i:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&65280|(c&65280)<<8|c<<24;return a}};sjcl2.codec.utf8String={fromBits:function(a){var b="",c=sjcl2.bitArray.bitLength(a),d2,e;for(d2=0;d2<c/8;d2++)0===(d2&3)&&(e=a[d2/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d2=0;for(c=0;c<a.length;c++)d2=d2<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d2),d2=0);c&3&&b.push(sjcl2.bitArray.partial(8*(c&3),d2));return b}};sjcl2.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl2.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d2;a=a.replace(/\\s|0x/g,"");d2=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl2.bitArray.clamp(c,4*d2)}};sjcl2.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(a,b,c){var d2=sjcl2.codec.base32.BASE,e=sjcl2.codec.base32.REMAINING,f="",g=0,h=sjcl2.codec.base32.B,k=0,l=sjcl2.bitArray.bitLength(a);c&&(h=sjcl2.codec.base32.X);for(c=0;f.length*d2<l;)f+=h.charAt((k^a[c]>>>g)>>>e),g<d2?(k=a[c]<<d2-g,g+=e,c++):(k<<=d2,g-=d2);for(;f.length&7&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\\s|=/g,"").toUpperCase();var c=sjcl2.codec.base32.BITS,d2=sjcl2.codec.base32.BASE,e=sjcl2.codec.base32.REMAINING,f=[],g,h=0,k=sjcl2.codec.base32.B,l=0,n,m="base32";b&&(k=sjcl2.codec.base32.X,m="base32hex");for(g=0;g<a.length;g++){n=k.indexOf(a.charAt(g));if(0>n){if(!b)try{return sjcl2.codec.base32hex.toBits(a)}catch(p2){}throw new sjcl2.exception.invalid("this isn\'t "+m+"!")}h>e?(h-=e,f.push(l^n>>>h),l=n<<c-h):(h+=d2,l^=n<<c-h)}h&56&&f.push(sjcl2.bitArray.partial(h&56,l,1));return f}};sjcl2.codec.base32hex={fromBits:function(a,b){return sjcl2.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl2.codec.base32.toBits(a,1)}};sjcl2.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d2="",e=0,f=sjcl2.codec.base64.B,g=0,h=sjcl2.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d2.length<h;)d2+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;d2.length&3&&!b;)d2+="=";return d2},toBits:function(a,b){a=a.replace(/\\s|=/g,"");var c=[],d2,e=0,f=sjcl2.codec.base64.B,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d2=0;d2<a.length;d2++){h=f.indexOf(a.charAt(d2));if(0>h)throw new sjcl2.exception.invalid("this isn\'t base64!");26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e)}e&56&&c.push(sjcl2.bitArray.partial(e&56,g,1));return c}};sjcl2.codec.base64url={fromBits:function(a){return sjcl2.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl2.codec.base64.toBits(a,1)}};sjcl2.hash.sha256=function(a){this.b[0]||this.O();a?(this.F=a.F.slice(0),this.A=a.A.slice(0),this.l=a.l):this.reset()};sjcl2.hash.sha256.hash=function(a){return new sjcl2.hash.sha256().update(a).finalize()};sjcl2.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(a){"string"===typeof a&&(a=sjcl2.codec.utf8String.toBits(a));var b,c=this.A=sjcl2.bitArray.concat(this.A,a);b=this.l;a=this.l=b+sjcl2.bitArray.bitLength(a);if(9007199254740991<a)throw new sjcl2.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d2=new Uint32Array(c),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u2(this,d2.subarray(16*e,16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u2(this,c.splice(0,16));return this},finalize:function(){var a,b=this.A,c=this.F,b=sjcl2.bitArray.concat(b,[sjcl2.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.l/4294967296));for(b.push(this.l|0);b.length;)u2(this,b.splice(0,16));this.reset();return c},Y:[],b:[],O:function(){function a(a2){return 4294967296*(a2-Math.floor(a2))|0}for(var b=0,c=2,d2,e;64>b;c++){e=true;for(d2=2;d2*d2<=c;d2++)if(0===c%d2){e=false;break}e&&(8>b&&(this.Y[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}};function u2(a,b){var c,d2,e,f=a.F,g=a.b,h=f[0],k=f[1],l=f[2],n=f[3],m=f[4],p2=f[5],r=f[6],q=f[7];for(c=0;64>c;c++)16>c?d2=b[c]:(d2=b[c+1&15],e=b[c+14&15],d2=b[c&15]=(d2>>>7^d2>>>18^d2>>>3^d2<<25^d2<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c&15]+b[c+9&15]|0),d2=d2+q+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(r^m&(p2^r))+g[c],q=r,r=p2,p2=m,m=n+d2|0,n=l,l=k,k=h,h=d2+(k&l^n&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+n|0;f[4]=f[4]+m|0;f[5]=f[5]+p2|0;f[6]=f[6]+r|0;f[7]=f[7]+q|0}sjcl2.mode.ccm={name:"ccm",G:[],listenProgress:function(a){sjcl2.mode.ccm.G.push(a)},unListenProgress:function(a){a=sjcl2.mode.ccm.G.indexOf(a);-1<a&&sjcl2.mode.ccm.G.splice(a,1)},fa:function(a){var b=sjcl2.mode.ccm.G.slice(),c;for(c=0;c<b.length;c+=1)b[c](a)},encrypt:function(a,b,c,d2,e){var f,g=b.slice(0),h=sjcl2.bitArray,k=h.bitLength(c)/8,l=h.bitLength(g)/8;e=e||64;d2=d2||[];if(7>k)throw new sjcl2.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&l>>>8*f;f++);f<15-k&&(f=15-k);c=h.clamp(c,8*(15-f));b=sjcl2.mode.ccm.V(a,b,c,d2,e,f);g=sjcl2.mode.ccm.C(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d2,e){e=e||64;d2=d2||[];var f=sjcl2.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/8;if(7>g)throw new sjcl2.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&h>>>8*b;b++);b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));k=sjcl2.mode.ccm.C(a,k,c,l,e,b);a=sjcl2.mode.ccm.V(a,k.data,c,d2,e,b);if(!f.equal(k.tag,a))throw new sjcl2.exception.corrupt("ccm: tag doesn\'t match");return k.data},na:function(a,b,c,d2,e,f){var g=[],h=sjcl2.bitArray,k=h.i;d2=[h.partial(8,(b.length?64:0)|d2-2<<2|f-1)];d2=h.concat(d2,c);d2[3]|=e;d2=a.encrypt(d2);if(b.length)for(c=h.bitLength(b)/8,65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,b),b=0;b<g.length;b+=4)d2=a.encrypt(k(d2,g.slice(b,b+4).concat([0,0,0])));return d2},V:function(a,b,c,d2,e,f){var g=sjcl2.bitArray,h=g.i;e/=8;if(e%2||4>e||16<e)throw new sjcl2.exception.invalid("ccm: invalid tag length");if(4294967295<d2.length||4294967295<b.length)throw new sjcl2.exception.bug("ccm: can\'t deal with 4GiB or more data");c=sjcl2.mode.ccm.na(a,d2,c,e,g.bitLength(b)/8,f);for(d2=0;d2<b.length;d2+=4)c=a.encrypt(h(c,b.slice(d2,d2+4).concat([0,0,0])));return g.clamp(c,8*e)},C:function(a,b,c,d2,e,f){var g,h=sjcl2.bitArray;g=h.i;var k=b.length,l=h.bitLength(b),n=k/50,m=n;c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d2=h.bitSlice(g(d2,a.encrypt(c)),0,e);if(!k)return{tag:d2,data:[]};for(g=0;g<k;g+=4)g>n&&(sjcl2.mode.ccm.fa(g/k),n+=m),c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d2,data:h.clamp(b,l)}}};sjcl2.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d2,e,f){if(128!==sjcl2.bitArray.bitLength(c))throw new sjcl2.exception.invalid("ocb iv must be 128 bits");var g,h=sjcl2.mode.ocb2.S,k=sjcl2.bitArray,l=k.i,n=[0,0,0,0];c=h(a.encrypt(c));var m,p2=[];d2=d2||[];e=e||64;for(g=0;g+4<b.length;g+=4)m=b.slice(g,g+4),n=l(n,m),p2=p2.concat(l(c,a.encrypt(l(c,m)))),c=h(c);m=b.slice(g);b=k.bitLength(m);g=a.encrypt(l(c,[0,0,0,b]));m=k.clamp(l(m.concat([0,0,0]),g),b);n=l(n,l(m.concat([0,0,0]),g));n=a.encrypt(l(n,l(c,h(c))));d2.length&&(n=l(n,f?d2:sjcl2.mode.ocb2.pmac(a,d2)));return p2.concat(k.concat(m,k.clamp(n,e)))},decrypt:function(a,b,c,d2,e,f){if(128!==sjcl2.bitArray.bitLength(c))throw new sjcl2.exception.invalid("ocb iv must be 128 bits");e=e||64;var g=sjcl2.mode.ocb2.S,h=sjcl2.bitArray,k=h.i,l=[0,0,0,0],n=g(a.encrypt(c)),m,p2,r=sjcl2.bitArray.bitLength(b)-e,q=[];d2=d2||[];for(c=0;c+4<r/32;c+=4)m=k(n,a.decrypt(k(n,b.slice(c,c+4)))),l=k(l,m),q=q.concat(m),n=g(n);p2=r-32*c;m=a.encrypt(k(n,[0,0,0,p2]));m=k(m,h.clamp(b.slice(c),p2).concat([0,0,0]));l=k(l,m);l=a.encrypt(k(l,k(n,g(n))));d2.length&&(l=k(l,f?d2:sjcl2.mode.ocb2.pmac(a,d2)));if(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))throw new sjcl2.exception.corrupt("ocb: tag doesn\'t match");return q.concat(h.clamp(m,p2))},pmac:function(a,b){var c,d2=sjcl2.mode.ocb2.S,e=sjcl2.bitArray,f=e.i,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d2(d2(h)));for(c=0;c+4<b.length;c+=4)h=d2(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d2(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d2(f(h,d2(h))),g))},S:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};sjcl2.mode.gcm={name:"gcm",encrypt:function(a,b,c,d2,e){var f=b.slice(0);b=sjcl2.bitArray;d2=d2||[];a=sjcl2.mode.gcm.C(true,a,f,d2,c,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c,d2,e){var f=b.slice(0),g=sjcl2.bitArray,h=g.bitLength(f);e=e||128;d2=d2||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl2.mode.gcm.C(false,a,f,d2,c,e);if(!g.equal(a.tag,b))throw new sjcl2.exception.corrupt("gcm: tag doesn\'t match");return a.data},ka:function(a,b){var c,d2,e,f,g,h=sjcl2.bitArray.i;e=[0,0,0,0];f=b.slice(0);for(c=0;128>c;c++){(d2=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d2=3;0<d2;d2--)f[d2]=f[d2]>>>1|(f[d2-1]&1)<<31;f[0]>>>=1;g&&(f[0]^=-520093696)}return e},j:function(a,b,c){var d2,e=c.length;b=b.slice(0);for(d2=0;d2<e;d2+=4)b[0]^=4294967295&c[d2],b[1]^=4294967295&c[d2+1],b[2]^=4294967295&c[d2+2],b[3]^=4294967295&c[d2+3],b=sjcl2.mode.gcm.ka(b,a);return b},C:function(a,b,c,d2,e,f){var g,h,k,l,n,m,p2,r,q=sjcl2.bitArray;m=c.length;p2=q.bitLength(c);r=q.bitLength(d2);h=q.bitLength(e);g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=q.concat(e,[1])):(e=sjcl2.mode.gcm.j(g,[0,0,0,0],e),e=sjcl2.mode.gcm.j(g,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl2.mode.gcm.j(g,[0,0,0,0],d2);n=e.slice(0);d2=h.slice(0);a||(d2=sjcl2.mode.gcm.j(g,h,c));for(l=0;l<m;l+=4)n[3]++,k=b.encrypt(n),c[l]^=k[0],c[l+1]^=k[1],c[l+2]^=k[2],c[l+3]^=k[3];c=q.clamp(c,p2);a&&(d2=sjcl2.mode.gcm.j(g,h,c));a=[Math.floor(r/4294967296),r&4294967295,Math.floor(p2/4294967296),p2&4294967295];d2=sjcl2.mode.gcm.j(g,d2,a);k=b.encrypt(e);d2[0]^=k[0];d2[1]^=k[1];d2[2]^=k[2];d2[3]^=k[3];return{tag:q.bitSlice(d2,0,f),data:c}}};sjcl2.misc.hmac=function(a,b){this.W=b=b||sjcl2.hash.sha256;var c=[[],[]],d2,e=b.prototype.blockSize/32;this.w=[new b,new b];a.length>e&&(a=b.hash(a));for(d2=0;d2<e;d2++)c[0][d2]=a[d2]^909522486,c[1][d2]=a[d2]^1549556828;this.w[0].update(c[0]);this.w[1].update(c[1]);this.R=new b(this.w[0])};sjcl2.misc.hmac.prototype.encrypt=sjcl2.misc.hmac.prototype.mac=function(a){if(this.aa)throw new sjcl2.exception.invalid("encrypt on already updated hmac called!");this.update(a);return this.digest(a)};sjcl2.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=false};sjcl2.misc.hmac.prototype.update=function(a){this.aa=true;this.R.update(a)};sjcl2.misc.hmac.prototype.digest=function(){var a=this.R.finalize(),a=new this.W(this.w[1]).update(a).finalize();this.reset();return a};sjcl2.misc.pbkdf2=function(a,b,c,d2,e){c=c||1e4;if(0>d2||0>c)throw new sjcl2.exception.invalid("invalid params to pbkdf2");"string"===typeof a&&(a=sjcl2.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl2.codec.utf8String.toBits(b));e=e||sjcl2.misc.hmac;a=new e(a);var f,g,h,k,l=[],n=sjcl2.bitArray;for(k=1;32*l.length<(d2||1);k++){e=f=a.encrypt(n.concat(b,[k]));for(g=1;g<c;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];l=l.concat(e)}d2&&(l=n.clamp(l,d2));return l};sjcl2.prng=function(a){this.c=[new sjcl2.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=a;this.D=false;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=3e4;this.ba=80};sjcl2.prng.prototype={randomWords:function(a,b){var c=[],d2;d2=this.isReady(b);var e;if(d2===this.u)throw new sjcl2.exception.notReady("generator isn\'t seeded");if(d2&this.J){d2=!(d2&this.I);e=[];var f=0,g;this.Z=e[0]=new Date().valueOf()+this.da;for(g=0;16>g;g++)e.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.m[g],this.m[g]=0,d2||!(this.P&1<<g));g++);this.P>=1<<this.c.length&&(this.c.push(new sjcl2.hash.sha256),this.m.push(0));this.f-=f;f>this.o&&(this.o=f);this.P++;this.b=sjcl2.hash.sha256.hash(this.b.concat(e));this.L=new sjcl2.cipher.aes(this.b);for(d2=0;4>d2&&(this.h[d2]=this.h[d2]+1|0,!this.h[d2]);d2++);}for(d2=0;d2<a;d2+=4)0===(d2+1)%this.ca&&y3(this),e=z2(this),c.push(e[0],e[1],e[2],e[3]);y3(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl2.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=a},addEntropy:function(a,b,c){c=c||"user";var d2,e,f=new Date().valueOf(),g=this.H[c],h=this.isReady(),k=0;d2=this.U[c];void 0===d2&&(d2=this.U[c]=this.ha++);void 0===g&&(g=this.H[c]=0);this.H[c]=(this.H[c]+1)%this.c.length;switch(typeof a){case"number":void 0===b&&(b=1);this.c[g].update([d2,this.N++,1,b,f,1,a|0]);break;case"object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(k=1),c=0;c<a.length&&!k;c++)"number"!==typeof a[c]&&(k=1);if(!k){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e=e>>>1;this.c[g].update([d2,this.N++,2,b,f,a.length].concat(a))}break;case"string":void 0===b&&(b=a.length);this.c[g].update([d2,this.N++,3,b,f,a.length]);this.c[g].update(a);break;default:k=1}if(k)throw new sjcl2.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[g]+=b;this.f+=b;h===this.u&&(this.isReady()!==this.u&&A3("seeded",Math.max(this.o,this.f)),A3("progress",this.getProgress()))},isReady:function(a){a=this.T[void 0!==a?a:this.M];return this.o&&this.o>=a?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=a?this.J|this.u:this.u},getProgress:function(a){a=this.T[a?a:this.M];return this.o>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B2(this,this.ma),mouseCollector:B2(this,this.oa),keyboardCollector:B2(this,this.la),accelerometerCollector:B2(this,this.ea),touchCollector:B2(this,this.qa)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,false),window.addEventListener("mousemove",this.a.mouseCollector,false),window.addEventListener("keypress",this.a.keyboardCollector,false),window.addEventListener("devicemotion",this.a.accelerometerCollector,false),window.addEventListener("touchmove",this.a.touchCollector,false);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl2.exception.bug("can\'t attach event");this.D=true}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,false),window.removeEventListener("mousemove",this.a.mouseCollector,false),window.removeEventListener("keypress",this.a.keyboardCollector,false),window.removeEventListener("devicemotion",this.a.accelerometerCollector,false),window.removeEventListener("touchmove",this.a.touchCollector,false)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=false)},addEventListener:function(a,b){this.K[a][this.ga++]=b},removeEventListener:function(a,b){var c,d2,e=this.K[a],f=[];for(d2 in e)e.hasOwnProperty(d2)&&e[d2]===b&&f.push(d2);for(c=0;c<f.length;c++)d2=f[c],delete e[d2]},la:function(){C3(this,1)},oa:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d2){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,"mouse");C3(this,0)},qa:function(a){a=a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C3(this,0)},ma:function(){C3(this,2)},ea:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C3(this,0)}};function A3(a,b){var c,d2=sjcl2.random.K[a],e=[];for(c in d2)d2.hasOwnProperty(c)&&e.push(d2[c]);for(c=0;c<e.length;c++)e[c](b)}function C3(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy(new Date().valueOf(),b,"loadtime")}function y3(a){a.b=z2(a).concat(z2(a));a.L=new sjcl2.cipher.aes(a.b)}function z2(a){for(var b=0;4>b&&(a.h[b]=a.h[b]+1|0,!a.h[b]);b++);return a.L.encrypt(a.h)}function B2(a,b){return function(){b.apply(a,arguments)}}sjcl2.random=new sjcl2.prng(6);a:try{if(G2="undefined"!==typeof module&&module.exports){try{H2=__require22("crypto")}catch(a){H2=null}G2=E2=H2}if(G2&&E2.randomBytes)D2=E2.randomBytes(128),D2=new Uint32Array(new Uint8Array(D2).buffer),sjcl2.random.addEntropy(D2,1024,"crypto[\'randomBytes\']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F3=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F3);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F3);else break a;sjcl2.random.addEntropy(F3,1024,"crypto[\'getRandomValues\']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}var D2;var E2;var F3;var G2;var H2;sjcl2.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(a,b,c,d2){c=c||{};d2=d2||{};var e=sjcl2.json,f=e.g({iv:sjcl2.random.randomWords(4,0)},e.defaults),g;e.g(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl2.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl2.codec.base64.toBits(f.iv));if(!sjcl2.mode[f.mode]||!sjcl2.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)throw new sjcl2.exception.invalid("json encrypt: invalid parameters");"string"===typeof a?(g=sjcl2.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl2.ecc&&a instanceof sjcl2.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl2.codec.utf8String.toBits(b));"string"===typeof c&&(f.adata=c=sjcl2.codec.utf8String.toBits(c));g=new sjcl2.cipher[f.cipher](a);e.g(d2,f);d2.key=a;f.ct="ccm"===f.mode&&sjcl2.arrayBuffer&&sjcl2.arrayBuffer.ccm&&b instanceof ArrayBuffer?sjcl2.arrayBuffer.ccm.encrypt(g,b,f.iv,c,f.ts):sjcl2.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f},encrypt:function(a,b,c,d2){var e=sjcl2.json,f=e.ja.apply(e,arguments);return e.encode(f)},ia:function(a,b,c,d2){c=c||{};d2=d2||{};var e=sjcl2.json;b=e.g(e.g(e.g({},e.defaults),b),c,true);var f,g;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl2.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl2.codec.base64.toBits(b.iv));if(!sjcl2.mode[b.mode]||!sjcl2.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjcl2.exception.invalid("json decrypt: invalid parameters");"string"===typeof a?(g=sjcl2.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):sjcl2.ecc&&a instanceof sjcl2.ecc.elGamal.secretKey&&(a=a.unkem(sjcl2.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl2.codec.utf8String.toBits(f));g=new sjcl2.cipher[b.cipher](a);f="ccm"===b.mode&&sjcl2.arrayBuffer&&sjcl2.arrayBuffer.ccm&&b.ct instanceof ArrayBuffer?sjcl2.arrayBuffer.ccm.decrypt(g,b.ct,b.iv,b.tag,f,b.ts):sjcl2.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.g(d2,b);d2.key=a;return 1===c.raw?f:sjcl2.codec.utf8String.fromBits(f)},decrypt:function(a,b,c,d2){var e=sjcl2.json;return e.ia(a,e.decode(b),c,d2)},encode:function(a){var b,c="{",d2="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl2.exception.invalid("json encode: invalid property name");c+=d2+\'"\'+b+\'":\';d2=",";switch(typeof a[b]){case"number":case"boolean":c+=a[b];break;case"string":c+=\'"\'+escape(a[b])+\'"\';break;case"object":c+=\'"\'+sjcl2.codec.base64.fromBits(a[b],0)+\'"\';break;default:throw new sjcl2.exception.bug("json encode: unsupported type")}}return c+"}"},decode:function(a){a=a.replace(/\\s/g,"");if(!a.match(/^\\{.*\\}$/))throw new sjcl2.exception.invalid("json decode: this isn\'t json!");a=a.replace(/^\\{|\\}$/g,"").split(/,/);var b={},c,d2;for(c=0;c<a.length;c++){if(!(d2=a[c].match(/^\\s*(?:(["\']?)([a-z][a-z0-9]*)\\1)\\s*:\\s*(?:(-?\\d+)|"([a-z0-9+\\/%*_.@=\\-]*)"|(true|false))$/i)))throw new sjcl2.exception.invalid("json decode: this isn\'t json!");null!=d2[3]?b[d2[2]]=parseInt(d2[3],10):null!=d2[4]?b[d2[2]]=d2[2].match(/^(ct|adata|salt|iv)$/)?sjcl2.codec.base64.toBits(d2[4]):unescape(d2[4]):null!=d2[5]&&(b[d2[2]]="true"===d2[5])}return b},g:function(a,b,c){void 0===a&&(a={});if(void 0===b)return a;for(var d2 in b)if(b.hasOwnProperty(d2)){if(c&&void 0!==a[d2]&&a[d2]!==b[d2])throw new sjcl2.exception.invalid("required parameter overridden");a[d2]=b[d2]}return a},sa:function(a,b){var c={},d2;for(d2 in a)a.hasOwnProperty(d2)&&a[d2]!==b[d2]&&(c[d2]=a[d2]);return c},ra:function(a,b){var c={},d2;for(d2=0;d2<b.length;d2++)void 0!==a[b[d2]]&&(c[b[d2]]=a[b[d2]]);return c}};sjcl2.encrypt=sjcl2.json.encrypt;sjcl2.decrypt=sjcl2.json.decrypt;sjcl2.misc.pa={};sjcl2.misc.cachedPbkdf2=function(a,b){var c=sjcl2.misc.pa,d2;b=b||{};d2=b.iter||1e3;c=c[a]=c[a]||{};d2=c[d2]=c[d2]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl2.random.randomWords(2,0)};c=void 0===b.salt?d2.firstSalt:b.salt;d2[c]=d2[c]||sjcl2.misc.pbkdf2(a,c,b.iter);return{key:d2[c].slice(0),salt:c.slice(0)}};var _HTTPfrontend2=class extends Service2{name="http";fetchProxied=false;listening={};constructor(options,path,fetched){super(options);this.load(this);this.listen(path,fetched)}GET=(url2="http://localhost:8080/ping",type="",mimeType)=>{if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend2.request({method:"GET",url:url2,responseType:type,mimeType,onload:ev2=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url2 instanceof URL)url2=url2.toString();this.setState({[url2]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};POST=(message,url2="http://localhost:8080/echo",type="",mimeType)=>{if(typeof message==="object"&&(type==="json"||type==="text"||!type)){message=JSON.stringify(message)}if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend2.request({method:"POST",url:url2,data:message,responseType:type,mimeType,onload:ev2=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url2 instanceof URL)url2=url2.toString();this.setState({[url2]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};transmit=(message,url2)=>{let obj=message;if(typeof obj==="object"){message=JSON.stringify(obj)}if(obj?.method?.toLowerCase()=="get"||message?.toLowerCase()==="get")return this.GET(url2);return this.POST(message,url2)};transponder=(url2,message,type="",mimeType)=>{if(typeof message==="object")message=JSON.stringify(message);let method="GET";if(message){method="POST"}if(type==="json")mimeType="application/json";else return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend2.request({method,url:url2,data:message,responseType:type,onload:ev2=>{let body=xhr.response;if(typeof body==="string"){let substr=body.substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))body=body.replace(/\\\\/g,"");if(body[0]===\'"\'){body=body.substring(1,body.length-1)};body=JSON.parse(body)}}if(typeof body?.method==="string"){return resolve(this.handleMethod(body.route,body.method,body.args))}else if(typeof body?.route==="string"){return resolve(this.handleServiceMessage(body))}else if(typeof body?.node==="string"||body.node instanceof GraphNode2){return resolve(this.handleGraphNodeCall(body.node,body.args))}else return resolve(body)},onabort:er=>{reject(er)}})}).catch(console.error)};listen=(path="0",fetched=async(clone,args,response)=>{const result=await clone.text();const returned=this.receive(result);this.setState({[response.url]:returned})})=>{this.listening[path]={};let listenerId=`${path}${Math.floor(Math.random()*1e15)}`;this.listening[path][listenerId]=fetched;if(!this.fetchProxied){globalThis.fetch=new Proxy(globalThis.fetch,{apply(fetch2,that,args){const result=fetch2.apply(that,args);result.then(response=>{if(!response.ok)return;if(this.listening["0"]){for(const key in this.listeners){const clone=response.clone();this.listening["0"][key](clone,args,response)}}else{for(const key in this.listening){if(response.url.includes(key)){for(const key2 in this.listening[path]){const clone=response.clone();this.listening[path][key2](clone,args,response)}break}}}}).catch(er=>{console.error(er)});return result}});this.fetchProxied=true}return listenerId};stopListening=(path,listener)=>{if(!path&&path!==0){for(const key in this.listening)delete this.listening[key]}else{if(!listener)delete this.listening[path];else delete this.listening[listener]}}};var HTTPfrontend2=_HTTPfrontend2;__publicField3(HTTPfrontend2,"request",options=>{const xhr=new XMLHttpRequest;if(options.responseType)xhr.responseType=options.responseType;else options.responseType="json";if(options.mimeType){xhr.overrideMimeType(options.mimeType)}if(options.onload)xhr.addEventListener("load",options.onload,false);if(options.onprogress)xhr.addEventListener("progress",options.onprogress,false);if(options.onabort)xhr.addEventListener("abort",options.onabort,false);if(options.onloadend)xhr.addEventListener("loadend",options.onloadend,false);if(options.onerror)xhr.addEventListener("error",options.onerror,false);xhr.open(options.method,options.url,true,options.user,options.pass);if(!options.onerror)xhr.onerror=function(){xhr.abort()};xhr.send(options.data);return xhr});var import_web_worker2=__toESM3(require_browser2());var WorkerService2=class extends Service2{name="worker";workers={};threadRot=0;connections;constructor(options){super();this.connections={workers:this.workers};if(options?.services)this.addServices(options.services);this.load(this);this.setLoaders(this.workerloader);if(options)this.init(options);if(typeof WorkerGlobalScope!=="undefined"&&globalThis instanceof WorkerGlobalScope){this.addDefaultMessageListener()}}loadWorkerRoute=(rt,routeKey)=>{if(rt.workerUrl)rt.url=rt.workerUrl;if(rt.workerId)rt.__node.tag=rt.workerId;if(!rt.__node.tag)rt.__node.tag=routeKey;rt._id=rt.__node.tag;let worker;if(this.workers[rt._id])worker=this.workers[rt._id];else if(rt.worker)worker=rt.worker;if(!worker){worker=this.addWorker(rt)}rt.worker=worker;if(!rt.worker.__ondisconnected){let ondelete=rt2=>{rt2.worker?.terminate()};rt.__addOndisconnected(ondelete)}if(rt.transferFunctions){for(const prop in rt.transferFunctions){this.transferFunction(worker,rt.transferFunctions[prop],prop)}}if(rt.transferClasses){for(const prop in rt.transferClasses){this.transferClass(worker,rt.transferClasses[prop],prop)}}if(worker){if(!rt.__operator){rt.__operator=(...args)=>{if(rt.callback){if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.post(rt.callback,args);else return worker.run(rt.callback,args)}else{if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.send(args);else return worker.request(args)}}}if(rt.init){worker.run(rt.init,rt.initArgs,void 0,rt.initTransfer)}return worker}};workerloader={"workers":(node,parent,graph,roots)=>{let rt=node;if(!node.parentRoute&&(parent?.callback&&parent?.worker))node.parentRoute=parent?.callback;if(rt?.worker||rt?.workerId||rt?.workerUrl){let worker=this.loadWorkerRoute(rt,rt.__node.tag);if(worker){if(!rt.parentRoute&&rt.__parent?.callback)rt.parentRoute=rt.__parent.callback;if(rt.__parent&&!rt.portId){if(typeof rt.__parent==="string"){if(rt.__node.tag!==rt.__parent&&worker._id!==rt.__parent)rt.portId=this.establishMessageChannel(worker,rt.__parent)}else if(rt.__node.tag!==rt.__parent?.__node?.tag&&worker._id!==rt.__parent?.tag){rt.portId=this.establishMessageChannel(worker,rt.__parent.worker)}};if(rt.parentRoute){if(!rt.stopped){if(typeof rt.__parent==="string"&&rt.__parent===worker._id){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else if(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.parentRoute,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id)&&!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent){if(typeof rt.__parent==="string"){if(!rt.stopped){if(rt.__parent===worker._id){worker.run("subscribe",[rt.__parent,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id))worker.workerSubs[rt.__parent+rt.portId]={sub:null,route:worker._id,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent?.__node?.tag&&rt.__parent?.worker){if(!rt.stopped){if(rt.__node.tag===rt.__parent.__node.tag||worker._id===rt.__parent.__node.tag){worker.run("subscribe",[rt.__parent.__node.tag,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent.__node.tag,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent.__node.tag+rt.portId].sub=sub})}if(!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.__parent.__node.tag+rt.portId]={sub:null,route:rt.__parent.__node.tag,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}}}}else if(rt.__parent&&rt.parentRoute){if(typeof rt.__parent==="string"&&roots[rt.__parent]?.worker){roots[rt.__parent].worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}else if(rt.__parent?.worker){rt.__parent.worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}}return rt}};addDefaultMessageListener=()=>{globalThis.onmessage=ev2=>{let result=this.receive(ev2.data);if(this.__node.keepState)this.setState({[this.name]:result})}};postMessage=(message,target,transfer)=>{if(this.workers[target]){this.workers[target].send(message,transfer)}else{globalThis.postMessage(message,target,transfer)}};addWorker=options=>{let worker;if(!options._id)options._id=`worker${Math.floor(Math.random()*1e15)}`;if(options.url)worker=new import_web_worker2.default(options.url);else if(options.port){worker=options.port}else if(this.workers[options._id]){if(this.workers[options._id].port)worker=this.workers[options._id].port;else worker=this.workers[options._id].worker}if(!worker)return;let send=(message,transfer)=>{return this.transmit(message,worker,transfer)};let post=(route,args,method,transfer)=>{let message={route,args};if(method)message.method=method;return this.transmit(message,worker,transfer)};let run=(route,args,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[{route,args},options._id,callbackId]};if(method)req.args[0].method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let request=(message,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,options._id,callbackId]};if(method)req.method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let workerSubs={};let subscribe=(route,callback,args,key,subInput,blocking)=>{return this.subscribeToWorker(route,options._id,callback,args,key,subInput,blocking)};let unsubscribe=(route,sub)=>{return run("unsubscribe",[route,sub])};let start=async(route,portId,callback,blocking)=>{if(route)await run("subscribeToWorker",[route,portId,void 0,callback,blocking]).then(sub=>{if(sub)workerSubs[route+portId]={sub,route,portId,callback,blocking}});else for(const key in workerSubs){if(typeof workerSubs[key].sub!=="number")await run("subscribeToWorker",[workerSubs[key].route,workerSubs[key].portId,void 0,workerSubs[key].callback,void 0,workerSubs[key].blocking]).then(sub=>{workerSubs[key].sub=sub});console.log(JSON.stringify(workerSubs))}return true};let stop=async(route,portId)=>{if(route&&portId&&workerSubs[route+portId]){await run("unsubscribe",[route,workerSubs[route+portId].sub]);workerSubs[route+portId].sub=false}else{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){await run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub]).then(console.log)}workerSubs[key].sub=false}}return true};let terminate=()=>{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub])}workerSubs[key].sub=false}return this.terminate(options._id)};if(!options.onmessage)options.onmessage=ev2=>{this.receive(ev2.data);this.setState({[options._id]:ev2.data})};if(!options.onerror){options.onerror=ev2=>{console.error(ev2.data)}}worker.onmessage=options.onmessage;worker.onerror=options.onerror;this.workers[options._id]={worker,send,post,run,request,subscribe,unsubscribe,terminate,start,stop,postMessage:worker.postMessage,workerSubs,graph:this,...options};return this.workers[options._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=scriptTemplate=>{let blob=new Blob([scriptTemplate],{type:"text/javascript"});return URL.createObjectURL(blob)};getTransferable(message){let transfer;if(typeof message==="object"){if(message.args){if(message.args?.constructor?.name==="Object"){for(const key in message.args){if(ArrayBuffer.isView(message.args[key])){if(!transfer)transfer=[message.args[key].buffer];else transfer.push(message.args[key].buffer)}else if(message.args[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message.args[key]];else transfer.push(message.args[key])}}}else if(Array.isArray(message.args)&&message.args.length<11){message.args.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg?.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message.args)){transfer=[message.args.buffer]}else if(message.args?.constructor?.name==="ArrayBuffer"){transfer=[message]}}else if(message?.constructor?.name==="Object"){for(const key in message){if(ArrayBuffer.isView(message[key])){if(!transfer)transfer=[message[key].buffer];else transfer.push(message[key].buffer)}else if(message[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message[key]];else transfer.push(message[key])}}}else if(Array.isArray(message)&&message.length<11){message.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message)){transfer=[message.buffer]}else if(message.constructor?.name==="ArrayBuffer"){transfer=[message]}}return transfer}transmit=(message,worker,transfer)=>{if(!transfer){transfer=this.getTransferable(message)}if(worker instanceof import_web_worker2.default||worker instanceof MessagePort){worker.postMessage(message,transfer)}else if(typeof worker==="string"){if(this.workers[worker]){if(this.workers[worker].port)this.workers[worker].port.postMessage(message,transfer);else if(this.workers[worker].worker)this.workers[worker].worker.postMessage(message,transfer)}}else{let keys22=Object.keys(this.workers);this.workers[keys22[this.threadRot]].worker.postMessage(message,transfer);this.threadRot++;if(this.threadRot===keys22.length)this.threadRot=0}return message};terminate=worker=>{let onclose;if(typeof worker==="string"){let obj=this.workers[worker];if(obj){delete this.workers[worker];worker=obj.worker;if(obj.onclose)onclose=obj.onclose}}else if(typeof worker==="object"){if(worker?._id){worker=worker.worker;delete this.workers[worker?._id]}}if(worker instanceof import_web_worker2.default){worker.terminate();if(onclose)onclose(worker);return true}if(worker instanceof MessagePort){worker.close();if(onclose)onclose(worker);return true}return false};establishMessageChannel=(worker,worker2)=>{let workerId;if(typeof worker==="string"){workerId=worker;if(this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker2=this.workers[worker].worker}}else if(worker?.worker){worker=worker.worker}if(typeof worker2==="string"){if(this.workers[worker2]){if(this.workers[worker2].port)worker2=this.workers[worker2].port;else worker2=this.workers[worker2].worker}}else if(worker2?.worker){worker2=worker2.worker}if(worker instanceof import_web_worker2.default||worker instanceof MessagePort){let channel=new MessageChannel;let portId=`port${Math.floor(Math.random()*1e15)}`;worker.postMessage({route:"addWorker",args:{port:channel.port1,_id:portId}},[channel.port1]);if(worker2 instanceof import_web_worker2.default||worker2 instanceof MessagePort){worker2.postMessage({route:"addWorker",args:{port:channel.port2,_id:portId}},[channel.port2])}else if(workerId&&this.workers[workerId]){channel.port2.onmessage=this.workers[workerId].onmessage;this.workers[workerId].port=channel.port2}return portId}return false};request=(message,workerId,transfer,method)=>{let worker=this.workers[workerId].worker;return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,callbackId]};if(method)req.method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};runRequest=(message,worker,callbackId)=>{let res=this.receive(message);if(typeof worker==="string"&&this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}if(res instanceof Promise){res.then(r=>{if(worker instanceof import_web_worker2.default||worker instanceof MessagePort)worker.postMessage({args:r,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:r,callbackId})})}else{if(worker instanceof import_web_worker2.default||worker instanceof MessagePort)worker.postMessage({args:res,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:res,callbackId})}return res};subscribeWorker=(route,worker,args,key,subInput,blocking)=>{let callback;if(blocking){let blocked=false;callback=res=>{if(!blocked){blocked=true;if(res instanceof Promise){res.then(r=>{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,r]).then(ret=>{blocked=false})})}else{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,res]).then(ret=>{blocked=false})}}}}else{callback=res=>{if(res instanceof Promise){res.then(r=>{if(worker?.postMessage)worker.postMessage({args:r,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:r,callbackId:route})})}else{if(worker?.postMessage)worker.postMessage({args:res,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:res,callbackId:route})}}}if(!blocking&&worker?.port){worker=worker.port}else if(!blocking&&worker?.worker){worker=worker.worker}else if(typeof worker==="string"&&this.workers[worker]){if(blocking)worker=this.workers[worker];else if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}return this.subscribe(route,callback,args,key,subInput)};subscribeToWorker=(route,workerId,callback,args,key,subInput,blocking)=>{if(typeof workerId==="string"&&this.workers[workerId]){this.__node.state.subscribeEvent(workerId,res=>{if(res?.callbackId===route){if(!callback)this.setState({[workerId]:res.args});else if(typeof callback==="string"){this.run(callback,res.args)}else callback(res.args)}});return this.workers[workerId].run("subscribeWorker",[route,workerId,args,key,subInput,blocking])}};triggerSubscription=async(route,workerId,result)=>{if(this.__node.state.triggers[workerId])for(let i22=0;i22<this.__node.state.triggers[workerId].length;i22++){await this.__node.state.triggers[workerId][i22].onchange({args:result,callbackId:route})}return true};pipeWorkers=(sourceWorker,listenerWorker,sourceRoute,listenerRoute,portId,args,key,subInput,blocking)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof listenerWorker==="string")listenerWorker=this.workers[listenerWorker];if(!portId){portId=this.establishMessageChannel(sourceWorker.worker,listenerWorker.worker)}return listenerWorker.run("subscribeToWorker",[sourceRoute,portId,listenerRoute,args,key,subInput,blocking])};unpipeWorkers=(sourceRoute,sourceWorker,sub)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof sourceWorker==="object"){return sourceWorker.run("unsubscribe",[sourceRoute,sub])}}};var mouseEventHandler2=makeSendPropertiesHandler2(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]);var wheelEventHandlerImpl2=makeSendPropertiesHandler2(["deltaX","deltaY"]);var keydownEventHandler2=makeSendPropertiesHandler2(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function focusEventHandler2(event,sendFn){const data={type:event.type};data.isTrusted=event.isTrusted;data.bubbles=event.bubbles;data.cancelBubble=event.cancelBubble;data.cancelable=event.cancelable;data.composed=event.composed;data.defaultPrevent=event.defaultPrevented;data.eventPhase=event.eventPhase;data.returnValue=event.returnValue;data.currentTarget=event.currentTarget.id?event.currentTarget.id:event.currentTarget.constructor.name;data.target=data.currentTarget;data.srcElement=data.currentTarget;sendFn(data)}function wheelEventHandler2(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();wheelEventHandlerImpl2(event,sendFn)}function preventDefaultHandler2(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault()}function copyProperties2(src,properties,dst){for(const name2 of properties){dst[name2]=src[name2]}}function makeSendPropertiesHandler2(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties2(event,properties,data);sendFn(data)}}function touchEventHandler2(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();const touches=[];const data={type:event.type,touches};for(let i22=0;i22<event.touches.length;++i22){const touch=event.touches[i22];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var i2=1;var keys2={};while(i2<222){keys2[i2]=true;i2++}function filteredKeydownEventHandler2(event,sendFn,preventDefault){let{keyCode}=event;if(keys2[keyCode]){if(preventDefault&&event.preventDefault&&(keyCode<110||keyCode>123))event.preventDefault();keydownEventHandler2(event,sendFn)}}var eventHandlers2={contextmenu:preventDefaultHandler2,mousedown:mouseEventHandler2,mousemove:mouseEventHandler2,mouseup:mouseEventHandler2,pointerdown:mouseEventHandler2,pointermove:mouseEventHandler2,pointerup:mouseEventHandler2,pointerlockchange:mouseEventHandler2,webkitpointerlockchange:mouseEventHandler2,focus:focusEventHandler2,blur:focusEventHandler2,pointerout:mouseEventHandler2,touchstart:touchEventHandler2,touchmove:touchEventHandler2,touchend:touchEventHandler2,wheel:wheelEventHandler2,keydown:filteredKeydownEventHandler2,keyup:filteredKeydownEventHandler2};function initProxyElement2(element,worker,id,preventDefault){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{if(!worker){handleProxyEvent2(data,id)}else worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers2);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent,preventDefault)})}if(eventHandlers2.keydown){globalThis.addEventListener("keydown",function(ev2){eventHandlers2.keydown(ev2,sendEvent,preventDefault)})}if(eventHandlers2.keyup){globalThis.addEventListener("keyup",function(ev2){eventHandlers2.keyup(ev2,sendEvent,preventDefault)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher2=class{__listeners;addEventListener(type,listener){if(this.__listeners===void 0)this.__listeners={};const listeners=this.__listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this.__listeners===void 0)return false;const listeners=this.__listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i22=0,l=array.length;i22<l;i22++){array[i22].call(this,event)}}}};function noop2(){}var ElementProxyReceiver2=class extends EventDispatcher2{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super();this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.style.width=this.width+"px";this.proxied.style.height=this.height+"px";this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop2;data.stopPropagation=noop2;this.dispatchEvent(data,this.proxied)};focus(){}blur(){}};var ProxyManager2=class{targets={};constructor(){if(!globalThis.document)globalThis.document={elementFromPoint:(...args)=>{return this.targets[Object.keys(this.targets)[0]].proxied}}}makeProxy=(id,addTo=void 0)=>{if(!id)id=`proxyReceiver${Math.floor(Math.random()*1e15)}`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver2;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;if(typeof WorkerGlobalScope!=="undefined")addTo.style=proxy.style;if(proxy.width){addTo.style.width=proxy.width+"px";addTo.clientWidth=proxy.width}if(proxy.height){addTo.style.height=proxy.height+"px";addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy);addTo.blur=proxy.blur.bind(proxy)}};getProxy=id=>{return this.targets[id]};handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0}};function makeProxy2(id,elm){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager2;this.__node.graph.ProxyManager.makeProxy(id,elm)}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager2;globalThis.ProxyManager.makeProxy(id,elm)}return id}function handleProxyEvent2(data,id){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager2;if(this.__node.graph.ProxyManager.handleEvent(data,id))return data}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager2;if(globalThis.ProxyManager.handleEvent(data,id))return data}}var proxyElementWorkerRoutes2={initProxyElement:initProxyElement2,makeProxy:makeProxy2,handleProxyEvent:handleProxyEvent2};function Renderer2(options){if(options.worker){let worker=options.worker;let route=options.route;if(worker instanceof Blob||typeof worker==="string"){worker=new Worker(worker)}delete options.worker;delete options.route;return transferCanvas2(worker,options,route)}else{initProxyElement2(options.canvas,void 0,options._id,options.preventDefault);return setupCanvas2(options)}}function transferCanvas2(worker,options,route){if(!options)return void 0;if(!options._id)options._id=`canvas${Math.floor(Math.random()*1e15)}`;let offscreen=options.canvas.transferControlToOffscreen();if(!options.width)options.width=options.canvas.clientWidth;if(!options.height)options.height=options.canvas.clientHeight;let message={route:route?route:"setupCanvas",args:{...options,canvas:offscreen}};if(this?.__node?.graph)this.__node.graph.run("initProxyElement",options.canvas,worker,options._id,options.preventDefault);else initProxyElement2(options.canvas,worker,options._id,options.preventDefault);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let tr=[offscreen];if(options.transfer){tr.push(...options.transfer);delete options.transfer}worker.postMessage(message,tr);const canvascontrols={_id:options._id,width:options.width,height:options.height,worker,draw:(props,transfer)=>{worker.postMessage({route:"drawFrame",args:[props,options._id]},transfer)},update:(props,transfer)=>{worker.postMessage({route:"updateCanvas",args:[props,options._id]},transfer)},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:(newDrawProps,transfer)=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]},transfer)},terminate:()=>{worker.terminate()}};return canvascontrols}function setDraw2(settings,_id){let canvasopts;if(this?.__node?.graph){if(_id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]}else{if(_id)canvasopts=globalThis.CANVASES?.[settings._id];else if(settings._id)canvasopts=globalThis.CANVASES?.[settings._id];else canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]]}if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasopts._id,canvasopts.canvas);else proxyElementWorkerRoutes2.makeProxy(canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText32(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw.bind(settings)}if(typeof settings.update==="string")settings.update=parseFunctionFromText32(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update.bind(settings)}if(typeof settings.init==="string")settings.init=parseFunctionFromText32(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init.bind(settings)}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText32(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear.bind(settings)}return settings._id}return void 0}function setupCanvas2(options){if(this?.__node?.graph){if(!this.__node.graph.CANVASES)this.__node.graph.CANVASES={}}else if(!globalThis.CANVASES)globalThis.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=`canvas${Math.floor(Math.random()*1e15)}`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this?.__node?.graph?.CANVASES[canvasOptions._id]){this.__node.graph.run("setDraw",canvasOptions)}else if(globalThis.CANVASES?.[canvasOptions._id]){setDraw2(canvasOptions)}else{if(this?.__node?.graph){canvasOptions.graph=this.__node.graph;if(!canvasOptions.__node){canvasOptions.__node={}}if(!canvasOptions.__node.tag)canvasOptions.__node.tag=canvasOptions._id;canvasOptions=this.__node.graph.add(canvasOptions);canvasOptions.__addOndisconnected=()=>{canvasOptions.stop();delete this.__node.graph.CANVASES[canvasOptions._id]}}if(this?.__node?.graph)this.__node.graph.CANVASES[canvasOptions._id]=canvasOptions;else globalThis.CANVASES[canvasOptions._id]=canvasOptions;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);else proxyElementWorkerRoutes2.makeProxy(canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText32(canvasOptions.draw)}else if(typeof canvasOptions.draw==="function"){canvasOptions.draw=canvasOptions.draw.bind(canvasOptions)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText32(canvasOptions.update)}else if(typeof canvasOptions.update==="function"){canvasOptions.update=canvasOptions.update.bind(canvasOptions)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText32(canvasOptions.init)}else if(typeof canvasOptions.init==="function"){canvasOptions.init=canvasOptions.init.bind(canvasOptions)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText32(canvasOptions.clear)}else if(typeof canvasOptions.clear==="function"){canvasOptions.clear=canvasOptions.clear.bind(canvasOptions)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);canvasOptions.stop=()=>{stopAnim2(canvasOptions._id)};canvasOptions.start=draw=>{startAnim2(canvasOptions._id,draw)};canvasOptions.set=settings=>{setDraw2(settings,canvasOptions._id)};if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)return canvasOptions._id;else{const canvascontrols={_id:options._id,width:options.width,height:options.height,draw:props=>{drawFrame2(props,options._id)},update:props=>{updateCanvas2(props,options._id)},clear:()=>{clearCanvas2(options._id)},init:()=>{initCanvas2(options._id)},stop:()=>{stopAnim2(options._id)},start:()=>{startAnim2(options._id)},set:newDrawProps=>{setDraw2(newDrawProps,options._id)},terminate:()=>{if(this.__node?.graph)this.__node.graph.remove(options._id);else{stopAnim2(options._id);if(this?.__node?.graph)delete this.__node.graph.CANVASES[canvasOptions._id];else delete globalThis.CANVASES[canvasOptions._id]}}};return canvascontrols}}function drawFrame2(props,_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0}function clearCanvas2(_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function initCanvas2(_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function updateCanvas2(input,_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0}function setProps2(props,_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0}function startAnim2(_id,draw){let canvasopts=getCanvas2.call(this,_id);canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText32(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function stopAnim2(_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")requestAnimationFrame(canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context));return _id}return void 0}function getCanvas2(_id){let canvasopts;if(this?.__node?.graph){if(!_id)canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]];else canvasopts=this.__node.graph.CANVASES?.[_id]}else{if(!_id)canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]];else canvasopts=globalThis.CANVASES?.[_id]}return canvasopts}var workerCanvasRoutes2={...proxyElementWorkerRoutes2,Renderer:Renderer2,transferCanvas:transferCanvas2,setupCanvas:setupCanvas2,setDraw:setDraw2,drawFrame:drawFrame2,clearCanvas:clearCanvas2,initCanvas:initCanvas2,updateCanvas:updateCanvas2,setProps:setProps2,startAnim:startAnim2,stopAnim:stopAnim2,getCanvas:getCanvas2};function parseFunctionFromText32(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var str3=String(`(()=>{var __require=(x=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(x,{get:(a,b)=>(typeof require!=="undefined"?require:a)[b]}):x)(function(x){if(typeof require!=="undefined")return require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x+\'" is not supported\')});var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __require2=(x=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x)(function(x){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x+\'" is not supported\')});var __commonJS=(cb,mod)=>function __require22(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:true}):target,mod));var __publicField=(obj,key,value)=>{__defNormalProp(obj,typeof key!=="symbol"?key+"":key,value);return value};var require_browser=__commonJS({"node_modules/web-worker/cjs/browser.js"(exports,module2){module2.exports=Worker}});var EventHandler=class{data={};triggers={};ctr=0;constructor(data){if(typeof data==="object")this.data=data}setState=updateObj=>{Object.assign(this.data,updateObj);let props=Object.getOwnPropertyNames(updateObj);for(const prop of props){this.triggerEvent(prop,this.data[prop])}if(this.triggers[statesubKey]){let run=fn=>{fn(updateObj)};const l=this.triggers[statesubKey].length;for(let i2=l-1;i2>=0;i2--){run(this.triggers[statesubKey][i2].onchange)}}return this.data};setValue=(key,value)=>{this.data[key]=value;this.triggerEvent(key,value)};triggerEvent=(key,value)=>{if(this.triggers[key]){let fn=obj=>{obj.onchange(value)};const l=this.triggers[key].length;for(let i2=l-1;i2>=0;i2--){fn(this.triggers[key][i2])}}};subscribeState=onchange=>{return this.subscribeEvent(statesubKey,onchange)};unsubscribeState=sub=>{return this.unsubscribeEvent(statesubKey,sub)};subscribeEvent=(key,onchange,refObject,refKey)=>{if(key){if(refObject&&refKey&&!this.triggers[key]){Object.defineProperty(this.data,key,{get:()=>{return refObject[refKey]},set:value=>{refObject[refKey]=value},enumerable:true,configurable:true})}if(!this.triggers[key]){this.triggers[key]=[]}let l=this.ctr;this.ctr++;this.triggers[key].push({sub:l,onchange});return l}else return void 0};unsubscribeEvent=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(sub===void 0){delete this.triggers[key];delete this.data[key]}else{let idx=void 0;let obj=triggers.find((o,i2)=>{if(o.sub===sub){idx=i2;return true}});if(obj)triggers.splice(idx,1);if(Object.keys(triggers).length===0){delete this.triggers[key];delete this.data[key]}if(this.onRemoved)this.onRemoved(obj);return true}}};subscribeEventOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeEvent(key,sub)};sub=this.subscribeEvent(key,changed);return sub};getEvent=(key,sub)=>{for(const s in this.triggers[key]){if(this.triggers[key][s].sub===sub)return this.triggers[key][s]}};getSnapshot=()=>{const snapshot={};for(const key in this.data){snapshot[key]=this.data[key]}};onRemoved};var statesubKey="*s";var state=new EventHandler;var GraphNode=class{__node={tag:\\`node\\${Math.floor(Math.random()*1e15)}\\`,unique:\\`\\${Math.floor(Math.random()*1e15)}\\`,state};__children;__parent;__operator;__listeners;__props;__args;constructor(properties,parent,graph){this.__setProperties(properties,parent,graph)}__setProperties=(properties,parent,graph)=>{let enforceProperties=()=>{let orig=properties;if(typeof properties==="function"){if(isNativeClass(properties)){properties=new properties}else properties={__operator:properties,__node:{forward:true,tag:properties.name}}}else if(typeof properties==="string"){if(graph?.get(properties)){properties=graph.get(properties)}}if(!("__node"in properties))properties.__node={};if(!properties.__node.initial)properties.__node.initial=orig};enforceProperties();if(typeof properties==="object"){let assignState=()=>{if(properties.__node?.state)this.__node.state=properties.__node.state;else if(graph){properties.__node.state=graph.__node.state}};let setProps2=()=>{if(properties.__props){if(typeof properties.__props==="function")properties.__props=new properties.__props;if(typeof properties.__props==="object"){this.__proxyObject(properties.__props)}}};let setTag=()=>{if(!properties.__node.tag){if(properties.__operator?.name)properties.__node.tag=properties.__operator.name;else properties.__node.tag=\\`node\\${Math.floor(Math.random()*1e15)}\\`}};let setNode=()=>{if(typeof properties.__node==="string"){if(graph?.get(properties.__node.tag)){properties=graph.get(properties.__node.tag)}else properties.__node={}}else if(!properties.__node)properties.__node={};if(graph){properties.__node.graph=graph}if(properties instanceof Graph)properties.__node.source=properties};let setParent=()=>{if(!properties.__parent&&parent)properties.__parent=parent;if(parent?.__node&&!(parent instanceof Graph||properties instanceof Graph))properties.__node.tag=parent.__node.tag+"."+properties.__node.tag;if(parent instanceof Graph&&properties instanceof Graph){if(properties.__node.loaders)Object.assign(parent.__node.loaders?parent.__node.loaders:{},properties.__node.loaders);if(parent.__node.mapGraphs){properties.__node.nodes.forEach(n=>{parent.set(properties.__node.tag+"."+n.__node.tag,n)});let ondelete=()=>{properties.__node.nodes.forEach(n=>{parent.__node.nodes.delete(properties.__node.tag+"."+n.__node.tag)})};this.__addOndisconnected(ondelete)}}};let setOp=()=>{if(typeof properties.default==="function"&&!properties.__operator){properties.__operator=properties.default}if(properties.__operator){if(typeof properties.__operator==="string"){if(graph){let n=graph.get(properties.__operator);if(n)properties.__operator=n.__operator;if(!properties.__node.tag&&properties.__operator.name)properties.__node.tag=properties.__operator.name}}if(typeof properties.__operator==="function")properties.__operator=this.__setOperator(properties.__operator);if(properties.default)properties.default=properties.__operator}};let assignProps=()=>{properties.__node=Object.assign(this.__node,properties.__node);let keys2=Object.getOwnPropertyNames(properties).filter(v=>{if(!objProps[v])return true});for(const key of keys2){if(key in properties)this[key]=properties[key]}};let bindCallbacks=()=>{if(this.__onconnected){if(typeof this.__onconnected==="function"){this.__onconnected=this.__onconnected.bind(this)}else if(Array.isArray(this.__onconnected)){this.__onconnected=this.__onconnected.map(f=>{return f.bind(this)})}if(typeof this.__ondisconnected==="function"){this.__ondisconnected=this.__ondisconnected.bind(this)}else if(Array.isArray(this.__ondisconnected)){this.__ondisconnected=this.__ondisconnected.map(f=>{return f.bind(this)})}}};assignState();setTag();setProps2();setNode();setParent();assignProps();bindCallbacks();setOp()}};__subscribe=(callback,key,subInput,target,tkey,args)=>{const subscribeToFunction=(k,setTarget=(callback2,target2)=>target2?target2:callback2,triggerCallback=callback)=>{let wrappedArgs;if(args){let wrapped=wrapArgs(triggerCallback,args,this.__node.graph);triggerCallback=wrapped.__callback;wrappedArgs=wrapped.__args}let sub=this.__node.state.subscribeEvent(k,triggerCallback,this,key);let trigger=this.__node.state.getEvent(k,sub);if(!this.__listeners)this.__listeners={};this.__listeners[k]=this.__node.state.triggers[k];if(!trigger)return sub;trigger.source=this.__node.tag;if(key)trigger.key=key;trigger.target=setTarget(callback,target);if(subInput)trigger.subInput=subInput;if(args){trigger.arguments=args;trigger.__args=wrappedArgs}if(tkey)trigger.tkey=tkey;trigger.node=this;trigger.graph=this.__node.graph;return sub};const subscribeToGraph=callback2=>{let fn=this.__node.graph.get(callback2);if(!fn&&callback2.includes(".")){target=callback2.substring(0,callback2.lastIndexOf("."));let n=this.__node.graph.get(callback2.substring(0,target));tkey=callback2.lastIndexOf(".")+1;if(n&&typeof n[key]==="function")callback2=(...args2)=>{return n[tkey](...args2)}}else if(fn.__operator){callback2=fn.__operator;tkey="__operator"}};if(key){if(!this.__node.localState||!this.__node.localState[key]){this.__addLocalState(this,key)}if(typeof callback==="string"){tkey=callback;if(target){if(this.__node.graph?.get(target)){let n=this.__node.graph?.get(target);if(typeof n[callback]==="function"){let fn=n[callback];callback=(...inp)=>{fn(...inp)}}else{let k2=callback;let setter=inp=>{n[k2]=inp};callback=setter}}}else if(typeof this[callback]==="function"){let fn=this[callback];callback=(...inp)=>{fn(...inp)}}else if(this.__node.graph?.get(callback))subscribeToGraph(callback);if(typeof callback!=="function")return void 0}let sub;let k=subInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node)sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)});return sub}else{if(typeof callback==="string"){if(this.__node.graph.get(callback))callback=this.__node.graph.get(callback);tkey="__operator";if(typeof callback!=="object")return void 0}let sub;let k=subInput?this.__node.unique+"input":this.__node.unique;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node){sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)})}return sub}};__unsubscribe=(sub,key,unsubInput)=>{if(key){return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key,sub)}else return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"input":this.__node.unique,sub)};__setOperator=fn=>{fn=fn.bind(this);if(this.__args&&this.__node.graph){fn=wrapArgs(fn,this.__args,this.__node.graph).__callback}let inpstr=\\`\\${this.__node.unique}input\\`;this.__operator=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[this.__node.unique]){if(typeof result?.then==="function"){result.then(res=>{if(res!==void 0)this.__node.state.setValue(this.__node.unique,res)}).catch(console.error)}else if(result!==void 0)this.__node.state.setValue(this.__node.unique,result)}return result};if(this.__parent instanceof GraphNode&&!this.__subscribedToParent){if(this.__parent.__operator){let sub=this.__parent.__subscribe(this);let ondelete=()=>{this.__parent?.__unsubscribe(sub);delete this.__subscribedToParent};this.__addOndisconnected(ondelete);this.__subscribedToParent=true}}return this.__operator};__addLocalState=(props,key)=>{if(!props)return;if(!this.__node.localState){this.__node.localState={}}const localState=this.__node.localState;const initState=(props2,k)=>{let str2=this.__node.unique+"."+k;let inpstr=\\`\\${str2}input\\`;let get,set;let obj,descriptor;if(typeof props2[k]==="function"&&k!=="__operator"){if(this.__props?.[k]){obj=this.__props}else{obj=localState}get=()=>{return obj[k]};set=fn=>{if(!this.__props?.[k])fn=fn.bind(this);obj[k]=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[str2]){if(typeof result?.then==="function"){result.then(res=>{this.__node.state.triggerEvent(str2,res)}).catch(console.error)}else this.__node.state.triggerEvent(str2,result)}return result}};localState[k]=props2[k].bind(this);descriptor={get,set,enumerable:true,configurable:true}}else{let get2,set2;let obj2;if(this.__props?.[k]){obj2=this.__props}else{obj2=localState}get2=()=>{return obj2[k]};set2=v=>{obj2[k]=v;if(this.__node.state.triggers[str2])this.__node.state.triggerEvent(str2,v)};localState[k]=props2[k];descriptor={get:get2,set:set2,enumerable:true,configurable:true}}Object.defineProperty(props2,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}};if(key)initState(props,key);else{for(let k in props){initState(props,k)}}};__proxyObject=obj=>{const allProps=getAllProperties(obj);for(const k of allProps){const descriptor={get:()=>{return obj[k]},set:value=>{obj[k]=value},enumerable:true,configurable:true};Object.defineProperty(this,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}}};__addOnconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__onconnected)){this.__onconnected.push(callback)}else if(typeof this.__onconnected==="function"){this.__onconnected=[callback,this.__onconnected]}else this.__onconnected=callback}__addOndisconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__ondisconnected)){this.__ondisconnected.push(callback)}else if(typeof this.__ondisconnected==="function"){this.__ondisconnected=[callback,this.__ondisconnected]}else this.__ondisconnected=callback}__callConnected(node=this){if(typeof this.__onconnected==="function"){this.__onconnected(this)}else if(Array.isArray(this.__onconnected)){let fn=o=>{o(this)};this.__onconnected.forEach(fn)}}__callDisconnected(node=this){if(typeof this.__ondisconnected==="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let fn=o=>{o(this)};this.__ondisconnected.forEach(fn)}}};var Graph=class{__node={tag:\\`graph\\${Math.floor(Math.random()*1e15)}\\`,unique:\\`\\${Math.random()}\\`,nodes:new Map,state,roots:{}};constructor(options){this.init(options)}init=options=>{if(options){let cpy=Object.assign({},options);delete cpy.roots;recursivelyAssign(this.__node,cpy);if(options.roots)this.load(options.roots)}};load=roots=>{function recursivelyAssignChildren(target,obj,inChildren=true,top=true){if(top){if(target)Object.assign(target,obj);else target=Object.assign({},obj);recursivelyAssignChildren(target,obj,true,false)}if(obj?.__children&&!inChildren){if(obj.__children?.constructor.name==="Object"){if(target.__children?.constructor.name==="Object")recursivelyAssignChildren(target.__children,obj.__children,true,false);else target.__children=recursivelyAssignChildren({},obj.__children,true,false)}else{target.__children=obj.__children}}else if(inChildren){for(const key in obj){target[key]=Object.assign({},obj[key]);if(obj[key]?.__children){recursivelyAssignChildren({},obj[key].__children,false,false)}}}return target}this.__node.roots=recursivelyAssignChildren(this.__node.roots?this.__node.roots:{},roots);let cpy=Object.assign({},roots);if(cpy.__node)delete cpy.__node;let listeners=this.recursiveSet(cpy,this,void 0,roots);if(roots.__node){if(!roots.__node.tag)roots.__node._tag=\\`roots\\${Math.floor(Math.random()*1e15)}\\`;else if(!this.get(roots.__node.tag)){let node=new GraphNode(roots,this,this);this.set(node.__node.tag,node);this.runLoaders(node,this,roots,roots.__node.tag);if(node.__listeners){listeners[node.__node.tag]=node.__listeners}}}else if(roots.__listeners){this.setListeners(roots.__listeners)}this.setListeners(listeners);return cpy};setLoaders=(loaders2,replace)=>{if(replace)this.__node.loaders=loaders2;else Object.assign(this.__node.loaders,loaders2);return this.__node.loaders};runLoaders=(node,parent,properties,key)=>{for(const l in this.__node.loaders){if(typeof this.__node.loaders[l]==="object"){if(this.__node.loaders[l].init)this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key);if(this.__node.loaders[l].connected)node.__addOnconnected(this.__node.loaders[l].connect);if(this.__node.loaders[l].disconnected)node.__addOndisconnected(this.__node.loaders[l].disconnect)}else if(typeof this.__node.loaders[l]==="function")this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key)}};add=(properties,parent)=>{let listeners={};if(typeof parent==="string")parent=this.get(parent);let instanced;if(typeof properties==="function"){if(isNativeClass(properties)){if(properties.prototype instanceof GraphNode){properties=properties.prototype.constructor(properties,parent,this);instanced=true}else properties=new properties}else properties={__operator:properties}}else if(typeof properties==="string"){properties=this.__node.roots[properties]}if(!properties)return;if(!instanced){let keys2=Object.getOwnPropertyNames(properties);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(properties));keys2.push(...nonArrowFunctions);keys2=keys2.filter(v=>!objProps.includes(v));let cpy={};for(const key of keys2){cpy[key]=properties[key]}properties=cpy}if(!properties.__node)properties.__node={};properties.__node.initial=properties;if(typeof properties==="object"&&!this.get(properties.__node.tag)){let node;let root=recursivelyAssign({},properties,2);if(instanced)node=properties;else node=new GraphNode(properties,parent,this);this.set(node.__node.tag,node);this.runLoaders(node,parent,properties,node.__node.tag);this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key in node.__listeners){let listener=node.__listeners[key];if(node[key]){delete listeners[node.__node.tag][key];listeners[node.__node.tag][node.__node.tag+"."+key]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][key]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][key]=parent.__node.tag}}}}this.setListeners(listeners);node.__callConnected();return node}else if(properties.__node.tag)return this.get(properties.__node.tag)};recursiveSet=(t2,parent,listeners={},origin)=>{let keys2=Object.getOwnPropertyNames(origin);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(origin)).filter(v=>!objProps.includes(v));keys2.push(...nonArrowFunctions);for(const key of keys2){if(key.includes("__"))continue;let p=origin[key];if(Array.isArray(p))continue;let instanced;if(typeof p==="function"){if(isNativeClass(p)){p=new p;if(p instanceof GraphNode){p=p.prototype.constructor(p,parent,this);instanced=true}}else p={__operator:p}}else if(typeof p==="string"){if(this.__node.nodes.get(p))p=this.__node.nodes.get(p);else p=this.__node.roots[p]}else if(typeof p==="boolean"){if(this.__node.nodes.get(key))p=this.__node.nodes.get(key);else p=this.__node.roots[key]}if(p instanceof Object){if(!instanced&&!(p instanceof GraphNode)){let ks=Object.getOwnPropertyNames(p);let nonArrowFunctions2=Object.getOwnPropertyNames(Object.getPrototypeOf(p));nonArrowFunctions2.splice(nonArrowFunctions2.indexOf("constructor"),1);ks.push(...nonArrowFunctions2);let cpy={};for(const key2 of ks){cpy[key2]=p[key2]}p=cpy}if(!p.__node)p.__node={};if(!p.__node.tag)p.__node.tag=key;if(!p.__node.initial)p.__node.initial=t2[key];if(this.get(p.__node.tag)&&!(!(parent instanceof Graph)&&parent?.__node)||parent?.__node&&this.get(parent.__node.tag+"."+p.__node.tag))continue;let node;let newnode=false;let root=recursivelyAssign({},p,2);if(instanced||p instanceof GraphNode){node=p}else{node=new GraphNode(p,parent,this);newnode=true}if(!newnode&&p instanceof GraphNode&&!instanced&&parent instanceof GraphNode){let sub=this.subscribe(parent.__node.tag,node.__node.tag);let ondelete=node2=>{this.unsubscribe(parent.__node.tag,sub)};node.__addOndisconnected(ondelete)}else if(node){this.set(node.__node.tag,node);this.runLoaders(node,parent,t2[key],key);t2[key]=node;this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key2 in node.__listeners){let listener=node.__listeners[key2];let k=key2;if(node[key2]){delete listeners[node.__node.tag][key2];k=node.__node.tag+"."+key2;listeners[node.__node.tag][k]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][k]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][k]=parent.__node.tag}}}}node.__callConnected()}}}return listeners};remove=(node,clearListeners=true)=>{this.unsubscribe(node);if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){this.delete(node.__node.tag);delete this.__node.roots[node.__node.tag];if(clearListeners){this.clearListeners(node)}node.__callDisconnected();const recursiveRemove=t2=>{for(const key in t2){this.unsubscribe(t2[key]);this.delete(t2[key].__node.tag);delete this.__node.roots[t2[key].__node.tag];this.delete(key);delete this.__node.roots[key];t2[key].__node.tag=t2[key].__node.tag.substring(t2[key].__node.tag.lastIndexOf(".")+1);if(clearListeners){this.clearListeners(t2[key])}t2[key].__callDisconnected();if(t2[key].__children){recursiveRemove(t2[key].__children)}}};if(node.__children){recursiveRemove(node.__children)}}if(node?.__node.tag&&node?.__parent){delete node?.__parent;node.__node.tag=node.__node.tag.substring(node.__node.tag.indexOf(".")+1)}if(node?.__node.graph)node.__node.graph=void 0;return node};run=(node,...args)=>{if(typeof node==="string"){let nd=this.get(node);if(!nd&&node.includes(".")){nd=this.get(node.substring(0,node.lastIndexOf(".")));if(typeof nd?.[node.substring(node.lastIndexOf(".")+1)]==="function")return nd[node.substring(node.lastIndexOf(".")+1)](...args)}else if(nd?.__operator)return nd.__operator(...args)}if(node?.__operator){return node?.__operator(...args)}};setListeners=listeners=>{for(const key in listeners){let node=this.get(key);if(typeof listeners[key]==="object"){for(const k in listeners[key]){let n=this.get(k);let sub;if(typeof listeners[key][k]!=="object")listeners[key][k]={__callback:listeners[key][k]};else if(!listeners[key][k].__callback){for(const kk in listeners[key][k]){if(typeof listeners[key][k][kk]!=="object"){listeners[key][k][kk]={__callback:listeners[key][k][kk]};if(node.__operator&&(listeners[key][k][kk].__callback===true||typeof listeners[key][k][kk].__callback==="undefined"))listeners[key][k][kk].__callback=node.__operator}let nn=this.get(kk);if(!nn){let tag=k.substring(0,k.lastIndexOf("."));nn=this.get(tag);if(nn){let prop=k.substring(k.lastIndexOf(".")+1);sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k][kk].__args,prop,listeners[key][k][kk].inputState,key,k)}}else{sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}if("__callback"in listeners[key][k]){if(node){if(listeners[key][k].__callback===true||typeof listeners[key][k].__callback==="undefined")listeners[key][k].__callback=node.__operator;if(typeof listeners[key][k].__callback==="function")listeners[key][k].__callback=listeners[key][k].__callback.bind(node)}if(!n){let tag=k.substring(0,k.lastIndexOf("."));n=this.get(tag);if(n){sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,k.substring(k.lastIndexOf(".")+1),listeners[key][k].inputState,key,k)}}else{sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}}}};clearListeners=(node,listener)=>{if(typeof node==="string")node=this.get(node);if(node?.__listeners){for(const key in node.__listeners){if(listener&&key!==listener)continue;if(typeof node.__listeners[key]?.sub!=="number")continue;let n=this.get(key);if(!n){n=this.get(key.substring(0,key.lastIndexOf(".")));if(n){if(typeof node.__listeners[key]==="object"&&!node.__listeners[key]?.__callback){for(const k in node.__listeners[key]){if(typeof node.__listeners[key][k]?.sub==="number"){this.unsubscribe(n,node.__listeners[key][k].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}else{if(typeof!node.__listeners[key]?.__callback==="number"){for(const k in node.__listeners[key]){if(node.__listeners[key][k]?.sub){this.unsubscribe(n,node.__listeners[key][k].sub,void 0,node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,void 0,node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}}};get=tag=>{return this.__node.nodes.get(tag)};set=(tag,node)=>{return this.__node.nodes.set(tag,node)};delete=tag=>{return this.__node.nodes.delete(tag)};getProps=(node,getInitial)=>{if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){let cpy;if(getInitial)cpy=Object.assign({},this.__node.roots[node.__node.tag]);else{cpy=Object.assign({},node);for(const key in cpy){if(key.includes("__"))delete cpy[key]}}}};subscribe=(nodeEvent,onEvent,args,key,subInput,target,bound,tkey)=>{let nd=nodeEvent;if(typeof nodeEvent==="string"){nd=this.get(nodeEvent);if(!nd&&nodeEvent.includes(".")){nd=this.get(nodeEvent.substring(0,nodeEvent.lastIndexOf(".")));key=nodeEvent.substring(nodeEvent.lastIndexOf(".")+1)}}if(target instanceof GraphNode)target=target.__node.tag;if(typeof onEvent==="string"){let setOnEventFromString=onEvent2=>{if(this.get(onEvent2)?.__operator){let node=this.get(onEvent2);target=onEvent2;onEvent2=function(...inp){return node.__operator(...inp)}}else if(onEvent2.includes(".")){target=onEvent2.substring(0,onEvent2.lastIndexOf("."));let n=this.get(target);let k=onEvent2.substring(onEvent2.lastIndexOf(".")+1);tkey=k;if(typeof n[k]==="function"){if(n[k]instanceof GraphNode)onEvent2=n[k];else onEvent2=function(...inp){return n[k](...inp)}}else{onEvent2=function(inp){n[k]=inp;return n[k]}}}return onEvent2};if(target){let node=this.get(target);if(typeof node?.[onEvent]==="function"){tkey=onEvent;onEvent=function(...inp){return node[key](...inp)}}else if(node[key]){tkey=key;if(node[key]instanceof GraphNode)onEvent=node[key];else onEvent=function(inp){node[key]=inp;return node[key]}}else{onEvent=setOnEventFromString(onEvent)}}else{onEvent=setOnEventFromString(onEvent)}}let sub;if(nd instanceof GraphNode){const doSub=()=>{sub=nd.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)nd.__unsubscribe(sub,key,subInput);sub=void 0};nd.__addOndisconnected(()=>{ondelete();nd.__addOnconnected(()=>{if(sub===void 0&&nd.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))onEvent=this.get(onEvent);if(onEvent instanceof GraphNode){onEvent.__addOndisconnected(()=>{ondelete()})}};doSub()}else if(typeof nodeEvent==="string"){let node=this.get(nodeEvent);if(node){if(onEvent instanceof GraphNode&&onEvent.__operator){const doSub=()=>{sub=node.__subscribe(onEvent.__operator,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput)};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});onEvent.__addOndisconnected(ondelete)};doSub()}else if(typeof onEvent==="function"||typeof onEvent==="string"){const doSub=()=>{sub=node.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput);sub=void 0};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))this.get(onEvent).__addOndisconnected(ondelete)};doSub()}}else{if(typeof onEvent==="string")onEvent=this.__node.nodes.get(onEvent).__operator;if(typeof onEvent==="function")sub=this.__node.state.subscribeEvent(nodeEvent,onEvent)}}return sub};unsubscribe=(node,sub,key,subInput)=>{if(node instanceof GraphNode){return node.__unsubscribe(sub,key,subInput)}else return this.get(node)?.__unsubscribe(sub,key,subInput)};setState=update=>{this.__node.state.setState(update)}};function recursivelyAssign(target,obj,maxDepth=Infinity,curDepth=0){for(const key in obj){if(obj[key]?.constructor.name==="Object"&&curDepth<maxDepth){curDepth++;if(target[key]?.constructor.name==="Object")recursivelyAssign(target[key],obj[key],maxDepth,curDepth);else target[key]=recursivelyAssign({},obj[key],maxDepth,curDepth)}else{target[key]=obj[key]}}return target}function getAllProperties(obj){var allProps=[],curr=obj;do{var props=Object.getOwnPropertyNames(curr);let fn=function(prop){if(allProps.indexOf(prop)===-1)allProps.push(prop)};props.forEach(fn)}while(curr=Object.getPrototypeOf(curr));return allProps}function isNativeClass(thing){return isFunction(thing)==="class"}function isFunction(x){const res=typeof x==="function"?x.prototype?Object.getOwnPropertyDescriptor(x,"prototype")?.writable?"function":"class":x.constructor.name==="AsyncFunction"?"async":"arrow":"";return res}var getCallbackFromString=(a,graph)=>{if(graph.get(a)?.__operator){let node=graph.get(a);return(...inp)=>{node.__operator(...inp)}}else if(a.includes(".")){let split=a.split(".");let popped=split.pop();let joined=split.join(".");let node=graph.get(joined);if(typeof graph.get(joined)?.[popped]==="function"){return(...inp)=>{return node[popped](...inp)}}else return()=>{return node[popped]}}else if(graph.get(a)){let node=graph.get(a);return()=>{return node}}else{let arg=a;return()=>{return arg}}};var wrapArgs=(callback,argOrder,graph)=>{let args=[];let forArg=(a,i2)=>{if(a==="__output"||a==="__input"||a==="__callback"){args[i2]={__callback:inp=>{return inp},__args:void 0,idx:i2}}else if(typeof a==="string"){args[i2]={__callback:getCallbackFromString(a,graph),__args:void 0,idx:i2}}else if(typeof a==="function"){let fn2=a;args[i2]={__callback:(...inp)=>{return fn2(...inp)},__args:void 0,idx:i2}}else if(typeof a==="object"&&(a.__input||a.__callback)){let recursivelyCreateCallback=function(c){let input=c.__input?c.__input:c.__callback;if(typeof c.__input==="string"){input={__callback:getCallbackFromString(c.__input,graph),__args:void 0,idx:i2}}if(c.__args){let wrapped=wrapArgs(input,c.__args,graph);input={__callback:wrapped.__callback,__args:wrapped.__args,idx:i2}}else{input={__callback:input,__args:void 0,idx:i2}}if(c.__output){let output=c.__output;if(typeof c.__output==="string"){output={__callback:getCallbackFromString(output,graph),__args:void 0,idx:i2}}else if(typeof a.__output==="object"){output=recursivelyCreateCallback(output)}if(typeof output?.__callback==="function"){let fn2=input.__callback;let callback2=output.__callback;input={__callback:(...inp)=>{return callback2(fn2(...inp))},__args:output.__args,idx:i2}}}return input};args[i2]=recursivelyCreateCallback(a)}else{let arg=a;args[i2]={__callback:()=>{return arg},__args:void 0,idx:i2}}};argOrder.forEach(forArg);if(typeof callback==="string")callback={__callback:getCallbackFromString(callback,graph),__args:void 0};let fn=typeof callback==="function"?callback:callback.__callback;callback=function(...inp){let mapArg=arg=>{return arg.__callback(...inp)};const result=fn(...args.map(mapArg));return result};return{__callback:callback,__args:args}};var objProps=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var backprop=(node,parent,graph)=>{if(node.__node.backward&&parent instanceof GraphNode){graph.setListeners({[parent.__node.tag]:{[node.__node.tag]:parent}})}};var loop=(node,parent,graph)=>{if(node.__operator&&!node.__node.looperSet){if(typeof node.__node.delay==="number"){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{setTimeout(async()=>{res(await fn(...args))},node.__node.delay)})})}else if(node.__node.frame===true){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{requestAnimationFrame(async()=>{res(await fn(...args))})})})}if(typeof node.__node.repeat==="number"||typeof node.__node.recursive==="number"){let fn=node.__operator;node.__setOperator(async(...args)=>{let i2=node.__node.repeat?node.__node.repeat:node.__node.recursive;let result;let repeater=async(tick,...inp)=>{while(tick>0){if(node.__node.delay||node.__node.frame){fn(...inp).then(async res=>{if(node.__node.recursive){await repeater(tick,res)}else await repeater(tick,...inp)});break}else result=await fn(...args);tick--}};await repeater(i2,...args);return result})}if(node.__node.loop&&typeof node.__node.loop==="number"){node.__node.looperSet=true;let fn=node.__operator;let time=node.__node.loop;node.__setOperator((...args)=>{if(!("looping"in node.__node))node.__node.looping=true;if(node.__node.looping){let last=performance.now();fn(...args);setTimeout(()=>{let now=performance.now();let overshoot=now-last-node.__node.loop;if(overshoot>0)time=node.__node.loop-overshoot;else time=node.__node.loop;if(time<=0)time=node.__node.loop;node.__operator(...args)},time)}});if(node.__node.looping)node.__operator();let ondelete=node2=>{if(node2.__node.looping)node2.__node.looping=false};node.__addOndisconnected(ondelete)}}};var animate=(node,parent,graph)=>{if(node.__node.animate===true||node.__animation){let fn=node.__operator;node.__setOperator((...args)=>{if(!("animating"in node.__node))node.__node.animating=true;if(node.__node.animating){if(typeof node.__animation==="function")node.__animation(...args);else fn(...args);requestAnimationFrame(()=>{node.__operator(...args)})}});if(node.__node.animating||(!("animating"in node.__node)||node.__node.animating)&&node.__animation)setTimeout(()=>{requestAnimationFrame(node.__operator)},10);let ondelete=node2=>{if(node2.__node.animating)node2.__node.animating=false};node.__addOndisconnected(ondelete)}};var branching=(node,parent,graph)=>{if(typeof node.__branch==="object"&&node.__operator&&!node.__branchApplied){let fn=node.__operator;node.__branchApplied=true;node.__operator=(...args)=>{let result=fn(...args);for(const key in node.__branch){let triggered=()=>{if(typeof node.__branch[key].then==="function"){node.__branch[key].then(result)}else if(node.__branch[key].then instanceof GraphNode&&node.__branch[key].then.__operator){node.__branch[key].then.__operator(result)}else result=node.__branch[key].then};if(typeof node.__branch[key].if==="function"){if(node.__branch[key].if(result)==true){triggered()}}else if(node.__branch[key].if===result){triggered()}}return result}}if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].branch&&!node.__listeners[key].branchApplied){let fn=node.__listeners[key].callback;node.__listeners[key].branchApplied=true;node.__listeners.callback=ret=>{let triggered=()=>{if(typeof node.__listeners[key].branch.then==="function"){ret=node.__listeners[key].branch.then(ret)}else if(node.__listeners[key].branch.then instanceof GraphNode&&node.__listeners[key].branch.then.__operator){ret=node.__listeners[key].branch.then.__operator(ret)}else ret=node.__listeners[key].branch.then};if(typeof node.__listeners[key].branch.if==="function"){if(node.__listeners[key].branch.if(ret)){triggered()}}else if(node.__listeners[key].branch.if===ret){triggered()}return fn(ret)}}}}}};var triggerListenerOncreate=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].oncreate){node.__listeners[key].callback(node.__listeners[key].oncreate)}}}}};var bindListener=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].binding==="object"){node.__listeners.callback=node.__listeners.callback.bind(node.__listeners[key].binding)}}}}};var transformListenerResult=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].transform==="function"&&!node.__listeners[key].transformApplied){let fn=node.__listeners[key].callback;node.__listeners[key].transformApplied=true;node.__listeners.callback=ret=>{ret=node.__listeners[key].transform(ret);return fn(ret)}}}}}};var substitute__operator=(node,parent,graph)=>{if(node.post&&!node.__operator){node.__setOperator(node.post)}else if(!node.__operator&&typeof node.get=="function"){node.__setOperator(node.get)}if(!node.get&&node.__operator){node.get=node.__operator}if(node.aliases){node.aliases.forEach(a=>{graph.set(a,node);let ondelete=node2=>{graph.__node.nodes.delete(a)};node.__addOndisconnected(ondelete)})}if(typeof graph.__node.roots?.[node.__node.tag]==="object"&&node.get)graph.__node.roots[node.__node.tag].get=node.get};var loaders={backprop,loop,animate,branching,triggerListenerOncreate,bindListener,transformListenerResult,substitute__operator};var recursivelyStringifyFunctions=obj=>{let cpy={};for(const key in obj){if(typeof obj[key]==="object"){cpy[key]=recursivelyStringifyFunctions(obj[key])}else if(typeof obj[key]==="function"){cpy[key]=obj[key].toString()}else cpy[key]=obj[key]}return cpy};function parseFunctionFromText(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\\\W*(function[^{]+\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>[^{]*\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs22(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs}var stringifyFast=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p in value[prop]){if(Array.isArray(value[prop][p])){if(value[prop][p].length>20)obj[prop][p]=value[prop][p].slice(value[prop][p].length-20);else obj[prop][p]=value[prop][p]}else{if(value[prop][p]!=null){let con=value[prop][p].constructor.name;if(con.includes("Set")){obj[prop][p]=Array.from(value[prop][p])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p]="instanceof_"+con}else{obj[prop][p]=value[prop][p]}}else{obj[prop][p]=value[prop][p]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast22(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast}function methodstrings(node){if(typeof node.__methods==="object"){for(const key in node.__methods){let fstr=node.__methods[key];let fn=typeof fstr==="function"?fstr:parseFunctionFromText(fstr);if(key==="__operator"){node.__setOperator(fn)}else{node[key]=fn.bind(node)}}}}var Service=class extends Graph{name=\\`service\\${Math.floor(Math.random()*1e15)}\\`;constructor(options){super({...options,loaders:options?.loaders?Object.assign({...loaders},options.loaders):{...loaders}});if(options?.services)this.addServices(options.services);this.load(this)}addServices=services=>{for(const s in services){if(typeof services[s]==="function")services[s]=new services[s];if(services[s]?.__node?.loaders)Object.assign(this.__node.loaders,services[s].__node.loaders);if(services[s]?.__node?.nodes){services[s].__node.nodes.forEach((n,tag)=>{if(!this.get(tag)){this.set(tag,n)}else this.set(s+"."+tag,n)});this.__node.nodes.forEach((n,k)=>{if(!services[s].__node.nodes.get(k))services[s].__node.nodes.set(k,n)});let set=this.set;this.set=(tag,node)=>{services[s].set(tag,node);return set(tag,node)};let del=this.delete;this.delete=tag=>{services[s].delete(tag);return del(tag)}}else if(typeof services[s]==="object"){this.load(services[s])}}};handleMethod=(route,method,args)=>{let m=method.toLowerCase();let src=this.__node.nodes.get(route);if(!src){src=this.__node.roots[route]}if(src?.[m]){if(typeof src[m]!=="function"){if(args){if(Array.isArray(args)&&args.length===1)src[m]=args[0];else src[m]=args;return}return src[m]}else{if(Array.isArray(args))return src[m](...args);else return src[m](args)}}else return this.handleServiceMessage({route,args,method})};handleServiceMessage(message){let call;if(typeof message==="object"){if(message.route)call=message.route;else if(message.node)call=message.node}if(call){if(Array.isArray(message.args))return this.run(call,...message.args);else return this.run(call,message.args)}else return message}handleGraphNodeCall(route,args){if(!route)return args;if(args?.args){this.handleServiceMessage(args)}else if(Array.isArray(args))return this.run(route,...args);else return this.run(route,args)}transmit=(...args)=>{if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};receive=(...args)=>{if(args[0]){if(typeof args[0]==="string"){let substr=args[0].substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\\\\\"))args[0]=args[0].replace(/\\\\\\\\/g,"");if(args[0][0]===\'"\'){args[0]=args[0].substring(1,args[0].length-1)};args[0]=JSON.parse(args[0])}}}if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};pipe=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return this.subscribe(source,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})};pipeOnce=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return source.__node.state.subscribeEventOnce(source.__node.unique,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.__node.state.subscribeEventOnce(source.__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(source).__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})};terminate=(...args)=>{};isTypedArray=isTypedArray;recursivelyAssign=recursivelyAssign2;spliceTypedArray=spliceTypedArray;ping=()=>{console.log("pinged!");return"pong"};echo=(...args)=>{this.transmit(...args);return args};log=(...args)=>{console.log(...args);return true};error=(...args)=>{console.error(...args);return true}};function isTypedArray(x){return ArrayBuffer.isView(x)&&Object.prototype.toString.call(x)!=="[object DataView]"}var recursivelyAssign2=(target,obj)=>{for(const key in obj){if(obj[key]?.constructor.name==="Object"&&!Array.isArray(obj[key])){if(target[key]?.constructor.name==="Object"&&!Array.isArray(target[key]))recursivelyAssign2(target[key],obj[key]);else target[key]=recursivelyAssign2({},obj[key])}else target[key]=obj[key]}return target};function spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let ta;if(s.length>0||e?.length>0)ta=new arr.constructor(s.length+e.length);if(ta){if(s.length>0)ta.set(s);if(e&&e.length>0)ta.set(e,s.length)}return ta}var nodeTemplates={};var remoteGraphRoutes={transferNode:(properties,connection,name2)=>{let str2;if(typeof properties==="object"){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}str2=recursivelyStringifyFunctions(properties)}else if(typeof properties==="function")str2=properties.toString();else if(typeof properties==="string")str2=properties;if(str2){if(connection.run)return connection.run("setNode",[str2]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:str2},void 0);return new Promise(r=>r(name2))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:str2}));return new Promise(r=>r(name2))}}},setNode:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function")properties={__operator:f,__node:{tag:name2?name2:f.name}};else{f=JSON.parse(properties);if(typeof f==="object")properties=f}}if(typeof properties==="object"||typeof properties==="function"){let template={};if(typeof properties==="object")Object.assign(template,properties);else template.__operator=properties;let node=this.__node.graph.add(template);if(node){nodeTemplates[node.__node.tag]=template;return node.__node?.tag}else return false}else return false},proxyRemoteNode:function(name2,connection){return new Promise((res,rej)=>{connection.run("getNodeProperties",name2).then(props=>{let proxy={};if(typeof props==="object"){for(const key in props){if(props[key]==="function"){proxy[key]=(...args)=>{return new Promise(r=>{connection.run(name2,args,key).then(r)})}}else{Object.defineProperty(proxy,key,{get:()=>{return new Promise(r=>{connection.run(name2,void 0,key).then(r)})},set:value=>{connection.post(name2,value,key)},configurable:true,enumerable:true})}}}res(proxy)})})},makeNodeTransferrable:function(properties,name2){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}const str2=recursivelyStringifyFunctions(properties);return str2},setTemplate:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function"){if(!name2)name2=f.name;properties={__operator:f,__node:{tag:name2}}}else{f=JSON.parse(properties);if(typeof f==="object"){properties=f;if(!name2&&f.__node?.tag)name2=f.__node.tag}}}if(!name2)name2=\\`node\\${Math.floor(Math.random()*1e15)}\\`;if(typeof properties==="object"||typeof properties==="function"){nodeTemplates[name2]=properties;return name2}else return false},loadFromTemplate:function(templateName,name2,properties){if(nodeTemplates[templateName]){let cpy=recursivelyAssign2({},nodeTemplates[templateName]);if(name2){if(!cpy.__node)cpy.__node={};cpy.__node.tag=name2}if(properties)Object.assign(cpy,properties);let node=this.__node.graph.add(cpy);return node.__node.tag}},setMethod:function(nodeTag,fn,methodKey){if(typeof fn==="string"){let f=parseFunctionFromText(fn);if(typeof f==="function")fn=f}if(!methodKey&&typeof fn==="function")methodKey=fn.name;if(this.__node.graph.get(nodeTag)){this.__node.graph.get(nodeTag)[methodKey]=fn}else this.__node.graph.add({__node:{tag:methodKey,[methodKey]:fn}});return true},assignNode:function(nodeTag,source){if(this.__node.graph.get(nodeTag)&&typeof source==="object"){Object.assign(this.__node.graph.get(nodeTag),source)}},getNodeProperties:function(nodeTag){let node=this.__node.graph.get(nodeTag);if(node){let properties=Object.getOwnPropertyNames(node);let result={};for(const key in properties){result[key]=typeof node[key]}return result}return void 0},transferClass:(classObj,connection,className)=>{if(typeof classObj==="object"){let str2=classObj.toString();let message={route:"receiveClass",args:[str2,className]};if(connection.run)return connection.run("receiveClass",[str2,className]);else if(connection.postMessage){connection.postMessage({route:"receiveClass",args:[str2,className]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"receiveClass",args:[str2,className]}));return new Promise(r=>r(name))}return message}return false},receiveClass:function(stringified,className){if(typeof stringified==="string"){if(stringified.indexOf("class")===0){let cls=(0,eval)("("+stringified+")");let name2=className;if(!name2)name2=cls.name;this.__node.graph[name2]=cls;return true}}return false},transferFunction:(fn,connection,fnName)=>{if(!fnName)fnName=fn.name;let str2=fn.toString();let message={route:"setNode",args:[str2,fnName]};if(connection.run)return connection.run("setNode",[str2,fnName]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:[str2,fnName]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:[str2,fnName]}));return new Promise(r=>r(name))}return message},setGlobal:(key,value)=>{globalThis[key]=value;return true},assignGlobalObject:(target,source)=>{if(!globalThis[target])return false;if(typeof source==="object")Object.assign(globalThis[target],source);return true},setValue:function(key,value){this.__node.graph[key]=value;return true},assignObject:function(target,source){if(!this.__node.graph[target])return false;if(typeof source==="object")Object.assign(this.__node.graph[target],source);return true},setGlobalFunction:(fn,fnName)=>{if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;globalThis[fnName]=fn;return true}return false},setGraphFunction:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.__node.graph[fnName]=fn;return true}return false}};function html(strings,...args){return function append(elm=document.createElement("div")){let template=document.createElement("template");strings.map(function(s,i2){template.innerHTML+=s;if(args[i2]instanceof HTMLElement){let dummy2=\\`<span id="dummyNode12345"></span>\\`;dummy2.id="dummyNode12345";template.innerHTML+=dummy2}else template.innerHTML+=args[i2]});let query=template.content.querySelectorAll("#dummyNode12345");let ctr=0;args.forEach((arg,i2)=>{if(arg instanceof HTMLElement){console.log(arg,query[ctr]);template.content.replaceChild(arg,query[ctr]);ctr++}});elm.appendChild(template.content);return elm}}var dummy=html\\`\\`;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl.cipher.aes=function(a){this.s[0][0][0]||this.O();var b,c,d,e,f=this.s[0][4],g=this.s[1];b=a.length;var h=1;if(4!==b&&6!==b&&8!==b)throw new sjcl.exception.invalid("invalid aes key size");this.b=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));d[a]=d[a-b]^c}for(b=0;a;b++,a--)c=d[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]]};sjcl.cipher.aes.prototype={encrypt:function(a){return t(this,a,0)},decrypt:function(a){return t(this,a,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var a=this.s[0],b=this.s[1],c=a[4],d=b[4],e,f,g,h=[],k=[],l,n,m,p;for(e=0;256>e;e++)k[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=l||1,g=k[g]||1)for(m=g^g<<1^g<<2^g<<3^g<<4,m=m>>8^m&255^99,c[f]=m,d[m]=f,n=h[e=h[l=h[f]]],p=16843009*n^65537*e^257*l^16843008*f,n=257*h[m]^16843008*m,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p=p<<24^p>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};function t(a,b,c){if(4!==b.length)throw new sjcl.exception.invalid("invalid aes block size");var d=a.b[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,k,l,n=d.length/4-2,m,p=4,r=[0,0,0,0];h=a.s[c];a=h[0];var q=h[1],v=h[2],w=h[3],x=h[4];for(m=0;m<n;m++)h=a[e>>>24]^q[f>>16&255]^v[g>>8&255]^w[b&255]^d[p],k=a[f>>>24]^q[g>>16&255]^v[b>>8&255]^w[e&255]^d[p+1],l=a[g>>>24]^q[b>>16&255]^v[e>>8&255]^w[f&255]^d[p+2],b=a[b>>>24]^q[e>>16&255]^v[f>>8&255]^w[g&255]^d[p+3],p+=4,e=h,f=k,g=l;for(m=0;4>m;m++)r[c?3&-m:m]=x[e>>>24]<<24^x[f>>16&255]<<16^x[g>>8&255]<<8^x[b&255]^d[p++],h=e,e=f,f=g,g=b,b=h;return r}sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.$(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.$(b,d,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b=b&31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return false;var c=0,d;for(d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c},$:function(a,b,c,d){var e;e=0;for(void 0===d&&(d=[]);32<=b;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1));return d},i:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&65280|(c&65280)<<8|c<<24;return a}};sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++)0===(d&3)&&(e=a[d/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++)d=d<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d),d=0);c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b}};sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d;a=a.replace(/\\\\s|0x/g,"");d=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,4*d)}};sjcl.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(a,b,c){var d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f="",g=0,h=sjcl.codec.base32.B,k=0,l=sjcl.bitArray.bitLength(a);c&&(h=sjcl.codec.base32.X);for(c=0;f.length*d<l;)f+=h.charAt((k^a[c]>>>g)>>>e),g<d?(k=a[c]<<d-g,g+=e,c++):(k<<=d,g-=d);for(;f.length&7&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\\\\s|=/g,"").toUpperCase();var c=sjcl.codec.base32.BITS,d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f=[],g,h=0,k=sjcl.codec.base32.B,l=0,n,m="base32";b&&(k=sjcl.codec.base32.X,m="base32hex");for(g=0;g<a.length;g++){n=k.indexOf(a.charAt(g));if(0>n){if(!b)try{return sjcl.codec.base32hex.toBits(a)}catch(p){}throw new sjcl.exception.invalid("this isn\'t "+m+"!")}h>e?(h-=e,f.push(l^n>>>h),l=n<<c-h):(h+=d,l^=n<<c-h)}h&56&&f.push(sjcl.bitArray.partial(h&56,l,1));return f}};sjcl.codec.base32hex={fromBits:function(a,b){return sjcl.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl.codec.base32.toBits(a,1)}};sjcl.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.B,g=0,h=sjcl.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;d.length&3&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\\\\s|=/g,"");var c=[],d,e=0,f=sjcl.codec.base64.B,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d=0;d<a.length;d++){h=f.indexOf(a.charAt(d));if(0>h)throw new sjcl.exception.invalid("this isn\'t base64!");26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e)}e&56&&c.push(sjcl.bitArray.partial(e&56,g,1));return c}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}};sjcl.hash.sha256=function(a){this.b[0]||this.O();a?(this.F=a.F.slice(0),this.A=a.A.slice(0),this.l=a.l):this.reset()};sjcl.hash.sha256.hash=function(a){return new sjcl.hash.sha256().update(a).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.A=sjcl.bitArray.concat(this.A,a);b=this.l;a=this.l=b+sjcl.bitArray.bitLength(a);if(9007199254740991<a)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d=new Uint32Array(c),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u(this,d.subarray(16*e,16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u(this,c.splice(0,16));return this},finalize:function(){var a,b=this.A,c=this.F,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.l/4294967296));for(b.push(this.l|0);b.length;)u(this,b.splice(0,16));this.reset();return c},Y:[],b:[],O:function(){function a(a2){return 4294967296*(a2-Math.floor(a2))|0}for(var b=0,c=2,d,e;64>b;c++){e=true;for(d=2;d*d<=c;d++)if(0===c%d){e=false;break}e&&(8>b&&(this.Y[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}};function u(a,b){var c,d,e,f=a.F,g=a.b,h=f[0],k=f[1],l=f[2],n=f[3],m=f[4],p=f[5],r=f[6],q=f[7];for(c=0;64>c;c++)16>c?d=b[c]:(d=b[c+1&15],e=b[c+14&15],d=b[c&15]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c&15]+b[c+9&15]|0),d=d+q+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(r^m&(p^r))+g[c],q=r,r=p,p=m,m=n+d|0,n=l,l=k,k=h,h=d+(k&l^n&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+n|0;f[4]=f[4]+m|0;f[5]=f[5]+p|0;f[6]=f[6]+r|0;f[7]=f[7]+q|0}sjcl.mode.ccm={name:"ccm",G:[],listenProgress:function(a){sjcl.mode.ccm.G.push(a)},unListenProgress:function(a){a=sjcl.mode.ccm.G.indexOf(a);-1<a&&sjcl.mode.ccm.G.splice(a,1)},fa:function(a){var b=sjcl.mode.ccm.G.slice(),c;for(c=0;c<b.length;c+=1)b[c](a)},encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,k=h.bitLength(c)/8,l=h.bitLength(g)/8;e=e||64;d=d||[];if(7>k)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&l>>>8*f;f++);f<15-k&&(f=15-k);c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.V(a,b,c,d,e,f);g=sjcl.mode.ccm.C(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/8;if(7>g)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&h>>>8*b;b++);b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));k=sjcl.mode.ccm.C(a,k,c,l,e,b);a=sjcl.mode.ccm.V(a,k.data,c,d,e,b);if(!f.equal(k.tag,a))throw new sjcl.exception.corrupt("ccm: tag doesn\'t match");return k.data},na:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,k=h.i;d=[h.partial(8,(b.length?64:0)|d-2<<2|f-1)];d=h.concat(d,c);d[3]|=e;d=a.encrypt(d);if(b.length)for(c=h.bitLength(b)/8,65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,b),b=0;b<g.length;b+=4)d=a.encrypt(k(d,g.slice(b,b+4).concat([0,0,0])));return d},V:function(a,b,c,d,e,f){var g=sjcl.bitArray,h=g.i;e/=8;if(e%2||4>e||16<e)throw new sjcl.exception.invalid("ccm: invalid tag length");if(4294967295<d.length||4294967295<b.length)throw new sjcl.exception.bug("ccm: can\'t deal with 4GiB or more data");c=sjcl.mode.ccm.na(a,d,c,e,g.bitLength(b)/8,f);for(d=0;d<b.length;d+=4)c=a.encrypt(h(c,b.slice(d,d+4).concat([0,0,0])));return g.clamp(c,8*e)},C:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.i;var k=b.length,l=h.bitLength(b),n=k/50,m=n;c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d=h.bitSlice(g(d,a.encrypt(c)),0,e);if(!k)return{tag:d,data:[]};for(g=0;g<k;g+=4)g>n&&(sjcl.mode.ccm.fa(g/k),n+=m),c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d,data:h.clamp(b,l)}}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var g,h=sjcl.mode.ocb2.S,k=sjcl.bitArray,l=k.i,n=[0,0,0,0];c=h(a.encrypt(c));var m,p=[];d=d||[];e=e||64;for(g=0;g+4<b.length;g+=4)m=b.slice(g,g+4),n=l(n,m),p=p.concat(l(c,a.encrypt(l(c,m)))),c=h(c);m=b.slice(g);b=k.bitLength(m);g=a.encrypt(l(c,[0,0,0,b]));m=k.clamp(l(m.concat([0,0,0]),g),b);n=l(n,l(m.concat([0,0,0]),g));n=a.encrypt(l(n,l(c,h(c))));d.length&&(n=l(n,f?d:sjcl.mode.ocb2.pmac(a,d)));return p.concat(k.concat(m,k.clamp(n,e)))},decrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");e=e||64;var g=sjcl.mode.ocb2.S,h=sjcl.bitArray,k=h.i,l=[0,0,0,0],n=g(a.encrypt(c)),m,p,r=sjcl.bitArray.bitLength(b)-e,q=[];d=d||[];for(c=0;c+4<r/32;c+=4)m=k(n,a.decrypt(k(n,b.slice(c,c+4)))),l=k(l,m),q=q.concat(m),n=g(n);p=r-32*c;m=a.encrypt(k(n,[0,0,0,p]));m=k(m,h.clamp(b.slice(c),p).concat([0,0,0]));l=k(l,m);l=a.encrypt(k(l,k(n,g(n))));d.length&&(l=k(l,f?d:sjcl.mode.ocb2.pmac(a,d)));if(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))throw new sjcl.exception.corrupt("ocb: tag doesn\'t match");return q.concat(h.clamp(m,p))},pmac:function(a,b){var c,d=sjcl.mode.ocb2.S,e=sjcl.bitArray,f=e.i,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4)h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d(f(h,d(h))),g))},S:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);b=sjcl.bitArray;d=d||[];a=sjcl.mode.gcm.C(true,a,f,d,c,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c,d,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);e=e||128;d=d||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.C(false,a,f,d,c,e);if(!g.equal(a.tag,b))throw new sjcl.exception.corrupt("gcm: tag doesn\'t match");return a.data},ka:function(a,b){var c,d,e,f,g,h=sjcl.bitArray.i;e=[0,0,0,0];f=b.slice(0);for(c=0;128>c;c++){(d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d=3;0<d;d--)f[d]=f[d]>>>1|(f[d-1]&1)<<31;f[0]>>>=1;g&&(f[0]^=-520093696)}return e},j:function(a,b,c){var d,e=c.length;b=b.slice(0);for(d=0;d<e;d+=4)b[0]^=4294967295&c[d],b[1]^=4294967295&c[d+1],b[2]^=4294967295&c[d+2],b[3]^=4294967295&c[d+3],b=sjcl.mode.gcm.ka(b,a);return b},C:function(a,b,c,d,e,f){var g,h,k,l,n,m,p,r,q=sjcl.bitArray;m=c.length;p=q.bitLength(c);r=q.bitLength(d);h=q.bitLength(e);g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=q.concat(e,[1])):(e=sjcl.mode.gcm.j(g,[0,0,0,0],e),e=sjcl.mode.gcm.j(g,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl.mode.gcm.j(g,[0,0,0,0],d);n=e.slice(0);d=h.slice(0);a||(d=sjcl.mode.gcm.j(g,h,c));for(l=0;l<m;l+=4)n[3]++,k=b.encrypt(n),c[l]^=k[0],c[l+1]^=k[1],c[l+2]^=k[2],c[l+3]^=k[3];c=q.clamp(c,p);a&&(d=sjcl.mode.gcm.j(g,h,c));a=[Math.floor(r/4294967296),r&4294967295,Math.floor(p/4294967296),p&4294967295];d=sjcl.mode.gcm.j(g,d,a);k=b.encrypt(e);d[0]^=k[0];d[1]^=k[1];d[2]^=k[2];d[3]^=k[3];return{tag:q.bitSlice(d,0,f),data:c}}};sjcl.misc.hmac=function(a,b){this.W=b=b||sjcl.hash.sha256;var c=[[],[]],d,e=b.prototype.blockSize/32;this.w=[new b,new b];a.length>e&&(a=b.hash(a));for(d=0;d<e;d++)c[0][d]=a[d]^909522486,c[1][d]=a[d]^1549556828;this.w[0].update(c[0]);this.w[1].update(c[1]);this.R=new b(this.w[0])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){if(this.aa)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");this.update(a);return this.digest(a)};sjcl.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=false};sjcl.misc.hmac.prototype.update=function(a){this.aa=true;this.R.update(a)};sjcl.misc.hmac.prototype.digest=function(){var a=this.R.finalize(),a=new this.W(this.w[1]).update(a).finalize();this.reset();return a};sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1e4;if(0>d||0>c)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,k,l=[],n=sjcl.bitArray;for(k=1;32*l.length<(d||1);k++){e=f=a.encrypt(n.concat(b,[k]));for(g=1;g<c;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];l=l.concat(e)}d&&(l=n.clamp(l,d));return l};sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=a;this.D=false;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=3e4;this.ba=80};sjcl.prng.prototype={randomWords:function(a,b){var c=[],d;d=this.isReady(b);var e;if(d===this.u)throw new sjcl.exception.notReady("generator isn\'t seeded");if(d&this.J){d=!(d&this.I);e=[];var f=0,g;this.Z=e[0]=new Date().valueOf()+this.da;for(g=0;16>g;g++)e.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.m[g],this.m[g]=0,d||!(this.P&1<<g));g++);this.P>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.m.push(0));this.f-=f;f>this.o&&(this.o=f);this.P++;this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.L=new sjcl.cipher.aes(this.b);for(d=0;4>d&&(this.h[d]=this.h[d]+1|0,!this.h[d]);d++);}for(d=0;d<a;d+=4)0===(d+1)%this.ca&&y(this),e=z(this),c.push(e[0],e[1],e[2],e[3]);y(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=new Date().valueOf(),g=this.H[c],h=this.isReady(),k=0;d=this.U[c];void 0===d&&(d=this.U[c]=this.ha++);void 0===g&&(g=this.H[c]=0);this.H[c]=(this.H[c]+1)%this.c.length;switch(typeof a){case"number":void 0===b&&(b=1);this.c[g].update([d,this.N++,1,b,f,1,a|0]);break;case"object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(k=1),c=0;c<a.length&&!k;c++)"number"!==typeof a[c]&&(k=1);if(!k){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e=e>>>1;this.c[g].update([d,this.N++,2,b,f,a.length].concat(a))}break;case"string":void 0===b&&(b=a.length);this.c[g].update([d,this.N++,3,b,f,a.length]);this.c[g].update(a);break;default:k=1}if(k)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[g]+=b;this.f+=b;h===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},isReady:function(a){a=this.T[void 0!==a?a:this.M];return this.o&&this.o>=a?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=a?this.J|this.u:this.u},getProgress:function(a){a=this.T[a?a:this.M];return this.o>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,false),window.addEventListener("mousemove",this.a.mouseCollector,false),window.addEventListener("keypress",this.a.keyboardCollector,false),window.addEventListener("devicemotion",this.a.accelerometerCollector,false),window.addEventListener("touchmove",this.a.touchCollector,false);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl.exception.bug("can\'t attach event");this.D=true}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,false),window.removeEventListener("mousemove",this.a.mouseCollector,false),window.removeEventListener("keypress",this.a.keyboardCollector,false),window.removeEventListener("devicemotion",this.a.accelerometerCollector,false),window.removeEventListener("touchmove",this.a.touchCollector,false)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=false)},addEventListener:function(a,b){this.K[a][this.ga++]=b},removeEventListener:function(a,b){var c,d,e=this.K[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},la:function(){C(this,1)},oa:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,"mouse");C(this,0)},qa:function(a){a=a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C(this,0)},ma:function(){C(this,2)},ea:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C(this,0)}};function A(a,b){var c,d=sjcl.random.K[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}function C(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy(new Date().valueOf(),b,"loadtime")}function y(a){a.b=z(a).concat(z(a));a.L=new sjcl.cipher.aes(a.b)}function z(a){for(var b=0;4>b&&(a.h[b]=a.h[b]+1|0,!a.h[b]);b++);return a.L.encrypt(a.h)}function B(a,b){return function(){b.apply(a,arguments)}}sjcl.random=new sjcl.prng(6);a:try{if(G="undefined"!==typeof module&&module.exports){try{H=__require2("crypto")}catch(a){H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array(new Uint8Array(D).buffer),sjcl.random.addEntropy(D,1024,"crypto[\'randomBytes\']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F);else break a;sjcl.random.addEntropy(F,1024,"crypto[\'getRandomValues\']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}var D;var E;var F;var G;var H;sjcl.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json,f=e.g({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.g(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl.codec.base64.toBits(f.iv));if(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)throw new sjcl.exception.invalid("json encrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));"string"===typeof c&&(f.adata=c=sjcl.codec.utf8String.toBits(c));g=new sjcl.cipher[f.cipher](a);e.g(d,f);d.key=a;f.ct="ccm"===f.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(g,b,f.iv,c,f.ts):sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f},encrypt:function(a,b,c,d){var e=sjcl.json,f=e.ja.apply(e,arguments);return e.encode(f)},ia:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json;b=e.g(e.g(e.g({},e.defaults),b),c,true);var f,g;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv));if(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjcl.exception.invalid("json decrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl.codec.utf8String.toBits(f));g=new sjcl.cipher[b.cipher](a);f="ccm"===b.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(g,b.ct,b.iv,b.tag,f,b.ts):sjcl.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.g(d,b);d.key=a;return 1===c.raw?f:sjcl.codec.utf8String.fromBits(f)},decrypt:function(a,b,c,d){var e=sjcl.json;return e.ia(a,e.decode(b),c,d)},encode:function(a){var b,c="{",d="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");c+=d+\'"\'+b+\'":\';d=",";switch(typeof a[b]){case"number":case"boolean":c+=a[b];break;case"string":c+=\'"\'+escape(a[b])+\'"\';break;case"object":c+=\'"\'+sjcl.codec.base64.fromBits(a[b],0)+\'"\';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return c+"}"},decode:function(a){a=a.replace(/\\\\s/g,"");if(!a.match(/^\\\\{.*\\\\}$/))throw new sjcl.exception.invalid("json decode: this isn\'t json!");a=a.replace(/^\\\\{|\\\\}$/g,"").split(/,/);var b={},c,d;for(c=0;c<a.length;c++){if(!(d=a[c].match(/^\\\\s*(?:(["\']?)([a-z][a-z0-9]*)\\\\1)\\\\s*:\\\\s*(?:(-?\\\\d+)|"([a-z0-9+\\\\/%*_.@=\\\\-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn\'t json!");null!=d[3]?b[d[2]]=parseInt(d[3],10):null!=d[4]?b[d[2]]=d[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(d[4]):unescape(d[4]):null!=d[5]&&(b[d[2]]="true"===d[5])}return b},g:function(a,b,c){void 0===a&&(a={});if(void 0===b)return a;for(var d in b)if(b.hasOwnProperty(d)){if(c&&void 0!==a[d]&&a[d]!==b[d])throw new sjcl.exception.invalid("required parameter overridden");a[d]=b[d]}return a},sa:function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&a[d]!==b[d]&&(c[d]=a[d]);return c},ra:function(a,b){var c={},d;for(d=0;d<b.length;d++)void 0!==a[b[d]]&&(c[b[d]]=a[b[d]]);return c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.pa={};sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.pa,d;b=b||{};d=b.iter||1e3;c=c[a]=c[a]||{};d=c[d]=c[d]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=void 0===b.salt?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);return{key:d[c].slice(0),salt:c.slice(0)}};var _HTTPfrontend=class extends Service{name="http";fetchProxied=false;listening={};constructor(options,path,fetched){super(options);this.load(this);this.listen(path,fetched)}GET=(url="http://localhost:8080/ping",type="",mimeType)=>{if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"GET",url,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};POST=(message,url="http://localhost:8080/echo",type="",mimeType)=>{if(typeof message==="object"&&(type==="json"||type==="text"||!type)){message=JSON.stringify(message)}if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"POST",url,data:message,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};transmit=(message,url)=>{let obj=message;if(typeof obj==="object"){message=JSON.stringify(obj)}if(obj?.method?.toLowerCase()=="get"||message?.toLowerCase()==="get")return this.GET(url);return this.POST(message,url)};transponder=(url,message,type="",mimeType)=>{if(typeof message==="object")message=JSON.stringify(message);let method="GET";if(message){method="POST"}if(type==="json")mimeType="application/json";else return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method,url,data:message,responseType:type,onload:ev=>{let body=xhr.response;if(typeof body==="string"){let substr=body.substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\\\\\"))body=body.replace(/\\\\\\\\/g,"");if(body[0]===\'"\'){body=body.substring(1,body.length-1)};body=JSON.parse(body)}}if(typeof body?.method==="string"){return resolve(this.handleMethod(body.route,body.method,body.args))}else if(typeof body?.route==="string"){return resolve(this.handleServiceMessage(body))}else if(typeof body?.node==="string"||body.node instanceof GraphNode){return resolve(this.handleGraphNodeCall(body.node,body.args))}else return resolve(body)},onabort:er=>{reject(er)}})}).catch(console.error)};listen=(path="0",fetched=async(clone,args,response)=>{const result=await clone.text();const returned=this.receive(result);this.setState({[response.url]:returned})})=>{this.listening[path]={};let listenerId=\\`\\${path}\\${Math.floor(Math.random()*1e15)}\\`;this.listening[path][listenerId]=fetched;if(!this.fetchProxied){globalThis.fetch=new Proxy(globalThis.fetch,{apply(fetch,that,args){const result=fetch.apply(that,args);result.then(response=>{if(!response.ok)return;if(this.listening["0"]){for(const key in this.listeners){const clone=response.clone();this.listening["0"][key](clone,args,response)}}else{for(const key in this.listening){if(response.url.includes(key)){for(const key2 in this.listening[path]){const clone=response.clone();this.listening[path][key2](clone,args,response)}break}}}}).catch(er=>{console.error(er)});return result}});this.fetchProxied=true}return listenerId};stopListening=(path,listener)=>{if(!path&&path!==0){for(const key in this.listening)delete this.listening[key]}else{if(!listener)delete this.listening[path];else delete this.listening[listener]}}};var HTTPfrontend=_HTTPfrontend;__publicField(HTTPfrontend,"request",options=>{const xhr=new XMLHttpRequest;if(options.responseType)xhr.responseType=options.responseType;else options.responseType="json";if(options.mimeType){xhr.overrideMimeType(options.mimeType)}if(options.onload)xhr.addEventListener("load",options.onload,false);if(options.onprogress)xhr.addEventListener("progress",options.onprogress,false);if(options.onabort)xhr.addEventListener("abort",options.onabort,false);if(options.onloadend)xhr.addEventListener("loadend",options.onloadend,false);if(options.onerror)xhr.addEventListener("error",options.onerror,false);xhr.open(options.method,options.url,true,options.user,options.pass);if(!options.onerror)xhr.onerror=function(){xhr.abort()};xhr.send(options.data);return xhr});var import_web_worker=__toESM(require_browser());var WorkerService=class extends Service{name="worker";workers={};threadRot=0;connections;constructor(options){super();this.connections={workers:this.workers};if(options?.services)this.addServices(options.services);this.load(this);this.setLoaders(this.workerloader);if(options)this.init(options);if(typeof WorkerGlobalScope!=="undefined"&&globalThis instanceof WorkerGlobalScope){this.addDefaultMessageListener()}}loadWorkerRoute=(rt,routeKey)=>{if(rt.workerUrl)rt.url=rt.workerUrl;if(rt.workerId)rt.__node.tag=rt.workerId;if(!rt.__node.tag)rt.__node.tag=routeKey;rt._id=rt.__node.tag;let worker;if(this.workers[rt._id])worker=this.workers[rt._id];else if(rt.worker)worker=rt.worker;if(!worker){worker=this.addWorker(rt)}rt.worker=worker;if(!rt.worker.__ondisconnected){let ondelete=rt2=>{rt2.worker?.terminate()};rt.__addOndisconnected(ondelete)}if(rt.transferFunctions){for(const prop in rt.transferFunctions){this.transferFunction(worker,rt.transferFunctions[prop],prop)}}if(rt.transferClasses){for(const prop in rt.transferClasses){this.transferClass(worker,rt.transferClasses[prop],prop)}}if(worker){if(!rt.__operator){rt.__operator=(...args)=>{if(rt.callback){if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.post(rt.callback,args);else return worker.run(rt.callback,args)}else{if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.send(args);else return worker.request(args)}}}if(rt.init){worker.run(rt.init,rt.initArgs,void 0,rt.initTransfer)}return worker}};workerloader={"workers":(node,parent,graph,roots)=>{let rt=node;if(!node.parentRoute&&(parent?.callback&&parent?.worker))node.parentRoute=parent?.callback;if(rt?.worker||rt?.workerId||rt?.workerUrl){let worker=this.loadWorkerRoute(rt,rt.__node.tag);if(worker){if(!rt.parentRoute&&rt.__parent?.callback)rt.parentRoute=rt.__parent.callback;if(rt.__parent&&!rt.portId){if(typeof rt.__parent==="string"){if(rt.__node.tag!==rt.__parent&&worker._id!==rt.__parent)rt.portId=this.establishMessageChannel(worker,rt.__parent)}else if(rt.__node.tag!==rt.__parent?.__node?.tag&&worker._id!==rt.__parent?.tag){rt.portId=this.establishMessageChannel(worker,rt.__parent.worker)}};if(rt.parentRoute){if(!rt.stopped){if(typeof rt.__parent==="string"&&rt.__parent===worker._id){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else if(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.parentRoute,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id)&&!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent){if(typeof rt.__parent==="string"){if(!rt.stopped){if(rt.__parent===worker._id){worker.run("subscribe",[rt.__parent,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id))worker.workerSubs[rt.__parent+rt.portId]={sub:null,route:worker._id,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent?.__node?.tag&&rt.__parent?.worker){if(!rt.stopped){if(rt.__node.tag===rt.__parent.__node.tag||worker._id===rt.__parent.__node.tag){worker.run("subscribe",[rt.__parent.__node.tag,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent.__node.tag,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent.__node.tag+rt.portId].sub=sub})}if(!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.__parent.__node.tag+rt.portId]={sub:null,route:rt.__parent.__node.tag,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}}}}else if(rt.__parent&&rt.parentRoute){if(typeof rt.__parent==="string"&&roots[rt.__parent]?.worker){roots[rt.__parent].worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}else if(rt.__parent?.worker){rt.__parent.worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}}return rt}};addDefaultMessageListener=()=>{globalThis.onmessage=ev=>{let result=this.receive(ev.data);if(this.__node.keepState)this.setState({[this.name]:result})}};postMessage=(message,target,transfer)=>{if(this.workers[target]){this.workers[target].send(message,transfer)}else{globalThis.postMessage(message,target,transfer)}};addWorker=options=>{let worker;if(!options._id)options._id=\\`worker\\${Math.floor(Math.random()*1e15)}\\`;if(options.url)worker=new import_web_worker.default(options.url);else if(options.port){worker=options.port}else if(this.workers[options._id]){if(this.workers[options._id].port)worker=this.workers[options._id].port;else worker=this.workers[options._id].worker}if(!worker)return;let send=(message,transfer)=>{return this.transmit(message,worker,transfer)};let post=(route,args,method,transfer)=>{let message={route,args};if(method)message.method=method;return this.transmit(message,worker,transfer)};let run=(route,args,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[{route,args},options._id,callbackId]};if(method)req.args[0].method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let request=(message,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,options._id,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let workerSubs={};let subscribe=(route,callback,args,key,subInput,blocking)=>{return this.subscribeToWorker(route,options._id,callback,args,key,subInput,blocking)};let unsubscribe=(route,sub)=>{return run("unsubscribe",[route,sub])};let start=async(route,portId,callback,blocking)=>{if(route)await run("subscribeToWorker",[route,portId,void 0,callback,blocking]).then(sub=>{if(sub)workerSubs[route+portId]={sub,route,portId,callback,blocking}});else for(const key in workerSubs){if(typeof workerSubs[key].sub!=="number")await run("subscribeToWorker",[workerSubs[key].route,workerSubs[key].portId,void 0,workerSubs[key].callback,void 0,workerSubs[key].blocking]).then(sub=>{workerSubs[key].sub=sub});console.log(JSON.stringify(workerSubs))}return true};let stop=async(route,portId)=>{if(route&&portId&&workerSubs[route+portId]){await run("unsubscribe",[route,workerSubs[route+portId].sub]);workerSubs[route+portId].sub=false}else{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){await run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub]).then(console.log)}workerSubs[key].sub=false}}return true};let terminate=()=>{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub])}workerSubs[key].sub=false}return this.terminate(options._id)};if(!options.onmessage)options.onmessage=ev=>{this.receive(ev.data);this.setState({[options._id]:ev.data})};if(!options.onerror){options.onerror=ev=>{console.error(ev.data)}}worker.onmessage=options.onmessage;worker.onerror=options.onerror;this.workers[options._id]={worker,send,post,run,request,subscribe,unsubscribe,terminate,start,stop,postMessage:worker.postMessage,workerSubs,graph:this,...options};return this.workers[options._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=scriptTemplate=>{let blob=new Blob([scriptTemplate],{type:"text/javascript"});return URL.createObjectURL(blob)};getTransferable(message){let transfer;if(typeof message==="object"){if(message.args){if(message.args?.constructor?.name==="Object"){for(const key in message.args){if(ArrayBuffer.isView(message.args[key])){if(!transfer)transfer=[message.args[key].buffer];else transfer.push(message.args[key].buffer)}else if(message.args[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message.args[key]];else transfer.push(message.args[key])}}}else if(Array.isArray(message.args)&&message.args.length<11){message.args.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg?.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message.args)){transfer=[message.args.buffer]}else if(message.args?.constructor?.name==="ArrayBuffer"){transfer=[message]}}else if(message?.constructor?.name==="Object"){for(const key in message){if(ArrayBuffer.isView(message[key])){if(!transfer)transfer=[message[key].buffer];else transfer.push(message[key].buffer)}else if(message[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message[key]];else transfer.push(message[key])}}}else if(Array.isArray(message)&&message.length<11){message.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message)){transfer=[message.buffer]}else if(message.constructor?.name==="ArrayBuffer"){transfer=[message]}}return transfer}transmit=(message,worker,transfer)=>{if(!transfer){transfer=this.getTransferable(message)}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){worker.postMessage(message,transfer)}else if(typeof worker==="string"){if(this.workers[worker]){if(this.workers[worker].port)this.workers[worker].port.postMessage(message,transfer);else if(this.workers[worker].worker)this.workers[worker].worker.postMessage(message,transfer)}}else{let keys2=Object.keys(this.workers);this.workers[keys2[this.threadRot]].worker.postMessage(message,transfer);this.threadRot++;if(this.threadRot===keys2.length)this.threadRot=0}return message};terminate=worker=>{let onclose;if(typeof worker==="string"){let obj=this.workers[worker];if(obj){delete this.workers[worker];worker=obj.worker;if(obj.onclose)onclose=obj.onclose}}else if(typeof worker==="object"){if(worker?._id){worker=worker.worker;delete this.workers[worker?._id]}}if(worker instanceof import_web_worker.default){worker.terminate();if(onclose)onclose(worker);return true}if(worker instanceof MessagePort){worker.close();if(onclose)onclose(worker);return true}return false};establishMessageChannel=(worker,worker2)=>{let workerId;if(typeof worker==="string"){workerId=worker;if(this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker2=this.workers[worker].worker}}else if(worker?.worker){worker=worker.worker}if(typeof worker2==="string"){if(this.workers[worker2]){if(this.workers[worker2].port)worker2=this.workers[worker2].port;else worker2=this.workers[worker2].worker}}else if(worker2?.worker){worker2=worker2.worker}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){let channel=new MessageChannel;let portId=\\`port\\${Math.floor(Math.random()*1e15)}\\`;worker.postMessage({route:"addWorker",args:{port:channel.port1,_id:portId}},[channel.port1]);if(worker2 instanceof import_web_worker.default||worker2 instanceof MessagePort){worker2.postMessage({route:"addWorker",args:{port:channel.port2,_id:portId}},[channel.port2])}else if(workerId&&this.workers[workerId]){channel.port2.onmessage=this.workers[workerId].onmessage;this.workers[workerId].port=channel.port2}return portId}return false};request=(message,workerId,transfer,method)=>{let worker=this.workers[workerId].worker;return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};runRequest=(message,worker,callbackId)=>{let res=this.receive(message);if(typeof worker==="string"&&this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}if(res instanceof Promise){res.then(r=>{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:r,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:r,callbackId})})}else{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:res,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:res,callbackId})}return res};subscribeWorker=(route,worker,args,key,subInput,blocking)=>{let callback;if(blocking){let blocked=false;callback=res=>{if(!blocked){blocked=true;if(res instanceof Promise){res.then(r=>{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,r]).then(ret=>{blocked=false})})}else{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,res]).then(ret=>{blocked=false})}}}}else{callback=res=>{if(res instanceof Promise){res.then(r=>{if(worker?.postMessage)worker.postMessage({args:r,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:r,callbackId:route})})}else{if(worker?.postMessage)worker.postMessage({args:res,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:res,callbackId:route})}}}if(!blocking&&worker?.port){worker=worker.port}else if(!blocking&&worker?.worker){worker=worker.worker}else if(typeof worker==="string"&&this.workers[worker]){if(blocking)worker=this.workers[worker];else if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}return this.subscribe(route,callback,args,key,subInput)};subscribeToWorker=(route,workerId,callback,args,key,subInput,blocking)=>{if(typeof workerId==="string"&&this.workers[workerId]){this.__node.state.subscribeEvent(workerId,res=>{if(res?.callbackId===route){if(!callback)this.setState({[workerId]:res.args});else if(typeof callback==="string"){this.run(callback,res.args)}else callback(res.args)}});return this.workers[workerId].run("subscribeWorker",[route,workerId,args,key,subInput,blocking])}};triggerSubscription=async(route,workerId,result)=>{if(this.__node.state.triggers[workerId])for(let i2=0;i2<this.__node.state.triggers[workerId].length;i2++){await this.__node.state.triggers[workerId][i2].onchange({args:result,callbackId:route})}return true};pipeWorkers=(sourceWorker,listenerWorker,sourceRoute,listenerRoute,portId,args,key,subInput,blocking)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof listenerWorker==="string")listenerWorker=this.workers[listenerWorker];if(!portId){portId=this.establishMessageChannel(sourceWorker.worker,listenerWorker.worker)}return listenerWorker.run("subscribeToWorker",[sourceRoute,portId,listenerRoute,args,key,subInput,blocking])};unpipeWorkers=(sourceRoute,sourceWorker,sub)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof sourceWorker==="object"){return sourceWorker.run("unsubscribe",[sourceRoute,sub])}}};var mouseEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]);var wheelEventHandlerImpl=makeSendPropertiesHandler(["deltaX","deltaY"]);var keydownEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function focusEventHandler(event,sendFn){const data={type:event.type};data.isTrusted=event.isTrusted;data.bubbles=event.bubbles;data.cancelBubble=event.cancelBubble;data.cancelable=event.cancelable;data.composed=event.composed;data.defaultPrevent=event.defaultPrevented;data.eventPhase=event.eventPhase;data.returnValue=event.returnValue;data.currentTarget=event.currentTarget.id?event.currentTarget.id:event.currentTarget.constructor.name;data.target=data.currentTarget;data.srcElement=data.currentTarget;sendFn(data)}function wheelEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();wheelEventHandlerImpl(event,sendFn)}function preventDefaultHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault()}function copyProperties(src,properties,dst){for(const name2 of properties){dst[name2]=src[name2]}}function makeSendPropertiesHandler(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties(event,properties,data);sendFn(data)}}function touchEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();const touches=[];const data={type:event.type,touches};for(let i2=0;i2<event.touches.length;++i2){const touch=event.touches[i2];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var i=1;var keys={};while(i<222){keys[i]=true;i++}function filteredKeydownEventHandler(event,sendFn,preventDefault){let{keyCode}=event;if(keys[keyCode]){if(preventDefault&&event.preventDefault&&(keyCode<110||keyCode>123))event.preventDefault();keydownEventHandler(event,sendFn)}}var eventHandlers={contextmenu:preventDefaultHandler,mousedown:mouseEventHandler,mousemove:mouseEventHandler,mouseup:mouseEventHandler,pointerdown:mouseEventHandler,pointermove:mouseEventHandler,pointerup:mouseEventHandler,pointerlockchange:mouseEventHandler,webkitpointerlockchange:mouseEventHandler,focus:focusEventHandler,blur:focusEventHandler,pointerout:mouseEventHandler,touchstart:touchEventHandler,touchmove:touchEventHandler,touchend:touchEventHandler,wheel:wheelEventHandler,keydown:filteredKeydownEventHandler,keyup:filteredKeydownEventHandler};function initProxyElement(element,worker,id,preventDefault){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{if(!worker){handleProxyEvent(data,id)}else worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent,preventDefault)})}if(eventHandlers.keydown){globalThis.addEventListener("keydown",function(ev){eventHandlers.keydown(ev,sendEvent,preventDefault)})}if(eventHandlers.keyup){globalThis.addEventListener("keyup",function(ev){eventHandlers.keyup(ev,sendEvent,preventDefault)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher=class{__listeners;addEventListener(type,listener){if(this.__listeners===void 0)this.__listeners={};const listeners=this.__listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this.__listeners===void 0)return false;const listeners=this.__listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i2=0,l=array.length;i2<l;i2++){array[i2].call(this,event)}}}};function noop(){}var ElementProxyReceiver=class extends EventDispatcher{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super();this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.style.width=this.width+"px";this.proxied.style.height=this.height+"px";this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop;data.stopPropagation=noop;this.dispatchEvent(data,this.proxied)};focus(){}blur(){}};var ProxyManager=class{targets={};constructor(){if(!globalThis.document)globalThis.document={elementFromPoint:(...args)=>{return this.targets[Object.keys(this.targets)[0]].proxied}}}makeProxy=(id,addTo=void 0)=>{if(!id)id=\\`proxyReceiver\\${Math.floor(Math.random()*1e15)}\\`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;if(typeof WorkerGlobalScope!=="undefined")addTo.style=proxy.style;if(proxy.width){addTo.style.width=proxy.width+"px";addTo.clientWidth=proxy.width}if(proxy.height){addTo.style.height=proxy.height+"px";addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy);addTo.blur=proxy.blur.bind(proxy)}};getProxy=id=>{return this.targets[id]};handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0}};function makeProxy(id,elm){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;this.__node.graph.ProxyManager.makeProxy(id,elm)}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;globalThis.ProxyManager.makeProxy(id,elm)}return id}function handleProxyEvent(data,id){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;if(this.__node.graph.ProxyManager.handleEvent(data,id))return data}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;if(globalThis.ProxyManager.handleEvent(data,id))return data}}var proxyElementWorkerRoutes={initProxyElement,makeProxy,handleProxyEvent};function Renderer(options){if(options.worker){let worker=options.worker;let route=options.route;if(worker instanceof Blob||typeof worker==="string"){worker=new Worker(worker)}delete options.worker;delete options.route;return transferCanvas(worker,options,route)}else{initProxyElement(options.canvas,void 0,options._id,options.preventDefault);return setupCanvas(options)}}function transferCanvas(worker,options,route){if(!options)return void 0;if(!options._id)options._id=\\`canvas\\${Math.floor(Math.random()*1e15)}\\`;let offscreen=options.canvas.transferControlToOffscreen();if(!options.width)options.width=options.canvas.clientWidth;if(!options.height)options.height=options.canvas.clientHeight;let message={route:route?route:"setupCanvas",args:{...options,canvas:offscreen}};if(this?.__node?.graph)this.__node.graph.run("initProxyElement",options.canvas,worker,options._id,options.preventDefault);else initProxyElement(options.canvas,worker,options._id,options.preventDefault);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let tr=[offscreen];if(options.transfer){tr.push(...options.transfer);delete options.transfer}worker.postMessage(message,tr);const canvascontrols={_id:options._id,width:options.width,height:options.height,worker,draw:(props,transfer)=>{worker.postMessage({route:"drawFrame",args:[props,options._id]},transfer)},update:(props,transfer)=>{worker.postMessage({route:"updateCanvas",args:[props,options._id]},transfer)},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:(newDrawProps,transfer)=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]},transfer)},terminate:()=>{worker.terminate()}};return canvascontrols}function setDraw(settings,_id){let canvasopts;if(this?.__node?.graph){if(_id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]}else{if(_id)canvasopts=globalThis.CANVASES?.[settings._id];else if(settings._id)canvasopts=globalThis.CANVASES?.[settings._id];else canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]]}if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasopts._id,canvasopts.canvas);else proxyElementWorkerRoutes.makeProxy(canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText3(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw.bind(settings)}if(typeof settings.update==="string")settings.update=parseFunctionFromText3(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update.bind(settings)}if(typeof settings.init==="string")settings.init=parseFunctionFromText3(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init.bind(settings)}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText3(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear.bind(settings)}return settings._id}return void 0}function setupCanvas(options){if(this?.__node?.graph){if(!this.__node.graph.CANVASES)this.__node.graph.CANVASES={}}else if(!globalThis.CANVASES)globalThis.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=\\`canvas\\${Math.floor(Math.random()*1e15)}\\`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this?.__node?.graph?.CANVASES[canvasOptions._id]){this.__node.graph.run("setDraw",canvasOptions)}else if(globalThis.CANVASES?.[canvasOptions._id]){setDraw(canvasOptions)}else{if(this?.__node?.graph){canvasOptions.graph=this.__node.graph;if(!canvasOptions.__node){canvasOptions.__node={}}if(!canvasOptions.__node.tag)canvasOptions.__node.tag=canvasOptions._id;canvasOptions=this.__node.graph.add(canvasOptions);canvasOptions.__addOndisconnected=()=>{canvasOptions.stop();delete this.__node.graph.CANVASES[canvasOptions._id]}}if(this?.__node?.graph)this.__node.graph.CANVASES[canvasOptions._id]=canvasOptions;else globalThis.CANVASES[canvasOptions._id]=canvasOptions;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);else proxyElementWorkerRoutes.makeProxy(canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText3(canvasOptions.draw)}else if(typeof canvasOptions.draw==="function"){canvasOptions.draw=canvasOptions.draw.bind(canvasOptions)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText3(canvasOptions.update)}else if(typeof canvasOptions.update==="function"){canvasOptions.update=canvasOptions.update.bind(canvasOptions)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText3(canvasOptions.init)}else if(typeof canvasOptions.init==="function"){canvasOptions.init=canvasOptions.init.bind(canvasOptions)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText3(canvasOptions.clear)}else if(typeof canvasOptions.clear==="function"){canvasOptions.clear=canvasOptions.clear.bind(canvasOptions)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);canvasOptions.stop=()=>{stopAnim(canvasOptions._id)};canvasOptions.start=draw=>{startAnim(canvasOptions._id,draw)};canvasOptions.set=settings=>{setDraw(settings,canvasOptions._id)};if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)return canvasOptions._id;else{const canvascontrols={_id:options._id,width:options.width,height:options.height,draw:props=>{drawFrame(props,options._id)},update:props=>{updateCanvas(props,options._id)},clear:()=>{clearCanvas(options._id)},init:()=>{initCanvas(options._id)},stop:()=>{stopAnim(options._id)},start:()=>{startAnim(options._id)},set:newDrawProps=>{setDraw(newDrawProps,options._id)},terminate:()=>{if(this.__node?.graph)this.__node.graph.remove(options._id);else{stopAnim(options._id);if(this?.__node?.graph)delete this.__node.graph.CANVASES[canvasOptions._id];else delete globalThis.CANVASES[canvasOptions._id]}}};return canvascontrols}}function drawFrame(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0}function clearCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function initCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function updateCanvas(input,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0}function setProps(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0}function startAnim(_id,draw){let canvasopts=getCanvas.call(this,_id);canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText3(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function stopAnim(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")requestAnimationFrame(canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context));return _id}return void 0}function getCanvas(_id){let canvasopts;if(this?.__node?.graph){if(!_id)canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]];else canvasopts=this.__node.graph.CANVASES?.[_id]}else{if(!_id)canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]];else canvasopts=globalThis.CANVASES?.[_id]}return canvasopts}var workerCanvasRoutes={...proxyElementWorkerRoutes,Renderer,transferCanvas,setupCanvas,setDraw,drawFrame,clearCanvas,initCanvas,updateCanvas,setProps,startAnim,stopAnim,getCanvas};function parseFunctionFromText3(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\\\W*(function[^{]+\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>[^{]*\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var _ArrayManip=class{constructor(){this.recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"){if(typeof target[key]==="object")this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target}}static autoscale(array,lineIdx=0,nLines=1,centerZero=false,ymin,ymax,clamp){if(array?.length===0)return array;let max=ymax?ymax:Math.max(...array);let min=ymin?ymin:Math.min(...array);let _lines=1/nLines;let scalar=1;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));if(absmax!==0)scalar=_lines/absmax;return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return y2*scalar+(_lines*(lineIdx+1)*2-1-_lines)})}else{if(max===min){if(max!==0){scalar=_lines/max}else if(min!==0){scalar=_lines/Math.abs(min)}}else scalar=_lines/(max-min);return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return 2*((y2-min)*scalar-1/(2*nLines))+(_lines*(lineIdx+1)*2-1-_lines)})}}static genTimestamps(ct,sps10){let now=Date.now();let toInterp=[now-ct*1e3/sps10,now];return _ArrayManip.upsample(toInterp,ct)}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i2=incr;i2<array.length;i2+=incr){let rounded=Math.round(i2);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static upsample(array,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array(fitCount);var springFactor=(array.length-1)/(fitCount-1);newData[0]=array[0];for(var i2=1;i2<fitCount-1;i2++){var tmp=i2*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i2]=linearInterpolate(array[before],array[after],atPoint)}newData[fitCount-1]=array[array.length-1];return newData}static interpolate(array,fitCount,scalar=1){if(array.length>fitCount){return _ArrayManip.downsample(array,fitCount,scalar)}else if(array.length<fitCount){return _ArrayManip.upsample(array,fitCount,scalar)}return array}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x;b=0}else if(60<=h&&h<120){r=x;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x}else if(180<=h&&h<240){r=0;g=x;b=c}else if(240<=h&&h<300){r=x;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static circularBuffer(arr,newEntries){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,newEntries.slice(len-newEntries.length))}else{arr.splice(0,arr.length,...newEntries)}return arr}static reformatData(data,key){if(Array.isArray(data)){if(Array.isArray(data[0])){let d={};data.forEach((arr,i2)=>{d[i2]=arr});data=d;if(isNaN(data[0][0]))return void 0}else if(key){data={[key]:data};if(isNaN(data[key][0]))return void 0}else{data={0:data};if(isNaN(data[0][0]))return void 0}}else if(typeof data==="object"){for(const key2 in data){if(typeof data[key2]==="number")data[key2]=[data[key2]];else if(data[key2]?.values){if(typeof data[key2].values==="number")data[key2].values=[data[key2].values]}if(isNaN(data[key2][0]))return void 0}}else if(typeof data==="string"){let split;if(data.includes("\\\\r\\\\n")){let lines=data.split("\\\\r\\\\n");data={};lines.forEach((l,j)=>{if(l.includes("	")){split=l.split("	")}else if(l.includes(",")){split=l.split(",")}else if(l.includes("|")){split=l.split("|")}if(Array.isArray(split)){split.forEach((val,i2)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl=parseFloat(v);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i2]=[fl];else return void 0}})}})}else if(data.includes("	")){split=data.split("	")}else if(data.includes(",")){split=data.split(",")}else if(data.includes("|")){split=data.split("|")}data={};if(Array.isArray(split)){split.forEach((val,i2)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl=parseFloat(v);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i2]=[fl];else return void 0}})}}else if(typeof data==="number"){if(key)data={[key]:[data]};else data={0:[data]}}return data}static padTime(data,lastValue,time,targetFit){let slopeIncr=(data[0]-lastValue)/time/targetFit;let padded=[...new Array(targetFit-data.length).map((_,i2)=>lastValue+slopeIncr*(i2+1)),...data];return padded}static interpolateForTime(data,time,targetSPS){return _ArrayManip.interpolate(data,Math.ceil(targetSPS*time))}isTypedArray(x){return ArrayBuffer.isView(x)&&Object.prototype.toString.call(x)!=="[object DataView]"}spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var ArrayManip=_ArrayManip;ArrayManip.bufferValues=(objects,property,keys2,buffer)=>{if(!Array.isArray(keys2)&&typeof keys2==="object")keys2=Object.keys(keys2);if(!buffer){let object_keys=Object.keys(objects);if(keys2)buffer=new Float32Array(object_keys.length*keys2.length);else{if(typeof objects[object_keys[0]][property]==="object"){keys2=Object.keys(objects[object_keys[0]][property]);buffer=new Float32Array(object_keys.length*keys2.length)}else buffer=new Float32Array(object_keys.length)}}let i2=0;for(const key in objects){if(objects[key][property]){if(keys2){for(let j=0;j<keys2.length;j++){buffer[i2]=objects[key][property][keys2[j]];i2++}}else{buffer[i2]=objects[key][property];i2++}}}return buffer};var rechk=/^([<>])?(([1-9]\\\\d*)?([xcbB?hHiIfdsp]))*$/;var refmt=/([1-9]\\\\d*)?([xcbB?hHiIfdsp])/g;var str=(v,o,c)=>String.fromCharCode(...new Uint8Array(v.buffer,v.byteOffset+o,c));var rts=(v,o,c,s)=>new Uint8Array(v.buffer,v.byteOffset+o,c).set(s.split("").map(str2=>str2.charCodeAt(0)));var pst=(v,o,c)=>str(v,o+1,Math.min(v.getUint8(o),c-1));var tsp=(v,o,c,s)=>{v.setUint8(o,s.length);rts(v,o+1,c-1,s)};var lut=le=>({x:c=>[1,c,0],c:c=>[c,1,o=>({u:v=>str(v,o,1),p:(v,c2)=>rts(v,o,1,c2)})],"?":c=>[c,1,o=>({u:v=>Boolean(v.getUint8(o)),p:(v,B2)=>v.setUint8(o,B2)})],b:c=>[c,1,o=>({u:v=>v.getInt8(o),p:(v,b)=>v.setInt8(o,b)})],B:c=>[c,1,o=>({u:v=>v.getUint8(o),p:(v,B2)=>v.setUint8(o,B2)})],h:c=>[c,2,o=>({u:v=>v.getInt16(o,le),p:(v,h)=>v.setInt16(o,h,le)})],H:c=>[c,2,o=>({u:v=>v.getUint16(o,le),p:(v,H2)=>v.setUint16(o,H2,le)})],i:c=>[c,4,o=>({u:v=>v.getInt32(o,le),p:(v,i2)=>v.setInt32(o,i2,le)})],I:c=>[c,4,o=>({u:v=>v.getUint32(o,le),p:(v,I)=>v.setUint32(o,I,le)})],f:c=>[c,4,o=>({u:v=>v.getFloat32(o,le),p:(v,f)=>v.setFloat32(o,f,le)})],d:c=>[c,8,o=>({u:v=>v.getFloat64(o,le),p:(v,d)=>v.setFloat64(o,d,le)})],s:c=>[1,c,o=>({u:v=>str(v,o,c),p:(v,s)=>rts(v,o,c,s.slice(0,c))})],p:c=>[1,c,o=>({u:v=>pst(v,o,c),p:(v,s)=>tsp(v,o,c,s.slice(0,c-1))})]});var errbuf=new RangeError("Structure larger than remaining buffer");var errval=new RangeError("Not enough values for structure");var _ByteParser=class extends ArrayManip{static toDataView(value){if(!(value instanceof DataView)){if(typeof value==="string"&&parseInt(value))value=parseInt(value);if(typeof value==="string"){let enc=new TextEncoder;let hascodes={};for(const code in _ByteParser.codes){while(value.indexOf(code)>-1){let idx=value.indexOf(code);value=value.replace(code,"");hascodes[idx]=code}}let encoded=Array.from(enc.encode(value));for(const key in hascodes){encoded.splice(parseInt(key),0,_ByteParser.codes[hascodes[key]])}value=new DataView(new Uint8Array(encoded).buffer)}else if(typeof value==="number"){let tmp=value;if(value<256){value=new DataView(new ArrayBuffer(1));value.setUint8(0,tmp)}else if(value<65536){value=new DataView(new ArrayBuffer(2));value.setInt16(0,tmp)}else{value=new DataView(new ArrayBuffer(4));value.setUint32(0,tmp)}}else if(value instanceof ArrayBuffer||typeof SharedArrayBuffer!=="undefined"&&value instanceof SharedArrayBuffer){value=new DataView(value)}else if(Array.isArray(value)){value=new DataView(Uint8Array.from(value).buffer)}else if(typeof value==="object"){value=new TextEncoder().encode(JSON.stringify(value))}}return value}static searchBuffer(buffer,searchString,limit){var needle=searchString;var haystack=buffer;var search=_ByteParser.boyerMoore(needle);var skip=search.byteLength;var indices=[];for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){indices.push(i2);if(limit){if(indices.length>=limit)break}}return indices}static bytesToInt16(x0,x1){let int16=(255&x0)<<8|255&x1;if((int16&32768)>0){int16|=4294901760}else{int16&=65535}return int16}static bytesToUInt16(x0,x1){return x0*256+x1}static Uint16ToBytes(y2){return[y2&255,y2>>8&255]}static bytesToInt24(x0,x1,x2){let int24=(255&x0)<<16|(255&x1)<<8|255&x2;if((int24&8388608)>0){int24|=4278190080}else{int24&=16777215}return int24}static bytesToUInt24(x0,x1,x2){return x0*65536+x1*256+x2}static Uint24ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255]}static bytesToInt32(x0,x1,x2,x3){let int32=(255&x0)<<24|(255&x1)<<16|(255&x2)<<8|255&x3;if((int32&2147483648)>0){int32|=0}else{int32&=4294967295}return int32}static bytesToUInt32(x0,x1,x2,x3){return x0*16777216+x1*65536+x2*256+x3}static Uint32ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255,y2>>24&255]}static get2sCompliment(val,nbits4){if(val>4294967296)return null;return val<<32-nbits4>>32-nbits4}static getSignedInt(...args){let pos=0;function getInt(size){var value=0;var first=true;while(size--){if(first){let byte=args[pos++];value+=byte&127;if(byte&128){value-=128}first=false}else{value*=256;value+=args[pos++]}}return value}return getInt(args.length)}static asUint8Array(input){if(input instanceof Uint8Array){return input}else if(typeof input==="string"){var arr=new Uint8Array(input.length);for(var i2=0;i2<input.length;i2++){var c=input.charCodeAt(i2);if(c>127){throw new TypeError("Only ASCII patterns are supported")}arr[i2]=c}return arr}else{return new Uint8Array(input)}}static boyerMoore(patternBuffer){var pattern=_ByteParser.asUint8Array(patternBuffer);var M=pattern.length;if(M===0){throw new TypeError("patternBuffer must be at least 1 byte long")}var R=256;var rightmost_positions=new Int32Array(R);for(var c=0;c<R;c++){rightmost_positions[c]=-1}for(var j=0;j<M;j++){rightmost_positions[pattern[j]]=j}var boyerMooreSearch=(txtBuffer,start,end)=>{var txt=_ByteParser.asUint8Array(txtBuffer);if(start===void 0)start=0;if(end===void 0)end=txt.length;var pat=pattern;var right=rightmost_positions;var lastIndex=end-pat.length;var lastPatIndex=pat.length-1;var skip;for(var i2=start;i2<=lastIndex;i2+=skip){skip=0;for(var j2=lastPatIndex;j2>=0;j2--){var c2=txt[i2+j2];if(pat[j2]!==c2){skip=Math.max(1,j2-right[c2]);break}}if(skip===0){return i2}}return-1};boyerMooreSearch.byteLength=pattern.byteLength;return boyerMooreSearch}static struct(format){let fns=[],size=0,m=rechk.exec(format);if(!m){throw new RangeError("Invalid format string")}const t2=lut("<"===m[1]),lu=(n,c)=>t2[c](n?parseInt(n,10):1);while(m=refmt.exec(format)){((r,s,f)=>{for(let i2=0;i2<r;++i2,size+=s){if(f){fns.push(f(size))}}})(...lu(...m.slice(1)))}const unpack_from=(arrb,offs)=>{if(arrb.byteLength<(offs|0)+size){throw errbuf}let v=new DataView(arrb,offs|0);return fns.map(f=>f.u(v))};const pack_into=(arrb,offs,...values)=>{if(values.length<fns.length){throw errval}if(arrb.byteLength<offs+size){throw errbuf}const v=new DataView(arrb,offs);new Uint8Array(arrb,offs,size).fill(0);fns.forEach((f,i2)=>f.p(v,values[i2]))};const pack=(...values)=>{let b=new ArrayBuffer(size);pack_into(b,0,...values);return b};const unpack=arrb=>unpack_from(arrb,0);function*iter_unpack(arrb){for(let offs=0;offs+size<=arrb.byteLength;offs+=size){yield unpack_from(arrb,offs)}}return Object.freeze({unpack,pack,unpack_from,pack_into,iter_unpack,format,size})}};var ByteParser=_ByteParser;ByteParser.codes={"\\\\\\\\n":10,"\\\\\\\\r":13,"\\\\\\\\t":9,"\\\\\\\\s":32,"\\\\\\\\b":8,"\\\\\\\\f":12,"\\\\\\\\":92};(function(s){var w,f={},l=console,m=Math,z2="postMessage",x="HackTimer.js by turuslan: ",v="Initialisation failed",p=0,r="hasOwnProperty",y2=[].slice,b=Worker;function d(){do{p=2147483647>p?p+1:0}while(f[r](p));return p}if(!/MSIE 10/i.test(navigator.userAgent)){try{s=URL.createObjectURL(new Blob(["var f={},p=postMessage,r=\'hasOwnProperty\';onmessage=function(e){var d=e.data,i=d.i,t=d[r](\'t\')?d.t:0;switch(d.n){case\'a\':f[i]=setInterval(function(){p(i)},t);break;case\'b\':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case\'c\':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case\'d\':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch(e){}}if(typeof b!=="undefined"){try{w=new b(s);setInterval=function(c,t2){var i2=d();f[i2]={c,p:y2.call(arguments,2)};w[z2]({n:"a",i:i2,t:t2});return i2};clearInterval=function(i2){if(f[r](i2))delete f[i2],w[z2]({n:"b",i:i2})};setTimeout=function(c,t2){var i2=d();f[i2]={c,p:y2.call(arguments,2),t:true};w[z2]({n:"c",i:i2,t:t2});return i2};clearTimeout=function(i2){if(f[r](i2))delete f[i2],w[z2]({n:"d",i:i2})};w.onmessage=function(e){var i2=e.data,c,n;if(f[r](i2)){n=f[i2];c=n.c;if(n[r]("t"))delete f[i2]}if(typeof c=="string")try{c=new Function(c)}catch(k){l.log(x+"Error parsing callback code string: ",k)}if(typeof c=="function")c.apply(globalThis,n.p)};w.onerror=function(e){l.log(e)}}catch(e){l.log(x+v);l.error(e)}}else l.log(x+v+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js");var WebSerial=class extends ByteParser{constructor(){super(...arguments);this.streams={};this.createStream=options=>{let stream={_id:options._id?options._id:\\`stream\\${Math.floor(Math.random()*1e15)}\\`,info:options.port.getInfo(),running:false,...options};if(options.port?.readable){if(options.transforms){stream.reader=WebSerial.setStreamTransforms(options.port.readable,options.transforms).getReader()}else{stream.reader=options.port.readable.getReader()}}this.streams[stream._id]=stream;return stream}}getPorts(){return navigator.serial.getPorts()}requestPort(usbVendorId,usbProductId){let options={};if(usbVendorId){options.usbVendorId=usbVendorId}if(usbProductId){options.usbProductId=usbProductId}if(options.usbVendorId)return navigator.serial.requestPort({filters:[options]});else return navigator.serial.requestPort()}openPort(port,options){if(options)options=Object.assign({},options);if(options?.ondisconnect){port.ondisconnect=options.ondisconnect;delete options.ondisconnect}return port.open(options).then(()=>{if(options?.onconnect)options.onconnect(port)})}async readWithTimeout(port,timeout){const reader=port.readable.getReader();const timer=setTimeout(()=>{reader.releaseLock()},timeout);const result=await reader.read();clearTimeout(timer);reader.releaseLock();return result}async writePort(port,message){const writer=port.writable.getWriter();await writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}getSignals(port){return port.getSignals()}setSignals(port,signals){return port.setSignals(signals)}readStream(stream){if(stream.reader&&!stream.running){let reader=stream.reader;if(stream.buffering){if(typeof stream.buffering!=="object")stream.buffering={};if(!stream.buffering.buffer){stream.buffering.buffer=[]}if(!stream.buffering.searchBytes)stream.buffering.searchBytes=new Uint8Array([13,10])}let readLoop=()=>{if(stream.port.readable&&stream.running){reader.read().then(result=>{if(result.done)reader.releaseLock();else{if(stream.buffering){stream.buffering.buffer.push(...result.value);const needle=stream.buffering.searchBytes;const haystack=stream.buffering.buffer;const search=WebSerial.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=stream.buffering.lockIdx??0;for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){if(!stream.buffering.locked&&!("lockIdx"in stream.buffering))used=stream.buffering.lockIdx=i2;else{nextIndex=i2;if(nextIndex>=0){const len=nextIndex-used;if(!stream.buffering.locked){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(data);stream.buffering.locked=true}else if(len>0){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(new Uint8Array(data))}used=nextIndex}}}}else stream.ondata(result.value);setTimeout(()=>{readLoop()},stream.frequency)}}).catch(er=>{console.error(stream._id," Read error:",er);if(er.message.includes("overrun")||er.message.includes("framing")){delete stream.reader;this.reconnect(stream)}})}else if(!stream.running&&stream.port.readable){try{reader.releaseLock()}catch(er){console.error(er)}}};stream.running=true;readLoop();return stream}return void 0}writeStream(stream,message){if(typeof stream==="string")stream=this.streams[stream];if(stream.port.writable){let writer=stream.port.writable.getWriter();writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}return void 0}closeStream(stream,onclose){if(typeof stream==="string")stream=this.streams[stream];stream.running=false;return new Promise((res,rej)=>{if(stream.settings.beforedisconnect){stream.settings.beforedisconnect(this,stream.port)}setTimeout(async()=>{if(stream.port.readable&&stream.reader){try{stream.reader.releaseLock()}catch(er){console.error(er)}if(stream.transforms)try{await stream.reader.cancel()}catch(err){console.error(err)}}try{await stream.port.close().then(()=>{if(onclose)onclose(this.streams[stream._id])});delete this.streams[stream._id];res(true)}catch(er){rej(er)}},300)})}reconnect(stream,options){if(typeof stream==="string")stream=this.streams[stream];return new Promise((res,rej)=>{if(typeof stream!=="object"){rej(void 0);return}let info=stream.port.getInfo();this.closeStream(stream._id).then(closed=>{setTimeout(()=>{this.getPorts().then(ports=>{for(let i2=0;i2<ports.length;i2++){if(ports[i2].getInfo().usbVendorId===info.usbVendorId&&ports[i2].getInfo().usbProductId===info.usbProductId){if(!options)options=stream;else options._id=stream._id;delete options.port;this.openPort(ports[i2],options.settings).then(()=>{const stream2=this.createStream({...options,port:ports[i2]});this.readStream(stream2);res(stream2)}).catch(rej)}}}).catch(rej)},100)})})}static setStreamTransforms(stream,transforms){let transform=[];Object.keys(transforms).forEach(t2=>{let opt=transforms[t2];if(opt instanceof TransformStream){transform.push(opt)}else{if(!opt.start)opt.start=function start(){};if(!opt.flush)opt.flush=function flush(){};let transformer=new TransformStream({start:opt.start,transform:opt.transform,flush:opt.flush},opt.writableStrategy,opt.readableStrategy);transform.push(transformer)}});let str2=stream;transform.forEach(transform2=>{str2=str2.pipeThrough(transform2)});return str2}};var sps=250;var gain=32;var nbits=24;var vref=1.2;var half24bit=Math.pow(2,24)/2;function ads131m08codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i2=0;i2<9;i2++){let j=i2*25;output[0][i2]=ByteParser.bytesToInt24(arr[j],arr[j+1],arr[j+2]);output[1][i2]=ByteParser.bytesToInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i2]=ByteParser.bytesToInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i2]=ByteParser.bytesToInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i2]=ByteParser.bytesToInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i2]=ByteParser.bytesToInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i2]=ByteParser.bytesToInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i2]=ByteParser.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])}if(arr.length>225){output.leds=arr.slice(225)}return output}function ads131m08codec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i2=0;i2<9;i2++){let j=i2*25;output[0][i2]=ByteParser.bytesToInt24(arr[j],arr[j+1],arr[j+2])+half24bit;output[1][i2]=ByteParser.bytesToInt24(arr[j+3],arr[j+4],arr[j+5])+half24bit;output[2][i2]=ByteParser.bytesToInt24(arr[j+6],arr[j+7],arr[j+8])+half24bit;output[3][i2]=ByteParser.bytesToInt24(arr[j+9],arr[j+10],arr[j+11])+half24bit;output[4][i2]=ByteParser.bytesToInt24(arr[j+12],arr[j+13],arr[j+14])+half24bit;output[5][i2]=ByteParser.bytesToInt24(arr[j+15],arr[j+16],arr[j+17])+half24bit;output[6][i2]=ByteParser.bytesToInt24(arr[j+18],arr[j+19],arr[j+20])+half24bit;output[7][i2]=ByteParser.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])+half24bit}if(arr.length>225){output.leds=arr.slice(225)}return output}var decoder=new TextDecoder;function ads131m08_arduinocodec(data){const parsed=decoder.decode(data);let split;if(parsed.includes("|"))split=parsed.split("|");else if(split.includes(","))split=parsed.split(",");else split=parsed.split("	");return{"0":parseInt(split[0]),"1":parseInt(split[1]),"2":parseInt(split[2]),"3":parseInt(split[3]),"4":parseInt(split[4]),"5":parseInt(split[5]),"6":parseInt(split[6]),"7":parseInt(split[7]),timestamp:Date.now()}}var defaultChartSetting={nSec:10,sps,units:"mV"};var ads131m08ChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting)),"1":JSON.parse(JSON.stringify(defaultChartSetting)),"2":JSON.parse(JSON.stringify(defaultChartSetting)),"3":JSON.parse(JSON.stringify(defaultChartSetting)),"4":JSON.parse(JSON.stringify(defaultChartSetting)),"5":JSON.parse(JSON.stringify(defaultChartSetting)),"6":JSON.parse(JSON.stringify(defaultChartSetting)),"7":JSON.parse(JSON.stringify(defaultChartSetting))}};var defaultsetting={sps,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))};var halfOffset=.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))*(Math.pow(2,nbits)-1)*.5;var ads131m08FilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting)),"1":JSON.parse(JSON.stringify(defaultsetting)),"2":JSON.parse(JSON.stringify(defaultsetting)),"3":JSON.parse(JSON.stringify(defaultsetting)),"4":JSON.parse(JSON.stringify(defaultsetting)),"5":JSON.parse(JSON.stringify(defaultsetting)),"6":JSON.parse(JSON.stringify(defaultsetting)),"7":JSON.parse(JSON.stringify(defaultsetting))};var accScale=.002/Math.pow(2,4);var getAcc=(arr,output,channels=8)=>{const accIdx=channels*3+1;const sum=(a,b)=>a+b;const accSum=arr.slice(accIdx).reduce(sum,0);if(accSum!==0){output.ax=accScale*ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output.ay=accScale*ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output.az=accScale*ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5])}};function cytoncodec(data){let arr;if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<8;i2++){let idx=1+3*i2;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);output.timestamp=Date.now();return output}function daisycytoncodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<8;i2++){let idx=1+3*i2;if(arr[0]%2===0)output[i2+7]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2]);else output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);return output}var sps2=250;var cytonSerialSettings={deviceType:"USB",deviceName:"cyton",baudRate:115200,codec:cytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var daisycytonSerialSettings={deviceType:"USB",deviceName:"cyton_daisy",baudRate:115200,codec:daisycytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var defaultChartSetting2={nSec:10,sps:sps2,units:"mV"};var defaultChartSetting22={nSec:10,sps:sps2};var cytonChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting2)),"1":JSON.parse(JSON.stringify(defaultChartSetting2)),"2":JSON.parse(JSON.stringify(defaultChartSetting2)),"3":JSON.parse(JSON.stringify(defaultChartSetting2)),"4":JSON.parse(JSON.stringify(defaultChartSetting2)),"5":JSON.parse(JSON.stringify(defaultChartSetting2)),"6":JSON.parse(JSON.stringify(defaultChartSetting2)),"7":JSON.parse(JSON.stringify(defaultChartSetting2)),"ax":JSON.parse(JSON.stringify(defaultChartSetting22)),"ay":JSON.parse(JSON.stringify(defaultChartSetting22)),"az":JSON.parse(JSON.stringify(defaultChartSetting22))},generateNewLines:true};var defaultsetting2={sps:sps2,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))};var cytonFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting2)),"1":JSON.parse(JSON.stringify(defaultsetting2)),"2":JSON.parse(JSON.stringify(defaultsetting2)),"3":JSON.parse(JSON.stringify(defaultsetting2)),"4":JSON.parse(JSON.stringify(defaultsetting2)),"5":JSON.parse(JSON.stringify(defaultsetting2)),"6":JSON.parse(JSON.stringify(defaultsetting2)),"7":JSON.parse(JSON.stringify(defaultsetting2)),"8":JSON.parse(JSON.stringify(defaultsetting2)),"9":JSON.parse(JSON.stringify(defaultsetting2)),"10":JSON.parse(JSON.stringify(defaultsetting2)),"11":JSON.parse(JSON.stringify(defaultsetting2)),"12":JSON.parse(JSON.stringify(defaultsetting2)),"13":JSON.parse(JSON.stringify(defaultsetting2)),"14":JSON.parse(JSON.stringify(defaultsetting2)),"15":JSON.parse(JSON.stringify(defaultsetting2))};function freeeeg128codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<128;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=385;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps3=250;var freeeeg128SerialSettings={deviceType:"USB",deviceName:"freeeeg128",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg128codec,sps:sps3,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg128ChartSettings={lines:{"ax":{nSec:10,sps:sps3},"ay":{nSec:10,sps:sps3},"az":{nSec:10,sps:sps3},"gx":{nSec:10,sps:sps3},"gy":{nSec:10,sps:sps3},"gz":{nSec:10,sps:sps3}}};var freeeeg128FilterSettings={};for(let i2=0;i2<128;i2++){freeeeg128ChartSettings.lines[i2]={sps:sps3,nSec:10,units:"mV"};freeeeg128FilterSettings[i2]={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))}}function freeeeg32codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<32;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=97;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps4=512;var freeeeg32SerialSettings={deviceType:"USB",deviceName:"freeeeg32",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg32_optical_SerialSettings={deviceType:"USB",deviceName:"freeeeg32_optical",baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting3={nSec:10,sps:sps4};var freeeeg32ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting3)),"ay":JSON.parse(JSON.stringify(defaultChartSetting3)),"az":JSON.parse(JSON.stringify(defaultChartSetting3)),"gx":JSON.parse(JSON.stringify(defaultChartSetting3)),"gy":JSON.parse(JSON.stringify(defaultChartSetting3)),"gz":JSON.parse(JSON.stringify(defaultChartSetting3))}};var freeeeg32FilterSettings={};for(let i2=0;i2<32;i2++){freeeeg32ChartSettings.lines[i2]={sps:sps4,nSec:10,units:"mV"};freeeeg32FilterSettings[i2]={sps:sps4,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))}}function freeeeg16codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<16;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var BLEBuffer=[];var locked;var lockIdx;function freeeeg16BLEcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;BLEBuffer.push(...data);const needle=new Uint8Array([192,160]);const haystack=BLEBuffer;const search=ByteParser.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=lockIdx??0;let pass=false;for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){if(!locked&&!(typeof lockIdx==="number"))used=lockIdx=i2;else{nextIndex=i2;if(nextIndex>=0){const len=nextIndex-used;if(!lockIdx){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true;locked=true}else if(len>0){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true}used=nextIndex}}}if(pass){let output={};for(let i3=0;i3<16;i3++){let idx=i3*3+1;output[i3]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}else return void 0}var sps5=250;var freeeeg16BLESettings={deviceType:"BLE",deviceName:"freeeeg16",services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:void 0},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:freeeeg16BLEcodec,sps:sps5}}}};var freeeeg16SerialSettings={deviceType:"USB",deviceName:"freeeeg16",baudRate:115200,bufferSize:2e3,frequency:3.5,codec:freeeeg16codec,sps:sps5,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting4={nSec:10,sps:sps5};var freeeeg16ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting4)),"ay":JSON.parse(JSON.stringify(defaultChartSetting4)),"az":JSON.parse(JSON.stringify(defaultChartSetting4)),"gx":JSON.parse(JSON.stringify(defaultChartSetting4)),"gy":JSON.parse(JSON.stringify(defaultChartSetting4)),"gz":JSON.parse(JSON.stringify(defaultChartSetting4))}};var freeeeg16FilterSettings={};var gain2=32;var nbits2=24;var vref2=1.2;for(let i2=0;i2<16;i2++){freeeeg16ChartSettings.lines[i2]={sps:sps5,nSec:10,units:"mV"};freeeeg16FilterSettings[i2]={sps:sps5,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref2/(gain2*(Math.pow(2,nbits2)-1))}}var textdecoder=new TextDecoder;function hegduinocodec(value){let output={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0};let txt=textdecoder.decode(value);let line=txt.split("|");if(line.length===3){output.timestamp=Date.now();output.red=parseInt(line[0]);output.infrared=parseInt(line[1]);output.heg=parseFloat(line[2])}else if(line.length>=2){output.timestamp=Date.now();output.red=parseInt(line[1]);output.infrared=parseInt(line[2]);output.heg=parseFloat(line[3]);if(line[4])output.ambient=parseFloat(line[4]);if(line[5])output.temperature=parseFloat(line[5]);return output}else return txt}var sps6=40;var hegduinoSerialSettings={deviceType:"USB",deviceName:"hegduino",baudRate:115200,write:"t\\\\n",codec:hegduinocodec,sps:sps6};var hegduinoV1SerialSettings=Object.assign({},hegduinoSerialSettings);hegduinoV1SerialSettings.sps=19;var hegduinoBLESettings={deviceType:"BLE",deviceName:"hegduino",sps:sps6,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:hegduinocodec,sps:sps6}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};var hegduinoV1BLESettings=Object.assign({},hegduinoSerialSettings);hegduinoV1BLESettings.sps=19;function max3010xcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let pktCt=32;const output={"red":new Array(pktCt),"ir":new Array(pktCt),"max_dietemp":ByteParser.get2sCompliment(arr[193],8)+.0625*arr[194],"timestamp":Date.now()};let i2=0;while(i2<pktCt){let idx=i2*6;if(i2%2===0){output["ir"][i2]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["ir"][i2+1]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}else{output["red"][i2-1]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["red"][i2]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}i2++}return output}function mpu6050codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={"ax":new Array(20),"ay":new Array(20),"az":new Array(20),"gx":new Array(20),"gy":new Array(20),"gz":new Array(20),"mpu_dietemp":(ByteParser.bytesToInt16(arr[241],arr[242])+521)/340+35,timestamp:Date.now()};for(let i2=0;i2<20;i2++){let idx=i2*12;output.ax[i2]=ByteParser.bytesToInt16(arr[idx+1],arr[idx+2]);output.ay[i2]=ByteParser.bytesToInt16(arr[idx+3],arr[idx+4]);output.az[i2]=ByteParser.bytesToInt16(arr[idx+5],arr[idx+6]);output.gx[i2]=ByteParser.bytesToInt16(arr[idx+7],arr[idx+8]);output.gy[i2]=ByteParser.bytesToInt16(arr[idx+9],arr[idx+10]);output.gz[i2]=ByteParser.bytesToInt16(arr[idx+11],arr[idx+12])}return output}function cognixionONE_EEG_codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let i2=0;i2<7;i2++){let j=i2*26+1;if(!arr[j+23])break;output[0][i2]=ByteParser.bytesToUInt24(arr[j],arr[j+1],arr[j+2]);output[1][i2]=ByteParser.bytesToUInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i2]=ByteParser.bytesToUInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i2]=ByteParser.bytesToUInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i2]=ByteParser.bytesToUInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i2]=ByteParser.bytesToUInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i2]=ByteParser.bytesToUInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i2]=ByteParser.bytesToUInt24(arr[j+21],arr[j+22],arr[j+23])}return output}var sps7=250;var cognixionONEBLESettings={deviceType:"BLE",deviceName:"cognixionONE",services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:true,notifyCallback:void 0,codec:cognixionONE_EEG_codec,sps:sps7}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:true}}},sps:sps7};var cognixionONESerialSettings=Object.assign({},cytonSerialSettings);cognixionONESerialSettings.sps=sps7;cognixionONESerialSettings.deviceName="cognixionONE";var defaultChartSetting5={nSec:10,sps:sps7,units:"mV"};var cognixionONEChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting5)),"1":JSON.parse(JSON.stringify(defaultChartSetting5)),"2":JSON.parse(JSON.stringify(defaultChartSetting5)),"3":JSON.parse(JSON.stringify(defaultChartSetting5)),"4":JSON.parse(JSON.stringify(defaultChartSetting5)),"5":JSON.parse(JSON.stringify(defaultChartSetting5)),"6":JSON.parse(JSON.stringify(defaultChartSetting5)),"7":JSON.parse(JSON.stringify(defaultChartSetting5))}};var PeanutCodes={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function peanutcodec(data){let result={};let i2=0;while(i2<data.length){if(PeanutCodes[data[i2]]&&i2+1+PeanutCodes[data[i2]].byteLength<=data.length){let slice=data.slice(i2+1,i2+1+PeanutCodes[data[i2]].byteLength).buffer;let unpacked=ByteParser.struct(PeanutCodes[data[i2]].format).unpack(slice);let code=PeanutCodes[data[i2]].type;if(code==="unfilteredHEG"||code==="heg")unpacked=unpacked[0]/256;else if(code==="POOR_SIGNAL"||code==="sampleNumber"||code==="debug0"||code==="debug1"||code==="debug2"||code==="debug3")unpacked=unpacked[0];if(!result[PeanutCodes[data[i2]].type]){if(Array.isArray(unpacked))result[PeanutCodes[data[i2]].type]=unpacked;else result[PeanutCodes[data[i2]].type]=[unpacked]}else{if(Array.isArray(unpacked))result[PeanutCodes[data[i2]].type].push(...unpacked);else result[PeanutCodes[data[i2]].type].push(unpacked)}i2+=PeanutCodes[data[i2]].byteLength+1}else i2++}result.timestamp=Date.now();return result}var peanutSerialSettings={deviceType:"USB",deviceName:"peanut",baudRate:38400,bufferSize:400,write:"protocol 3\\\\n",buffering:{searchBytes:new Uint8Array([170,170])},codec:peanutcodec,sps:10.101};var sealevel_hpa=1013.25;var bme280codec=data=>{let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={timestamp:Date.now(),temp:[],pressure:[],altitude:[]};let mode=0;if(arr[0].length===74)mode=1;if(!mode){for(let j=0;j<3;j++){let i2=j*16+2;let tint=ByteParser.bytesToInt32(arr[3+i2],arr[2+i2],arr[1+i2],arr[0+i2]);let tfrac=ByteParser.bytesToInt32(arr[7+i2],arr[6+i2],arr[5+i2],arr[4+i2]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser.bytesToInt32(arr[11+i2],arr[10+i2],arr[9+i2],arr[8+i2]);let pfrac=ByteParser.bytesToInt32(arr[15+i2],arr[14+i2],arr[13+i2],arr[12+i2]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}else{output.humidity=[];for(let j=0;j<3;j++){let i2=j*24+2;let tint=ByteParser.bytesToInt32(arr[3+i2],arr[2+i2],arr[1+i2],arr[0+i2]);let tfrac=ByteParser.bytesToInt32(arr[7+i2],arr[6+i2],arr[5+i2],arr[4+i2]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser.bytesToInt32(arr[11+i2],arr[10+i2],arr[9+i2],arr[8+i2]);let pfrac=ByteParser.bytesToInt32(arr[15+i2],arr[14+i2],arr[13+i2],arr[12+i2]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));let hint=ByteParser.bytesToInt32(arr[19+i2],arr[18+i2],arr[17+i2],arr[16+i2]);let hfrac=ByteParser.bytesToInt32(arr[23+i2],arr[22+i2],arr[21+i2],arr[20+i2]);output.humidity.push(hint+hfrac/Math.pow(10,Math.ceil(Math.log10(hfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}return output};function altitude(pressure,temperature){return 44330*(1-Math.pow(pressure/sealevel_hpa,.1903))}function nrf5x_usbcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i2)=>{output[i2+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec(arr.subarray(2))))}return output}function nrf5x_usbcodec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec_singleended(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i2)=>{output[i2+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec_singleended(arr.subarray(2))))}return output}var nrf5xSerialSettings={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec,sps:250};var nrf5xSerialSettings_singleended={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec_singleended,sps:250};var nrf5xBLESettings={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var nrf5xBLESettings_singleended={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var defaultChartSetting6={nSec:10,sps:250,units:"mV"};var nrf5x_usbChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting6)),"1":JSON.parse(JSON.stringify(defaultChartSetting6)),"2":JSON.parse(JSON.stringify(defaultChartSetting6)),"3":JSON.parse(JSON.stringify(defaultChartSetting6)),"4":JSON.parse(JSON.stringify(defaultChartSetting6)),"5":JSON.parse(JSON.stringify(defaultChartSetting6)),"6":JSON.parse(JSON.stringify(defaultChartSetting6)),"7":JSON.parse(JSON.stringify(defaultChartSetting6))},generateNewLines:true,cleanGeneration:false};var gain3=32;var nbits3=24;var vref3=1.2;var defaultsetting3={sps:250,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref3/(gain3*(Math.pow(2,nbits3)-1))};var nrf5x_usbFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting3)),"1":JSON.parse(JSON.stringify(defaultsetting3)),"2":JSON.parse(JSON.stringify(defaultsetting3)),"3":JSON.parse(JSON.stringify(defaultsetting3)),"4":JSON.parse(JSON.stringify(defaultsetting3)),"5":JSON.parse(JSON.stringify(defaultsetting3)),"6":JSON.parse(JSON.stringify(defaultsetting3)),"7":JSON.parse(JSON.stringify(defaultsetting3)),"8":JSON.parse(JSON.stringify(defaultsetting3)),"9":JSON.parse(JSON.stringify(defaultsetting3)),"10":JSON.parse(JSON.stringify(defaultsetting3)),"11":JSON.parse(JSON.stringify(defaultsetting3)),"12":JSON.parse(JSON.stringify(defaultsetting3)),"13":JSON.parse(JSON.stringify(defaultsetting3)),"14":JSON.parse(JSON.stringify(defaultsetting3)),"15":JSON.parse(JSON.stringify(defaultsetting3))};var textdecoder2=new TextDecoder;function statechangercodec(value){let output={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0};let txt=textdecoder2.decode(value);let line=txt.split("|");if(line.length>=5){output.timestamp=Date.now();output.left_red=parseInt(line[1]);output.left_infrared=parseInt(line[2]);output.left_heg=parseFloat(line[3]);output.center_red=parseInt(line[4]);output.center_infrared=parseInt(line[5]);output.center_heg=parseFloat(line[6]);output.right_red=parseInt(line[7]);output.right_infrared=parseInt(line[8]);output.right_heg=parseFloat(line[9]);return output}else return txt}var statechangerSerialSettings={deviceType:"USB",deviceName:"statechanger",baudRate:115200,codec:statechangercodec,sps:20};var statechangerBLESettings={deviceType:"BLE",deviceName:"statechanger",sps:20,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:statechangercodec}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};function blueberrycodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.red/(.5*(output.ir+output.ir2));return output}var sps8=40;var blueberryBLESettings={deviceType:"BLE",deviceName:"blueberry",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:true,notifyCallback:void 0,codec:blueberrycodec,sps:sps8}}},sps:sps8};function blueberryshortcodec(value){let output={sred:value.getInt32(2),sir:value.getInt32(6),sir2:value.getInt32(10),timestamp:Date.now()};output.sheg=output.sred/(.5*(output.sir+output.sir2));return output}function blueberrylongcodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.sred/(.5*(output.ir+output.ir2));return output}var sps9=40;var blueberry2BLESettings={deviceType:"BLE",deviceName:"blueberry2",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:true,notifyCallback:void 0,codec:blueberrylongcodec,sps:sps9},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:true,notifyCallback:void 0,codec:blueberryshortcodec,sps:sps9}}},sps:sps9};function hrcodec(data){return{hr:data.getInt8(1),timestamp:Date.now()}}var heartRateBLESettings={deviceType:"BLE",deviceName:"heartrate",services:{"heart_rate":{"heart_rate_measurement":{notify:true,notifyCallback:void 0,codec:hrcodec}}}};var simulatorSettings={sps:250,deviceType:"CUSTOM",deviceName:"simulator",simulate:{"0":{sps:250,freq:1,amplitude:1,offset:0},"1":{sps:250,freq:10,amplitude:1,offset:0},"2":{sps:250,freq:100,amplitude:.5,offset:.5},"3":{sps:250,freq:25,amplitude:1,offset:0}},connect:(settings={})=>{return new Promise(async(res,rej)=>{let _id=\\`simulated\\${Math.floor(Math.random()*1e15)}\\`;let info={_id,settings:Object.assign(Object.assign({},simulatorSettings),settings)};info.settings.looping=true;let loopTime=50;let lastTime=Date.now();let loop2=()=>{if(info.settings.looping){let newData={};let now=Date.now();let frame=now-lastTime;for(const key in info.settings.simulate){let newPoints=Math.floor(info.settings.simulate[key].sps*frame/1e3);newData[key]=new Array(newPoints).fill(0);newData[key]=newData[key].map((v,i2)=>{return Math.sin(2*Math.PI*info.settings.simulate[key].freq*.001*(lastTime+frame*(i2+1)/newPoints))*info.settings.simulate[key].amplitude+info.settings.simulate[key].offset})}lastTime=now;newData.timestamp=lastTime;info.settings.ondata(newData);setTimeout(()=>{loop2()},loopTime)}};loop2();if(info.settings.onconnect)info.settings.onconnect(info);res(info)})},codec:reading=>{return reading},disconnect:info=>{console.log(info);info.settings.looping=false;info.settings.ondisconnect(info)},onconnect:info=>{console.log("simulator connected!",info)},ondisconnect:info=>{console.log("simulator disconnected!",info)},ondata:data=>{}};var BiquadChannelFilterer=class{constructor(options={sps:512,useSMA4:false,useNotch50:true,useNotch60:true,useLowpass:false,lowpassHz:100,useBandpass:false,bandpassLower:3,bandpassUpper:45,useDCBlock:true,DCBresonance:.995,trimOutliers:false,outlierTolerance:.2,useScaling:false,scalar:1}){this.idx=0;this.sps=options.sps;this.bandpassLower=options.bandpassLower?options.bandpassLower:3;this.bandpassUpper=options.bandpassUpper?options.bandpassUpper:45;this.useSMA4=options.useSMA4;this.last4=[];this.useNotch50=options.useNotch50;this.useNotch60=options.useNotch60;this.useLowpass=options.useLowpass;this.lowpassHz=options.lowpassHz?options.lowpassHz:100;this.useBandpass=options.useBandpass;this.useDCBlock=options.useDCBlock;this.DCBresonance=options.DCBresonance?options.DCBresonance:.995;this.useScaling=options.useScaling;this.scalar=options.scalar;this.trimOutliers=options.trimOutliers;this.outlierTolerance=options.outlierTolerance;let sps10=this.sps;this.notch50=[makeNotchFilter(50,sps10,2),makeNotchFilter(100,sps10,2)];this.notch60=[makeNotchFilter(60,sps10,2),makeNotchFilter(120,sps10,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1)];this.dcb=new DCBlocker(options.DCBresonance?options.DCBresonance:.995)}reset(sps10=this.sps){this.notch50=[makeNotchFilter(50,sps10,2),makeNotchFilter(100,sps10,2)];this.notch60=[makeNotchFilter(60,sps10,2),makeNotchFilter(120,sps10,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1)];this.dcb=new DCBlocker(this.DCBresonance)}setBandpass(bandpassLower=this.bandpassLower,bandpassUpper=this.bandpassUpper,sps10=this.sps){this.bandpassLower=bandpassLower;this.bandpassUpper=bandpassUpper;this.bp1=[makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10)]}apply(latestData=0){let out=latestData;if(this.useScaling===true){out*=this.scalar}if(this.filtered&&this.trimOutliers&&this.outlierTolerance){if(Math.abs(out-this.filtered)>this.outlierTolerance){out=this.filtered}}if(this.useDCBlock===true){out=this.dcb.applyFilter(out)}if(this.useSMA4===true){if(this.last4.length<4){this.last4.push(out)}else{out=this.last4.reduce((accumulator,currentValue)=>accumulator+currentValue)/this.last4.length;this.last4.shift();this.last4.push(out)}}if(this.useNotch50===true){this.notch50.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useNotch60===true){this.notch60.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useLowpass===true){this.lp1.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useBandpass===true){this.bp1.forEach((f,i2)=>{out=f.applyFilter(out)})}this.filtered=out;this.idx++;return out}};var Biquad=class{constructor(type,freq,sps10,Q=1/Math.sqrt(2),dbGain=0){this.a0=0;this.a1=0;this.a2=0;this.b0=0;this.b1=0;this.b2=0;this.x1=0;this.x2=0;this.y1=0;this.y2=0;let types=["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"];if(types.indexOf(type)<0){console.error("Valid types: \'lowpass\',\'highpass\',\'bandpass\',\'notch\',\'peak\',\'lowshelf\',\'highshelf\'");return}this.type=type;this.freq=freq;this.sps=sps10;this.Q=Q;this.dbGain=dbGain;let A2=Math.pow(10,dbGain/40);let omega=2*Math.PI*freq/sps10;let sn=Math.sin(omega);let cs=Math.cos(omega);let alpha=sn/(2*Q);let beta=Math.sqrt(A2+A2);this[type](A2,sn,cs,alpha,beta);this.b0/=this.a0;this.b1/=this.a0;this.b2/=this.a0;this.a1/=this.a0;this.a2/=this.a0}lowpass(A2,sn,cs,alpha,beta){this.b0=(1-cs)*.5;this.b1=1-cs;this.b2=(1-cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}highpass(A2,sn,cs,alpha,beta){this.b0=(1+cs)*.5;this.b1=-(1+cs);this.b2=(1+cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}bandpass(A2,sn,cs,alpha,beta){this.b0=alpha;this.b1=0;this.b2=-alpha;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}notch(A2,sn,cs,alpha,beta){this.b0=1;this.b1=-2*cs;this.b2=1;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}peak(A2,sn,cs,alpha,beta){this.b0=1+alpha*A2;this.b1=-2*cs;this.b2=1-alpha*A2;this.a0=1+alpha/A2;this.a1=-2*cs;this.a2=1-alpha/A2}lowshelf(A2,sn,cs,alpha,beta){this.b0=A2*(A2+1-(A2-1)*cs+beta*sn);this.b1=2*A2*(A2-1-(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn);this.a0=A2+1+(A2+1)*cs+beta*sn;this.a1=2*(A2-1+(A2+1)*cs);this.a2=A2+1+(A2-1)*cs-beta*sn}highshelf(A2,sn,cs,alpha,beta){this.b0=A2*(A2+1+(A2-1)*cs+beta*sn);this.b1=2*A2*(A2-1+(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn);this.a0=A2+1-(A2+1)*cs-beta*sn;this.a1=2*(A2-1-(A2+1)*cs);this.a2=A2+1-(A2-1)*cs-beta*sn}applyFilter(signal_step){let y2=this.b0*signal_step+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;this.x2=this.x1;this.x1=signal_step;this.y2=this.y1;this.y1=y2;return y2}zResult(freq){try{let phi=Math.pow(Math.sin(Math.PI*freq*2/(2*this.sps)),2);let result=(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*phi+16*this.b0*this.b2*phi*phi)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*phi+16*this.a2*phi*phi);return result}catch(err){return-200}}static calcCenterFrequency(freqStart,freqEnd){return(freqStart+freqEnd)/2}static calcBandwidth(freqStart,freqEnd){return freqEnd-this.calcCenterFrequency(freqStart,freqEnd)}static calcBandpassQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*Math.sqrt((frequency-bandwidth)*(frequency+bandwidth))/(2*bandwidth);return Q}static calcNotchQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*frequency*bandwidth/Math.sqrt((frequency-bandwidth)*(frequency+bandwidth));return Q}};var DCBlocker=class{constructor(r=.995){this.r=r;this.y1=this.y2=this.x1=this.x2=0}applyFilter(signal_step){this.x2=this.x1;this.x1=signal_step;let y2=this.x1-this.x2+this.r*this.y1;this.y2=this.y1;this.y1=y2;return y2}};var makeNotchFilter=(frequency,sps10,bandwidth)=>{return new Biquad("notch",frequency,sps10,Biquad.calcNotchQ(frequency,bandwidth),0)};var makeBandpassFilter=(freqStart,freqEnd,sps10,resonance=Math.pow(10,Math.floor(Math.log10(Biquad.calcCenterFrequency(freqStart,freqEnd)))))=>{return new Biquad("bandpass",Biquad.calcCenterFrequency(freqStart,freqEnd),sps10,Biquad.calcBandpassQ(Biquad.calcCenterFrequency(freqStart,freqEnd),Biquad.calcBandwidth(freqStart,freqEnd),resonance),0)};var defaultsetting1={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var ganglionFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting1)),"1":JSON.parse(JSON.stringify(defaultsetting1)),"2":JSON.parse(JSON.stringify(defaultsetting1)),"3":JSON.parse(JSON.stringify(defaultsetting1))};var defaultChartSetting7={nSec:10,sps:250,units:"mV"};var ganglionChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting7)),"1":JSON.parse(JSON.stringify(defaultChartSetting7)),"2":JSON.parse(JSON.stringify(defaultChartSetting7)),"3":JSON.parse(JSON.stringify(defaultChartSetting7)),"ax":{nSec:10,sps:250,units:"mg"},"ay":{nSec:10,sps:250,units:"mg"},"az":{nSec:10,sps:250,units:"mg"}},generateNewLines:true};var defaultsetting4={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var museFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting4)),"1":JSON.parse(JSON.stringify(defaultsetting4)),"2":JSON.parse(JSON.stringify(defaultsetting4)),"3":JSON.parse(JSON.stringify(defaultsetting4)),"4":JSON.parse(JSON.stringify(defaultsetting4))};var Devices={BLE:{"nrf5x":nrf5xBLESettings,"nrf5x_singleended":nrf5xBLESettings_singleended,"hegduino":hegduinoBLESettings,"hegduinoV1":hegduinoV1BLESettings,"cognixionONE":cognixionONEBLESettings,"statechanger":statechangerBLESettings,"blueberry":blueberryBLESettings,"blueberry2":blueberry2BLESettings,"heart_rate":heartRateBLESettings,"freeEEG16":freeeeg16BLESettings},USB:{"nrf5x":nrf5xSerialSettings,"nrf5x_singleended":nrf5xSerialSettings_singleended,"freeEEG16":freeeeg16SerialSettings,"freeEEG32":freeeeg32SerialSettings,"freeEEG32_optical":freeeeg32_optical_SerialSettings,"freeEEG128":freeeeg128SerialSettings,"hegduino":hegduinoSerialSettings,"hegduinoV1":hegduinoV1SerialSettings,"cyton":cytonSerialSettings,"cyton_daisy":daisycytonSerialSettings,"peanut":peanutSerialSettings,"statechanger":statechangerSerialSettings,"cognixionONE":cytonSerialSettings},BLE_CUSTOM:{},USB_CUSTOM:{},CUSTOM:{"simulator":simulatorSettings}};var textdecoder3=new TextDecoder;var decoders={"raw":data=>{if(data?.buffer)return Array.from(new Uint8Array(data));else return data},"utf8":data=>{return textdecoder3.decode(data)},"console-f12":data=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(data);return data},"debug":(data,debugmessage)=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(debugmessage,data);return data},"ads131m08":ads131m08codec,"arduino_ads131m08":ads131m08_arduinocodec,"max3010x":max3010xcodec,"mpu6050":mpu6050codec,"bme280":bme280codec,"freeeeg16":freeeeg16codec,"freeeeg32":freeeeg32codec,"freeeeg128":freeeeg128codec,"cyton":cytoncodec,"cognixionONE_BLE":cognixionONE_EEG_codec,"hegduino":hegduinocodec,"nrf5x":nrf5x_usbcodec,"peanut":peanutcodec,"statechanger":statechangercodec,"blueberry":blueberrycodec,"heart_rate":hrcodec};function parseFunctionFromText2(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\\\W*(function[^{]+\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>[^{]*\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs3(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs2}var stringifyFast2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p in value[prop]){if(Array.isArray(value[prop][p])){if(value[prop][p].length>20)obj[prop][p]=value[prop][p].slice(value[prop][p].length-20);else obj[prop][p]=value[prop][p]}else{if(value[prop][p]!=null){let con=value[prop][p].constructor.name;if(con.includes("Set")){obj[prop][p]=Array.from(value[prop][p])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p]="instanceof_"+con}else{obj[prop][p]=value[prop][p]}}else{obj[prop][p]=value[prop][p]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast3(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast2}function loadStreamWorkerGlobals(){globalThis.Devices=Devices;globalThis.WebSerial=WebSerial;globalThis.decoders=decoders;globalThis.decoder="raw";globalThis.ByteParser=ByteParser;globalThis.filtering=false;globalThis.filters={};globalThis.BiquadChannelFilterer=BiquadChannelFilterer;globalThis.ArrayManip=ArrayManip}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){loadStreamWorkerGlobals()}var streamWorkerRoutes={"transferDevice":function transferDevice(device,worker){let cpy=Object.assign({},device);for(const key in cpy){if(typeof cpy[key]==="function")cpy[key]=cpy[key].toString()}worker.send({route:"receiveDevice",args:cpy})},"receiveDevice":function receiveDevice(device){for(const key in device){if(typeof device[key]==="string"){let fn=parseFunctionFromText2(device[key]);if(typeof fn==="function"){device[key]=fn}}}if(!globalThis.Devices[device.deviceType])globalThis.Devices[device.deviceType]={};globalThis.Devices[device.deviceType][device.deviceName]=device},"receiveDecoder":function receiveDecoder(decoder2,decoderName){globalThis.decoders[decoderName]=(0,eval)("("+decoder2+")")},"receiveCodec":function receiveDeviceCodec(decoder2,deviceType,device,service,characteristic){let codec=parseFunctionFromText2(decoder2);if(codec){if(deviceType==="BLE"&&service&&characteristic){if(globalThis.Devices[deviceType][device]){if(globalThis.Devices[deviceType][device][service]){if(globalThis.Devices[deviceType][device][characteristic]){globalThis.Devices[deviceType][device][characteristic].codec=codec}else{globalThis.Devices[deviceType][device][characteristic]={codec}}}else{globalThis.Devices[deviceType][device]={[characteristic]:{codec}}}}}else if(globalThis.Devices[deviceType][device]?.codec){if(globalThis.Devices[deviceType][device])globalThis.Devices[deviceType][device].codec=codec;else{globalThis.Devices[deviceType][device]={codec}}}}},"decode":function decode(data){return globalThis.decoder(data)},"decodeAndParse":function decodeAndParse(data){let decoded=this.__node.graph.run("decode",data);if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}}}}return parsed}}return decoded},"setActiveDecoder":function setActiveDecoder(deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device]?.codec;else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device][service][characteristic].codec;return true},"decodeDevice":function decodeDevice(data,deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)return globalThis.Devices[deviceType][device].codec(data);else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)return globalThis.Devices[deviceType][device][service][characteristic].codec(data)},"decodeAndParseDevice":function decodeAndParseDevice(data,deviceType,deviceName,service,characteristic){let decoded;if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][deviceName]?.services[service]?.[characteristic]?.codec)decoded=globalThis.Devices[deviceType][deviceName].services[service][characteristic].codec(data);else if(globalThis.Devices[deviceType][deviceName]?.codec)decoded=globalThis.Devices[deviceType][deviceName].codec(data);else decoded=data;if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}else if(typeof parsed[prop]==="number"){parsed[prop]=filter.apply(parsed[prop])}}}}return parsed}}return decoded},"toggleAnim":function toggleAnim(){globalThis.runningAnim=!globalThis.runningAnim;return globalThis.runningAnim},"setFilters":function setFilters(filters,clearFilters=false){if(!globalThis.filters||clearFilters){globalThis.filters={};if(clearFilters)globalThis.filtering=false}if(filters){for(const key in filters){globalThis.filters[key]=new BiquadChannelFilterer(filters[key])}globalThis.filtering=true}return true},"getFilterSettings":function getFilterSettings(){if(globalThis.filters){let filters={};for(const key in globalThis.filters){filters[key]={sps:globalThis.filters[key].sps,useScaling:globalThis.filters[key].useScaling,scalar:globalThis.filters[key].scalar,useNotch50:globalThis.filters[key].useNotch50,useNotch60:globalThis.filters[key].useNotch60,useDCBlock:globalThis.filters[key].useDCBlock,useLowpass:globalThis.filters[key].useLowpass,lowpassHz:globalThis.filters[key].lowpassHz,useBandpass:globalThis.filters[key].useBandpass,bandpassLower:globalThis.filters[key].bandpassLower,bandpassUpper:globalThis.filters[key].bandpassUpper}}return filters}return void 0},"setupSerial":function setupSerial(){globalThis.Serial=new globalThis.WebSerial;globalThis.decoder="raw";console.log("worker: Setting up Serial",globalThis.Serial);return true},"openPort":function openPort(settings){const WorkerService2=this.__node.graph;if(!globalThis.Serial)WorkerService2.run("setupSerial");return new Promise((res,rej)=>{globalThis.Serial.getPorts().then(ports=>{const Serial=globalThis.Serial;let port=ports.find(port2=>{return port2.getInfo().usbVendorId===settings.usbVendorId&&port2.getInfo().usbProductId===settings.usbProductId});if(port){let options=Object.assign({},settings);if(typeof settings.pipeTo==="object"&&settings.pipeTo.extraArgs&&globalThis.Devices?.[settings.pipeTo.extraArgs[0]]?.[settings.pipeTo.extraArgs[1]]){options.onconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].onconnect;options.ondisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].ondisconnect;options.beforedisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].beforedisconnect}Serial.openPort(port,options).then(()=>{const stream=Serial.createStream({port,settings:options,frequency:settings.frequency?settings.frequency:10,buffering:settings.buffering,ondata:value=>{if(stream.settings.pipeTo){if(stream.settings.pipeMain){WorkerService2.transmit(value,void 0,[value.buffer])}if(typeof stream.settings.pipeTo==="string")WorkerService2.transmit(value,stream.settings.pipeTo,[value.buffer]);else if(stream.settings.pipeTo?.route){let args=value;if(stream.settings.pipeTo.extraArgs)args=[value,...stream.settings.pipeTo.extraArgs];WorkerService2.transmit({route:stream.settings.pipeTo.route,args},stream.settings.pipeTo._id,[value.buffer])}}else{WorkerService2.transmit(value,void 0,[value.buffer])}}});Serial.readStream(stream);port.ondisconnect=()=>{postMessage(\\`\\${stream._id} disconnected\\`)};res({_id:stream._id,settings,info:stream.info})}).catch(()=>{postMessage(\\`disconnected\\`)});;}else{rej(false)}})})},"closeStream":function closeStream(streamId){return new Promise((res,rej)=>{const Serial=globalThis.Serial;let ondisconnect;if(Serial.streams[streamId].port?.ondisconnect)ondisconnect=Serial.streams[streamId].port.ondisconnect;Serial.closeStream(Serial.streams[streamId]).then(resolved=>{if(ondisconnect)ondisconnect(void 0);res(resolved)}).catch(rej)})},"writeStream":function writeStream(streamId,message){globalThis.Serial.writeStream(globalThis.Serial.streams[streamId],message);return true},"updateStreamSettings":function updateStreamSettings(streamId,settings){if(globalThis.Serial?.streams[streamId]){for(const key in settings){if(typeof settings[key]==="object"){Object.assign(globalThis.Serial.streams[streamId].settings[key],settings[key])}else globalThis.Serial.streams[streamId][key]=settings[key]}}}};if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){globalThis.Devices=Devices;const worker=new WorkerService({roots:{...workerCanvasRoutes,...remoteGraphRoutes,...streamWorkerRoutes}})}var stream_worker_default=self;})();\n`);var url=URL.createObjectURL(new globalThis.Blob([str3],{type:"text/javascript"}));var _ArrayManip3=class{constructor(){this.recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"){if(typeof target[key]==="object")this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target}}static autoscale(array,lineIdx=0,nLines=1,centerZero=false,ymin,ymax,clamp){if(array?.length===0)return array;let max=ymax?ymax:Math.max(...array);let min=ymin?ymin:Math.min(...array);let _lines=1/nLines;let scalar=1;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));if(absmax!==0)scalar=_lines/absmax;return array.map(y22=>{if(clamp){if(y22<min)y22=min;if(y22>max)y22=max}return y22*scalar+(_lines*(lineIdx+1)*2-1-_lines)})}else{if(max===min){if(max!==0){scalar=_lines/max}else if(min!==0){scalar=_lines/Math.abs(min)}}else scalar=_lines/(max-min);return array.map(y22=>{if(clamp){if(y22<min)y22=min;if(y22>max)y22=max}return 2*((y22-min)*scalar-1/(2*nLines))+(_lines*(lineIdx+1)*2-1-_lines)})}}static genTimestamps(ct,sps11){let now=Date.now();let toInterp=[now-ct*1e3/sps11,now];return _ArrayManip3.upsample(toInterp,ct)}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i22=incr;i22<array.length;i22+=incr){let rounded=Math.round(i22);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static upsample(array,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array(fitCount);var springFactor=(array.length-1)/(fitCount-1);newData[0]=array[0];for(var i22=1;i22<fitCount-1;i22++){var tmp=i22*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i22]=linearInterpolate(array[before],array[after],atPoint)}newData[fitCount-1]=array[array.length-1];return newData}static interpolate(array,fitCount,scalar=1){if(array.length>fitCount){return _ArrayManip3.downsample(array,fitCount,scalar)}else if(array.length<fitCount){return _ArrayManip3.upsample(array,fitCount,scalar)}return array}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x3=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x3;b=0}else if(60<=h&&h<120){r=x3;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x3}else if(180<=h&&h<240){r=0;g=x3;b=c}else if(240<=h&&h<300){r=x3;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x3}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static circularBuffer(arr,newEntries){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,newEntries.slice(len-newEntries.length))}else{arr.splice(0,arr.length,...newEntries)}return arr}static reformatData(data,key){if(Array.isArray(data)){if(Array.isArray(data[0])){let d2={};data.forEach((arr,i22)=>{d2[i22]=arr});data=d2;if(isNaN(data[0][0]))return void 0}else if(key){data={[key]:data};if(isNaN(data[key][0]))return void 0}else{data={0:data};if(isNaN(data[0][0]))return void 0}}else if(typeof data==="object"){for(const key2 in data){if(typeof data[key2]==="number")data[key2]=[data[key2]];else if(data[key2]?.values){if(typeof data[key2].values==="number")data[key2].values=[data[key2].values]}if(isNaN(data[key2][0]))return void 0}}else if(typeof data==="string"){let split;if(data.includes("\\r\\n")){let lines=data.split("\\r\\n");data={};lines.forEach((l,j)=>{if(l.includes("	")){split=l.split("	")}else if(l.includes(",")){split=l.split(",")}else if(l.includes("|")){split=l.split("|")}if(Array.isArray(split)){split.forEach((val,i22)=>{if(val.includes(":")){let[key2,v2]=val.split(":");let fl=parseFloat(v2);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i22]=[fl];else return void 0}})}})}else if(data.includes("	")){split=data.split("	")}else if(data.includes(",")){split=data.split(",")}else if(data.includes("|")){split=data.split("|")}data={};if(Array.isArray(split)){split.forEach((val,i22)=>{if(val.includes(":")){let[key2,v2]=val.split(":");let fl=parseFloat(v2);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i22]=[fl];else return void 0}})}}else if(typeof data==="number"){if(key)data={[key]:[data]};else data={0:[data]}}return data}static padTime(data,lastValue,time,targetFit){let slopeIncr=(data[0]-lastValue)/time/targetFit;let padded=[...new Array(targetFit-data.length).map((_,i22)=>lastValue+slopeIncr*(i22+1)),...data];return padded}static interpolateForTime(data,time,targetSPS){return _ArrayManip3.interpolate(data,Math.ceil(targetSPS*time))}isTypedArray(x3){return ArrayBuffer.isView(x3)&&Object.prototype.toString.call(x3)!=="[object DataView]"}spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var ArrayManip3=_ArrayManip3;ArrayManip3.bufferValues=(objects,property,keys22,buffer)=>{if(!Array.isArray(keys22)&&typeof keys22==="object")keys22=Object.keys(keys22);if(!buffer){let object_keys=Object.keys(objects);if(keys22)buffer=new Float32Array(object_keys.length*keys22.length);else{if(typeof objects[object_keys[0]][property]==="object"){keys22=Object.keys(objects[object_keys[0]][property]);buffer=new Float32Array(object_keys.length*keys22.length)}else buffer=new Float32Array(object_keys.length)}}let i22=0;for(const key in objects){if(objects[key][property]){if(keys22){for(let j=0;j<keys22.length;j++){buffer[i22]=objects[key][property][keys22[j]];i22++}}else{buffer[i22]=objects[key][property];i22++}}}return buffer};var rechk3=/^([<>])?(([1-9]\\d*)?([xcbB?hHiIfdsp]))*$/;var refmt3=/([1-9]\\d*)?([xcbB?hHiIfdsp])/g;var str22=(v2,o,c)=>String.fromCharCode(...new Uint8Array(v2.buffer,v2.byteOffset+o,c));var rts3=(v2,o,c,s)=>new Uint8Array(v2.buffer,v2.byteOffset+o,c).set(s.split("").map(str32=>str32.charCodeAt(0)));var pst3=(v2,o,c)=>str22(v2,o+1,Math.min(v2.getUint8(o),c-1));var tsp3=(v2,o,c,s)=>{v2.setUint8(o,s.length);rts3(v2,o+1,c-1,s)};var lut3=le=>({x:c=>[1,c,0],c:c=>[c,1,o=>({u:v2=>str22(v2,o,1),p:(v2,c2)=>rts3(v2,o,1,c2)})],"?":c=>[c,1,o=>({u:v2=>Boolean(v2.getUint8(o)),p:(v2,B22)=>v2.setUint8(o,B22)})],b:c=>[c,1,o=>({u:v2=>v2.getInt8(o),p:(v2,b)=>v2.setInt8(o,b)})],B:c=>[c,1,o=>({u:v2=>v2.getUint8(o),p:(v2,B22)=>v2.setUint8(o,B22)})],h:c=>[c,2,o=>({u:v2=>v2.getInt16(o,le),p:(v2,h)=>v2.setInt16(o,h,le)})],H:c=>[c,2,o=>({u:v2=>v2.getUint16(o,le),p:(v2,H22)=>v2.setUint16(o,H22,le)})],i:c=>[c,4,o=>({u:v2=>v2.getInt32(o,le),p:(v2,i22)=>v2.setInt32(o,i22,le)})],I:c=>[c,4,o=>({u:v2=>v2.getUint32(o,le),p:(v2,I)=>v2.setUint32(o,I,le)})],f:c=>[c,4,o=>({u:v2=>v2.getFloat32(o,le),p:(v2,f)=>v2.setFloat32(o,f,le)})],d:c=>[c,8,o=>({u:v2=>v2.getFloat64(o,le),p:(v2,d2)=>v2.setFloat64(o,d2,le)})],s:c=>[1,c,o=>({u:v2=>str22(v2,o,c),p:(v2,s)=>rts3(v2,o,c,s.slice(0,c))})],p:c=>[1,c,o=>({u:v2=>pst3(v2,o,c),p:(v2,s)=>tsp3(v2,o,c,s.slice(0,c-1))})]});var errbuf3=new RangeError("Structure larger than remaining buffer");var errval3=new RangeError("Not enough values for structure");var _ByteParser3=class extends ArrayManip3{static toDataView(value){if(!(value instanceof DataView)){if(typeof value==="string"&&parseInt(value))value=parseInt(value);if(typeof value==="string"){let enc=new TextEncoder;let hascodes={};for(const code in _ByteParser3.codes){while(value.indexOf(code)>-1){let idx=value.indexOf(code);value=value.replace(code,"");hascodes[idx]=code}}let encoded=Array.from(enc.encode(value));for(const key in hascodes){encoded.splice(parseInt(key),0,_ByteParser3.codes[hascodes[key]])}value=new DataView(new Uint8Array(encoded).buffer)}else if(typeof value==="number"){let tmp=value;if(value<256){value=new DataView(new ArrayBuffer(1));value.setUint8(0,tmp)}else if(value<65536){value=new DataView(new ArrayBuffer(2));value.setInt16(0,tmp)}else{value=new DataView(new ArrayBuffer(4));value.setUint32(0,tmp)}}else if(value instanceof ArrayBuffer||typeof SharedArrayBuffer!=="undefined"&&value instanceof SharedArrayBuffer){value=new DataView(value)}else if(Array.isArray(value)){value=new DataView(Uint8Array.from(value).buffer)}else if(typeof value==="object"){value=new TextEncoder().encode(JSON.stringify(value))}}return value}static searchBuffer(buffer,searchString,limit){var needle=searchString;var haystack=buffer;var search=_ByteParser3.boyerMoore(needle);var skip=search.byteLength;var indices=[];for(var i22=search(haystack);i22!==-1;i22=search(haystack,i22+skip)){indices.push(i22);if(limit){if(indices.length>=limit)break}}return indices}static bytesToInt16(x0,x1){let int16=(255&x0)<<8|255&x1;if((int16&32768)>0){int16|=4294901760}else{int16&=65535}return int16}static bytesToUInt16(x0,x1){return x0*256+x1}static Uint16ToBytes(y22){return[y22&255,y22>>8&255]}static bytesToInt24(x0,x1,x22){let int24=(255&x0)<<16|(255&x1)<<8|255&x22;if((int24&8388608)>0){int24|=4278190080}else{int24&=16777215}return int24}static bytesToUInt24(x0,x1,x22){return x0*65536+x1*256+x22}static Uint24ToBytes(y22){return[y22&255,y22>>8&255,y22>>16&255]}static bytesToInt32(x0,x1,x22,x3){let int32=(255&x0)<<24|(255&x1)<<16|(255&x22)<<8|255&x3;if((int32&2147483648)>0){int32|=0}else{int32&=4294967295}return int32}static bytesToUInt32(x0,x1,x22,x3){return x0*16777216+x1*65536+x22*256+x3}static Uint32ToBytes(y22){return[y22&255,y22>>8&255,y22>>16&255,y22>>24&255]}static get2sCompliment(val,nbits42){if(val>4294967296)return null;return val<<32-nbits42>>32-nbits42}static getSignedInt(...args){let pos=0;function getInt(size){var value=0;var first=true;while(size--){if(first){let byte=args[pos++];value+=byte&127;if(byte&128){value-=128}first=false}else{value*=256;value+=args[pos++]}}return value}return getInt(args.length)}static asUint8Array(input){if(input instanceof Uint8Array){return input}else if(typeof input==="string"){var arr=new Uint8Array(input.length);for(var i22=0;i22<input.length;i22++){var c=input.charCodeAt(i22);if(c>127){throw new TypeError("Only ASCII patterns are supported")}arr[i22]=c}return arr}else{return new Uint8Array(input)}}static boyerMoore(patternBuffer){var pattern=_ByteParser3.asUint8Array(patternBuffer);var M2=pattern.length;if(M2===0){throw new TypeError("patternBuffer must be at least 1 byte long")}var R2=256;var rightmost_positions=new Int32Array(R2);for(var c=0;c<R2;c++){rightmost_positions[c]=-1}for(var j=0;j<M2;j++){rightmost_positions[pattern[j]]=j}var boyerMooreSearch=(txtBuffer,start,end)=>{var txt=_ByteParser3.asUint8Array(txtBuffer);if(start===void 0)start=0;if(end===void 0)end=txt.length;var pat=pattern;var right=rightmost_positions;var lastIndex=end-pat.length;var lastPatIndex=pat.length-1;var skip;for(var i22=start;i22<=lastIndex;i22+=skip){skip=0;for(var j2=lastPatIndex;j2>=0;j2--){var c2=txt[i22+j2];if(pat[j2]!==c2){skip=Math.max(1,j2-right[c2]);break}}if(skip===0){return i22}}return-1};boyerMooreSearch.byteLength=pattern.byteLength;return boyerMooreSearch}static struct(format){let fns=[],size=0,m=rechk3.exec(format);if(!m){throw new RangeError("Invalid format string")}const t22=lut3("<"===m[1]),lu=(n,c)=>t22[c](n?parseInt(n,10):1);while(m=refmt3.exec(format)){((r,s,f)=>{for(let i22=0;i22<r;++i22,size+=s){if(f){fns.push(f(size))}}})(...lu(...m.slice(1)))}const unpack_from=(arrb,offs)=>{if(arrb.byteLength<(offs|0)+size){throw errbuf3}let v2=new DataView(arrb,offs|0);return fns.map(f=>f.u(v2))};const pack_into=(arrb,offs,...values)=>{if(values.length<fns.length){throw errval3}if(arrb.byteLength<offs+size){throw errbuf3}const v2=new DataView(arrb,offs);new Uint8Array(arrb,offs,size).fill(0);fns.forEach((f,i22)=>f.p(v2,values[i22]))};const pack=(...values)=>{let b=new ArrayBuffer(size);pack_into(b,0,...values);return b};const unpack=arrb=>unpack_from(arrb,0);function*iter_unpack(arrb){for(let offs=0;offs+size<=arrb.byteLength;offs+=size){yield unpack_from(arrb,offs)}}return Object.freeze({unpack,pack,unpack_from,pack_into,iter_unpack,format,size})}};var ByteParser3=_ByteParser3;ByteParser3.codes={"\\\\n":10,"\\\\r":13,"\\\\t":9,"\\\\s":32,"\\\\b":8,"\\\\f":12,"\\\\":92};var ScanMode;(function(ScanMode2){ScanMode2[ScanMode2["SCAN_MODE_LOW_POWER"]=0]="SCAN_MODE_LOW_POWER";ScanMode2[ScanMode2["SCAN_MODE_BALANCED"]=1]="SCAN_MODE_BALANCED";ScanMode2[ScanMode2["SCAN_MODE_LOW_LATENCY"]=2]="SCAN_MODE_LOW_LATENCY"})(ScanMode||(ScanMode={}));var ConnectionPriority;(function(ConnectionPriority2){ConnectionPriority2[ConnectionPriority2["CONNECTION_PRIORITY_BALANCED"]=0]="CONNECTION_PRIORITY_BALANCED";ConnectionPriority2[ConnectionPriority2["CONNECTION_PRIORITY_HIGH"]=1]="CONNECTION_PRIORITY_HIGH";ConnectionPriority2[ConnectionPriority2["CONNECTION_PRIORITY_LOW_POWER"]=2]="CONNECTION_PRIORITY_LOW_POWER"})(ConnectionPriority||(ConnectionPriority={}));init_dist();init_conversion();init_dist();var BluetoothLe=registerPlugin("BluetoothLe",{web:()=>Promise.resolve().then(()=>(init_web(),web_exports)).then(m=>new m.BluetoothLeWeb)});var makeQueue=()=>{let currentTask=Promise.resolve();return fn=>new Promise((resolve,reject)=>{currentTask=currentTask.then(()=>fn()).then(resolve).catch(reject)})};function getQueue(enabled){if(enabled){return makeQueue()}return fn=>fn()}function parseUUID(uuid){if(typeof uuid!=="string"){throw new Error(`Invalid UUID type ${typeof uuid}. Expected string.`)}uuid=uuid.toLowerCase();const is128BitUuid=uuid.search(/^[0-9a-f]{8}\\b-[0-9a-f]{4}\\b-[0-9a-f]{4}\\b-[0-9a-f]{4}\\b-[0-9a-f]{12}$/)>=0;if(!is128BitUuid){throw new Error(`Invalid UUID format ${uuid}. Expected 128 bit string (e.g. "0000180d-0000-1000-8000-00805f9b34fb").`)}return uuid}var BleClientClass=class{constructor(){this.scanListener=null;this.eventListeners=new Map;this.queue=getQueue(true)}enableQueue(){this.queue=getQueue(true)}disableQueue(){this.queue=getQueue(false)}async initialize(options){await this.queue(async()=>{await BluetoothLe.initialize(options)})}async isEnabled(){const enabled=await this.queue(async()=>{const result=await BluetoothLe.isEnabled();return result.value});return enabled}async enable(){await this.queue(async()=>{await BluetoothLe.enable()})}async disable(){await this.queue(async()=>{await BluetoothLe.disable()})}async startEnabledNotifications(callback){await this.queue(async()=>{var _a;const key=`onEnabledChanged`;await((_a=this.eventListeners.get(key))===null||_a===void 0?void 0:_a.remove());const listener=await BluetoothLe.addListener(key,result=>{callback(result.value)});this.eventListeners.set(key,listener);await BluetoothLe.startEnabledNotifications()})}async stopEnabledNotifications(){await this.queue(async()=>{var _a;const key=`onEnabledChanged`;await((_a=this.eventListeners.get(key))===null||_a===void 0?void 0:_a.remove());this.eventListeners.delete(key);await BluetoothLe.stopEnabledNotifications()})}async isLocationEnabled(){const enabled=await this.queue(async()=>{const result=await BluetoothLe.isLocationEnabled();return result.value});return enabled}async openLocationSettings(){await this.queue(async()=>{await BluetoothLe.openLocationSettings()})}async openBluetoothSettings(){await this.queue(async()=>{await BluetoothLe.openBluetoothSettings()})}async openAppSettings(){await this.queue(async()=>{await BluetoothLe.openAppSettings()})}async setDisplayStrings(displayStrings){await this.queue(async()=>{await BluetoothLe.setDisplayStrings(displayStrings)})}async requestDevice(options){options=options?this.validateRequestBleDeviceOptions(options):void 0;const result=await this.queue(async()=>{const device=await BluetoothLe.requestDevice(options);return device});return result}async requestLEScan(options,callback){options=this.validateRequestBleDeviceOptions(options);await this.queue(async()=>{var _a;await((_a=this.scanListener)===null||_a===void 0?void 0:_a.remove());this.scanListener=await BluetoothLe.addListener("onScanResult",resultInternal=>{const result=Object.assign(Object.assign({},resultInternal),{manufacturerData:this.convertObject(resultInternal.manufacturerData),serviceData:this.convertObject(resultInternal.serviceData),rawAdvertisement:resultInternal.rawAdvertisement?this.convertValue(resultInternal.rawAdvertisement):void 0});callback(result)});await BluetoothLe.requestLEScan(options)})}async stopLEScan(){await this.queue(async()=>{var _a;await((_a=this.scanListener)===null||_a===void 0?void 0:_a.remove());this.scanListener=null;await BluetoothLe.stopLEScan()})}async getDevices(deviceIds){if(!Array.isArray(deviceIds)){throw new Error("deviceIds must be an array")}return this.queue(async()=>{const result=await BluetoothLe.getDevices({deviceIds});return result.devices})}async getConnectedDevices(services){if(!Array.isArray(services)){throw new Error("services must be an array")}services=services.map(parseUUID);return this.queue(async()=>{const result=await BluetoothLe.getConnectedDevices({services});return result.devices})}async connect(deviceId,onDisconnect,options){await this.queue(async()=>{var _a;if(onDisconnect){const key=`disconnected|${deviceId}`;await((_a=this.eventListeners.get(key))===null||_a===void 0?void 0:_a.remove());const listener=await BluetoothLe.addListener(key,()=>{onDisconnect(deviceId)});this.eventListeners.set(key,listener)}await BluetoothLe.connect(Object.assign({deviceId},options))})}async createBond(deviceId){await this.queue(async()=>{await BluetoothLe.createBond({deviceId})})}async isBonded(deviceId){const isBonded=await this.queue(async()=>{const result=await BluetoothLe.isBonded({deviceId});return result.value});return isBonded}async disconnect(deviceId){await this.queue(async()=>{await BluetoothLe.disconnect({deviceId})})}async getServices(deviceId){const services=await this.queue(async()=>{const result=await BluetoothLe.getServices({deviceId});return result.services});return services}async discoverServices(deviceId){await this.queue(async()=>{await BluetoothLe.discoverServices({deviceId})})}async getMtu(deviceId){const value=await this.queue(async()=>{const result=await BluetoothLe.getMtu({deviceId});return result.value});return value}async requestConnectionPriority(deviceId,connectionPriority){await this.queue(async()=>{await BluetoothLe.requestConnectionPriority({deviceId,connectionPriority})})}async readRssi(deviceId){const value=await this.queue(async()=>{const result=await BluetoothLe.readRssi({deviceId});return parseFloat(result.value)});return value}async read(deviceId,service,characteristic,options){service=parseUUID(service);characteristic=parseUUID(characteristic);const value=await this.queue(async()=>{const result=await BluetoothLe.read(Object.assign({deviceId,service,characteristic},options));return this.convertValue(result.value)});return value}async write(deviceId,service,characteristic,value,options){service=parseUUID(service);characteristic=parseUUID(characteristic);return this.queue(async()=>{if(!(value===null||value===void 0?void 0:value.buffer)){throw new Error("Invalid data.")}let writeValue=value;if(Capacitor.getPlatform()!=="web"){writeValue=dataViewToHexString(value)}await BluetoothLe.write(Object.assign({deviceId,service,characteristic,value:writeValue},options))})}async writeWithoutResponse(deviceId,service,characteristic,value,options){service=parseUUID(service);characteristic=parseUUID(characteristic);await this.queue(async()=>{if(!(value===null||value===void 0?void 0:value.buffer)){throw new Error("Invalid data.")}let writeValue=value;if(Capacitor.getPlatform()!=="web"){writeValue=dataViewToHexString(value)}await BluetoothLe.writeWithoutResponse(Object.assign({deviceId,service,characteristic,value:writeValue},options))})}async readDescriptor(deviceId,service,characteristic,descriptor,options){service=parseUUID(service);characteristic=parseUUID(characteristic);descriptor=parseUUID(descriptor);const value=await this.queue(async()=>{const result=await BluetoothLe.readDescriptor(Object.assign({deviceId,service,characteristic,descriptor},options));return this.convertValue(result.value)});return value}async writeDescriptor(deviceId,service,characteristic,descriptor,value,options){service=parseUUID(service);characteristic=parseUUID(characteristic);descriptor=parseUUID(descriptor);return this.queue(async()=>{if(!(value===null||value===void 0?void 0:value.buffer)){throw new Error("Invalid data.")}let writeValue=value;if(Capacitor.getPlatform()!=="web"){writeValue=dataViewToHexString(value)}await BluetoothLe.writeDescriptor(Object.assign({deviceId,service,characteristic,descriptor,value:writeValue},options))})}async startNotifications(deviceId,service,characteristic,callback){service=parseUUID(service);characteristic=parseUUID(characteristic);await this.queue(async()=>{var _a;const key=`notification|${deviceId}|${service}|${characteristic}`;await((_a=this.eventListeners.get(key))===null||_a===void 0?void 0:_a.remove());const listener=await BluetoothLe.addListener(key,event=>{callback(this.convertValue(event===null||event===void 0?void 0:event.value))});this.eventListeners.set(key,listener);await BluetoothLe.startNotifications({deviceId,service,characteristic})})}async stopNotifications(deviceId,service,characteristic){service=parseUUID(service);characteristic=parseUUID(characteristic);await this.queue(async()=>{var _a;const key=`notification|${deviceId}|${service}|${characteristic}`;await((_a=this.eventListeners.get(key))===null||_a===void 0?void 0:_a.remove());this.eventListeners.delete(key);await BluetoothLe.stopNotifications({deviceId,service,characteristic})})}validateRequestBleDeviceOptions(options){if(options.services){options.services=options.services.map(parseUUID)}if(options.optionalServices){options.optionalServices=options.optionalServices.map(parseUUID)}return options}convertValue(value){if(typeof value==="string"){return hexStringToDataView(value)}else if(value===void 0){return new DataView(new ArrayBuffer(0))}return value}convertObject(obj){if(obj===void 0){return void 0}const result={};for(const key of Object.keys(obj)){result[key]=this.convertValue(obj[key])}return result}};var BleClient=new BleClientClass;init_conversion();var BLEClient=class extends ByteParser3{constructor(options,location){super();this.client=BleClient;this.devices={};this.location=false;this.initialized=false;this.setupDevice=(device,options2)=>{return new Promise(async(res,rej)=>{this.devices[device.deviceId]={device,deviceId:device.deviceId,...options2};this.client.connect(device.deviceId,deviceId=>{if(this.devices[device.deviceId]?.ondisconnect)this.devices[device.deviceId].ondisconnect(deviceId)},options2?.connectOptions).then(async()=>{let services=await this.getServices(device.deviceId);for(const service in options2?.services){let svc=services.find(o=>{if(o.uuid===service)return true});if(svc)for(const characteristic in options2.services[service]){if(!svc.characteristics.find(o=>{if(o.uuid===characteristic)return true}))continue;let opt=options2.services[service][characteristic];if(opt.write){await this.write(device,service,characteristic,opt.write,opt.writeCallback,opt.writeOptions)}if(opt.read){await this.read(device,service,characteristic,opt.readCallback,opt.readOptions)}if(opt.notify&&opt.notifyCallback){await this.subscribe(device,service,characteristic,opt.notifyCallback);opt.notifying=true}}}}).catch(rej);res(this.devices[device.deviceId])})};this.triangulate=(device,duration=1500,sampleRate=60)=>{return new Promise((res,rej)=>{if("Accelerometer"in globalThis){if(typeof globalThis.Accelerometer==="function"){let acl=new globalThis.Accelerometer({frequency:sampleRate});let start=performance.now();let now=start;let result={samples:[],vector:{}};let onread=()=>{if(now-start<duration){this.readRssi(device).then(rssi=>{let x3=acl.x;let y22=acl.y;let z22=acl.z;now=performance.now();result.samples.push({x:x3,y:y22,z:z22,rssi,timestamp:now})})}else{let vector={x:0,y:0,z:0,rssiAvg:0};result.samples.forEach(s=>{});acl.removeEventListener("reading",onread)}};acl.addEventListener("reading",onread)}}else rej(new Error("No Accelerometer API detected"))})};if(location)this.location=location;if(options){this.setup(options)}}setup(options,location=this.location){let services=[];if(options){for(const serviceuuid in options.services){services.push(serviceuuid)}}let opts={};if(!location)opts.androidNeverForLocation=false;return new Promise(async(res,rej)=>{if(!this.initialized){await this.client.initialize(opts);this.initialized=true}if(options?.deviceId){res(await this.reconnect(options.deviceId))}else{if(options){let services2=Array.from(Object.keys(options.services));let deviceRequest={};if(!this.isMobile()){deviceRequest.optionalServices=services2}if(options.name)deviceRequest.name=options.name;if(options.namePrefix)deviceRequest.namePrefix=options.namePrefix;this.client.requestDevice(deviceRequest).then(device=>{res(this.setupDevice(device,options))}).catch(rej)}else{this.client.requestDevice().then(device=>{res(this.setupDevice(device,options))}).catch(rej)}}})}initialize(options){return new Promise((res,rej)=>{this.client.initialize(options).then(()=>{res(true)}).catch(rej)})}requestDevice(request,options){return new Promise((res,rej)=>{this.client.requestDevice(request).then(device=>{this.devices[device.deviceId]={device,deviceId:device.deviceId,...options};res(device)}).catch(rej)})}getServices(deviceId){return this.client.getServices(deviceId)}connect(device,options){return new Promise((res,rej)=>{this.client.connect(device.deviceId,deviceId=>{if(options?.ondisconnect)options.ondisconnect(deviceId)},options?.connectOptions).then(connected=>{res(device)}).catch(rej)})}reconnect(deviceId,options){return new Promise((res,rej)=>{let opts=options;if(this.devices[deviceId])opts=Object.assign(Object.assign({},this.devices[deviceId]),opts);if(opts?.deviceId)delete opts.deviceId;this.client.getDevices([deviceId]).then(devices=>{this.setupDevice(devices[0],opts).then(device=>{res(device)})}).catch(rej)})}disconnect(device){if(typeof device==="object"){if(device?.deviceId){device=device.deviceId};}if(typeof device==="string"){let info=this.devices[device];if(info.beforedisconnect)info.beforedisconnect(this,info);delete this.devices[device];return this.client.disconnect(device)}}write(device,service,characteristic,value,callback,options){if(typeof device==="object")device=device.deviceId;if(callback){return this.client.write(device,service,characteristic,BLEClient.toDataView(value)).then(callback)}else return this.client.writeWithoutResponse(device,service,characteristic,BLEClient.toDataView(value),options)}read(device,service,characteristic,ondata,options){if(typeof device==="object")device=device.deviceId;if(ondata)return this.client.read(device,service,characteristic,options).then(ondata);else return this.client.read(device,service,characteristic,options)}subscribe(device,service,characteristic,ondata){if(typeof device==="object")device=device.deviceId;return this.client.startNotifications(device,service,characteristic,ondata)}unsubscribe(device,service,characteristic){if(typeof device==="object")device=device.deviceId;return this.client.stopNotifications(device,service,characteristic)}scan(options,callback){return this.client.requestLEScan(options,callback)}stopScanning(){return this.client.stopLEScan()}readDescriptor(device,service,characteristic,descriptor,options){return this.client.readDescriptor(device.deviceId,service,characteristic,descriptor,options)}writeDescriptor(device,service,characteristic,descriptor,value,options){return this.client.writeDescriptor(device.deviceId,service,characteristic,descriptor,BLEClient.toDataView(value),options)}readRssi(device){return this.client.readRssi(device.deviceId)}isMobile(){let check=false;(function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4)))check=true})(navigator.userAgent||navigator.vendor||window.opera);return check}isAndroid(){const device=navigator.userAgent.toLowerCase();return device.indexOf("android")>-1}async distance(device,txPower,x3,exp,c){let rssi=await this.readRssi(device);if(rssi==0)return void 0;let ratio=rssi/txPower;if(ratio<1){return Math.pow(ratio,10)}else{return x3*Math.pow(ratio,exp)+c}}async distanceFromPhone(device,txPower,model){let x3,exp,c;if(model){if(model==="nexus5"){x3=.42093;exp=6.9476;c=.54992}else if(model==="motoX"){x3=.9401940951;exp=6.170094565;c=0}else if(model==="iphone5"){x3=.89976;exp=7.7095;c=.111}}return await this.distance(device,txPower,x3,exp,c)}};(function(s){var w,f={},l=console,m=Math,z22="postMessage",x3="HackTimer.js by turuslan: ",v2="Initialisation failed",p2=0,r="hasOwnProperty",y22=[].slice,b=Worker;function d2(){do{p2=2147483647>p2?p2+1:0}while(f[r](p2));return p2}if(!/MSIE 10/i.test(navigator.userAgent)){try{s=URL.createObjectURL(new Blob(["var f={},p=postMessage,r=\'hasOwnProperty\';onmessage=function(e){var d=e.data,i=d.i,t=d[r](\'t\')?d.t:0;switch(d.n){case\'a\':f[i]=setInterval(function(){p(i)},t);break;case\'b\':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case\'c\':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case\'d\':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch(e){}}if(typeof b!=="undefined"){try{w=new b(s);setInterval=function(c,t22){var i22=d2();f[i22]={c,p:y22.call(arguments,2)};w[z22]({n:"a",i:i22,t:t22});return i22};clearInterval=function(i22){if(f[r](i22))delete f[i22],w[z22]({n:"b",i:i22})};setTimeout=function(c,t22){var i22=d2();f[i22]={c,p:y22.call(arguments,2),t:true};w[z22]({n:"c",i:i22,t:t22});return i22};clearTimeout=function(i22){if(f[r](i22))delete f[i22],w[z22]({n:"d",i:i22})};w.onmessage=function(e){var i22=e.data,c,n;if(f[r](i22)){n=f[i22];c=n.c;if(n[r]("t"))delete f[i22]}if(typeof c=="string")try{c=new Function(c)}catch(k){l.log(x3+"Error parsing callback code string: ",k)}if(typeof c=="function")c.apply(globalThis,n.p)};w.onerror=function(e){l.log(e)}}catch(e){l.log(x3+v2);l.error(e)}}else l.log(x3+v2+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js");var sps10=250;var gain4=32;var nbits4=24;var vref4=1.2;var half24bit2=Math.pow(2,24)/2;function ads131m08codec2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i22=0;i22<9;i22++){let j=i22*25;output[0][i22]=ByteParser3.bytesToInt24(arr[j],arr[j+1],arr[j+2]);output[1][i22]=ByteParser3.bytesToInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i22]=ByteParser3.bytesToInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i22]=ByteParser3.bytesToInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i22]=ByteParser3.bytesToInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i22]=ByteParser3.bytesToInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i22]=ByteParser3.bytesToInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i22]=ByteParser3.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])}if(arr.length>225){output.leds=arr.slice(225)}return output}function ads131m08codec_singleended2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i22=0;i22<9;i22++){let j=i22*25;output[0][i22]=ByteParser3.bytesToInt24(arr[j],arr[j+1],arr[j+2])+half24bit2;output[1][i22]=ByteParser3.bytesToInt24(arr[j+3],arr[j+4],arr[j+5])+half24bit2;output[2][i22]=ByteParser3.bytesToInt24(arr[j+6],arr[j+7],arr[j+8])+half24bit2;output[3][i22]=ByteParser3.bytesToInt24(arr[j+9],arr[j+10],arr[j+11])+half24bit2;output[4][i22]=ByteParser3.bytesToInt24(arr[j+12],arr[j+13],arr[j+14])+half24bit2;output[5][i22]=ByteParser3.bytesToInt24(arr[j+15],arr[j+16],arr[j+17])+half24bit2;output[6][i22]=ByteParser3.bytesToInt24(arr[j+18],arr[j+19],arr[j+20])+half24bit2;output[7][i22]=ByteParser3.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])+half24bit2}if(arr.length>225){output.leds=arr.slice(225)}return output}var decoder2=new TextDecoder;var defaultChartSetting8={nSec:10,sps:sps10,units:"mV"};var ads131m08ChartSettings2={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting8)),"1":JSON.parse(JSON.stringify(defaultChartSetting8)),"2":JSON.parse(JSON.stringify(defaultChartSetting8)),"3":JSON.parse(JSON.stringify(defaultChartSetting8)),"4":JSON.parse(JSON.stringify(defaultChartSetting8)),"5":JSON.parse(JSON.stringify(defaultChartSetting8)),"6":JSON.parse(JSON.stringify(defaultChartSetting8)),"7":JSON.parse(JSON.stringify(defaultChartSetting8))}};var defaultsetting5={sps:sps10,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref4/(gain4*(Math.pow(2,nbits4)-1))};var halfOffset2=.96*1e3*vref4/(gain4*(Math.pow(2,nbits4)-1))*(Math.pow(2,nbits4)-1)*.5;var ads131m08FilterSettings2={"0":JSON.parse(JSON.stringify(defaultsetting5)),"1":JSON.parse(JSON.stringify(defaultsetting5)),"2":JSON.parse(JSON.stringify(defaultsetting5)),"3":JSON.parse(JSON.stringify(defaultsetting5)),"4":JSON.parse(JSON.stringify(defaultsetting5)),"5":JSON.parse(JSON.stringify(defaultsetting5)),"6":JSON.parse(JSON.stringify(defaultsetting5)),"7":JSON.parse(JSON.stringify(defaultsetting5))};var accScale2=.002/Math.pow(2,4);var getAcc2=(arr,output,channels=8)=>{const accIdx=channels*3+1;const sum=(a,b)=>a+b;const accSum=arr.slice(accIdx).reduce(sum,0);if(accSum!==0){output.ax=accScale2*ByteParser3.bytesToInt16(arr[accIdx],arr[accIdx+1]);output.ay=accScale2*ByteParser3.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output.az=accScale2*ByteParser3.bytesToInt16(arr[accIdx+4],arr[accIdx+5])}};function cytoncodec2(data){let arr;if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i22=0;i22<8;i22++){let idx=1+3*i22;output[i22]=ByteParser3.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc2(arr,output);output.timestamp=Date.now();return output}function daisycytoncodec2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i22=0;i22<8;i22++){let idx=1+3*i22;if(arr[0]%2===0)output[i22+7]=ByteParser3.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2]);else output[i22]=ByteParser3.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc2(arr,output);return output}var sps22=250;var cytonSerialSettings2={deviceType:"USB",deviceName:"cyton",baudRate:115200,codec:cytoncodec2,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps22};var daisycytonSerialSettings2={deviceType:"USB",deviceName:"cyton_daisy",baudRate:115200,codec:daisycytoncodec2,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps22};var defaultChartSetting23={nSec:10,sps:sps22,units:"mV"};var defaultChartSetting222={nSec:10,sps:sps22};var cytonChartSettings2={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting23)),"1":JSON.parse(JSON.stringify(defaultChartSetting23)),"2":JSON.parse(JSON.stringify(defaultChartSetting23)),"3":JSON.parse(JSON.stringify(defaultChartSetting23)),"4":JSON.parse(JSON.stringify(defaultChartSetting23)),"5":JSON.parse(JSON.stringify(defaultChartSetting23)),"6":JSON.parse(JSON.stringify(defaultChartSetting23)),"7":JSON.parse(JSON.stringify(defaultChartSetting23)),"ax":JSON.parse(JSON.stringify(defaultChartSetting222)),"ay":JSON.parse(JSON.stringify(defaultChartSetting222)),"az":JSON.parse(JSON.stringify(defaultChartSetting222))},generateNewLines:true};var defaultsetting22={sps:sps22,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))};var cytonFilterSettings2={"0":JSON.parse(JSON.stringify(defaultsetting22)),"1":JSON.parse(JSON.stringify(defaultsetting22)),"2":JSON.parse(JSON.stringify(defaultsetting22)),"3":JSON.parse(JSON.stringify(defaultsetting22)),"4":JSON.parse(JSON.stringify(defaultsetting22)),"5":JSON.parse(JSON.stringify(defaultsetting22)),"6":JSON.parse(JSON.stringify(defaultsetting22)),"7":JSON.parse(JSON.stringify(defaultsetting22)),"8":JSON.parse(JSON.stringify(defaultsetting22)),"9":JSON.parse(JSON.stringify(defaultsetting22)),"10":JSON.parse(JSON.stringify(defaultsetting22)),"11":JSON.parse(JSON.stringify(defaultsetting22)),"12":JSON.parse(JSON.stringify(defaultsetting22)),"13":JSON.parse(JSON.stringify(defaultsetting22)),"14":JSON.parse(JSON.stringify(defaultsetting22)),"15":JSON.parse(JSON.stringify(defaultsetting22))};function freeeeg128codec2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i22=0;i22<128;i22++){let idx=i22*3+1;output[i22]=ByteParser3.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=385;output["ax"]=ByteParser3.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser3.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser3.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser3.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser3.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser3.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps32=250;var freeeeg128SerialSettings2={deviceType:"USB",deviceName:"freeeeg128",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg128codec2,sps:sps32,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg128ChartSettings2={lines:{"ax":{nSec:10,sps:sps32},"ay":{nSec:10,sps:sps32},"az":{nSec:10,sps:sps32},"gx":{nSec:10,sps:sps32},"gy":{nSec:10,sps:sps32},"gz":{nSec:10,sps:sps32}}};var freeeeg128FilterSettings2={};for(let i22=0;i22<128;i22++){freeeeg128ChartSettings2.lines[i22]={sps:sps32,nSec:10,units:"mV"};freeeeg128FilterSettings2[i22]={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))}}function freeeeg32codec2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i22=0;i22<32;i22++){let idx=i22*3+1;output[i22]=ByteParser3.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=97;output["ax"]=ByteParser3.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser3.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser3.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser3.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser3.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser3.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps42=512;var freeeeg32SerialSettings2={deviceType:"USB",deviceName:"freeeeg32",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec2,sps:sps42,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg32_optical_SerialSettings2={deviceType:"USB",deviceName:"freeeeg32_optical",baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec2,sps:sps42,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting32={nSec:10,sps:sps42};var freeeeg32ChartSettings2={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting32)),"ay":JSON.parse(JSON.stringify(defaultChartSetting32)),"az":JSON.parse(JSON.stringify(defaultChartSetting32)),"gx":JSON.parse(JSON.stringify(defaultChartSetting32)),"gy":JSON.parse(JSON.stringify(defaultChartSetting32)),"gz":JSON.parse(JSON.stringify(defaultChartSetting32))}};var freeeeg32FilterSettings2={};for(let i22=0;i22<32;i22++){freeeeg32ChartSettings2.lines[i22]={sps:sps42,nSec:10,units:"mV"};freeeeg32FilterSettings2[i22]={sps:sps42,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))}}function freeeeg16codec2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i22=0;i22<16;i22++){let idx=i22*3+1;output[i22]=ByteParser3.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser3.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser3.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser3.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser3.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser3.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser3.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var BLEBuffer2=[];var locked2;var lockIdx2;function freeeeg16BLEcodec2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;BLEBuffer2.push(...data);const needle=new Uint8Array([192,160]);const haystack=BLEBuffer2;const search=ByteParser3.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=lockIdx2??0;let pass=false;for(var i22=search(haystack);i22!==-1;i22=search(haystack,i22+skip)){if(!locked2&&!(typeof lockIdx2==="number"))used=lockIdx2=i22;else{nextIndex=i22;if(nextIndex>=0){const len=nextIndex-used;if(!lockIdx2){const line=BLEBuffer2.splice(lockIdx2,len);arr=new Uint8Array(line.slice(needle.length));pass=true;locked2=true}else if(len>0){const line=BLEBuffer2.splice(lockIdx2,len);arr=new Uint8Array(line.slice(needle.length));pass=true}used=nextIndex}}}if(pass){let output={};for(let i3=0;i3<16;i3++){let idx=i3*3+1;output[i3]=ByteParser3.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser3.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser3.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser3.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser3.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser3.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser3.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}else return void 0}var sps52=250;var freeeeg16BLESettings2={deviceType:"BLE",deviceName:"freeeeg16",services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:void 0},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:freeeeg16BLEcodec2,sps:sps52}}}};var freeeeg16SerialSettings2={deviceType:"USB",deviceName:"freeeeg16",baudRate:115200,bufferSize:2e3,frequency:3.5,codec:freeeeg16codec2,sps:sps52,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting42={nSec:10,sps:sps52};var freeeeg16ChartSettings2={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting42)),"ay":JSON.parse(JSON.stringify(defaultChartSetting42)),"az":JSON.parse(JSON.stringify(defaultChartSetting42)),"gx":JSON.parse(JSON.stringify(defaultChartSetting42)),"gy":JSON.parse(JSON.stringify(defaultChartSetting42)),"gz":JSON.parse(JSON.stringify(defaultChartSetting42))}};var freeeeg16FilterSettings2={};var gain22=32;var nbits22=24;var vref22=1.2;for(let i22=0;i22<16;i22++){freeeeg16ChartSettings2.lines[i22]={sps:sps52,nSec:10,units:"mV"};freeeeg16FilterSettings2[i22]={sps:sps52,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref22/(gain22*(Math.pow(2,nbits22)-1))}}var textdecoder4=new TextDecoder;function hegduinocodec2(value){let output={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0};let txt=textdecoder4.decode(value);let line=txt.split("|");if(line.length===3){output.timestamp=Date.now();output.red=parseInt(line[0]);output.infrared=parseInt(line[1]);output.heg=parseFloat(line[2])}else if(line.length>=2){output.timestamp=Date.now();output.red=parseInt(line[1]);output.infrared=parseInt(line[2]);output.heg=parseFloat(line[3]);if(line[4])output.ambient=parseFloat(line[4]);if(line[5])output.temperature=parseFloat(line[5]);return output}else return txt}var sps62=40;var hegduinoSerialSettings2={deviceType:"USB",deviceName:"hegduino",baudRate:115200,write:"t\\n",codec:hegduinocodec2,sps:sps62};var hegduinoV1SerialSettings2=Object.assign({},hegduinoSerialSettings2);hegduinoV1SerialSettings2.sps=19;var hegduinoBLESettings2={deviceType:"BLE",deviceName:"hegduino",sps:sps62,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:hegduinocodec2,sps:sps62}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};var hegduinoV1BLESettings2=Object.assign({},hegduinoSerialSettings2);hegduinoV1BLESettings2.sps=19;function max3010xcodec2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let pktCt=32;const output={"red":new Array(pktCt),"ir":new Array(pktCt),"max_dietemp":ByteParser3.get2sCompliment(arr[193],8)+.0625*arr[194],"timestamp":Date.now()};let i22=0;while(i22<pktCt){let idx=i22*6;if(i22%2===0){output["ir"][i22]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["ir"][i22+1]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}else{output["red"][i22-1]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["red"][i22]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}i22++}return output}function mpu6050codec2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={"ax":new Array(20),"ay":new Array(20),"az":new Array(20),"gx":new Array(20),"gy":new Array(20),"gz":new Array(20),"mpu_dietemp":(ByteParser3.bytesToInt16(arr[241],arr[242])+521)/340+35,timestamp:Date.now()};for(let i22=0;i22<20;i22++){let idx=i22*12;output.ax[i22]=ByteParser3.bytesToInt16(arr[idx+1],arr[idx+2]);output.ay[i22]=ByteParser3.bytesToInt16(arr[idx+3],arr[idx+4]);output.az[i22]=ByteParser3.bytesToInt16(arr[idx+5],arr[idx+6]);output.gx[i22]=ByteParser3.bytesToInt16(arr[idx+7],arr[idx+8]);output.gy[i22]=ByteParser3.bytesToInt16(arr[idx+9],arr[idx+10]);output.gz[i22]=ByteParser3.bytesToInt16(arr[idx+11],arr[idx+12])}return output}function cognixionONE_EEG_codec2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let i22=0;i22<7;i22++){let j=i22*26+1;if(!arr[j+23])break;output[0][i22]=ByteParser3.bytesToUInt24(arr[j],arr[j+1],arr[j+2]);output[1][i22]=ByteParser3.bytesToUInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i22]=ByteParser3.bytesToUInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i22]=ByteParser3.bytesToUInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i22]=ByteParser3.bytesToUInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i22]=ByteParser3.bytesToUInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i22]=ByteParser3.bytesToUInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i22]=ByteParser3.bytesToUInt24(arr[j+21],arr[j+22],arr[j+23])}return output}var sps82=250;var cognixionONEBLESettings2={deviceType:"BLE",deviceName:"cognixionONE",services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:true,notifyCallback:void 0,codec:cognixionONE_EEG_codec2,sps:sps82}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:true}}},sps:sps82};var cognixionONESerialSettings2=Object.assign({},cytonSerialSettings2);cognixionONESerialSettings2.sps=sps82;cognixionONESerialSettings2.deviceName="cognixionONE";var defaultChartSetting52={nSec:10,sps:sps82,units:"mV"};var cognixionONEChartSettings2={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting52)),"1":JSON.parse(JSON.stringify(defaultChartSetting52)),"2":JSON.parse(JSON.stringify(defaultChartSetting52)),"3":JSON.parse(JSON.stringify(defaultChartSetting52)),"4":JSON.parse(JSON.stringify(defaultChartSetting52)),"5":JSON.parse(JSON.stringify(defaultChartSetting52)),"6":JSON.parse(JSON.stringify(defaultChartSetting52)),"7":JSON.parse(JSON.stringify(defaultChartSetting52))}};var PeanutCodes2={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function peanutcodec2(data){let result={};let i22=0;while(i22<data.length){if(PeanutCodes2[data[i22]]&&i22+1+PeanutCodes2[data[i22]].byteLength<=data.length){let slice=data.slice(i22+1,i22+1+PeanutCodes2[data[i22]].byteLength).buffer;let unpacked=ByteParser3.struct(PeanutCodes2[data[i22]].format).unpack(slice);let code=PeanutCodes2[data[i22]].type;if(code==="unfilteredHEG"||code==="heg")unpacked=unpacked[0]/256;else if(code==="POOR_SIGNAL"||code==="sampleNumber"||code==="debug0"||code==="debug1"||code==="debug2"||code==="debug3")unpacked=unpacked[0];if(!result[PeanutCodes2[data[i22]].type]){if(Array.isArray(unpacked))result[PeanutCodes2[data[i22]].type]=unpacked;else result[PeanutCodes2[data[i22]].type]=[unpacked]}else{if(Array.isArray(unpacked))result[PeanutCodes2[data[i22]].type].push(...unpacked);else result[PeanutCodes2[data[i22]].type].push(unpacked)}i22+=PeanutCodes2[data[i22]].byteLength+1}else i22++}result.timestamp=Date.now();return result}var peanutSerialSettings2={deviceType:"USB",deviceName:"peanut",baudRate:38400,bufferSize:400,write:"protocol 3\\n",buffering:{searchBytes:new Uint8Array([170,170])},codec:peanutcodec2,sps:10.101};var sealevel_hpa2=1013.25;var bme280codec2=data=>{let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={timestamp:Date.now(),temp:[],pressure:[],altitude:[]};let mode=0;if(arr[0].length===74)mode=1;if(!mode){for(let j=0;j<3;j++){let i22=j*16+2;let tint=ByteParser3.bytesToInt32(arr[3+i22],arr[2+i22],arr[1+i22],arr[0+i22]);let tfrac=ByteParser3.bytesToInt32(arr[7+i22],arr[6+i22],arr[5+i22],arr[4+i22]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser3.bytesToInt32(arr[11+i22],arr[10+i22],arr[9+i22],arr[8+i22]);let pfrac=ByteParser3.bytesToInt32(arr[15+i22],arr[14+i22],arr[13+i22],arr[12+i22]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));output.altitude.push(altitude2(output.pressure[j],output.temp[j]))}}else{output.humidity=[];for(let j=0;j<3;j++){let i22=j*24+2;let tint=ByteParser3.bytesToInt32(arr[3+i22],arr[2+i22],arr[1+i22],arr[0+i22]);let tfrac=ByteParser3.bytesToInt32(arr[7+i22],arr[6+i22],arr[5+i22],arr[4+i22]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser3.bytesToInt32(arr[11+i22],arr[10+i22],arr[9+i22],arr[8+i22]);let pfrac=ByteParser3.bytesToInt32(arr[15+i22],arr[14+i22],arr[13+i22],arr[12+i22]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));let hint=ByteParser3.bytesToInt32(arr[19+i22],arr[18+i22],arr[17+i22],arr[16+i22]);let hfrac=ByteParser3.bytesToInt32(arr[23+i22],arr[22+i22],arr[21+i22],arr[20+i22]);output.humidity.push(hint+hfrac/Math.pow(10,Math.ceil(Math.log10(hfrac))));output.altitude.push(altitude2(output.pressure[j],output.temp[j]))}}return output};function altitude2(pressure,temperature){return 44330*(1-Math.pow(pressure/sealevel_hpa2,.1903))}function nrf5x_usbcodec2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec2(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec2(arr.subarray(2)));Object.keys(result).forEach((key,i22)=>{output[i22+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec2(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec2(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec2(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec2(arr.subarray(2))))}return output}function nrf5x_usbcodec_singleended2(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec_singleended2(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec2(arr.subarray(2)));Object.keys(result).forEach((key,i22)=>{output[i22+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec2(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec2(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec2(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec_singleended2(arr.subarray(2))))}return output}var nrf5xSerialSettings2={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec2,sps:250};var nrf5xSerialSettings_singleended2={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec_singleended2,sps:250};var nrf5xBLESettings2={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec2,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec2,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec2,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec2,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec2,sps:3.33}}}};var nrf5xBLESettings_singleended2={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended2,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec2,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec2,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended2,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec2,sps:3.33}}}};var defaultChartSetting62={nSec:10,sps:250,units:"mV"};var nrf5x_usbChartSettings2={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting62)),"1":JSON.parse(JSON.stringify(defaultChartSetting62)),"2":JSON.parse(JSON.stringify(defaultChartSetting62)),"3":JSON.parse(JSON.stringify(defaultChartSetting62)),"4":JSON.parse(JSON.stringify(defaultChartSetting62)),"5":JSON.parse(JSON.stringify(defaultChartSetting62)),"6":JSON.parse(JSON.stringify(defaultChartSetting62)),"7":JSON.parse(JSON.stringify(defaultChartSetting62))},generateNewLines:true,cleanGeneration:false};var gain32=32;var nbits32=24;var vref32=1.2;var defaultsetting32={sps:250,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref32/(gain32*(Math.pow(2,nbits32)-1))};var nrf5x_usbFilterSettings2={"0":JSON.parse(JSON.stringify(defaultsetting32)),"1":JSON.parse(JSON.stringify(defaultsetting32)),"2":JSON.parse(JSON.stringify(defaultsetting32)),"3":JSON.parse(JSON.stringify(defaultsetting32)),"4":JSON.parse(JSON.stringify(defaultsetting32)),"5":JSON.parse(JSON.stringify(defaultsetting32)),"6":JSON.parse(JSON.stringify(defaultsetting32)),"7":JSON.parse(JSON.stringify(defaultsetting32)),"8":JSON.parse(JSON.stringify(defaultsetting32)),"9":JSON.parse(JSON.stringify(defaultsetting32)),"10":JSON.parse(JSON.stringify(defaultsetting32)),"11":JSON.parse(JSON.stringify(defaultsetting32)),"12":JSON.parse(JSON.stringify(defaultsetting32)),"13":JSON.parse(JSON.stringify(defaultsetting32)),"14":JSON.parse(JSON.stringify(defaultsetting32)),"15":JSON.parse(JSON.stringify(defaultsetting32))};var textdecoder22=new TextDecoder;function statechangercodec2(value){let output={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0};let txt=textdecoder22.decode(value);let line=txt.split("|");if(line.length>=5){output.timestamp=Date.now();output.left_red=parseInt(line[1]);output.left_infrared=parseInt(line[2]);output.left_heg=parseFloat(line[3]);output.center_red=parseInt(line[4]);output.center_infrared=parseInt(line[5]);output.center_heg=parseFloat(line[6]);output.right_red=parseInt(line[7]);output.right_infrared=parseInt(line[8]);output.right_heg=parseFloat(line[9]);return output}else return txt}var statechangerSerialSettings2={deviceType:"USB",deviceName:"statechanger",baudRate:115200,codec:statechangercodec2,sps:20};var statechangerBLESettings2={deviceType:"BLE",deviceName:"statechanger",sps:20,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:statechangercodec2}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};function blueberrycodec2(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.red/(.5*(output.ir+output.ir2));return output}var sps92=40;var blueberryBLESettings2={deviceType:"BLE",deviceName:"blueberry",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:true,notifyCallback:void 0,codec:blueberrycodec2,sps:sps92}}},sps:sps92};function blueberryshortcodec2(value){let output={sred:value.getInt32(2),sir:value.getInt32(6),sir2:value.getInt32(10),timestamp:Date.now()};output.sheg=output.sred/(.5*(output.sir+output.sir2));return output}function blueberrylongcodec2(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.sred/(.5*(output.ir+output.ir2));return output}var sps102=40;var blueberry2BLESettings2={deviceType:"BLE",deviceName:"blueberry2",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:true,notifyCallback:void 0,codec:blueberrylongcodec2,sps:sps102},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:true,notifyCallback:void 0,codec:blueberryshortcodec2,sps:sps102}}},sps:sps102};function hrcodec2(data){return{hr:data.getInt8(1),timestamp:Date.now()}}var heartRateBLESettings2={deviceType:"BLE",deviceName:"heartrate",services:{"heart_rate":{"heart_rate_measurement":{notify:true,notifyCallback:void 0,codec:hrcodec2}}}};var simulatorSettings2={sps:250,deviceType:"CUSTOM",deviceName:"simulator",simulate:{"0":{sps:250,freq:1,amplitude:1,offset:0},"1":{sps:250,freq:10,amplitude:1,offset:0},"2":{sps:250,freq:100,amplitude:.5,offset:.5},"3":{sps:250,freq:25,amplitude:1,offset:0}},connect:(settings={})=>{return new Promise(async(res,rej)=>{let _id=`simulated${Math.floor(Math.random()*1e15)}`;let info={_id,settings:Object.assign(Object.assign({},simulatorSettings2),settings)};info.settings.looping=true;let loopTime=50;let lastTime=Date.now();let loop22=()=>{if(info.settings.looping){let newData={};let now=Date.now();let frame=now-lastTime;for(const key in info.settings.simulate){let newPoints=Math.floor(info.settings.simulate[key].sps*frame/1e3);newData[key]=new Array(newPoints).fill(0);newData[key]=newData[key].map((v2,i22)=>{return Math.sin(2*Math.PI*info.settings.simulate[key].freq*.001*(lastTime+frame*(i22+1)/newPoints))*info.settings.simulate[key].amplitude+info.settings.simulate[key].offset})}lastTime=now;newData.timestamp=lastTime;info.settings.ondata(newData);setTimeout(()=>{loop22()},loopTime)}};loop22();if(info.settings.onconnect)info.settings.onconnect(info);res(info)})},codec:reading=>{return reading},disconnect:info=>{console.log(info);info.settings.looping=false;info.settings.ondisconnect(info)},onconnect:info=>{console.log("simulator connected!",info)},ondisconnect:info=>{console.log("simulator disconnected!",info)},ondata:data=>{}};var defaultsetting12={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var ganglionFilterSettings2={"0":JSON.parse(JSON.stringify(defaultsetting12)),"1":JSON.parse(JSON.stringify(defaultsetting12)),"2":JSON.parse(JSON.stringify(defaultsetting12)),"3":JSON.parse(JSON.stringify(defaultsetting12))};var defaultChartSetting72={nSec:10,sps:250,units:"mV"};var ganglionChartSettings2={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting72)),"1":JSON.parse(JSON.stringify(defaultChartSetting72)),"2":JSON.parse(JSON.stringify(defaultChartSetting72)),"3":JSON.parse(JSON.stringify(defaultChartSetting72)),"ax":{nSec:10,sps:250,units:"mg"},"ay":{nSec:10,sps:250,units:"mg"},"az":{nSec:10,sps:250,units:"mg"}},generateNewLines:true};var defaultsetting42={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var museFilterSettings2={"0":JSON.parse(JSON.stringify(defaultsetting42)),"1":JSON.parse(JSON.stringify(defaultsetting42)),"2":JSON.parse(JSON.stringify(defaultsetting42)),"3":JSON.parse(JSON.stringify(defaultsetting42)),"4":JSON.parse(JSON.stringify(defaultsetting42))};var Devices2={BLE:{"nrf5x":nrf5xBLESettings2,"nrf5x_singleended":nrf5xBLESettings_singleended2,"hegduino":hegduinoBLESettings2,"hegduinoV1":hegduinoV1BLESettings2,"cognixionONE":cognixionONEBLESettings2,"statechanger":statechangerBLESettings2,"blueberry":blueberryBLESettings2,"blueberry2":blueberry2BLESettings2,"heart_rate":heartRateBLESettings2,"freeEEG16":freeeeg16BLESettings2},USB:{"nrf5x":nrf5xSerialSettings2,"nrf5x_singleended":nrf5xSerialSettings_singleended2,"freeEEG16":freeeeg16SerialSettings2,"freeEEG32":freeeeg32SerialSettings2,"freeEEG32_optical":freeeeg32_optical_SerialSettings2,"freeEEG128":freeeeg128SerialSettings2,"hegduino":hegduinoSerialSettings2,"hegduinoV1":hegduinoV1SerialSettings2,"cyton":cytonSerialSettings2,"cyton_daisy":daisycytonSerialSettings2,"peanut":peanutSerialSettings2,"statechanger":statechangerSerialSettings2,"cognixionONE":cytonSerialSettings2},BLE_CUSTOM:{},USB_CUSTOM:{},CUSTOM:{"simulator":simulatorSettings2}};var textdecoder32=new TextDecoder;var BLE=new BLEClient;var workers=new WorkerService2({roots:{...workerCanvasRoutes2,...remoteGraphRoutes2}});var __create4=Object.create;var __defProp4=Object.defineProperty;var __getOwnPropDesc4=Object.getOwnPropertyDescriptor;var __getOwnPropNames4=Object.getOwnPropertyNames;var __getProtoOf4=Object.getPrototypeOf;var __hasOwnProp4=Object.prototype.hasOwnProperty;var __commonJS4=(cb,mod)=>function __require5(){return mod||(0,cb[__getOwnPropNames4(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps4=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames4(from))if(!__hasOwnProp4.call(to,key)&&key!==except)__defProp4(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc4(from,key))||desc.enumerable})}return to};var __toESM4=(mod,isNodeMode,target)=>(target=mod!=null?__create4(__getProtoOf4(mod)):{},__copyProps4(isNodeMode||!mod||!mod.__esModule?__defProp4(target,"default",{value:mod,enumerable:true}):target,mod));var require_browserfs=__commonJS4({"node_modules/browserfs/dist/browserfs.js"(exports,module2){(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module2==="object")module2.exports=factory();else if(typeof define==="function"&&define.amd)define([],factory);else if(typeof exports==="object")exports["BrowserFS"]=factory();else root["BrowserFS"]=factory()})(exports,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module22=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module22.exports,module22,module22.exports,__webpack_require__);module22.loaded=true;return module22.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)}([function(module22,exports2,__webpack_require__){(function(Buffer2,global2,module3,process){"use strict";Object.defineProperty(exports2,"__esModule",{value:true});var buffer=__webpack_require__(2);var path=__webpack_require__(9);var ErrorCode;(function(ErrorCode2){ErrorCode2[ErrorCode2["EPERM"]=1]="EPERM";ErrorCode2[ErrorCode2["ENOENT"]=2]="ENOENT";ErrorCode2[ErrorCode2["EIO"]=5]="EIO";ErrorCode2[ErrorCode2["EBADF"]=9]="EBADF";ErrorCode2[ErrorCode2["EACCES"]=13]="EACCES";ErrorCode2[ErrorCode2["EBUSY"]=16]="EBUSY";ErrorCode2[ErrorCode2["EEXIST"]=17]="EEXIST";ErrorCode2[ErrorCode2["ENOTDIR"]=20]="ENOTDIR";ErrorCode2[ErrorCode2["EISDIR"]=21]="EISDIR";ErrorCode2[ErrorCode2["EINVAL"]=22]="EINVAL";ErrorCode2[ErrorCode2["EFBIG"]=27]="EFBIG";ErrorCode2[ErrorCode2["ENOSPC"]=28]="ENOSPC";ErrorCode2[ErrorCode2["EROFS"]=30]="EROFS";ErrorCode2[ErrorCode2["ENOTEMPTY"]=39]="ENOTEMPTY";ErrorCode2[ErrorCode2["ENOTSUP"]=95]="ENOTSUP"})(ErrorCode||(ErrorCode={}));var ErrorStrings={};ErrorStrings[ErrorCode.EPERM]="Operation not permitted.";ErrorStrings[ErrorCode.ENOENT]="No such file or directory.";ErrorStrings[ErrorCode.EIO]="Input/output error.";ErrorStrings[ErrorCode.EBADF]="Bad file descriptor.";ErrorStrings[ErrorCode.EACCES]="Permission denied.";ErrorStrings[ErrorCode.EBUSY]="Resource busy or locked.";ErrorStrings[ErrorCode.EEXIST]="File exists.";ErrorStrings[ErrorCode.ENOTDIR]="File is not a directory.";ErrorStrings[ErrorCode.EISDIR]="File is a directory.";ErrorStrings[ErrorCode.EINVAL]="Invalid argument.";ErrorStrings[ErrorCode.EFBIG]="File is too big.";ErrorStrings[ErrorCode.ENOSPC]="No space left on disk.";ErrorStrings[ErrorCode.EROFS]="Cannot modify a read-only file system.";ErrorStrings[ErrorCode.ENOTEMPTY]="Directory is not empty.";ErrorStrings[ErrorCode.ENOTSUP]="Operation is not supported.";var ApiError=function(Error2){function ApiError2(type,message,path$$1){if(message===void 0)message=ErrorStrings[type];Error2.call(this,message);this.syscall="";this.errno=type;this.code=ErrorCode[type];this.path=path$$1;this.stack=new Error2().stack;this.message="Error: "+this.code+": "+message+(this.path?", \'"+this.path+"\'":"")}if(Error2)ApiError2.__proto__=Error2;ApiError2.prototype=Object.create(Error2&&Error2.prototype);ApiError2.prototype.constructor=ApiError2;ApiError2.fromJSON=function fromJSON(json){var err=new ApiError2(0);err.errno=json.errno;err.code=json.code;err.path=json.path;err.stack=json.stack;err.message=json.message;return err};ApiError2.fromBuffer=function fromBuffer(buffer$$1,i22){if(i22===void 0)i22=0;return ApiError2.fromJSON(JSON.parse(buffer$$1.toString("utf8",i22+4,i22+4+buffer$$1.readUInt32LE(i22))))};ApiError2.FileError=function FileError(code,p2){return new ApiError2(code,ErrorStrings[code],p2)};ApiError2.ENOENT=function ENOENT(path$$1){return this.FileError(ErrorCode.ENOENT,path$$1)};ApiError2.EEXIST=function EEXIST(path$$1){return this.FileError(ErrorCode.EEXIST,path$$1)};ApiError2.EISDIR=function EISDIR(path$$1){return this.FileError(ErrorCode.EISDIR,path$$1)};ApiError2.ENOTDIR=function ENOTDIR(path$$1){return this.FileError(ErrorCode.ENOTDIR,path$$1)};ApiError2.EPERM=function EPERM(path$$1){return this.FileError(ErrorCode.EPERM,path$$1)};ApiError2.ENOTEMPTY=function ENOTEMPTY(path$$1){return this.FileError(ErrorCode.ENOTEMPTY,path$$1)};ApiError2.prototype.toString=function toString(){return this.message};ApiError2.prototype.toJSON=function toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message}};ApiError2.prototype.writeToBuffer=function writeToBuffer(buffer$$1,i22){if(buffer$$1===void 0)buffer$$1=Buffer2.alloc(this.bufferSize());if(i22===void 0)i22=0;var bytesWritten=buffer$$1.write(JSON.stringify(this.toJSON()),i22+4);buffer$$1.writeUInt32LE(bytesWritten,i22);return buffer$$1};ApiError2.prototype.bufferSize=function bufferSize(){return 4+Buffer2.byteLength(JSON.stringify(this.toJSON()))};return ApiError2}(Error);var api_error=Object.freeze({get ErrorCode(){return ErrorCode},ErrorStrings,ApiError});var ActionType;(function(ActionType2){ActionType2[ActionType2["NOP"]=0]="NOP";ActionType2[ActionType2["THROW_EXCEPTION"]=1]="THROW_EXCEPTION";ActionType2[ActionType2["TRUNCATE_FILE"]=2]="TRUNCATE_FILE";ActionType2[ActionType2["CREATE_FILE"]=3]="CREATE_FILE"})(ActionType||(ActionType={}));var FileFlag=function FileFlag2(flagStr){this.flagStr=flagStr;if(FileFlag2.validFlagStrs.indexOf(flagStr)<0){throw new ApiError(ErrorCode.EINVAL,"Invalid flag: "+flagStr)}};FileFlag.getFileFlag=function getFileFlag(flagStr){if(FileFlag.flagCache.hasOwnProperty(flagStr)){return FileFlag.flagCache[flagStr]}return FileFlag.flagCache[flagStr]=new FileFlag(flagStr)};FileFlag.prototype.getFlagString=function getFlagString(){return this.flagStr};FileFlag.prototype.isReadable=function isReadable(){return this.flagStr.indexOf("r")!==-1||this.flagStr.indexOf("+")!==-1};FileFlag.prototype.isWriteable=function isWriteable(){return this.flagStr.indexOf("w")!==-1||this.flagStr.indexOf("a")!==-1||this.flagStr.indexOf("+")!==-1};FileFlag.prototype.isTruncating=function isTruncating(){return this.flagStr.indexOf("w")!==-1};FileFlag.prototype.isAppendable=function isAppendable(){return this.flagStr.indexOf("a")!==-1};FileFlag.prototype.isSynchronous=function isSynchronous(){return this.flagStr.indexOf("s")!==-1};FileFlag.prototype.isExclusive=function isExclusive(){return this.flagStr.indexOf("x")!==-1};FileFlag.prototype.pathExistsAction=function pathExistsAction(){if(this.isExclusive()){return ActionType.THROW_EXCEPTION}else if(this.isTruncating()){return ActionType.TRUNCATE_FILE}else{return ActionType.NOP}};FileFlag.prototype.pathNotExistsAction=function pathNotExistsAction(){if((this.isWriteable()||this.isAppendable())&&this.flagStr!=="r+"){return ActionType.CREATE_FILE}else{return ActionType.THROW_EXCEPTION}};FileFlag.flagCache={};FileFlag.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"];var FileType;(function(FileType2){FileType2[FileType2["FILE"]=32768]="FILE";FileType2[FileType2["DIRECTORY"]=16384]="DIRECTORY";FileType2[FileType2["SYMLINK"]=40960]="SYMLINK"})(FileType||(FileType={}));var Stats=function Stats2(itemType,size,mode,atime,mtime,ctime){if(atime===void 0)atime=new Date;if(mtime===void 0)mtime=new Date;if(ctime===void 0)ctime=new Date;this.size=size;this.atime=atime;this.mtime=mtime;this.ctime=ctime;this.dev=0;this.ino=0;this.rdev=0;this.nlink=1;this.blksize=4096;this.uid=0;this.gid=0;this.birthtime=new Date(0);this.fileData=null;if(!mode){switch(itemType){case FileType.FILE:this.mode=420;break;case FileType.DIRECTORY:default:this.mode=511}}else{this.mode=mode}this.blocks=Math.ceil(size/512);if(this.mode<4096){this.mode|=itemType}};Stats.fromBuffer=function fromBuffer(buffer$$1){var size=buffer$$1.readUInt32LE(0),mode=buffer$$1.readUInt32LE(4),atime=buffer$$1.readDoubleLE(8),mtime=buffer$$1.readDoubleLE(16),ctime=buffer$$1.readDoubleLE(24);return new Stats(mode&61440,size,mode&4095,new Date(atime),new Date(mtime),new Date(ctime))};Stats.prototype.toBuffer=function toBuffer(){var buffer$$1=Buffer2.alloc(32);buffer$$1.writeUInt32LE(this.size,0);buffer$$1.writeUInt32LE(this.mode,4);buffer$$1.writeDoubleLE(this.atime.getTime(),8);buffer$$1.writeDoubleLE(this.mtime.getTime(),16);buffer$$1.writeDoubleLE(this.ctime.getTime(),24);return buffer$$1};Stats.prototype.clone=function clone(){return new Stats(this.mode&61440,this.size,this.mode&4095,this.atime,this.mtime,this.ctime)};Stats.prototype.isFile=function isFile(){return(this.mode&61440)===FileType.FILE};Stats.prototype.isDirectory=function isDirectory(){return(this.mode&61440)===FileType.DIRECTORY};Stats.prototype.isSymbolicLink=function isSymbolicLink(){return(this.mode&61440)===FileType.SYMLINK};Stats.prototype.chmod=function chmod(mode){this.mode=this.mode&61440|mode};Stats.prototype.isSocket=function isSocket(){return false};Stats.prototype.isBlockDevice=function isBlockDevice(){return false};Stats.prototype.isCharacterDevice=function isCharacterDevice(){return false};Stats.prototype.isFIFO=function isFIFO(){return false};var wrapCb=function(cb,numArgs){return cb};function assertRoot(fs4){if(fs4){return fs4}throw new ApiError(ErrorCode.EIO,"Initialize BrowserFS with a file system using BrowserFS.initialize(filesystem)")}function normalizeMode(mode,def){switch(typeof mode){case"number":return mode;case"string":var trueMode=parseInt(mode,8);if(!isNaN(trueMode)){return trueMode}return def;default:return def}}function normalizeTime(time){if(time instanceof Date){return time}else if(typeof time==="number"){return new Date(time*1e3)}else{throw new ApiError(ErrorCode.EINVAL,"Invalid time.")}}function normalizePath(p2){if(p2.indexOf("\\0")>=0){throw new ApiError(ErrorCode.EINVAL,"Path must be a string without null bytes.")}else if(p2===""){throw new ApiError(ErrorCode.EINVAL,"Path must not be empty.")}return path.resolve(p2)}function normalizeOptions(options,defEnc,defFlag,defMode){switch(typeof options){case"object":return{encoding:typeof options["encoding"]!=="undefined"?options["encoding"]:defEnc,flag:typeof options["flag"]!=="undefined"?options["flag"]:defFlag,mode:normalizeMode(options["mode"],defMode)};case"string":return{encoding:options,flag:defFlag,mode:defMode};default:return{encoding:defEnc,flag:defFlag,mode:defMode}}}function nopCb(){}var FS=function FS2(){this.F_OK=0;this.R_OK=4;this.W_OK=2;this.X_OK=1;this.root=null;this.fdMap={};this.nextFd=100};FS.prototype.initialize=function initialize3(rootFS){if(!rootFS.constructor.isAvailable()){throw new ApiError(ErrorCode.EINVAL,"Tried to instantiate BrowserFS with an unavailable file system.")}return this.root=rootFS};FS.prototype._toUnixTimestamp=function _toUnixTimestamp(time){if(typeof time==="number"){return time}else if(time instanceof Date){return time.getTime()/1e3}throw new Error("Cannot parse time: "+time)};FS.prototype.getRootFS=function getRootFS(){if(this.root){return this.root}else{return null}};FS.prototype.rename=function rename(oldPath,newPath,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{assertRoot(this.root).rename(normalizePath(oldPath),normalizePath(newPath),newCb)}catch(e){newCb(e)}};FS.prototype.renameSync=function renameSync(oldPath,newPath){assertRoot(this.root).renameSync(normalizePath(oldPath),normalizePath(newPath))};FS.prototype.exists=function exists2(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{return assertRoot(this.root).exists(normalizePath(path$$1),newCb)}catch(e){return newCb(false)}};FS.prototype.existsSync=function existsSync(path$$1){try{return assertRoot(this.root).existsSync(normalizePath(path$$1))}catch(e){return false}};FS.prototype.stat=function stat(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,2);try{return assertRoot(this.root).stat(normalizePath(path$$1),false,newCb)}catch(e){return newCb(e)}};FS.prototype.statSync=function statSync(path$$1){return assertRoot(this.root).statSync(normalizePath(path$$1),false)};FS.prototype.lstat=function lstat(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,2);try{return assertRoot(this.root).stat(normalizePath(path$$1),true,newCb)}catch(e){return newCb(e)}};FS.prototype.lstatSync=function lstatSync(path$$1){return assertRoot(this.root).statSync(normalizePath(path$$1),true)};FS.prototype.truncate=function truncate(path$$1,arg2,cb){if(arg2===void 0)arg2=0;if(cb===void 0)cb=nopCb;var len=0;if(typeof arg2==="function"){cb=arg2}else if(typeof arg2==="number"){len=arg2}var newCb=wrapCb(cb,1);try{if(len<0){throw new ApiError(ErrorCode.EINVAL)}return assertRoot(this.root).truncate(normalizePath(path$$1),len,newCb)}catch(e){return newCb(e)}};FS.prototype.truncateSync=function truncateSync(path$$1,len){if(len===void 0)len=0;if(len<0){throw new ApiError(ErrorCode.EINVAL)}return assertRoot(this.root).truncateSync(normalizePath(path$$1),len)};FS.prototype.unlink=function unlink(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{return assertRoot(this.root).unlink(normalizePath(path$$1),newCb)}catch(e){return newCb(e)}};FS.prototype.unlinkSync=function unlinkSync(path$$1){return assertRoot(this.root).unlinkSync(normalizePath(path$$1))};FS.prototype.open=function open(path$$1,flag,arg2,cb){var this$1=this;if(cb===void 0)cb=nopCb;var mode=normalizeMode(arg2,420);cb=typeof arg2==="function"?arg2:cb;var newCb=wrapCb(cb,2);try{assertRoot(this.root).open(normalizePath(path$$1),FileFlag.getFileFlag(flag),mode,function(e,file){if(file){newCb(e,this$1.getFdForFile(file))}else{newCb(e)}})}catch(e){newCb(e)}};FS.prototype.openSync=function openSync(path$$1,flag,mode){if(mode===void 0)mode=420;return this.getFdForFile(assertRoot(this.root).openSync(normalizePath(path$$1),FileFlag.getFileFlag(flag),normalizeMode(mode,420)))};FS.prototype.readFile=function readFile2(filename,arg2,cb){if(arg2===void 0)arg2={};if(cb===void 0)cb=nopCb;var options=normalizeOptions(arg2,null,"r",null);cb=typeof arg2==="function"?arg2:cb;var newCb=wrapCb(cb,2);try{var flag=FileFlag.getFileFlag(options["flag"]);if(!flag.isReadable()){return newCb(new ApiError(ErrorCode.EINVAL,"Flag passed to readFile must allow for reading."))}return assertRoot(this.root).readFile(normalizePath(filename),options.encoding,flag,newCb)}catch(e){return newCb(e)}};FS.prototype.readFileSync=function readFileSync(filename,arg2){if(arg2===void 0)arg2={};var options=normalizeOptions(arg2,null,"r",null);var flag=FileFlag.getFileFlag(options.flag);if(!flag.isReadable()){throw new ApiError(ErrorCode.EINVAL,"Flag passed to readFile must allow for reading.")}return assertRoot(this.root).readFileSync(normalizePath(filename),options.encoding,flag)};FS.prototype.writeFile=function writeFile2(filename,data,arg3,cb){if(arg3===void 0)arg3={};if(cb===void 0)cb=nopCb;var options=normalizeOptions(arg3,"utf8","w",420);cb=typeof arg3==="function"?arg3:cb;var newCb=wrapCb(cb,1);try{var flag=FileFlag.getFileFlag(options.flag);if(!flag.isWriteable()){return newCb(new ApiError(ErrorCode.EINVAL,"Flag passed to writeFile must allow for writing."))}return assertRoot(this.root).writeFile(normalizePath(filename),data,options.encoding,flag,options.mode,newCb)}catch(e){return newCb(e)}};FS.prototype.writeFileSync=function writeFileSync(filename,data,arg3){var options=normalizeOptions(arg3,"utf8","w",420);var flag=FileFlag.getFileFlag(options.flag);if(!flag.isWriteable()){throw new ApiError(ErrorCode.EINVAL,"Flag passed to writeFile must allow for writing.")}return assertRoot(this.root).writeFileSync(normalizePath(filename),data,options.encoding,flag,options.mode)};FS.prototype.appendFile=function appendFile3(filename,data,arg3,cb){if(cb===void 0)cb=nopCb;var options=normalizeOptions(arg3,"utf8","a",420);cb=typeof arg3==="function"?arg3:cb;var newCb=wrapCb(cb,1);try{var flag=FileFlag.getFileFlag(options.flag);if(!flag.isAppendable()){return newCb(new ApiError(ErrorCode.EINVAL,"Flag passed to appendFile must allow for appending."))}assertRoot(this.root).appendFile(normalizePath(filename),data,options.encoding,flag,options.mode,newCb)}catch(e){newCb(e)}};FS.prototype.appendFileSync=function appendFileSync(filename,data,arg3){var options=normalizeOptions(arg3,"utf8","a",420);var flag=FileFlag.getFileFlag(options.flag);if(!flag.isAppendable()){throw new ApiError(ErrorCode.EINVAL,"Flag passed to appendFile must allow for appending.")}return assertRoot(this.root).appendFileSync(normalizePath(filename),data,options.encoding,flag,options.mode)};FS.prototype.fstat=function fstat(fd,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,2);try{var file=this.fd2file(fd);file.stat(newCb)}catch(e){newCb(e)}};FS.prototype.fstatSync=function fstatSync(fd){return this.fd2file(fd).statSync()};FS.prototype.close=function close(fd,cb){var this$1=this;if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{this.fd2file(fd).close(function(e){if(!e){this$1.closeFd(fd)}newCb(e)})}catch(e){newCb(e)}};FS.prototype.closeSync=function closeSync(fd){this.fd2file(fd).closeSync();this.closeFd(fd)};FS.prototype.ftruncate=function ftruncate(fd,arg2,cb){if(cb===void 0)cb=nopCb;var length=typeof arg2==="number"?arg2:0;cb=typeof arg2==="function"?arg2:cb;var newCb=wrapCb(cb,1);try{var file=this.fd2file(fd);if(length<0){throw new ApiError(ErrorCode.EINVAL)}file.truncate(length,newCb)}catch(e){newCb(e)}};FS.prototype.ftruncateSync=function ftruncateSync(fd,len){if(len===void 0)len=0;var file=this.fd2file(fd);if(len<0){throw new ApiError(ErrorCode.EINVAL)}file.truncateSync(len)};FS.prototype.fsync=function fsync(fd,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{this.fd2file(fd).sync(newCb)}catch(e){newCb(e)}};FS.prototype.fsyncSync=function fsyncSync(fd){this.fd2file(fd).syncSync()};FS.prototype.fdatasync=function fdatasync(fd,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{this.fd2file(fd).datasync(newCb)}catch(e){newCb(e)}};FS.prototype.fdatasyncSync=function fdatasyncSync(fd){this.fd2file(fd).datasyncSync()};FS.prototype.write=function write(fd,arg2,arg3,arg4,arg5,cb){if(cb===void 0)cb=nopCb;var buffer$$1,offset,length,position=null;if(typeof arg2==="string"){var encoding="utf8";switch(typeof arg3){case"function":cb=arg3;break;case"number":position=arg3;encoding=typeof arg4==="string"?arg4:"utf8";cb=typeof arg5==="function"?arg5:cb;break;default:cb=typeof arg4==="function"?arg4:typeof arg5==="function"?arg5:cb;return cb(new ApiError(ErrorCode.EINVAL,"Invalid arguments."))}buffer$$1=Buffer2.from(arg2,encoding);offset=0;length=buffer$$1.length}else{buffer$$1=arg2;offset=arg3;length=arg4;position=typeof arg5==="number"?arg5:null;cb=typeof arg5==="function"?arg5:cb}var newCb=wrapCb(cb,3);try{var file=this.fd2file(fd);if(position===void 0||position===null){position=file.getPos()}file.write(buffer$$1,offset,length,position,newCb)}catch(e){newCb(e)}};FS.prototype.writeSync=function writeSync(fd,arg2,arg3,arg4,arg5){var buffer$$1,offset=0,length,position;if(typeof arg2==="string"){position=typeof arg3==="number"?arg3:null;var encoding=typeof arg4==="string"?arg4:"utf8";offset=0;buffer$$1=Buffer2.from(arg2,encoding);length=buffer$$1.length}else{buffer$$1=arg2;offset=arg3;length=arg4;position=typeof arg5==="number"?arg5:null}var file=this.fd2file(fd);if(position===void 0||position===null){position=file.getPos()}return file.writeSync(buffer$$1,offset,length,position)};FS.prototype.read=function read(fd,arg2,arg3,arg4,arg5,cb){if(cb===void 0)cb=nopCb;var position,offset,length,buffer$$1,newCb;if(typeof arg2==="number"){length=arg2;position=arg3;var encoding=arg4;cb=typeof arg5==="function"?arg5:cb;offset=0;buffer$$1=Buffer2.alloc(length);newCb=wrapCb(function(err,bytesRead,buf){if(err){return cb(err)}cb(err,buf.toString(encoding),bytesRead)},3)}else{buffer$$1=arg2;offset=arg3;length=arg4;position=arg5;newCb=wrapCb(cb,3)}try{var file=this.fd2file(fd);if(position===void 0||position===null){position=file.getPos()}file.read(buffer$$1,offset,length,position,newCb)}catch(e){newCb(e)}};FS.prototype.readSync=function readSync(fd,arg2,arg3,arg4,arg5){var shenanigans=false;var buffer$$1,offset,length,position,encoding="utf8";if(typeof arg2==="number"){length=arg2;position=arg3;encoding=arg4;offset=0;buffer$$1=Buffer2.alloc(length);shenanigans=true}else{buffer$$1=arg2;offset=arg3;length=arg4;position=arg5}var file=this.fd2file(fd);if(position===void 0||position===null){position=file.getPos()}var rv=file.readSync(buffer$$1,offset,length,position);if(!shenanigans){return rv}else{return[buffer$$1.toString(encoding),rv]}};FS.prototype.fchown=function fchown(fd,uid,gid,callback){if(callback===void 0)callback=nopCb;var newCb=wrapCb(callback,1);try{this.fd2file(fd).chown(uid,gid,newCb)}catch(e){newCb(e)}};FS.prototype.fchownSync=function fchownSync(fd,uid,gid){this.fd2file(fd).chownSync(uid,gid)};FS.prototype.fchmod=function fchmod(fd,mode,cb){var newCb=wrapCb(cb,1);try{var numMode=typeof mode==="string"?parseInt(mode,8):mode;this.fd2file(fd).chmod(numMode,newCb)}catch(e){newCb(e)}};FS.prototype.fchmodSync=function fchmodSync(fd,mode){var numMode=typeof mode==="string"?parseInt(mode,8):mode;this.fd2file(fd).chmodSync(numMode)};FS.prototype.futimes=function futimes(fd,atime,mtime,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{var file=this.fd2file(fd);if(typeof atime==="number"){atime=new Date(atime*1e3)}if(typeof mtime==="number"){mtime=new Date(mtime*1e3)}file.utimes(atime,mtime,newCb)}catch(e){newCb(e)}};FS.prototype.futimesSync=function futimesSync(fd,atime,mtime){this.fd2file(fd).utimesSync(normalizeTime(atime),normalizeTime(mtime))};FS.prototype.rmdir=function rmdir(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{path$$1=normalizePath(path$$1);assertRoot(this.root).rmdir(path$$1,newCb)}catch(e){newCb(e)}};FS.prototype.rmdirSync=function rmdirSync(path$$1){path$$1=normalizePath(path$$1);return assertRoot(this.root).rmdirSync(path$$1)};FS.prototype.mkdir=function mkdir(path$$1,mode,cb){if(cb===void 0)cb=nopCb;if(typeof mode==="function"){cb=mode;mode=511}var newCb=wrapCb(cb,1);try{path$$1=normalizePath(path$$1);assertRoot(this.root).mkdir(path$$1,mode,newCb)}catch(e){newCb(e)}};FS.prototype.mkdirSync=function mkdirSync(path$$1,mode){assertRoot(this.root).mkdirSync(normalizePath(path$$1),normalizeMode(mode,511))};FS.prototype.readdir=function readdir(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,2);try{path$$1=normalizePath(path$$1);assertRoot(this.root).readdir(path$$1,newCb)}catch(e){newCb(e)}};FS.prototype.readdirSync=function readdirSync(path$$1){path$$1=normalizePath(path$$1);return assertRoot(this.root).readdirSync(path$$1)};FS.prototype.link=function link(srcpath,dstpath,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{srcpath=normalizePath(srcpath);dstpath=normalizePath(dstpath);assertRoot(this.root).link(srcpath,dstpath,newCb)}catch(e){newCb(e)}};FS.prototype.linkSync=function linkSync(srcpath,dstpath){srcpath=normalizePath(srcpath);dstpath=normalizePath(dstpath);return assertRoot(this.root).linkSync(srcpath,dstpath)};FS.prototype.symlink=function symlink(srcpath,dstpath,arg3,cb){if(cb===void 0)cb=nopCb;var type=typeof arg3==="string"?arg3:"file";cb=typeof arg3==="function"?arg3:cb;var newCb=wrapCb(cb,1);try{if(type!=="file"&&type!=="dir"){return newCb(new ApiError(ErrorCode.EINVAL,"Invalid type: "+type))}srcpath=normalizePath(srcpath);dstpath=normalizePath(dstpath);assertRoot(this.root).symlink(srcpath,dstpath,type,newCb)}catch(e){newCb(e)}};FS.prototype.symlinkSync=function symlinkSync(srcpath,dstpath,type){if(!type){type="file"}else if(type!=="file"&&type!=="dir"){throw new ApiError(ErrorCode.EINVAL,"Invalid type: "+type)}srcpath=normalizePath(srcpath);dstpath=normalizePath(dstpath);return assertRoot(this.root).symlinkSync(srcpath,dstpath,type)};FS.prototype.readlink=function readlink(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,2);try{path$$1=normalizePath(path$$1);assertRoot(this.root).readlink(path$$1,newCb)}catch(e){newCb(e)}};FS.prototype.readlinkSync=function readlinkSync(path$$1){path$$1=normalizePath(path$$1);return assertRoot(this.root).readlinkSync(path$$1)};FS.prototype.chown=function chown(path$$1,uid,gid,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{path$$1=normalizePath(path$$1);assertRoot(this.root).chown(path$$1,false,uid,gid,newCb)}catch(e){newCb(e)}};FS.prototype.chownSync=function chownSync(path$$1,uid,gid){path$$1=normalizePath(path$$1);assertRoot(this.root).chownSync(path$$1,false,uid,gid)};FS.prototype.lchown=function lchown(path$$1,uid,gid,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{path$$1=normalizePath(path$$1);assertRoot(this.root).chown(path$$1,true,uid,gid,newCb)}catch(e){newCb(e)}};FS.prototype.lchownSync=function lchownSync(path$$1,uid,gid){path$$1=normalizePath(path$$1);assertRoot(this.root).chownSync(path$$1,true,uid,gid)};FS.prototype.chmod=function chmod(path$$1,mode,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{var numMode=normalizeMode(mode,-1);if(numMode<0){throw new ApiError(ErrorCode.EINVAL,"Invalid mode.")}assertRoot(this.root).chmod(normalizePath(path$$1),false,numMode,newCb)}catch(e){newCb(e)}};FS.prototype.chmodSync=function chmodSync(path$$1,mode){var numMode=normalizeMode(mode,-1);if(numMode<0){throw new ApiError(ErrorCode.EINVAL,"Invalid mode.")}path$$1=normalizePath(path$$1);assertRoot(this.root).chmodSync(path$$1,false,numMode)};FS.prototype.lchmod=function lchmod(path$$1,mode,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{var numMode=normalizeMode(mode,-1);if(numMode<0){throw new ApiError(ErrorCode.EINVAL,"Invalid mode.")}assertRoot(this.root).chmod(normalizePath(path$$1),true,numMode,newCb)}catch(e){newCb(e)}};FS.prototype.lchmodSync=function lchmodSync(path$$1,mode){var numMode=normalizeMode(mode,-1);if(numMode<1){throw new ApiError(ErrorCode.EINVAL,"Invalid mode.")}assertRoot(this.root).chmodSync(normalizePath(path$$1),true,numMode)};FS.prototype.utimes=function utimes(path$$1,atime,mtime,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{assertRoot(this.root).utimes(normalizePath(path$$1),normalizeTime(atime),normalizeTime(mtime),newCb)}catch(e){newCb(e)}};FS.prototype.utimesSync=function utimesSync(path$$1,atime,mtime){assertRoot(this.root).utimesSync(normalizePath(path$$1),normalizeTime(atime),normalizeTime(mtime))};FS.prototype.realpath=function realpath(path$$1,arg2,cb){if(cb===void 0)cb=nopCb;var cache=typeof arg2==="object"?arg2:{};cb=typeof arg2==="function"?arg2:nopCb;var newCb=wrapCb(cb,2);try{path$$1=normalizePath(path$$1);assertRoot(this.root).realpath(path$$1,cache,newCb)}catch(e){newCb(e)}};FS.prototype.realpathSync=function realpathSync(path$$1,cache){if(cache===void 0)cache={};path$$1=normalizePath(path$$1);return assertRoot(this.root).realpathSync(path$$1,cache)};FS.prototype.watchFile=function watchFile(filename,arg2,listener){if(listener===void 0)listener=nopCb;throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.unwatchFile=function unwatchFile(filename,listener){if(listener===void 0)listener=nopCb;throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.watch=function watch(filename,arg2,listener){if(listener===void 0)listener=nopCb;throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.access=function access(path$$1,arg2,cb){if(cb===void 0)cb=nopCb;throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.accessSync=function accessSync(path$$1,mode){throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.createReadStream=function createReadStream(path$$1,options){throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.createWriteStream=function createWriteStream(path$$1,options){throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.wrapCallbacks=function wrapCallbacks(cbWrapper){wrapCb=cbWrapper};FS.prototype.getFdForFile=function getFdForFile(file){var fd=this.nextFd++;this.fdMap[fd]=file;return fd};FS.prototype.fd2file=function fd2file(fd){var rv=this.fdMap[fd];if(rv){return rv}else{throw new ApiError(ErrorCode.EBADF,"Invalid file descriptor.")}};FS.prototype.closeFd=function closeFd(fd){delete this.fdMap[fd]};FS.Stats=Stats;var fs3=new FS;var _fsMock={};var fsProto=FS.prototype;Object.keys(fsProto).forEach(function(key){if(typeof fs3[key]==="function"){_fsMock[key]=function(){return fs3[key].apply(fs3,arguments)}}else{_fsMock[key]=fs3[key]}});_fsMock["changeFSModule"]=function(newFs){fs3=newFs};_fsMock["getFSModule"]=function(){return fs3};_fsMock["FS"]=FS;function _min(d0,d1,d2,bx,ay){return d0<d1||d2<d1?d0>d2?d2+1:d0+1:bx===ay?d1:d1+1}function levenshtein(a,b){if(a===b){return 0}if(a.length>b.length){var tmp=a;a=b;b=tmp}var la=a.length;var lb=b.length;while(la>0&&a.charCodeAt(la-1)===b.charCodeAt(lb-1)){la--;lb--}var offset=0;while(offset<la&&a.charCodeAt(offset)===b.charCodeAt(offset)){offset++}la-=offset;lb-=offset;if(la===0||lb===1){return lb}var vector=new Array(la<<1);for(var y4=0;y4<la;){vector[la+y4]=a.charCodeAt(offset+y4);vector[y4]=++y4}var x3;var d0;var d1;var d2;var d3;for(x3=0;x3+3<lb;){var bx0=b.charCodeAt(offset+(d0=x3));var bx1=b.charCodeAt(offset+(d1=x3+1));var bx2=b.charCodeAt(offset+(d2=x3+2));var bx3=b.charCodeAt(offset+(d3=x3+3));var dd$1=x3+=4;for(var y$1=0;y$1<la;){var ay=vector[la+y$1];var dy=vector[y$1];d0=_min(dy,d0,d1,bx0,ay);d1=_min(d0,d1,d2,bx1,ay);d2=_min(d1,d2,d3,bx2,ay);dd$1=_min(d2,d3,dd$1,bx3,ay);vector[y$1++]=dd$1;d3=d2;d2=d1;d1=d0;d0=dy}}var dd=0;for(;x3<lb;){var bx0$1=b.charCodeAt(offset+(d0=x3));dd=++x3;for(var y$2=0;y$2<la;y$2++){var dy$1=vector[y$2];vector[y$2]=dd=dy$1<d0||dd<d0?dy$1>dd?dd+1:dy$1+1:bx0$1===vector[la+y$2]?d0:d0+1;d0=dy$1}}return dd}function deprecationMessage(print,fsName,opts){if(print){console.warn("["+fsName+"] Direct file system constructor usage is deprecated for this file system, and will be removed in the next major version. Please use the \'"+fsName+".Create("+JSON.stringify(opts)+", callback)\' method instead. See https://github.com/jvilk/BrowserFS/issues/176 for more details.")}}var isIE=typeof navigator!=="undefined"&&!!(/(msie) ([\\w.]+)/.exec(navigator.userAgent.toLowerCase())||navigator.userAgent.indexOf("Trident")!==-1);var isWebWorker=typeof window==="undefined";function fail(){throw new Error("BFS has reached an impossible code path; please file a bug.")}function mkdirpSync(p2,mode,fs4){if(!fs4.existsSync(p2)){mkdirpSync(path.dirname(p2),mode,fs4);fs4.mkdirSync(p2,mode)}}function buffer2ArrayBuffer(buff){var u8=buffer2Uint8array(buff),u8offset=u8.byteOffset,u8Len=u8.byteLength;if(u8offset===0&&u8Len===u8.buffer.byteLength){return u8.buffer}else{return u8.buffer.slice(u8offset,u8offset+u8Len)}}function buffer2Uint8array(buff){if(buff instanceof Uint8Array){return buff}else{return new Uint8Array(buff)}}function arrayish2Buffer(arr){if(arr instanceof Buffer2){return arr}else if(arr instanceof Uint8Array){return uint8Array2Buffer(arr)}else{return Buffer2.from(arr)}}function uint8Array2Buffer(u8){if(u8 instanceof Buffer2){return u8}else if(u8.byteOffset===0&&u8.byteLength===u8.buffer.byteLength){return arrayBuffer2Buffer(u8.buffer)}else{return Buffer2.from(u8.buffer,u8.byteOffset,u8.byteLength)}}function arrayBuffer2Buffer(ab){return Buffer2.from(ab)}function copyingSlice(buff,start,end){if(start===void 0)start=0;if(end===void 0)end=buff.length;if(start<0||end<0||end>buff.length||start>end){throw new TypeError("Invalid slice bounds on buffer of length "+buff.length+": ["+start+", "+end+"]")}if(buff.length===0){return emptyBuffer()}else{var u8=buffer2Uint8array(buff),s0=buff[0],newS0=(s0+1)%255;buff[0]=newS0;if(u8[0]===newS0){u8[0]=s0;return uint8Array2Buffer(u8.slice(start,end))}else{buff[0]=s0;return uint8Array2Buffer(u8.subarray(start,end))}}}var emptyBuff=null;function emptyBuffer(){if(emptyBuff){return emptyBuff}return emptyBuff=Buffer2.alloc(0)}function bufferValidator(v2,cb){if(Buffer2.isBuffer(v2)){cb()}else{cb(new ApiError(ErrorCode.EINVAL,"option must be a Buffer."))}}function checkOptions(fsType,opts,cb){var optsInfo=fsType.Options;var fsName=fsType.Name;var pendingValidators=0;var callbackCalled=false;var loopEnded=false;function validatorCallback(e){if(!callbackCalled){if(e){callbackCalled=true;cb(e)}pendingValidators--;if(pendingValidators===0&&loopEnded){cb()}}}var loop3=function(optName2){if(optsInfo.hasOwnProperty(optName2)){var opt=optsInfo[optName2];var providedValue=opts[optName2];if(providedValue===void 0||providedValue===null){if(!opt.optional){var incorrectOptions=Object.keys(opts).filter(function(o){return!(o in optsInfo)}).map(function(a){return{str:a,distance:levenshtein(optName2,a)}}).filter(function(o){return o.distance<5}).sort(function(a,b){return a.distance-b.distance});if(callbackCalled){return{}}callbackCalled=true;return{v:cb(new ApiError(ErrorCode.EINVAL,"["+fsName+"] Required option \'"+optName2+"\' not provided."+(incorrectOptions.length>0?" You provided unrecognized option \'"+incorrectOptions[0].str+"\'; perhaps you meant to type \'"+optName2+"\'.":"")+"\\nOption description: "+opt.description))}}}else{var typeMatches=false;if(Array.isArray(opt.type)){typeMatches=opt.type.indexOf(typeof providedValue)!==-1}else{typeMatches=typeof providedValue===opt.type}if(!typeMatches){if(callbackCalled){return{}}callbackCalled=true;return{v:cb(new ApiError(ErrorCode.EINVAL,"["+fsName+"] Value provided for option "+optName2+" is not the proper type. Expected "+(Array.isArray(opt.type)?"one of {"+opt.type.join(", ")+"}":opt.type)+", but received "+typeof providedValue+"\\nOption description: "+opt.description))}}else if(opt.validator){pendingValidators++;opt.validator(providedValue,validatorCallback)}}}};for(var optName in optsInfo){var returned=loop3(optName);if(returned)return returned.v}loopEnded=true;if(pendingValidators===0&&!callbackCalled){cb()}}var BFSUtils=Object.freeze({deprecationMessage,isIE,isWebWorker,fail,mkdirpSync,buffer2ArrayBuffer,buffer2Uint8array,arrayish2Buffer,uint8Array2Buffer,arrayBuffer2Buffer,copyingSlice,emptyBuffer,bufferValidator,checkOptions});var BFSEmscriptenStreamOps=function BFSEmscriptenStreamOps2(fs4){this.fs=fs4;this.nodefs=fs4.getNodeFS();this.FS=fs4.getFS();this.PATH=fs4.getPATH();this.ERRNO_CODES=fs4.getERRNO_CODES()};BFSEmscriptenStreamOps.prototype.open=function open(stream){var path$$1=this.fs.realPath(stream.node);var FS2=this.FS;try{if(FS2.isFile(stream.node.mode)){stream.nfd=this.nodefs.openSync(path$$1,this.fs.flagsToPermissionString(stream.flags))}}catch(e){if(!e.code){throw e}throw new FS2.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenStreamOps.prototype.close=function close(stream){var FS2=this.FS;try{if(FS2.isFile(stream.node.mode)&&stream.nfd){this.nodefs.closeSync(stream.nfd)}}catch(e){if(!e.code){throw e}throw new FS2.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenStreamOps.prototype.read=function read(stream,buffer$$1,offset,length,position){try{return this.nodefs.readSync(stream.nfd,uint8Array2Buffer(buffer$$1),offset,length,position)}catch(e){throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenStreamOps.prototype.write=function write(stream,buffer$$1,offset,length,position){try{return this.nodefs.writeSync(stream.nfd,uint8Array2Buffer(buffer$$1),offset,length,position)}catch(e){throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenStreamOps.prototype.llseek=function llseek(stream,offset,whence){var position=offset;if(whence===1){position+=stream.position}else if(whence===2){if(this.FS.isFile(stream.node.mode)){try{var stat=this.nodefs.fstatSync(stream.nfd);position+=stat.size}catch(e){throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}}}if(position<0){throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL)}stream.position=position;return position};var BFSEmscriptenNodeOps=function BFSEmscriptenNodeOps2(fs4){this.fs=fs4;this.nodefs=fs4.getNodeFS();this.FS=fs4.getFS();this.PATH=fs4.getPATH();this.ERRNO_CODES=fs4.getERRNO_CODES()};BFSEmscriptenNodeOps.prototype.getattr=function getattr(node){var path$$1=this.fs.realPath(node);var stat;try{stat=this.nodefs.lstatSync(path$$1)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}return{dev:stat.dev,ino:stat.ino,mode:stat.mode,nlink:stat.nlink,uid:stat.uid,gid:stat.gid,rdev:stat.rdev,size:stat.size,atime:stat.atime,mtime:stat.mtime,ctime:stat.ctime,blksize:stat.blksize,blocks:stat.blocks}};BFSEmscriptenNodeOps.prototype.setattr=function setattr(node,attr){var path$$1=this.fs.realPath(node);try{if(attr.mode!==void 0){this.nodefs.chmodSync(path$$1,attr.mode);node.mode=attr.mode}if(attr.timestamp!==void 0){var date=new Date(attr.timestamp);this.nodefs.utimesSync(path$$1,date,date)}}catch(e){if(!e.code){throw e}if(e.code!=="ENOTSUP"){throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}}if(attr.size!==void 0){try{this.nodefs.truncateSync(path$$1,attr.size)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}}};BFSEmscriptenNodeOps.prototype.lookup=function lookup(parent,name2){var path$$1=this.PATH.join2(this.fs.realPath(parent),name2);var mode=this.fs.getMode(path$$1);return this.fs.createNode(parent,name2,mode)};BFSEmscriptenNodeOps.prototype.mknod=function mknod(parent,name2,mode,dev){var node=this.fs.createNode(parent,name2,mode,dev);var path$$1=this.fs.realPath(node);try{if(this.FS.isDir(node.mode)){this.nodefs.mkdirSync(path$$1,node.mode)}else{this.nodefs.writeFileSync(path$$1,"",{mode:node.mode})}}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}return node};BFSEmscriptenNodeOps.prototype.rename=function rename(oldNode,newDir,newName){var oldPath=this.fs.realPath(oldNode);var newPath=this.PATH.join2(this.fs.realPath(newDir),newName);try{this.nodefs.renameSync(oldPath,newPath);oldNode.name=newName;oldNode.parent=newDir}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenNodeOps.prototype.unlink=function unlink(parent,name2){var path$$1=this.PATH.join2(this.fs.realPath(parent),name2);try{this.nodefs.unlinkSync(path$$1)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenNodeOps.prototype.rmdir=function rmdir(parent,name2){var path$$1=this.PATH.join2(this.fs.realPath(parent),name2);try{this.nodefs.rmdirSync(path$$1)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenNodeOps.prototype.readdir=function readdir(node){var path$$1=this.fs.realPath(node);try{var contents=this.nodefs.readdirSync(path$$1);contents.push(".","..");return contents}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenNodeOps.prototype.symlink=function symlink(parent,newName,oldPath){var newPath=this.PATH.join2(this.fs.realPath(parent),newName);try{this.nodefs.symlinkSync(oldPath,newPath)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenNodeOps.prototype.readlink=function readlink(node){var path$$1=this.fs.realPath(node);try{return this.nodefs.readlinkSync(path$$1)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};var BFSEmscriptenFS=function BFSEmscriptenFS2(_FS,_PATH,_ERRNO_CODES,nodefs){if(_FS===void 0)_FS=self["FS"];if(_PATH===void 0)_PATH=self["PATH"];if(_ERRNO_CODES===void 0)_ERRNO_CODES=self["ERRNO_CODES"];if(nodefs===void 0)nodefs=_fsMock;this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"};this.nodefs=nodefs;this.FS=_FS;this.PATH=_PATH;this.ERRNO_CODES=_ERRNO_CODES;this.node_ops=new BFSEmscriptenNodeOps(this);this.stream_ops=new BFSEmscriptenStreamOps(this)};BFSEmscriptenFS.prototype.mount=function mount(m){return this.createNode(null,"/",this.getMode(m.opts.root),0)};BFSEmscriptenFS.prototype.createNode=function createNode(parent,name2,mode,dev){var FS2=this.FS;if(!FS2.isDir(mode)&&!FS2.isFile(mode)&&!FS2.isLink(mode)){throw new FS2.ErrnoError(this.ERRNO_CODES.EINVAL)}var node=FS2.createNode(parent,name2,mode);node.node_ops=this.node_ops;node.stream_ops=this.stream_ops;return node};BFSEmscriptenFS.prototype.getMode=function getMode(path$$1){var stat;try{stat=this.nodefs.lstatSync(path$$1)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}return stat.mode};BFSEmscriptenFS.prototype.realPath=function realPath(node){var parts=[];while(node.parent!==node){parts.push(node.name);node=node.parent}parts.push(node.mount.opts.root);parts.reverse();return this.PATH.join.apply(null,parts)};BFSEmscriptenFS.prototype.flagsToPermissionString=function flagsToPermissionString(flags){var parsedFlags=typeof flags==="string"?parseInt(flags,10):flags;parsedFlags&=8191;if(parsedFlags in this.flagsToPermissionStringMap){return this.flagsToPermissionStringMap[parsedFlags]}else{return flags}};BFSEmscriptenFS.prototype.getNodeFS=function getNodeFS(){return this.nodefs};BFSEmscriptenFS.prototype.getFS=function getFS(){return this.FS};BFSEmscriptenFS.prototype.getPATH=function getPATH(){return this.PATH};BFSEmscriptenFS.prototype.getERRNO_CODES=function getERRNO_CODES(){return this.ERRNO_CODES};var BaseFileSystem=function BaseFileSystem2(){};BaseFileSystem.prototype.supportsLinks=function supportsLinks(){return false};BaseFileSystem.prototype.diskSpace=function diskSpace(p2,cb){cb(0,0)};BaseFileSystem.prototype.openFile=function openFile(p2,flag,cb){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.createFile=function createFile(p2,flag,mode,cb){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.open=function open(p2,flag,mode,cb){var this$1=this;var mustBeFile=function(e,stats){if(e){switch(flag.pathNotExistsAction()){case ActionType.CREATE_FILE:return this$1.stat(path.dirname(p2),false,function(e2,parentStats){if(e2){cb(e2)}else if(parentStats&&!parentStats.isDirectory()){cb(ApiError.ENOTDIR(path.dirname(p2)))}else{this$1.createFile(p2,flag,mode,cb)}});case ActionType.THROW_EXCEPTION:return cb(ApiError.ENOENT(p2));default:return cb(new ApiError(ErrorCode.EINVAL,"Invalid FileFlag object."))}}else{if(stats&&stats.isDirectory()){return cb(ApiError.EISDIR(p2))}switch(flag.pathExistsAction()){case ActionType.THROW_EXCEPTION:return cb(ApiError.EEXIST(p2));case ActionType.TRUNCATE_FILE:return this$1.openFile(p2,flag,function(e2,fd){if(e2){cb(e2)}else if(fd){fd.truncate(0,function(){fd.sync(function(){cb(null,fd)})})}else{fail()}});case ActionType.NOP:return this$1.openFile(p2,flag,cb);default:return cb(new ApiError(ErrorCode.EINVAL,"Invalid FileFlag object."))}}};this.stat(p2,false,mustBeFile)};BaseFileSystem.prototype.rename=function rename(oldPath,newPath,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.renameSync=function renameSync(oldPath,newPath){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.stat=function stat(p2,isLstat,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.statSync=function statSync(p2,isLstat){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.openFileSync=function openFileSync(p2,flag,mode){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.createFileSync=function createFileSync(p2,flag,mode){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.openSync=function openSync(p2,flag,mode){var stats;try{stats=this.statSync(p2,false)}catch(e){switch(flag.pathNotExistsAction()){case ActionType.CREATE_FILE:var parentStats=this.statSync(path.dirname(p2),false);if(!parentStats.isDirectory()){throw ApiError.ENOTDIR(path.dirname(p2))}return this.createFileSync(p2,flag,mode);case ActionType.THROW_EXCEPTION:throw ApiError.ENOENT(p2);default:throw new ApiError(ErrorCode.EINVAL,"Invalid FileFlag object.")}}if(stats.isDirectory()){throw ApiError.EISDIR(p2)}switch(flag.pathExistsAction()){case ActionType.THROW_EXCEPTION:throw ApiError.EEXIST(p2);case ActionType.TRUNCATE_FILE:this.unlinkSync(p2);return this.createFileSync(p2,flag,stats.mode);case ActionType.NOP:return this.openFileSync(p2,flag,mode);default:throw new ApiError(ErrorCode.EINVAL,"Invalid FileFlag object.")}};BaseFileSystem.prototype.unlink=function unlink(p2,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.unlinkSync=function unlinkSync(p2){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.rmdir=function rmdir(p2,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.rmdirSync=function rmdirSync(p2){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.mkdir=function mkdir(p2,mode,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.mkdirSync=function mkdirSync(p2,mode){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.readdir=function readdir(p2,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.readdirSync=function readdirSync(p2){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.exists=function exists2(p2,cb){this.stat(p2,null,function(err){cb(!err)})};BaseFileSystem.prototype.existsSync=function existsSync(p2){try{this.statSync(p2,true);return true}catch(e){return false}};BaseFileSystem.prototype.realpath=function realpath(p2,cache,cb){if(this.supportsLinks()){var splitPath=p2.split(path.sep);for(var i22=0;i22<splitPath.length;i22++){var addPaths=splitPath.slice(0,i22+1);splitPath[i22]=path.join.apply(null,addPaths)}}else{this.exists(p2,function(doesExist){if(doesExist){cb(null,p2)}else{cb(ApiError.ENOENT(p2))}})}};BaseFileSystem.prototype.realpathSync=function realpathSync(p2,cache){if(this.supportsLinks()){var splitPath=p2.split(path.sep);for(var i22=0;i22<splitPath.length;i22++){var addPaths=splitPath.slice(0,i22+1);splitPath[i22]=path.join.apply(path,addPaths)}return splitPath.join(path.sep)}else{if(this.existsSync(p2)){return p2}else{throw ApiError.ENOENT(p2)}}};BaseFileSystem.prototype.truncate=function truncate(p2,len,cb){this.open(p2,FileFlag.getFileFlag("r+"),420,function(er,fd){if(er){return cb(er)}fd.truncate(len,function(er2){fd.close(function(er22){cb(er2||er22)})})})};BaseFileSystem.prototype.truncateSync=function truncateSync(p2,len){var fd=this.openSync(p2,FileFlag.getFileFlag("r+"),420);try{fd.truncateSync(len)}catch(e){throw e}finally{fd.closeSync()}};BaseFileSystem.prototype.readFile=function readFile2(fname,encoding,flag,cb){var oldCb=cb;this.open(fname,flag,420,function(err,fd){if(err){return cb(err)}cb=function(err2,arg){fd.close(function(err22){if(!err2){err2=err22}return oldCb(err2,arg)})};fd.stat(function(err2,stat){if(err2){return cb(err2)}var buf=Buffer2.alloc(stat.size);fd.read(buf,0,stat.size,0,function(err3){if(err3){return cb(err3)}else if(encoding===null){return cb(err3,buf)}try{cb(null,buf.toString(encoding))}catch(e){cb(e)}})})})};BaseFileSystem.prototype.readFileSync=function readFileSync(fname,encoding,flag){var fd=this.openSync(fname,flag,420);try{var stat=fd.statSync();var buf=Buffer2.alloc(stat.size);fd.readSync(buf,0,stat.size,0);fd.closeSync();if(encoding===null){return buf}return buf.toString(encoding)}finally{fd.closeSync()}};BaseFileSystem.prototype.writeFile=function writeFile2(fname,data,encoding,flag,mode,cb){var oldCb=cb;this.open(fname,flag,420,function(err,fd){if(err){return cb(err)}cb=function(err2){fd.close(function(err22){oldCb(err2?err2:err22)})};try{if(typeof data==="string"){data=Buffer2.from(data,encoding)}}catch(e){return cb(e)}fd.write(data,0,data.length,0,cb)})};BaseFileSystem.prototype.writeFileSync=function writeFileSync(fname,data,encoding,flag,mode){var fd=this.openSync(fname,flag,mode);try{if(typeof data==="string"){data=Buffer2.from(data,encoding)}fd.writeSync(data,0,data.length,0)}finally{fd.closeSync()}};BaseFileSystem.prototype.appendFile=function appendFile3(fname,data,encoding,flag,mode,cb){var oldCb=cb;this.open(fname,flag,mode,function(err,fd){if(err){return cb(err)}cb=function(err2){fd.close(function(err22){oldCb(err2?err2:err22)})};if(typeof data==="string"){data=Buffer2.from(data,encoding)}fd.write(data,0,data.length,null,cb)})};BaseFileSystem.prototype.appendFileSync=function appendFileSync(fname,data,encoding,flag,mode){var fd=this.openSync(fname,flag,mode);try{if(typeof data==="string"){data=Buffer2.from(data,encoding)}fd.writeSync(data,0,data.length,null)}finally{fd.closeSync()}};BaseFileSystem.prototype.chmod=function chmod(p2,isLchmod,mode,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.chmodSync=function chmodSync(p2,isLchmod,mode){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.chown=function chown(p2,isLchown,uid,gid,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.chownSync=function chownSync(p2,isLchown,uid,gid){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.utimes=function utimes(p2,atime,mtime,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.utimesSync=function utimesSync(p2,atime,mtime){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.link=function link(srcpath,dstpath,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.linkSync=function linkSync(srcpath,dstpath){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.symlink=function symlink(srcpath,dstpath,type,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.symlinkSync=function symlinkSync(srcpath,dstpath,type){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.readlink=function readlink(p2,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.readlinkSync=function readlinkSync(p2){throw new ApiError(ErrorCode.ENOTSUP)};var SynchronousFileSystem=function(BaseFileSystem2){function SynchronousFileSystem2(){BaseFileSystem2.apply(this,arguments)}if(BaseFileSystem2)SynchronousFileSystem2.__proto__=BaseFileSystem2;SynchronousFileSystem2.prototype=Object.create(BaseFileSystem2&&BaseFileSystem2.prototype);SynchronousFileSystem2.prototype.constructor=SynchronousFileSystem2;SynchronousFileSystem2.prototype.supportsSynch=function supportsSynch(){return true};SynchronousFileSystem2.prototype.rename=function rename(oldPath,newPath,cb){try{this.renameSync(oldPath,newPath);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.stat=function stat(p2,isLstat,cb){try{cb(null,this.statSync(p2,isLstat))}catch(e){cb(e)}};SynchronousFileSystem2.prototype.open=function open(p2,flags,mode,cb){try{cb(null,this.openSync(p2,flags,mode))}catch(e){cb(e)}};SynchronousFileSystem2.prototype.unlink=function unlink(p2,cb){try{this.unlinkSync(p2);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.rmdir=function rmdir(p2,cb){try{this.rmdirSync(p2);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.mkdir=function mkdir(p2,mode,cb){try{this.mkdirSync(p2,mode);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.readdir=function readdir(p2,cb){try{cb(null,this.readdirSync(p2))}catch(e){cb(e)}};SynchronousFileSystem2.prototype.chmod=function chmod(p2,isLchmod,mode,cb){try{this.chmodSync(p2,isLchmod,mode);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.chown=function chown(p2,isLchown,uid,gid,cb){try{this.chownSync(p2,isLchown,uid,gid);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.utimes=function utimes(p2,atime,mtime,cb){try{this.utimesSync(p2,atime,mtime);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.link=function link(srcpath,dstpath,cb){try{this.linkSync(srcpath,dstpath);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.symlink=function symlink(srcpath,dstpath,type,cb){try{this.symlinkSync(srcpath,dstpath,type);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.readlink=function readlink(p2,cb){try{cb(null,this.readlinkSync(p2))}catch(e){cb(e)}};return SynchronousFileSystem2}(BaseFileSystem);var BaseFile=function BaseFile2(){};BaseFile.prototype.sync=function sync(cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFile.prototype.syncSync=function syncSync(){throw new ApiError(ErrorCode.ENOTSUP)};BaseFile.prototype.datasync=function datasync(cb){this.sync(cb)};BaseFile.prototype.datasyncSync=function datasyncSync(){return this.syncSync()};BaseFile.prototype.chown=function chown(uid,gid,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFile.prototype.chownSync=function chownSync(uid,gid){throw new ApiError(ErrorCode.ENOTSUP)};BaseFile.prototype.chmod=function chmod(mode,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFile.prototype.chmodSync=function chmodSync(mode){throw new ApiError(ErrorCode.ENOTSUP)};BaseFile.prototype.utimes=function utimes(atime,mtime,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFile.prototype.utimesSync=function utimesSync(atime,mtime){throw new ApiError(ErrorCode.ENOTSUP)};var PreloadFile=function(BaseFile$$1){function PreloadFile2(_fs,_path,_flag,_stat,contents){BaseFile$$1.call(this);this._pos=0;this._dirty=false;this._fs=_fs;this._path=_path;this._flag=_flag;this._stat=_stat;if(contents){this._buffer=contents}else{this._buffer=emptyBuffer()}if(this._stat.size!==this._buffer.length&&this._flag.isReadable()){throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}}if(BaseFile$$1)PreloadFile2.__proto__=BaseFile$$1;PreloadFile2.prototype=Object.create(BaseFile$$1&&BaseFile$$1.prototype);PreloadFile2.prototype.constructor=PreloadFile2;PreloadFile2.prototype.getBuffer=function getBuffer(){return this._buffer};PreloadFile2.prototype.getStats=function getStats(){return this._stat};PreloadFile2.prototype.getFlag=function getFlag2(){return this._flag};PreloadFile2.prototype.getPath=function getPath(){return this._path};PreloadFile2.prototype.getPos=function getPos(){if(this._flag.isAppendable()){return this._stat.size}return this._pos};PreloadFile2.prototype.advancePos=function advancePos(delta){return this._pos+=delta};PreloadFile2.prototype.setPos=function setPos(newPos){return this._pos=newPos};PreloadFile2.prototype.sync=function sync(cb){try{this.syncSync();cb()}catch(e){cb(e)}};PreloadFile2.prototype.syncSync=function syncSync(){throw new ApiError(ErrorCode.ENOTSUP)};PreloadFile2.prototype.close=function close(cb){try{this.closeSync();cb()}catch(e){cb(e)}};PreloadFile2.prototype.closeSync=function closeSync(){throw new ApiError(ErrorCode.ENOTSUP)};PreloadFile2.prototype.stat=function stat(cb){try{cb(null,this._stat.clone())}catch(e){cb(e)}};PreloadFile2.prototype.statSync=function statSync(){return this._stat.clone()};PreloadFile2.prototype.truncate=function truncate(len,cb){try{this.truncateSync(len);if(this._flag.isSynchronous()&&!_fsMock.getRootFS().supportsSynch()){this.sync(cb)}cb()}catch(e){return cb(e)}};PreloadFile2.prototype.truncateSync=function truncateSync(len){this._dirty=true;if(!this._flag.isWriteable()){throw new ApiError(ErrorCode.EPERM,"File not opened with a writeable mode.")}this._stat.mtime=new Date;if(len>this._buffer.length){var buf=Buffer2.alloc(len-this._buffer.length,0);this.writeSync(buf,0,buf.length,this._buffer.length);if(this._flag.isSynchronous()&&_fsMock.getRootFS().supportsSynch()){this.syncSync()}return}this._stat.size=len;var newBuff=Buffer2.alloc(len);this._buffer.copy(newBuff,0,0,len);this._buffer=newBuff;if(this._flag.isSynchronous()&&_fsMock.getRootFS().supportsSynch()){this.syncSync()}};PreloadFile2.prototype.write=function write(buffer$$1,offset,length,position,cb){try{cb(null,this.writeSync(buffer$$1,offset,length,position),buffer$$1)}catch(e){cb(e)}};PreloadFile2.prototype.writeSync=function writeSync(buffer$$1,offset,length,position){this._dirty=true;if(position===void 0||position===null){position=this.getPos()}if(!this._flag.isWriteable()){throw new ApiError(ErrorCode.EPERM,"File not opened with a writeable mode.")}var endFp=position+length;if(endFp>this._stat.size){this._stat.size=endFp;if(endFp>this._buffer.length){var newBuff=Buffer2.alloc(endFp);this._buffer.copy(newBuff);this._buffer=newBuff}}var len=buffer$$1.copy(this._buffer,position,offset,offset+length);this._stat.mtime=new Date;if(this._flag.isSynchronous()){this.syncSync();return len}this.setPos(position+len);return len};PreloadFile2.prototype.read=function read(buffer$$1,offset,length,position,cb){try{cb(null,this.readSync(buffer$$1,offset,length,position),buffer$$1)}catch(e){cb(e)}};PreloadFile2.prototype.readSync=function readSync(buffer$$1,offset,length,position){if(!this._flag.isReadable()){throw new ApiError(ErrorCode.EPERM,"File not opened with a readable mode.")}if(position===void 0||position===null){position=this.getPos()}var endRead=position+length;if(endRead>this._stat.size){length=this._stat.size-position}var rv=this._buffer.copy(buffer$$1,offset,position,position+length);this._stat.atime=new Date;this._pos=position+length;return rv};PreloadFile2.prototype.chmod=function chmod(mode,cb){try{this.chmodSync(mode);cb()}catch(e){cb(e)}};PreloadFile2.prototype.chmodSync=function chmodSync(mode){if(!this._fs.supportsProps()){throw new ApiError(ErrorCode.ENOTSUP)}this._dirty=true;this._stat.chmod(mode);this.syncSync()};PreloadFile2.prototype.isDirty=function isDirty(){return this._dirty};PreloadFile2.prototype.resetDirty=function resetDirty(){this._dirty=false};return PreloadFile2}(BaseFile);var NoSyncFile=function(PreloadFile2){function NoSyncFile2(_fs,_path,_flag,_stat,contents){PreloadFile2.call(this,_fs,_path,_flag,_stat,contents)}if(PreloadFile2)NoSyncFile2.__proto__=PreloadFile2;NoSyncFile2.prototype=Object.create(PreloadFile2&&PreloadFile2.prototype);NoSyncFile2.prototype.constructor=NoSyncFile2;NoSyncFile2.prototype.sync=function sync(cb){cb()};NoSyncFile2.prototype.syncSync=function syncSync(){};NoSyncFile2.prototype.close=function close(cb){cb()};NoSyncFile2.prototype.closeSync=function closeSync(){};return NoSyncFile2}(PreloadFile);var MirrorFile=function(PreloadFile$$1){function MirrorFile2(fs4,path$$1,flag,stat,data){PreloadFile$$1.call(this,fs4,path$$1,flag,stat,data)}if(PreloadFile$$1)MirrorFile2.__proto__=PreloadFile$$1;MirrorFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);MirrorFile2.prototype.constructor=MirrorFile2;MirrorFile2.prototype.syncSync=function syncSync(){if(this.isDirty()){this._fs._syncSync(this);this.resetDirty()}};MirrorFile2.prototype.closeSync=function closeSync(){this.syncSync()};return MirrorFile2}(PreloadFile);var AsyncMirror=function(SynchronousFileSystem$$1){function AsyncMirror2(sync,async,deprecateMsg){if(deprecateMsg===void 0)deprecateMsg=true;SynchronousFileSystem$$1.call(this);this._queue=[];this._queueRunning=false;this._isInitialized=false;this._initializeCallbacks=[];this._sync=sync;this._async=async;if(!sync.supportsSynch()){throw new Error("The first argument to AsyncMirror needs to be a synchronous file system.")}deprecationMessage(deprecateMsg,AsyncMirror2.Name,{sync:"sync file system instance",async:"async file system instance"})}if(SynchronousFileSystem$$1)AsyncMirror2.__proto__=SynchronousFileSystem$$1;AsyncMirror2.prototype=Object.create(SynchronousFileSystem$$1&&SynchronousFileSystem$$1.prototype);AsyncMirror2.prototype.constructor=AsyncMirror2;AsyncMirror2.Create=function Create(opts,cb){try{var fs4=new AsyncMirror2(opts.sync,opts.async,false);fs4.initialize(function(e){if(e){cb(e)}else{cb(null,fs4)}},false)}catch(e){cb(e)}};AsyncMirror2.isAvailable=function isAvailable(){return true};AsyncMirror2.prototype.getName=function getName(){return AsyncMirror2.Name};AsyncMirror2.prototype._syncSync=function _syncSync(fd){this._sync.writeFileSync(fd.getPath(),fd.getBuffer(),null,FileFlag.getFileFlag("w"),fd.getStats().mode);this.enqueueOp({apiMethod:"writeFile",arguments:[fd.getPath(),fd.getBuffer(),null,fd.getFlag(),fd.getStats().mode]})};AsyncMirror2.prototype.initialize=function initialize3(userCb,deprecateMsg){var this$1=this;if(deprecateMsg===void 0)deprecateMsg=true;if(deprecateMsg){console.warn("[AsyncMirror] AsyncMirror.initialize() is deprecated and will be removed in the next major version. Please use \'AsyncMirror.Create({ sync: (sync file system instance), async: (async file system instance)}, cb)\' to create and initialize AsyncMirror instances.")}var callbacks=this._initializeCallbacks;var end=function(e){this$1._isInitialized=!e;this$1._initializeCallbacks=[];callbacks.forEach(function(cb){return cb(e)})};if(!this._isInitialized){if(callbacks.push(userCb)===1){var copyDirectory=function(p2,mode,cb){if(p2!=="/"){this$1._sync.mkdirSync(p2,mode)}this$1._async.readdir(p2,function(err,files){var i22=0;function copyNextFile(err2){if(err2){cb(err2)}else if(i22<files.length){copyItem(path.join(p2,files[i22]),copyNextFile);i22++}else{cb()}}if(err){cb(err)}else{copyNextFile()}})},copyFile=function(p2,mode,cb){this$1._async.readFile(p2,null,FileFlag.getFileFlag("r"),function(err,data){if(err){cb(err)}else{try{this$1._sync.writeFileSync(p2,data,null,FileFlag.getFileFlag("w"),mode)}catch(e){err=e}finally{cb(err)}}})},copyItem=function(p2,cb){this$1._async.stat(p2,false,function(err,stats){if(err){cb(err)}else if(stats.isDirectory()){copyDirectory(p2,stats.mode,cb)}else{copyFile(p2,stats.mode,cb)}})};copyDirectory("/",0,end)}}else{userCb()}};AsyncMirror2.prototype.isReadOnly=function isReadOnly(){return false};AsyncMirror2.prototype.supportsSynch=function supportsSynch(){return true};AsyncMirror2.prototype.supportsLinks=function supportsLinks(){return false};AsyncMirror2.prototype.supportsProps=function supportsProps(){return this._sync.supportsProps()&&this._async.supportsProps()};AsyncMirror2.prototype.renameSync=function renameSync(oldPath,newPath){this.checkInitialized();this._sync.renameSync(oldPath,newPath);this.enqueueOp({apiMethod:"rename",arguments:[oldPath,newPath]})};AsyncMirror2.prototype.statSync=function statSync(p2,isLstat){this.checkInitialized();return this._sync.statSync(p2,isLstat)};AsyncMirror2.prototype.openSync=function openSync(p2,flag,mode){this.checkInitialized();var fd=this._sync.openSync(p2,flag,mode);fd.closeSync();return new MirrorFile(this,p2,flag,this._sync.statSync(p2,false),this._sync.readFileSync(p2,null,FileFlag.getFileFlag("r")))};AsyncMirror2.prototype.unlinkSync=function unlinkSync(p2){this.checkInitialized();this._sync.unlinkSync(p2);this.enqueueOp({apiMethod:"unlink",arguments:[p2]})};AsyncMirror2.prototype.rmdirSync=function rmdirSync(p2){this.checkInitialized();this._sync.rmdirSync(p2);this.enqueueOp({apiMethod:"rmdir",arguments:[p2]})};AsyncMirror2.prototype.mkdirSync=function mkdirSync(p2,mode){this.checkInitialized();this._sync.mkdirSync(p2,mode);this.enqueueOp({apiMethod:"mkdir",arguments:[p2,mode]})};AsyncMirror2.prototype.readdirSync=function readdirSync(p2){this.checkInitialized();return this._sync.readdirSync(p2)};AsyncMirror2.prototype.existsSync=function existsSync(p2){this.checkInitialized();return this._sync.existsSync(p2)};AsyncMirror2.prototype.chmodSync=function chmodSync(p2,isLchmod,mode){this.checkInitialized();this._sync.chmodSync(p2,isLchmod,mode);this.enqueueOp({apiMethod:"chmod",arguments:[p2,isLchmod,mode]})};AsyncMirror2.prototype.chownSync=function chownSync(p2,isLchown,uid,gid){this.checkInitialized();this._sync.chownSync(p2,isLchown,uid,gid);this.enqueueOp({apiMethod:"chown",arguments:[p2,isLchown,uid,gid]})};AsyncMirror2.prototype.utimesSync=function utimesSync(p2,atime,mtime){this.checkInitialized();this._sync.utimesSync(p2,atime,mtime);this.enqueueOp({apiMethod:"utimes",arguments:[p2,atime,mtime]})};AsyncMirror2.prototype.checkInitialized=function checkInitialized(){if(!this._isInitialized){throw new ApiError(ErrorCode.EPERM,"AsyncMirrorFS is not initialized. Please initialize AsyncMirrorFS using its initialize() method before using it.")}};AsyncMirror2.prototype.enqueueOp=function enqueueOp(op){var this$1=this;this._queue.push(op);if(!this._queueRunning){this._queueRunning=true;var doNextOp=function(err){if(err){console.error("WARNING: File system has desynchronized. Received following error: "+err+"\\n$")}if(this$1._queue.length>0){var op2=this$1._queue.shift(),args=op2.arguments;args.push(doNextOp);this$1._async[op2.apiMethod].apply(this$1._async,args)}else{this$1._queueRunning=false}};doNextOp()}};return AsyncMirror2}(SynchronousFileSystem);AsyncMirror.Name="AsyncMirror";AsyncMirror.Options={sync:{type:"object",description:"The synchronous file system to mirror the asynchronous file system to."},async:{type:"object",description:"The asynchronous file system to mirror."}};function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}var nativeMax=Math.max;function overRest$1(func,start,transform){start=nativeMax(start===void 0?func.length-1:start,0);return function(){var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);while(++index<length){array[index]=args[start+index]}index=-1;var otherArgs=Array(start+1);while(++index<start){otherArgs[index]=args[index]}otherArgs[start]=transform(array);return apply(func,this,otherArgs)}}function identity(value){return value}function rest(func,start){return overRest$1(func,start,identity)}var initialParams=function(fn){return rest(function(args){var callback=args.pop();fn.call(this,args,callback)})};function applyEach$1(eachfn){return rest(function(fns,args){var go=initialParams(function(args2,callback){var that=this;return eachfn(fns,function(fn,cb){fn.apply(that,args2.concat(cb))},callback)});if(args.length){return go.apply(this,args)}else{return go}})}var freeGlobal=typeof global2=="object"&&global2&&global2.Object===Object&&global2;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self;var root=freeGlobal||freeSelf||Function("return this")();var Symbol$1=root.Symbol;var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;var nativeObjectToString=objectProto.toString;var symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(value){var isOwn=hasOwnProperty.call(value,symToStringTag$1),tag=value[symToStringTag$1];try{value[symToStringTag$1]=void 0;var unmasked=true}catch(e){}var result=nativeObjectToString.call(value);if(unmasked){if(isOwn){value[symToStringTag$1]=tag}else{delete value[symToStringTag$1]}}return result}var objectProto$1=Object.prototype;var nativeObjectToString$1=objectProto$1.toString;function objectToString(value){return nativeObjectToString$1.call(value)}var nullTag="[object Null]";var undefinedTag="[object Undefined]";var symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(value){if(value==null){return value===void 0?undefinedTag:nullTag}return symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}function isObject(value){var type=typeof value;return value!=null&&(type=="object"||type=="function")}var asyncTag="[object AsyncFunction]";var funcTag="[object Function]";var genTag="[object GeneratorFunction]";var proxyTag="[object Proxy]";function isFunction3(value){if(!isObject(value)){return false}var tag=baseGetTag(value);return tag==funcTag||tag==genTag||tag==asyncTag||tag==proxyTag}var MAX_SAFE_INTEGER=9007199254740991;function isLength(value){return typeof value=="number"&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isArrayLike(value){return value!=null&&isLength(value.length)&&!isFunction3(value)}var breakLoop={};function noop3(){}function once(fn){return function(){if(fn===null){return}var callFn=fn;fn=null;callFn.apply(this,arguments)}}var iteratorSymbol=typeof Symbol==="function"&&Symbol.iterator;var getIterator=function(coll){return iteratorSymbol&&coll[iteratorSymbol]&&coll[iteratorSymbol]()};function baseTimes(n,iteratee){var index=-1,result=Array(n);while(++index<n){result[index]=iteratee(index)}return result}function isObjectLike(value){return value!=null&&typeof value=="object"}var argsTag="[object Arguments]";function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag}var objectProto$3=Object.prototype;var hasOwnProperty$2=objectProto$3.hasOwnProperty;var propertyIsEnumerable=objectProto$3.propertyIsEnumerable;var isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty$2.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")};var isArray=Array.isArray;function stubFalse(){return false}var freeExports=typeof exports2=="object"&&exports2&&!exports2.nodeType&&exports2;var freeModule=freeExports&&typeof module3=="object"&&module3&&!module3.nodeType&&module3;var moduleExports=freeModule&&freeModule.exports===freeExports;var Buffer$1=moduleExports?root.Buffer:void 0;var nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0;var isBuffer=nativeIsBuffer||stubFalse;var MAX_SAFE_INTEGER$1=9007199254740991;var reIsUint=/^(?:0|[1-9]\\d*)$/;function isIndex(value,length){length=length==null?MAX_SAFE_INTEGER$1:length;return!!length&&(typeof value=="number"||reIsUint.test(value))&&(value>-1&&value%1==0&&value<length)}var argsTag$1="[object Arguments]";var arrayTag="[object Array]";var boolTag="[object Boolean]";var dateTag="[object Date]";var errorTag="[object Error]";var funcTag$1="[object Function]";var mapTag="[object Map]";var numberTag="[object Number]";var objectTag="[object Object]";var regexpTag="[object RegExp]";var setTag="[object Set]";var stringTag="[object String]";var weakMapTag="[object WeakMap]";var arrayBufferTag="[object ArrayBuffer]";var dataViewTag="[object DataView]";var float32Tag="[object Float32Array]";var float64Tag="[object Float64Array]";var int8Tag="[object Int8Array]";var int16Tag="[object Int16Array]";var int32Tag="[object Int32Array]";var uint8Tag="[object Uint8Array]";var uint8ClampedTag="[object Uint8ClampedArray]";var uint16Tag="[object Uint16Array]";var uint32Tag="[object Uint32Array]";var typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=true;typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=false;function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}function baseUnary(func){return function(value){return func(value)}}var freeExports$1=typeof exports2=="object"&&exports2&&!exports2.nodeType&&exports2;var freeModule$1=freeExports$1&&typeof module3=="object"&&module3&&!module3.nodeType&&module3;var moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1;var freeProcess=moduleExports$1&&freeGlobal.process;var nodeUtil=function(){try{return freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();var nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray;var isTypedArray3=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;var objectProto$2=Object.prototype;var hasOwnProperty$1=objectProto$2.hasOwnProperty;function arrayLikeKeys(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray3(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value){if((inherited||hasOwnProperty$1.call(value,key))&&!(skipIndexes&&(key=="length"||isBuff&&(key=="offset"||key=="parent")||isType&&(key=="buffer"||key=="byteLength"||key=="byteOffset")||isIndex(key,length)))){result.push(key)}}return result}var objectProto$5=Object.prototype;function isPrototype(value){var Ctor=value&&value.constructor,proto=typeof Ctor=="function"&&Ctor.prototype||objectProto$5;return value===proto}function overArg(func,transform){return function(arg){return func(transform(arg))}}var nativeKeys=overArg(Object.keys,Object);var objectProto$4=Object.prototype;var hasOwnProperty$3=objectProto$4.hasOwnProperty;function baseKeys(object){if(!isPrototype(object)){return nativeKeys(object)}var result=[];for(var key in Object(object)){if(hasOwnProperty$3.call(object,key)&&key!="constructor"){result.push(key)}}return result}function keys3(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function createArrayIterator(coll){var i22=-1;var len=coll.length;return function next(){return++i22<len?{value:coll[i22],key:i22}:null}}function createES2015Iterator(iterator2){var i22=-1;return function next(){var item=iterator2.next();if(item.done){return null}i22++;return{value:item.value,key:i22}}}function createObjectIterator(obj){var okeys=keys3(obj);var i22=-1;var len=okeys.length;return function next(){var key=okeys[++i22];return i22<len?{value:obj[key],key}:null}}function iterator(coll){if(isArrayLike(coll)){return createArrayIterator(coll)}var iterator2=getIterator(coll);return iterator2?createES2015Iterator(iterator2):createObjectIterator(coll)}function onlyOnce(fn){return function(){if(fn===null){throw new Error("Callback was already called.")}var callFn=fn;fn=null;callFn.apply(this,arguments)}}function _eachOfLimit(limit){return function(obj,iteratee,callback){callback=once(callback||noop3);if(limit<=0||!obj){return callback(null)}var nextElem=iterator(obj);var done=false;var running=0;function iterateeCallback(err,value){running-=1;if(err){done=true;callback(err)}else if(value===breakLoop||done&&running<=0){done=true;return callback(null)}else{replenish()}}function replenish(){while(running<limit&&!done){var elem=nextElem();if(elem===null){done=true;if(running<=0){callback(null)}return}running+=1;iteratee(elem.value,elem.key,onlyOnce(iterateeCallback))}}replenish()}}function eachOfLimit(coll,limit,iteratee,callback){_eachOfLimit(limit)(coll,iteratee,callback)}function doLimit(fn,limit){return function(iterable,iteratee,callback){return fn(iterable,limit,iteratee,callback)}}function eachOfArrayLike(coll,iteratee,callback){callback=once(callback||noop3);var index=0,completed=0,length=coll.length;if(length===0){callback(null)}function iteratorCallback(err,value){if(err){callback(err)}else if(++completed===length||value===breakLoop){callback(null)}}for(;index<length;index++){iteratee(coll[index],index,onlyOnce(iteratorCallback))}}var eachOfGeneric=doLimit(eachOfLimit,Infinity);var eachOf=function(coll,iteratee,callback){var eachOfImplementation=isArrayLike(coll)?eachOfArrayLike:eachOfGeneric;eachOfImplementation(coll,iteratee,callback)};function doParallel(fn){return function(obj,iteratee,callback){return fn(eachOf,obj,iteratee,callback)}}function _asyncMap(eachfn,arr,iteratee,callback){callback=callback||noop3;arr=arr||[];var results=[];var counter=0;eachfn(arr,function(value,_,callback2){var index=counter++;iteratee(value,function(err,v2){results[index]=v2;callback2(err)})},function(err){callback(err,results)})}var map=doParallel(_asyncMap);applyEach$1(map);function doParallelLimit(fn){return function(obj,limit,iteratee,callback){return fn(_eachOfLimit(limit),obj,iteratee,callback)}}var mapLimit=doParallelLimit(_asyncMap);var mapSeries=doLimit(mapLimit,1);applyEach$1(mapSeries);rest(function(fn,args){return rest(function(callArgs){return fn.apply(null,args.concat(callArgs))})});function arrayEach(array,iteratee){var index=-1,length=array==null?0:array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break}}return array}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;while(length--){var key=props[fromRight?length:++index];if(iteratee(iterable[key],key,iterable)===false){break}}return object}}var baseFor=createBaseFor();function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys3)}function baseFindIndex(array,predicate,fromIndex,fromRight){var length=array.length,index=fromIndex+(fromRight?1:-1);while(fromRight?index--:++index<length){if(predicate(array[index],index,array)){return index}}return-1}function baseIsNaN(value){return value!==value}function strictIndexOf(array,value,fromIndex){var index=fromIndex-1,length=array.length;while(++index<length){if(array[index]===value){return index}}return-1}function baseIndexOf(array,value,fromIndex){return value===value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}var rsAstralRange$1="\\\\ud800-\\\\udfff";var rsComboMarksRange$1="\\\\u0300-\\\\u036f";var reComboHalfMarksRange$1="\\\\ufe20-\\\\ufe2f";var rsComboSymbolsRange$1="\\\\u20d0-\\\\u20ff";var rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1;var rsVarRange$1="\\\\ufe0e\\\\ufe0f";var rsAstral="["+rsAstralRange$1+"]";var rsCombo="["+rsComboRange$1+"]";var rsFitz="\\\\ud83c[\\\\udffb-\\\\udfff]";var rsModifier="(?:"+rsCombo+"|"+rsFitz+")";var rsNonAstral="[^"+rsAstralRange$1+"]";var rsRegional="(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}";var rsSurrPair="[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]";var rsZWJ$1="\\\\u200d";var reOptMod=rsModifier+"?";var rsOptVar="["+rsVarRange$1+"]?";var rsOptJoin="(?:"+rsZWJ$1+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*";var rsSeq=rsOptVar+reOptMod+rsOptJoin;var rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")";var hasSetImmediate=typeof setImmediate==="function"&&setImmediate;var hasNextTick=typeof process==="object"&&typeof process.nextTick==="function";function fallback(fn){setTimeout(fn,0)}function wrap(defer){return rest(function(fn,args){defer(function(){fn.apply(null,args)})})}var _defer;if(hasSetImmediate){_defer=setImmediate}else if(hasNextTick){_defer=process.nextTick}else{_defer=fallback}wrap(_defer);var eachOfSeries=doLimit(eachOfLimit,1);function reduce(coll,memo,iteratee,callback){callback=once(callback||noop3);eachOfSeries(coll,function(x3,i22,callback2){iteratee(memo,x3,function(err,v2){memo=v2;callback2(err)})},function(err){callback(err,memo)})}var seq=rest(function seq2(functions){return rest(function(args){var that=this;var cb=args[args.length-1];if(typeof cb=="function"){args.pop()}else{cb=noop3}reduce(functions,args,function(newargs,fn,cb2){fn.apply(that,newargs.concat(rest(function(err,nextargs){cb2(err,nextargs)})))},function(err,results){cb.apply(that,[err].concat(results))})})});rest(function(args){return seq.apply(null,args.reverse())});rest(function(values){var args=[null].concat(values);return initialParams(function(ignoredArgs,callback){return callback.apply(this,args)})});function consoleFunc(name2){return rest(function(fn,args){fn.apply(null,args.concat(rest(function(err,args2){if(typeof console==="object"){if(err){if(console.error){console.error(err)}}else if(console[name2]){arrayEach(args2,function(x3){console[name2](x3)})}}})))})}consoleFunc("dir");function _withoutIndex(iteratee){return function(value,index,callback){return iteratee(value,callback)}}function eachLimit(coll,iteratee,callback){eachOf(coll,_withoutIndex(iteratee),callback)}consoleFunc("log");var _defer$1;if(hasNextTick){_defer$1=process.nextTick}else if(hasSetImmediate){_defer$1=setImmediate}else{_defer$1=fallback}wrap(_defer$1);var nativeCeil=Math.ceil;var nativeMax$1=Math.max;var errorCodeLookup;function constructErrorCodeLookup(){if(errorCodeLookup){return}errorCodeLookup={};errorCodeLookup[Dropbox.ApiError.NETWORK_ERROR]=ErrorCode.EIO;errorCodeLookup[Dropbox.ApiError.INVALID_PARAM]=ErrorCode.EINVAL;errorCodeLookup[Dropbox.ApiError.INVALID_TOKEN]=ErrorCode.EPERM;errorCodeLookup[Dropbox.ApiError.OAUTH_ERROR]=ErrorCode.EPERM;errorCodeLookup[Dropbox.ApiError.NOT_FOUND]=ErrorCode.ENOENT;errorCodeLookup[Dropbox.ApiError.INVALID_METHOD]=ErrorCode.EINVAL;errorCodeLookup[Dropbox.ApiError.NOT_ACCEPTABLE]=ErrorCode.EINVAL;errorCodeLookup[Dropbox.ApiError.CONFLICT]=ErrorCode.EINVAL;errorCodeLookup[Dropbox.ApiError.RATE_LIMITED]=ErrorCode.EBUSY;errorCodeLookup[Dropbox.ApiError.SERVER_ERROR]=ErrorCode.EBUSY;errorCodeLookup[Dropbox.ApiError.OVER_QUOTA]=ErrorCode.ENOSPC}function isFileInfo(cache){return cache&&cache.stat.isFile}function isDirInfo(cache){return cache&&cache.stat.isFolder}function isArrayBuffer(ab){return ab===null||ab===void 0||typeof ab==="object"&&typeof ab["byteLength"]==="number"}var CachedDropboxClient=function CachedDropboxClient2(client){this._cache={};this._client=client};CachedDropboxClient.prototype.readdir=function readdir(p2,cb){var this$1=this;var cacheInfo=this.getCachedDirInfo(p2);this._wrap(function(interceptCb){if(cacheInfo!==null&&cacheInfo.contents){this$1._client.readdir(p2,{contentHash:cacheInfo.stat.contentHash},interceptCb)}else{this$1._client.readdir(p2,interceptCb)}},function(err,filenames,stat,folderEntries){if(err){if(err.status===Dropbox.ApiError.NO_CONTENT&&cacheInfo!==null){cb(null,cacheInfo.contents.slice(0))}else{cb(err)}}else{this$1.updateCachedDirInfo(p2,stat,filenames.slice(0));folderEntries.forEach(function(entry){this$1.updateCachedInfo(path.join(p2,entry.name),entry)});cb(null,filenames)}})};CachedDropboxClient.prototype.remove=function remove(p2,cb){var this$1=this;this._wrap(function(interceptCb){this$1._client.remove(p2,interceptCb)},function(err,stat){if(!err){this$1.updateCachedInfo(p2,stat)}cb(err)})};CachedDropboxClient.prototype.move=function move(src,dest,cb){var this$1=this;this._wrap(function(interceptCb){this$1._client.move(src,dest,interceptCb)},function(err,stat){if(!err){this$1.deleteCachedInfo(src);this$1.updateCachedInfo(dest,stat)}cb(err)})};CachedDropboxClient.prototype.stat=function stat(p2,cb){var this$1=this;this._wrap(function(interceptCb){this$1._client.stat(p2,interceptCb)},function(err,stat2){if(!err){this$1.updateCachedInfo(p2,stat2)}cb(err,stat2)})};CachedDropboxClient.prototype.readFile=function readFile2(p2,cb){var this$1=this;var cacheInfo=this.getCachedFileInfo(p2);if(cacheInfo!==null&&cacheInfo.contents!==null){this.stat(p2,function(error,stat){if(error){cb(error)}else if(stat.contentHash===cacheInfo.stat.contentHash){cb(error,cacheInfo.contents.slice(0),cacheInfo.stat)}else{this$1.readFile(p2,cb)}})}else{this._wrap(function(interceptCb){this$1._client.readFile(p2,{arrayBuffer:true},interceptCb)},function(err,contents,stat){if(!err){this$1.updateCachedInfo(p2,stat,contents.slice(0))}cb(err,contents,stat)})}};CachedDropboxClient.prototype.writeFile=function writeFile2(p2,contents,cb){var this$1=this;this._wrap(function(interceptCb){this$1._client.writeFile(p2,contents,interceptCb)},function(err,stat){if(!err){this$1.updateCachedInfo(p2,stat,contents.slice(0))}cb(err,stat)})};CachedDropboxClient.prototype.mkdir=function mkdir(p2,cb){var this$1=this;this._wrap(function(interceptCb){this$1._client.mkdir(p2,interceptCb)},function(err,stat){if(!err){this$1.updateCachedInfo(p2,stat,[])}cb(err)})};CachedDropboxClient.prototype._wrap=function _wrap(performOp,cb){var numRun=0;var interceptCb=function(error){var timeoutDuration=2;if(error&&3>++numRun){switch(error.status){case Dropbox.ApiError.SERVER_ERROR:case Dropbox.ApiError.NETWORK_ERROR:case Dropbox.ApiError.RATE_LIMITED:setTimeout(function(){performOp(interceptCb)},timeoutDuration*1e3);break;default:cb.apply(null,arguments);break}}else{cb.apply(null,arguments)}};performOp(interceptCb)};CachedDropboxClient.prototype.getCachedInfo=function getCachedInfo(p2){return this._cache[p2.toLowerCase()]};CachedDropboxClient.prototype.putCachedInfo=function putCachedInfo(p2,cache){this._cache[p2.toLowerCase()]=cache};CachedDropboxClient.prototype.deleteCachedInfo=function deleteCachedInfo(p2){delete this._cache[p2.toLowerCase()]};CachedDropboxClient.prototype.getCachedDirInfo=function getCachedDirInfo(p2){var info=this.getCachedInfo(p2);if(isDirInfo(info)){return info}else{return null}};CachedDropboxClient.prototype.getCachedFileInfo=function getCachedFileInfo(p2){var info=this.getCachedInfo(p2);if(isFileInfo(info)){return info}else{return null}};CachedDropboxClient.prototype.updateCachedDirInfo=function updateCachedDirInfo(p2,stat,contents){if(contents===void 0)contents=null;var cachedInfo=this.getCachedInfo(p2);if(stat.contentHash!==null&&(cachedInfo===void 0||cachedInfo.stat.contentHash!==stat.contentHash)){this.putCachedInfo(p2,{stat,contents})}};CachedDropboxClient.prototype.updateCachedFileInfo=function updateCachedFileInfo(p2,stat,contents){if(contents===void 0)contents=null;var cachedInfo=this.getCachedInfo(p2);if(stat.versionTag!==null&&(cachedInfo===void 0||cachedInfo.stat.versionTag!==stat.versionTag)){this.putCachedInfo(p2,{stat,contents})}};CachedDropboxClient.prototype.updateCachedInfo=function updateCachedInfo(p2,stat,contents){if(contents===void 0)contents=null;if(stat.isFile&&isArrayBuffer(contents)){this.updateCachedFileInfo(p2,stat,contents)}else if(stat.isFolder&&Array.isArray(contents)){this.updateCachedDirInfo(p2,stat,contents)}};var DropboxFile=function(PreloadFile$$1){function DropboxFile2(_fs,_path,_flag,_stat,contents){PreloadFile$$1.call(this,_fs,_path,_flag,_stat,contents)}if(PreloadFile$$1)DropboxFile2.__proto__=PreloadFile$$1;DropboxFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);DropboxFile2.prototype.constructor=DropboxFile2;DropboxFile2.prototype.sync=function sync(cb){var this$1=this;if(this.isDirty()){var buffer$$1=this.getBuffer(),arrayBuffer=buffer2ArrayBuffer(buffer$$1);this._fs._writeFileStrict(this.getPath(),arrayBuffer,function(e){if(!e){this$1.resetDirty()}cb(e)})}else{cb()}};DropboxFile2.prototype.close=function close(cb){this.sync(cb)};return DropboxFile2}(PreloadFile);var DropboxFileSystem=function(BaseFileSystem$$1){function DropboxFileSystem2(client,deprecateMsg){if(deprecateMsg===void 0)deprecateMsg=true;BaseFileSystem$$1.call(this);this._client=new CachedDropboxClient(client);deprecationMessage(deprecateMsg,DropboxFileSystem2.Name,{client:"authenticated dropbox client instance"});constructErrorCodeLookup()}if(BaseFileSystem$$1)DropboxFileSystem2.__proto__=BaseFileSystem$$1;DropboxFileSystem2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);DropboxFileSystem2.prototype.constructor=DropboxFileSystem2;DropboxFileSystem2.Create=function Create(opts,cb){cb(null,new DropboxFileSystem2(opts.client,false))};DropboxFileSystem2.isAvailable=function isAvailable(){return typeof Dropbox!=="undefined"};DropboxFileSystem2.prototype.getName=function getName(){return DropboxFileSystem2.Name};DropboxFileSystem2.prototype.isReadOnly=function isReadOnly(){return false};DropboxFileSystem2.prototype.supportsSymlinks=function supportsSymlinks(){return false};DropboxFileSystem2.prototype.supportsProps=function supportsProps(){return false};DropboxFileSystem2.prototype.supportsSynch=function supportsSynch(){return false};DropboxFileSystem2.prototype.empty=function empty(mainCb){var this$1=this;this._client.readdir("/",function(error,files){if(error){mainCb(this$1.convert(error,"/"))}else{var deleteFile2=function(file,cb){var p2=path.join("/",file);this$1._client.remove(p2,function(err){cb(err?this$1.convert(err,p2):null)})};var finished=function(err){if(err){mainCb(err)}else{mainCb()}};eachLimit(files,deleteFile2,finished)}})};DropboxFileSystem2.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;this._client.move(oldPath,newPath,function(error){if(error){this$1._client.stat(newPath,function(error2,stat){if(error2||stat.isFolder){var missingPath=error.response.error.indexOf(oldPath)>-1?oldPath:newPath;cb(this$1.convert(error,missingPath))}else{this$1._client.remove(newPath,function(error22){if(error22){cb(this$1.convert(error22,newPath))}else{this$1.rename(oldPath,newPath,cb)}})}})}else{cb()}})};DropboxFileSystem2.prototype.stat=function stat(path$$1,isLstat,cb){var this$1=this;this._client.stat(path$$1,function(error,stat2){if(error){cb(this$1.convert(error,path$$1))}else if(stat2&&stat2.isRemoved){cb(ApiError.FileError(ErrorCode.ENOENT,path$$1))}else{var stats=new Stats(this$1._statType(stat2),stat2.size);return cb(null,stats)}})};DropboxFileSystem2.prototype.open=function open(path$$1,flags,mode,cb){var this$1=this;this._client.readFile(path$$1,function(error,content,dbStat){if(error){if(flags.isReadable()){cb(this$1.convert(error,path$$1))}else{switch(error.status){case Dropbox.ApiError.NOT_FOUND:var ab=new ArrayBuffer(0);return this$1._writeFileStrict(path$$1,ab,function(error2,stat){if(error2){cb(error2)}else{var file2=this$1._makeFile(path$$1,flags,stat,arrayBuffer2Buffer(ab));cb(null,file2)}});default:return cb(this$1.convert(error,path$$1))}}}else{var buffer$$1;if(content===null){buffer$$1=emptyBuffer()}else{buffer$$1=arrayBuffer2Buffer(content)}var file=this$1._makeFile(path$$1,flags,dbStat,buffer$$1);return cb(null,file)}})};DropboxFileSystem2.prototype._writeFileStrict=function _writeFileStrict(p2,data,cb){var this$1=this;var parent=path.dirname(p2);this.stat(parent,false,function(error,stat){if(error){cb(ApiError.FileError(ErrorCode.ENOENT,parent))}else{this$1._client.writeFile(p2,data,function(error2,stat2){if(error2){cb(this$1.convert(error2,p2))}else{cb(null,stat2)}})}})};DropboxFileSystem2.prototype._statType=function _statType(stat){return stat.isFile?FileType.FILE:FileType.DIRECTORY};DropboxFileSystem2.prototype._makeFile=function _makeFile(path$$1,flag,stat,buffer$$1){var type=this._statType(stat);var stats=new Stats(type,stat.size);return new DropboxFile(this,path$$1,flag,stats,buffer$$1)};DropboxFileSystem2.prototype._remove=function _remove(path$$1,cb,isFile){var this$1=this;this._client.stat(path$$1,function(error,stat){if(error){cb(this$1.convert(error,path$$1))}else{if(stat.isFile&&!isFile){cb(ApiError.FileError(ErrorCode.ENOTDIR,path$$1))}else if(!stat.isFile&&isFile){cb(ApiError.FileError(ErrorCode.EISDIR,path$$1))}else{this$1._client.remove(path$$1,function(error2){if(error2){cb(this$1.convert(error2,path$$1))}else{cb(null)}})}}})};DropboxFileSystem2.prototype.unlink=function unlink(path$$1,cb){this._remove(path$$1,cb,true)};DropboxFileSystem2.prototype.rmdir=function rmdir(path$$1,cb){this._remove(path$$1,cb,false)};DropboxFileSystem2.prototype.mkdir=function mkdir(p2,mode,cb){var this$1=this;var parent=path.dirname(p2);this._client.stat(parent,function(error,stat){if(error){cb(this$1.convert(error,parent))}else{this$1._client.mkdir(p2,function(error2){if(error2){cb(ApiError.FileError(ErrorCode.EEXIST,p2))}else{cb(null)}})}})};DropboxFileSystem2.prototype.readdir=function readdir(path$$1,cb){var this$1=this;this._client.readdir(path$$1,function(error,files){if(error){return cb(this$1.convert(error))}else{return cb(null,files)}})};DropboxFileSystem2.prototype.convert=function convert(err,path$$1){if(path$$1===void 0)path$$1=null;var errorCode=errorCodeLookup[err.status];if(errorCode===void 0){errorCode=ErrorCode.EIO}if(!path$$1){return new ApiError(errorCode)}else{return ApiError.FileError(errorCode,path$$1)}};return DropboxFileSystem2}(BaseFileSystem);DropboxFileSystem.Name="Dropbox";DropboxFileSystem.Options={client:{type:"object",description:"An *authenticated* Dropbox client. Must be from the 0.10 JS SDK.",validator:function(opt,cb){if(opt.isAuthenticated&&opt.isAuthenticated()){cb()}else{cb(new ApiError(ErrorCode.EINVAL,"\'client\' option must be an authenticated Dropbox client from the v0.10 JS SDK."))}}}};function convertError(e,path$$1){if(path$$1===void 0)path$$1="";var errno=e.errno;var parent=e.node;var paths=[];while(parent){paths.unshift(parent.name);if(parent===parent.parent){break}parent=parent.parent}return new ApiError(errno,ErrorStrings[errno],paths.length>0?"/"+paths.join("/"):path$$1)}var EmscriptenFile=function(BaseFile$$1){function EmscriptenFile2(_fs,_FS,_path,_stream){BaseFile$$1.call(this);this._fs=_fs;this._FS=_FS;this._path=_path;this._stream=_stream}if(BaseFile$$1)EmscriptenFile2.__proto__=BaseFile$$1;EmscriptenFile2.prototype=Object.create(BaseFile$$1&&BaseFile$$1.prototype);EmscriptenFile2.prototype.constructor=EmscriptenFile2;EmscriptenFile2.prototype.getPos=function getPos(){return void 0};EmscriptenFile2.prototype.close=function close(cb){var err=null;try{this.closeSync()}catch(e){err=e}finally{cb(err)}};EmscriptenFile2.prototype.closeSync=function closeSync(){try{this._FS.close(this._stream)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.stat=function stat(cb){try{cb(null,this.statSync())}catch(e){cb(e)}};EmscriptenFile2.prototype.statSync=function statSync(){try{return this._fs.statSync(this._path,false)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.truncate=function truncate(len,cb){var err=null;try{this.truncateSync(len)}catch(e){err=e}finally{cb(err)}};EmscriptenFile2.prototype.truncateSync=function truncateSync(len){try{this._FS.ftruncate(this._stream.fd,len)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.write=function write(buffer$$1,offset,length,position,cb){try{cb(null,this.writeSync(buffer$$1,offset,length,position),buffer$$1)}catch(e){cb(e)}};EmscriptenFile2.prototype.writeSync=function writeSync(buffer$$1,offset,length,position){try{var u8=buffer2Uint8array(buffer$$1);var emPosition=position===null?void 0:position;return this._FS.write(this._stream,u8,offset,length,emPosition)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.read=function read(buffer$$1,offset,length,position,cb){try{cb(null,this.readSync(buffer$$1,offset,length,position),buffer$$1)}catch(e){cb(e)}};EmscriptenFile2.prototype.readSync=function readSync(buffer$$1,offset,length,position){try{var u8=buffer2Uint8array(buffer$$1);var emPosition=position===null?void 0:position;return this._FS.read(this._stream,u8,offset,length,emPosition)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.sync=function sync(cb){cb()};EmscriptenFile2.prototype.syncSync=function syncSync(){};EmscriptenFile2.prototype.chown=function chown(uid,gid,cb){var err=null;try{this.chownSync(uid,gid)}catch(e){err=e}finally{cb(err)}};EmscriptenFile2.prototype.chownSync=function chownSync(uid,gid){try{this._FS.fchown(this._stream.fd,uid,gid)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.chmod=function chmod(mode,cb){var err=null;try{this.chmodSync(mode)}catch(e){err=e}finally{cb(err)}};EmscriptenFile2.prototype.chmodSync=function chmodSync(mode){try{this._FS.fchmod(this._stream.fd,mode)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.utimes=function utimes(atime,mtime,cb){var err=null;try{this.utimesSync(atime,mtime)}catch(e){err=e}finally{cb(err)}};EmscriptenFile2.prototype.utimesSync=function utimesSync(atime,mtime){this._fs.utimesSync(this._path,atime,mtime)};return EmscriptenFile2}(BaseFile);var EmscriptenFileSystem=function(SynchronousFileSystem$$1){function EmscriptenFileSystem2(_FS){SynchronousFileSystem$$1.call(this);this._FS=_FS}if(SynchronousFileSystem$$1)EmscriptenFileSystem2.__proto__=SynchronousFileSystem$$1;EmscriptenFileSystem2.prototype=Object.create(SynchronousFileSystem$$1&&SynchronousFileSystem$$1.prototype);EmscriptenFileSystem2.prototype.constructor=EmscriptenFileSystem2;EmscriptenFileSystem2.Create=function Create(opts,cb){cb(null,new EmscriptenFileSystem2(opts.FS))};EmscriptenFileSystem2.isAvailable=function isAvailable(){return true};EmscriptenFileSystem2.prototype.getName=function getName(){return this._FS.DB_NAME()};EmscriptenFileSystem2.prototype.isReadOnly=function isReadOnly(){return false};EmscriptenFileSystem2.prototype.supportsLinks=function supportsLinks(){return true};EmscriptenFileSystem2.prototype.supportsProps=function supportsProps(){return true};EmscriptenFileSystem2.prototype.supportsSynch=function supportsSynch(){return true};EmscriptenFileSystem2.prototype.renameSync=function renameSync(oldPath,newPath){try{this._FS.rename(oldPath,newPath)}catch(e){if(e.errno===ErrorCode.ENOENT){throw convertError(e,this.existsSync(oldPath)?newPath:oldPath)}else{throw convertError(e)}}};EmscriptenFileSystem2.prototype.statSync=function statSync(p2,isLstat){try{var stats=isLstat?this._FS.lstat(p2):this._FS.stat(p2);var itemType=this.modeToFileType(stats.mode);return new Stats(itemType,stats.size,stats.mode,stats.atime,stats.mtime,stats.ctime)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.openSync=function openSync(p2,flag,mode){try{var stream=this._FS.open(p2,flag.getFlagString(),mode);if(this._FS.isDir(stream.node.mode)){this._FS.close(stream);throw ApiError.EISDIR(p2)}return new EmscriptenFile(this,this._FS,p2,stream)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.unlinkSync=function unlinkSync(p2){try{this._FS.unlink(p2)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.rmdirSync=function rmdirSync(p2){try{this._FS.rmdir(p2)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.mkdirSync=function mkdirSync(p2,mode){try{this._FS.mkdir(p2,mode)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.readdirSync=function readdirSync(p2){try{return this._FS.readdir(p2).filter(function(p22){return p22!=="."&&p22!==".."})}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.truncateSync=function truncateSync(p2,len){try{this._FS.truncate(p2,len)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.readFileSync=function readFileSync(p2,encoding,flag){try{var data=this._FS.readFile(p2,{flags:flag.getFlagString()});var buff=uint8Array2Buffer(data);if(encoding){return buff.toString(encoding)}else{return buff}}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.writeFileSync=function writeFileSync(p2,data,encoding,flag,mode){try{if(encoding){data=Buffer2.from(data,encoding)}var u8=buffer2Uint8array(data);this._FS.writeFile(p2,u8,{flags:flag.getFlagString(),encoding:"binary"});this._FS.chmod(p2,mode)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.chmodSync=function chmodSync(p2,isLchmod,mode){try{isLchmod?this._FS.lchmod(p2,mode):this._FS.chmod(p2,mode)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.chownSync=function chownSync(p2,isLchown,uid,gid){try{isLchown?this._FS.lchown(p2,uid,gid):this._FS.chown(p2,uid,gid)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.symlinkSync=function symlinkSync(srcpath,dstpath,type){try{this._FS.symlink(srcpath,dstpath)}catch(e){throw convertError(e)}};EmscriptenFileSystem2.prototype.readlinkSync=function readlinkSync(p2){try{return this._FS.readlink(p2)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.utimesSync=function utimesSync(p2,atime,mtime){try{this._FS.utime(p2,atime.getTime(),mtime.getTime())}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.modeToFileType=function modeToFileType(mode){if(this._FS.isDir(mode)){return FileType.DIRECTORY}else if(this._FS.isFile(mode)){return FileType.FILE}else if(this._FS.isLink(mode)){return FileType.SYMLINK}else{throw ApiError.EPERM("Invalid mode: "+mode)}};return EmscriptenFileSystem2}(SynchronousFileSystem);EmscriptenFileSystem.Name="EmscriptenFileSystem";EmscriptenFileSystem.Options={FS:{type:"object",description:"The Emscripten file system to use (the `FS` variable)"}};var FolderAdapter=function(BaseFileSystem$$1){function FolderAdapter2(folder,wrapped){BaseFileSystem$$1.call(this);this._folder=folder;this._wrapped=wrapped}if(BaseFileSystem$$1)FolderAdapter2.__proto__=BaseFileSystem$$1;FolderAdapter2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);FolderAdapter2.prototype.constructor=FolderAdapter2;FolderAdapter2.Create=function Create(opts,cb){cb(null,new FolderAdapter2(opts.folder,opts.wrapped))};FolderAdapter2.isAvailable=function isAvailable(){return true};FolderAdapter2.prototype.initialize=function initialize3(cb){var this$1=this;this._wrapped.exists(this._folder,function(exists2){if(exists2){cb()}else if(this$1._wrapped.isReadOnly()){cb(ApiError.ENOENT(this$1._folder))}else{this$1._wrapped.mkdir(this$1._folder,511,cb)}})};FolderAdapter2.prototype.getName=function getName(){return this._wrapped.getName()};FolderAdapter2.prototype.isReadOnly=function isReadOnly(){return this._wrapped.isReadOnly()};FolderAdapter2.prototype.supportsProps=function supportsProps(){return this._wrapped.supportsProps()};FolderAdapter2.prototype.supportsSynch=function supportsSynch(){return this._wrapped.supportsSynch()};FolderAdapter2.prototype.supportsLinks=function supportsLinks(){return false};return FolderAdapter2}(BaseFileSystem);FolderAdapter.Name="FolderAdapter";FolderAdapter.Options={folder:{type:"string",description:"The folder to use as the root directory"},wrapped:{type:"object",description:"The file system to wrap"}};function translateError(folder,e){if(e!==null&&typeof e==="object"){var err=e;var p2=err.path;if(p2){p2="/"+path.relative(folder,p2);err.message=err.message.replace(err.path,p2);err.path=p2}}return e}function wrapCallback(folder,cb){if(typeof cb==="function"){return function(err){if(arguments.length>0){arguments[0]=translateError(folder,err)}cb.apply(null,arguments)}}else{return cb}}function wrapFunction(name2,wrapFirst,wrapSecond){if(name2.slice(name2.length-4)!=="Sync"){return function(){if(arguments.length>0){if(wrapFirst){arguments[0]=path.join(this._folder,arguments[0])}if(wrapSecond){arguments[1]=path.join(this._folder,arguments[1])}arguments[arguments.length-1]=wrapCallback(this._folder,arguments[arguments.length-1])}return this._wrapped[name2].apply(this._wrapped,arguments)}}else{return function(){try{if(wrapFirst){arguments[0]=path.join(this._folder,arguments[0])}if(wrapSecond){arguments[1]=path.join(this._folder,arguments[1])}return this._wrapped[name2].apply(this._wrapped,arguments)}catch(e){throw translateError(this._folder,e)}}}}["diskSpace","stat","statSync","open","openSync","unlink","unlinkSync","rmdir","rmdirSync","mkdir","mkdirSync","readdir","readdirSync","exists","existsSync","realpath","realpathSync","truncate","truncateSync","readFile","readFileSync","writeFile","writeFileSync","appendFile","appendFileSync","chmod","chmodSync","chown","chownSync","utimes","utimesSync","readlink","readlinkSync"].forEach(function(name2){FolderAdapter.prototype[name2]=wrapFunction(name2,true,false)});["rename","renameSync","link","linkSync","symlink","symlinkSync"].forEach(function(name2){FolderAdapter.prototype[name2]=wrapFunction(name2,true,true)});var toExport;if(typeof window!=="undefined"){toExport=window}else if(typeof self!=="undefined"){toExport=self}else{toExport=global2}var global$1=toExport;function isDirectoryEntry(entry){return entry.isDirectory}var _getFS=global$1.webkitRequestFileSystem||global$1.requestFileSystem||null;function _requestQuota(type,size,success,errorCallback){if(typeof navigator["webkitPersistentStorage"]!=="undefined"){switch(type){case global$1.PERSISTENT:navigator.webkitPersistentStorage.requestQuota(size,success,errorCallback);break;case global$1.TEMPORARY:navigator.webkitTemporaryStorage.requestQuota(size,success,errorCallback);break;default:errorCallback(new TypeError("Invalid storage type: "+type));break}}else{global$1.webkitStorageInfo.requestQuota(type,size,success,errorCallback)}}function _toArray(list2){return Array.prototype.slice.call(list2||[],0)}function convertError$1(err,p2,expectedDir){switch(err.name){case"PathExistsError":return ApiError.EEXIST(p2);case"QuotaExceededError":return ApiError.FileError(ErrorCode.ENOSPC,p2);case"NotFoundError":return ApiError.ENOENT(p2);case"SecurityError":return ApiError.FileError(ErrorCode.EACCES,p2);case"InvalidModificationError":return ApiError.FileError(ErrorCode.EPERM,p2);case"TypeMismatchError":return ApiError.FileError(expectedDir?ErrorCode.ENOTDIR:ErrorCode.EISDIR,p2);case"EncodingError":case"InvalidStateError":case"NoModificationAllowedError":default:return ApiError.FileError(ErrorCode.EINVAL,p2)}}var HTML5FSFile=function(PreloadFile$$1){function HTML5FSFile2(fs4,entry,path$$1,flag,stat,contents){PreloadFile$$1.call(this,fs4,path$$1,flag,stat,contents);this._entry=entry}if(PreloadFile$$1)HTML5FSFile2.__proto__=PreloadFile$$1;HTML5FSFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);HTML5FSFile2.prototype.constructor=HTML5FSFile2;HTML5FSFile2.prototype.sync=function sync(cb){var this$1=this;if(!this.isDirty()){return cb()}this._entry.createWriter(function(writer){var buffer$$1=this$1.getBuffer();var blob=new Blob([buffer2ArrayBuffer(buffer$$1)]);var length=blob.size;writer.onwriteend=function(err){writer.onwriteend=null;writer.onerror=null;writer.truncate(length);this$1.resetDirty();cb()};writer.onerror=function(err){cb(convertError$1(err,this$1.getPath(),false))};writer.write(blob)})};HTML5FSFile2.prototype.close=function close(cb){this.sync(cb)};return HTML5FSFile2}(PreloadFile);var HTML5FS=function(BaseFileSystem$$1){function HTML5FS2(size,type,deprecateMsg){if(size===void 0)size=5;if(type===void 0)type=global$1.PERSISTENT;if(deprecateMsg===void 0)deprecateMsg=true;BaseFileSystem$$1.call(this);this.size=1024*1024*size;this.type=type;deprecationMessage(deprecateMsg,HTML5FS2.Name,{size,type})}if(BaseFileSystem$$1)HTML5FS2.__proto__=BaseFileSystem$$1;HTML5FS2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);HTML5FS2.prototype.constructor=HTML5FS2;HTML5FS2.Create=function Create(opts,cb){var fs4=new HTML5FS2(opts.size,opts.type,false);fs4.allocate(function(e){return e?cb(e):cb(null,fs4)},false)};HTML5FS2.isAvailable=function isAvailable(){return!!_getFS};HTML5FS2.prototype.getName=function getName(){return HTML5FS2.Name};HTML5FS2.prototype.isReadOnly=function isReadOnly(){return false};HTML5FS2.prototype.supportsSymlinks=function supportsSymlinks(){return false};HTML5FS2.prototype.supportsProps=function supportsProps(){return false};HTML5FS2.prototype.supportsSynch=function supportsSynch(){return false};HTML5FS2.prototype.allocate=function allocate(cb,deprecateMsg){var this$1=this;if(cb===void 0)cb=function(){};if(deprecateMsg===void 0)deprecateMsg=true;if(deprecateMsg){console.warn("[HTML5FS] HTML5FS.allocate() is deprecated and will be removed in the next major release. Please use \'HTML5FS.Create({type: "+this.type+", size: "+this.size+"}, cb)\' to create and allocate HTML5FS instances.")}var success=function(fs4){this$1.fs=fs4;cb()};var error=function(err){cb(convertError$1(err,"/",true))};if(this.type===global$1.PERSISTENT){_requestQuota(this.type,this.size,function(granted){_getFS(this$1.type,granted,success,error)},error)}else{_getFS(this.type,this.size,success,error)}};HTML5FS2.prototype.empty=function empty(mainCb){this._readdir("/",function(err,entries){if(err){console.error("Failed to empty FS");mainCb(err)}else{var finished=function(er){if(err){console.error("Failed to empty FS");mainCb(err)}else{mainCb()}};var deleteEntry=function(entry,cb){var succ=function(){cb()};var error=function(err2){cb(convertError$1(err2,entry.fullPath,!entry.isDirectory))};if(isDirectoryEntry(entry)){entry.removeRecursively(succ,error)}else{entry.remove(succ,error)}};eachLimit(entries,deleteEntry,finished)}})};HTML5FS2.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;var semaphore=2;var successCount=0;var root2=this.fs.root;var currentPath=oldPath;var error=function(err){if(--semaphore<=0){cb(convertError$1(err,currentPath,false))}};var success=function(file){if(++successCount===2){return cb(new ApiError(ErrorCode.EINVAL,"Something was identified as both a file and a directory. This should never happen."))}if(oldPath===newPath){return cb()}currentPath=path.dirname(newPath);root2.getDirectory(currentPath,{},function(parentDir){currentPath=path.basename(newPath);file.moveTo(parentDir,currentPath,function(entry){cb()},function(err){if(file.isDirectory){currentPath=newPath;this$1.unlink(newPath,function(e){if(e){error(err)}else{this$1.rename(oldPath,newPath,cb)}})}else{error(err)}})},error)};root2.getFile(oldPath,{},success,error);root2.getDirectory(oldPath,{},success,error)};HTML5FS2.prototype.stat=function stat(path$$1,isLstat,cb){var this$1=this;var opts={create:false};var loadAsFile=function(entry){var fileFromEntry=function(file){var stat2=new Stats(FileType.FILE,file.size);cb(null,stat2)};entry.file(fileFromEntry,failedToLoad)};var loadAsDir=function(dir$$1){var size=4096;var stat2=new Stats(FileType.DIRECTORY,size);cb(null,stat2)};var failedToLoad=function(err){cb(convertError$1(err,path$$1,false))};var failedToLoadAsFile=function(){this$1.fs.root.getDirectory(path$$1,opts,loadAsDir,failedToLoad)};this.fs.root.getFile(path$$1,opts,loadAsFile,failedToLoadAsFile)};HTML5FS2.prototype.open=function open(p2,flags,mode,cb){var this$1=this;var error=function(err){if(err.name==="InvalidModificationError"&&flags.isExclusive()){cb(ApiError.EEXIST(p2))}else{cb(convertError$1(err,p2,false))}};this.fs.root.getFile(p2,{create:flags.pathNotExistsAction()===ActionType.CREATE_FILE,exclusive:flags.isExclusive()},function(entry){entry.file(function(file){var reader=new FileReader;reader.onloadend=function(event){var bfsFile=this$1._makeFile(p2,entry,flags,file,reader.result);cb(null,bfsFile)};reader.onerror=function(ev2){error(reader.error)};reader.readAsArrayBuffer(file)},error)},error)};HTML5FS2.prototype.unlink=function unlink(path$$1,cb){this._remove(path$$1,cb,true)};HTML5FS2.prototype.rmdir=function rmdir(path$$1,cb){var this$1=this;this.readdir(path$$1,function(e,files){if(e){cb(e)}else if(files.length>0){cb(ApiError.ENOTEMPTY(path$$1))}else{this$1._remove(path$$1,cb,false)}})};HTML5FS2.prototype.mkdir=function mkdir(path$$1,mode,cb){var opts={create:true,exclusive:true};var success=function(dir$$1){cb()};var error=function(err){cb(convertError$1(err,path$$1,true))};this.fs.root.getDirectory(path$$1,opts,success,error)};HTML5FS2.prototype.readdir=function readdir(path$$1,cb){this._readdir(path$$1,function(e,entries){if(entries){var rv=[];for(var i22=0,list2=entries;i22<list2.length;i22+=1){var entry=list2[i22];rv.push(entry.name)}cb(null,rv)}else{return cb(e)}})};HTML5FS2.prototype._makeFile=function _makeFile(path$$1,entry,flag,stat,data){if(data===void 0)data=new ArrayBuffer(0);var stats=new Stats(FileType.FILE,stat.size);var buffer$$1=arrayBuffer2Buffer(data);return new HTML5FSFile(this,entry,path$$1,flag,stats,buffer$$1)};HTML5FS2.prototype._readdir=function _readdir(path$$1,cb){var error=function(err){cb(convertError$1(err,path$$1,true))};this.fs.root.getDirectory(path$$1,{create:false},function(dirEntry){var reader=dirEntry.createReader();var entries=[];var readEntries=function(){reader.readEntries(function(results){if(results.length){entries=entries.concat(_toArray(results));readEntries()}else{cb(null,entries)}},error)};readEntries()},error)};HTML5FS2.prototype._remove=function _remove(path$$1,cb,isFile){var success=function(entry){var succ=function(){cb()};var err=function(err2){cb(convertError$1(err2,path$$1,!isFile))};entry.remove(succ,err)};var error=function(err){cb(convertError$1(err,path$$1,!isFile))};var opts={create:false};if(isFile){this.fs.root.getFile(path$$1,opts,success,error)}else{this.fs.root.getDirectory(path$$1,opts,success,error)}};return HTML5FS2}(BaseFileSystem);HTML5FS.Name="HTML5FS";HTML5FS.Options={size:{type:"number",optional:true,description:"Storage quota to request, in megabytes. Allocated value may be less. Defaults to 5."},type:{type:"number",optional:true,description:"window.PERSISTENT or window.TEMPORARY. Defaults to PERSISTENT."}};var Inode=function Inode2(id,size,mode,atime,mtime,ctime){this.id=id;this.size=size;this.mode=mode;this.atime=atime;this.mtime=mtime;this.ctime=ctime};Inode.fromBuffer=function fromBuffer(buffer$$1){if(buffer$$1===void 0){throw new Error("NO")}return new Inode(buffer$$1.toString("ascii",30),buffer$$1.readUInt32LE(0),buffer$$1.readUInt16LE(4),buffer$$1.readDoubleLE(6),buffer$$1.readDoubleLE(14),buffer$$1.readDoubleLE(22))};Inode.prototype.toStats=function toStats(){return new Stats((this.mode&61440)===FileType.DIRECTORY?FileType.DIRECTORY:FileType.FILE,this.size,this.mode,new Date(this.atime),new Date(this.mtime),new Date(this.ctime))};Inode.prototype.getSize=function getSize(){return 30+this.id.length};Inode.prototype.toBuffer=function toBuffer(buff){if(buff===void 0)buff=Buffer2.alloc(this.getSize());buff.writeUInt32LE(this.size,0);buff.writeUInt16LE(this.mode,4);buff.writeDoubleLE(this.atime,6);buff.writeDoubleLE(this.mtime,14);buff.writeDoubleLE(this.ctime,22);buff.write(this.id,30,this.id.length,"ascii");return buff};Inode.prototype.update=function update(stats){var hasChanged=false;if(this.size!==stats.size){this.size=stats.size;hasChanged=true}if(this.mode!==stats.mode){this.mode=stats.mode;hasChanged=true}var atimeMs=stats.atime.getTime();if(this.atime!==atimeMs){this.atime=atimeMs;hasChanged=true}var mtimeMs=stats.mtime.getTime();if(this.mtime!==mtimeMs){this.mtime=mtimeMs;hasChanged=true}var ctimeMs=stats.ctime.getTime();if(this.ctime!==ctimeMs){this.ctime=ctimeMs;hasChanged=true}return hasChanged};Inode.prototype.isFile=function isFile(){return(this.mode&61440)===FileType.FILE};Inode.prototype.isDirectory=function isDirectory(){return(this.mode&61440)===FileType.DIRECTORY};var ROOT_NODE_ID="/";var emptyDirNode=null;function getEmptyDirNode(){if(emptyDirNode){return emptyDirNode}return emptyDirNode=Buffer2.from("{}")}function GenerateRandomID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0;var v2=c==="x"?r:r&3|8;return v2.toString(16)})}function noError(e,cb){if(e){cb(e);return false}return true}function noErrorTx(e,tx,cb){if(e){tx.abort(function(){cb(e)});return false}return true}var SimpleSyncRWTransaction=function SimpleSyncRWTransaction2(store){this.store=store;this.originalData={};this.modifiedKeys=[]};SimpleSyncRWTransaction.prototype.get=function get(key){var val=this.store.get(key);this.stashOldValue(key,val);return val};SimpleSyncRWTransaction.prototype.put=function put(key,data,overwrite){this.markModified(key);return this.store.put(key,data,overwrite)};SimpleSyncRWTransaction.prototype.del=function del(key){this.markModified(key);this.store.del(key)};SimpleSyncRWTransaction.prototype.commit=function commit(){};SimpleSyncRWTransaction.prototype.abort=function abort(){var this$1=this;for(var i22=0,list2=this$1.modifiedKeys;i22<list2.length;i22+=1){var key=list2[i22];var value=this$1.originalData[key];if(!value){this$1.store.del(key)}else{this$1.store.put(key,value,true)}}};SimpleSyncRWTransaction.prototype.stashOldValue=function stashOldValue(key,value){if(!this.originalData.hasOwnProperty(key)){this.originalData[key]=value}};SimpleSyncRWTransaction.prototype.markModified=function markModified(key){if(this.modifiedKeys.indexOf(key)===-1){this.modifiedKeys.push(key);if(!this.originalData.hasOwnProperty(key)){this.originalData[key]=this.store.get(key)}}};var SyncKeyValueFile=function(PreloadFile$$1){function SyncKeyValueFile2(_fs,_path,_flag,_stat,contents){PreloadFile$$1.call(this,_fs,_path,_flag,_stat,contents)}if(PreloadFile$$1)SyncKeyValueFile2.__proto__=PreloadFile$$1;SyncKeyValueFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);SyncKeyValueFile2.prototype.constructor=SyncKeyValueFile2;SyncKeyValueFile2.prototype.syncSync=function syncSync(){if(this.isDirty()){this._fs._syncSync(this.getPath(),this.getBuffer(),this.getStats());this.resetDirty()}};SyncKeyValueFile2.prototype.closeSync=function closeSync(){this.syncSync()};return SyncKeyValueFile2}(PreloadFile);var SyncKeyValueFileSystem=function(SynchronousFileSystem$$1){function SyncKeyValueFileSystem2(options){SynchronousFileSystem$$1.call(this);this.store=options.store;this.makeRootDirectory()}if(SynchronousFileSystem$$1)SyncKeyValueFileSystem2.__proto__=SynchronousFileSystem$$1;SyncKeyValueFileSystem2.prototype=Object.create(SynchronousFileSystem$$1&&SynchronousFileSystem$$1.prototype);SyncKeyValueFileSystem2.prototype.constructor=SyncKeyValueFileSystem2;SyncKeyValueFileSystem2.isAvailable=function isAvailable(){return true};SyncKeyValueFileSystem2.prototype.getName=function getName(){return this.store.name()};SyncKeyValueFileSystem2.prototype.isReadOnly=function isReadOnly(){return false};SyncKeyValueFileSystem2.prototype.supportsSymlinks=function supportsSymlinks(){return false};SyncKeyValueFileSystem2.prototype.supportsProps=function supportsProps(){return false};SyncKeyValueFileSystem2.prototype.supportsSynch=function supportsSynch(){return true};SyncKeyValueFileSystem2.prototype.empty=function empty(){this.store.clear();this.makeRootDirectory()};SyncKeyValueFileSystem2.prototype.renameSync=function renameSync(oldPath,newPath){var tx=this.store.beginTransaction("readwrite"),oldParent=path.dirname(oldPath),oldName=path.basename(oldPath),newParent=path.dirname(newPath),newName=path.basename(newPath),oldDirNode=this.findINode(tx,oldParent),oldDirList=this.getDirListing(tx,oldParent,oldDirNode);if(!oldDirList[oldName]){throw ApiError.ENOENT(oldPath)}var nodeId=oldDirList[oldName];delete oldDirList[oldName];if((newParent+"/").indexOf(oldPath+"/")===0){throw new ApiError(ErrorCode.EBUSY,oldParent)}var newDirNode,newDirList;if(newParent===oldParent){newDirNode=oldDirNode;newDirList=oldDirList}else{newDirNode=this.findINode(tx,newParent);newDirList=this.getDirListing(tx,newParent,newDirNode)}if(newDirList[newName]){var newNameNode=this.getINode(tx,newPath,newDirList[newName]);if(newNameNode.isFile()){try{tx.del(newNameNode.id);tx.del(newDirList[newName])}catch(e){tx.abort();throw e}}else{throw ApiError.EPERM(newPath)}}newDirList[newName]=nodeId;try{tx.put(oldDirNode.id,Buffer2.from(JSON.stringify(oldDirList)),true);tx.put(newDirNode.id,Buffer2.from(JSON.stringify(newDirList)),true)}catch(e){tx.abort();throw e}tx.commit()};SyncKeyValueFileSystem2.prototype.statSync=function statSync(p2,isLstat){return this.findINode(this.store.beginTransaction("readonly"),p2).toStats()};SyncKeyValueFileSystem2.prototype.createFileSync=function createFileSync(p2,flag,mode){var tx=this.store.beginTransaction("readwrite"),data=emptyBuffer(),newFile=this.commitNewFile(tx,p2,FileType.FILE,mode,data);return new SyncKeyValueFile(this,p2,flag,newFile.toStats(),data)};SyncKeyValueFileSystem2.prototype.openFileSync=function openFileSync(p2,flag){var tx=this.store.beginTransaction("readonly"),node=this.findINode(tx,p2),data=tx.get(node.id);if(data===void 0){throw ApiError.ENOENT(p2)}return new SyncKeyValueFile(this,p2,flag,node.toStats(),data)};SyncKeyValueFileSystem2.prototype.unlinkSync=function unlinkSync(p2){this.removeEntry(p2,false)};SyncKeyValueFileSystem2.prototype.rmdirSync=function rmdirSync(p2){if(this.readdirSync(p2).length>0){throw ApiError.ENOTEMPTY(p2)}else{this.removeEntry(p2,true)}};SyncKeyValueFileSystem2.prototype.mkdirSync=function mkdirSync(p2,mode){var tx=this.store.beginTransaction("readwrite"),data=Buffer2.from("{}");this.commitNewFile(tx,p2,FileType.DIRECTORY,mode,data)};SyncKeyValueFileSystem2.prototype.readdirSync=function readdirSync(p2){var tx=this.store.beginTransaction("readonly");return Object.keys(this.getDirListing(tx,p2,this.findINode(tx,p2)))};SyncKeyValueFileSystem2.prototype._syncSync=function _syncSync(p2,data,stats){var tx=this.store.beginTransaction("readwrite"),fileInodeId=this._findINode(tx,path.dirname(p2),path.basename(p2)),fileInode=this.getINode(tx,p2,fileInodeId),inodeChanged=fileInode.update(stats);try{tx.put(fileInode.id,data,true);if(inodeChanged){tx.put(fileInodeId,fileInode.toBuffer(),true)}}catch(e){tx.abort();throw e}tx.commit()};SyncKeyValueFileSystem2.prototype.makeRootDirectory=function makeRootDirectory(){var tx=this.store.beginTransaction("readwrite");if(tx.get(ROOT_NODE_ID)===void 0){var currTime=new Date().getTime(),dirInode=new Inode(GenerateRandomID(),4096,511|FileType.DIRECTORY,currTime,currTime,currTime);tx.put(dirInode.id,getEmptyDirNode(),false);tx.put(ROOT_NODE_ID,dirInode.toBuffer(),false);tx.commit()}};SyncKeyValueFileSystem2.prototype._findINode=function _findINode(tx,parent,filename){var this$1=this;var readDirectory=function(inode){var dirList=this$1.getDirListing(tx,parent,inode);if(dirList[filename]){return dirList[filename]}else{throw ApiError.ENOENT(path.resolve(parent,filename))}};if(parent==="/"){if(filename===""){return ROOT_NODE_ID}else{return readDirectory(this.getINode(tx,parent,ROOT_NODE_ID))}}else{return readDirectory(this.getINode(tx,parent+path.sep+filename,this._findINode(tx,path.dirname(parent),path.basename(parent))))}};SyncKeyValueFileSystem2.prototype.findINode=function findINode(tx,p2){return this.getINode(tx,p2,this._findINode(tx,path.dirname(p2),path.basename(p2)))};SyncKeyValueFileSystem2.prototype.getINode=function getINode(tx,p2,id){var inode=tx.get(id);if(inode===void 0){throw ApiError.ENOENT(p2)}return Inode.fromBuffer(inode)};SyncKeyValueFileSystem2.prototype.getDirListing=function getDirListing(tx,p2,inode){if(!inode.isDirectory()){throw ApiError.ENOTDIR(p2)}var data=tx.get(inode.id);if(data===void 0){throw ApiError.ENOENT(p2)}return JSON.parse(data.toString())};SyncKeyValueFileSystem2.prototype.addNewNode=function addNewNode(tx,data){var retries=0;var currId;while(retries<5){try{currId=GenerateRandomID();tx.put(currId,data,false);return currId}catch(e){}}throw new ApiError(ErrorCode.EIO,"Unable to commit data to key-value store.")};SyncKeyValueFileSystem2.prototype.commitNewFile=function commitNewFile(tx,p2,type,mode,data){var parentDir=path.dirname(p2),fname=path.basename(p2),parentNode=this.findINode(tx,parentDir),dirListing=this.getDirListing(tx,parentDir,parentNode),currTime=new Date().getTime();if(p2==="/"){throw ApiError.EEXIST(p2)}if(dirListing[fname]){throw ApiError.EEXIST(p2)}var fileNode;try{var dataId=this.addNewNode(tx,data);fileNode=new Inode(dataId,data.length,mode|type,currTime,currTime,currTime);var fileNodeId=this.addNewNode(tx,fileNode.toBuffer());dirListing[fname]=fileNodeId;tx.put(parentNode.id,Buffer2.from(JSON.stringify(dirListing)),true)}catch(e){tx.abort();throw e}tx.commit();return fileNode};SyncKeyValueFileSystem2.prototype.removeEntry=function removeEntry(p2,isDir){var tx=this.store.beginTransaction("readwrite"),parent=path.dirname(p2),parentNode=this.findINode(tx,parent),parentListing=this.getDirListing(tx,parent,parentNode),fileName=path.basename(p2);if(!parentListing[fileName]){throw ApiError.ENOENT(p2)}var fileNodeId=parentListing[fileName];delete parentListing[fileName];var fileNode=this.getINode(tx,p2,fileNodeId);if(!isDir&&fileNode.isDirectory()){throw ApiError.EISDIR(p2)}else if(isDir&&!fileNode.isDirectory()){throw ApiError.ENOTDIR(p2)}try{tx.del(fileNode.id);tx.del(fileNodeId);tx.put(parentNode.id,Buffer2.from(JSON.stringify(parentListing)),true)}catch(e){tx.abort();throw e}tx.commit()};return SyncKeyValueFileSystem2}(SynchronousFileSystem);var AsyncKeyValueFile=function(PreloadFile$$1){function AsyncKeyValueFile2(_fs,_path,_flag,_stat,contents){PreloadFile$$1.call(this,_fs,_path,_flag,_stat,contents)}if(PreloadFile$$1)AsyncKeyValueFile2.__proto__=PreloadFile$$1;AsyncKeyValueFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);AsyncKeyValueFile2.prototype.constructor=AsyncKeyValueFile2;AsyncKeyValueFile2.prototype.sync=function sync(cb){var this$1=this;if(this.isDirty()){this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),function(e){if(!e){this$1.resetDirty()}cb(e)})}else{cb()}};AsyncKeyValueFile2.prototype.close=function close(cb){this.sync(cb)};return AsyncKeyValueFile2}(PreloadFile);var AsyncKeyValueFileSystem=function(BaseFileSystem$$1){function AsyncKeyValueFileSystem2(){BaseFileSystem$$1.apply(this,arguments)}if(BaseFileSystem$$1)AsyncKeyValueFileSystem2.__proto__=BaseFileSystem$$1;AsyncKeyValueFileSystem2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);AsyncKeyValueFileSystem2.prototype.constructor=AsyncKeyValueFileSystem2;AsyncKeyValueFileSystem2.isAvailable=function isAvailable(){return true};AsyncKeyValueFileSystem2.prototype.init=function init(store,cb){this.store=store;this.makeRootDirectory(cb)};AsyncKeyValueFileSystem2.prototype.getName=function getName(){return this.store.name()};AsyncKeyValueFileSystem2.prototype.isReadOnly=function isReadOnly(){return false};AsyncKeyValueFileSystem2.prototype.supportsSymlinks=function supportsSymlinks(){return false};AsyncKeyValueFileSystem2.prototype.supportsProps=function supportsProps(){return false};AsyncKeyValueFileSystem2.prototype.supportsSynch=function supportsSynch(){return false};AsyncKeyValueFileSystem2.prototype.empty=function empty(cb){var this$1=this;this.store.clear(function(e){if(noError(e,cb)){this$1.makeRootDirectory(cb)}})};AsyncKeyValueFileSystem2.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;var tx=this.store.beginTransaction("readwrite");var oldParent=path.dirname(oldPath),oldName=path.basename(oldPath);var newParent=path.dirname(newPath),newName=path.basename(newPath);var inodes={};var lists={};var errorOccurred=false;if((newParent+"/").indexOf(oldPath+"/")===0){return cb(new ApiError(ErrorCode.EBUSY,oldParent))}var theOleSwitcharoo=function(){if(errorOccurred||!lists.hasOwnProperty(oldParent)||!lists.hasOwnProperty(newParent)){return}var oldParentList=lists[oldParent],oldParentINode=inodes[oldParent],newParentList=lists[newParent],newParentINode=inodes[newParent];if(!oldParentList[oldName]){cb(ApiError.ENOENT(oldPath))}else{var fileId=oldParentList[oldName];delete oldParentList[oldName];var completeRename=function(){newParentList[newName]=fileId;tx.put(oldParentINode.id,Buffer2.from(JSON.stringify(oldParentList)),true,function(e){if(noErrorTx(e,tx,cb)){if(oldParent===newParent){tx.commit(cb)}else{tx.put(newParentINode.id,Buffer2.from(JSON.stringify(newParentList)),true,function(e2){if(noErrorTx(e2,tx,cb)){tx.commit(cb)}})}}})};if(newParentList[newName]){this$1.getINode(tx,newPath,newParentList[newName],function(e,inode){if(noErrorTx(e,tx,cb)){if(inode.isFile()){tx.del(inode.id,function(e2){if(noErrorTx(e2,tx,cb)){tx.del(newParentList[newName],function(e3){if(noErrorTx(e3,tx,cb)){completeRename()}})}})}else{tx.abort(function(e2){cb(ApiError.EPERM(newPath))})}}})}else{completeRename()}}};var processInodeAndListings=function(p2){this$1.findINodeAndDirListing(tx,p2,function(e,node,dirList){if(e){if(!errorOccurred){errorOccurred=true;tx.abort(function(){cb(e)})}}else{inodes[p2]=node;lists[p2]=dirList;theOleSwitcharoo()}})};processInodeAndListings(oldParent);if(oldParent!==newParent){processInodeAndListings(newParent)}};AsyncKeyValueFileSystem2.prototype.stat=function stat(p2,isLstat,cb){var tx=this.store.beginTransaction("readonly");this.findINode(tx,p2,function(e,inode){if(noError(e,cb)){cb(null,inode.toStats())}})};AsyncKeyValueFileSystem2.prototype.createFile=function createFile(p2,flag,mode,cb){var this$1=this;var tx=this.store.beginTransaction("readwrite"),data=emptyBuffer();this.commitNewFile(tx,p2,FileType.FILE,mode,data,function(e,newFile){if(noError(e,cb)){cb(null,new AsyncKeyValueFile(this$1,p2,flag,newFile.toStats(),data))}})};AsyncKeyValueFileSystem2.prototype.openFile=function openFile(p2,flag,cb){var this$1=this;var tx=this.store.beginTransaction("readonly");this.findINode(tx,p2,function(e,inode){if(noError(e,cb)){tx.get(inode.id,function(e2,data){if(noError(e2,cb)){if(data===void 0){cb(ApiError.ENOENT(p2))}else{cb(null,new AsyncKeyValueFile(this$1,p2,flag,inode.toStats(),data))}}})}})};AsyncKeyValueFileSystem2.prototype.unlink=function unlink(p2,cb){this.removeEntry(p2,false,cb)};AsyncKeyValueFileSystem2.prototype.rmdir=function rmdir(p2,cb){var this$1=this;this.readdir(p2,function(err,files){if(err){cb(err)}else if(files.length>0){cb(ApiError.ENOTEMPTY(p2))}else{this$1.removeEntry(p2,true,cb)}})};AsyncKeyValueFileSystem2.prototype.mkdir=function mkdir(p2,mode,cb){var tx=this.store.beginTransaction("readwrite"),data=Buffer2.from("{}");this.commitNewFile(tx,p2,FileType.DIRECTORY,mode,data,cb)};AsyncKeyValueFileSystem2.prototype.readdir=function readdir(p2,cb){var this$1=this;var tx=this.store.beginTransaction("readonly");this.findINode(tx,p2,function(e,inode){if(noError(e,cb)){this$1.getDirListing(tx,p2,inode,function(e2,dirListing){if(noError(e2,cb)){cb(null,Object.keys(dirListing))}})}})};AsyncKeyValueFileSystem2.prototype._sync=function _sync(p2,data,stats,cb){var this$1=this;var tx=this.store.beginTransaction("readwrite");this._findINode(tx,path.dirname(p2),path.basename(p2),function(e,fileInodeId){if(noErrorTx(e,tx,cb)){this$1.getINode(tx,p2,fileInodeId,function(e2,fileInode){if(noErrorTx(e2,tx,cb)){var inodeChanged=fileInode.update(stats);tx.put(fileInode.id,data,true,function(e3){if(noErrorTx(e3,tx,cb)){if(inodeChanged){tx.put(fileInodeId,fileInode.toBuffer(),true,function(e4){if(noErrorTx(e4,tx,cb)){tx.commit(cb)}})}else{tx.commit(cb)}}})}})}})};AsyncKeyValueFileSystem2.prototype.makeRootDirectory=function makeRootDirectory(cb){var tx=this.store.beginTransaction("readwrite");tx.get(ROOT_NODE_ID,function(e,data){if(e||data===void 0){var currTime=new Date().getTime(),dirInode=new Inode(GenerateRandomID(),4096,511|FileType.DIRECTORY,currTime,currTime,currTime);tx.put(dirInode.id,getEmptyDirNode(),false,function(e2){if(noErrorTx(e2,tx,cb)){tx.put(ROOT_NODE_ID,dirInode.toBuffer(),false,function(e3){if(e3){tx.abort(function(){cb(e3)})}else{tx.commit(cb)}})}})}else{tx.commit(cb)}})};AsyncKeyValueFileSystem2.prototype._findINode=function _findINode(tx,parent,filename,cb){var this$1=this;var handleDirectoryListings=function(e,inode,dirList){if(e){cb(e)}else if(dirList[filename]){cb(null,dirList[filename])}else{cb(ApiError.ENOENT(path.resolve(parent,filename)))}};if(parent==="/"){if(filename===""){cb(null,ROOT_NODE_ID)}else{this.getINode(tx,parent,ROOT_NODE_ID,function(e,inode){if(noError(e,cb)){this$1.getDirListing(tx,parent,inode,function(e2,dirList){handleDirectoryListings(e2,inode,dirList)})}})}}else{this.findINodeAndDirListing(tx,parent,handleDirectoryListings)}};AsyncKeyValueFileSystem2.prototype.findINode=function findINode(tx,p2,cb){var this$1=this;this._findINode(tx,path.dirname(p2),path.basename(p2),function(e,id){if(noError(e,cb)){this$1.getINode(tx,p2,id,cb)}})};AsyncKeyValueFileSystem2.prototype.getINode=function getINode(tx,p2,id,cb){tx.get(id,function(e,data){if(noError(e,cb)){if(data===void 0){cb(ApiError.ENOENT(p2))}else{cb(null,Inode.fromBuffer(data))}}})};AsyncKeyValueFileSystem2.prototype.getDirListing=function getDirListing(tx,p2,inode,cb){if(!inode.isDirectory()){cb(ApiError.ENOTDIR(p2))}else{tx.get(inode.id,function(e,data){if(noError(e,cb)){try{cb(null,JSON.parse(data.toString()))}catch(e2){cb(ApiError.ENOENT(p2))}}})}};AsyncKeyValueFileSystem2.prototype.findINodeAndDirListing=function findINodeAndDirListing(tx,p2,cb){var this$1=this;this.findINode(tx,p2,function(e,inode){if(noError(e,cb)){this$1.getDirListing(tx,p2,inode,function(e2,listing){if(noError(e2,cb)){cb(null,inode,listing)}})}})};AsyncKeyValueFileSystem2.prototype.addNewNode=function addNewNode(tx,data,cb){var retries=0,currId;var reroll=function(){if(++retries===5){cb(new ApiError(ErrorCode.EIO,"Unable to commit data to key-value store."))}else{currId=GenerateRandomID();tx.put(currId,data,false,function(e,committed){if(e||!committed){reroll()}else{cb(null,currId)}})}};reroll()};AsyncKeyValueFileSystem2.prototype.commitNewFile=function commitNewFile(tx,p2,type,mode,data,cb){var this$1=this;var parentDir=path.dirname(p2),fname=path.basename(p2),currTime=new Date().getTime();if(p2==="/"){return cb(ApiError.EEXIST(p2))}this.findINodeAndDirListing(tx,parentDir,function(e,parentNode,dirListing){if(noErrorTx(e,tx,cb)){if(dirListing[fname]){tx.abort(function(){cb(ApiError.EEXIST(p2))})}else{this$1.addNewNode(tx,data,function(e2,dataId){if(noErrorTx(e2,tx,cb)){var fileInode=new Inode(dataId,data.length,mode|type,currTime,currTime,currTime);this$1.addNewNode(tx,fileInode.toBuffer(),function(e3,fileInodeId){if(noErrorTx(e3,tx,cb)){dirListing[fname]=fileInodeId;tx.put(parentNode.id,Buffer2.from(JSON.stringify(dirListing)),true,function(e4){if(noErrorTx(e4,tx,cb)){tx.commit(function(e5){if(noErrorTx(e5,tx,cb)){cb(null,fileInode)}})}})}})}})}}})};AsyncKeyValueFileSystem2.prototype.removeEntry=function removeEntry(p2,isDir,cb){var this$1=this;var tx=this.store.beginTransaction("readwrite"),parent=path.dirname(p2),fileName=path.basename(p2);this.findINodeAndDirListing(tx,parent,function(e,parentNode,parentListing){if(noErrorTx(e,tx,cb)){if(!parentListing[fileName]){tx.abort(function(){cb(ApiError.ENOENT(p2))})}else{var fileNodeId=parentListing[fileName];delete parentListing[fileName];this$1.getINode(tx,p2,fileNodeId,function(e2,fileNode){if(noErrorTx(e2,tx,cb)){if(!isDir&&fileNode.isDirectory()){tx.abort(function(){cb(ApiError.EISDIR(p2))})}else if(isDir&&!fileNode.isDirectory()){tx.abort(function(){cb(ApiError.ENOTDIR(p2))})}else{tx.del(fileNode.id,function(e3){if(noErrorTx(e3,tx,cb)){tx.del(fileNodeId,function(e4){if(noErrorTx(e4,tx,cb)){tx.put(parentNode.id,Buffer2.from(JSON.stringify(parentListing)),true,function(e5){if(noErrorTx(e5,tx,cb)){tx.commit(cb)}})}})}})}}})}}})};return AsyncKeyValueFileSystem2}(BaseFileSystem);var InMemoryStore=function InMemoryStore2(){this.store={}};InMemoryStore.prototype.name=function name2(){return InMemoryFileSystem.Name};InMemoryStore.prototype.clear=function clear(){this.store={}};InMemoryStore.prototype.beginTransaction=function beginTransaction(type){return new SimpleSyncRWTransaction(this)};InMemoryStore.prototype.get=function get(key){return this.store[key]};InMemoryStore.prototype.put=function put(key,data,overwrite){if(!overwrite&&this.store.hasOwnProperty(key)){return false}this.store[key]=data;return true};InMemoryStore.prototype.del=function del(key){delete this.store[key]};var InMemoryFileSystem=function(SyncKeyValueFileSystem$$1){function InMemoryFileSystem2(){SyncKeyValueFileSystem$$1.call(this,{store:new InMemoryStore})}if(SyncKeyValueFileSystem$$1)InMemoryFileSystem2.__proto__=SyncKeyValueFileSystem$$1;InMemoryFileSystem2.prototype=Object.create(SyncKeyValueFileSystem$$1&&SyncKeyValueFileSystem$$1.prototype);InMemoryFileSystem2.prototype.constructor=InMemoryFileSystem2;InMemoryFileSystem2.Create=function Create(options,cb){cb(null,new InMemoryFileSystem2)};return InMemoryFileSystem2}(SyncKeyValueFileSystem);InMemoryFileSystem.Name="InMemory";InMemoryFileSystem.Options={};var indexedDB=global$1.indexedDB||global$1.mozIndexedDB||global$1.webkitIndexedDB||global$1.msIndexedDB;function convertError$2(e,message){if(message===void 0)message=e.toString();switch(e.name){case"NotFoundError":return new ApiError(ErrorCode.ENOENT,message);case"QuotaExceededError":return new ApiError(ErrorCode.ENOSPC,message);default:return new ApiError(ErrorCode.EIO,message)}}function onErrorHandler(cb,code,message){if(code===void 0)code=ErrorCode.EIO;if(message===void 0)message=null;return function(e){e.preventDefault();cb(new ApiError(code,message!==null?message:void 0))}}var IndexedDBROTransaction=function IndexedDBROTransaction2(tx,store){this.tx=tx;this.store=store};IndexedDBROTransaction.prototype.get=function get(key,cb){try{var r=this.store.get(key);r.onerror=onErrorHandler(cb);r.onsuccess=function(event){var result=event.target.result;if(result===void 0){cb(null,result)}else{cb(null,arrayBuffer2Buffer(result))}}}catch(e){cb(convertError$2(e))}};var IndexedDBRWTransaction=function(IndexedDBROTransaction2){function IndexedDBRWTransaction2(tx,store){IndexedDBROTransaction2.call(this,tx,store)}if(IndexedDBROTransaction2)IndexedDBRWTransaction2.__proto__=IndexedDBROTransaction2;IndexedDBRWTransaction2.prototype=Object.create(IndexedDBROTransaction2&&IndexedDBROTransaction2.prototype);IndexedDBRWTransaction2.prototype.constructor=IndexedDBRWTransaction2;IndexedDBRWTransaction2.prototype.put=function put(key,data,overwrite,cb){try{var arraybuffer=buffer2ArrayBuffer(data);var r;if(overwrite){r=this.store.put(arraybuffer,key)}else{r=this.store.add(arraybuffer,key)}r.onerror=onErrorHandler(cb);r.onsuccess=function(event){cb(null,true)}}catch(e){cb(convertError$2(e))}};IndexedDBRWTransaction2.prototype.del=function del(key,cb){try{var r=this.store["delete"](key);r.onerror=onErrorHandler(cb);r.onsuccess=function(event){cb()}}catch(e){cb(convertError$2(e))}};IndexedDBRWTransaction2.prototype.commit=function commit(cb){setTimeout(cb,0)};IndexedDBRWTransaction2.prototype.abort=function abort(cb){var _e=null;try{this.tx.abort()}catch(e){_e=convertError$2(e)}finally{cb(_e)}};return IndexedDBRWTransaction2}(IndexedDBROTransaction);var IndexedDBStore=function IndexedDBStore2(cb,storeName){var this$1=this;if(storeName===void 0)storeName="browserfs";this.storeName=storeName;var openReq=indexedDB.open(this.storeName,1);openReq.onupgradeneeded=function(event){var db=event.target.result;if(db.objectStoreNames.contains(this$1.storeName)){db.deleteObjectStore(this$1.storeName)}db.createObjectStore(this$1.storeName)};openReq.onsuccess=function(event){this$1.db=event.target.result;cb(null,this$1)};openReq.onerror=onErrorHandler(cb,ErrorCode.EACCES)};IndexedDBStore.prototype.name=function name2(){return IndexedDBFileSystem.Name+" - "+this.storeName};IndexedDBStore.prototype.clear=function clear(cb){try{var tx=this.db.transaction(this.storeName,"readwrite"),objectStore=tx.objectStore(this.storeName),r=objectStore.clear();r.onsuccess=function(event){setTimeout(cb,0)};r.onerror=onErrorHandler(cb)}catch(e){cb(convertError$2(e))}};IndexedDBStore.prototype.beginTransaction=function beginTransaction(type){if(type===void 0)type="readonly";var tx=this.db.transaction(this.storeName,type),objectStore=tx.objectStore(this.storeName);if(type==="readwrite"){return new IndexedDBRWTransaction(tx,objectStore)}else if(type==="readonly"){return new IndexedDBROTransaction(tx,objectStore)}else{throw new ApiError(ErrorCode.EINVAL,"Invalid transaction type.")}};var IndexedDBFileSystem=function(AsyncKeyValueFileSystem$$1){function IndexedDBFileSystem2(cb,storeName,deprecateMsg){var this$1=this;if(deprecateMsg===void 0)deprecateMsg=true;AsyncKeyValueFileSystem$$1.call(this);this.store=new IndexedDBStore(function(e){if(e){cb(e)}else{this$1.init(this$1.store,function(e2){cb(e2,this$1)})}},storeName);deprecationMessage(deprecateMsg,IndexedDBFileSystem2.Name,{storeName})}if(AsyncKeyValueFileSystem$$1)IndexedDBFileSystem2.__proto__=AsyncKeyValueFileSystem$$1;IndexedDBFileSystem2.prototype=Object.create(AsyncKeyValueFileSystem$$1&&AsyncKeyValueFileSystem$$1.prototype);IndexedDBFileSystem2.prototype.constructor=IndexedDBFileSystem2;IndexedDBFileSystem2.Create=function Create(opts,cb){new IndexedDBFileSystem2(cb,opts.storeName,false)};IndexedDBFileSystem2.isAvailable=function isAvailable(){try{return typeof indexedDB!=="undefined"&&null!==indexedDB.open("__browserfs_test__")}catch(e){return false}};return IndexedDBFileSystem2}(AsyncKeyValueFileSystem);IndexedDBFileSystem.Name="IndexedDB";IndexedDBFileSystem.Options={storeName:{type:"string",optional:true,description:"The name of this file system. You can have multiple IndexedDB file systems operating at once, but each must have a different name."}};var supportsBinaryString=false;var binaryEncoding;try{global$1.localStorage.setItem("__test__",String.fromCharCode(55296));supportsBinaryString=global$1.localStorage.getItem("__test__")===String.fromCharCode(55296)}catch(e){supportsBinaryString=false}binaryEncoding=supportsBinaryString?"binary_string":"binary_string_ie";if(!Buffer2.isEncoding(binaryEncoding)){binaryEncoding="base64"}var LocalStorageStore=function LocalStorageStore2(){};LocalStorageStore.prototype.name=function name2(){return LocalStorageFileSystem.Name};LocalStorageStore.prototype.clear=function clear(){global$1.localStorage.clear()};LocalStorageStore.prototype.beginTransaction=function beginTransaction(type){return new SimpleSyncRWTransaction(this)};LocalStorageStore.prototype.get=function get(key){try{var data=global$1.localStorage.getItem(key);if(data!==null){return Buffer2.from(data,binaryEncoding)}}catch(e){}return void 0};LocalStorageStore.prototype.put=function put(key,data,overwrite){try{if(!overwrite&&global$1.localStorage.getItem(key)!==null){return false}global$1.localStorage.setItem(key,data.toString(binaryEncoding));return true}catch(e){throw new ApiError(ErrorCode.ENOSPC,"LocalStorage is full.")}};LocalStorageStore.prototype.del=function del(key){try{global$1.localStorage.removeItem(key)}catch(e){throw new ApiError(ErrorCode.EIO,"Unable to delete key "+key+": "+e)}};var LocalStorageFileSystem=function(SyncKeyValueFileSystem$$1){function LocalStorageFileSystem2(){SyncKeyValueFileSystem$$1.call(this,{store:new LocalStorageStore})}if(SyncKeyValueFileSystem$$1)LocalStorageFileSystem2.__proto__=SyncKeyValueFileSystem$$1;LocalStorageFileSystem2.prototype=Object.create(SyncKeyValueFileSystem$$1&&SyncKeyValueFileSystem$$1.prototype);LocalStorageFileSystem2.prototype.constructor=LocalStorageFileSystem2;LocalStorageFileSystem2.Create=function Create(options,cb){cb(null,new LocalStorageFileSystem2)};LocalStorageFileSystem2.isAvailable=function isAvailable(){return typeof global$1.localStorage!=="undefined"};return LocalStorageFileSystem2}(SyncKeyValueFileSystem);LocalStorageFileSystem.Name="LocalStorage";LocalStorageFileSystem.Options={};var MountableFileSystem=function(BaseFileSystem$$1){function MountableFileSystem2(){BaseFileSystem$$1.call(this);this.mountList=[];this.mntMap={};this.rootFs=new InMemoryFileSystem}if(BaseFileSystem$$1)MountableFileSystem2.__proto__=BaseFileSystem$$1;MountableFileSystem2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);MountableFileSystem2.prototype.constructor=MountableFileSystem2;MountableFileSystem2.Create=function Create(opts,cb){var fs4=new MountableFileSystem2;Object.keys(opts).forEach(function(mountPoint){fs4.mount(mountPoint,opts[mountPoint])});cb(null,fs4)};MountableFileSystem2.isAvailable=function isAvailable(){return true};MountableFileSystem2.prototype.mount=function mount(mountPoint,fs4){if(mountPoint[0]!=="/"){mountPoint="/"+mountPoint}mountPoint=path.resolve(mountPoint);if(this.mntMap[mountPoint]){throw new ApiError(ErrorCode.EINVAL,"Mount point "+mountPoint+" is already taken.")}mkdirpSync(mountPoint,511,this.rootFs);this.mntMap[mountPoint]=fs4;this.mountList.push(mountPoint);this.mountList=this.mountList.sort(function(a,b){return b.length-a.length})};MountableFileSystem2.prototype.umount=function umount(mountPoint){var this$1=this;if(mountPoint[0]!=="/"){mountPoint="/"+mountPoint}mountPoint=path.resolve(mountPoint);if(!this.mntMap[mountPoint]){throw new ApiError(ErrorCode.EINVAL,"Mount point "+mountPoint+" is already unmounted.")}delete this.mntMap[mountPoint];this.mountList.splice(this.mountList.indexOf(mountPoint),1);while(mountPoint!=="/"){if(this$1.rootFs.readdirSync(mountPoint).length===0){this$1.rootFs.rmdirSync(mountPoint);mountPoint=path.dirname(mountPoint)}else{break}}};MountableFileSystem2.prototype._getFs=function _getFs(path$$1){var this$1=this;var mountList=this.mountList,len=mountList.length;for(var i22=0;i22<len;i22++){var mountPoint=mountList[i22];if(mountPoint.length<=path$$1.length&&path$$1.indexOf(mountPoint)===0){path$$1=path$$1.substr(mountPoint.length>1?mountPoint.length:0);if(path$$1===""){path$$1="/"}return{fs:this$1.mntMap[mountPoint],path:path$$1}}}return{fs:this.rootFs,path:path$$1}};MountableFileSystem2.prototype.getName=function getName(){return MountableFileSystem2.Name};MountableFileSystem2.prototype.diskSpace=function diskSpace(path$$1,cb){cb(0,0)};MountableFileSystem2.prototype.isReadOnly=function isReadOnly(){return false};MountableFileSystem2.prototype.supportsLinks=function supportsLinks(){return false};MountableFileSystem2.prototype.supportsProps=function supportsProps(){return false};MountableFileSystem2.prototype.supportsSynch=function supportsSynch(){return true};MountableFileSystem2.prototype.standardizeError=function standardizeError(err,path$$1,realPath){var index=err.message.indexOf(path$$1);if(index!==-1){err.message=err.message.substr(0,index)+realPath+err.message.substr(index+path$$1.length);err.path=realPath}return err};MountableFileSystem2.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;var fs1rv=this._getFs(oldPath);var fs2rv=this._getFs(newPath);if(fs1rv.fs===fs2rv.fs){return fs1rv.fs.rename(fs1rv.path,fs2rv.path,function(e){if(e){this$1.standardizeError(this$1.standardizeError(e,fs1rv.path,oldPath),fs2rv.path,newPath)}cb(e)})}return _fsMock.readFile(oldPath,function(err,data){if(err){return cb(err)}_fsMock.writeFile(newPath,data,function(err2){if(err2){return cb(err2)}_fsMock.unlink(oldPath,cb)})})};MountableFileSystem2.prototype.renameSync=function renameSync(oldPath,newPath){var fs1rv=this._getFs(oldPath);var fs2rv=this._getFs(newPath);if(fs1rv.fs===fs2rv.fs){try{return fs1rv.fs.renameSync(fs1rv.path,fs2rv.path)}catch(e){this.standardizeError(this.standardizeError(e,fs1rv.path,oldPath),fs2rv.path,newPath);throw e}}var data=_fsMock.readFileSync(oldPath);_fsMock.writeFileSync(newPath,data);return _fsMock.unlinkSync(oldPath)};MountableFileSystem2.prototype.readdirSync=function readdirSync(p2){var fsInfo=this._getFs(p2);var rv=null;if(fsInfo.fs!==this.rootFs){try{rv=this.rootFs.readdirSync(p2)}catch(e){}}try{var rv2=fsInfo.fs.readdirSync(fsInfo.path);if(rv===null){return rv2}else{return rv2.concat(rv.filter(function(val){return rv2.indexOf(val)===-1}))}}catch(e){if(rv===null){throw this.standardizeError(e,fsInfo.path,p2)}else{return rv}}};MountableFileSystem2.prototype.readdir=function readdir(p2,cb){var this$1=this;var fsInfo=this._getFs(p2);fsInfo.fs.readdir(fsInfo.path,function(err,files){if(fsInfo.fs!==this$1.rootFs){try{var rv=this$1.rootFs.readdirSync(p2);if(files){files=files.concat(rv.filter(function(val){return files.indexOf(val)===-1}))}else{files=rv}}catch(e){if(err){return cb(this$1.standardizeError(err,fsInfo.path,p2))}}}else if(err){return cb(this$1.standardizeError(err,fsInfo.path,p2))}cb(null,files)})};MountableFileSystem2.prototype.rmdirSync=function rmdirSync(p2){var fsInfo=this._getFs(p2);if(this._containsMountPt(p2)){throw ApiError.ENOTEMPTY(p2)}else{try{fsInfo.fs.rmdirSync(fsInfo.path)}catch(e){throw this.standardizeError(e,fsInfo.path,p2)}}};MountableFileSystem2.prototype.rmdir=function rmdir(p2,cb){var this$1=this;var fsInfo=this._getFs(p2);if(this._containsMountPt(p2)){cb(ApiError.ENOTEMPTY(p2))}else{fsInfo.fs.rmdir(fsInfo.path,function(err){cb(err?this$1.standardizeError(err,fsInfo.path,p2):null)})}};MountableFileSystem2.prototype._containsMountPt=function _containsMountPt(p2){var mountPoints=this.mountList,len=mountPoints.length;for(var i22=0;i22<len;i22++){var pt=mountPoints[i22];if(pt.length>=p2.length&&pt.slice(0,p2.length)===p2){return true}}return false};return MountableFileSystem2}(BaseFileSystem);MountableFileSystem.Name="MountableFileSystem";MountableFileSystem.Options={};function defineFcn(name2,isSync,numArgs){if(isSync){return function(){var args=[],len=arguments.length;while(len--)args[len]=arguments[len];var path$$1=args[0];var rv=this._getFs(path$$1);args[0]=rv.path;try{return rv.fs[name2].apply(rv.fs,args)}catch(e){this.standardizeError(e,rv.path,path$$1);throw e}}}else{return function(){var this$1=this;var args=[],len=arguments.length;while(len--)args[len]=arguments[len];var path$$1=args[0];var rv=this._getFs(path$$1);args[0]=rv.path;if(typeof args[args.length-1]==="function"){var cb=args[args.length-1];args[args.length-1]=function(){var args2=[],len2=arguments.length;while(len2--)args2[len2]=arguments[len2];if(args2.length>0&&args2[0]instanceof ApiError){this$1.standardizeError(args2[0],rv.path,path$$1)}cb.apply(null,args2)}}return rv.fs[name2].apply(rv.fs,args)}}}var fsCmdMap=[["exists","unlink","readlink"],["stat","mkdir","realpath","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]];for(var i3=0;i3<fsCmdMap.length;i3++){var cmds=fsCmdMap[i3];for(var i$1=0,list=cmds;i$1<list.length;i$1+=1){var fnName=list[i$1];MountableFileSystem.prototype[fnName]=defineFcn(fnName,false,i3+1);MountableFileSystem.prototype[fnName+"Sync"]=defineFcn(fnName+"Sync",true,i3+1)}}var bfsSetImmediate;if(typeof setImmediate!=="undefined"){bfsSetImmediate=setImmediate}else{var gScope=global$1;var timeouts=[];var messageName="zero-timeout-message";var canUsePostMessage=function(){if(typeof gScope.importScripts!=="undefined"||!gScope.postMessage){return false}var postMessageIsAsync=true;var oldOnMessage=gScope.onmessage;gScope.onmessage=function(){postMessageIsAsync=false};gScope.postMessage("","*");gScope.onmessage=oldOnMessage;return postMessageIsAsync};if(canUsePostMessage()){bfsSetImmediate=function(fn){timeouts.push(fn);gScope.postMessage(messageName,"*")};var handleMessage=function(event){if(event.source===self&&event.data===messageName){if(event.stopPropagation){event.stopPropagation()}else{event.cancelBubble=true}if(timeouts.length>0){var fn=timeouts.shift();return fn()}}};if(gScope.addEventListener){gScope.addEventListener("message",handleMessage,true)}else{gScope.attachEvent("onmessage",handleMessage)}}else if(gScope.MessageChannel){var channel=new gScope.MessageChannel;channel.port1.onmessage=function(event){if(timeouts.length>0){return timeouts.shift()()}};bfsSetImmediate=function(fn){timeouts.push(fn);channel.port2.postMessage("")}}else{bfsSetImmediate=function(fn){return setTimeout(fn,0)}}}var setImmediate$3=bfsSetImmediate;var Mutex=function Mutex2(){this._locked=false;this._waiters=[]};Mutex.prototype.lock=function lock(cb){if(this._locked){this._waiters.push(cb);return}this._locked=true;cb()};Mutex.prototype.unlock=function unlock(){if(!this._locked){throw new Error("unlock of a non-locked mutex")}var next=this._waiters.shift();if(next){setImmediate$3(next);return}this._locked=false};Mutex.prototype.tryLock=function tryLock(){if(this._locked){return false}this._locked=true;return true};Mutex.prototype.isLocked=function isLocked(){return this._locked};var LockedFS=function LockedFS2(fs4){this._fs=fs4;this._mu=new Mutex};LockedFS.prototype.getName=function getName(){return"LockedFS<"+this._fs.getName()+">"};LockedFS.prototype.getFSUnlocked=function getFSUnlocked(){return this._fs};LockedFS.prototype.initialize=function initialize3(cb){this._fs.initialize(cb)};LockedFS.prototype.diskSpace=function diskSpace(p2,cb){this._fs.diskSpace(p2,cb)};LockedFS.prototype.isReadOnly=function isReadOnly(){return this._fs.isReadOnly()};LockedFS.prototype.supportsLinks=function supportsLinks(){return this._fs.supportsLinks()};LockedFS.prototype.supportsProps=function supportsProps(){return this._fs.supportsProps()};LockedFS.prototype.supportsSynch=function supportsSynch(){return this._fs.supportsSynch()};LockedFS.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;this._mu.lock(function(){this$1._fs.rename(oldPath,newPath,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.renameSync=function renameSync(oldPath,newPath){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.renameSync(oldPath,newPath)};LockedFS.prototype.stat=function stat(p2,isLstat,cb){var this$1=this;this._mu.lock(function(){this$1._fs.stat(p2,isLstat,function(err,stat2){this$1._mu.unlock();cb(err,stat2)})})};LockedFS.prototype.statSync=function statSync(p2,isLstat){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.statSync(p2,isLstat)};LockedFS.prototype.open=function open(p2,flag,mode,cb){var this$1=this;this._mu.lock(function(){this$1._fs.open(p2,flag,mode,function(err,fd){this$1._mu.unlock();cb(err,fd)})})};LockedFS.prototype.openSync=function openSync(p2,flag,mode){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.openSync(p2,flag,mode)};LockedFS.prototype.unlink=function unlink(p2,cb){var this$1=this;this._mu.lock(function(){this$1._fs.unlink(p2,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.unlinkSync=function unlinkSync(p2){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.unlinkSync(p2)};LockedFS.prototype.rmdir=function rmdir(p2,cb){var this$1=this;this._mu.lock(function(){this$1._fs.rmdir(p2,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.rmdirSync=function rmdirSync(p2){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.rmdirSync(p2)};LockedFS.prototype.mkdir=function mkdir(p2,mode,cb){var this$1=this;this._mu.lock(function(){this$1._fs.mkdir(p2,mode,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.mkdirSync=function mkdirSync(p2,mode){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.mkdirSync(p2,mode)};LockedFS.prototype.readdir=function readdir(p2,cb){var this$1=this;this._mu.lock(function(){this$1._fs.readdir(p2,function(err,files){this$1._mu.unlock();cb(err,files)})})};LockedFS.prototype.readdirSync=function readdirSync(p2){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.readdirSync(p2)};LockedFS.prototype.exists=function exists2(p2,cb){var this$1=this;this._mu.lock(function(){this$1._fs.exists(p2,function(exists3){this$1._mu.unlock();cb(exists3)})})};LockedFS.prototype.existsSync=function existsSync(p2){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.existsSync(p2)};LockedFS.prototype.realpath=function realpath(p2,cache,cb){var this$1=this;this._mu.lock(function(){this$1._fs.realpath(p2,cache,function(err,resolvedPath){this$1._mu.unlock();cb(err,resolvedPath)})})};LockedFS.prototype.realpathSync=function realpathSync(p2,cache){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.realpathSync(p2,cache)};LockedFS.prototype.truncate=function truncate(p2,len,cb){var this$1=this;this._mu.lock(function(){this$1._fs.truncate(p2,len,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.truncateSync=function truncateSync(p2,len){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.truncateSync(p2,len)};LockedFS.prototype.readFile=function readFile2(fname,encoding,flag,cb){var this$1=this;this._mu.lock(function(){this$1._fs.readFile(fname,encoding,flag,function(err,data){this$1._mu.unlock();cb(err,data)})})};LockedFS.prototype.readFileSync=function readFileSync(fname,encoding,flag){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.readFileSync(fname,encoding,flag)};LockedFS.prototype.writeFile=function writeFile2(fname,data,encoding,flag,mode,cb){var this$1=this;this._mu.lock(function(){this$1._fs.writeFile(fname,data,encoding,flag,mode,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.writeFileSync=function writeFileSync(fname,data,encoding,flag,mode){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.writeFileSync(fname,data,encoding,flag,mode)};LockedFS.prototype.appendFile=function appendFile3(fname,data,encoding,flag,mode,cb){var this$1=this;this._mu.lock(function(){this$1._fs.appendFile(fname,data,encoding,flag,mode,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.appendFileSync=function appendFileSync(fname,data,encoding,flag,mode){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.appendFileSync(fname,data,encoding,flag,mode)};LockedFS.prototype.chmod=function chmod(p2,isLchmod,mode,cb){var this$1=this;this._mu.lock(function(){this$1._fs.chmod(p2,isLchmod,mode,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.chmodSync=function chmodSync(p2,isLchmod,mode){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.chmodSync(p2,isLchmod,mode)};LockedFS.prototype.chown=function chown(p2,isLchown,uid,gid,cb){var this$1=this;this._mu.lock(function(){this$1._fs.chown(p2,isLchown,uid,gid,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.chownSync=function chownSync(p2,isLchown,uid,gid){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.chownSync(p2,isLchown,uid,gid)};LockedFS.prototype.utimes=function utimes(p2,atime,mtime,cb){var this$1=this;this._mu.lock(function(){this$1._fs.utimes(p2,atime,mtime,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.utimesSync=function utimesSync(p2,atime,mtime){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.utimesSync(p2,atime,mtime)};LockedFS.prototype.link=function link(srcpath,dstpath,cb){var this$1=this;this._mu.lock(function(){this$1._fs.link(srcpath,dstpath,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.linkSync=function linkSync(srcpath,dstpath){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.linkSync(srcpath,dstpath)};LockedFS.prototype.symlink=function symlink(srcpath,dstpath,type,cb){var this$1=this;this._mu.lock(function(){this$1._fs.symlink(srcpath,dstpath,type,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.symlinkSync=function symlinkSync(srcpath,dstpath,type){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.symlinkSync(srcpath,dstpath,type)};LockedFS.prototype.readlink=function readlink(p2,cb){var this$1=this;this._mu.lock(function(){this$1._fs.readlink(p2,function(err,linkString){this$1._mu.unlock();cb(err,linkString)})})};LockedFS.prototype.readlinkSync=function readlinkSync(p2){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.readlinkSync(p2)};var deletionLogPath="/.deletedFiles.log";function makeModeWritable(mode){return 146|mode}function getFlag(f){return FileFlag.getFileFlag(f)}var OverlayFile=function(PreloadFile$$1){function OverlayFile2(fs4,path$$1,flag,stats,data){PreloadFile$$1.call(this,fs4,path$$1,flag,stats,data)}if(PreloadFile$$1)OverlayFile2.__proto__=PreloadFile$$1;OverlayFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);OverlayFile2.prototype.constructor=OverlayFile2;OverlayFile2.prototype.sync=function sync(cb){var this$1=this;if(!this.isDirty()){cb(null);return}this._fs._syncAsync(this,function(err){this$1.resetDirty();cb(err)})};OverlayFile2.prototype.syncSync=function syncSync(){if(this.isDirty()){this._fs._syncSync(this);this.resetDirty()}};OverlayFile2.prototype.close=function close(cb){this.sync(cb)};OverlayFile2.prototype.closeSync=function closeSync(){this.syncSync()};return OverlayFile2}(PreloadFile);var UnlockedOverlayFS=function(BaseFileSystem$$1){function UnlockedOverlayFS2(writable,readable){BaseFileSystem$$1.call(this);this._isInitialized=false;this._initializeCallbacks=[];this._deletedFiles={};this._deleteLog="";this._deleteLogUpdatePending=false;this._deleteLogUpdateNeeded=false;this._deleteLogError=null;this._writable=writable;this._readable=readable;if(this._writable.isReadOnly()){throw new ApiError(ErrorCode.EINVAL,"Writable file system must be writable.")}}if(BaseFileSystem$$1)UnlockedOverlayFS2.__proto__=BaseFileSystem$$1;UnlockedOverlayFS2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);UnlockedOverlayFS2.prototype.constructor=UnlockedOverlayFS2;UnlockedOverlayFS2.isAvailable=function isAvailable(){return true};UnlockedOverlayFS2.prototype.getOverlayedFileSystems=function getOverlayedFileSystems(){return{readable:this._readable,writable:this._writable}};UnlockedOverlayFS2.prototype._syncAsync=function _syncAsync(file,cb){var this$1=this;this.createParentDirectoriesAsync(file.getPath(),function(err){if(err){return cb(err)}this$1._writable.writeFile(file.getPath(),file.getBuffer(),null,getFlag("w"),file.getStats().mode,cb)})};UnlockedOverlayFS2.prototype._syncSync=function _syncSync(file){this.createParentDirectories(file.getPath());this._writable.writeFileSync(file.getPath(),file.getBuffer(),null,getFlag("w"),file.getStats().mode)};UnlockedOverlayFS2.prototype.getName=function getName(){return OverlayFS.Name};UnlockedOverlayFS2.prototype.initialize=function initialize3(cb){var this$1=this;var callbackArray=this._initializeCallbacks;var end=function(e){this$1._isInitialized=!e;this$1._initializeCallbacks=[];callbackArray.forEach(function(cb2){return cb2(e)})};if(this._isInitialized){return cb()}callbackArray.push(cb);if(callbackArray.length!==1){return}this._writable.readFile(deletionLogPath,"utf8",getFlag("r"),function(err,data){if(err){if(err.errno!==ErrorCode.ENOENT){return end(err)}}else{this$1._deleteLog=data}this$1._reparseDeletionLog();end()})};UnlockedOverlayFS2.prototype.isReadOnly=function isReadOnly(){return false};UnlockedOverlayFS2.prototype.supportsSynch=function supportsSynch(){return this._readable.supportsSynch()&&this._writable.supportsSynch()};UnlockedOverlayFS2.prototype.supportsLinks=function supportsLinks(){return false};UnlockedOverlayFS2.prototype.supportsProps=function supportsProps(){return this._readable.supportsProps()&&this._writable.supportsProps()};UnlockedOverlayFS2.prototype.getDeletionLog=function getDeletionLog(){return this._deleteLog};UnlockedOverlayFS2.prototype.restoreDeletionLog=function restoreDeletionLog(log){this._deleteLog=log;this._reparseDeletionLog();this.updateLog("")};UnlockedOverlayFS2.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;if(!this.checkInitAsync(cb)||this.checkPathAsync(oldPath,cb)||this.checkPathAsync(newPath,cb)){return}if(oldPath===deletionLogPath||newPath===deletionLogPath){return cb(ApiError.EPERM("Cannot rename deletion log."))}if(oldPath===newPath){return cb()}this.stat(oldPath,false,function(oldErr,oldStats){if(oldErr){return cb(oldErr)}return this$1.stat(newPath,false,function(newErr,newStats){var self2=this$1;function copyDirContents(files){var file=files.shift();if(!file){return cb()}var oldFile=path.resolve(oldPath,file);var newFile=path.resolve(newPath,file);self2.rename(oldFile,newFile,function(err){if(err){return cb(err)}copyDirContents(files)})}var mode=511;if(oldStats.isDirectory()){if(newErr){if(newErr.errno!==ErrorCode.ENOENT){return cb(newErr)}return this$1._writable.exists(oldPath,function(exists2){if(exists2){return this$1._writable.rename(oldPath,newPath,cb)}this$1._writable.mkdir(newPath,mode,function(mkdirErr){if(mkdirErr){return cb(mkdirErr)}this$1._readable.readdir(oldPath,function(err,files){if(err){return cb()}copyDirContents(files)})})})}mode=newStats.mode;if(!newStats.isDirectory()){return cb(ApiError.ENOTDIR(newPath))}this$1.readdir(newPath,function(readdirErr,files){if(files&&files.length){return cb(ApiError.ENOTEMPTY(newPath))}this$1._readable.readdir(oldPath,function(err,files2){if(err){return cb()}copyDirContents(files2)})})}if(newStats&&newStats.isDirectory()){return cb(ApiError.EISDIR(newPath))}this$1.readFile(oldPath,null,getFlag("r"),function(err,data){if(err){return cb(err)}return this$1.writeFile(newPath,data,null,getFlag("w"),oldStats.mode,function(err2){if(err2){return cb(err2)}return this$1.unlink(oldPath,cb)})})})})};UnlockedOverlayFS2.prototype.renameSync=function renameSync(oldPath,newPath){var this$1=this;this.checkInitialized();this.checkPath(oldPath);this.checkPath(newPath);if(oldPath===deletionLogPath||newPath===deletionLogPath){throw ApiError.EPERM("Cannot rename deletion log.")}var oldStats=this.statSync(oldPath,false);if(oldStats.isDirectory()){if(oldPath===newPath){return}var mode=511;if(this.existsSync(newPath)){var stats=this.statSync(newPath,false);mode=stats.mode;if(stats.isDirectory()){if(this.readdirSync(newPath).length>0){throw ApiError.ENOTEMPTY(newPath)}}else{throw ApiError.ENOTDIR(newPath)}}if(this._writable.existsSync(oldPath)){this._writable.renameSync(oldPath,newPath)}else if(!this._writable.existsSync(newPath)){this._writable.mkdirSync(newPath,mode)}if(this._readable.existsSync(oldPath)){this._readable.readdirSync(oldPath).forEach(function(name2){this$1.renameSync(path.resolve(oldPath,name2),path.resolve(newPath,name2))})}}else{if(this.existsSync(newPath)&&this.statSync(newPath,false).isDirectory()){throw ApiError.EISDIR(newPath)}this.writeFileSync(newPath,this.readFileSync(oldPath,null,getFlag("r")),null,getFlag("w"),oldStats.mode)}if(oldPath!==newPath&&this.existsSync(oldPath)){this.unlinkSync(oldPath)}};UnlockedOverlayFS2.prototype.stat=function stat(p2,isLstat,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this._writable.stat(p2,isLstat,function(err,stat2){if(err&&err.errno===ErrorCode.ENOENT){if(this$1._deletedFiles[p2]){cb(ApiError.ENOENT(p2))}this$1._readable.stat(p2,isLstat,function(err2,stat3){if(stat3){stat3=stat3.clone();stat3.mode=makeModeWritable(stat3.mode)}cb(err2,stat3)})}else{cb(err,stat2)}})};UnlockedOverlayFS2.prototype.statSync=function statSync(p2,isLstat){this.checkInitialized();try{return this._writable.statSync(p2,isLstat)}catch(e){if(this._deletedFiles[p2]){throw ApiError.ENOENT(p2)}var oldStat=this._readable.statSync(p2,isLstat).clone();oldStat.mode=makeModeWritable(oldStat.mode);return oldStat}};UnlockedOverlayFS2.prototype.open=function open(p2,flag,mode,cb){var this$1=this;if(!this.checkInitAsync(cb)||this.checkPathAsync(p2,cb)){return}this.stat(p2,false,function(err,stats){if(stats){switch(flag.pathExistsAction()){case ActionType.TRUNCATE_FILE:return this$1.createParentDirectoriesAsync(p2,function(err2){if(err2){return cb(err2)}this$1._writable.open(p2,flag,mode,cb)});case ActionType.NOP:return this$1._writable.exists(p2,function(exists2){if(exists2){this$1._writable.open(p2,flag,mode,cb)}else{stats=stats.clone();stats.mode=mode;this$1._readable.readFile(p2,null,getFlag("r"),function(readFileErr,data){if(readFileErr){return cb(readFileErr)}if(stats.size===-1){stats.size=data.length}var f=new OverlayFile(this$1,p2,flag,stats,data);cb(null,f)})}});default:return cb(ApiError.EEXIST(p2))}}else{switch(flag.pathNotExistsAction()){case ActionType.CREATE_FILE:return this$1.createParentDirectoriesAsync(p2,function(err2){if(err2){return cb(err2)}return this$1._writable.open(p2,flag,mode,cb)});default:return cb(ApiError.ENOENT(p2))}}})};UnlockedOverlayFS2.prototype.openSync=function openSync(p2,flag,mode){this.checkInitialized();this.checkPath(p2);if(p2===deletionLogPath){throw ApiError.EPERM("Cannot open deletion log.")}if(this.existsSync(p2)){switch(flag.pathExistsAction()){case ActionType.TRUNCATE_FILE:this.createParentDirectories(p2);return this._writable.openSync(p2,flag,mode);case ActionType.NOP:if(this._writable.existsSync(p2)){return this._writable.openSync(p2,flag,mode)}else{var buf=this._readable.readFileSync(p2,null,getFlag("r"));var stats=this._readable.statSync(p2,false).clone();stats.mode=mode;return new OverlayFile(this,p2,flag,stats,buf)}default:throw ApiError.EEXIST(p2)}}else{switch(flag.pathNotExistsAction()){case ActionType.CREATE_FILE:this.createParentDirectories(p2);return this._writable.openSync(p2,flag,mode);default:throw ApiError.ENOENT(p2)}}};UnlockedOverlayFS2.prototype.unlink=function unlink(p2,cb){var this$1=this;if(!this.checkInitAsync(cb)||this.checkPathAsync(p2,cb)){return}this.exists(p2,function(exists2){if(!exists2){return cb(ApiError.ENOENT(p2))}this$1._writable.exists(p2,function(writableExists){if(writableExists){return this$1._writable.unlink(p2,function(err){if(err){return cb(err)}this$1.exists(p2,function(readableExists){if(readableExists){this$1.deletePath(p2)}cb(null)})})}else{this$1.deletePath(p2);cb(null)}})})};UnlockedOverlayFS2.prototype.unlinkSync=function unlinkSync(p2){this.checkInitialized();this.checkPath(p2);if(this.existsSync(p2)){if(this._writable.existsSync(p2)){this._writable.unlinkSync(p2)}if(this.existsSync(p2)){this.deletePath(p2)}}else{throw ApiError.ENOENT(p2)}};UnlockedOverlayFS2.prototype.rmdir=function rmdir(p2,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}var rmdirLower=function(){this$1.readdir(p2,function(err,files){if(err){return cb(err)}if(files.length){return cb(ApiError.ENOTEMPTY(p2))}this$1.deletePath(p2);cb(null)})};this.exists(p2,function(exists2){if(!exists2){return cb(ApiError.ENOENT(p2))}this$1._writable.exists(p2,function(writableExists){if(writableExists){this$1._writable.rmdir(p2,function(err){if(err){return cb(err)}this$1._readable.exists(p2,function(readableExists){if(readableExists){rmdirLower()}else{cb()}})})}else{rmdirLower()}})})};UnlockedOverlayFS2.prototype.rmdirSync=function rmdirSync(p2){this.checkInitialized();if(this.existsSync(p2)){if(this._writable.existsSync(p2)){this._writable.rmdirSync(p2)}if(this.existsSync(p2)){if(this.readdirSync(p2).length>0){throw ApiError.ENOTEMPTY(p2)}else{this.deletePath(p2)}}}else{throw ApiError.ENOENT(p2)}};UnlockedOverlayFS2.prototype.mkdir=function mkdir(p2,mode,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this.exists(p2,function(exists2){if(exists2){return cb(ApiError.EEXIST(p2))}this$1.createParentDirectoriesAsync(p2,function(err){if(err){return cb(err)}this$1._writable.mkdir(p2,mode,cb)})})};UnlockedOverlayFS2.prototype.mkdirSync=function mkdirSync(p2,mode){this.checkInitialized();if(this.existsSync(p2)){throw ApiError.EEXIST(p2)}else{this.createParentDirectories(p2);this._writable.mkdirSync(p2,mode)}};UnlockedOverlayFS2.prototype.readdir=function readdir(p2,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this.stat(p2,false,function(err,dirStats){if(err){return cb(err)}if(!dirStats.isDirectory()){return cb(ApiError.ENOTDIR(p2))}this$1._writable.readdir(p2,function(err2,wFiles){if(err2&&err2.code!=="ENOENT"){return cb(err2)}else if(err2||!wFiles){wFiles=[]}this$1._readable.readdir(p2,function(err3,rFiles){if(err3||!rFiles){rFiles=[]}var seenMap={};var filtered=wFiles.concat(rFiles.filter(function(fPath){return!this$1._deletedFiles[p2+"/"+fPath]})).filter(function(fPath){var result=!seenMap[fPath];seenMap[fPath]=true;return result});cb(null,filtered)})})})};UnlockedOverlayFS2.prototype.readdirSync=function readdirSync(p2){var this$1=this;this.checkInitialized();var dirStats=this.statSync(p2,false);if(!dirStats.isDirectory()){throw ApiError.ENOTDIR(p2)}var contents=[];try{contents=contents.concat(this._writable.readdirSync(p2))}catch(e){}try{contents=contents.concat(this._readable.readdirSync(p2).filter(function(fPath){return!this$1._deletedFiles[p2+"/"+fPath]}))}catch(e){}var seenMap={};return contents.filter(function(fileP){var result=!seenMap[fileP];seenMap[fileP]=true;return result})};UnlockedOverlayFS2.prototype.exists=function exists2(p2,cb){var this$1=this;this.checkInitialized();this._writable.exists(p2,function(existsWritable){if(existsWritable){return cb(true)}this$1._readable.exists(p2,function(existsReadable){cb(existsReadable&&this$1._deletedFiles[p2]!==true)})})};UnlockedOverlayFS2.prototype.existsSync=function existsSync(p2){this.checkInitialized();return this._writable.existsSync(p2)||this._readable.existsSync(p2)&&this._deletedFiles[p2]!==true};UnlockedOverlayFS2.prototype.chmod=function chmod(p2,isLchmod,mode,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this.operateOnWritableAsync(p2,function(err){if(err){return cb(err)}else{this$1._writable.chmod(p2,isLchmod,mode,cb)}})};UnlockedOverlayFS2.prototype.chmodSync=function chmodSync(p2,isLchmod,mode){var this$1=this;this.checkInitialized();this.operateOnWritable(p2,function(){this$1._writable.chmodSync(p2,isLchmod,mode)})};UnlockedOverlayFS2.prototype.chown=function chown(p2,isLchmod,uid,gid,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this.operateOnWritableAsync(p2,function(err){if(err){return cb(err)}else{this$1._writable.chown(p2,isLchmod,uid,gid,cb)}})};UnlockedOverlayFS2.prototype.chownSync=function chownSync(p2,isLchown,uid,gid){var this$1=this;this.checkInitialized();this.operateOnWritable(p2,function(){this$1._writable.chownSync(p2,isLchown,uid,gid)})};UnlockedOverlayFS2.prototype.utimes=function utimes(p2,atime,mtime,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this.operateOnWritableAsync(p2,function(err){if(err){return cb(err)}else{this$1._writable.utimes(p2,atime,mtime,cb)}})};UnlockedOverlayFS2.prototype.utimesSync=function utimesSync(p2,atime,mtime){var this$1=this;this.checkInitialized();this.operateOnWritable(p2,function(){this$1._writable.utimesSync(p2,atime,mtime)})};UnlockedOverlayFS2.prototype.deletePath=function deletePath(p2){this._deletedFiles[p2]=true;this.updateLog("d"+p2+"\\n")};UnlockedOverlayFS2.prototype.updateLog=function updateLog(addition){var this$1=this;this._deleteLog+=addition;if(this._deleteLogUpdatePending){this._deleteLogUpdateNeeded=true}else{this._deleteLogUpdatePending=true;this._writable.writeFile(deletionLogPath,this._deleteLog,"utf8",FileFlag.getFileFlag("w"),420,function(e){this$1._deleteLogUpdatePending=false;if(e){this$1._deleteLogError=e}else if(this$1._deleteLogUpdateNeeded){this$1._deleteLogUpdateNeeded=false;this$1.updateLog("")}})}};UnlockedOverlayFS2.prototype._reparseDeletionLog=function _reparseDeletionLog(){var this$1=this;this._deletedFiles={};this._deleteLog.split("\\n").forEach(function(path$$1){this$1._deletedFiles[path$$1.slice(1)]=path$$1.slice(0,1)==="d"})};UnlockedOverlayFS2.prototype.checkInitialized=function checkInitialized(){if(!this._isInitialized){throw new ApiError(ErrorCode.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")}else if(this._deleteLogError!==null){var e=this._deleteLogError;this._deleteLogError=null;throw e}};UnlockedOverlayFS2.prototype.checkInitAsync=function checkInitAsync(cb){if(!this._isInitialized){cb(new ApiError(ErrorCode.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it."));return false}else if(this._deleteLogError!==null){var e=this._deleteLogError;this._deleteLogError=null;cb(e);return false}return true};UnlockedOverlayFS2.prototype.checkPath=function checkPath(p2){if(p2===deletionLogPath){throw ApiError.EPERM(p2)}};UnlockedOverlayFS2.prototype.checkPathAsync=function checkPathAsync(p2,cb){if(p2===deletionLogPath){cb(ApiError.EPERM(p2));return true}return false};UnlockedOverlayFS2.prototype.createParentDirectoriesAsync=function createParentDirectoriesAsync(p2,cb){var parent=path.dirname(p2);var toCreate=[];var self2=this;this._writable.stat(parent,false,statDone);function statDone(err,stat){if(err){toCreate.push(parent);parent=path.dirname(parent);self2._writable.stat(parent,false,statDone)}else{createParents()}}function createParents(){if(!toCreate.length){return cb()}var dir=toCreate.pop();self2._readable.stat(dir,false,function(err,stats){if(!stats){return cb()}self2._writable.mkdir(dir,stats.mode,function(err2){if(err2){return cb(err2)}createParents()})})}};UnlockedOverlayFS2.prototype.createParentDirectories=function createParentDirectories(p2){var this$1=this;var parent=path.dirname(p2),toCreate=[];while(!this._writable.existsSync(parent)){toCreate.push(parent);parent=path.dirname(parent)}toCreate=toCreate.reverse();toCreate.forEach(function(p22){this$1._writable.mkdirSync(p22,this$1.statSync(p22,false).mode)})};UnlockedOverlayFS2.prototype.operateOnWritable=function operateOnWritable(p2,f){if(this.existsSync(p2)){if(!this._writable.existsSync(p2)){this.copyToWritable(p2)}f()}else{throw ApiError.ENOENT(p2)}};UnlockedOverlayFS2.prototype.operateOnWritableAsync=function operateOnWritableAsync(p2,cb){var this$1=this;this.exists(p2,function(exists2){if(!exists2){return cb(ApiError.ENOENT(p2))}this$1._writable.exists(p2,function(existsWritable){if(existsWritable){cb()}else{return this$1.copyToWritableAsync(p2,cb)}})})};UnlockedOverlayFS2.prototype.copyToWritable=function copyToWritable(p2){var pStats=this.statSync(p2,false);if(pStats.isDirectory()){this._writable.mkdirSync(p2,pStats.mode)}else{this.writeFileSync(p2,this._readable.readFileSync(p2,null,getFlag("r")),null,getFlag("w"),this.statSync(p2,false).mode)}};UnlockedOverlayFS2.prototype.copyToWritableAsync=function copyToWritableAsync(p2,cb){var this$1=this;this.stat(p2,false,function(err,pStats){if(err){return cb(err)}if(pStats.isDirectory()){return this$1._writable.mkdir(p2,pStats.mode,cb)}this$1._readable.readFile(p2,null,getFlag("r"),function(err2,data){if(err2){return cb(err2)}this$1.writeFile(p2,data,null,getFlag("w"),pStats.mode,cb)})})};return UnlockedOverlayFS2}(BaseFileSystem);var OverlayFS=function(LockedFS$$1){function OverlayFS2(writable,readable,deprecateMsg){if(deprecateMsg===void 0)deprecateMsg=true;LockedFS$$1.call(this,new UnlockedOverlayFS(writable,readable));deprecationMessage(deprecateMsg,OverlayFS2.Name,{readable:"readable file system",writable:"writable file system"})}if(LockedFS$$1)OverlayFS2.__proto__=LockedFS$$1;OverlayFS2.prototype=Object.create(LockedFS$$1&&LockedFS$$1.prototype);OverlayFS2.prototype.constructor=OverlayFS2;OverlayFS2.Create=function Create(opts,cb){try{var fs4=new OverlayFS2(opts.writable,opts.readable,false);fs4.initialize(function(e){cb(e,fs4)},false)}catch(e){cb(e)}};OverlayFS2.isAvailable=function isAvailable(){return UnlockedOverlayFS.isAvailable()};OverlayFS2.prototype.initialize=function initialize3(cb,deprecateMsg){if(deprecateMsg===void 0)deprecateMsg=true;if(deprecateMsg){console.warn("[OverlayFS] OverlayFS.initialize() is deprecated and will be removed in the next major release. Please use \'OverlayFS.Create({readable: readable file system instance, writable: writable file system instance}, cb)\' to create and initialize OverlayFS instances.")}LockedFS$$1.prototype.initialize.call(this,cb)};OverlayFS2.prototype.getOverlayedFileSystems=function getOverlayedFileSystems(){return LockedFS$$1.prototype.getFSUnlocked.call(this).getOverlayedFileSystems()};OverlayFS2.prototype.unwrap=function unwrap(){return LockedFS$$1.prototype.getFSUnlocked.call(this)};return OverlayFS2}(LockedFS);OverlayFS.Name="OverlayFS";OverlayFS.Options={writable:{type:"object",description:"The file system to write modified files to."},readable:{type:"object",description:"The file system that initially populates this file system."}};var SpecialArgType;(function(SpecialArgType2){SpecialArgType2[SpecialArgType2["CB"]=0]="CB";SpecialArgType2[SpecialArgType2["FD"]=1]="FD";SpecialArgType2[SpecialArgType2["API_ERROR"]=2]="API_ERROR";SpecialArgType2[SpecialArgType2["STATS"]=3]="STATS";SpecialArgType2[SpecialArgType2["PROBE"]=4]="PROBE";SpecialArgType2[SpecialArgType2["FILEFLAG"]=5]="FILEFLAG";SpecialArgType2[SpecialArgType2["BUFFER"]=6]="BUFFER";SpecialArgType2[SpecialArgType2["ERROR"]=7]="ERROR"})(SpecialArgType||(SpecialArgType={}));var CallbackArgumentConverter=function CallbackArgumentConverter2(){this._callbacks={};this._nextId=0};CallbackArgumentConverter.prototype.toRemoteArg=function toRemoteArg(cb){var id=this._nextId++;this._callbacks[id]=cb;return{type:SpecialArgType.CB,id}};CallbackArgumentConverter.prototype.toLocalArg=function toLocalArg(id){var cb=this._callbacks[id];delete this._callbacks[id];return cb};var FileDescriptorArgumentConverter=function FileDescriptorArgumentConverter2(){this._fileDescriptors={};this._nextId=0};FileDescriptorArgumentConverter.prototype.toRemoteArg=function toRemoteArg(fd,p2,flag,cb){var id=this._nextId++;var data;var stat;this._fileDescriptors[id]=fd;fd.stat(function(err,stats){if(err){cb(err)}else{stat=bufferToTransferrableObject(stats.toBuffer());if(flag.isReadable()){fd.read(Buffer2.alloc(stats.size),0,stats.size,0,function(err2,bytesRead,buff){if(err2){cb(err2)}else{data=bufferToTransferrableObject(buff);cb(null,{type:SpecialArgType.FD,id,data,stat,path:p2,flag:flag.getFlagString()})}})}else{cb(null,{type:SpecialArgType.FD,id,data:new ArrayBuffer(0),stat,path:p2,flag:flag.getFlagString()})}}})};FileDescriptorArgumentConverter.prototype.applyFdAPIRequest=function applyFdAPIRequest(request,cb){var this$1=this;var fdArg=request.args[0];this._applyFdChanges(fdArg,function(err,fd){if(err){cb(err)}else{fd[request.method](function(e){if(request.method==="close"){delete this$1._fileDescriptors[fdArg.id]}cb(e)})}})};FileDescriptorArgumentConverter.prototype._applyFdChanges=function _applyFdChanges(remoteFd,cb){var fd=this._fileDescriptors[remoteFd.id],data=transferrableObjectToBuffer(remoteFd.data),remoteStats=Stats.fromBuffer(transferrableObjectToBuffer(remoteFd.stat));var flag=FileFlag.getFileFlag(remoteFd.flag);if(flag.isWriteable()){fd.write(data,0,data.length,flag.isAppendable()?fd.getPos():0,function(e){function applyStatChanges(){fd.stat(function(e2,stats){if(e2){cb(e2)}else{if(stats.mode!==remoteStats.mode){fd.chmod(remoteStats.mode,function(e3){cb(e3,fd)})}else{cb(e2,fd)}}})}if(e){cb(e)}else{if(!flag.isAppendable()){fd.truncate(data.length,function(){applyStatChanges()})}else{applyStatChanges()}}})}else{cb(null,fd)}};function apiErrorLocal2Remote(e){return{type:SpecialArgType.API_ERROR,errorData:bufferToTransferrableObject(e.writeToBuffer())}}function apiErrorRemote2Local(e){return ApiError.fromBuffer(transferrableObjectToBuffer(e.errorData))}function errorLocal2Remote(e){return{type:SpecialArgType.ERROR,name:e.name,message:e.message,stack:e.stack}}function errorRemote2Local(e){var cnstr=global$1[e.name];if(typeof cnstr!=="function"){cnstr=Error}var err=new cnstr(e.message);err.stack=e.stack;return err}function statsLocal2Remote(stats){return{type:SpecialArgType.STATS,statsData:bufferToTransferrableObject(stats.toBuffer())}}function statsRemote2Local(stats){return Stats.fromBuffer(transferrableObjectToBuffer(stats.statsData))}function fileFlagLocal2Remote(flag){return{type:SpecialArgType.FILEFLAG,flagStr:flag.getFlagString()}}function fileFlagRemote2Local(remoteFlag){return FileFlag.getFileFlag(remoteFlag.flagStr)}function bufferToTransferrableObject(buff){return buffer2ArrayBuffer(buff)}function transferrableObjectToBuffer(buff){return arrayBuffer2Buffer(buff)}function bufferLocal2Remote(buff){return{type:SpecialArgType.BUFFER,data:bufferToTransferrableObject(buff)}}function bufferRemote2Local(buffArg){return transferrableObjectToBuffer(buffArg.data)}function isAPIRequest(data){return data&&typeof data==="object"&&data.hasOwnProperty("browserfsMessage")&&data["browserfsMessage"]}function isAPIResponse(data){return data&&typeof data==="object"&&data.hasOwnProperty("browserfsMessage")&&data["browserfsMessage"]}var WorkerFile=function(PreloadFile$$1){function WorkerFile2(_fs,_path,_flag,_stat,remoteFdId,contents){PreloadFile$$1.call(this,_fs,_path,_flag,_stat,contents);this._remoteFdId=remoteFdId}if(PreloadFile$$1)WorkerFile2.__proto__=PreloadFile$$1;WorkerFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);WorkerFile2.prototype.constructor=WorkerFile2;WorkerFile2.prototype.getRemoteFdId=function getRemoteFdId(){return this._remoteFdId};WorkerFile2.prototype.toRemoteArg=function toRemoteArg(){return{type:SpecialArgType.FD,id:this._remoteFdId,data:bufferToTransferrableObject(this.getBuffer()),stat:bufferToTransferrableObject(this.getStats().toBuffer()),path:this.getPath(),flag:this.getFlag().getFlagString()}};WorkerFile2.prototype.sync=function sync(cb){this._syncClose("sync",cb)};WorkerFile2.prototype.close=function close(cb){this._syncClose("close",cb)};WorkerFile2.prototype._syncClose=function _syncClose(type,cb){var this$1=this;if(this.isDirty()){this._fs.syncClose(type,this,function(e){if(!e){this$1.resetDirty()}cb(e)})}else{cb()}};return WorkerFile2}(PreloadFile);var WorkerFS=function(BaseFileSystem$$1){function WorkerFS2(worker,deprecateMsg){var this$1=this;if(deprecateMsg===void 0)deprecateMsg=true;BaseFileSystem$$1.call(this);this._callbackConverter=new CallbackArgumentConverter;this._isInitialized=false;this._isReadOnly=false;this._supportLinks=false;this._supportProps=false;this._worker=worker;deprecationMessage(deprecateMsg,WorkerFS2.Name,{worker:"Web Worker instance"});this._worker.addEventListener("message",function(e){var resp=e.data;if(isAPIResponse(resp)){var i22;var args=resp.args;var fixedArgs=new Array(args.length);for(i22=0;i22<fixedArgs.length;i22++){fixedArgs[i22]=this$1._argRemote2Local(args[i22])}this$1._callbackConverter.toLocalArg(resp.cbId).apply(null,fixedArgs)}})}if(BaseFileSystem$$1)WorkerFS2.__proto__=BaseFileSystem$$1;WorkerFS2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);WorkerFS2.prototype.constructor=WorkerFS2;WorkerFS2.Create=function Create(opts,cb){var fs4=new WorkerFS2(opts.worker,false);fs4.initialize(function(){cb(null,fs4)})};WorkerFS2.isAvailable=function isAvailable(){return typeof importScripts!=="undefined"||typeof Worker!=="undefined"};WorkerFS2.attachRemoteListener=function attachRemoteListener(worker){var fdConverter=new FileDescriptorArgumentConverter;function argLocal2Remote(arg,requestArgs,cb){switch(typeof arg){case"object":if(arg instanceof Stats){cb(null,statsLocal2Remote(arg))}else if(arg instanceof ApiError){cb(null,apiErrorLocal2Remote(arg))}else if(arg instanceof BaseFile){cb(null,fdConverter.toRemoteArg(arg,requestArgs[0],requestArgs[1],cb))}else if(arg instanceof FileFlag){cb(null,fileFlagLocal2Remote(arg))}else if(arg instanceof Buffer2){cb(null,bufferLocal2Remote(arg))}else if(arg instanceof Error){cb(null,errorLocal2Remote(arg))}else{cb(null,arg)}break;default:cb(null,arg);break}}function argRemote2Local(arg,fixedRequestArgs){if(!arg){return arg}switch(typeof arg){case"object":if(typeof arg["type"]==="number"){var specialArg=arg;switch(specialArg.type){case SpecialArgType.CB:var cbId=arg.id;return function(){var arguments$1=arguments;var i22;var fixedArgs=new Array(arguments.length);var message,countdown=arguments.length;function abortAndSendError(err){if(countdown>0){countdown=-1;message={browserfsMessage:true,cbId,args:[apiErrorLocal2Remote(err)]};worker.postMessage(message)}}for(i22=0;i22<arguments.length;i22++){(function(i32,arg2){argLocal2Remote(arg2,fixedRequestArgs,function(err,fixedArg){fixedArgs[i32]=fixedArg;if(err){abortAndSendError(err)}else if(--countdown===0){message={browserfsMessage:true,cbId,args:fixedArgs};worker.postMessage(message)}})})(i22,arguments$1[i22])}if(arguments.length===0){message={browserfsMessage:true,cbId,args:fixedArgs};worker.postMessage(message)}};case SpecialArgType.API_ERROR:return apiErrorRemote2Local(specialArg);case SpecialArgType.STATS:return statsRemote2Local(specialArg);case SpecialArgType.FILEFLAG:return fileFlagRemote2Local(specialArg);case SpecialArgType.BUFFER:return bufferRemote2Local(specialArg);case SpecialArgType.ERROR:return errorRemote2Local(specialArg);default:return arg}}else{return arg}default:return arg}}worker.addEventListener("message",function(e){var request=e.data;if(isAPIRequest(request)){var args=request.args,fixedArgs=new Array(args.length);switch(request.method){case"close":case"sync":(function(){var remoteCb=args[1];fdConverter.applyFdAPIRequest(request,function(err){var response={browserfsMessage:true,cbId:remoteCb.id,args:err?[apiErrorLocal2Remote(err)]:[]};worker.postMessage(response)})})();break;case"probe":(function(){var rootFs=_fsMock.getRootFS(),remoteCb=args[1],probeResponse={type:SpecialArgType.PROBE,isReadOnly:rootFs.isReadOnly(),supportsLinks:rootFs.supportsLinks(),supportsProps:rootFs.supportsProps()},response={browserfsMessage:true,cbId:remoteCb.id,args:[probeResponse]};worker.postMessage(response)})();break;default:for(var i22=0;i22<args.length;i22++){fixedArgs[i22]=argRemote2Local(args[i22],fixedArgs)}var rootFS=_fsMock.getRootFS();rootFS[request.method].apply(rootFS,fixedArgs);break}}})};WorkerFS2.prototype.getName=function getName(){return WorkerFS2.Name};WorkerFS2.prototype.initialize=function initialize3(cb){var this$1=this;if(!this._isInitialized){var message={browserfsMessage:true,method:"probe",args:[this._argLocal2Remote(emptyBuffer()),this._callbackConverter.toRemoteArg(function(probeResponse){this$1._isInitialized=true;this$1._isReadOnly=probeResponse.isReadOnly;this$1._supportLinks=probeResponse.supportsLinks;this$1._supportProps=probeResponse.supportsProps;cb()})]};this._worker.postMessage(message)}else{cb()}};WorkerFS2.prototype.isReadOnly=function isReadOnly(){return this._isReadOnly};WorkerFS2.prototype.supportsSynch=function supportsSynch(){return false};WorkerFS2.prototype.supportsLinks=function supportsLinks(){return this._supportLinks};WorkerFS2.prototype.supportsProps=function supportsProps(){return this._supportProps};WorkerFS2.prototype.rename=function rename(oldPath,newPath,cb){this._rpc("rename",arguments)};WorkerFS2.prototype.stat=function stat(p2,isLstat,cb){this._rpc("stat",arguments)};WorkerFS2.prototype.open=function open(p2,flag,mode,cb){this._rpc("open",arguments)};WorkerFS2.prototype.unlink=function unlink(p2,cb){this._rpc("unlink",arguments)};WorkerFS2.prototype.rmdir=function rmdir(p2,cb){this._rpc("rmdir",arguments)};WorkerFS2.prototype.mkdir=function mkdir(p2,mode,cb){this._rpc("mkdir",arguments)};WorkerFS2.prototype.readdir=function readdir(p2,cb){this._rpc("readdir",arguments)};WorkerFS2.prototype.exists=function exists2(p2,cb){this._rpc("exists",arguments)};WorkerFS2.prototype.realpath=function realpath(p2,cache,cb){this._rpc("realpath",arguments)};WorkerFS2.prototype.truncate=function truncate(p2,len,cb){this._rpc("truncate",arguments)};WorkerFS2.prototype.readFile=function readFile2(fname,encoding,flag,cb){this._rpc("readFile",arguments)};WorkerFS2.prototype.writeFile=function writeFile2(fname,data,encoding,flag,mode,cb){this._rpc("writeFile",arguments)};WorkerFS2.prototype.appendFile=function appendFile3(fname,data,encoding,flag,mode,cb){this._rpc("appendFile",arguments)};WorkerFS2.prototype.chmod=function chmod(p2,isLchmod,mode,cb){this._rpc("chmod",arguments)};WorkerFS2.prototype.chown=function chown(p2,isLchown,uid,gid,cb){this._rpc("chown",arguments)};WorkerFS2.prototype.utimes=function utimes(p2,atime,mtime,cb){this._rpc("utimes",arguments)};WorkerFS2.prototype.link=function link(srcpath,dstpath,cb){this._rpc("link",arguments)};WorkerFS2.prototype.symlink=function symlink(srcpath,dstpath,type,cb){this._rpc("symlink",arguments)};WorkerFS2.prototype.readlink=function readlink(p2,cb){this._rpc("readlink",arguments)};WorkerFS2.prototype.syncClose=function syncClose(method,fd,cb){this._worker.postMessage({browserfsMessage:true,method,args:[fd.toRemoteArg(),this._callbackConverter.toRemoteArg(cb)]})};WorkerFS2.prototype._argRemote2Local=function _argRemote2Local(arg){if(!arg){return arg}switch(typeof arg){case"object":if(typeof arg["type"]==="number"){var specialArg=arg;switch(specialArg.type){case SpecialArgType.API_ERROR:return apiErrorRemote2Local(specialArg);case SpecialArgType.FD:var fdArg=specialArg;return new WorkerFile(this,fdArg.path,FileFlag.getFileFlag(fdArg.flag),Stats.fromBuffer(transferrableObjectToBuffer(fdArg.stat)),fdArg.id,transferrableObjectToBuffer(fdArg.data));case SpecialArgType.STATS:return statsRemote2Local(specialArg);case SpecialArgType.FILEFLAG:return fileFlagRemote2Local(specialArg);case SpecialArgType.BUFFER:return bufferRemote2Local(specialArg);case SpecialArgType.ERROR:return errorRemote2Local(specialArg);default:return arg}}else{return arg}default:return arg}};WorkerFS2.prototype._rpc=function _rpc(methodName,args){var this$1=this;var fixedArgs=new Array(args.length);for(var i22=0;i22<args.length;i22++){fixedArgs[i22]=this$1._argLocal2Remote(args[i22])}var message={browserfsMessage:true,method:methodName,args:fixedArgs};this._worker.postMessage(message)};WorkerFS2.prototype._argLocal2Remote=function _argLocal2Remote(arg){if(!arg){return arg}switch(typeof arg){case"object":if(arg instanceof Stats){return statsLocal2Remote(arg)}else if(arg instanceof ApiError){return apiErrorLocal2Remote(arg)}else if(arg instanceof WorkerFile){return arg.toRemoteArg()}else if(arg instanceof FileFlag){return fileFlagLocal2Remote(arg)}else if(arg instanceof Buffer2){return bufferLocal2Remote(arg)}else if(arg instanceof Error){return errorLocal2Remote(arg)}else{return"Unknown argument"}case"function":return this._callbackConverter.toRemoteArg(arg);default:return arg}};return WorkerFS2}(BaseFileSystem);WorkerFS.Name="WorkerFS";WorkerFS.Options={worker:{type:"object",description:"The target worker that you want to connect to, or the current worker if in a worker context.",validator:function(v2,cb){if(v2["postMessage"]){cb()}else{cb(new ApiError(ErrorCode.EINVAL,"option must be a Web Worker instance."))}}}};function asyncDownloadFileModern(p2,type,cb){var req=new XMLHttpRequest;req.open("GET",p2,true);var jsonSupported=true;switch(type){case"buffer":req.responseType="arraybuffer";break;case"json":try{req.responseType="json";jsonSupported=req.responseType==="json"}catch(e){jsonSupported=false}break;default:return cb(new ApiError(ErrorCode.EINVAL,"Invalid download type: "+type))}req.onreadystatechange=function(e){if(req.readyState===4){if(req.status===200){switch(type){case"buffer":return cb(null,req.response?Buffer2.from(req.response):emptyBuffer());case"json":if(jsonSupported){return cb(null,req.response)}else{return cb(null,JSON.parse(req.responseText))}}}else{return cb(new ApiError(req.status,"XHR error."))}}};req.send()}function syncDownloadFileModern(p2,type){var req=new XMLHttpRequest;req.open("GET",p2,false);var data=null;var err=null;req.overrideMimeType("text/plain; charset=x-user-defined");req.onreadystatechange=function(e){if(req.readyState===4){if(req.status===200){switch(type){case"buffer":var text=req.responseText;data=Buffer2.alloc(text.length);for(var i22=0;i22<text.length;i22++){data[i22]=text.charCodeAt(i22)}return;case"json":data=JSON.parse(req.responseText);return}}else{err=new ApiError(req.status,"XHR error.");return}}};req.send();if(err){throw err}return data}function syncDownloadFileIE10(p2,type){var req=new XMLHttpRequest;req.open("GET",p2,false);switch(type){case"buffer":req.responseType="arraybuffer";break;case"json":break;default:throw new ApiError(ErrorCode.EINVAL,"Invalid download type: "+type)}var data;var err;req.onreadystatechange=function(e){if(req.readyState===4){if(req.status===200){switch(type){case"buffer":data=Buffer2.from(req.response);break;case"json":data=JSON.parse(req.response);break}}else{err=new ApiError(req.status,"XHR error.")}}};req.send();if(err){throw err}return data}function getFileSize2(async,p2,cb){var req=new XMLHttpRequest;req.open("HEAD",p2,async);req.onreadystatechange=function(e){if(req.readyState===4){if(req.status===200){try{return cb(null,parseInt(req.getResponseHeader("Content-Length")||"-1",10))}catch(e2){return cb(new ApiError(ErrorCode.EIO,"XHR HEAD error: Could not read content-length."))}}else{return cb(new ApiError(req.status,"XHR HEAD error."))}}};req.send()}var asyncDownloadFile=asyncDownloadFileModern;var syncDownloadFile=isIE&&typeof Blob!=="undefined"?syncDownloadFileIE10:syncDownloadFileModern;function getFileSizeSync(p2){var rv=-1;getFileSize2(false,p2,function(err,size){if(err){throw err}rv=size});return rv}function getFileSizeAsync(p2,cb){getFileSize2(true,p2,cb)}var FileIndex=function FileIndex2(){this._index={};this.addPath("/",new DirInode)};FileIndex.fromListing=function fromListing(listing){var idx=new FileIndex;var rootInode=new DirInode;idx._index["/"]=rootInode;var queue=[["",listing,rootInode]];while(queue.length>0){var inode=void 0;var next=queue.pop();var pwd=next[0];var tree=next[1];var parent=next[2];for(var node in tree){if(tree.hasOwnProperty(node)){var children=tree[node];var name2=pwd+"/"+node;if(children){idx._index[name2]=inode=new DirInode;queue.push([name2,children,inode])}else{inode=new FileInode(new Stats(FileType.FILE,-1,365))}if(parent){parent._ls[node]=inode}}}}return idx};FileIndex.prototype.fileIterator=function fileIterator(cb){var this$1=this;for(var path$$1 in this$1._index){if(this$1._index.hasOwnProperty(path$$1)){var dir=this$1._index[path$$1];var files=dir.getListing();for(var i22=0,list2=files;i22<list2.length;i22+=1){var file=list2[i22];var item=dir.getItem(file);if(isFileInode(item)){cb(item.getData())}}}}};FileIndex.prototype.addPath=function addPath(path$$1,inode){if(!inode){throw new Error("Inode must be specified")}if(path$$1[0]!=="/"){throw new Error("Path must be absolute, got: "+path$$1)}if(this._index.hasOwnProperty(path$$1)){return this._index[path$$1]===inode}var splitPath=this._split_path(path$$1);var dirpath=splitPath[0];var itemname=splitPath[1];var parent=this._index[dirpath];if(parent===void 0&&path$$1!=="/"){parent=new DirInode;if(!this.addPath(dirpath,parent)){return false}}if(path$$1!=="/"){if(!parent.addItem(itemname,inode)){return false}}if(isDirInode(inode)){this._index[path$$1]=inode}return true};FileIndex.prototype.addPathFast=function addPathFast(path$$1,inode){var itemNameMark=path$$1.lastIndexOf("/");var parentPath=itemNameMark===0?"/":path$$1.substring(0,itemNameMark);var itemName=path$$1.substring(itemNameMark+1);var parent=this._index[parentPath];if(parent===void 0){parent=new DirInode;this.addPathFast(parentPath,parent)}if(!parent.addItem(itemName,inode)){return false}if(inode.isDir()){this._index[path$$1]=inode}return true};FileIndex.prototype.removePath=function removePath(path$$1){var this$1=this;var splitPath=this._split_path(path$$1);var dirpath=splitPath[0];var itemname=splitPath[1];var parent=this._index[dirpath];if(parent===void 0){return null}var inode=parent.remItem(itemname);if(inode===null){return null}if(isDirInode(inode)){var children=inode.getListing();for(var i22=0,list2=children;i22<list2.length;i22+=1){var child=list2[i22];this$1.removePath(path$$1+"/"+child)}if(path$$1!=="/"){delete this._index[path$$1]}}return inode};FileIndex.prototype.ls=function ls(path$$1){var item=this._index[path$$1];if(item===void 0){return null}return item.getListing()};FileIndex.prototype.getInode=function getInode(path$$1){var splitPath=this._split_path(path$$1);var dirpath=splitPath[0];var itemname=splitPath[1];var parent=this._index[dirpath];if(parent===void 0){return null}if(dirpath===path$$1){return parent}return parent.getItem(itemname)};FileIndex.prototype._split_path=function _split_path(p2){var dirpath=path.dirname(p2);var itemname=p2.substr(dirpath.length+(dirpath==="/"?0:1));return[dirpath,itemname]};var FileInode=function FileInode2(data){this.data=data};FileInode.prototype.isFile=function isFile(){return true};FileInode.prototype.isDir=function isDir(){return false};FileInode.prototype.getData=function getData(){return this.data};FileInode.prototype.setData=function setData(data){this.data=data};var DirInode=function DirInode2(data){if(data===void 0)data=null;this.data=data;this._ls={}};DirInode.prototype.isFile=function isFile(){return false};DirInode.prototype.isDir=function isDir(){return true};DirInode.prototype.getData=function getData(){return this.data};DirInode.prototype.getStats=function getStats(){return new Stats(FileType.DIRECTORY,4096,365)};DirInode.prototype.getListing=function getListing(){return Object.keys(this._ls)};DirInode.prototype.getItem=function getItem(p2){var item=this._ls[p2];return item?item:null};DirInode.prototype.addItem=function addItem(p2,inode){if(p2 in this._ls){return false}this._ls[p2]=inode;return true};DirInode.prototype.remItem=function remItem(p2){var item=this._ls[p2];if(item===void 0){return null}delete this._ls[p2];return item};function isFileInode(inode){return!!inode&&inode.isFile()}function isDirInode(inode){return!!inode&&inode.isDir()}function tryToString(buff,encoding,cb){try{cb(null,buff.toString(encoding))}catch(e){cb(e)}}var XmlHttpRequest=function(BaseFileSystem$$1){function XmlHttpRequest2(listingUrlOrObj,prefixUrl,deprecateMsg){if(prefixUrl===void 0)prefixUrl="";if(deprecateMsg===void 0)deprecateMsg=true;BaseFileSystem$$1.call(this);if(!listingUrlOrObj){listingUrlOrObj="index.json"}if(prefixUrl.length>0&&prefixUrl.charAt(prefixUrl.length-1)!=="/"){prefixUrl=prefixUrl+"/"}this.prefixUrl=prefixUrl;var listing=null;if(typeof listingUrlOrObj==="string"){listing=this._requestFileSync(listingUrlOrObj,"json");if(!listing){throw new Error("Unable to find listing at URL: ${listingUrlOrObj}")}}else{listing=listingUrlOrObj}deprecationMessage(deprecateMsg,XmlHttpRequest2.Name,{index:typeof listingUrlOrObj==="string"?listingUrlOrObj:"file index as an object",baseUrl:prefixUrl});this._index=FileIndex.fromListing(listing)}if(BaseFileSystem$$1)XmlHttpRequest2.__proto__=BaseFileSystem$$1;XmlHttpRequest2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);XmlHttpRequest2.prototype.constructor=XmlHttpRequest2;XmlHttpRequest2.Create=function Create(opts,cb){if(opts.index===void 0){opts.index="index.json"}if(typeof opts.index==="string"){XmlHttpRequest2.FromURL(opts.index,cb,opts.baseUrl,false)}else{cb(null,new XmlHttpRequest2(opts.index,opts.baseUrl,false))}};XmlHttpRequest2.isAvailable=function isAvailable(){return typeof XMLHttpRequest!=="undefined"&&XMLHttpRequest!==null};XmlHttpRequest2.FromURL=function FromURL(url2,cb,baseUrl,deprecateMsg){if(baseUrl===void 0)baseUrl=url2.slice(0,url2.lastIndexOf("/")+1);if(deprecateMsg===void 0)deprecateMsg=true;if(deprecateMsg){console.warn(`[XmlHttpRequest] XmlHttpRequest.FromURL() is deprecated and will be removed in the next major release. Please use \'XmlHttpRequest.Create({ index: "`+url2+\'", baseUrl: "\'+baseUrl+`" }, cb)\' instead.`)}asyncDownloadFile(url2,"json",function(e,data){if(e){cb(e)}else{cb(null,new XmlHttpRequest2(data,baseUrl,false))}})};XmlHttpRequest2.prototype.empty=function empty(){this._index.fileIterator(function(file){file.fileData=null})};XmlHttpRequest2.prototype.getName=function getName(){return XmlHttpRequest2.Name};XmlHttpRequest2.prototype.diskSpace=function diskSpace(path$$1,cb){cb(0,0)};XmlHttpRequest2.prototype.isReadOnly=function isReadOnly(){return true};XmlHttpRequest2.prototype.supportsLinks=function supportsLinks(){return false};XmlHttpRequest2.prototype.supportsProps=function supportsProps(){return false};XmlHttpRequest2.prototype.supportsSynch=function supportsSynch(){return true};XmlHttpRequest2.prototype.preloadFile=function preloadFile(path$$1,buffer$$1){var inode=this._index.getInode(path$$1);if(isFileInode(inode)){if(inode===null){throw ApiError.ENOENT(path$$1)}var stats=inode.getData();stats.size=buffer$$1.length;stats.fileData=buffer$$1}else{throw ApiError.EISDIR(path$$1)}};XmlHttpRequest2.prototype.stat=function stat(path$$1,isLstat,cb){var inode=this._index.getInode(path$$1);if(inode===null){return cb(ApiError.ENOENT(path$$1))}var stats;if(isFileInode(inode)){stats=inode.getData();if(stats.size<0){this._requestFileSizeAsync(path$$1,function(e,size){if(e){return cb(e)}stats.size=size;cb(null,stats.clone())})}else{cb(null,stats.clone())}}else if(isDirInode(inode)){stats=inode.getStats();cb(null,stats)}else{cb(ApiError.FileError(ErrorCode.EINVAL,path$$1))}};XmlHttpRequest2.prototype.statSync=function statSync(path$$1,isLstat){var inode=this._index.getInode(path$$1);if(inode===null){throw ApiError.ENOENT(path$$1)}var stats;if(isFileInode(inode)){stats=inode.getData();if(stats.size<0){stats.size=this._requestFileSizeSync(path$$1)}}else if(isDirInode(inode)){stats=inode.getStats()}else{throw ApiError.FileError(ErrorCode.EINVAL,path$$1)}return stats};XmlHttpRequest2.prototype.open=function open(path$$1,flags,mode,cb){if(flags.isWriteable()){return cb(new ApiError(ErrorCode.EPERM,path$$1))}var self2=this;var inode=this._index.getInode(path$$1);if(inode===null){return cb(ApiError.ENOENT(path$$1))}if(isFileInode(inode)){var stats=inode.getData();switch(flags.pathExistsAction()){case ActionType.THROW_EXCEPTION:case ActionType.TRUNCATE_FILE:return cb(ApiError.EEXIST(path$$1));case ActionType.NOP:if(stats.fileData){return cb(null,new NoSyncFile(self2,path$$1,flags,stats.clone(),stats.fileData))}this._requestFileAsync(path$$1,"buffer",function(err,buffer$$1){if(err){return cb(err)}stats.size=buffer$$1.length;stats.fileData=buffer$$1;return cb(null,new NoSyncFile(self2,path$$1,flags,stats.clone(),buffer$$1))});break;default:return cb(new ApiError(ErrorCode.EINVAL,"Invalid FileMode object."))}}else{return cb(ApiError.EISDIR(path$$1))}};XmlHttpRequest2.prototype.openSync=function openSync(path$$1,flags,mode){if(flags.isWriteable()){throw new ApiError(ErrorCode.EPERM,path$$1)}var inode=this._index.getInode(path$$1);if(inode===null){throw ApiError.ENOENT(path$$1)}if(isFileInode(inode)){var stats=inode.getData();switch(flags.pathExistsAction()){case ActionType.THROW_EXCEPTION:case ActionType.TRUNCATE_FILE:throw ApiError.EEXIST(path$$1);case ActionType.NOP:if(stats.fileData){return new NoSyncFile(this,path$$1,flags,stats.clone(),stats.fileData)}var buffer$$1=this._requestFileSync(path$$1,"buffer");stats.size=buffer$$1.length;stats.fileData=buffer$$1;return new NoSyncFile(this,path$$1,flags,stats.clone(),buffer$$1);default:throw new ApiError(ErrorCode.EINVAL,"Invalid FileMode object.")}}else{throw ApiError.EISDIR(path$$1)}};XmlHttpRequest2.prototype.readdir=function readdir(path$$1,cb){try{cb(null,this.readdirSync(path$$1))}catch(e){cb(e)}};XmlHttpRequest2.prototype.readdirSync=function readdirSync(path$$1){var inode=this._index.getInode(path$$1);if(inode===null){throw ApiError.ENOENT(path$$1)}else if(isDirInode(inode)){return inode.getListing()}else{throw ApiError.ENOTDIR(path$$1)}};XmlHttpRequest2.prototype.readFile=function readFile2(fname,encoding,flag,cb){var oldCb=cb;this.open(fname,flag,420,function(err,fd){if(err){return cb(err)}cb=function(err2,arg){fd.close(function(err22){if(!err2){err2=err22}return oldCb(err2,arg)})};var fdCast=fd;var fdBuff=fdCast.getBuffer();if(encoding===null){cb(err,copyingSlice(fdBuff))}else{tryToString(fdBuff,encoding,cb)}})};XmlHttpRequest2.prototype.readFileSync=function readFileSync(fname,encoding,flag){var fd=this.openSync(fname,flag,420);try{var fdCast=fd;var fdBuff=fdCast.getBuffer();if(encoding===null){return copyingSlice(fdBuff)}return fdBuff.toString(encoding)}finally{fd.closeSync()}};XmlHttpRequest2.prototype.getXhrPath=function getXhrPath(filePath){if(filePath.charAt(0)==="/"){filePath=filePath.slice(1)}return this.prefixUrl+filePath};XmlHttpRequest2.prototype._requestFileAsync=function _requestFileAsync(p2,type,cb){asyncDownloadFile(this.getXhrPath(p2),type,cb)};XmlHttpRequest2.prototype._requestFileSync=function _requestFileSync(p2,type){return syncDownloadFile(this.getXhrPath(p2),type)};XmlHttpRequest2.prototype._requestFileSizeAsync=function _requestFileSizeAsync(path$$1,cb){getFileSizeAsync(this.getXhrPath(path$$1),cb)};XmlHttpRequest2.prototype._requestFileSizeSync=function _requestFileSizeSync(path$$1){return getFileSizeSync(this.getXhrPath(path$$1))};return XmlHttpRequest2}(BaseFileSystem);XmlHttpRequest.Name="XmlHttpRequest";XmlHttpRequest.Options={index:{type:["string","object"],optional:true,description:"URL to a file index as a JSON file or the file index object itself, generated with the make_xhrfs_index script. Defaults to `index.json`."},baseUrl:{type:"string",optional:true,description:"Used as the URL prefix for fetched files. Default: Fetch files relative to the index."}};var ExtendedASCII=function ExtendedASCII2(){};ExtendedASCII.str2byte=function str2byte(str4,buf){var length=str4.length>buf.length?buf.length:str4.length;for(var i22=0;i22<length;i22++){var charCode=str4.charCodeAt(i22);if(charCode>127){var charIdx=ExtendedASCII.extendedChars.indexOf(str4.charAt(i22));if(charIdx>-1){charCode=charIdx+128}}buf[charCode]=i22}return length};ExtendedASCII.byte2str=function byte2str(buff){var chars=new Array(buff.length);for(var i22=0;i22<buff.length;i22++){var charCode=buff[i22];if(charCode>127){chars[i22]=ExtendedASCII.extendedChars[charCode-128]}else{chars[i22]=String.fromCharCode(charCode)}}return chars.join("")};ExtendedASCII.byteLength=function byteLength(str4){return str4.length};ExtendedASCII.extendedChars=["\\xC7","\\xFC","\\xE9","\\xE2","\\xE4","\\xE0","\\xE5","\\xE7","\\xEA","\\xEB","\\xE8","\\xEF","\\xEE","\\xEC","\\xC4","\\xC5","\\xC9","\\xE6","\\xC6","\\xF4","\\xF6","\\xF2","\\xFB","\\xF9","\\xFF","\\xD6","\\xDC","\\xF8","\\xA3","\\xD8","\\xD7","\\u0192","\\xE1","\\xED","\\xF3","\\xFA","\\xF1","\\xD1","\\xAA","\\xBA","\\xBF","\\xAE","\\xAC","\\xBD","\\xBC","\\xA1","\\xAB","\\xBB","_","_","_","\\xA6","\\xA6","\\xC1","\\xC2","\\xC0","\\xA9","\\xA6","\\xA6","+","+","\\xA2","\\xA5","+","+","-","-","+","-","+","\\xE3","\\xC3","+","+","-","-","\\xA6","-","+","\\xA4","\\xF0","\\xD0","\\xCA","\\xCB","\\xC8","i","\\xCD","\\xCE","\\xCF","+","+","_","_","\\xA6","\\xCC","_","\\xD3","\\xDF","\\xD4","\\xD2","\\xF5","\\xD5","\\xB5","\\xFE","\\xDE","\\xDA","\\xDB","\\xD9","\\xFD","\\xDD","\\xAF","\\xB4","\\xAD","\\xB1","_","\\xBE","\\xB6","\\xA7","\\xF7","\\xB8","\\xB0","\\xA8","\\xB7","\\xB9","\\xB3","\\xB2","_"," "];var inflateRaw=__webpack_require__(31).inflateRaw;var decompressionMethods={};var ExternalFileAttributeType;(function(ExternalFileAttributeType2){ExternalFileAttributeType2[ExternalFileAttributeType2["MSDOS"]=0]="MSDOS";ExternalFileAttributeType2[ExternalFileAttributeType2["AMIGA"]=1]="AMIGA";ExternalFileAttributeType2[ExternalFileAttributeType2["OPENVMS"]=2]="OPENVMS";ExternalFileAttributeType2[ExternalFileAttributeType2["UNIX"]=3]="UNIX";ExternalFileAttributeType2[ExternalFileAttributeType2["VM_CMS"]=4]="VM_CMS";ExternalFileAttributeType2[ExternalFileAttributeType2["ATARI_ST"]=5]="ATARI_ST";ExternalFileAttributeType2[ExternalFileAttributeType2["OS2_HPFS"]=6]="OS2_HPFS";ExternalFileAttributeType2[ExternalFileAttributeType2["MAC"]=7]="MAC";ExternalFileAttributeType2[ExternalFileAttributeType2["Z_SYSTEM"]=8]="Z_SYSTEM";ExternalFileAttributeType2[ExternalFileAttributeType2["CP_M"]=9]="CP_M";ExternalFileAttributeType2[ExternalFileAttributeType2["NTFS"]=10]="NTFS";ExternalFileAttributeType2[ExternalFileAttributeType2["MVS"]=11]="MVS";ExternalFileAttributeType2[ExternalFileAttributeType2["VSE"]=12]="VSE";ExternalFileAttributeType2[ExternalFileAttributeType2["ACORN_RISC"]=13]="ACORN_RISC";ExternalFileAttributeType2[ExternalFileAttributeType2["VFAT"]=14]="VFAT";ExternalFileAttributeType2[ExternalFileAttributeType2["ALT_MVS"]=15]="ALT_MVS";ExternalFileAttributeType2[ExternalFileAttributeType2["BEOS"]=16]="BEOS";ExternalFileAttributeType2[ExternalFileAttributeType2["TANDEM"]=17]="TANDEM";ExternalFileAttributeType2[ExternalFileAttributeType2["OS_400"]=18]="OS_400";ExternalFileAttributeType2[ExternalFileAttributeType2["OSX"]=19]="OSX"})(ExternalFileAttributeType||(ExternalFileAttributeType={}));var CompressionMethod;(function(CompressionMethod2){CompressionMethod2[CompressionMethod2["STORED"]=0]="STORED";CompressionMethod2[CompressionMethod2["SHRUNK"]=1]="SHRUNK";CompressionMethod2[CompressionMethod2["REDUCED_1"]=2]="REDUCED_1";CompressionMethod2[CompressionMethod2["REDUCED_2"]=3]="REDUCED_2";CompressionMethod2[CompressionMethod2["REDUCED_3"]=4]="REDUCED_3";CompressionMethod2[CompressionMethod2["REDUCED_4"]=5]="REDUCED_4";CompressionMethod2[CompressionMethod2["IMPLODE"]=6]="IMPLODE";CompressionMethod2[CompressionMethod2["DEFLATE"]=8]="DEFLATE";CompressionMethod2[CompressionMethod2["DEFLATE64"]=9]="DEFLATE64";CompressionMethod2[CompressionMethod2["TERSE_OLD"]=10]="TERSE_OLD";CompressionMethod2[CompressionMethod2["BZIP2"]=12]="BZIP2";CompressionMethod2[CompressionMethod2["LZMA"]=14]="LZMA";CompressionMethod2[CompressionMethod2["TERSE_NEW"]=18]="TERSE_NEW";CompressionMethod2[CompressionMethod2["LZ77"]=19]="LZ77";CompressionMethod2[CompressionMethod2["WAVPACK"]=97]="WAVPACK";CompressionMethod2[CompressionMethod2["PPMD"]=98]="PPMD"})(CompressionMethod||(CompressionMethod={}));function msdos2date(time,date){var day=date&31;var month=(date>>5&15)-1;var year=(date>>9)+1980;var second=time&31;var minute=time>>5&63;var hour=time>>11;return new Date(year,month,day,hour,minute,second)}function safeToString(buff,useUTF8,start,length){if(length===0){return""}else if(useUTF8){return buff.toString("utf8",start,start+length)}else{return ExtendedASCII.byte2str(buff.slice(start,start+length))}}var FileHeader=function FileHeader2(data){this.data=data;if(data.readUInt32LE(0)!==67324752){throw new ApiError(ErrorCode.EINVAL,"Invalid Zip file: Local file header has invalid signature: "+this.data.readUInt32LE(0))}};FileHeader.prototype.versionNeeded=function versionNeeded(){return this.data.readUInt16LE(4)};FileHeader.prototype.flags=function flags(){return this.data.readUInt16LE(6)};FileHeader.prototype.compressionMethod=function compressionMethod(){return this.data.readUInt16LE(8)};FileHeader.prototype.lastModFileTime=function lastModFileTime(){return msdos2date(this.data.readUInt16LE(10),this.data.readUInt16LE(12))};FileHeader.prototype.rawLastModFileTime=function rawLastModFileTime(){return this.data.readUInt32LE(10)};FileHeader.prototype.crc32=function crc32(){return this.data.readUInt32LE(14)};FileHeader.prototype.fileNameLength=function fileNameLength(){return this.data.readUInt16LE(26)};FileHeader.prototype.extraFieldLength=function extraFieldLength(){return this.data.readUInt16LE(28)};FileHeader.prototype.fileName=function fileName(){return safeToString(this.data,this.useUTF8(),30,this.fileNameLength())};FileHeader.prototype.extraField=function extraField(){var start=30+this.fileNameLength();return this.data.slice(start,start+this.extraFieldLength())};FileHeader.prototype.totalSize=function totalSize(){return 30+this.fileNameLength()+this.extraFieldLength()};FileHeader.prototype.useUTF8=function useUTF8(){return(this.flags()&2048)===2048};var FileData=function FileData2(header,record,data){this.header=header;this.record=record;this.data=data};FileData.prototype.decompress=function decompress(){var compressionMethod=this.header.compressionMethod();var fcn=decompressionMethods[compressionMethod];if(fcn){return fcn(this.data,this.record.compressedSize(),this.record.uncompressedSize(),this.record.flag())}else{var name2=CompressionMethod[compressionMethod];if(!name2){name2="Unknown: "+compressionMethod}throw new ApiError(ErrorCode.EINVAL,"Invalid compression method on file \'"+this.header.fileName()+"\': "+name2)}};FileData.prototype.getHeader=function getHeader(){return this.header};FileData.prototype.getRecord=function getRecord(){return this.record};FileData.prototype.getRawData=function getRawData(){return this.data};var DataDescriptor=function DataDescriptor2(data){this.data=data};DataDescriptor.prototype.crc32=function crc32(){return this.data.readUInt32LE(0)};DataDescriptor.prototype.compressedSize=function compressedSize(){return this.data.readUInt32LE(4)};DataDescriptor.prototype.uncompressedSize=function uncompressedSize(){return this.data.readUInt32LE(8)};var ArchiveExtraDataRecord=function ArchiveExtraDataRecord2(data){this.data=data;if(this.data.readUInt32LE(0)!==134630224){throw new ApiError(ErrorCode.EINVAL,"Invalid archive extra data record signature: "+this.data.readUInt32LE(0))}};ArchiveExtraDataRecord.prototype.length=function length(){return this.data.readUInt32LE(4)};ArchiveExtraDataRecord.prototype.extraFieldData=function extraFieldData(){return this.data.slice(8,8+this.length())};var DigitalSignature=function DigitalSignature2(data){this.data=data;if(this.data.readUInt32LE(0)!==84233040){throw new ApiError(ErrorCode.EINVAL,"Invalid digital signature signature: "+this.data.readUInt32LE(0))}};DigitalSignature.prototype.size=function size(){return this.data.readUInt16LE(4)};DigitalSignature.prototype.signatureData=function signatureData(){return this.data.slice(6,6+this.size())};var CentralDirectory=function CentralDirectory2(zipData,data){this.zipData=zipData;this.data=data;if(this.data.readUInt32LE(0)!==33639248){throw new ApiError(ErrorCode.EINVAL,"Invalid Zip file: Central directory record has invalid signature: "+this.data.readUInt32LE(0))}this._filename=this.produceFilename()};CentralDirectory.prototype.versionMadeBy=function versionMadeBy(){return this.data.readUInt16LE(4)};CentralDirectory.prototype.versionNeeded=function versionNeeded(){return this.data.readUInt16LE(6)};CentralDirectory.prototype.flag=function flag(){return this.data.readUInt16LE(8)};CentralDirectory.prototype.compressionMethod=function compressionMethod(){return this.data.readUInt16LE(10)};CentralDirectory.prototype.lastModFileTime=function lastModFileTime(){return msdos2date(this.data.readUInt16LE(12),this.data.readUInt16LE(14))};CentralDirectory.prototype.rawLastModFileTime=function rawLastModFileTime(){return this.data.readUInt32LE(12)};CentralDirectory.prototype.crc32=function crc32(){return this.data.readUInt32LE(16)};CentralDirectory.prototype.compressedSize=function compressedSize(){return this.data.readUInt32LE(20)};CentralDirectory.prototype.uncompressedSize=function uncompressedSize(){return this.data.readUInt32LE(24)};CentralDirectory.prototype.fileNameLength=function fileNameLength(){return this.data.readUInt16LE(28)};CentralDirectory.prototype.extraFieldLength=function extraFieldLength(){return this.data.readUInt16LE(30)};CentralDirectory.prototype.fileCommentLength=function fileCommentLength(){return this.data.readUInt16LE(32)};CentralDirectory.prototype.diskNumberStart=function diskNumberStart(){return this.data.readUInt16LE(34)};CentralDirectory.prototype.internalAttributes=function internalAttributes(){return this.data.readUInt16LE(36)};CentralDirectory.prototype.externalAttributes=function externalAttributes(){return this.data.readUInt32LE(38)};CentralDirectory.prototype.headerRelativeOffset=function headerRelativeOffset(){return this.data.readUInt32LE(42)};CentralDirectory.prototype.produceFilename=function produceFilename(){var fileName=safeToString(this.data,this.useUTF8(),46,this.fileNameLength());return fileName.replace(/\\\\/g,"/")};CentralDirectory.prototype.fileName=function fileName(){return this._filename};CentralDirectory.prototype.rawFileName=function rawFileName(){return this.data.slice(46,46+this.fileNameLength())};CentralDirectory.prototype.extraField=function extraField(){var start=44+this.fileNameLength();return this.data.slice(start,start+this.extraFieldLength())};CentralDirectory.prototype.fileComment=function fileComment(){var start=46+this.fileNameLength()+this.extraFieldLength();return safeToString(this.data,this.useUTF8(),start,this.fileCommentLength())};CentralDirectory.prototype.rawFileComment=function rawFileComment(){var start=46+this.fileNameLength()+this.extraFieldLength();return this.data.slice(start,start+this.fileCommentLength())};CentralDirectory.prototype.totalSize=function totalSize(){return 46+this.fileNameLength()+this.extraFieldLength()+this.fileCommentLength()};CentralDirectory.prototype.isDirectory=function isDirectory(){var fileName=this.fileName();return(this.externalAttributes()&16?true:false)||fileName.charAt(fileName.length-1)==="/"};CentralDirectory.prototype.isFile=function isFile(){return!this.isDirectory()};CentralDirectory.prototype.useUTF8=function useUTF8(){return(this.flag()&2048)===2048};CentralDirectory.prototype.isEncrypted=function isEncrypted(){return(this.flag()&1)===1};CentralDirectory.prototype.getFileData=function getFileData(){var start=this.headerRelativeOffset();var header=new FileHeader(this.zipData.slice(start));return new FileData(header,this,this.zipData.slice(start+header.totalSize()))};CentralDirectory.prototype.getData=function getData(){return this.getFileData().decompress()};CentralDirectory.prototype.getRawData=function getRawData(){return this.getFileData().getRawData()};CentralDirectory.prototype.getStats=function getStats(){return new Stats(FileType.FILE,this.uncompressedSize(),365,new Date,this.lastModFileTime())};var EndOfCentralDirectory=function EndOfCentralDirectory2(data){this.data=data;if(this.data.readUInt32LE(0)!==101010256){throw new ApiError(ErrorCode.EINVAL,"Invalid Zip file: End of central directory record has invalid signature: "+this.data.readUInt32LE(0))}};EndOfCentralDirectory.prototype.diskNumber=function diskNumber(){return this.data.readUInt16LE(4)};EndOfCentralDirectory.prototype.cdDiskNumber=function cdDiskNumber(){return this.data.readUInt16LE(6)};EndOfCentralDirectory.prototype.cdDiskEntryCount=function cdDiskEntryCount(){return this.data.readUInt16LE(8)};EndOfCentralDirectory.prototype.cdTotalEntryCount=function cdTotalEntryCount(){return this.data.readUInt16LE(10)};EndOfCentralDirectory.prototype.cdSize=function cdSize(){return this.data.readUInt32LE(12)};EndOfCentralDirectory.prototype.cdOffset=function cdOffset(){return this.data.readUInt32LE(16)};EndOfCentralDirectory.prototype.cdZipCommentLength=function cdZipCommentLength(){return this.data.readUInt16LE(20)};EndOfCentralDirectory.prototype.cdZipComment=function cdZipComment(){return safeToString(this.data,true,22,this.cdZipCommentLength())};EndOfCentralDirectory.prototype.rawCdZipComment=function rawCdZipComment(){return this.data.slice(22,22+this.cdZipCommentLength())};var ZipTOC=function ZipTOC2(index,directoryEntries,eocd,data){this.index=index;this.directoryEntries=directoryEntries;this.eocd=eocd;this.data=data};var ZipFS=function(SynchronousFileSystem$$1){function ZipFS2(input,name2,deprecateMsg){if(name2===void 0)name2="";if(deprecateMsg===void 0)deprecateMsg=true;SynchronousFileSystem$$1.call(this);this.name=name2;this._index=new FileIndex;this._directoryEntries=[];this._eocd=null;deprecationMessage(deprecateMsg,ZipFS2.Name,{zipData:"zip data as a Buffer",name:name2});if(input instanceof ZipTOC){this._index=input.index;this._directoryEntries=input.directoryEntries;this._eocd=input.eocd;this.data=input.data}else{this.data=input;this.populateIndex()}}if(SynchronousFileSystem$$1)ZipFS2.__proto__=SynchronousFileSystem$$1;ZipFS2.prototype=Object.create(SynchronousFileSystem$$1&&SynchronousFileSystem$$1.prototype);ZipFS2.prototype.constructor=ZipFS2;ZipFS2.Create=function Create(opts,cb){try{ZipFS2.computeIndex(opts.zipData,function(zipTOC){var fs4=new ZipFS2(zipTOC,opts.name,false);cb(null,fs4)},false)}catch(e){cb(e)}};ZipFS2.isAvailable=function isAvailable(){return true};ZipFS2.RegisterDecompressionMethod=function RegisterDecompressionMethod(m,fcn){decompressionMethods[m]=fcn};ZipFS2.computeIndex=function computeIndex(data,cb,deprecateMsg){if(deprecateMsg===void 0)deprecateMsg=true;if(deprecateMsg){console.warn("[ZipFS] ZipFS.computeIndex is now deprecated, and will be removed in the next major release. Please update your code to use \'ZipFS.Create({ zipData: zip file as a Buffer}, cb)\' instead.")}var index=new FileIndex;var eocd=ZipFS2.getEOCD(data);if(eocd.diskNumber()!==eocd.cdDiskNumber()){throw new ApiError(ErrorCode.EINVAL,"ZipFS does not support spanned zip files.")}var cdPtr=eocd.cdOffset();if(cdPtr===4294967295){throw new ApiError(ErrorCode.EINVAL,"ZipFS does not support Zip64.")}var cdEnd=cdPtr+eocd.cdSize();ZipFS2.computeIndexResponsive(data,index,cdPtr,cdEnd,cb,[],eocd)};ZipFS2.getEOCD=function getEOCD(data){var startOffset=22;var endOffset=Math.min(startOffset+65535,data.length-1);for(var i22=startOffset;i22<endOffset;i22++){if(data.readUInt32LE(data.length-i22)===101010256){return new EndOfCentralDirectory(data.slice(data.length-i22))}}throw new ApiError(ErrorCode.EINVAL,"Invalid ZIP file: Could not locate End of Central Directory signature.")};ZipFS2.addToIndex=function addToIndex(cd,index){var filename=cd.fileName();if(filename.charAt(0)==="/"){throw new Error("WHY IS THIS ABSOLUTE")}if(filename.charAt(filename.length-1)==="/"){filename=filename.substr(0,filename.length-1)}if(cd.isDirectory()){index.addPathFast("/"+filename,new DirInode(cd))}else{index.addPathFast("/"+filename,new FileInode(cd))}};ZipFS2.computeIndexResponsive=function computeIndexResponsive(data,index,cdPtr,cdEnd,cb,cdEntries,eocd){if(cdPtr<cdEnd){var count=0;while(count++<200&&cdPtr<cdEnd){var cd=new CentralDirectory(data,data.slice(cdPtr));ZipFS2.addToIndex(cd,index);cdPtr+=cd.totalSize();cdEntries.push(cd)}setImmediate$3(function(){ZipFS2.computeIndexResponsive(data,index,cdPtr,cdEnd,cb,cdEntries,eocd)})}else{cb(new ZipTOC(index,cdEntries,eocd,data))}};ZipFS2.prototype.getName=function getName(){return ZipFS2.Name+(this.name!==""?" "+this.name:"")};ZipFS2.prototype.getCentralDirectoryEntry=function getCentralDirectoryEntry(path$$1){var inode=this._index.getInode(path$$1);if(inode===null){throw ApiError.ENOENT(path$$1)}if(isFileInode(inode)){return inode.getData()}else if(isDirInode(inode)){return inode.getData()}else{throw ApiError.EPERM("Invalid inode: "+inode)}};ZipFS2.prototype.getCentralDirectoryEntryAt=function getCentralDirectoryEntryAt(index){var dirEntry=this._directoryEntries[index];if(!dirEntry){throw new RangeError("Invalid directory index: "+index+".")}return dirEntry};ZipFS2.prototype.getNumberOfCentralDirectoryEntries=function getNumberOfCentralDirectoryEntries(){return this._directoryEntries.length};ZipFS2.prototype.getEndOfCentralDirectory=function getEndOfCentralDirectory(){return this._eocd};ZipFS2.prototype.diskSpace=function diskSpace(path$$1,cb){cb(this.data.length,0)};ZipFS2.prototype.isReadOnly=function isReadOnly(){return true};ZipFS2.prototype.supportsLinks=function supportsLinks(){return false};ZipFS2.prototype.supportsProps=function supportsProps(){return false};ZipFS2.prototype.supportsSynch=function supportsSynch(){return true};ZipFS2.prototype.statSync=function statSync(path$$1,isLstat){var inode=this._index.getInode(path$$1);if(inode===null){throw ApiError.ENOENT(path$$1)}var stats;if(isFileInode(inode)){stats=inode.getData().getStats()}else if(isDirInode(inode)){stats=inode.getStats()}else{throw new ApiError(ErrorCode.EINVAL,"Invalid inode.")}return stats};ZipFS2.prototype.openSync=function openSync(path$$1,flags,mode){if(flags.isWriteable()){throw new ApiError(ErrorCode.EPERM,path$$1)}var inode=this._index.getInode(path$$1);if(!inode){throw ApiError.ENOENT(path$$1)}else if(isFileInode(inode)){var cdRecord=inode.getData();var stats=cdRecord.getStats();switch(flags.pathExistsAction()){case ActionType.THROW_EXCEPTION:case ActionType.TRUNCATE_FILE:throw ApiError.EEXIST(path$$1);case ActionType.NOP:return new NoSyncFile(this,path$$1,flags,stats,cdRecord.getData());default:throw new ApiError(ErrorCode.EINVAL,"Invalid FileMode object.")}}else{throw ApiError.EISDIR(path$$1)}};ZipFS2.prototype.readdirSync=function readdirSync(path$$1){var inode=this._index.getInode(path$$1);if(!inode){throw ApiError.ENOENT(path$$1)}else if(isDirInode(inode)){return inode.getListing()}else{throw ApiError.ENOTDIR(path$$1)}};ZipFS2.prototype.readFileSync=function readFileSync(fname,encoding,flag){var fd=this.openSync(fname,flag,420);try{var fdCast=fd;var fdBuff=fdCast.getBuffer();if(encoding===null){return copyingSlice(fdBuff)}return fdBuff.toString(encoding)}finally{fd.closeSync()}};ZipFS2.prototype.populateIndex=function populateIndex(){var this$1=this;var eocd=this._eocd=ZipFS2.getEOCD(this.data);if(eocd.diskNumber()!==eocd.cdDiskNumber()){throw new ApiError(ErrorCode.EINVAL,"ZipFS does not support spanned zip files.")}var cdPtr=eocd.cdOffset();if(cdPtr===4294967295){throw new ApiError(ErrorCode.EINVAL,"ZipFS does not support Zip64.")}var cdEnd=cdPtr+eocd.cdSize();while(cdPtr<cdEnd){var cd=new CentralDirectory(this$1.data,this$1.data.slice(cdPtr));cdPtr+=cd.totalSize();ZipFS2.addToIndex(cd,this$1._index);this$1._directoryEntries.push(cd)}};return ZipFS2}(SynchronousFileSystem);ZipFS.Name="ZipFS";ZipFS.Options={zipData:{type:"object",description:"The zip file as a Buffer object.",validator:bufferValidator},name:{type:"string",optional:true,description:"The name of the zip file (optional)."}};ZipFS.CompressionMethod=CompressionMethod;ZipFS.RegisterDecompressionMethod(CompressionMethod.DEFLATE,function(data,compressedSize,uncompressedSize){return arrayish2Buffer(inflateRaw(data.slice(0,compressedSize),{chunkSize:uncompressedSize}))});ZipFS.RegisterDecompressionMethod(CompressionMethod.STORED,function(data,compressedSize,uncompressedSize){return copyingSlice(data,0,uncompressedSize)});var rockRidgeIdentifier="IEEE_P1282";function getASCIIString(data,startIndex,length){return data.toString("ascii",startIndex,startIndex+length).trim()}function getJolietString(data,startIndex,length){if(length===1){return String.fromCharCode(data[startIndex])}var pairs=Math.floor(length/2);var chars=new Array(pairs);for(var i22=0;i22<pairs;i22++){var pos=startIndex+(i22<<1);chars[i22]=String.fromCharCode(data[pos+1]|data[pos]<<8)}return chars.join("")}function getDate(data,startIndex){var year=parseInt(getASCIIString(data,startIndex,4),10);var mon=parseInt(getASCIIString(data,startIndex+4,2),10);var day=parseInt(getASCIIString(data,startIndex+6,2),10);var hour=parseInt(getASCIIString(data,startIndex+8,2),10);var min=parseInt(getASCIIString(data,startIndex+10,2),10);var sec=parseInt(getASCIIString(data,startIndex+12,2),10);var hundrethsSec=parseInt(getASCIIString(data,startIndex+14,2),10);return new Date(year,mon,day,hour,min,sec,hundrethsSec*100)}function getShortFormDate(data,startIndex){var yearsSince1900=data[startIndex];var month=data[startIndex+1];var day=data[startIndex+2];var hour=data[startIndex+3];var minute=data[startIndex+4];var second=data[startIndex+5];return new Date(yearsSince1900,month-1,day,hour,minute,second)}function constructSystemUseEntry(bigData,i22){var data=bigData.slice(i22);var sue=new SystemUseEntry(data);switch(sue.signatureWord()){case 17221:return new CEEntry(data);case 20548:return new PDEntry(data);case 21328:return new SPEntry(data);case 21332:return new STEntry(data);case 17746:return new EREntry(data);case 17747:return new ESEntry(data);case 20568:return new PXEntry(data);case 20558:return new PNEntry(data);case 21324:return new SLEntry(data);case 20045:return new NMEntry(data);case 17228:return new CLEntry(data);case 20556:return new PLEntry(data);case 21061:return new REEntry(data);case 21574:return new TFEntry(data);case 21318:return new SFEntry(data);case 21074:return new RREntry(data);default:return sue}}function constructSystemUseEntries(data,i22,len,isoData){len=len-4;var entries=new Array;while(i22<len){var entry=constructSystemUseEntry(data,i22);var length=entry.length();if(length===0){return entries}i22+=length;if(entry instanceof STEntry){break}if(entry instanceof CEEntry){entries=entries.concat(entry.getEntries(isoData))}else{entries.push(entry)}}return entries}var VolumeDescriptor=function VolumeDescriptor2(data){this._data=data};VolumeDescriptor.prototype.type=function type(){return this._data[0]};VolumeDescriptor.prototype.standardIdentifier=function standardIdentifier(){return getASCIIString(this._data,1,5)};VolumeDescriptor.prototype.version=function version(){return this._data[6]};VolumeDescriptor.prototype.data=function data(){return this._data.slice(7,2048)};var PrimaryOrSupplementaryVolumeDescriptor=function(VolumeDescriptor2){function PrimaryOrSupplementaryVolumeDescriptor2(data){VolumeDescriptor2.call(this,data);this._root=null}if(VolumeDescriptor2)PrimaryOrSupplementaryVolumeDescriptor2.__proto__=VolumeDescriptor2;PrimaryOrSupplementaryVolumeDescriptor2.prototype=Object.create(VolumeDescriptor2&&VolumeDescriptor2.prototype);PrimaryOrSupplementaryVolumeDescriptor2.prototype.constructor=PrimaryOrSupplementaryVolumeDescriptor2;PrimaryOrSupplementaryVolumeDescriptor2.prototype.systemIdentifier=function systemIdentifier(){return this._getString32(8)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeIdentifier=function volumeIdentifier(){return this._getString32(40)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeSpaceSize=function volumeSpaceSize(){return this._data.readUInt32LE(80)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeSetSize=function volumeSetSize(){return this._data.readUInt16LE(120)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeSequenceNumber=function volumeSequenceNumber(){return this._data.readUInt16LE(124)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.logicalBlockSize=function logicalBlockSize(){return this._data.readUInt16LE(128)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.pathTableSize=function pathTableSize(){return this._data.readUInt32LE(132)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.locationOfTypeLPathTable=function locationOfTypeLPathTable(){return this._data.readUInt32LE(140)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.locationOfOptionalTypeLPathTable=function locationOfOptionalTypeLPathTable(){return this._data.readUInt32LE(144)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.locationOfTypeMPathTable=function locationOfTypeMPathTable(){return this._data.readUInt32BE(148)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.locationOfOptionalTypeMPathTable=function locationOfOptionalTypeMPathTable(){return this._data.readUInt32BE(152)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.rootDirectoryEntry=function rootDirectoryEntry(isoData){if(this._root===null){this._root=this._constructRootDirectoryRecord(this._data.slice(156));this._root.rootCheckForRockRidge(isoData)}return this._root};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeSetIdentifier=function volumeSetIdentifier(){return this._getString(190,128)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.publisherIdentifier=function publisherIdentifier(){return this._getString(318,128)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.dataPreparerIdentifier=function dataPreparerIdentifier(){return this._getString(446,128)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.applicationIdentifier=function applicationIdentifier(){return this._getString(574,128)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.copyrightFileIdentifier=function copyrightFileIdentifier(){return this._getString(702,38)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.abstractFileIdentifier=function abstractFileIdentifier(){return this._getString(740,36)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.bibliographicFileIdentifier=function bibliographicFileIdentifier(){return this._getString(776,37)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeCreationDate=function volumeCreationDate(){return getDate(this._data,813)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeModificationDate=function volumeModificationDate(){return getDate(this._data,830)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeExpirationDate=function volumeExpirationDate(){return getDate(this._data,847)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeEffectiveDate=function volumeEffectiveDate(){return getDate(this._data,864)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.fileStructureVersion=function fileStructureVersion(){return this._data[881]};PrimaryOrSupplementaryVolumeDescriptor2.prototype.applicationUsed=function applicationUsed(){return this._data.slice(883,883+512)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.reserved=function reserved(){return this._data.slice(1395,1395+653)};PrimaryOrSupplementaryVolumeDescriptor2.prototype._getString32=function _getString32(idx){return this._getString(idx,32)};return PrimaryOrSupplementaryVolumeDescriptor2}(VolumeDescriptor);var PrimaryVolumeDescriptor=function(PrimaryOrSupplementaryVolumeDescriptor2){function PrimaryVolumeDescriptor2(data){PrimaryOrSupplementaryVolumeDescriptor2.call(this,data);if(this.type()!==1){throw new ApiError(ErrorCode.EIO,"Invalid primary volume descriptor.")}}if(PrimaryOrSupplementaryVolumeDescriptor2)PrimaryVolumeDescriptor2.__proto__=PrimaryOrSupplementaryVolumeDescriptor2;PrimaryVolumeDescriptor2.prototype=Object.create(PrimaryOrSupplementaryVolumeDescriptor2&&PrimaryOrSupplementaryVolumeDescriptor2.prototype);PrimaryVolumeDescriptor2.prototype.constructor=PrimaryVolumeDescriptor2;PrimaryVolumeDescriptor2.prototype.name=function name2(){return"ISO9660"};PrimaryVolumeDescriptor2.prototype._constructRootDirectoryRecord=function _constructRootDirectoryRecord(data){return new ISODirectoryRecord(data,-1)};PrimaryVolumeDescriptor2.prototype._getString=function _getString(idx,len){return this._getString(idx,len)};return PrimaryVolumeDescriptor2}(PrimaryOrSupplementaryVolumeDescriptor);var SupplementaryVolumeDescriptor=function(PrimaryOrSupplementaryVolumeDescriptor2){function SupplementaryVolumeDescriptor2(data){PrimaryOrSupplementaryVolumeDescriptor2.call(this,data);if(this.type()!==2){throw new ApiError(ErrorCode.EIO,"Invalid supplementary volume descriptor.")}var escapeSequence=this.escapeSequence();var third=escapeSequence[2];if(escapeSequence[0]!==37||escapeSequence[1]!==47||third!==64&&third!==67&&third!==69){throw new ApiError(ErrorCode.EIO,"Unrecognized escape sequence for SupplementaryVolumeDescriptor: "+escapeSequence.toString())}}if(PrimaryOrSupplementaryVolumeDescriptor2)SupplementaryVolumeDescriptor2.__proto__=PrimaryOrSupplementaryVolumeDescriptor2;SupplementaryVolumeDescriptor2.prototype=Object.create(PrimaryOrSupplementaryVolumeDescriptor2&&PrimaryOrSupplementaryVolumeDescriptor2.prototype);SupplementaryVolumeDescriptor2.prototype.constructor=SupplementaryVolumeDescriptor2;SupplementaryVolumeDescriptor2.prototype.name=function name2(){return"Joliet"};SupplementaryVolumeDescriptor2.prototype.escapeSequence=function escapeSequence(){return this._data.slice(88,120)};SupplementaryVolumeDescriptor2.prototype._constructRootDirectoryRecord=function _constructRootDirectoryRecord(data){return new JolietDirectoryRecord(data,-1)};SupplementaryVolumeDescriptor2.prototype._getString=function _getString(idx,len){return getJolietString(this._data,idx,len)};return SupplementaryVolumeDescriptor2}(PrimaryOrSupplementaryVolumeDescriptor);var DirectoryRecord=function DirectoryRecord2(data,rockRidgeOffset){this._suEntries=null;this._fileOrDir=null;this._data=data;this._rockRidgeOffset=rockRidgeOffset};DirectoryRecord.prototype.hasRockRidge=function hasRockRidge(){return this._rockRidgeOffset>-1};DirectoryRecord.prototype.getRockRidgeOffset=function getRockRidgeOffset(){return this._rockRidgeOffset};DirectoryRecord.prototype.rootCheckForRockRidge=function rootCheckForRockRidge(isoData){var dir=this.getDirectory(isoData);this._rockRidgeOffset=dir.getDotEntry(isoData)._getRockRidgeOffset(isoData);if(this._rockRidgeOffset>-1){this._fileOrDir=null}};DirectoryRecord.prototype.length=function length(){return this._data[0]};DirectoryRecord.prototype.extendedAttributeRecordLength=function extendedAttributeRecordLength(){return this._data[1]};DirectoryRecord.prototype.lba=function lba(){return this._data.readUInt32LE(2)*2048};DirectoryRecord.prototype.dataLength=function dataLength(){return this._data.readUInt32LE(10)};DirectoryRecord.prototype.recordingDate=function recordingDate(){return getShortFormDate(this._data,18)};DirectoryRecord.prototype.fileFlags=function fileFlags(){return this._data[25]};DirectoryRecord.prototype.fileUnitSize=function fileUnitSize(){return this._data[26]};DirectoryRecord.prototype.interleaveGapSize=function interleaveGapSize(){return this._data[27]};DirectoryRecord.prototype.volumeSequenceNumber=function volumeSequenceNumber(){return this._data.readUInt16LE(28)};DirectoryRecord.prototype.identifier=function identifier(){return this._getString(33,this._data[32])};DirectoryRecord.prototype.fileName=function fileName(isoData){if(this.hasRockRidge()){var fn=this._rockRidgeFilename(isoData);if(fn!==null){return fn}}var ident=this.identifier();if(this.isDirectory(isoData)){return ident}var versionSeparator=ident.indexOf(";");if(versionSeparator===-1){return ident}else if(ident[versionSeparator-1]==="."){return ident.slice(0,versionSeparator-1)}else{return ident.slice(0,versionSeparator)}};DirectoryRecord.prototype.isDirectory=function isDirectory(isoData){var rv=!!(this.fileFlags()&2);if(!rv&&this.hasRockRidge()){rv=this.getSUEntries(isoData).filter(function(e){return e instanceof CLEntry}).length>0}return rv};DirectoryRecord.prototype.isSymlink=function isSymlink(isoData){return this.hasRockRidge()&&this.getSUEntries(isoData).filter(function(e){return e instanceof SLEntry}).length>0};DirectoryRecord.prototype.getSymlinkPath=function getSymlinkPath(isoData){var p2="";var entries=this.getSUEntries(isoData);var getStr=this._getGetString();for(var i22=0,list2=entries;i22<list2.length;i22+=1){var entry=list2[i22];if(entry instanceof SLEntry){var components=entry.componentRecords();for(var i$12=0,list$1=components;i$12<list$1.length;i$12+=1){var component=list$1[i$12];var flags=component.flags();if(flags&2){p2+="./"}else if(flags&4){p2+="../"}else if(flags&8){p2+="/"}else{p2+=component.content(getStr);if(!(flags&1)){p2+="/"}}}if(!entry.continueFlag()){break}}}if(p2.length>1&&p2[p2.length-1]==="/"){return p2.slice(0,p2.length-1)}else{return p2}};DirectoryRecord.prototype.getFile=function getFile(isoData){if(this.isDirectory(isoData)){throw new Error("Tried to get a File from a directory.")}if(this._fileOrDir===null){this._fileOrDir=isoData.slice(this.lba(),this.lba()+this.dataLength())}return this._fileOrDir};DirectoryRecord.prototype.getDirectory=function getDirectory(isoData){if(!this.isDirectory(isoData)){throw new Error("Tried to get a Directory from a file.")}if(this._fileOrDir===null){this._fileOrDir=this._constructDirectory(isoData)}return this._fileOrDir};DirectoryRecord.prototype.getSUEntries=function getSUEntries(isoData){if(!this._suEntries){this._constructSUEntries(isoData)}return this._suEntries};DirectoryRecord.prototype._rockRidgeFilename=function _rockRidgeFilename(isoData){var nmEntries=this.getSUEntries(isoData).filter(function(e2){return e2 instanceof NMEntry});if(nmEntries.length===0||nmEntries[0].flags()&(2|4)){return null}var str4="";var getString=this._getGetString();for(var i22=0,list2=nmEntries;i22<list2.length;i22+=1){var e=list2[i22];str4+=e.name(getString);if(!(e.flags()&1)){break}}return str4};DirectoryRecord.prototype._constructSUEntries=function _constructSUEntries(isoData){var i22=33+this._data[32];if(i22%2===1){i22++}i22+=this._rockRidgeOffset;this._suEntries=constructSystemUseEntries(this._data,i22,this.length(),isoData)};DirectoryRecord.prototype._getRockRidgeOffset=function _getRockRidgeOffset(isoData){this._rockRidgeOffset=0;var suEntries=this.getSUEntries(isoData);if(suEntries.length>0){var spEntry=suEntries[0];if(spEntry instanceof SPEntry&&spEntry.checkBytesPass()){for(var i22=1;i22<suEntries.length;i22++){var entry=suEntries[i22];if(entry instanceof RREntry||entry instanceof EREntry&&entry.extensionIdentifier()===rockRidgeIdentifier){return spEntry.bytesSkipped()}}}}this._rockRidgeOffset=-1;return-1};var ISODirectoryRecord=function(DirectoryRecord2){function ISODirectoryRecord2(data,rockRidgeOffset){DirectoryRecord2.call(this,data,rockRidgeOffset)}if(DirectoryRecord2)ISODirectoryRecord2.__proto__=DirectoryRecord2;ISODirectoryRecord2.prototype=Object.create(DirectoryRecord2&&DirectoryRecord2.prototype);ISODirectoryRecord2.prototype.constructor=ISODirectoryRecord2;ISODirectoryRecord2.prototype._getString=function _getString(i22,len){return getASCIIString(this._data,i22,len)};ISODirectoryRecord2.prototype._constructDirectory=function _constructDirectory(isoData){return new ISODirectory(this,isoData)};ISODirectoryRecord2.prototype._getGetString=function _getGetString(){return getASCIIString};return ISODirectoryRecord2}(DirectoryRecord);var JolietDirectoryRecord=function(DirectoryRecord2){function JolietDirectoryRecord2(data,rockRidgeOffset){DirectoryRecord2.call(this,data,rockRidgeOffset)}if(DirectoryRecord2)JolietDirectoryRecord2.__proto__=DirectoryRecord2;JolietDirectoryRecord2.prototype=Object.create(DirectoryRecord2&&DirectoryRecord2.prototype);JolietDirectoryRecord2.prototype.constructor=JolietDirectoryRecord2;JolietDirectoryRecord2.prototype._getString=function _getString(i22,len){return getJolietString(this._data,i22,len)};JolietDirectoryRecord2.prototype._constructDirectory=function _constructDirectory(isoData){return new JolietDirectory(this,isoData)};JolietDirectoryRecord2.prototype._getGetString=function _getGetString(){return getJolietString};return JolietDirectoryRecord2}(DirectoryRecord);var SystemUseEntry=function SystemUseEntry2(data){this._data=data};SystemUseEntry.prototype.signatureWord=function signatureWord(){return this._data.readUInt16BE(0)};SystemUseEntry.prototype.signatureWordString=function signatureWordString(){return getASCIIString(this._data,0,2)};SystemUseEntry.prototype.length=function length(){return this._data[2]};SystemUseEntry.prototype.suVersion=function suVersion(){return this._data[3]};var CEEntry=function(SystemUseEntry2){function CEEntry2(data){SystemUseEntry2.call(this,data);this._entries=null}if(SystemUseEntry2)CEEntry2.__proto__=SystemUseEntry2;CEEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);CEEntry2.prototype.constructor=CEEntry2;CEEntry2.prototype.continuationLba=function continuationLba(){return this._data.readUInt32LE(4)};CEEntry2.prototype.continuationLbaOffset=function continuationLbaOffset(){return this._data.readUInt32LE(12)};CEEntry2.prototype.continuationLength=function continuationLength(){return this._data.readUInt32LE(20)};CEEntry2.prototype.getEntries=function getEntries(isoData){if(!this._entries){var start=this.continuationLba()*2048+this.continuationLbaOffset();this._entries=constructSystemUseEntries(isoData,start,this.continuationLength(),isoData)}return this._entries};return CEEntry2}(SystemUseEntry);var PDEntry=function(SystemUseEntry2){function PDEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)PDEntry2.__proto__=SystemUseEntry2;PDEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);PDEntry2.prototype.constructor=PDEntry2;return PDEntry2}(SystemUseEntry);var SPEntry=function(SystemUseEntry2){function SPEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)SPEntry2.__proto__=SystemUseEntry2;SPEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);SPEntry2.prototype.constructor=SPEntry2;SPEntry2.prototype.checkBytesPass=function checkBytesPass(){return this._data[4]===190&&this._data[5]===239};SPEntry2.prototype.bytesSkipped=function bytesSkipped(){return this._data[6]};return SPEntry2}(SystemUseEntry);var STEntry=function(SystemUseEntry2){function STEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)STEntry2.__proto__=SystemUseEntry2;STEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);STEntry2.prototype.constructor=STEntry2;return STEntry2}(SystemUseEntry);var EREntry=function(SystemUseEntry2){function EREntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)EREntry2.__proto__=SystemUseEntry2;EREntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);EREntry2.prototype.constructor=EREntry2;EREntry2.prototype.identifierLength=function identifierLength(){return this._data[4]};EREntry2.prototype.descriptorLength=function descriptorLength(){return this._data[5]};EREntry2.prototype.sourceLength=function sourceLength(){return this._data[6]};EREntry2.prototype.extensionVersion=function extensionVersion(){return this._data[7]};EREntry2.prototype.extensionIdentifier=function extensionIdentifier(){return getASCIIString(this._data,8,this.identifierLength())};EREntry2.prototype.extensionDescriptor=function extensionDescriptor(){return getASCIIString(this._data,8+this.identifierLength(),this.descriptorLength())};EREntry2.prototype.extensionSource=function extensionSource(){return getASCIIString(this._data,8+this.identifierLength()+this.descriptorLength(),this.sourceLength())};return EREntry2}(SystemUseEntry);var ESEntry=function(SystemUseEntry2){function ESEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)ESEntry2.__proto__=SystemUseEntry2;ESEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);ESEntry2.prototype.constructor=ESEntry2;ESEntry2.prototype.extensionSequence=function extensionSequence(){return this._data[4]};return ESEntry2}(SystemUseEntry);var RREntry=function(SystemUseEntry2){function RREntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)RREntry2.__proto__=SystemUseEntry2;RREntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);RREntry2.prototype.constructor=RREntry2;return RREntry2}(SystemUseEntry);var PXEntry=function(SystemUseEntry2){function PXEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)PXEntry2.__proto__=SystemUseEntry2;PXEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);PXEntry2.prototype.constructor=PXEntry2;PXEntry2.prototype.mode=function mode(){return this._data.readUInt32LE(4)};PXEntry2.prototype.fileLinks=function fileLinks(){return this._data.readUInt32LE(12)};PXEntry2.prototype.uid=function uid(){return this._data.readUInt32LE(20)};PXEntry2.prototype.gid=function gid(){return this._data.readUInt32LE(28)};PXEntry2.prototype.inode=function inode(){return this._data.readUInt32LE(36)};return PXEntry2}(SystemUseEntry);var PNEntry=function(SystemUseEntry2){function PNEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)PNEntry2.__proto__=SystemUseEntry2;PNEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);PNEntry2.prototype.constructor=PNEntry2;PNEntry2.prototype.devTHigh=function devTHigh(){return this._data.readUInt32LE(4)};PNEntry2.prototype.devTLow=function devTLow(){return this._data.readUInt32LE(12)};return PNEntry2}(SystemUseEntry);var SLEntry=function(SystemUseEntry2){function SLEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)SLEntry2.__proto__=SystemUseEntry2;SLEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);SLEntry2.prototype.constructor=SLEntry2;SLEntry2.prototype.flags=function flags(){return this._data[4]};SLEntry2.prototype.continueFlag=function continueFlag(){return this.flags()&1};SLEntry2.prototype.componentRecords=function componentRecords(){var this$1=this;var records=new Array;var i22=5;while(i22<this.length()){var record=new SLComponentRecord(this$1._data.slice(i22));records.push(record);i22+=record.length()}return records};return SLEntry2}(SystemUseEntry);var SLComponentRecord=function SLComponentRecord2(data){this._data=data};SLComponentRecord.prototype.flags=function flags(){return this._data[0]};SLComponentRecord.prototype.length=function length(){return 2+this.componentLength()};SLComponentRecord.prototype.componentLength=function componentLength(){return this._data[1]};SLComponentRecord.prototype.content=function content(getString){return getString(this._data,2,this.componentLength())};var NMEntry=function(SystemUseEntry2){function NMEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)NMEntry2.__proto__=SystemUseEntry2;NMEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);NMEntry2.prototype.constructor=NMEntry2;NMEntry2.prototype.flags=function flags(){return this._data[4]};NMEntry2.prototype.name=function name2(getString){return getString(this._data,5,this.length()-5)};return NMEntry2}(SystemUseEntry);var CLEntry=function(SystemUseEntry2){function CLEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)CLEntry2.__proto__=SystemUseEntry2;CLEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);CLEntry2.prototype.constructor=CLEntry2;CLEntry2.prototype.childDirectoryLba=function childDirectoryLba(){return this._data.readUInt32LE(4)};return CLEntry2}(SystemUseEntry);var PLEntry=function(SystemUseEntry2){function PLEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)PLEntry2.__proto__=SystemUseEntry2;PLEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);PLEntry2.prototype.constructor=PLEntry2;PLEntry2.prototype.parentDirectoryLba=function parentDirectoryLba(){return this._data.readUInt32LE(4)};return PLEntry2}(SystemUseEntry);var REEntry=function(SystemUseEntry2){function REEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)REEntry2.__proto__=SystemUseEntry2;REEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);REEntry2.prototype.constructor=REEntry2;return REEntry2}(SystemUseEntry);var TFEntry=function(SystemUseEntry2){function TFEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)TFEntry2.__proto__=SystemUseEntry2;TFEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);TFEntry2.prototype.constructor=TFEntry2;TFEntry2.prototype.flags=function flags(){return this._data[4]};TFEntry2.prototype.creation=function creation(){if(this.flags()&1){if(this._longFormDates()){return getDate(this._data,5)}else{return getShortFormDate(this._data,5)}}else{return null}};TFEntry2.prototype.modify=function modify(){if(this.flags()&2){var previousDates=this.flags()&1?1:0;if(this._longFormDates){return getDate(this._data,5+previousDates*17)}else{return getShortFormDate(this._data,5+previousDates*7)}}else{return null}};TFEntry2.prototype.access=function access(){if(this.flags()&4){var previousDates=this.flags()&1?1:0;previousDates+=this.flags()&2?1:0;if(this._longFormDates){return getDate(this._data,5+previousDates*17)}else{return getShortFormDate(this._data,5+previousDates*7)}}else{return null}};TFEntry2.prototype.backup=function backup(){if(this.flags()&16){var previousDates=this.flags()&1?1:0;previousDates+=this.flags()&2?1:0;previousDates+=this.flags()&4?1:0;if(this._longFormDates){return getDate(this._data,5+previousDates*17)}else{return getShortFormDate(this._data,5+previousDates*7)}}else{return null}};TFEntry2.prototype.expiration=function expiration(){if(this.flags()&32){var previousDates=this.flags()&1?1:0;previousDates+=this.flags()&2?1:0;previousDates+=this.flags()&4?1:0;previousDates+=this.flags()&16?1:0;if(this._longFormDates){return getDate(this._data,5+previousDates*17)}else{return getShortFormDate(this._data,5+previousDates*7)}}else{return null}};TFEntry2.prototype.effective=function effective(){if(this.flags()&64){var previousDates=this.flags()&1?1:0;previousDates+=this.flags()&2?1:0;previousDates+=this.flags()&4?1:0;previousDates+=this.flags()&16?1:0;previousDates+=this.flags()&32?1:0;if(this._longFormDates){return getDate(this._data,5+previousDates*17)}else{return getShortFormDate(this._data,5+previousDates*7)}}else{return null}};TFEntry2.prototype._longFormDates=function _longFormDates(){return!!(this.flags()&&128)};return TFEntry2}(SystemUseEntry);var SFEntry=function(SystemUseEntry2){function SFEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)SFEntry2.__proto__=SystemUseEntry2;SFEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);SFEntry2.prototype.constructor=SFEntry2;SFEntry2.prototype.virtualSizeHigh=function virtualSizeHigh(){return this._data.readUInt32LE(4)};SFEntry2.prototype.virtualSizeLow=function virtualSizeLow(){return this._data.readUInt32LE(12)};SFEntry2.prototype.tableDepth=function tableDepth(){return this._data[20]};return SFEntry2}(SystemUseEntry);var Directory=function Directory2(record,isoData){var this$1=this;this._fileList=[];this._fileMap={};this._record=record;var i22=record.lba();var iLimit=i22+record.dataLength();if(!(record.fileFlags()&2)){var cl=record.getSUEntries(isoData).filter(function(e){return e instanceof CLEntry})[0];i22=cl.childDirectoryLba()*2048;iLimit=Infinity}while(i22<iLimit){var len=isoData[i22];if(len===0){i22++;continue}var r=this$1._constructDirectoryRecord(isoData.slice(i22));var fname=r.fileName(isoData);if(fname!=="\\0"&&fname!==""){if(!r.hasRockRidge()||r.getSUEntries(isoData).filter(function(e){return e instanceof REEntry}).length===0){this$1._fileMap[fname]=r;this$1._fileList.push(fname)}}else if(iLimit===Infinity){iLimit=i22+r.dataLength()}i22+=r.length()}};Directory.prototype.getRecord=function getRecord(name2){return this._fileMap[name2]};Directory.prototype.getFileList=function getFileList(){return this._fileList};Directory.prototype.getDotEntry=function getDotEntry(isoData){return this._constructDirectoryRecord(isoData.slice(this._record.lba()))};var ISODirectory=function(Directory2){function ISODirectory2(record,isoData){Directory2.call(this,record,isoData)}if(Directory2)ISODirectory2.__proto__=Directory2;ISODirectory2.prototype=Object.create(Directory2&&Directory2.prototype);ISODirectory2.prototype.constructor=ISODirectory2;ISODirectory2.prototype._constructDirectoryRecord=function _constructDirectoryRecord(data){return new ISODirectoryRecord(data,this._record.getRockRidgeOffset())};return ISODirectory2}(Directory);var JolietDirectory=function(Directory2){function JolietDirectory2(record,isoData){Directory2.call(this,record,isoData)}if(Directory2)JolietDirectory2.__proto__=Directory2;JolietDirectory2.prototype=Object.create(Directory2&&Directory2.prototype);JolietDirectory2.prototype.constructor=JolietDirectory2;JolietDirectory2.prototype._constructDirectoryRecord=function _constructDirectoryRecord(data){return new JolietDirectoryRecord(data,this._record.getRockRidgeOffset())};return JolietDirectory2}(Directory);var IsoFS=function(SynchronousFileSystem$$1){function IsoFS2(data,name2,deprecateMsg){var this$1=this;if(name2===void 0)name2="";if(deprecateMsg===void 0)deprecateMsg=true;SynchronousFileSystem$$1.call(this);this._data=data;deprecationMessage(deprecateMsg,IsoFS2.Name,{data:"ISO data as a Buffer",name:name2});var vdTerminatorFound=false;var i22=16*2048;var candidateVDs=new Array;while(!vdTerminatorFound){var slice=data.slice(i22);var vd=new VolumeDescriptor(slice);switch(vd.type()){case 1:candidateVDs.push(new PrimaryVolumeDescriptor(slice));break;case 2:candidateVDs.push(new SupplementaryVolumeDescriptor(slice));break;case 255:vdTerminatorFound=true;break}i22+=2048}if(candidateVDs.length===0){throw new ApiError(ErrorCode.EIO,"Unable to find a suitable volume descriptor.")}candidateVDs.forEach(function(v2){if(!this$1._pvd||this$1._pvd.type()!==2){this$1._pvd=v2}});this._root=this._pvd.rootDirectoryEntry(data);this._name=name2}if(SynchronousFileSystem$$1)IsoFS2.__proto__=SynchronousFileSystem$$1;IsoFS2.prototype=Object.create(SynchronousFileSystem$$1&&SynchronousFileSystem$$1.prototype);IsoFS2.prototype.constructor=IsoFS2;IsoFS2.Create=function Create(opts,cb){var fs4;var e;try{fs4=new IsoFS2(opts.data,opts.name,false)}catch(e2){e2=e2}finally{cb(e,fs4)}};IsoFS2.isAvailable=function isAvailable(){return true};IsoFS2.prototype.getName=function getName(){var name2="IsoFS"+this._name+(this._pvd?"-"+this._pvd.name():"");if(this._root&&this._root.hasRockRidge()){name2+="-RockRidge"}return name2};IsoFS2.prototype.diskSpace=function diskSpace(path$$1,cb){cb(this._data.length,0)};IsoFS2.prototype.isReadOnly=function isReadOnly(){return true};IsoFS2.prototype.supportsLinks=function supportsLinks(){return false};IsoFS2.prototype.supportsProps=function supportsProps(){return false};IsoFS2.prototype.supportsSynch=function supportsSynch(){return true};IsoFS2.prototype.statSync=function statSync(p2,isLstat){var record=this._getDirectoryRecord(p2);if(record===null){throw ApiError.ENOENT(p2)}return this._getStats(p2,record)};IsoFS2.prototype.openSync=function openSync(p2,flags,mode){if(flags.isWriteable()){throw new ApiError(ErrorCode.EPERM,p2)}var record=this._getDirectoryRecord(p2);if(!record){throw ApiError.ENOENT(p2)}else if(record.isSymlink(this._data)){return this.openSync(path.resolve(p2,record.getSymlinkPath(this._data)),flags,mode)}else if(!record.isDirectory(this._data)){var data=record.getFile(this._data);var stats=this._getStats(p2,record);switch(flags.pathExistsAction()){case ActionType.THROW_EXCEPTION:case ActionType.TRUNCATE_FILE:throw ApiError.EEXIST(p2);case ActionType.NOP:return new NoSyncFile(this,p2,flags,stats,data);default:throw new ApiError(ErrorCode.EINVAL,"Invalid FileMode object.")}}else{throw ApiError.EISDIR(p2)}};IsoFS2.prototype.readdirSync=function readdirSync(path$$1){var record=this._getDirectoryRecord(path$$1);if(!record){throw ApiError.ENOENT(path$$1)}else if(record.isDirectory(this._data)){return record.getDirectory(this._data).getFileList().slice(0)}else{throw ApiError.ENOTDIR(path$$1)}};IsoFS2.prototype.readFileSync=function readFileSync(fname,encoding,flag){var fd=this.openSync(fname,flag,420);try{var fdCast=fd;var fdBuff=fdCast.getBuffer();if(encoding===null){return copyingSlice(fdBuff)}return fdBuff.toString(encoding)}finally{fd.closeSync()}};IsoFS2.prototype._getDirectoryRecord=function _getDirectoryRecord(path$$1){var this$1=this;if(path$$1==="/"){return this._root}var components=path$$1.split("/").slice(1);var dir=this._root;for(var i22=0,list2=components;i22<list2.length;i22+=1){var component=list2[i22];if(dir.isDirectory(this$1._data)){dir=dir.getDirectory(this$1._data).getRecord(component);if(!dir){return null}}else{return null}}return dir};IsoFS2.prototype._getStats=function _getStats(p2,record){if(record.isSymlink(this._data)){var newP=path.resolve(p2,record.getSymlinkPath(this._data));var dirRec=this._getDirectoryRecord(newP);if(!dirRec){return null}return this._getStats(newP,dirRec)}else{var len=record.dataLength();var mode=365;var date=record.recordingDate();var atime=date;var mtime=date;var ctime=date;if(record.hasRockRidge()){var entries=record.getSUEntries(this._data);for(var i22=0,list2=entries;i22<list2.length;i22+=1){var entry=list2[i22];if(entry instanceof PXEntry){mode=entry.mode()}else if(entry instanceof TFEntry){var flags=entry.flags();if(flags&4){atime=entry.access()}if(flags&2){mtime=entry.modify()}if(flags&1){ctime=entry.creation()}}}}mode=mode&365;return new Stats(record.isDirectory(this._data)?FileType.DIRECTORY:FileType.FILE,len,mode,atime,mtime,ctime)}};return IsoFS2}(SynchronousFileSystem);IsoFS.Name="IsoFS";IsoFS.Options={data:{type:"object",description:"The ISO file in a buffer",validator:bufferValidator}};[AsyncMirror,DropboxFileSystem,EmscriptenFileSystem,FolderAdapter,HTML5FS,InMemoryFileSystem,IndexedDBFileSystem,IsoFS,LocalStorageFileSystem,MountableFileSystem,OverlayFS,WorkerFS,XmlHttpRequest,ZipFS].forEach(function(fsType){var create=fsType.Create;fsType.Create=function(opts,cb){var oneArg=typeof opts==="function";var normalizedCb=oneArg?opts:cb;var normalizedOpts=oneArg?{}:opts;function wrappedCb(e){if(e){normalizedCb(e)}else{create.call(fsType,normalizedOpts,normalizedCb)}}checkOptions(fsType,normalizedOpts,wrappedCb)}});var Backends={AsyncMirror,Dropbox:DropboxFileSystem,Emscripten:EmscriptenFileSystem,FolderAdapter,HTML5FS,InMemory:InMemoryFileSystem,IndexedDB:IndexedDBFileSystem,IsoFS,LocalStorage:LocalStorageFileSystem,MountableFileSystem,OverlayFS,WorkerFS,XmlHttpRequest,ZipFS};if(process["initializeTTYs"]){process["initializeTTYs"]()}function install(obj){obj.Buffer=Buffer2;obj.process=process;var oldRequire=obj.require?obj.require:null;obj.require=function(arg){var rv=BFSRequire2(arg);if(!rv){return oldRequire.apply(null,Array.prototype.slice.call(arguments,0))}else{return rv}}}function registerFileSystem(name2,fs4){Backends[name2]=fs4}function BFSRequire2(module4){switch(module4){case"fs":return _fsMock;case"path":return path;case"buffer":return buffer;case"process":return process;case"bfs_utils":return BFSUtils;default:return Backends[module4]}}function initialize2(rootfs){return _fsMock.initialize(rootfs)}function configure(config,cb){getFileSystem(config,function(e,fs4){if(fs4){initialize2(fs4);cb()}else{cb(e)}})}function getFileSystem(config,cb){var fsName=config["fs"];if(!fsName){return cb(new ApiError(ErrorCode.EPERM,\'Missing "fs" property on configuration object.\'))}var options=config["options"];var waitCount=0;var called=false;function finish(){if(!called){called=true;var fsc=Backends[fsName];if(!fsc){cb(new ApiError(ErrorCode.EPERM,"File system "+fsName+" is not available in BrowserFS."))}else{fsc.Create(options,cb)}}}if(options!==null&&typeof options==="object"){var finishedIterating=false;var props=Object.keys(options).filter(function(k){return k!=="fs"});props.forEach(function(p2){var d2=options[p2];if(d2!==null&&typeof d2==="object"&&d2["fs"]){waitCount++;getFileSystem(d2,function(e,fs4){waitCount--;if(e){if(called){return}called=true;cb(e)}else{options[p2]=fs4;if(waitCount===0&&finishedIterating){finish()}}})}});finishedIterating=true}if(waitCount===0){finish()}}if("ab".substr(-1)!=="b"){String.prototype.substr=function(substr){return function(start,length){if(start<0){start=this.length+start}return substr.call(this,start,length)}}(String.prototype.substr)}if(typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined"){if(!Uint8Array.prototype["slice"]){Uint8Array.prototype.slice=function(start,end){if(start===void 0)start=0;if(end===void 0)end=this.length;var self2=this;if(start<0){start=this.length+start;if(start<0){start=0}}if(end<0){end=this.length+end;if(end<0){end=0}}if(end<start){end=start}return new Uint8Array(self2.buffer,self2.byteOffset+start,end-start)}}}exports2.install=install;exports2.registerFileSystem=registerFileSystem;exports2.BFSRequire=BFSRequire2;exports2.initialize=initialize2;exports2.configure=configure;exports2.getFileSystem=getFileSystem;exports2.EmscriptenFS=BFSEmscriptenFS;exports2.FileSystem=Backends;exports2.Errors=api_error;exports2.setImmediate=setImmediate$3}).call(exports2,__webpack_require__(1),function(){return this}(),__webpack_require__(5)(module22),__webpack_require__(6))},function(module22,exports2,__webpack_require__){module22.exports=__webpack_require__(2).Buffer},function(module22,exports2,__webpack_require__){(function(Buffer2){"use strict";var base64=__webpack_require__(3);var ieee754=__webpack_require__(4);exports2.Buffer=Buffer2;exports2.SlowBuffer=SlowBuffer;exports2.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports2.kMaxLength=K_MAX_LENGTH;Buffer2.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer2.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function typedArraySupport(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return arr.foo()===42}catch(e){return false}}function createBuffer(length){if(length>K_MAX_LENGTH){throw new RangeError("Invalid typed array length")}var buf=new Uint8Array(length);buf.__proto__=Buffer2.prototype;return buf}function Buffer2(arg,encodingOrOffset,length){if(typeof arg==="number"){if(typeof encodingOrOffset==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}if(typeof Symbol!=="undefined"&&Symbol.species&&Buffer2[Symbol.species]===Buffer2){Object.defineProperty(Buffer2,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}Buffer2.poolSize=8192;function from(value,encodingOrOffset,length){if(typeof value==="number"){throw new TypeError(\'"value" argument must not be a number\')}if(isArrayBuffer(value)){return fromArrayBuffer(value,encodingOrOffset,length)}if(typeof value==="string"){return fromString(value,encodingOrOffset)}return fromObject(value)}Buffer2.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)};Buffer2.prototype.__proto__=Uint8Array.prototype;Buffer2.__proto__=Uint8Array;function assertSize(size){if(typeof size!=="number"){throw new TypeError(\'"size" argument must be a number\')}else if(size<0){throw new RangeError(\'"size" argument must not be negative\')}}function alloc(size,fill,encoding){assertSize(size);if(size<=0){return createBuffer(size)}if(fill!==void 0){return typeof encoding==="string"?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill)}return createBuffer(size)}Buffer2.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)};function allocUnsafe(size){assertSize(size);return createBuffer(size<0?0:checked(size)|0)}Buffer2.allocUnsafe=function(size){return allocUnsafe(size)};Buffer2.allocUnsafeSlow=function(size){return allocUnsafe(size)};function fromString(string,encoding){if(typeof encoding!=="string"||encoding===""){encoding="utf8"}if(!Buffer2.isEncoding(encoding)){throw new TypeError(\'"encoding" must be a valid string encoding\')}var length=byteLength(string,encoding)|0;var buf=createBuffer(length);var actual=buf.write(string,encoding);if(actual!==length){buf=buf.slice(0,actual)}return buf}function fromArrayLike(array){var length=array.length<0?0:checked(array.length)|0;var buf=createBuffer(length);for(var i3=0;i3<length;i3+=1){buf[i3]=array[i3]&255}return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError("\'offset\' is out of bounds")}if(array.byteLength<byteOffset+(length||0)){throw new RangeError("\'length\' is out of bounds")}var buf;if(byteOffset===void 0&&length===void 0){buf=new Uint8Array(array)}else if(length===void 0){buf=new Uint8Array(array,byteOffset)}else{buf=new Uint8Array(array,byteOffset,length)}buf.__proto__=Buffer2.prototype;return buf}function fromObject(obj){if(Buffer2.isBuffer(obj)){var len=checked(obj.length)|0;var buf=createBuffer(len);if(buf.length===0){return buf}obj.copy(buf,0,0,len);return buf}if(obj){if(isArrayBufferView(obj)||"length"in obj){if(typeof obj.length!=="number"||numberIsNaN(obj.length)){return createBuffer(0)}return fromArrayLike(obj)}if(obj.type==="Buffer"&&Array.isArray(obj.data)){return fromArrayLike(obj.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes")}return length|0}function SlowBuffer(length){if(+length!=length){length=0}return Buffer2.alloc(+length)}Buffer2.isBuffer=function isBuffer(b){return b!=null&&b._isBuffer===true};Buffer2.compare=function compare(a,b){if(!Buffer2.isBuffer(a)||!Buffer2.isBuffer(b)){throw new TypeError("Arguments must be Buffers")}if(a===b)return 0;var x3=a.length;var y4=b.length;for(var i3=0,len=Math.min(x3,y4);i3<len;++i3){if(a[i3]!==b[i3]){x3=a[i3];y4=b[i3];break}}if(x3<y4)return-1;if(y4<x3)return 1;return 0};Buffer2.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer2.concat=function concat(list,length){if(!Array.isArray(list)){throw new TypeError(\'"list" argument must be an Array of Buffers\')}if(list.length===0){return Buffer2.alloc(0)}var i3;if(length===void 0){length=0;for(i3=0;i3<list.length;++i3){length+=list[i3].length}}var buffer=Buffer2.allocUnsafe(length);var pos=0;for(i3=0;i3<list.length;++i3){var buf=list[i3];if(!Buffer2.isBuffer(buf)){throw new TypeError(\'"list" argument must be an Array of Buffers\')}buf.copy(buffer,pos);pos+=buf.length}return buffer};function byteLength(string,encoding){if(Buffer2.isBuffer(string)){return string.length}if(isArrayBufferView(string)||isArrayBuffer(string)){return string.byteLength}if(typeof string!=="string"){string=""+string}var len=string.length;if(len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer2.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;if(start===void 0||start<0){start=0}if(start>this.length){return""}if(end===void 0||end>this.length){end=this.length}if(end<=0){return""}end>>>=0;start>>>=0;if(end<=start){return""}if(!encoding)encoding="utf8";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer2.prototype._isBuffer=true;function swap(b,n,m){var i3=b[n];b[n]=b[m];b[m]=i3}Buffer2.prototype.swap16=function swap16(){var len=this.length;if(len%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var i3=0;i3<len;i3+=2){swap(this,i3,i3+1)}return this};Buffer2.prototype.swap32=function swap32(){var len=this.length;if(len%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var i3=0;i3<len;i3+=4){swap(this,i3,i3+3);swap(this,i3+1,i3+2)}return this};Buffer2.prototype.swap64=function swap64(){var len=this.length;if(len%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var i3=0;i3<len;i3+=8){swap(this,i3,i3+7);swap(this,i3+1,i3+6);swap(this,i3+2,i3+5);swap(this,i3+3,i3+4)}return this};Buffer2.prototype.toString=function toString(){var length=this.length;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer2.prototype.equals=function equals(b){if(!Buffer2.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer2.compare(this,b)===0};Buffer2.prototype.inspect=function inspect(){var str4="";var max=exports2.INSPECT_MAX_BYTES;if(this.length>0){str4=this.toString("hex",0,max).match(/.{2}/g).join(" ");if(this.length>max)str4+=" ... "}return"<Buffer "+str4+">"};Buffer2.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(!Buffer2.isBuffer(target)){throw new TypeError("Argument must be a Buffer")}if(start===void 0){start=0}if(end===void 0){end=target?target.length:0}if(thisStart===void 0){thisStart=0}if(thisEnd===void 0){thisEnd=this.length}if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError("out of range index")}if(thisStart>=thisEnd&&start>=end){return 0}if(thisStart>=thisEnd){return-1}if(start>=end){return 1}start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x3=thisEnd-thisStart;var y4=end-start;var len=Math.min(x3,y4);var thisCopy=this.slice(thisStart,thisEnd);var targetCopy=target.slice(start,end);for(var i3=0;i3<len;++i3){if(thisCopy[i3]!==targetCopy[i3]){x3=thisCopy[i3];y4=targetCopy[i3];break}}if(x3<y4)return-1;if(y4<x3)return 1;return 0};function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(buffer.length===0)return-1;if(typeof byteOffset==="string"){encoding=byteOffset;byteOffset=0}else if(byteOffset>2147483647){byteOffset=2147483647}else if(byteOffset<-2147483648){byteOffset=-2147483648}byteOffset=+byteOffset;if(numberIsNaN(byteOffset)){byteOffset=dir?0:buffer.length-1}if(byteOffset<0)byteOffset=buffer.length+byteOffset;if(byteOffset>=buffer.length){if(dir)return-1;else byteOffset=buffer.length-1}else if(byteOffset<0){if(dir)byteOffset=0;else return-1}if(typeof val==="string"){val=Buffer2.from(val,encoding)}if(Buffer2.isBuffer(val)){if(val.length===0){return-1}return arrayIndexOf(buffer,val,byteOffset,encoding,dir)}else if(typeof val==="number"){val=val&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(dir){return Uint8Array.prototype.indexOf.call(buffer,val,byteOffset)}else{return Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset)}}return arrayIndexOf(buffer,[val],byteOffset,encoding,dir)}throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1;var arrLength=arr.length;var valLength=val.length;if(encoding!==void 0){encoding=String(encoding).toLowerCase();if(encoding==="ucs2"||encoding==="ucs-2"||encoding==="utf16le"||encoding==="utf-16le"){if(arr.length<2||val.length<2){return-1}indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2}}function read(buf,i22){if(indexSize===1){return buf[i22]}else{return buf.readUInt16BE(i22*indexSize)}}var i3;if(dir){var foundIndex=-1;for(i3=byteOffset;i3<arrLength;i3++){if(read(arr,i3)===read(val,foundIndex===-1?0:i3-foundIndex)){if(foundIndex===-1)foundIndex=i3;if(i3-foundIndex+1===valLength)return foundIndex*indexSize}else{if(foundIndex!==-1)i3-=i3-foundIndex;foundIndex=-1}}}else{if(byteOffset+valLength>arrLength)byteOffset=arrLength-valLength;for(i3=byteOffset;i3>=0;i3--){var found=true;for(var j=0;j<valLength;j++){if(read(arr,i3+j)!==read(val,j)){found=false;break}}if(found)return i3}}return-1}Buffer2.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1};Buffer2.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,true)};Buffer2.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,false)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(strLen%2!==0)throw new TypeError("Invalid hex string");if(length>strLen/2){length=strLen/2}for(var i3=0;i3<length;++i3){var parsed=parseInt(string.substr(i3*2,2),16);if(numberIsNaN(parsed))return i3;buf[offset+i3]=parsed}return i3}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer2.prototype.write=function write(string,offset,length,encoding){if(offset===void 0){encoding="utf8";length=this.length;offset=0}else if(length===void 0&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset>>>0;if(isFinite(length)){length=length>>>0;if(encoding===void 0)encoding="utf8"}else{encoding=length;length=void 0}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var remaining=this.length-offset;if(length===void 0||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer2.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i3=start;while(i3<end){var firstByte=buf[i3];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i3+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte}break;case 2:secondByte=buf[i3+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint}}break;case 3:secondByte=buf[i3+1];thirdByte=buf[i3+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint}}break;case 4:secondByte=buf[i3+1];thirdByte=buf[i3+2];fourthByte=buf[i3+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i3+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}var res="";var i3=0;while(i3<len){res+=String.fromCharCode.apply(String,codePoints.slice(i3,i3+=MAX_ARGUMENTS_LENGTH))}return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i3=start;i3<end;++i3){ret+=String.fromCharCode(buf[i3]&127)}return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i3=start;i3<end;++i3){ret+=String.fromCharCode(buf[i3])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i3=start;i3<end;++i3){out+=toHex(buf[i3])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i3=0;i3<bytes.length;i3+=2){res+=String.fromCharCode(bytes[i3]+bytes[i3+1]*256)}return res}Buffer2.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===void 0?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf=this.subarray(start,end);newBuf.__proto__=Buffer2.prototype;return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer2.prototype.readUIntLE=function readUIntLE(offset,byteLength2,noAssert){offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert)checkOffset(offset,byteLength2,this.length);var val=this[offset];var mul=1;var i3=0;while(++i3<byteLength2&&(mul*=256)){val+=this[offset+i3]*mul}return val};Buffer2.prototype.readUIntBE=function readUIntBE(offset,byteLength2,noAssert){offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert){checkOffset(offset,byteLength2,this.length)}var val=this[offset+--byteLength2];var mul=1;while(byteLength2>0&&(mul*=256)){val+=this[offset+--byteLength2]*mul}return val};Buffer2.prototype.readUInt8=function readUInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer2.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer2.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer2.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer2.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer2.prototype.readIntLE=function readIntLE(offset,byteLength2,noAssert){offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert)checkOffset(offset,byteLength2,this.length);var val=this[offset];var mul=1;var i3=0;while(++i3<byteLength2&&(mul*=256)){val+=this[offset+i3]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength2);return val};Buffer2.prototype.readIntBE=function readIntBE(offset,byteLength2,noAssert){offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert)checkOffset(offset,byteLength2,this.length);var i3=byteLength2;var mul=1;var val=this[offset+--i3];while(i3>0&&(mul*=256)){val+=this[offset+--i3]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength2);return val};Buffer2.prototype.readInt8=function readInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer2.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer2.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer2.prototype.readInt32LE=function readInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer2.prototype.readInt32BE=function readInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer2.prototype.readFloatLE=function readFloatLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer2.prototype.readFloatBE=function readFloatBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer2.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer2.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer2.isBuffer(buf))throw new TypeError(\'"buffer" argument must be a Buffer instance\');if(value>max||value<min)throw new RangeError(\'"value" argument is out of bounds\');if(offset+ext>buf.length)throw new RangeError("Index out of range")}Buffer2.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength2,noAssert){value=+value;offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength2)-1;checkInt(this,value,offset,byteLength2,maxBytes,0)}var mul=1;var i3=0;this[offset]=value&255;while(++i3<byteLength2&&(mul*=256)){this[offset+i3]=value/mul&255}return offset+byteLength2};Buffer2.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength2,noAssert){value=+value;offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength2)-1;checkInt(this,value,offset,byteLength2,maxBytes,0)}var i3=byteLength2-1;var mul=1;this[offset+i3]=value&255;while(--i3>=0&&(mul*=256)){this[offset+i3]=value/mul&255}return offset+byteLength2};Buffer2.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,255,0);this[offset]=value&255;return offset+1};Buffer2.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer2.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer2.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255;return offset+4};Buffer2.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};Buffer2.prototype.writeIntLE=function writeIntLE(value,offset,byteLength2,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength2-1);checkInt(this,value,offset,byteLength2,limit-1,-limit)}var i3=0;var mul=1;var sub=0;this[offset]=value&255;while(++i3<byteLength2&&(mul*=256)){if(value<0&&sub===0&&this[offset+i3-1]!==0){sub=1}this[offset+i3]=(value/mul>>0)-sub&255}return offset+byteLength2};Buffer2.prototype.writeIntBE=function writeIntBE(value,offset,byteLength2,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength2-1);checkInt(this,value,offset,byteLength2,limit-1,-limit)}var i3=byteLength2-1;var mul=1;var sub=0;this[offset+i3]=value&255;while(--i3>=0&&(mul*=256)){if(value<0&&sub===0&&this[offset+i3+1]!==0){sub=1}this[offset+i3]=(value/mul>>0)-sub&255}return offset+byteLength2};Buffer2.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer2.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer2.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer2.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24;return offset+4};Buffer2.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,4,34028234663852886e22,-34028234663852886e22)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer2.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer2.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,8,17976931348623157e292,-17976931348623157e292)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer2.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer2.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer2.prototype.copy=function copy(target,targetStart,start,end){if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;var i3;if(this===target&&start<targetStart&&targetStart<end){for(i3=len-1;i3>=0;--i3){target[i3+targetStart]=this[i3+start]}}else if(len<1e3){for(i3=0;i3<len;++i3){target[i3+targetStart]=this[i3+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart)}return len};Buffer2.prototype.fill=function fill(val,start,end,encoding){if(typeof val==="string"){if(typeof start==="string"){encoding=start;start=0;end=this.length}else if(typeof end==="string"){encoding=end;end=this.length}if(val.length===1){var code=val.charCodeAt(0);if(code<256){val=code}}if(encoding!==void 0&&typeof encoding!=="string"){throw new TypeError("encoding must be a string")}if(typeof encoding==="string"&&!Buffer2.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}}else if(typeof val==="number"){val=val&255}if(start<0||this.length<start||this.length<end){throw new RangeError("Out of range index")}if(end<=start){return this}start=start>>>0;end=end===void 0?this.length:end>>>0;if(!val)val=0;var i3;if(typeof val==="number"){for(i3=start;i3<end;++i3){this[i3]=val}}else{var bytes=Buffer2.isBuffer(val)?val:new Buffer2(val,encoding);var len=bytes.length;for(i3=0;i3<end-start;++i3){this[i3+start]=bytes[i3%len]}}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(str4){str4=str4.trim().replace(INVALID_BASE64_RE,"");if(str4.length<2)return"";while(str4.length%4!==0){str4=str4+"="}return str4}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i3=0;i3<length;++i3){codePoint=string.charCodeAt(i3);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i3+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189)}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str4){var byteArray=[];for(var i3=0;i3<str4.length;++i3){byteArray.push(str4.charCodeAt(i3)&255)}return byteArray}function utf16leToBytes(str4,units){var c,hi,lo;var byteArray=[];for(var i3=0;i3<str4.length;++i3){if((units-=2)<0)break;c=str4.charCodeAt(i3);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str4){return base64.toByteArray(base64clean(str4))}function blitBuffer(src,dst,offset,length){for(var i3=0;i3<length;++i3){if(i3+offset>=dst.length||i3>=src.length)break;dst[i3+offset]=src[i3]}return i3}function isArrayBuffer(obj){return obj instanceof ArrayBuffer||obj!=null&&obj.constructor!=null&&obj.constructor.name==="ArrayBuffer"&&typeof obj.byteLength==="number"}function isArrayBufferView(obj){return typeof ArrayBuffer.isView==="function"&&ArrayBuffer.isView(obj)}function numberIsNaN(obj){return obj!==obj}}).call(exports2,__webpack_require__(1))},function(module22,exports2){"use strict";exports2.byteLength=byteLength;exports2.toByteArray=toByteArray;exports2.fromByteArray=fromByteArray;var lookup=[];var revLookup=[];var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i3=0,len=code.length;i3<len;++i3){lookup[i3]=code[i3];revLookup[code.charCodeAt(i3)]=i3}revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function placeHoldersCount(b64){var len2=b64.length;if(len2%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}return b64[len2-2]==="="?2:b64[len2-1]==="="?1:0}function byteLength(b64){return b64.length*3/4-placeHoldersCount(b64)}function toByteArray(b64){var i22,j,l,tmp,placeHolders,arr;var len2=b64.length;placeHolders=placeHoldersCount(b64);arr=new Arr(len2*3/4-placeHolders);l=placeHolders>0?len2-4:len2;var L2=0;for(i22=0,j=0;i22<l;i22+=4,j+=3){tmp=revLookup[b64.charCodeAt(i22)]<<18|revLookup[b64.charCodeAt(i22+1)]<<12|revLookup[b64.charCodeAt(i22+2)]<<6|revLookup[b64.charCodeAt(i22+3)];arr[L2++]=tmp>>16&255;arr[L2++]=tmp>>8&255;arr[L2++]=tmp&255}if(placeHolders===2){tmp=revLookup[b64.charCodeAt(i22)]<<2|revLookup[b64.charCodeAt(i22+1)]>>4;arr[L2++]=tmp&255}else if(placeHolders===1){tmp=revLookup[b64.charCodeAt(i22)]<<10|revLookup[b64.charCodeAt(i22+1)]<<4|revLookup[b64.charCodeAt(i22+2)]>>2;arr[L2++]=tmp>>8&255;arr[L2++]=tmp&255}return arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}function encodeChunk(uint8,start,end){var tmp;var output=[];for(var i22=start;i22<end;i22+=3){tmp=(uint8[i22]<<16)+(uint8[i22+1]<<8)+uint8[i22+2];output.push(tripletToBase64(tmp))}return output.join("")}function fromByteArray(uint8){var tmp;var len2=uint8.length;var extraBytes=len2%3;var output="";var parts=[];var maxChunkLength=16383;for(var i22=0,len22=len2-extraBytes;i22<len22;i22+=maxChunkLength){parts.push(encodeChunk(uint8,i22,i22+maxChunkLength>len22?len22:i22+maxChunkLength))}if(extraBytes===1){tmp=uint8[len2-1];output+=lookup[tmp>>2];output+=lookup[tmp<<4&63];output+="=="}else if(extraBytes===2){tmp=(uint8[len2-2]<<8)+uint8[len2-1];output+=lookup[tmp>>10];output+=lookup[tmp>>4&63];output+=lookup[tmp<<2&63];output+="="}parts.push(output);return parts.join("")}},function(module22,exports2){exports2.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i3=isLE?nBytes-1:0;var d2=isLE?-1:1;var s=buffer[offset+i3];i3+=d2;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i3],i3+=d2,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i3],i3+=d2,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports2.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i3=isLE?0:nBytes-1;var d2=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i3]=m&255,i3+=d2,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i3]=e&255,i3+=d2,e/=256,eLen-=8){}buffer[offset+i3-d2]|=s*128}},function(module22,exports2){module22.exports=function(module3){if(!module3.webpackPolyfill){module3.deprecate=function(){};module3.paths=[];module3.children=[];module3.webpackPolyfill=1}return module3}},function(module22,exports2,__webpack_require__){"use strict";var Process=__webpack_require__(7);var process=new Process,processProxy={};function defineKey(key2){if(processProxy[key2]){return}if(typeof process[key2]==="function"){processProxy[key2]=function(){return process[key2].apply(process,arguments)}}else{processProxy[key2]=process[key2]}}for(var key in process){defineKey(key)}processProxy.initializeTTYs=function(){if(process.stdin===null){process.initializeTTYs();processProxy.stdin=process.stdin;processProxy.stdout=process.stdout;processProxy.stderr=process.stderr}};process.nextTick(function(){processProxy.initializeTTYs()});module22.exports=processProxy},function(module22,exports2,__webpack_require__){(function(__dirname){"use strict";var __extends=this&&this.__extends||function(d2,b){for(var p2 in b)if(b.hasOwnProperty(p2))d2[p2]=b[p2];function __(){this.constructor=d2}d2.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)};var events=__webpack_require__(8);var path=null;var Item=function(){function Item2(fun,array){this.fun=fun;this.array=array}Item2.prototype.run=function(){this.fun.apply(null,this.array)};return Item2}();var NextTickQueue=function(){function NextTickQueue2(){this._queue=[];this._draining=false;this._currentQueue=null;this._queueIndex=-1}NextTickQueue2.prototype.push=function(item){var _this=this;if(this._queue.push(item)===1&&!this._draining){setTimeout(function(){return _this._drainQueue()},0)}};NextTickQueue2.prototype._cleanUpNextTick=function(){this._draining=false;if(this._currentQueue&&this._currentQueue.length){this._queue=this._currentQueue.concat(this._queue)}else{this._queueIndex=-1}if(this._queue.length){this._drainQueue()}};NextTickQueue2.prototype._drainQueue=function(){var _this=this;if(this._draining){return}var timeout=setTimeout(function(){return _this._cleanUpNextTick()});this._draining=true;var len=this._queue.length;while(len){this._currentQueue=this._queue;this._queue=[];while(++this._queueIndex<len){if(this._currentQueue){this._currentQueue[this._queueIndex].run()}}this._queueIndex=-1;len=this._queue.length}this._currentQueue=null;this._draining=false;clearTimeout(timeout)};return NextTickQueue2}();var Process=function(_super){__extends(Process2,_super);function Process2(){_super.apply(this,arguments);this.startTime=Date.now();this._cwd="/";this.platform="browser";this.argv=[];this.execArgv=[];this.stdout=null;this.stderr=null;this.stdin=null;this.domain=null;this._queue=new NextTickQueue;this.execPath=__dirname;this.env={};this.exitCode=0;this._gid=1;this._uid=1;this.version="v5.0";this.versions={http_parser:"0.0",node:"5.0",v8:"0.0",uv:"0.0",zlib:"0.0",ares:"0.0",icu:"0.0",modules:"0",openssl:"0.0"};this.config={target_defaults:{cflags:[],default_configuration:"Release",defines:[],include_dirs:[],libraries:[]},variables:{clang:0,host_arch:"x32",node_install_npm:false,node_install_waf:false,node_prefix:"",node_shared_cares:false,node_shared_http_parser:false,node_shared_libuv:false,node_shared_zlib:false,node_shared_v8:false,node_use_dtrace:false,node_use_etw:false,node_use_openssl:false,node_shared_openssl:false,strict_aliasing:false,target_arch:"x32",v8_use_snapshot:false,v8_no_strict_aliasing:0,visibility:""}};this.pid=Math.random()*1e3|0;this.title="node";this.arch="x32";this._mask=18;this.connected=void 0}Process2.prototype.chdir=function(dir){if(path===null){path=__webpack_require__(9)}this._cwd=path.resolve(dir)};Process2.prototype.cwd=function(){return this._cwd};Process2.prototype.uptime=function(){return(Date.now()-this.startTime)/1e3|0};Process2.prototype.nextTick=function(fun){var args=[];for(var _i=1;_i<arguments.length;_i++){args[_i-1]=arguments[_i]}this._queue.push(new Item(fun,args))};Process2.prototype.abort=function(){this.emit("abort")};Process2.prototype.exit=function(code){this.exitCode=code;this.emit("exit",[code])};Process2.prototype.getgid=function(){return this._gid};Process2.prototype.setgid=function(gid){if(typeof gid==="number"){this._gid=gid}else{this._gid=1}};Process2.prototype.getuid=function(){return this._uid};Process2.prototype.setuid=function(uid){if(typeof uid==="number"){this._uid=uid}else{this._uid=1}};Process2.prototype.kill=function(pid,signal){this.emit("kill",[pid,signal])};Process2.prototype.memoryUsage=function(){return{rss:0,heapTotal:0,heapUsed:0}};Process2.prototype.umask=function(mask){if(mask===void 0){mask=this._mask}var oldMask=this._mask;this._mask=mask;this.emit("umask",[mask]);return oldMask};Process2.prototype.hrtime=function(){var timeinfo;if(typeof performance!=="undefined"){timeinfo=performance.now()}else if(Date["now"]){timeinfo=Date.now()}else{timeinfo=new Date().getTime()}var secs=timeinfo/1e3|0;timeinfo-=secs*1e3;timeinfo=timeinfo*1e6|0;return[secs,timeinfo]};Process2.prototype.initializeTTYs=function(){if(this.stdout===null){var TTY=__webpack_require__(10);this.stdout=new TTY;this.stderr=new TTY;this.stdin=new TTY}};Process2.prototype.disconnect=function(){};return Process2}(events.EventEmitter);module22.exports=Process}).call(exports2,"/")},function(module22,exports2){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}module22.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=void 0;EventEmitter.prototype._maxListeners=void 0;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i3,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}else{var err=new Error(\'Uncaught, unspecified "error" event. (\'+er+")");err.context=er;throw err}}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction3(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1);handler.apply(this,args)}}else if(isObject(handler)){args=Array.prototype.slice.call(arguments,1);listeners=handler.slice();len=listeners.length;for(i3=0;i3<len;i3++)listeners[i3].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction3(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction3(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction3(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i3;if(!isFunction3(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction3(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i3=length;i3-- >0;){if(list[i3]===listener||list[i3].listener&&list[i3].listener===listener){position=i3;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction3(listeners)){this.removeListener(type,listeners)}else if(listeners){while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction3(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction3(evlistener))return 1;else if(evlistener)return evlistener.length}return 0};EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)};function isFunction3(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},function(module22,exports2,__webpack_require__){(function(process){"use strict";var splitPathRe=/^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;function posixSplitPath(filename){var out=splitPathRe.exec(filename);out.shift();return out}var path=function(){function path2(){}path2.normalize=function(p2){if(p2===""){p2="."}var absolute=p2.charAt(0)===path2.sep;p2=path2._removeDuplicateSeps(p2);var components=p2.split(path2.sep);var goodComponents=[];for(var idx=0;idx<components.length;idx++){var c=components[idx];if(c==="."){continue}else if(c===".."&&(absolute||!absolute&&goodComponents.length>0&&goodComponents[0]!=="..")){goodComponents.pop()}else{goodComponents.push(c)}}if(!absolute&&goodComponents.length<2){switch(goodComponents.length){case 1:if(goodComponents[0]===""){goodComponents.unshift(".")}break;default:goodComponents.push(".")}}p2=goodComponents.join(path2.sep);if(absolute&&p2.charAt(0)!==path2.sep){p2=path2.sep+p2}return p2};path2.join=function(){var paths=[];for(var _i=0;_i<arguments.length;_i++){paths[_i-0]=arguments[_i]}var processed=[];for(var i3=0;i3<paths.length;i3++){var segment=paths[i3];if(typeof segment!=="string"){throw new TypeError("Invalid argument type to path.join: "+typeof segment)}else if(segment!==""){processed.push(segment)}}return path2.normalize(processed.join(path2.sep))};path2.resolve=function(){var paths=[];for(var _i=0;_i<arguments.length;_i++){paths[_i-0]=arguments[_i]}var processed=[];for(var i3=0;i3<paths.length;i3++){var p2=paths[i3];if(typeof p2!=="string"){throw new TypeError("Invalid argument type to path.join: "+typeof p2)}else if(p2!==""){if(p2.charAt(0)===path2.sep){processed=[]}processed.push(p2)}}var resolved=path2.normalize(processed.join(path2.sep));if(resolved.length>1&&resolved.charAt(resolved.length-1)===path2.sep){return resolved.substr(0,resolved.length-1)}if(resolved.charAt(0)!==path2.sep){if(resolved.charAt(0)==="."&&(resolved.length===1||resolved.charAt(1)===path2.sep)){resolved=resolved.length===1?"":resolved.substr(2)}var cwd=process.cwd();if(resolved!==""){resolved=this.normalize(cwd+(cwd!=="/"?path2.sep:"")+resolved)}else{resolved=cwd}}return resolved};path2.relative=function(from,to){var i3;from=path2.resolve(from);to=path2.resolve(to);var fromSegs=from.split(path2.sep);var toSegs=to.split(path2.sep);toSegs.shift();fromSegs.shift();var upCount=0;var downSegs=[];for(i3=0;i3<fromSegs.length;i3++){var seg=fromSegs[i3];if(seg===toSegs[i3]){continue}upCount=fromSegs.length-i3;break}downSegs=toSegs.slice(i3);if(fromSegs.length===1&&fromSegs[0]===""){upCount=0}if(upCount>fromSegs.length){upCount=fromSegs.length}var rv="";for(i3=0;i3<upCount;i3++){rv+="../"}rv+=downSegs.join(path2.sep);if(rv.length>1&&rv.charAt(rv.length-1)===path2.sep){rv=rv.substr(0,rv.length-1)}return rv};path2.dirname=function(p2){p2=path2._removeDuplicateSeps(p2);var absolute=p2.charAt(0)===path2.sep;var sections=p2.split(path2.sep);if(sections.pop()===""&&sections.length>0){sections.pop()}if(sections.length>1||sections.length===1&&!absolute){return sections.join(path2.sep)}else if(absolute){return path2.sep}else{return"."}};path2.basename=function(p2,ext){if(ext===void 0){ext=""}if(p2===""){return p2}p2=path2.normalize(p2);var sections=p2.split(path2.sep);var lastPart=sections[sections.length-1];if(lastPart===""&&sections.length>1){return sections[sections.length-2]}if(ext.length>0){var lastPartExt=lastPart.substr(lastPart.length-ext.length);if(lastPartExt===ext){return lastPart.substr(0,lastPart.length-ext.length)}}return lastPart};path2.extname=function(p2){p2=path2.normalize(p2);var sections=p2.split(path2.sep);p2=sections.pop();if(p2===""&&sections.length>0){p2=sections.pop()}if(p2===".."){return""}var i3=p2.lastIndexOf(".");if(i3===-1||i3===0){return""}return p2.substr(i3)};path2.isAbsolute=function(p2){return p2.length>0&&p2.charAt(0)===path2.sep};path2._makeLong=function(p2){return p2};path2.parse=function(p2){var allParts=posixSplitPath(p2);return{root:allParts[0],dir:allParts[0]+allParts[1].slice(0,-1),base:allParts[2],ext:allParts[3],name:allParts[2].slice(0,allParts[2].length-allParts[3].length)}};path2.format=function(pathObject){if(pathObject===null||typeof pathObject!=="object"){throw new TypeError("Parameter \'pathObject\' must be an object, not "+typeof pathObject)}var root=pathObject.root||"";if(typeof root!=="string"){throw new TypeError("\'pathObject.root\' must be a string or undefined, not "+typeof pathObject.root)}var dir=pathObject.dir?pathObject.dir+path2.sep:"";var base=pathObject.base||"";return dir+base};path2._removeDuplicateSeps=function(p2){p2=p2.replace(this._replaceRegex,this.sep);return p2};path2.sep="/";path2._replaceRegex=new RegExp("//+","g");path2.delimiter=":";path2.posix=path2;path2.win32=path2;return path2}();var _=path;module22.exports=path}).call(exports2,__webpack_require__(6))},function(module22,exports2,__webpack_require__){(function(Buffer2){"use strict";var __extends=this&&this.__extends||function(d2,b){for(var p2 in b)if(b.hasOwnProperty(p2))d2[p2]=b[p2];function __(){this.constructor=d2}d2.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)};var stream=__webpack_require__(11);var TTY=function(_super){__extends(TTY2,_super);function TTY2(){_super.call(this);this.isRaw=false;this.columns=80;this.rows=120;this.isTTY=true;this._bufferedWrites=[];this._waitingForWrites=false}TTY2.prototype.setRawMode=function(mode){if(this.isRaw!==mode){this.isRaw=mode;this.emit("modeChange")}};TTY2.prototype.changeColumns=function(columns){if(columns!==this.columns){this.columns=columns;this.emit("resize")}};TTY2.prototype.changeRows=function(rows){if(rows!==this.rows){this.rows=rows;this.emit("resize")}};TTY2.isatty=function(fd){return fd&&fd instanceof TTY2};TTY2.prototype._write=function(chunk,encoding,cb){var error;try{var data;if(typeof chunk==="string"){data=new Buffer2(chunk,encoding)}else{data=chunk}this._bufferedWrites.push(data);if(this._waitingForWrites){this._read(1024)}}catch(e){error=e}finally{cb(error)}};TTY2.prototype._read=function(size){if(this._bufferedWrites.length===0){this._waitingForWrites=true}else{while(this._bufferedWrites.length>0){this._waitingForWrites=this.push(this._bufferedWrites.shift());if(!this._waitingForWrites){break}}}};return TTY2}(stream.Duplex);module22.exports=TTY}).call(exports2,__webpack_require__(1))},function(module22,exports2,__webpack_require__){module22.exports=Stream;var EE=__webpack_require__(8).EventEmitter;var inherits=__webpack_require__(12);inherits(Stream,EE);Stream.Readable=__webpack_require__(13);Stream.Writable=__webpack_require__(27);Stream.Duplex=__webpack_require__(28);Stream.Transform=__webpack_require__(29);Stream.PassThrough=__webpack_require__(30);Stream.Stream=Stream;function Stream(){EE.call(this)}Stream.prototype.pipe=function(dest,options){var source=this;function ondata(chunk){if(dest.writable){if(false===dest.write(chunk)&&source.pause){source.pause()}}}source.on("data",ondata);function ondrain(){if(source.readable&&source.resume){source.resume()}}dest.on("drain",ondrain);if(!dest._isStdio&&(!options||options.end!==false)){source.on("end",onend);source.on("close",onclose)}var didOnEnd=false;function onend(){if(didOnEnd)return;didOnEnd=true;dest.end()}function onclose(){if(didOnEnd)return;didOnEnd=true;if(typeof dest.destroy==="function")dest.destroy()}function onerror(er){cleanup();if(EE.listenerCount(this,"error")===0){throw er}}source.on("error",onerror);dest.on("error",onerror);function cleanup(){source.removeListener("data",ondata);dest.removeListener("drain",ondrain);source.removeListener("end",onend);source.removeListener("close",onclose);source.removeListener("error",onerror);dest.removeListener("error",onerror);source.removeListener("end",cleanup);source.removeListener("close",cleanup);dest.removeListener("close",cleanup)}source.on("end",cleanup);source.on("close",cleanup);dest.on("close",cleanup);dest.emit("pipe",source);return dest}},function(module22,exports2){if(typeof Object.create==="function"){module22.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}else{module22.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}},function(module22,exports2,__webpack_require__){(function(process){var Stream=function(){try{return __webpack_require__(11)}catch(_){}}();exports2=module22.exports=__webpack_require__(14);exports2.Stream=Stream||exports2;exports2.Readable=exports2;exports2.Writable=__webpack_require__(22);exports2.Duplex=__webpack_require__(21);exports2.Transform=__webpack_require__(25);exports2.PassThrough=__webpack_require__(26);if(!process.browser&&process.env.READABLE_STREAM==="disable"&&Stream){module22.exports=Stream}}).call(exports2,__webpack_require__(6))},function(module22,exports2,__webpack_require__){(function(process){"use strict";module22.exports=Readable;var processNextTick=__webpack_require__(15);var isArray=__webpack_require__(16);var Duplex;Readable.ReadableState=ReadableState;var EE=__webpack_require__(8).EventEmitter;var EElistenerCount=function(emitter,type){return emitter.listeners(type).length};var Stream;(function(){try{Stream=__webpack_require__(11)}catch(_){}finally{if(!Stream)Stream=__webpack_require__(8).EventEmitter}})();var Buffer2=__webpack_require__(2).Buffer;var bufferShim=__webpack_require__(17);var util=__webpack_require__(18);util.inherits=__webpack_require__(12);var debugUtil=__webpack_require__(19);var debug=void 0;if(debugUtil&&debugUtil.debuglog){debug=debugUtil.debuglog("stream")}else{debug=function(){}}var BufferList=__webpack_require__(20);var StringDecoder;util.inherits(Readable,Stream);function prependListener(emitter,event,fn){if(typeof emitter.prependListener==="function"){return emitter.prependListener(event,fn)}else{if(!emitter._events||!emitter._events[event])emitter.on(event,fn);else if(isArray(emitter._events[event]))emitter._events[event].unshift(fn);else emitter._events[event]=[fn,emitter._events[event]]}}function ReadableState(options,stream){Duplex=Duplex||__webpack_require__(21);options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)this.objectMode=this.objectMode||!!options.readableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=hwm||hwm===0?hwm:defaultHwm;this.highWaterMark=~~this.highWaterMark;this.buffer=new BufferList;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.defaultEncoding=options.defaultEncoding||"utf8";this.ranOut=false;this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(options.encoding){if(!StringDecoder)StringDecoder=__webpack_require__(24).StringDecoder;this.decoder=new StringDecoder(options.encoding);this.encoding=options.encoding}}function Readable(options){Duplex=Duplex||__webpack_require__(21);if(!(this instanceof Readable))return new Readable(options);this._readableState=new ReadableState(options,this);this.readable=true;if(options&&typeof options.read==="function")this._read=options.read;Stream.call(this)}Readable.prototype.push=function(chunk,encoding){var state4=this._readableState;if(!state4.objectMode&&typeof chunk==="string"){encoding=encoding||state4.defaultEncoding;if(encoding!==state4.encoding){chunk=bufferShim.from(chunk,encoding);encoding=""}}return readableAddChunk(this,state4,chunk,encoding,false)};Readable.prototype.unshift=function(chunk){var state4=this._readableState;return readableAddChunk(this,state4,chunk,"",true)};Readable.prototype.isPaused=function(){return this._readableState.flowing===false};function readableAddChunk(stream,state4,chunk,encoding,addToFront){var er=chunkInvalid(state4,chunk);if(er){stream.emit("error",er)}else if(chunk===null){state4.reading=false;onEofChunk(stream,state4)}else if(state4.objectMode||chunk&&chunk.length>0){if(state4.ended&&!addToFront){var e=new Error("stream.push() after EOF");stream.emit("error",e)}else if(state4.endEmitted&&addToFront){var _e=new Error("stream.unshift() after end event");stream.emit("error",_e)}else{var skipAdd;if(state4.decoder&&!addToFront&&!encoding){chunk=state4.decoder.write(chunk);skipAdd=!state4.objectMode&&chunk.length===0}if(!addToFront)state4.reading=false;if(!skipAdd){if(state4.flowing&&state4.length===0&&!state4.sync){stream.emit("data",chunk);stream.read(0)}else{state4.length+=state4.objectMode?1:chunk.length;if(addToFront)state4.buffer.unshift(chunk);else state4.buffer.push(chunk);if(state4.needReadable)emitReadable(stream)}}maybeReadMore(stream,state4)}}else if(!addToFront){state4.reading=false}return needMoreData(state4)}function needMoreData(state4){return!state4.ended&&(state4.needReadable||state4.length<state4.highWaterMark||state4.length===0)}Readable.prototype.setEncoding=function(enc){if(!StringDecoder)StringDecoder=__webpack_require__(24).StringDecoder;this._readableState.decoder=new StringDecoder(enc);this._readableState.encoding=enc;return this};var MAX_HWM=8388608;function computeNewHighWaterMark(n){if(n>=MAX_HWM){n=MAX_HWM}else{n--;n|=n>>>1;n|=n>>>2;n|=n>>>4;n|=n>>>8;n|=n>>>16;n++}return n}function howMuchToRead(n,state4){if(n<=0||state4.length===0&&state4.ended)return 0;if(state4.objectMode)return 1;if(n!==n){if(state4.flowing&&state4.length)return state4.buffer.head.data.length;else return state4.length}if(n>state4.highWaterMark)state4.highWaterMark=computeNewHighWaterMark(n);if(n<=state4.length)return n;if(!state4.ended){state4.needReadable=true;return 0}return state4.length}Readable.prototype.read=function(n){debug("read",n);n=parseInt(n,10);var state4=this._readableState;var nOrig=n;if(n!==0)state4.emittedReadable=false;if(n===0&&state4.needReadable&&(state4.length>=state4.highWaterMark||state4.ended)){debug("read: emitReadable",state4.length,state4.ended);if(state4.length===0&&state4.ended)endReadable(this);else emitReadable(this);return null}n=howMuchToRead(n,state4);if(n===0&&state4.ended){if(state4.length===0)endReadable(this);return null}var doRead=state4.needReadable;debug("need readable",doRead);if(state4.length===0||state4.length-n<state4.highWaterMark){doRead=true;debug("length less than watermark",doRead)}if(state4.ended||state4.reading){doRead=false;debug("reading or ended",doRead)}else if(doRead){debug("do read");state4.reading=true;state4.sync=true;if(state4.length===0)state4.needReadable=true;this._read(state4.highWaterMark);state4.sync=false;if(!state4.reading)n=howMuchToRead(nOrig,state4)}var ret;if(n>0)ret=fromList(n,state4);else ret=null;if(ret===null){state4.needReadable=true;n=0}else{state4.length-=n}if(state4.length===0){if(!state4.ended)state4.needReadable=true;if(nOrig!==n&&state4.ended)endReadable(this)}if(ret!==null)this.emit("data",ret);return ret};function chunkInvalid(state4,chunk){var er=null;if(!Buffer2.isBuffer(chunk)&&typeof chunk!=="string"&&chunk!==null&&chunk!==void 0&&!state4.objectMode){er=new TypeError("Invalid non-string/buffer chunk")}return er}function onEofChunk(stream,state4){if(state4.ended)return;if(state4.decoder){var chunk=state4.decoder.end();if(chunk&&chunk.length){state4.buffer.push(chunk);state4.length+=state4.objectMode?1:chunk.length}}state4.ended=true;emitReadable(stream)}function emitReadable(stream){var state4=stream._readableState;state4.needReadable=false;if(!state4.emittedReadable){debug("emitReadable",state4.flowing);state4.emittedReadable=true;if(state4.sync)processNextTick(emitReadable_,stream);else emitReadable_(stream)}}function emitReadable_(stream){debug("emit readable");stream.emit("readable");flow(stream)}function maybeReadMore(stream,state4){if(!state4.readingMore){state4.readingMore=true;processNextTick(maybeReadMore_,stream,state4)}}function maybeReadMore_(stream,state4){var len=state4.length;while(!state4.reading&&!state4.flowing&&!state4.ended&&state4.length<state4.highWaterMark){debug("maybeReadMore read 0");stream.read(0);if(len===state4.length)break;else len=state4.length}state4.readingMore=false}Readable.prototype._read=function(n){this.emit("error",new Error("_read() is not implemented"))};Readable.prototype.pipe=function(dest,pipeOpts){var src=this;var state4=this._readableState;switch(state4.pipesCount){case 0:state4.pipes=dest;break;case 1:state4.pipes=[state4.pipes,dest];break;default:state4.pipes.push(dest);break}state4.pipesCount+=1;debug("pipe count=%d opts=%j",state4.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==false)&&dest!==process.stdout&&dest!==process.stderr;var endFn=doEnd?onend:cleanup;if(state4.endEmitted)processNextTick(endFn);else src.once("end",endFn);dest.on("unpipe",onunpipe);function onunpipe(readable){debug("onunpipe");if(readable===src){cleanup()}}function onend(){debug("onend");dest.end()}var ondrain=pipeOnDrain(src);dest.on("drain",ondrain);var cleanedUp=false;function cleanup(){debug("cleanup");dest.removeListener("close",onclose);dest.removeListener("finish",onfinish);dest.removeListener("drain",ondrain);dest.removeListener("error",onerror);dest.removeListener("unpipe",onunpipe);src.removeListener("end",onend);src.removeListener("end",cleanup);src.removeListener("data",ondata);cleanedUp=true;if(state4.awaitDrain&&(!dest._writableState||dest._writableState.needDrain))ondrain()}var increasedAwaitDrain=false;src.on("data",ondata);function ondata(chunk){debug("ondata");increasedAwaitDrain=false;var ret=dest.write(chunk);if(false===ret&&!increasedAwaitDrain){if((state4.pipesCount===1&&state4.pipes===dest||state4.pipesCount>1&&indexOf(state4.pipes,dest)!==-1)&&!cleanedUp){debug("false write response, pause",src._readableState.awaitDrain);src._readableState.awaitDrain++;increasedAwaitDrain=true}src.pause()}}function onerror(er){debug("onerror",er);unpipe();dest.removeListener("error",onerror);if(EElistenerCount(dest,"error")===0)dest.emit("error",er)}prependListener(dest,"error",onerror);function onclose(){dest.removeListener("finish",onfinish);unpipe()}dest.once("close",onclose);function onfinish(){debug("onfinish");dest.removeListener("close",onclose);unpipe()}dest.once("finish",onfinish);function unpipe(){debug("unpipe");src.unpipe(dest)}dest.emit("pipe",src);if(!state4.flowing){debug("pipe resume");src.resume()}return dest};function pipeOnDrain(src){return function(){var state4=src._readableState;debug("pipeOnDrain",state4.awaitDrain);if(state4.awaitDrain)state4.awaitDrain--;if(state4.awaitDrain===0&&EElistenerCount(src,"data")){state4.flowing=true;flow(src)}}}Readable.prototype.unpipe=function(dest){var state4=this._readableState;if(state4.pipesCount===0)return this;if(state4.pipesCount===1){if(dest&&dest!==state4.pipes)return this;if(!dest)dest=state4.pipes;state4.pipes=null;state4.pipesCount=0;state4.flowing=false;if(dest)dest.emit("unpipe",this);return this}if(!dest){var dests=state4.pipes;var len=state4.pipesCount;state4.pipes=null;state4.pipesCount=0;state4.flowing=false;for(var i3=0;i3<len;i3++){dests[i3].emit("unpipe",this)}return this}var index=indexOf(state4.pipes,dest);if(index===-1)return this;state4.pipes.splice(index,1);state4.pipesCount-=1;if(state4.pipesCount===1)state4.pipes=state4.pipes[0];dest.emit("unpipe",this);return this};Readable.prototype.on=function(ev2,fn){var res=Stream.prototype.on.call(this,ev2,fn);if(ev2==="data"){if(this._readableState.flowing!==false)this.resume()}else if(ev2==="readable"){var state4=this._readableState;if(!state4.endEmitted&&!state4.readableListening){state4.readableListening=state4.needReadable=true;state4.emittedReadable=false;if(!state4.reading){processNextTick(nReadingNextTick,this)}else if(state4.length){emitReadable(this,state4)}}}return res};Readable.prototype.addListener=Readable.prototype.on;function nReadingNextTick(self2){debug("readable nexttick read 0");self2.read(0)}Readable.prototype.resume=function(){var state4=this._readableState;if(!state4.flowing){debug("resume");state4.flowing=true;resume(this,state4)}return this};function resume(stream,state4){if(!state4.resumeScheduled){state4.resumeScheduled=true;processNextTick(resume_,stream,state4)}}function resume_(stream,state4){if(!state4.reading){debug("resume read 0");stream.read(0)}state4.resumeScheduled=false;state4.awaitDrain=0;stream.emit("resume");flow(stream);if(state4.flowing&&!state4.reading)stream.read(0)}Readable.prototype.pause=function(){debug("call pause flowing=%j",this._readableState.flowing);if(false!==this._readableState.flowing){debug("pause");this._readableState.flowing=false;this.emit("pause")}return this};function flow(stream){var state4=stream._readableState;debug("flow",state4.flowing);while(state4.flowing&&stream.read()!==null){}}Readable.prototype.wrap=function(stream){var state4=this._readableState;var paused=false;var self2=this;stream.on("end",function(){debug("wrapped end");if(state4.decoder&&!state4.ended){var chunk=state4.decoder.end();if(chunk&&chunk.length)self2.push(chunk)}self2.push(null)});stream.on("data",function(chunk){debug("wrapped data");if(state4.decoder)chunk=state4.decoder.write(chunk);if(state4.objectMode&&(chunk===null||chunk===void 0))return;else if(!state4.objectMode&&(!chunk||!chunk.length))return;var ret=self2.push(chunk);if(!ret){paused=true;stream.pause()}});for(var i3 in stream){if(this[i3]===void 0&&typeof stream[i3]==="function"){this[i3]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i3)}}var events=["error","close","destroy","pause","resume"];forEach(events,function(ev2){stream.on(ev2,self2.emit.bind(self2,ev2))});self2._read=function(n){debug("wrapped _read",n);if(paused){paused=false;stream.resume()}};return self2};Readable._fromList=fromList;function fromList(n,state4){if(state4.length===0)return null;var ret;if(state4.objectMode)ret=state4.buffer.shift();else if(!n||n>=state4.length){if(state4.decoder)ret=state4.buffer.join("");else if(state4.buffer.length===1)ret=state4.buffer.head.data;else ret=state4.buffer.concat(state4.length);state4.buffer.clear()}else{ret=fromListPartial(n,state4.buffer,state4.decoder)}return ret}function fromListPartial(n,list,hasStrings){var ret;if(n<list.head.data.length){ret=list.head.data.slice(0,n);list.head.data=list.head.data.slice(n)}else if(n===list.head.data.length){ret=list.shift()}else{ret=hasStrings?copyFromBufferString(n,list):copyFromBuffer(n,list)}return ret}function copyFromBufferString(n,list){var p2=list.head;var c=1;var ret=p2.data;n-=ret.length;while(p2=p2.next){var str4=p2.data;var nb=n>str4.length?str4.length:n;if(nb===str4.length)ret+=str4;else ret+=str4.slice(0,n);n-=nb;if(n===0){if(nb===str4.length){++c;if(p2.next)list.head=p2.next;else list.head=list.tail=null}else{list.head=p2;p2.data=str4.slice(nb)}break}++c}list.length-=c;return ret}function copyFromBuffer(n,list){var ret=bufferShim.allocUnsafe(n);var p2=list.head;var c=1;p2.data.copy(ret);n-=p2.data.length;while(p2=p2.next){var buf=p2.data;var nb=n>buf.length?buf.length:n;buf.copy(ret,ret.length-n,0,nb);n-=nb;if(n===0){if(nb===buf.length){++c;if(p2.next)list.head=p2.next;else list.head=list.tail=null}else{list.head=p2;p2.data=buf.slice(nb)}break}++c}list.length-=c;return ret}function endReadable(stream){var state4=stream._readableState;if(state4.length>0)throw new Error(\'"endReadable()" called on non-empty stream\');if(!state4.endEmitted){state4.ended=true;processNextTick(endReadableNT,state4,stream)}}function endReadableNT(state4,stream){if(!state4.endEmitted&&state4.length===0){state4.endEmitted=true;stream.readable=false;stream.emit("end")}}function forEach(xs,f){for(var i3=0,l=xs.length;i3<l;i3++){f(xs[i3],i3)}}function indexOf(xs,x3){for(var i3=0,l=xs.length;i3<l;i3++){if(xs[i3]===x3)return i3}return-1}}).call(exports2,__webpack_require__(6))},function(module22,exports2,__webpack_require__){(function(process){"use strict";if(!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0){module22.exports=nextTick}else{module22.exports=process.nextTick}function nextTick(fn,arg1,arg2,arg3){if(typeof fn!=="function"){throw new TypeError(\'"callback" argument must be a function\')}var len=arguments.length;var args,i3;switch(len){case 0:case 1:return process.nextTick(fn);case 2:return process.nextTick(function afterTickOne(){fn.call(null,arg1)});case 3:return process.nextTick(function afterTickTwo(){fn.call(null,arg1,arg2)});case 4:return process.nextTick(function afterTickThree(){fn.call(null,arg1,arg2,arg3)});default:args=new Array(len-1);i3=0;while(i3<args.length){args[i3++]=arguments[i3]}return process.nextTick(function afterTick(){fn.apply(null,args)})}}}).call(exports2,__webpack_require__(6))},function(module22,exports2){var toString={}.toString;module22.exports=Array.isArray||function(arr){return toString.call(arr)=="[object Array]"}},function(module22,exports2,__webpack_require__){(function(global2){"use strict";var buffer=__webpack_require__(2);var Buffer2=buffer.Buffer;var SlowBuffer=buffer.SlowBuffer;var MAX_LEN=buffer.kMaxLength||2147483647;exports2.alloc=function alloc(size,fill,encoding){if(typeof Buffer2.alloc==="function"){return Buffer2.alloc(size,fill,encoding)}if(typeof encoding==="number"){throw new TypeError("encoding must not be number")}if(typeof size!=="number"){throw new TypeError("size must be a number")}if(size>MAX_LEN){throw new RangeError("size is too large")}var enc=encoding;var _fill=fill;if(_fill===void 0){enc=void 0;_fill=0}var buf=new Buffer2(size);if(typeof _fill==="string"){var fillBuf=new Buffer2(_fill,enc);var flen=fillBuf.length;var i3=-1;while(++i3<size){buf[i3]=fillBuf[i3%flen]}}else{buf.fill(_fill)}return buf};exports2.allocUnsafe=function allocUnsafe(size){if(typeof Buffer2.allocUnsafe==="function"){return Buffer2.allocUnsafe(size)}if(typeof size!=="number"){throw new TypeError("size must be a number")}if(size>MAX_LEN){throw new RangeError("size is too large")}return new Buffer2(size)};exports2.from=function from(value,encodingOrOffset,length){if(typeof Buffer2.from==="function"&&(!global2.Uint8Array||Uint8Array.from!==Buffer2.from)){return Buffer2.from(value,encodingOrOffset,length)}if(typeof value==="number"){throw new TypeError(\'"value" argument must not be a number\')}if(typeof value==="string"){return new Buffer2(value,encodingOrOffset)}if(typeof ArrayBuffer!=="undefined"&&value instanceof ArrayBuffer){var offset=encodingOrOffset;if(arguments.length===1){return new Buffer2(value)}if(typeof offset==="undefined"){offset=0}var len=length;if(typeof len==="undefined"){len=value.byteLength-offset}if(offset>=value.byteLength){throw new RangeError("\'offset\' is out of bounds")}if(len>value.byteLength-offset){throw new RangeError("\'length\' is out of bounds")}return new Buffer2(value.slice(offset,offset+len))}if(Buffer2.isBuffer(value)){var out=new Buffer2(value.length);value.copy(out,0,0,value.length);return out}if(value){if(Array.isArray(value)||typeof ArrayBuffer!=="undefined"&&value.buffer instanceof ArrayBuffer||"length"in value){return new Buffer2(value)}if(value.type==="Buffer"&&Array.isArray(value.data)){return new Buffer2(value.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")};exports2.allocUnsafeSlow=function allocUnsafeSlow(size){if(typeof Buffer2.allocUnsafeSlow==="function"){return Buffer2.allocUnsafeSlow(size)}if(typeof size!=="number"){throw new TypeError("size must be a number")}if(size>=MAX_LEN){throw new RangeError("size is too large")}return new SlowBuffer(size)}}).call(exports2,function(){return this}())},function(module22,exports2,__webpack_require__){(function(Buffer2){function isArray(arg){if(Array.isArray){return Array.isArray(arg)}return objectToString(arg)==="[object Array]"}exports2.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports2.isBoolean=isBoolean;function isNull(arg){return arg===null}exports2.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports2.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports2.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports2.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports2.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports2.isUndefined=isUndefined;function isRegExp(re){return objectToString(re)==="[object RegExp]"}exports2.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports2.isObject=isObject;function isDate(d2){return objectToString(d2)==="[object Date]"}exports2.isDate=isDate;function isError(e){return objectToString(e)==="[object Error]"||e instanceof Error}exports2.isError=isError;function isFunction3(arg){return typeof arg==="function"}exports2.isFunction=isFunction3;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports2.isPrimitive=isPrimitive;exports2.isBuffer=Buffer2.isBuffer;function objectToString(o){return Object.prototype.toString.call(o)}}).call(exports2,__webpack_require__(1))},function(module22,exports2){},function(module22,exports2,__webpack_require__){"use strict";var Buffer2=__webpack_require__(2).Buffer;var bufferShim=__webpack_require__(17);module22.exports=BufferList;function BufferList(){this.head=null;this.tail=null;this.length=0}BufferList.prototype.push=function(v2){var entry={data:v2,next:null};if(this.length>0)this.tail.next=entry;else this.head=entry;this.tail=entry;++this.length};BufferList.prototype.unshift=function(v2){var entry={data:v2,next:this.head};if(this.length===0)this.tail=entry;this.head=entry;++this.length};BufferList.prototype.shift=function(){if(this.length===0)return;var ret=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return ret};BufferList.prototype.clear=function(){this.head=this.tail=null;this.length=0};BufferList.prototype.join=function(s){if(this.length===0)return"";var p2=this.head;var ret=""+p2.data;while(p2=p2.next){ret+=s+p2.data}return ret};BufferList.prototype.concat=function(n){if(this.length===0)return bufferShim.alloc(0);if(this.length===1)return this.head.data;var ret=bufferShim.allocUnsafe(n>>>0);var p2=this.head;var i3=0;while(p2){p2.data.copy(ret,i3);i3+=p2.data.length;p2=p2.next}return ret}},function(module22,exports2,__webpack_require__){"use strict";var objectKeys=Object.keys||function(obj){var keys22=[];for(var key in obj){keys22.push(key)}return keys22};module22.exports=Duplex;var processNextTick=__webpack_require__(15);var util=__webpack_require__(18);util.inherits=__webpack_require__(12);var Readable=__webpack_require__(14);var Writable=__webpack_require__(22);util.inherits(Duplex,Readable);var keys3=objectKeys(Writable.prototype);for(var v2=0;v2<keys3.length;v2++){var method=keys3[v2];if(!Duplex.prototype[method])Duplex.prototype[method]=Writable.prototype[method]}function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options);Writable.call(this,options);if(options&&options.readable===false)this.readable=false;if(options&&options.writable===false)this.writable=false;this.allowHalfOpen=true;if(options&&options.allowHalfOpen===false)this.allowHalfOpen=false;this.once("end",onend)}function onend(){if(this.allowHalfOpen||this._writableState.ended)return;processNextTick(onEndNT,this)}function onEndNT(self2){self2.end()}function forEach(xs,f){for(var i3=0,l=xs.length;i3<l;i3++){f(xs[i3],i3)}}},function(module22,exports2,__webpack_require__){(function(process){"use strict";module22.exports=Writable;var processNextTick=__webpack_require__(15);var asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick;var Duplex;Writable.WritableState=WritableState;var util=__webpack_require__(18);util.inherits=__webpack_require__(12);var internalUtil={deprecate:__webpack_require__(23)};var Stream;(function(){try{Stream=__webpack_require__(11)}catch(_){}finally{if(!Stream)Stream=__webpack_require__(8).EventEmitter}})();var Buffer2=__webpack_require__(2).Buffer;var bufferShim=__webpack_require__(17);util.inherits(Writable,Stream);function nop(){}function WriteReq(chunk,encoding,cb){this.chunk=chunk;this.encoding=encoding;this.callback=cb;this.next=null}function WritableState(options,stream){Duplex=Duplex||__webpack_require__(21);options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)this.objectMode=this.objectMode||!!options.writableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=hwm||hwm===0?hwm:defaultHwm;this.highWaterMark=~~this.highWaterMark;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;var noDecode=options.decodeStrings===false;this.decodeStrings=!noDecode;this.defaultEncoding=options.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(er){onwrite(stream,er)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.bufferedRequestCount=0;this.corkedRequestsFree=new CorkedRequest(this)}WritableState.prototype.getBuffer=function getBuffer(){var current=this.bufferedRequest;var out=[];while(current){out.push(current);current=current.next}return out};(function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(_){}})();var realHasInstance;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){realHasInstance=Function.prototype[Symbol.hasInstance];Object.defineProperty(Writable,Symbol.hasInstance,{value:function(object){if(realHasInstance.call(this,object))return true;return object&&object._writableState instanceof WritableState}})}else{realHasInstance=function(object){return object instanceof this}}function Writable(options){Duplex=Duplex||__webpack_require__(21);if(!realHasInstance.call(Writable,this)&&!(this instanceof Duplex)){return new Writable(options)}this._writableState=new WritableState(options,this);this.writable=true;if(options){if(typeof options.write==="function")this._write=options.write;if(typeof options.writev==="function")this._writev=options.writev}Stream.call(this)}Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function writeAfterEnd(stream,cb){var er=new Error("write after end");stream.emit("error",er);processNextTick(cb,er)}function validChunk(stream,state4,chunk,cb){var valid=true;var er=false;if(chunk===null){er=new TypeError("May not write null values to stream")}else if(typeof chunk!=="string"&&chunk!==void 0&&!state4.objectMode){er=new TypeError("Invalid non-string/buffer chunk")}if(er){stream.emit("error",er);processNextTick(cb,er);valid=false}return valid}Writable.prototype.write=function(chunk,encoding,cb){var state4=this._writableState;var ret=false;var isBuf=Buffer2.isBuffer(chunk);if(typeof encoding==="function"){cb=encoding;encoding=null}if(isBuf)encoding="buffer";else if(!encoding)encoding=state4.defaultEncoding;if(typeof cb!=="function")cb=nop;if(state4.ended)writeAfterEnd(this,cb);else if(isBuf||validChunk(this,state4,chunk,cb)){state4.pendingcb++;ret=writeOrBuffer(this,state4,isBuf,chunk,encoding,cb)}return ret};Writable.prototype.cork=function(){var state4=this._writableState;state4.corked++};Writable.prototype.uncork=function(){var state4=this._writableState;if(state4.corked){state4.corked--;if(!state4.writing&&!state4.corked&&!state4.finished&&!state4.bufferProcessing&&state4.bufferedRequest)clearBuffer(this,state4)}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(encoding){if(typeof encoding==="string")encoding=encoding.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+encoding);this._writableState.defaultEncoding=encoding;return this};function decodeChunk(state4,chunk,encoding){if(!state4.objectMode&&state4.decodeStrings!==false&&typeof chunk==="string"){chunk=bufferShim.from(chunk,encoding)}return chunk}function writeOrBuffer(stream,state4,isBuf,chunk,encoding,cb){if(!isBuf){chunk=decodeChunk(state4,chunk,encoding);if(Buffer2.isBuffer(chunk))encoding="buffer"}var len=state4.objectMode?1:chunk.length;state4.length+=len;var ret=state4.length<state4.highWaterMark;if(!ret)state4.needDrain=true;if(state4.writing||state4.corked){var last=state4.lastBufferedRequest;state4.lastBufferedRequest=new WriteReq(chunk,encoding,cb);if(last){last.next=state4.lastBufferedRequest}else{state4.bufferedRequest=state4.lastBufferedRequest}state4.bufferedRequestCount+=1}else{doWrite(stream,state4,false,len,chunk,encoding,cb)}return ret}function doWrite(stream,state4,writev,len,chunk,encoding,cb){state4.writelen=len;state4.writecb=cb;state4.writing=true;state4.sync=true;if(writev)stream._writev(chunk,state4.onwrite);else stream._write(chunk,encoding,state4.onwrite);state4.sync=false}function onwriteError(stream,state4,sync,er,cb){--state4.pendingcb;if(sync)processNextTick(cb,er);else cb(er);stream._writableState.errorEmitted=true;stream.emit("error",er)}function onwriteStateUpdate(state4){state4.writing=false;state4.writecb=null;state4.length-=state4.writelen;state4.writelen=0}function onwrite(stream,er){var state4=stream._writableState;var sync=state4.sync;var cb=state4.writecb;onwriteStateUpdate(state4);if(er)onwriteError(stream,state4,sync,er,cb);else{var finished=needFinish(state4);if(!finished&&!state4.corked&&!state4.bufferProcessing&&state4.bufferedRequest){clearBuffer(stream,state4)}if(sync){asyncWrite(afterWrite,stream,state4,finished,cb)}else{afterWrite(stream,state4,finished,cb)}}}function afterWrite(stream,state4,finished,cb){if(!finished)onwriteDrain(stream,state4);state4.pendingcb--;cb();finishMaybe(stream,state4)}function onwriteDrain(stream,state4){if(state4.length===0&&state4.needDrain){state4.needDrain=false;stream.emit("drain")}}function clearBuffer(stream,state4){state4.bufferProcessing=true;var entry=state4.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state4.bufferedRequestCount;var buffer=new Array(l);var holder=state4.corkedRequestsFree;holder.entry=entry;var count=0;while(entry){buffer[count]=entry;entry=entry.next;count+=1}doWrite(stream,state4,true,state4.length,buffer,"",holder.finish);state4.pendingcb++;state4.lastBufferedRequest=null;if(holder.next){state4.corkedRequestsFree=holder.next;holder.next=null}else{state4.corkedRequestsFree=new CorkedRequest(state4)}}else{while(entry){var chunk=entry.chunk;var encoding=entry.encoding;var cb=entry.callback;var len=state4.objectMode?1:chunk.length;doWrite(stream,state4,false,len,chunk,encoding,cb);entry=entry.next;if(state4.writing){break}}if(entry===null)state4.lastBufferedRequest=null}state4.bufferedRequestCount=0;state4.bufferedRequest=entry;state4.bufferProcessing=false}Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("_write() is not implemented"))};Writable.prototype._writev=null;Writable.prototype.end=function(chunk,encoding,cb){var state4=this._writableState;if(typeof chunk==="function"){cb=chunk;chunk=null;encoding=null}else if(typeof encoding==="function"){cb=encoding;encoding=null}if(chunk!==null&&chunk!==void 0)this.write(chunk,encoding);if(state4.corked){state4.corked=1;this.uncork()}if(!state4.ending&&!state4.finished)endWritable(this,state4,cb)};function needFinish(state4){return state4.ending&&state4.length===0&&state4.bufferedRequest===null&&!state4.finished&&!state4.writing}function prefinish(stream,state4){if(!state4.prefinished){state4.prefinished=true;stream.emit("prefinish")}}function finishMaybe(stream,state4){var need=needFinish(state4);if(need){if(state4.pendingcb===0){prefinish(stream,state4);state4.finished=true;stream.emit("finish")}else{prefinish(stream,state4)}}return need}function endWritable(stream,state4,cb){state4.ending=true;finishMaybe(stream,state4);if(cb){if(state4.finished)processNextTick(cb);else stream.once("finish",cb)}state4.ended=true;stream.writable=false}function CorkedRequest(state4){var _this=this;this.next=null;this.entry=null;this.finish=function(err){var entry=_this.entry;_this.entry=null;while(entry){var cb=entry.callback;state4.pendingcb--;cb(err);entry=entry.next}if(state4.corkedRequestsFree){state4.corkedRequestsFree.next=_this}else{state4.corkedRequestsFree=_this}}}}).call(exports2,__webpack_require__(6))},function(module22,exports2){(function(global2){module22.exports=deprecate;function deprecate(fn,msg){if(config("noDeprecation")){return fn}var warned=false;function deprecated(){if(!warned){if(config("throwDeprecation")){throw new Error(msg)}else if(config("traceDeprecation")){console.trace(msg)}else{console.warn(msg)}warned=true}return fn.apply(this,arguments)}return deprecated}function config(name2){try{if(!global2.localStorage)return false}catch(_){return false}var val=global2.localStorage[name2];if(null==val)return false;return String(val).toLowerCase()==="true"}}).call(exports2,function(){return this}())},function(module22,exports2,__webpack_require__){var Buffer2=__webpack_require__(2).Buffer;var isBufferEncoding=Buffer2.isEncoding||function(encoding){switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function assertEncoding(encoding){if(encoding&&!isBufferEncoding(encoding)){throw new Error("Unknown encoding: "+encoding)}}var StringDecoder=exports2.StringDecoder=function(encoding){this.encoding=(encoding||"utf8").toLowerCase().replace(/[-_]/,"");assertEncoding(encoding);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2;this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3;this.detectIncompleteChar=base64DetectIncompleteChar;break;default:this.write=passThroughWrite;return}this.charBuffer=new Buffer2(6);this.charReceived=0;this.charLength=0};StringDecoder.prototype.write=function(buffer){var charStr="";while(this.charLength){var available=buffer.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:buffer.length;buffer.copy(this.charBuffer,this.charReceived,0,available);this.charReceived+=available;if(this.charReceived<this.charLength){return""}buffer=buffer.slice(available,buffer.length);charStr=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var charCode=charStr.charCodeAt(charStr.length-1);if(charCode>=55296&&charCode<=56319){this.charLength+=this.surrogateSize;charStr="";continue}this.charReceived=this.charLength=0;if(buffer.length===0){return charStr}break}this.detectIncompleteChar(buffer);var end=buffer.length;if(this.charLength){buffer.copy(this.charBuffer,0,buffer.length-this.charReceived,end);end-=this.charReceived}charStr+=buffer.toString(this.encoding,0,end);var end=charStr.length-1;var charCode=charStr.charCodeAt(end);if(charCode>=55296&&charCode<=56319){var size=this.surrogateSize;this.charLength+=size;this.charReceived+=size;this.charBuffer.copy(this.charBuffer,size,0,size);buffer.copy(this.charBuffer,0,0,size);return charStr.substring(0,end)}return charStr};StringDecoder.prototype.detectIncompleteChar=function(buffer){var i3=buffer.length>=3?3:buffer.length;for(;i3>0;i3--){var c=buffer[buffer.length-i3];if(i3==1&&c>>5==6){this.charLength=2;break}if(i3<=2&&c>>4==14){this.charLength=3;break}if(i3<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=i3};StringDecoder.prototype.end=function(buffer){var res="";if(buffer&&buffer.length)res=this.write(buffer);if(this.charReceived){var cr=this.charReceived;var buf=this.charBuffer;var enc=this.encoding;res+=buf.slice(0,cr).toString(enc)}return res};function passThroughWrite(buffer){return buffer.toString(this.encoding)}function utf16DetectIncompleteChar(buffer){this.charReceived=buffer.length%2;this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(buffer){this.charReceived=buffer.length%3;this.charLength=this.charReceived?3:0}},function(module22,exports2,__webpack_require__){"use strict";module22.exports=Transform;var Duplex=__webpack_require__(21);var util=__webpack_require__(18);util.inherits=__webpack_require__(12);util.inherits(Transform,Duplex);function TransformState(stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data)};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null;this.writeencoding=null}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=false;var cb=ts.writecb;if(!cb)return stream.emit("error",new Error("no writecb in Transform class"));ts.writechunk=null;ts.writecb=null;if(data!==null&&data!==void 0)stream.push(data);cb(er);var rs=stream._readableState;rs.reading=false;if(rs.needReadable||rs.length<rs.highWaterMark){stream._read(rs.highWaterMark)}}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options);this._transformState=new TransformState(this);var stream=this;this._readableState.needReadable=true;this._readableState.sync=false;if(options){if(typeof options.transform==="function")this._transform=options.transform;if(typeof options.flush==="function")this._flush=options.flush}this.once("prefinish",function(){if(typeof this._flush==="function")this._flush(function(er,data){done(stream,er,data)});else done(stream)})}Transform.prototype.push=function(chunk,encoding){this._transformState.needTransform=false;return Duplex.prototype.push.call(this,chunk,encoding)};Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("_transform() is not implemented")};Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb;ts.writechunk=chunk;ts.writeencoding=encoding;if(!ts.transforming){var rs=this._readableState;if(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)this._read(rs.highWaterMark)}};Transform.prototype._read=function(n){var ts=this._transformState;if(ts.writechunk!==null&&ts.writecb&&!ts.transforming){ts.transforming=true;this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)}else{ts.needTransform=true}};function done(stream,er,data){if(er)return stream.emit("error",er);if(data!==null&&data!==void 0)stream.push(data);var ws=stream._writableState;var ts=stream._transformState;if(ws.length)throw new Error("Calling transform done when ws.length != 0");if(ts.transforming)throw new Error("Calling transform done when still transforming");return stream.push(null)}},function(module22,exports2,__webpack_require__){"use strict";module22.exports=PassThrough;var Transform=__webpack_require__(25);var util=__webpack_require__(18);util.inherits=__webpack_require__(12);util.inherits(PassThrough,Transform);function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},function(module22,exports2,__webpack_require__){module22.exports=__webpack_require__(22)},function(module22,exports2,__webpack_require__){module22.exports=__webpack_require__(21)},function(module22,exports2,__webpack_require__){module22.exports=__webpack_require__(25)},function(module22,exports2,__webpack_require__){module22.exports=__webpack_require__(26)},function(module22,exports2,__webpack_require__){"use strict";var zlib_inflate=__webpack_require__(32);var utils=__webpack_require__(33);var strings=__webpack_require__(38);var c=__webpack_require__(39);var msg=__webpack_require__(40);var ZStream=__webpack_require__(41);var GZheader=__webpack_require__(42);var toString=Object.prototype.toString;function Inflate(options){if(!(this instanceof Inflate))return new Inflate(options);this.options=utils.assign({chunkSize:16384,windowBits:0,to:""},options||{});var opt=this.options;if(opt.raw&&opt.windowBits>=0&&opt.windowBits<16){opt.windowBits=-opt.windowBits;if(opt.windowBits===0){opt.windowBits=-15}}if(opt.windowBits>=0&&opt.windowBits<16&&!(options&&options.windowBits)){opt.windowBits+=32}if(opt.windowBits>15&&opt.windowBits<48){if((opt.windowBits&15)===0){opt.windowBits|=15}}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new ZStream;this.strm.avail_out=0;var status=zlib_inflate.inflateInit2(this.strm,opt.windowBits);if(status!==c.Z_OK){throw new Error(msg[status])}this.header=new GZheader;zlib_inflate.inflateGetHeader(this.strm,this.header)}Inflate.prototype.push=function(data,mode){var strm=this.strm;var chunkSize=this.options.chunkSize;var dictionary=this.options.dictionary;var status,_mode;var next_out_utf8,tail,utf8str;var dict;var allowBufError=false;if(this.ended){return false}_mode=mode===~~mode?mode:mode===true?c.Z_FINISH:c.Z_NO_FLUSH;if(typeof data==="string"){strm.input=strings.binstring2buf(data)}else if(toString.call(data)==="[object ArrayBuffer]"){strm.input=new Uint8Array(data)}else{strm.input=data}strm.next_in=0;strm.avail_in=strm.input.length;do{if(strm.avail_out===0){strm.output=new utils.Buf8(chunkSize);strm.next_out=0;strm.avail_out=chunkSize}status=zlib_inflate.inflate(strm,c.Z_NO_FLUSH);if(status===c.Z_NEED_DICT&&dictionary){if(typeof dictionary==="string"){dict=strings.string2buf(dictionary)}else if(toString.call(dictionary)==="[object ArrayBuffer]"){dict=new Uint8Array(dictionary)}else{dict=dictionary}status=zlib_inflate.inflateSetDictionary(this.strm,dict)}if(status===c.Z_BUF_ERROR&&allowBufError===true){status=c.Z_OK;allowBufError=false}if(status!==c.Z_STREAM_END&&status!==c.Z_OK){this.onEnd(status);this.ended=true;return false}if(strm.next_out){if(strm.avail_out===0||status===c.Z_STREAM_END||strm.avail_in===0&&(_mode===c.Z_FINISH||_mode===c.Z_SYNC_FLUSH)){if(this.options.to==="string"){next_out_utf8=strings.utf8border(strm.output,strm.next_out);tail=strm.next_out-next_out_utf8;utf8str=strings.buf2string(strm.output,next_out_utf8);strm.next_out=tail;strm.avail_out=chunkSize-tail;if(tail){utils.arraySet(strm.output,strm.output,next_out_utf8,tail,0)}this.onData(utf8str)}else{this.onData(utils.shrinkBuf(strm.output,strm.next_out))}}}if(strm.avail_in===0&&strm.avail_out===0){allowBufError=true}}while((strm.avail_in>0||strm.avail_out===0)&&status!==c.Z_STREAM_END);if(status===c.Z_STREAM_END){_mode=c.Z_FINISH}if(_mode===c.Z_FINISH){status=zlib_inflate.inflateEnd(this.strm);this.onEnd(status);this.ended=true;return status===c.Z_OK}if(_mode===c.Z_SYNC_FLUSH){this.onEnd(c.Z_OK);strm.avail_out=0;return true}return true};Inflate.prototype.onData=function(chunk){this.chunks.push(chunk)};Inflate.prototype.onEnd=function(status){if(status===c.Z_OK){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=utils.flattenChunks(this.chunks)}}this.chunks=[];this.err=status;this.msg=this.strm.msg};function inflate(input,options){var inflator=new Inflate(options);inflator.push(input,true);if(inflator.err){throw inflator.msg||msg[inflator.err]}return inflator.result}function inflateRaw(input,options){options=options||{};options.raw=true;return inflate(input,options)}exports2.Inflate=Inflate;exports2.inflate=inflate;exports2.inflateRaw=inflateRaw;exports2.ungzip=inflate},function(module22,exports2,__webpack_require__){"use strict";var utils=__webpack_require__(33);var adler32=__webpack_require__(34);var crc32=__webpack_require__(35);var inflate_fast=__webpack_require__(36);var inflate_table=__webpack_require__(37);var CODES=0;var LENS=1;var DISTS=2;var Z_FINISH=4;var Z_BLOCK=5;var Z_TREES=6;var Z_OK=0;var Z_STREAM_END=1;var Z_NEED_DICT=2;var Z_STREAM_ERROR=-2;var Z_DATA_ERROR=-3;var Z_MEM_ERROR=-4;var Z_BUF_ERROR=-5;var Z_DEFLATED=8;var HEAD=1;var FLAGS=2;var TIME=3;var OS=4;var EXLEN=5;var EXTRA=6;var NAME=7;var COMMENT=8;var HCRC=9;var DICTID=10;var DICT=11;var TYPE=12;var TYPEDO=13;var STORED=14;var COPY_=15;var COPY=16;var TABLE=17;var LENLENS=18;var CODELENS=19;var LEN_=20;var LEN=21;var LENEXT=22;var DIST=23;var DISTEXT=24;var MATCH=25;var LIT=26;var CHECK=27;var LENGTH=28;var DONE=29;var BAD=30;var MEM=31;var SYNC=32;var ENOUGH_LENS=852;var ENOUGH_DISTS=592;var MAX_WBITS=15;var DEF_WBITS=MAX_WBITS;function zswap32(q){return(q>>>24&255)+(q>>>8&65280)+((q&65280)<<8)+((q&255)<<24)}function InflateState(){this.mode=0;this.last=false;this.wrap=0;this.havedict=false;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new utils.Buf16(320);this.work=new utils.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function inflateResetKeep(strm){var state4;if(!strm||!strm.state){return Z_STREAM_ERROR}state4=strm.state;strm.total_in=strm.total_out=state4.total=0;strm.msg="";if(state4.wrap){strm.adler=state4.wrap&1}state4.mode=HEAD;state4.last=0;state4.havedict=0;state4.dmax=32768;state4.head=null;state4.hold=0;state4.bits=0;state4.lencode=state4.lendyn=new utils.Buf32(ENOUGH_LENS);state4.distcode=state4.distdyn=new utils.Buf32(ENOUGH_DISTS);state4.sane=1;state4.back=-1;return Z_OK}function inflateReset(strm){var state4;if(!strm||!strm.state){return Z_STREAM_ERROR}state4=strm.state;state4.wsize=0;state4.whave=0;state4.wnext=0;return inflateResetKeep(strm)}function inflateReset2(strm,windowBits){var wrap;var state4;if(!strm||!strm.state){return Z_STREAM_ERROR}state4=strm.state;if(windowBits<0){wrap=0;windowBits=-windowBits}else{wrap=(windowBits>>4)+1;if(windowBits<48){windowBits&=15}}if(windowBits&&(windowBits<8||windowBits>15)){return Z_STREAM_ERROR}if(state4.window!==null&&state4.wbits!==windowBits){state4.window=null}state4.wrap=wrap;state4.wbits=windowBits;return inflateReset(strm)}function inflateInit2(strm,windowBits){var ret;var state4;if(!strm){return Z_STREAM_ERROR}state4=new InflateState;strm.state=state4;state4.window=null;ret=inflateReset2(strm,windowBits);if(ret!==Z_OK){strm.state=null}return ret}function inflateInit(strm){return inflateInit2(strm,DEF_WBITS)}var virgin=true;var lenfix,distfix;function fixedtables(state4){if(virgin){var sym;lenfix=new utils.Buf32(512);distfix=new utils.Buf32(32);sym=0;while(sym<144){state4.lens[sym++]=8}while(sym<256){state4.lens[sym++]=9}while(sym<280){state4.lens[sym++]=7}while(sym<288){state4.lens[sym++]=8}inflate_table(LENS,state4.lens,0,288,lenfix,0,state4.work,{bits:9});sym=0;while(sym<32){state4.lens[sym++]=5}inflate_table(DISTS,state4.lens,0,32,distfix,0,state4.work,{bits:5});virgin=false}state4.lencode=lenfix;state4.lenbits=9;state4.distcode=distfix;state4.distbits=5}function updatewindow(strm,src,end,copy){var dist;var state4=strm.state;if(state4.window===null){state4.wsize=1<<state4.wbits;state4.wnext=0;state4.whave=0;state4.window=new utils.Buf8(state4.wsize)}if(copy>=state4.wsize){utils.arraySet(state4.window,src,end-state4.wsize,state4.wsize,0);state4.wnext=0;state4.whave=state4.wsize}else{dist=state4.wsize-state4.wnext;if(dist>copy){dist=copy}utils.arraySet(state4.window,src,end-copy,dist,state4.wnext);copy-=dist;if(copy){utils.arraySet(state4.window,src,end-copy,copy,0);state4.wnext=copy;state4.whave=state4.wsize}else{state4.wnext+=dist;if(state4.wnext===state4.wsize){state4.wnext=0}if(state4.whave<state4.wsize){state4.whave+=dist}}}return 0}function inflate(strm,flush){var state4;var input,output;var next;var put;var have,left;var hold;var bits;var _in,_out;var copy;var from;var from_source;var here=0;var here_bits,here_op,here_val;var last_bits,last_op,last_val;var len;var ret;var hbuf=new utils.Buf8(4);var opts;var n;var order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!strm||!strm.state||!strm.output||!strm.input&&strm.avail_in!==0){return Z_STREAM_ERROR}state4=strm.state;if(state4.mode===TYPE){state4.mode=TYPEDO}put=strm.next_out;output=strm.output;left=strm.avail_out;next=strm.next_in;input=strm.input;have=strm.avail_in;hold=state4.hold;bits=state4.bits;_in=have;_out=left;ret=Z_OK;inf_leave:for(;;){switch(state4.mode){case HEAD:if(state4.wrap===0){state4.mode=TYPEDO;break}while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(state4.wrap&2&&hold===35615){state4.check=0;hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state4.check=crc32(state4.check,hbuf,2,0);hold=0;bits=0;state4.mode=FLAGS;break}state4.flags=0;if(state4.head){state4.head.done=false}if(!(state4.wrap&1)||(((hold&255)<<8)+(hold>>8))%31){strm.msg="incorrect header check";state4.mode=BAD;break}if((hold&15)!==Z_DEFLATED){strm.msg="unknown compression method";state4.mode=BAD;break}hold>>>=4;bits-=4;len=(hold&15)+8;if(state4.wbits===0){state4.wbits=len}else if(len>state4.wbits){strm.msg="invalid window size";state4.mode=BAD;break}state4.dmax=1<<len;strm.adler=state4.check=1;state4.mode=hold&512?DICTID:TYPE;hold=0;bits=0;break;case FLAGS:while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.flags=hold;if((state4.flags&255)!==Z_DEFLATED){strm.msg="unknown compression method";state4.mode=BAD;break}if(state4.flags&57344){strm.msg="unknown header flags set";state4.mode=BAD;break}if(state4.head){state4.head.text=hold>>8&1}if(state4.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state4.check=crc32(state4.check,hbuf,2,0)}hold=0;bits=0;state4.mode=TIME;case TIME:while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(state4.head){state4.head.time=hold}if(state4.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;hbuf[2]=hold>>>16&255;hbuf[3]=hold>>>24&255;state4.check=crc32(state4.check,hbuf,4,0)}hold=0;bits=0;state4.mode=OS;case OS:while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(state4.head){state4.head.xflags=hold&255;state4.head.os=hold>>8}if(state4.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state4.check=crc32(state4.check,hbuf,2,0)}hold=0;bits=0;state4.mode=EXLEN;case EXLEN:if(state4.flags&1024){while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.length=hold;if(state4.head){state4.head.extra_len=hold}if(state4.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state4.check=crc32(state4.check,hbuf,2,0)}hold=0;bits=0}else if(state4.head){state4.head.extra=null}state4.mode=EXTRA;case EXTRA:if(state4.flags&1024){copy=state4.length;if(copy>have){copy=have}if(copy){if(state4.head){len=state4.head.extra_len-state4.length;if(!state4.head.extra){state4.head.extra=new Array(state4.head.extra_len)}utils.arraySet(state4.head.extra,input,next,copy,len)}if(state4.flags&512){state4.check=crc32(state4.check,input,copy,next)}have-=copy;next+=copy;state4.length-=copy}if(state4.length){break inf_leave}}state4.length=0;state4.mode=NAME;case NAME:if(state4.flags&2048){if(have===0){break inf_leave}copy=0;do{len=input[next+copy++];if(state4.head&&len&&state4.length<65536){state4.head.name+=String.fromCharCode(len)}}while(len&&copy<have);if(state4.flags&512){state4.check=crc32(state4.check,input,copy,next)}have-=copy;next+=copy;if(len){break inf_leave}}else if(state4.head){state4.head.name=null}state4.length=0;state4.mode=COMMENT;case COMMENT:if(state4.flags&4096){if(have===0){break inf_leave}copy=0;do{len=input[next+copy++];if(state4.head&&len&&state4.length<65536){state4.head.comment+=String.fromCharCode(len)}}while(len&&copy<have);if(state4.flags&512){state4.check=crc32(state4.check,input,copy,next)}have-=copy;next+=copy;if(len){break inf_leave}}else if(state4.head){state4.head.comment=null}state4.mode=HCRC;case HCRC:if(state4.flags&512){while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(hold!==(state4.check&65535)){strm.msg="header crc mismatch";state4.mode=BAD;break}hold=0;bits=0}if(state4.head){state4.head.hcrc=state4.flags>>9&1;state4.head.done=true}strm.adler=state4.check=0;state4.mode=TYPE;break;case DICTID:while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}strm.adler=state4.check=zswap32(hold);hold=0;bits=0;state4.mode=DICT;case DICT:if(state4.havedict===0){strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state4.hold=hold;state4.bits=bits;return Z_NEED_DICT}strm.adler=state4.check=1;state4.mode=TYPE;case TYPE:if(flush===Z_BLOCK||flush===Z_TREES){break inf_leave}case TYPEDO:if(state4.last){hold>>>=bits&7;bits-=bits&7;state4.mode=CHECK;break}while(bits<3){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.last=hold&1;hold>>>=1;bits-=1;switch(hold&3){case 0:state4.mode=STORED;break;case 1:fixedtables(state4);state4.mode=LEN_;if(flush===Z_TREES){hold>>>=2;bits-=2;break inf_leave}break;case 2:state4.mode=TABLE;break;case 3:strm.msg="invalid block type";state4.mode=BAD}hold>>>=2;bits-=2;break;case STORED:hold>>>=bits&7;bits-=bits&7;while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if((hold&65535)!==(hold>>>16^65535)){strm.msg="invalid stored block lengths";state4.mode=BAD;break}state4.length=hold&65535;hold=0;bits=0;state4.mode=COPY_;if(flush===Z_TREES){break inf_leave}case COPY_:state4.mode=COPY;case COPY:copy=state4.length;if(copy){if(copy>have){copy=have}if(copy>left){copy=left}if(copy===0){break inf_leave}utils.arraySet(output,input,next,copy,put);have-=copy;next+=copy;left-=copy;put+=copy;state4.length-=copy;break}state4.mode=TYPE;break;case TABLE:while(bits<14){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.nlen=(hold&31)+257;hold>>>=5;bits-=5;state4.ndist=(hold&31)+1;hold>>>=5;bits-=5;state4.ncode=(hold&15)+4;hold>>>=4;bits-=4;if(state4.nlen>286||state4.ndist>30){strm.msg="too many length or distance symbols";state4.mode=BAD;break}state4.have=0;state4.mode=LENLENS;case LENLENS:while(state4.have<state4.ncode){while(bits<3){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.lens[order[state4.have++]]=hold&7;hold>>>=3;bits-=3}while(state4.have<19){state4.lens[order[state4.have++]]=0}state4.lencode=state4.lendyn;state4.lenbits=7;opts={bits:state4.lenbits};ret=inflate_table(CODES,state4.lens,0,19,state4.lencode,0,state4.work,opts);state4.lenbits=opts.bits;if(ret){strm.msg="invalid code lengths set";state4.mode=BAD;break}state4.have=0;state4.mode=CODELENS;case CODELENS:while(state4.have<state4.nlen+state4.ndist){for(;;){here=state4.lencode[hold&(1<<state4.lenbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(here_val<16){hold>>>=here_bits;bits-=here_bits;state4.lens[state4.have++]=here_val}else{if(here_val===16){n=here_bits+2;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;bits-=here_bits;if(state4.have===0){strm.msg="invalid bit length repeat";state4.mode=BAD;break}len=state4.lens[state4.have-1];copy=3+(hold&3);hold>>>=2;bits-=2}else if(here_val===17){n=here_bits+3;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;bits-=here_bits;len=0;copy=3+(hold&7);hold>>>=3;bits-=3}else{n=here_bits+7;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;bits-=here_bits;len=0;copy=11+(hold&127);hold>>>=7;bits-=7}if(state4.have+copy>state4.nlen+state4.ndist){strm.msg="invalid bit length repeat";state4.mode=BAD;break}while(copy--){state4.lens[state4.have++]=len}}}if(state4.mode===BAD){break}if(state4.lens[256]===0){strm.msg="invalid code -- missing end-of-block";state4.mode=BAD;break}state4.lenbits=9;opts={bits:state4.lenbits};ret=inflate_table(LENS,state4.lens,0,state4.nlen,state4.lencode,0,state4.work,opts);state4.lenbits=opts.bits;if(ret){strm.msg="invalid literal/lengths set";state4.mode=BAD;break}state4.distbits=6;state4.distcode=state4.distdyn;opts={bits:state4.distbits};ret=inflate_table(DISTS,state4.lens,state4.nlen,state4.ndist,state4.distcode,0,state4.work,opts);state4.distbits=opts.bits;if(ret){strm.msg="invalid distances set";state4.mode=BAD;break}state4.mode=LEN_;if(flush===Z_TREES){break inf_leave}case LEN_:state4.mode=LEN;case LEN:if(have>=6&&left>=258){strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state4.hold=hold;state4.bits=bits;inflate_fast(strm,_out);put=strm.next_out;output=strm.output;left=strm.avail_out;next=strm.next_in;input=strm.input;have=strm.avail_in;hold=state4.hold;bits=state4.bits;if(state4.mode===TYPE){state4.back=-1}break}state4.back=0;for(;;){here=state4.lencode[hold&(1<<state4.lenbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(here_op&&(here_op&240)===0){last_bits=here_bits;last_op=here_op;last_val=here_val;for(;;){here=state4.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(last_bits+here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=last_bits;bits-=last_bits;state4.back+=last_bits}hold>>>=here_bits;bits-=here_bits;state4.back+=here_bits;state4.length=here_val;if(here_op===0){state4.mode=LIT;break}if(here_op&32){state4.back=-1;state4.mode=TYPE;break}if(here_op&64){strm.msg="invalid literal/length code";state4.mode=BAD;break}state4.extra=here_op&15;state4.mode=LENEXT;case LENEXT:if(state4.extra){n=state4.extra;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.length+=hold&(1<<state4.extra)-1;hold>>>=state4.extra;bits-=state4.extra;state4.back+=state4.extra}state4.was=state4.length;state4.mode=DIST;case DIST:for(;;){here=state4.distcode[hold&(1<<state4.distbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if((here_op&240)===0){last_bits=here_bits;last_op=here_op;last_val=here_val;for(;;){here=state4.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(last_bits+here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=last_bits;bits-=last_bits;state4.back+=last_bits}hold>>>=here_bits;bits-=here_bits;state4.back+=here_bits;if(here_op&64){strm.msg="invalid distance code";state4.mode=BAD;break}state4.offset=here_val;state4.extra=here_op&15;state4.mode=DISTEXT;case DISTEXT:if(state4.extra){n=state4.extra;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.offset+=hold&(1<<state4.extra)-1;hold>>>=state4.extra;bits-=state4.extra;state4.back+=state4.extra}if(state4.offset>state4.dmax){strm.msg="invalid distance too far back";state4.mode=BAD;break}state4.mode=MATCH;case MATCH:if(left===0){break inf_leave}copy=_out-left;if(state4.offset>copy){copy=state4.offset-copy;if(copy>state4.whave){if(state4.sane){strm.msg="invalid distance too far back";state4.mode=BAD;break}}if(copy>state4.wnext){copy-=state4.wnext;from=state4.wsize-copy}else{from=state4.wnext-copy}if(copy>state4.length){copy=state4.length}from_source=state4.window}else{from_source=output;from=put-state4.offset;copy=state4.length}if(copy>left){copy=left}left-=copy;state4.length-=copy;do{output[put++]=from_source[from++]}while(--copy);if(state4.length===0){state4.mode=LEN}break;case LIT:if(left===0){break inf_leave}output[put++]=state4.length;left--;state4.mode=LEN;break;case CHECK:if(state4.wrap){while(bits<32){if(have===0){break inf_leave}have--;hold|=input[next++]<<bits;bits+=8}_out-=left;strm.total_out+=_out;state4.total+=_out;if(_out){strm.adler=state4.check=state4.flags?crc32(state4.check,output,_out,put-_out):adler32(state4.check,output,_out,put-_out)}_out=left;if((state4.flags?hold:zswap32(hold))!==state4.check){strm.msg="incorrect data check";state4.mode=BAD;break}hold=0;bits=0}state4.mode=LENGTH;case LENGTH:if(state4.wrap&&state4.flags){while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(hold!==(state4.total&4294967295)){strm.msg="incorrect length check";state4.mode=BAD;break}hold=0;bits=0}state4.mode=DONE;case DONE:ret=Z_STREAM_END;break inf_leave;case BAD:ret=Z_DATA_ERROR;break inf_leave;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}}strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state4.hold=hold;state4.bits=bits;if(state4.wsize||_out!==strm.avail_out&&state4.mode<BAD&&(state4.mode<CHECK||flush!==Z_FINISH)){if(updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out)){state4.mode=MEM;return Z_MEM_ERROR}}_in-=strm.avail_in;_out-=strm.avail_out;strm.total_in+=_in;strm.total_out+=_out;state4.total+=_out;if(state4.wrap&&_out){strm.adler=state4.check=state4.flags?crc32(state4.check,output,_out,strm.next_out-_out):adler32(state4.check,output,_out,strm.next_out-_out)}strm.data_type=state4.bits+(state4.last?64:0)+(state4.mode===TYPE?128:0)+(state4.mode===LEN_||state4.mode===COPY_?256:0);if((_in===0&&_out===0||flush===Z_FINISH)&&ret===Z_OK){ret=Z_BUF_ERROR}return ret}function inflateEnd(strm){if(!strm||!strm.state){return Z_STREAM_ERROR}var state4=strm.state;if(state4.window){state4.window=null}strm.state=null;return Z_OK}function inflateGetHeader(strm,head){var state4;if(!strm||!strm.state){return Z_STREAM_ERROR}state4=strm.state;if((state4.wrap&2)===0){return Z_STREAM_ERROR}state4.head=head;head.done=false;return Z_OK}function inflateSetDictionary(strm,dictionary){var dictLength=dictionary.length;var state4;var dictid;var ret;if(!strm||!strm.state){return Z_STREAM_ERROR}state4=strm.state;if(state4.wrap!==0&&state4.mode!==DICT){return Z_STREAM_ERROR}if(state4.mode===DICT){dictid=1;dictid=adler32(dictid,dictionary,dictLength,0);if(dictid!==state4.check){return Z_DATA_ERROR}}ret=updatewindow(strm,dictionary,dictLength,dictLength);if(ret){state4.mode=MEM;return Z_MEM_ERROR}state4.havedict=1;return Z_OK}exports2.inflateReset=inflateReset;exports2.inflateReset2=inflateReset2;exports2.inflateResetKeep=inflateResetKeep;exports2.inflateInit=inflateInit;exports2.inflateInit2=inflateInit2;exports2.inflate=inflate;exports2.inflateEnd=inflateEnd;exports2.inflateGetHeader=inflateGetHeader;exports2.inflateSetDictionary=inflateSetDictionary;exports2.inflateInfo="pako inflate (from Nodeca project)"},function(module22,exports2){"use strict";var TYPED_OK=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";exports2.assign=function(obj){var sources=Array.prototype.slice.call(arguments,1);while(sources.length){var source=sources.shift();if(!source){continue}if(typeof source!=="object"){throw new TypeError(source+"must be non-object")}for(var p2 in source){if(source.hasOwnProperty(p2)){obj[p2]=source[p2]}}}return obj};exports2.shrinkBuf=function(buf,size){if(buf.length===size){return buf}if(buf.subarray){return buf.subarray(0,size)}buf.length=size;return buf};var fnTyped={arraySet:function(dest,src,src_offs,len,dest_offs){if(src.subarray&&dest.subarray){dest.set(src.subarray(src_offs,src_offs+len),dest_offs);return}for(var i3=0;i3<len;i3++){dest[dest_offs+i3]=src[src_offs+i3]}},flattenChunks:function(chunks){var i3,l,len,pos,chunk,result;len=0;for(i3=0,l=chunks.length;i3<l;i3++){len+=chunks[i3].length}result=new Uint8Array(len);pos=0;for(i3=0,l=chunks.length;i3<l;i3++){chunk=chunks[i3];result.set(chunk,pos);pos+=chunk.length}return result}};var fnUntyped={arraySet:function(dest,src,src_offs,len,dest_offs){for(var i3=0;i3<len;i3++){dest[dest_offs+i3]=src[src_offs+i3]}},flattenChunks:function(chunks){return[].concat.apply([],chunks)}};exports2.setTyped=function(on){if(on){exports2.Buf8=Uint8Array;exports2.Buf16=Uint16Array;exports2.Buf32=Int32Array;exports2.assign(exports2,fnTyped)}else{exports2.Buf8=Array;exports2.Buf16=Array;exports2.Buf32=Array;exports2.assign(exports2,fnUntyped)}};exports2.setTyped(TYPED_OK)},function(module22,exports2){"use strict";function adler32(adler,buf,len,pos){var s1=adler&65535|0,s2=adler>>>16&65535|0,n=0;while(len!==0){n=len>2e3?2e3:len;len-=n;do{s1=s1+buf[pos++]|0;s2=s2+s1|0}while(--n);s1%=65521;s2%=65521}return s1|s2<<16|0}module22.exports=adler32},function(module22,exports2){"use strict";function makeTable(){var c,table=[];for(var n=0;n<256;n++){c=n;for(var k=0;k<8;k++){c=c&1?3988292384^c>>>1:c>>>1}table[n]=c}return table}var crcTable=makeTable();function crc32(crc,buf,len,pos){var t3=crcTable,end=pos+len;crc^=-1;for(var i3=pos;i3<end;i3++){crc=crc>>>8^t3[(crc^buf[i3])&255]}return crc^-1}module22.exports=crc32},function(module22,exports2){"use strict";var BAD=30;var TYPE=12;module22.exports=function inflate_fast(strm,start){var state4;var _in;var last;var _out;var beg;var end;var dmax;var wsize;var whave;var wnext;var s_window;var hold;var bits;var lcode;var dcode;var lmask;var dmask;var here;var op;var len;var dist;var from;var from_source;var input,output;state4=strm.state;_in=strm.next_in;input=strm.input;last=_in+(strm.avail_in-5);_out=strm.next_out;output=strm.output;beg=_out-(start-strm.avail_out);end=_out+(strm.avail_out-257);dmax=state4.dmax;wsize=state4.wsize;whave=state4.whave;wnext=state4.wnext;s_window=state4.window;hold=state4.hold;bits=state4.bits;lcode=state4.lencode;dcode=state4.distcode;lmask=(1<<state4.lenbits)-1;dmask=(1<<state4.distbits)-1;top:do{if(bits<15){hold+=input[_in++]<<bits;bits+=8;hold+=input[_in++]<<bits;bits+=8}here=lcode[hold&lmask];dolen:for(;;){op=here>>>24;hold>>>=op;bits-=op;op=here>>>16&255;if(op===0){output[_out++]=here&65535}else if(op&16){len=here&65535;op&=15;if(op){if(bits<op){hold+=input[_in++]<<bits;bits+=8}len+=hold&(1<<op)-1;hold>>>=op;bits-=op}if(bits<15){hold+=input[_in++]<<bits;bits+=8;hold+=input[_in++]<<bits;bits+=8}here=dcode[hold&dmask];dodist:for(;;){op=here>>>24;hold>>>=op;bits-=op;op=here>>>16&255;if(op&16){dist=here&65535;op&=15;if(bits<op){hold+=input[_in++]<<bits;bits+=8;if(bits<op){hold+=input[_in++]<<bits;bits+=8}}dist+=hold&(1<<op)-1;if(dist>dmax){strm.msg="invalid distance too far back";state4.mode=BAD;break top}hold>>>=op;bits-=op;op=_out-beg;if(dist>op){op=dist-op;if(op>whave){if(state4.sane){strm.msg="invalid distance too far back";state4.mode=BAD;break top}}from=0;from_source=s_window;if(wnext===0){from+=wsize-op;if(op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist;from_source=output}}else if(wnext<op){from+=wsize+wnext-op;op-=wnext;if(op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=0;if(wnext<len){op=wnext;len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist;from_source=output}}}else{from+=wnext-op;if(op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist;from_source=output}}while(len>2){output[_out++]=from_source[from++];output[_out++]=from_source[from++];output[_out++]=from_source[from++];len-=3}if(len){output[_out++]=from_source[from++];if(len>1){output[_out++]=from_source[from++]}}}else{from=_out-dist;do{output[_out++]=output[from++];output[_out++]=output[from++];output[_out++]=output[from++];len-=3}while(len>2);if(len){output[_out++]=output[from++];if(len>1){output[_out++]=output[from++]}}}}else if((op&64)===0){here=dcode[(here&65535)+(hold&(1<<op)-1)];continue dodist}else{strm.msg="invalid distance code";state4.mode=BAD;break top}break}}else if((op&64)===0){here=lcode[(here&65535)+(hold&(1<<op)-1)];continue dolen}else if(op&32){state4.mode=TYPE;break top}else{strm.msg="invalid literal/length code";state4.mode=BAD;break top}break}}while(_in<last&&_out<end);len=bits>>3;_in-=len;bits-=len<<3;hold&=(1<<bits)-1;strm.next_in=_in;strm.next_out=_out;strm.avail_in=_in<last?5+(last-_in):5-(_in-last);strm.avail_out=_out<end?257+(end-_out):257-(_out-end);state4.hold=hold;state4.bits=bits;return}},function(module22,exports2,__webpack_require__){"use strict";var utils=__webpack_require__(33);var MAXBITS=15;var ENOUGH_LENS=852;var ENOUGH_DISTS=592;var CODES=0;var LENS=1;var DISTS=2;var lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78];var dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0];var dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module22.exports=function inflate_table(type,lens,lens_index,codes,table,table_index,work,opts){var bits=opts.bits;var len=0;var sym=0;var min=0,max=0;var root=0;var curr=0;var drop=0;var left=0;var used=0;var huff=0;var incr;var fill;var low;var mask;var next;var base=null;var base_index=0;var end;var count=new utils.Buf16(MAXBITS+1);var offs=new utils.Buf16(MAXBITS+1);var extra=null;var extra_index=0;var here_bits,here_op,here_val;for(len=0;len<=MAXBITS;len++){count[len]=0}for(sym=0;sym<codes;sym++){count[lens[lens_index+sym]]++}root=bits;for(max=MAXBITS;max>=1;max--){if(count[max]!==0){break}}if(root>max){root=max}if(max===0){table[table_index++]=1<<24|64<<16|0;table[table_index++]=1<<24|64<<16|0;opts.bits=1;return 0}for(min=1;min<max;min++){if(count[min]!==0){break}}if(root<min){root=min}left=1;for(len=1;len<=MAXBITS;len++){left<<=1;left-=count[len];if(left<0){return-1}}if(left>0&&(type===CODES||max!==1)){return-1}offs[1]=0;for(len=1;len<MAXBITS;len++){offs[len+1]=offs[len]+count[len]}for(sym=0;sym<codes;sym++){if(lens[lens_index+sym]!==0){work[offs[lens[lens_index+sym]]++]=sym}}if(type===CODES){base=extra=work;end=19}else if(type===LENS){base=lbase;base_index-=257;extra=lext;extra_index-=257;end=256}else{base=dbase;extra=dext;end=-1}huff=0;sym=0;len=min;next=table_index;curr=root;drop=0;low=-1;used=1<<root;mask=used-1;if(type===LENS&&used>ENOUGH_LENS||type===DISTS&&used>ENOUGH_DISTS){return 1}for(;;){here_bits=len-drop;if(work[sym]<end){here_op=0;here_val=work[sym]}else if(work[sym]>end){here_op=extra[extra_index+work[sym]];here_val=base[base_index+work[sym]]}else{here_op=32+64;here_val=0}incr=1<<len-drop;fill=1<<curr;min=fill;do{fill-=incr;table[next+(huff>>drop)+fill]=here_bits<<24|here_op<<16|here_val|0}while(fill!==0);incr=1<<len-1;while(huff&incr){incr>>=1}if(incr!==0){huff&=incr-1;huff+=incr}else{huff=0}sym++;if(--count[len]===0){if(len===max){break}len=lens[lens_index+work[sym]]}if(len>root&&(huff&mask)!==low){if(drop===0){drop=root}next+=min;curr=len-drop;left=1<<curr;while(curr+drop<max){left-=count[curr+drop];if(left<=0){break}curr++;left<<=1}used+=1<<curr;if(type===LENS&&used>ENOUGH_LENS||type===DISTS&&used>ENOUGH_DISTS){return 1}low=huff&mask;table[low]=root<<24|curr<<16|next-table_index|0}}if(huff!==0){table[next+huff]=len-drop<<24|64<<16|0}opts.bits=root;return 0}},function(module22,exports2,__webpack_require__){"use strict";var utils=__webpack_require__(33);var STR_APPLY_OK=true;var STR_APPLY_UIA_OK=true;try{String.fromCharCode.apply(null,[0])}catch(__){STR_APPLY_OK=false}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(__){STR_APPLY_UIA_OK=false}var _utf8len=new utils.Buf8(256);for(var q=0;q<256;q++){_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1}_utf8len[254]=_utf8len[254]=1;exports2.string2buf=function(str4){var buf,c,c2,m_pos,i3,str_len=str4.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++){c=str4.charCodeAt(m_pos);if((c&64512)===55296&&m_pos+1<str_len){c2=str4.charCodeAt(m_pos+1);if((c2&64512)===56320){c=65536+(c-55296<<10)+(c2-56320);m_pos++}}buf_len+=c<128?1:c<2048?2:c<65536?3:4}buf=new utils.Buf8(buf_len);for(i3=0,m_pos=0;i3<buf_len;m_pos++){c=str4.charCodeAt(m_pos);if((c&64512)===55296&&m_pos+1<str_len){c2=str4.charCodeAt(m_pos+1);if((c2&64512)===56320){c=65536+(c-55296<<10)+(c2-56320);m_pos++}}if(c<128){buf[i3++]=c}else if(c<2048){buf[i3++]=192|c>>>6;buf[i3++]=128|c&63}else if(c<65536){buf[i3++]=224|c>>>12;buf[i3++]=128|c>>>6&63;buf[i3++]=128|c&63}else{buf[i3++]=240|c>>>18;buf[i3++]=128|c>>>12&63;buf[i3++]=128|c>>>6&63;buf[i3++]=128|c&63}}return buf};function buf2binstring(buf,len){if(len<65537){if(buf.subarray&&STR_APPLY_UIA_OK||!buf.subarray&&STR_APPLY_OK){return String.fromCharCode.apply(null,utils.shrinkBuf(buf,len))}}var result="";for(var i3=0;i3<len;i3++){result+=String.fromCharCode(buf[i3])}return result}exports2.buf2binstring=function(buf){return buf2binstring(buf,buf.length)};exports2.binstring2buf=function(str4){var buf=new utils.Buf8(str4.length);for(var i3=0,len=buf.length;i3<len;i3++){buf[i3]=str4.charCodeAt(i3)}return buf};exports2.buf2string=function(buf,max){var i3,out,c,c_len;var len=max||buf.length;var utf16buf=new Array(len*2);for(out=0,i3=0;i3<len;){c=buf[i3++];if(c<128){utf16buf[out++]=c;continue}c_len=_utf8len[c];if(c_len>4){utf16buf[out++]=65533;i3+=c_len-1;continue}c&=c_len===2?31:c_len===3?15:7;while(c_len>1&&i3<len){c=c<<6|buf[i3++]&63;c_len--}if(c_len>1){utf16buf[out++]=65533;continue}if(c<65536){utf16buf[out++]=c}else{c-=65536;utf16buf[out++]=55296|c>>10&1023;utf16buf[out++]=56320|c&1023}}return buf2binstring(utf16buf,out)};exports2.utf8border=function(buf,max){var pos;max=max||buf.length;if(max>buf.length){max=buf.length}pos=max-1;while(pos>=0&&(buf[pos]&192)===128){pos--}if(pos<0){return max}if(pos===0){return max}return pos+_utf8len[buf[pos]]>max?pos:max}},function(module22,exports2){"use strict";module22.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(module22,exports2){"use strict";module22.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(module22,exports2){"use strict";function ZStream(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}module22.exports=ZStream},function(module22,exports2){"use strict";function GZheader(){this.text=0;this.time=0;this.xflags=0;this.os=0;this.extra=null;this.extra_len=0;this.name="";this.comment="";this.hcrc=0;this.done=false}module22.exports=GZheader}])})}});var CSV=class{constructor(onOpen=this.onOpen,saveButtonId=null,openButtonId=null){this.onOpen=onOpen;this.notes=[];if(saveButtonId!==null){document.getElementById(saveButtonId).addEventListener("click",this.saveCSV)}if(openButtonId!==null){document.getElementById(openButtonId).addEventListener("click",this.openCSV)}}processArraysForCSV(data=["1|2|3","3|2|1"],delimiter="|",header="a,b,c",saveNotes=false){let csvDat=header+"\\n";let noteIdx=0;data.forEach((line,i3)=>{if(data[i3]==="string"&&delimiter!==","){csvDat+=line.split(delimiter).join(",")}else{csvData+=line.join(",")}if(saveNotes===true){if(this.notes[noteIdx].idx===i3){line+=this.notes[noteIdx].text;noteIdx++}}if(line.indexOf("\\n")<0){csvDat+="\\n"}});return csvDat}static saveCSV(csvDat="a,b,c\\n1,2,3\\n3,2,1\\n",name2=new Date().toISOString()){var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csvDat);hiddenElement.target="_blank";if(name2!==""){hiddenElement.download=name2}else{hiddenElement.download=new Date().toISOString()+".csv"}hiddenElement.click()}static openCSV(delimiter=",",onOpen=(csvDat,header,path)=>{return csvDat,header,path}){return new Promise((res,rej)=>{var input=document.createElement("input");input.accept=".csv";input.type="file";input.onchange=e=>{var file=e.target.files[0];var reader=new FileReader;reader.onload=event=>{var tempcsvData=event.target.result;var tempcsvArr=tempcsvData.split("\\n");let header=[];var csvDat=[];tempcsvArr.pop();tempcsvArr.forEach((row,i3)=>{if(i3==0){header=row.split(delimiter)}else{var temp=row.split(delimiter);csvDat.push(temp)}});onOpen(csvDat,header,input.value);input.value="";res({data:csvDat,header,filename:input.value})};reader.readAsText(file)};input.click()})}static openCSVRaw(onOpen=(csvDat,path)=>{return csvDat,path}){return new Promise((res,rej)=>{var input=document.createElement("input");input.accept=".csv";input.type="file";input.onchange=e=>{var file=e.target.files[0];var reader=new FileReader;reader.onload=event=>{var tempcsvData=event.target.result;onOpen(tempcsvData,input.value);input.value="";res({data:tempcsvData,filename:input.value})};reader.readAsText(file)};input.click()})}onOpen(csvDat=[],header=[]){console.log("CSV Opened!",header,csvDat)}};var parseCSVData=(data,filename,head,hasend=true,parser=(lines,filename2,head2)=>{let result={filename:filename2};let header=head2;if(typeof head2==="string")header=head2.split(",");result.header=header;for(let i3=0;i3<lines.length;i3++){let line=lines[i3].split(",");for(let j=0;j<line.length;j++){if(!result[header[j]])result[header[j]]=[];result[header[j]].push(line[j])}}return result})=>{let lines;if(data.includes("\\r"))lines=data.split("\\r\\n");else lines=data.split("\\n");if(!head)head=lines[0];lines.shift();if(hasend===false)lines.pop();let result=parser(lines,filename,head);return result};function toISOLocal(d2){d2=new Date(d2);var z3=n=>("0"+n).slice(-2);var zz=n=>("00"+n).slice(-3);var off=d2.getTimezoneOffset();var sign=off<0?"+":"-";off=Math.abs(off);return d2.getFullYear()+"-"+z3(d2.getMonth()+1)+"-"+z3(d2.getDate())+"T"+z3(d2.getHours())+":"+z3(d2.getMinutes())+":"+z3(d2.getSeconds())+"."+zz(d2.getMilliseconds())+"(UTC"+sign+z3(off/60|0)+":00)"}var BrowserFS=__toESM4(require_browserfs());var fsInited=false;var fs2=BrowserFS.BFSRequire("fs");var BFSBuffer=BrowserFS.BFSRequire("buffer").Buffer;var initPromise;var initFS=async(dirs=["data"],oninit=(exists2=[])=>{},onerror=e=>{},filesystem="IndexedDB")=>{if(fsInited){if(initPromise){await initPromise}return true}else{fsInited=true;initPromise=new Promise((resolve,reject)=>{BrowserFS.FileSystem[filesystem].Create({},(e,mountableFileSystem)=>{if(e){reject(e);return}if(!mountableFileSystem){onerror(e);reject(new Error(`Error creating BrowserFS`));return}BrowserFS.initialize(mountableFileSystem);let promises=[];dirs.forEach(async dir=>{promises.push(dirExists(fs2,dir))});Promise.all(promises).then(values=>{oninit(values);resolve(true)})})});return await initPromise}};var exists=async(path="")=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise(resolve=>{fs2.exists("/"+path,function(exists2){resolve(exists2)})})};var readFile=async(path="data")=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise(resolve=>{fs2.readFile("/"+path,function(e,output){resolve(output)})})};async function readFileChunk(path="data",begin=0,end=5120,onread=data=>{}){if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);if(path!=""){return await new Promise(async(resolve,reject)=>{fs2.open("/"+path,"r",(e,fd)=>{if(e){reject(e);return}fs2.read(fd,end,begin,"utf-8",(er,output,bytesRead)=>{if(er){reject(er);return}if(bytesRead!==0){let data=output.toString();fs2.close(fd,()=>{onread(data,path);resolve(data)})}else resolve(void 0)})})})}else{console.error("Path name is not defined");return void 0}}var getFilenames=async(directory="data",onload=directory2=>{})=>{if(!fsInited)await initFS([directory]);else await dirExists(fs2,directory);return await new Promise((resolve,reject)=>{fs2.readdir("/"+directory,(e,dir)=>{if(e){reject(e);return}if(dir){onload(dir);resolve(dir)}else resolve(void 0)})})};var writeFile=async(path,data,onwrite=data2=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise((resolve,reject)=>{fs2.writeFile("/"+path,data,err=>{if(err){reject(err);return}onwrite(data);resolve(true)})})};var appendFile2=async(path,data,onwrite=data2=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise((resolve,reject)=>{fs2.appendFile("/"+path,data,err=>{if(err){reject(err);return}onwrite(data);resolve(true)})})};var deleteFile=async(path="data",ondelete=()=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise(resolve=>{if(path!=""){fs2.unlink("/"+path,e=>{if(e)console.error(e);ondelete();resolve(true)})}else{console.error("Path name is not defined");resolve(false)}})};var readFileAsText=async(path="data",end="end",begin=0,onread=(data,filename)=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise(async(resolve,reject)=>{let size=await getFileSize(path);if(end==="end"){end=size}else if(typeof end==="number"){if(end>size)end=size}fs2.open("/"+path,"r",(e,fd)=>{if(e){reject(e);return}fs2.read(fd,end,begin,"utf-8",(er,output,bytesRead)=>{if(er){reject(er);return}if(bytesRead!==0){let data=output.toString();fs2.close(fd,()=>{onread(data,path);resolve(data)})}else resolve(void 0)})})})};var listFiles=async(dir="data",onload=directory=>{})=>{if(!fsInited)await initFS([dir]);else await dirExists(fs2,dir);return await new Promise((resolve,reject)=>{fs2.readdir("/"+dir,(e,directory)=>{if(e){reject(e);return}if(directory){onload(directory)}resolve(directory)})})};var getFileSize=async(path="data",onread=size=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise((resolve,reject)=>{fs2.stat("/"+path,(e,stats)=>{if(e){reject(e);return}let filesize=stats.size;onread(filesize);resolve(filesize)})})};var getCSVHeader=async(path="data",onopen=(header,filename)=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise((resolve,reject)=>{fs2.open("/"+path,"r",(e,fd)=>{if(e){reject(e);return}fs2.read(fd,65535,0,"utf-8",(er,output,bytesRead)=>{if(er){reject(er);return}if(bytesRead!==0){let data=output.toString();let lines=data.split("\\n");let header=lines[0];fs2.close(fd,()=>{onopen(header,path);resolve(header)})}else resolve(void 0)})})})};var writeToCSVFromDB=async(path="data",fileSizeLimitMb=10)=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise((resolve,reject)=>{if(path!=""){fs2.stat("/"+path,(e,stats)=>{if(e){reject(e);return}let filesize=stats.size;fs2.open(path,"r",(e2,fd)=>{if(e2){reject(e2);return}let i3=0;let maxFileSize=fileSizeLimitMb*1024*1024;let end=maxFileSize;if(filesize<maxFileSize){end=filesize;fs2.read(fd,end,0,"utf-8",(e3,output,bytesRead)=>{if(e3){reject(e3);return}if(bytesRead!==0)CSV.saveCSV(output.toString(),path.split("/")[1]);fs2.close(fd);resolve(true)})}else{const writeChunkToFile=async()=>{if(i3<filesize){if(i3+end>filesize){end=filesize-i3}let chunk=0;fs2.read(fd,end,i3,"utf-8",(e3,output,bytesRead)=>{if(e3){reject(e3);return}if(bytesRead!==0){CSV.saveCSV(output.toString(),path.split("/")[1]+"_"+chunk);i3+=maxFileSize;chunk++;writeChunkToFile();fs2.close(fd);resolve(true)}})}}}})})}else{console.error("File name is not defined.");resolve(false)}})};async function processCSVChunksFromDB(path="data",onData=(csvdata,start2,end2,size)=>{},maxChunkSize=1e4,start=0,end="end",options={}){let size=await getFileSize(path);let partition=start;return await new Promise((res,rej)=>{let processPartition=()=>{let endChunk=partition+maxChunkSize;if(endChunk>size){endChunk=size}readCSVChunkFromDB(path,partition,endChunk,options).then(async result=>{await onData(result,partition,endChunk,size);partition=endChunk;if(partition!==size){processPartition()}else{res(true)}}).catch(rej)};processPartition()})}async function readCSVChunkFromDB(path="data",start=0,end="end",options={}){if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);const transpose=options.transpose||false;let head=await getCSVHeader(path);if(head)head=head.split(",");else return void 0;let resultLengths=[];let resultNames=[];let results=transpose?[]:{};head.forEach(v2=>{if(v2){resultNames.push(v2);resultLengths.push(1)}else resultLengths[resultLengths.length-1]++});let size=await getFileSize(path);if(end==="end")end=size;else if(end>size){start=size-(end-start);end=size}let data=(await readFileChunk(path,start,end))?.split("\\n").slice(1,-1);let preprocess=value=>{try{value=JSON.parse(value)}catch{}return value};if(data)data.forEach((r,i3)=>{let row=r.split(",");if(transpose){const entry={};if(options.json)row.forEach((v2,idx)=>{if(options.json)entry[resultNames[idx]]=preprocess(v2);else entry[resultNames[idx]]=v2});results.push(entry)}else{row.forEach((v2,i22)=>{const header=resultNames[i22];if(!results[header])results[header]=[];if(options.json)results[header].push(preprocess(v2));else results[header].push(v2)})}});return results}var directories={};var dirExists=async(fs3,directory)=>{if(!fsInited)await initFS([directory]);return await new Promise((resolve,reject)=>{if(!directory)reject(false);if(directories[directory]==="exists"||directories[directory]==="created"){resolve()}else{if(directory[0]==="/")directory=directory.substring(1);if(!directory)reject(false);fs3.exists(`/${directory}`,exists2=>{if(exists2){directories[directory]="exists";resolve()}else if(directories[directory]==="creating"){resolve()}else{directories[directory]="creating";fs3.mkdir(`/${directory}`,1,err=>{if(err){reject(err);return}directories[directory]="created";setTimeout(resolve,500)})}})}})};var BFSRoutes={initFS,dirExists,exists,readFile,readFileChunk,getFilenames,writeFile,appendFile:appendFile2,deleteFile,readFileAsText,getFileSize,getCSVHeader,listFiles};var CSV_REFERENCE={};function lerp(v0,v1,t3){return(1-t3)*v0+t3*v1}function interpolerp(v0,v1,fit,floor=true){if(fit<=2)return[v0,v1];let a=1/fit;let result=new Array(fit);result[0]=v0;for(let i3=1;i3<=fit;i3++){result[i3]=lerp(v0,v1,a*i3);if(floor)result[i3]=Math.floor(result[i3])}return result}var appendCSV=async(newData,filename,header,options)=>{if(!filename){let keys3=Object.keys(CSV_REFERENCE);if(keys3.length>0)filename=keys3[keys3.length-1];else filename=`csv${new Date().toISOString()}`}let csv=CSV_REFERENCE[filename];if(!csv){let keys3=Array.from(Object.keys(newData));if(keys3.indexOf("timestamp")>-1)keys3.splice(keys3.indexOf("timestamp"),1);CSV_REFERENCE[filename]={header:header?header:["timestamp","localized",...keys3],lastX:void 0,buffer:"",buffered:0,bufferSize:options?.bufferSize?options.bufferSize:0,toFixed:options?.toFixed?options.toFixed:0,xIncrement:options?.xIncrement?options.xIncrement:0};csv=CSV_REFERENCE[filename];const existingHeader=await getCSVHeader(filename).catch(()=>null);const isDifferent=!existingHeader||existingHeader!==csv.header.join(",");if(isDifferent)header=csv.header}if(!csv.header||csv.header?.length===0){let keys3=Array.from(Object.keys(newData));if(keys3.indexOf("timestamp")>-1)keys3.splice(keys3.indexOf("timestamp"),1);csv.header=header?header:["timestamp","localized",...keys3]}else if(header)csv.header=header;let maxLen=1;for(const key in newData){const value=newData[key];if(csv.header.indexOf(key)>-1&&value&&Array.isArray(value)&&value?.length>maxLen)maxLen=value?.length}let x3;if(csv.xIncrement){if(!csv.lastX){if(typeof newData[csv.header[0]]!=="undefined"){x3=newData[csv.header[0]]}else if(csv.header[0].toLowerCase().includes("time")||csv.header[0].toLowerCase().includes("unix"))x3=Date.now()}else{if(newData[csv.header[2]]){if(Array.isArray(newData[csv.header[2]]))x3=csv.lastX+csv.xIncrement*newData[csv.header[2]].length;else x3=csv.lastX+csv.xIncrement}else if(newData[csv.header[0]]){if(Array.isArray(newData[csv.header[0]]))x3=csv.lastX+csv.xIncrement*newData[csv.header[0]].length;else x3=csv.lastX+csv.xIncrement}else x3=csv.lastX+csv.xIncrement}}else if(newData[csv.header[0]])x3=newData[csv.header[0]];else x3=Date.now();if(typeof csv.lastX==="undefined")csv.lastX=Array.isArray(x3)?x3[0]:x3;if(typeof x3==="undefined"){if(csv.header[0].includes("time")){let now=Date.now();if(maxLen===1)x3=Date.now();else{x3=interpolerp(csv.lastX,now,maxLen);x3.shift()}}else{let newX=csv.lastX+1;if(maxLen>1){x3=new Array(maxLen).fill("");x3[maxLen-1]=newX}else x3=newX}}else if(maxLen>1&&x3?.length!==maxLen){if(!Array.isArray(x3)||x3.length===1){x3=interpolerp(csv.lastX,x3,maxLen,true);x3.shift()}else{x3=interpolerp(x3[0],x3[x3.length-1],maxLen,true);x3.shift()}}let toAppend=[];if(Array.isArray(x3)){let curIdcs={};for(let i3=0;i3<x3.length;i3++){toAppend.push([]);for(let j=0;j<csv.header.length;j++){let d2=newData[csv.header[j]];if(j===0){toAppend[i3][0]=x3[i3];if(csv.header[j+1]==="localized"){j++;toAppend[i3][j]=toISOLocal(x3[i3])}continue}if(d2===void 0){toAppend[i3][j]=""}else if(Array.isArray(d2)){if(d2.length===x3.length)toAppend[i3][j]=d2[i3];else{if(!(csv.header[j]in curIdcs)){curIdcs[csv.header[j]]=i3;if(d2.length!==1)toAppend[i3][j]=d2[i3]}else{if(d2.length===1&&i3===x3.length-1){toAppend[i3][j]=d2[curIdcs[csv.header[j]]]}else if(Math.floor(d2.length*i3/x3.length)>curIdcs[csv.header[j]]){curIdcs[csv.header[j]]++;toAppend[i3][j]=d2[curIdcs[csv.header[j]]]}else{toAppend[i3][j]=""}}}}else{if(i3===x3.length-1){toAppend[i3][j]=d2}else{toAppend[i3][j]=""}}if(typeof toAppend[i3][j]==="number"&&Math.floor(toAppend[i3][j])!==toAppend[i3][j])toAppend[i3][j]=toAppend[i3][j].toFixed(CSV_REFERENCE[filename].toFixed)}}}else{toAppend.push([]);for(let j=0;j<csv.header.length;j++){if(j===0){toAppend[0][0]=x3;if(csv.header[j+1]==="localized"){j++;toAppend[0][j]=toISOLocal(x3)}continue}if(csv.header[j]in newData)toAppend[0][j]=newData[csv.header[j]];else toAppend[0][j]="";if(typeof toAppend[0][j]==="number"&&Math.floor(toAppend[0][j])!==toAppend[0][j])toAppend[0][j]=toAppend[0][j].toFixed(CSV_REFERENCE[filename].toFixed)}}let csvProcessed="";if(header)csvProcessed+=header.join(",")+"\\n";toAppend.forEach(arr=>{csvProcessed+=(options?.json?arr.map(v2=>JSON.stringify(v2)):arr).join(",")+"\\n";if(csv.bufferSize)csv.buffered++});csv.lastX=toAppend[toAppend.length-1][0];if(csv.bufferSize){csv.buffer+=csvProcessed;if(csv.buffered>csv.bufferSize){let r=new Promise((res,rej)=>{exists(filename).then(fileExists=>{if(!fileExists){writeFile(filename,csv.buffer,written=>{res(written)})}else{appendFile2(filename,csv.buffer,written=>{res(written)})}})});await r;csv.buffer="";csv.buffered=0;return r}else return await Promise.resolve(true)}else{return await new Promise((res,rej)=>{exists(filename).then(fileExists=>{if(!fileExists){writeFile(filename,csvProcessed,written=>{res(written)})}else{appendFile2(filename,csvProcessed,written=>{res(written)})}})})}};var updateCSVHeader=(header,filename)=>{if(CSV_REFERENCE[filename]){CSV_REFERENCE[filename].header=header}};var createCSV=(filename,header,toFixed=5,bufferSize=0,xIncrement)=>{if(!CSV_REFERENCE[filename]){if(header?.indexOf("timestamp")>1){header.splice(header.indexOf("timestamp"),1);header.unshift("timestamp")}if((header?.[0].toLowerCase().includes("time")||header?.[0].toLowerCase().includes("unix"))&&header[1]!=="localized"){header.splice(1,0,"localized")}CSV_REFERENCE[filename]={header,lastX:header[1]==="localized"?Date.now():0,bufferSize,buffer:"",buffered:0,toFixed,xIncrement};return new Promise((res,rej)=>{exists(filename).then(doesExist=>{if(!doesExist){writeFile(filename,CSV_REFERENCE[filename].header?CSV_REFERENCE[filename].header.join(",")+"\\n":"",written=>{res(written)}).catch(rej)}})})}};var visualizeDirectory=(dir,parentNode=document.body)=>{return new Promise(async(res,rej)=>{if(parentNode.querySelector("#bfs"+dir))parentNode.querySelector("#bfs"+dir)?.remove();parentNode.insertAdjacentHTML("beforeend",`<div id=\'bfs${dir}\' class=\'bfs${dir}\'></div>`);let div=parentNode.querySelector("#bfs"+dir);await listFiles(dir).then(directory=>{if(directory.length===0)div.innerHTML="No Files!";else directory.forEach(listing=>{div?.insertAdjacentHTML("beforeend",`<div id=\'${listing}\' class=\'bfsfilediv\'>\n                        <span class=\'bfsfiletitle\'>Data: </span>\n                        <span>${listing}</span>\n                        <button class=\'bfsdownloadbtn\' id=\'download${listing}\'>Download CSV</button>\n                        ${listing.indexOf(".")>-1?`<button class=\'bfsdeletebtn\' id=\'delete${listing}\'>Delete</button>`:""}\n                    </div>`);if(document.getElementById(`delete${listing}`)){document.getElementById(`delete${listing}`).onclick=()=>{deleteFile(dir+"/"+listing,()=>{visualizeDirectory(dir,parentNode)})}}if(document.getElementById(`download${listing}`)){document.getElementById(`download${listing}`).onclick=()=>{writeToCSVFromDB(dir+"/"+listing,10)}}});res(directory)}).catch(rej)})};var csvRoutes={appendCSV,updateCSVHeader,createCSV,visualizeDirectory,openCSV:CSV.openCSV,saveCSV:CSV.saveCSV,openCSVRaw:CSV.openCSVRaw,parseCSVData,getCSVHeader,writeToCSVFromDB,readCSVChunkFromDB,processCSVChunksFromDB,toISOLocal};Object.assign(nodeTemplates,algorithms);if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){globalThis.Devices=Devices2;const worker=new WorkerService({roots:{...workerCanvasRoutes,...remoteGraphRoutes,...BFSRoutes,...csvRoutes,...streamWorkerRoutes,...webglPlotRoutes}})}var device_worker_default=self;})();\n/*! Bundled license information:\n\ndevice-decoder/dist/device.frontend.esm.js:\n  (*! Bundled license information:\n  \n  @capacitor/core/dist/index.js:\n    (*! Capacitor: https://capacitorjs.com/ - MIT License *)\n  *)\n\ngraphscript-services.storage/dist/index.storage.services.esm.js:\n  (*! Bundled license information:\n  \n  browserfs/dist/browserfs.js:\n    (*!\n    * The buffer module from node.js, for the browser.\n    *\n    * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n    * @license  MIT\n    *)\n  *)\n*/\n',UAe=URL.createObjectURL(new globalThis.Blob([$Ae],{type:"text/javascript"})),lc=UAe;var cc={heg:sc.addWorker({url:lc}),fnirs:sc.addWorker({url:lc}),hr:sc.addWorker({url:lc}),br:sc.addWorker({url:lc})},$1=[6,7],zAe={6:"long",7:"short"},TN=[255,9,30],j1={255:"ambient",30:"red",9:"infrared"},qAe=TN.filter(e=>e!==255).length,ON=0,VAe=TN.length,AN=0,HAe=$1.length*VAe,WAe={},CN=e=>j1[e],JY=e=>zAe[e],nv=["timestamp"],NN={};$1.forEach(e=>{let t=JY(e);TN.forEach(r=>{let n=CN(r);NN[n+"_"+t]={sps:20,nSec:10},nv.push(n+"_"+t)})});for(let e in P1)P1[e].useScaling=!1;var ci={ambient:0,red:0,infrared:0,heg:0,timestamp:0},JAe=!0,Gs,IN=0,Ko={};wt.data.csvs={};var GY=async()=>{let e=sc.addWorker({url:lc}),t=await e.run("loadFromTemplate",["beat_detect","hr",{maxFreq:3,sps:20.833}]),r=s=>{if(console.log(s),s){let l={hr:s.bpm,hrv:s.change,height0:s.height0,height1:s.height1,timestamp:s.timestamp};wt.setValue("hr",l),wt.data.deviceRecording&&(wt.data.csvs.hr||(wt.data.csvs.hr="data/HRV_"+new Date().toISOString()+".csv",cc.hr.run("createCSV",[wt.data.csvs.hr,nv,3,1]).then(async()=>{})),cc.hr.run("appendCSV",l,wt.data.csvs.hr))}};e.subscribe("hr",s=>{Array.isArray(s)?s.map(r):r(s)});let n=sc.addWorker({url:lc}),i=await n.run("loadFromTemplate",["beat_detect","breath",{maxFreq:.2,sps:20.833}]),a=s=>{if(s){let l={breath:s.bpm,brv:s.change,timestamp:s.timestamp};wt.setValue("breath",l),wt.data.deviceRecording&&(wt.data.csvs.breath||(wt.data.csvs.breath="data/BREATH_"+new Date().toISOString()+".csv",cc.breath.run("createCSV",[wt.data.csvs.breath,nv,3,1]).then(async()=>{})),cc.breath.run("appendCSV",l,wt.data.csvs.breath))}};n.subscribe("breath",s=>{Array.isArray(s)?s.map(a):a(s)});let o="B";return zu.BLE.nrf5x.namePrefix=o,zu.BLE.nrf5x_singleended.namePrefix=o,R1(zu.BLE.nrf5x_singleended,{workerUrl:lc,ondecoded:{"0002cafe-b0ba-8bad-f00d-deadbeef0000":s=>{if(s.leds){let l={timestamp:s.timestamp},c=(f,u)=>{let h=(g,_)=>{let w=JY(g),E=CN(f)+"_"+w,S=CN(Gs)+"_"+w;if((!Ko[E]||f===255&&Ko[E]>s[g][u]||Ko[E]<s[g][u])&&(Ko[E]=s[g][u]),Gs&&Ko[S]&&Gs!==f){l[S]||(l[S]=[]);let A;if(Gs===255?(_===0&&ON++,ON===qAe&&(A=Ko[S],l[S].push(A),_+1==$1.length&&(ON=0))):(A=JAe&&IN?Ko[S]-IN:Ko[S],l[S].push(A)),WAe[S]=l[S],typeof A=="number"&&(j1[Gs]==="red"?ci.red+=A:j1[Gs]==="infrared"?ci.infrared+=A:j1[Gs]==="ambient"&&(ci.ambient+=A),Gs===255&&(IN=Ko[S]),delete Ko[S],AN++,AN===HAe)){ci.infrared&&(ci.heg=ci.red/ci.infrared,wt.setValue("heg",ci)),ci.timestamp=s.timestamp[0],wt.data.deviceRecording&&(wt.data.csvs.heg||(wt.data.csvs.heg="data/HEG_"+new Date().toISOString()+".csv",cc.heg.run("createCSV",[wt.data.csvs.heg,nv,5,50]).then(async()=>{})),cc.heg.run("appendCSV",l,wt.data.csvs.heg));let O={raw:ci.red+ci.infrared+ci.ambient,timestamp:ci.timestamp};e.post("hr",O),n.post("breath",O),AN=0,ci.red=0,ci.infrared=0,ci.ambient=0}}};$1.forEach(h),Gs=f};s.leds.forEach(c),wt.data.deviceRecording&&(wt.data.csvs.fnirs||(wt.data.csvs.fnirs="data/FNIRS_"+new Date().toISOString()+".csv",cc.fnirs.run("createCSV",[wt.data.csvs.fnirs,nv,5,100]).then(async()=>{})),cc.fnirs.run("appendCSV",l,wt.data.csvs.fnirs)),wt.setValue("fnirs",l)}}},ondisconnect:()=>{e.terminate(),n.terminate(),wt.setState({deviceConnected:!1,device:void 0})},onconnect:()=>{wt.setState({deviceConnected:!0})},filterSettings:P1}).then(s=>{wt.setState({device:s})}).catch(s=>{e.terminate(),n.terminate(),wt.setState({deviceConnected:!1})})};var GAe='(()=>{var mouseEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]);var wheelEventHandlerImpl=makeSendPropertiesHandler(["deltaX","deltaY"]);var keydownEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function focusEventHandler(event,sendFn){const data={type:event.type};data.isTrusted=event.isTrusted;data.bubbles=event.bubbles;data.cancelBubble=event.cancelBubble;data.cancelable=event.cancelable;data.composed=event.composed;data.defaultPrevent=event.defaultPrevented;data.eventPhase=event.eventPhase;data.returnValue=event.returnValue;data.currentTarget=event.currentTarget.id?event.currentTarget.id:event.currentTarget.constructor.name;data.target=data.currentTarget;data.srcElement=data.currentTarget;sendFn(data)}function wheelEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();wheelEventHandlerImpl(event,sendFn)}function preventDefaultHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault()}function copyProperties(src,properties,dst){for(const name of properties){dst[name]=src[name]}}function makeSendPropertiesHandler(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties(event,properties,data);sendFn(data)}}function touchEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();const touches=[];const data={type:event.type,touches};for(let i2=0;i2<event.touches.length;++i2){const touch=event.touches[i2];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var i=1;var keys={};while(i<222){keys[i]=true;i++}function filteredKeydownEventHandler(event,sendFn,preventDefault){let{keyCode}=event;if(keys[keyCode]){if(preventDefault&&event.preventDefault&&(keyCode<110||keyCode>123))event.preventDefault();keydownEventHandler(event,sendFn)}}var eventHandlers={contextmenu:preventDefaultHandler,mousedown:mouseEventHandler,mousemove:mouseEventHandler,mouseup:mouseEventHandler,pointerdown:mouseEventHandler,pointermove:mouseEventHandler,pointerup:mouseEventHandler,pointerlockchange:mouseEventHandler,webkitpointerlockchange:mouseEventHandler,focus:focusEventHandler,blur:focusEventHandler,pointerout:mouseEventHandler,touchstart:touchEventHandler,touchmove:touchEventHandler,touchend:touchEventHandler,wheel:wheelEventHandler,keydown:filteredKeydownEventHandler,keyup:filteredKeydownEventHandler};function initProxyElement(element,worker,id,preventDefault){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{if(!worker){handleProxyEvent(data,id)}else worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent,preventDefault)})}if(eventHandlers.keydown){globalThis.addEventListener("keydown",function(ev){eventHandlers.keydown(ev,sendEvent,preventDefault)})}if(eventHandlers.keyup){globalThis.addEventListener("keyup",function(ev){eventHandlers.keyup(ev,sendEvent,preventDefault)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher=class{addEventListener(type,listener){if(this.__listeners===void 0)this.__listeners={};const listeners=this.__listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this.__listeners===void 0)return false;const listeners=this.__listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i2=0,l=array.length;i2<l;i2++){array[i2].call(this,event)}}}};function noop(){}var ElementProxyReceiver=class extends EventDispatcher{constructor(){super();this.__listeners={};this.style={};this.setPointerCapture=()=>{};this.releasePointerCapture=()=>{};this.getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};this.handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.style.width=this.width+"px";this.proxied.style.height=this.height+"px";this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop;data.stopPropagation=noop;this.dispatchEvent(data,this.proxied)};this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}focus(){}blur(){}};var ProxyManager=class{constructor(){this.targets={};this.makeProxy=(id,addTo=void 0)=>{if(!id)id=`proxyReceiver${Math.floor(Math.random()*1e15)}`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;if(typeof WorkerGlobalScope!=="undefined")addTo.style=proxy.style;if(proxy.width){addTo.style.width=proxy.width+"px";addTo.clientWidth=proxy.width}if(proxy.height){addTo.style.height=proxy.height+"px";addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy);addTo.blur=proxy.blur.bind(proxy)}};this.getProxy=id=>{return this.targets[id]};this.handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0};if(!globalThis.document)globalThis.document={elementFromPoint:(...args)=>{return this.targets[Object.keys(this.targets)[0]].proxied}}}};function makeProxy(id,elm){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;this.__node.graph.ProxyManager.makeProxy(id,elm)}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;globalThis.ProxyManager.makeProxy(id,elm)}return id}function handleProxyEvent(data,id){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;if(this.__node.graph.ProxyManager.handleEvent(data,id))return data}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;if(globalThis.ProxyManager.handleEvent(data,id))return data}}var proxyElementWorkerRoutes={initProxyElement,makeProxy,handleProxyEvent};function Renderer(options){if(options.worker){let worker=options.worker;let route=options.route;if(worker instanceof Blob||typeof worker==="string"){worker=new Worker(worker)}delete options.worker;delete options.route;return transferCanvas(worker,options,route)}else{initProxyElement(options.canvas,void 0,options._id,options.preventDefault);return setupCanvas(options)}}function transferCanvas(worker,options,route){if(!options)return void 0;if(!options._id)options._id=`canvas${Math.floor(Math.random()*1e15)}`;let offscreen=options.canvas.transferControlToOffscreen();if(!options.width)options.width=options.canvas.clientWidth;if(!options.height)options.height=options.canvas.clientHeight;let message={route:route?route:"setupCanvas",args:{...options,canvas:offscreen}};if(this?.__node?.graph)this.__node.graph.run("initProxyElement",options.canvas,worker,options._id,options.preventDefault);else initProxyElement(options.canvas,worker,options._id,options.preventDefault);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let tr=[offscreen];if(options.transfer){tr.push(...options.transfer);delete options.transfer}worker.postMessage(message,tr);const canvascontrols={_id:options._id,width:options.width,height:options.height,worker,draw:(props,transfer)=>{worker.postMessage({route:"drawFrame",args:[props,options._id]},transfer)},update:(props,transfer)=>{worker.postMessage({route:"updateCanvas",args:[props,options._id]},transfer)},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:(newDrawProps,transfer)=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]},transfer)},terminate:()=>{worker.terminate()}};return canvascontrols}function setDraw(settings,_id){let canvasopts;if(this?.__node?.graph){if(_id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]}else{if(_id)canvasopts=globalThis.CANVASES?.[settings._id];else if(settings._id)canvasopts=globalThis.CANVASES?.[settings._id];else canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]]}if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasopts._id,canvasopts.canvas);else proxyElementWorkerRoutes.makeProxy(canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw.bind(settings)}if(typeof settings.update==="string")settings.update=parseFunctionFromText(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update.bind(settings)}if(typeof settings.init==="string")settings.init=parseFunctionFromText(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init.bind(settings)}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear.bind(settings)}return settings._id}return void 0}function setupCanvas(options){if(this?.__node?.graph){if(!this.__node.graph.CANVASES)this.__node.graph.CANVASES={}}else if(!globalThis.CANVASES)globalThis.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=`canvas${Math.floor(Math.random()*1e15)}`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this?.__node?.graph?.CANVASES[canvasOptions._id]){this.__node.graph.run("setDraw",canvasOptions)}else if(globalThis.CANVASES?.[canvasOptions._id]){setDraw(canvasOptions)}else{if(this?.__node?.graph){canvasOptions.graph=this.__node.graph;if(!canvasOptions.__node){canvasOptions.__node={}}if(!canvasOptions.__node.tag)canvasOptions.__node.tag=canvasOptions._id;canvasOptions=this.__node.graph.add(canvasOptions);canvasOptions.__addOndisconnected=()=>{canvasOptions.stop();delete this.__node.graph.CANVASES[canvasOptions._id]}}if(this?.__node?.graph)this.__node.graph.CANVASES[canvasOptions._id]=canvasOptions;else globalThis.CANVASES[canvasOptions._id]=canvasOptions;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);else proxyElementWorkerRoutes.makeProxy(canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText(canvasOptions.draw)}else if(typeof canvasOptions.draw==="function"){canvasOptions.draw=canvasOptions.draw.bind(canvasOptions)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText(canvasOptions.update)}else if(typeof canvasOptions.update==="function"){canvasOptions.update=canvasOptions.update.bind(canvasOptions)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText(canvasOptions.init)}else if(typeof canvasOptions.init==="function"){canvasOptions.init=canvasOptions.init.bind(canvasOptions)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText(canvasOptions.clear)}else if(typeof canvasOptions.clear==="function"){canvasOptions.clear=canvasOptions.clear.bind(canvasOptions)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);canvasOptions.stop=()=>{stopAnim(canvasOptions._id)};canvasOptions.start=draw=>{startAnim(canvasOptions._id,draw)};canvasOptions.set=settings=>{setDraw(settings,canvasOptions._id)};if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)return canvasOptions._id;else{const canvascontrols={_id:options._id,width:options.width,height:options.height,draw:props=>{drawFrame(props,options._id)},update:props=>{updateCanvas(props,options._id)},clear:()=>{clearCanvas(options._id)},init:()=>{initCanvas(options._id)},stop:()=>{stopAnim(options._id)},start:()=>{startAnim(options._id)},set:newDrawProps=>{setDraw(newDrawProps,options._id)},terminate:()=>{if(this.__node?.graph)this.__node.graph.remove(options._id);else{stopAnim(options._id);if(this?.__node?.graph)delete this.__node.graph.CANVASES[canvasOptions._id];else delete globalThis.CANVASES[canvasOptions._id]}}};return canvascontrols}}function drawFrame(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0}function clearCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function initCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function updateCanvas(input,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0}function setProps(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0}function startAnim(_id,draw){let canvasopts=getCanvas.call(this,_id);canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function stopAnim(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")requestAnimationFrame(canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context));return _id}return void 0}function getCanvas(_id){let canvasopts;if(this?.__node?.graph){if(!_id)canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]];else canvasopts=this.__node.graph.CANVASES?.[_id]}else{if(!_id)canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]];else canvasopts=globalThis.CANVASES?.[_id]}return canvasopts}var workerCanvasRoutes={...proxyElementWorkerRoutes,Renderer,transferCanvas,setupCanvas,setDraw,drawFrame,clearCanvas,initCanvas,updateCanvas,setProps,startAnim,stopAnim,getCanvas};function parseFunctionFromText(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var v=class{constructor(e,t,n,o){this.r=e,this.g=t,this.b=n,this.a=o}};var x=class{constructor(){this.scaleX=1,this.scaleY=1,this.offsetX=0,this.offsetY=0,this.loop=false,this._vbuffer=0,this._coord=0,this.visible=true,this.intensity=1,this.xy=new Float32Array([]),this.numPoints=0,this.color=new v(0,0,0,1),this.webglNumPoints=0}};var d=class extends x{constructor(e,t){super(),this.currentIndex=0,this.webglNumPoints=t,this.numPoints=t,this.color=e,this.xy=new Float32Array(2*this.webglNumPoints)}setX(e,t){this.xy[e*2]=t}setY(e,t){this.xy[e*2+1]=t}getX(e){return this.xy[e*2]}getY(e){return this.xy[e*2+1]}lineSpaceX(e,t){for(let n=0;n<this.numPoints;n++)this.setX(n,e+t*n)}arrangeX(){this.lineSpaceX(-1,2/this.numPoints)}constY(e){for(let t=0;t<this.numPoints;t++)this.setY(t,e)}shiftAdd(e){let t=e.length;for(let n=0;n<this.numPoints-t;n++)this.setY(n,this.getY(n+t));for(let n=0;n<t;n++)this.setY(n+this.numPoints-t,e[n])}addArrayY(e){if(this.currentIndex+e.length<=this.numPoints)for(let t=0;t<e.length;t++)this.setY(this.currentIndex,e[t]),this.currentIndex++}replaceArrayY(e){if(e.length==this.numPoints)for(let t=0;t<this.numPoints;t++)this.setY(t,e[t])}};var M=(f,e,t)=>{let n={x:0,y:0};return n.x=f.x+e.x*t,n.y=f.y+e.y*t,n};var _=f=>P(-f.y,f.x);var w=(f,e)=>{let t=R(f,e);return t=S(t),t};var T=(f,e)=>{let t={x:0,y:0};return t.x=f.x+e.x,t.y=f.y+e.y,t};var C=(f,e)=>f.x*e.x+f.y*e.y;var S=f=>{let e={x:0,y:0},t=f.x*f.x+f.y*f.y;return t>0&&(t=1/Math.sqrt(t),e.x=f.x*t,e.y=f.y*t),e};var P=(f,e)=>{let t={x:0,y:0};return t.x=f,t.y=e,t};var R=(f,e)=>{let t={x:0,y:0};return t.x=f.x-e.x,t.y=f.y-e.y,t};var F=f=>{let e,t={x:0,y:0},n={x:0,y:0},o=[],a=(s,r)=>{o.push({vec2:s,miterLength:r})},h=s=>({x:f[s*2],y:f[s*2+1]});t=w(h(1),h(0)),e=_(t),a(e,1);let l=f.length/2;for(let s=1;s<l-1;s++){let r=h(s-1),i2=h(s),u=h(s+1);t=w(i2,r),e=_(t),n=w(u,i2);let c=N(t,n),g=X(t,c,1);a(c,g)}return t=w(h(l-1),h(l-2)),e=_(t),a(e,1),o};var N=(f,e)=>{let t=T(f,e);return t=S(t),P(-t.y,t.x)};var X=(f,e,t)=>{let n=P(-f.y,f.x);return t/C(e,n)};var p=class extends x{constructor(e,t,n){super(),this.currentIndex=0,this._thicknessRequested=0,this._actualThickness=0,this.webglNumPoints=t*2,this.numPoints=t,this.color=e,this._thicknessRequested=n,this._linePoints=new Float32Array(t*2),this.xy=new Float32Array(2*this.webglNumPoints)}convertToTriPoints(){let e=this._actualThickness/2,t=F(this._linePoints);for(let n=0;n<this.numPoints;n++){let o=this._linePoints[2*n],a=this._linePoints[2*n+1],h={x:o,y:a},l=M(h,t[n].vec2,t[n].miterLength*e),s=M(h,t[n].vec2,-t[n].miterLength*e);this.xy[n*4]=l.x,this.xy[n*4+1]=l.y,this.xy[n*4+2]=s.x,this.xy[n*4+3]=s.y}}setX(e,t){this._linePoints[e*2]=t}setY(e,t){this._linePoints[e*2+1]=t}lineSpaceX(e,t){for(let n=0;n<this.numPoints;n++)this.setX(n,e+t*n)}setThickness(e){this._thicknessRequested=e}getThickness(){return this._thicknessRequested}setActualThickness(e){this._actualThickness=e}};var A=class{constructor(e,t){this.debug=false,this.addLine=this.addDataLine,t==null?this.webgl=e.getContext("webgl",{antialias:true,transparent:false}):(this.webgl=e.getContext("webgl",{antialias:t.antialias,transparent:t.transparent,desynchronized:t.deSync,powerPerformance:t.powerPerformance,preserveDrawing:t.preserveDrawing}),this.debug=t.debug==null?false:t.debug),this.log("canvas type is: "+e.constructor.name),this.log(`[webgl-plot]:width=${e.width}, height=${e.height}`),this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[],this.gScaleX=1,this.gScaleY=1,this.gXYratio=1,this.gOffsetX=0,this.gOffsetY=0,this.gLog10X=false,this.gLog10Y=false,this.webgl.clear(this.webgl.COLOR_BUFFER_BIT),this.webgl.viewport(0,0,e.width,e.height),this._progLine=this.webgl.createProgram(),this.initThinLineProgram(),this.webgl.enable(this.webgl.BLEND),this.webgl.blendFunc(this.webgl.SRC_ALPHA,this.webgl.ONE_MINUS_SRC_ALPHA)}get linesData(){return this._linesData}get linesAux(){return this._linesAux}get thickLines(){return this._thickLines}get surfaces(){return this._surfaces}_drawLines(e){let t=this.webgl;e.forEach(n=>{if(n.visible){t.useProgram(this._progLine);let o=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(o,false,new Float32Array([n.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,n.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let a=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(a,new Float32Array([n.offsetX+this.gOffsetX,n.offsetY+this.gOffsetY]));let h=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(h,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let l=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(l,[n.color.r,n.color.g,n.color.b,n.color.a]),t.bufferData(t.ARRAY_BUFFER,n.xy,t.STREAM_DRAW),t.drawArrays(n.loop?t.LINE_LOOP:t.LINE_STRIP,0,n.webglNumPoints)}})}_drawSurfaces(e){let t=this.webgl;e.forEach(n=>{if(n.visible){t.useProgram(this._progLine);let o=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(o,false,new Float32Array([n.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,n.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let a=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(a,new Float32Array([n.offsetX+this.gOffsetX,n.offsetY+this.gOffsetY]));let h=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(h,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let l=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(l,[n.color.r,n.color.g,n.color.b,n.color.a]),t.bufferData(t.ARRAY_BUFFER,n.xy,t.STREAM_DRAW),t.drawArrays(t.TRIANGLE_STRIP,0,n.webglNumPoints)}})}_drawTriangles(e){let t=this.webgl;t.bufferData(t.ARRAY_BUFFER,e.xy,t.STREAM_DRAW),t.useProgram(this._progLine);let n=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(n,false,new Float32Array([e.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,e.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let o=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(o,new Float32Array([e.offsetX+this.gOffsetX,e.offsetY+this.gOffsetY]));let a=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(a,new Int32Array([0,0]));let h=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(h,[e.color.r,e.color.g,e.color.b,e.color.a]),t.drawArrays(t.TRIANGLE_STRIP,0,e.xy.length/2)}_drawThickLines(){this._thickLines.forEach(e=>{if(e.visible){let t=Math.min(this.gScaleX,this.gScaleY);e.setActualThickness(e.getThickness()/t),e.convertToTriPoints(),this._drawTriangles(e)}})}update(){this.clear(),this.draw()}draw(){this._drawLines(this.linesData),this._drawLines(this.linesAux),this._drawThickLines(),this._drawSurfaces(this.surfaces)}clear(){this.webgl.clear(this.webgl.COLOR_BUFFER_BIT)}_addLine(e){e._vbuffer=this.webgl.createBuffer(),this.webgl.bindBuffer(this.webgl.ARRAY_BUFFER,e._vbuffer),this.webgl.bufferData(this.webgl.ARRAY_BUFFER,e.xy,this.webgl.STREAM_DRAW),e._coord=this.webgl.getAttribLocation(this._progLine,"coordinates"),this.webgl.vertexAttribPointer(e._coord,2,this.webgl.FLOAT,false,0,0),this.webgl.enableVertexAttribArray(e._coord)}addDataLine(e){this._addLine(e),this.linesData.push(e)}addAuxLine(e){this._addLine(e),this.linesAux.push(e)}addThickLine(e){this._addLine(e),this._thickLines.push(e)}addSurface(e){this._addLine(e),this.surfaces.push(e)}initThinLineProgram(){let e=`\n      attribute vec2 coordinates;\n      uniform mat2 uscale;\n      uniform vec2 uoffset;\n      uniform ivec2 is_log;\n\n      void main(void) {\n         float x = (is_log[0]==1) ? log(coordinates.x) : coordinates.x;\n         float y = (is_log[1]==1) ? log(coordinates.y) : coordinates.y;\n         vec2 line = vec2(x, y);\n         gl_Position = vec4(uscale*line + uoffset, 0.0, 1.0);\n      }`,t=this.webgl.createShader(this.webgl.VERTEX_SHADER);this.webgl.shaderSource(t,e),this.webgl.compileShader(t);let n=`\n         precision mediump float;\n         uniform highp vec4 uColor;\n         void main(void) {\n            gl_FragColor =  uColor;\n         }`,o=this.webgl.createShader(this.webgl.FRAGMENT_SHADER);this.webgl.shaderSource(o,n),this.webgl.compileShader(o),this._progLine=this.webgl.createProgram(),this.webgl.attachShader(this._progLine,t),this.webgl.attachShader(this._progLine,o),this.webgl.linkProgram(this._progLine)}popDataLine(){this.linesData.pop()}removeAllLines(){this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[]}removeDataLines(){this._linesData=[]}removeAuxLines(){this._linesAux=[]}viewport(e,t,n,o){this.webgl.viewport(e,t,n,o)}log(e){this.debug&&console.log("[webgl-plot]:"+e)}};var y=class{constructor(){this.plots={};this.renderOverlay=(e,t,n,o,a,h=1,l=0)=>{if(typeof n.settings.overlay=="object"&&(o.useOverlay||!("useOverlay"in o))){let s=n.settings.nLines-o.position-1,r=e.height*s/n.settings.nLines,i2=e.height*(s+1)/n.settings.nLines;if(t.clearRect(0,r,e.width,i2),n.settings.mode==="sweep"){t.strokeStyle=n.settings.sweepColor?n.settings.sweepColor:"rgba(0,255,0,0.8)",t.beginPath();let u=e.width*o.ct/o.values.length;t.moveTo(u,r),t.lineTo(u,i2),t.stroke()}if(t.fillStyle=n.settings.overlayColor?n.settings.overlayColor:"white",a&&t.fillText(a,20,e.height*(s+.2)/n.settings.nLines),o.nSec){let u=this.formatTime(o.nSec);t.fillText(`${u}`,n.settings.mode==="sweep"?e.width-35:20,e.height*(s+.9)/n.settings.nLines),t.fillText("0:00",n.settings.mode==="sweep"?20:e.width-35,e.height*(s+.9)/n.settings.nLines)}typeof h=="number"&&t.fillText(`${Math.floor(h)===h?h:h?.toFixed(5)} ${o.units?o.units:""}`,e.width-100,e.height*(s+.2)/n.settings.nLines),typeof l=="number"&&t.fillText(`${Math.floor(l)===l?l:l?.toFixed(5)} ${o.units?o.units:""}`,e.width-100,e.height*(s+.8)/n.settings.nLines)}}}initPlot(e,t){if(t||(t=new A(e.canvas,e.webglOptions)),!e._id)e._id=`plot${Math.floor(Math.random()*1e15)}`;else if(this.plots[e._id]){let r=this.plots[e._id].initial;if(e.lines){for(let i2 in e.lines)if(r.lines[i2]&&Array.isArray(e.lines[i2])){let u=e.lines[i2];e.lines[i2]=r.lines[i2]}}e=Object.assign(r,e)}e.overlay&&(typeof e.overlay!="object"&&(e.overlay=document.createElement("canvas"),e.overlay.style.position="absolute",e.overlay.width=e.canvas.width,e.overlay.height=e.canvas.height,e.canvas.appendChild(e.overlay)),e.overlayCtx||(e.overlayCtx=e.overlay.getContext("2d"))),e.width&&(e.canvas.width=e.width,e.canvas.style&&(e.canvas.style.width=e.width+"px"),typeof e.overlay=="object"&&(e.overlay.width=e.width,e.overlay.style&&(e.overlay.style.width=e.width+"px"))),e.height&&(e.canvas.height=e.height,e.canvas.style&&(e.canvas.style.height=e.height+"px"),typeof e.overlay=="object"&&(e.overlay.height=e.height,e.overlay.style&&(e.overlay.style.height=e.height+"px"))),e.lines?.timestamp&&delete e.lines.timestamp,e.lines||(e.lines={});let n={};for(let r in e.lines)n[r]=Object.assign({},n[r]),"viewing"in e.lines[r]||(e.lines[r].viewing=true),n[r].viewing=e.lines[r].viewing,n[r].sps=e.lines[r].sps,n[r].nSec=e.lines[r].nSec,n[r].nPoints=e.lines[r].nPoints,n[r].ymin=e.lines[r].ymin,n[r].ymax=e.lines[r].ymax,n[r].units=e.lines[r].units;let o={plot:t,settings:e,initial:Object.assign(Object.assign({},e),{lines:n}),anim:()=>{t.update()}};this.plots[e._id]=o;let a=0,h=0;Object.keys(e.lines).forEach(r=>{e.lines[r]?.viewing!==false&&h++}),e.nLines=h;let l,s;typeof e.overlay=="object"&&(l=e.overlay,s=e.overlayCtx,s.clearRect(0,0,e.overlay.width,e.overlay.height),s.font=e.overlayFont?e.overlayFont:"1em Courier",s.fillStyle=e.overlayColor?e.overlayColor:"white");for(let r in e.lines){let i2=e.lines[r];if(Array.isArray(i2)&&(i2={values:i2},e.lines[r]=i2),"viewing"in i2||(i2.viewing=true),i2.color)Array.isArray(i2.color)&&(i2.color=new v(...i2.color));else{let m=y.HSLToRGB(360*(a/h)%360,100,50,1);o.initial.lines[r].color=[...m,1],i2.color=new v(...m,1)}let u;if(i2.nSec&&i2.sps?u=Math.ceil(i2.nSec*i2.sps):i2.nPoints?u=i2.nPoints:i2.points?u=i2.points:e.linePoints?u=e.linePoints:i2.values?u=i2.values.length:u=1e3,i2.points=u,e.lines[r].viewing===false)continue;if((i2.width||e.lineWidth)&&i2.width!==0){let m=e.lineWidth;m||(m=i2.width),i2.width?i2.line=new p(i2.color,u,i2.width):e.lineWidth&&(i2.line=new p(i2.color,u,e.lineWidth)),i2.line.lineSpaceX(-1,2/i2.line.numPoints)}else i2.line=new d(i2.color,u),i2.line.arrangeX();i2.values?.length===i2.points?i2.values.length!==u&&(i2.interpolate?i2.values.length>u?i2.values=y.downsample(i2.values,u):i2.values.length<u&&(i2.values=y.upsample(i2.values,u)):i2.values.length>i2.points?i2.values=i2.values.slice(i2.values.length-i2.points):i2.values=[...new Array(i2.points-i2.values.length).fill(0),...i2.values]):Array.isArray(i2.values)?i2.values.length>u?i2.values=i2.values.slice(i2.values.length-u):i2.values.length<u&&(i2.values=[...new Array(u-i2.values.length).fill(0),...i2.values]):i2.values=new Array(i2.points).fill(0);let c=i2.ymin,g=i2.ymax,b=i2.values.length<=1e5;if(c===g?(g=b?Math.max(...i2.values):1,c=b?Math.min(...i2.values):0):isNaN(g)&&(g=b?Math.max(...i2.values):1),isNaN(c)&&(c=b?Math.min(...i2.values):0),c>g){let m=c;g=c,c=m}let Y=Math.abs(c);if(i2.absmax=Y>g?Y:g,"autoscale"in i2||(i2.autoscale=true),i2.position||(i2.position=e.nLines-a-1),i2.autoscale?i2.autoscale===2?("clamp"in i2||(i2.clamp=true),i2.scaled=y.autoscale(i2.values,i2.position,h,i2.centerZero,c,g,i2.clamp)):(i2.scaled=i2.values,i2.line.scaleY=y.getYScalar(i2.values,h,i2.centerZero,c,g),i2.line.offsetY=y.getYOffset(i2.position,h,c,i2.line.scaleY)):i2.scaled=i2.values,i2.scaled.forEach((m,L)=>i2.line.setY(L,m)),i2.line instanceof p?t.addThickLine(i2.line):i2.line instanceof d&&t.addDataLine(i2.line),"xAxis"in i2||(i2.xAxis=true),i2.xAxis){i2.xColor?Array.isArray(i2.xColor)&&(i2.xColor=new v(...i2.xColor)):i2.xColor=new v(1,1,1,.3);let m=new d(i2.xColor,2),L=i2.autoscale?(a+1)*2/h-1-1/h:0;m.constY(L),m.arrangeX(),m.xy[2]=1,i2.x=m,t.addAuxLine(m)}if(h>1&&i2.autoscale&&a!==h-1){e.dividerColor?Array.isArray(e.dividerColor)&&(e.dividerColor=new v(...e.dividerColor)):e.dividerColor=new v(1,1,1,1);let m=new d(e.dividerColor,2);m.constY(i2.autoscale?(a+1)*2/h-1:1),m.arrangeX(),m.xy[2]=1,i2.divider=m,t.addAuxLine(m)}if(typeof e.overlay=="object"&&(i2.useOverlay||!("useOverlay"in i2))){let m=e.nLines-i2.position-1;s.fillText(r,20,l.height*(m+.2)/e.nLines),s.fillText(`${Math.floor(g)===g?g:g?.toFixed(5)} ${i2.units?i2.units:""}`,l.width-100,l.height*(m+.2)/e.nLines),s.fillText(`${Math.floor(c)===c?c:c?.toFixed(5)} ${i2.units?i2.units:""}`,l.width-100,l.height*(m+.9)/e.nLines)}a++}return requestAnimationFrame(o.anim),this.plots[e._id]}deinitPlot(e){return typeof e=="string"&&(e=this.plots[e]),e.plot.clear(),e.plot.removeAllLines(),true}reinitPlot(e,t){if(typeof e=="string"){let n=e;e=this.plots[e],t._id||(t._id=n)}if(e.plot)return e.plot.clear(),e.plot.removeAllLines(),e.settings.overlayCtx&&e.settings.overlayCtx.clearRect(0,0,e.settings.overlay?.width,e.settings.overlay?.height),this.initPlot(t,e.plot)}getChartSettings(e,t){let n=this.plots[e];if(n){let o=Object.assign({},n.initial);for(let a in n.initial.lines)typeof n.initial.lines[a]?.ymax!="number"&&(o.lines[a].ymax=n.settings.lines[a]?.ymax),typeof n.initial.lines[a]?.ymin!="number"&&(o.lines[a].ymin=n.settings.lines[a]?.ymin),t&&(o.lines[a].values=n.settings.lines[a].values);return delete o.canvas,delete o.overlay,delete o.overlayCtx,o}}update(e,t,n=true){if(typeof e=="string"&&(e=this.plots[e]),!e)return false;let o,a;if(typeof e.settings.overlay=="object"&&(o=e.settings.overlay,a=e.settings.overlayCtx,a.font=e.settings.overlayFont?e.settings.overlayFont:"1em Courier",a.fillStyle=e.settings.overlayColor?e.settings.overlayColor:"white"),t){let h=false;for(let l in t)if(e.settings.lines[l]&&e.settings.lines[l].line){if(e.settings.lines[l]?.viewing===false)continue;let s=e.settings.lines[l];if(s.values){if(e.settings.mode&&e.settings.mode==="sweep"){"ct"in s||(s.ct=0);let g=b=>{s.ct>s.values.length&&(s.ct=0),s.values[s.ct]=b,s.ct++};Array.isArray(t[l])?(s.ct===0&&(s.values=new Array(s.values.length).fill(t[l][t[l].length-1])),t[l].forEach(g)):typeof t[l]=="number"?(s.ct===0&&(s.values=new Array(s.values.length).fill(t[l])),g(t[l])):t[l].values&&(s.ct===0&&(s.values=new Array(s.values.length).fill(t[l].values[t[l].values.length-1])),t[l].values.forEach(g))}else Array.isArray(t[l])&&s.values?.length<1e5?(s.values.length===0?(s.values.length=s.points?s.points:1e3,s.values.fill(t[l][t[l].length-1]),s.firstWrite=true):s.firstWrite||(s.values.fill(t[l][t[l].length-1]),s.firstWrite=true),t[l].length===s.values.length?s.values=t[l]:y.circularBuffer(s.values,t[l])):typeof t[l]=="number"?(s.firstWrite||(s.values.fill(t[l]),s.firstWrite=true),s.values.push(t[l]),s.values.shift()):t[l]?.values&&(s.values.length===0?(s.values.length=s.points?s.points:1e3,s.values.fill(t[l].values[t[l].values.length-1]),s.firstWrite=true):s.firstWrite||(s.values.fill(t[l].values[t[l].values.length-1]),s.firstWrite=true),t[l].values.length===s.values.length?s.values=t[l].values:y.circularBuffer(s.values,t[l].values));s.values.length!==s.points&&(s.interpolate?s.values.length>s.points?s.values=y.downsample(s.values,s.points):s.scaled.length<s.points&&(s.values=y.upsample(s.values,s.points)):s.values.length>s.points?s.values.splice(0,s.values.length-s.points):s.values=new Array(s.points).fill(0).splice(s.points-s.values.length,0,s.values));let r=s.ymin,i2=s.ymax,u=s.values.length<=1e5;if(r===i2?(i2=u?Math.max(...s.values):1,r=u?Math.min(...s.values):0):isNaN(i2)&&(i2=u?Math.max(...s.values):1),isNaN(r)&&(r=u?Math.min(...s.values):0),r>i2){let g=r;i2=r,r=g}let c=Math.abs(r);s.absmax=c>i2?c:i2,s.autoscale?s.autoscale===2?s.scaled=y.autoscale(s.values,s.position,e.settings.nLines,s.centerZero,r,i2,s.clamp):(s.scaled=s.values,s.line.scaleY=y.getYScalar(s.values,e.settings.nLines,s.centerZero,r,i2),s.line.offsetY=y.getYOffset(s.position,e.settings.nLines,r,s.line.scaleY)):s.scaled=s.values,s.scaled.forEach((g,b)=>{!s.autoscale&&s.absmax>1?s.line.setY(b,g/s.absmax):s.line.setY(b,g)}),this.renderOverlay(o,a,e,s,l,i2,r)}}else e.settings.generateNewLines&&!l.includes("timestamp")&&(Array.isArray(t[l])&&(t[l]={values:t[l]}),!t[l].nSec&&!t[l].nPoints&&!e.settings.linePoints&&(t[l].nPoints=1e3),h=true);if(h)return e.settings.cleanGeneration||Object.keys(e.initial.lines).forEach(l=>{t[l]?t[l]=Object.assign(e.initial.lines[l],t[l]):t[l]=e.initial.lines[l]}),this.reinitPlot(e,{_id:e.settings._id,lines:t}),true}else for(let h in e.settings.lines){let l=e.settings.lines[h];this.renderOverlay(o,a,e,l,h,l.ymax,l.ymin)}return n&&requestAnimationFrame(e.anim),true}updateLine(e,t,n,o,a,h,l){return e.numPoints!==t.length&&(n?e.numPoints>t.length?t=y.downsample(t,e.numPoints):e.numPoints<t.length&&(t=y.upsample(t,e.numPoints)):t.length>e.numPoints?t=t.slice(t.length-e.numPoints):t=[...new Array(t.length).fill(0),...t]),o&&(t=y.autoscale(t,a,h,l)),t.forEach((s,r)=>e.setY(r,s)),true}formatTime(e){let t=Math.floor(e/60),n=Math.floor(t/60);t=t%60,e=e%60;let o="";return n>0&&(o+=n+":",t<10&&(o+="0")),o+=t+":",e>0&&(e<10&&(o+="0"),o+=e),o}static autoscale(e,t=0,n=1,o=false,a,h,l){if(e?.length===0)return e;let s=typeof h=="number"?h:e.length<=1e5?Math.max(...e):1,r=typeof a=="number"?a:e.length<=1e5?Math.min(...e):0,i2=1/n,u=1;if(o){let c=Math.max(Math.abs(r),Math.abs(s));return c!==0&&(u=i2/c),e.map(g=>(l&&(g<r&&(g=r),g>s&&(g=s)),g*u+(i2*(t+1)*2-1-i2)))}else return s===r?s!==0?u=i2/s:r!==0&&(u=i2/Math.abs(r)):u=i2/(s-r),e.map(c=>(l&&(c<r&&(c=r),c>s&&(c=s)),2*((c-r)*u-1/(2*n))+(i2*(t+1)*2-1-i2)))}static getYScalar(e,t=1,n=false,o,a){if(e?.length===0)return e;let h=typeof a=="number"?a:e.length<=1e5?Math.max(...e):1,l=typeof o=="number"?o:e.length<=1e5?Math.min(...e):0,s=1/t,r=1;if(n){let i2=Math.max(Math.abs(l),Math.abs(h));return i2!==0&&(r=s/i2),2*r}else return h===l?h!==0?r=s/h:l!==0&&(r=s/Math.abs(l)):r=s/(h-l),2*r}static getYOffset(e=0,t=1,n=0,o=1){let a=1/t,h=a*(e+1)*2-1-a;return n!==0?h-=n*o+1/t:h-=o+1/t,h}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t,n=1){if(e.length>t){let o=new Array(t),a=e.length/t,h=e.length-1,l=0,s=0;for(let r=a;r<e.length;r+=a){let i2=Math.round(r);i2>h&&(i2=h);for(let u=l;u<i2;u++)o[s]+=e[u];o[s]/=(i2-l)*n,s++,l=i2}return o}else return e}static upsample(e,t,n=1){var o=function(c,g,b){return(c+(g-c)*b)*n},a=new Array(t),h=(e.length-1)/(t-1);a[0]=e[0];for(var l=1;l<t-1;l++){var s=l*h,r=Math.floor(s),i2=Math.ceil(s),u=s-r;a[l]=o(e[r],e[i2],u)}return a[t-1]=e[e.length-1],a}static interpolate(e,t,n=1){return e.length>t?y.downsample(e,t,n):e.length<t?y.upsample(e,t,n):e}static HSLToRGB(e,t,n,o=255){t/=100,n/=100;let a=(1-Math.abs(2*n-1))*t,h=a*(1-Math.abs(e/60%2-1)),l=n-a/2,s=0,r=0,i2=0;return 0<=e&&e<60?(s=a,r=h,i2=0):60<=e&&e<120?(s=h,r=a,i2=0):120<=e&&e<180?(s=0,r=a,i2=h):180<=e&&e<240?(s=0,r=h,i2=a):240<=e&&e<300?(s=h,r=0,i2=a):300<=e&&e<360&&(s=a,r=0,i2=h),s=(s+l)*o,r=(r+l)*o,i2=(i2+l)*o,[s,r,i2]}static circularBuffer(e,t){if(t.length<e.length){let n=e.slice(t.length),o=e.length;e.splice(0,o,...n,...t)}else if(t.length>e.length){let n=e.length;e.splice(0,n,...t.slice(t.length-n))}else e.splice(0,e.length,...t);return e}static formatDataForCharts(e,t){if(Array.isArray(e)){if(Array.isArray(e[0])){let n={};if(e.forEach((o,a)=>{n[a]=o}),e=n,isNaN(e[0][0]))return}else if(t){if(e={[t]:e},isNaN(e[t][0]))return}else if(e={0:e},isNaN(e[0][0]))return}else if(typeof e=="object"){for(let n in e)if(typeof e[n]=="number"?e[n]=[e[n]]:e[n]?.values&&typeof e[n].values=="number"&&(e[n].values=[e[n].values]),isNaN(e[n][0]))return}else if(typeof e=="string"){let n;if(e.includes(`\\r\n`)){let o=e.split(`\\r\n`);e={},o.forEach((a,h)=>{a.includes("	")?n=a.split("	"):a.includes(",")?n=a.split(","):a.includes("|")&&(n=a.split("|")),n&&n.forEach((l,s)=>{if(l.includes(":")){let[r,i2]=l.split(":"),u=parseFloat(i2);isNaN(u)||(e[r]=[u])}else{let r=parseFloat(l);isNaN(r)||(e[s]=[r])}})})}else e.includes("	")?n=e.split("	"):e.includes(",")?n=e.split(","):e.includes("|")&&(n=e.split("|"));e={},n&&n.forEach((o,a)=>{if(o.includes(":")){let[h,l]=o.split(":"),s=parseFloat(l);isNaN(s)||(e[h]=[s])}else{let h=parseFloat(o);isNaN(h)||(e[a]=[h])}})}else typeof e=="number"&&(t?e={[t]:[e]}:e={0:[e]});return e}static padTime(e,t,n,o){let a=(e[0]-t)/n/o;return[...new Array(o-e.length).map((l,s)=>t+a*(s+1)),...e]}static interpolateForTime(e,t,n){return y.interpolate(e,Math.ceil(n*t))}};if(typeof WorkerGlobalScope!=="undefined"){globalThis.plotter=new y;const routes={...workerCanvasRoutes};self.onmessage=ev=>{if(ev.data.route){if(Array.isArray(ev.data.args)){routes[ev.data.route](...ev.data.args)}else routes[ev.data.route](ev.data.args)}}}var canvas_worker_default=self;})();\n',YAe=URL.createObjectURL(new globalThis.Blob([GAe],{type:"text/javascript"})),iv=YAe;var KAe=Object.create,q1=Object.defineProperty,XAe=Object.getOwnPropertyDescriptor,XY=Object.getOwnPropertyNames,ZAe=Object.getPrototypeOf,QAe=Object.prototype.hasOwnProperty,eIe=(e,t,r)=>t in e?q1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,tIe=(e=>typeof Mr<"u"?Mr:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof Mr<"u"?Mr:t)[r]}):e)(function(e){if(typeof Mr<"u")return Mr.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),rIe=(e,t)=>function(){return t||(0,e[XY(e)[0]])((t={exports:{}}).exports,t),t.exports},nIe=(e,t)=>{for(var r in t)q1(e,r,{get:t[r],enumerable:!0})},iIe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of XY(t))!QAe.call(e,i)&&i!==r&&q1(e,i,{get:()=>t[i],enumerable:!(n=XAe(t,i))||n.enumerable});return e},aIe=(e,t,r)=>(r=e!=null?KAe(ZAe(e)):{},iIe(t||!e||!e.__esModule?q1(r,"default",{value:e,enumerable:!0}):r,e)),ZY=(e,t,r)=>(eIe(e,typeof t!="symbol"?t+"":t,r),r),oIe=rIe({"struct/datastructures/bson.cjs"(e){"use strict";var t=5,r=2147483647,n=-2147483648,i=Math.pow(2,63)-1,a=-Math.pow(2,63),o=Math.pow(2,53),s=-Math.pow(2,53),l=1,c=2,f=3,u=4,h=5,g=6,_=7,w=8,E=9,S=10,A=11,O=12,C=13,T=14,D=15,P=16,z=17,ne=18,V=19,X=255,Q=127,ie=0,pe=4,de=Object.freeze({double:1,string:2,object:3,array:4,binData:5,undefined:6,objectId:7,bool:8,date:9,null:10,regex:11,dbPointer:12,javascript:13,symbol:14,javascriptWithScope:15,int:16,timestamp:17,long:18,decimal:19,minKey:-1,maxKey:127}),F=class extends Error{get bsonError(){return!0}get name(){return"BSONError"}constructor(m){super(m)}static isBSONError(m){return m!=null&&typeof m=="object"&&"bsonError"in m&&m.bsonError===!0&&"name"in m&&"message"in m&&"stack"in m}},H=class extends F{get name(){return"BSONVersionError"}constructor(){super(`Unsupported BSON version, bson types must be from bson ${t}.0 or later`)}},Z=class extends F{get name(){return"BSONRuntimeError"}constructor(m){super(m)}};function j(m){return q.fromNumberArray(Array.from({length:m},()=>Math.floor(Math.random()*256)))}var $=(()=>{try{return tIe("crypto").randomBytes}catch{return j}})(),q={toLocalBufferType(m){if(Buffer.isBuffer(m))return m;if(ArrayBuffer.isView(m))return Buffer.from(m.buffer,m.byteOffset,m.byteLength);let N=m?.[Symbol.toStringTag]??Object.prototype.toString.call(m);if(N==="ArrayBuffer"||N==="SharedArrayBuffer"||N==="[object ArrayBuffer]"||N==="[object SharedArrayBuffer]")return Buffer.from(m);throw new F(`Cannot create Buffer from ${String(m)}`)},allocate(m){return Buffer.alloc(m)},equals(m,N){return q.toLocalBufferType(m).equals(N)},fromNumberArray(m){return Buffer.from(m)},fromBase64(m){return Buffer.from(m,"base64")},toBase64(m){return q.toLocalBufferType(m).toString("base64")},fromISO88591(m){return Buffer.from(m,"binary")},toISO88591(m){return q.toLocalBufferType(m).toString("binary")},fromHex(m){return Buffer.from(m,"hex")},toHex(m){return q.toLocalBufferType(m).toString("hex")},fromUTF8(m){return Buffer.from(m,"utf8")},toUTF8(m){return q.toLocalBufferType(m).toString("utf8")},utf8ByteLength(m){return Buffer.byteLength(m,"utf8")},encodeUTF8Into(m,N,Y){return q.toLocalBufferType(m).write(N,Y,void 0,"utf8")},randomBytes:$};function ae(){let{navigator:m}=globalThis;return typeof m=="object"&&m.product==="ReactNative"}function le(m){if(m<0)throw new RangeError(`The argument 'byteLength' is invalid. Received ${m}`);return ke.fromNumberArray(Array.from({length:m},()=>Math.floor(Math.random()*256)))}var fe=(()=>{let{crypto:m}=globalThis;if(m!=null&&typeof m.getRandomValues=="function")return N=>m.getRandomValues(ke.allocate(N));if(ae()){let{console:N}=globalThis;N?.warn?.("BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.")}return le})(),Se=/(\d|[a-f])/i,ke={toLocalBufferType(m){let N=m?.[Symbol.toStringTag]??Object.prototype.toString.call(m);if(N==="Uint8Array")return m;if(ArrayBuffer.isView(m))return new Uint8Array(m.buffer.slice(m.byteOffset,m.byteOffset+m.byteLength));if(N==="ArrayBuffer"||N==="SharedArrayBuffer"||N==="[object ArrayBuffer]"||N==="[object SharedArrayBuffer]")return new Uint8Array(m);throw new F(`Cannot make a Uint8Array from ${String(m)}`)},allocate(m){if(typeof m!="number")throw new TypeError(`The "size" argument must be of type number. Received ${String(m)}`);return new Uint8Array(m)},equals(m,N){if(m.byteLength!==N.byteLength)return!1;for(let Y=0;Y<m.byteLength;Y++)if(m[Y]!==N[Y])return!1;return!0},fromNumberArray(m){return Uint8Array.from(m)},fromBase64(m){return Uint8Array.from(atob(m),N=>N.charCodeAt(0))},toBase64(m){return btoa(ke.toISO88591(m))},fromISO88591(m){return Uint8Array.from(m,N=>N.charCodeAt(0)&255)},toISO88591(m){return Array.from(Uint16Array.from(m),N=>String.fromCharCode(N)).join("")},fromHex(m){let N=m.length%2===0?m:m.slice(0,m.length-1),Y=[];for(let M=0;M<N.length;M+=2){let ve=N[M],Ce=N[M+1];if(!Se.test(ve)||!Se.test(Ce))break;let Le=Number.parseInt(`${ve}${Ce}`,16);Y.push(Le)}return Uint8Array.from(Y)},toHex(m){return Array.from(m,N=>N.toString(16).padStart(2,"0")).join("")},fromUTF8(m){return new TextEncoder().encode(m)},toUTF8(m){return new TextDecoder("utf8",{fatal:!1}).decode(m)},utf8ByteLength(m){return ke.fromUTF8(m).byteLength},encodeUTF8Into(m,N,Y){let M=ke.fromUTF8(N);return m.set(M,Y),M.byteLength},randomBytes:fe},xe=typeof Buffer=="function"&&Buffer.prototype?._isBuffer!==!0,se=xe?q:ke,be=class extends DataView{static fromUint8Array(m){return new DataView(m.buffer,m.byteOffset,m.byteLength)}},W=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,J=m=>typeof m=="string"&&W.test(m),re=m=>{if(!J(m))throw new F('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');let N=m.replace(/-/g,"");return se.fromHex(N)};function Ee(m,N=!0){return N?[se.toHex(m.subarray(0,4)),se.toHex(m.subarray(4,6)),se.toHex(m.subarray(6,8)),se.toHex(m.subarray(8,10)),se.toHex(m.subarray(10,16))].join("-"):se.toHex(m)}function Te(m){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(m))}function Ie(m){return Object.prototype.toString.call(m)==="[object Uint8Array]"}function Ye(m){return Object.prototype.toString.call(m)==="[object RegExp]"}function Ke(m){return Object.prototype.toString.call(m)==="[object Map]"}function St(m){return Object.prototype.toString.call(m)==="[object Date]"}var _t=class{get[Symbol.for("@@mdb.bson.version")](){return t}},ft=class extends _t{get _bsontype(){return"Binary"}constructor(m,N){if(super(),m!=null&&typeof m!="string"&&!ArrayBuffer.isView(m)&&!(m instanceof ArrayBuffer)&&!Array.isArray(m))throw new F("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=N??ft.BSON_BINARY_SUBTYPE_DEFAULT,m==null?(this.buffer=se.allocate(ft.BUFFER_SIZE),this.position=0):(typeof m=="string"?this.buffer=se.fromISO88591(m):Array.isArray(m)?this.buffer=se.fromNumberArray(m):this.buffer=se.toLocalBufferType(m),this.position=this.buffer.byteLength)}put(m){if(typeof m=="string"&&m.length!==1)throw new F("only accepts single character String");if(typeof m!="number"&&m.length!==1)throw new F("only accepts single character Uint8Array or Array");let N;if(typeof m=="string"?N=m.charCodeAt(0):typeof m=="number"?N=m:N=m[0],N<0||N>255)throw new F("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.byteLength>this.position)this.buffer[this.position++]=N;else{let Y=se.allocate(ft.BUFFER_SIZE+this.buffer.length);Y.set(this.buffer,0),this.buffer=Y,this.buffer[this.position++]=N}}write(m,N){if(N=typeof N=="number"?N:this.position,this.buffer.byteLength<N+m.length){let Y=se.allocate(this.buffer.byteLength+m.length);Y.set(this.buffer,0),this.buffer=Y}if(ArrayBuffer.isView(m))this.buffer.set(se.toLocalBufferType(m),N),this.position=N+m.byteLength>this.position?N+m.length:this.position;else if(typeof m=="string"){let Y=se.fromISO88591(m);this.buffer.set(Y,N),this.position=N+m.length>this.position?N+m.length:this.position}}read(m,N){return N=N&&N>0?N:this.position,this.buffer.slice(m,m+N)}value(m){return m=!!m,m&&this.buffer.length===this.position?this.buffer:m?this.buffer.slice(0,this.position):se.toISO88591(this.buffer.subarray(0,this.position))}length(){return this.position}toJSON(){return se.toBase64(this.buffer)}toString(m){return m==="hex"?se.toHex(this.buffer):m==="base64"?se.toBase64(this.buffer):m==="utf8"||m==="utf-8"?se.toUTF8(this.buffer):se.toUTF8(this.buffer)}toExtendedJSON(m){m=m||{};let N=se.toBase64(this.buffer),Y=Number(this.sub_type).toString(16);return m.legacy?{$binary:N,$type:Y.length===1?"0"+Y:Y}:{$binary:{base64:N,subType:Y.length===1?"0"+Y:Y}}}toUUID(){if(this.sub_type===ft.SUBTYPE_UUID)return new B(this.buffer.slice(0,this.position));throw new F(`Binary sub_type "${this.sub_type}" is not supported for converting to UUID. Only "${ft.SUBTYPE_UUID}" is currently supported.`)}static fromExtendedJSON(m,N){N=N||{};let Y,M;if("$binary"in m?N.legacy&&typeof m.$binary=="string"&&"$type"in m?(M=m.$type?parseInt(m.$type,16):0,Y=se.fromBase64(m.$binary)):typeof m.$binary!="string"&&(M=m.$binary.subType?parseInt(m.$binary.subType,16):0,Y=se.fromBase64(m.$binary.base64)):"$uuid"in m&&(M=4,Y=re(m.$uuid)),!Y)throw new F(`Unexpected Binary Extended JSON format ${JSON.stringify(m)}`);return M===pe?new B(Y):new ft(Y,M)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Binary(Buffer.from("${se.toHex(this.buffer)}", "hex"), ${this.sub_type})`}};ft.BSON_BINARY_SUBTYPE_DEFAULT=0,ft.BUFFER_SIZE=256,ft.SUBTYPE_DEFAULT=0,ft.SUBTYPE_FUNCTION=1,ft.SUBTYPE_BYTE_ARRAY=2,ft.SUBTYPE_UUID_OLD=3,ft.SUBTYPE_UUID=4,ft.SUBTYPE_MD5=5,ft.SUBTYPE_ENCRYPTED=6,ft.SUBTYPE_COLUMN=7,ft.SUBTYPE_USER_DEFINED=128;var ee=16,B=class extends ft{constructor(m){let N,Y;if(m==null)N=B.generate();else if(m instanceof B)N=se.toLocalBufferType(new Uint8Array(m.buffer)),Y=m.__id;else if(ArrayBuffer.isView(m)&&m.byteLength===ee)N=se.toLocalBufferType(m);else if(typeof m=="string")N=re(m);else throw new F("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");super(N,pe),this.__id=Y}get id(){return this.buffer}set id(m){this.buffer=m,B.cacheHexString&&(this.__id=Ee(m))}toHexString(m=!0){if(B.cacheHexString&&this.__id)return this.__id;let N=Ee(this.id,m);return B.cacheHexString&&(this.__id=N),N}toString(m){return m==="hex"?se.toHex(this.id):m==="base64"?se.toBase64(this.id):this.toHexString()}toJSON(){return this.toHexString()}equals(m){if(!m)return!1;if(m instanceof B)return se.equals(m.id,this.id);try{return se.equals(new B(m).id,this.id)}catch{return!1}}toBinary(){return new ft(this.id,ft.SUBTYPE_UUID)}static generate(){let m=se.randomBytes(ee);return m[6]=m[6]&15|64,m[8]=m[8]&63|128,m}static isValid(m){return m?m instanceof B?!0:typeof m=="string"?J(m):Ie(m)?m.byteLength!==ee?!1:(m[6]&240)===64&&(m[8]&128)===128:!1:!1}static createFromHexString(m){let N=re(m);return new B(N)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new UUID("${this.toHexString()}")`}},R=class extends _t{get _bsontype(){return"Code"}constructor(m,N){super(),this.code=m.toString(),this.scope=N??null}toJSON(){return this.scope!=null?{code:this.code,scope:this.scope}:{code:this.code}}toExtendedJSON(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}}static fromExtendedJSON(m){return new R(m.$code,m.$scope)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){let m=this.toJSON();return`new Code("${String(m.code)}"${m.scope!=null?`, ${JSON.stringify(m.scope)}`:""})`}};function te(m){return m!=null&&typeof m=="object"&&"$id"in m&&m.$id!=null&&"$ref"in m&&typeof m.$ref=="string"&&(!("$db"in m)||"$db"in m&&typeof m.$db=="string")}var we=class extends _t{get _bsontype(){return"DBRef"}constructor(m,N,Y,M){super();let ve=m.split(".");ve.length===2&&(Y=ve.shift(),m=ve.shift()),this.collection=m,this.oid=N,this.db=Y,this.fields=M||{}}get namespace(){return this.collection}set namespace(m){this.collection=m}toJSON(){let m=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(m.$db=this.db),m}toExtendedJSON(m){m=m||{};let N={$ref:this.collection,$id:this.oid};return m.legacy||(this.db&&(N.$db=this.db),N=Object.assign(N,this.fields)),N}static fromExtendedJSON(m){let N=Object.assign({},m);return delete N.$ref,delete N.$id,delete N.$db,new we(m.$ref,m.$id,m.$db,N)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){let m=this.oid===void 0||this.oid.toString===void 0?this.oid:this.oid.toString();return`new DBRef("${this.namespace}", new ObjectId("${String(m)}")${this.db?`, "${this.db}"`:""})`}},Ae=void 0;try{Ae=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}var Re=65536,It=1<<24,Pt=Re*Re,Gt=Pt*Pt,xr=Gt/2,zt={},Ei={},Xs=20,Xo=/^(\+?0|(\+|-)?[1-9][0-9]*)$/,he=class extends _t{get _bsontype(){return"Long"}get __isLong__(){return!0}constructor(m=0,N,Y){super(),typeof m=="bigint"?Object.assign(this,he.fromBigInt(m,!!N)):typeof m=="string"?Object.assign(this,he.fromString(m,!!N)):(this.low=m|0,this.high=N|0,this.unsigned=!!Y)}static fromBits(m,N,Y){return new he(m,N,Y)}static fromInt(m,N){let Y,M,ve;return N?(m>>>=0,(ve=0<=m&&m<256)&&(M=Ei[m],M)?M:(Y=he.fromBits(m,(m|0)<0?-1:0,!0),ve&&(Ei[m]=Y),Y)):(m|=0,(ve=-128<=m&&m<128)&&(M=zt[m],M)?M:(Y=he.fromBits(m,m<0?-1:0,!1),ve&&(zt[m]=Y),Y))}static fromNumber(m,N){if(isNaN(m))return N?he.UZERO:he.ZERO;if(N){if(m<0)return he.UZERO;if(m>=Gt)return he.MAX_UNSIGNED_VALUE}else{if(m<=-xr)return he.MIN_VALUE;if(m+1>=xr)return he.MAX_VALUE}return m<0?he.fromNumber(-m,N).neg():he.fromBits(m%Pt|0,m/Pt|0,N)}static fromBigInt(m,N){return he.fromString(m.toString(),N)}static fromString(m,N,Y){if(m.length===0)throw new F("empty string");if(m==="NaN"||m==="Infinity"||m==="+Infinity"||m==="-Infinity")return he.ZERO;if(typeof N=="number"?(Y=N,N=!1):N=!!N,Y=Y||10,Y<2||36<Y)throw new F("radix");let M;if((M=m.indexOf("-"))>0)throw new F("interior hyphen");if(M===0)return he.fromString(m.substring(1),N,Y).neg();let ve=he.fromNumber(Math.pow(Y,8)),Ce=he.ZERO;for(let Le=0;Le<m.length;Le+=8){let et=Math.min(8,m.length-Le),me=parseInt(m.substring(Le,Le+et),Y);if(et<8){let Xe=he.fromNumber(Math.pow(Y,et));Ce=Ce.mul(Xe).add(he.fromNumber(me))}else Ce=Ce.mul(ve),Ce=Ce.add(he.fromNumber(me))}return Ce.unsigned=N,Ce}static fromBytes(m,N,Y){return Y?he.fromBytesLE(m,N):he.fromBytesBE(m,N)}static fromBytesLE(m,N){return new he(m[0]|m[1]<<8|m[2]<<16|m[3]<<24,m[4]|m[5]<<8|m[6]<<16|m[7]<<24,N)}static fromBytesBE(m,N){return new he(m[4]<<24|m[5]<<16|m[6]<<8|m[7],m[0]<<24|m[1]<<16|m[2]<<8|m[3],N)}static isLong(m){return m!=null&&typeof m=="object"&&"__isLong__"in m&&m.__isLong__===!0}static fromValue(m,N){return typeof m=="number"?he.fromNumber(m,N):typeof m=="string"?he.fromString(m,N):he.fromBits(m.low,m.high,typeof N=="boolean"?N:m.unsigned)}add(m){he.isLong(m)||(m=he.fromValue(m));let N=this.high>>>16,Y=this.high&65535,M=this.low>>>16,ve=this.low&65535,Ce=m.high>>>16,Le=m.high&65535,et=m.low>>>16,me=m.low&65535,Xe=0,Be=0,Pe=0,$e=0;return $e+=ve+me,Pe+=$e>>>16,$e&=65535,Pe+=M+et,Be+=Pe>>>16,Pe&=65535,Be+=Y+Le,Xe+=Be>>>16,Be&=65535,Xe+=N+Ce,Xe&=65535,he.fromBits(Pe<<16|$e,Xe<<16|Be,this.unsigned)}and(m){return he.isLong(m)||(m=he.fromValue(m)),he.fromBits(this.low&m.low,this.high&m.high,this.unsigned)}compare(m){if(he.isLong(m)||(m=he.fromValue(m)),this.eq(m))return 0;let N=this.isNegative(),Y=m.isNegative();return N&&!Y?-1:!N&&Y?1:this.unsigned?m.high>>>0>this.high>>>0||m.high===this.high&&m.low>>>0>this.low>>>0?-1:1:this.sub(m).isNegative()?-1:1}comp(m){return this.compare(m)}divide(m){if(he.isLong(m)||(m=he.fromValue(m)),m.isZero())throw new F("division by zero");if(Ae){if(!this.unsigned&&this.high===-2147483648&&m.low===-1&&m.high===-1)return this;let ve=(this.unsigned?Ae.div_u:Ae.div_s)(this.low,this.high,m.low,m.high);return he.fromBits(ve,Ae.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?he.UZERO:he.ZERO;let N,Y,M;if(this.unsigned){if(m.unsigned||(m=m.toUnsigned()),m.gt(this))return he.UZERO;if(m.gt(this.shru(1)))return he.UONE;M=he.UZERO}else{if(this.eq(he.MIN_VALUE))return m.eq(he.ONE)||m.eq(he.NEG_ONE)?he.MIN_VALUE:m.eq(he.MIN_VALUE)?he.ONE:(N=this.shr(1).div(m).shl(1),N.eq(he.ZERO)?m.isNegative()?he.ONE:he.NEG_ONE:(Y=this.sub(m.mul(N)),M=N.add(Y.div(m)),M));if(m.eq(he.MIN_VALUE))return this.unsigned?he.UZERO:he.ZERO;if(this.isNegative())return m.isNegative()?this.neg().div(m.neg()):this.neg().div(m).neg();if(m.isNegative())return this.div(m.neg()).neg();M=he.ZERO}for(Y=this;Y.gte(m);){N=Math.max(1,Math.floor(Y.toNumber()/m.toNumber()));let ve=Math.ceil(Math.log(N)/Math.LN2),Ce=ve<=48?1:Math.pow(2,ve-48),Le=he.fromNumber(N),et=Le.mul(m);for(;et.isNegative()||et.gt(Y);)N-=Ce,Le=he.fromNumber(N,this.unsigned),et=Le.mul(m);Le.isZero()&&(Le=he.ONE),M=M.add(Le),Y=Y.sub(et)}return M}div(m){return this.divide(m)}equals(m){return he.isLong(m)||(m=he.fromValue(m)),this.unsigned!==m.unsigned&&this.high>>>31===1&&m.high>>>31===1?!1:this.high===m.high&&this.low===m.low}eq(m){return this.equals(m)}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative())return this.eq(he.MIN_VALUE)?64:this.neg().getNumBitsAbs();let m=this.high!==0?this.high:this.low,N;for(N=31;N>0&&!(m&1<<N);N--);return this.high!==0?N+33:N+1}greaterThan(m){return this.comp(m)>0}gt(m){return this.greaterThan(m)}greaterThanOrEqual(m){return this.comp(m)>=0}gte(m){return this.greaterThanOrEqual(m)}ge(m){return this.greaterThanOrEqual(m)}isEven(){return(this.low&1)===0}isNegative(){return!this.unsigned&&this.high<0}isOdd(){return(this.low&1)===1}isPositive(){return this.unsigned||this.high>=0}isZero(){return this.high===0&&this.low===0}lessThan(m){return this.comp(m)<0}lt(m){return this.lessThan(m)}lessThanOrEqual(m){return this.comp(m)<=0}lte(m){return this.lessThanOrEqual(m)}modulo(m){if(he.isLong(m)||(m=he.fromValue(m)),Ae){let N=(this.unsigned?Ae.rem_u:Ae.rem_s)(this.low,this.high,m.low,m.high);return he.fromBits(N,Ae.get_high(),this.unsigned)}return this.sub(this.div(m).mul(m))}mod(m){return this.modulo(m)}rem(m){return this.modulo(m)}multiply(m){if(this.isZero())return he.ZERO;if(he.isLong(m)||(m=he.fromValue(m)),Ae){let lt=Ae.mul(this.low,this.high,m.low,m.high);return he.fromBits(lt,Ae.get_high(),this.unsigned)}if(m.isZero())return he.ZERO;if(this.eq(he.MIN_VALUE))return m.isOdd()?he.MIN_VALUE:he.ZERO;if(m.eq(he.MIN_VALUE))return this.isOdd()?he.MIN_VALUE:he.ZERO;if(this.isNegative())return m.isNegative()?this.neg().mul(m.neg()):this.neg().mul(m).neg();if(m.isNegative())return this.mul(m.neg()).neg();if(this.lt(he.TWO_PWR_24)&&m.lt(he.TWO_PWR_24))return he.fromNumber(this.toNumber()*m.toNumber(),this.unsigned);let N=this.high>>>16,Y=this.high&65535,M=this.low>>>16,ve=this.low&65535,Ce=m.high>>>16,Le=m.high&65535,et=m.low>>>16,me=m.low&65535,Xe=0,Be=0,Pe=0,$e=0;return $e+=ve*me,Pe+=$e>>>16,$e&=65535,Pe+=M*me,Be+=Pe>>>16,Pe&=65535,Pe+=ve*et,Be+=Pe>>>16,Pe&=65535,Be+=Y*me,Xe+=Be>>>16,Be&=65535,Be+=M*et,Xe+=Be>>>16,Be&=65535,Be+=ve*Le,Xe+=Be>>>16,Be&=65535,Xe+=N*me+Y*et+M*Le+ve*Ce,Xe&=65535,he.fromBits(Pe<<16|$e,Xe<<16|Be,this.unsigned)}mul(m){return this.multiply(m)}negate(){return!this.unsigned&&this.eq(he.MIN_VALUE)?he.MIN_VALUE:this.not().add(he.ONE)}neg(){return this.negate()}not(){return he.fromBits(~this.low,~this.high,this.unsigned)}notEquals(m){return!this.equals(m)}neq(m){return this.notEquals(m)}ne(m){return this.notEquals(m)}or(m){return he.isLong(m)||(m=he.fromValue(m)),he.fromBits(this.low|m.low,this.high|m.high,this.unsigned)}shiftLeft(m){return he.isLong(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?he.fromBits(this.low<<m,this.high<<m|this.low>>>32-m,this.unsigned):he.fromBits(0,this.low<<m-32,this.unsigned)}shl(m){return this.shiftLeft(m)}shiftRight(m){return he.isLong(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?he.fromBits(this.low>>>m|this.high<<32-m,this.high>>m,this.unsigned):he.fromBits(this.high>>m-32,this.high>=0?0:-1,this.unsigned)}shr(m){return this.shiftRight(m)}shiftRightUnsigned(m){if(he.isLong(m)&&(m=m.toInt()),m&=63,m===0)return this;{let N=this.high;if(m<32){let Y=this.low;return he.fromBits(Y>>>m|N<<32-m,N>>>m,this.unsigned)}else return m===32?he.fromBits(N,0,this.unsigned):he.fromBits(N>>>m-32,0,this.unsigned)}}shr_u(m){return this.shiftRightUnsigned(m)}shru(m){return this.shiftRightUnsigned(m)}subtract(m){return he.isLong(m)||(m=he.fromValue(m)),this.add(m.neg())}sub(m){return this.subtract(m)}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){return this.unsigned?(this.high>>>0)*Pt+(this.low>>>0):this.high*Pt+(this.low>>>0)}toBigInt(){return BigInt(this.toString())}toBytes(m){return m?this.toBytesLE():this.toBytesBE()}toBytesLE(){let m=this.high,N=this.low;return[N&255,N>>>8&255,N>>>16&255,N>>>24,m&255,m>>>8&255,m>>>16&255,m>>>24]}toBytesBE(){let m=this.high,N=this.low;return[m>>>24,m>>>16&255,m>>>8&255,m&255,N>>>24,N>>>16&255,N>>>8&255,N&255]}toSigned(){return this.unsigned?he.fromBits(this.low,this.high,!1):this}toString(m){if(m=m||10,m<2||36<m)throw new F("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(he.MIN_VALUE)){let ve=he.fromNumber(m),Ce=this.div(ve),Le=Ce.mul(ve).sub(this);return Ce.toString(m)+Le.toInt().toString(m)}else return"-"+this.neg().toString(m);let N=he.fromNumber(Math.pow(m,6),this.unsigned),Y=this,M="";for(;;){let ve=Y.div(N),Le=(Y.sub(ve.mul(N)).toInt()>>>0).toString(m);if(Y=ve,Y.isZero())return Le+M;for(;Le.length<6;)Le="0"+Le;M=""+Le+M}}toUnsigned(){return this.unsigned?this:he.fromBits(this.low,this.high,!0)}xor(m){return he.isLong(m)||(m=he.fromValue(m)),he.fromBits(this.low^m.low,this.high^m.high,this.unsigned)}eqz(){return this.isZero()}le(m){return this.lessThanOrEqual(m)}toExtendedJSON(m){return m&&m.relaxed?this.toNumber():{$numberLong:this.toString()}}static fromExtendedJSON(m,N){let{useBigInt64:Y=!1,relaxed:M=!0}={...N};if(m.$numberLong.length>Xs)throw new F("$numberLong string is too long");if(!Xo.test(m.$numberLong))throw new F(`$numberLong string "${m.$numberLong}" is in an invalid format`);if(Y){let Ce=BigInt(m.$numberLong);return BigInt.asIntN(64,Ce)}let ve=he.fromString(m.$numberLong);return M?ve.toNumber():ve}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Long("${this.toString()}"${this.unsigned?", true":""})`}};he.TWO_PWR_24=he.fromInt(It),he.MAX_UNSIGNED_VALUE=he.fromBits(-1,-1,!0),he.ZERO=he.fromInt(0),he.UZERO=he.fromInt(0,!0),he.ONE=he.fromInt(1),he.UONE=he.fromInt(1,!0),he.NEG_ONE=he.fromInt(-1),he.MAX_VALUE=he.fromBits(-1,2147483647,!1),he.MIN_VALUE=he.fromBits(0,-2147483648,!1);var Xp=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,Zp=/^(\+|-)?(Infinity|inf)$/i,Qp=/^(\+|-)?NaN$/i,Oe=6111,tt=-6176,K=6176,at=34,Yt=se.fromNumberArray([124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),rt=se.fromNumberArray([248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),Pn=se.fromNumberArray([120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),it=/^([-+])?(\d+)?$/,Dr=31,Fe=16383,De=30,Zs=31;function ir(m){return!isNaN(parseInt(m,10))}function ct(m){let N=he.fromNumber(1e9),Y=he.fromNumber(0);if(!m.parts[0]&&!m.parts[1]&&!m.parts[2]&&!m.parts[3])return{quotient:m,rem:Y};for(let M=0;M<=3;M++)Y=Y.shiftLeft(32),Y=Y.add(new he(m.parts[M],0)),m.parts[M]=Y.div(N).low,Y=Y.modulo(N);return{quotient:m,rem:Y}}function Zo(m,N){if(!m&&!N)return{high:he.fromNumber(0),low:he.fromNumber(0)};let Y=m.shiftRightUnsigned(32),M=new he(m.getLowBits(),0),ve=N.shiftRightUnsigned(32),Ce=new he(N.getLowBits(),0),Le=Y.multiply(ve),et=Y.multiply(Ce),me=M.multiply(ve),Xe=M.multiply(Ce);return Le=Le.add(et.shiftRightUnsigned(32)),et=new he(et.getLowBits(),0).add(me).add(Xe.shiftRightUnsigned(32)),Le=Le.add(et.shiftRightUnsigned(32)),Xe=et.shiftLeft(32).add(new he(Xe.getLowBits(),0)),{high:Le,low:Xe}}function ja(m,N){let Y=m.high>>>0,M=N.high>>>0;if(Y<M)return!0;if(Y===M){let ve=m.low>>>0,Ce=N.low>>>0;if(ve<Ce)return!0}return!1}function Kt(m,N){throw new F(`"${m}" is not a valid Decimal128 string - ${N}`)}var xt=class extends _t{get _bsontype(){return"Decimal128"}constructor(m){if(super(),typeof m=="string")this.bytes=xt.fromString(m).bytes;else if(Ie(m)){if(m.byteLength!==16)throw new F("Decimal128 must take a Buffer of 16 bytes");this.bytes=m}else throw new F("Decimal128 must take a Buffer or string")}static fromString(m){let N=!1,Y=!1,M=!1,ve=0,Ce=0,Le=0,et=0,me=0,Xe=[0],Be=0,Pe=0,$e=0,lt=0,We=0,sn=0,Fn=new he(0,0),Zt=new he(0,0),Xr=0,st=0;if(m.length>=7e3)throw new F(""+m+" not a valid Decimal128 string");let ln=m.match(Xp),el=m.match(Zp),gc=m.match(Qp);if(!ln&&!el&&!gc||m.length===0)throw new F(""+m+" not a valid Decimal128 string");if(ln){let Ft=ln[2],Ct=ln[4],nt=ln[5],gt=ln[6];Ct&&gt===void 0&&Kt(m,"missing exponent power"),Ct&&Ft===void 0&&Kt(m,"missing exponent base"),Ct===void 0&&(nt||gt)&&Kt(m,"missing e before exponent")}if((m[st]==="+"||m[st]==="-")&&(N=m[st++]==="-"),!ir(m[st])&&m[st]!=="."){if(m[st]==="i"||m[st]==="I")return new xt(N?rt:Pn);if(m[st]==="N")return new xt(Yt)}for(;ir(m[st])||m[st]===".";){if(m[st]==="."){Y&&Kt(m,"contains multiple periods"),Y=!0,st=st+1;continue}Be<34&&(m[st]!=="0"||M)&&(M||(me=Ce),M=!0,Xe[Pe++]=parseInt(m[st],10),Be=Be+1),M&&(Le=Le+1),Y&&(et=et+1),Ce=Ce+1,st=st+1}if(Y&&!Ce)throw new F(""+m+" not a valid Decimal128 string");if(m[st]==="e"||m[st]==="E"){let Ft=m.substr(++st).match(it);if(!Ft||!Ft[2])return new xt(Yt);We=parseInt(Ft[0],10),st=st+Ft[0].length}if(m[st])return new xt(Yt);if($e=0,!Be)$e=0,lt=0,Xe[0]=0,Le=1,Be=1,ve=0;else if(lt=Be-1,ve=Le,ve!==1)for(;Xe[me+ve-1]===0;)ve=ve-1;for(We<=et&&et-We>16384?We=tt:We=We-et;We>Oe;){if(lt=lt+1,lt-$e>at){if(Xe.join("").match(/^0+$/)){We=Oe;break}Kt(m,"overflow")}We=We-1}for(;We<tt||Be<Le;){if(lt===0&&ve<Be){We=tt,ve=0;break}if(Be<Le?Le=Le-1:lt=lt-1,We<Oe)We=We+1;else{if(Xe.join("").match(/^0+$/)){We=Oe;break}Kt(m,"overflow")}}if(lt-$e+1<ve){let Ft=Ce;Y&&(me=me+1,Ft=Ft+1),N&&(me=me+1,Ft=Ft+1);let Ct=parseInt(m[me+lt+1],10),nt=0;if(Ct>=5&&(nt=1,Ct===5)){for(nt=Xe[lt]%2===1?1:0,sn=me+lt+2;sn<Ft;sn++)if(parseInt(m[sn],10)){nt=1;break}}if(nt){let gt=lt;for(;gt>=0;gt--)if(++Xe[gt]>9&&(Xe[gt]=0,gt===0))if(We<Oe)We=We+1,Xe[gt]=1;else return new xt(N?rt:Pn)}}if(Fn=he.fromNumber(0),Zt=he.fromNumber(0),ve===0)Fn=he.fromNumber(0),Zt=he.fromNumber(0);else if(lt-$e<17){let Ft=$e;for(Zt=he.fromNumber(Xe[Ft++]),Fn=new he(0,0);Ft<=lt;Ft++)Zt=Zt.multiply(he.fromNumber(10)),Zt=Zt.add(he.fromNumber(Xe[Ft]))}else{let Ft=$e;for(Fn=he.fromNumber(Xe[Ft++]);Ft<=lt-17;Ft++)Fn=Fn.multiply(he.fromNumber(10)),Fn=Fn.add(he.fromNumber(Xe[Ft]));for(Zt=he.fromNumber(Xe[Ft++]);Ft<=lt;Ft++)Zt=Zt.multiply(he.fromNumber(10)),Zt=Zt.add(he.fromNumber(Xe[Ft]))}let bt=Zo(Fn,he.fromString("100000000000000000"));bt.low=bt.low.add(Zt),ja(bt.low,Zt)&&(bt.high=bt.high.add(he.fromNumber(1))),Xr=We+K;let Ze={low:he.fromNumber(0),high:he.fromNumber(0)};bt.high.shiftRightUnsigned(49).and(he.fromNumber(1)).equals(he.fromNumber(1))?(Ze.high=Ze.high.or(he.fromNumber(3).shiftLeft(61)),Ze.high=Ze.high.or(he.fromNumber(Xr).and(he.fromNumber(16383).shiftLeft(47))),Ze.high=Ze.high.or(bt.high.and(he.fromNumber(0x7fffffffffff)))):(Ze.high=Ze.high.or(he.fromNumber(Xr&16383).shiftLeft(49)),Ze.high=Ze.high.or(bt.high.and(he.fromNumber(562949953421311)))),Ze.low=bt.low,N&&(Ze.high=Ze.high.or(he.fromString("9223372036854775808")));let or=se.allocate(16);return st=0,or[st++]=Ze.low.low&255,or[st++]=Ze.low.low>>8&255,or[st++]=Ze.low.low>>16&255,or[st++]=Ze.low.low>>24&255,or[st++]=Ze.low.high&255,or[st++]=Ze.low.high>>8&255,or[st++]=Ze.low.high>>16&255,or[st++]=Ze.low.high>>24&255,or[st++]=Ze.high.low&255,or[st++]=Ze.high.low>>8&255,or[st++]=Ze.high.low>>16&255,or[st++]=Ze.high.low>>24&255,or[st++]=Ze.high.high&255,or[st++]=Ze.high.high>>8&255,or[st++]=Ze.high.high>>16&255,or[st++]=Ze.high.high>>24&255,new xt(or)}toString(){let m,N=0,Y=new Array(36);for(let st=0;st<Y.length;st++)Y[st]=0;let M=0,ve=!1,Ce,Le={parts:[0,0,0,0]},et,me,Xe=[];M=0;let Be=this.bytes,Pe=Be[M++]|Be[M++]<<8|Be[M++]<<16|Be[M++]<<24,$e=Be[M++]|Be[M++]<<8|Be[M++]<<16|Be[M++]<<24,lt=Be[M++]|Be[M++]<<8|Be[M++]<<16|Be[M++]<<24,We=Be[M++]|Be[M++]<<8|Be[M++]<<16|Be[M++]<<24;M=0,{low:new he(Pe,$e),high:new he(lt,We)}.high.lessThan(he.ZERO)&&Xe.push("-");let Fn=We>>26&Dr;if(Fn>>3===3){if(Fn===De)return Xe.join("")+"Infinity";if(Fn===Zs)return"NaN";m=We>>15&Fe,Ce=8+(We>>14&1)}else Ce=We>>14&7,m=We>>17&Fe;let Zt=m-K;if(Le.parts[0]=(We&16383)+((Ce&15)<<14),Le.parts[1]=lt,Le.parts[2]=$e,Le.parts[3]=Pe,Le.parts[0]===0&&Le.parts[1]===0&&Le.parts[2]===0&&Le.parts[3]===0)ve=!0;else for(me=3;me>=0;me--){let st=0,ln=ct(Le);if(Le=ln.quotient,st=ln.rem.low,!!st)for(et=8;et>=0;et--)Y[me*9+et]=st%10,st=Math.floor(st/10)}if(ve)N=1,Y[M]=0;else for(N=36;!Y[M];)N=N-1,M=M+1;let Xr=N-1+Zt;if(Xr>=34||Xr<=-7||Zt>0){if(N>34)return Xe.push("0"),Zt>0?Xe.push(`E+${Zt}`):Zt<0&&Xe.push(`E${Zt}`),Xe.join("");Xe.push(`${Y[M++]}`),N=N-1,N&&Xe.push(".");for(let st=0;st<N;st++)Xe.push(`${Y[M++]}`);Xe.push("E"),Xr>0?Xe.push(`+${Xr}`):Xe.push(`${Xr}`)}else if(Zt>=0)for(let st=0;st<N;st++)Xe.push(`${Y[M++]}`);else{let st=N+Zt;if(st>0)for(let ln=0;ln<st;ln++)Xe.push(`${Y[M++]}`);else Xe.push("0");for(Xe.push(".");st++<0;)Xe.push("0");for(let ln=0;ln<N-Math.max(st-1,0);ln++)Xe.push(`${Y[M++]}`)}return Xe.join("")}toJSON(){return{$numberDecimal:this.toString()}}toExtendedJSON(){return{$numberDecimal:this.toString()}}static fromExtendedJSON(m){return xt.fromString(m.$numberDecimal)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Decimal128("${this.toString()}")`}},mr=class extends _t{get _bsontype(){return"Double"}constructor(m){super(),m instanceof Number&&(m=m.valueOf()),this.value=+m}valueOf(){return this.value}toJSON(){return this.value}toString(m){return this.value.toString(m)}toExtendedJSON(m){return m&&(m.legacy||m.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-0.0"}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}}static fromExtendedJSON(m,N){let Y=parseFloat(m.$numberDouble);return N&&N.relaxed?Y:new mr(Y)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Double(${this.toExtendedJSON().$numberDouble})`}},Br=class extends _t{get _bsontype(){return"Int32"}constructor(m){super(),m instanceof Number&&(m=m.valueOf()),this.value=+m|0}valueOf(){return this.value}toString(m){return this.value.toString(m)}toJSON(){return this.value}toExtendedJSON(m){return m&&(m.relaxed||m.legacy)?this.value:{$numberInt:this.value.toString()}}static fromExtendedJSON(m,N){return N&&N.relaxed?parseInt(m.$numberInt,10):new Br(m.$numberInt)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Int32(${this.valueOf()})`}},kr=class extends _t{get _bsontype(){return"MaxKey"}toExtendedJSON(){return{$maxKey:1}}static fromExtendedJSON(){return new kr}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return"new MaxKey()"}},Ji=class extends _t{get _bsontype(){return"MinKey"}toExtendedJSON(){return{$minKey:1}}static fromExtendedJSON(){return new Ji}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return"new MinKey()"}},Qo=new RegExp("^[0-9a-fA-F]{24}$"),Xt=null,Er=Symbol("id"),At=class extends _t{get _bsontype(){return"ObjectId"}constructor(m){super();let N;if(typeof m=="object"&&m&&"id"in m){if(typeof m.id!="string"&&!ArrayBuffer.isView(m.id))throw new F("Argument passed in must have an id that is of type string or Buffer");"toHexString"in m&&typeof m.toHexString=="function"?N=se.fromHex(m.toHexString()):N=m.id}else N=m;if(N==null||typeof N=="number")this[Er]=At.generate(typeof N=="number"?N:void 0);else if(ArrayBuffer.isView(N)&&N.byteLength===12)this[Er]=se.toLocalBufferType(N);else if(typeof N=="string")if(N.length===12){let Y=se.fromUTF8(N);if(Y.byteLength===12)this[Er]=Y;else throw new F("Argument passed in must be a string of 12 bytes")}else if(N.length===24&&Qo.test(N))this[Er]=se.fromHex(N);else throw new F("Argument passed in must be a string of 12 bytes or a string of 24 hex characters or an integer");else throw new F("Argument passed in does not match the accepted types");At.cacheHexString&&(this.__id=se.toHex(this.id))}get id(){return this[Er]}set id(m){this[Er]=m,At.cacheHexString&&(this.__id=se.toHex(m))}toHexString(){if(At.cacheHexString&&this.__id)return this.__id;let m=se.toHex(this.id);return At.cacheHexString&&!this.__id&&(this.__id=m),m}static getInc(){return At.index=(At.index+1)%16777215}static generate(m){typeof m!="number"&&(m=Math.floor(Date.now()/1e3));let N=At.getInc(),Y=se.allocate(12);return be.fromUint8Array(Y).setUint32(0,m,!1),Xt===null&&(Xt=se.randomBytes(5)),Y[4]=Xt[0],Y[5]=Xt[1],Y[6]=Xt[2],Y[7]=Xt[3],Y[8]=Xt[4],Y[11]=N&255,Y[10]=N>>8&255,Y[9]=N>>16&255,Y}toString(m){return m==="base64"?se.toBase64(this.id):m==="hex"?this.toHexString():this.toHexString()}toJSON(){return this.toHexString()}equals(m){if(m==null)return!1;if(m instanceof At)return this[Er][11]===m[Er][11]&&se.equals(this[Er],m[Er]);if(typeof m=="string"&&At.isValid(m)&&m.length===12&&Ie(this.id))return se.equals(this.id,se.fromISO88591(m));if(typeof m=="string"&&At.isValid(m)&&m.length===24)return m.toLowerCase()===this.toHexString();if(typeof m=="string"&&At.isValid(m)&&m.length===12)return se.equals(se.fromUTF8(m),this.id);if(typeof m=="object"&&"toHexString"in m&&typeof m.toHexString=="function"){let N=m.toHexString(),Y=this.toHexString().toLowerCase();return typeof N=="string"&&N.toLowerCase()===Y}return!1}getTimestamp(){let m=new Date,N=be.fromUint8Array(this.id).getUint32(0,!1);return m.setTime(Math.floor(N)*1e3),m}static createPk(){return new At}static createFromTime(m){let N=se.fromNumberArray([0,0,0,0,0,0,0,0,0,0,0,0]);return be.fromUint8Array(N).setUint32(0,m,!1),new At(N)}static createFromHexString(m){if(typeof m>"u"||m!=null&&m.length!==24)throw new F("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new At(se.fromHex(m))}static isValid(m){if(m==null)return!1;try{return new At(m),!0}catch{return!1}}toExtendedJSON(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}}static fromExtendedJSON(m){return new At(m.$oid)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new ObjectId("${this.toHexString()}")`}};At.index=Math.floor(Math.random()*16777215);function Wn(m,N,Y){let M=5;if(Array.isArray(m))for(let ve=0;ve<m.length;ve++)M+=ui(ve.toString(),m[ve],N,!0,Y);else{typeof m?.toBSON=="function"&&(m=m.toBSON());for(let ve of Object.keys(m))M+=ui(ve,m[ve],N,!1,Y)}return M}function ui(m,N,Y=!1,M=!1,ve=!1){switch(typeof N?.toBSON=="function"&&(N=N.toBSON()),typeof N){case"string":return 1+se.utf8ByteLength(m)+1+4+se.utf8ByteLength(N)+1;case"number":return Math.floor(N)===N&&N>=s&&N<=o&&N>=n&&N<=r?(m!=null?se.utf8ByteLength(m)+1:0)+(4+1):(m!=null?se.utf8ByteLength(m)+1:0)+(8+1);case"undefined":return M||!ve?(m!=null?se.utf8ByteLength(m)+1:0)+1:0;case"boolean":return(m!=null?se.utf8ByteLength(m)+1:0)+(1+1);case"object":if(N!=null&&typeof N._bsontype=="string"&&N[Symbol.for("@@mdb.bson.version")]!==t)throw new H;if(N==null||N._bsontype==="MinKey"||N._bsontype==="MaxKey")return(m!=null?se.utf8ByteLength(m)+1:0)+1;if(N._bsontype==="ObjectId")return(m!=null?se.utf8ByteLength(m)+1:0)+(12+1);if(N instanceof Date||St(N))return(m!=null?se.utf8ByteLength(m)+1:0)+(8+1);if(ArrayBuffer.isView(N)||N instanceof ArrayBuffer||Te(N))return(m!=null?se.utf8ByteLength(m)+1:0)+(1+4+1)+N.byteLength;if(N._bsontype==="Long"||N._bsontype==="Double"||N._bsontype==="Timestamp")return(m!=null?se.utf8ByteLength(m)+1:0)+(8+1);if(N._bsontype==="Decimal128")return(m!=null?se.utf8ByteLength(m)+1:0)+(16+1);if(N._bsontype==="Code")return N.scope!=null&&Object.keys(N.scope).length>0?(m!=null?se.utf8ByteLength(m)+1:0)+1+4+4+se.utf8ByteLength(N.code.toString())+1+Wn(N.scope,Y,ve):(m!=null?se.utf8ByteLength(m)+1:0)+1+4+se.utf8ByteLength(N.code.toString())+1;if(N._bsontype==="Binary"){let Ce=N;return Ce.sub_type===ft.SUBTYPE_BYTE_ARRAY?(m!=null?se.utf8ByteLength(m)+1:0)+(Ce.position+1+4+1+4):(m!=null?se.utf8ByteLength(m)+1:0)+(Ce.position+1+4+1)}else{if(N._bsontype==="Symbol")return(m!=null?se.utf8ByteLength(m)+1:0)+se.utf8ByteLength(N.value)+4+1+1;if(N._bsontype==="DBRef"){let Ce=Object.assign({$ref:N.collection,$id:N.oid},N.fields);return N.db!=null&&(Ce.$db=N.db),(m!=null?se.utf8ByteLength(m)+1:0)+1+Wn(Ce,Y,ve)}else return N instanceof RegExp||Ye(N)?(m!=null?se.utf8ByteLength(m)+1:0)+1+se.utf8ByteLength(N.source)+1+(N.global?1:0)+(N.ignoreCase?1:0)+(N.multiline?1:0)+1:N._bsontype==="BSONRegExp"?(m!=null?se.utf8ByteLength(m)+1:0)+1+se.utf8ByteLength(N.pattern)+1+se.utf8ByteLength(N.options)+1:(m!=null?se.utf8ByteLength(m)+1:0)+Wn(N,Y,ve)+1}case"function":if(Y)return(m!=null?se.utf8ByteLength(m)+1:0)+1+4+se.utf8ByteLength(N.toString())+1}return 0}function Wu(m){return m.split("").sort().join("")}var Oi=class extends _t{get _bsontype(){return"BSONRegExp"}constructor(m,N){if(super(),this.pattern=m,this.options=Wu(N??""),this.pattern.indexOf("\0")!==-1)throw new F(`BSON Regex patterns cannot contain null bytes, found: ${JSON.stringify(this.pattern)}`);if(this.options.indexOf("\0")!==-1)throw new F(`BSON Regex options cannot contain null bytes, found: ${JSON.stringify(this.options)}`);for(let Y=0;Y<this.options.length;Y++)if(!(this.options[Y]==="i"||this.options[Y]==="m"||this.options[Y]==="x"||this.options[Y]==="l"||this.options[Y]==="s"||this.options[Y]==="u"))throw new F(`The regular expression option [${this.options[Y]}] is not supported`)}static parseOptions(m){return m?m.split("").sort().join(""):""}toExtendedJSON(m){return m=m||{},m.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}}static fromExtendedJSON(m){if("$regex"in m)if(typeof m.$regex!="string"){if(m.$regex._bsontype==="BSONRegExp")return m}else return new Oi(m.$regex,Oi.parseOptions(m.$options));if("$regularExpression"in m)return new Oi(m.$regularExpression.pattern,Oi.parseOptions(m.$regularExpression.options));throw new F(`Unexpected BSONRegExp EJSON object form: ${JSON.stringify(m)}`)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new BSONRegExp(${JSON.stringify(this.pattern)}, ${JSON.stringify(this.options)})`}},es=class extends _t{get _bsontype(){return"BSONSymbol"}constructor(m){super(),this.value=m}valueOf(){return this.value}toString(){return this.value}inspect(){return`new BSONSymbol("${this.value}")`}toJSON(){return this.value}toExtendedJSON(){return{$symbol:this.value}}static fromExtendedJSON(m){return new es(m.$symbol)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}},Q1=he,Ai=class extends Q1{get _bsontype(){return"Timestamp"}constructor(m){if(m==null)super(0,0,!0);else if(typeof m=="bigint")super(m,!0);else if(he.isLong(m))super(m.low,m.high,!0);else if(typeof m=="object"&&"t"in m&&"i"in m){if(typeof m.t!="number"&&(typeof m.t!="object"||m.t._bsontype!=="Int32"))throw new F("Timestamp constructed from { t, i } must provide t as a number");if(typeof m.i!="number"&&(typeof m.i!="object"||m.i._bsontype!=="Int32"))throw new F("Timestamp constructed from { t, i } must provide i as a number");if(m.t<0)throw new F("Timestamp constructed from { t, i } must provide a positive t");if(m.i<0)throw new F("Timestamp constructed from { t, i } must provide a positive i");if(m.t>4294967295)throw new F("Timestamp constructed from { t, i } must provide t equal or less than uint32 max");if(m.i>4294967295)throw new F("Timestamp constructed from { t, i } must provide i equal or less than uint32 max");super(m.i.valueOf(),m.t.valueOf(),!0)}else throw new F("A Timestamp can only be constructed with: bigint, Long, or { t: number; i: number }")}toJSON(){return{$timestamp:this.toString()}}static fromInt(m){return new Ai(he.fromInt(m,!0))}static fromNumber(m){return new Ai(he.fromNumber(m,!0))}static fromBits(m,N){return new Ai({i:m,t:N})}static fromString(m,N){return new Ai(he.fromString(m,!0,N))}toExtendedJSON(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}}static fromExtendedJSON(m){let N=he.isLong(m.$timestamp.i)?m.$timestamp.i.getLowBitsUnsigned():m.$timestamp.i,Y=he.isLong(m.$timestamp.t)?m.$timestamp.t.getLowBitsUnsigned():m.$timestamp.t;return new Ai({t:Y,i:N})}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Timestamp({ t: ${this.getHighBits()}, i: ${this.getLowBits()} })`}};Ai.MAX_VALUE=he.MAX_UNSIGNED_VALUE;var eS=128,tS=192,rS=224,nS=240,iS=248,aS=192,oS=224,sS=240,lS=128;function uv(m,N,Y){let M=0;for(let ve=N;ve<Y;ve+=1){let Ce=m[ve];if(M){if((Ce&tS)!==lS)return!1;M-=1}else if(Ce&eS)if((Ce&rS)===aS)M=1;else if((Ce&nS)===oS)M=2;else if((Ce&iS)===sS)M=3;else return!1}return!M}var cS=he.fromNumber(o),uS=he.fromNumber(s);function fv(m,N,Y){N=N??{};let M=N&&N.index?N.index:0,ve=m[M]|m[M+1]<<8|m[M+2]<<16|m[M+3]<<24;if(ve<5)throw new F(`bson size must be >= 5, is ${ve}`);if(N.allowObjectSmallerThanBufferSize&&m.length<ve)throw new F(`buffer length ${m.length} must be >= bson size ${ve}`);if(!N.allowObjectSmallerThanBufferSize&&m.length!==ve)throw new F(`buffer length ${m.length} must === bson size ${ve}`);if(ve+M>m.byteLength)throw new F(`(bson size ${ve} + options.index ${M} must be <= buffer length ${m.byteLength})`);if(m[M+ve-1]!==0)throw new F("One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00");return Ju(m,M,N,Y)}var fS=/^\$ref$|^\$id$|^\$db$/;function Ju(m,N,Y,M=!1){let ve=Y.fieldsAsRaw==null?null:Y.fieldsAsRaw,Ce=Y.raw==null?!1:Y.raw,Le=typeof Y.bsonRegExp=="boolean"?Y.bsonRegExp:!1,et=Y.promoteBuffers??!1,me=Y.promoteLongs??!0,Xe=Y.promoteValues??!0,Be=Y.useBigInt64??!1;if(Be&&!Xe)throw new F("Must either request bigint or Long for int64 deserialization");if(Be&&!me)throw new F("Must either request bigint or Long for int64 deserialization");let Pe=Y.validation==null?{utf8:!0}:Y.validation,$e=!0,lt,We=new Set,sn=Pe.utf8;if(typeof sn=="boolean")lt=sn;else{$e=!1;let bt=Object.keys(sn).map(function(Ze){return sn[Ze]});if(bt.length===0)throw new F("UTF-8 validation setting cannot be empty");if(typeof bt[0]!="boolean")throw new F("Invalid UTF-8 validation option, must specify boolean values");if(lt=bt[0],!bt.every(Ze=>Ze===lt))throw new F("Invalid UTF-8 validation option - keys must be all true or all false")}if(!$e)for(let bt of Object.keys(sn))We.add(bt);let Fn=N;if(m.length<5)throw new F("corrupt bson message < 5 bytes long");let Zt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(Zt<5||Zt>m.length)throw new F("corrupt bson message");let Xr=M?[]:{},st=0,ln=!1,el=M?!1:null,gc=new DataView(m.buffer,m.byteOffset,m.byteLength);for(;!ln;){let bt=m[N++];if(bt===0)break;let Ze=N;for(;m[Ze]!==0&&Ze<m.length;)Ze++;if(Ze>=m.byteLength)throw new F("Bad BSON Document: illegal CString");let or=M?st++:se.toUTF8(m.subarray(N,Ze)),Ft=!0;$e||We.has(or)?Ft=lt:Ft=!lt,el!==!1&&or[0]==="$"&&(el=fS.test(or));let Ct;if(N=Ze+1,bt===c){let nt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(nt<=0||nt>m.length-N||m[N+nt-1]!==0)throw new F("bad string length in bson");Ct=Gu(m,N,N+nt-1,Ft),N=N+nt}else if(bt===_){let nt=se.allocate(12);nt.set(m.subarray(N,N+12)),Ct=new At(nt),N=N+12}else if(bt===P&&Xe===!1)Ct=new Br(m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24);else if(bt===P)Ct=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;else if(bt===l&&Xe===!1)Ct=new mr(gc.getFloat64(N,!0)),N=N+8;else if(bt===l)Ct=gc.getFloat64(N,!0),N=N+8;else if(bt===E){let nt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,gt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;Ct=new Date(new he(nt,gt).toNumber())}else if(bt===w){if(m[N]!==0&&m[N]!==1)throw new F("illegal boolean type value");Ct=m[N++]===1}else if(bt===f){let nt=N,gt=m[N]|m[N+1]<<8|m[N+2]<<16|m[N+3]<<24;if(gt<=0||gt>m.length-N)throw new F("bad embedded document length in bson");if(Ce)Ct=m.slice(N,N+gt);else{let er=Y;$e||(er={...Y,validation:{utf8:Ft}}),Ct=Ju(m,nt,er,!1)}N=N+gt}else if(bt===u){let nt=N,gt=m[N]|m[N+1]<<8|m[N+2]<<16|m[N+3]<<24,er=Y,Dn=N+gt;if(ve&&ve[or]&&(er={...Y,raw:!0}),$e||(er={...er,validation:{utf8:Ft}}),Ct=Ju(m,nt,er,!0),N=N+gt,m[N-1]!==0)throw new F("invalid array terminator byte");if(N!==Dn)throw new F("corrupted array bson")}else if(bt===g)Ct=void 0;else if(bt===S)Ct=null;else if(bt===ne){let nt=be.fromUint8Array(m.subarray(N,N+8)),gt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,er=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,Dn=new he(gt,er);Be?Ct=nt.getBigInt64(0,!0):me&&Xe===!0?Ct=Dn.lessThanOrEqual(cS)&&Dn.greaterThanOrEqual(uS)?Dn.toNumber():Dn:Ct=Dn}else if(bt===V){let nt=se.allocate(16);nt.set(m.subarray(N,N+16),0),N=N+16,Ct=new xt(nt)}else if(bt===h){let nt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,gt=nt,er=m[N++];if(nt<0)throw new F("Negative binary type element size found");if(nt>m.byteLength)throw new F("Binary type size larger than document size");if(m.slice!=null){if(er===ft.SUBTYPE_BYTE_ARRAY){if(nt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,nt<0)throw new F("Negative binary type element size found for subtype 0x02");if(nt>gt-4)throw new F("Binary type with subtype 0x02 contains too long binary size");if(nt<gt-4)throw new F("Binary type with subtype 0x02 contains too short binary size")}et&&Xe?Ct=se.toLocalBufferType(m.slice(N,N+nt)):(Ct=new ft(m.slice(N,N+nt),er),er===pe&&(Ct=Ct.toUUID()))}else{let Dn=se.allocate(nt);if(er===ft.SUBTYPE_BYTE_ARRAY){if(nt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,nt<0)throw new F("Negative binary type element size found for subtype 0x02");if(nt>gt-4)throw new F("Binary type with subtype 0x02 contains too long binary size");if(nt<gt-4)throw new F("Binary type with subtype 0x02 contains too short binary size")}for(Ze=0;Ze<nt;Ze++)Dn[Ze]=m[N+Ze];et&&Xe?Ct=Dn:er===pe?Ct=new ft(m.slice(N,N+nt),er).toUUID():Ct=new ft(m.slice(N,N+nt),er)}N=N+nt}else if(bt===A&&Le===!1){for(Ze=N;m[Ze]!==0&&Ze<m.length;)Ze++;if(Ze>=m.length)throw new F("Bad BSON Document: illegal CString");let nt=se.toUTF8(m.subarray(N,Ze));for(N=Ze+1,Ze=N;m[Ze]!==0&&Ze<m.length;)Ze++;if(Ze>=m.length)throw new F("Bad BSON Document: illegal CString");let gt=se.toUTF8(m.subarray(N,Ze));N=Ze+1;let er=new Array(gt.length);for(Ze=0;Ze<gt.length;Ze++)switch(gt[Ze]){case"m":er[Ze]="m";break;case"s":er[Ze]="g";break;case"i":er[Ze]="i";break}Ct=new RegExp(nt,er.join(""))}else if(bt===A&&Le===!0){for(Ze=N;m[Ze]!==0&&Ze<m.length;)Ze++;if(Ze>=m.length)throw new F("Bad BSON Document: illegal CString");let nt=se.toUTF8(m.subarray(N,Ze));for(N=Ze+1,Ze=N;m[Ze]!==0&&Ze<m.length;)Ze++;if(Ze>=m.length)throw new F("Bad BSON Document: illegal CString");let gt=se.toUTF8(m.subarray(N,Ze));N=Ze+1,Ct=new Oi(nt,gt)}else if(bt===T){let nt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(nt<=0||nt>m.length-N||m[N+nt-1]!==0)throw new F("bad string length in bson");let gt=Gu(m,N,N+nt-1,Ft);Ct=Xe?gt:new es(gt),N=N+nt}else if(bt===z){let nt=m[N++]+m[N++]*256+m[N++]*65536+m[N++]*16777216,gt=m[N++]+m[N++]*256+m[N++]*65536+m[N++]*(1<<24);Ct=new Ai({i:nt,t:gt})}else if(bt===X)Ct=new Ji;else if(bt===Q)Ct=new kr;else if(bt===C){let nt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(nt<=0||nt>m.length-N||m[N+nt-1]!==0)throw new F("bad string length in bson");let gt=Gu(m,N,N+nt-1,Ft);Ct=new R(gt),N=N+nt}else if(bt===D){let nt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(nt<4+4+4+1)throw new F("code_w_scope total size shorter minimum expected length");let gt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(gt<=0||gt>m.length-N||m[N+gt-1]!==0)throw new F("bad string length in bson");let er=Gu(m,N,N+gt-1,Ft);N=N+gt;let Dn=N,tf=m[N]|m[N+1]<<8|m[N+2]<<16|m[N+3]<<24,rf=Ju(m,Dn,Y,!1);if(N=N+tf,nt<4+4+tf+gt)throw new F("code_w_scope total size is too short, truncating scope");if(nt>4+4+tf+gt)throw new F("code_w_scope total size is too long, clips outer document");Ct=new R(er,rf)}else if(bt===O){let nt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(nt<=0||nt>m.length-N||m[N+nt-1]!==0)throw new F("bad string length in bson");if(Pe!=null&&Pe.utf8&&!uv(m,N,N+nt-1))throw new F("Invalid UTF-8 string in BSON document");let gt=se.toUTF8(m.subarray(N,N+nt-1));N=N+nt;let er=se.allocate(12);er.set(m.subarray(N,N+12),0);let Dn=new At(er);N=N+12,Ct=new we(gt,Dn)}else throw new F(`Detected unknown BSON type ${bt.toString(16)} for fieldname "${or}"`);or==="__proto__"?Object.defineProperty(Xr,or,{value:Ct,writable:!0,enumerable:!0,configurable:!0}):Xr[or]=Ct}if(Zt!==N-Fn)throw M?new F("corrupt array bson"):new F("corrupt object bson");if(!el)return Xr;if(te(Xr)){let bt=Object.assign({},Xr);return delete bt.$ref,delete bt.$id,delete bt.$db,new we(Xr.$ref,Xr.$id,Xr.$db,bt)}return Xr}function Gu(m,N,Y,M){let ve=se.toUTF8(m.subarray(N,Y));if(M){for(let Ce=0;Ce<ve.length;Ce++)if(ve.charCodeAt(Ce)===65533){if(!uv(m,N,Y))throw new F("Invalid UTF-8 string in BSON document");break}}return ve}var Yu=/\x00/,dv=new Set(["$db","$ref","$id","$clusterTime"]);function eh(m,N,Y,M){m[M++]=c;let ve=se.encodeUTF8Into(m,N,M);M=M+ve+1,m[M-1]=0;let Ce=se.encodeUTF8Into(m,Y,M+4);return m[M+3]=Ce+1>>24&255,m[M+2]=Ce+1>>16&255,m[M+1]=Ce+1>>8&255,m[M]=Ce+1&255,M=M+4+Ce,m[M++]=0,M}var Qs=new DataView(new ArrayBuffer(8),0,8),dS=new Uint8Array(Qs.buffer,0,4),Ku=new Uint8Array(Qs.buffer,0,8);function th(m,N,Y,M){let Ce=!Object.is(Y,-0)&&Number.isSafeInteger(Y)&&Y<=r&&Y>=n?P:l;Ce===P?Qs.setInt32(0,Y,!0):Qs.setFloat64(0,Y,!0);let Le=Ce===P?dS:Ku;m[M++]=Ce;let et=se.encodeUTF8Into(m,N,M);return M=M+et,m[M++]=0,m.set(Le,M),M+=Le.byteLength,M}function rh(m,N,Y,M){m[M++]=ne;let ve=se.encodeUTF8Into(m,N,M);return M+=ve,m[M++]=0,Qs.setBigInt64(0,Y,!0),m.set(Ku,M),M+=Ku.byteLength,M}function dc(m,N,Y,M){m[M++]=S;let ve=se.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,M}function nh(m,N,Y,M){m[M++]=w;let ve=se.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,m[M++]=Y?1:0,M}function ih(m,N,Y,M){m[M++]=E;let ve=se.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ce=he.fromNumber(Y.getTime()),Le=Ce.getLowBits(),et=Ce.getHighBits();return m[M++]=Le&255,m[M++]=Le>>8&255,m[M++]=Le>>16&255,m[M++]=Le>>24&255,m[M++]=et&255,m[M++]=et>>8&255,m[M++]=et>>16&255,m[M++]=et>>24&255,M}function ah(m,N,Y,M){m[M++]=A;let ve=se.encodeUTF8Into(m,N,M);if(M=M+ve,m[M++]=0,Y.source&&Y.source.match(Yu)!=null)throw new F("value "+Y.source+" must not contain null bytes");return M=M+se.encodeUTF8Into(m,Y.source,M),m[M++]=0,Y.ignoreCase&&(m[M++]=105),Y.global&&(m[M++]=115),Y.multiline&&(m[M++]=109),m[M++]=0,M}function oh(m,N,Y,M){m[M++]=A;let ve=se.encodeUTF8Into(m,N,M);if(M=M+ve,m[M++]=0,Y.pattern.match(Yu)!=null)throw new F("pattern "+Y.pattern+" must not contain null bytes");M=M+se.encodeUTF8Into(m,Y.pattern,M),m[M++]=0;let Ce=Y.options.split("").sort().join("");return M=M+se.encodeUTF8Into(m,Ce,M),m[M++]=0,M}function ar(m,N,Y,M){Y===null?m[M++]=S:Y._bsontype==="MinKey"?m[M++]=X:m[M++]=Q;let ve=se.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,M}function sh(m,N,Y,M){m[M++]=_;let ve=se.encodeUTF8Into(m,N,M);if(M=M+ve,m[M++]=0,Ie(Y.id))m.set(Y.id.subarray(0,12),M);else throw new F("object ["+JSON.stringify(Y)+"] is not a valid ObjectId");return M+12}function lh(m,N,Y,M){m[M++]=h;let ve=se.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ce=Y.length;return m[M++]=Ce&255,m[M++]=Ce>>8&255,m[M++]=Ce>>16&255,m[M++]=Ce>>24&255,m[M++]=ie,m.set(Y,M),M=M+Ce,M}function Xu(m,N,Y,M,ve,Ce,Le,et,me){if(me.has(Y))throw new F("Cannot convert circular structure to BSON");me.add(Y),m[M++]=Array.isArray(Y)?u:f;let Xe=se.encodeUTF8Into(m,N,M);M=M+Xe,m[M++]=0;let Be=hc(m,Y,ve,M,Ce+1,Le,et,me);return me.delete(Y),Be}function Zu(m,N,Y,M){m[M++]=V;let ve=se.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,m.set(Y.bytes.subarray(0,16),M),M+16}function ch(m,N,Y,M){m[M++]=Y._bsontype==="Long"?ne:z;let ve=se.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ce=Y.getLowBits(),Le=Y.getHighBits();return m[M++]=Ce&255,m[M++]=Ce>>8&255,m[M++]=Ce>>16&255,m[M++]=Ce>>24&255,m[M++]=Le&255,m[M++]=Le>>8&255,m[M++]=Le>>16&255,m[M++]=Le>>24&255,M}function pc(m,N,Y,M){Y=Y.valueOf(),m[M++]=P;let ve=se.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,m[M++]=Y&255,m[M++]=Y>>8&255,m[M++]=Y>>16&255,m[M++]=Y>>24&255,M}function Qu(m,N,Y,M){m[M++]=l;let ve=se.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,Qs.setFloat64(0,Y.value,!0),m.set(Ku,M),M=M+8,M}function ef(m,N,Y,M){m[M++]=C;let ve=se.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ce=Y.toString(),Le=se.encodeUTF8Into(m,Ce,M+4)+1;return m[M]=Le&255,m[M+1]=Le>>8&255,m[M+2]=Le>>16&255,m[M+3]=Le>>24&255,M=M+4+Le-1,m[M++]=0,M}function uh(m,N,Y,M,ve=!1,Ce=0,Le=!1,et=!0,me){if(Y.scope&&typeof Y.scope=="object"){m[M++]=D;let Xe=se.encodeUTF8Into(m,N,M);M=M+Xe,m[M++]=0;let Be=M,Pe=Y.code;M=M+4;let $e=se.encodeUTF8Into(m,Pe,M+4)+1;m[M]=$e&255,m[M+1]=$e>>8&255,m[M+2]=$e>>16&255,m[M+3]=$e>>24&255,m[M+4+$e-1]=0,M=M+$e+4;let lt=hc(m,Y.scope,ve,M,Ce+1,Le,et,me);M=lt-1;let We=lt-Be;m[Be++]=We&255,m[Be++]=We>>8&255,m[Be++]=We>>16&255,m[Be++]=We>>24&255,m[M++]=0}else{m[M++]=C;let Xe=se.encodeUTF8Into(m,N,M);M=M+Xe,m[M++]=0;let Be=Y.code.toString(),Pe=se.encodeUTF8Into(m,Be,M+4)+1;m[M]=Pe&255,m[M+1]=Pe>>8&255,m[M+2]=Pe>>16&255,m[M+3]=Pe>>24&255,M=M+4+Pe-1,m[M++]=0}return M}function fh(m,N,Y,M){m[M++]=h;let ve=se.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ce=Y.buffer,Le=Y.position;return Y.sub_type===ft.SUBTYPE_BYTE_ARRAY&&(Le=Le+4),m[M++]=Le&255,m[M++]=Le>>8&255,m[M++]=Le>>16&255,m[M++]=Le>>24&255,m[M++]=Y.sub_type,Y.sub_type===ft.SUBTYPE_BYTE_ARRAY&&(Le=Le-4,m[M++]=Le&255,m[M++]=Le>>8&255,m[M++]=Le>>16&255,m[M++]=Le>>24&255),m.set(Ce,M),M=M+Y.position,M}function dh(m,N,Y,M){m[M++]=T;let ve=se.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ce=se.encodeUTF8Into(m,Y.value,M+4)+1;return m[M]=Ce&255,m[M+1]=Ce>>8&255,m[M+2]=Ce>>16&255,m[M+3]=Ce>>24&255,M=M+4+Ce-1,m[M++]=0,M}function ph(m,N,Y,M,ve,Ce,Le){m[M++]=f;let et=se.encodeUTF8Into(m,N,M);M=M+et,m[M++]=0;let me=M,Xe={$ref:Y.collection||Y.namespace,$id:Y.oid};Y.db!=null&&(Xe.$db=Y.db),Xe=Object.assign(Xe,Y.fields);let Be=hc(m,Xe,!1,M,ve+1,Ce,!0,Le),Pe=Be-me;return m[me++]=Pe&255,m[me++]=Pe>>8&255,m[me++]=Pe>>16&255,m[me++]=Pe>>24&255,Be}function hc(m,N,Y,M,ve,Ce,Le,et){if(et==null){if(N==null)return m[0]=5,m[1]=0,m[2]=0,m[3]=0,m[4]=0,5;if(Array.isArray(N))throw new F("serialize does not support an array as the root input");if(typeof N!="object")throw new F("serialize does not support non-object as the root input");if("_bsontype"in N&&typeof N._bsontype=="string")throw new F("BSON types cannot be serialized as a document");if(St(N)||Ye(N)||Ie(N)||Te(N))throw new F("date, regexp, typedarray, and arraybuffer cannot be BSON documents");et=new Set}et.add(N);let me=M+4;if(Array.isArray(N))for(let Be=0;Be<N.length;Be++){let Pe=`${Be}`,$e=N[Be];if(typeof $e?.toBSON=="function"&&($e=$e.toBSON()),typeof $e=="string")me=eh(m,Pe,$e,me);else if(typeof $e=="number")me=th(m,Pe,$e,me);else if(typeof $e=="bigint")me=rh(m,Pe,$e,me);else if(typeof $e=="boolean")me=nh(m,Pe,$e,me);else if($e instanceof Date||St($e))me=ih(m,Pe,$e,me);else if($e===void 0)me=dc(m,Pe,$e,me);else if($e===null)me=dc(m,Pe,$e,me);else if(Ie($e))me=lh(m,Pe,$e,me);else if($e instanceof RegExp||Ye($e))me=ah(m,Pe,$e,me);else if(typeof $e=="object"&&$e._bsontype==null)me=Xu(m,Pe,$e,me,Y,ve,Ce,Le,et);else{if(typeof $e=="object"&&$e[Symbol.for("@@mdb.bson.version")]!==t)throw new H;if($e._bsontype==="ObjectId")me=sh(m,Pe,$e,me);else if($e._bsontype==="Decimal128")me=Zu(m,Pe,$e,me);else if($e._bsontype==="Long"||$e._bsontype==="Timestamp")me=ch(m,Pe,$e,me);else if($e._bsontype==="Double")me=Qu(m,Pe,$e,me);else if(typeof $e=="function"&&Ce)me=ef(m,Pe,$e,me);else if($e._bsontype==="Code")me=uh(m,Pe,$e,me,Y,ve,Ce,Le,et);else if($e._bsontype==="Binary")me=fh(m,Pe,$e,me);else if($e._bsontype==="BSONSymbol")me=dh(m,Pe,$e,me);else if($e._bsontype==="DBRef")me=ph(m,Pe,$e,me,ve,Ce,et);else if($e._bsontype==="BSONRegExp")me=oh(m,Pe,$e,me);else if($e._bsontype==="Int32")me=pc(m,Pe,$e,me);else if($e._bsontype==="MinKey"||$e._bsontype==="MaxKey")me=ar(m,Pe,$e,me);else if(typeof $e._bsontype<"u")throw new F(`Unrecognized or invalid _bsontype: ${String($e._bsontype)}`)}}else if(N instanceof Map||Ke(N)){let Be=N.entries(),Pe=!1;for(;!Pe;){let $e=Be.next();if(Pe=!!$e.done,Pe)continue;let lt=$e.value[0],We=$e.value[1];typeof We?.toBSON=="function"&&(We=We.toBSON());let sn=typeof We;if(typeof lt=="string"&&!dv.has(lt)){if(lt.match(Yu)!=null)throw new F("key "+lt+" must not contain null bytes");if(Y){if(lt[0]==="$")throw new F("key "+lt+" must not start with '$'");if(~lt.indexOf("."))throw new F("key "+lt+" must not contain '.'")}}if(sn==="string")me=eh(m,lt,We,me);else if(sn==="number")me=th(m,lt,We,me);else if(sn==="bigint")me=rh(m,lt,We,me);else if(sn==="boolean")me=nh(m,lt,We,me);else if(We instanceof Date||St(We))me=ih(m,lt,We,me);else if(We===null||We===void 0&&Le===!1)me=dc(m,lt,We,me);else if(Ie(We))me=lh(m,lt,We,me);else if(We instanceof RegExp||Ye(We))me=ah(m,lt,We,me);else if(sn==="object"&&We._bsontype==null)me=Xu(m,lt,We,me,Y,ve,Ce,Le,et);else{if(typeof We=="object"&&We[Symbol.for("@@mdb.bson.version")]!==t)throw new H;if(We._bsontype==="ObjectId")me=sh(m,lt,We,me);else if(sn==="object"&&We._bsontype==="Decimal128")me=Zu(m,lt,We,me);else if(We._bsontype==="Long"||We._bsontype==="Timestamp")me=ch(m,lt,We,me);else if(We._bsontype==="Double")me=Qu(m,lt,We,me);else if(We._bsontype==="Code")me=uh(m,lt,We,me,Y,ve,Ce,Le,et);else if(typeof We=="function"&&Ce)me=ef(m,lt,We,me);else if(We._bsontype==="Binary")me=fh(m,lt,We,me);else if(We._bsontype==="BSONSymbol")me=dh(m,lt,We,me);else if(We._bsontype==="DBRef")me=ph(m,lt,We,me,ve,Ce,et);else if(We._bsontype==="BSONRegExp")me=oh(m,lt,We,me);else if(We._bsontype==="Int32")me=pc(m,lt,We,me);else if(We._bsontype==="MinKey"||We._bsontype==="MaxKey")me=ar(m,lt,We,me);else if(typeof We._bsontype<"u")throw new F(`Unrecognized or invalid _bsontype: ${String(We._bsontype)}`)}}}else{if(typeof N?.toBSON=="function"&&(N=N.toBSON(),N!=null&&typeof N!="object"))throw new F("toBSON function did not return an object");for(let Be of Object.keys(N)){let Pe=N[Be];typeof Pe?.toBSON=="function"&&(Pe=Pe.toBSON());let $e=typeof Pe;if(typeof Be=="string"&&!dv.has(Be)){if(Be.match(Yu)!=null)throw new F("key "+Be+" must not contain null bytes");if(Y){if(Be[0]==="$")throw new F("key "+Be+" must not start with '$'");if(~Be.indexOf("."))throw new F("key "+Be+" must not contain '.'")}}if($e==="string")me=eh(m,Be,Pe,me);else if($e==="number")me=th(m,Be,Pe,me);else if($e==="bigint")me=rh(m,Be,Pe,me);else if($e==="boolean")me=nh(m,Be,Pe,me);else if(Pe instanceof Date||St(Pe))me=ih(m,Be,Pe,me);else if(Pe===void 0)Le===!1&&(me=dc(m,Be,Pe,me));else if(Pe===null)me=dc(m,Be,Pe,me);else if(Ie(Pe))me=lh(m,Be,Pe,me);else if(Pe instanceof RegExp||Ye(Pe))me=ah(m,Be,Pe,me);else if($e==="object"&&Pe._bsontype==null)me=Xu(m,Be,Pe,me,Y,ve,Ce,Le,et);else{if(typeof Pe=="object"&&Pe[Symbol.for("@@mdb.bson.version")]!==t)throw new H;if(Pe._bsontype==="ObjectId")me=sh(m,Be,Pe,me);else if($e==="object"&&Pe._bsontype==="Decimal128")me=Zu(m,Be,Pe,me);else if(Pe._bsontype==="Long"||Pe._bsontype==="Timestamp")me=ch(m,Be,Pe,me);else if(Pe._bsontype==="Double")me=Qu(m,Be,Pe,me);else if(Pe._bsontype==="Code")me=uh(m,Be,Pe,me,Y,ve,Ce,Le,et);else if(typeof Pe=="function"&&Ce)me=ef(m,Be,Pe,me);else if(Pe._bsontype==="Binary")me=fh(m,Be,Pe,me);else if(Pe._bsontype==="BSONSymbol")me=dh(m,Be,Pe,me);else if(Pe._bsontype==="DBRef")me=ph(m,Be,Pe,me,ve,Ce,et);else if(Pe._bsontype==="BSONRegExp")me=oh(m,Be,Pe,me);else if(Pe._bsontype==="Int32")me=pc(m,Be,Pe,me);else if(Pe._bsontype==="MinKey"||Pe._bsontype==="MaxKey")me=ar(m,Be,Pe,me);else if(typeof Pe._bsontype<"u")throw new F(`Unrecognized or invalid _bsontype: ${String(Pe._bsontype)}`)}}}et.delete(N),m[me++]=0;let Xe=me-M;return m[M++]=Xe&255,m[M++]=Xe>>8&255,m[M++]=Xe>>16&255,m[M++]=Xe>>24&255,me}function pS(m){return m!=null&&typeof m=="object"&&"_bsontype"in m&&typeof m._bsontype=="string"}var hS={$oid:At,$binary:ft,$uuid:ft,$symbol:es,$numberInt:Br,$numberDecimal:xt,$numberDouble:mr,$numberLong:he,$minKey:Ji,$maxKey:kr,$regex:Oi,$regularExpression:Oi,$timestamp:Ai};function pv(m,N={}){if(typeof m=="number"){let M=m<=r&&m>=n,ve=m<=i&&m>=a;if(N.relaxed||N.legacy)return m;if(Number.isInteger(m)&&!Object.is(m,-0)){if(M)return new Br(m);if(ve)return N.useBigInt64?BigInt(m):he.fromNumber(m)}return new mr(m)}if(m==null||typeof m!="object")return m;if(m.$undefined)return null;let Y=Object.keys(m).filter(M=>M.startsWith("$")&&m[M]!=null);for(let M=0;M<Y.length;M++){let ve=hS[Y[M]];if(ve)return ve.fromExtendedJSON(m,N)}if(m.$date!=null){let M=m.$date,ve=new Date;if(N.legacy)if(typeof M=="number")ve.setTime(M);else if(typeof M=="string")ve.setTime(Date.parse(M));else if(typeof M=="bigint")ve.setTime(Number(M));else throw new Z(`Unrecognized type for EJSON date: ${typeof M}`);else if(typeof M=="string")ve.setTime(Date.parse(M));else if(he.isLong(M))ve.setTime(M.toNumber());else if(typeof M=="number"&&N.relaxed)ve.setTime(M);else if(typeof M=="bigint")ve.setTime(Number(M));else throw new Z(`Unrecognized type for EJSON date: ${typeof M}`);return ve}if(m.$code!=null){let M=Object.assign({},m);return m.$scope&&(M.$scope=pv(m.$scope)),R.fromExtendedJSON(m)}if(te(m)||m.$dbPointer){let M=m.$ref?m:m.$dbPointer;if(M instanceof we)return M;let ve=Object.keys(M).filter(Le=>Le.startsWith("$")),Ce=!0;if(ve.forEach(Le=>{["$ref","$id","$db"].indexOf(Le)===-1&&(Ce=!1)}),Ce)return we.fromExtendedJSON(M)}return m}function gS(m,N){return m.map((Y,M)=>{N.seenObjects.push({propertyName:`index ${M}`,obj:null});try{return $a(Y,N)}finally{N.seenObjects.pop()}})}function hv(m){let N=m.toISOString();return m.getUTCMilliseconds()!==0?N:N.slice(0,-5)+"Z"}function $a(m,N){if(m instanceof Map||Ke(m)){let Y=Object.create(null);for(let[M,ve]of m){if(typeof M!="string")throw new F("Can only serialize maps with string keys");Y[M]=ve}return $a(Y,N)}if((typeof m=="object"||typeof m=="function")&&m!==null){let Y=N.seenObjects.findIndex(M=>M.obj===m);if(Y!==-1){let M=N.seenObjects.map(Be=>Be.propertyName),ve=M.slice(0,Y).map(Be=>`${Be} -> `).join(""),Ce=M[Y],Le=" -> "+M.slice(Y+1,M.length-1).map(Be=>`${Be} -> `).join(""),et=M[M.length-1],me=" ".repeat(ve.length+Ce.length/2),Xe="-".repeat(Le.length+(Ce.length+et.length)/2-1);throw new F(`Converting circular structure to EJSON:
    ${ve}${Ce}${Le}${et}
    ${me}\\${Xe}/`)}N.seenObjects[N.seenObjects.length-1].obj=m}if(Array.isArray(m))return gS(m,N);if(m===void 0)return null;if(m instanceof Date||St(m)){let Y=m.getTime(),M=Y>-1&&Y<2534023188e5;return N.legacy?N.relaxed&&M?{$date:m.getTime()}:{$date:hv(m)}:N.relaxed&&M?{$date:hv(m)}:{$date:{$numberLong:m.getTime().toString()}}}if(typeof m=="number"&&(!N.relaxed||!isFinite(m))){if(Number.isInteger(m)&&!Object.is(m,-0)){if(m>=n&&m<=r)return{$numberInt:m.toString()};if(m>=a&&m<=i)return{$numberLong:m.toString()}}return{$numberDouble:Object.is(m,-0)?"-0.0":m.toString()}}if(typeof m=="bigint")return N.relaxed?Number(BigInt.asIntN(64,m)):{$numberLong:BigInt.asIntN(64,m).toString()};if(m instanceof RegExp||Ye(m)){let Y=m.flags;if(Y===void 0){let ve=m.toString().match(/[gimuy]*$/);ve&&(Y=ve[0])}return new Oi(m.source,Y).toExtendedJSON(N)}return m!=null&&typeof m=="object"?yS(m,N):m}var gv={Binary:m=>new ft(m.value(),m.sub_type),Code:m=>new R(m.code,m.scope),DBRef:m=>new we(m.collection||m.namespace,m.oid,m.db,m.fields),Decimal128:m=>new xt(m.bytes),Double:m=>new mr(m.value),Int32:m=>new Br(m.value),Long:m=>he.fromBits(m.low!=null?m.low:m.low_,m.low!=null?m.high:m.high_,m.low!=null?m.unsigned:m.unsigned_),MaxKey:()=>new kr,MinKey:()=>new Ji,ObjectId:m=>new At(m),BSONRegExp:m=>new Oi(m.pattern,m.options),BSONSymbol:m=>new es(m.value),Timestamp:m=>Ai.fromBits(m.low,m.high)};function yS(m,N){if(m==null||typeof m!="object")throw new F("not an object instance");let Y=m._bsontype;if(typeof Y>"u"){let M={};for(let ve of Object.keys(m)){N.seenObjects.push({propertyName:ve,obj:null});try{let Ce=$a(m[ve],N);ve==="__proto__"?Object.defineProperty(M,ve,{value:Ce,writable:!0,enumerable:!0,configurable:!0}):M[ve]=Ce}finally{N.seenObjects.pop()}}return M}else{if(m!=null&&typeof m=="object"&&typeof m._bsontype=="string"&&m[Symbol.for("@@mdb.bson.version")]!==t)throw new H;if(pS(m)){let M=m;if(typeof M.toExtendedJSON!="function"){let ve=gv[m._bsontype];if(!ve)throw new F("Unrecognized or invalid _bsontype: "+m._bsontype);M=ve(M)}return Y==="Code"&&M.scope?M=new R(M.code,$a(M.scope,N)):Y==="DBRef"&&M.oid&&(M=new we($a(M.collection,N),$a(M.oid,N),$a(M.db,N),$a(M.fields,N))),M.toExtendedJSON(N)}else throw new F("_bsontype must be a string, but was: "+typeof Y)}}function yv(m,N){let Y={useBigInt64:N?.useBigInt64??!1,relaxed:N?.relaxed??!0,legacy:N?.legacy??!1};return JSON.parse(m,(M,ve)=>{if(M.indexOf("\0")!==-1)throw new F(`BSON Document field names cannot contain null bytes, found: ${JSON.stringify(M)}`);return pv(ve,Y)})}function mv(m,N,Y,M){Y!=null&&typeof Y=="object"&&(M=Y,Y=0),N!=null&&typeof N=="object"&&!Array.isArray(N)&&(M=N,N=void 0,Y=0);let ve=Object.assign({relaxed:!0,legacy:!1},M,{seenObjects:[{propertyName:"(root)",obj:null}]}),Ce=$a(m,ve);return JSON.stringify(Ce,N,Y)}function mS(m,N){return N=N||{},JSON.parse(mv(m,N))}function vv(m,N){return N=N||{},yv(JSON.stringify(m),N)}var yo=Object.create(null);yo.parse=yv,yo.stringify=mv,yo.serialize=mS,yo.deserialize=vv,Object.freeze(yo);var hh=1024*1024*17,pa=se.allocate(hh);function bv(m){pa.length<m&&(pa=se.allocate(m))}function _v(m,N={}){let Y=typeof N.checkKeys=="boolean"?N.checkKeys:!1,M=typeof N.serializeFunctions=="boolean"?N.serializeFunctions:!1,ve=typeof N.ignoreUndefined=="boolean"?N.ignoreUndefined:!0,Ce=typeof N.minInternalBufferSize=="number"?N.minInternalBufferSize:hh;pa.length<Ce&&(pa=se.allocate(Ce));let Le=hc(pa,m,Y,0,0,M,ve,null),et=se.allocate(Le);return et.set(pa.subarray(0,Le),0),et}function gh(m,N,Y={}){let M=typeof Y.checkKeys=="boolean"?Y.checkKeys:!1,ve=typeof Y.serializeFunctions=="boolean"?Y.serializeFunctions:!1,Ce=typeof Y.ignoreUndefined=="boolean"?Y.ignoreUndefined:!0,Le=typeof Y.index=="number"?Y.index:0,et=hc(pa,m,M,0,0,ve,Ce,null);return N.set(pa.subarray(0,et),Le),Le+et-1}function wv(m,N={}){return fv(se.toLocalBufferType(m),N)}function yh(m,N={}){N=N||{};let Y=typeof N.serializeFunctions=="boolean"?N.serializeFunctions:!1,M=typeof N.ignoreUndefined=="boolean"?N.ignoreUndefined:!0;return Wn(m,Y,M)}function Sv(m,N,Y,M,ve,Ce){let Le=Object.assign({allowObjectSmallerThanBufferSize:!0,index:0},Ce),et=se.toLocalBufferType(m),me=N;for(let Xe=0;Xe<Y;Xe++){let Be=et[me]|et[me+1]<<8|et[me+2]<<16|et[me+3]<<24;Le.index=me,M[ve+Xe]=fv(et,Le),me=me+Be}return me}var vS=Object.freeze({__proto__:null,Code:R,BSONSymbol:es,DBRef:we,Binary:ft,ObjectId:At,UUID:B,Long:he,Timestamp:Ai,Double:mr,Int32:Br,MinKey:Ji,MaxKey:kr,BSONRegExp:Oi,Decimal128:xt,setInternalBufferSize:bv,serialize:_v,serializeWithBufferAndIndex:gh,deserialize:wv,calculateObjectSize:yh,deserializeStream:Sv,BSONValue:_t,BSONError:F,BSONVersionError:H,BSONRuntimeError:Z,BSONType:de,EJSON:yo});e.BSON=vS,e.BSONError=F,e.BSONRegExp=Oi,e.BSONRuntimeError=Z,e.BSONSymbol=es,e.BSONType=de,e.BSONValue=_t,e.BSONVersionError=H,e.Binary=ft,e.Code=R,e.DBRef=we,e.Decimal128=xt,e.Double=mr,e.EJSON=yo,e.Int32=Br,e.Long=he,e.MaxKey=kr,e.MinKey=Ji,e.ObjectId=At,e.Timestamp=Ai,e.UUID=B,e.calculateObjectSize=yh,e.deserialize=wv,e.deserializeStream=Sv,e.serialize=_v,e.serializeWithBufferAndIndex=gh,e.setInternalBufferSize=bv}}),QY={};nIe(QY,{AuthorizationStruct:()=>sK,ChatroomStruct:()=>fK,CoherenceMap:()=>jN,CoherenceStruct:()=>MN,CommentStruct:()=>dK,Data:()=>lIe,DataStruct:()=>cK,DateStruct:()=>gK,ECGStruct:()=>UN,EDAStruct:()=>rK,EEGCoordinates:()=>sIe,EEGStruct:()=>uc,EMGStruct:()=>aK,EventStruct:()=>uK,EyeTrackerStruct:()=>tK,FNIRSStruct:()=>$N,FrequencyBandsStruct:()=>H1,GroupStruct:()=>lK,HRVStruct:()=>iK,IMUStruct:()=>eK,NotificationStruct:()=>pK,PPGStruct:()=>nK,ProfileStruct:()=>oK,ScheduleStruct:()=>hK,Struct:()=>Ln,eegCoordinates:()=>qu,setCoordinate:()=>V1,structRegistry:()=>cIe});function Ln(e="struct",t={},r={_id:""},n={structType:"struct",_id:""}){function i(o=""){return`${o+Math.floor(Math.random()+Math.random()*Math.random()*1e16)}`}let a={_id:i(e+"defaultId"),structType:e,ownerId:r?._id,timestamp:Date.now(),parent:{structType:n?.structType,_id:n?._id}};return a.ownerId||delete a.ownerId,a?.parent?._id||delete a.parent,Object.keys(t).length>0&&Object.assign(a,t),a}var qu={FP1:[-21.2,66.9,12.1],FPZ:[1.4,65.1,11.3],FP2:[24.3,66.3,12.5],AF7:[-41.7,52.8,11.3],AF3:[-32.7,48.4,32.8],AFZ:[1.8,54.8,37.9],AF4:[35.1,50.1,31.1],AF8:[43.9,52.7,9.3],F5:[-51.4,26.7,24.7],F3:[-39.7,25.3,44.7],F1:[-22.1,26.8,54.9],FZ:[0,26.8,60.6],F2:[23.6,28.2,55.6],F4:[41.9,27.5,43.9],F6:[52.9,28.7,25.2],F7:[-52.1,28.6,3.8],F8:[53.2,28.4,3.1],FC5:[-59.1,3,26.1],FC3:[-45.5,2.4,51.3],FC1:[-24.7,.3,66.4],FCZ:[1,1,72.8],FC2:[26.1,3.2,66],FC4:[47.5,4.6,49.7],FC6:[60.5,4.9,25.5],FT9:[-53.8,-2.1,-29.1],FT7:[-59.2,3.4,-2.1],FT8:[60.2,4.7,-2.8],FT10:[55,-3.6,-31],T7:[-65.8,-17.8,-2.9],T5:[-61.5,-65.3,1.1],T3:[-70.2,-21.3,-10.7],T4:[71.9,-25.2,-8.2],T6:[59.3,-67.6,3.8],T8:[67.4,-18.5,-3.4],C5:[-63.6,-18.9,25.8],C3:[-49.1,-20.7,53.2],C1:[-25.1,-22.5,70.1],CZ:[.8,-21.9,77.4],C2:[26.7,-20.9,69.5],C4:[50.3,-18.8,53],C6:[65.2,-18,26.4],CP5:[-61.8,-46.2,22.5],CP3:[-46.9,-47.7,49.7],CP1:[-24,-49.1,66.1],CPZ:[.7,-47.9,72.6],CP2:[25.8,-47.1,66],CP4:[49.5,-45.5,50.7],CP6:[62.9,-44.6,24.4],TP9:[-73.6,-46.7,-4],TP7:[-63.6,-44.7,-4],TP8:[64.6,-45.4,-3.7],TP10:[74.6,-47.4,-3.7],P9:[-50.8,-51.3,-37.7],P7:[-55.9,-64.8,0],P5:[-52.7,-67.1,19.9],P3:[-41.4,-67.8,42.4],P1:[-21.6,-71.3,52.6],PZ:[.7,-69.3,56.9],P2:[24.4,-69.9,53.5],P4:[44.2,-65.8,42.7],P6:[54.4,-65.3,20.2],P8:[56.4,-64.4,.1],P10:[51,-53.9,-36.5],PO7:[-44,-81.7,1.6],PO3:[-33.3,-84.3,26.5],POZ:[0,-87.9,33.5],PO4:[35.2,-82.6,26.1],PO8:[43.3,-82,.7],O1:[-25.8,-93.3,7.7],OZ:[.3,-97.1,8.7],O2:[25,-95.2,6.2]};function V1(e,t={}){if(!qu[e.tag]&&e.position&&(qu[e.tag]=[e.position.x,e.position.y,e.position.z]),qu[e.tag]){let r={channel:"",position:{x:qu[e.tag][0],y:qu[e.tag][1],z:qu[e.tag][2]}};return Object.assign(t,r)}else return Object.assign(t,e)}function sIe(e=[],t=!0){let r=[];for(let n of e){let i=uc(n);r.push(i)}return t&&r.push(...jN({channelDicts:e})),r}function H1(e=[],t={}){let r={scp:[],delta:[],theta:[],alpha1:[],alpha2:[],beta:[],lowgamma:[],highgamma:[]};return e.forEach(n=>r[n]=[]),Object.assign(t,r)}function uc(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i=H1(),a={tag:e,position:{x:0,y:0,z:0},count:0,times:[],raw:[],filtered:[],fftCount:0,fftTimes:[],ffts:[],slices:JSON.parse(JSON.stringify(i)),means:JSON.parse(JSON.stringify(i)),startTime:Date.now()},o=Ln("eeg",a,r,n);return e&&V1(a,o),Object.assign(o,t)}function MN(e={0:uc("FP1"),1:uc("FP2")},t={},r={_id:""},n={structType:"struct",_id:""}){let i=H1(),a={tag:e[0]?.tag+"::"+e[1]?.tag,x0:e[0]?.position?.x,y0:e[0]?.position?.y,z0:e[0]?.position?.z,x1:e[1]?.position?.x,y1:e[1]?.position?.y,z1:e[1]?.position?.z,fftCount:0,fftTimes:[],ffts:[],slices:JSON.parse(JSON.stringify(i)),means:JSON.parse(JSON.stringify(i)),startTime:Date.now()},o=Ln("coherence",a,r,n);return Object.assign(o,t)}function jN(e={channelDicts:[{ch:0,tag:"FP1",analyze:!1},{ch:1,tag:"FP2",analyze:!1}],taggedOnly:!0},t={},r={_id:""},n={structType:"struct",_id:""}){for(var i=[],a=1,o=0,s=0;s<e.channelDicts.length*(e.channelDicts.length+1)/2-e.channelDicts.length;s++){if(e.taggedOnly===!1||e.taggedOnly===!0&&e.channelDicts[o].tag!==null&&e.channelDicts[o+a].tag!==null&&e.channelDicts[o].tag!=="other"&&e.channelDicts[o+a].tag!=="other"&&e.channelDicts[o].analyze===!0&&e.channelDicts[o+a].analyze===!0){var l=uc(e.channelDicts[o].tag),c=uc(e.channelDicts[o+a].tag);i.push(MN({0:l,1:c},{},r,n))}a++,a+o===e.channelDicts.length&&(o++,a=1)}return i}function $N(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,position:{x:0,y:0,z:0},count:0,times:[],red:[],ir:[],ir2:[],ambient:[],ratio:[],temp:[],beat_detect:{beats:[],breaths:[],rir:[],rir2:[],drir_dt:[],localmins:[],localmaxs:[],val_dists:[],peak_dists:[],localmins2:[],localmaxs2:[],val_dists2:[],peak_dists2:[]},startTime:Date.now()},a=Ln("fnirs",i,r,n);return e&&V1(i,a),Object.assign(a,t)}function eK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,Ax:[],Ay:[],Az:[],Gx:[],Gy:[],Gz:[],startTime:Date.now()},a=Ln("imu",i,r,n);return e&&V1(i,a),Object.assign(a,t)}function tK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,count:0,times:[],x:[],y:[],smax:[],smay:[],startTime:Date.now()},a=Ln("eyetracker",i,r,n);return Object.assign(a,t)}function UN(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,count:0,times:[],raw:[],filtered:[],bpm:[],hrv:[],startTime:Date.now()},a=Ln("ecg",i,r,n);return Object.assign(a,t)}function rK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){}function nK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i=$N(e,r,n,t);return i.structType="ppg",i}function iK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i=UN(e,r,n,t);return i.structType="hrv",i}function aK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i=uc(e,r,n,t);return i.structType="emg",i}function oK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let a=Ln("profile",{tag:e,name:"",username:"",firstName:"",lastName:"",email:"",phone:"",sex:"",birthday:"",type:"",pictureUrl:"",userRoles:{},socials:{},data:{},hidden:!1,accessToken:"",refreshToken:""},r,n);return Object.assign(a,t)}function sK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let a=Ln("authorization",{tag:e,authorizedId:"",authorizedName:"",authorizerId:"",authorizerName:"",authorizations:{},structs:{},excluded:{},groups:{},status:"PENDING",expires:!1,associatedAuthId:""},r,n);return Object.assign(a,t)}function lK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let a=Ln("group",{tag:e,name:"",details:"",admins:{},peers:{},clients:{},users:{}},r,n);return Object.assign(a,t)}function lIe(e,t){return{type:e,data:t,timestamp:Date.now()}}function cK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,title:"",author:"",expires:!1,type:"",data:new Array},a=Ln("data",i,r,n);return Object.assign(a,t)}function uK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,event:"",author:"",startTime:"",endTime:"",grade:void 0,value:void 0,units:void 0,location:void 0,notes:"",attachments:new Array,users:{}},a=Ln("event",i,r,n);return Object.assign(a,t)}function fK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,message:"",topic:"",author:"",attachments:new Array,comments:new Array,replies:new Array,users:{},audioChatActive:!1,videoChatActive:!1},a=Ln("chatroom",i,r,n);return Object.assign(a,t)}function dK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,author:"",replyTo:"",message:"",rating:0,replies:new Array,users:{},attachments:new Array},a=Ln("comment",i,r,n);return Object.assign(a,t)}function pK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let a=Ln("notification",{tag:e,note:"",parentUserId:""},r,n);return Object.assign(a,t)}function hK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,title:"",author:"",attachments:new Array,dates:new Array},a=Ln("schedule",i,r,n);return Object.assign(a,t)}function gK(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,timeSet:"",notes:"",recurs:"NEVER",attachments:new Array},a=Ln("date",i,r,n);return Object.assign(a,t)}var cIe={Struct:Ln,EEGStruct:uc,FNIRSStruct:$N,CoherenceStruct:MN,CoherenceMap:jN,FrequencyBandsStruct:H1,IMUStruct:eK,EyeTrackerStruct:tK,ECGStruct:UN,EDAStruct:rK,PPGStruct:nK,HRVStruct:iK,EMGStruct:aK,ProfileStruct:oK,AuthorizationStruct:sK,GroupStruct:lK,DataStruct:cK,EventStruct:uK,ChatroomStruct:fK,CommentStruct:dK,NotificationStruct:pK,ScheduleStruct:hK,DateStruct:gK};var uIe=class{data={};triggers={};ctr=0;constructor(e){typeof e=="object"&&(this.data=e)}setState=e=>{Object.assign(this.data,e);let t=Object.getOwnPropertyNames(e);for(let r of t)this.triggerEvent(r,this.data[r]);if(this.triggers[av]){let r=i=>{i(e)},n=this.triggers[av].length;for(let i=n-1;i>=0;i--)r(this.triggers[av][i].onchange)}return this.data};setValue=(e,t)=>{this.data[e]=t,this.triggerEvent(e,t)};triggerEvent=(e,t)=>{if(this.triggers[e]){let r=i=>{i.onchange(t)},n=this.triggers[e].length;for(let i=n-1;i>=0;i--)r(this.triggers[e][i])}};subscribeState=e=>this.subscribeEvent(av,e);unsubscribeState=e=>this.unsubscribeEvent(av,e);subscribeEvent=(e,t,r,n)=>{if(e){r&&n&&!this.triggers[e]&&Object.defineProperty(this.data,e,{get:()=>r[n],set:a=>{r[n]=a},enumerable:!0,configurable:!0}),this.triggers[e]||(this.triggers[e]=[]);let i=this.ctr;return this.ctr++,this.triggers[e].push({sub:i,onchange:t}),i}else return};unsubscribeEvent=(e,t)=>{let r=this.triggers[e];if(r)if(t===void 0)delete this.triggers[e],delete this.data[e];else{let n,i=r.find((a,o)=>{if(a.sub===t)return n=o,!0});return i&&r.splice(n,1),Object.keys(r).length===0&&(delete this.triggers[e],delete this.data[e]),this.onRemoved&&this.onRemoved(i),!0}};subscribeEventOnce=(e,t)=>{let r,n=i=>{t(i),this.unsubscribeEvent(e,r)};return r=this.subscribeEvent(e,n),r};getEvent=(e,t)=>{for(let r in this.triggers[e])if(this.triggers[e][r].sub===t)return this.triggers[e][r]};getSnapshot=()=>{let e={};for(let t in this.data)e[t]=this.data[t]};onRemoved},av="*s",NWe=new uIe;var LWe=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var PWe=aIe(oIe());var LN=QY.ProfileStruct();for(let e in LN)e==="username"||e==="lastName"||e==="firstName"||e==="name"||e==="_id"||e==="pictureUrl"?LN[e]=1:delete LN[e];var Et={collision:{setupEntities:function(e){for(let t in e){let r=e[t];r.components&&!r.components[this.__node.tag]||this.setupEntity(r)}return e},setupEntity:function(e){return"collisionEnabled"in e||(e.collisionEnabled=!0),e.collisionType||(e.collisionType="sphere"),e.collisionRadius||(e.collisionRadius=1),e.collisionBoundsScale||(e.collisionBoundsScale={x:1,y:1,z:1}),e.colliding||(e.colliding={}),e.position||(e.position={x:0,y:0,z:0}),e},__node:{tag:"collision"},__operator:function(e){let t=this.entityKeys;for(let r=0;r<t.length;r++){let n=e[t[r]];if(!(n.components&&(!n.components[this.__node.tag]||!n.collisionEnabled))&&n.collisionEnabled)for(let i=0;i<t.length;i++){if(r===i)continue;let a=e[t[i]];if(a.components&&!a.components[this.__node.tag]||!a.collisionEnabled)continue;let o=Et.collision.collisionCheck(n,a);o!==!1&&(n.colliding||(n.colliding={}),a.colliding||(a.colliding={}),n.colliding[a.__node.tag]=o,a.colliding[n.__node.tag]=o)}}return e},collisionCheck:(e,t)=>{if(e.collisionEnabled===!1||t.collisionEnabled===!1)return!1;let r=Et.collision.distance(e.position,t.position);if(r<Math.max(...Object.values(e.collisionBoundsScale))*e.collisionRadius+Math.max(...Object.values(t.collisionBoundsScale))*t.collisionRadius){let n=!1;if(e.collisionType==="sphere"?t.collisionType==="sphere"?n=Et.collision.sphereCollisionCheck(e,t,r):t.collisionType==="box"?n=Et.collision.sphereBoxCollisionCheck(e,t,r):t.collisionType==="point"&&(n=Et.collision.isPointInsideSphere(t.position,e,r)):e.collisionType==="box"?t.collisionType==="sphere"?n=Et.collision.sphereBoxCollisionCheck(t,e,r):t.collisionType==="box"?n=Et.collision.boxCollisionCheck(e,t):t.collisionType==="point"&&(n=Et.collision.isPointInsideBox(e.position,e)):e.collisionType==="point"&&(t.collisionType==="sphere"?n=Et.collision.isPointInsideSphere(e.position,t,r):t.collisionType==="box"&&(n=Et.collision.isPointInsideBox(e.position,t))),n)return r}return!1},sphereCollisionCheck:(e,t,r)=>(r===void 0&&(r=Et.collision.distance(e.position,t.position)),r<e.collisionRadius+t.collisionRadius),boxCollisionCheck:(e,t)=>{let r=(e.position.x-e.collisionRadius)*e.collisionBoundsScale.x,n=(e.position.x+e.collisionRadius)*e.collisionBoundsScale.x,i=(e.position.y-e.collisionRadius)*e.collisionBoundsScale.y,a=(e.position.y+e.collisionRadius)*e.collisionBoundsScale.y,o=(e.position.z-e.collisionRadius)*e.collisionBoundsScale.z,s=(e.position.z+e.collisionRadius)*e.collisionBoundsScale.z,l=(t.position.x-t.collisionRadius)*e.collisionBoundsScale.x,c=(t.position.x+t.collisionRadius)*e.collisionBoundsScale.x,f=(t.position.y-t.collisionRadius)*e.collisionBoundsScale.y,u=(t.position.y+t.collisionRadius)*e.collisionBoundsScale.y,h=(t.position.z-t.collisionRadius)*e.collisionBoundsScale.z,g=(t.position.z+t.collisionRadius)*e.collisionBoundsScale.z;return(n<=c&&n>=l||r<=c&&r>=l)&&(a<=u&&a>=f||i<=u&&i>=f)&&(s<=g&&s>=h||o<=g&&o>=h)},sphereBoxCollisionCheck:(e,t,r)=>{let n=(t.position.x-t.collisionRadius)*t.collisionBoundsScale.x,i=(t.position.x+t.collisionRadius)*t.collisionBoundsScale.x,a=(t.position.y-t.collisionRadius)*t.collisionBoundsScale.y,o=(t.position.y+t.collisionRadius)*t.collisionBoundsScale.y,s=(t.position.z-t.collisionRadius)*t.collisionBoundsScale.z,l=(t.position.z+t.collisionRadius)*t.collisionBoundsScale.z,c={x:Math.max(n,Math.min(e.position.x,i)),y:Math.max(a,Math.min(e.position.y,o)),z:Math.max(s,Math.min(e.position.z,l))};return r===void 0&&(r=Et.collision.distance(e.position,c)),r>e.collisionRadius},isPointInsideSphere:(e,t,r)=>(r===void 0&&(r=Et.collision.distance(e,t.position)),r<t.collisionRadius),isPointInsideBox:(e,t)=>{let r=(t.position.x-t.collisionRadius)*t.collisionBoundsScale.x,n=(t.position.x+t.collisionRadius)*t.collisionBoundsScale.x,i=(t.position.y-t.collisionRadius)*t.collisionBoundsScale.x,a=(t.position.y+t.collisionRadius)*t.collisionBoundsScale.x,o=(t.position.z-t.collisionRadius)*t.collisionBoundsScale.x,s=(t.position.z+t.collisionRadius)*t.collisionBoundsScale.x;return e.x>=r&&e.x<=n&&e.y>=i&&e.y<=a&&e.z>=o&&e.z<=s},closestPointOnLine:(e,t,r)=>{let n={x:r.x-t.x,y:r.y-t.y,z:r.z-t.z},i={x:t.x-e.x,y:t.y-e.y,z:t.z-e.z},a={x:r.x-e.x,y:r.y-e.y,z:r.z-e.z},o=Et.collision.dot(i,n);if(o<=0)return t;let s=Et.collision.dot(a,n);if(s<=0)return r;let l=1/(o+s);return{x:t.x+(r.x-t.x)*o*l,y:t.y+(r.y-t.y)*o*l,z:t.z+(r.z-t.z)*o*l}},closestPointOnPolygon:(e,t,r,n)=>{let i=Et.collision.calcNormal(t,r,n),a=Et.collision.dot(e,i)-Et.collision.dot(t,i),o=Et.collision.vecadd(e,Et.collision.vecscale(i,-a)),s=n[0]-t[0],l=n[1]-t[1],c=n[2]-t[2],f=r[0]-t[0],u=r[1]-t[1],h=r[2]-t[2],g=o[0]-t[0],_=o[1]-t[1],w=o[2]-t[2],E=s*s+l*l+c*c,S=s*f+l*u+c*h,A=s*g+l*_+c*w,O=f*f+u*u+h*h,C=f*g+u*_+h*w,T=E*O-S*S;if(Math.abs(T)<1e-30)return;let D=1/T,P=(O*A-S*C)*D,z=(E*C-S*A)*D;if(P>=0&&z>=0&&P+z<1)return o},calcNormal:(e,t,r,n=!0)=>{var i=Et.collision.makeVec(e,t),a=Et.collision.makeVec(e,r);return n===!0?Et.collision.normalize(Et.collision.cross3D(i,a)):Et.collision.normalize(Et.collision.cross3D(a,i))},dot:(e,t)=>{let r=0;for(let n in e)r+=e[n]*t[n];return r},makeVec(e,t){return{x:t.x-e.x,y:t.y-e.y,z:t.z-e.z}},vecadd:(e,t)=>{let r=Object.assign({},e);for(let n in r)r[n]+=t[n];return r},vecsub:(e,t)=>{let r=Object.assign({},e);for(let n in r)r[n]-=t[n];return r},vecmul:(e,t)=>{let r=Object.assign({},e);for(let n in r)r[n]*=t[n];return r},vecdiv:(e,t)=>{let r=Object.assign({},e);for(let n in r)r[n]/=t[n];return r},vecscale:(e,t)=>{let r=Object.assign({},e);for(let n in r)r[n]*=t;return r},distance:(e,t)=>{let r=0;for(let n in e)r+=Math.pow(e[n]-t[n],2);return Math.sqrt(r)},magnitude:e=>{let t=0;for(let r in e)t+=e[r]*e[r];return Math.sqrt(t)},normalize:e=>{let t=Et.collision.magnitude(e),r=t?1/t:0,n={};for(let i in e)n[i]=e[i]*r;return n},distance3D(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)+(e.z-t.z)*(e.z-t.z))},cross3D(e,t){return{x:e.y*t.z-e.z*t.y,y:e.z*t.x-e.x*t.z,z:e.x*t.y-e.y*t.x}},nearestNeighborSearch(e,t=1e15){var r={};for(let o in e){let s={tag:o,position:void 0,neighbors:[]};s.position=e[o].position,r[o]=s}for(let o in r){for(let s in r){var n=Et.collision.distance3D(r[o].position,r[s].position);if(n<t){var i={tag:s,position:e[s].position,dist:n};r[o].neighbors.push(i);var a={tag:s,position:e[o].position,dist:n};r[s].neighbors.push(a)}}r[o].neighbors.sort(function(s,l){return s.dist-l.dist})}return r},generateBoundingVolumeTree(e,t="octree",r=1e15,n=3){let i={proto:{parent:void 0,children:{},entities:{},collisionType:"box",collisionRadius:1,collisionBoundsScale:{x:1,y:1,z:1},position:{x:0,y:0,z:0}},tree:{}},a,o,s,l=0,c=0,f=0,u={},h=r;for(let E in e){let S=e[E],A=S.position.x+S.collisionRadius*S.collisionBoundsScale.x,O=S.position.y+S.collisionRadius*S.collisionBoundsScale.y,C=S.position.z+S.collisionRadius*S.collisionBoundsScale.z;a<A&&(a=A),l>A&&(l=A),o<O&&(o=O),c>O&&(c=O),s<C&&(s=C),f>C&&(f=C),h>S.collisionRadius&&(h=S.collisionRadius),u[E]=S.position}let g=JSON.parse(JSON.stringify(i.proto)),_={x:(a+l)*.5,y:(o+c)*.5,z:(s+f)*.5},w={x:a-_.x,y:o-_.y,z:s-_.z};if(g.position=_,g.collisionBoundsScale=w,g.entities=e,i.tree=g,h*=2,t==="octree"){let E=function(A,O){let C={x:A.x+O.x,y:A.y+O.y,z:A.z+O.z},T={x:A.x-O.x,y:A.y+O.y,z:A.z+O.z},D={x:A.x+O.x,y:A.y-O.y,z:A.z+O.z},P={x:A.x+O.x,y:A.y+O.y,z:A.z-O.z},z={x:A.x-O.x,y:A.y-O.y,z:A.z+O.z},ne={x:A.x-O.x,y:A.y+O.y,z:A.z-O.z},V={x:A.x+O.x,y:A.y-O.y,z:A.z-O.z},X={x:A.x-O.x,y:A.y-O.y,z:A.z-O.z};return[C,T,D,P,z,ne,V,X]},S=function(A){let O={x:A.collisionBoundsScale.x*.5,y:A.collisionBoundsScale.y*.5,z:A.collisionBoundsScale.z*.5},C=E(A.position,O),T=Object.assign({},A.bodies);for(let D=0;D<8;D++){let P=Object.assign(JSON.parse(JSON.stringify(i.proto)),{position:C[D],collisionBoundsScale:O});P.parent=A;for(let z in T)Et.collision.collisionCheck(T[z],P)&&(P.entities[z]=T[z],delete T[z]);Object.keys(P.entities).length>n-1&&(A.children[D]=P,P.parent=A,Object.keys(P.entities).length>n&&P.collisionRadius*.5>h&&S(P))}};return S(g),g}else{let E=Et.collision.nearestNeighborSearch(u,r),S=Object.keys(E),A=S[Math.floor(Math.random()*S.length)],O=!0,C=0,T=(P,z)=>{let ne={},V={},X=Object.keys(P);for(;O&&C<X.length;){let Q=P[A],ie=0,pe=0,de=u[Q.tag].x-z[Q.tag].collisionBoundsScale.x,F=u[Q.tag].y-z[Q.tag].collisionBoundsScale.y,H=u[Q.tag].z-z[Q.tag].collisionBoundsScale.z,Z=u[Q.tag].x+z[Q.tag].collisionBoundsScale.x,j=u[Q.tag].y+z[Q.tag].collisionBoundsScale.y,$=u[Q.tag].z+z[Q.tag].collisionBoundsScale.z,q=JSON.parse(JSON.stringify(i.proto));q.tag=`bound${Math.floor(Math.random()*1e15)}`,q.children[Q.tag]=z[Q.tag],q.bodies[Q.tag]=e[Q.tag],z[Q.tag].parent=q,V[Q.tag]=!0,ie++,pe++;let ae=Object.keys(Q.neighbors);for(;ie<ae.length&&pe<3;){if(V[Q.neighbors[ie].tag]){ie++;continue}let Se=u[Q.neighbors[ie].tag].x-z[Q.neighbors[ie].tag].collisionBoundsScale.x,ke=u[Q.neighbors[ie].tag].y-z[Q.neighbors[ie].tag].collisionBoundsScale.y,xe=u[Q.neighbors[ie].tag].z-z[Q.neighbors[ie].tag].collisionBoundsScale.z,se=u[Q.neighbors[ie].tag].x+z[Q.neighbors[ie].tag].collisionBoundsScale.x,be=u[Q.neighbors[ie].tag].y+z[Q.neighbors[ie].tag].collisionBoundsScale.y,W=u[Q.neighbors[ie].tag].z+z[Q.neighbors[ie].tag].collisionBoundsScale.z;de>Se&&(de=Se),Z<se&&(Z=se),F>ke&&(F=ke),j<be&&(j=be),H>xe&&(H=xe),$<W&&($=W),q.children[Q.neighbors[ie].tag]=z[Q.neighbors[ie].tag],q.entities[Q.neighbors[ie].tag]=e[Q.neighbors[ie].tag],z[Q.neighbors[ie].tag].parent=q,V[Q.neighbors[ie].tag]=!0,ie++,pe++}let le={x:(Z+de)*.5,y:(j+F)*.5,z:($+H)*.5},fe={x:Z-le.x,y:j-le.y,z:$-le.z};for(q.position=le,q.collisionBoundsScale=fe,q.bodies.length===1&&(q=Q),ne[q.tag]=q;ie<Q.neighbors.length&&V[Q.neighbors[ie].tag];)ie++;ie<Q.neighbors.length?A=Q.neighbors[ie].tag:Object.keys(V).length<Object.keys(P).length?A=S[0]:O=!1,C++}return ne},D=T(E,e);for(;Object.keys(D).length>2;){let P=Et.collision.nearestNeighborSearch(D,r);D=T(P,D)}return g.children=D,g.children.forEach(P=>{P.parent=g}),g}}},collider:{lastTime:performance.now(),setupEntities:function(e){for(let t in e){let r=e[t];r.components&&!r.components[this.__node.tag]||this.setupEntity(r)}return e},setupEntity:function(e){return"collisionEnabled"in e||Et.collision.setupEntity(e),"boundingBox"in e||(e.boundingBox={bot:0,top:100,left:0,right:100,front:0,back:100}),"position"in e||Et.movement.setupEntity(e),"restitution"in e||(e.restitution=1),"useBoundingBox"in e||(e.useBoundingBox=!0),!e.position.x&&!e.position.y&&!e.position.z&&(e.position.x=Math.random()*e.boundingBox.right,e.position.y=Math.random()*e.boundingBox.back,e.position.z=Math.random()*e.boundingBox.top),e},__operator:function(e){let t=this.entityKeys;for(let r=0;r<t.length;r++){let n=e[t[r]];if(!(n.components&&(!n.components[this.__node.tag]||!n.collisionEnabled))&&(n.useBoundingBox&&this.checkBoundingBox(n),!!n.collisionEnabled&&n.colliding)){for(let i in n.colliding){let a=e[i];if(n.colliding[i]===!1){delete n.colliding[i],delete a.colliding[n.__node.tag];continue}a.collisionEnabled&&(a.collisionType==="box"?this.resolveBoxCollision(n,a,n.colliding[i]):n.collisionType==="box"?(n.fixed=!0,this.resolveSphereCollisions(n,a,n.colliding[i]),n.fixed=!1):(this.resolveSphereCollisions(n,a,n.colliding[i]),delete a.colliding[n.__node.tag]),delete n.colliding[a.__node.tag])}delete n.colliding}}return e},__node:{tag:"collider"},checkBoundingBox:e=>{let t=e.collisionRadius*e.collisionBoundsScale.x,r=e.collisionRadius*e.collisionBoundsScale.y,n=e.collisionRadius*e.collisionBoundsScale.z;e.position.y-r<=e.boundingBox.front&&(e.velocity.y*=-e.restitution,e.position.y=e.boundingBox.front+r),e.position.y+r>=e.boundingBox.back&&(e.velocity.y*=-e.restitution,e.position.y=e.boundingBox.back-r),e.position.x-t<=e.boundingBox.left&&(e.velocity.x*=-e.restitution,e.position.x=e.boundingBox.left+t),e.position.x+t>=e.boundingBox.right&&(e.velocity.x*=-e.restitution,e.position.x=e.boundingBox.right-t),e.position.z-n<=e.boundingBox.bot&&(e.velocity.z*=-e.restitution,e.position.z=e.boundingBox.bot+n),e.position.z+n>=e.boundingBox.top&&(e.velocity.z*=-e.restitution,e.position.z=e.boundingBox.top-n)},resolveBoxCollision:(e,t,r)=>{let n=Et.collision.makeVec(e.position,t.position);var i=Object.values(n);let a,o=1/0,s=-1;i[l]<0&&(s=1),r&&(s=-s);for(let h in e.position){let g=Math.abs(t.position[h]-e.position[h]);g<o&&Math.abs(t.position[h]-e.position[h]+e.velocity[h]*1e-17)<g&&(a=h,o=g)}var l=i.indexOf(a);l===0&&(l="x"),l===1&&(l="y"),l===2&&(l="z"),l===3&&(l="w");let c=t.position[l]+t.collisionRadius*t.collisionBoundsScale[l]*s;if(r){let h=c-e.collisionRadius*e.collisionBoundsScale[l]*s;e.position[l]=h}else{let h=c+e.collisionRadius*e.collisionBoundsScale[l]*s;e.position[l]=h}e.velocity[l]=-e.velocity[l]*e.restitution,r&&(e.force[l]=-e.velocity[l]);var f=Et.collision.magnitude(t.acceleration),u=Et.collision.normalize(t.acceleration);e.force[l]=-u[l]*f*t.mass,r&&(e.force[l]=-e.force[l])},resolveSphereCollisions:(e,t,r)=>{r===void 0&&(r=Et.collision.distance(e.position,t.position));let n=Et.collision.normalize(Et.collision.makeVec(e.position,t.position)),i=e.mass+t.mass,a=e.mass/i,o=1-a;e.fixed===!1?(e.position.x+=n.x*o*1.01,e.position.y+=n.y*o*1.01,e.position.z+=n.z*o*1.001):(t.position.x-=n.x*1.01,t.position.y-=n.y*1.01,t.position.z-=n.z*1.01),t.fixed===!1?(t.position.x+=n.x*a*1.01,t.position.y+=n.y*a*1.01,t.position.z+=n.z*a*1.01):(e.position.x+=n.x*1.01,e.position.y+=n.y*1.01,e.position.z+=n.z*1.01),r=Et.collision.distance(e.position,t.position);let s={x:e.velocity.x-t.velocity.x,y:e.velocity.y-t.velocity.y,z:e.velocity.z-t.velocity.z},l=s.x*n.x+s.y*n.y+s.z*n.z;if(l>0){let c=2*l/i;e.fixed===!1&&(e.velocity.x-=c*n.x*t.mass*e.restitution,e.velocity.y-=c*n.y*t.mass*e.restitution,e.velocity.z-=c*n.z*t.mass*e.restitution),t.fixed===!1&&(t.velocity.x+=c*n.x*t.mass*t.restitution/t.mass,t.velocity.y+=c*n.y*t.mass*t.restitution/t.mass,t.velocity.z+=c*n.z*t.mass*t.restitution/t.mass)}}},nbody:{lastTime:performance.now(),G:6674e-14,setupEntities:function(e){for(let t in e){let r=e[t];r.components&&!r.components[this.__node.tag]||this.setupEntity(r)}return e},setupEntity:function(e){return"collisionEnabled"in e||Et.collider.setupEntity(e),e.isAttractor=!0,"attractorGroup"in e||(e.attractorGroup=0),"attractorFrameSearchMax"in e||(e.attractorFrameSearchMax=10),"attractorGroupRules"in e||(e.attractorGroupRules={0:{G:this.G,maxDist:void 0}}),e},__operator:function(e){let t=this.entityKeys;for(let r=0;r<t.length;r++){let n=e[t[r]];if(n.components&&!n.components[this.__node.tag]||!n.mass)continue;let i=0;e:for(let a=0;a<t.length;a++){let o=t[Math.floor(Math.random()*t.length)];i++;let s=e[o];if(s.components&&!s.components[this.__node.tag]||!s.mass||!s.isAttractor)continue e;if(this.attract(n,s,void 0,this.G),i>n.attractorFrameSearchMax)break e}}return e},__node:{tag:"nbody"},attract:function(e,t,r,n=this.G,i){r===void 0&&(r=Et.collision.distance3D(e.position,t.position)),i===void 0&&(i=Et.collision.normalize(Et.collision.makeVec(e.position,t.position)));let a=0;r<.01&&(r=.01),e.attractorGroupRules[t.attractorGroup]?typeof e.attractorGroupRules[t.attractorGroup]=="object"?e.attractorGroupRules[t.attractorGroup].maxDist&&e.attractorGroupRules[t.attractorGroup].maxDist<r||(a=e.attractorGroupRules[t.attractorGroup].G*e.mass*t.mass/(r*r)):a=e.attractorGroupRules[t.attractorGroup]*e.mass*t.mass/(r*r):a=n*e.mass*t.mass/(r*r),e.force.x+=i.x*a,e.force.y+=i.y*a,e.force.z+=i.z*a,t.force.x-=i.x*a,t.force.y-=i.y*a,t.force.z-=i.z*a}},boid:{lastTime:performance.now(),defaultAnchor:{x:Math.random(),y:Math.random(),z:Math.random(),mul:.006},setupEntities:function(e){for(let t in e){let r=e[t];this.setupEntity(r)}return e},setupEntity:function(e){e.position||Et.collider.setupEntity(e);let t=Object.assign({},this.defaultAnchor);t.x*=e.boundingBox.right,t.y*=e.boundingBox.back,t.z*=e.boundingBox.top;let r={cohesion:1e-5,separation:1e-4,alignment:.006,swirl:t,attractor:Object.assign(t,{mul:.002}),useCohesion:!0,useSeparation:!0,useAlignment:!0,useSwirl:!0,useAttractor:!0,useAttraction:!1,groupRadius:200,groupSize:5,searchLimit:5};return e.boid?e.boid=Object.assign(r,e.boid):e.boid=r,this.entityKeys.length>1e3&&(e.boid.groupSize=1,e.boid.searchLimit=1),e},__operator:function(e){let t=performance.now(),r=t-this.lastTime;this.lastTime=t;let n=this.entityKeys,i=n.length,a=1/r,o=-1;e:for(let s=0;s<n.length;s++){o++;let l=e[n[s]],c=[],f=[],u=[l.position.x,l.position.y,l.position.z,0,0,0,l.velocity.x,l.velocity.y,l.velocity.z,0,0,0,0,0,0,0,0,0],h=1,g=-1;t:for(let S=0;S<n.length;S++){if(g++,f.length>l.boid.groupSize||g>l.boid.searchLimit)break t;let A=n[Math.floor(Math.random()*i)];if(g===o||A===n[s]||c.indexOf(A)>-1)continue t;{let O=e[A],C=Math.sqrt((l.position.x-O.position.x)*(l.position.x-O.position.x)+(l.position.y-O.position.y)*(l.position.y-O.position.y)+(l.position.z-O.position.z)*(l.position.z-O.position.z));if(C>l.boid.groupRadius)continue t;{f.push(C),c.push(A);let T;if((l.boid.useSeparation||l.boid.useAlignment)&&(T=l.boid.groupRadius/(C*C),T>l.maxSpeed?T=l.maxSpeed:T<-l.maxSpeed&&(T=-l.maxSpeed)),l.boid.useCohesion&&(u[0]+=(O.position.x-l.position.x)*.5*C*a,u[1]+=(O.position.y-l.position.y)*.5*C*a,u[2]+=(O.position.z-l.position.z)*.5*C*a),isNaN(C)||isNaN(u[0])||isNaN(O.position.x)){console.log(C,s,A,l.position,O.position,u),l.position.x=NaN;return}l.boid.useSeparation&&(u[3]=u[3]+(l.position.x-O.position.x)*T,u[4]=u[4]+(l.position.y-O.position.y)*T,u[5]=u[5]+(l.position.z-O.position.z)*T),l.boid.useAttraction&&O.boid.useAttraction&&Et.nbody.attract(l,O,C),l.boid.useAlignment&&(u[6]=u[6]+O.velocity.x*T,u[7]=u[7]+O.velocity.y*T,u[8]=u[8]+O.velocity.z*T),h++}}}let _=1/h;l.boid.useCohesion?(u[0]=l.boid.cohesion*(u[0]*_),u[1]=l.boid.cohesion*(u[1]*_),u[2]=l.boid.cohesion*(u[2]*_)):(u[0]=0,u[1]=0,u[2]=0),l.boid.useSeparation?(u[3]=l.boid.separation*u[3],u[4]=l.boid.separation*u[4],u[5]=l.boid.separation*u[5]):(u[3]=0,u[4]=0,u[5]=0),l.boid.useAlignment?(u[6]=-(l.boid.alignment*u[6]*_),u[7]=l.boid.alignment*u[7]*_,u[8]=l.boid.alignment*u[8]*_):(u[6]=0,u[7]=0,u[8]=0);let w=[0,0,0];l.boid.useSwirl==!0&&(u[9]=-(l.position.y-l.boid.swirl.y)*l.boid.swirl.mul,u[10]=(l.position.z-l.boid.swirl.z)*l.boid.swirl.mul,u[11]=(l.position.x-l.boid.swirl.x)*l.boid.swirl.mul);let E=[0,0,0];l.boid.useAttractor==!0&&(u[12]=(l.boid.attractor.x-l.position.x)*l.boid.attractor.mul,(l.position.x>l.boundingBox.left||l.position.x<l.boundingBox.right)&&(u[12]*=3),u[13]=(l.boid.attractor.y-l.position.y)*l.boid.attractor.mul,(l.position.y>l.boundingBox.top||l.position.y<l.boundingBox.bottom)&&(u[13]*=3),u[14]=(l.boid.attractor.z-l.position.z)*l.boid.attractor.mul,(l.position.z>l.boundingBox.front||l.position.z<l.boundingBox.back)&&(u[14]*=3)),l.velocity.x=l.velocity.x+u[0]+u[3]+u[6]+u[9]+u[12]+u[15],l.velocity.y=l.velocity.y+u[1]+u[4]+u[7]+u[10]+u[13]+u[16],l.velocity.z=l.velocity.z+u[2]+u[5]+u[8]+u[11]+u[14]+u[17],isNaN(l.velocity.x)&&console.error(l,s,h,l.position,l.velocity,w,E)}return e},__node:{tag:"boid"}},movement:{__node:{tag:"movement"},lastTime:performance.now(),setupEntities:function(e){for(let t in e){let r=e[t];r.components&&!r.components[this.__node.tag]||this.setupEntity(r)}},setupEntity:function(e){return"mass"in e||(e.mass=1),"fixed"in e||(e.fixed=!1),e.force||(e.force={x:0,y:0,z:0}),"mass"in e||(e.mass=1),"gravity"in e||(e.gravity=-9.81),e.acceleration||(e.acceleration={x:0,y:0,z:0}),e.velocity||(e.velocity={x:0,y:0,z:0}),"maxSpeed"in e||(e.maxSpeed=10),e.position||(e.position={x:0,y:0,z:0}),e},__operator:function(e){let t=performance.now(),r=(t-this.lastTime)*.001;this.lastTime=t;let n=this.entityKeys;for(let i=0;i<n.length;i++){let a=e[n[i]];if(!(a.components&&!a.components[this.__node.tag])&&!a.fixed){if(a.mass&&(a.force.x&&(a.acceleration.x+=a.force.x/a.mass,a.force.x=0),a.force.y&&(a.acceleration.y+=a.force.y/a.mass,a.force.y=0),a.force.z&&(a.acceleration.z+=a.force.z/a.mass+a.gravity,a.force.z=0)),a.drag&&(a.acceleration.x&&(a.acceleration.x-=a.acceleration.x*a.drag*r),a.acceleration.y&&(a.acceleration.y-=a.acceleration.y*a.drag*r),a.acceleration.z&&(a.acceleration.z-=a.acceleration.z*a.drag*r)),a.acceleration.x&&(a.velocity.x+=a.acceleration.x*r),a.acceleration.y&&(a.velocity.y+=a.acceleration.y*r),a.acceleration.z&&(a.velocity.z+=a.acceleration.z*r),a.maxSpeed>0){let o=Et.collision.magnitude(a.velocity);if(o>a.maxSpeed){let s=a.maxSpeed/o;a.velocity.x*=s,a.velocity.y*=s,a.velocity.z*=s}}a.velocity.x&&(a.position.x+=a.velocity.x*r),a.velocity.y&&(a.position.y+=a.velocity.y*r),a.velocity.z&&(a.position.z+=a.velocity.z*r)}}return e}}},Vu=class{constructor(e,t,r,n){this.r=e,this.g=t,this.b=r,this.a=n}},yK=class{constructor(){this.scaleX=1,this.scaleY=1,this.offsetX=0,this.offsetY=0,this.loop=!1,this._vbuffer=0,this._coord=0,this.visible=!0,this.intensity=1,this.xy=new Float32Array([]),this.numPoints=0,this.color=new Vu(0,0,0,1),this.webglNumPoints=0}},U1=class extends yK{constructor(e,t){super(),this.currentIndex=0,this.webglNumPoints=t,this.numPoints=t,this.color=e,this.xy=new Float32Array(2*this.webglNumPoints)}setX(e,t){this.xy[e*2]=t}setY(e,t){this.xy[e*2+1]=t}getX(e){return this.xy[e*2]}getY(e){return this.xy[e*2+1]}lineSpaceX(e,t){for(let r=0;r<this.numPoints;r++)this.setX(r,e+t*r)}arrangeX(){this.lineSpaceX(-1,2/this.numPoints)}constY(e){for(let t=0;t<this.numPoints;t++)this.setY(t,e)}shiftAdd(e){let t=e.length;for(let r=0;r<this.numPoints-t;r++)this.setY(r,this.getY(r+t));for(let r=0;r<t;r++)this.setY(r+this.numPoints-t,e[r])}addArrayY(e){if(this.currentIndex+e.length<=this.numPoints)for(let t=0;t<e.length;t++)this.setY(this.currentIndex,e[t]),this.currentIndex++}replaceArrayY(e){if(e.length==this.numPoints)for(let t=0;t<this.numPoints;t++)this.setY(t,e[t])}},YY=(e,t,r)=>{let n={x:0,y:0};return n.x=e.x+t.x*r,n.y=e.y+t.y*r,n},PN=e=>zN(-e.y,e.x),z1=(e,t)=>{let r=pIe(e,t);return r=mK(r),r},fIe=(e,t)=>{let r={x:0,y:0};return r.x=e.x+t.x,r.y=e.y+t.y,r},dIe=(e,t)=>e.x*t.x+e.y*t.y,mK=e=>{let t={x:0,y:0},r=e.x*e.x+e.y*e.y;return r>0&&(r=1/Math.sqrt(r),t.x=e.x*r,t.y=e.y*r),t},zN=(e,t)=>{let r={x:0,y:0};return r.x=e,r.y=t,r},pIe=(e,t)=>{let r={x:0,y:0};return r.x=e.x-t.x,r.y=e.y-t.y,r},hIe=e=>{let t,r={x:0,y:0},n={x:0,y:0},i=[],a=(l,c)=>{i.push({vec2:l,miterLength:c})},o=l=>({x:e[l*2],y:e[l*2+1]});r=z1(o(1),o(0)),t=PN(r),a(t,1);let s=e.length/2;for(let l=1;l<s-1;l++){let c=o(l-1),f=o(l),u=o(l+1);r=z1(f,c),t=PN(r),n=z1(u,f);let h=gIe(r,n),g=yIe(r,h,1);a(h,g)}return r=z1(o(s-1),o(s-2)),t=PN(r),a(t,1),i},gIe=(e,t)=>{let r=fIe(e,t);return r=mK(r),zN(-r.y,r.x)},yIe=(e,t,r)=>{let n=zN(-e.y,e.x);return r/dIe(t,n)},FN=class extends yK{constructor(e,t,r){super(),this.currentIndex=0,this._thicknessRequested=0,this._actualThickness=0,this.webglNumPoints=t*2,this.numPoints=t,this.color=e,this._thicknessRequested=r,this._linePoints=new Float32Array(t*2),this.xy=new Float32Array(2*this.webglNumPoints)}convertToTriPoints(){let e=this._actualThickness/2,t=hIe(this._linePoints);for(let r=0;r<this.numPoints;r++){let n=this._linePoints[2*r],i=this._linePoints[2*r+1],a={x:n,y:i},o=YY(a,t[r].vec2,t[r].miterLength*e),s=YY(a,t[r].vec2,-t[r].miterLength*e);this.xy[r*4]=o.x,this.xy[r*4+1]=o.y,this.xy[r*4+2]=s.x,this.xy[r*4+3]=s.y}}setX(e,t){this._linePoints[e*2]=t}setY(e,t){this._linePoints[e*2+1]=t}lineSpaceX(e,t){for(let r=0;r<this.numPoints;r++)this.setX(r,e+t*r)}setThickness(e){this._thicknessRequested=e}getThickness(){return this._thicknessRequested}setActualThickness(e){this._actualThickness=e}},mIe=class{constructor(e,t){this.debug=!1,this.addLine=this.addDataLine,t==null?this.webgl=e.getContext("webgl",{antialias:!0,transparent:!1}):(this.webgl=e.getContext("webgl",{antialias:t.antialias,transparent:t.transparent,desynchronized:t.deSync,powerPerformance:t.powerPerformance,preserveDrawing:t.preserveDrawing}),this.debug=t.debug==null?!1:t.debug),this.log("canvas type is: "+e.constructor.name),this.log(`[webgl-plot]:width=${e.width}, height=${e.height}`),this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[],this.gScaleX=1,this.gScaleY=1,this.gXYratio=1,this.gOffsetX=0,this.gOffsetY=0,this.gLog10X=!1,this.gLog10Y=!1,this.webgl.clear(this.webgl.COLOR_BUFFER_BIT),this.webgl.viewport(0,0,e.width,e.height),this._progLine=this.webgl.createProgram(),this.initThinLineProgram(),this.webgl.enable(this.webgl.BLEND),this.webgl.blendFunc(this.webgl.SRC_ALPHA,this.webgl.ONE_MINUS_SRC_ALPHA)}get linesData(){return this._linesData}get linesAux(){return this._linesAux}get thickLines(){return this._thickLines}get surfaces(){return this._surfaces}_drawLines(e){let t=this.webgl;e.forEach(r=>{if(r.visible){t.useProgram(this._progLine);let n=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(n,!1,new Float32Array([r.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,r.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let i=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(i,new Float32Array([r.offsetX+this.gOffsetX,r.offsetY+this.gOffsetY]));let a=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(a,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let o=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(o,[r.color.r,r.color.g,r.color.b,r.color.a]),t.bufferData(t.ARRAY_BUFFER,r.xy,t.STREAM_DRAW),t.drawArrays(r.loop?t.LINE_LOOP:t.LINE_STRIP,0,r.webglNumPoints)}})}_drawSurfaces(e){let t=this.webgl;e.forEach(r=>{if(r.visible){t.useProgram(this._progLine);let n=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(n,!1,new Float32Array([r.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,r.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let i=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(i,new Float32Array([r.offsetX+this.gOffsetX,r.offsetY+this.gOffsetY]));let a=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(a,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let o=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(o,[r.color.r,r.color.g,r.color.b,r.color.a]),t.bufferData(t.ARRAY_BUFFER,r.xy,t.STREAM_DRAW),t.drawArrays(t.TRIANGLE_STRIP,0,r.webglNumPoints)}})}_drawTriangles(e){let t=this.webgl;t.bufferData(t.ARRAY_BUFFER,e.xy,t.STREAM_DRAW),t.useProgram(this._progLine);let r=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(r,!1,new Float32Array([e.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,e.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let n=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(n,new Float32Array([e.offsetX+this.gOffsetX,e.offsetY+this.gOffsetY]));let i=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(i,new Int32Array([0,0]));let a=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(a,[e.color.r,e.color.g,e.color.b,e.color.a]),t.drawArrays(t.TRIANGLE_STRIP,0,e.xy.length/2)}_drawThickLines(){this._thickLines.forEach(e=>{if(e.visible){let t=Math.min(this.gScaleX,this.gScaleY);e.setActualThickness(e.getThickness()/t),e.convertToTriPoints(),this._drawTriangles(e)}})}update(){this.clear(),this.draw()}draw(){this._drawLines(this.linesData),this._drawLines(this.linesAux),this._drawThickLines(),this._drawSurfaces(this.surfaces)}clear(){this.webgl.clear(this.webgl.COLOR_BUFFER_BIT)}_addLine(e){e._vbuffer=this.webgl.createBuffer(),this.webgl.bindBuffer(this.webgl.ARRAY_BUFFER,e._vbuffer),this.webgl.bufferData(this.webgl.ARRAY_BUFFER,e.xy,this.webgl.STREAM_DRAW),e._coord=this.webgl.getAttribLocation(this._progLine,"coordinates"),this.webgl.vertexAttribPointer(e._coord,2,this.webgl.FLOAT,!1,0,0),this.webgl.enableVertexAttribArray(e._coord)}addDataLine(e){this._addLine(e),this.linesData.push(e)}addAuxLine(e){this._addLine(e),this.linesAux.push(e)}addThickLine(e){this._addLine(e),this._thickLines.push(e)}addSurface(e){this._addLine(e),this.surfaces.push(e)}initThinLineProgram(){let e=`
      attribute vec2 coordinates;
      uniform mat2 uscale;
      uniform vec2 uoffset;
      uniform ivec2 is_log;

      void main(void) {
         float x = (is_log[0]==1) ? log(coordinates.x) : coordinates.x;
         float y = (is_log[1]==1) ? log(coordinates.y) : coordinates.y;
         vec2 line = vec2(x, y);
         gl_Position = vec4(uscale*line + uoffset, 0.0, 1.0);
      }`,t=this.webgl.createShader(this.webgl.VERTEX_SHADER);this.webgl.shaderSource(t,e),this.webgl.compileShader(t);let r=`
         precision mediump float;
         uniform highp vec4 uColor;
         void main(void) {
            gl_FragColor =  uColor;
         }`,n=this.webgl.createShader(this.webgl.FRAGMENT_SHADER);this.webgl.shaderSource(n,r),this.webgl.compileShader(n),this._progLine=this.webgl.createProgram(),this.webgl.attachShader(this._progLine,t),this.webgl.attachShader(this._progLine,n),this.webgl.linkProgram(this._progLine)}popDataLine(){this.linesData.pop()}removeAllLines(){this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[]}removeDataLines(){this._linesData=[]}removeAuxLines(){this._linesAux=[]}viewport(e,t,r,n){this.webgl.viewport(e,t,r,n)}log(e){this.debug&&console.log("[webgl-plot]:"+e)}},on=class{constructor(){this.plots={}}initPlot(e,t){if(t||(t=new mIe(e.canvas,e.webglOptions)),!e._id)e._id=`plot${Math.floor(Math.random()*1e15)}`;else if(this.plots[e._id]){let l=this.plots[e._id].initial;if(e.lines){for(let c in e.lines)if(l.lines[c]&&Array.isArray(e.lines[c])){let f=e.lines[c];e.lines[c]=l.lines[c]}}e=Object.assign(l,e)}e.overlay&&(typeof e.overlay!="object"&&(e.overlay=document.createElement("canvas"),e.overlay.style.position="absolute",e.overlay.width=e.canvas.width,e.overlay.height=e.canvas.height,e.canvas.appendChild(e.overlay)),e.overlayCtx||(e.overlayCtx=e.overlay.getContext("2d"))),e.width&&(e.canvas.width=e.width,e.canvas.style&&(e.canvas.style.width=e.width+"px"),typeof e.overlay=="object"&&(e.overlay.width=e.width,e.overlay.style&&(e.overlay.style.width=e.width+"px"))),e.height&&(e.canvas.height=e.height,e.canvas.style&&(e.canvas.style.height=e.height+"px"),typeof e.overlay=="object"&&(e.overlay.height=e.height,e.overlay.style&&(e.overlay.style.height=e.height+"px"))),e.lines?.timestamp&&delete e.lines.timestamp,e.lines||(e.lines={});let r={};for(let l in e.lines)r[l]=Object.assign({},r[l]),"viewing"in e.lines[l]||(e.lines[l].viewing=!0),r[l].viewing=e.lines[l].viewing,r[l].sps=e.lines[l].sps,r[l].nSec=e.lines[l].nSec,r[l].nPoints=e.lines[l].nPoints,r[l].ymin=e.lines[l].ymin,r[l].ymax=e.lines[l].ymax,r[l].units=e.lines[l].units;let n={plot:t,settings:e,initial:Object.assign(Object.assign({},e),{lines:r}),anim:()=>{t.update()}};this.plots[e._id]=n;let i=0,a=0;Object.keys(e.lines).forEach(l=>{e.lines[l]?.viewing!==!1&&a++}),e.nLines=a;let o,s;typeof e.overlay=="object"&&(o=e.overlay,s=e.overlayCtx,s.clearRect(0,0,e.overlay.width,e.overlay.height),s.font=e.overlayFont?e.overlayFont:"1em Courier",s.fillStyle=e.overlayColor?e.overlayColor:"white");for(let l in e.lines){let c=e.lines[l];if(Array.isArray(c)&&(c={values:c},e.lines[l]=c),"viewing"in c||(c.viewing=!0),c.color)Array.isArray(c.color)&&(c.color=new Vu(...c.color));else{let w=on.HSLToRGB(360*(i/a)%360,100,50,1);n.initial.lines[l].color=[...w,1],c.color=new Vu(...w,1)}let f;if(c.nSec&&c.sps?f=Math.ceil(c.nSec*c.sps):c.nPoints?f=c.nPoints:c.points?f=c.points:e.linePoints?f=e.linePoints:c.values?f=c.values.length:f=1e3,c.points=f,e.lines[l].viewing===!1)continue;if((c.width||e.lineWidth)&&c.width!==0){let w=e.lineWidth;w||(w=c.width),c.width?c.line=new FN(c.color,f,c.width):e.lineWidth&&(c.line=new FN(c.color,f,e.lineWidth)),c.line.lineSpaceX(-1,2/c.line.numPoints)}else c.line=new U1(c.color,f),c.line.arrangeX();c.values?.length===c.points?c.values.length!==f&&(c.interpolate?c.values.length>f?c.values=on.downsample(c.values,f):c.values.length<f&&(c.values=on.upsample(c.values,f)):c.values.length>c.points?c.values=c.values.slice(c.values.length-c.points):c.values=[...new Array(c.points-c.values.length).fill(0),...c.values]):Array.isArray(c.values)?c.values.length>f?c.values=c.values.slice(c.values.length-f):c.values.length<f&&(c.values=[...new Array(f-c.values.length).fill(0),...c.values]):c.values=new Array(c.points).fill(0);let u=c.ymin,h=c.ymax,g=c.values.length<=1e5;if(u===h?(h=g?Math.max(...c.values):1,u=g?Math.min(...c.values):0):isNaN(h)&&(h=g?Math.max(...c.values):1),isNaN(u)&&(u=g?Math.min(...c.values):0),u>h){let w=u;h=u,u=w}let _=Math.abs(u);if(c.absmax=_>h?_:h,"autoscale"in c||(c.autoscale=!0),c.position||(c.position=e.nLines-i-1),c.autoscale?c.autoscale===2?("clamp"in c||(c.clamp=!0),c.scaled=on.autoscale(c.values,c.position,a,c.centerZero,u,h,c.clamp)):(c.scaled=c.values,c.line.scaleY=on.getYScalar(c.values,a,c.centerZero,u,h),c.line.offsetY=on.getYOffset(c.position,a,u,c.line.scaleY)):c.scaled=c.values,c.scaled.forEach((w,E)=>c.line.setY(E,w)),c.line instanceof FN?t.addThickLine(c.line):c.line instanceof U1&&t.addDataLine(c.line),"xAxis"in c||(c.xAxis=!0),c.xAxis){c.xColor?Array.isArray(c.xColor)&&(c.xColor=new Vu(...c.xColor)):c.xColor=new Vu(1,1,1,.3);let w=new U1(c.xColor,2),E=c.autoscale?(i+1)*2/a-1-1/a:0;w.constY(E),w.arrangeX(),w.xy[2]=1,c.x=w,t.addAuxLine(w)}if(a>1&&c.autoscale&&i!==a-1){e.dividerColor?Array.isArray(e.dividerColor)&&(e.dividerColor=new Vu(...e.dividerColor)):e.dividerColor=new Vu(1,1,1,1);let w=new U1(e.dividerColor,2);w.constY(c.autoscale?(i+1)*2/a-1:1),w.arrangeX(),w.xy[2]=1,c.divider=w,t.addAuxLine(w)}if(typeof e.overlay=="object"&&(c.useOverlay||!("useOverlay"in c))){let w=e.nLines-c.position-1;s.fillText(l,20,o.height*(w+.2)/e.nLines),s.fillText(`${Math.floor(h)===h?h:h?.toFixed(5)} ${c.units?c.units:""}`,o.width-100,o.height*(w+.2)/e.nLines),s.fillText(`${Math.floor(u)===u?u:u?.toFixed(5)} ${c.units?c.units:""}`,o.width-100,o.height*(w+.9)/e.nLines)}i++}return requestAnimationFrame(n.anim),this.plots[e._id]}deinitPlot(e){return typeof e=="string"&&(e=this.plots[e]),e.plot.clear(),e.plot.removeAllLines(),!0}reinitPlot(e,t){if(typeof e=="string"){let r=e;e=this.plots[e],t._id||(t._id=r)}if(e.plot)return e.plot.clear(),e.plot.removeAllLines(),e.settings.overlayCtx&&e.settings.overlayCtx.clearRect(0,0,e.settings.overlay?.width,e.settings.overlay?.height),this.initPlot(t,e.plot)}getChartSettings(e,t){let r=this.plots[e];if(r){let n=Object.assign({},r.initial);for(let i in r.initial.lines)typeof r.initial.lines[i]?.ymax!="number"&&(n.lines[i].ymax=r.settings.lines[i]?.ymax),typeof r.initial.lines[i]?.ymin!="number"&&(n.lines[i].ymin=r.settings.lines[i]?.ymin),t&&(n.lines[i].values=r.settings.lines[i].values);return delete n.canvas,delete n.overlay,delete n.overlayCtx,n}}update(e,t,r=!0){if(typeof e=="string"&&(e=this.plots[e]),!e)return!1;if(t){let n=!1,i,a;typeof e.settings.overlay=="object"&&(i=e.settings.overlay,a=e.settings.overlayCtx,a.font=e.settings.overlayFont?e.settings.overlayFont:"1em Courier",a.fillStyle=e.settings.overlayColor?e.settings.overlayColor:"white");for(let o in t)if(e.settings.lines[o]&&e.settings.lines[o].line){if(e.settings.lines[o]?.viewing===!1)continue;let s=e.settings.lines[o];if(s.values){if(e.settings.mode&&e.settings.mode==="sweep"){"ct"in s||(s.ct=0);let h=g=>{s.ct>s.values.length&&(s.ct=0),s.values[s.ct]=g,s.ct++};Array.isArray(t[o])?t[o].forEach(h):typeof t[o]=="number"?h(t[o]):t[o].values&&t[o].values.forEach(h)}else Array.isArray(t[o])&&s.values?.length<1e5?(s.values.length===0&&(s.values.length=s.points?s.points:1e3),t[o].length===s.values.length?s.values=t[o]:on.circularBuffer(s.values,t[o])):typeof t[o]=="number"?(s.values.push(t[o]),s.values.shift()):t[o]?.values&&(s.values.length===0&&(s.values.length=s.points?s.points:1e3),t[o].values.length===s.values.length?s.values=t[o].values:on.circularBuffer(s.values,t[o].values));s.values.length!==s.points&&(s.interpolate?s.values.length>s.points?s.values=on.downsample(s.values,s.points):s.scaled.length<s.points&&(s.values=on.upsample(s.values,s.points)):s.values.length>s.points?s.values.splice(0,s.values.length-s.points):s.values=new Array(s.points).fill(0).splice(s.points-s.values.length,0,s.values));let l=s.ymin,c=s.ymax,f=s.values.length<=1e5;if(l===c?(c=f?Math.max(...s.values):1,l=f?Math.min(...s.values):0):isNaN(c)&&(c=f?Math.max(...s.values):1),isNaN(l)&&(l=f?Math.min(...s.values):0),l>c){let h=l;c=l,l=h}let u=Math.abs(l);if(s.absmax=u>c?u:c,s.autoscale?s.autoscale===2?s.scaled=on.autoscale(s.values,s.position,e.settings.nLines,s.centerZero,l,c,s.clamp):(s.scaled=s.values,s.line.scaleY=on.getYScalar(s.values,e.settings.nLines,s.centerZero,l,c),s.line.offsetY=on.getYOffset(s.position,e.settings.nLines,l,s.line.scaleY)):s.scaled=s.values,s.scaled.forEach((h,g)=>{!s.autoscale&&s.absmax>1?s.line.setY(g,h/s.absmax):s.line.setY(g,h)}),typeof e.settings.overlay=="object"&&(s.useOverlay||!("useOverlay"in s))){let h=e.settings.nLines-s.position-1,g=i.height*h/e.settings.nLines,_=i.height/e.settings.nLines;if(a.clearRect(0,g,i.width,_),e.settings.mode&&e.settings.mode==="sweep"){a.fillStyle=e.settings.sweepColor?e.settings.sweepColor:"rgba(0,255,0,0.25)",a.beginPath();let w=i.width*s.ct/s.values.length;a.moveTo(w,g),a.lineTo(w,_),a.stroke()}a.fillStyle=e.settings.overlayColor?e.settings.overlayColor:"white",a.fillText(o,20,i.height*(h+.2)/e.settings.nLines),a.fillText(`${Math.floor(c)===c?c:c?.toFixed(5)} ${s.units?s.units:""}`,i.width-100,i.height*(h+.2)/e.settings.nLines),a.fillText(`${Math.floor(l)===l?l:l?.toFixed(5)} ${s.units?s.units:""}`,i.width-100,i.height*(h+.9)/e.settings.nLines)}}}else e.settings.generateNewLines&&!o.includes("timestamp")&&(Array.isArray(t[o])&&(t[o]={values:t[o]}),!t[o].nSec&&!t[o].nPoints&&!e.settings.linePoints&&(t[o].nPoints=1e3),n=!0);if(n)return e.settings.cleanGeneration||Object.keys(e.initial.lines).forEach(o=>{t[o]?t[o]=Object.assign(e.initial.lines[o],t[o]):t[o]=e.initial.lines[o]}),this.reinitPlot(e,{_id:e.settings._id,lines:t}),!0}return r&&requestAnimationFrame(e.anim),!0}updateLine(e,t,r,n,i,a,o){return e.numPoints!==t.length&&(r?e.numPoints>t.length?t=on.downsample(t,e.numPoints):e.numPoints<t.length&&(t=on.upsample(t,e.numPoints)):t.length>e.numPoints?t=t.slice(t.length-e.numPoints):t=[...new Array(t.length).fill(0),...t]),n&&(t=on.autoscale(t,i,a,o)),t.forEach((s,l)=>e.setY(l,s)),!0}static autoscale(e,t=0,r=1,n=!1,i,a,o){if(e?.length===0)return e;let s=typeof a=="number"?a:e.length<=1e5?Math.max(...e):1,l=typeof i=="number"?i:e.length<=1e5?Math.min(...e):0,c=1/r,f=1;if(n){let u=Math.max(Math.abs(l),Math.abs(s));return u!==0&&(f=c/u),e.map(h=>(o&&(h<l&&(h=l),h>s&&(h=s)),h*f+(c*(t+1)*2-1-c)))}else return s===l?s!==0?f=c/s:l!==0&&(f=c/Math.abs(l)):f=c/(s-l),e.map(u=>(o&&(u<l&&(u=l),u>s&&(u=s)),2*((u-l)*f-1/(2*r))+(c*(t+1)*2-1-c)))}static getYScalar(e,t=1,r=!1,n,i){if(e?.length===0)return e;let a=typeof i=="number"?i:e.length<=1e5?Math.max(...e):1,o=typeof n=="number"?n:e.length<=1e5?Math.min(...e):0,s=1/t,l=1;if(r){let c=Math.max(Math.abs(o),Math.abs(a));return c!==0&&(l=s/c),2*l}else return a===o?a!==0?l=s/a:o!==0&&(l=s/Math.abs(o)):l=s/(a-o),2*l}static getYOffset(e=0,t=1,r=0,n=1){let i=1/t,a=i*(e+1)*2-1-i;return r!==0?a-=r*n+1/t:a-=n+1/t,a}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t,r=1){if(e.length>t){let n=new Array(t),i=e.length/t,a=e.length-1,o=0,s=0;for(let l=i;l<e.length;l+=i){let c=Math.round(l);c>a&&(c=a);for(let f=o;f<c;f++)n[s]+=e[f];n[s]/=(c-o)*r,s++,o=c}return n}else return e}static upsample(e,t,r=1){var n=function(u,h,g){return(u+(h-u)*g)*r},i=new Array(t),a=(e.length-1)/(t-1);i[0]=e[0];for(var o=1;o<t-1;o++){var s=o*a,l=Math.floor(s),c=Math.ceil(s),f=s-l;i[o]=n(e[l],e[c],f)}return i[t-1]=e[e.length-1],i}static interpolate(e,t,r=1){return e.length>t?on.downsample(e,t,r):e.length<t?on.upsample(e,t,r):e}static HSLToRGB(e,t,r,n=255){t/=100,r/=100;let i=(1-Math.abs(2*r-1))*t,a=i*(1-Math.abs(e/60%2-1)),o=r-i/2,s=0,l=0,c=0;return 0<=e&&e<60?(s=i,l=a,c=0):60<=e&&e<120?(s=a,l=i,c=0):120<=e&&e<180?(s=0,l=i,c=a):180<=e&&e<240?(s=0,l=a,c=i):240<=e&&e<300?(s=a,l=0,c=i):300<=e&&e<360&&(s=i,l=0,c=a),s=(s+o)*n,l=(l+o)*n,c=(c+o)*n,[s,l,c]}static circularBuffer(e,t){if(t.length<e.length){let r=e.slice(t.length),n=e.length;e.splice(0,n,...r,...t)}else if(t.length>e.length){let r=e.length;e.splice(0,r,...t.slice(t.length-r))}else e.splice(0,e.length,...t);return e}static formatDataForCharts(e,t){if(Array.isArray(e)){if(Array.isArray(e[0])){let r={};if(e.forEach((n,i)=>{r[i]=n}),e=r,isNaN(e[0][0]))return}else if(t){if(e={[t]:e},isNaN(e[t][0]))return}else if(e={0:e},isNaN(e[0][0]))return}else if(typeof e=="object"){for(let r in e)if(typeof e[r]=="number"?e[r]=[e[r]]:e[r]?.values&&typeof e[r].values=="number"&&(e[r].values=[e[r].values]),isNaN(e[r][0]))return}else if(typeof e=="string"){let r;if(e.includes(`\r
`)){let n=e.split(`\r
`);e={},n.forEach((i,a)=>{i.includes("	")?r=i.split("	"):i.includes(",")?r=i.split(","):i.includes("|")&&(r=i.split("|")),r&&r.forEach((o,s)=>{if(o.includes(":")){let[l,c]=o.split(":"),f=parseFloat(c);isNaN(f)||(e[l]=[f])}else{let l=parseFloat(o);isNaN(l)||(e[s]=[l])}})})}else e.includes("	")?r=e.split("	"):e.includes(",")?r=e.split(","):e.includes("|")&&(r=e.split("|"));e={},r&&r.forEach((n,i)=>{if(n.includes(":")){let[a,o]=n.split(":"),s=parseFloat(o);isNaN(s)||(e[a]=[s])}else{let a=parseFloat(n);isNaN(a)||(e[i]=[a])}})}else typeof e=="number"&&(t?e={[t]:[e]}:e={0:[e]});return e}static padTime(e,t,r,n){let i=(e[0]-t)/r/n;return[...new Array(n-e.length).map((a,o)=>t+i*(o+1)),...e]}static interpolateForTime(e,t,r){return on.interpolate(e,Math.ceil(r*t))}};var vIe=Object.defineProperty,bIe=(e,t,r)=>t in e?vIe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ut=(e,t,r)=>(bIe(e,typeof t!="symbol"?t+"":t,r),r),go=class{constructor(){}static genSineWave(e=20,t=1,r=1,n=512,i=0,a=1){for(var o=[],s=[],l=1/n,c=0;c<r;c+=l){var f=Math.sin(2*Math.PI*e*c)*t;f+=Math.sin(2*Math.PI*i*c)*a,o.push(f),s.push(c)}return[s,o]}static getSineAmplitude(e=20,t=1,r=0,n=0){return Math.sin(this.TWO_PI*e*r+n)*t}static mean(e){var t=e.reduce((r,n)=>n+=r);return t/e.length}static mode(e){return e.sort((t,r)=>e.filter(n=>n===t).length-e.filter(n=>n===r).length).pop()}static std(e,t=void 0){let r=t;t||(r=this.mean(e));let n=0;for(let i=0;i<e.length;i++){let a=e[i]-r;n+=a*a}return Math.sqrt(n/e.length)}static relError(e=[],t=[],r=!0){if(e.length!==t.length)throw new Error("Input arrays of same length!");let n=e.length,i=new Array(e.length);for(let a=0;a<n;a++){let o=(e[a]-t[a])/e[a];r&&(o=Math.abs(o)),i[a]=o}return i}static informationEntropy(e=[]){let t=e.length,r=new Array(t);for(let n=0;n<t;n++){let i=e[n]*Math.log(e[n]);isNaN(i)&&(i=0),r[n]=i}return r}static zscore(e){let t=this.mean(e),r=this.std(e,t),n=new Array().length(e.length);for(let i=0;i<e.length;i++)n[i]=(e[i]-t)/r;return n}static variance(e){var t=this.mean(e);return e.reduce((r,n)=>r+(n-t)**2,0)/e.length}static dot(e,t){for(var r=0,n=0;n<e.length;n++)r+=e[n]*t[n];return r}static cross3D(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}static magnitude(e){var t=0;return e.forEach(r=>{t+=r*r}),Math.sqrt(t)}static distance(e,t){var r=0;return e.forEach((n,i)=>{r+=(t[i]-n)*(t[i]-n)}),Math.sqrt(r)}static midpoint(e=[1,2,3],t=[3,4,5]){return e.map((r,n)=>(r+t[n])*.5)}static normalize(e){var t=0;t=this.magnitude(e);var r=new Array(e.length);return e.forEach((n,i)=>{r[i]=n*t}),r}static normalizeSeries(e=[],t=!0){let r=Math.max(...e),n=Math.min(...e);return t==!1&&(r=Math.max(r,Math.abs(n)),n=0),r-n===0&&(n=0,r===0&&(r=1e-13)),e.map(i=>(i-n)/(r-n))}static quadraticFormula(e,t,r){let n=Math.sqrt(t*t-4*e*r);if(!isNaN(n))return["complex","complex"];let i=1/(2*e);if(n===0)return[t*i];let a=-t;return[(a+n)*i,(a-n)*i]}static newtonsMethod(e=a=>Math.pow(a,5)+a*a-a-.2,t=0,r=1,n=.01,i=10){let a=[];for(let o=0;o<i;o++){let s=Math.random()*(r-t),l=e(s),c=e(s+n),f=(c-l)/n,u=s+n;for(;Math.abs(f)>n;){let _=-l/E,w=u+_;l=c,c=e(w);let E=(c-l)/(w-u)}let h,g=a.find((_,w)=>{if(Math.abs(xn1-_)<n)return h=w,!0});g?a[h]=(xn1+g)*.5:a.push(xn1)}return a}static makeVec(e,t){var r=[];return e.forEach((n,i)=>{r.push(t[i]-n)}),r}static getBufferedValueByCoordinates(e=new Array(300).fill(1),t=[10,10,2],r=[1,2,1],n=void 0){let i=(o=0,s=0)=>{if(s===t.length)return o;if(s==0)o+=r[s];else if(t[s]==0)dimsAt0++;else{let l=(c=r[s],f=s-1)=>(c*=t[f],f--,f==0?c:l(c,f));o+=l(r[s]+1,s-1)}return s++,i(o,s)},a=i();if(n){if(r[r.length-1]===0){let o=0,s=0;for(;s!==r.length-1;)r[s]!==0&&(o=s),s++;return e[a-o+n]}return e[a-t.length+n]}else{if(r[r.length-1]===0){let o=0,s=0;for(;s!==r.length-1;)r[s]!==0&&(o=s),s++;return e.slice(a-o,a+1)}return e.slice(a-t.length,a+1)}}static forBufferedMat(e=new Array(100).fill(1),t=[10,10],r=(n,i,a,o)=>n+a+o){let n=[],i=0,a=(s=0,l=s+1)=>{let c=new Array(e.length);for(let f=0;f<t[s];f++)n[s]=f,t[l]?a(l):(c[i]=r(e[i],i,...n),i++);return c},o=(s,l=s+1)=>{let c=new Array(e.length);for(let f=0;f<t[s];f++)if(n[s]=f,t[l])a(l);else for(let u=0;u<t.length;u++)c[i]=r[u](e[i],i,...n),i++;return c};if(typeof r=="function")return a();if(Array.isArray(r))return o()}static mapBufferedMat(e=new Array(100).fill(1),t=[10,10],r=(n,i,a,o)=>(console.log(`value:${n}, idx:${i}, x:${a},y:${o}`),n+a+o)){let n=new Array(t.length).fill(0),i=(s,l=0)=>{if(s[l]>=t[l]){if(s[l]=0,l++,l===t.length)return;i(s,l)}else s[l]++},a=new Array(e.length),o=0;if(typeof r=="function")for(;o<e.length;)a[o]=r(e[o],o,...n),o+=t.length,i(n);else if(Array.isArray(r))for(;o<e.length;)r.forEach(s=>{a[o]=s(e[o],o,...n),o++,i(n)});return a}static combinations(e=["a","b","c"],t=3){var r=[];return t<=0?r.push([]):go.combinations(e,t-1).forEach(function(n){e.forEach(function(i){r.push([i].concat(n))})}),r}static generateCoordinateSpace(e=[10,10,10],t=[-10,-10,-10],r=[1,1,1],n=void 0){for(let s=0;s<e.length;s++)if(t[s]>e[s]){let l=e[s];e[s]=t[s],t[s]=l}let i=[],a=[...e],o=a.length-1;for(i.push([...a]);a[0]>=t[0];){let s=c=>{if(a[c]<=t[c]){if(c===0||(a[c]=e[c],c--,c<0))return;typeof r[c]=="function"?a[c]-=r[c](a[c]):a[c]-=r[c],s(c)}},l=o;typeof r[l]=="function"?a[l]-=r[l](a[l]):a[l]-=r[l],i.push([...a]),s(l),n&&(i[i.length-1]=n(i[i.length-1]))}return i}static calcVectorField(e=[[0,0],[0,1],[1,0],[1,1]],t=(r,n)=>[r*10,n*10]){return e.map(r=>t(...r))}static transpose(e){return e[0].map((t,r)=>e.map(n=>n[r]))}static matmul(e,t){for(var r=e.length,n=e[0].length,i=t.length,a=t[0].length,o=new Array(r),s=0;s<r;++s){o[s]=new Array(a);for(var l=0;l<a;++l){o[s][l]=0;for(var c=0;c<n;++c)o[s][l]+=e[s][c]*t[c][l]}}return o}static matscale(e,t){let r=[];for(var n=0;n<e.length;n++){r[n]=[];for(let i=0;i<e[0].length;i++)r[n][i]=e[n][i]*t}return r}static matadd(e,t){let r=[];for(let i=0;i<e.length;i++){r[i]=[];for(var n=0;n<e[0].length;n++)r[i][n]=e[i][n]+t[i][n]}return r}static matsub(e,t){let r=[];for(let i=0;i<e.length;i++){r[i]=[];for(var n=0;n<e[0].length;n++)r[i][n]=e[i][n]-t[i][n]}return r}static histogram(e=[],t=1,r=void 0){let n=[...e];n.sort(function(l,c){return l-c});let i=Math.min(...n);if(typeof r=="number"){let l=Math.max(...n);t=Math.abs((l-i)/(r-1))}let a=i,o=[],s=[];for(let l=0;l<n.length;l++){let c=t*a;if(n[l]>i+c){a++,c+=t;let u=i+c+c*.5;o.push(u),s.push(0)}s[s.length-1]++}return[o,s]}static normalDistribution(e=[],t=!0,r=1e-4){let n=this.mean(e),i=this.variance(e),a=e.length,o=[],s=1/(this.TWO_PI*i),l=1/i,c=0;for(let f=0;f<a;f++){let u=Math.exp(-.5*Math.pow((e[f]-n)*l,2))*s;u<r&&(u=0),o.push(u),c+=u}if(t){let f=1/c;o=o.map(u=>u*f)}return o}static expectedValue(e=[],t=this.normalDistribution(e)){return e.reduce((r,n,i)=>r+n*t[i])}static originMoment(e=[],t=this.normalDistribution(e),r=1){return e.reduce((n,i,a)=>n+Math.pow(i,r)*t[a])}static centralMoment(e=[],t=this.normalDistribution(e),r=1){let n=this.mean(e);return e.reduce((i,a,o)=>i+Math.pow(a-n,r)*t[o]/e.length)}static linearDiscriminantAnalysis(e=[],t=[]){let r=this.mean(e),n=this.mean(t),i=this.cov1d(e,t),a=this.normalDistribution(e),o=[];for(let s=0;s<e.length;s++)o.push(x[s]*i*n-.5*r*i*n+Math.log10(a[s]));return o}static conv1D(e=[],t=[1/3,1/3,1/3],r=Math.floor(t.length*.5)){let n=[],i=1/t.length;if(r>0){let s=new Array(r).fill(0);e=[...s,...e,...s]}let a=Math.floor(t.length*.5),o=e.length-t.length+a;for(let s=a;s<o;s++){let l=0;for(let c=0;c<t.length;c++)l+=e[s-a]*t[c];n.push(l*i)}return n}static conv2D(e=[[],[],[]],t=[[],[],[]],r=0){let n=new Array(e.length-Math.ceil(t.length*.5)).fill([]),i,a=go.transpose(a);if(r>0){let w=new Array(r).fill(0);i=go.transpose(e);for(let E=0;E<i.length;E++)i[E]=[...w,...i[E],...w];e=go.transpose(i);for(let E=0;E<e.length;E++)e[E]=[...w,...e[E],...w]}let o=Math.floor(t[0].length*.5),s=Math.floor(a[0].length*.5),l=e[0].length-t[0].length+o,c=i[0].length-a[0].length+s,f=1/(t[0].length*a[0].length),u=l*c,h=o,g,_=s;for(;h<u;){let w=0;g=h%e[0].length,g===0&&_++;for(let E=0;E<t[0].length;E++){for(let S=0;S<a[0].length;E++)w+=e[_-s+S][g-o+E]*t[S][E];n[_].push(w*f)}h++}return n}static cov2d(e){var t=this.transpose(e),r=[],n=[],i=[];e.forEach((_,w)=>{n.push(this.mean(_))}),t.forEach((_,w)=>{i.push(this.mean(_))}),e.forEach((_,w)=>{r.push([]);for(var E=0;E<_.length;E++)r[w].push((e[w][E]-n[w])*(e[w][E]-i[E])/(_.length-1))});for(var a=this.transpose(r),o=r.length,s=r[0].length,l=a.length,c=a[0].length,f=new Array(o),u=0;u<o;++u){f[u]=new Array(c);for(var h=0;h<c;++h){f[u][h]=0;for(var g=0;g<s;++g)f[u][h]+=r[u][g]*a[g][h]/(e[0].length-1)}}return f}static cov1d(e=[],t=[]){return this.cov2d([e,t])}static cov3d(e=[],t=[],r=[]){return[[this.cov1d(e,e),this.cov1d(e,t),this.cov1d(e,r)],[this.cov1d(t,e),this.cov1d(t,t),this.cov1d(t,r)],[this.cov1d(r,e),this.cov1d(r,t),this.cov1d(r,r)]]}static covNd(e=[]){let t=[];e.forEach((r,n)=>{t.push([]),e.forEach((i,a)=>{t[n].push(this.cov1d(r,i))})})}static eigens2x2(e=[[1,2],[3,4]]){let t=e[0][0]*e[1][1]-e[0][1]*e[1][0],r=(e[0][0]+e[1][1])*.5,n=Math.sqrt(r*r-t),i=r+n,a=r-n;return[i,a]}static eigenvectors2x2(e=[[1,2],[3,4]],t=[1,2]){let r=[-e[0][1],e[0][0]-t[0]];r[0]===0&&r[1]===0&&(r[0]=e[1][1]-t[0],r[1]=-e[1][0]);let n=[-e[0][1],e[0][0]-t[1]];return n[0]===0&&n[1]===0&&(n[0]=e[1][1]-t[1],n[1]=-e[1][0]),[r,n]}static fastpca2d(e,t){let r=this.cov1d(e,t),n=this.eigens2x2(r);n[1]>n[0]&&n.reverse();let i=this.eigenvectors2x2(r,n);return console.log(n,i),[n,i]}static crosscorrelation(e,t){var r=[...t,...Array(t.length).fill(0)],n=this.mean(e),i=this.mean(t),a=e.reduce((h,g)=>h+=Math.pow(g-n,2));a=Math.sqrt(Math.abs(a));var o=t.reduce((h,g)=>h+=Math.pow(g-n,2));o=Math.sqrt(Math.abs(o));let s=a*o;s===0&&(s=1e-26);for(var l=1/s,c=new Array(e.length).fill(0),f=0;f<e.length;f++){var u=e.reduce((h,g,_)=>h+=(g-n)*(r[f+_]-i));c[f]=u*l}return c}static autocorrelation(e){var t=[...e,...Array(e.length).fill(0)],r=this.mean(e),n=e.reduce((c,f)=>c+=Math.pow(f-r,2));n=Math.sqrt(Math.abs(n));let i=n*arr2Est;i===0&&(i=1e-26);for(var a=1/i,o=new Array(e.length).fill(0),s=0;s<e.length;s++){var l=e.reduce((c,f,u)=>c+=(f-r)*(t[s+u]-r));o[s]=l*a}return o}static autocorrelation2dNormalized(e){let t=[];for(let r=0;r<e.length;r++){t.push([]);for(let n=0;n<e[r].length;n++){let i=0,a=0;for(let o=0;o<e.length;o++)for(let s=0;s<e[o].length;s++)i+=e[r][n]*e[e.length-1-o][e[r].length-1-s],a+=e[r][n]*e[e.length-1][e[r].length-1];t[r][n]=i/a-1}}return t}static crosscorrelation2d(e,t){let r=[];for(let n=0;n<e.length;n++){r.push([]);for(let i=0;i<e[n].length;i++){let a=0;for(let o=0;o<t.length;o++)for(let s=0;s<t[o].length;s++)a+=e[n][i]*t[t.length-1-o][t[n].length-1-s];r[n][i]=a}}return r}static crosscorrelation2dNormalized(e,t){let r=[];for(let n=0;n<e.length;n++){r.push([]);for(let i=0;i<e[n].length;i++){let a=0,o=0;for(let s=0;s<t.length;s++)for(let l=0;l<t[s].length;l++)a+=e[n][i]*t[mat2d.length-1-s][t[n].length-1-l],o+=e[n][i]*t[t.length-1][t[n].length-1];r[n][i]=a/o-1}}return r}static correlograms(e=[[],[]]){var t=[];return e.forEach((r,n)=>{e.forEach((i,a)=>{a>=n&&t.push(go.crosscorrelation(r,i))})}),t}static dft(e=[]){for(var t=6.283185307179586,r=[],n=[],i=[],a=0;a<e.length;a++){r.push(0),n.push(0);for(var o=0;o<e.length;o++){var s=t*a*o/e.length;r[a]=r[a]+e[o]*Math.cos(s),n[a]=n[a]-e[o]*Math.sin(s)}i.push(Math.sqrt(r[a]*r[a]+n[a]*n[a]))}function l(u){return[...u.slice(Math.ceil(u.length*.5),u.length),...u.slice(0,Math.ceil(u.length*.5))]}i=l(i);let c=i.length*.5,f=i.map((u,h)=>h-c);return{real:r,imag:n,freqs:f,mags:i}}static sma(e=[],t){for(var r=[],n=0;n<e.length;n++)if(n==0)r.push(e[0]);else if(n<t){var i=e.slice(0,n+1);r.push(i.reduce((a,o)=>o+=a)/(n+1))}else{var i=e.slice(n-t,n);r.push(i.reduce((o,s)=>s+=o)/t)}return r}static sum(e=[]){if(e.length>0){var t=e.reduce((r,n)=>n+=r);return t}else return 0}static reduceArrByFactor(e,t=2){return e.filter((n,i)=>i%t===0)}static makeArr(e,t,r){for(var n=[],i=(t-e)/(r-1),a=0;a<r;a++)n.push(e+i*a);return n}static autoscale(e,t=1,r=0,n=!1){if(e?.length===0)return e;let i=Math.max(...e),a=Math.min(...e),o=1/t,s;if(n){let l=Math.max(Math.abs(a),Math.abs(i));return s=o/l,e.map(c=>c*s+(o*(r+1)*2-1-o))}else return s=o/(i-a),e.map(l=>2*((l-a)*s-1/(2*t))+(o*(r+1)*2-1-o))}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t,r=1){if(e.length>t){let n=new Array(t),i=e.length/t,a=e.length-1,o=0,s=0;for(let l=i;l<e.length;l+=i){let c=Math.round(l);c>a&&(c=a);for(let f=o;f<c;f++)n[s]+=e[f];n[s]/=(c-o)*r,s++,o=c}return n}else return e}static interpolateArray(e,t,r=1){var n=function(u,h,g){return(u+(h-u)*g)*r},i=new Array,a=(e.length-1)/(t-1);i[0]=e[0];for(var o=1;o<t-1;o++){var s=o*a,l=Math.floor(s),c=Math.ceil(s),f=s-l;i[o]=n(e[l],e[c],f)}return i[t-1]=e[e.length-1],i}static isExtrema(e,t="peak"){let r=[...e];if(r.length%2===0&&r.pop(),e.length>1){let n=!0;for(let i=0;i<r.length;i++){let a=r[i];if(t==="peak"){if(i<Math.floor(r.length*.5)&&a>=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&a>=r[Math.floor(r.length*.5)]){n=!1;break}}else if(t==="valley"){if(i<Math.floor(r.length*.5)&&a<=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&a<=r[Math.floor(r.length*.5)]){n=!1;break}}else if(i<Math.floor(r.length*.5)&&a<=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&a<=r[Math.floor(r.length*.5)]){n=!1;break}}if(t!=="peak"&&t!=="valley"&&n===!1){n=!0;for(let i=0;i<r.length;i++){let a=r[i];if(i<Math.floor(r.length*.5)&&a>=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&a>=r[Math.floor(r.length*.5)]){n=!1;break}}}return n}else return}static isCriticalPoint(e,t="peak"){let r=[...e];if(r.length%2===0&&r.pop(),e.length>1){let n=!0;for(let i=0;i<r.length;i++){let a=r[i];if(t==="peak"){if(i<r.length*.5&&a<=0){n=!1;break}else if(i>r.length*.5&&a>0){n=!1;break}}else if(t==="valley"){if(i<r.length*.5&&a>=0){n=!1;break}else if(i>r.length*.5&&a<0){n=!1;break}}else if(i<r.length*.5&&a>=0){n=!1;break}else if(i>r.length*.5&&a<0){n=!1;break}}if(t!=="peak"&&t!=="valley"&&n===!1){n=!0;for(let i=0;i<r.length;i++){let a=r[i];if(i<r.length*.5&&a<=0){n=!1;break}else if(i>r.length*.5&&a>0){n=!1;break}}}return n}else return}static getPeakThreshold(e,t,r){let n,i=e.filter((a,o)=>{if(t.indexOf(o)>-1)return!0});return r===0?n=this.mean(i):n=(r+this.mean(i))*.5,n}static column(e,t){let r=new Array(e.length).fill(0).map(()=>new Array(1).fill(0));for(let n=0;n<e.length;n++)r[n][0]=e[n][t];return r}static flatten_vector(e){let t=[];for(let r=0;r<e.length;r++)t[r]=e[r][0];return t}static squared_difference(e,t){let r=0;for(let n=0;n<e.length;n++)r=r+Math.pow(e[n]-t[n],2);return r}static shift_deflate(e,t,r){let n=Math.sqrt(this.matmul(this.transpose(r),r)),i=this.matscale(r,1/n),a=this.matscale(this.matmul(i,this.transpose(i)),t);return this.matsub(e,a)}static eigenvalue_of_vector(e,t){return ev=this.matmul(this.matmul(this.transpose(t),e),t),ev}static power_iteration(e,t=1e-5,r=1e3){let n=e.length,i=new Array(n).fill(0).map(()=>new Array(1).fill(Math.sqrt(n))),a=this.eigenvalue_of_vector(e,i),o=1,s=0;for(;o>t&&s<r;){let l=JSON.parse(JSON.stringify(a)),c=this.matmul(e,i);i=this.normalize(c),a=this.eigenvalue_of_vector(e,i),o=Math.abs(a-l),s++}return[a,i]}static eigens(e,t=1e-4,r=1e3){let n=[],i=[];for(let a=0;a<e.length;a++){let o=this.power_iteration(e,t,r),s=o[0],l=o[1];n[a]=s,i[a]=this.flatten_vector(l),e=this.shift_deflate(e,s,l)}return[n,i]}static pca(e,t=1e-5){let r=e.length,n=new Array(r),i=new Array(r),a=this.transpose(e);n[0]=this.column(e,0);let o=1,s=0;for(;espilon>t;){s++,i[0]=this.matmul(a,n[0]);let c=this.matmul(this.transpose(n[0]),n[0]);i[0]=this.matscale(i[0],1/c);let f=Math.sqrt(this.matmul(this.transpose(i[0]),i[0]));i[0]=this.matscale(i[0],1/f);let u=this.matmul(e,i[0]),h=this.matmul(this.transpose(i[0]),i[0]);u=this.matscale(u,1/h),o=this.squared_difference(n[0],u),n[0]=JSON.parse(JSON.stringify(u))}return this.matmul(this.transpose(n[0]),n[0])}static circularBuffer(e,t){if(Array.isArray(t))if(t.length<e.length){let r=e.slice(t.length),n=e.length;e.splice(0,n,...r,...t)}else if(t.length>e.length){let r=e.length;e.splice(0,r,t.slice(r-t.length))}else e.splice(0,e.length,...t);else e.push(t),e.shift();return e}static HSLToRGB(e,t,r,n=255){t/=100,r/=100;let i=(1-Math.abs(2*r-1))*t,a=i*(1-Math.abs(e/60%2-1)),o=r-i/2,s=0,l=0,c=0;return 0<=e&&e<60?(s=i,l=a,c=0):60<=e&&e<120?(s=a,l=i,c=0):120<=e&&e<180?(s=0,l=i,c=a):180<=e&&e<240?(s=0,l=a,c=i):240<=e&&e<300?(s=a,l=0,c=i):300<=e&&e<360&&(s=i,l=0,c=a),s=(s+o)*n,l=(l+o)*n,c=(c+o)*n,[s,l,c]}static p300(e=[],t=[],r=[],n=256){let i=Math.floor(n/10),a=this.sma(t,i),o=this.peakDetect(a,"peak",i),s=this.mean(a),l=this.std(a,s),c=0,f=[];return o.length>0&&e.forEach((u,h)=>{for(;r[o[c]]<u+200&&(c++,!!o[c]););let g=0,_=[];for(;r[o[c+g]]<u+600&&(_.push(c+g),g++,!!o[c+g]););if(_.length>1){let w=[];_.forEach(A=>{w.push(a[o[A]])});let E=Math.max(...w),S=_[w.indexOf(E)];f.push({event_timestamp:u,event_index:h,peak_timestamp:r[[o[S]]],signal_index:[o[S]],signal_amplitude:t[[o[S]]],zscore:(a[o[S]]-s)/l})}else _.length===1&&f.push({event_timestamp:u,event_index:h,peak_timestamp:r[o[_[0]]],signal_index:o[_[0]],signal_amplitude:t[[o[_[0]]]],zscore:(a[o[_[0]]]-s)/l})}),f}},Lt=go;Ut(Lt,"TWO_PI",Math.PI*2);Ut(Lt,"C",299792458);Ut(Lt,"G",66743e-15);Ut(Lt,"h",662607015e-42);Ut(Lt,"R",8314.32);Ut(Lt,"Ra",287);Ut(Lt,"H",69.3);Ut(Lt,"kbar",1054571817e-43);Ut(Lt,"kB",1380649e-29);Ut(Lt,"ke",89875517923e-1);Ut(Lt,"me",91093837015e-41);Ut(Lt,"mp",167262192369e-38);Ut(Lt,"mn",167492749804e-38);Ut(Lt,"P0",101325);Ut(Lt,"T0",288.15);Ut(Lt,"p0",1.225);Ut(Lt,"Na",60220978e16);Ut(Lt,"y",1.405);Ut(Lt,"M0",28.96643);Ut(Lt,"g0",9.80665);Ut(Lt,"Re",6378100);Ut(Lt,"B",1458e-9);Ut(Lt,"S",110.4);Ut(Lt,"Sigma",365e-12);Ut(Lt,"imgkernels",{edgeDetection:[[-1,-1,-1],[-1,8,-1],[-1,-1,-1]],boxBlur:[[1/9,1/9,1/9],[1/9,1/9,1/9],[1/9,1/9,1/9]],sobelLeft:[[1,0,-1],[2,0,-2],[1,0,-1]],sobelRight:[[-1,0,1],[-2,0,2],[-1,0,1]],sobelTop:[[1,2,1],[0,0,0],[-1,-2,-1]],sobelBottom:[[-1,2,1],[0,0,0],[1,2,1]],identity:[[0,0,0],[0,1,0],[0,0,0]],gaussian3x3:[[1,2,1],[2,4,2],[1,2,1]],guassian7x7:[[0,0,0,5,0,0,0],[0,5,18,32,18,5,0],[0,18,64,100,64,18,0],[5,32,100,100,100,32,5],[0,18,64,100,64,18,0],[0,5,18,32,18,5,0],[0,0,0,5,0,0,0]],emboss:[[-2,-1,0],[-1,1,1],[0,1,2]],sharpen:[[0,-1,0],[-1,5,-1],[0,-1,0]]});Ut(Lt,"integral",(e=n=>n,t=[],r=.01)=>{let n=0;for(let i=t[0];i<t[1];i+=r){let a=e(i);n+=a*r}return n});Ut(Lt,"dintegral",(e=(i,a)=>i+a,t=[[],[]],r=.01,n=r)=>{let i=0;for(let a=t[0][0]+r;a<t[0][1];a+=r)for(let o=t[1][0]+n;o<t[1][1];o+=n){let s=e(a,o);i+=s*r*n}return i});Ut(Lt,"tintegral",(e=(a,o,s)=>a+o+s,t=[[],[],[]],r=.01,n=r,i=r)=>{let a=0;for(let o=t[0][0]+r;o<t[0][1];o+=r)for(let s=t[1][0]+n;s<t[1][1];s+=n)for(let l=t[2][0]+i;l<t[2][1];l+=i){let c=e(o,s,l);a+=c*r*n*i}return a});Ut(Lt,"pintegral",(e=n=>n,t=[],r=.01)=>{let n=0,i,a;for(let o=t[0];o<t[1];o+=r)i=a,a=e(o),i&&(n+=go.distance([0,i],[r,a]));return n});Ut(Lt,"meshgrid",go.generateCoordinateSpace);Ut(Lt,"autocorrelation2d",e=>{let t=[];for(let r=0;r<e.length;r++){t.push([]);for(let n=0;n<e[r].length;n++){let i=0;for(let a=0;a<e.length;a++)for(let o=0;o<e[a].length;o++)i+=e[r][n]*e[e.length-1-a][e[r].length-1-o];t[r][n]=i}}return t});Ut(Lt,"lerp",go.makeArr);Ut(Lt,"upsample",go.interpolateArray);Ut(Lt,"lerp",(e,t,r,n=!0)=>{function i(o,s,l){return(1-l)*o+l*s}function a(o,s,l,c=!0){if(l<=2)return[o,s];let f=1/l,u=new Array(l);u[0]=o;for(let h=1;h<=l;h++)u[h]=i(o,s,f*h),c&&(u[h]=Math.floor(u[h]));return u}});Ut(Lt,"peakDetect",(e,t="peak",r=49)=>{let n=Math.floor(r*.5),i=[];for(let a=0;a<e.length-r;a++)go.isExtrema(e.slice(a,a+r),t)&&i.push(a+n-1);return i});Object.assign(Math,Lt);var _Ie={accelConstant:1/8192,gyroConstant:1/65.5,gyroXAngle:0,gyroYAngle:0,gyroZAngle:0,px:0,py:0,pz:0,sps:100,lastAccelTime:Date.now(),lastGyroTime:Date.now(),__operator:function(e){if(!("ax"in e)&&!("gx"in e))return;if(!e.timestamp)if(e.ax&&Array.isArray(e.ax)||e.gx&&Array.isArray(e.gx)){let r=e.ax?e.ax.length:e.gx.length,n=Date.now(),i=[n-r*this.sps*1e3,n];e.timestamp=Lt.upsample(i,r)}else e.timestamp=Date.now();let t;if(e.ax){let r=(n,i,a,o)=>{i=i*this.accelConstant,a=a*this.accelConstant,o=o*this.accelConstant;let s=Math.atan(a/Math.sqrt(i*i)+o*o*180/Math.PI)+this.accelXError,l=Math.atan(-i/Math.sqrt(a*a)+o*o*180/Math.PI)+this.accelYError;return{ax:i,ay:a,az:o,roll:s,pitch:l}};Array.isArray(e.timestamp)?t=e.timestamp.map((n,i)=>r(n,e.ax[i],e.ay[i],e.az[i])):t=r(e.timestamp,e.ax,e.ay,e.az)}if(e.gx){let r=(i,a,o,s)=>{let l=i-this.lastGyroTime;return this.lastGyroTime=i,a=a*this.gyroConstant+this.gyroXError,o=o*this.gyroConstant+this.gyroYError,s=s*this.gyroConstant+this.gyroZError,this.gyroXAngle+=a*l,this.gyroYAngle+=o*l,this.gyroZAngle+=s*l,{gx:a,gy:o,gz:s,roll:this.gyroXAngle,pitch:this.gyroYAngle,yaw:this.gyroZAngle}},n;Array.isArray(e.timestamp)?(n=e.timestamp.map((i,a)=>{if(t){let o=r(i,e.gx[a],e.gy[a],e.gz[a]);t.roll=t.roll*.04+o.roll*.96,t.pitch=t.pitch*.04+o.pitch*.96,t.yaw=n.yaw}else return r(i,e.gx[a],e.gy[a],e.gz[a])}),t||(t=n)):(n=r(e.timestamp,e.gx,e.gy,e.gz),t?(t.roll=t.roll*.04+n.roll*.96,t.pitch=t.pitch*.04+n.pitch*.96,t.yaw=n.yaw):t=n)}else(this.gyroXAngle||this.gyroYAngle||this.gyroZAngle)&&(t.roll=t.roll*.04+this.gyroXAngle*.96,t.pitch=t.pitch*.04+this.gyroYAngle*.96,t.yaw=this.gyroXAngle);if(t.ax){let r=(n,i)=>{let a=n-this.lastAccelTime;return this.lastAccelTime=n,this.px+=i.ax*a*a*Math.cos(this.pitch*Math.PI*.005555555555),this.py+=i.ay*a*a*Math.cos(this.roll*Math.PI*.005555555555),this.pz+=i.az*a*a*Math.sin(this.pitch*Math.PI*.005555555555),i.px=this.px,i.py=this.py,i.pz=this.pz,i};Array.isArray(e.timestamp)?e.timestamp.map((n,i)=>{r(n,t)}):r(e.timestamp,t)}return t}},vK=class{type;freq;sps;Q;dbGain;a0=0;a1=0;a2=0;b0=0;b1=0;b2=0;x1=0;x2=0;y1=0;y2=0;constructor(e,t,r,n=1/Math.sqrt(2),i=0){if(["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"].indexOf(e)<0){console.error("Valid types: 'lowpass','highpass','bandpass','notch','peak','lowshelf','highshelf'");return}this.type=e,this.freq=t,this.sps=r,this.Q=n,this.dbGain=i;let o=Math.pow(10,i/40),s=2*Math.PI*t/r,l=Math.sin(s),c=Math.cos(s),f=l/(2*n),u=Math.sqrt(o+o);this[e](o,l,c,f,u),this.b0/=this.a0,this.b1/=this.a0,this.b2/=this.a0,this.a1/=this.a0,this.a2/=this.a0}lowpass(e,t,r,n,i){this.b0=(1-r)*.5,this.b1=1-r,this.b2=(1-r)*.5,this.a0=1+n,this.a1=-2*r,this.a2=1-n}highpass(e,t,r,n,i){this.b0=(1+r)*.5,this.b1=-(1+r),this.b2=(1+r)*.5,this.a0=1+n,this.a1=-2*r,this.a2=1-n}bandpass(e,t,r,n,i){this.b0=n,this.b1=0,this.b2=-n,this.a0=1+n,this.a1=-2*r,this.a2=1-n}notch(e,t,r,n,i){this.b0=1,this.b1=-2*r,this.b2=1,this.a0=1+n,this.a1=-2*r,this.a2=1-n}peak(e,t,r,n,i){this.b0=1+n*e,this.b1=-2*r,this.b2=1-n*e,this.a0=1+n/e,this.a1=-2*r,this.a2=1-n/e}lowshelf(e,t,r,n,i){this.b0=e*(e+1-(e-1)*r+i*t),this.b1=2*e*(e-1-(e+1)*r),this.b2=e*(e+1-(e-1)*r-i*t),this.a0=e+1+(e+1)*r+i*t,this.a1=2*(e-1+(e+1)*r),this.a2=e+1+(e-1)*r-i*t}highshelf(e,t,r,n,i){this.b0=e*(e+1+(e-1)*r+i*t),this.b1=2*e*(e-1+(e+1)*r),this.b2=e*(e+1-(e-1)*r-i*t),this.a0=e+1-(e+1)*r-i*t,this.a1=2*(e-1-(e+1)*r),this.a2=e+1-(e-1)*r-i*t}applyFilter(e){let t=this.b0*e+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;return this.x2=this.x1,this.x1=e,this.y2=this.y1,this.y1=t,t}zResult(e){try{let t=Math.pow(Math.sin(Math.PI*e*2/(2*this.sps)),2);return(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*t+16*this.b0*this.b2*t*t)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*t+16*this.a2*t*t)}catch{return-200}}static calcCenterFrequency(e,t){return(e+t)/2}static calcBandwidth(e,t){return t-this.calcCenterFrequency(e,t)}static calcBandpassQ(e,t,r=Math.pow(10,Math.floor(Math.log10(e)))){return r*Math.sqrt((e-t)*(e+t))/(2*t)}static calcNotchQ(e,t,r=Math.pow(10,Math.floor(Math.log10(e)))){return r*e*t/Math.sqrt((e-t)*(e+t))}},DN={refdata:[],lowpass:void 0,smoothed:[],timestamp:[],peaks:[],valleys:[],peak_distances:[],valley_distances:[],beats:[],lastPeak:0,lastValley:0,sps:100,maxFreq:4,limit:10,__onconnected:function(){if(!this.lowpass){let e=this.maxFreq;e||(e=1),e>1&&(e*=.5),this.lowpass=new vK("lowpass",this.maxFreq,this.sps),this.peakFinderWindow=Math.floor(this.sps/this.maxFreq),this.peakFinderWindow%2===0&&(this.peakFinderWindow+=1),this.peakFinderWindow<5&&(this.peakFinderWindow=5),this.midpoint=Math.round(this.peakFinderWindow*.5)}},__operator:function(e){if(!("red"in e)&&!("heg"in e)&&!("raw"in e))return;let t=e.red?e.red:e.heg?e.heg:e.raw;if(!("timestamp"in e))if(Array.isArray(t)){let n=Date.now(),i;t&&(i=t.length);let a=[n-t.length*this.sps*1e3,n];e.timestamp=Lt.upsample(a,t.length)}else e.timestamp=Date.now();let r=(n,i)=>{n&&this.refdata.push(n),this.timestamp.push(i);let a;if(this.refdata.length>this.peakFinderWindow&&(this.refdata.shift(),this.timestamp.shift()),this.smoothed.push(this.lowpass.applyFilter(this.refdata[this.refdata.length-1])),this.smoothed.length>this.peakFinderWindow&&this.smoothed.shift(),this.smoothed.length===this.peakFinderWindow&&(Lt.isExtrema(this.smoothed,"valley")?this.valleys.push({value:this.smoothed[this.smoothed.length-this.midpoint?this.midpoint:1],timestamp:this.timestamp[this.timestamp.length-this.midpoint?this.midpoint:1]}):Lt.isExtrema(this.smoothed,"peak")&&this.peaks.push({value:this.smoothed[this.smoothed.length-this.midpoint?this.midpoint:1],timestamp:this.timestamp[this.timestamp.length-this.midpoint?this.midpoint:1]}),this.valleys.length>2&&this.peaks.length>2)){if(this.valleys[this.valleys.length-1].timestamp<this.peaks[this.peaks.length-2].timestamp&&this.peaks.splice(this.peaks.length-1),this.peaks[this.peaks.length-1].timestamp<this.valleys[this.valleys.length-2].timestamp&&this.valleys.splice(this.valleys.length-1),this.valley_distances.push({distance:this.valleys[this.valleys.length-1].timestamp-this.valleys[this.valleys.length-2].timestamp,timestamp:this.valleys[this.valleys.length-1].timestamp,peak0:this.valleys[this.valleys.length-1].value,peak1:this.valleys[this.valleys.length-2].value}),this.peak_distances.push({distance:this.peaks[this.peaks.length-1].timestamp-this.peaks[this.peaks.length-2].timestamp,timestamp:this.peaks[this.peaks.length-1].timestamp,peak0:this.peaks[this.peaks.length-1].value,peak1:this.peaks[this.peaks.length-2].value}),this.peak_distances.length>1&&this.valley_distances.length>1&&this.lastPeak<this.peaks[this.peaks.length-1].timestamp&&this.lastValley<this.peaks[this.peaks.length-1].timestamp)if(this.valley_distances[this.valley_distances.length-1].timestamp>this.peak_distances[this.peak_distances.length-1].timestamp){let o,s=0;this.beats.length<1?o=60/(5e-4*(this.peak_distances[this.peak_distances.length-1].distance+this.valley_distances[this.valley_distances.length-1].distance)):this.beats[this.beats.length-1].timestamp!==this.peak_distances[this.peak_distances.length-1].timestamp&&(o=60/(5e-4*(this.peak_distances[this.peak_distances.length-1].dt+this.valley_distances[this.valley_distances.length-1].dt)),s=Math.abs(o-this.beats[this.beats.length-1].bpm)),a={timestamp:this.peak_distances[this.peak_distances.length-1].timestamp,change:s,bpm:o,height0:this.peak_distances[this.peak_distances.length-1].peak0-this.valley_distances[this.valley_distances.length-1].peak0,height1:this.peak_distances[this.peak_distances.length-1].peak1-this.valley_distances[this.valley_distances.length-1].peak1},this.beats.push(a),this.lastPeak=this.peaks[this.peaks.length-1].timestamp,this.lastValley=this.peaks[this.peaks.length-1].timestamp}else{let o,s=0;this.beats.length<2?o=60/(5e-4*(this.peak_distances[this.peak_distances.length-2].distance+this.valley_distances[this.valley_distances.length-2].distance)):this.beats[this.beats.length-1].timestamp!==this.peak_distances[this.peak_distances.length-2].timestamp&&(o=60/(5e-4*(this.peak_distances[this.peak_distances.length-2].distance+this.valley_distances[this.valley_distances.length-2].distance)),s=Math.abs(o-this.beats[this.beats.length-2].bpm)),a={timestamp:this.peak_distances[this.peak_distances.length-2].timestamp,change:s,bpm:o,height0:this.peak_distances[this.peak_distances.length-2].peak0-this.valley_distances[this.valley_distances.length-2].peak0,height1:this.peak_distances[this.peak_distances.length-2].peak1-this.valley_distances[this.valley_distances.length-2].peak1},Array.isArray(a.timestamp)&&(a.timestamp=a.timestamp[0]),this.beats.push(a),this.lastPeak=this.peaks[this.peaks.length-1].timestamp,this.lastValley=this.peaks[this.peaks.length-1].timestamp}this.peaks.length>this.limit&&this.peaks.shift(),this.valleys.length>this.limit&&this.valleys.shift(),this.peak_distances.length>this.limit&&this.peak_distances.shift(),this.valley_distances.length>this.limit&&this.valley_distances.shift(),this.beats.length>this.limit&&this.beats.shift()}return a};if(e.red){if("ir"in e&&!Array.isArray(e.red))return r(e.red+e.ir,e.timestamp);let n;return e.ir?n=e.red.map((i,a)=>r(i+e.ir[a],e.timestamp[a])).filter(i=>{if(i)return!0}):n=e.red.map((i,a)=>r(i,e.timestamp[a])).filter(i=>{if(i)return!0}),n}else{if(e.raw)return Array.isArray(e.raw)?e.raw.map((i,a)=>r(i,e.timestamp[a])).filter(i=>{if(i)return!0}):r(e.raw,e.timestamp);if(Array.isArray(e.heg))return Array.isArray(e.heg)?e.heg.map((i,a)=>r(i,e.timestamp[a])).filter(i=>{if(i)return!0}):r(e.heg,e.timestamp)}}},wIe={sps:250,intervals:{},watch:["0"],tolerance:.2,__onconnected:e=>{e.watch.forEach(t=>e.intervals[t]={lowpass:new vK("lowpass",20,e.sps),filtered:[],averaged:[]})},__operator:function(e){let t=5,r=50,n={},i=!1,a=(o,s)=>{let l=this.intervals[o].lowpass.applyFilter(s);if(this.intervals[o].filtered.push(l),this.intervals[o].averaged.push(l),this.intervals[o].filtered.length>t)if(this.intervals[o].averaged.length>r){this.intervals[o].averaged.splice(0,t);let c=Lt.mean(this.intervals[o].averaged);Math.abs(Math.min(...this.intervals[o].filtered))>Math.abs(c)+this.tolerance&&(this.intervals[o].filtered.length=0,i=!0,n[o]=!0)}else this.intervals[o].filtered.shift()};for(let o in this.intervals)e[o]&&(Array.isArray(e[o])?e[o].forEach(s=>{a(o,s)}):typeof e[o]=="number"&&a(o,e[o]));if(i)return n}},ov=class{static autoscale(e,t=0,r=1,n=!1,i,a,o){if(e?.length===0)return e;let s=a||Math.max(...e),l=i||Math.min(...e),c=1/r,f=1;if(n){let u=Math.max(Math.abs(l),Math.abs(s));return u!==0&&(f=c/u),e.map(h=>(o&&(h<l&&(h=l),h>s&&(h=s)),h*f+(c*(t+1)*2-1-c)))}else return s===l?s!==0?f=c/s:l!==0&&(f=c/Math.abs(l)):f=c/(s-l),e.map(u=>(o&&(u<l&&(u=l),u>s&&(u=s)),2*((u-l)*f-1/(2*r))+(c*(t+1)*2-1-c)))}static genTimestamps(e,t){let r=Date.now(),n=[r-e*1e3/t,r];return ov.upsample(n,e)}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t,r=1){if(e.length>t){let n=new Array(t),i=e.length/t,a=e.length-1,o=0,s=0;for(let l=i;l<e.length;l+=i){let c=Math.round(l);c>a&&(c=a);for(let f=o;f<c;f++)n[s]+=e[f];n[s]/=(c-o)*r,s++,o=c}return n}else return e}static upsample(e,t,r=1){var n=function(u,h,g){return(u+(h-u)*g)*r},i=new Array(t),a=(e.length-1)/(t-1);i[0]=e[0];for(var o=1;o<t-1;o++){var s=o*a,l=Math.floor(s),c=Math.ceil(s),f=s-l;i[o]=n(e[l],e[c],f)}return i[t-1]=e[e.length-1],i}static interpolate(e,t,r=1){return e.length>t?ov.downsample(e,t,r):e.length<t?ov.upsample(e,t,r):e}static HSLToRGB(e,t,r,n=255){t/=100,r/=100;let i=(1-Math.abs(2*r-1))*t,a=i*(1-Math.abs(e/60%2-1)),o=r-i/2,s=0,l=0,c=0;return 0<=e&&e<60?(s=i,l=a,c=0):60<=e&&e<120?(s=a,l=i,c=0):120<=e&&e<180?(s=0,l=i,c=a):180<=e&&e<240?(s=0,l=a,c=i):240<=e&&e<300?(s=a,l=0,c=i):300<=e&&e<360&&(s=i,l=0,c=a),s=(s+o)*n,l=(l+o)*n,c=(c+o)*n,[s,l,c]}static circularBuffer(e,t){if(t.length<e.length){let r=e.slice(t.length),n=e.length;e.splice(0,n,...r,...t)}else if(t.length>e.length){let r=e.length;e.splice(0,r,...t.slice(t.length-r))}else e.splice(0,e.length,...t);return e}static reformatData(e,t){if(Array.isArray(e)){if(Array.isArray(e[0])){let r={};if(e.forEach((n,i)=>{r[i]=n}),e=r,isNaN(e[0][0]))return}else if(t){if(e={[t]:e},isNaN(e[t][0]))return}else if(e={0:e},isNaN(e[0][0]))return}else if(typeof e=="object"){for(let r in e)if(typeof e[r]=="number"?e[r]=[e[r]]:e[r]?.values&&typeof e[r].values=="number"&&(e[r].values=[e[r].values]),isNaN(e[r][0]))return}else if(typeof e=="string"){let r;if(e.includes(`\r
`)){let n=e.split(`\r
`);e={},n.forEach((i,a)=>{i.includes("	")?r=i.split("	"):i.includes(",")?r=i.split(","):i.includes("|")&&(r=i.split("|")),Array.isArray(r)&&r.forEach((o,s)=>{if(o.includes(":")){let[l,c]=o.split(":"),f=parseFloat(c);if(f)e[l]=[f];else return}else{let l=parseFloat(o);if(l)e[s]=[l];else return}})})}else e.includes("	")?r=e.split("	"):e.includes(",")?r=e.split(","):e.includes("|")&&(r=e.split("|"));e={},Array.isArray(r)&&r.forEach((n,i)=>{if(n.includes(":")){let[a,o]=n.split(":"),s=parseFloat(o);if(s)e[a]=[s];else return}else{let a=parseFloat(n);if(a)e[i]=[a];else return}})}else typeof e=="number"&&(t?e={[t]:[e]}:e={0:[e]});return e}static padTime(e,t,r,n){let i=(e[0]-t)/r/n;return[...new Array(n-e.length).map((o,s)=>t+i*(s+1)),...e]}static interpolateForTime(e,t,r){return ov.interpolate(e,Math.ceil(r*t))}isTypedArray(e){return ArrayBuffer.isView(e)&&Object.prototype.toString.call(e)!=="[object DataView]"}recursivelyAssign=(e,t)=>{for(let r in t)typeof t[r]=="object"?typeof e[r]=="object"?this.recursivelyAssign(e[r],t[r]):e[r]=this.recursivelyAssign({},t[r]):e[r]=t[r];return e};spliceTypedArray(e,t,r){let n=e.subarray(0,t),i;r&&(i=e.subarray(r+1));let a;return(n.length>0||i?.length>0)&&(a=new e.constructor(n.length+i.length)),n.length>0&&a.set(n),i&&i.length>0&&a.set(i,n.length),a}},bK=ov;ZY(bK,"bufferValues",(e,t,r,n)=>{if(!Array.isArray(r)&&typeof r=="object"&&(r=Object.keys(r)),!n){let a=Object.keys(e);r?n=new Float32Array(a.length*r.length):typeof e[a[0]][t]=="object"?(r=Object.keys(e[a[0]][t]),n=new Float32Array(a.length*r.length)):n=new Float32Array(a.length)}let i=0;for(let a in e)if(e[a][t])if(r)for(let o=0;o<r.length;o++)n[i]=e[a][t][r[o]],i++;else n[i]=e[a][t],i++;return n});var SIe=/^([<>])?(([1-9]\d*)?([xcbB?hHiIfdsp]))*$/,xIe=/([1-9]\d*)?([xcbB?hHiIfdsp])/g,BN=(e,t,r)=>String.fromCharCode(...new Uint8Array(e.buffer,e.byteOffset+t,r)),RN=(e,t,r,n)=>new Uint8Array(e.buffer,e.byteOffset+t,r).set(n.split("").map(i=>i.charCodeAt(0))),kIe=(e,t,r)=>BN(e,t+1,Math.min(e.getUint8(t),r-1)),EIe=(e,t,r,n)=>{e.setUint8(t,n.length),RN(e,t+1,r-1,n)},OIe=e=>({x:t=>[1,t,0],c:t=>[t,1,r=>({u:n=>BN(n,r,1),p:(n,i)=>RN(n,r,1,i)})],"?":t=>[t,1,r=>({u:n=>!!n.getUint8(r),p:(n,i)=>n.setUint8(r,i)})],b:t=>[t,1,r=>({u:n=>n.getInt8(r),p:(n,i)=>n.setInt8(r,i)})],B:t=>[t,1,r=>({u:n=>n.getUint8(r),p:(n,i)=>n.setUint8(r,i)})],h:t=>[t,2,r=>({u:n=>n.getInt16(r,e),p:(n,i)=>n.setInt16(r,i,e)})],H:t=>[t,2,r=>({u:n=>n.getUint16(r,e),p:(n,i)=>n.setUint16(r,i,e)})],i:t=>[t,4,r=>({u:n=>n.getInt32(r,e),p:(n,i)=>n.setInt32(r,i,e)})],I:t=>[t,4,r=>({u:n=>n.getUint32(r,e),p:(n,i)=>n.setUint32(r,i,e)})],f:t=>[t,4,r=>({u:n=>n.getFloat32(r,e),p:(n,i)=>n.setFloat32(r,i,e)})],d:t=>[t,8,r=>({u:n=>n.getFloat64(r,e),p:(n,i)=>n.setFloat64(r,i,e)})],s:t=>[1,t,r=>({u:n=>BN(n,r,t),p:(n,i)=>RN(n,r,t,i.slice(0,t))})],p:t=>[1,t,r=>({u:n=>kIe(n,r,t),p:(n,i)=>EIe(n,r,t,i.slice(0,t-1))})]}),KY=new RangeError("Structure larger than remaining buffer"),AIe=new RangeError("Not enough values for structure"),Yp=class extends bK{static toDataView(e){if(!(e instanceof DataView))if(typeof e=="string"&&parseInt(e)&&(e=parseInt(e)),typeof e=="string"){let t=new TextEncoder,r={};for(let i in Yp.codes)for(;e.indexOf(i)>-1;){let a=e.indexOf(i);e=e.replace(i,""),r[a]=i}let n=Array.from(t.encode(e));for(let i in r)n.splice(parseInt(i),0,Yp.codes[r[i]]);e=new DataView(new Uint8Array(n).buffer)}else if(typeof e=="number"){let t=e;e<256?(e=new DataView(new ArrayBuffer(1)),e.setUint8(0,t)):e<65536?(e=new DataView(new ArrayBuffer(2)),e.setInt16(0,t)):(e=new DataView(new ArrayBuffer(4)),e.setUint32(0,t))}else e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer?e=new DataView(e):Array.isArray(e)?e=new DataView(Uint8Array.from(e).buffer):typeof e=="object"&&(e=new TextEncoder().encode(JSON.stringify(e)));return e}static searchBuffer(e,t,r){for(var n=t,i=e,a=Yp.boyerMoore(n),o=a.byteLength,s=[],l=a(i);l!==-1&&(s.push(l),!(r&&s.length>=r));l=a(i,l+o));return s}static bytesToInt16(e,t){let r=(255&e)<<8|255&t;return(r&32768)>0?r|=4294901760:r&=65535,r}static bytesToUInt16(e,t){return e*256+t}static Uint16ToBytes(e){return[e&255,e>>8&255]}static bytesToInt24(e,t,r){let n=(255&e)<<16|(255&t)<<8|255&r;return(n&8388608)>0?n|=4278190080:n&=16777215,n}static bytesToUInt24(e,t,r){return e*65536+t*256+r}static Uint24ToBytes(e){return[e&255,e>>8&255,e>>16&255]}static bytesToInt32(e,t,r,n){let i=(255&e)<<24|(255&t)<<16|(255&r)<<8|255&n;return(i&2147483648)>0?i|=0:i&=4294967295,i}static bytesToUInt32(e,t,r,n){return e*16777216+t*65536+r*256+n}static Uint32ToBytes(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]}static get2sCompliment(e,t){return e>4294967296?null:e<<32-t>>32-t}static getSignedInt(...e){let t=0;function r(n){for(var i=0,a=!0;n--;)if(a){let o=e[t++];i+=o&127,o&128&&(i-=128),a=!1}else i*=256,i+=e[t++];return i}return r(e.length)}static asUint8Array(e){if(e instanceof Uint8Array)return e;if(typeof e=="string"){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n>127)throw new TypeError("Only ASCII patterns are supported");t[r]=n}return t}else return new Uint8Array(e)}static boyerMoore(e){var t=Yp.asUint8Array(e),r=t.length;if(r===0)throw new TypeError("patternBuffer must be at least 1 byte long");for(var n=256,i=new Int32Array(n),a=0;a<n;a++)i[a]=-1;for(var o=0;o<r;o++)i[t[o]]=o;var s=(l,c,f)=>{var u=Yp.asUint8Array(l);c===void 0&&(c=0),f===void 0&&(f=u.length);for(var h=t,g=i,_=f-h.length,w=h.length-1,E,S=c;S<=_;S+=E){E=0;for(var A=w;A>=0;A--){var O=u[S+A];if(h[A]!==O){E=Math.max(1,A-g[O]);break}}if(E===0)return S}return-1};return s.byteLength=t.byteLength,s}static struct(e){let t=[],r=0,n=SIe.exec(e);if(!n)throw new RangeError("Invalid format string");let i=OIe(n[1]==="<"),a=(u,h)=>i[h](u?parseInt(u,10):1);for(;n=xIe.exec(e);)((u,h,g)=>{for(let _=0;_<u;++_,r+=h)g&&t.push(g(r))})(...a(...n.slice(1)));let o=(u,h)=>{if(u.byteLength<(h|0)+r)throw KY;let g=new DataView(u,h|0);return t.map(_=>_.u(g))},s=(u,h,...g)=>{if(g.length<t.length)throw AIe;if(u.byteLength<h+r)throw KY;let _=new DataView(u,h);new Uint8Array(u,h,r).fill(0),t.forEach((w,E)=>w.p(_,g[E]))},l=(...u)=>{let h=new ArrayBuffer(r);return s(h,0,...u),h},c=u=>o(u,0);function*f(u){for(let h=0;h+r<=u.byteLength;h+=r)yield o(u,h)}return Object.freeze({unpack:c,pack:l,unpack_from:o,pack_into:s,iter_unpack:f,format:e,size:r})}},qN=Yp;ZY(qN,"codes",{"\\n":10,"\\r":13,"\\t":9,"\\s":32,"\\b":8,"\\f":12,"\\":92});var IIe={sps:250,nSec:1,watch:["0","1","2","3"],data:{},rms:{},__operator:function(e){return this.watch.forEach(t=>{e[t]&&(this.data[t]||(Array.isArray(e[t])?this.data[t]=new Array(Math.floor(this.sps*this.nSec)).fill(e[t][0]):this.data[t]=new Array(Math.floor(this.sps*this.nSec)).fill(e[t])),qN.circularBuffer(this.data[t],e[t]))}),e.timestamp?Array.isArray(e.timestamp)?this.rms.timestamp=e.timestamp[e.timestamp.length-1]:this.rms.timestamp=e.timestamp:this.rms.timestamp=Date.now(),new Promise(async t=>{await Promise.all(this.watch.map(async r=>{this.data[r]?this.rms[r]=Math.sqrt(Math.abs(this.data[r].reduce((n,i,a)=>n+i*i)/this.data[r].length)):delete this.rms[r]})),t(this.rms)})}},CIe={bufferSize:250,watch:["0","1","2","3"],data:{},blocking:!1,__onconnected:function(e){for(let t in e.watch)e.data[t]=new Array(e.bufferSize).fill(0)},__operator:function(e){let t=[];return this.watch.forEach(r=>{e[r]&&(qN.circularBuffer(this.data[r],e[r]),t.push(this.data[r]))}),t}},TIe={beat_detect:DN,accel_gyro:_Ie,heartrate:DN,breath:Object.assign({},DN),blink_detect:wIe,rms:IIe,circularBuffer2d:CIe};TIe.breath.maxFreq=.2;var Ys=GN(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]),NIe=GN(["deltaX","deltaY"]),LIe=GN(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function _K(e,t){let r={type:e.type};r.isTrusted=e.isTrusted,r.bubbles=e.bubbles,r.cancelBubble=e.cancelBubble,r.cancelable=e.cancelable,r.composed=e.composed,r.defaultPrevent=e.defaultPrevented,r.eventPhase=e.eventPhase,r.returnValue=e.returnValue,r.currentTarget=e.currentTarget.id?e.currentTarget.id:e.currentTarget.constructor.name,r.target=r.currentTarget,r.srcElement=r.currentTarget,t(r)}function PIe(e,t,r){r&&e.preventDefault&&e.preventDefault(),NIe(e,t)}function FIe(e,t,r){r&&e.preventDefault&&e.preventDefault()}function DIe(e,t,r){for(let n of t)r[n]=e[n]}function GN(e){return function(r,n){let i={type:r.type};DIe(r,e,i),n(i)}}function VN(e,t,r){r&&e.preventDefault&&e.preventDefault();let n=[],i={type:e.type,touches:n};for(let a=0;a<e.touches.length;++a){let o=e.touches[a];n.push({pageX:o.pageX,pageY:o.pageY})}t(i)}var HN=1,xK={};for(;HN<222;)xK[HN]=!0,HN++;function wK(e,t,r){let{keyCode:n}=e;xK[n]&&(r&&e.preventDefault&&(n<110||n>123)&&e.preventDefault(),LIe(e,t))}var sv={contextmenu:FIe,mousedown:Ys,mousemove:Ys,mouseup:Ys,pointerdown:Ys,pointermove:Ys,pointerup:Ys,pointerlockchange:Ys,webkitpointerlockchange:Ys,focus:_K,blur:_K,pointerout:Ys,touchstart:VN,touchmove:VN,touchend:VN,wheel:PIe,keydown:wK,keyup:wK};function W1(e,t,r,n){r||(r="proxy"+Math.floor(Math.random()*1e15));let i=s=>{t?t.postMessage({route:"handleProxyEvent",args:[s,r]}):kK(s,r)},a=Object.entries(sv);for(let[s,l]of a)e.addEventListener(s,function(c){l(c,i,n)});sv.keydown&&globalThis.addEventListener("keydown",function(s){sv.keydown(s,i,n)}),sv.keyup&&globalThis.addEventListener("keyup",function(s){sv.keyup(s,i,n)});let o=()=>{let s=e.getBoundingClientRect();i({type:"resize",left:s.left,top:s.top,width:e.clientWidth,height:e.clientHeight})};return o(),globalThis.addEventListener("resize",o),r}var WN=class{addEventListener(t,r){this.__listeners===void 0&&(this.__listeners={});let n=this.__listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(r)===-1&&n[t].push(r)}hasEventListener(t,r){if(this.__listeners===void 0)return!1;let n=this.__listeners;return n[t]!==void 0&&n[t].indexOf(r)!==-1}removeEventListener(t,r){if(this.__listeners===void 0)return;let i=this.__listeners[t];if(i!==void 0){let a=i.indexOf(r);a!==-1&&i.splice(a,1)}}dispatchEvent(t,r){if(this.__listeners===void 0)return;let i=this.__listeners[t.type];if(i!==void 0){r?t.target=r:t.target=this;let a=i.slice(0);for(let o=0,s=a.length;o<s;o++)a[o].call(this,t)}}};function SK(){}var JN=class extends WN{constructor(){super();this.__listeners={};this.style={};this.setPointerCapture=()=>{};this.releasePointerCapture=()=>{};this.getBoundingClientRect=()=>({left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height});this.handleEvent=r=>{r.type==="resize"&&(this.left=r.left,this.top=r.top,this.width=r.width,this.height=r.height,typeof this.proxied=="object"&&(this.proxied.style.width=this.width+"px",this.proxied.style.height=this.height+"px",this.proxied.clientWidth=this.width,this.proxied.clientHeight=this.height)),r.preventDefault=SK,r.stopPropagation=SK,this.dispatchEvent(r,this.proxied)};this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}focus(){}blur(){}},Kp=class{constructor(){this.targets={};this.makeProxy=(t,r=void 0)=>{t||(t=`proxyReceiver${Math.floor(Math.random()*1e15)}`);let n;this.targets[t]?n=this.targets[t]:(n=new JN,this.targets[t]=n),typeof r=="object"&&(r.proxy=n,n.proxied=r,typeof WorkerGlobalScope<"u"&&(r.style=n.style),n.width&&(r.style.width=n.width+"px",r.clientWidth=n.width),n.height&&(r.style.height=n.height+"px",r.clientHeight=n.height),r.setPointerCapture=n.setPointerCapture.bind(n),r.releasePointerCapture=n.releasePointerCapture.bind(n),r.getBoundingClientRect=n.getBoundingClientRect.bind(n),r.addEventListener=n.addEventListener.bind(n),r.removeEventListener=n.removeEventListener.bind(n),r.handleEvent=n.handleEvent.bind(n),r.dispatchEvent=n.dispatchEvent.bind(n),r.focus=n.focus.bind(n),r.blur=n.blur.bind(n))};this.getProxy=t=>this.targets[t];this.handleEvent=(t,r)=>{if(this.targets[r]||this.makeProxy(r),this.targets[r])return this.targets[r].handleEvent(t),!0};globalThis.document||(globalThis.document={elementFromPoint:(...t)=>this.targets[Object.keys(this.targets)[0]].proxied})}};function BIe(e,t){return this?.__node?.graph?(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new Kp),this.__node.graph.ProxyManager.makeProxy(e,t)):(globalThis.ProxyManager||(globalThis.ProxyManager=new Kp),globalThis.ProxyManager.makeProxy(e,t)),e}function kK(e,t){if(this?.__node?.graph){if(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new Kp),this.__node.graph.ProxyManager.handleEvent(e,t))return e}else if(globalThis.ProxyManager||(globalThis.ProxyManager=new Kp),globalThis.ProxyManager.handleEvent(e,t))return e}var J1={initProxyElement:W1,makeProxy:BIe,handleProxyEvent:kK};function RIe(e){if(e.worker){let t=e.worker,r=e.route;return(t instanceof Blob||typeof t=="string")&&(t=new Worker(t)),delete e.worker,delete e.route,EK(t,e,r)}else return W1(e.canvas,void 0,e._id,e.preventDefault),OK(e)}function EK(e,t,r){if(!t)return;t._id||(t._id=`canvas${Math.floor(Math.random()*1e15)}`);let n=t.canvas.transferControlToOffscreen();t.width||(t.width=t.canvas.clientWidth),t.height||(t.height=t.canvas.clientHeight);let i={route:r||"setupCanvas",args:{...t,canvas:n}};this?.__node?.graph?this.__node.graph.run("initProxyElement",t.canvas,e,t._id,t.preventDefault):W1(t.canvas,e,t._id,t.preventDefault),t.draw&&(typeof t.draw=="function"?i.args.draw=t.draw.toString():i.args.draw=t.draw),t.update&&(typeof t.update=="function"?i.args.update=t.update.toString():i.args.update=t.update),t.init&&(typeof t.init=="function"?i.args.init=t.init.toString():i.args.init=t.init),t.clear&&(typeof t.clear=="function"?i.args.clear=t.clear.toString():i.args.clear=t.clear);let a=[n];return t.transfer&&(a.push(...t.transfer),delete t.transfer),e.postMessage(i,a),{_id:t._id,width:t.width,height:t.height,worker:e,draw:(s,l)=>{e.postMessage({route:"drawFrame",args:[s,t._id]},l)},update:(s,l)=>{e.postMessage({route:"updateCanvas",args:[s,t._id]},l)},clear:()=>{e.postMessage({route:"clearCanvas",args:t._id})},init:()=>{e.postMessage({route:"initCanvas",args:t._id})},stop:()=>{e.postMessage({route:"stopAnim",args:t._id})},start:()=>{e.postMessage({route:"startAnim",args:t._id})},set:(s,l)=>{e.postMessage({route:"setDraw",args:[s,t._id]},l)},terminate:()=>{e.terminate()}}}function G1(e,t){let r;if(this?.__node?.graph?t?r=this.__node.graph.CANVASES?.[e._id]:e._id?r=this.__node.graph.CANVASES?.[e._id]:r=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:t||e._id?r=globalThis.CANVASES?.[e._id]:r=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],r)return e.canvas&&(r.canvas=e.canvas,this?.__node?.graph?this.__node.graph.run("makeProxy",r._id,r.canvas):J1.makeProxy(r._id,r.canvas)),typeof e.context=="string"?r.context=r.canvas.getContext(e.context):e.context&&(r.context=e.context),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),typeof e.draw=="string"&&(e.draw=Ks(e.draw)),typeof e.draw=="function"&&(r.draw=e.draw.bind(e)),typeof e.update=="string"&&(e.update=Ks(e.update)),typeof e.update=="function"&&(r.update=e.update.bind(e)),typeof e.init=="string"&&(e.init=Ks(e.init)),typeof e.init=="function"&&(r.init=e.init.bind(e)),typeof e.clear=="string"&&(e.clear=Ks(e.clear)),typeof e.clear=="function"&&(r.clear=e.clear.bind(e)),e._id}function OK(e){this?.__node?.graph?this.__node.graph.CANVASES||(this.__node.graph.CANVASES={}):globalThis.CANVASES||(globalThis.CANVASES={});let t=e;if(e._id?t._id=e._id:t._id=`canvas${Math.floor(Math.random()*1e15)}`,typeof e.context=="string"?t.context=e.canvas.getContext(e.context):t.context=e.context,"animating"in e?t.animating=e.animating:t.animating=!0,this?.__node?.graph?.CANVASES[t._id])this.__node.graph.run("setDraw",t);else if(globalThis.CANVASES?.[t._id])G1(t);else if(this?.__node?.graph&&(t.graph=this.__node.graph,t.__node||(t.__node={}),t.__node.tag||(t.__node.tag=t._id),t=this.__node.graph.add(t),t.__addOndisconnected=()=>{t.stop(),delete this.__node.graph.CANVASES[t._id]}),this?.__node?.graph?this.__node.graph.CANVASES[t._id]=t:globalThis.CANVASES[t._id]=t,this?.__node?.graph?this.__node.graph.run("makeProxy",t._id,t.canvas):J1.makeProxy(t._id,t.canvas),e.width&&(t.canvas.width=e.width),e.height&&(t.canvas.height=e.height),typeof t.draw=="string"?t.draw=Ks(t.draw):typeof t.draw=="function"&&(t.draw=t.draw.bind(t)),typeof t.update=="string"?t.update=Ks(t.update):typeof t.update=="function"&&(t.update=t.update.bind(t)),typeof t.init=="string"?t.init=Ks(t.init):typeof t.init=="function"&&(t.init=t.init.bind(t)),typeof t.clear=="string"?t.clear=Ks(t.clear):typeof t.clear=="function"&&(t.clear=t.clear.bind(t)),typeof t.init=="function"&&t.init(t,t.canvas,t.context),t.stop=()=>{Y1(t._id)},t.start=r=>{YN(t._id,r)},t.set=r=>{G1(r,t._id)},typeof t.draw=="function"&&t.animating){let r=(n,i,a)=>{n.animating&&(n.draw(n,i,a),requestAnimationFrame(()=>{r(n,i,a)}))};r(t,t.canvas,t.context)}return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?t._id:{_id:e._id,width:e.width,height:e.height,draw:n=>{AK(n,e._id)},update:n=>{TK(n,e._id)},clear:()=>{IK(e._id)},init:()=>{CK(e._id)},stop:()=>{Y1(e._id)},start:()=>{YN(e._id)},set:n=>{G1(n,e._id)},terminate:()=>{this.__node?.graph?this.__node.graph.remove(e._id):(Y1(e._id),this?.__node?.graph?delete this.__node.graph.CANVASES[t._id]:delete globalThis.CANVASES[t._id])}}}function AK(e,t){let r=fc.call(this,t);if(r&&(e&&Object.assign(r,e),r.draw))return r.draw(r,r.canvas,r.context),t}function IK(e){let t=fc.call(this,e);if(t?.clear)return t.clear(t,t.canvas,t.context),e}function CK(e){let t=fc.call(this,e);if(t?.init)return t.init(t,t.canvas,t.context),e}function TK(e,t){let r=fc.call(this,t);if(r?.update)return r.update(r,r.canvas,r.context,e),t}function MIe(e,t){let r=fc.call(this,t);if(r)return Object.assign(r,e),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),t}function YN(e,t){let r=fc.call(this,e);if(r.animating=!0,r&&t)return typeof t=="string"&&(t=Ks(t)),typeof t=="function"&&(r.draw=t),e;if(typeof r?.draw=="function"){let n=(i,a,o)=>{i.animating&&(i.draw(i,a,o),requestAnimationFrame(()=>{n(i,a,o)}))};return typeof r.clear=="function"&&r.clear(r,r.canvas,r.context),typeof r.init=="function"&&r.init(r,r.canvas,r.context),n(r,r.canvas,r.context),e}}function Y1(e){let t=fc.call(this,e);if(t)return t.animating=!1,typeof t.clear=="function"&&requestAnimationFrame(t.clear(t,t.canvas,t.context)),e}function fc(e){let t;return this?.__node?.graph?e?t=this.__node.graph.CANVASES?.[e]:t=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:e?t=globalThis.CANVASES?.[e]:t=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],t}var NK={...J1,Renderer:RIe,transferCanvas:EK,setupCanvas:OK,setDraw:G1,drawFrame:AK,clearCanvas:IK,initCanvas:CK,updateCanvas:TK,setProps:MIe,startAnim:YN,stopAnim:Y1,getCanvas:fc};function Ks(e=""){let t=o=>o.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),n=(o=>{let s=o.indexOf("=>")+1;return s<=0&&(s=o.indexOf("){")),s<=0&&(s=o.indexOf(") {")),o.slice(0,o.indexOf("{",s)+1)})(e),i=t(e),a;if(n.includes("function")){let o=n.split("(")[1].split(")")[0];a=new Function(o,i)}else if(n.substring(0,6)===i.substring(0,6)){let o=n.split("(")[1].split(")")[0];a=new Function(o,i.substring(i.indexOf("{")+1,i.length-1))}else try{a=(0,eval)(n+i+"}")}catch{}return a}var lv=class{constructor(t){dr(this,"plotter",new on);dr(this,"plot");dr(this,"options");dr(this,"create",(t=this.options)=>{let r=(a,o,s)=>{this.plotter.initPlot(a);let l=c=>{o.clientHeight&&(o.width=o.clientWidth,o.height=o.clientHeight,a.overlay.width=o.clientWidth,a.overlay.height=o.clientHeight,this.plotter.plots[a._id].plot.webgl.viewport(0,0,o.clientWidth,o.clientHeight),this.plotter.plots[a._id].plot.update())};typeof window<"u"?window.addEventListener("resize",l):o.addEventListener("resize",l),setTimeout(()=>{l(o)},10)},n=(a,o,s,l)=>{this.plotter.update(a._id,l)},i=(a,o,s)=>{this.plotter.deinitPlot(a._id)};if(t.init=r,t.update=n,t.clear=i,t.worker&&(t.worker===!0?t.worker=new Worker(iv):(typeof t.worker=="string"||t.worker instanceof Blob)&&(t.worker=new Worker(t.worker)),t.overlay)){let a=t.overlay.transferControlToOffscreen();t.overlay=a,t.transfer=[t.overlay]}return this.plot=NK.Renderer(t),this.plot});dr(this,"__operator",t=>{this.plot||this.create(this.options),this.plot.update(t)});t&&(this.options=t,this.create(t))}};var K1=oe(mt(),1),Hu=class extends Gp{constructor(r){super(r);dr(this,"state",{});dr(this,"stateKey");dr(this,"objectKey");dr(this,"sub");dr(this,"movingAverage",[]);this.stateKey=r.stateKey,this.objectKey=r.objectKey}componentDidMount(){this.sub=this.__subscribeComponent(this.stateKey),this.state[this.stateKey]=this.statemgr.data[this.stateKey]}componentWillUnmount(){this.__unsubscribeComponent(this.stateKey)}render(){let r=this.objectKey?this.state[this.stateKey]?.[this.objectKey]:this.state[this.stateKey],n=i=>(typeof i=="string"&&(i=parseFloat(i)),typeof i=="number"&&this.props.movingAverage&&(this.movingAverage.push(i),this.movingAverage.length>this.props.movingAverage&&this.movingAverage.shift(),i=this.movingAverage.reduce((o,s)=>o+s,0)/this.movingAverage.length),i);if(Array.isArray(r)&&this.props.movingAverage){let i;r.forEach(a=>{i=n(a)}),r=i}else r=n(r);return(0,K1.jsx)(K1.Fragment,{children:typeof r=="number"?r.toFixed(this.props.toFixed?this.props.toFixed:2):r})}};var qt=oe(mt(),1),X1=class extends Gp{constructor(){super(...arguments);dr(this,"state",{deviceConnected:!1,deviceRecording:!1,device:void 0,filelist:[]});dr(this,"canvas",document.createElement("canvas"));dr(this,"overlay",document.createElement("canvas"));dr(this,"canvas2",document.createElement("canvas"));dr(this,"overlay2",document.createElement("canvas"));dr(this,"sub");dr(this,"plotter1");dr(this,"sub2");dr(this,"plotter2")}componentDidMount(){this.canvas.width=800,this.canvas.height=600,this.canvas.style.width="100%",this.canvas.style.height="500px",this.overlay.width=800,this.overlay.height=600,this.overlay.style.width="100%",this.overlay.style.height="500px",this.overlay.style.position="absolute",this.overlay.style.zIndex="2",this.overlay.style.transform="translateY(-100%)",this.canvas2.width=800,this.canvas2.height=300,this.canvas2.style.width="100%",this.canvas2.style.height="150px",this.overlay2.width=800,this.overlay2.height=300,this.overlay2.style.width="100%",this.overlay2.style.height="150px",this.overlay2.style.position="absolute",this.overlay2.style.zIndex="2",this.overlay2.style.transform="translateY(-100%)",this.plotter1=new lv({canvas:this.canvas,overlay:this.overlay,lines:NN,generateNewLines:!1,cleanGeneration:!1,worker:iv}),this.sub=wt.subscribeEvent("fnirs",r=>{this.plotter1.__operator(r)}),this.plotter2=new lv({canvas:this.canvas2,overlay:this.overlay2,lines:{heg:{sps:20,nSec:10}},generateNewLines:!1,cleanGeneration:!1,worker:iv}),this.sub2=wt.subscribeEvent("heg",r=>{this.plotter2.__operator(r)})}componentWillUnmount(){wt.unsubscribeEvent("fnirs",this.sub),wt.unsubscribeEvent("heg",this.sub2)}async list(){let r=await tE.listFiles("data"),n=[];r.forEach(i=>{let a=async()=>{$B.writeToCSVFromDB("data/"+i,10)},o=()=>{tE.deleteFile("data/"+i).then(()=>{this.list()})};n.push((0,qt.jsx)("div",{id:i,children:(0,qt.jsxs)("span",{children:[i,(0,qt.jsx)("button",{onClick:a,id:"dl",children:"Download"}),(0,qt.jsx)("button",{onClick:o,id:"del",children:"Delete"})]})}))}),this.setState({filelist:r})}render(){return(0,qt.jsxs)(qt.Fragment,{children:[this.state.deviceConnected?(0,qt.jsx)("button",{onClick:()=>{this.state.device?.disconnect()},children:"Disconnect"}):(0,qt.jsx)("button",{onClick:()=>{GY()},children:"Connect"}),this.state.deviceRecording?(0,qt.jsx)("button",{onClick:()=>{this.setState({deviceRecording:!1,csvs:{}}),this.list()},children:"Stop Recording"}):(0,qt.jsx)("button",{onClick:()=>{this.setState({deviceRecording:!0}),this.list()},children:"Record"}),(0,qt.jsxs)("div",{children:[(0,qt.jsxs)("span",{children:["HEG: ",(0,qt.jsx)(Hu,{stateKey:"heg",objectKey:"heg",toFixed:2,movingAverage:10})]}),(0,qt.jsx)("br",{}),(0,qt.jsxs)("span",{children:["HR: ",(0,qt.jsx)(Hu,{stateKey:"hr",objectKey:"hr",toFixed:2,movingAverage:5}),"/ min"]}),(0,qt.jsx)("br",{}),(0,qt.jsxs)("span",{children:["HRV: ",(0,qt.jsx)(Hu,{stateKey:"hr",objectKey:"hrv",toFixed:2,movingAverage:5}),"/ min"]}),(0,qt.jsx)("br",{}),(0,qt.jsxs)("span",{children:["Breath: ",(0,qt.jsx)(Hu,{stateKey:"breath",objectKey:"breath",toFixed:2}),"/ min"]})]}),(0,qt.jsx)("hr",{}),(0,qt.jsx)("div",{ref:r=>{r?.appendChild(this.canvas2),r?.appendChild(this.overlay2)}}),(0,qt.jsx)("hr",{}),(0,qt.jsx)("br",{}),(0,qt.jsx)("hr",{}),(0,qt.jsx)("div",{ref:r=>{r?.appendChild(this.canvas),r?.appendChild(this.overlay)}}),(0,qt.jsx)("hr",{}),(0,qt.jsxs)("div",{children:["Recordings",(0,qt.jsx)("br",{}),...this.state.filelist]})]})}};var pr=oe(mt(),1);function KN(){let e=null;return(0,pr.jsxs)(pr.Fragment,{children:[(0,pr.jsx)(Yo,{}),(0,pr.jsx)(X1,{})]})}function cv(e,t,r,n=[]){let i=[];for(let a in e){let o=e[a],s=t[a],l=[...n,a];if(typeof o=="object"&&s&&typeof s=="object")i.push(...cv(o,s,r,l));else{let c=l.join("-");r(c,s,o),i.push({id:c,latest:s,previous:o})}}return i}var LK={};function PK(e,t){let r=JSON.parse(e.data),{provider:n,previously:i,added:a,...o}=r;if(n){let{steamid:s}=n;"steamid"in LK||(cv(n,n,(l,c)=>t(l,c),["provider"]),LK=n),Object.entries(o).forEach(([l,c])=>{"steamid"in c&&c.steamid!==s||((!i||l in i&&"steamid"in i[l]&&i[l].steamid!==s)&&(i={[l]:c}),i&&cv(i[l],c,(f,u,h)=>t(f,u,i===u?void 0:h),[l]),a&&cv(a[l],c,(f,u)=>{typeof u=="object"?(t(f,u,void 0,!0),cv(u,u,(h,g)=>t(h,g),f.split("-"))):t(f,u)},[l]))})}else console.warn("Non-CS:GO Message",o)}var XN=730;globalThis.commoners=s_;var{url:DK}=globalThis.commoners.services.csgo,BK=async()=>fetch(`${DK}/installed`).then(e=>e.json(e)),ZN=new EventSource(`${DK}/events`),FK={},jIe=(e,t,r,n)=>{FK[e]!==t&&(FK[e]=t,vE({[e]:{value:t,previous:r,isNew:n}}))};function $Ie(){console.warn("Event source opened!")}ZN.addEventListener("message",e=>PK(e,jIe));ZN.addEventListener("error",function(){console.error("Failed to connect to event stream.")},!1);ZN.addEventListener("open",$Ie);var RK=oe(He(),1);var Z1=oe(mt(),1);function QN({children:e="Please wait"}){return(0,Z1.jsxs)(Cu,{disabled:!0,children:[(0,Z1.jsx)(Cm,{className:"mr-2 h-4 w-4 animate-spin"}),e]})}var Hn=oe(mt(),1);function eL(){let[e,t]=(0,RK.useState)({});return Object.keys(e).length||BK().then(n=>setTimeout(()=>t(n),500)),(0,Hn.jsxs)(Hn.Fragment,{children:[(0,Hn.jsx)(Yo,{}),(0,Hn.jsx)("div",{className:"flex-col md:flex",children:(0,Hn.jsxs)("div",{className:"flex-1 space-y-4 p-8 pt-6",children:[(0,Hn.jsxs)("div",{className:"flex-1 space-x-2",children:["csgo"in e?(0,Hn.jsx)(No,{className:Op({}),to:e.csgo?`steam://launch/${XN}`:`steam://install/${XN}`,children:e.csgo?"Launch CS:GO":"Install CS:GO"}):(0,Hn.jsx)(QN,{children:"Fetching CS:GO Info"}),"steam"in e?(0,Hn.jsx)(No,{className:Op({variant:"secondary"}),to:e.steam?"steam://open/main":"https://store.steampowered.com/about/",children:e.steam?"Open Steam":"Install Steam"}):(0,Hn.jsx)(QN,{children:"Fetching Steam Info"})]}),(0,Hn.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,Hn.jsx)(ua,{name:"App Name",Icon:Om,primaryState:"provider-name",secondaryState:"player-activity"}),(0,Hn.jsx)(ua,{name:"User",Icon:Nm,primaryState:"player-name",secondaryState:"provider-steamid"}),(0,Hn.jsx)(ua,{name:"Health",Icon:Im,primaryState:"player-state-health"})]})]})})]})}var Wi=oe(mt(),1);globalThis.commoners=s_;var UIe=!1;UIe&&nR();var $K=document.createElement("div");document.body.insertAdjacentElement("afterbegin",$K);jK.default.createRoot($K).render((0,Wi.jsx)(MK.default.StrictMode,{children:(0,Wi.jsx)(wR,{children:(0,Wi.jsxs)(TE,{children:[(0,Wi.jsx)(Uc,{path:"/",element:(0,Wi.jsx)(k3,{}),errorElement:(0,Wi.jsx)(E3,{})}),(0,Wi.jsx)(Uc,{path:"/devices",element:(0,Wi.jsx)(KN,{})}),(0,Wi.jsx)(Uc,{path:"/plus",element:(0,Wi.jsx)(eL,{})}),(0,Wi.jsx)(Uc,{path:"/settings",element:(0,Wi.jsx)(T3,{})})]})})}));})();
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
  (**
   * @license React
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (**
   * @license React
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react/cjs/react-jsx-runtime.production.min.js:
  (**
   * @license React
   * react-jsx-runtime.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

classnames/index.js:
  (*!
  	Copyright (c) 2018 Jed Watson.
  	Licensed under the MIT License (MIT), see
  	http://jedwatson.github.io/classnames
  *)

react-is/cjs/react-is.production.min.js:
  (** @license React v16.13.1
   * react-is.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

decimal.js-light/decimal.js:
  (*! decimal.js-light v2.5.1 https://github.com/MikeMcl/decimal.js-light/LICENCE *)

graphscript-services.storage/dist/index.storage.services.esm.js:
  (*! Bundled license information:
  
  browserfs/dist/browserfs.js:
    (*!
    * The buffer module from node.js, for the browser.
    *
    * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
    * @license  MIT
    *)
  *)

@remix-run/router/dist/router.js:
  (**
   * @remix-run/router v1.6.2
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

react-router/dist/index.js:
  (**
   * React Router v6.11.2
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

react-router-dom/dist/index.js:
  (**
   * React Router DOM v6.11.2
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

react-resize-detector/build/index.esm.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

device-decoder/dist/device.frontend.esm.js:
  (*! Bundled license information:
  
  @capacitor/core/dist/index.js:
    (*! Capacitor: https://capacitorjs.com/ - MIT License *)
  *)
*/
