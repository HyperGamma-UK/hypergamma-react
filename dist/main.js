(()=>{var wte=Object.create;var Jv=Object.defineProperty;var Ste=Object.getOwnPropertyDescriptor;var xte=Object.getOwnPropertyNames;var kte=Object.getPrototypeOf,Ete=Object.prototype.hasOwnProperty;var Ote=(e,t,r)=>t in e?Jv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ar=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var Gv=(e,t)=>()=>(e&&(t=e(e=0)),t);var ce=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),_D=(e,t)=>{for(var r in t)Jv(e,r,{get:t[r],enumerable:!0})},Ate=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of xte(t))!Ete.call(e,i)&&i!==r&&Jv(e,i,{get:()=>t[i],enumerable:!(n=Ste(t,i))||n.enumerable});return e};var ae=(e,t,r)=>(r=e!=null?wte(kte(e)):{},Ate(t||!e||!e.__esModule?Jv(r,"default",{value:e,enumerable:!0}):r,e));var br=(e,t,r)=>(Ote(e,typeof t!="symbol"?t+"":t,r),r);var ND=ce(Ut=>{"use strict";var xg=Symbol.for("react.element"),Tte=Symbol.for("react.portal"),Cte=Symbol.for("react.fragment"),Ite=Symbol.for("react.strict_mode"),Nte=Symbol.for("react.profiler"),Pte=Symbol.for("react.provider"),Lte=Symbol.for("react.context"),Fte=Symbol.for("react.forward_ref"),Dte=Symbol.for("react.suspense"),jte=Symbol.for("react.memo"),Bte=Symbol.for("react.lazy"),wD=Symbol.iterator;function Mte(e){return e===null||typeof e!="object"?null:(e=wD&&e[wD]||e["@@iterator"],typeof e=="function"?e:null)}var kD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ED=Object.assign,OD={};function Xf(e,t,r){this.props=e,this.context=t,this.refs=OD,this.updater=r||kD}Xf.prototype.isReactComponent={};Xf.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Xf.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function AD(){}AD.prototype=Xf.prototype;function uk(e,t,r){this.props=e,this.context=t,this.refs=OD,this.updater=r||kD}var fk=uk.prototype=new AD;fk.constructor=uk;ED(fk,Xf.prototype);fk.isPureReactComponent=!0;var SD=Array.isArray,TD=Object.prototype.hasOwnProperty,dk={current:null},CD={key:!0,ref:!0,__self:!0,__source:!0};function ID(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)TD.call(t,n)&&!CD.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:xg,type:e,key:s,ref:a,props:i,_owner:dk.current}}function Rte(e,t){return{$$typeof:xg,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function pk(e){return typeof e=="object"&&e!==null&&e.$$typeof===xg}function $te(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var xD=/\/+/g;function ck(e,t){return typeof e=="object"&&e!==null&&e.key!=null?$te(""+e.key):t.toString(36)}function Yv(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case xg:case Tte:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+ck(a,0):n,SD(i)?(r="",e!=null&&(r=e.replace(xD,"$&/")+"/"),Yv(i,t,r,"",function(c){return c})):i!=null&&(pk(i)&&(i=Rte(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(xD,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",SD(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+ck(s,o);a+=Yv(s,t,r,l,i)}else if(l=Mte(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+ck(s,o++),a+=Yv(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Kv(e,t,r){if(e==null)return e;var n=[],i=0;return Yv(e,n,"","",function(s){return t.call(r,s,i++)}),n}function Ute(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Si={current:null},Xv={transition:null},zte={ReactCurrentDispatcher:Si,ReactCurrentBatchConfig:Xv,ReactCurrentOwner:dk};Ut.Children={map:Kv,forEach:function(e,t,r){Kv(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Kv(e,function(){t++}),t},toArray:function(e){return Kv(e,function(t){return t})||[]},only:function(e){if(!pk(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ut.Component=Xf;Ut.Fragment=Cte;Ut.Profiler=Nte;Ut.PureComponent=uk;Ut.StrictMode=Ite;Ut.Suspense=Dte;Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zte;Ut.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=ED({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=dk.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)TD.call(t,l)&&!CD.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:xg,type:e.type,key:i,ref:s,props:n,_owner:a}};Ut.createContext=function(e){return e={$$typeof:Lte,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Pte,_context:e},e.Consumer=e};Ut.createElement=ID;Ut.createFactory=function(e){var t=ID.bind(null,e);return t.type=e,t};Ut.createRef=function(){return{current:null}};Ut.forwardRef=function(e){return{$$typeof:Fte,render:e}};Ut.isValidElement=pk;Ut.lazy=function(e){return{$$typeof:Bte,_payload:{_status:-1,_result:e},_init:Ute}};Ut.memo=function(e,t){return{$$typeof:jte,type:e,compare:t===void 0?null:t}};Ut.startTransition=function(e){var t=Xv.transition;Xv.transition={};try{e()}finally{Xv.transition=t}};Ut.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ut.useCallback=function(e,t){return Si.current.useCallback(e,t)};Ut.useContext=function(e){return Si.current.useContext(e)};Ut.useDebugValue=function(){};Ut.useDeferredValue=function(e){return Si.current.useDeferredValue(e)};Ut.useEffect=function(e,t){return Si.current.useEffect(e,t)};Ut.useId=function(){return Si.current.useId()};Ut.useImperativeHandle=function(e,t,r){return Si.current.useImperativeHandle(e,t,r)};Ut.useInsertionEffect=function(e,t){return Si.current.useInsertionEffect(e,t)};Ut.useLayoutEffect=function(e,t){return Si.current.useLayoutEffect(e,t)};Ut.useMemo=function(e,t){return Si.current.useMemo(e,t)};Ut.useReducer=function(e,t,r){return Si.current.useReducer(e,t,r)};Ut.useRef=function(e){return Si.current.useRef(e)};Ut.useState=function(e){return Si.current.useState(e)};Ut.useSyncExternalStore=function(e,t,r){return Si.current.useSyncExternalStore(e,t,r)};Ut.useTransition=function(){return Si.current.useTransition()};Ut.version="18.2.0"});var Je=ce((bLe,PD)=>{"use strict";PD.exports=ND()});var zD=ce(Er=>{"use strict";function mk(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(0<Zv(i,t))e[n]=t,e[r]=i,r=n;else break e}}function ta(e){return e.length===0?null:e[0]}function e_(e){if(e.length===0)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,s=i>>>1;n<s;){var a=2*(n+1)-1,o=e[a],l=a+1,c=e[l];if(0>Zv(o,r))l<i&&0>Zv(c,o)?(e[n]=c,e[l]=r,n=l):(e[n]=o,e[a]=r,n=a);else if(l<i&&0>Zv(c,r))e[n]=c,e[l]=r,n=l;else break e}}return t}function Zv(e,t){var r=e.sortIndex-t.sortIndex;return r!==0?r:e.id-t.id}typeof performance=="object"&&typeof performance.now=="function"?(LD=performance,Er.unstable_now=function(){return LD.now()}):(hk=Date,FD=hk.now(),Er.unstable_now=function(){return hk.now()-FD});var LD,hk,FD,Ma=[],Sl=[],qte=1,Ts=null,ti=3,t_=!1,tu=!1,Eg=!1,BD=typeof setTimeout=="function"?setTimeout:null,MD=typeof clearTimeout=="function"?clearTimeout:null,DD=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function bk(e){for(var t=ta(Sl);t!==null;){if(t.callback===null)e_(Sl);else if(t.startTime<=e)e_(Sl),t.sortIndex=t.expirationTime,mk(Ma,t);else break;t=ta(Sl)}}function vk(e){if(Eg=!1,bk(e),!tu)if(ta(Ma)!==null)tu=!0,wk(_k);else{var t=ta(Sl);t!==null&&Sk(vk,t.startTime-e)}}function _k(e,t){tu=!1,Eg&&(Eg=!1,MD(Og),Og=-1),t_=!0;var r=ti;try{for(bk(t),Ts=ta(Ma);Ts!==null&&(!(Ts.expirationTime>t)||e&&!UD());){var n=Ts.callback;if(typeof n=="function"){Ts.callback=null,ti=Ts.priorityLevel;var i=n(Ts.expirationTime<=t);t=Er.unstable_now(),typeof i=="function"?Ts.callback=i:Ts===ta(Ma)&&e_(Ma),bk(t)}else e_(Ma);Ts=ta(Ma)}if(Ts!==null)var s=!0;else{var a=ta(Sl);a!==null&&Sk(vk,a.startTime-t),s=!1}return s}finally{Ts=null,ti=r,t_=!1}}var r_=!1,Qv=null,Og=-1,RD=5,$D=-1;function UD(){return!(Er.unstable_now()-$D<RD)}function gk(){if(Qv!==null){var e=Er.unstable_now();$D=e;var t=!0;try{t=Qv(!0,e)}finally{t?kg():(r_=!1,Qv=null)}}else r_=!1}var kg;typeof DD=="function"?kg=function(){DD(gk)}:typeof MessageChannel<"u"?(yk=new MessageChannel,jD=yk.port2,yk.port1.onmessage=gk,kg=function(){jD.postMessage(null)}):kg=function(){BD(gk,0)};var yk,jD;function wk(e){Qv=e,r_||(r_=!0,kg())}function Sk(e,t){Og=BD(function(){e(Er.unstable_now())},t)}Er.unstable_IdlePriority=5;Er.unstable_ImmediatePriority=1;Er.unstable_LowPriority=4;Er.unstable_NormalPriority=3;Er.unstable_Profiling=null;Er.unstable_UserBlockingPriority=2;Er.unstable_cancelCallback=function(e){e.callback=null};Er.unstable_continueExecution=function(){tu||t_||(tu=!0,wk(_k))};Er.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):RD=0<e?Math.floor(1e3/e):5};Er.unstable_getCurrentPriorityLevel=function(){return ti};Er.unstable_getFirstCallbackNode=function(){return ta(Ma)};Er.unstable_next=function(e){switch(ti){case 1:case 2:case 3:var t=3;break;default:t=ti}var r=ti;ti=t;try{return e()}finally{ti=r}};Er.unstable_pauseExecution=function(){};Er.unstable_requestPaint=function(){};Er.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=ti;ti=e;try{return t()}finally{ti=r}};Er.unstable_scheduleCallback=function(e,t,r){var n=Er.unstable_now();switch(typeof r=="object"&&r!==null?(r=r.delay,r=typeof r=="number"&&0<r?n+r:n):r=n,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return i=r+i,e={id:qte++,callback:t,priorityLevel:e,startTime:r,expirationTime:i,sortIndex:-1},r>n?(e.sortIndex=r,mk(Sl,e),ta(Ma)===null&&e===ta(Sl)&&(Eg?(MD(Og),Og=-1):Eg=!0,Sk(vk,r-n))):(e.sortIndex=i,mk(Ma,e),tu||t_||(tu=!0,wk(_k))),e};Er.unstable_shouldYield=UD;Er.unstable_wrapCallback=function(e){var t=ti;return function(){var r=ti;ti=t;try{return e.apply(this,arguments)}finally{ti=r}}}});var VD=ce((_Le,qD)=>{"use strict";qD.exports=zD()});var YM=ce(hs=>{"use strict";var Xj=Je(),ds=VD();function Ve(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Zj=new Set,Gg={};function hu(e,t){bd(e,t),bd(e+"Capture",t)}function bd(e,t){for(Gg[e]=t,e=0;e<t.length;e++)Zj.add(t[e])}var To=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hk=Object.prototype.hasOwnProperty,Vte=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,HD={},WD={};function Hte(e){return Hk.call(WD,e)?!0:Hk.call(HD,e)?!1:Vte.test(e)?WD[e]=!0:(HD[e]=!0,!1)}function Wte(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Jte(e,t,r,n){if(t===null||typeof t>"u"||Wte(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ei(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var Gn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Gn[e]=new Ei(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Gn[t]=new Ei(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Gn[e]=new Ei(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Gn[e]=new Ei(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Gn[e]=new Ei(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Gn[e]=new Ei(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Gn[e]=new Ei(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Gn[e]=new Ei(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Gn[e]=new Ei(e,5,!1,e.toLowerCase(),null,!1,!1)});var BE=/[\-:]([a-z])/g;function ME(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(BE,ME);Gn[t]=new Ei(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(BE,ME);Gn[t]=new Ei(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(BE,ME);Gn[t]=new Ei(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Gn[e]=new Ei(e,1,!1,e.toLowerCase(),null,!1,!1)});Gn.xlinkHref=new Ei("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Gn[e]=new Ei(e,1,!1,e.toLowerCase(),null,!0,!0)});function RE(e,t,r,n){var i=Gn.hasOwnProperty(t)?Gn[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Jte(t,r,i,n)&&(r=null),n||i===null?Hte(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Po=Xj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,n_=Symbol.for("react.element"),ed=Symbol.for("react.portal"),td=Symbol.for("react.fragment"),$E=Symbol.for("react.strict_mode"),Wk=Symbol.for("react.profiler"),Qj=Symbol.for("react.provider"),eB=Symbol.for("react.context"),UE=Symbol.for("react.forward_ref"),Jk=Symbol.for("react.suspense"),Gk=Symbol.for("react.suspense_list"),zE=Symbol.for("react.memo"),kl=Symbol.for("react.lazy");Symbol.for("react.scope");Symbol.for("react.debug_trace_mode");var tB=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden");Symbol.for("react.cache");Symbol.for("react.tracing_marker");var JD=Symbol.iterator;function Ag(e){return e===null||typeof e!="object"?null:(e=JD&&e[JD]||e["@@iterator"],typeof e=="function"?e:null)}var Jr=Object.assign,xk;function Dg(e){if(xk===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);xk=t&&t[1]||""}return`
`+xk+e}var kk=!1;function Ek(e,t){if(!e||kk)return"";kk=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{kk=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Dg(e):""}function Gte(e){switch(e.tag){case 5:return Dg(e.type);case 16:return Dg("Lazy");case 13:return Dg("Suspense");case 19:return Dg("SuspenseList");case 0:case 2:case 15:return e=Ek(e.type,!1),e;case 11:return e=Ek(e.type.render,!1),e;case 1:return e=Ek(e.type,!0),e;default:return""}}function Kk(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case td:return"Fragment";case ed:return"Portal";case Wk:return"Profiler";case $E:return"StrictMode";case Jk:return"Suspense";case Gk:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case eB:return(e.displayName||"Context")+".Consumer";case Qj:return(e._context.displayName||"Context")+".Provider";case UE:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case zE:return t=e.displayName||null,t!==null?t:Kk(e.type)||"Memo";case kl:t=e._payload,e=e._init;try{return Kk(e(t))}catch{}}return null}function Kte(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kk(t);case 8:return t===$E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ml(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function rB(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Yte(e){var t=rB(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function i_(e){e._valueTracker||(e._valueTracker=Yte(e))}function nB(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=rB(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function P_(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Yk(e,t){var r=t.checked;return Jr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function GD(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ml(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function iB(e,t){t=t.checked,t!=null&&RE(e,"checked",t,!1)}function Xk(e,t){iB(e,t);var r=Ml(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Zk(e,t.type,r):t.hasOwnProperty("defaultValue")&&Zk(e,t.type,Ml(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function KD(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Zk(e,t,r){(t!=="number"||P_(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var jg=Array.isArray;function dd(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ml(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Qk(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ve(91));return Jr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function YD(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ve(92));if(jg(r)){if(1<r.length)throw Error(Ve(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ml(r)}}function sB(e,t){var r=Ml(t.value),n=Ml(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function XD(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function aB(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function eE(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?aB(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var s_,oB=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(s_=s_||document.createElement("div"),s_.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=s_.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Kg(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Rg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xte=["Webkit","ms","Moz","O"];Object.keys(Rg).forEach(function(e){Xte.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Rg[t]=Rg[e]})});function lB(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Rg.hasOwnProperty(e)&&Rg[e]?(""+t).trim():t+"px"}function cB(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=lB(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Zte=Jr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tE(e,t){if(t){if(Zte[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ve(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ve(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ve(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ve(62))}}function rE(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nE=null;function qE(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var iE=null,pd=null,hd=null;function ZD(e){if(e=py(e)){if(typeof iE!="function")throw Error(Ve(280));var t=e.stateNode;t&&(t=a0(t),iE(e.stateNode,e.type,t))}}function uB(e){pd?hd?hd.push(e):hd=[e]:pd=e}function fB(){if(pd){var e=pd,t=hd;if(hd=pd=null,ZD(e),t)for(e=0;e<t.length;e++)ZD(t[e])}}function dB(e,t){return e(t)}function pB(){}var Ok=!1;function hB(e,t,r){if(Ok)return e(t,r);Ok=!0;try{return dB(e,t,r)}finally{Ok=!1,(pd!==null||hd!==null)&&(pB(),fB())}}function Yg(e,t){var r=e.stateNode;if(r===null)return null;var n=a0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ve(231,t,typeof r));return r}var sE=!1;if(To)try{Zf={},Object.defineProperty(Zf,"passive",{get:function(){sE=!0}}),window.addEventListener("test",Zf,Zf),window.removeEventListener("test",Zf,Zf)}catch{sE=!1}var Zf;function Qte(e,t,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var $g=!1,L_=null,F_=!1,aE=null,ere={onError:function(e){$g=!0,L_=e}};function tre(e,t,r,n,i,s,a,o,l){$g=!1,L_=null,Qte.apply(ere,arguments)}function rre(e,t,r,n,i,s,a,o,l){if(tre.apply(this,arguments),$g){if($g){var c=L_;$g=!1,L_=null}else throw Error(Ve(198));F_||(F_=!0,aE=c)}}function gu(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function gB(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function QD(e){if(gu(e)!==e)throw Error(Ve(188))}function nre(e){var t=e.alternate;if(!t){if(t=gu(e),t===null)throw Error(Ve(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return QD(i),e;if(s===n)return QD(i),t;s=s.sibling}throw Error(Ve(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Ve(189))}}if(r.alternate!==n)throw Error(Ve(190))}if(r.tag!==3)throw Error(Ve(188));return r.stateNode.current===r?e:t}function yB(e){return e=nre(e),e!==null?mB(e):null}function mB(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=mB(e);if(t!==null)return t;e=e.sibling}return null}var bB=ds.unstable_scheduleCallback,ej=ds.unstable_cancelCallback,ire=ds.unstable_shouldYield,sre=ds.unstable_requestPaint,on=ds.unstable_now,are=ds.unstable_getCurrentPriorityLevel,VE=ds.unstable_ImmediatePriority,vB=ds.unstable_UserBlockingPriority,D_=ds.unstable_NormalPriority,ore=ds.unstable_LowPriority,_B=ds.unstable_IdlePriority,r0=null,za=null;function lre(e){if(za&&typeof za.onCommitFiberRoot=="function")try{za.onCommitFiberRoot(r0,e,void 0,(e.current.flags&128)===128)}catch{}}var aa=Math.clz32?Math.clz32:fre,cre=Math.log,ure=Math.LN2;function fre(e){return e>>>=0,e===0?32:31-(cre(e)/ure|0)|0}var a_=64,o_=4194304;function Bg(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function j_(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Bg(o):(s&=a,s!==0&&(n=Bg(s)))}else a=r&~i,a!==0?n=Bg(a):s!==0&&(n=Bg(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-aa(t),i=1<<r,n|=e[r],t&=~i;return n}function dre(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pre(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-aa(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=dre(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function oE(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function wB(){var e=a_;return a_<<=1,!(a_&4194240)&&(a_=64),e}function Ak(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function fy(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-aa(t),e[t]=r}function hre(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-aa(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function HE(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-aa(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var pr=0;function SB(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var xB,WE,kB,EB,OB,lE=!1,l_=[],Il=null,Nl=null,Pl=null,Xg=new Map,Zg=new Map,Ol=[],gre="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tj(e,t){switch(e){case"focusin":case"focusout":Il=null;break;case"dragenter":case"dragleave":Nl=null;break;case"mouseover":case"mouseout":Pl=null;break;case"pointerover":case"pointerout":Xg.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zg.delete(t.pointerId)}}function Tg(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=py(t),t!==null&&WE(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function yre(e,t,r,n,i){switch(t){case"focusin":return Il=Tg(Il,e,t,r,n,i),!0;case"dragenter":return Nl=Tg(Nl,e,t,r,n,i),!0;case"mouseover":return Pl=Tg(Pl,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Xg.set(s,Tg(Xg.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Zg.set(s,Tg(Zg.get(s)||null,e,t,r,n,i)),!0}return!1}function AB(e){var t=iu(e.target);if(t!==null){var r=gu(t);if(r!==null){if(t=r.tag,t===13){if(t=gB(r),t!==null){e.blockedOn=t,OB(e.priority,function(){kB(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function S_(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=cE(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);nE=n,r.target.dispatchEvent(n),nE=null}else return t=py(r),t!==null&&WE(t),e.blockedOn=r,!1;t.shift()}return!0}function rj(e,t,r){S_(e)&&r.delete(t)}function mre(){lE=!1,Il!==null&&S_(Il)&&(Il=null),Nl!==null&&S_(Nl)&&(Nl=null),Pl!==null&&S_(Pl)&&(Pl=null),Xg.forEach(rj),Zg.forEach(rj)}function Cg(e,t){e.blockedOn===t&&(e.blockedOn=null,lE||(lE=!0,ds.unstable_scheduleCallback(ds.unstable_NormalPriority,mre)))}function Qg(e){function t(i){return Cg(i,e)}if(0<l_.length){Cg(l_[0],e);for(var r=1;r<l_.length;r++){var n=l_[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Il!==null&&Cg(Il,e),Nl!==null&&Cg(Nl,e),Pl!==null&&Cg(Pl,e),Xg.forEach(t),Zg.forEach(t),r=0;r<Ol.length;r++)n=Ol[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ol.length&&(r=Ol[0],r.blockedOn===null);)AB(r),r.blockedOn===null&&Ol.shift()}var gd=Po.ReactCurrentBatchConfig,B_=!0;function bre(e,t,r,n){var i=pr,s=gd.transition;gd.transition=null;try{pr=1,JE(e,t,r,n)}finally{pr=i,gd.transition=s}}function vre(e,t,r,n){var i=pr,s=gd.transition;gd.transition=null;try{pr=4,JE(e,t,r,n)}finally{pr=i,gd.transition=s}}function JE(e,t,r,n){if(B_){var i=cE(e,t,r,n);if(i===null)Fk(e,t,n,M_,r),tj(e,n);else if(yre(i,e,t,r,n))n.stopPropagation();else if(tj(e,n),t&4&&-1<gre.indexOf(e)){for(;i!==null;){var s=py(i);if(s!==null&&xB(s),s=cE(e,t,r,n),s===null&&Fk(e,t,n,M_,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Fk(e,t,n,null,r)}}var M_=null;function cE(e,t,r,n){if(M_=null,e=qE(n),e=iu(e),e!==null)if(t=gu(e),t===null)e=null;else if(r=t.tag,r===13){if(e=gB(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return M_=e,null}function TB(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(are()){case VE:return 1;case vB:return 4;case D_:case ore:return 16;case _B:return 536870912;default:return 16}default:return 16}}var Tl=null,GE=null,x_=null;function CB(){if(x_)return x_;var e,t=GE,r=t.length,n,i="value"in Tl?Tl.value:Tl.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return x_=i.slice(e,1<n?1-n:void 0)}function k_(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function c_(){return!0}function nj(){return!1}function ps(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?c_:nj,this.isPropagationStopped=nj,this}return Jr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=c_)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=c_)},persist:function(){},isPersistent:c_}),t}var Ed={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},KE=ps(Ed),dy=Jr({},Ed,{view:0,detail:0}),_re=ps(dy),Tk,Ck,Ig,n0=Jr({},dy,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:YE,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ig&&(Ig&&e.type==="mousemove"?(Tk=e.screenX-Ig.screenX,Ck=e.screenY-Ig.screenY):Ck=Tk=0,Ig=e),Tk)},movementY:function(e){return"movementY"in e?e.movementY:Ck}}),ij=ps(n0),wre=Jr({},n0,{dataTransfer:0}),Sre=ps(wre),xre=Jr({},dy,{relatedTarget:0}),Ik=ps(xre),kre=Jr({},Ed,{animationName:0,elapsedTime:0,pseudoElement:0}),Ere=ps(kre),Ore=Jr({},Ed,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Are=ps(Ore),Tre=Jr({},Ed,{data:0}),sj=ps(Tre),Cre={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ire={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nre={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pre(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Nre[e])?!!t[e]:!1}function YE(){return Pre}var Lre=Jr({},dy,{key:function(e){if(e.key){var t=Cre[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=k_(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ire[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:YE,charCode:function(e){return e.type==="keypress"?k_(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?k_(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Fre=ps(Lre),Dre=Jr({},n0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),aj=ps(Dre),jre=Jr({},dy,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:YE}),Bre=ps(jre),Mre=Jr({},Ed,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rre=ps(Mre),$re=Jr({},n0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ure=ps($re),zre=[9,13,27,32],XE=To&&"CompositionEvent"in window,Ug=null;To&&"documentMode"in document&&(Ug=document.documentMode);var qre=To&&"TextEvent"in window&&!Ug,IB=To&&(!XE||Ug&&8<Ug&&11>=Ug),oj=String.fromCharCode(32),lj=!1;function NB(e,t){switch(e){case"keyup":return zre.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function PB(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var rd=!1;function Vre(e,t){switch(e){case"compositionend":return PB(t);case"keypress":return t.which!==32?null:(lj=!0,oj);case"textInput":return e=t.data,e===oj&&lj?null:e;default:return null}}function Hre(e,t){if(rd)return e==="compositionend"||!XE&&NB(e,t)?(e=CB(),x_=GE=Tl=null,rd=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return IB&&t.locale!=="ko"?null:t.data;default:return null}}var Wre={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cj(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Wre[e.type]:t==="textarea"}function LB(e,t,r,n){uB(n),t=R_(t,"onChange"),0<t.length&&(r=new KE("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var zg=null,ey=null;function Jre(e){VB(e,0)}function i0(e){var t=sd(e);if(nB(t))return e}function Gre(e,t){if(e==="change")return t}var FB=!1;To&&(To?(f_="oninput"in document,f_||(Nk=document.createElement("div"),Nk.setAttribute("oninput","return;"),f_=typeof Nk.oninput=="function"),u_=f_):u_=!1,FB=u_&&(!document.documentMode||9<document.documentMode));var u_,f_,Nk;function uj(){zg&&(zg.detachEvent("onpropertychange",DB),ey=zg=null)}function DB(e){if(e.propertyName==="value"&&i0(ey)){var t=[];LB(t,ey,e,qE(e)),hB(Jre,t)}}function Kre(e,t,r){e==="focusin"?(uj(),zg=t,ey=r,zg.attachEvent("onpropertychange",DB)):e==="focusout"&&uj()}function Yre(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return i0(ey)}function Xre(e,t){if(e==="click")return i0(t)}function Zre(e,t){if(e==="input"||e==="change")return i0(t)}function Qre(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var la=typeof Object.is=="function"?Object.is:Qre;function ty(e,t){if(la(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Hk.call(t,i)||!la(e[i],t[i]))return!1}return!0}function fj(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dj(e,t){var r=fj(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=fj(r)}}function jB(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?jB(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function BB(){for(var e=window,t=P_();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=P_(e.document)}return t}function ZE(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ene(e){var t=BB(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&jB(r.ownerDocument.documentElement,r)){if(n!==null&&ZE(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=dj(r,s);var a=dj(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var tne=To&&"documentMode"in document&&11>=document.documentMode,nd=null,uE=null,qg=null,fE=!1;function pj(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;fE||nd==null||nd!==P_(n)||(n=nd,"selectionStart"in n&&ZE(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),qg&&ty(qg,n)||(qg=n,n=R_(uE,"onSelect"),0<n.length&&(t=new KE("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=nd)))}function d_(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var id={animationend:d_("Animation","AnimationEnd"),animationiteration:d_("Animation","AnimationIteration"),animationstart:d_("Animation","AnimationStart"),transitionend:d_("Transition","TransitionEnd")},Pk={},MB={};To&&(MB=document.createElement("div").style,"AnimationEvent"in window||(delete id.animationend.animation,delete id.animationiteration.animation,delete id.animationstart.animation),"TransitionEvent"in window||delete id.transitionend.transition);function s0(e){if(Pk[e])return Pk[e];if(!id[e])return e;var t=id[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in MB)return Pk[e]=t[r];return e}var RB=s0("animationend"),$B=s0("animationiteration"),UB=s0("animationstart"),zB=s0("transitionend"),qB=new Map,hj="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $l(e,t){qB.set(e,t),hu(t,[e])}for(p_=0;p_<hj.length;p_++)h_=hj[p_],gj=h_.toLowerCase(),yj=h_[0].toUpperCase()+h_.slice(1),$l(gj,"on"+yj);var h_,gj,yj,p_;$l(RB,"onAnimationEnd");$l($B,"onAnimationIteration");$l(UB,"onAnimationStart");$l("dblclick","onDoubleClick");$l("focusin","onFocus");$l("focusout","onBlur");$l(zB,"onTransitionEnd");bd("onMouseEnter",["mouseout","mouseover"]);bd("onMouseLeave",["mouseout","mouseover"]);bd("onPointerEnter",["pointerout","pointerover"]);bd("onPointerLeave",["pointerout","pointerover"]);hu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));hu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));hu("onBeforeInput",["compositionend","keypress","textInput","paste"]);hu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));hu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));hu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rne=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mg));function mj(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,rre(n,t,void 0,e),e.currentTarget=null}function VB(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;mj(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;mj(i,o,c),s=l}}}if(F_)throw e=aE,F_=!1,aE=null,e}function Fr(e,t){var r=t[yE];r===void 0&&(r=t[yE]=new Set);var n=e+"__bubble";r.has(n)||(HB(t,e,2,!1),r.add(n))}function Lk(e,t,r){var n=0;t&&(n|=4),HB(r,e,n,t)}var g_="_reactListening"+Math.random().toString(36).slice(2);function ry(e){if(!e[g_]){e[g_]=!0,Zj.forEach(function(r){r!=="selectionchange"&&(rne.has(r)||Lk(r,!1,e),Lk(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[g_]||(t[g_]=!0,Lk("selectionchange",!1,t))}}function HB(e,t,r,n){switch(TB(t)){case 1:var i=bre;break;case 4:i=vre;break;default:i=JE}r=i.bind(null,t,r,e),i=void 0,!sE||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Fk(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=iu(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}hB(function(){var c=s,f=qE(r),u=[];e:{var d=qB.get(e);if(d!==void 0){var p=KE,_=e;switch(e){case"keypress":if(k_(r)===0)break e;case"keydown":case"keyup":p=Fre;break;case"focusin":_="focus",p=Ik;break;case"focusout":_="blur",p=Ik;break;case"beforeblur":case"afterblur":p=Ik;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=ij;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Sre;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Bre;break;case RB:case $B:case UB:p=Ere;break;case zB:p=Rre;break;case"scroll":p=_re;break;case"wheel":p=Ure;break;case"copy":case"cut":case"paste":p=Are;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=aj}var w=(t&4)!==0,k=!w&&e==="scroll",S=w?d!==null?d+"Capture":null:d;w=[];for(var O=c,A;O!==null;){A=O;var C=A.stateNode;if(A.tag===5&&C!==null&&(A=C,S!==null&&(C=Yg(O,S),C!=null&&w.push(ny(O,C,A)))),k)break;O=O.return}0<w.length&&(d=new p(d,_,null,r,f),u.push({event:d,listeners:w}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",d&&r!==nE&&(_=r.relatedTarget||r.fromElement)&&(iu(_)||_[Co]))break e;if((p||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,p?(_=r.relatedTarget||r.toElement,p=c,_=_?iu(_):null,_!==null&&(k=gu(_),_!==k||_.tag!==5&&_.tag!==6)&&(_=null)):(p=null,_=c),p!==_)){if(w=ij,C="onMouseLeave",S="onMouseEnter",O="mouse",(e==="pointerout"||e==="pointerover")&&(w=aj,C="onPointerLeave",S="onPointerEnter",O="pointer"),k=p==null?d:sd(p),A=_==null?d:sd(_),d=new w(C,O+"leave",p,r,f),d.target=k,d.relatedTarget=A,C=null,iu(f)===c&&(w=new w(S,O+"enter",_,r,f),w.target=A,w.relatedTarget=k,C=w),k=C,p&&_)t:{for(w=p,S=_,O=0,A=w;A;A=Qf(A))O++;for(A=0,C=S;C;C=Qf(C))A++;for(;0<O-A;)w=Qf(w),O--;for(;0<A-O;)S=Qf(S),A--;for(;O--;){if(w===S||S!==null&&w===S.alternate)break t;w=Qf(w),S=Qf(S)}w=null}else w=null;p!==null&&bj(u,d,p,w,!1),_!==null&&k!==null&&bj(u,k,_,w,!0)}}e:{if(d=c?sd(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var I=Gre;else if(cj(d))if(FB)I=Zre;else{I=Yre;var D=Kre}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(I=Xre);if(I&&(I=I(e,c))){LB(u,I,r,f);break e}D&&D(e,d,c),e==="focusout"&&(D=d._wrapperState)&&D.controlled&&d.type==="number"&&Zk(d,"number",d.value)}switch(D=c?sd(c):window,e){case"focusin":(cj(D)||D.contentEditable==="true")&&(nd=D,uE=c,qg=null);break;case"focusout":qg=uE=nd=null;break;case"mousedown":fE=!0;break;case"contextmenu":case"mouseup":case"dragend":fE=!1,pj(u,r,f);break;case"selectionchange":if(tne)break;case"keydown":case"keyup":pj(u,r,f)}var L;if(XE)e:{switch(e){case"compositionstart":var U="onCompositionStart";break e;case"compositionend":U="onCompositionEnd";break e;case"compositionupdate":U="onCompositionUpdate";break e}U=void 0}else rd?NB(e,r)&&(U="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(U="onCompositionStart");U&&(IB&&r.locale!=="ko"&&(rd||U!=="onCompositionStart"?U==="onCompositionEnd"&&rd&&(L=CB()):(Tl=f,GE="value"in Tl?Tl.value:Tl.textContent,rd=!0)),D=R_(c,U),0<D.length&&(U=new sj(U,e,null,r,f),u.push({event:U,listeners:D}),L?U.data=L:(L=PB(r),L!==null&&(U.data=L)))),(L=qre?Vre(e,r):Hre(e,r))&&(c=R_(c,"onBeforeInput"),0<c.length&&(f=new sj("onBeforeInput","beforeinput",null,r,f),u.push({event:f,listeners:c}),f.data=L))}VB(u,t)})}function ny(e,t,r){return{instance:e,listener:t,currentTarget:r}}function R_(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Yg(e,r),s!=null&&n.unshift(ny(e,s,i)),s=Yg(e,t),s!=null&&n.push(ny(e,s,i))),e=e.return}return n}function Qf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function bj(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Yg(r,s),l!=null&&a.unshift(ny(r,l,o))):i||(l=Yg(r,s),l!=null&&a.push(ny(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var nne=/\r\n?/g,ine=/\u0000|\uFFFD/g;function vj(e){return(typeof e=="string"?e:""+e).replace(nne,`
`).replace(ine,"")}function y_(e,t,r){if(t=vj(t),vj(e)!==t&&r)throw Error(Ve(425))}function $_(){}var dE=null,pE=null;function hE(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var gE=typeof setTimeout=="function"?setTimeout:void 0,sne=typeof clearTimeout=="function"?clearTimeout:void 0,_j=typeof Promise=="function"?Promise:void 0,ane=typeof queueMicrotask=="function"?queueMicrotask:typeof _j<"u"?function(e){return _j.resolve(null).then(e).catch(one)}:gE;function one(e){setTimeout(function(){throw e})}function Dk(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Qg(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Qg(t)}function Ll(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function wj(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Od=Math.random().toString(36).slice(2),Ua="__reactFiber$"+Od,iy="__reactProps$"+Od,Co="__reactContainer$"+Od,yE="__reactEvents$"+Od,lne="__reactListeners$"+Od,cne="__reactHandles$"+Od;function iu(e){var t=e[Ua];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Co]||r[Ua]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=wj(e);e!==null;){if(r=e[Ua])return r;e=wj(e)}return t}e=r,r=e.parentNode}return null}function py(e){return e=e[Ua]||e[Co],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function sd(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ve(33))}function a0(e){return e[iy]||null}var mE=[],ad=-1;function Ul(e){return{current:e}}function Dr(e){0>ad||(e.current=mE[ad],mE[ad]=null,ad--)}function Or(e,t){ad++,mE[ad]=e.current,e.current=t}var Rl={},si=Ul(Rl),Hi=Ul(!1),cu=Rl;function vd(e,t){var r=e.type.contextTypes;if(!r)return Rl;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Wi(e){return e=e.childContextTypes,e!=null}function U_(){Dr(Hi),Dr(si)}function Sj(e,t,r){if(si.current!==Rl)throw Error(Ve(168));Or(si,t),Or(Hi,r)}function WB(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Ve(108,Kte(e)||"Unknown",i));return Jr({},r,n)}function z_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Rl,cu=si.current,Or(si,e),Or(Hi,Hi.current),!0}function xj(e,t,r){var n=e.stateNode;if(!n)throw Error(Ve(169));r?(e=WB(e,t,cu),n.__reactInternalMemoizedMergedChildContext=e,Dr(Hi),Dr(si),Or(si,e)):Dr(Hi),Or(Hi,r)}var ko=null,o0=!1,jk=!1;function JB(e){ko===null?ko=[e]:ko.push(e)}function une(e){o0=!0,JB(e)}function zl(){if(!jk&&ko!==null){jk=!0;var e=0,t=pr;try{var r=ko;for(pr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ko=null,o0=!1}catch(i){throw ko!==null&&(ko=ko.slice(e+1)),bB(VE,zl),i}finally{pr=t,jk=!1}}return null}var od=[],ld=0,q_=null,V_=0,Cs=[],Is=0,uu=null,Eo=1,Oo="";function ru(e,t){od[ld++]=V_,od[ld++]=q_,q_=e,V_=t}function GB(e,t,r){Cs[Is++]=Eo,Cs[Is++]=Oo,Cs[Is++]=uu,uu=e;var n=Eo;e=Oo;var i=32-aa(n)-1;n&=~(1<<i),r+=1;var s=32-aa(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Eo=1<<32-aa(t)+i|r<<i|n,Oo=s+e}else Eo=1<<s|r<<i|n,Oo=e}function QE(e){e.return!==null&&(ru(e,1),GB(e,1,0))}function eO(e){for(;e===q_;)q_=od[--ld],od[ld]=null,V_=od[--ld],od[ld]=null;for(;e===uu;)uu=Cs[--Is],Cs[Is]=null,Oo=Cs[--Is],Cs[Is]=null,Eo=Cs[--Is],Cs[Is]=null}var us=null,cs=null,$r=!1,sa=null;function KB(e,t){var r=Ns(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function kj(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,us=e,cs=Ll(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,us=e,cs=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=uu!==null?{id:Eo,overflow:Oo}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ns(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,us=e,cs=null,!0):!1;default:return!1}}function bE(e){return(e.mode&1)!==0&&(e.flags&128)===0}function vE(e){if($r){var t=cs;if(t){var r=t;if(!kj(e,t)){if(bE(e))throw Error(Ve(418));t=Ll(r.nextSibling);var n=us;t&&kj(e,t)?KB(n,r):(e.flags=e.flags&-4097|2,$r=!1,us=e)}}else{if(bE(e))throw Error(Ve(418));e.flags=e.flags&-4097|2,$r=!1,us=e}}}function Ej(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;us=e}function m_(e){if(e!==us)return!1;if(!$r)return Ej(e),$r=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!hE(e.type,e.memoizedProps)),t&&(t=cs)){if(bE(e))throw YB(),Error(Ve(418));for(;t;)KB(e,t),t=Ll(t.nextSibling)}if(Ej(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ve(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){cs=Ll(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}cs=null}}else cs=us?Ll(e.stateNode.nextSibling):null;return!0}function YB(){for(var e=cs;e;)e=Ll(e.nextSibling)}function _d(){cs=us=null,$r=!1}function tO(e){sa===null?sa=[e]:sa.push(e)}var fne=Po.ReactCurrentBatchConfig;function na(e,t){if(e&&e.defaultProps){t=Jr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var H_=Ul(null),W_=null,cd=null,rO=null;function nO(){rO=cd=W_=null}function iO(e){var t=H_.current;Dr(H_),e._currentValue=t}function _E(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function yd(e,t){W_=e,rO=cd=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Vi=!0),e.firstContext=null)}function Ls(e){var t=e._currentValue;if(rO!==e)if(e={context:e,memoizedValue:t,next:null},cd===null){if(W_===null)throw Error(Ve(308));cd=e,W_.dependencies={lanes:0,firstContext:e}}else cd=cd.next=e;return t}var su=null;function sO(e){su===null?su=[e]:su.push(e)}function XB(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,sO(t)):(r.next=i.next,i.next=r),t.interleaved=r,Io(e,n)}function Io(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var El=!1;function aO(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ZB(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ao(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fl(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Yt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Io(e,r)}return i=n.interleaved,i===null?(t.next=t,sO(n)):(t.next=i.next,i.next=t),n.interleaved=t,Io(e,r)}function E_(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,HE(e,r)}}function Oj(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function J_(e,t,r,n){var i=e.updateQueue;El=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(s!==null){var u=i.baseState;a=0,f=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var _=e,w=o;switch(d=t,p=r,w.tag){case 1:if(_=w.payload,typeof _=="function"){u=_.call(p,u,d);break e}u=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=w.payload,d=typeof _=="function"?_.call(p,u,d):_,d==null)break e;u=Jr({},u,d);break e;case 2:El=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=p,l=u):f=f.next=p,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(1);if(f===null&&(l=u),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=f,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);du|=a,e.lanes=a,e.memoizedState=u}}function Aj(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Ve(191,i));i.call(n)}}}var QB=new Xj.Component().refs;function wE(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Jr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var l0={isMounted:function(e){return(e=e._reactInternals)?gu(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ki(),i=jl(e),s=Ao(n,i);s.payload=t,r!=null&&(s.callback=r),t=Fl(e,s,i),t!==null&&(oa(t,e,i,n),E_(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ki(),i=jl(e),s=Ao(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Fl(e,s,i),t!==null&&(oa(t,e,i,n),E_(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ki(),n=jl(e),i=Ao(r,n);i.tag=2,t!=null&&(i.callback=t),t=Fl(e,i,n),t!==null&&(oa(t,e,n,r),E_(t,e,n))}};function Tj(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!ty(r,n)||!ty(i,s):!0}function eM(e,t,r){var n=!1,i=Rl,s=t.contextType;return typeof s=="object"&&s!==null?s=Ls(s):(i=Wi(t)?cu:si.current,n=t.contextTypes,s=(n=n!=null)?vd(e,i):Rl),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=l0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Cj(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&l0.enqueueReplaceState(t,t.state,null)}function SE(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=QB,aO(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Ls(s):(s=Wi(t)?cu:si.current,i.context=vd(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(wE(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&l0.enqueueReplaceState(i,i.state,null),J_(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Ng(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ve(309));var n=r.stateNode}if(!n)throw Error(Ve(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;o===QB&&(o=i.refs={}),a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(Ve(284));if(!r._owner)throw Error(Ve(290,e))}return e}function b_(e,t){throw e=Object.prototype.toString.call(t),Error(Ve(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ij(e){var t=e._init;return t(e._payload)}function tM(e){function t(S,O){if(e){var A=S.deletions;A===null?(S.deletions=[O],S.flags|=16):A.push(O)}}function r(S,O){if(!e)return null;for(;O!==null;)t(S,O),O=O.sibling;return null}function n(S,O){for(S=new Map;O!==null;)O.key!==null?S.set(O.key,O):S.set(O.index,O),O=O.sibling;return S}function i(S,O){return S=Bl(S,O),S.index=0,S.sibling=null,S}function s(S,O,A){return S.index=A,e?(A=S.alternate,A!==null?(A=A.index,A<O?(S.flags|=2,O):A):(S.flags|=2,O)):(S.flags|=1048576,O)}function a(S){return e&&S.alternate===null&&(S.flags|=2),S}function o(S,O,A,C){return O===null||O.tag!==6?(O=qk(A,S.mode,C),O.return=S,O):(O=i(O,A),O.return=S,O)}function l(S,O,A,C){var I=A.type;return I===td?f(S,O,A.props.children,C,A.key):O!==null&&(O.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===kl&&Ij(I)===O.type)?(C=i(O,A.props),C.ref=Ng(S,O,A),C.return=S,C):(C=N_(A.type,A.key,A.props,null,S.mode,C),C.ref=Ng(S,O,A),C.return=S,C)}function c(S,O,A,C){return O===null||O.tag!==4||O.stateNode.containerInfo!==A.containerInfo||O.stateNode.implementation!==A.implementation?(O=Vk(A,S.mode,C),O.return=S,O):(O=i(O,A.children||[]),O.return=S,O)}function f(S,O,A,C,I){return O===null||O.tag!==7?(O=lu(A,S.mode,C,I),O.return=S,O):(O=i(O,A),O.return=S,O)}function u(S,O,A){if(typeof O=="string"&&O!==""||typeof O=="number")return O=qk(""+O,S.mode,A),O.return=S,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case n_:return A=N_(O.type,O.key,O.props,null,S.mode,A),A.ref=Ng(S,null,O),A.return=S,A;case ed:return O=Vk(O,S.mode,A),O.return=S,O;case kl:var C=O._init;return u(S,C(O._payload),A)}if(jg(O)||Ag(O))return O=lu(O,S.mode,A,null),O.return=S,O;b_(S,O)}return null}function d(S,O,A,C){var I=O!==null?O.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return I!==null?null:o(S,O,""+A,C);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case n_:return A.key===I?l(S,O,A,C):null;case ed:return A.key===I?c(S,O,A,C):null;case kl:return I=A._init,d(S,O,I(A._payload),C)}if(jg(A)||Ag(A))return I!==null?null:f(S,O,A,C,null);b_(S,A)}return null}function p(S,O,A,C,I){if(typeof C=="string"&&C!==""||typeof C=="number")return S=S.get(A)||null,o(O,S,""+C,I);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case n_:return S=S.get(C.key===null?A:C.key)||null,l(O,S,C,I);case ed:return S=S.get(C.key===null?A:C.key)||null,c(O,S,C,I);case kl:var D=C._init;return p(S,O,A,D(C._payload),I)}if(jg(C)||Ag(C))return S=S.get(A)||null,f(O,S,C,I,null);b_(O,C)}return null}function _(S,O,A,C){for(var I=null,D=null,L=O,U=O=0,te=null;L!==null&&U<A.length;U++){L.index>U?(te=L,L=null):te=L.sibling;var V=d(S,L,A[U],C);if(V===null){L===null&&(L=te);break}e&&L&&V.alternate===null&&t(S,L),O=s(V,O,U),D===null?I=V:D.sibling=V,D=V,L=te}if(U===A.length)return r(S,L),$r&&ru(S,U),I;if(L===null){for(;U<A.length;U++)L=u(S,A[U],C),L!==null&&(O=s(L,O,U),D===null?I=L:D.sibling=L,D=L);return $r&&ru(S,U),I}for(L=n(S,L);U<A.length;U++)te=p(L,S,U,A[U],C),te!==null&&(e&&te.alternate!==null&&L.delete(te.key===null?U:te.key),O=s(te,O,U),D===null?I=te:D.sibling=te,D=te);return e&&L.forEach(function(X){return t(S,X)}),$r&&ru(S,U),I}function w(S,O,A,C){var I=Ag(A);if(typeof I!="function")throw Error(Ve(150));if(A=I.call(A),A==null)throw Error(Ve(151));for(var D=I=null,L=O,U=O=0,te=null,V=A.next();L!==null&&!V.done;U++,V=A.next()){L.index>U?(te=L,L=null):te=L.sibling;var X=d(S,L,V.value,C);if(X===null){L===null&&(L=te);break}e&&L&&X.alternate===null&&t(S,L),O=s(X,O,U),D===null?I=X:D.sibling=X,D=X,L=te}if(V.done)return r(S,L),$r&&ru(S,U),I;if(L===null){for(;!V.done;U++,V=A.next())V=u(S,V.value,C),V!==null&&(O=s(V,O,U),D===null?I=V:D.sibling=V,D=V);return $r&&ru(S,U),I}for(L=n(S,L);!V.done;U++,V=A.next())V=p(L,S,U,V.value,C),V!==null&&(e&&V.alternate!==null&&L.delete(V.key===null?U:V.key),O=s(V,O,U),D===null?I=V:D.sibling=V,D=V);return e&&L.forEach(function(Z){return t(S,Z)}),$r&&ru(S,U),I}function k(S,O,A,C){if(typeof A=="object"&&A!==null&&A.type===td&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case n_:e:{for(var I=A.key,D=O;D!==null;){if(D.key===I){if(I=A.type,I===td){if(D.tag===7){r(S,D.sibling),O=i(D,A.props.children),O.return=S,S=O;break e}}else if(D.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===kl&&Ij(I)===D.type){r(S,D.sibling),O=i(D,A.props),O.ref=Ng(S,D,A),O.return=S,S=O;break e}r(S,D);break}else t(S,D);D=D.sibling}A.type===td?(O=lu(A.props.children,S.mode,C,A.key),O.return=S,S=O):(C=N_(A.type,A.key,A.props,null,S.mode,C),C.ref=Ng(S,O,A),C.return=S,S=C)}return a(S);case ed:e:{for(D=A.key;O!==null;){if(O.key===D)if(O.tag===4&&O.stateNode.containerInfo===A.containerInfo&&O.stateNode.implementation===A.implementation){r(S,O.sibling),O=i(O,A.children||[]),O.return=S,S=O;break e}else{r(S,O);break}else t(S,O);O=O.sibling}O=Vk(A,S.mode,C),O.return=S,S=O}return a(S);case kl:return D=A._init,k(S,O,D(A._payload),C)}if(jg(A))return _(S,O,A,C);if(Ag(A))return w(S,O,A,C);b_(S,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,O!==null&&O.tag===6?(r(S,O.sibling),O=i(O,A),O.return=S,S=O):(r(S,O),O=qk(A,S.mode,C),O.return=S,S=O),a(S)):r(S,O)}return k}var wd=tM(!0),rM=tM(!1),hy={},qa=Ul(hy),sy=Ul(hy),ay=Ul(hy);function au(e){if(e===hy)throw Error(Ve(174));return e}function oO(e,t){switch(Or(ay,t),Or(sy,e),Or(qa,hy),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:eE(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=eE(t,e)}Dr(qa),Or(qa,t)}function Sd(){Dr(qa),Dr(sy),Dr(ay)}function nM(e){au(ay.current);var t=au(qa.current),r=eE(t,e.type);t!==r&&(Or(sy,e),Or(qa,r))}function lO(e){sy.current===e&&(Dr(qa),Dr(sy))}var Hr=Ul(0);function G_(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Bk=[];function cO(){for(var e=0;e<Bk.length;e++)Bk[e]._workInProgressVersionPrimary=null;Bk.length=0}var O_=Po.ReactCurrentDispatcher,Mk=Po.ReactCurrentBatchConfig,fu=0,Wr=null,xn=null,Cn=null,K_=!1,Vg=!1,oy=0,dne=0;function ri(){throw Error(Ve(321))}function uO(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!la(e[r],t[r]))return!1;return!0}function fO(e,t,r,n,i,s){if(fu=s,Wr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,O_.current=e===null||e.memoizedState===null?yne:mne,e=r(n,i),Vg){s=0;do{if(Vg=!1,oy=0,25<=s)throw Error(Ve(301));s+=1,Cn=xn=null,t.updateQueue=null,O_.current=bne,e=r(n,i)}while(Vg)}if(O_.current=Y_,t=xn!==null&&xn.next!==null,fu=0,Cn=xn=Wr=null,K_=!1,t)throw Error(Ve(300));return e}function dO(){var e=oy!==0;return oy=0,e}function $a(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cn===null?Wr.memoizedState=Cn=e:Cn=Cn.next=e,Cn}function Fs(){if(xn===null){var e=Wr.alternate;e=e!==null?e.memoizedState:null}else e=xn.next;var t=Cn===null?Wr.memoizedState:Cn.next;if(t!==null)Cn=t,xn=e;else{if(e===null)throw Error(Ve(310));xn=e,e={memoizedState:xn.memoizedState,baseState:xn.baseState,baseQueue:xn.baseQueue,queue:xn.queue,next:null},Cn===null?Wr.memoizedState=Cn=e:Cn=Cn.next=e}return Cn}function ly(e,t){return typeof t=="function"?t(e):t}function Rk(e){var t=Fs(),r=t.queue;if(r===null)throw Error(Ve(311));r.lastRenderedReducer=e;var n=xn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var f=c.lane;if((fu&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var u={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=u,a=n):l=l.next=u,Wr.lanes|=f,du|=f}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,la(n,t.memoizedState)||(Vi=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Wr.lanes|=s,du|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function $k(e){var t=Fs(),r=t.queue;if(r===null)throw Error(Ve(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);la(s,t.memoizedState)||(Vi=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function iM(){}function sM(e,t){var r=Wr,n=Fs(),i=t(),s=!la(n.memoizedState,i);if(s&&(n.memoizedState=i,Vi=!0),n=n.queue,pO(lM.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Cn!==null&&Cn.memoizedState.tag&1){if(r.flags|=2048,cy(9,oM.bind(null,r,n,i,t),void 0,null),In===null)throw Error(Ve(349));fu&30||aM(r,t,i)}return i}function aM(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Wr.updateQueue,t===null?(t={lastEffect:null,stores:null},Wr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function oM(e,t,r,n){t.value=r,t.getSnapshot=n,cM(t)&&uM(e)}function lM(e,t,r){return r(function(){cM(t)&&uM(e)})}function cM(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!la(e,r)}catch{return!0}}function uM(e){var t=Io(e,1);t!==null&&oa(t,e,1,-1)}function Nj(e){var t=$a();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ly,lastRenderedState:e},t.queue=e,e=e.dispatch=gne.bind(null,Wr,e),[t.memoizedState,e]}function cy(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Wr.updateQueue,t===null?(t={lastEffect:null,stores:null},Wr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function fM(){return Fs().memoizedState}function A_(e,t,r,n){var i=$a();Wr.flags|=e,i.memoizedState=cy(1|t,r,void 0,n===void 0?null:n)}function c0(e,t,r,n){var i=Fs();n=n===void 0?null:n;var s=void 0;if(xn!==null){var a=xn.memoizedState;if(s=a.destroy,n!==null&&uO(n,a.deps)){i.memoizedState=cy(t,r,s,n);return}}Wr.flags|=e,i.memoizedState=cy(1|t,r,s,n)}function Pj(e,t){return A_(8390656,8,e,t)}function pO(e,t){return c0(2048,8,e,t)}function dM(e,t){return c0(4,2,e,t)}function pM(e,t){return c0(4,4,e,t)}function hM(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function gM(e,t,r){return r=r!=null?r.concat([e]):null,c0(4,4,hM.bind(null,t,e),r)}function hO(){}function yM(e,t){var r=Fs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&uO(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function mM(e,t){var r=Fs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&uO(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function bM(e,t,r){return fu&21?(la(r,t)||(r=wB(),Wr.lanes|=r,du|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Vi=!0),e.memoizedState=r)}function pne(e,t){var r=pr;pr=r!==0&&4>r?r:4,e(!0);var n=Mk.transition;Mk.transition={};try{e(!1),t()}finally{pr=r,Mk.transition=n}}function vM(){return Fs().memoizedState}function hne(e,t,r){var n=jl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},_M(e))wM(t,r);else if(r=XB(e,t,r,n),r!==null){var i=ki();oa(r,e,n,i),SM(r,t,n)}}function gne(e,t,r){var n=jl(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(_M(e))wM(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,la(o,a)){var l=t.interleaved;l===null?(i.next=i,sO(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=XB(e,t,i,n),r!==null&&(i=ki(),oa(r,e,n,i),SM(r,t,n))}}function _M(e){var t=e.alternate;return e===Wr||t!==null&&t===Wr}function wM(e,t){Vg=K_=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function SM(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,HE(e,r)}}var Y_={readContext:Ls,useCallback:ri,useContext:ri,useEffect:ri,useImperativeHandle:ri,useInsertionEffect:ri,useLayoutEffect:ri,useMemo:ri,useReducer:ri,useRef:ri,useState:ri,useDebugValue:ri,useDeferredValue:ri,useTransition:ri,useMutableSource:ri,useSyncExternalStore:ri,useId:ri,unstable_isNewReconciler:!1},yne={readContext:Ls,useCallback:function(e,t){return $a().memoizedState=[e,t===void 0?null:t],e},useContext:Ls,useEffect:Pj,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,A_(4194308,4,hM.bind(null,t,e),r)},useLayoutEffect:function(e,t){return A_(4194308,4,e,t)},useInsertionEffect:function(e,t){return A_(4,2,e,t)},useMemo:function(e,t){var r=$a();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=$a();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=hne.bind(null,Wr,e),[n.memoizedState,e]},useRef:function(e){var t=$a();return e={current:e},t.memoizedState=e},useState:Nj,useDebugValue:hO,useDeferredValue:function(e){return $a().memoizedState=e},useTransition:function(){var e=Nj(!1),t=e[0];return e=pne.bind(null,e[1]),$a().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Wr,i=$a();if($r){if(r===void 0)throw Error(Ve(407));r=r()}else{if(r=t(),In===null)throw Error(Ve(349));fu&30||aM(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Pj(lM.bind(null,n,s,e),[e]),n.flags|=2048,cy(9,oM.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=$a(),t=In.identifierPrefix;if($r){var r=Oo,n=Eo;r=(n&~(1<<32-aa(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=oy++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=dne++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},mne={readContext:Ls,useCallback:yM,useContext:Ls,useEffect:pO,useImperativeHandle:gM,useInsertionEffect:dM,useLayoutEffect:pM,useMemo:mM,useReducer:Rk,useRef:fM,useState:function(){return Rk(ly)},useDebugValue:hO,useDeferredValue:function(e){var t=Fs();return bM(t,xn.memoizedState,e)},useTransition:function(){var e=Rk(ly)[0],t=Fs().memoizedState;return[e,t]},useMutableSource:iM,useSyncExternalStore:sM,useId:vM,unstable_isNewReconciler:!1},bne={readContext:Ls,useCallback:yM,useContext:Ls,useEffect:pO,useImperativeHandle:gM,useInsertionEffect:dM,useLayoutEffect:pM,useMemo:mM,useReducer:$k,useRef:fM,useState:function(){return $k(ly)},useDebugValue:hO,useDeferredValue:function(e){var t=Fs();return xn===null?t.memoizedState=e:bM(t,xn.memoizedState,e)},useTransition:function(){var e=$k(ly)[0],t=Fs().memoizedState;return[e,t]},useMutableSource:iM,useSyncExternalStore:sM,useId:vM,unstable_isNewReconciler:!1};function xd(e,t){try{var r="",n=t;do r+=Gte(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Uk(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function xE(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var vne=typeof WeakMap=="function"?WeakMap:Map;function xM(e,t,r){r=Ao(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Z_||(Z_=!0,LE=n),xE(e,t)},r}function kM(e,t,r){r=Ao(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){xE(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){xE(e,t),typeof n!="function"&&(Dl===null?Dl=new Set([this]):Dl.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Lj(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new vne;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Lne.bind(null,e,t,r),t.then(e,e))}function Fj(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Dj(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ao(-1,1),t.tag=2,Fl(r,t,1))),r.lanes|=1),e)}var _ne=Po.ReactCurrentOwner,Vi=!1;function xi(e,t,r,n){t.child=e===null?rM(t,null,r,n):wd(t,e.child,r,n)}function jj(e,t,r,n,i){r=r.render;var s=t.ref;return yd(t,i),n=fO(e,t,r,n,s,i),r=dO(),e!==null&&!Vi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,No(e,t,i)):($r&&r&&QE(t),t.flags|=1,xi(e,t,n,i),t.child)}function Bj(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!SO(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,EM(e,t,s,n,i)):(e=N_(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:ty,r(a,n)&&e.ref===t.ref)return No(e,t,i)}return t.flags|=1,e=Bl(s,n),e.ref=t.ref,e.return=t,t.child=e}function EM(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(ty(s,n)&&e.ref===t.ref)if(Vi=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Vi=!0);else return t.lanes=e.lanes,No(e,t,i)}return kE(e,t,r,n,i)}function OM(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Or(fd,ls),ls|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Or(fd,ls),ls|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Or(fd,ls),ls|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Or(fd,ls),ls|=n;return xi(e,t,i,r),t.child}function AM(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function kE(e,t,r,n,i){var s=Wi(r)?cu:si.current;return s=vd(t,s),yd(t,i),r=fO(e,t,r,n,s,i),n=dO(),e!==null&&!Vi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,No(e,t,i)):($r&&n&&QE(t),t.flags|=1,xi(e,t,r,i),t.child)}function Mj(e,t,r,n,i){if(Wi(r)){var s=!0;z_(t)}else s=!1;if(yd(t,i),t.stateNode===null)T_(e,t),eM(t,r,n),SE(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Ls(c):(c=Wi(r)?cu:si.current,c=vd(t,c));var f=r.getDerivedStateFromProps,u=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";u||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Cj(t,a,n,c),El=!1;var d=t.memoizedState;a.state=d,J_(t,n,a,i),l=t.memoizedState,o!==n||d!==l||Hi.current||El?(typeof f=="function"&&(wE(t,r,f,n),l=t.memoizedState),(o=El||Tj(t,r,o,n,d,l,c))?(u||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,ZB(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:na(t.type,o),a.props=c,u=t.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Ls(l):(l=Wi(r)?cu:si.current,l=vd(t,l));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==u||d!==l)&&Cj(t,a,n,l),El=!1,d=t.memoizedState,a.state=d,J_(t,n,a,i);var _=t.memoizedState;o!==u||d!==_||Hi.current||El?(typeof p=="function"&&(wE(t,r,p,n),_=t.memoizedState),(c=El||Tj(t,r,c,n,d,_,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,_,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,_,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=_),a.props=n,a.state=_,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return EE(e,t,r,n,s,i)}function EE(e,t,r,n,i,s){AM(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&xj(t,r,!1),No(e,t,s);n=t.stateNode,_ne.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=wd(t,e.child,null,s),t.child=wd(t,null,o,s)):xi(e,t,o,s),t.memoizedState=n.state,i&&xj(t,r,!0),t.child}function TM(e){var t=e.stateNode;t.pendingContext?Sj(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Sj(e,t.context,!1),oO(e,t.containerInfo)}function Rj(e,t,r,n,i){return _d(),tO(i),t.flags|=256,xi(e,t,r,n),t.child}var OE={dehydrated:null,treeContext:null,retryLane:0};function AE(e){return{baseLanes:e,cachePool:null,transitions:null}}function CM(e,t,r){var n=t.pendingProps,i=Hr.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Or(Hr,i&1),e===null)return vE(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=d0(a,n,0,null),e=lu(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=AE(r),t.memoizedState=OE,e):gO(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return wne(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Bl(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Bl(o,s):(s=lu(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?AE(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=OE,n}return s=e.child,e=s.sibling,n=Bl(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function gO(e,t){return t=d0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function v_(e,t,r,n){return n!==null&&tO(n),wd(t,e.child,null,r),e=gO(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function wne(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=Uk(Error(Ve(422))),v_(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=d0({mode:"visible",children:n.children},i,0,null),s=lu(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&wd(t,e.child,null,a),t.child.memoizedState=AE(a),t.memoizedState=OE,s);if(!(t.mode&1))return v_(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Ve(419)),n=Uk(s,n,void 0),v_(e,t,a,n)}if(o=(a&e.childLanes)!==0,Vi||o){if(n=In,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Io(e,i),oa(n,e,i,-1))}return wO(),n=Uk(Error(Ve(421))),v_(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=Fne.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,cs=Ll(i.nextSibling),us=t,$r=!0,sa=null,e!==null&&(Cs[Is++]=Eo,Cs[Is++]=Oo,Cs[Is++]=uu,Eo=e.id,Oo=e.overflow,uu=t),t=gO(t,n.children),t.flags|=4096,t)}function $j(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),_E(e.return,t,r)}function zk(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function IM(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(xi(e,t,n.children,r),n=Hr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$j(e,r,t);else if(e.tag===19)$j(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Or(Hr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&G_(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),zk(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&G_(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}zk(t,!0,r,null,s);break;case"together":zk(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function T_(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function No(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),du|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ve(153));if(t.child!==null){for(e=t.child,r=Bl(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Bl(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Sne(e,t,r){switch(t.tag){case 3:TM(t),_d();break;case 5:nM(t);break;case 1:Wi(t.type)&&z_(t);break;case 4:oO(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Or(H_,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Or(Hr,Hr.current&1),t.flags|=128,null):r&t.child.childLanes?CM(e,t,r):(Or(Hr,Hr.current&1),e=No(e,t,r),e!==null?e.sibling:null);Or(Hr,Hr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return IM(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Or(Hr,Hr.current),n)break;return null;case 22:case 23:return t.lanes=0,OM(e,t,r)}return No(e,t,r)}var NM,TE,PM,LM;NM=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};TE=function(){};PM=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,au(qa.current);var s=null;switch(r){case"input":i=Yk(e,i),n=Yk(e,n),s=[];break;case"select":i=Jr({},i,{value:void 0}),n=Jr({},n,{value:void 0}),s=[];break;case"textarea":i=Qk(e,i),n=Qk(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=$_)}tE(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Gg.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i?.[c],n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Gg.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Fr("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};LM=function(e,t,r,n){r!==n&&(t.flags|=4)};function Pg(e,t){if(!$r)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ni(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function xne(e,t,r){var n=t.pendingProps;switch(eO(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ni(t),null;case 1:return Wi(t.type)&&U_(),ni(t),null;case 3:return n=t.stateNode,Sd(),Dr(Hi),Dr(si),cO(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(m_(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,sa!==null&&(jE(sa),sa=null))),TE(e,t),ni(t),null;case 5:lO(t);var i=au(ay.current);if(r=t.type,e!==null&&t.stateNode!=null)PM(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ve(166));return ni(t),null}if(e=au(qa.current),m_(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Ua]=t,n[iy]=s,e=(t.mode&1)!==0,r){case"dialog":Fr("cancel",n),Fr("close",n);break;case"iframe":case"object":case"embed":Fr("load",n);break;case"video":case"audio":for(i=0;i<Mg.length;i++)Fr(Mg[i],n);break;case"source":Fr("error",n);break;case"img":case"image":case"link":Fr("error",n),Fr("load",n);break;case"details":Fr("toggle",n);break;case"input":GD(n,s),Fr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Fr("invalid",n);break;case"textarea":YD(n,s),Fr("invalid",n)}tE(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&y_(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&y_(n.textContent,o,e),i=["children",""+o]):Gg.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Fr("scroll",n)}switch(r){case"input":i_(n),KD(n,s,!0);break;case"textarea":i_(n),XD(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=$_)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=aB(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Ua]=t,e[iy]=n,NM(e,t,!1,!1),t.stateNode=e;e:{switch(a=rE(r,n),r){case"dialog":Fr("cancel",e),Fr("close",e),i=n;break;case"iframe":case"object":case"embed":Fr("load",e),i=n;break;case"video":case"audio":for(i=0;i<Mg.length;i++)Fr(Mg[i],e);i=n;break;case"source":Fr("error",e),i=n;break;case"img":case"image":case"link":Fr("error",e),Fr("load",e),i=n;break;case"details":Fr("toggle",e),i=n;break;case"input":GD(e,n),i=Yk(e,n),Fr("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Jr({},n,{value:void 0}),Fr("invalid",e);break;case"textarea":YD(e,n),i=Qk(e,n),Fr("invalid",e);break;default:i=n}tE(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?cB(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&oB(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Kg(e,l):typeof l=="number"&&Kg(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Gg.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Fr("scroll",e):l!=null&&RE(e,s,l,a))}switch(r){case"input":i_(e),KD(e,n,!1);break;case"textarea":i_(e),XD(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ml(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?dd(e,!!n.multiple,s,!1):n.defaultValue!=null&&dd(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=$_)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ni(t),null;case 6:if(e&&t.stateNode!=null)LM(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ve(166));if(r=au(ay.current),au(qa.current),m_(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ua]=t,(s=n.nodeValue!==r)&&(e=us,e!==null))switch(e.tag){case 3:y_(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&y_(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ua]=t,t.stateNode=n}return ni(t),null;case 13:if(Dr(Hr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($r&&cs!==null&&t.mode&1&&!(t.flags&128))YB(),_d(),t.flags|=98560,s=!1;else if(s=m_(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Ve(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ve(317));s[Ua]=t}else _d(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ni(t),s=!1}else sa!==null&&(jE(sa),sa=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Hr.current&1?kn===0&&(kn=3):wO())),t.updateQueue!==null&&(t.flags|=4),ni(t),null);case 4:return Sd(),TE(e,t),e===null&&ry(t.stateNode.containerInfo),ni(t),null;case 10:return iO(t.type._context),ni(t),null;case 17:return Wi(t.type)&&U_(),ni(t),null;case 19:if(Dr(Hr),s=t.memoizedState,s===null)return ni(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)Pg(s,!1);else{if(kn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=G_(e),a!==null){for(t.flags|=128,Pg(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Or(Hr,Hr.current&1|2),t.child}e=e.sibling}s.tail!==null&&on()>kd&&(t.flags|=128,n=!0,Pg(s,!1),t.lanes=4194304)}else{if(!n)if(e=G_(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Pg(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!$r)return ni(t),null}else 2*on()-s.renderingStartTime>kd&&r!==1073741824&&(t.flags|=128,n=!0,Pg(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=on(),t.sibling=null,r=Hr.current,Or(Hr,n?r&1|2:r&1),t):(ni(t),null);case 22:case 23:return _O(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ls&1073741824&&(ni(t),t.subtreeFlags&6&&(t.flags|=8192)):ni(t),null;case 24:return null;case 25:return null}throw Error(Ve(156,t.tag))}function kne(e,t){switch(eO(t),t.tag){case 1:return Wi(t.type)&&U_(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Sd(),Dr(Hi),Dr(si),cO(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return lO(t),null;case 13:if(Dr(Hr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ve(340));_d()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Dr(Hr),null;case 4:return Sd(),null;case 10:return iO(t.type._context),null;case 22:case 23:return _O(),null;case 24:return null;default:return null}}var __=!1,ii=!1,Ene=typeof WeakSet=="function"?WeakSet:Set,lt=null;function ud(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Xr(e,t,n)}else r.current=null}function CE(e,t,r){try{r()}catch(n){Xr(e,t,n)}}var Uj=!1;function One(e,t){if(dE=B_,e=BB(),ZE(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,f=0,u=e,d=null;t:for(;;){for(var p;u!==r||i!==0&&u.nodeType!==3||(o=a+i),u!==s||n!==0&&u.nodeType!==3||(l=a+n),u.nodeType===3&&(a+=u.nodeValue.length),(p=u.firstChild)!==null;)d=u,u=p;for(;;){if(u===e)break t;if(d===r&&++c===i&&(o=a),d===s&&++f===n&&(l=a),(p=u.nextSibling)!==null)break;u=d,d=u.parentNode}u=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(pE={focusedElem:e,selectionRange:r},B_=!1,lt=t;lt!==null;)if(t=lt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,lt=e;else for(;lt!==null;){t=lt;try{var _=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var w=_.memoizedProps,k=_.memoizedState,S=t.stateNode,O=S.getSnapshotBeforeUpdate(t.elementType===t.type?w:na(t.type,w),k);S.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var A=t.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ve(163))}}catch(C){Xr(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,lt=e;break}lt=t.return}return _=Uj,Uj=!1,_}function Hg(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&CE(t,r,s)}i=i.next}while(i!==n)}}function u0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function IE(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function FM(e){var t=e.alternate;t!==null&&(e.alternate=null,FM(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ua],delete t[iy],delete t[yE],delete t[lne],delete t[cne])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function DM(e){return e.tag===5||e.tag===3||e.tag===4}function zj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||DM(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function NE(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=$_));else if(n!==4&&(e=e.child,e!==null))for(NE(e,t,r),e=e.sibling;e!==null;)NE(e,t,r),e=e.sibling}function PE(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(PE(e,t,r),e=e.sibling;e!==null;)PE(e,t,r),e=e.sibling}var Wn=null,ia=!1;function xl(e,t,r){for(r=r.child;r!==null;)jM(e,t,r),r=r.sibling}function jM(e,t,r){if(za&&typeof za.onCommitFiberUnmount=="function")try{za.onCommitFiberUnmount(r0,r)}catch{}switch(r.tag){case 5:ii||ud(r,t);case 6:var n=Wn,i=ia;Wn=null,xl(e,t,r),Wn=n,ia=i,Wn!==null&&(ia?(e=Wn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Wn.removeChild(r.stateNode));break;case 18:Wn!==null&&(ia?(e=Wn,r=r.stateNode,e.nodeType===8?Dk(e.parentNode,r):e.nodeType===1&&Dk(e,r),Qg(e)):Dk(Wn,r.stateNode));break;case 4:n=Wn,i=ia,Wn=r.stateNode.containerInfo,ia=!0,xl(e,t,r),Wn=n,ia=i;break;case 0:case 11:case 14:case 15:if(!ii&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&CE(r,t,a),i=i.next}while(i!==n)}xl(e,t,r);break;case 1:if(!ii&&(ud(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Xr(r,t,o)}xl(e,t,r);break;case 21:xl(e,t,r);break;case 22:r.mode&1?(ii=(n=ii)||r.memoizedState!==null,xl(e,t,r),ii=n):xl(e,t,r);break;default:xl(e,t,r)}}function qj(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Ene),t.forEach(function(n){var i=Dne.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ra(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:Wn=o.stateNode,ia=!1;break e;case 3:Wn=o.stateNode.containerInfo,ia=!0;break e;case 4:Wn=o.stateNode.containerInfo,ia=!0;break e}o=o.return}if(Wn===null)throw Error(Ve(160));jM(s,a,i),Wn=null,ia=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Xr(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)BM(t,e),t=t.sibling}function BM(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ra(t,e),Ra(e),n&4){try{Hg(3,e,e.return),u0(3,e)}catch(w){Xr(e,e.return,w)}try{Hg(5,e,e.return)}catch(w){Xr(e,e.return,w)}}break;case 1:ra(t,e),Ra(e),n&512&&r!==null&&ud(r,r.return);break;case 5:if(ra(t,e),Ra(e),n&512&&r!==null&&ud(r,r.return),e.flags&32){var i=e.stateNode;try{Kg(i,"")}catch(w){Xr(e,e.return,w)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&iB(i,s),rE(o,a);var c=rE(o,s);for(a=0;a<l.length;a+=2){var f=l[a],u=l[a+1];f==="style"?cB(i,u):f==="dangerouslySetInnerHTML"?oB(i,u):f==="children"?Kg(i,u):RE(i,f,u,c)}switch(o){case"input":Xk(i,s);break;case"textarea":sB(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?dd(i,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?dd(i,!!s.multiple,s.defaultValue,!0):dd(i,!!s.multiple,s.multiple?[]:"",!1))}i[iy]=s}catch(w){Xr(e,e.return,w)}}break;case 6:if(ra(t,e),Ra(e),n&4){if(e.stateNode===null)throw Error(Ve(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(w){Xr(e,e.return,w)}}break;case 3:if(ra(t,e),Ra(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Qg(t.containerInfo)}catch(w){Xr(e,e.return,w)}break;case 4:ra(t,e),Ra(e);break;case 13:ra(t,e),Ra(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(bO=on())),n&4&&qj(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(ii=(c=ii)||f,ra(t,e),ii=c):ra(t,e),Ra(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(lt=e,f=e.child;f!==null;){for(u=lt=f;lt!==null;){switch(d=lt,p=d.child,d.tag){case 0:case 11:case 14:case 15:Hg(4,d,d.return);break;case 1:ud(d,d.return);var _=d.stateNode;if(typeof _.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,_.props=t.memoizedProps,_.state=t.memoizedState,_.componentWillUnmount()}catch(w){Xr(n,r,w)}}break;case 5:ud(d,d.return);break;case 22:if(d.memoizedState!==null){Hj(u);continue}}p!==null?(p.return=d,lt=p):Hj(u)}f=f.sibling}e:for(f=null,u=e;;){if(u.tag===5){if(f===null){f=u;try{i=u.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=u.stateNode,l=u.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=lB("display",a))}catch(w){Xr(e,e.return,w)}}}else if(u.tag===6){if(f===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(w){Xr(e,e.return,w)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;f===u&&(f=null),u=u.return}f===u&&(f=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:ra(t,e),Ra(e),n&4&&qj(e);break;case 21:break;default:ra(t,e),Ra(e)}}function Ra(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(DM(r)){var n=r;break e}r=r.return}throw Error(Ve(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Kg(i,""),n.flags&=-33);var s=zj(e);PE(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=zj(e);NE(e,o,a);break;default:throw Error(Ve(161))}}catch(l){Xr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ane(e,t,r){lt=e,MM(e,t,r)}function MM(e,t,r){for(var n=(e.mode&1)!==0;lt!==null;){var i=lt,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||__;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||ii;o=__;var c=ii;if(__=a,(ii=l)&&!c)for(lt=i;lt!==null;)a=lt,l=a.child,a.tag===22&&a.memoizedState!==null?Wj(i):l!==null?(l.return=a,lt=l):Wj(i);for(;s!==null;)lt=s,MM(s,t,r),s=s.sibling;lt=i,__=o,ii=c}Vj(e,t,r)}else i.subtreeFlags&8772&&s!==null?(s.return=i,lt=s):Vj(e,t,r)}}function Vj(e){for(;lt!==null;){var t=lt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ii||u0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ii)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:na(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Aj(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Aj(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var u=f.dehydrated;u!==null&&Qg(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ve(163))}ii||t.flags&512&&IE(t)}catch(d){Xr(t,t.return,d)}}if(t===e){lt=null;break}if(r=t.sibling,r!==null){r.return=t.return,lt=r;break}lt=t.return}}function Hj(e){for(;lt!==null;){var t=lt;if(t===e){lt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,lt=r;break}lt=t.return}}function Wj(e){for(;lt!==null;){var t=lt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{u0(4,t)}catch(l){Xr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){Xr(t,i,l)}}var s=t.return;try{IE(t)}catch(l){Xr(t,s,l)}break;case 5:var a=t.return;try{IE(t)}catch(l){Xr(t,a,l)}}}catch(l){Xr(t,t.return,l)}if(t===e){lt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,lt=o;break}lt=t.return}}var Tne=Math.ceil,X_=Po.ReactCurrentDispatcher,yO=Po.ReactCurrentOwner,Ps=Po.ReactCurrentBatchConfig,Yt=0,In=null,yn=null,Jn=0,ls=0,fd=Ul(0),kn=0,uy=null,du=0,f0=0,mO=0,Wg=null,qi=null,bO=0,kd=1/0,xo=null,Z_=!1,LE=null,Dl=null,w_=!1,Cl=null,Q_=0,Jg=0,FE=null,C_=-1,I_=0;function ki(){return Yt&6?on():C_!==-1?C_:C_=on()}function jl(e){return e.mode&1?Yt&2&&Jn!==0?Jn&-Jn:fne.transition!==null?(I_===0&&(I_=wB()),I_):(e=pr,e!==0||(e=window.event,e=e===void 0?16:TB(e.type)),e):1}function oa(e,t,r,n){if(50<Jg)throw Jg=0,FE=null,Error(Ve(185));fy(e,r,n),(!(Yt&2)||e!==In)&&(e===In&&(!(Yt&2)&&(f0|=r),kn===4&&Al(e,Jn)),Ji(e,n),r===1&&Yt===0&&!(t.mode&1)&&(kd=on()+500,o0&&zl()))}function Ji(e,t){var r=e.callbackNode;pre(e,t);var n=j_(e,e===In?Jn:0);if(n===0)r!==null&&ej(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&ej(r),t===1)e.tag===0?une(Jj.bind(null,e)):JB(Jj.bind(null,e)),ane(function(){!(Yt&6)&&zl()}),r=null;else{switch(SB(n)){case 1:r=VE;break;case 4:r=vB;break;case 16:r=D_;break;case 536870912:r=_B;break;default:r=D_}r=WM(r,RM.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function RM(e,t){if(C_=-1,I_=0,Yt&6)throw Error(Ve(327));var r=e.callbackNode;if(md()&&e.callbackNode!==r)return null;var n=j_(e,e===In?Jn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=e0(e,n);else{t=n;var i=Yt;Yt|=2;var s=UM();(In!==e||Jn!==t)&&(xo=null,kd=on()+500,ou(e,t));do try{Nne();break}catch(o){$M(e,o)}while(1);nO(),X_.current=s,Yt=i,yn!==null?t=0:(In=null,Jn=0,t=kn)}if(t!==0){if(t===2&&(i=oE(e),i!==0&&(n=i,t=DE(e,i))),t===1)throw r=uy,ou(e,0),Al(e,n),Ji(e,on()),r;if(t===6)Al(e,n);else{if(i=e.current.alternate,!(n&30)&&!Cne(i)&&(t=e0(e,n),t===2&&(s=oE(e),s!==0&&(n=s,t=DE(e,s))),t===1))throw r=uy,ou(e,0),Al(e,n),Ji(e,on()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Ve(345));case 2:nu(e,qi,xo);break;case 3:if(Al(e,n),(n&130023424)===n&&(t=bO+500-on(),10<t)){if(j_(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){ki(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=gE(nu.bind(null,e,qi,xo),t);break}nu(e,qi,xo);break;case 4:if(Al(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-aa(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=on()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Tne(n/1960))-n,10<n){e.timeoutHandle=gE(nu.bind(null,e,qi,xo),n);break}nu(e,qi,xo);break;case 5:nu(e,qi,xo);break;default:throw Error(Ve(329))}}}return Ji(e,on()),e.callbackNode===r?RM.bind(null,e):null}function DE(e,t){var r=Wg;return e.current.memoizedState.isDehydrated&&(ou(e,t).flags|=256),e=e0(e,t),e!==2&&(t=qi,qi=r,t!==null&&jE(t)),e}function jE(e){qi===null?qi=e:qi.push.apply(qi,e)}function Cne(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!la(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Al(e,t){for(t&=~mO,t&=~f0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-aa(t),n=1<<r;e[r]=-1,t&=~n}}function Jj(e){if(Yt&6)throw Error(Ve(327));md();var t=j_(e,0);if(!(t&1))return Ji(e,on()),null;var r=e0(e,t);if(e.tag!==0&&r===2){var n=oE(e);n!==0&&(t=n,r=DE(e,n))}if(r===1)throw r=uy,ou(e,0),Al(e,t),Ji(e,on()),r;if(r===6)throw Error(Ve(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,nu(e,qi,xo),Ji(e,on()),null}function vO(e,t){var r=Yt;Yt|=1;try{return e(t)}finally{Yt=r,Yt===0&&(kd=on()+500,o0&&zl())}}function pu(e){Cl!==null&&Cl.tag===0&&!(Yt&6)&&md();var t=Yt;Yt|=1;var r=Ps.transition,n=pr;try{if(Ps.transition=null,pr=1,e)return e()}finally{pr=n,Ps.transition=r,Yt=t,!(Yt&6)&&zl()}}function _O(){ls=fd.current,Dr(fd)}function ou(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,sne(r)),yn!==null)for(r=yn.return;r!==null;){var n=r;switch(eO(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&U_();break;case 3:Sd(),Dr(Hi),Dr(si),cO();break;case 5:lO(n);break;case 4:Sd();break;case 13:Dr(Hr);break;case 19:Dr(Hr);break;case 10:iO(n.type._context);break;case 22:case 23:_O()}r=r.return}if(In=e,yn=e=Bl(e.current,null),Jn=ls=t,kn=0,uy=null,mO=f0=du=0,qi=Wg=null,su!==null){for(t=0;t<su.length;t++)if(r=su[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}su=null}return e}function $M(e,t){do{var r=yn;try{if(nO(),O_.current=Y_,K_){for(var n=Wr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}K_=!1}if(fu=0,Cn=xn=Wr=null,Vg=!1,oy=0,yO.current=null,r===null||r.return===null){kn=1,uy=t,yn=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=Jn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,u=f.tag;if(!(f.mode&1)&&(u===0||u===11||u===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=Fj(a);if(p!==null){p.flags&=-257,Dj(p,a,o,s,t),p.mode&1&&Lj(s,c,t),t=p,l=c;var _=t.updateQueue;if(_===null){var w=new Set;w.add(l),t.updateQueue=w}else _.add(l);break e}else{if(!(t&1)){Lj(s,c,t),wO();break e}l=Error(Ve(426))}}else if($r&&o.mode&1){var k=Fj(a);if(k!==null){!(k.flags&65536)&&(k.flags|=256),Dj(k,a,o,s,t),tO(xd(l,o));break e}}s=l=xd(l,o),kn!==4&&(kn=2),Wg===null?Wg=[s]:Wg.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var S=xM(s,l,t);Oj(s,S);break e;case 1:o=l;var O=s.type,A=s.stateNode;if(!(s.flags&128)&&(typeof O.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Dl===null||!Dl.has(A)))){s.flags|=65536,t&=-t,s.lanes|=t;var C=kM(s,o,t);Oj(s,C);break e}}s=s.return}while(s!==null)}qM(r)}catch(I){t=I,yn===r&&r!==null&&(yn=r=r.return);continue}break}while(1)}function UM(){var e=X_.current;return X_.current=Y_,e===null?Y_:e}function wO(){(kn===0||kn===3||kn===2)&&(kn=4),In===null||!(du&268435455)&&!(f0&268435455)||Al(In,Jn)}function e0(e,t){var r=Yt;Yt|=2;var n=UM();(In!==e||Jn!==t)&&(xo=null,ou(e,t));do try{Ine();break}catch(i){$M(e,i)}while(1);if(nO(),Yt=r,X_.current=n,yn!==null)throw Error(Ve(261));return In=null,Jn=0,kn}function Ine(){for(;yn!==null;)zM(yn)}function Nne(){for(;yn!==null&&!ire();)zM(yn)}function zM(e){var t=HM(e.alternate,e,ls);e.memoizedProps=e.pendingProps,t===null?qM(e):yn=t,yO.current=null}function qM(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=kne(r,t),r!==null){r.flags&=32767,yn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{kn=6,yn=null;return}}else if(r=xne(r,t,ls),r!==null){yn=r;return}if(t=t.sibling,t!==null){yn=t;return}yn=t=e}while(t!==null);kn===0&&(kn=5)}function nu(e,t,r){var n=pr,i=Ps.transition;try{Ps.transition=null,pr=1,Pne(e,t,r,n)}finally{Ps.transition=i,pr=n}return null}function Pne(e,t,r,n){do md();while(Cl!==null);if(Yt&6)throw Error(Ve(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ve(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(hre(e,s),e===In&&(yn=In=null,Jn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||w_||(w_=!0,WM(D_,function(){return md(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Ps.transition,Ps.transition=null;var a=pr;pr=1;var o=Yt;Yt|=4,yO.current=null,One(e,r),BM(r,e),ene(pE),B_=!!dE,pE=dE=null,e.current=r,Ane(r,e,i),sre(),Yt=o,pr=a,Ps.transition=s}else e.current=r;if(w_&&(w_=!1,Cl=e,Q_=i),s=e.pendingLanes,s===0&&(Dl=null),lre(r.stateNode,n),Ji(e,on()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Z_)throw Z_=!1,e=LE,LE=null,e;return Q_&1&&e.tag!==0&&md(),s=e.pendingLanes,s&1?e===FE?Jg++:(Jg=0,FE=e):Jg=0,zl(),null}function md(){if(Cl!==null){var e=SB(Q_),t=Ps.transition,r=pr;try{if(Ps.transition=null,pr=16>e?16:e,Cl===null)var n=!1;else{if(e=Cl,Cl=null,Q_=0,Yt&6)throw Error(Ve(331));var i=Yt;for(Yt|=4,lt=e.current;lt!==null;){var s=lt,a=s.child;if(lt.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(lt=c;lt!==null;){var f=lt;switch(f.tag){case 0:case 11:case 15:Hg(8,f,s)}var u=f.child;if(u!==null)u.return=f,lt=u;else for(;lt!==null;){f=lt;var d=f.sibling,p=f.return;if(FM(f),f===c){lt=null;break}if(d!==null){d.return=p,lt=d;break}lt=p}}}var _=s.alternate;if(_!==null){var w=_.child;if(w!==null){_.child=null;do{var k=w.sibling;w.sibling=null,w=k}while(w!==null)}}lt=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,lt=a;else e:for(;lt!==null;){if(s=lt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Hg(9,s,s.return)}var S=s.sibling;if(S!==null){S.return=s.return,lt=S;break e}lt=s.return}}var O=e.current;for(lt=O;lt!==null;){a=lt;var A=a.child;if(a.subtreeFlags&2064&&A!==null)A.return=a,lt=A;else e:for(a=O;lt!==null;){if(o=lt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:u0(9,o)}}catch(I){Xr(o,o.return,I)}if(o===a){lt=null;break e}var C=o.sibling;if(C!==null){C.return=o.return,lt=C;break e}lt=o.return}}if(Yt=i,zl(),za&&typeof za.onPostCommitFiberRoot=="function")try{za.onPostCommitFiberRoot(r0,e)}catch{}n=!0}return n}finally{pr=r,Ps.transition=t}}return!1}function Gj(e,t,r){t=xd(r,t),t=xM(e,t,1),e=Fl(e,t,1),t=ki(),e!==null&&(fy(e,1,t),Ji(e,t))}function Xr(e,t,r){if(e.tag===3)Gj(e,e,r);else for(;t!==null;){if(t.tag===3){Gj(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Dl===null||!Dl.has(n))){e=xd(r,e),e=kM(t,e,1),t=Fl(t,e,1),e=ki(),t!==null&&(fy(t,1,e),Ji(t,e));break}}t=t.return}}function Lne(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ki(),e.pingedLanes|=e.suspendedLanes&r,In===e&&(Jn&r)===r&&(kn===4||kn===3&&(Jn&130023424)===Jn&&500>on()-bO?ou(e,0):mO|=r),Ji(e,t)}function VM(e,t){t===0&&(e.mode&1?(t=o_,o_<<=1,!(o_&130023424)&&(o_=4194304)):t=1);var r=ki();e=Io(e,t),e!==null&&(fy(e,t,r),Ji(e,r))}function Fne(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),VM(e,r)}function Dne(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ve(314))}n!==null&&n.delete(t),VM(e,r)}var HM;HM=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Hi.current)Vi=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Vi=!1,Sne(e,t,r);Vi=!!(e.flags&131072)}else Vi=!1,$r&&t.flags&1048576&&GB(t,V_,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;T_(e,t),e=t.pendingProps;var i=vd(t,si.current);yd(t,r),i=fO(null,t,n,e,i,r);var s=dO();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Wi(n)?(s=!0,z_(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,aO(t),i.updater=l0,t.stateNode=i,i._reactInternals=t,SE(t,n,e,r),t=EE(null,t,n,!0,s,r)):(t.tag=0,$r&&s&&QE(t),xi(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(T_(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Bne(n),e=na(n,e),i){case 0:t=kE(null,t,n,e,r);break e;case 1:t=Mj(null,t,n,e,r);break e;case 11:t=jj(null,t,n,e,r);break e;case 14:t=Bj(null,t,n,na(n.type,e),r);break e}throw Error(Ve(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:na(n,i),kE(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:na(n,i),Mj(e,t,n,i,r);case 3:e:{if(TM(t),e===null)throw Error(Ve(387));n=t.pendingProps,s=t.memoizedState,i=s.element,ZB(e,t),J_(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=xd(Error(Ve(423)),t),t=Rj(e,t,n,r,i);break e}else if(n!==i){i=xd(Error(Ve(424)),t),t=Rj(e,t,n,r,i);break e}else for(cs=Ll(t.stateNode.containerInfo.firstChild),us=t,$r=!0,sa=null,r=rM(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(_d(),n===i){t=No(e,t,r);break e}xi(e,t,n,r)}t=t.child}return t;case 5:return nM(t),e===null&&vE(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,hE(n,i)?a=null:s!==null&&hE(n,s)&&(t.flags|=32),AM(e,t),xi(e,t,a,r),t.child;case 6:return e===null&&vE(t),null;case 13:return CM(e,t,r);case 4:return oO(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=wd(t,null,n,r):xi(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:na(n,i),jj(e,t,n,i,r);case 7:return xi(e,t,t.pendingProps,r),t.child;case 8:return xi(e,t,t.pendingProps.children,r),t.child;case 12:return xi(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,Or(H_,n._currentValue),n._currentValue=a,s!==null)if(la(s.value,a)){if(s.children===i.children&&!Hi.current){t=No(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Ao(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),_E(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Ve(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),_E(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}xi(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,yd(t,r),i=Ls(i),n=n(i),t.flags|=1,xi(e,t,n,r),t.child;case 14:return n=t.type,i=na(n,t.pendingProps),i=na(n.type,i),Bj(e,t,n,i,r);case 15:return EM(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:na(n,i),T_(e,t),t.tag=1,Wi(n)?(e=!0,z_(t)):e=!1,yd(t,r),eM(t,n,i),SE(t,n,i,r),EE(null,t,n,!0,e,r);case 19:return IM(e,t,r);case 22:return OM(e,t,r)}throw Error(Ve(156,t.tag))};function WM(e,t){return bB(e,t)}function jne(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ns(e,t,r,n){return new jne(e,t,r,n)}function SO(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Bne(e){if(typeof e=="function")return SO(e)?1:0;if(e!=null){if(e=e.$$typeof,e===UE)return 11;if(e===zE)return 14}return 2}function Bl(e,t){var r=e.alternate;return r===null?(r=Ns(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function N_(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")SO(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case td:return lu(r.children,i,s,t);case $E:a=8,i|=8;break;case Wk:return e=Ns(12,r,t,i|2),e.elementType=Wk,e.lanes=s,e;case Jk:return e=Ns(13,r,t,i),e.elementType=Jk,e.lanes=s,e;case Gk:return e=Ns(19,r,t,i),e.elementType=Gk,e.lanes=s,e;case tB:return d0(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Qj:a=10;break e;case eB:a=9;break e;case UE:a=11;break e;case zE:a=14;break e;case kl:a=16,n=null;break e}throw Error(Ve(130,e==null?e:typeof e,""))}return t=Ns(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function lu(e,t,r,n){return e=Ns(7,e,n,t),e.lanes=r,e}function d0(e,t,r,n){return e=Ns(22,e,n,t),e.elementType=tB,e.lanes=r,e.stateNode={isHidden:!1},e}function qk(e,t,r){return e=Ns(6,e,null,t),e.lanes=r,e}function Vk(e,t,r){return t=Ns(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Mne(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ak(0),this.expirationTimes=Ak(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ak(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function xO(e,t,r,n,i,s,a,o,l){return e=new Mne(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Ns(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},aO(s),e}function Rne(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ed,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function JM(e){if(!e)return Rl;e=e._reactInternals;e:{if(gu(e)!==e||e.tag!==1)throw Error(Ve(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Wi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ve(171))}if(e.tag===1){var r=e.type;if(Wi(r))return WB(e,r,t)}return t}function GM(e,t,r,n,i,s,a,o,l){return e=xO(r,n,!0,e,i,s,a,o,l),e.context=JM(null),r=e.current,n=ki(),i=jl(r),s=Ao(n,i),s.callback=t??null,Fl(r,s,i),e.current.lanes=i,fy(e,i,n),Ji(e,n),e}function p0(e,t,r,n){var i=t.current,s=ki(),a=jl(i);return r=JM(r),t.context===null?t.context=r:t.pendingContext=r,t=Ao(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Fl(i,t,a),e!==null&&(oa(e,i,a,s),E_(e,i,a)),a}function t0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Kj(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function kO(e,t){Kj(e,t),(e=e.alternate)&&Kj(e,t)}function $ne(){return null}var KM=typeof reportError=="function"?reportError:function(e){console.error(e)};function EO(e){this._internalRoot=e}h0.prototype.render=EO.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ve(409));p0(e,t,null,null)};h0.prototype.unmount=EO.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;pu(function(){p0(null,e,null,null)}),t[Co]=null}};function h0(e){this._internalRoot=e}h0.prototype.unstable_scheduleHydration=function(e){if(e){var t=EB();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ol.length&&t!==0&&t<Ol[r].priority;r++);Ol.splice(r,0,e),r===0&&AB(e)}};function OO(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function g0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Yj(){}function Une(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=t0(a);s.call(c)}}var a=GM(t,n,e,0,null,!1,!1,"",Yj);return e._reactRootContainer=a,e[Co]=a.current,ry(e.nodeType===8?e.parentNode:e),pu(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=t0(l);o.call(c)}}var l=xO(e,0,!1,null,null,!1,!1,"",Yj);return e._reactRootContainer=l,e[Co]=l.current,ry(e.nodeType===8?e.parentNode:e),pu(function(){p0(t,l,r,n)}),l}function y0(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=t0(a);o.call(l)}}p0(t,a,e,i)}else a=Une(r,t,e,i,n);return t0(a)}xB=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Bg(t.pendingLanes);r!==0&&(HE(t,r|1),Ji(t,on()),!(Yt&6)&&(kd=on()+500,zl()))}break;case 13:pu(function(){var n=Io(e,1);if(n!==null){var i=ki();oa(n,e,1,i)}}),kO(e,1)}};WE=function(e){if(e.tag===13){var t=Io(e,134217728);if(t!==null){var r=ki();oa(t,e,134217728,r)}kO(e,134217728)}};kB=function(e){if(e.tag===13){var t=jl(e),r=Io(e,t);if(r!==null){var n=ki();oa(r,e,t,n)}kO(e,t)}};EB=function(){return pr};OB=function(e,t){var r=pr;try{return pr=e,t()}finally{pr=r}};iE=function(e,t,r){switch(t){case"input":if(Xk(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=a0(n);if(!i)throw Error(Ve(90));nB(n),Xk(n,i)}}}break;case"textarea":sB(e,r);break;case"select":t=r.value,t!=null&&dd(e,!!r.multiple,t,!1)}};dB=vO;pB=pu;var zne={usingClientEntryPoint:!1,Events:[py,sd,a0,uB,fB,vO]},Lg={findFiberByHostInstance:iu,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},qne={bundleType:Lg.bundleType,version:Lg.version,rendererPackageName:Lg.rendererPackageName,rendererConfig:Lg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Po.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=yB(e),e===null?null:e.stateNode},findFiberByHostInstance:Lg.findFiberByHostInstance||$ne,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(Fg=__REACT_DEVTOOLS_GLOBAL_HOOK__,!Fg.isDisabled&&Fg.supportsFiber))try{r0=Fg.inject(qne),za=Fg}catch{}var Fg;hs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zne;hs.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!OO(t))throw Error(Ve(200));return Rne(e,t,null,r)};hs.createRoot=function(e,t){if(!OO(e))throw Error(Ve(299));var r=!1,n="",i=KM;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=xO(e,1,!1,null,null,r,!1,n,i),e[Co]=t.current,ry(e.nodeType===8?e.parentNode:e),new EO(t)};hs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ve(188)):(e=Object.keys(e).join(","),Error(Ve(268,e)));return e=yB(t),e=e===null?null:e.stateNode,e};hs.flushSync=function(e){return pu(e)};hs.hydrate=function(e,t,r){if(!g0(t))throw Error(Ve(200));return y0(null,e,t,!0,r)};hs.hydrateRoot=function(e,t,r){if(!OO(e))throw Error(Ve(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=KM;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=GM(t,null,e,1,r??null,i,!1,s,a),e[Co]=t.current,ry(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new h0(t)};hs.render=function(e,t,r){if(!g0(t))throw Error(Ve(200));return y0(null,e,t,!1,r)};hs.unmountComponentAtNode=function(e){if(!g0(e))throw Error(Ve(40));return e._reactRootContainer?(pu(function(){y0(null,null,e,!1,function(){e._reactRootContainer=null,e[Co]=null})}),!0):!1};hs.unstable_batchedUpdates=vO;hs.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!g0(r))throw Error(Ve(200));if(e==null||e._reactInternals===void 0)throw Error(Ve(38));return y0(e,t,r,!1,n)};hs.version="18.2.0-next-9e3b772b8-20220608"});var Va=ce((SLe,ZM)=>{"use strict";function XM(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(XM)}catch(e){console.error(e)}}XM(),ZM.exports=YM()});var eR=ce(AO=>{"use strict";var QM=Va();AO.createRoot=QM.createRoot,AO.hydrateRoot=QM.hydrateRoot;var xLe});var y4=ce(R0=>{"use strict";var eae=Je(),tae=Symbol.for("react.element"),rae=Symbol.for("react.fragment"),nae=Object.prototype.hasOwnProperty,iae=eae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,sae={key:!0,ref:!0,__self:!0,__source:!0};function g4(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)nae.call(t,n)&&!sae.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:tae,type:e,key:s,ref:a,props:i,_owner:iae.current}}R0.Fragment=rae;R0.jsx=g4;R0.jsxs=g4});var vt=ce((oDe,m4)=>{"use strict";m4.exports=y4()});var Kr=ce((nje,J0)=>{(function(){"use strict";var e={}.hasOwnProperty,t="[native code]";function r(){for(var n=[],i=0;i<arguments.length;i++){var s=arguments[i];if(s){var a=typeof s;if(a==="string"||a==="number")n.push(s);else if(Array.isArray(s)){if(s.length){var o=r.apply(null,s);o&&n.push(o)}}else if(a==="object"){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){n.push(s.toString());continue}for(var l in s)e.call(s,l)&&s[l]&&n.push(l)}}}return n.join(" ")}typeof J0<"u"&&J0.exports?(r.default=r,J0.exports=r):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return r}):window.classNames=r})()});var Ms=ce((ije,I4)=>{function zae(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}I4.exports=zae});var kA=ce((sje,N4)=>{var qae=typeof global=="object"&&global&&global.Object===Object&&global;N4.exports=qae});var pa=ce((aje,P4)=>{var Vae=kA(),Hae=typeof self=="object"&&self&&self.Object===Object&&self,Wae=Vae||Hae||Function("return this")();P4.exports=Wae});var Ud=ce((oje,L4)=>{var Jae=pa(),Gae=Jae.Symbol;L4.exports=Gae});var B4=ce((lje,j4)=>{var F4=Ud(),D4=Object.prototype,Kae=D4.hasOwnProperty,Yae=D4.toString,Ny=F4?F4.toStringTag:void 0;function Xae(e){var t=Kae.call(e,Ny),r=e[Ny];try{e[Ny]=void 0;var n=!0}catch{}var i=Yae.call(e);return n&&(t?e[Ny]=r:delete e[Ny]),i}j4.exports=Xae});var R4=ce((cje,M4)=>{var Zae=Object.prototype,Qae=Zae.toString;function eoe(e){return Qae.call(e)}M4.exports=eoe});var Uo=ce((uje,z4)=>{var $4=Ud(),toe=B4(),roe=R4(),noe="[object Null]",ioe="[object Undefined]",U4=$4?$4.toStringTag:void 0;function soe(e){return e==null?e===void 0?ioe:noe:U4&&U4 in Object(e)?toe(e):roe(e)}z4.exports=soe});var mn=ce((fje,q4)=>{var aoe=Uo(),ooe=Ms(),loe="[object AsyncFunction]",coe="[object Function]",uoe="[object GeneratorFunction]",foe="[object Proxy]";function doe(e){if(!ooe(e))return!1;var t=aoe(e);return t==coe||t==uoe||t==loe||t==foe}q4.exports=doe});var Yr=ce((dje,V4)=>{var poe=Array.isArray;V4.exports=poe});var zo=ce((pje,H4)=>{function hoe(e){return e!=null&&typeof e=="object"}H4.exports=hoe});var G0=ce((hje,W4)=>{var goe=Uo(),yoe=Yr(),moe=zo(),boe="[object String]";function voe(e){return typeof e=="string"||!yoe(e)&&moe(e)&&goe(e)==boe}W4.exports=voe});var ku=ce((gje,J4)=>{var _oe=Uo(),woe=zo(),Soe="[object Symbol]";function xoe(e){return typeof e=="symbol"||woe(e)&&_oe(e)==Soe}J4.exports=xoe});var K0=ce((yje,G4)=>{var koe=Yr(),Eoe=ku(),Ooe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Aoe=/^\w*$/;function Toe(e,t){if(koe(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Eoe(e)?!0:Aoe.test(e)||!Ooe.test(e)||t!=null&&e in Object(t)}G4.exports=Toe});var Y4=ce((mje,K4)=>{var Coe=pa(),Ioe=Coe["__core-js_shared__"];K4.exports=Ioe});var Q4=ce((bje,Z4)=>{var EA=Y4(),X4=function(){var e=/[^.]+$/.exec(EA&&EA.keys&&EA.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Noe(e){return!!X4&&X4 in e}Z4.exports=Noe});var OA=ce((vje,e5)=>{var Poe=Function.prototype,Loe=Poe.toString;function Foe(e){if(e!=null){try{return Loe.call(e)}catch{}try{return e+""}catch{}}return""}e5.exports=Foe});var r5=ce((_je,t5)=>{var Doe=mn(),joe=Q4(),Boe=Ms(),Moe=OA(),Roe=/[\\^$.*+?()[\]{}|]/g,$oe=/^\[object .+?Constructor\]$/,Uoe=Function.prototype,zoe=Object.prototype,qoe=Uoe.toString,Voe=zoe.hasOwnProperty,Hoe=RegExp("^"+qoe.call(Voe).replace(Roe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Woe(e){if(!Boe(e)||joe(e))return!1;var t=Doe(e)?Hoe:$oe;return t.test(Moe(e))}t5.exports=Woe});var i5=ce((wje,n5)=>{function Joe(e,t){return e?.[t]}n5.exports=Joe});var Gl=ce((Sje,s5)=>{var Goe=r5(),Koe=i5();function Yoe(e,t){var r=Koe(e,t);return Goe(r)?r:void 0}s5.exports=Yoe});var Py=ce((xje,a5)=>{var Xoe=Gl(),Zoe=Xoe(Object,"create");a5.exports=Zoe});var c5=ce((kje,l5)=>{var o5=Py();function Qoe(){this.__data__=o5?o5(null):{},this.size=0}l5.exports=Qoe});var f5=ce((Eje,u5)=>{function ele(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}u5.exports=ele});var p5=ce((Oje,d5)=>{var tle=Py(),rle="__lodash_hash_undefined__",nle=Object.prototype,ile=nle.hasOwnProperty;function sle(e){var t=this.__data__;if(tle){var r=t[e];return r===rle?void 0:r}return ile.call(t,e)?t[e]:void 0}d5.exports=sle});var g5=ce((Aje,h5)=>{var ale=Py(),ole=Object.prototype,lle=ole.hasOwnProperty;function cle(e){var t=this.__data__;return ale?t[e]!==void 0:lle.call(t,e)}h5.exports=cle});var m5=ce((Tje,y5)=>{var ule=Py(),fle="__lodash_hash_undefined__";function dle(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ule&&t===void 0?fle:t,this}y5.exports=dle});var v5=ce((Cje,b5)=>{var ple=c5(),hle=f5(),gle=p5(),yle=g5(),mle=m5();function zd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}zd.prototype.clear=ple;zd.prototype.delete=hle;zd.prototype.get=gle;zd.prototype.has=yle;zd.prototype.set=mle;b5.exports=zd});var w5=ce((Ije,_5)=>{function ble(){this.__data__=[],this.size=0}_5.exports=ble});var Y0=ce((Nje,S5)=>{function vle(e,t){return e===t||e!==e&&t!==t}S5.exports=vle});var Ly=ce((Pje,x5)=>{var _le=Y0();function wle(e,t){for(var r=e.length;r--;)if(_le(e[r][0],t))return r;return-1}x5.exports=wle});var E5=ce((Lje,k5)=>{var Sle=Ly(),xle=Array.prototype,kle=xle.splice;function Ele(e){var t=this.__data__,r=Sle(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():kle.call(t,r,1),--this.size,!0}k5.exports=Ele});var A5=ce((Fje,O5)=>{var Ole=Ly();function Ale(e){var t=this.__data__,r=Ole(t,e);return r<0?void 0:t[r][1]}O5.exports=Ale});var C5=ce((Dje,T5)=>{var Tle=Ly();function Cle(e){return Tle(this.__data__,e)>-1}T5.exports=Cle});var N5=ce((jje,I5)=>{var Ile=Ly();function Nle(e,t){var r=this.__data__,n=Ile(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}I5.exports=Nle});var Fy=ce((Bje,P5)=>{var Ple=w5(),Lle=E5(),Fle=A5(),Dle=C5(),jle=N5();function qd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}qd.prototype.clear=Ple;qd.prototype.delete=Lle;qd.prototype.get=Fle;qd.prototype.has=Dle;qd.prototype.set=jle;P5.exports=qd});var X0=ce((Mje,L5)=>{var Ble=Gl(),Mle=pa(),Rle=Ble(Mle,"Map");L5.exports=Rle});var j5=ce((Rje,D5)=>{var F5=v5(),$le=Fy(),Ule=X0();function zle(){this.size=0,this.__data__={hash:new F5,map:new(Ule||$le),string:new F5}}D5.exports=zle});var M5=ce(($je,B5)=>{function qle(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}B5.exports=qle});var Dy=ce((Uje,R5)=>{var Vle=M5();function Hle(e,t){var r=e.__data__;return Vle(t)?r[typeof t=="string"?"string":"hash"]:r.map}R5.exports=Hle});var U5=ce((zje,$5)=>{var Wle=Dy();function Jle(e){var t=Wle(this,e).delete(e);return this.size-=t?1:0,t}$5.exports=Jle});var q5=ce((qje,z5)=>{var Gle=Dy();function Kle(e){return Gle(this,e).get(e)}z5.exports=Kle});var H5=ce((Vje,V5)=>{var Yle=Dy();function Xle(e){return Yle(this,e).has(e)}V5.exports=Xle});var J5=ce((Hje,W5)=>{var Zle=Dy();function Qle(e,t){var r=Zle(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}W5.exports=Qle});var Z0=ce((Wje,G5)=>{var ece=j5(),tce=U5(),rce=q5(),nce=H5(),ice=J5();function Vd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Vd.prototype.clear=ece;Vd.prototype.delete=tce;Vd.prototype.get=rce;Vd.prototype.has=nce;Vd.prototype.set=ice;G5.exports=Vd});var X5=ce((Jje,Y5)=>{var K5=Z0(),sce="Expected a function";function AA(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(sce);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var a=e.apply(this,n);return r.cache=s.set(i,a)||s,a};return r.cache=new(AA.Cache||K5),r}AA.Cache=K5;Y5.exports=AA});var Q5=ce((Gje,Z5)=>{var ace=X5(),oce=500;function lce(e){var t=ace(e,function(n){return r.size===oce&&r.clear(),n}),r=t.cache;return t}Z5.exports=lce});var t6=ce((Kje,e6)=>{var cce=Q5(),uce=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,fce=/\\(\\)?/g,dce=cce(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(uce,function(r,n,i,s){t.push(i?s.replace(fce,"$1"):n||r)}),t});e6.exports=dce});var Q0=ce((Yje,r6)=>{function pce(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}r6.exports=pce});var l6=ce((Xje,o6)=>{var n6=Ud(),hce=Q0(),gce=Yr(),yce=ku(),mce=1/0,i6=n6?n6.prototype:void 0,s6=i6?i6.toString:void 0;function a6(e){if(typeof e=="string")return e;if(gce(e))return hce(e,a6)+"";if(yce(e))return s6?s6.call(e):"";var t=e+"";return t=="0"&&1/e==-mce?"-0":t}o6.exports=a6});var TA=ce((Zje,c6)=>{var bce=l6();function vce(e){return e==null?"":bce(e)}c6.exports=vce});var CA=ce((Qje,u6)=>{var _ce=Yr(),wce=K0(),Sce=t6(),xce=TA();function kce(e,t){return _ce(e)?e:wce(e,t)?[e]:Sce(xce(e))}u6.exports=kce});var jy=ce((eBe,f6)=>{var Ece=ku(),Oce=1/0;function Ace(e){if(typeof e=="string"||Ece(e))return e;var t=e+"";return t=="0"&&1/e==-Oce?"-0":t}f6.exports=Ace});var e2=ce((tBe,d6)=>{var Tce=CA(),Cce=jy();function Ice(e,t){t=Tce(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[Cce(t[r++])];return r&&r==n?e:void 0}d6.exports=Ice});var Eu=ce((rBe,p6)=>{var Nce=e2();function Pce(e,t,r){var n=e==null?void 0:Nce(e,t);return n===void 0?r:n}p6.exports=Pce});var Rs=ce((nBe,h6)=>{function Lce(e){return e==null}h6.exports=Lce});var y6=ce(gr=>{"use strict";var Ln=typeof Symbol=="function"&&Symbol.for,IA=Ln?Symbol.for("react.element"):60103,NA=Ln?Symbol.for("react.portal"):60106,t2=Ln?Symbol.for("react.fragment"):60107,r2=Ln?Symbol.for("react.strict_mode"):60108,n2=Ln?Symbol.for("react.profiler"):60114,i2=Ln?Symbol.for("react.provider"):60109,s2=Ln?Symbol.for("react.context"):60110,PA=Ln?Symbol.for("react.async_mode"):60111,a2=Ln?Symbol.for("react.concurrent_mode"):60111,o2=Ln?Symbol.for("react.forward_ref"):60112,l2=Ln?Symbol.for("react.suspense"):60113,Fce=Ln?Symbol.for("react.suspense_list"):60120,c2=Ln?Symbol.for("react.memo"):60115,u2=Ln?Symbol.for("react.lazy"):60116,Dce=Ln?Symbol.for("react.block"):60121,jce=Ln?Symbol.for("react.fundamental"):60117,Bce=Ln?Symbol.for("react.responder"):60118,Mce=Ln?Symbol.for("react.scope"):60119;function gs(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case IA:switch(e=e.type,e){case PA:case a2:case t2:case n2:case r2:case l2:return e;default:switch(e=e&&e.$$typeof,e){case s2:case o2:case u2:case c2:case i2:return e;default:return t}}case NA:return t}}}function g6(e){return gs(e)===a2}gr.AsyncMode=PA;gr.ConcurrentMode=a2;gr.ContextConsumer=s2;gr.ContextProvider=i2;gr.Element=IA;gr.ForwardRef=o2;gr.Fragment=t2;gr.Lazy=u2;gr.Memo=c2;gr.Portal=NA;gr.Profiler=n2;gr.StrictMode=r2;gr.Suspense=l2;gr.isAsyncMode=function(e){return g6(e)||gs(e)===PA};gr.isConcurrentMode=g6;gr.isContextConsumer=function(e){return gs(e)===s2};gr.isContextProvider=function(e){return gs(e)===i2};gr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===IA};gr.isForwardRef=function(e){return gs(e)===o2};gr.isFragment=function(e){return gs(e)===t2};gr.isLazy=function(e){return gs(e)===u2};gr.isMemo=function(e){return gs(e)===c2};gr.isPortal=function(e){return gs(e)===NA};gr.isProfiler=function(e){return gs(e)===n2};gr.isStrictMode=function(e){return gs(e)===r2};gr.isSuspense=function(e){return gs(e)===l2};gr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===t2||e===a2||e===n2||e===r2||e===l2||e===Fce||typeof e=="object"&&e!==null&&(e.$$typeof===u2||e.$$typeof===c2||e.$$typeof===i2||e.$$typeof===s2||e.$$typeof===o2||e.$$typeof===jce||e.$$typeof===Bce||e.$$typeof===Mce||e.$$typeof===Dce)};gr.typeOf=gs});var b6=ce((sBe,m6)=>{"use strict";m6.exports=y6()});var LA=ce((aBe,v6)=>{var Rce=Uo(),$ce=zo(),Uce="[object Number]";function zce(e){return typeof e=="number"||$ce(e)&&Rce(e)==Uce}v6.exports=zce});var FA=ce((oBe,_6)=>{var qce=LA();function Vce(e){return qce(e)&&e!=+e}_6.exports=Vce});var U6=ce((vBe,$6)=>{var aue=Fy();function oue(){this.__data__=new aue,this.size=0}$6.exports=oue});var q6=ce((_Be,z6)=>{function lue(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}z6.exports=lue});var H6=ce((wBe,V6)=>{function cue(e){return this.__data__.get(e)}V6.exports=cue});var J6=ce((SBe,W6)=>{function uue(e){return this.__data__.has(e)}W6.exports=uue});var K6=ce((xBe,G6)=>{var fue=Fy(),due=X0(),pue=Z0(),hue=200;function gue(e,t){var r=this.__data__;if(r instanceof fue){var n=r.__data__;if(!due||n.length<hue-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new pue(n)}return r.set(e,t),this.size=r.size,this}G6.exports=gue});var JA=ce((kBe,Y6)=>{var yue=Fy(),mue=U6(),bue=q6(),vue=H6(),_ue=J6(),wue=K6();function Gd(e){var t=this.__data__=new yue(e);this.size=t.size}Gd.prototype.clear=mue;Gd.prototype.delete=bue;Gd.prototype.get=vue;Gd.prototype.has=_ue;Gd.prototype.set=wue;Y6.exports=Gd});var Z6=ce((EBe,X6)=>{var Sue="__lodash_hash_undefined__";function xue(e){return this.__data__.set(e,Sue),this}X6.exports=xue});var e8=ce((OBe,Q6)=>{function kue(e){return this.__data__.has(e)}Q6.exports=kue});var GA=ce((ABe,t8)=>{var Eue=Z0(),Oue=Z6(),Aue=e8();function g2(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Eue;++t<r;)this.add(e[t])}g2.prototype.add=g2.prototype.push=Oue;g2.prototype.has=Aue;t8.exports=g2});var KA=ce((TBe,r8)=>{function Tue(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}r8.exports=Tue});var YA=ce((CBe,n8)=>{function Cue(e,t){return e.has(t)}n8.exports=Cue});var XA=ce((IBe,i8)=>{var Iue=GA(),Nue=KA(),Pue=YA(),Lue=1,Fue=2;function Due(e,t,r,n,i,s){var a=r&Lue,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(e),f=s.get(t);if(c&&f)return c==t&&f==e;var u=-1,d=!0,p=r&Fue?new Iue:void 0;for(s.set(e,t),s.set(t,e);++u<o;){var _=e[u],w=t[u];if(n)var k=a?n(w,_,u,t,e,s):n(_,w,u,e,t,s);if(k!==void 0){if(k)continue;d=!1;break}if(p){if(!Nue(t,function(S,O){if(!Pue(p,O)&&(_===S||i(_,S,r,n,s)))return p.push(O)})){d=!1;break}}else if(!(_===w||i(_,w,r,n,s))){d=!1;break}}return s.delete(e),s.delete(t),d}i8.exports=Due});var a8=ce((NBe,s8)=>{var jue=pa(),Bue=jue.Uint8Array;s8.exports=Bue});var l8=ce((PBe,o8)=>{function Mue(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}o8.exports=Mue});var y2=ce((LBe,c8)=>{function Rue(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}c8.exports=Rue});var h8=ce((FBe,p8)=>{var u8=Ud(),f8=a8(),$ue=Y0(),Uue=XA(),zue=l8(),que=y2(),Vue=1,Hue=2,Wue="[object Boolean]",Jue="[object Date]",Gue="[object Error]",Kue="[object Map]",Yue="[object Number]",Xue="[object RegExp]",Zue="[object Set]",Que="[object String]",efe="[object Symbol]",tfe="[object ArrayBuffer]",rfe="[object DataView]",d8=u8?u8.prototype:void 0,ZA=d8?d8.valueOf:void 0;function nfe(e,t,r,n,i,s,a){switch(r){case rfe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case tfe:return!(e.byteLength!=t.byteLength||!s(new f8(e),new f8(t)));case Wue:case Jue:case Yue:return $ue(+e,+t);case Gue:return e.name==t.name&&e.message==t.message;case Xue:case Que:return e==t+"";case Kue:var o=zue;case Zue:var l=n&Vue;if(o||(o=que),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=Hue,a.set(e,t);var f=Uue(o(e),o(t),n,i,s,a);return a.delete(e),f;case efe:if(ZA)return ZA.call(e)==ZA.call(t)}return!1}p8.exports=nfe});var QA=ce((DBe,g8)=>{function ife(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}g8.exports=ife});var m8=ce((jBe,y8)=>{var sfe=QA(),afe=Yr();function ofe(e,t,r){var n=t(e);return afe(e)?n:sfe(n,r(e))}y8.exports=ofe});var v8=ce((BBe,b8)=>{function lfe(e,t){for(var r=-1,n=e==null?0:e.length,i=0,s=[];++r<n;){var a=e[r];t(a,r,e)&&(s[i++]=a)}return s}b8.exports=lfe});var w8=ce((MBe,_8)=>{function cfe(){return[]}_8.exports=cfe});var k8=ce((RBe,x8)=>{var ufe=v8(),ffe=w8(),dfe=Object.prototype,pfe=dfe.propertyIsEnumerable,S8=Object.getOwnPropertySymbols,hfe=S8?function(e){return e==null?[]:(e=Object(e),ufe(S8(e),function(t){return pfe.call(e,t)}))}:ffe;x8.exports=hfe});var O8=ce(($Be,E8)=>{function gfe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}E8.exports=gfe});var T8=ce((UBe,A8)=>{var yfe=Uo(),mfe=zo(),bfe="[object Arguments]";function vfe(e){return mfe(e)&&yfe(e)==bfe}A8.exports=vfe});var m2=ce((zBe,N8)=>{var C8=T8(),_fe=zo(),I8=Object.prototype,wfe=I8.hasOwnProperty,Sfe=I8.propertyIsEnumerable,xfe=C8(function(){return arguments}())?C8:function(e){return _fe(e)&&wfe.call(e,"callee")&&!Sfe.call(e,"callee")};N8.exports=xfe});var L8=ce((qBe,P8)=>{function kfe(){return!1}P8.exports=kfe});var eT=ce((My,Kd)=>{var Efe=pa(),Ofe=L8(),j8=typeof My=="object"&&My&&!My.nodeType&&My,F8=j8&&typeof Kd=="object"&&Kd&&!Kd.nodeType&&Kd,Afe=F8&&F8.exports===j8,D8=Afe?Efe.Buffer:void 0,Tfe=D8?D8.isBuffer:void 0,Cfe=Tfe||Ofe;Kd.exports=Cfe});var b2=ce((VBe,B8)=>{var Ife=9007199254740991,Nfe=/^(?:0|[1-9]\d*)$/;function Pfe(e,t){var r=typeof e;return t=t??Ife,!!t&&(r=="number"||r!="symbol"&&Nfe.test(e))&&e>-1&&e%1==0&&e<t}B8.exports=Pfe});var v2=ce((HBe,M8)=>{var Lfe=9007199254740991;function Ffe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Lfe}M8.exports=Ffe});var $8=ce((WBe,R8)=>{var Dfe=Uo(),jfe=v2(),Bfe=zo(),Mfe="[object Arguments]",Rfe="[object Array]",$fe="[object Boolean]",Ufe="[object Date]",zfe="[object Error]",qfe="[object Function]",Vfe="[object Map]",Hfe="[object Number]",Wfe="[object Object]",Jfe="[object RegExp]",Gfe="[object Set]",Kfe="[object String]",Yfe="[object WeakMap]",Xfe="[object ArrayBuffer]",Zfe="[object DataView]",Qfe="[object Float32Array]",ede="[object Float64Array]",tde="[object Int8Array]",rde="[object Int16Array]",nde="[object Int32Array]",ide="[object Uint8Array]",sde="[object Uint8ClampedArray]",ade="[object Uint16Array]",ode="[object Uint32Array]",jr={};jr[Qfe]=jr[ede]=jr[tde]=jr[rde]=jr[nde]=jr[ide]=jr[sde]=jr[ade]=jr[ode]=!0;jr[Mfe]=jr[Rfe]=jr[Xfe]=jr[$fe]=jr[Zfe]=jr[Ufe]=jr[zfe]=jr[qfe]=jr[Vfe]=jr[Hfe]=jr[Wfe]=jr[Jfe]=jr[Gfe]=jr[Kfe]=jr[Yfe]=!1;function lde(e){return Bfe(e)&&jfe(e.length)&&!!jr[Dfe(e)]}R8.exports=lde});var tT=ce((JBe,U8)=>{function cde(e){return function(t){return e(t)}}U8.exports=cde});var q8=ce((Ry,Yd)=>{var ude=kA(),z8=typeof Ry=="object"&&Ry&&!Ry.nodeType&&Ry,$y=z8&&typeof Yd=="object"&&Yd&&!Yd.nodeType&&Yd,fde=$y&&$y.exports===z8,rT=fde&&ude.process,dde=function(){try{var e=$y&&$y.require&&$y.require("util").types;return e||rT&&rT.binding&&rT.binding("util")}catch{}}();Yd.exports=dde});var nT=ce((GBe,W8)=>{var pde=$8(),hde=tT(),V8=q8(),H8=V8&&V8.isTypedArray,gde=H8?hde(H8):pde;W8.exports=gde});var G8=ce((KBe,J8)=>{var yde=O8(),mde=m2(),bde=Yr(),vde=eT(),_de=b2(),wde=nT(),Sde=Object.prototype,xde=Sde.hasOwnProperty;function kde(e,t){var r=bde(e),n=!r&&mde(e),i=!r&&!n&&vde(e),s=!r&&!n&&!i&&wde(e),a=r||n||i||s,o=a?yde(e.length,String):[],l=o.length;for(var c in e)(t||xde.call(e,c))&&!(a&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||_de(c,l)))&&o.push(c);return o}J8.exports=kde});var Y8=ce((YBe,K8)=>{var Ede=Object.prototype;function Ode(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Ede;return e===r}K8.exports=Ode});var Z8=ce((XBe,X8)=>{function Ade(e,t){return function(r){return e(t(r))}}X8.exports=Ade});var e$=ce((ZBe,Q8)=>{var Tde=Z8(),Cde=Tde(Object.keys,Object);Q8.exports=Cde});var r$=ce((QBe,t$)=>{var Ide=Y8(),Nde=e$(),Pde=Object.prototype,Lde=Pde.hasOwnProperty;function Fde(e){if(!Ide(e))return Nde(e);var t=[];for(var r in Object(e))Lde.call(e,r)&&r!="constructor"&&t.push(r);return t}t$.exports=Fde});var Xd=ce((eMe,n$)=>{var Dde=mn(),jde=v2();function Bde(e){return e!=null&&jde(e.length)&&!Dde(e)}n$.exports=Bde});var Uy=ce((tMe,i$)=>{var Mde=G8(),Rde=r$(),$de=Xd();function Ude(e){return $de(e)?Mde(e):Rde(e)}i$.exports=Ude});var a$=ce((rMe,s$)=>{var zde=m8(),qde=k8(),Vde=Uy();function Hde(e){return zde(e,Vde,qde)}s$.exports=Hde});var c$=ce((nMe,l$)=>{var o$=a$(),Wde=1,Jde=Object.prototype,Gde=Jde.hasOwnProperty;function Kde(e,t,r,n,i,s){var a=r&Wde,o=o$(e),l=o.length,c=o$(t),f=c.length;if(l!=f&&!a)return!1;for(var u=l;u--;){var d=o[u];if(!(a?d in t:Gde.call(t,d)))return!1}var p=s.get(e),_=s.get(t);if(p&&_)return p==t&&_==e;var w=!0;s.set(e,t),s.set(t,e);for(var k=a;++u<l;){d=o[u];var S=e[d],O=t[d];if(n)var A=a?n(O,S,d,t,e,s):n(S,O,d,e,t,s);if(!(A===void 0?S===O||i(S,O,r,n,s):A)){w=!1;break}k||(k=d=="constructor")}if(w&&!k){var C=e.constructor,I=t.constructor;C!=I&&"constructor"in e&&"constructor"in t&&!(typeof C=="function"&&C instanceof C&&typeof I=="function"&&I instanceof I)&&(w=!1)}return s.delete(e),s.delete(t),w}l$.exports=Kde});var f$=ce((iMe,u$)=>{var Yde=Gl(),Xde=pa(),Zde=Yde(Xde,"DataView");u$.exports=Zde});var p$=ce((sMe,d$)=>{var Qde=Gl(),epe=pa(),tpe=Qde(epe,"Promise");d$.exports=tpe});var iT=ce((aMe,h$)=>{var rpe=Gl(),npe=pa(),ipe=rpe(npe,"Set");h$.exports=ipe});var y$=ce((oMe,g$)=>{var spe=Gl(),ape=pa(),ope=spe(ape,"WeakMap");g$.exports=ope});var k$=ce((lMe,x$)=>{var sT=f$(),aT=X0(),oT=p$(),lT=iT(),cT=y$(),S$=Uo(),Zd=OA(),m$="[object Map]",lpe="[object Object]",b$="[object Promise]",v$="[object Set]",_$="[object WeakMap]",w$="[object DataView]",cpe=Zd(sT),upe=Zd(aT),fpe=Zd(oT),dpe=Zd(lT),ppe=Zd(cT),Cu=S$;(sT&&Cu(new sT(new ArrayBuffer(1)))!=w$||aT&&Cu(new aT)!=m$||oT&&Cu(oT.resolve())!=b$||lT&&Cu(new lT)!=v$||cT&&Cu(new cT)!=_$)&&(Cu=function(e){var t=S$(e),r=t==lpe?e.constructor:void 0,n=r?Zd(r):"";if(n)switch(n){case cpe:return w$;case upe:return m$;case fpe:return b$;case dpe:return v$;case ppe:return _$}return t});x$.exports=Cu});var P$=ce((cMe,N$)=>{var uT=JA(),hpe=XA(),gpe=h8(),ype=c$(),E$=k$(),O$=Yr(),A$=eT(),mpe=nT(),bpe=1,T$="[object Arguments]",C$="[object Array]",_2="[object Object]",vpe=Object.prototype,I$=vpe.hasOwnProperty;function _pe(e,t,r,n,i,s){var a=O$(e),o=O$(t),l=a?C$:E$(e),c=o?C$:E$(t);l=l==T$?_2:l,c=c==T$?_2:c;var f=l==_2,u=c==_2,d=l==c;if(d&&A$(e)){if(!A$(t))return!1;a=!0,f=!1}if(d&&!f)return s||(s=new uT),a||mpe(e)?hpe(e,t,r,n,i,s):gpe(e,t,l,r,n,i,s);if(!(r&bpe)){var p=f&&I$.call(e,"__wrapped__"),_=u&&I$.call(t,"__wrapped__");if(p||_){var w=p?e.value():e,k=_?t.value():t;return s||(s=new uT),i(w,k,r,n,s)}}return d?(s||(s=new uT),ype(e,t,r,n,i,s)):!1}N$.exports=_pe});var w2=ce((uMe,D$)=>{var wpe=P$(),L$=zo();function F$(e,t,r,n,i){return e===t?!0:e==null||t==null||!L$(e)&&!L$(t)?e!==e&&t!==t:wpe(e,t,r,n,F$,i)}D$.exports=F$});var B$=ce((fMe,j$)=>{var Spe=JA(),xpe=w2(),kpe=1,Epe=2;function Ope(e,t,r,n){var i=r.length,s=i,a=!n;if(e==null)return!s;for(e=Object(e);i--;){var o=r[i];if(a&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++i<s;){o=r[i];var l=o[0],c=e[l],f=o[1];if(a&&o[2]){if(c===void 0&&!(l in e))return!1}else{var u=new Spe;if(n)var d=n(c,f,l,e,t,u);if(!(d===void 0?xpe(f,c,kpe|Epe,n,u):d))return!1}}return!0}j$.exports=Ope});var fT=ce((dMe,M$)=>{var Ape=Ms();function Tpe(e){return e===e&&!Ape(e)}M$.exports=Tpe});var $$=ce((pMe,R$)=>{var Cpe=fT(),Ipe=Uy();function Npe(e){for(var t=Ipe(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,Cpe(i)]}return t}R$.exports=Npe});var dT=ce((hMe,U$)=>{function Ppe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}U$.exports=Ppe});var q$=ce((gMe,z$)=>{var Lpe=B$(),Fpe=$$(),Dpe=dT();function jpe(e){var t=Fpe(e);return t.length==1&&t[0][2]?Dpe(t[0][0],t[0][1]):function(r){return r===e||Lpe(r,e,t)}}z$.exports=jpe});var H$=ce((yMe,V$)=>{function Bpe(e,t){return e!=null&&t in Object(e)}V$.exports=Bpe});var J$=ce((mMe,W$)=>{var Mpe=CA(),Rpe=m2(),$pe=Yr(),Upe=b2(),zpe=v2(),qpe=jy();function Vpe(e,t,r){t=Mpe(t,e);for(var n=-1,i=t.length,s=!1;++n<i;){var a=qpe(t[n]);if(!(s=e!=null&&r(e,a)))break;e=e[a]}return s||++n!=i?s:(i=e==null?0:e.length,!!i&&zpe(i)&&Upe(a,i)&&($pe(e)||Rpe(e)))}W$.exports=Vpe});var K$=ce((bMe,G$)=>{var Hpe=H$(),Wpe=J$();function Jpe(e,t){return e!=null&&Wpe(e,t,Hpe)}G$.exports=Jpe});var X$=ce((vMe,Y$)=>{var Gpe=w2(),Kpe=Eu(),Ype=K$(),Xpe=K0(),Zpe=fT(),Qpe=dT(),ehe=jy(),the=1,rhe=2;function nhe(e,t){return Xpe(e)&&Zpe(t)?Qpe(ehe(e),t):function(r){var n=Kpe(r,e);return n===void 0&&n===t?Ype(r,e):Gpe(t,n,the|rhe)}}Y$.exports=nhe});var Iu=ce((_Me,Z$)=>{function ihe(e){return e}Z$.exports=ihe});var eU=ce((wMe,Q$)=>{function she(e){return function(t){return t?.[e]}}Q$.exports=she});var rU=ce((SMe,tU)=>{var ahe=e2();function ohe(e){return function(t){return ahe(t,e)}}tU.exports=ohe});var iU=ce((xMe,nU)=>{var lhe=eU(),che=rU(),uhe=K0(),fhe=jy();function dhe(e){return uhe(e)?lhe(fhe(e)):che(e)}nU.exports=dhe});var Wo=ce((kMe,sU)=>{var phe=q$(),hhe=X$(),ghe=Iu(),yhe=Yr(),mhe=iU();function bhe(e){return typeof e=="function"?e:e==null?ghe:typeof e=="object"?yhe(e)?hhe(e[0],e[1]):phe(e):mhe(e)}sU.exports=bhe});var pT=ce((EMe,aU)=>{function vhe(e,t,r,n){for(var i=e.length,s=r+(n?1:-1);n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}aU.exports=vhe});var lU=ce((OMe,oU)=>{function _he(e){return e!==e}oU.exports=_he});var uU=ce((AMe,cU)=>{function whe(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}cU.exports=whe});var dU=ce((TMe,fU)=>{var She=pT(),xhe=lU(),khe=uU();function Ehe(e,t,r){return t===t?khe(e,t,r):She(e,xhe,r)}fU.exports=Ehe});var hU=ce((CMe,pU)=>{var Ohe=dU();function Ahe(e,t){var r=e==null?0:e.length;return!!r&&Ohe(e,t,0)>-1}pU.exports=Ahe});var yU=ce((IMe,gU)=>{function The(e,t,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}gU.exports=The});var bU=ce((NMe,mU)=>{function Che(){}mU.exports=Che});var _U=ce((PMe,vU)=>{var hT=iT(),Ihe=bU(),Nhe=y2(),Phe=1/0,Lhe=hT&&1/Nhe(new hT([,-0]))[1]==Phe?function(e){return new hT(e)}:Ihe;vU.exports=Lhe});var SU=ce((LMe,wU)=>{var Fhe=GA(),Dhe=hU(),jhe=yU(),Bhe=YA(),Mhe=_U(),Rhe=y2(),$he=200;function Uhe(e,t,r){var n=-1,i=Dhe,s=e.length,a=!0,o=[],l=o;if(r)a=!1,i=jhe;else if(s>=$he){var c=t?null:Mhe(e);if(c)return Rhe(c);a=!1,i=Bhe,l=new Fhe}else l=t?[]:o;e:for(;++n<s;){var f=e[n],u=t?t(f):f;if(f=r||f!==0?f:0,a&&u===u){for(var d=l.length;d--;)if(l[d]===u)continue e;t&&l.push(u),o.push(f)}else i(l,u,r)||(l!==o&&l.push(u),o.push(f))}return o}wU.exports=Uhe});var gT=ce((FMe,xU)=>{var zhe=Wo(),qhe=SU();function Vhe(e,t){return e&&e.length?qhe(e,zhe(t,2)):[]}xU.exports=Vhe});var EU=ce((DMe,kU)=>{function Hhe(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),r=r>i?i:r,r<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(i);++n<i;)s[n]=e[n+t];return s}kU.exports=Hhe});var AU=ce((jMe,OU)=>{var Whe=EU();function Jhe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:Whe(e,t,r)}OU.exports=Jhe});var yT=ce((BMe,TU)=>{var Ghe="\\ud800-\\udfff",Khe="\\u0300-\\u036f",Yhe="\\ufe20-\\ufe2f",Xhe="\\u20d0-\\u20ff",Zhe=Khe+Yhe+Xhe,Qhe="\\ufe0e\\ufe0f",ege="\\u200d",tge=RegExp("["+ege+Ghe+Zhe+Qhe+"]");function rge(e){return tge.test(e)}TU.exports=rge});var IU=ce((MMe,CU)=>{function nge(e){return e.split("")}CU.exports=nge});var MU=ce((RMe,BU)=>{var NU="\\ud800-\\udfff",ige="\\u0300-\\u036f",sge="\\ufe20-\\ufe2f",age="\\u20d0-\\u20ff",oge=ige+sge+age,lge="\\ufe0e\\ufe0f",cge="["+NU+"]",mT="["+oge+"]",bT="\\ud83c[\\udffb-\\udfff]",uge="(?:"+mT+"|"+bT+")",PU="[^"+NU+"]",LU="(?:\\ud83c[\\udde6-\\uddff]){2}",FU="[\\ud800-\\udbff][\\udc00-\\udfff]",fge="\\u200d",DU=uge+"?",jU="["+lge+"]?",dge="(?:"+fge+"(?:"+[PU,LU,FU].join("|")+")"+jU+DU+")*",pge=jU+DU+dge,hge="(?:"+[PU+mT+"?",mT,LU,FU,cge].join("|")+")",gge=RegExp(bT+"(?="+bT+")|"+hge+pge,"g");function yge(e){return e.match(gge)||[]}BU.exports=yge});var $U=ce(($Me,RU)=>{var mge=IU(),bge=yT(),vge=MU();function _ge(e){return bge(e)?vge(e):mge(e)}RU.exports=_ge});var zU=ce((UMe,UU)=>{var wge=AU(),Sge=yT(),xge=$U(),kge=TA();function Ege(e){return function(t){t=kge(t);var r=Sge(t)?xge(t):void 0,n=r?r[0]:t.charAt(0),i=r?wge(r,1).join(""):t.slice(1);return n[e]()+i}}UU.exports=Ege});var S2=ce((zMe,qU)=>{var Oge=zU(),Age=Oge("toUpperCase");qU.exports=Age});var wz=ce((z4e,_z)=>{"use strict";var mye="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";_z.exports=mye});var Ez=ce((q4e,kz)=>{"use strict";var bye=wz();function Sz(){}function xz(){}xz.resetWarningCache=Sz;kz.exports=function(){function e(n,i,s,a,o,l){if(l!==bye){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:xz,resetWarningCache:Sz};return r.PropTypes=r,r}});var Jo=ce((W4e,Oz)=>{Oz.exports=Ez()();var V4e,H4e});var t9=ce((g5e,Yy)=>{function Fme(e){return e&&e.__esModule?e:{default:e}}Yy.exports=Fme,Yy.exports.__esModule=!0,Yy.exports.default=Yy.exports});var n9=ce((q2,r9)=>{"use strict";q2.__esModule=!0;q2.default=Dme;function Dme(e,t){return e.classList?!!t&&e.classList.contains(t):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")!==-1}r9.exports=q2.default});var s9=ce((V2,i9)=>{"use strict";var jme=t9();V2.__esModule=!0;V2.default=Mme;var Bme=jme(n9());function Mme(e,t){e.classList?e.classList.add(t):(0,Bme.default)(e,t)||(typeof e.className=="string"?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}i9.exports=V2.default});var l9=ce((y5e,o9)=>{"use strict";function a9(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}o9.exports=function(t,r){t.classList?t.classList.remove(r):typeof t.className=="string"?t.className=a9(t.className,r):t.setAttribute("class",a9(t.className&&t.className.baseVal||"",r))}});var pC=ce(dC=>{"use strict";Object.defineProperty(dC,"__esModule",{value:!0});function c9(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function u9(e){function t(r){var n=this.constructor.getDerivedStateFromProps(e,r);return n??null}this.setState(t.bind(this))}function f9(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}c9.__suppressDeprecationWarning=!0;u9.__suppressDeprecationWarning=!0;f9.__suppressDeprecationWarning=!0;function Rme(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var r=null,n=null,i=null;if(typeof t.componentWillMount=="function"?r="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(r="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?i="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(i="UNSAFE_componentWillUpdate"),r!==null||n!==null||i!==null){var s=e.displayName||e.name,a=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+s+" uses "+a+" but also contains the following legacy lifecycles:"+(r!==null?`
  `+r:"")+(n!==null?`
  `+n:"")+(i!==null?`
  `+i:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=c9,t.componentWillReceiveProps=u9),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=f9;var o=t.componentDidUpdate;t.componentDidUpdate=function(c,f,u){var d=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:u;o.call(this,c,f,d)}}return e}dC.polyfill=Rme});var hC=ce(yp=>{"use strict";yp.__esModule=!0;yp.classNamesShape=yp.timeoutsShape=void 0;var b5e=$me(Jo());function $me(e){return e&&e.__esModule?e:{default:e}}var Ume=null;yp.timeoutsShape=Ume;var zme=null;yp.classNamesShape=zme});var mC=ce(Gi=>{"use strict";Gi.__esModule=!0;Gi.default=Gi.EXITING=Gi.ENTERED=Gi.ENTERING=Gi.EXITED=Gi.UNMOUNTED=void 0;var qme=Wme(Jo()),gC=d9(Je()),Vme=d9(Va()),Hme=pC(),_5e=hC();function d9(e){return e&&e.__esModule?e:{default:e}}function Wme(e){if(e&&e.__esModule)return e;var t={};if(e!=null){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}}return t.default=e,t}function Jme(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Gme(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Xy="unmounted";Gi.UNMOUNTED=Xy;var Du="exited";Gi.EXITED=Du;var ju="entering";Gi.ENTERING=ju;var bp="entered";Gi.ENTERED=bp;var yC="exiting";Gi.EXITING=yC;var Za=function(e){Gme(t,e);function t(n,i){var s;s=e.call(this,n,i)||this;var a=i.transitionGroup,o=a&&!a.isMounting?n.enter:n.appear,l;return s.appearStatus=null,n.in?o?(l=Du,s.appearStatus=ju):l=bp:n.unmountOnExit||n.mountOnEnter?l=Xy:l=Du,s.state={status:l},s.nextCallback=null,s}var r=t.prototype;return r.getChildContext=function(){return{transitionGroup:null}},t.getDerivedStateFromProps=function(i,s){var a=i.in;return a&&s.status===Xy?{status:Du}:null},r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(i){var s=null;if(i!==this.props){var a=this.state.status;this.props.in?a!==ju&&a!==bp&&(s=ju):(a===ju||a===bp)&&(s=yC)}this.updateStatus(!1,s)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var i=this.props.timeout,s,a,o;return s=a=o=i,i!=null&&typeof i!="number"&&(s=i.exit,a=i.enter,o=i.appear!==void 0?i.appear:a),{exit:s,enter:a,appear:o}},r.updateStatus=function(i,s){if(i===void 0&&(i=!1),s!==null){this.cancelNextCallback();var a=Vme.default.findDOMNode(this);s===ju?this.performEnter(a,i):this.performExit(a)}else this.props.unmountOnExit&&this.state.status===Du&&this.setState({status:Xy})},r.performEnter=function(i,s){var a=this,o=this.props.enter,l=this.context.transitionGroup?this.context.transitionGroup.isMounting:s,c=this.getTimeouts(),f=l?c.appear:c.enter;if(!s&&!o){this.safeSetState({status:bp},function(){a.props.onEntered(i)});return}this.props.onEnter(i,l),this.safeSetState({status:ju},function(){a.props.onEntering(i,l),a.onTransitionEnd(i,f,function(){a.safeSetState({status:bp},function(){a.props.onEntered(i,l)})})})},r.performExit=function(i){var s=this,a=this.props.exit,o=this.getTimeouts();if(!a){this.safeSetState({status:Du},function(){s.props.onExited(i)});return}this.props.onExit(i),this.safeSetState({status:yC},function(){s.props.onExiting(i),s.onTransitionEnd(i,o.exit,function(){s.safeSetState({status:Du},function(){s.props.onExited(i)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(i,s){s=this.setNextCallback(s),this.setState(i,s)},r.setNextCallback=function(i){var s=this,a=!0;return this.nextCallback=function(o){a&&(a=!1,s.nextCallback=null,i(o))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},r.onTransitionEnd=function(i,s,a){this.setNextCallback(a);var o=s==null&&!this.props.addEndListener;if(!i||o){setTimeout(this.nextCallback,0);return}this.props.addEndListener&&this.props.addEndListener(i,this.nextCallback),s!=null&&setTimeout(this.nextCallback,s)},r.render=function(){var i=this.state.status;if(i===Xy)return null;var s=this.props,a=s.children,o=Jme(s,["children"]);if(delete o.in,delete o.mountOnEnter,delete o.unmountOnExit,delete o.appear,delete o.enter,delete o.exit,delete o.timeout,delete o.addEndListener,delete o.onEnter,delete o.onEntering,delete o.onEntered,delete o.onExit,delete o.onExiting,delete o.onExited,typeof a=="function")return a(i,o);var l=gC.default.Children.only(a);return gC.default.cloneElement(l,o)},t}(gC.default.Component);Za.contextTypes={transitionGroup:qme.object};Za.childContextTypes={transitionGroup:function(){}};Za.propTypes={};function mp(){}Za.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:mp,onEntering:mp,onEntered:mp,onExit:mp,onExiting:mp,onExited:mp};Za.UNMOUNTED=0;Za.EXITED=1;Za.ENTERING=2;Za.ENTERED=3;Za.EXITING=4;var Kme=(0,Hme.polyfill)(Za);Gi.default=Kme});var g9=ce((Qy,h9)=>{"use strict";Qy.__esModule=!0;Qy.default=void 0;var S5e=Qme(Jo()),Yme=W2(s9()),Xme=W2(l9()),p9=W2(Je()),Zme=W2(mC()),x5e=hC();function W2(e){return e&&e.__esModule?e:{default:e}}function Qme(e){if(e&&e.__esModule)return e;var t={};if(e!=null){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}}return t.default=e,t}function H2(){return H2=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},H2.apply(this,arguments)}function ebe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Zy=function(t,r){return t&&r&&r.split(" ").forEach(function(n){return(0,Yme.default)(t,n)})},bC=function(t,r){return t&&r&&r.split(" ").forEach(function(n){return(0,Xme.default)(t,n)})},vC=function(e){ebe(t,e);function t(){for(var n,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s))||this,n.onEnter=function(o,l){var c=n.getClassNames(l?"appear":"enter"),f=c.className;n.removeClasses(o,"exit"),Zy(o,f),n.props.onEnter&&n.props.onEnter(o,l)},n.onEntering=function(o,l){var c=n.getClassNames(l?"appear":"enter"),f=c.activeClassName;n.reflowAndAddClass(o,f),n.props.onEntering&&n.props.onEntering(o,l)},n.onEntered=function(o,l){var c=n.getClassNames("appear").doneClassName,f=n.getClassNames("enter").doneClassName,u=l?c+" "+f:f;n.removeClasses(o,l?"appear":"enter"),Zy(o,u),n.props.onEntered&&n.props.onEntered(o,l)},n.onExit=function(o){var l=n.getClassNames("exit"),c=l.className;n.removeClasses(o,"appear"),n.removeClasses(o,"enter"),Zy(o,c),n.props.onExit&&n.props.onExit(o)},n.onExiting=function(o){var l=n.getClassNames("exit"),c=l.activeClassName;n.reflowAndAddClass(o,c),n.props.onExiting&&n.props.onExiting(o)},n.onExited=function(o){var l=n.getClassNames("exit"),c=l.doneClassName;n.removeClasses(o,"exit"),Zy(o,c),n.props.onExited&&n.props.onExited(o)},n.getClassNames=function(o){var l=n.props.classNames,c=typeof l=="string",f=c&&l?l+"-":"",u=c?f+o:l[o],d=c?u+"-active":l[o+"Active"],p=c?u+"-done":l[o+"Done"];return{className:u,activeClassName:d,doneClassName:p}},n}var r=t.prototype;return r.removeClasses=function(i,s){var a=this.getClassNames(s),o=a.className,l=a.activeClassName,c=a.doneClassName;o&&bC(i,o),l&&bC(i,l),c&&bC(i,c)},r.reflowAndAddClass=function(i,s){s&&(i&&i.scrollTop,Zy(i,s))},r.render=function(){var i=H2({},this.props);return delete i.classNames,p9.default.createElement(Zme.default,H2({},i,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(p9.default.Component);vC.defaultProps={classNames:""};vC.propTypes={};var tbe=vC;Qy.default=tbe;h9.exports=Qy.default});var m9=ce(vp=>{"use strict";vp.__esModule=!0;vp.getChildMapping=_C;vp.mergeChildMappings=y9;vp.getInitialChildMapping=rbe;vp.getNextChildMapping=nbe;var Go=Je();function _C(e,t){var r=function(s){return t&&(0,Go.isValidElement)(s)?t(s):s},n=Object.create(null);return e&&Go.Children.map(e,function(i){return i}).forEach(function(i){n[i.key]=r(i)}),n}function y9(e,t){e=e||{},t=t||{};function r(f){return f in t?t[f]:e[f]}var n=Object.create(null),i=[];for(var s in e)s in t?i.length&&(n[s]=i,i=[]):i.push(s);var a,o={};for(var l in t){if(n[l])for(a=0;a<n[l].length;a++){var c=n[l][a];o[n[l][a]]=r(c)}o[l]=r(l)}for(a=0;a<i.length;a++)o[i[a]]=r(i[a]);return o}function Bu(e,t,r){return r[t]!=null?r[t]:e.props[t]}function rbe(e,t){return _C(e.children,function(r){return(0,Go.cloneElement)(r,{onExited:t.bind(null,r),in:!0,appear:Bu(r,"appear",e),enter:Bu(r,"enter",e),exit:Bu(r,"exit",e)})})}function nbe(e,t,r){var n=_C(e.children),i=y9(t,n);return Object.keys(i).forEach(function(s){var a=i[s];if((0,Go.isValidElement)(a)){var o=s in t,l=s in n,c=t[s],f=(0,Go.isValidElement)(c)&&!c.props.in;l&&(!o||f)?i[s]=(0,Go.cloneElement)(a,{onExited:r.bind(null,a),in:!0,exit:Bu(a,"exit",e),enter:Bu(a,"enter",e)}):!l&&o&&!f?i[s]=(0,Go.cloneElement)(a,{in:!1}):l&&o&&(0,Go.isValidElement)(c)&&(i[s]=(0,Go.cloneElement)(a,{onExited:r.bind(null,a),in:c.props.in,exit:Bu(a,"exit",e),enter:Bu(a,"enter",e)}))}}),i}});var xC=ce((em,w9)=>{"use strict";em.__esModule=!0;em.default=void 0;var ibe=_9(Jo()),b9=_9(Je()),sbe=pC(),wC=m9();function _9(e){return e&&e.__esModule?e:{default:e}}function abe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function SC(){return SC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},SC.apply(this,arguments)}function obe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function v9(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var lbe=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},cbe={component:"div",childFactory:function(t){return t}},J2=function(e){obe(t,e);function t(n,i){var s;s=e.call(this,n,i)||this;var a=s.handleExited.bind(v9(v9(s)));return s.state={handleExited:a,firstRender:!0},s}var r=t.prototype;return r.getChildContext=function(){return{transitionGroup:{isMounting:!this.appeared}}},r.componentDidMount=function(){this.appeared=!0,this.mounted=!0},r.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(i,s){var a=s.children,o=s.handleExited,l=s.firstRender;return{children:l?(0,wC.getInitialChildMapping)(i,o):(0,wC.getNextChildMapping)(i,a,o),firstRender:!1}},r.handleExited=function(i,s){var a=(0,wC.getChildMapping)(this.props.children);i.key in a||(i.props.onExited&&i.props.onExited(s),this.mounted&&this.setState(function(o){var l=SC({},o.children);return delete l[i.key],{children:l}}))},r.render=function(){var i=this.props,s=i.component,a=i.childFactory,o=abe(i,["component","childFactory"]),l=lbe(this.state.children).map(a);return delete o.appear,delete o.enter,delete o.exit,s===null?l:b9.default.createElement(s,o,l)},t}(b9.default.Component);J2.childContextTypes={transitionGroup:ibe.default.object.isRequired};J2.propTypes={};J2.defaultProps=cbe;var ube=(0,sbe.polyfill)(J2);em.default=ube;w9.exports=em.default});var k9=ce((tm,x9)=>{"use strict";tm.__esModule=!0;tm.default=void 0;var E5e=kC(Jo()),_p=kC(Je()),fbe=Va(),dbe=kC(xC());function kC(e){return e&&e.__esModule?e:{default:e}}function pbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function hbe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var S9=function(e){hbe(t,e);function t(){for(var n,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s))||this,n.handleEnter=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return n.handleLifecycle("onEnter",0,l)},n.handleEntering=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return n.handleLifecycle("onEntering",0,l)},n.handleEntered=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return n.handleLifecycle("onEntered",0,l)},n.handleExit=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return n.handleLifecycle("onExit",1,l)},n.handleExiting=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return n.handleLifecycle("onExiting",1,l)},n.handleExited=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return n.handleLifecycle("onExited",1,l)},n}var r=t.prototype;return r.handleLifecycle=function(i,s,a){var o,l=this.props.children,c=_p.default.Children.toArray(l)[s];c.props[i]&&(o=c.props)[i].apply(o,a),this.props[i]&&this.props[i]((0,fbe.findDOMNode)(this))},r.render=function(){var i=this.props,s=i.children,a=i.in,o=pbe(i,["children","in"]),l=_p.default.Children.toArray(s),c=l[0],f=l[1];return delete o.onEnter,delete o.onEntering,delete o.onEntered,delete o.onExit,delete o.onExiting,delete o.onExited,_p.default.createElement(dbe.default,o,a?_p.default.cloneElement(c,{key:"first",onEnter:this.handleEnter,onEntering:this.handleEntering,onEntered:this.handleEntered}):_p.default.cloneElement(f,{key:"second",onEnter:this.handleExit,onEntering:this.handleExiting,onEntered:this.handleExited}))},t}(_p.default.Component);S9.propTypes={};var gbe=S9;tm.default=gbe;x9.exports=tm.default});var EC=ce((O5e,E9)=>{"use strict";var ybe=G2(g9()),mbe=G2(k9()),bbe=G2(xC()),vbe=G2(mC());function G2(e){return e&&e.__esModule?e:{default:e}}E9.exports={Transition:vbe.default,TransitionGroup:bbe.default,ReplaceTransition:mbe.default,CSSTransition:ybe.default}});var M9=ce((B5e,B9)=>{var D9=Ud(),Ibe=m2(),Nbe=Yr(),j9=D9?D9.isConcatSpreadable:void 0;function Pbe(e){return Nbe(e)||Ibe(e)||!!(j9&&e&&e[j9])}B9.exports=Pbe});var NC=ce((M5e,$9)=>{var Lbe=QA(),Fbe=M9();function R9(e,t,r,n,i){var s=-1,a=e.length;for(r||(r=Fbe),i||(i=[]);++s<a;){var o=e[s];t>0&&r(o)?t>1?R9(o,t-1,r,n,i):Lbe(i,o):n||(i[i.length]=o)}return i}$9.exports=R9});var z9=ce((R5e,U9)=>{function Dbe(e){return function(t,r,n){for(var i=-1,s=Object(t),a=n(t),o=a.length;o--;){var l=a[e?o:++i];if(r(s[l],l,s)===!1)break}return t}}U9.exports=Dbe});var V9=ce(($5e,q9)=>{var jbe=z9(),Bbe=jbe();q9.exports=Bbe});var PC=ce((U5e,H9)=>{var Mbe=V9(),Rbe=Uy();function $be(e,t){return e&&Mbe(e,t,Rbe)}H9.exports=$be});var J9=ce((z5e,W9)=>{var Ube=Xd();function zbe(e,t){return function(r,n){if(r==null)return r;if(!Ube(r))return e(r,n);for(var i=r.length,s=t?i:-1,a=Object(r);(t?s--:++s<i)&&n(a[s],s,a)!==!1;);return r}}W9.exports=zbe});var Y2=ce((q5e,G9)=>{var qbe=PC(),Vbe=J9(),Hbe=Vbe(qbe);G9.exports=Hbe});var LC=ce((V5e,K9)=>{var Wbe=Y2(),Jbe=Xd();function Gbe(e,t){var r=-1,n=Jbe(e)?Array(e.length):[];return Wbe(e,function(i,s,a){n[++r]=t(i,s,a)}),n}K9.exports=Gbe});var X9=ce((H5e,Y9)=>{function Kbe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}Y9.exports=Kbe});var eq=ce((W5e,Q9)=>{var Z9=ku();function Ybe(e,t){if(e!==t){var r=e!==void 0,n=e===null,i=e===e,s=Z9(e),a=t!==void 0,o=t===null,l=t===t,c=Z9(t);if(!o&&!c&&!s&&e>t||s&&a&&l&&!o&&!c||n&&a&&l||!r&&l||!i)return 1;if(!n&&!s&&!c&&e<t||c&&r&&i&&!n&&!s||o&&r&&i||!a&&i||!l)return-1}return 0}Q9.exports=Ybe});var rq=ce((J5e,tq)=>{var Xbe=eq();function Zbe(e,t,r){for(var n=-1,i=e.criteria,s=t.criteria,a=i.length,o=r.length;++n<a;){var l=Xbe(i[n],s[n]);if(l){if(n>=o)return l;var c=r[n];return l*(c=="desc"?-1:1)}}return e.index-t.index}tq.exports=Zbe});var iq=ce((G5e,nq)=>{var FC=Q0(),Qbe=e2(),eve=Wo(),tve=LC(),rve=X9(),nve=tT(),ive=rq(),sve=Iu(),ave=Yr();function ove(e,t,r){t.length?t=FC(t,function(s){return ave(s)?function(a){return Qbe(a,s.length===1?s[0]:s)}:s}):t=[sve];var n=-1;t=FC(t,nve(eve));var i=tve(e,function(s,a,o){var l=FC(t,function(c){return c(s)});return{criteria:l,index:++n,value:s}});return rve(i,function(s,a){return ive(s,a,r)})}nq.exports=ove});var aq=ce((K5e,sq)=>{function lve(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}sq.exports=lve});var cq=ce((Y5e,lq)=>{var cve=aq(),oq=Math.max;function uve(e,t,r){return t=oq(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,s=oq(n.length-t,0),a=Array(s);++i<s;)a[i]=n[t+i];i=-1;for(var o=Array(t+1);++i<t;)o[i]=n[i];return o[t]=r(a),cve(e,this,o)}}lq.exports=uve});var fq=ce((X5e,uq)=>{function fve(e){return function(){return e}}uq.exports=fve});var DC=ce((Z5e,dq)=>{var dve=Gl(),pve=function(){try{var e=dve(Object,"defineProperty");return e({},"",{}),e}catch{}}();dq.exports=pve});var gq=ce((Q5e,hq)=>{var hve=fq(),pq=DC(),gve=Iu(),yve=pq?function(e,t){return pq(e,"toString",{configurable:!0,enumerable:!1,value:hve(t),writable:!0})}:gve;hq.exports=yve});var mq=ce((e6e,yq)=>{var mve=800,bve=16,vve=Date.now;function _ve(e){var t=0,r=0;return function(){var n=vve(),i=bve-(n-r);if(r=n,i>0){if(++t>=mve)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}yq.exports=_ve});var vq=ce((t6e,bq)=>{var wve=gq(),Sve=mq(),xve=Sve(wve);bq.exports=xve});var wq=ce((r6e,_q)=>{var kve=Iu(),Eve=cq(),Ove=vq();function Ave(e,t){return Ove(Eve(e,t,kve),e+"")}_q.exports=Ave});var im=ce((n6e,Sq)=>{var Tve=Y0(),Cve=Xd(),Ive=b2(),Nve=Ms();function Pve(e,t,r){if(!Nve(r))return!1;var n=typeof t;return(n=="number"?Cve(r)&&Ive(t,r.length):n=="string"&&t in r)?Tve(r[t],e):!1}Sq.exports=Pve});var X2=ce((i6e,kq)=>{var Lve=NC(),Fve=iq(),Dve=wq(),xq=im(),jve=Dve(function(e,t){if(e==null)return[];var r=t.length;return r>1&&xq(e,t[0],t[1])?t=[]:r>2&&xq(t[0],t[1],t[2])&&(t=[t[0]]),Fve(e,Lve(t,1),[])});kq.exports=jve});var Mq=ce((p6e,Bq)=>{var l_e=pa(),c_e=function(){return l_e.Date.now()};Bq.exports=c_e});var $q=ce((h6e,Rq)=>{var u_e=/\s/;function f_e(e){for(var t=e.length;t--&&u_e.test(e.charAt(t)););return t}Rq.exports=f_e});var zq=ce((g6e,Uq)=>{var d_e=$q(),p_e=/^\s+/;function h_e(e){return e&&e.slice(0,d_e(e)+1).replace(p_e,"")}Uq.exports=h_e});var zC=ce((y6e,Hq)=>{var g_e=zq(),qq=Ms(),y_e=ku(),Vq=0/0,m_e=/^[-+]0x[0-9a-f]+$/i,b_e=/^0b[01]+$/i,v_e=/^0o[0-7]+$/i,__e=parseInt;function w_e(e){if(typeof e=="number")return e;if(y_e(e))return Vq;if(qq(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=qq(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=g_e(e);var r=b_e.test(e);return r||v_e.test(e)?__e(e.slice(2),r?2:8):m_e.test(e)?Vq:+e}Hq.exports=w_e});var VC=ce((m6e,Jq)=>{var S_e=Ms(),qC=Mq(),Wq=zC(),x_e="Expected a function",k_e=Math.max,E_e=Math.min;function O_e(e,t,r){var n,i,s,a,o,l,c=0,f=!1,u=!1,d=!0;if(typeof e!="function")throw new TypeError(x_e);t=Wq(t)||0,S_e(r)&&(f=!!r.leading,u="maxWait"in r,s=u?k_e(Wq(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d);function p(D){var L=n,U=i;return n=i=void 0,c=D,a=e.apply(U,L),a}function _(D){return c=D,o=setTimeout(S,t),f?p(D):a}function w(D){var L=D-l,U=D-c,te=t-L;return u?E_e(te,s-U):te}function k(D){var L=D-l,U=D-c;return l===void 0||L>=t||L<0||u&&U>=s}function S(){var D=qC();if(k(D))return O(D);o=setTimeout(S,w(D))}function O(D){return o=void 0,d&&n?p(D):(n=i=void 0,a)}function A(){o!==void 0&&clearTimeout(o),c=0,n=l=i=o=void 0}function C(){return o===void 0?a:O(qC())}function I(){var D=qC(),L=k(D);if(n=arguments,i=this,l=D,L){if(o===void 0)return _(l);if(u)return clearTimeout(o),o=setTimeout(S,t),p(l)}return o===void 0&&(o=setTimeout(S,t)),a}return I.cancel=A,I.flush=C,I}Jq.exports=O_e});var HC=ce((b6e,Gq)=>{var A_e=VC(),T_e=Ms(),C_e="Expected a function";function I_e(e,t,r){var n=!0,i=!0;if(typeof e!="function")throw new TypeError(C_e);return T_e(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),A_e(e,t,{leading:n,maxWait:t,trailing:i})}Gq.exports=I_e});var s7=ce((A6e,i7)=>{var KC="(".charCodeAt(0),YC=")".charCodeAt(0),tw="'".charCodeAt(0),XC='"'.charCodeAt(0),ZC="\\".charCodeAt(0),rw="/".charCodeAt(0),QC=",".charCodeAt(0),eI=":".charCodeAt(0),n7="*".charCodeAt(0);i7.exports=function(e){for(var t=[],r=e,n,i,s,a,o,l,c,f=0,u=r.charCodeAt(f),d=r.length,p=[{nodes:t}],_=0,w,k="",S="",O="";f<d;)if(u<=32){n=f;do n+=1,u=r.charCodeAt(n);while(u<=32);a=r.slice(f,n),s=t[t.length-1],u===YC&&_?O=a:s&&s.type==="div"?s.after=a:u===QC||u===eI||u===rw&&r.charCodeAt(n+1)!==n7?S=a:t.push({type:"space",sourceIndex:f,value:a}),f=n}else if(u===tw||u===XC){n=f,i=u===tw?"'":'"',a={type:"string",sourceIndex:f,quote:i};do if(o=!1,n=r.indexOf(i,n+1),~n)for(l=n;r.charCodeAt(l-1)===ZC;)l-=1,o=!o;else r+=i,n=r.length-1,a.unclosed=!0;while(o);a.value=r.slice(f+1,n),t.push(a),f=n+1,u=r.charCodeAt(f)}else if(u===rw&&r.charCodeAt(f+1)===n7)a={type:"comment",sourceIndex:f},n=r.indexOf("*/",f),n===-1&&(a.unclosed=!0,n=r.length),a.value=r.slice(f+2,n),t.push(a),f=n+2,u=r.charCodeAt(f);else if(u===rw||u===QC||u===eI)a=r[f],t.push({type:"div",sourceIndex:f-S.length,value:a,before:S,after:""}),S="",f+=1,u=r.charCodeAt(f);else if(KC===u){n=f;do n+=1,u=r.charCodeAt(n);while(u<=32);if(a={type:"function",sourceIndex:f-k.length,value:k,before:r.slice(f+1,n)},f=n,k==="url"&&u!==tw&&u!==XC){n-=1;do if(o=!1,n=r.indexOf(")",n+1),~n)for(l=n;r.charCodeAt(l-1)===ZC;)l-=1,o=!o;else r+=")",n=r.length-1,a.unclosed=!0;while(o);c=n;do c-=1,u=r.charCodeAt(c);while(u<=32);f!==c+1?a.nodes=[{type:"word",sourceIndex:f,value:r.slice(f,c+1)}]:a.nodes=[],a.unclosed&&c+1!==n?(a.after="",a.nodes.push({type:"space",sourceIndex:c+1,value:r.slice(c+1,n)})):a.after=r.slice(c+1,n),f=n+1,u=r.charCodeAt(f),t.push(a)}else _+=1,a.after="",t.push(a),p.push(a),t=a.nodes=[],w=a;k=""}else if(YC===u&&_)f+=1,u=r.charCodeAt(f),w.after=O,O="",_-=1,p.pop(),w=p[_],t=w.nodes;else{n=f;do u===ZC&&(n+=1),n+=1,u=r.charCodeAt(n);while(n<d&&!(u<=32||u===tw||u===XC||u===QC||u===eI||u===rw||u===KC||u===YC&&_));a=r.slice(f,n),KC===u?k=a:t.push({type:"word",sourceIndex:f,value:a}),f=n}for(f=p.length-1;f;f-=1)p[f].unclosed=!0;return p[0].nodes}});var o7=ce((T6e,a7)=>{a7.exports=function e(t,r,n){var i,s,a,o;for(i=0,s=t.length;i<s;i+=1)a=t[i],n||(o=r(a,i,t)),o!==!1&&a.type==="function"&&Array.isArray(a.nodes)&&e(a.nodes,r,n),n&&r(a,i,t)}});var f7=ce((C6e,u7)=>{function l7(e,t){var r=e.type,n=e.value,i,s;return t&&(s=t(e))!==void 0?s:r==="word"||r==="space"?n:r==="string"?(i=e.quote||"",i+n+(e.unclosed?"":i)):r==="comment"?"/*"+n+(e.unclosed?"":"*/"):r==="div"?(e.before||"")+n+(e.after||""):Array.isArray(e.nodes)?(i=c7(e.nodes),r!=="function"?i:n+"("+(e.before||"")+i+(e.after||"")+(e.unclosed?"":")")):n}function c7(e,t){var r,n;if(Array.isArray(e)){for(r="",n=e.length-1;~n;n-=1)r=l7(e[n],t)+r;return r}return l7(e,t)}u7.exports=c7});var p7=ce((I6e,d7)=>{var U_e="-".charCodeAt(0),z_e="+".charCodeAt(0),q_e=".".charCodeAt(0),V_e="e".charCodeAt(0),H_e="E".charCodeAt(0);d7.exports=function(e){for(var t=0,r=e.length,n=!1,i=-1,s=!1,a;t<r;){if(a=e.charCodeAt(t),a>=48&&a<=57)s=!0;else if(a===V_e||a===H_e){if(i>-1)break;i=t}else if(a===q_e){if(n)break;n=!0}else if(a===z_e||a===U_e){if(t!==0)break}else break;t+=1}return i+1===t&&t--,s?{number:e.slice(0,t),unit:e.slice(t)}:!1}});var m7=ce((N6e,y7)=>{var W_e=s7(),h7=o7(),g7=f7();function Ql(e){return this instanceof Ql?(this.nodes=W_e(e),this):new Ql(e)}Ql.prototype.toString=function(){return Array.isArray(this.nodes)?g7(this.nodes):""};Ql.prototype.walk=function(e,t){return h7(this.nodes,e,t),this};Ql.unit=p7();Ql.walk=h7;Ql.stringify=g7;y7.exports=Ql});var b7=ce(lm=>{var nw=function(){function e(f,u){Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonParserError"}),f==null&&(f="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:f}),this.hash=u;var d;if(u&&u.exception instanceof Error){var p=u.exception;this.message=p.message||f,d=p.stack}d||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):d=new Error(f).stack),d&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:d})}typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(e.prototype,Error.prototype):e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e.prototype.name="JisonParserError";function t(f){for(var u=[],d=f.pop,p=f.rule,_=0,w=d.length;_<w;_++)u.push([d[_],p[_]]);return u}function r(f){for(var u={},d=f.idx,p=f.goto,_=0,w=d.length;_<w;_++){var k=d[_];u[k]=p[_]}return u}function n(f){for(var u=[],d=f.len,p=f.symbol,_=f.type,w=f.state,k=f.mode,S=f.goto,O=0,A=d.length;O<A;O++){for(var C=d[O],I={},D=0;D<C;D++){var L=p.shift();switch(_.shift()){case 2:I[L]=[k.shift(),S.shift()];break;case 0:I[L]=w.shift();break;default:I[L]=[3]}}u.push(I)}return u}function i(f,u,d){d=d||0;for(var p=0;p<u;p++)this.push(f),f+=d}function s(f,u){for(f=this.length-f,u+=f;f<u;f++)this.push(this[f])}function a(f){for(var u=[],d=0,p=f.length;d<p;d++){var _=f[d];typeof _=="function"?(d++,_.apply(u,f[d])):u.push(_)}return u}var o={trace:function(){},JisonParserError:e,yy:{},options:{type:"lalr",hasPartialLrUpgradeOnConflict:!0,errorRecoveryTokenDiscardCount:3},symbols_:{$accept:0,$end:1,ADD:3,ANGLE:16,CHS:22,COMMA:14,CSS_CPROP:13,CSS_VAR:12,DIV:6,EMS:20,EOF:1,EXS:21,FREQ:18,LENGTH:15,LPAREN:7,MUL:5,NESTED_CALC:9,NUMBER:11,PERCENTAGE:28,PREFIX:10,REMS:23,RES:19,RPAREN:8,SUB:4,TIME:17,VHS:24,VMAXS:27,VMINS:26,VWS:25,css_value:33,css_variable:32,error:2,expression:29,math_expression:30,value:31},terminals_:{1:"EOF",2:"error",3:"ADD",4:"SUB",5:"MUL",6:"DIV",7:"LPAREN",8:"RPAREN",9:"NESTED_CALC",10:"PREFIX",11:"NUMBER",12:"CSS_VAR",13:"CSS_CPROP",14:"COMMA",15:"LENGTH",16:"ANGLE",17:"TIME",18:"FREQ",19:"RES",20:"EMS",21:"EXS",22:"CHS",23:"REMS",24:"VHS",25:"VWS",26:"VMINS",27:"VMAXS",28:"PERCENTAGE"},TERROR:2,EOF:1,originalQuoteName:null,originalParseError:null,cleanupAfterParse:null,constructParseErrorInfo:null,yyMergeLocationInfo:null,__reentrant_call_depth:0,__error_infos:[],__error_recovery_infos:[],quoteName:function(u){return'"'+u+'"'},getSymbolName:function(u){if(this.terminals_[u])return this.terminals_[u];var d=this.symbols_;for(var p in d)if(d[p]===u)return p;return null},describeSymbol:function(u){if(u!==this.EOF&&this.terminal_descriptions_&&this.terminal_descriptions_[u])return this.terminal_descriptions_[u];if(u===this.EOF)return"end of input";var d=this.getSymbolName(u);return d?this.quoteName(d):null},collect_expected_token_set:function(u,d){var p=this.TERROR,_=[],w={};if(!d&&this.state_descriptions_&&this.state_descriptions_[u])return[this.state_descriptions_[u]];for(var k in this.table[u])if(k=+k,k!==p){var S=d?k:this.describeSymbol(k);S&&!w[S]&&(_.push(S),w[S]=!0)}return _},productions_:t({pop:a([29,i,[30,10],31,31,32,32,i,[33,15]]),rule:a([2,i,[3,5],4,7,i,[1,4],2,4,6,i,[1,14],2])}),performAction:function(u,d,p){var _=this.yy,w=_.parser,k=_.lexer;switch(u){case 0:this.$=p[d-1];break;case 1:return this.$=p[d-1],p[d-1];break;case 2:case 3:case 4:case 5:this.$={type:"MathExpression",operator:p[d-1],left:p[d-2],right:p[d]};break;case 6:this.$=p[d-1];break;case 7:this.$={type:"Calc",value:p[d-1]};break;case 8:this.$={type:"Calc",value:p[d-1],prefix:p[d-5]};break;case 9:case 10:case 11:this.$=p[d];break;case 12:this.$={type:"Value",value:parseFloat(p[d])};break;case 13:this.$={type:"Value",value:parseFloat(p[d])*-1};break;case 14:this.$={type:"CssVariable",value:p[d-1]};break;case 15:this.$={type:"CssVariable",value:p[d-3],fallback:p[d-1]};break;case 16:this.$={type:"LengthValue",value:parseFloat(p[d]),unit:/[a-z]+/.exec(p[d])[0]};break;case 17:this.$={type:"AngleValue",value:parseFloat(p[d]),unit:/[a-z]+/.exec(p[d])[0]};break;case 18:this.$={type:"TimeValue",value:parseFloat(p[d]),unit:/[a-z]+/.exec(p[d])[0]};break;case 19:this.$={type:"FrequencyValue",value:parseFloat(p[d]),unit:/[a-z]+/.exec(p[d])[0]};break;case 20:this.$={type:"ResolutionValue",value:parseFloat(p[d]),unit:/[a-z]+/.exec(p[d])[0]};break;case 21:this.$={type:"EmValue",value:parseFloat(p[d]),unit:"em"};break;case 22:this.$={type:"ExValue",value:parseFloat(p[d]),unit:"ex"};break;case 23:this.$={type:"ChValue",value:parseFloat(p[d]),unit:"ch"};break;case 24:this.$={type:"RemValue",value:parseFloat(p[d]),unit:"rem"};break;case 25:this.$={type:"VhValue",value:parseFloat(p[d]),unit:"vh"};break;case 26:this.$={type:"VwValue",value:parseFloat(p[d]),unit:"vw"};break;case 27:this.$={type:"VminValue",value:parseFloat(p[d]),unit:"vmin"};break;case 28:this.$={type:"VmaxValue",value:parseFloat(p[d]),unit:"vmax"};break;case 29:this.$={type:"PercentageValue",value:parseFloat(p[d]),unit:"%"};break;case 30:var S=p[d];S.value*=-1,this.$=S;break}},table:n({len:a([24,1,5,23,1,18,i,[0,3],1,i,[0,16],i,[23,4],s,[28,3],0,0,16,1,6,6,i,[0,3],5,1,2,s,[37,3],s,[20,3],5,0,0]),symbol:a([4,7,9,11,12,i,[15,19,1],1,1,i,[3,4,1],s,[30,19],s,[29,4],7,4,10,11,s,[22,14],s,[19,3],s,[43,22],s,[23,69],s,[139,4],8,s,[51,24],4,s,[138,15],13,s,[186,5],8,s,[6,6],s,[5,5],9,8,14,s,[159,47],s,[60,10]]),type:a([i,[2,19],i,[0,5],1,i,[2,24],i,[0,4],s,[22,19],s,[43,42],s,[23,70],s,[28,25],s,[45,25],s,[113,54]]),state:a([1,2,8,6,7,30,s,[4,3],33,37,s,[5,3],38,s,[4,3],39,s,[4,3],40,s,[4,3],42,s,[21,4],50,s,[5,3],51,s,[4,3]]),mode:a([i,[1,179],i,[2,3],s,[5,5],s,[6,4],i,[1,57]]),goto:a([5,3,4,24,i,[9,15,1],i,[25,5,1],s,[24,19],31,35,32,34,s,[18,14],36,s,[38,19],s,[19,57],s,[118,4],41,s,[24,19],43,35,s,[16,14],44,i,[2,3],28,29,2,i,[3,3],28,29,3,s,[53,4],i,[45,5,1],s,[100,42],52,s,[5,4],53])}),defaultActions:r({idx:a([6,7,8,i,[10,16,1],33,34,39,40,41,45,47,52,53]),goto:a([9,10,11,i,[16,14,1],12,1,30,13,i,[4,4,1],14,15,8])}),parseError:function(u,d,p){if(d.recoverable)typeof this.trace=="function"&&this.trace(u),d.destroy();else throw typeof this.trace=="function"&&this.trace(u),p||(p=this.JisonParserError),new p(u,d)},parse:function(u){var d=this,p=new Array(128),_=new Array(128),w=new Array(128),k=this.table,S=0,O=0,A=this.TERROR,C=this.EOF,I=this.options.errorRecoveryTokenDiscardCount|0||3,D=[0,54],L;this.__lexer__?L=this.__lexer__:L=this.__lexer__=Object.create(this.lexer);var U={parseError:void 0,quoteName:void 0,lexer:void 0,parser:void 0,pre_parse:void 0,post_parse:void 0,pre_lex:void 0,post_lex:void 0},te;typeof assert!="function"?te=function(J,ne){if(!J)throw new Error("assertion failed: "+(ne||"***"))}:te=assert,this.yyGetSharedState=function(){return U};function V(W,J){for(var ne in J)typeof W[ne]>"u"&&Object.prototype.hasOwnProperty.call(J,ne)&&(W[ne]=J[ne])}V(U,this.yy),U.lexer=L,U.parser=this,typeof U.parseError=="function"?this.parseError=function(J,ne,Oe){return Oe||(Oe=this.JisonParserError),U.parseError.call(this,J,ne,Oe)}:this.parseError=this.originalParseError,typeof U.quoteName=="function"?this.quoteName=function(J){return U.quoteName.call(this,J)}:this.quoteName=this.originalQuoteName,this.cleanupAfterParse=function(J,ne,Oe){var Ne;if(ne){var Ce;(U.post_parse||this.post_parse)&&(Ce=this.constructParseErrorInfo(null,null,null,!1)),U.post_parse&&(Ne=U.post_parse.call(this,U,J,Ce),typeof Ne<"u"&&(J=Ne)),this.post_parse&&(Ne=this.post_parse.call(this,U,J,Ce),typeof Ne<"u"&&(J=Ne)),Ce&&Ce.destroy&&Ce.destroy()}if(this.__reentrant_call_depth>1)return J;if(L.cleanupAfterLex&&L.cleanupAfterLex(Oe),U&&(U.lexer=void 0,U.parser=void 0,L.yy===U&&(L.yy=void 0)),U=void 0,this.parseError=this.originalParseError,this.quoteName=this.originalQuoteName,p.length=0,_.length=0,w.length=0,S=0,!Oe){for(var Xe=this.__error_infos.length-1;Xe>=0;Xe--){var Ze=this.__error_infos[Xe];Ze&&typeof Ze.destroy=="function"&&Ze.destroy()}this.__error_infos.length=0}return J},this.constructParseErrorInfo=function(J,ne,Oe,Ne){var Ce={errStr:J,exception:ne,text:L.match,value:L.yytext,token:this.describeSymbol(O)||O,token_id:O,line:L.yylineno,expected:Oe,recoverable:Ne,state:de,action:F,new_state:oe,symbol_stack:p,state_stack:_,value_stack:w,stack_pointer:S,yy:U,lexer:L,parser:this,destroy:function(){var Ze=!!this.recoverable;for(var kt in this)this.hasOwnProperty(kt)&&typeof kt=="object"&&(this[kt]=void 0);this.recoverable=Ze}};return this.__error_infos.push(Ce),Ce};function X(W){var J=d.getSymbolName(W);return J||(J=W),J}function Z(){var W=L.lex();return typeof W!="number"&&(W=d.symbols_[W]||W),W||C}function se(){var W=L.fastLex();return typeof W!="number"&&(W=d.symbols_[W]||W),W||C}var pe=Z,de,F,H,Q,R={$:!0,_$:void 0,yy:U},$,q,ie,oe,fe=!1;try{if(this.__reentrant_call_depth++,L.setInput(u,U),typeof L.canIUse=="function"){var _e=L.canIUse();_e.fastLex&&typeof se=="function"&&(pe=se)}for(w[S]=null,_[S]=0,p[S]=0,++S,this.pre_parse&&this.pre_parse.call(this,U),U.pre_parse&&U.pre_parse.call(this,U),oe=_[S-1];;){if(de=oe,this.defaultActions[de])F=2,oe=this.defaultActions[de];else if(O||(O=pe()),Q=k[de]&&k[de][O]||D,oe=Q[1],F=Q[0],!F){var Ee,Se=this.describeSymbol(O)||O,le=this.collect_expected_token_set(de);typeof L.yylineno=="number"?Ee="Parse error on line "+(L.yylineno+1)+": ":Ee="Parse error: ",typeof L.showPosition=="function"&&(Ee+=`
`+L.showPosition(79-10,10)+`
`),le.length?Ee+="Expecting "+le.join(", ")+", got unexpected "+Se:Ee+="Unexpected "+Se,$=this.constructParseErrorInfo(Ee,null,le,!1),H=this.parseError($.errStr,$,this.JisonParserError),typeof H<"u"&&(fe=H);break}switch(F){default:if(F instanceof Array){$=this.constructParseErrorInfo("Parse Error: multiple actions possible at state: "+de+", token: "+O,null,null,!1),H=this.parseError($.errStr,$,this.JisonParserError),typeof H<"u"&&(fe=H);break}$=this.constructParseErrorInfo("Parsing halted. No viable error recovery approach available due to internal system failure.",null,null,!1),H=this.parseError($.errStr,$,this.JisonParserError),typeof H<"u"&&(fe=H);break;case 1:p[S]=O,w[S]=L.yytext,_[S]=oe,++S,O=0;continue;case 2:if(ie=this.productions_[oe-1],q=ie[1],H=this.performAction.call(R,oe,S-1,w),typeof H<"u"){fe=H;break}S-=q;var we=ie[0];p[S]=we,w[S]=R.$,oe=k[_[S-1]][we],_[S]=oe,++S;continue;case 3:S!==-2&&(fe=!0,S--,typeof w[S]<"u"&&(fe=w[S]));break}break}}catch(W){if(W instanceof this.JisonParserError)throw W;if(L&&typeof L.JisonLexerError=="function"&&W instanceof L.JisonLexerError)throw W;$=this.constructParseErrorInfo("Parsing aborted due to exception.",W,null,!1),fe=!1,H=this.parseError($.errStr,$,this.JisonParserError),typeof H<"u"&&(fe=H)}finally{fe=this.cleanupAfterParse(fe,!0,!0),this.__reentrant_call_depth--}return fe}};o.originalParseError=o.parseError,o.originalQuoteName=o.quoteName;var l=function(){function f(d,p){Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonLexerError"}),d==null&&(d="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:d}),this.hash=p;var _;if(p&&p.exception instanceof Error){var w=p.exception;this.message=w.message||d,_=w.stack}_||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):_=new Error(d).stack),_&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:_})}typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(f.prototype,Error.prototype):f.prototype=Object.create(Error.prototype),f.prototype.constructor=f,f.prototype.name="JisonLexerError";var u={EOF:1,ERROR:2,__currentRuleSet__:null,__error_infos:[],__decompressed:!1,done:!1,_backtrack:!1,_input:"",_more:!1,_signaled_error_token:!1,conditionStack:[],match:"",matched:"",matches:!1,yytext:"",offset:0,yyleng:0,yylineno:0,yylloc:null,constructLexErrorInfo:function(p,_,w){if(p=""+p,w==null&&(w=!(p.indexOf(`
`)>0&&p.indexOf("^")>0)),this.yylloc&&w){if(typeof this.prettyPrintRange=="function"){var k=this.prettyPrintRange(this.yylloc);/\n\s*$/.test(p)||(p+=`
`),p+=`
  Erroneous area:
`+this.prettyPrintRange(this.yylloc)}else if(typeof this.showPosition=="function"){var S=this.showPosition();S&&(p.length&&p[p.length-1]!==`
`&&S[0]!==`
`?p+=`
`+S:p+=S)}}var O={errStr:p,recoverable:!!_,text:this.match,token:null,line:this.yylineno,loc:this.yylloc,yy:this.yy,lexer:this,destroy:function(){var C=!!this.recoverable;for(var I in this)this.hasOwnProperty(I)&&typeof I=="object"&&(this[I]=void 0);this.recoverable=C}};return this.__error_infos.push(O),O},parseError:function(p,_,w){if(w||(w=this.JisonLexerError),this.yy){if(this.yy.parser&&typeof this.yy.parser.parseError=="function")return this.yy.parser.parseError.call(this,p,_,w)||this.ERROR;if(typeof this.yy.parseError=="function")return this.yy.parseError.call(this,p,_,w)||this.ERROR}throw new w(p,_)},yyerror:function(p){var _="";this.yylloc&&(_=" on line "+(this.yylineno+1));var w=this.constructLexErrorInfo("Lexical error"+_+": "+p,this.options.lexerErrorsAreRecoverable),k=Array.prototype.slice.call(arguments,1);return k.length&&(w.extra_error_attributes=k),this.parseError(w.errStr,w,this.JisonLexerError)||this.ERROR},cleanupAfterLex:function(p){if(this.setInput("",{}),!p){for(var _=this.__error_infos.length-1;_>=0;_--){var w=this.__error_infos[_];w&&typeof w.destroy=="function"&&w.destroy()}this.__error_infos.length=0}return this},clear:function(){this.yytext="",this.yyleng=0,this.match="",this.matches=!1,this._more=!1,this._backtrack=!1;var p=this.yylloc?this.yylloc.last_column:0;this.yylloc={first_line:this.yylineno+1,first_column:p,last_line:this.yylineno+1,last_column:p,range:[this.offset,this.offset]}},setInput:function(p,_){if(this.yy=_||this.yy||{},!this.__decompressed){for(var w=this.rules,k=0,S=w.length;k<S;k++){var O=w[k];typeof O=="number"&&(w[k]=w[O])}var A=this.conditions;for(var C in A){for(var I=A[C],D=I.rules,S=D.length,L=new Array(S+1),U=new Array(S+1),k=0;k<S;k++){var te=D[k],O=w[te];L[k+1]=O,U[k+1]=te}I.rules=U,I.__rule_regexes=L,I.__rule_count=S}this.__decompressed=!0}return this._input=p||"",this.clear(),this._signaled_error_token=!1,this.done=!1,this.yylineno=0,this.matched="",this.conditionStack=["INITIAL"],this.__currentRuleSet__=null,this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]},this.offset=0,this},editRemainingInput:function(p,_){var w=p.call(this,this._input,_);return typeof w!="string"?w&&(this._input=""+w):this._input=w,this},input:function(){if(!this._input)return null;var p=this._input[0];this.yytext+=p,this.yyleng++,this.offset++,this.match+=p,this.matched+=p;var _=1,w=!1;if(p===`
`)w=!0;else if(p==="\r"){w=!0;var k=this._input[1];k===`
`&&(_++,p+=k,this.yytext+=k,this.yyleng++,this.offset++,this.match+=k,this.matched+=k,this.yylloc.range[1]++)}return w?(this.yylineno++,this.yylloc.last_line++,this.yylloc.last_column=0):this.yylloc.last_column++,this.yylloc.range[1]++,this._input=this._input.slice(_),p},unput:function(p){var _=p.length,w=p.split(/(?:\r\n?|\n)/g);if(this._input=p+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-_),this.yyleng=this.yytext.length,this.offset-=_,this.match=this.match.substr(0,this.match.length-_),this.matched=this.matched.substr(0,this.matched.length-_),w.length>1){this.yylineno-=w.length-1,this.yylloc.last_line=this.yylineno+1;var k=this.match,S=k.split(/(?:\r\n?|\n)/g);S.length===1&&(k=this.matched,S=k.split(/(?:\r\n?|\n)/g)),this.yylloc.last_column=S[S.length-1].length}else this.yylloc.last_column-=_;return this.yylloc.range[1]=this.yylloc.range[0]+this.yyleng,this.done=!1,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else{var p="";this.yylloc&&(p=" on line "+(this.yylineno+1));var _=this.constructLexErrorInfo("Lexical error"+p+": You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).",!1);this._signaled_error_token=this.parseError(_.errStr,_,this.JisonLexerError)||this.ERROR}return this},less:function(p){return this.unput(this.match.slice(p))},pastInput:function(p,_){var w=this.matched.substring(0,this.matched.length-this.match.length);p<0?p=w.length:p||(p=20),_<0?_=w.length:_||(_=1),w=w.substr(-p*2-2);var k=w.replace(/\r\n|\r/g,`
`).split(`
`);return k=k.slice(-_),w=k.join(`
`),w.length>p&&(w="..."+w.substr(-p)),w},upcomingInput:function(p,_){var w=this.match;p<0?p=w.length+this._input.length:p||(p=20),_<0?_=p:_||(_=1),w.length<p*2+2&&(w+=this._input.substring(0,p*2+2));var k=w.replace(/\r\n|\r/g,`
`).split(`
`);return k=k.slice(0,_),w=k.join(`
`),w.length>p&&(w=w.substring(0,p)+"..."),w},showPosition:function(p,_){var w=this.pastInput(p).replace(/\s/g," "),k=new Array(w.length+1).join("-");return w+this.upcomingInput(_).replace(/\s/g," ")+`
`+k+"^"},deriveLocationInfo:function(p,_,w,k){var S={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]};return p&&(S.first_line=p.first_line|0,S.last_line=p.last_line|0,S.first_column=p.first_column|0,S.last_column=p.last_column|0,p.range&&(S.range[0]=p.range[0]|0,S.range[1]=p.range[1]|0)),(S.first_line<=0||S.last_line<S.first_line)&&(S.first_line<=0&&_&&(S.first_line=_.last_line|0,S.first_column=_.last_column|0,_.range&&(S.range[0]=p.range[1]|0)),(S.last_line<=0||S.last_line<S.first_line)&&w&&(S.last_line=w.first_line|0,S.last_column=w.first_column|0,w.range&&(S.range[1]=p.range[0]|0)),S.first_line<=0&&k&&(S.last_line<=0||k.last_line<=S.last_line)&&(S.first_line=k.first_line|0,S.first_column=k.first_column|0,k.range&&(S.range[0]=k.range[0]|0)),S.last_line<=0&&k&&(S.first_line<=0||k.first_line>=S.first_line)&&(S.last_line=k.last_line|0,S.last_column=k.last_column|0,k.range&&(S.range[1]=k.range[1]|0))),S.last_line<=0&&(S.first_line<=0?(S.first_line=this.yylloc.first_line,S.last_line=this.yylloc.last_line,S.first_column=this.yylloc.first_column,S.last_column=this.yylloc.last_column,S.range[0]=this.yylloc.range[0],S.range[1]=this.yylloc.range[1]):(S.last_line=this.yylloc.last_line,S.last_column=this.yylloc.last_column,S.range[1]=this.yylloc.range[1])),S.first_line<=0&&(S.first_line=S.last_line,S.first_column=0,S.range[1]=S.range[0]),S.first_column<0&&(S.first_column=0),S.last_column<0&&(S.last_column=S.first_column>0?S.first_column:80),S},prettyPrintRange:function(p,_,w){p=this.deriveLocationInfo(p,_,w);let k=3,S=1,O=2;var A=this.matched+this._input,C=A.split(`
`),I=Math.max(1,_?_.first_line:p.first_line-k),D=Math.max(1,w?w.last_line:p.last_line+S),L=1+Math.log10(D|1)|0,U=new Array(L).join(" "),te=[],V=C.slice(I-1,D+1).map(function(de,F){var H=F+I,Q=(U+H).substr(-L),R=Q+": "+de,$=new Array(L+1).join("^"),q=2+1,ie=0;if(H===p.first_line?(q+=p.first_column,ie=Math.max(2,(H===p.last_line?p.last_column:de.length)-p.first_column+1)):H===p.last_line?ie=Math.max(2,p.last_column+1):H>p.first_line&&H<p.last_line&&(ie=Math.max(2,de.length+1)),ie){var oe=new Array(q).join("."),fe=new Array(ie).join("^");R+=`
`+$+oe+fe,de.trim().length>0&&te.push(F)}return R=R.replace(/\t/g," "),R});if(te.length>2*O){var X=te[O-1]+1,Z=te[te.length-O]-1,se=new Array(L+1).join(" ")+"  (...continued...)";se+=`
`+new Array(L+1).join("-")+"  (---------------)",V.splice(X,Z-X+1,se)}return V.join(`
`)},describeYYLLOC:function(p,_){var w=p.first_line,k=p.last_line,S=p.first_column,O=p.last_column,A=k-w,C=O-S,I;if(A===0?(I="line "+w+", ",C<=1?I+="column "+S:I+="columns "+S+" .. "+O):I="lines "+w+"(column "+S+") .. "+k+"(column "+O+")",p.range&&_){var D=p.range[0],L=p.range[1]-1;L<=D?I+=" {String Offset: "+D+"}":I+=" {String Offset range: "+D+" .. "+L+"}"}return I},test_match:function(p,_){var w,k,S,O,A;if(this.options.backtrack_lexer&&(S={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.yylloc.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column,range:this.yylloc.range.slice(0)},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done}),O=p[0],A=O.length,k=O.split(/(?:\r\n?|\n)/g),k.length>1?(this.yylineno+=k.length-1,this.yylloc.last_line=this.yylineno+1,this.yylloc.last_column=k[k.length-1].length):this.yylloc.last_column+=A,this.yytext+=O,this.match+=O,this.matched+=O,this.matches=p,this.yyleng=this.yytext.length,this.yylloc.range[1]+=A,this.offset+=A,this._more=!1,this._backtrack=!1,this._input=this._input.slice(A),w=this.performAction.call(this,this.yy,_,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),w)return w;if(this._backtrack){for(var C in S)this[C]=S[C];return this.__currentRuleSet__=null,!1}else if(this._signaled_error_token)return w=this._signaled_error_token,this._signaled_error_token=!1,w;return!1},next:function(){if(this.done)return this.clear(),this.EOF;this._input||(this.done=!0);var p,_,w,k;this._more||this.clear();var S=this.__currentRuleSet__;if(!S&&(S=this.__currentRuleSet__=this._currentRules(),!S||!S.rules)){var O="";this.options.trackPosition&&(O=" on line "+(this.yylineno+1));var A=this.constructLexErrorInfo("Internal lexer engine error"+O+': The lex grammar programmer pushed a non-existing condition name "'+this.topState()+'"; this is a fatal error and should be reported to the application programmer team!',!1);return this.parseError(A.errStr,A,this.JisonLexerError)||this.ERROR}for(var C=S.rules,I=S.__rule_regexes,D=S.__rule_count,L=1;L<=D;L++)if(w=this._input.match(I[L]),w&&(!_||w[0].length>_[0].length)){if(_=w,k=L,this.options.backtrack_lexer){if(p=this.test_match(w,C[L]),p!==!1)return p;if(this._backtrack){_=void 0;continue}else return!1}else if(!this.options.flex)break}if(_)return p=this.test_match(_,C[k]),p!==!1?p:!1;if(this._input){var O="";this.options.trackPosition&&(O=" on line "+(this.yylineno+1));var A=this.constructLexErrorInfo("Lexical error"+O+": Unrecognized text.",this.options.lexerErrorsAreRecoverable),U=this._input,te=this.topState(),V=this.conditionStack.length;return p=this.parseError(A.errStr,A,this.JisonLexerError)||this.ERROR,p===this.ERROR&&!this.matches&&U===this._input&&te===this.topState()&&V===this.conditionStack.length&&this.input(),p}else return this.done=!0,this.clear(),this.EOF},lex:function(){var p;for(typeof this.pre_lex=="function"&&(p=this.pre_lex.call(this,0)),typeof this.options.pre_lex=="function"&&(p=this.options.pre_lex.call(this,p)||p),this.yy&&typeof this.yy.pre_lex=="function"&&(p=this.yy.pre_lex.call(this,p)||p);!p;)p=this.next();return this.yy&&typeof this.yy.post_lex=="function"&&(p=this.yy.post_lex.call(this,p)||p),typeof this.options.post_lex=="function"&&(p=this.options.post_lex.call(this,p)||p),typeof this.post_lex=="function"&&(p=this.post_lex.call(this,p)||p),p},fastLex:function(){for(var p;!p;)p=this.next();return p},canIUse:function(){var p={fastLex:!(typeof this.pre_lex=="function"||typeof this.options.pre_lex=="function"||this.yy&&typeof this.yy.pre_lex=="function"||this.yy&&typeof this.yy.post_lex=="function"||typeof this.options.post_lex=="function"||typeof this.post_lex=="function")&&typeof this.fastLex=="function"};return p},begin:function(p){return this.pushState(p)},pushState:function(p){return this.conditionStack.push(p),this.__currentRuleSet__=null,this},popState:function(){var p=this.conditionStack.length-1;return p>0?(this.__currentRuleSet__=null,this.conditionStack.pop()):this.conditionStack[0]},topState:function(p){return p=this.conditionStack.length-1-Math.abs(p||0),p>=0?this.conditionStack[p]:"INITIAL"},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL},stateStackSize:function(){return this.conditionStack.length},options:{trackPosition:!0},JisonLexerError:f,performAction:function(p,_,w){var k=this,S=w;switch(_){case 1:break;default:return this.simpleCaseActionClusters[_]}},simpleCaseActionClusters:{0:13,2:5,3:6,4:3,5:4,6:15,7:15,8:15,9:15,10:15,11:15,12:16,13:16,14:16,15:16,16:17,17:17,18:18,19:18,20:19,21:19,22:19,23:20,24:21,25:22,26:23,27:25,28:24,29:26,30:27,31:28,32:11,33:9,34:12,35:10,36:7,37:8,38:14,39:1},rules:[/^(?:(--[\d\-A-Za-z]*))/,/^(?:\s+)/,/^(?:\*)/,/^(?:\/)/,/^(?:\+)/,/^(?:-)/,/^(?:(\d+(\.\d*)?|\.\d+)px\b)/,/^(?:(\d+(\.\d*)?|\.\d+)cm\b)/,/^(?:(\d+(\.\d*)?|\.\d+)mm\b)/,/^(?:(\d+(\.\d*)?|\.\d+)in\b)/,/^(?:(\d+(\.\d*)?|\.\d+)pt\b)/,/^(?:(\d+(\.\d*)?|\.\d+)pc\b)/,/^(?:(\d+(\.\d*)?|\.\d+)deg\b)/,/^(?:(\d+(\.\d*)?|\.\d+)grad\b)/,/^(?:(\d+(\.\d*)?|\.\d+)rad\b)/,/^(?:(\d+(\.\d*)?|\.\d+)turn\b)/,/^(?:(\d+(\.\d*)?|\.\d+)s\b)/,/^(?:(\d+(\.\d*)?|\.\d+)ms\b)/,/^(?:(\d+(\.\d*)?|\.\d+)Hz\b)/,/^(?:(\d+(\.\d*)?|\.\d+)kHz\b)/,/^(?:(\d+(\.\d*)?|\.\d+)dpi\b)/,/^(?:(\d+(\.\d*)?|\.\d+)dpcm\b)/,/^(?:(\d+(\.\d*)?|\.\d+)dppx\b)/,/^(?:(\d+(\.\d*)?|\.\d+)em\b)/,/^(?:(\d+(\.\d*)?|\.\d+)ex\b)/,/^(?:(\d+(\.\d*)?|\.\d+)ch\b)/,/^(?:(\d+(\.\d*)?|\.\d+)rem\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vw\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vh\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vmin\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vmax\b)/,/^(?:(\d+(\.\d*)?|\.\d+)%)/,/^(?:(\d+(\.\d*)?|\.\d+)\b)/,/^(?:(calc))/,/^(?:(var))/,/^(?:([a-z]+))/,/^(?:\()/,/^(?:\))/,/^(?:,)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39],inclusive:!0}}};return u}();o.lexer=l;function c(){this.yy={}}return c.prototype=o,o.Parser=c,new c}();typeof ar<"u"&&typeof lm<"u"&&(lm.parser=nw,lm.Parser=nw.Parser,lm.parse=function(){return nw.parse.apply(nw,arguments)})});var _7=ce((F6e,v7)=>{var tI={px:{px:1,cm:37.79527559055118,mm:3.7795275590551185,in:96,pt:1.3333333333333333,pc:16},cm:{px:.026458333333333334,cm:1,mm:.1,in:2.54,pt:.035277777777777776,pc:.42333333333333334},mm:{px:.26458333333333334,cm:10,mm:1,in:25.4,pt:.35277777777777775,pc:4.233333333333333},in:{px:.010416666666666666,cm:.39370078740157477,mm:.03937007874015748,in:1,pt:.013888888888888888,pc:.16666666666666666},pt:{px:.75,cm:28.346456692913385,mm:2.834645669291339,in:72,pt:1,pc:12},pc:{px:.0625,cm:2.3622047244094486,mm:.2362204724409449,in:6,pt:.08333333333333333,pc:1},deg:{deg:1,grad:.9,rad:180/Math.PI,turn:360},grad:{deg:1.1111111111111112,grad:1,rad:200/Math.PI,turn:400},rad:{deg:Math.PI/180,grad:Math.PI/200,rad:1,turn:Math.PI*2},turn:{deg:.002777777777777778,grad:.0025,rad:.5/Math.PI,turn:1},s:{s:1,ms:.001},ms:{s:1e3,ms:1},Hz:{Hz:1,kHz:1e3},kHz:{Hz:.001,kHz:1},dpi:{dpi:1,dpcm:.39370078740157477,dppx:.010416666666666666},dpcm:{dpi:2.54,dpcm:1,dppx:.026458333333333334},dppx:{dpi:96,dpcm:37.79527559055118,dppx:1}};v7.exports=function(e,t,r,n){if(!tI.hasOwnProperty(r))throw new Error("Cannot convert to "+r);if(!tI[r].hasOwnProperty(t))throw new Error("Cannot convert from "+t+" to "+r);var i=tI[r][t]*e;return n!==!1?(n=Math.pow(10,parseInt(n)||5),Math.round(i*n)/n):i}});var S7=ce((iw,w7)=>{"use strict";Object.defineProperty(iw,"__esModule",{value:!0});var J_e=_7(),G_e=K_e(J_e);function K_e(e){return e&&e.__esModule?e:{default:e}}function Y_e(e,t,r){switch(e.type){case"LengthValue":case"AngleValue":case"TimeValue":case"FrequencyValue":case"ResolutionValue":return X_e(e,t,r);default:return{left:e,right:t}}}function X_e(e,t,r){return t.type===e.type&&(t={type:e.type,value:(0,G_e.default)(t.value,t.unit,e.unit,r),unit:e.unit}),{left:e,right:t}}iw.default=Y_e;w7.exports=iw.default});var sI=ce(sw=>{"use strict";Object.defineProperty(sw,"__esModule",{value:!0});sw.flip=nI;var Z_e=S7(),rI=Q_e(Z_e);function Q_e(e){return e&&e.__esModule?e:{default:e}}function ci(e,t){return e.type==="MathExpression"?i0e(e,t):e.type==="Calc"?ci(e.value,t):e}function x7(e,t){return e.type===t.type&&e.value===t.value}function Ki(e){switch(e){case"LengthValue":case"AngleValue":case"TimeValue":case"FrequencyValue":case"ResolutionValue":case"EmValue":case"ExValue":case"ChValue":case"RemValue":case"VhValue":case"VwValue":case"VminValue":case"VmaxValue":case"PercentageValue":case"Value":return!0}return!1}function e0e(e,t){var r=(0,rI.default)(e.left,e.right,t),n=ci(r.left,t),i=ci(r.right,t);return n.type==="MathExpression"&&i.type==="MathExpression"&&(n.operator==="/"&&i.operator==="*"||n.operator==="-"&&i.operator==="+"||n.operator==="*"&&i.operator==="/"||n.operator==="+"&&i.operator==="-")&&(x7(n.right,i.right)?r=(0,rI.default)(n.left,i.left,t):x7(n.right,i.left)&&(r=(0,rI.default)(n.left,i.right,t)),n=ci(r.left,t),i=ci(r.right,t)),e.left=n,e.right=i,e}function nI(e){return e==="+"?"-":"+"}function iI(e){return Ki(e.type)?e.value=-e.value:e.type=="MathExpression"&&(e.left=iI(e.left),e.right=iI(e.right)),e}function t0e(e,t){var r=e,n=r.left,i=r.right,s=r.operator;if(n.type==="CssVariable"||i.type==="CssVariable")return e;if(i.value===0)return n;if(n.value===0&&s==="+")return i;if(n.value===0&&s==="-")return iI(i);if(n.type===i.type&&Ki(n.type)&&(e=Object.assign({},n),s==="+"?e.value=n.value+i.value:e.value=n.value-i.value),Ki(n.type)&&(i.operator==="+"||i.operator==="-")&&i.type==="MathExpression"){if(n.type===i.left.type)return e=Object.assign({},e),e.left=ci({type:"MathExpression",operator:s,left:n,right:i.left},t),e.right=i.right,e.operator=s==="-"?nI(i.operator):i.operator,ci(e,t);if(n.type===i.right.type)return e=Object.assign({},e),e.left=ci({type:"MathExpression",operator:s==="-"?nI(i.operator):i.operator,left:n,right:i.right},t),e.right=i.left,ci(e,t)}if(n.type==="MathExpression"&&(n.operator==="+"||n.operator==="-")&&Ki(i.type)){if(i.type===n.left.type)return e=Object.assign({},n),e.left=ci({type:"MathExpression",operator:s,left:n.left,right:i},t),ci(e,t);if(i.type===n.right.type)return e=Object.assign({},n),n.operator==="-"?(e.right=ci({type:"MathExpression",operator:s==="-"?"+":"-",left:i,right:n.right},t),e.operator=s==="-"?"-":"+"):e.right=ci({type:"MathExpression",operator:s,left:n.right,right:i},t),e.right.value<0&&(e.right.value*=-1,e.operator=e.operator==="-"?"+":"-"),ci(e,t)}return e}function r0e(e,t){if(!Ki(e.right.type))return e;if(e.right.type!=="Value")throw new Error('Cannot divide by "'+e.right.unit+'", number expected');if(e.right.value===0)throw new Error("Cannot divide by zero");return e.left.type==="MathExpression"?Ki(e.left.left.type)&&Ki(e.left.right.type)?(e.left.left.value/=e.right.value,e.left.right.value/=e.right.value,ci(e.left,t)):e:Ki(e.left.type)?(e.left.value/=e.right.value,e.left):e}function n0e(e){if(e.left.type==="MathExpression"&&e.right.type==="Value"){if(Ki(e.left.left.type)&&Ki(e.left.right.type))return e.left.left.value*=e.right.value,e.left.right.value*=e.right.value,e.left}else{if(Ki(e.left.type)&&e.right.type==="Value")return e.left.value*=e.right.value,e.left;if(e.left.type==="Value"&&e.right.type==="MathExpression"){if(Ki(e.right.left.type)&&Ki(e.right.right.type))return e.right.left.value*=e.left.value,e.right.right.value*=e.left.value,e.right}else if(e.left.type==="Value"&&Ki(e.right.type))return e.right.value*=e.left.value,e.right}return e}function i0e(e,t){switch(e=e0e(e,t),e.operator){case"+":case"-":return t0e(e,t);case"/":return r0e(e,t);case"*":return n0e(e)}return e}sw.default=ci});var O7=ce((ow,E7)=>{"use strict";Object.defineProperty(ow,"__esModule",{value:!0});ow.default=function(e,t,r){var n=Yo(t,r);return t.type==="MathExpression"&&(n=e+"("+n+")"),n};var s0e=sI(),aw={"*":0,"/":0,"+":1,"-":1};function k7(e,t){if(t!==!1){var r=Math.pow(10,t);return Math.round(e*r)/r}return e}function Yo(e,t){switch(e.type){case"MathExpression":{var r=e.left,n=e.right,i=e.operator,s="";return r.type==="MathExpression"&&aw[i]<aw[r.operator]?s+="("+Yo(r,t)+")":s+=Yo(r,t),s+=" "+e.operator+" ",n.type==="MathExpression"&&aw[i]<aw[n.operator]?s+="("+Yo(n,t)+")":(n.type==="MathExpression"&&i==="-"&&["+","-"].includes(n.operator)&&(n.operator=(0,s0e.flip)(n.operator)),s+=Yo(n,t)),s}case"Value":return k7(e.value,t);case"CssVariable":return e.fallback?"var("+e.value+", "+Yo(e.fallback,t,!0)+")":"var("+e.value+")";case"Calc":return e.prefix?"-"+e.prefix+"-calc("+Yo(e.value,t)+")":"calc("+Yo(e.value,t)+")";default:return k7(e.value,t)+e.unit}}E7.exports=ow.default});var C7=ce((lw,T7)=>{"use strict";Object.defineProperty(lw,"__esModule",{value:!0});var a0e=m7(),A7=aI(a0e),o0e=b7(),l0e=sI(),c0e=aI(l0e),u0e=O7(),f0e=aI(u0e);function aI(e){return e&&e.__esModule?e:{default:e}}var d0e=/((?:\-[a-z]+\-)?calc)/;lw.default=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return(0,A7.default)(e).walk(function(r){if(!(r.type!=="function"||!d0e.test(r.value))){var n=A7.default.stringify(r.nodes);if(!(n.indexOf("constant")>=0||n.indexOf("env")>=0)){var i=o0e.parser.parse(n),s=(0,c0e.default)(i,t);r.type="word",r.value=(0,f0e.default)(r.value,s,t)}}},!0).toString()};T7.exports=lw.default});var uw=ce((q6e,q7)=>{var D0e=w2();function j0e(e,t){return D0e(e,t)}q7.exports=j0e});var uI=ce((V6e,V7)=>{var B0e=ku();function M0e(e,t,r){for(var n=-1,i=e.length;++n<i;){var s=e[n],a=t(s);if(a!=null&&(o===void 0?a===a&&!B0e(a):r(a,o)))var o=a,l=s}return l}V7.exports=M0e});var W7=ce((H6e,H7)=>{function R0e(e,t){return e>t}H7.exports=R0e});var G7=ce((W6e,J7)=>{var $0e=uI(),U0e=W7(),z0e=Iu();function q0e(e){return e&&e.length?$0e(e,z0e,U0e):void 0}J7.exports=q0e});var Y7=ce((J6e,K7)=>{function V0e(e,t){return e<t}K7.exports=V0e});var Z7=ce((G6e,X7)=>{var H0e=uI(),W0e=Y7(),J0e=Iu();function G0e(e){return e&&e.length?H0e(e,J0e,W0e):void 0}X7.exports=G0e});var eV=ce((K6e,Q7)=>{var K0e=Q0(),Y0e=Wo(),X0e=LC(),Z0e=Yr();function Q0e(e,t){var r=Z0e(e)?K0e:X0e;return r(e,Y0e(t,3))}Q7.exports=Q0e});var rV=ce((Y6e,tV)=>{var e2e=NC(),t2e=eV();function r2e(e,t){return e2e(t2e(e,t),1)}tV.exports=r2e});var WI=ce((kH,Jw)=>{(function(e){"use strict";var t=1e9,r={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},n=!0,i="[DecimalError] ",s=i+"Invalid argument: ",a=i+"Exponent out of range: ",o=Math.floor,l=Math.pow,c=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,f,u=1e7,d=7,p=9007199254740991,_=o(p/d),w={};w.absoluteValue=w.abs=function(){var F=new this.constructor(this);return F.s&&(F.s=1),F},w.comparedTo=w.cmp=function(F){var H,Q,R,$,q=this;if(F=new q.constructor(F),q.s!==F.s)return q.s||-F.s;if(q.e!==F.e)return q.e>F.e^q.s<0?1:-1;for(R=q.d.length,$=F.d.length,H=0,Q=R<$?R:$;H<Q;++H)if(q.d[H]!==F.d[H])return q.d[H]>F.d[H]^q.s<0?1:-1;return R===$?0:R>$^q.s<0?1:-1},w.decimalPlaces=w.dp=function(){var F=this,H=F.d.length-1,Q=(H-F.e)*d;if(H=F.d[H],H)for(;H%10==0;H/=10)Q--;return Q<0?0:Q},w.dividedBy=w.div=function(F){return A(this,new this.constructor(F))},w.dividedToIntegerBy=w.idiv=function(F){var H=this,Q=H.constructor;return V(A(H,new Q(F),0,1),Q.precision)},w.equals=w.eq=function(F){return!this.cmp(F)},w.exponent=function(){return I(this)},w.greaterThan=w.gt=function(F){return this.cmp(F)>0},w.greaterThanOrEqualTo=w.gte=function(F){return this.cmp(F)>=0},w.isInteger=w.isint=function(){return this.e>this.d.length-2},w.isNegative=w.isneg=function(){return this.s<0},w.isPositive=w.ispos=function(){return this.s>0},w.isZero=function(){return this.s===0},w.lessThan=w.lt=function(F){return this.cmp(F)<0},w.lessThanOrEqualTo=w.lte=function(F){return this.cmp(F)<1},w.logarithm=w.log=function(F){var H,Q=this,R=Q.constructor,$=R.precision,q=$+5;if(F===void 0)F=new R(10);else if(F=new R(F),F.s<1||F.eq(f))throw Error(i+"NaN");if(Q.s<1)throw Error(i+(Q.s?"NaN":"-Infinity"));return Q.eq(f)?new R(0):(n=!1,H=A(U(Q,q),U(F,q),q),n=!0,V(H,$))},w.minus=w.sub=function(F){var H=this;return F=new H.constructor(F),H.s==F.s?X(H,F):k(H,(F.s=-F.s,F))},w.modulo=w.mod=function(F){var H,Q=this,R=Q.constructor,$=R.precision;if(F=new R(F),!F.s)throw Error(i+"NaN");return Q.s?(n=!1,H=A(Q,F,0,1).times(F),n=!0,Q.minus(H)):V(new R(Q),$)},w.naturalExponential=w.exp=function(){return C(this)},w.naturalLogarithm=w.ln=function(){return U(this)},w.negated=w.neg=function(){var F=new this.constructor(this);return F.s=-F.s||0,F},w.plus=w.add=function(F){var H=this;return F=new H.constructor(F),H.s==F.s?k(H,F):X(H,(F.s=-F.s,F))},w.precision=w.sd=function(F){var H,Q,R,$=this;if(F!==void 0&&F!==!!F&&F!==1&&F!==0)throw Error(s+F);if(H=I($)+1,R=$.d.length-1,Q=R*d+1,R=$.d[R],R){for(;R%10==0;R/=10)Q--;for(R=$.d[0];R>=10;R/=10)Q++}return F&&H>Q?H:Q},w.squareRoot=w.sqrt=function(){var F,H,Q,R,$,q,ie,oe=this,fe=oe.constructor;if(oe.s<1){if(!oe.s)return new fe(0);throw Error(i+"NaN")}for(F=I(oe),n=!1,$=Math.sqrt(+oe),$==0||$==1/0?(H=O(oe.d),(H.length+F)%2==0&&(H+="0"),$=Math.sqrt(H),F=o((F+1)/2)-(F<0||F%2),$==1/0?H="5e"+F:(H=$.toExponential(),H=H.slice(0,H.indexOf("e")+1)+F),R=new fe(H)):R=new fe($.toString()),Q=fe.precision,$=ie=Q+3;;)if(q=R,R=q.plus(A(oe,q,ie+2)).times(.5),O(q.d).slice(0,ie)===(H=O(R.d)).slice(0,ie)){if(H=H.slice(ie-3,ie+1),$==ie&&H=="4999"){if(V(q,Q+1,0),q.times(q).eq(oe)){R=q;break}}else if(H!="9999")break;ie+=4}return n=!0,V(R,Q)},w.times=w.mul=function(F){var H,Q,R,$,q,ie,oe,fe,_e,Ee=this,Se=Ee.constructor,le=Ee.d,we=(F=new Se(F)).d;if(!Ee.s||!F.s)return new Se(0);for(F.s*=Ee.s,Q=Ee.e+F.e,fe=le.length,_e=we.length,fe<_e&&(q=le,le=we,we=q,ie=fe,fe=_e,_e=ie),q=[],ie=fe+_e,R=ie;R--;)q.push(0);for(R=_e;--R>=0;){for(H=0,$=fe+R;$>R;)oe=q[$]+we[R]*le[$-R-1]+H,q[$--]=oe%u|0,H=oe/u|0;q[$]=(q[$]+H)%u|0}for(;!q[--ie];)q.pop();return H?++Q:q.shift(),F.d=q,F.e=Q,n?V(F,Se.precision):F},w.toDecimalPlaces=w.todp=function(F,H){var Q=this,R=Q.constructor;return Q=new R(Q),F===void 0?Q:(S(F,0,t),H===void 0?H=R.rounding:S(H,0,8),V(Q,F+I(Q)+1,H))},w.toExponential=function(F,H){var Q,R=this,$=R.constructor;return F===void 0?Q=Z(R,!0):(S(F,0,t),H===void 0?H=$.rounding:S(H,0,8),R=V(new $(R),F+1,H),Q=Z(R,!0,F+1)),Q},w.toFixed=function(F,H){var Q,R,$=this,q=$.constructor;return F===void 0?Z($):(S(F,0,t),H===void 0?H=q.rounding:S(H,0,8),R=V(new q($),F+I($)+1,H),Q=Z(R.abs(),!1,F+I(R)+1),$.isneg()&&!$.isZero()?"-"+Q:Q)},w.toInteger=w.toint=function(){var F=this,H=F.constructor;return V(new H(F),I(F)+1,H.rounding)},w.toNumber=function(){return+this},w.toPower=w.pow=function(F){var H,Q,R,$,q,ie,oe=this,fe=oe.constructor,_e=12,Ee=+(F=new fe(F));if(!F.s)return new fe(f);if(oe=new fe(oe),!oe.s){if(F.s<1)throw Error(i+"Infinity");return oe}if(oe.eq(f))return oe;if(R=fe.precision,F.eq(f))return V(oe,R);if(H=F.e,Q=F.d.length-1,ie=H>=Q,q=oe.s,ie){if((Q=Ee<0?-Ee:Ee)<=p){for($=new fe(f),H=Math.ceil(R/d+4),n=!1;Q%2&&($=$.times(oe),se($.d,H)),Q=o(Q/2),Q!==0;)oe=oe.times(oe),se(oe.d,H);return n=!0,F.s<0?new fe(f).div($):V($,R)}}else if(q<0)throw Error(i+"NaN");return q=q<0&&F.d[Math.max(H,Q)]&1?-1:1,oe.s=1,n=!1,$=F.times(U(oe,R+_e)),n=!0,$=C($),$.s=q,$},w.toPrecision=function(F,H){var Q,R,$=this,q=$.constructor;return F===void 0?(Q=I($),R=Z($,Q<=q.toExpNeg||Q>=q.toExpPos)):(S(F,1,t),H===void 0?H=q.rounding:S(H,0,8),$=V(new q($),F,H),Q=I($),R=Z($,F<=Q||Q<=q.toExpNeg,F)),R},w.toSignificantDigits=w.tosd=function(F,H){var Q=this,R=Q.constructor;return F===void 0?(F=R.precision,H=R.rounding):(S(F,1,t),H===void 0?H=R.rounding:S(H,0,8)),V(new R(Q),F,H)},w.toString=w.valueOf=w.val=w.toJSON=function(){var F=this,H=I(F),Q=F.constructor;return Z(F,H<=Q.toExpNeg||H>=Q.toExpPos)};function k(F,H){var Q,R,$,q,ie,oe,fe,_e,Ee=F.constructor,Se=Ee.precision;if(!F.s||!H.s)return H.s||(H=new Ee(F)),n?V(H,Se):H;if(fe=F.d,_e=H.d,ie=F.e,$=H.e,fe=fe.slice(),q=ie-$,q){for(q<0?(R=fe,q=-q,oe=_e.length):(R=_e,$=ie,oe=fe.length),ie=Math.ceil(Se/d),oe=ie>oe?ie+1:oe+1,q>oe&&(q=oe,R.length=1),R.reverse();q--;)R.push(0);R.reverse()}for(oe=fe.length,q=_e.length,oe-q<0&&(q=oe,R=_e,_e=fe,fe=R),Q=0;q;)Q=(fe[--q]=fe[q]+_e[q]+Q)/u|0,fe[q]%=u;for(Q&&(fe.unshift(Q),++$),oe=fe.length;fe[--oe]==0;)fe.pop();return H.d=fe,H.e=$,n?V(H,Se):H}function S(F,H,Q){if(F!==~~F||F<H||F>Q)throw Error(s+F)}function O(F){var H,Q,R,$=F.length-1,q="",ie=F[0];if($>0){for(q+=ie,H=1;H<$;H++)R=F[H]+"",Q=d-R.length,Q&&(q+=L(Q)),q+=R;ie=F[H],R=ie+"",Q=d-R.length,Q&&(q+=L(Q))}else if(ie===0)return"0";for(;ie%10===0;)ie/=10;return q+ie}var A=function(){function F(R,$){var q,ie=0,oe=R.length;for(R=R.slice();oe--;)q=R[oe]*$+ie,R[oe]=q%u|0,ie=q/u|0;return ie&&R.unshift(ie),R}function H(R,$,q,ie){var oe,fe;if(q!=ie)fe=q>ie?1:-1;else for(oe=fe=0;oe<q;oe++)if(R[oe]!=$[oe]){fe=R[oe]>$[oe]?1:-1;break}return fe}function Q(R,$,q){for(var ie=0;q--;)R[q]-=ie,ie=R[q]<$[q]?1:0,R[q]=ie*u+R[q]-$[q];for(;!R[0]&&R.length>1;)R.shift()}return function(R,$,q,ie){var oe,fe,_e,Ee,Se,le,we,W,J,ne,Oe,Ne,Ce,Xe,Ze,kt,St,pt,ee=R.constructor,j=R.s==$.s?1:-1,B=R.d,re=$.d;if(!R.s)return new ee(R);if(!$.s)throw Error(i+"Division by zero");for(fe=R.e-$.e,St=re.length,Ze=B.length,we=new ee(j),W=we.d=[],_e=0;re[_e]==(B[_e]||0);)++_e;if(re[_e]>(B[_e]||0)&&--fe,q==null?Ne=q=ee.precision:ie?Ne=q+(I(R)-I($))+1:Ne=q,Ne<0)return new ee(0);if(Ne=Ne/d+2|0,_e=0,St==1)for(Ee=0,re=re[0],Ne++;(_e<Ze||Ee)&&Ne--;_e++)Ce=Ee*u+(B[_e]||0),W[_e]=Ce/re|0,Ee=Ce%re|0;else{for(Ee=u/(re[0]+1)|0,Ee>1&&(re=F(re,Ee),B=F(B,Ee),St=re.length,Ze=B.length),Xe=St,J=B.slice(0,St),ne=J.length;ne<St;)J[ne++]=0;pt=re.slice(),pt.unshift(0),kt=re[0],re[1]>=u/2&&++kt;do Ee=0,oe=H(re,J,St,ne),oe<0?(Oe=J[0],St!=ne&&(Oe=Oe*u+(J[1]||0)),Ee=Oe/kt|0,Ee>1?(Ee>=u&&(Ee=u-1),Se=F(re,Ee),le=Se.length,ne=J.length,oe=H(Se,J,le,ne),oe==1&&(Ee--,Q(Se,St<le?pt:re,le))):(Ee==0&&(oe=Ee=1),Se=re.slice()),le=Se.length,le<ne&&Se.unshift(0),Q(J,Se,ne),oe==-1&&(ne=J.length,oe=H(re,J,St,ne),oe<1&&(Ee++,Q(J,St<ne?pt:re,ne))),ne=J.length):oe===0&&(Ee++,J=[0]),W[_e++]=Ee,oe&&J[0]?J[ne++]=B[Xe]||0:(J=[B[Xe]],ne=1);while((Xe++<Ze||J[0]!==void 0)&&Ne--)}return W[0]||W.shift(),we.e=fe,V(we,ie?q+I(we)+1:q)}}();function C(F,H){var Q,R,$,q,ie,oe,fe=0,_e=0,Ee=F.constructor,Se=Ee.precision;if(I(F)>16)throw Error(a+I(F));if(!F.s)return new Ee(f);for(H==null?(n=!1,oe=Se):oe=H,ie=new Ee(.03125);F.abs().gte(.1);)F=F.times(ie),_e+=5;for(R=Math.log(l(2,_e))/Math.LN10*2+5|0,oe+=R,Q=$=q=new Ee(f),Ee.precision=oe;;){if($=V($.times(F),oe),Q=Q.times(++fe),ie=q.plus(A($,Q,oe)),O(ie.d).slice(0,oe)===O(q.d).slice(0,oe)){for(;_e--;)q=V(q.times(q),oe);return Ee.precision=Se,H==null?(n=!0,V(q,Se)):q}q=ie}}function I(F){for(var H=F.e*d,Q=F.d[0];Q>=10;Q/=10)H++;return H}function D(F,H,Q){if(H>F.LN10.sd())throw n=!0,Q&&(F.precision=Q),Error(i+"LN10 precision limit exceeded");return V(new F(F.LN10),H)}function L(F){for(var H="";F--;)H+="0";return H}function U(F,H){var Q,R,$,q,ie,oe,fe,_e,Ee,Se=1,le=10,we=F,W=we.d,J=we.constructor,ne=J.precision;if(we.s<1)throw Error(i+(we.s?"NaN":"-Infinity"));if(we.eq(f))return new J(0);if(H==null?(n=!1,_e=ne):_e=H,we.eq(10))return H==null&&(n=!0),D(J,_e);if(_e+=le,J.precision=_e,Q=O(W),R=Q.charAt(0),q=I(we),Math.abs(q)<15e14){for(;R<7&&R!=1||R==1&&Q.charAt(1)>3;)we=we.times(F),Q=O(we.d),R=Q.charAt(0),Se++;q=I(we),R>1?(we=new J("0."+Q),q++):we=new J(R+"."+Q.slice(1))}else return fe=D(J,_e+2,ne).times(q+""),we=U(new J(R+"."+Q.slice(1)),_e-le).plus(fe),J.precision=ne,H==null?(n=!0,V(we,ne)):we;for(oe=ie=we=A(we.minus(f),we.plus(f),_e),Ee=V(we.times(we),_e),$=3;;){if(ie=V(ie.times(Ee),_e),fe=oe.plus(A(ie,new J($),_e)),O(fe.d).slice(0,_e)===O(oe.d).slice(0,_e))return oe=oe.times(2),q!==0&&(oe=oe.plus(D(J,_e+2,ne).times(q+""))),oe=A(oe,new J(Se),_e),J.precision=ne,H==null?(n=!0,V(oe,ne)):oe;oe=fe,$+=2}}function te(F,H){var Q,R,$;for((Q=H.indexOf("."))>-1&&(H=H.replace(".","")),(R=H.search(/e/i))>0?(Q<0&&(Q=R),Q+=+H.slice(R+1),H=H.substring(0,R)):Q<0&&(Q=H.length),R=0;H.charCodeAt(R)===48;)++R;for($=H.length;H.charCodeAt($-1)===48;)--$;if(H=H.slice(R,$),H){if($-=R,Q=Q-R-1,F.e=o(Q/d),F.d=[],R=(Q+1)%d,Q<0&&(R+=d),R<$){for(R&&F.d.push(+H.slice(0,R)),$-=d;R<$;)F.d.push(+H.slice(R,R+=d));H=H.slice(R),R=d-H.length}else R-=$;for(;R--;)H+="0";if(F.d.push(+H),n&&(F.e>_||F.e<-_))throw Error(a+Q)}else F.s=0,F.e=0,F.d=[0];return F}function V(F,H,Q){var R,$,q,ie,oe,fe,_e,Ee,Se=F.d;for(ie=1,q=Se[0];q>=10;q/=10)ie++;if(R=H-ie,R<0)R+=d,$=H,_e=Se[Ee=0];else{if(Ee=Math.ceil((R+1)/d),q=Se.length,Ee>=q)return F;for(_e=q=Se[Ee],ie=1;q>=10;q/=10)ie++;R%=d,$=R-d+ie}if(Q!==void 0&&(q=l(10,ie-$-1),oe=_e/q%10|0,fe=H<0||Se[Ee+1]!==void 0||_e%q,fe=Q<4?(oe||fe)&&(Q==0||Q==(F.s<0?3:2)):oe>5||oe==5&&(Q==4||fe||Q==6&&(R>0?$>0?_e/l(10,ie-$):0:Se[Ee-1])%10&1||Q==(F.s<0?8:7))),H<1||!Se[0])return fe?(q=I(F),Se.length=1,H=H-q-1,Se[0]=l(10,(d-H%d)%d),F.e=o(-H/d)||0):(Se.length=1,Se[0]=F.e=F.s=0),F;if(R==0?(Se.length=Ee,q=1,Ee--):(Se.length=Ee+1,q=l(10,d-R),Se[Ee]=$>0?(_e/l(10,ie-$)%l(10,$)|0)*q:0),fe)for(;;)if(Ee==0){(Se[0]+=q)==u&&(Se[0]=1,++F.e);break}else{if(Se[Ee]+=q,Se[Ee]!=u)break;Se[Ee--]=0,q=1}for(R=Se.length;Se[--R]===0;)Se.pop();if(n&&(F.e>_||F.e<-_))throw Error(a+I(F));return F}function X(F,H){var Q,R,$,q,ie,oe,fe,_e,Ee,Se,le=F.constructor,we=le.precision;if(!F.s||!H.s)return H.s?H.s=-H.s:H=new le(F),n?V(H,we):H;if(fe=F.d,Se=H.d,R=H.e,_e=F.e,fe=fe.slice(),ie=_e-R,ie){for(Ee=ie<0,Ee?(Q=fe,ie=-ie,oe=Se.length):(Q=Se,R=_e,oe=fe.length),$=Math.max(Math.ceil(we/d),oe)+2,ie>$&&(ie=$,Q.length=1),Q.reverse(),$=ie;$--;)Q.push(0);Q.reverse()}else{for($=fe.length,oe=Se.length,Ee=$<oe,Ee&&(oe=$),$=0;$<oe;$++)if(fe[$]!=Se[$]){Ee=fe[$]<Se[$];break}ie=0}for(Ee&&(Q=fe,fe=Se,Se=Q,H.s=-H.s),oe=fe.length,$=Se.length-oe;$>0;--$)fe[oe++]=0;for($=Se.length;$>ie;){if(fe[--$]<Se[$]){for(q=$;q&&fe[--q]===0;)fe[q]=u-1;--fe[q],fe[$]+=u}fe[$]-=Se[$]}for(;fe[--oe]===0;)fe.pop();for(;fe[0]===0;fe.shift())--R;return fe[0]?(H.d=fe,H.e=R,n?V(H,we):H):new le(0)}function Z(F,H,Q){var R,$=I(F),q=O(F.d),ie=q.length;return H?(Q&&(R=Q-ie)>0?q=q.charAt(0)+"."+q.slice(1)+L(R):ie>1&&(q=q.charAt(0)+"."+q.slice(1)),q=q+($<0?"e":"e+")+$):$<0?(q="0."+L(-$-1)+q,Q&&(R=Q-ie)>0&&(q+=L(R))):$>=ie?(q+=L($+1-ie),Q&&(R=Q-$-1)>0&&(q=q+"."+L(R))):((R=$+1)<ie&&(q=q.slice(0,R)+"."+q.slice(R)),Q&&(R=Q-ie)>0&&($+1===ie&&(q+="."),q+=L(R))),F.s<0?"-"+q:q}function se(F,H){if(F.length>H)return F.length=H,!0}function pe(F){var H,Q,R;function $(q){var ie=this;if(!(ie instanceof $))return new $(q);if(ie.constructor=$,q instanceof $){ie.s=q.s,ie.e=q.e,ie.d=(q=q.d)?q.slice():q;return}if(typeof q=="number"){if(q*0!==0)throw Error(s+q);if(q>0)ie.s=1;else if(q<0)q=-q,ie.s=-1;else{ie.s=0,ie.e=0,ie.d=[0];return}if(q===~~q&&q<1e7){ie.e=0,ie.d=[q];return}return te(ie,q.toString())}else if(typeof q!="string")throw Error(s+q);if(q.charCodeAt(0)===45?(q=q.slice(1),ie.s=-1):ie.s=1,c.test(q))te(ie,q);else throw Error(s+q)}if($.prototype=w,$.ROUND_UP=0,$.ROUND_DOWN=1,$.ROUND_CEIL=2,$.ROUND_FLOOR=3,$.ROUND_HALF_UP=4,$.ROUND_HALF_DOWN=5,$.ROUND_HALF_EVEN=6,$.ROUND_HALF_CEIL=7,$.ROUND_HALF_FLOOR=8,$.clone=pe,$.config=$.set=de,F===void 0&&(F={}),F)for(R=["precision","rounding","toExpNeg","toExpPos","LN10"],H=0;H<R.length;)F.hasOwnProperty(Q=R[H++])||(F[Q]=this[Q]);return $.config(F),$}function de(F){if(!F||typeof F!="object")throw Error(i+"Object expected");var H,Q,R,$=["precision",1,t,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(H=0;H<$.length;H+=3)if((R=F[Q=$[H]])!==void 0)if(o(R)===R&&R>=$[H+1]&&R<=$[H+2])this[Q]=R;else throw Error(s+Q+": "+R);if((R=F[Q="LN10"])!==void 0)if(R==Math.LN10)this[Q]=new this(R);else throw Error(s+Q+": "+R);return this}r=pe(r),r.default=r.Decimal=r,f=new r(1),typeof define=="function"&&define.amd?define(function(){return r}):typeof Jw<"u"&&Jw.exports?Jw.exports=r:(e||(e=typeof self<"u"&&self&&self.self==self?self:Function("return this")()),e.Decimal=r)})(kH)});var oW=ce((vqe,aW)=>{function xSe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}aW.exports=xSe});var MW=ce((qqe,BW)=>{var mxe=Math.ceil,bxe=Math.max;function vxe(e,t,r,n){for(var i=-1,s=bxe(mxe((t-e)/(r||1)),0),a=Array(s);s--;)a[n?s:++i]=e,e+=r;return a}BW.exports=vxe});var AN=ce((Vqe,$W)=>{var _xe=zC(),RW=1/0,wxe=17976931348623157e292;function Sxe(e){if(!e)return e===0?e:0;if(e=_xe(e),e===RW||e===-RW){var t=e<0?-1:1;return t*wxe}return e===e?e:0}$W.exports=Sxe});var zW=ce((Hqe,UW)=>{var xxe=MW(),kxe=im(),TN=AN();function Exe(e){return function(t,r,n){return n&&typeof n!="number"&&kxe(t,r,n)&&(r=n=void 0),t=TN(t),r===void 0?(r=t,t=0):r=TN(r),n=n===void 0?t<r?1:-1:TN(n),xxe(t,r,n,e)}}UW.exports=Exe});var CN=ce((Wqe,qW)=>{var Oxe=zW(),Axe=Oxe();qW.exports=Axe});var tJ=ce((r7e,eJ)=>{var Rxe=Y2();function $xe(e,t){var r;return Rxe(e,function(n,i,s){return r=t(n,i,s),!r}),!!r}eJ.exports=$xe});var nJ=ce((n7e,rJ)=>{var Uxe=KA(),zxe=Wo(),qxe=tJ(),Vxe=Yr(),Hxe=im();function Wxe(e,t,r){var n=Vxe(e)?Uxe:qxe;return r&&Hxe(e,t,r)&&(t=void 0),n(e,zxe(t,3))}rJ.exports=Wxe});var sJ=ce((s7e,iJ)=>{function Jxe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}iJ.exports=Jxe});var oJ=ce((a7e,aJ)=>{var Gxe=Y2();function Kxe(e,t){var r=!0;return Gxe(e,function(n,i,s){return r=!!t(n,i,s),r}),r}aJ.exports=Kxe});var LN=ce((o7e,lJ)=>{var Yxe=sJ(),Xxe=oJ(),Zxe=Wo(),Qxe=Yr(),eke=im();function tke(e,t,r){var n=Qxe(e)?Yxe:Xxe;return r&&eke(e,t,r)&&(t=void 0),n(e,Zxe(t,3))}lJ.exports=tke});var fJ=ce((l7e,uJ)=>{var cJ=DC();function rke(e,t,r){t=="__proto__"&&cJ?cJ(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}uJ.exports=rke});var pJ=ce((c7e,dJ)=>{var nke=fJ(),ike=PC(),ske=Wo();function ake(e,t){var r={};return t=ske(t,3),ike(e,function(n,i,s){nke(r,i,t(n,i,s))}),r}dJ.exports=ake});var nG=ce((IVe,rG)=>{var AEe=Wo(),TEe=Xd(),CEe=Uy();function IEe(e){return function(t,r,n){var i=Object(t);if(!TEe(t)){var s=AEe(r,3);t=CEe(t),r=function(o){return s(i[o],o,i)}}var a=e(t,r,n);return a>-1?i[s?t[a]:a]:void 0}}rG.exports=IEe});var sG=ce((NVe,iG)=>{var NEe=AN();function PEe(e){var t=NEe(e),r=t%1;return t===t?r?t-r:t:0}iG.exports=PEe});var oG=ce((PVe,aG)=>{var LEe=pT(),FEe=Wo(),DEe=sG(),jEe=Math.max;function BEe(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var i=r==null?0:DEe(r);return i<0&&(i=jEe(n+i,0)),LEe(e,FEe(t,3),i)}aG.exports=BEe});var cG=ce((LVe,lG)=>{var MEe=nG(),REe=oG(),$Ee=MEe(REe);lG.exports=$Ee});var fG=ce((FVe,uG)=>{var UEe=Uo(),zEe=zo(),qEe="[object Boolean]";function VEe(e){return e===!0||e===!1||zEe(e)&&UEe(e)==qEe}uG.exports=VEe});var hG=ce((zVe,XN)=>{"use strict";var KEe=Object.prototype.hasOwnProperty,Fi="~";function ob(){}Object.create&&(ob.prototype=Object.create(null),new ob().__proto__||(Fi=!1));function YEe(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function pG(e,t,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new YEe(r,n||e,i),a=Fi?Fi+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],s]:e._events[a].push(s):(e._events[a]=s,e._eventsCount++),e}function T1(e,t){--e._eventsCount===0?e._events=new ob:delete e._events[t]}function di(){this._events=new ob,this._eventsCount=0}di.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)KEe.call(r,n)&&t.push(Fi?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};di.prototype.listeners=function(t){var r=Fi?Fi+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,a=new Array(s);i<s;i++)a[i]=n[i].fn;return a};di.prototype.listenerCount=function(t){var r=Fi?Fi+t:t,n=this._events[r];return n?n.fn?1:n.length:0};di.prototype.emit=function(t,r,n,i,s,a){var o=Fi?Fi+t:t;if(!this._events[o])return!1;var l=this._events[o],c=arguments.length,f,u;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,r),!0;case 3:return l.fn.call(l.context,r,n),!0;case 4:return l.fn.call(l.context,r,n,i),!0;case 5:return l.fn.call(l.context,r,n,i,s),!0;case 6:return l.fn.call(l.context,r,n,i,s,a),!0}for(u=1,f=new Array(c-1);u<c;u++)f[u-1]=arguments[u];l.fn.apply(l.context,f)}else{var d=l.length,p;for(u=0;u<d;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,r);break;case 3:l[u].fn.call(l[u].context,r,n);break;case 4:l[u].fn.call(l[u].context,r,n,i);break;default:if(!f)for(p=1,f=new Array(c-1);p<c;p++)f[p-1]=arguments[p];l[u].fn.apply(l[u].context,f)}}return!0};di.prototype.on=function(t,r,n){return pG(this,t,r,n,!1)};di.prototype.once=function(t,r,n){return pG(this,t,r,n,!0)};di.prototype.removeListener=function(t,r,n,i){var s=Fi?Fi+t:t;if(!this._events[s])return this;if(!r)return T1(this,s),this;var a=this._events[s];if(a.fn)a.fn===r&&(!i||a.once)&&(!n||a.context===n)&&T1(this,s);else{for(var o=0,l=[],c=a.length;o<c;o++)(a[o].fn!==r||i&&!a[o].once||n&&a[o].context!==n)&&l.push(a[o]);l.length?this._events[s]=l.length===1?l[0]:l:T1(this,s)}return this};di.prototype.removeAllListeners=function(t){var r;return t?(r=Fi?Fi+t:t,this._events[r]&&T1(this,r)):(this._events=new ob,this._eventsCount=0),this};di.prototype.off=di.prototype.removeListener;di.prototype.addListener=di.prototype.on;di.prefixed=Fi;di.EventEmitter=di;typeof XN<"u"&&(XN.exports=di)});var S3e,x3e,YZ,gZe,yZe,jh,iv,k3e,E3e,O3e,Tc,ex,mZe,Bh,GZ,KZ,EL,bZe,A3e,T3e,C3e,I3e,OL,vZe,tx=Gv(()=>{S3e=e=>{let t=new Map;t.set("web",{name:"web"});let r=e.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:t},n=(s,a)=>{r.platforms.set(s,a)},i=s=>{r.platforms.has(s)&&(r.currentPlatform=r.platforms.get(s))};return r.addPlatform=n,r.setPlatform=i,r},x3e=e=>e.CapacitorPlatforms=S3e(e),YZ=x3e(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),gZe=YZ.addPlatform,yZe=YZ.setPlatform;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(jh||(jh={}));iv=class extends Error{constructor(t,r,n){super(t),this.message=t,this.code=r,this.data=n}},k3e=e=>{var t,r;return e?.androidBridge?"android":!((r=(t=e?.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},E3e=e=>{var t,r,n,i,s;let a=e.CapacitorCustomPlatform||null,o=e.Capacitor||{},l=o.Plugins=o.Plugins||{},c=e.CapacitorPlatforms,f=()=>a!==null?a.name:k3e(e),u=((t=c?.currentPlatform)===null||t===void 0?void 0:t.getPlatform)||f,d=()=>u()!=="web",p=((r=c?.currentPlatform)===null||r===void 0?void 0:r.isNativePlatform)||d,_=L=>{let U=C.get(L);return!!(U?.platforms.has(u())||S(L))},w=((n=c?.currentPlatform)===null||n===void 0?void 0:n.isPluginAvailable)||_,k=L=>{var U;return(U=o.PluginHeaders)===null||U===void 0?void 0:U.find(te=>te.name===L)},S=((i=c?.currentPlatform)===null||i===void 0?void 0:i.getPluginHeader)||k,O=L=>e.console.error(L),A=(L,U,te)=>Promise.reject(`${te} does not have an implementation of "${U}".`),C=new Map,I=(L,U={})=>{let te=C.get(L);if(te)return console.warn(`Capacitor plugin "${L}" already registered. Cannot register plugins twice.`),te.proxy;let V=u(),X=S(L),Z,se=async()=>(!Z&&V in U?Z=typeof U[V]=="function"?Z=await U[V]():Z=U[V]:a!==null&&!Z&&"web"in U&&(Z=typeof U.web=="function"?Z=await U.web():Z=U.web),Z),pe=($,q)=>{var ie,oe;if(X){let fe=X?.methods.find(_e=>q===_e.name);if(fe)return fe.rtype==="promise"?_e=>o.nativePromise(L,q.toString(),_e):(_e,Ee)=>o.nativeCallback(L,q.toString(),_e,Ee);if($)return(ie=$[q])===null||ie===void 0?void 0:ie.bind($)}else{if($)return(oe=$[q])===null||oe===void 0?void 0:oe.bind($);throw new iv(`"${L}" plugin is not implemented on ${V}`,jh.Unimplemented)}},de=$=>{let q,ie=(...oe)=>{let fe=se().then(_e=>{let Ee=pe(_e,$);if(Ee){let Se=Ee(...oe);return q=Se?.remove,Se}else throw new iv(`"${L}.${$}()" is not implemented on ${V}`,jh.Unimplemented)});return $==="addListener"&&(fe.remove=async()=>q()),fe};return ie.toString=()=>`${$.toString()}() { [capacitor code] }`,Object.defineProperty(ie,"name",{value:$,writable:!1,configurable:!1}),ie},F=de("addListener"),H=de("removeListener"),Q=($,q)=>{let ie=F({eventName:$},q),oe=async()=>{let _e=await ie;H({eventName:$,callbackId:_e},q)},fe=new Promise(_e=>ie.then(()=>_e({remove:oe})));return fe.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await oe()},fe},R=new Proxy({},{get($,q){switch(q){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return X?Q:F;case"removeListener":return H;default:return de(q)}}});return l[L]=R,C.set(L,{name:L,proxy:R,platforms:new Set([...Object.keys(U),...X?[V]:[]])}),R},D=((s=c?.currentPlatform)===null||s===void 0?void 0:s.registerPlugin)||I;return o.convertFileSrc||(o.convertFileSrc=L=>L),o.getPlatform=u,o.handleError=O,o.isNativePlatform=p,o.isPluginAvailable=w,o.pluginMethodNoop=A,o.registerPlugin=D,o.Exception=iv,o.DEBUG=!!o.DEBUG,o.isLoggingEnabled=!!o.isLoggingEnabled,o.platform=o.getPlatform(),o.isNative=o.isNativePlatform(),o},O3e=e=>e.Capacitor=E3e(e),Tc=O3e(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),ex=Tc.registerPlugin,mZe=Tc.Plugins,Bh=class{constructor(t){this.listeners={},this.windowListeners={},t&&(console.warn(`Capacitor WebPlugin "${t.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=t)}addListener(t,r){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(r);let i=this.windowListeners[t];i&&!i.registered&&this.addWindowListener(i);let s=async()=>this.removeListener(t,r),a=Promise.resolve({remove:s});return Object.defineProperty(a,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await s()}}),a}async removeAllListeners(){this.listeners={};for(let t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,r){let n=this.listeners[t];n&&n.forEach(i=>i(r))}hasListeners(t){return!!this.listeners[t].length}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:n=>{this.notifyListeners(r,n)}}}unimplemented(t="not implemented"){return new Tc.Exception(t,jh.Unimplemented)}unavailable(t="not available"){return new Tc.Exception(t,jh.Unavailable)}async removeListener(t,r){let n=this.listeners[t];if(!n)return;let i=n.indexOf(r);this.listeners[t].splice(i,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}},GZ=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),KZ=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent),EL=class extends Bh{async getCookies(){let t=document.cookie,r={};return t.split(";").forEach(n=>{if(n.length<=0)return;let[i,s]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=KZ(i).trim(),s=KZ(s).trim(),r[i]=s}),r}async setCookie(t){try{let r=GZ(t.key),n=GZ(t.value),i=`; expires=${(t.expires||"").replace("expires=","")}`,s=(t.path||"/").replace("path=",""),a=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${n||""}${i}; path=${s}; ${a};`}catch(r){return Promise.reject(r)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{let t=document.cookie.split(";")||[];for(let r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}},bZe=ex("CapacitorCookies",{web:()=>new EL}),A3e=async e=>new Promise((t,r)=>{let n=new FileReader;n.onload=()=>{let i=n.result;t(i.indexOf(",")>=0?i.split(",")[1]:i)},n.onerror=i=>r(i),n.readAsDataURL(e)}),T3e=(e={})=>{let t=Object.keys(e);return Object.keys(e).map(i=>i.toLocaleLowerCase()).reduce((i,s,a)=>(i[s]=e[t[a]],i),{})},C3e=(e,t=!0)=>e?Object.entries(e).reduce((n,i)=>{let[s,a]=i,o,l;return Array.isArray(a)?(l="",a.forEach(c=>{o=t?encodeURIComponent(c):c,l+=`${s}=${o}&`}),l.slice(0,-1)):(o=t?encodeURIComponent(a):a,l=`${s}=${o}`),`${n}&${l}`},"").substr(1):null,I3e=(e,t={})=>{let r=Object.assign({method:e.method||"GET",headers:e.headers},t),i=T3e(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(i.includes("application/x-www-form-urlencoded")){let s=new URLSearchParams;for(let[a,o]of Object.entries(e.data||{}))s.set(a,o);r.body=s.toString()}else if(i.includes("multipart/form-data")){let s=new FormData;if(e.data instanceof FormData)e.data.forEach((o,l)=>{s.append(l,o)});else for(let o of Object.keys(e.data))s.append(o,e.data[o]);r.body=s;let a=new Headers(r.headers);a.delete("content-type"),r.headers=a}else(i.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r},OL=class extends Bh{async request(t){let r=I3e(t,t.webFetchExtra),n=C3e(t.params,t.shouldEncodeUrlParams),i=n?`${t.url}?${n}`:t.url,s=await fetch(i,r),a=s.headers.get("content-type")||"",{responseType:o="text"}=s.ok?t:{};a.includes("application/json")&&(o="json");let l,c;switch(o){case"arraybuffer":case"blob":c=await s.blob(),l=await A3e(c);break;case"json":l=await s.json();break;case"document":case"text":default:l=await s.text()}let f={};return s.headers.forEach((u,d)=>{f[d]=u}),{data:l,headers:f,status:s.status,url:s.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}},vZe=ex("CapacitorHttp",{web:()=>new OL})});function N3e(e){return new DataView(Uint8Array.from(e).buffer)}function P3e(e){return Array.from(new Uint8Array(e.buffer))}function L3e(e){return`0000${e.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}function Mh(e){let t=e.trim().split(" ").filter(r=>r!=="").map(r=>parseInt(r,16));return N3e(t)}function rx(e){return P3e(e).map(t=>{let r=t.toString(16);return r.length==1&&(r="0"+r),r}).join(" ")}function XZ(e){if(typeof e=="string")return e;if(typeof e=="number")return L3e(e);throw new Error("Invalid UUID")}function AL(e){let t={};if(e)return e.forEach((r,n)=>{t[n.toString()]=r}),t}var nx=Gv(()=>{});async function ZZ(e,t,r){let n;return Promise.race([e,new Promise((i,s)=>{n=setTimeout(()=>s(r),t)})]).finally(()=>clearTimeout(n))}var QZ=Gv(()=>{});var eQ={};_D(eQ,{BluetoothLeWeb:()=>TL});var TL,tQ=Gv(()=>{tx();nx();QZ();TL=class extends Bh{constructor(){super(...arguments),this.deviceMap=new Map,this.discoveredDevices=new Map,this.scan=null,this.DEFAULT_CONNECTION_TIMEOUT=1e4,this.onAdvertisementReceivedCallback=this.onAdvertisementReceived.bind(this),this.onDisconnectedCallback=this.onDisconnected.bind(this),this.onCharacteristicValueChangedCallback=this.onCharacteristicValueChanged.bind(this)}async initialize(){if(typeof navigator>"u"||!navigator.bluetooth)throw this.unavailable("Web Bluetooth API not available in this browser.");if(!await navigator.bluetooth.getAvailability())throw this.unavailable("No Bluetooth radio available.")}async isEnabled(){return{value:!0}}async enable(){throw this.unavailable("enable is not available on web.")}async disable(){throw this.unavailable("disable is not available on web.")}async startEnabledNotifications(){}async stopEnabledNotifications(){}async isLocationEnabled(){throw this.unavailable("isLocationEnabled is not available on web.")}async openLocationSettings(){throw this.unavailable("openLocationSettings is not available on web.")}async openBluetoothSettings(){throw this.unavailable("openBluetoothSettings is not available on web.")}async openAppSettings(){throw this.unavailable("openAppSettings is not available on web.")}async setDisplayStrings(){}async requestDevice(t){let r=this.getFilters(t),n=await navigator.bluetooth.requestDevice({filters:r.length?r:void 0,optionalServices:t?.optionalServices,acceptAllDevices:r.length===0});return this.deviceMap.set(n.id,n),this.getBleDevice(n)}async requestLEScan(t){this.requestBleDeviceOptions=t;let r=this.getFilters(t);await this.stopLEScan(),this.discoveredDevices=new Map,navigator.bluetooth.removeEventListener("advertisementreceived",this.onAdvertisementReceivedCallback),navigator.bluetooth.addEventListener("advertisementreceived",this.onAdvertisementReceivedCallback),this.scan=await navigator.bluetooth.requestLEScan({filters:r.length?r:void 0,acceptAllAdvertisements:r.length===0,keepRepeatedDevices:t?.allowDuplicates})}onAdvertisementReceived(t){var r,n;let i=t.device.id;if(this.deviceMap.set(i,t.device),!this.discoveredDevices.has(i)||!((r=this.requestBleDeviceOptions)===null||r===void 0)&&r.allowDuplicates){this.discoveredDevices.set(i,!0);let a=this.getBleDevice(t.device),o={device:a,localName:a.name,rssi:t.rssi,txPower:t.txPower,manufacturerData:AL(t.manufacturerData),serviceData:AL(t.serviceData),uuids:(n=t.uuids)===null||n===void 0?void 0:n.map(XZ)};this.notifyListeners("onScanResult",o)}}async stopLEScan(){var t;!((t=this.scan)===null||t===void 0)&&t.active&&this.scan.stop(),this.scan=null}async getDevices(t){return{devices:(await navigator.bluetooth.getDevices()).filter(i=>t.deviceIds.includes(i.id)).map(i=>(this.deviceMap.set(i.id,i),this.getBleDevice(i)))}}async getConnectedDevices(t){return{devices:(await navigator.bluetooth.getDevices()).filter(i=>{var s;return(s=i.gatt)===null||s===void 0?void 0:s.connected}).map(i=>(this.deviceMap.set(i.id,i),this.getBleDevice(i)))}}async connect(t){var r,n;let i=this.getDeviceFromMap(t.deviceId);i.removeEventListener("gattserverdisconnected",this.onDisconnectedCallback),i.addEventListener("gattserverdisconnected",this.onDisconnectedCallback);let s=Symbol();if(i.gatt===void 0)throw new Error("No gatt server available.");try{let a=(r=t.timeout)!==null&&r!==void 0?r:this.DEFAULT_CONNECTION_TIMEOUT;await ZZ(i.gatt.connect(),a,s)}catch(a){throw await((n=i.gatt)===null||n===void 0?void 0:n.disconnect()),a===s?new Error("Connection timeout"):a}}onDisconnected(t){let n=`disconnected|${t.target.id}`;this.notifyListeners(n,null)}async createBond(t){throw this.unavailable("createBond is not available on web.")}async isBonded(t){throw this.unavailable("isBonded is not available on web.")}async disconnect(t){var r;(r=this.getDeviceFromMap(t.deviceId).gatt)===null||r===void 0||r.disconnect()}async getServices(t){var r,n;let i=(n=await((r=this.getDeviceFromMap(t.deviceId).gatt)===null||r===void 0?void 0:r.getPrimaryServices()))!==null&&n!==void 0?n:[],s=[];for(let a of i){let o=await a.getCharacteristics(),l=[];for(let c of o)l.push({uuid:c.uuid,properties:this.getProperties(c),descriptors:await this.getDescriptors(c)});s.push({uuid:a.uuid,characteristics:l})}return{services:s}}async getDescriptors(t){try{return(await t.getDescriptors()).map(n=>({uuid:n.uuid}))}catch{return[]}}getProperties(t){return{broadcast:t.properties.broadcast,read:t.properties.read,writeWithoutResponse:t.properties.writeWithoutResponse,write:t.properties.write,notify:t.properties.notify,indicate:t.properties.indicate,authenticatedSignedWrites:t.properties.authenticatedSignedWrites,reliableWrite:t.properties.reliableWrite,writableAuxiliaries:t.properties.writableAuxiliaries}}async getCharacteristic(t){var r;let n=await((r=this.getDeviceFromMap(t.deviceId).gatt)===null||r===void 0?void 0:r.getPrimaryService(t?.service));return n?.getCharacteristic(t?.characteristic)}async getDescriptor(t){let r=await this.getCharacteristic(t);return r?.getDescriptor(t?.descriptor)}async discoverServices(t){throw this.unavailable("discoverServices is not available on web.")}async getMtu(t){throw this.unavailable("getMtu is not available on web.")}async requestConnectionPriority(t){throw this.unavailable("requestConnectionPriority is not available on web.")}async readRssi(t){throw this.unavailable("readRssi is not available on web.")}async read(t){let r=await this.getCharacteristic(t);return{value:await r?.readValue()}}async write(t){let r=await this.getCharacteristic(t),n;typeof t.value=="string"?n=Mh(t.value):n=t.value,await r?.writeValueWithResponse(n)}async writeWithoutResponse(t){let r=await this.getCharacteristic(t),n;typeof t.value=="string"?n=Mh(t.value):n=t.value,await r?.writeValueWithoutResponse(n)}async readDescriptor(t){let r=await this.getDescriptor(t);return{value:await r?.readValue()}}async writeDescriptor(t){let r=await this.getDescriptor(t),n;typeof t.value=="string"?n=Mh(t.value):n=t.value,await r?.writeValue(n)}async startNotifications(t){let r=await this.getCharacteristic(t);r?.removeEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback),r?.addEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback),await r?.startNotifications()}onCharacteristicValueChanged(t){var r,n;let i=t.target,s=`notification|${(r=i.service)===null||r===void 0?void 0:r.device.id}|${(n=i.service)===null||n===void 0?void 0:n.uuid}|${i.uuid}`;this.notifyListeners(s,{value:i.value})}async stopNotifications(t){let r=await this.getCharacteristic(t);await r?.stopNotifications()}getFilters(t){var r;let n=[];for(let i of(r=t?.services)!==null&&r!==void 0?r:[])n.push({services:[i],name:t?.name,namePrefix:t?.namePrefix});return(t?.name||t?.namePrefix)&&n.length===0&&n.push({name:t.name,namePrefix:t.namePrefix}),n}getDeviceFromMap(t){let r=this.deviceMap.get(t);if(r===void 0)throw new Error('Device not found. Call "requestDevice", "requestLEScan" or "getDevices" first.');return r}getBleDevice(t){var r;return{deviceId:t.id,name:(r=t.name)!==null&&r!==void 0?r:void 0}}}});var Tee=ae(Je(),1),Cee=ae(eR(),1);var m0={services:{csgo:"./services/csgo/index.ts"},plugins:{bluetooth:!0},electron:{window:{width:1200}}};var Vne=Object.create,tR=Object.defineProperty,Hne=Object.getOwnPropertyDescriptor,rR=Object.getOwnPropertyNames,Wne=Object.getPrototypeOf,Jne=Object.prototype.hasOwnProperty,Gne=(e,t)=>function(){return t||(0,e[rR(e)[0]])((t={exports:{}}).exports,t),t.exports},Kne=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of rR(t))!Jne.call(e,i)&&i!==r&&tR(e,i,{get:()=>t[i],enumerable:!(n=Hne(t,i))||n.enumerable});return e},Yne=(e,t,r)=>(r=e!=null?Vne(Wne(e)):{},Kne(t||!e||!e.__esModule?tR(r,"default",{value:e,enumerable:!0}):r,e)),Xne=Gne({"node_modules/browserfs/dist/browserfs.js"(e,t){(function(n,i){typeof e=="object"&&typeof t=="object"?t.exports=i():typeof define=="function"&&define.amd?define([],i):typeof e=="object"?e.BrowserFS=i():n.BrowserFS=i()})(e,function(){return function(r){var n={};function i(s){if(n[s])return n[s].exports;var a=n[s]={exports:{},id:s,loaded:!1};return r[s].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}return i.m=r,i.c=n,i.p="",i(0)}([function(r,n,i){(function(s,a,o,l){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var c=i(2),f=i(9),u;(function(b){b[b.EPERM=1]="EPERM",b[b.ENOENT=2]="ENOENT",b[b.EIO=5]="EIO",b[b.EBADF=9]="EBADF",b[b.EACCES=13]="EACCES",b[b.EBUSY=16]="EBUSY",b[b.EEXIST=17]="EEXIST",b[b.ENOTDIR=20]="ENOTDIR",b[b.EISDIR=21]="EISDIR",b[b.EINVAL=22]="EINVAL",b[b.EFBIG=27]="EFBIG",b[b.ENOSPC=28]="ENOSPC",b[b.EROFS=30]="EROFS",b[b.ENOTEMPTY=39]="ENOTEMPTY",b[b.ENOTSUP=95]="ENOTSUP"})(u||(u={}));var d={};d[u.EPERM]="Operation not permitted.",d[u.ENOENT]="No such file or directory.",d[u.EIO]="Input/output error.",d[u.EBADF]="Bad file descriptor.",d[u.EACCES]="Permission denied.",d[u.EBUSY]="Resource busy or locked.",d[u.EEXIST]="File exists.",d[u.ENOTDIR]="File is not a directory.",d[u.EISDIR]="File is a directory.",d[u.EINVAL]="Invalid argument.",d[u.EFBIG]="File is too big.",d[u.ENOSPC]="No space left on disk.",d[u.EROFS]="Cannot modify a read-only file system.",d[u.ENOTEMPTY]="Directory is not empty.",d[u.ENOTSUP]="Operation is not supported.";var p=function(b){function h(y,g,v){g===void 0&&(g=d[y]),b.call(this,g),this.syscall="",this.errno=y,this.code=u[y],this.path=v,this.stack=new b().stack,this.message="Error: "+this.code+": "+g+(this.path?", '"+this.path+"'":"")}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.fromJSON=function(g){var v=new h(0);return v.errno=g.errno,v.code=g.code,v.path=g.path,v.stack=g.stack,v.message=g.message,v},h.fromBuffer=function(g,v){return v===void 0&&(v=0),h.fromJSON(JSON.parse(g.toString("utf8",v+4,v+4+g.readUInt32LE(v))))},h.FileError=function(g,v){return new h(g,d[g],v)},h.ENOENT=function(g){return this.FileError(u.ENOENT,g)},h.EEXIST=function(g){return this.FileError(u.EEXIST,g)},h.EISDIR=function(g){return this.FileError(u.EISDIR,g)},h.ENOTDIR=function(g){return this.FileError(u.ENOTDIR,g)},h.EPERM=function(g){return this.FileError(u.EPERM,g)},h.ENOTEMPTY=function(g){return this.FileError(u.ENOTEMPTY,g)},h.prototype.toString=function(){return this.message},h.prototype.toJSON=function(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message}},h.prototype.writeToBuffer=function(g,v){g===void 0&&(g=s.alloc(this.bufferSize())),v===void 0&&(v=0);var E=g.write(JSON.stringify(this.toJSON()),v+4);return g.writeUInt32LE(E,v),g},h.prototype.bufferSize=function(){return 4+s.byteLength(JSON.stringify(this.toJSON()))},h}(Error),_=Object.freeze({get ErrorCode(){return u},ErrorStrings:d,ApiError:p}),w;(function(b){b[b.NOP=0]="NOP",b[b.THROW_EXCEPTION=1]="THROW_EXCEPTION",b[b.TRUNCATE_FILE=2]="TRUNCATE_FILE",b[b.CREATE_FILE=3]="CREATE_FILE"})(w||(w={}));var k=function b(h){if(this.flagStr=h,b.validFlagStrs.indexOf(h)<0)throw new p(u.EINVAL,"Invalid flag: "+h)};k.getFileFlag=function(h){return k.flagCache.hasOwnProperty(h)?k.flagCache[h]:k.flagCache[h]=new k(h)},k.prototype.getFlagString=function(){return this.flagStr},k.prototype.isReadable=function(){return this.flagStr.indexOf("r")!==-1||this.flagStr.indexOf("+")!==-1},k.prototype.isWriteable=function(){return this.flagStr.indexOf("w")!==-1||this.flagStr.indexOf("a")!==-1||this.flagStr.indexOf("+")!==-1},k.prototype.isTruncating=function(){return this.flagStr.indexOf("w")!==-1},k.prototype.isAppendable=function(){return this.flagStr.indexOf("a")!==-1},k.prototype.isSynchronous=function(){return this.flagStr.indexOf("s")!==-1},k.prototype.isExclusive=function(){return this.flagStr.indexOf("x")!==-1},k.prototype.pathExistsAction=function(){return this.isExclusive()?w.THROW_EXCEPTION:this.isTruncating()?w.TRUNCATE_FILE:w.NOP},k.prototype.pathNotExistsAction=function(){return(this.isWriteable()||this.isAppendable())&&this.flagStr!=="r+"?w.CREATE_FILE:w.THROW_EXCEPTION},k.flagCache={},k.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"];var S;(function(b){b[b.FILE=32768]="FILE",b[b.DIRECTORY=16384]="DIRECTORY",b[b.SYMLINK=40960]="SYMLINK"})(S||(S={}));var O=function(h,y,g,v,E,T){if(v===void 0&&(v=new Date),E===void 0&&(E=new Date),T===void 0&&(T=new Date),this.size=y,this.atime=v,this.mtime=E,this.ctime=T,this.dev=0,this.ino=0,this.rdev=0,this.nlink=1,this.blksize=4096,this.uid=0,this.gid=0,this.birthtime=new Date(0),this.fileData=null,g)this.mode=g;else switch(h){case S.FILE:this.mode=420;break;case S.DIRECTORY:default:this.mode=511}this.blocks=Math.ceil(y/512),this.mode<4096&&(this.mode|=h)};O.fromBuffer=function(h){var y=h.readUInt32LE(0),g=h.readUInt32LE(4),v=h.readDoubleLE(8),E=h.readDoubleLE(16),T=h.readDoubleLE(24);return new O(g&61440,y,g&4095,new Date(v),new Date(E),new Date(T))},O.prototype.toBuffer=function(){var h=s.alloc(32);return h.writeUInt32LE(this.size,0),h.writeUInt32LE(this.mode,4),h.writeDoubleLE(this.atime.getTime(),8),h.writeDoubleLE(this.mtime.getTime(),16),h.writeDoubleLE(this.ctime.getTime(),24),h},O.prototype.clone=function(){return new O(this.mode&61440,this.size,this.mode&4095,this.atime,this.mtime,this.ctime)},O.prototype.isFile=function(){return(this.mode&61440)===S.FILE},O.prototype.isDirectory=function(){return(this.mode&61440)===S.DIRECTORY},O.prototype.isSymbolicLink=function(){return(this.mode&61440)===S.SYMLINK},O.prototype.chmod=function(h){this.mode=this.mode&61440|h},O.prototype.isSocket=function(){return!1},O.prototype.isBlockDevice=function(){return!1},O.prototype.isCharacterDevice=function(){return!1},O.prototype.isFIFO=function(){return!1};var A=function(b,h){return b};function C(b){if(b)return b;throw new p(u.EIO,"Initialize BrowserFS with a file system using BrowserFS.initialize(filesystem)")}function I(b,h){switch(typeof b){case"number":return b;case"string":var y=parseInt(b,8);return isNaN(y)?h:y;default:return h}}function D(b){if(b instanceof Date)return b;if(typeof b=="number")return new Date(b*1e3);throw new p(u.EINVAL,"Invalid time.")}function L(b){if(b.indexOf("\0")>=0)throw new p(u.EINVAL,"Path must be a string without null bytes.");if(b==="")throw new p(u.EINVAL,"Path must not be empty.");return f.resolve(b)}function U(b,h,y,g){switch(typeof b){case"object":return{encoding:typeof b.encoding<"u"?b.encoding:h,flag:typeof b.flag<"u"?b.flag:y,mode:I(b.mode,g)};case"string":return{encoding:b,flag:y,mode:g};default:return{encoding:h,flag:y,mode:g}}}function te(){}var V=function(){this.F_OK=0,this.R_OK=4,this.W_OK=2,this.X_OK=1,this.root=null,this.fdMap={},this.nextFd=100};V.prototype.initialize=function(h){if(!h.constructor.isAvailable())throw new p(u.EINVAL,"Tried to instantiate BrowserFS with an unavailable file system.");return this.root=h},V.prototype._toUnixTimestamp=function(h){if(typeof h=="number")return h;if(h instanceof Date)return h.getTime()/1e3;throw new Error("Cannot parse time: "+h)},V.prototype.getRootFS=function(){return this.root?this.root:null},V.prototype.rename=function(h,y,g){g===void 0&&(g=te);var v=A(g,1);try{C(this.root).rename(L(h),L(y),v)}catch(E){v(E)}},V.prototype.renameSync=function(h,y){C(this.root).renameSync(L(h),L(y))},V.prototype.exists=function(h,y){y===void 0&&(y=te);var g=A(y,1);try{return C(this.root).exists(L(h),g)}catch{return g(!1)}},V.prototype.existsSync=function(h){try{return C(this.root).existsSync(L(h))}catch{return!1}},V.prototype.stat=function(h,y){y===void 0&&(y=te);var g=A(y,2);try{return C(this.root).stat(L(h),!1,g)}catch(v){return g(v)}},V.prototype.statSync=function(h){return C(this.root).statSync(L(h),!1)},V.prototype.lstat=function(h,y){y===void 0&&(y=te);var g=A(y,2);try{return C(this.root).stat(L(h),!0,g)}catch(v){return g(v)}},V.prototype.lstatSync=function(h){return C(this.root).statSync(L(h),!0)},V.prototype.truncate=function(h,y,g){y===void 0&&(y=0),g===void 0&&(g=te);var v=0;typeof y=="function"?g=y:typeof y=="number"&&(v=y);var E=A(g,1);try{if(v<0)throw new p(u.EINVAL);return C(this.root).truncate(L(h),v,E)}catch(T){return E(T)}},V.prototype.truncateSync=function(h,y){if(y===void 0&&(y=0),y<0)throw new p(u.EINVAL);return C(this.root).truncateSync(L(h),y)},V.prototype.unlink=function(h,y){y===void 0&&(y=te);var g=A(y,1);try{return C(this.root).unlink(L(h),g)}catch(v){return g(v)}},V.prototype.unlinkSync=function(h){return C(this.root).unlinkSync(L(h))},V.prototype.open=function(h,y,g,v){var E=this;v===void 0&&(v=te);var T=I(g,420);v=typeof g=="function"?g:v;var P=A(v,2);try{C(this.root).open(L(h),k.getFileFlag(y),T,function(z,G){G?P(z,E.getFdForFile(G)):P(z)})}catch(z){P(z)}},V.prototype.openSync=function(h,y,g){return g===void 0&&(g=420),this.getFdForFile(C(this.root).openSync(L(h),k.getFileFlag(y),I(g,420)))},V.prototype.readFile=function(h,y,g){y===void 0&&(y={}),g===void 0&&(g=te);var v=U(y,null,"r",null);g=typeof y=="function"?y:g;var E=A(g,2);try{var T=k.getFileFlag(v.flag);return T.isReadable()?C(this.root).readFile(L(h),v.encoding,T,E):E(new p(u.EINVAL,"Flag passed to readFile must allow for reading."))}catch(P){return E(P)}},V.prototype.readFileSync=function(h,y){y===void 0&&(y={});var g=U(y,null,"r",null),v=k.getFileFlag(g.flag);if(!v.isReadable())throw new p(u.EINVAL,"Flag passed to readFile must allow for reading.");return C(this.root).readFileSync(L(h),g.encoding,v)},V.prototype.writeFile=function(h,y,g,v){g===void 0&&(g={}),v===void 0&&(v=te);var E=U(g,"utf8","w",420);v=typeof g=="function"?g:v;var T=A(v,1);try{var P=k.getFileFlag(E.flag);return P.isWriteable()?C(this.root).writeFile(L(h),y,E.encoding,P,E.mode,T):T(new p(u.EINVAL,"Flag passed to writeFile must allow for writing."))}catch(z){return T(z)}},V.prototype.writeFileSync=function(h,y,g){var v=U(g,"utf8","w",420),E=k.getFileFlag(v.flag);if(!E.isWriteable())throw new p(u.EINVAL,"Flag passed to writeFile must allow for writing.");return C(this.root).writeFileSync(L(h),y,v.encoding,E,v.mode)},V.prototype.appendFile=function(h,y,g,v){v===void 0&&(v=te);var E=U(g,"utf8","a",420);v=typeof g=="function"?g:v;var T=A(v,1);try{var P=k.getFileFlag(E.flag);if(!P.isAppendable())return T(new p(u.EINVAL,"Flag passed to appendFile must allow for appending."));C(this.root).appendFile(L(h),y,E.encoding,P,E.mode,T)}catch(z){T(z)}},V.prototype.appendFileSync=function(h,y,g){var v=U(g,"utf8","a",420),E=k.getFileFlag(v.flag);if(!E.isAppendable())throw new p(u.EINVAL,"Flag passed to appendFile must allow for appending.");return C(this.root).appendFileSync(L(h),y,v.encoding,E,v.mode)},V.prototype.fstat=function(h,y){y===void 0&&(y=te);var g=A(y,2);try{var v=this.fd2file(h);v.stat(g)}catch(E){g(E)}},V.prototype.fstatSync=function(h){return this.fd2file(h).statSync()},V.prototype.close=function(h,y){var g=this;y===void 0&&(y=te);var v=A(y,1);try{this.fd2file(h).close(function(E){E||g.closeFd(h),v(E)})}catch(E){v(E)}},V.prototype.closeSync=function(h){this.fd2file(h).closeSync(),this.closeFd(h)},V.prototype.ftruncate=function(h,y,g){g===void 0&&(g=te);var v=typeof y=="number"?y:0;g=typeof y=="function"?y:g;var E=A(g,1);try{var T=this.fd2file(h);if(v<0)throw new p(u.EINVAL);T.truncate(v,E)}catch(P){E(P)}},V.prototype.ftruncateSync=function(h,y){y===void 0&&(y=0);var g=this.fd2file(h);if(y<0)throw new p(u.EINVAL);g.truncateSync(y)},V.prototype.fsync=function(h,y){y===void 0&&(y=te);var g=A(y,1);try{this.fd2file(h).sync(g)}catch(v){g(v)}},V.prototype.fsyncSync=function(h){this.fd2file(h).syncSync()},V.prototype.fdatasync=function(h,y){y===void 0&&(y=te);var g=A(y,1);try{this.fd2file(h).datasync(g)}catch(v){g(v)}},V.prototype.fdatasyncSync=function(h){this.fd2file(h).datasyncSync()},V.prototype.write=function(h,y,g,v,E,T){T===void 0&&(T=te);var P,z,G,ue=null;if(typeof y=="string"){var xe="utf8";switch(typeof g){case"function":T=g;break;case"number":ue=g,xe=typeof v=="string"?v:"utf8",T=typeof E=="function"?E:T;break;default:return T=typeof v=="function"?v:typeof E=="function"?E:T,T(new p(u.EINVAL,"Invalid arguments."))}P=s.from(y,xe),z=0,G=P.length}else P=y,z=g,G=v,ue=typeof E=="number"?E:null,T=typeof E=="function"?E:T;var Pe=A(T,3);try{var We=this.fd2file(h);ue==null&&(ue=We.getPos()),We.write(P,z,G,ue,Pe)}catch(Ke){Pe(Ke)}},V.prototype.writeSync=function(h,y,g,v,E){var T,P=0,z,G;if(typeof y=="string"){G=typeof g=="number"?g:null;var ue=typeof v=="string"?v:"utf8";P=0,T=s.from(y,ue),z=T.length}else T=y,P=g,z=v,G=typeof E=="number"?E:null;var xe=this.fd2file(h);return G==null&&(G=xe.getPos()),xe.writeSync(T,P,z,G)},V.prototype.read=function(h,y,g,v,E,T){T===void 0&&(T=te);var P,z,G,ue,xe;if(typeof y=="number"){G=y,P=g;var Pe=v;T=typeof E=="function"?E:T,z=0,ue=s.alloc(G),xe=A(function(Ke,ht,bt){if(Ke)return T(Ke);T(Ke,bt.toString(Pe),ht)},3)}else ue=y,z=g,G=v,P=E,xe=A(T,3);try{var We=this.fd2file(h);P==null&&(P=We.getPos()),We.read(ue,z,G,P,xe)}catch(Ke){xe(Ke)}},V.prototype.readSync=function(h,y,g,v,E){var T=!1,P,z,G,ue,xe="utf8";typeof y=="number"?(G=y,ue=g,xe=v,z=0,P=s.alloc(G),T=!0):(P=y,z=g,G=v,ue=E);var Pe=this.fd2file(h);ue==null&&(ue=Pe.getPos());var We=Pe.readSync(P,z,G,ue);return T?[P.toString(xe),We]:We},V.prototype.fchown=function(h,y,g,v){v===void 0&&(v=te);var E=A(v,1);try{this.fd2file(h).chown(y,g,E)}catch(T){E(T)}},V.prototype.fchownSync=function(h,y,g){this.fd2file(h).chownSync(y,g)},V.prototype.fchmod=function(h,y,g){var v=A(g,1);try{var E=typeof y=="string"?parseInt(y,8):y;this.fd2file(h).chmod(E,v)}catch(T){v(T)}},V.prototype.fchmodSync=function(h,y){var g=typeof y=="string"?parseInt(y,8):y;this.fd2file(h).chmodSync(g)},V.prototype.futimes=function(h,y,g,v){v===void 0&&(v=te);var E=A(v,1);try{var T=this.fd2file(h);typeof y=="number"&&(y=new Date(y*1e3)),typeof g=="number"&&(g=new Date(g*1e3)),T.utimes(y,g,E)}catch(P){E(P)}},V.prototype.futimesSync=function(h,y,g){this.fd2file(h).utimesSync(D(y),D(g))},V.prototype.rmdir=function(h,y){y===void 0&&(y=te);var g=A(y,1);try{h=L(h),C(this.root).rmdir(h,g)}catch(v){g(v)}},V.prototype.rmdirSync=function(h){return h=L(h),C(this.root).rmdirSync(h)},V.prototype.mkdir=function(h,y,g){g===void 0&&(g=te),typeof y=="function"&&(g=y,y=511);var v=A(g,1);try{h=L(h),C(this.root).mkdir(h,y,v)}catch(E){v(E)}},V.prototype.mkdirSync=function(h,y){C(this.root).mkdirSync(L(h),I(y,511))},V.prototype.readdir=function(h,y){y===void 0&&(y=te);var g=A(y,2);try{h=L(h),C(this.root).readdir(h,g)}catch(v){g(v)}},V.prototype.readdirSync=function(h){return h=L(h),C(this.root).readdirSync(h)},V.prototype.link=function(h,y,g){g===void 0&&(g=te);var v=A(g,1);try{h=L(h),y=L(y),C(this.root).link(h,y,v)}catch(E){v(E)}},V.prototype.linkSync=function(h,y){return h=L(h),y=L(y),C(this.root).linkSync(h,y)},V.prototype.symlink=function(h,y,g,v){v===void 0&&(v=te);var E=typeof g=="string"?g:"file";v=typeof g=="function"?g:v;var T=A(v,1);try{if(E!=="file"&&E!=="dir")return T(new p(u.EINVAL,"Invalid type: "+E));h=L(h),y=L(y),C(this.root).symlink(h,y,E,T)}catch(P){T(P)}},V.prototype.symlinkSync=function(h,y,g){if(!g)g="file";else if(g!=="file"&&g!=="dir")throw new p(u.EINVAL,"Invalid type: "+g);return h=L(h),y=L(y),C(this.root).symlinkSync(h,y,g)},V.prototype.readlink=function(h,y){y===void 0&&(y=te);var g=A(y,2);try{h=L(h),C(this.root).readlink(h,g)}catch(v){g(v)}},V.prototype.readlinkSync=function(h){return h=L(h),C(this.root).readlinkSync(h)},V.prototype.chown=function(h,y,g,v){v===void 0&&(v=te);var E=A(v,1);try{h=L(h),C(this.root).chown(h,!1,y,g,E)}catch(T){E(T)}},V.prototype.chownSync=function(h,y,g){h=L(h),C(this.root).chownSync(h,!1,y,g)},V.prototype.lchown=function(h,y,g,v){v===void 0&&(v=te);var E=A(v,1);try{h=L(h),C(this.root).chown(h,!0,y,g,E)}catch(T){E(T)}},V.prototype.lchownSync=function(h,y,g){h=L(h),C(this.root).chownSync(h,!0,y,g)},V.prototype.chmod=function(h,y,g){g===void 0&&(g=te);var v=A(g,1);try{var E=I(y,-1);if(E<0)throw new p(u.EINVAL,"Invalid mode.");C(this.root).chmod(L(h),!1,E,v)}catch(T){v(T)}},V.prototype.chmodSync=function(h,y){var g=I(y,-1);if(g<0)throw new p(u.EINVAL,"Invalid mode.");h=L(h),C(this.root).chmodSync(h,!1,g)},V.prototype.lchmod=function(h,y,g){g===void 0&&(g=te);var v=A(g,1);try{var E=I(y,-1);if(E<0)throw new p(u.EINVAL,"Invalid mode.");C(this.root).chmod(L(h),!0,E,v)}catch(T){v(T)}},V.prototype.lchmodSync=function(h,y){var g=I(y,-1);if(g<1)throw new p(u.EINVAL,"Invalid mode.");C(this.root).chmodSync(L(h),!0,g)},V.prototype.utimes=function(h,y,g,v){v===void 0&&(v=te);var E=A(v,1);try{C(this.root).utimes(L(h),D(y),D(g),E)}catch(T){E(T)}},V.prototype.utimesSync=function(h,y,g){C(this.root).utimesSync(L(h),D(y),D(g))},V.prototype.realpath=function(h,y,g){g===void 0&&(g=te);var v=typeof y=="object"?y:{};g=typeof y=="function"?y:te;var E=A(g,2);try{h=L(h),C(this.root).realpath(h,v,E)}catch(T){E(T)}},V.prototype.realpathSync=function(h,y){return y===void 0&&(y={}),h=L(h),C(this.root).realpathSync(h,y)},V.prototype.watchFile=function(h,y,g){throw g===void 0&&(g=te),new p(u.ENOTSUP)},V.prototype.unwatchFile=function(h,y){throw y===void 0&&(y=te),new p(u.ENOTSUP)},V.prototype.watch=function(h,y,g){throw g===void 0&&(g=te),new p(u.ENOTSUP)},V.prototype.access=function(h,y,g){throw g===void 0&&(g=te),new p(u.ENOTSUP)},V.prototype.accessSync=function(h,y){throw new p(u.ENOTSUP)},V.prototype.createReadStream=function(h,y){throw new p(u.ENOTSUP)},V.prototype.createWriteStream=function(h,y){throw new p(u.ENOTSUP)},V.prototype.wrapCallbacks=function(h){A=h},V.prototype.getFdForFile=function(h){var y=this.nextFd++;return this.fdMap[y]=h,y},V.prototype.fd2file=function(h){var y=this.fdMap[h];if(y)return y;throw new p(u.EBADF,"Invalid file descriptor.")},V.prototype.closeFd=function(h){delete this.fdMap[h]},V.Stats=O;var X=new V,Z={},se=V.prototype;Object.keys(se).forEach(function(b){typeof X[b]=="function"?Z[b]=function(){return X[b].apply(X,arguments)}:Z[b]=X[b]}),Z.changeFSModule=function(b){X=b},Z.getFSModule=function(){return X},Z.FS=V;function pe(b,h,y,g,v){return b<h||y<h?b>y?y+1:b+1:g===v?h:h+1}function de(b,h){if(b===h)return 0;if(b.length>h.length){var y=b;b=h,h=y}for(var g=b.length,v=h.length;g>0&&b.charCodeAt(g-1)===h.charCodeAt(v-1);)g--,v--;for(var E=0;E<g&&b.charCodeAt(E)===h.charCodeAt(E);)E++;if(g-=E,v-=E,g===0||v===1)return v;for(var T=new Array(g<<1),P=0;P<g;)T[g+P]=b.charCodeAt(E+P),T[P]=++P;var z,G,ue,xe,Pe;for(z=0;z+3<v;)for(var We=h.charCodeAt(E+(G=z)),Ke=h.charCodeAt(E+(ue=z+1)),ht=h.charCodeAt(E+(xe=z+2)),bt=h.charCodeAt(E+(Pe=z+3)),Pt=z+=4,Rr=0;Rr<g;){var Hn=T[g+Rr],ja=T[Rr];G=pe(ja,G,ue,We,Hn),ue=pe(G,ue,xe,Ke,Hn),xe=pe(ue,xe,Pe,ht,Hn),Pt=pe(xe,Pe,Pt,bt,Hn),T[Rr++]=Pt,Pe=xe,xe=ue,ue=G,G=ja}for(var Ba=0;z<v;){var Yf=h.charCodeAt(E+(G=z));Ba=++z;for(var wo=0;wo<g;wo++){var So=T[wo];T[wo]=Ba=So<G||Ba<G?So>Ba?Ba+1:So+1:Yf===T[g+wo]?G:G+1,G=So}}return Ba}function F(b,h,y){b&&console.warn("["+h+"] Direct file system constructor usage is deprecated for this file system, and will be removed in the next major version. Please use the '"+h+".Create("+JSON.stringify(y)+", callback)' method instead. See https://github.com/jvilk/BrowserFS/issues/176 for more details.")}var H=typeof navigator<"u"&&!!(/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||navigator.userAgent.indexOf("Trident")!==-1),Q=typeof window>"u";function R(){throw new Error("BFS has reached an impossible code path; please file a bug.")}function $(b,h,y){y.existsSync(b)||($(f.dirname(b),h,y),y.mkdirSync(b,h))}function q(b){var h=ie(b),y=h.byteOffset,g=h.byteLength;return y===0&&g===h.buffer.byteLength?h.buffer:h.buffer.slice(y,y+g)}function ie(b){return b instanceof Uint8Array?b:new Uint8Array(b)}function oe(b){return b instanceof s?b:b instanceof Uint8Array?fe(b):s.from(b)}function fe(b){return b instanceof s?b:b.byteOffset===0&&b.byteLength===b.buffer.byteLength?_e(b.buffer):s.from(b.buffer,b.byteOffset,b.byteLength)}function _e(b){return s.from(b)}function Ee(b,h,y){if(h===void 0&&(h=0),y===void 0&&(y=b.length),h<0||y<0||y>b.length||h>y)throw new TypeError("Invalid slice bounds on buffer of length "+b.length+": ["+h+", "+y+"]");if(b.length===0)return le();var g=ie(b),v=b[0],E=(v+1)%255;return b[0]=E,g[0]===E?(g[0]=v,fe(g.slice(h,y))):(b[0]=v,fe(g.subarray(h,y)))}var Se=null;function le(){return Se||(Se=s.alloc(0))}function we(b,h){s.isBuffer(b)?h():h(new p(u.EINVAL,"option must be a Buffer."))}function W(b,h,y){var g=b.Options,v=b.Name,E=0,T=!1,P=!1;function z(Pe){T||(Pe&&(T=!0,y(Pe)),E--,E===0&&P&&y())}var G=function(Pe){if(g.hasOwnProperty(Pe)){var We=g[Pe],Ke=h[Pe];if(Ke==null){if(!We.optional){var ht=Object.keys(h).filter(function(Pt){return!(Pt in g)}).map(function(Pt){return{str:Pt,distance:de(Pe,Pt)}}).filter(function(Pt){return Pt.distance<5}).sort(function(Pt,Rr){return Pt.distance-Rr.distance});return T?{}:(T=!0,{v:y(new p(u.EINVAL,"["+v+"] Required option '"+Pe+"' not provided."+(ht.length>0?" You provided unrecognized option '"+ht[0].str+"'; perhaps you meant to type '"+Pe+"'.":"")+`
Option description: `+We.description))})}}else{var bt=!1;if(Array.isArray(We.type)?bt=We.type.indexOf(typeof Ke)!==-1:bt=typeof Ke===We.type,bt)We.validator&&(E++,We.validator(Ke,z));else return T?{}:(T=!0,{v:y(new p(u.EINVAL,"["+v+"] Value provided for option "+Pe+" is not the proper type. Expected "+(Array.isArray(We.type)?"one of {"+We.type.join(", ")+"}":We.type)+", but received "+typeof Ke+`
Option description: `+We.description))})}}};for(var ue in g){var xe=G(ue);if(xe)return xe.v}P=!0,E===0&&!T&&y()}var J=Object.freeze({deprecationMessage:F,isIE:H,isWebWorker:Q,fail:R,mkdirpSync:$,buffer2ArrayBuffer:q,buffer2Uint8array:ie,arrayish2Buffer:oe,uint8Array2Buffer:fe,arrayBuffer2Buffer:_e,copyingSlice:Ee,emptyBuffer:le,bufferValidator:we,checkOptions:W}),ne=function(h){this.fs=h,this.nodefs=h.getNodeFS(),this.FS=h.getFS(),this.PATH=h.getPATH(),this.ERRNO_CODES=h.getERRNO_CODES()};ne.prototype.open=function(h){var y=this.fs.realPath(h.node),g=this.FS;try{g.isFile(h.node.mode)&&(h.nfd=this.nodefs.openSync(y,this.fs.flagsToPermissionString(h.flags)))}catch(v){throw v.code?new g.ErrnoError(this.ERRNO_CODES[v.code]):v}},ne.prototype.close=function(h){var y=this.FS;try{y.isFile(h.node.mode)&&h.nfd&&this.nodefs.closeSync(h.nfd)}catch(g){throw g.code?new y.ErrnoError(this.ERRNO_CODES[g.code]):g}},ne.prototype.read=function(h,y,g,v,E){try{return this.nodefs.readSync(h.nfd,fe(y),g,v,E)}catch(T){throw new this.FS.ErrnoError(this.ERRNO_CODES[T.code])}},ne.prototype.write=function(h,y,g,v,E){try{return this.nodefs.writeSync(h.nfd,fe(y),g,v,E)}catch(T){throw new this.FS.ErrnoError(this.ERRNO_CODES[T.code])}},ne.prototype.llseek=function(h,y,g){var v=y;if(g===1)v+=h.position;else if(g===2&&this.FS.isFile(h.node.mode))try{var E=this.nodefs.fstatSync(h.nfd);v+=E.size}catch(T){throw new this.FS.ErrnoError(this.ERRNO_CODES[T.code])}if(v<0)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return h.position=v,v};var Oe=function(h){this.fs=h,this.nodefs=h.getNodeFS(),this.FS=h.getFS(),this.PATH=h.getPATH(),this.ERRNO_CODES=h.getERRNO_CODES()};Oe.prototype.getattr=function(h){var y=this.fs.realPath(h),g;try{g=this.nodefs.lstatSync(y)}catch(v){throw v.code?new this.FS.ErrnoError(this.ERRNO_CODES[v.code]):v}return{dev:g.dev,ino:g.ino,mode:g.mode,nlink:g.nlink,uid:g.uid,gid:g.gid,rdev:g.rdev,size:g.size,atime:g.atime,mtime:g.mtime,ctime:g.ctime,blksize:g.blksize,blocks:g.blocks}},Oe.prototype.setattr=function(h,y){var g=this.fs.realPath(h);try{if(y.mode!==void 0&&(this.nodefs.chmodSync(g,y.mode),h.mode=y.mode),y.timestamp!==void 0){var v=new Date(y.timestamp);this.nodefs.utimesSync(g,v,v)}}catch(E){if(!E.code)throw E;if(E.code!=="ENOTSUP")throw new this.FS.ErrnoError(this.ERRNO_CODES[E.code])}if(y.size!==void 0)try{this.nodefs.truncateSync(g,y.size)}catch(E){throw E.code?new this.FS.ErrnoError(this.ERRNO_CODES[E.code]):E}},Oe.prototype.lookup=function(h,y){var g=this.PATH.join2(this.fs.realPath(h),y),v=this.fs.getMode(g);return this.fs.createNode(h,y,v)},Oe.prototype.mknod=function(h,y,g,v){var E=this.fs.createNode(h,y,g,v),T=this.fs.realPath(E);try{this.FS.isDir(E.mode)?this.nodefs.mkdirSync(T,E.mode):this.nodefs.writeFileSync(T,"",{mode:E.mode})}catch(P){throw P.code?new this.FS.ErrnoError(this.ERRNO_CODES[P.code]):P}return E},Oe.prototype.rename=function(h,y,g){var v=this.fs.realPath(h),E=this.PATH.join2(this.fs.realPath(y),g);try{this.nodefs.renameSync(v,E),h.name=g,h.parent=y}catch(T){throw T.code?new this.FS.ErrnoError(this.ERRNO_CODES[T.code]):T}},Oe.prototype.unlink=function(h,y){var g=this.PATH.join2(this.fs.realPath(h),y);try{this.nodefs.unlinkSync(g)}catch(v){throw v.code?new this.FS.ErrnoError(this.ERRNO_CODES[v.code]):v}},Oe.prototype.rmdir=function(h,y){var g=this.PATH.join2(this.fs.realPath(h),y);try{this.nodefs.rmdirSync(g)}catch(v){throw v.code?new this.FS.ErrnoError(this.ERRNO_CODES[v.code]):v}},Oe.prototype.readdir=function(h){var y=this.fs.realPath(h);try{var g=this.nodefs.readdirSync(y);return g.push(".",".."),g}catch(v){throw v.code?new this.FS.ErrnoError(this.ERRNO_CODES[v.code]):v}},Oe.prototype.symlink=function(h,y,g){var v=this.PATH.join2(this.fs.realPath(h),y);try{this.nodefs.symlinkSync(g,v)}catch(E){throw E.code?new this.FS.ErrnoError(this.ERRNO_CODES[E.code]):E}},Oe.prototype.readlink=function(h){var y=this.fs.realPath(h);try{return this.nodefs.readlinkSync(y)}catch(g){throw g.code?new this.FS.ErrnoError(this.ERRNO_CODES[g.code]):g}};var Ne=function(h,y,g,v){h===void 0&&(h=self.FS),y===void 0&&(y=self.PATH),g===void 0&&(g=self.ERRNO_CODES),v===void 0&&(v=Z),this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"},this.nodefs=v,this.FS=h,this.PATH=y,this.ERRNO_CODES=g,this.node_ops=new Oe(this),this.stream_ops=new ne(this)};Ne.prototype.mount=function(h){return this.createNode(null,"/",this.getMode(h.opts.root),0)},Ne.prototype.createNode=function(h,y,g,v){var E=this.FS;if(!E.isDir(g)&&!E.isFile(g)&&!E.isLink(g))throw new E.ErrnoError(this.ERRNO_CODES.EINVAL);var T=E.createNode(h,y,g);return T.node_ops=this.node_ops,T.stream_ops=this.stream_ops,T},Ne.prototype.getMode=function(h){var y;try{y=this.nodefs.lstatSync(h)}catch(g){throw g.code?new this.FS.ErrnoError(this.ERRNO_CODES[g.code]):g}return y.mode},Ne.prototype.realPath=function(h){for(var y=[];h.parent!==h;)y.push(h.name),h=h.parent;return y.push(h.mount.opts.root),y.reverse(),this.PATH.join.apply(null,y)},Ne.prototype.flagsToPermissionString=function(h){var y=typeof h=="string"?parseInt(h,10):h;return y&=8191,y in this.flagsToPermissionStringMap?this.flagsToPermissionStringMap[y]:h},Ne.prototype.getNodeFS=function(){return this.nodefs},Ne.prototype.getFS=function(){return this.FS},Ne.prototype.getPATH=function(){return this.PATH},Ne.prototype.getERRNO_CODES=function(){return this.ERRNO_CODES};var Ce=function(){};Ce.prototype.supportsLinks=function(){return!1},Ce.prototype.diskSpace=function(h,y){y(0,0)},Ce.prototype.openFile=function(h,y,g){throw new p(u.ENOTSUP)},Ce.prototype.createFile=function(h,y,g,v){throw new p(u.ENOTSUP)},Ce.prototype.open=function(h,y,g,v){var E=this,T=function(P,z){if(P)switch(y.pathNotExistsAction()){case w.CREATE_FILE:return E.stat(f.dirname(h),!1,function(G,ue){G?v(G):ue&&!ue.isDirectory()?v(p.ENOTDIR(f.dirname(h))):E.createFile(h,y,g,v)});case w.THROW_EXCEPTION:return v(p.ENOENT(h));default:return v(new p(u.EINVAL,"Invalid FileFlag object."))}else{if(z&&z.isDirectory())return v(p.EISDIR(h));switch(y.pathExistsAction()){case w.THROW_EXCEPTION:return v(p.EEXIST(h));case w.TRUNCATE_FILE:return E.openFile(h,y,function(G,ue){G?v(G):ue?ue.truncate(0,function(){ue.sync(function(){v(null,ue)})}):R()});case w.NOP:return E.openFile(h,y,v);default:return v(new p(u.EINVAL,"Invalid FileFlag object."))}}};this.stat(h,!1,T)},Ce.prototype.rename=function(h,y,g){g(new p(u.ENOTSUP))},Ce.prototype.renameSync=function(h,y){throw new p(u.ENOTSUP)},Ce.prototype.stat=function(h,y,g){g(new p(u.ENOTSUP))},Ce.prototype.statSync=function(h,y){throw new p(u.ENOTSUP)},Ce.prototype.openFileSync=function(h,y,g){throw new p(u.ENOTSUP)},Ce.prototype.createFileSync=function(h,y,g){throw new p(u.ENOTSUP)},Ce.prototype.openSync=function(h,y,g){var v;try{v=this.statSync(h,!1)}catch{switch(y.pathNotExistsAction()){case w.CREATE_FILE:var E=this.statSync(f.dirname(h),!1);if(!E.isDirectory())throw p.ENOTDIR(f.dirname(h));return this.createFileSync(h,y,g);case w.THROW_EXCEPTION:throw p.ENOENT(h);default:throw new p(u.EINVAL,"Invalid FileFlag object.")}}if(v.isDirectory())throw p.EISDIR(h);switch(y.pathExistsAction()){case w.THROW_EXCEPTION:throw p.EEXIST(h);case w.TRUNCATE_FILE:return this.unlinkSync(h),this.createFileSync(h,y,v.mode);case w.NOP:return this.openFileSync(h,y,g);default:throw new p(u.EINVAL,"Invalid FileFlag object.")}},Ce.prototype.unlink=function(h,y){y(new p(u.ENOTSUP))},Ce.prototype.unlinkSync=function(h){throw new p(u.ENOTSUP)},Ce.prototype.rmdir=function(h,y){y(new p(u.ENOTSUP))},Ce.prototype.rmdirSync=function(h){throw new p(u.ENOTSUP)},Ce.prototype.mkdir=function(h,y,g){g(new p(u.ENOTSUP))},Ce.prototype.mkdirSync=function(h,y){throw new p(u.ENOTSUP)},Ce.prototype.readdir=function(h,y){y(new p(u.ENOTSUP))},Ce.prototype.readdirSync=function(h){throw new p(u.ENOTSUP)},Ce.prototype.exists=function(h,y){this.stat(h,null,function(g){y(!g)})},Ce.prototype.existsSync=function(h){try{return this.statSync(h,!0),!0}catch{return!1}},Ce.prototype.realpath=function(h,y,g){if(this.supportsLinks())for(var v=h.split(f.sep),E=0;E<v.length;E++){var T=v.slice(0,E+1);v[E]=f.join.apply(null,T)}else this.exists(h,function(P){P?g(null,h):g(p.ENOENT(h))})},Ce.prototype.realpathSync=function(h,y){if(this.supportsLinks()){for(var g=h.split(f.sep),v=0;v<g.length;v++){var E=g.slice(0,v+1);g[v]=f.join.apply(f,E)}return g.join(f.sep)}else{if(this.existsSync(h))return h;throw p.ENOENT(h)}},Ce.prototype.truncate=function(h,y,g){this.open(h,k.getFileFlag("r+"),420,function(v,E){if(v)return g(v);E.truncate(y,function(T){E.close(function(P){g(T||P)})})})},Ce.prototype.truncateSync=function(h,y){var g=this.openSync(h,k.getFileFlag("r+"),420);try{g.truncateSync(y)}catch(v){throw v}finally{g.closeSync()}},Ce.prototype.readFile=function(h,y,g,v){var E=v;this.open(h,g,420,function(T,P){if(T)return v(T);v=function(z,G){P.close(function(ue){return z||(z=ue),E(z,G)})},P.stat(function(z,G){if(z)return v(z);var ue=s.alloc(G.size);P.read(ue,0,G.size,0,function(xe){if(xe)return v(xe);if(y===null)return v(xe,ue);try{v(null,ue.toString(y))}catch(Pe){v(Pe)}})})})},Ce.prototype.readFileSync=function(h,y,g){var v=this.openSync(h,g,420);try{var E=v.statSync(),T=s.alloc(E.size);return v.readSync(T,0,E.size,0),v.closeSync(),y===null?T:T.toString(y)}finally{v.closeSync()}},Ce.prototype.writeFile=function(h,y,g,v,E,T){var P=T;this.open(h,v,420,function(z,G){if(z)return T(z);T=function(ue){G.close(function(xe){P(ue||xe)})};try{typeof y=="string"&&(y=s.from(y,g))}catch(ue){return T(ue)}G.write(y,0,y.length,0,T)})},Ce.prototype.writeFileSync=function(h,y,g,v,E){var T=this.openSync(h,v,E);try{typeof y=="string"&&(y=s.from(y,g)),T.writeSync(y,0,y.length,0)}finally{T.closeSync()}},Ce.prototype.appendFile=function(h,y,g,v,E,T){var P=T;this.open(h,v,E,function(z,G){if(z)return T(z);T=function(ue){G.close(function(xe){P(ue||xe)})},typeof y=="string"&&(y=s.from(y,g)),G.write(y,0,y.length,null,T)})},Ce.prototype.appendFileSync=function(h,y,g,v,E){var T=this.openSync(h,v,E);try{typeof y=="string"&&(y=s.from(y,g)),T.writeSync(y,0,y.length,null)}finally{T.closeSync()}},Ce.prototype.chmod=function(h,y,g,v){v(new p(u.ENOTSUP))},Ce.prototype.chmodSync=function(h,y,g){throw new p(u.ENOTSUP)},Ce.prototype.chown=function(h,y,g,v,E){E(new p(u.ENOTSUP))},Ce.prototype.chownSync=function(h,y,g,v){throw new p(u.ENOTSUP)},Ce.prototype.utimes=function(h,y,g,v){v(new p(u.ENOTSUP))},Ce.prototype.utimesSync=function(h,y,g){throw new p(u.ENOTSUP)},Ce.prototype.link=function(h,y,g){g(new p(u.ENOTSUP))},Ce.prototype.linkSync=function(h,y){throw new p(u.ENOTSUP)},Ce.prototype.symlink=function(h,y,g,v){v(new p(u.ENOTSUP))},Ce.prototype.symlinkSync=function(h,y,g){throw new p(u.ENOTSUP)},Ce.prototype.readlink=function(h,y){y(new p(u.ENOTSUP))},Ce.prototype.readlinkSync=function(h){throw new p(u.ENOTSUP)};var Xe=function(b){function h(){b.apply(this,arguments)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.supportsSynch=function(){return!0},h.prototype.rename=function(g,v,E){try{this.renameSync(g,v),E()}catch(T){E(T)}},h.prototype.stat=function(g,v,E){try{E(null,this.statSync(g,v))}catch(T){E(T)}},h.prototype.open=function(g,v,E,T){try{T(null,this.openSync(g,v,E))}catch(P){T(P)}},h.prototype.unlink=function(g,v){try{this.unlinkSync(g),v()}catch(E){v(E)}},h.prototype.rmdir=function(g,v){try{this.rmdirSync(g),v()}catch(E){v(E)}},h.prototype.mkdir=function(g,v,E){try{this.mkdirSync(g,v),E()}catch(T){E(T)}},h.prototype.readdir=function(g,v){try{v(null,this.readdirSync(g))}catch(E){v(E)}},h.prototype.chmod=function(g,v,E,T){try{this.chmodSync(g,v,E),T()}catch(P){T(P)}},h.prototype.chown=function(g,v,E,T,P){try{this.chownSync(g,v,E,T),P()}catch(z){P(z)}},h.prototype.utimes=function(g,v,E,T){try{this.utimesSync(g,v,E),T()}catch(P){T(P)}},h.prototype.link=function(g,v,E){try{this.linkSync(g,v),E()}catch(T){E(T)}},h.prototype.symlink=function(g,v,E,T){try{this.symlinkSync(g,v,E),T()}catch(P){T(P)}},h.prototype.readlink=function(g,v){try{v(null,this.readlinkSync(g))}catch(E){v(E)}},h}(Ce),Ze=function(){};Ze.prototype.sync=function(h){h(new p(u.ENOTSUP))},Ze.prototype.syncSync=function(){throw new p(u.ENOTSUP)},Ze.prototype.datasync=function(h){this.sync(h)},Ze.prototype.datasyncSync=function(){return this.syncSync()},Ze.prototype.chown=function(h,y,g){g(new p(u.ENOTSUP))},Ze.prototype.chownSync=function(h,y){throw new p(u.ENOTSUP)},Ze.prototype.chmod=function(h,y){y(new p(u.ENOTSUP))},Ze.prototype.chmodSync=function(h){throw new p(u.ENOTSUP)},Ze.prototype.utimes=function(h,y,g){g(new p(u.ENOTSUP))},Ze.prototype.utimesSync=function(h,y){throw new p(u.ENOTSUP)};var kt=function(b){function h(y,g,v,E,T){if(b.call(this),this._pos=0,this._dirty=!1,this._fs=y,this._path=g,this._flag=v,this._stat=E,T?this._buffer=T:this._buffer=le(),this._stat.size!==this._buffer.length&&this._flag.isReadable())throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.getBuffer=function(){return this._buffer},h.prototype.getStats=function(){return this._stat},h.prototype.getFlag=function(){return this._flag},h.prototype.getPath=function(){return this._path},h.prototype.getPos=function(){return this._flag.isAppendable()?this._stat.size:this._pos},h.prototype.advancePos=function(g){return this._pos+=g},h.prototype.setPos=function(g){return this._pos=g},h.prototype.sync=function(g){try{this.syncSync(),g()}catch(v){g(v)}},h.prototype.syncSync=function(){throw new p(u.ENOTSUP)},h.prototype.close=function(g){try{this.closeSync(),g()}catch(v){g(v)}},h.prototype.closeSync=function(){throw new p(u.ENOTSUP)},h.prototype.stat=function(g){try{g(null,this._stat.clone())}catch(v){g(v)}},h.prototype.statSync=function(){return this._stat.clone()},h.prototype.truncate=function(g,v){try{this.truncateSync(g),this._flag.isSynchronous()&&!Z.getRootFS().supportsSynch()&&this.sync(v),v()}catch(E){return v(E)}},h.prototype.truncateSync=function(g){if(this._dirty=!0,!this._flag.isWriteable())throw new p(u.EPERM,"File not opened with a writeable mode.");if(this._stat.mtime=new Date,g>this._buffer.length){var v=s.alloc(g-this._buffer.length,0);this.writeSync(v,0,v.length,this._buffer.length),this._flag.isSynchronous()&&Z.getRootFS().supportsSynch()&&this.syncSync();return}this._stat.size=g;var E=s.alloc(g);this._buffer.copy(E,0,0,g),this._buffer=E,this._flag.isSynchronous()&&Z.getRootFS().supportsSynch()&&this.syncSync()},h.prototype.write=function(g,v,E,T,P){try{P(null,this.writeSync(g,v,E,T),g)}catch(z){P(z)}},h.prototype.writeSync=function(g,v,E,T){if(this._dirty=!0,T==null&&(T=this.getPos()),!this._flag.isWriteable())throw new p(u.EPERM,"File not opened with a writeable mode.");var P=T+E;if(P>this._stat.size&&(this._stat.size=P,P>this._buffer.length)){var z=s.alloc(P);this._buffer.copy(z),this._buffer=z}var G=g.copy(this._buffer,T,v,v+E);return this._stat.mtime=new Date,this._flag.isSynchronous()?(this.syncSync(),G):(this.setPos(T+G),G)},h.prototype.read=function(g,v,E,T,P){try{P(null,this.readSync(g,v,E,T),g)}catch(z){P(z)}},h.prototype.readSync=function(g,v,E,T){if(!this._flag.isReadable())throw new p(u.EPERM,"File not opened with a readable mode.");T==null&&(T=this.getPos());var P=T+E;P>this._stat.size&&(E=this._stat.size-T);var z=this._buffer.copy(g,v,T,T+E);return this._stat.atime=new Date,this._pos=T+E,z},h.prototype.chmod=function(g,v){try{this.chmodSync(g),v()}catch(E){v(E)}},h.prototype.chmodSync=function(g){if(!this._fs.supportsProps())throw new p(u.ENOTSUP);this._dirty=!0,this._stat.chmod(g),this.syncSync()},h.prototype.isDirty=function(){return this._dirty},h.prototype.resetDirty=function(){this._dirty=!1},h}(Ze),St=function(b){function h(y,g,v,E,T){b.call(this,y,g,v,E,T)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.sync=function(g){g()},h.prototype.syncSync=function(){},h.prototype.close=function(g){g()},h.prototype.closeSync=function(){},h}(kt),pt=function(b){function h(y,g,v,E,T){b.call(this,y,g,v,E,T)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},h.prototype.closeSync=function(){this.syncSync()},h}(kt),ee=function(b){function h(y,g,v){if(v===void 0&&(v=!0),b.call(this),this._queue=[],this._queueRunning=!1,this._isInitialized=!1,this._initializeCallbacks=[],this._sync=y,this._async=g,!y.supportsSynch())throw new Error("The first argument to AsyncMirror needs to be a synchronous file system.");F(v,h.Name,{sync:"sync file system instance",async:"async file system instance"})}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){try{var E=new h(g.sync,g.async,!1);E.initialize(function(T){T?v(T):v(null,E)},!1)}catch(T){v(T)}},h.isAvailable=function(){return!0},h.prototype.getName=function(){return h.Name},h.prototype._syncSync=function(g){this._sync.writeFileSync(g.getPath(),g.getBuffer(),null,k.getFileFlag("w"),g.getStats().mode),this.enqueueOp({apiMethod:"writeFile",arguments:[g.getPath(),g.getBuffer(),null,g.getFlag(),g.getStats().mode]})},h.prototype.initialize=function(g,v){var E=this;v===void 0&&(v=!0),v&&console.warn("[AsyncMirror] AsyncMirror.initialize() is deprecated and will be removed in the next major version. Please use 'AsyncMirror.Create({ sync: (sync file system instance), async: (async file system instance)}, cb)' to create and initialize AsyncMirror instances.");var T=this._initializeCallbacks,P=function(xe){E._isInitialized=!xe,E._initializeCallbacks=[],T.forEach(function(Pe){return Pe(xe)})};if(this._isInitialized)g();else if(T.push(g)===1){var z=function(xe,Pe,We){xe!=="/"&&E._sync.mkdirSync(xe,Pe),E._async.readdir(xe,function(Ke,ht){var bt=0;function Pt(Rr){Rr?We(Rr):bt<ht.length?(ue(f.join(xe,ht[bt]),Pt),bt++):We()}Ke?We(Ke):Pt()})},G=function(xe,Pe,We){E._async.readFile(xe,null,k.getFileFlag("r"),function(Ke,ht){if(Ke)We(Ke);else try{E._sync.writeFileSync(xe,ht,null,k.getFileFlag("w"),Pe)}catch(bt){Ke=bt}finally{We(Ke)}})},ue=function(xe,Pe){E._async.stat(xe,!1,function(We,Ke){We?Pe(We):Ke.isDirectory()?z(xe,Ke.mode,Pe):G(xe,Ke.mode,Pe)})};z("/",0,P)}},h.prototype.isReadOnly=function(){return!1},h.prototype.supportsSynch=function(){return!0},h.prototype.supportsLinks=function(){return!1},h.prototype.supportsProps=function(){return this._sync.supportsProps()&&this._async.supportsProps()},h.prototype.renameSync=function(g,v){this.checkInitialized(),this._sync.renameSync(g,v),this.enqueueOp({apiMethod:"rename",arguments:[g,v]})},h.prototype.statSync=function(g,v){return this.checkInitialized(),this._sync.statSync(g,v)},h.prototype.openSync=function(g,v,E){this.checkInitialized();var T=this._sync.openSync(g,v,E);return T.closeSync(),new pt(this,g,v,this._sync.statSync(g,!1),this._sync.readFileSync(g,null,k.getFileFlag("r")))},h.prototype.unlinkSync=function(g){this.checkInitialized(),this._sync.unlinkSync(g),this.enqueueOp({apiMethod:"unlink",arguments:[g]})},h.prototype.rmdirSync=function(g){this.checkInitialized(),this._sync.rmdirSync(g),this.enqueueOp({apiMethod:"rmdir",arguments:[g]})},h.prototype.mkdirSync=function(g,v){this.checkInitialized(),this._sync.mkdirSync(g,v),this.enqueueOp({apiMethod:"mkdir",arguments:[g,v]})},h.prototype.readdirSync=function(g){return this.checkInitialized(),this._sync.readdirSync(g)},h.prototype.existsSync=function(g){return this.checkInitialized(),this._sync.existsSync(g)},h.prototype.chmodSync=function(g,v,E){this.checkInitialized(),this._sync.chmodSync(g,v,E),this.enqueueOp({apiMethod:"chmod",arguments:[g,v,E]})},h.prototype.chownSync=function(g,v,E,T){this.checkInitialized(),this._sync.chownSync(g,v,E,T),this.enqueueOp({apiMethod:"chown",arguments:[g,v,E,T]})},h.prototype.utimesSync=function(g,v,E){this.checkInitialized(),this._sync.utimesSync(g,v,E),this.enqueueOp({apiMethod:"utimes",arguments:[g,v,E]})},h.prototype.checkInitialized=function(){if(!this._isInitialized)throw new p(u.EPERM,"AsyncMirrorFS is not initialized. Please initialize AsyncMirrorFS using its initialize() method before using it.")},h.prototype.enqueueOp=function(g){var v=this;if(this._queue.push(g),!this._queueRunning){this._queueRunning=!0;var E=function(T){if(T&&console.error("WARNING: File system has desynchronized. Received following error: "+T+`
$`),v._queue.length>0){var P=v._queue.shift(),z=P.arguments;z.push(E),v._async[P.apiMethod].apply(v._async,z)}else v._queueRunning=!1};E()}},h}(Xe);ee.Name="AsyncMirror",ee.Options={sync:{type:"object",description:"The synchronous file system to mirror the asynchronous file system to."},async:{type:"object",description:"The asynchronous file system to mirror."}};function j(b,h,y){switch(y.length){case 0:return b.call(h);case 1:return b.call(h,y[0]);case 2:return b.call(h,y[0],y[1]);case 3:return b.call(h,y[0],y[1],y[2])}return b.apply(h,y)}var B=Math.max;function re(b,h,y){return h=B(h===void 0?b.length-1:h,0),function(){for(var g=arguments,v=-1,E=B(g.length-h,0),T=Array(E);++v<E;)T[v]=g[h+v];v=-1;for(var P=Array(h+1);++v<h;)P[v]=g[v];return P[h]=y(T),j(b,this,P)}}function ke(b){return b}function Te(b,h){return re(b,h,ke)}var Me=function(b){return Te(function(h){var y=h.pop();b.call(this,h,y)})};function It(b){return Te(function(h,y){var g=Me(function(v,E){var T=this;return b(h,function(P,z){P.apply(T,v.concat(z))},E)});return y.length?g.apply(this,y):g})}var Dt=typeof a=="object"&&a&&a.Object===Object&&a,Qt=typeof self=="object"&&self&&self.Object===Object&&self,Ir=Dt||Qt||Function("return this")(),Jt=Ir.Symbol,ji=Object.prototype,yl=ji.hasOwnProperty,ho=ji.toString,he=Jt?Jt.toStringTag:void 0;function Hh(b){var h=yl.call(b,he),y=b[he];try{b[he]=void 0;var g=!0}catch{}var v=ho.call(b);return g&&(h?b[he]=y:delete b[he]),v}var Wh=Object.prototype,Jh=Wh.toString;function Ae(b){return Jh.call(b)}var nt="[object Null]",Y="[object Undefined]",ot=Jt?Jt.toStringTag:void 0;function er(b){return b==null?b===void 0?Y:nt:ot&&ot in Object(b)?Hh(b):Ae(b)}function it(b){var h=typeof b;return b!=null&&(h=="object"||h=="function")}var Un="[object AsyncFunction]",at="[object Function]",zr="[object GeneratorFunction]",De="[object Proxy]";function je(b){if(!it(b))return!1;var h=er(b);return h==at||h==zr||h==Un||h==De}var ml=9007199254740991;function ur(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=ml}function ft(b){return b!=null&&ur(b.length)&&!je(b)}var go={};function Qs(){}function tr(b){return function(){if(b!==null){var h=b;b=null,h.apply(this,arguments)}}}var Et=typeof Symbol=="function"&&Symbol.iterator,kr=function(b){return Et&&b[Et]&&b[Et]()};function qr(b,h){for(var y=-1,g=Array(b);++y<b;)g[y]=h(y);return g}function Nr(b){return b!=null&&typeof b=="object"}var is="[object Arguments]";function yo(b){return Nr(b)&&er(b)==is}var rr=Object.prototype,Pr=rr.hasOwnProperty,Ct=rr.propertyIsEnumerable,ei=yo(function(){return arguments}())?yo:function(b){return Nr(b)&&Pr.call(b,"callee")&&!Ct.call(b,"callee")},wi=Array.isArray;function Pf(){return!1}var Bi=typeof n=="object"&&n&&!n.nodeType&&n,mo=Bi&&typeof o=="object"&&o&&!o.nodeType&&o,Ix=mo&&mo.exports===Bi,Mi=Ix?Ir.Buffer:void 0,Nx=Mi?Mi.isBuffer:void 0,Px=Nx||Pf,Lx=9007199254740991,Fx=/^(?:0|[1-9]\d*)$/;function Dx(b,h){return h=h??Lx,!!h&&(typeof b=="number"||Fx.test(b))&&b>-1&&b%1==0&&b<h}var jx="[object Arguments]",Bx="[object Array]",Mx="[object Boolean]",Rx="[object Date]",vv="[object Error]",$x="[object Function]",Ux="[object Map]",_v="[object Number]",zx="[object Object]",Lf="[object RegExp]",Ff="[object Set]",Df="[object String]",wv="[object WeakMap]",Gh="[object ArrayBuffer]",bl="[object DataView]",qx="[object Float32Array]",jf="[object Float64Array]",Kh="[object Int8Array]",Yh="[object Int16Array]",Vc="[object Int32Array]",Xh="[object Uint8Array]",Zh="[object Uint8ClampedArray]",Qh="[object Uint16Array]",eg="[object Uint32Array]",fr={};fr[qx]=fr[jf]=fr[Kh]=fr[Yh]=fr[Vc]=fr[Xh]=fr[Zh]=fr[Qh]=fr[eg]=!0,fr[jx]=fr[Bx]=fr[Gh]=fr[Mx]=fr[bl]=fr[Rx]=fr[vv]=fr[$x]=fr[Ux]=fr[_v]=fr[zx]=fr[Lf]=fr[Ff]=fr[Df]=fr[wv]=!1;function tg(b){return Nr(b)&&ur(b.length)&&!!fr[er(b)]}function rg(b){return function(h){return b(h)}}var Bf=typeof n=="object"&&n&&!n.nodeType&&n,Mf=Bf&&typeof o=="object"&&o&&!o.nodeType&&o,ng=Mf&&Mf.exports===Bf,Hc=ng&&Dt.process,Rf=function(){try{return Hc&&Hc.binding&&Hc.binding("util")}catch{}}(),$f=Rf&&Rf.isTypedArray,ig=$f?rg($f):tg,sg=Object.prototype,ag=sg.hasOwnProperty;function og(b,h){var y=wi(b),g=!y&&ei(b),v=!y&&!g&&Px(b),E=!y&&!g&&!v&&ig(b),T=y||g||v||E,P=T?qr(b.length,String):[],z=P.length;for(var G in b)(h||ag.call(b,G))&&!(T&&(G=="length"||v&&(G=="offset"||G=="parent")||E&&(G=="buffer"||G=="byteLength"||G=="byteOffset")||Dx(G,z)))&&P.push(G);return P}var Wc=Object.prototype;function Vx(b){var h=b&&b.constructor,y=typeof h=="function"&&h.prototype||Wc;return b===y}function Hx(b,h){return function(y){return b(h(y))}}var Sv=Hx(Object.keys,Object),Wx=Object.prototype,xv=Wx.hasOwnProperty;function ea(b){if(!Vx(b))return Sv(b);var h=[];for(var y in Object(b))xv.call(b,y)&&y!="constructor"&&h.push(y);return h}function kv(b){return ft(b)?og(b):ea(b)}function Jx(b){var h=-1,y=b.length;return function(){return++h<y?{value:b[h],key:h}:null}}function Ev(b){var h=-1;return function(){var g=b.next();return g.done?null:(h++,{value:g.value,key:h})}}function Ov(b){var h=kv(b),y=-1,g=h.length;return function(){var E=h[++y];return y<g?{value:b[E],key:E}:null}}function Gx(b){if(ft(b))return Jx(b);var h=kr(b);return h?Ev(h):Ov(b)}function Av(b){return function(){if(b===null)throw new Error("Callback was already called.");var h=b;b=null,h.apply(this,arguments)}}function Pa(b){return function(h,y,g){if(g=tr(g||Qs),b<=0||!h)return g(null);var v=Gx(h),E=!1,T=0;function P(G,ue){if(T-=1,G)E=!0,g(G);else{if(ue===go||E&&T<=0)return E=!0,g(null);z()}}function z(){for(;T<b&&!E;){var G=v();if(G===null){E=!0,T<=0&&g(null);return}T+=1,y(G.value,G.key,Av(P))}}z()}}function lg(b,h,y,g){Pa(h)(b,y,g)}function Es(b,h){return function(y,g,v){return b(y,h,g,v)}}function Tv(b,h,y){y=tr(y||Qs);var g=0,v=0,E=b.length;E===0&&y(null);function T(P,z){P?y(P):(++v===E||z===go)&&y(null)}for(;g<E;g++)h(b[g],g,Av(T))}var Cv=Es(lg,1/0),cg=function(b,h,y){var g=ft(b)?Tv:Cv;g(b,h,y)};function Iv(b){return function(h,y,g){return b(cg,h,y,g)}}function ug(b,h,y,g){g=g||Qs,h=h||[];var v=[],E=0;b(h,function(T,P,z){var G=E++;y(T,function(ue,xe){v[G]=xe,z(ue)})},function(T){g(T,v)})}var Nv=Iv(ug);It(Nv);function Kx(b){return function(h,y,g,v){return b(Pa(y),h,g,v)}}var m=Kx(ug),N=Es(m,1);It(N),Te(function(b,h){return Te(function(y){return b.apply(null,h.concat(y))})});function K(b,h){for(var y=-1,g=b==null?0:b.length;++y<g&&h(b[y],y,b)!==!1;);return b}function M(b){return function(h,y,g){for(var v=-1,E=Object(h),T=g(h),P=T.length;P--;){var z=T[b?P:++v];if(y(E[z],z,E)===!1)break}return h}}var ve=M();function Ie(b,h){return b&&ve(b,h,kv)}function Le(b,h,y,g){for(var v=b.length,E=y+(g?1:-1);g?E--:++E<v;)if(h(b[E],E,b))return E;return-1}function rt(b){return b!==b}function be(b,h,y){for(var g=y-1,v=b.length;++g<v;)if(b[g]===h)return g;return-1}function Qe(b,h,y){return h===h?be(b,h,y):Le(b,rt,y)}var Be="\\ud800-\\udfff",Fe="\\u0300-\\u036f",Ue="\\ufe20-\\ufe2f",ut="\\u20d0-\\u20ff",Ge=Fe+Ue+ut,pn="\\ufe0e\\ufe0f",zn="["+Be+"]",nr="["+Ge+"]",nn="\\ud83c[\\udffb-\\udfff]",ct="(?:"+nr+"|"+nn+")",hn="[^"+Be+"]",vl="(?:\\ud83c[\\udde6-\\uddff]){2}",Jc="[\\ud800-\\udbff][\\udc00-\\udfff]",wt="\\u200d",et=ct+"?",dr="["+pn+"]?",jt="(?:"+wt+"(?:"+[hn,vl,Jc].join("|")+")"+dr+et+")*",Nt=dr+et+jt,st="(?:"+[hn+nr+"?",nr,vl,Jc,zn].join("|")+")",mt=typeof setImmediate=="function"&&setImmediate,sr=typeof l=="object"&&typeof l.nextTick=="function";function qn(b){setTimeout(b,0)}function Uf(b){return Te(function(h,y){b(function(){h.apply(null,y)})})}var zf;mt?zf=setImmediate:sr?zf=l.nextTick:zf=qn,Uf(zf);var Nee=Es(lg,1);function Pee(b,h,y,g){g=tr(g||Qs),Nee(b,function(v,E,T){y(h,v,function(P,z){h=z,T(P)})},function(v){g(v,h)})}var Lee=Te(function(h){return Te(function(y){var g=this,v=y[y.length-1];typeof v=="function"?y.pop():v=Qs,Pee(h,y,function(E,T,P){T.apply(g,E.concat(Te(function(z,G){P(z,G)})))},function(E,T){v.apply(g,[E].concat(T))})})});Te(function(b){return Lee.apply(null,b.reverse())}),Te(function(b){var h=[null].concat(b);return Me(function(y,g){return g.apply(this,h)})});function xF(b){return Te(function(h,y){h.apply(null,y.concat(Te(function(g,v){typeof console=="object"&&(g?console.error&&console.error(g):console[b]&&K(v,function(E){console[b](E)}))})))})}xF("dir");function Fee(b){return function(h,y,g){return b(h,g)}}function kF(b,h,y){cg(b,Fee(h),y)}xF("log");var Pv;sr?Pv=l.nextTick:mt?Pv=setImmediate:Pv=qn,Uf(Pv);var hLe=Math.ceil,gLe=Math.max,Ri;function Dee(){Ri||(Ri={},Ri[Dropbox.ApiError.NETWORK_ERROR]=u.EIO,Ri[Dropbox.ApiError.INVALID_PARAM]=u.EINVAL,Ri[Dropbox.ApiError.INVALID_TOKEN]=u.EPERM,Ri[Dropbox.ApiError.OAUTH_ERROR]=u.EPERM,Ri[Dropbox.ApiError.NOT_FOUND]=u.ENOENT,Ri[Dropbox.ApiError.INVALID_METHOD]=u.EINVAL,Ri[Dropbox.ApiError.NOT_ACCEPTABLE]=u.EINVAL,Ri[Dropbox.ApiError.CONFLICT]=u.EINVAL,Ri[Dropbox.ApiError.RATE_LIMITED]=u.EBUSY,Ri[Dropbox.ApiError.SERVER_ERROR]=u.EBUSY,Ri[Dropbox.ApiError.OVER_QUOTA]=u.ENOSPC)}function jee(b){return b&&b.stat.isFile}function Bee(b){return b&&b.stat.isFolder}function Mee(b){return b==null||typeof b=="object"&&typeof b.byteLength=="number"}var Vn=function(h){this._cache={},this._client=h};Vn.prototype.readdir=function(h,y){var g=this,v=this.getCachedDirInfo(h);this._wrap(function(E){v!==null&&v.contents?g._client.readdir(h,{contentHash:v.stat.contentHash},E):g._client.readdir(h,E)},function(E,T,P,z){E?E.status===Dropbox.ApiError.NO_CONTENT&&v!==null?y(null,v.contents.slice(0)):y(E):(g.updateCachedDirInfo(h,P,T.slice(0)),z.forEach(function(G){g.updateCachedInfo(f.join(h,G.name),G)}),y(null,T))})},Vn.prototype.remove=function(h,y){var g=this;this._wrap(function(v){g._client.remove(h,v)},function(v,E){v||g.updateCachedInfo(h,E),y(v)})},Vn.prototype.move=function(h,y,g){var v=this;this._wrap(function(E){v._client.move(h,y,E)},function(E,T){E||(v.deleteCachedInfo(h),v.updateCachedInfo(y,T)),g(E)})},Vn.prototype.stat=function(h,y){var g=this;this._wrap(function(v){g._client.stat(h,v)},function(v,E){v||g.updateCachedInfo(h,E),y(v,E)})},Vn.prototype.readFile=function(h,y){var g=this,v=this.getCachedFileInfo(h);v!==null&&v.contents!==null?this.stat(h,function(E,T){E?y(E):T.contentHash===v.stat.contentHash?y(E,v.contents.slice(0),v.stat):g.readFile(h,y)}):this._wrap(function(E){g._client.readFile(h,{arrayBuffer:!0},E)},function(E,T,P){E||g.updateCachedInfo(h,P,T.slice(0)),y(E,T,P)})},Vn.prototype.writeFile=function(h,y,g){var v=this;this._wrap(function(E){v._client.writeFile(h,y,E)},function(E,T){E||v.updateCachedInfo(h,T,y.slice(0)),g(E,T)})},Vn.prototype.mkdir=function(h,y){var g=this;this._wrap(function(v){g._client.mkdir(h,v)},function(v,E){v||g.updateCachedInfo(h,E,[]),y(v)})},Vn.prototype._wrap=function(h,y){var g=0,v=function(E){var T=2;if(E&&3>++g)switch(E.status){case Dropbox.ApiError.SERVER_ERROR:case Dropbox.ApiError.NETWORK_ERROR:case Dropbox.ApiError.RATE_LIMITED:setTimeout(function(){h(v)},T*1e3);break;default:y.apply(null,arguments);break}else y.apply(null,arguments)};h(v)},Vn.prototype.getCachedInfo=function(h){return this._cache[h.toLowerCase()]},Vn.prototype.putCachedInfo=function(h,y){this._cache[h.toLowerCase()]=y},Vn.prototype.deleteCachedInfo=function(h){delete this._cache[h.toLowerCase()]},Vn.prototype.getCachedDirInfo=function(h){var y=this.getCachedInfo(h);return Bee(y)?y:null},Vn.prototype.getCachedFileInfo=function(h){var y=this.getCachedInfo(h);return jee(y)?y:null},Vn.prototype.updateCachedDirInfo=function(h,y,g){g===void 0&&(g=null);var v=this.getCachedInfo(h);y.contentHash!==null&&(v===void 0||v.stat.contentHash!==y.contentHash)&&this.putCachedInfo(h,{stat:y,contents:g})},Vn.prototype.updateCachedFileInfo=function(h,y,g){g===void 0&&(g=null);var v=this.getCachedInfo(h);y.versionTag!==null&&(v===void 0||v.stat.versionTag!==y.versionTag)&&this.putCachedInfo(h,{stat:y,contents:g})},Vn.prototype.updateCachedInfo=function(h,y,g){g===void 0&&(g=null),y.isFile&&Mee(g)?this.updateCachedFileInfo(h,y,g):y.isFolder&&Array.isArray(g)&&this.updateCachedDirInfo(h,y,g)};var Ree=function(b){function h(y,g,v,E,T){b.call(this,y,g,v,E,T)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.sync=function(g){var v=this;if(this.isDirty()){var E=this.getBuffer(),T=q(E);this._fs._writeFileStrict(this.getPath(),T,function(P){P||v.resetDirty(),g(P)})}else g()},h.prototype.close=function(g){this.sync(g)},h}(kt),Lv=function(b){function h(y,g){g===void 0&&(g=!0),b.call(this),this._client=new Vn(y),F(g,h.Name,{client:"authenticated dropbox client instance"}),Dee()}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){v(null,new h(g.client,!1))},h.isAvailable=function(){return typeof Dropbox<"u"},h.prototype.getName=function(){return h.Name},h.prototype.isReadOnly=function(){return!1},h.prototype.supportsSymlinks=function(){return!1},h.prototype.supportsProps=function(){return!1},h.prototype.supportsSynch=function(){return!1},h.prototype.empty=function(g){var v=this;this._client.readdir("/",function(E,T){if(E)g(v.convert(E,"/"));else{var P=function(G,ue){var xe=f.join("/",G);v._client.remove(xe,function(Pe){ue(Pe?v.convert(Pe,xe):null)})},z=function(G){G?g(G):g()};kF(T,P,z)}})},h.prototype.rename=function(g,v,E){var T=this;this._client.move(g,v,function(P){P?T._client.stat(v,function(z,G){if(z||G.isFolder){var ue=P.response.error.indexOf(g)>-1?g:v;E(T.convert(P,ue))}else T._client.remove(v,function(xe){xe?E(T.convert(xe,v)):T.rename(g,v,E)})}):E()})},h.prototype.stat=function(g,v,E){var T=this;this._client.stat(g,function(P,z){if(P)E(T.convert(P,g));else if(z&&z.isRemoved)E(p.FileError(u.ENOENT,g));else{var G=new O(T._statType(z),z.size);return E(null,G)}})},h.prototype.open=function(g,v,E,T){var P=this;this._client.readFile(g,function(z,G,ue){if(z)if(v.isReadable())T(P.convert(z,g));else switch(z.status){case Dropbox.ApiError.NOT_FOUND:var xe=new ArrayBuffer(0);return P._writeFileStrict(g,xe,function(Ke,ht){if(Ke)T(Ke);else{var bt=P._makeFile(g,v,ht,_e(xe));T(null,bt)}});default:return T(P.convert(z,g))}else{var Pe;G===null?Pe=le():Pe=_e(G);var We=P._makeFile(g,v,ue,Pe);return T(null,We)}})},h.prototype._writeFileStrict=function(g,v,E){var T=this,P=f.dirname(g);this.stat(P,!1,function(z,G){z?E(p.FileError(u.ENOENT,P)):T._client.writeFile(g,v,function(ue,xe){ue?E(T.convert(ue,g)):E(null,xe)})})},h.prototype._statType=function(g){return g.isFile?S.FILE:S.DIRECTORY},h.prototype._makeFile=function(g,v,E,T){var P=this._statType(E),z=new O(P,E.size);return new Ree(this,g,v,z,T)},h.prototype._remove=function(g,v,E){var T=this;this._client.stat(g,function(P,z){P?v(T.convert(P,g)):z.isFile&&!E?v(p.FileError(u.ENOTDIR,g)):!z.isFile&&E?v(p.FileError(u.EISDIR,g)):T._client.remove(g,function(G){v(G?T.convert(G,g):null)})})},h.prototype.unlink=function(g,v){this._remove(g,v,!0)},h.prototype.rmdir=function(g,v){this._remove(g,v,!1)},h.prototype.mkdir=function(g,v,E){var T=this,P=f.dirname(g);this._client.stat(P,function(z,G){z?E(T.convert(z,P)):T._client.mkdir(g,function(ue){E(ue?p.FileError(u.EEXIST,g):null)})})},h.prototype.readdir=function(g,v){var E=this;this._client.readdir(g,function(T,P){return T?v(E.convert(T)):v(null,P)})},h.prototype.convert=function(g,v){v===void 0&&(v=null);var E=Ri[g.status];return E===void 0&&(E=u.EIO),v?p.FileError(E,v):new p(E)},h}(Ce);Lv.Name="Dropbox",Lv.Options={client:{type:"object",description:"An *authenticated* Dropbox client. Must be from the 0.10 JS SDK.",validator:function(b,h){b.isAuthenticated&&b.isAuthenticated()?h():h(new p(u.EINVAL,"'client' option must be an authenticated Dropbox client from the v0.10 JS SDK."))}}};function Vr(b,h){h===void 0&&(h="");for(var y=b.errno,g=b.node,v=[];g&&(v.unshift(g.name),g!==g.parent);)g=g.parent;return new p(y,d[y],v.length>0?"/"+v.join("/"):h)}var $ee=function(b){function h(y,g,v,E){b.call(this),this._fs=y,this._FS=g,this._path=v,this._stream=E}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.getPos=function(){},h.prototype.close=function(g){var v=null;try{this.closeSync()}catch(E){v=E}finally{g(v)}},h.prototype.closeSync=function(){try{this._FS.close(this._stream)}catch(g){throw Vr(g,this._path)}},h.prototype.stat=function(g){try{g(null,this.statSync())}catch(v){g(v)}},h.prototype.statSync=function(){try{return this._fs.statSync(this._path,!1)}catch(g){throw Vr(g,this._path)}},h.prototype.truncate=function(g,v){var E=null;try{this.truncateSync(g)}catch(T){E=T}finally{v(E)}},h.prototype.truncateSync=function(g){try{this._FS.ftruncate(this._stream.fd,g)}catch(v){throw Vr(v,this._path)}},h.prototype.write=function(g,v,E,T,P){try{P(null,this.writeSync(g,v,E,T),g)}catch(z){P(z)}},h.prototype.writeSync=function(g,v,E,T){try{var P=ie(g),z=T===null?void 0:T;return this._FS.write(this._stream,P,v,E,z)}catch(G){throw Vr(G,this._path)}},h.prototype.read=function(g,v,E,T,P){try{P(null,this.readSync(g,v,E,T),g)}catch(z){P(z)}},h.prototype.readSync=function(g,v,E,T){try{var P=ie(g),z=T===null?void 0:T;return this._FS.read(this._stream,P,v,E,z)}catch(G){throw Vr(G,this._path)}},h.prototype.sync=function(g){g()},h.prototype.syncSync=function(){},h.prototype.chown=function(g,v,E){var T=null;try{this.chownSync(g,v)}catch(P){T=P}finally{E(T)}},h.prototype.chownSync=function(g,v){try{this._FS.fchown(this._stream.fd,g,v)}catch(E){throw Vr(E,this._path)}},h.prototype.chmod=function(g,v){var E=null;try{this.chmodSync(g)}catch(T){E=T}finally{v(E)}},h.prototype.chmodSync=function(g){try{this._FS.fchmod(this._stream.fd,g)}catch(v){throw Vr(v,this._path)}},h.prototype.utimes=function(g,v,E){var T=null;try{this.utimesSync(g,v)}catch(P){T=P}finally{E(T)}},h.prototype.utimesSync=function(g,v){this._fs.utimesSync(this._path,g,v)},h}(Ze),Fv=function(b){function h(y){b.call(this),this._FS=y}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){v(null,new h(g.FS))},h.isAvailable=function(){return!0},h.prototype.getName=function(){return this._FS.DB_NAME()},h.prototype.isReadOnly=function(){return!1},h.prototype.supportsLinks=function(){return!0},h.prototype.supportsProps=function(){return!0},h.prototype.supportsSynch=function(){return!0},h.prototype.renameSync=function(g,v){try{this._FS.rename(g,v)}catch(E){throw E.errno===u.ENOENT?Vr(E,this.existsSync(g)?v:g):Vr(E)}},h.prototype.statSync=function(g,v){try{var E=v?this._FS.lstat(g):this._FS.stat(g),T=this.modeToFileType(E.mode);return new O(T,E.size,E.mode,E.atime,E.mtime,E.ctime)}catch(P){throw Vr(P,g)}},h.prototype.openSync=function(g,v,E){try{var T=this._FS.open(g,v.getFlagString(),E);if(this._FS.isDir(T.node.mode))throw this._FS.close(T),p.EISDIR(g);return new $ee(this,this._FS,g,T)}catch(P){throw Vr(P,g)}},h.prototype.unlinkSync=function(g){try{this._FS.unlink(g)}catch(v){throw Vr(v,g)}},h.prototype.rmdirSync=function(g){try{this._FS.rmdir(g)}catch(v){throw Vr(v,g)}},h.prototype.mkdirSync=function(g,v){try{this._FS.mkdir(g,v)}catch(E){throw Vr(E,g)}},h.prototype.readdirSync=function(g){try{return this._FS.readdir(g).filter(function(v){return v!=="."&&v!==".."})}catch(v){throw Vr(v,g)}},h.prototype.truncateSync=function(g,v){try{this._FS.truncate(g,v)}catch(E){throw Vr(E,g)}},h.prototype.readFileSync=function(g,v,E){try{var T=this._FS.readFile(g,{flags:E.getFlagString()}),P=fe(T);return v?P.toString(v):P}catch(z){throw Vr(z,g)}},h.prototype.writeFileSync=function(g,v,E,T,P){try{E&&(v=s.from(v,E));var z=ie(v);this._FS.writeFile(g,z,{flags:T.getFlagString(),encoding:"binary"}),this._FS.chmod(g,P)}catch(G){throw Vr(G,g)}},h.prototype.chmodSync=function(g,v,E){try{v?this._FS.lchmod(g,E):this._FS.chmod(g,E)}catch(T){throw Vr(T,g)}},h.prototype.chownSync=function(g,v,E,T){try{v?this._FS.lchown(g,E,T):this._FS.chown(g,E,T)}catch(P){throw Vr(P,g)}},h.prototype.symlinkSync=function(g,v,E){try{this._FS.symlink(g,v)}catch(T){throw Vr(T)}},h.prototype.readlinkSync=function(g){try{return this._FS.readlink(g)}catch(v){throw Vr(v,g)}},h.prototype.utimesSync=function(g,v,E){try{this._FS.utime(g,v.getTime(),E.getTime())}catch(T){throw Vr(T,g)}},h.prototype.modeToFileType=function(g){if(this._FS.isDir(g))return S.DIRECTORY;if(this._FS.isFile(g))return S.FILE;if(this._FS.isLink(g))return S.SYMLINK;throw p.EPERM("Invalid mode: "+g)},h}(Xe);Fv.Name="EmscriptenFileSystem",Fv.Options={FS:{type:"object",description:"The Emscripten file system to use (the `FS` variable)"}};var qf=function(b){function h(y,g){b.call(this),this._folder=y,this._wrapped=g}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){v(null,new h(g.folder,g.wrapped))},h.isAvailable=function(){return!0},h.prototype.initialize=function(g){var v=this;this._wrapped.exists(this._folder,function(E){E?g():v._wrapped.isReadOnly()?g(p.ENOENT(v._folder)):v._wrapped.mkdir(v._folder,511,g)})},h.prototype.getName=function(){return this._wrapped.getName()},h.prototype.isReadOnly=function(){return this._wrapped.isReadOnly()},h.prototype.supportsProps=function(){return this._wrapped.supportsProps()},h.prototype.supportsSynch=function(){return this._wrapped.supportsSynch()},h.prototype.supportsLinks=function(){return!1},h}(Ce);qf.Name="FolderAdapter",qf.Options={folder:{type:"string",description:"The folder to use as the root directory"},wrapped:{type:"object",description:"The file system to wrap"}};function EF(b,h){if(h!==null&&typeof h=="object"){var y=h,g=y.path;g&&(g="/"+f.relative(b,g),y.message=y.message.replace(y.path,g),y.path=g)}return h}function Uee(b,h){return typeof h=="function"?function(y){arguments.length>0&&(arguments[0]=EF(b,y)),h.apply(null,arguments)}:h}function OF(b,h,y){return b.slice(b.length-4)!=="Sync"?function(){return arguments.length>0&&(h&&(arguments[0]=f.join(this._folder,arguments[0])),y&&(arguments[1]=f.join(this._folder,arguments[1])),arguments[arguments.length-1]=Uee(this._folder,arguments[arguments.length-1])),this._wrapped[b].apply(this._wrapped,arguments)}:function(){try{return h&&(arguments[0]=f.join(this._folder,arguments[0])),y&&(arguments[1]=f.join(this._folder,arguments[1])),this._wrapped[b].apply(this._wrapped,arguments)}catch(g){throw EF(this._folder,g)}}}["diskSpace","stat","statSync","open","openSync","unlink","unlinkSync","rmdir","rmdirSync","mkdir","mkdirSync","readdir","readdirSync","exists","existsSync","realpath","realpathSync","truncate","truncateSync","readFile","readFileSync","writeFile","writeFileSync","appendFile","appendFileSync","chmod","chmodSync","chown","chownSync","utimes","utimesSync","readlink","readlinkSync"].forEach(function(b){qf.prototype[b]=OF(b,!0,!1)}),["rename","renameSync","link","linkSync","symlink","symlinkSync"].forEach(function(b){qf.prototype[b]=OF(b,!0,!0)});var Dv;typeof window<"u"?Dv=window:typeof self<"u"?Dv=self:Dv=a;var sn=Dv;function zee(b){return b.isDirectory}var Yx=sn.webkitRequestFileSystem||sn.requestFileSystem||null;function qee(b,h,y,g){if(typeof navigator.webkitPersistentStorage<"u")switch(b){case sn.PERSISTENT:navigator.webkitPersistentStorage.requestQuota(h,y,g);break;case sn.TEMPORARY:navigator.webkitTemporaryStorage.requestQuota(h,y,g);break;default:g(new TypeError("Invalid storage type: "+b));break}else sn.webkitStorageInfo.requestQuota(b,h,y,g)}function Vee(b){return Array.prototype.slice.call(b||[],0)}function La(b,h,y){switch(b.name){case"PathExistsError":return p.EEXIST(h);case"QuotaExceededError":return p.FileError(u.ENOSPC,h);case"NotFoundError":return p.ENOENT(h);case"SecurityError":return p.FileError(u.EACCES,h);case"InvalidModificationError":return p.FileError(u.EPERM,h);case"TypeMismatchError":return p.FileError(y?u.ENOTDIR:u.EISDIR,h);case"EncodingError":case"InvalidStateError":case"NoModificationAllowedError":default:return p.FileError(u.EINVAL,h)}}var Hee=function(b){function h(y,g,v,E,T,P){b.call(this,y,v,E,T,P),this._entry=g}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.sync=function(g){var v=this;if(!this.isDirty())return g();this._entry.createWriter(function(E){var T=v.getBuffer(),P=new Blob([q(T)]),z=P.size;E.onwriteend=function(G){E.onwriteend=null,E.onerror=null,E.truncate(z),v.resetDirty(),g()},E.onerror=function(G){g(La(G,v.getPath(),!1))},E.write(P)})},h.prototype.close=function(g){this.sync(g)},h}(kt),jv=function(b){function h(y,g,v){y===void 0&&(y=5),g===void 0&&(g=sn.PERSISTENT),v===void 0&&(v=!0),b.call(this),this.size=1024*1024*y,this.type=g,F(v,h.Name,{size:y,type:g})}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){var E=new h(g.size,g.type,!1);E.allocate(function(T){return T?v(T):v(null,E)},!1)},h.isAvailable=function(){return!!Yx},h.prototype.getName=function(){return h.Name},h.prototype.isReadOnly=function(){return!1},h.prototype.supportsSymlinks=function(){return!1},h.prototype.supportsProps=function(){return!1},h.prototype.supportsSynch=function(){return!1},h.prototype.allocate=function(g,v){var E=this;g===void 0&&(g=function(){}),v===void 0&&(v=!0),v&&console.warn("[HTML5FS] HTML5FS.allocate() is deprecated and will be removed in the next major release. Please use 'HTML5FS.Create({type: "+this.type+", size: "+this.size+"}, cb)' to create and allocate HTML5FS instances.");var T=function(z){E.fs=z,g()},P=function(z){g(La(z,"/",!0))};this.type===sn.PERSISTENT?qee(this.type,this.size,function(z){Yx(E.type,z,T,P)},P):Yx(this.type,this.size,T,P)},h.prototype.empty=function(g){this._readdir("/",function(v,E){if(v)console.error("Failed to empty FS"),g(v);else{var T=function(z){v?(console.error("Failed to empty FS"),g(v)):g()},P=function(z,G){var ue=function(){G()},xe=function(Pe){G(La(Pe,z.fullPath,!z.isDirectory))};zee(z)?z.removeRecursively(ue,xe):z.remove(ue,xe)};kF(E,P,T)}})},h.prototype.rename=function(g,v,E){var T=this,P=2,z=0,G=this.fs.root,ue=g,xe=function(We){--P<=0&&E(La(We,ue,!1))},Pe=function(We){if(++z===2)return E(new p(u.EINVAL,"Something was identified as both a file and a directory. This should never happen."));if(g===v)return E();ue=f.dirname(v),G.getDirectory(ue,{},function(Ke){ue=f.basename(v),We.moveTo(Ke,ue,function(ht){E()},function(ht){We.isDirectory?(ue=v,T.unlink(v,function(bt){bt?xe(ht):T.rename(g,v,E)})):xe(ht)})},xe)};G.getFile(g,{},Pe,xe),G.getDirectory(g,{},Pe,xe)},h.prototype.stat=function(g,v,E){var T=this,P={create:!1},z=function(Pe){var We=function(Ke){var ht=new O(S.FILE,Ke.size);E(null,ht)};Pe.file(We,ue)},G=function(Pe){var We=4096,Ke=new O(S.DIRECTORY,We);E(null,Ke)},ue=function(Pe){E(La(Pe,g,!1))},xe=function(){T.fs.root.getDirectory(g,P,G,ue)};this.fs.root.getFile(g,P,z,xe)},h.prototype.open=function(g,v,E,T){var P=this,z=function(G){G.name==="InvalidModificationError"&&v.isExclusive()?T(p.EEXIST(g)):T(La(G,g,!1))};this.fs.root.getFile(g,{create:v.pathNotExistsAction()===w.CREATE_FILE,exclusive:v.isExclusive()},function(G){G.file(function(ue){var xe=new FileReader;xe.onloadend=function(Pe){var We=P._makeFile(g,G,v,ue,xe.result);T(null,We)},xe.onerror=function(Pe){z(xe.error)},xe.readAsArrayBuffer(ue)},z)},z)},h.prototype.unlink=function(g,v){this._remove(g,v,!0)},h.prototype.rmdir=function(g,v){var E=this;this.readdir(g,function(T,P){T?v(T):P.length>0?v(p.ENOTEMPTY(g)):E._remove(g,v,!1)})},h.prototype.mkdir=function(g,v,E){var T={create:!0,exclusive:!0},P=function(G){E()},z=function(G){E(La(G,g,!0))};this.fs.root.getDirectory(g,T,P,z)},h.prototype.readdir=function(g,v){this._readdir(g,function(E,T){if(T){for(var P=[],z=0,G=T;z<G.length;z+=1){var ue=G[z];P.push(ue.name)}v(null,P)}else return v(E)})},h.prototype._makeFile=function(g,v,E,T,P){P===void 0&&(P=new ArrayBuffer(0));var z=new O(S.FILE,T.size),G=_e(P);return new Hee(this,v,g,E,z,G)},h.prototype._readdir=function(g,v){var E=function(T){v(La(T,g,!0))};this.fs.root.getDirectory(g,{create:!1},function(T){var P=T.createReader(),z=[],G=function(){P.readEntries(function(ue){ue.length?(z=z.concat(Vee(ue)),G()):v(null,z)},E)};G()},E)},h.prototype._remove=function(g,v,E){var T=function(G){var ue=function(){v()},xe=function(Pe){v(La(Pe,g,!E))};G.remove(ue,xe)},P=function(G){v(La(G,g,!E))},z={create:!1};E?this.fs.root.getFile(g,z,T,P):this.fs.root.getDirectory(g,z,T,P)},h}(Ce);jv.Name="HTML5FS",jv.Options={size:{type:"number",optional:!0,description:"Storage quota to request, in megabytes. Allocated value may be less. Defaults to 5."},type:{type:"number",optional:!0,description:"window.PERSISTENT or window.TEMPORARY. Defaults to PERSISTENT."}};var $i=function(h,y,g,v,E,T){this.id=h,this.size=y,this.mode=g,this.atime=v,this.mtime=E,this.ctime=T};$i.fromBuffer=function(h){if(h===void 0)throw new Error("NO");return new $i(h.toString("ascii",30),h.readUInt32LE(0),h.readUInt16LE(4),h.readDoubleLE(6),h.readDoubleLE(14),h.readDoubleLE(22))},$i.prototype.toStats=function(){return new O((this.mode&61440)===S.DIRECTORY?S.DIRECTORY:S.FILE,this.size,this.mode,new Date(this.atime),new Date(this.mtime),new Date(this.ctime))},$i.prototype.getSize=function(){return 30+this.id.length},$i.prototype.toBuffer=function(h){return h===void 0&&(h=s.alloc(this.getSize())),h.writeUInt32LE(this.size,0),h.writeUInt16LE(this.mode,4),h.writeDoubleLE(this.atime,6),h.writeDoubleLE(this.mtime,14),h.writeDoubleLE(this.ctime,22),h.write(this.id,30,this.id.length,"ascii"),h},$i.prototype.update=function(h){var y=!1;this.size!==h.size&&(this.size=h.size,y=!0),this.mode!==h.mode&&(this.mode=h.mode,y=!0);var g=h.atime.getTime();this.atime!==g&&(this.atime=g,y=!0);var v=h.mtime.getTime();this.mtime!==v&&(this.mtime=v,y=!0);var E=h.ctime.getTime();return this.ctime!==E&&(this.ctime=E,y=!0),y},$i.prototype.isFile=function(){return(this.mode&61440)===S.FILE},$i.prototype.isDirectory=function(){return(this.mode&61440)===S.DIRECTORY};var _l="/",Xx=null;function AF(){return Xx||(Xx=s.from("{}"))}function Bv(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var h=Math.random()*16|0,y=b==="x"?h:h&3|8;return y.toString(16)})}function ss(b,h){return b?(h(b),!1):!0}function gn(b,h,y){return b?(h.abort(function(){y(b)}),!1):!0}var bo=function(h){this.store=h,this.originalData={},this.modifiedKeys=[]};bo.prototype.get=function(h){var y=this.store.get(h);return this.stashOldValue(h,y),y},bo.prototype.put=function(h,y,g){return this.markModified(h),this.store.put(h,y,g)},bo.prototype.del=function(h){this.markModified(h),this.store.del(h)},bo.prototype.commit=function(){},bo.prototype.abort=function(){for(var h=this,y=0,g=h.modifiedKeys;y<g.length;y+=1){var v=g[y],E=h.originalData[v];E?h.store.put(v,E,!0):h.store.del(v)}},bo.prototype.stashOldValue=function(h,y){this.originalData.hasOwnProperty(h)||(this.originalData[h]=y)},bo.prototype.markModified=function(h){this.modifiedKeys.indexOf(h)===-1&&(this.modifiedKeys.push(h),this.originalData.hasOwnProperty(h)||(this.originalData[h]=this.store.get(h)))};var TF=function(b){function h(y,g,v,E,T){b.call(this,y,g,v,E,T)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this.getPath(),this.getBuffer(),this.getStats()),this.resetDirty())},h.prototype.closeSync=function(){this.syncSync()},h}(kt),CF=function(b){function h(y){b.call(this),this.store=y.store,this.makeRootDirectory()}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.isAvailable=function(){return!0},h.prototype.getName=function(){return this.store.name()},h.prototype.isReadOnly=function(){return!1},h.prototype.supportsSymlinks=function(){return!1},h.prototype.supportsProps=function(){return!1},h.prototype.supportsSynch=function(){return!0},h.prototype.empty=function(){this.store.clear(),this.makeRootDirectory()},h.prototype.renameSync=function(g,v){var E=this.store.beginTransaction("readwrite"),T=f.dirname(g),P=f.basename(g),z=f.dirname(v),G=f.basename(v),ue=this.findINode(E,T),xe=this.getDirListing(E,T,ue);if(!xe[P])throw p.ENOENT(g);var Pe=xe[P];if(delete xe[P],(z+"/").indexOf(g+"/")===0)throw new p(u.EBUSY,T);var We,Ke;if(z===T?(We=ue,Ke=xe):(We=this.findINode(E,z),Ke=this.getDirListing(E,z,We)),Ke[G]){var ht=this.getINode(E,v,Ke[G]);if(ht.isFile())try{E.del(ht.id),E.del(Ke[G])}catch(bt){throw E.abort(),bt}else throw p.EPERM(v)}Ke[G]=Pe;try{E.put(ue.id,s.from(JSON.stringify(xe)),!0),E.put(We.id,s.from(JSON.stringify(Ke)),!0)}catch(bt){throw E.abort(),bt}E.commit()},h.prototype.statSync=function(g,v){return this.findINode(this.store.beginTransaction("readonly"),g).toStats()},h.prototype.createFileSync=function(g,v,E){var T=this.store.beginTransaction("readwrite"),P=le(),z=this.commitNewFile(T,g,S.FILE,E,P);return new TF(this,g,v,z.toStats(),P)},h.prototype.openFileSync=function(g,v){var E=this.store.beginTransaction("readonly"),T=this.findINode(E,g),P=E.get(T.id);if(P===void 0)throw p.ENOENT(g);return new TF(this,g,v,T.toStats(),P)},h.prototype.unlinkSync=function(g){this.removeEntry(g,!1)},h.prototype.rmdirSync=function(g){if(this.readdirSync(g).length>0)throw p.ENOTEMPTY(g);this.removeEntry(g,!0)},h.prototype.mkdirSync=function(g,v){var E=this.store.beginTransaction("readwrite"),T=s.from("{}");this.commitNewFile(E,g,S.DIRECTORY,v,T)},h.prototype.readdirSync=function(g){var v=this.store.beginTransaction("readonly");return Object.keys(this.getDirListing(v,g,this.findINode(v,g)))},h.prototype._syncSync=function(g,v,E){var T=this.store.beginTransaction("readwrite"),P=this._findINode(T,f.dirname(g),f.basename(g)),z=this.getINode(T,g,P),G=z.update(E);try{T.put(z.id,v,!0),G&&T.put(P,z.toBuffer(),!0)}catch(ue){throw T.abort(),ue}T.commit()},h.prototype.makeRootDirectory=function(){var g=this.store.beginTransaction("readwrite");if(g.get(_l)===void 0){var v=new Date().getTime(),E=new $i(Bv(),4096,511|S.DIRECTORY,v,v,v);g.put(E.id,AF(),!1),g.put(_l,E.toBuffer(),!1),g.commit()}},h.prototype._findINode=function(g,v,E){var T=this,P=function(z){var G=T.getDirListing(g,v,z);if(G[E])return G[E];throw p.ENOENT(f.resolve(v,E))};return v==="/"?E===""?_l:P(this.getINode(g,v,_l)):P(this.getINode(g,v+f.sep+E,this._findINode(g,f.dirname(v),f.basename(v))))},h.prototype.findINode=function(g,v){return this.getINode(g,v,this._findINode(g,f.dirname(v),f.basename(v)))},h.prototype.getINode=function(g,v,E){var T=g.get(E);if(T===void 0)throw p.ENOENT(v);return $i.fromBuffer(T)},h.prototype.getDirListing=function(g,v,E){if(!E.isDirectory())throw p.ENOTDIR(v);var T=g.get(E.id);if(T===void 0)throw p.ENOENT(v);return JSON.parse(T.toString())},h.prototype.addNewNode=function(g,v){for(var E=0,T;E<5;)try{return T=Bv(),g.put(T,v,!1),T}catch{}throw new p(u.EIO,"Unable to commit data to key-value store.")},h.prototype.commitNewFile=function(g,v,E,T,P){var z=f.dirname(v),G=f.basename(v),ue=this.findINode(g,z),xe=this.getDirListing(g,z,ue),Pe=new Date().getTime();if(v==="/"||xe[G])throw p.EEXIST(v);var We;try{var Ke=this.addNewNode(g,P);We=new $i(Ke,P.length,T|E,Pe,Pe,Pe);var ht=this.addNewNode(g,We.toBuffer());xe[G]=ht,g.put(ue.id,s.from(JSON.stringify(xe)),!0)}catch(bt){throw g.abort(),bt}return g.commit(),We},h.prototype.removeEntry=function(g,v){var E=this.store.beginTransaction("readwrite"),T=f.dirname(g),P=this.findINode(E,T),z=this.getDirListing(E,T,P),G=f.basename(g);if(!z[G])throw p.ENOENT(g);var ue=z[G];delete z[G];var xe=this.getINode(E,g,ue);if(!v&&xe.isDirectory())throw p.EISDIR(g);if(v&&!xe.isDirectory())throw p.ENOTDIR(g);try{E.del(xe.id),E.del(ue),E.put(P.id,s.from(JSON.stringify(z)),!0)}catch(Pe){throw E.abort(),Pe}E.commit()},h}(Xe),IF=function(b){function h(y,g,v,E,T){b.call(this,y,g,v,E,T)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.sync=function(g){var v=this;this.isDirty()?this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),function(E){E||v.resetDirty(),g(E)}):g()},h.prototype.close=function(g){this.sync(g)},h}(kt),Wee=function(b){function h(){b.apply(this,arguments)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.isAvailable=function(){return!0},h.prototype.init=function(g,v){this.store=g,this.makeRootDirectory(v)},h.prototype.getName=function(){return this.store.name()},h.prototype.isReadOnly=function(){return!1},h.prototype.supportsSymlinks=function(){return!1},h.prototype.supportsProps=function(){return!1},h.prototype.supportsSynch=function(){return!1},h.prototype.empty=function(g){var v=this;this.store.clear(function(E){ss(E,g)&&v.makeRootDirectory(g)})},h.prototype.rename=function(g,v,E){var T=this,P=this.store.beginTransaction("readwrite"),z=f.dirname(g),G=f.basename(g),ue=f.dirname(v),xe=f.basename(v),Pe={},We={},Ke=!1;if((ue+"/").indexOf(g+"/")===0)return E(new p(u.EBUSY,z));var ht=function(){if(!(Ke||!We.hasOwnProperty(z)||!We.hasOwnProperty(ue))){var Pt=We[z],Rr=Pe[z],Hn=We[ue],ja=Pe[ue];if(!Pt[G])E(p.ENOENT(g));else{var Ba=Pt[G];delete Pt[G];var Yf=function(){Hn[xe]=Ba,P.put(Rr.id,s.from(JSON.stringify(Pt)),!0,function(wo){gn(wo,P,E)&&(z===ue?P.commit(E):P.put(ja.id,s.from(JSON.stringify(Hn)),!0,function(So){gn(So,P,E)&&P.commit(E)}))})};Hn[xe]?T.getINode(P,v,Hn[xe],function(wo,So){gn(wo,P,E)&&(So.isFile()?P.del(So.id,function(vD){gn(vD,P,E)&&P.del(Hn[xe],function(_te){gn(_te,P,E)&&Yf()})}):P.abort(function(vD){E(p.EPERM(v))}))}):Yf()}}},bt=function(Pt){T.findINodeAndDirListing(P,Pt,function(Rr,Hn,ja){Rr?Ke||(Ke=!0,P.abort(function(){E(Rr)})):(Pe[Pt]=Hn,We[Pt]=ja,ht())})};bt(z),z!==ue&&bt(ue)},h.prototype.stat=function(g,v,E){var T=this.store.beginTransaction("readonly");this.findINode(T,g,function(P,z){ss(P,E)&&E(null,z.toStats())})},h.prototype.createFile=function(g,v,E,T){var P=this,z=this.store.beginTransaction("readwrite"),G=le();this.commitNewFile(z,g,S.FILE,E,G,function(ue,xe){ss(ue,T)&&T(null,new IF(P,g,v,xe.toStats(),G))})},h.prototype.openFile=function(g,v,E){var T=this,P=this.store.beginTransaction("readonly");this.findINode(P,g,function(z,G){ss(z,E)&&P.get(G.id,function(ue,xe){ss(ue,E)&&(xe===void 0?E(p.ENOENT(g)):E(null,new IF(T,g,v,G.toStats(),xe)))})})},h.prototype.unlink=function(g,v){this.removeEntry(g,!1,v)},h.prototype.rmdir=function(g,v){var E=this;this.readdir(g,function(T,P){T?v(T):P.length>0?v(p.ENOTEMPTY(g)):E.removeEntry(g,!0,v)})},h.prototype.mkdir=function(g,v,E){var T=this.store.beginTransaction("readwrite"),P=s.from("{}");this.commitNewFile(T,g,S.DIRECTORY,v,P,E)},h.prototype.readdir=function(g,v){var E=this,T=this.store.beginTransaction("readonly");this.findINode(T,g,function(P,z){ss(P,v)&&E.getDirListing(T,g,z,function(G,ue){ss(G,v)&&v(null,Object.keys(ue))})})},h.prototype._sync=function(g,v,E,T){var P=this,z=this.store.beginTransaction("readwrite");this._findINode(z,f.dirname(g),f.basename(g),function(G,ue){gn(G,z,T)&&P.getINode(z,g,ue,function(xe,Pe){if(gn(xe,z,T)){var We=Pe.update(E);z.put(Pe.id,v,!0,function(Ke){gn(Ke,z,T)&&(We?z.put(ue,Pe.toBuffer(),!0,function(ht){gn(ht,z,T)&&z.commit(T)}):z.commit(T))})}})})},h.prototype.makeRootDirectory=function(g){var v=this.store.beginTransaction("readwrite");v.get(_l,function(E,T){if(E||T===void 0){var P=new Date().getTime(),z=new $i(Bv(),4096,511|S.DIRECTORY,P,P,P);v.put(z.id,AF(),!1,function(G){gn(G,v,g)&&v.put(_l,z.toBuffer(),!1,function(ue){ue?v.abort(function(){g(ue)}):v.commit(g)})})}else v.commit(g)})},h.prototype._findINode=function(g,v,E,T){var P=this,z=function(G,ue,xe){G?T(G):xe[E]?T(null,xe[E]):T(p.ENOENT(f.resolve(v,E)))};v==="/"?E===""?T(null,_l):this.getINode(g,v,_l,function(G,ue){ss(G,T)&&P.getDirListing(g,v,ue,function(xe,Pe){z(xe,ue,Pe)})}):this.findINodeAndDirListing(g,v,z)},h.prototype.findINode=function(g,v,E){var T=this;this._findINode(g,f.dirname(v),f.basename(v),function(P,z){ss(P,E)&&T.getINode(g,v,z,E)})},h.prototype.getINode=function(g,v,E,T){g.get(E,function(P,z){ss(P,T)&&(z===void 0?T(p.ENOENT(v)):T(null,$i.fromBuffer(z)))})},h.prototype.getDirListing=function(g,v,E,T){E.isDirectory()?g.get(E.id,function(P,z){if(ss(P,T))try{T(null,JSON.parse(z.toString()))}catch{T(p.ENOENT(v))}}):T(p.ENOTDIR(v))},h.prototype.findINodeAndDirListing=function(g,v,E){var T=this;this.findINode(g,v,function(P,z){ss(P,E)&&T.getDirListing(g,v,z,function(G,ue){ss(G,E)&&E(null,z,ue)})})},h.prototype.addNewNode=function(g,v,E){var T=0,P,z=function(){++T===5?E(new p(u.EIO,"Unable to commit data to key-value store.")):(P=Bv(),g.put(P,v,!1,function(G,ue){G||!ue?z():E(null,P)}))};z()},h.prototype.commitNewFile=function(g,v,E,T,P,z){var G=this,ue=f.dirname(v),xe=f.basename(v),Pe=new Date().getTime();if(v==="/")return z(p.EEXIST(v));this.findINodeAndDirListing(g,ue,function(We,Ke,ht){gn(We,g,z)&&(ht[xe]?g.abort(function(){z(p.EEXIST(v))}):G.addNewNode(g,P,function(bt,Pt){if(gn(bt,g,z)){var Rr=new $i(Pt,P.length,T|E,Pe,Pe,Pe);G.addNewNode(g,Rr.toBuffer(),function(Hn,ja){gn(Hn,g,z)&&(ht[xe]=ja,g.put(Ke.id,s.from(JSON.stringify(ht)),!0,function(Ba){gn(Ba,g,z)&&g.commit(function(Yf){gn(Yf,g,z)&&z(null,Rr)})}))})}}))})},h.prototype.removeEntry=function(g,v,E){var T=this,P=this.store.beginTransaction("readwrite"),z=f.dirname(g),G=f.basename(g);this.findINodeAndDirListing(P,z,function(ue,xe,Pe){if(gn(ue,P,E))if(!Pe[G])P.abort(function(){E(p.ENOENT(g))});else{var We=Pe[G];delete Pe[G],T.getINode(P,g,We,function(Ke,ht){gn(Ke,P,E)&&(!v&&ht.isDirectory()?P.abort(function(){E(p.EISDIR(g))}):v&&!ht.isDirectory()?P.abort(function(){E(p.ENOTDIR(g))}):P.del(ht.id,function(bt){gn(bt,P,E)&&P.del(We,function(Pt){gn(Pt,P,E)&&P.put(xe.id,s.from(JSON.stringify(Pe)),!0,function(Rr){gn(Rr,P,E)&&P.commit(E)})})}))})}})},h}(Ce),Gc=function(){this.store={}};Gc.prototype.name=function(){return Vf.Name},Gc.prototype.clear=function(){this.store={}},Gc.prototype.beginTransaction=function(h){return new bo(this)},Gc.prototype.get=function(h){return this.store[h]},Gc.prototype.put=function(h,y,g){return!g&&this.store.hasOwnProperty(h)?!1:(this.store[h]=y,!0)},Gc.prototype.del=function(h){delete this.store[h]};var Vf=function(b){function h(){b.call(this,{store:new Gc})}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){v(null,new h)},h}(CF);Vf.Name="InMemory",Vf.Options={};var Zx=sn.indexedDB||sn.mozIndexedDB||sn.webkitIndexedDB||sn.msIndexedDB;function fg(b,h){switch(h===void 0&&(h=b.toString()),b.name){case"NotFoundError":return new p(u.ENOENT,h);case"QuotaExceededError":return new p(u.ENOSPC,h);default:return new p(u.EIO,h)}}function dg(b,h,y){return h===void 0&&(h=u.EIO),y===void 0&&(y=null),function(g){g.preventDefault(),b(new p(h,y!==null?y:void 0))}}var Qx=function(h,y){this.tx=h,this.store=y};Qx.prototype.get=function(h,y){try{var g=this.store.get(h);g.onerror=dg(y),g.onsuccess=function(v){var E=v.target.result;E===void 0?y(null,E):y(null,_e(E))}}catch(v){y(fg(v))}};var Jee=function(b){function h(y,g){b.call(this,y,g)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.put=function(g,v,E,T){try{var P=q(v),z;E?z=this.store.put(P,g):z=this.store.add(P,g),z.onerror=dg(T),z.onsuccess=function(G){T(null,!0)}}catch(G){T(fg(G))}},h.prototype.del=function(g,v){try{var E=this.store.delete(g);E.onerror=dg(v),E.onsuccess=function(T){v()}}catch(T){v(fg(T))}},h.prototype.commit=function(g){setTimeout(g,0)},h.prototype.abort=function(g){var v=null;try{this.tx.abort()}catch(E){v=fg(E)}finally{g(v)}},h}(Qx),Mv=function(h,y){var g=this;y===void 0&&(y="browserfs"),this.storeName=y;var v=Zx.open(this.storeName,1);v.onupgradeneeded=function(E){var T=E.target.result;T.objectStoreNames.contains(g.storeName)&&T.deleteObjectStore(g.storeName),T.createObjectStore(g.storeName)},v.onsuccess=function(E){g.db=E.target.result,h(null,g)},v.onerror=dg(h,u.EACCES)};Mv.prototype.name=function(){return pg.Name+" - "+this.storeName},Mv.prototype.clear=function(h){try{var y=this.db.transaction(this.storeName,"readwrite"),g=y.objectStore(this.storeName),v=g.clear();v.onsuccess=function(E){setTimeout(h,0)},v.onerror=dg(h)}catch(E){h(fg(E))}},Mv.prototype.beginTransaction=function(h){h===void 0&&(h="readonly");var y=this.db.transaction(this.storeName,h),g=y.objectStore(this.storeName);if(h==="readwrite")return new Jee(y,g);if(h==="readonly")return new Qx(y,g);throw new p(u.EINVAL,"Invalid transaction type.")};var pg=function(b){function h(y,g,v){var E=this;v===void 0&&(v=!0),b.call(this),this.store=new Mv(function(T){T?y(T):E.init(E.store,function(P){y(P,E)})},g),F(v,h.Name,{storeName:g})}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){new h(v,g.storeName,!1)},h.isAvailable=function(){try{return typeof Zx<"u"&&Zx.open("__browserfs_test__")!==null}catch{return!1}},h}(Wee);pg.Name="IndexedDB",pg.Options={storeName:{type:"string",optional:!0,description:"The name of this file system. You can have multiple IndexedDB file systems operating at once, but each must have a different name."}};var ek=!1,hg;try{sn.localStorage.setItem("__test__",String.fromCharCode(55296)),ek=sn.localStorage.getItem("__test__")===String.fromCharCode(55296)}catch{ek=!1}hg=ek?"binary_string":"binary_string_ie",s.isEncoding(hg)||(hg="base64");var Kc=function(){};Kc.prototype.name=function(){return gg.Name},Kc.prototype.clear=function(){sn.localStorage.clear()},Kc.prototype.beginTransaction=function(h){return new bo(this)},Kc.prototype.get=function(h){try{var y=sn.localStorage.getItem(h);if(y!==null)return s.from(y,hg)}catch{}},Kc.prototype.put=function(h,y,g){try{return!g&&sn.localStorage.getItem(h)!==null?!1:(sn.localStorage.setItem(h,y.toString(hg)),!0)}catch{throw new p(u.ENOSPC,"LocalStorage is full.")}},Kc.prototype.del=function(h){try{sn.localStorage.removeItem(h)}catch(y){throw new p(u.EIO,"Unable to delete key "+h+": "+y)}};var gg=function(b){function h(){b.call(this,{store:new Kc})}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){v(null,new h)},h.isAvailable=function(){return typeof sn.localStorage<"u"},h}(CF);gg.Name="LocalStorage",gg.Options={};var Hf=function(b){function h(){b.call(this),this.mountList=[],this.mntMap={},this.rootFs=new Vf}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){var E=new h;Object.keys(g).forEach(function(T){E.mount(T,g[T])}),v(null,E)},h.isAvailable=function(){return!0},h.prototype.mount=function(g,v){if(g[0]!=="/"&&(g="/"+g),g=f.resolve(g),this.mntMap[g])throw new p(u.EINVAL,"Mount point "+g+" is already taken.");$(g,511,this.rootFs),this.mntMap[g]=v,this.mountList.push(g),this.mountList=this.mountList.sort(function(E,T){return T.length-E.length})},h.prototype.umount=function(g){var v=this;if(g[0]!=="/"&&(g="/"+g),g=f.resolve(g),!this.mntMap[g])throw new p(u.EINVAL,"Mount point "+g+" is already unmounted.");for(delete this.mntMap[g],this.mountList.splice(this.mountList.indexOf(g),1);g!=="/"&&v.rootFs.readdirSync(g).length===0;)v.rootFs.rmdirSync(g),g=f.dirname(g)},h.prototype._getFs=function(g){for(var v=this,E=this.mountList,T=E.length,P=0;P<T;P++){var z=E[P];if(z.length<=g.length&&g.indexOf(z)===0)return g=g.substr(z.length>1?z.length:0),g===""&&(g="/"),{fs:v.mntMap[z],path:g}}return{fs:this.rootFs,path:g}},h.prototype.getName=function(){return h.Name},h.prototype.diskSpace=function(g,v){v(0,0)},h.prototype.isReadOnly=function(){return!1},h.prototype.supportsLinks=function(){return!1},h.prototype.supportsProps=function(){return!1},h.prototype.supportsSynch=function(){return!0},h.prototype.standardizeError=function(g,v,E){var T=g.message.indexOf(v);return T!==-1&&(g.message=g.message.substr(0,T)+E+g.message.substr(T+v.length),g.path=E),g},h.prototype.rename=function(g,v,E){var T=this,P=this._getFs(g),z=this._getFs(v);return P.fs===z.fs?P.fs.rename(P.path,z.path,function(G){G&&T.standardizeError(T.standardizeError(G,P.path,g),z.path,v),E(G)}):Z.readFile(g,function(G,ue){if(G)return E(G);Z.writeFile(v,ue,function(xe){if(xe)return E(xe);Z.unlink(g,E)})})},h.prototype.renameSync=function(g,v){var E=this._getFs(g),T=this._getFs(v);if(E.fs===T.fs)try{return E.fs.renameSync(E.path,T.path)}catch(z){throw this.standardizeError(this.standardizeError(z,E.path,g),T.path,v),z}var P=Z.readFileSync(g);return Z.writeFileSync(v,P),Z.unlinkSync(g)},h.prototype.readdirSync=function(g){var v=this._getFs(g),E=null;if(v.fs!==this.rootFs)try{E=this.rootFs.readdirSync(g)}catch{}try{var T=v.fs.readdirSync(v.path);return E===null?T:T.concat(E.filter(function(P){return T.indexOf(P)===-1}))}catch(P){if(E===null)throw this.standardizeError(P,v.path,g);return E}},h.prototype.readdir=function(g,v){var E=this,T=this._getFs(g);T.fs.readdir(T.path,function(P,z){if(T.fs!==E.rootFs)try{var G=E.rootFs.readdirSync(g);z?z=z.concat(G.filter(function(ue){return z.indexOf(ue)===-1})):z=G}catch{if(P)return v(E.standardizeError(P,T.path,g))}else if(P)return v(E.standardizeError(P,T.path,g));v(null,z)})},h.prototype.rmdirSync=function(g){var v=this._getFs(g);if(this._containsMountPt(g))throw p.ENOTEMPTY(g);try{v.fs.rmdirSync(v.path)}catch(E){throw this.standardizeError(E,v.path,g)}},h.prototype.rmdir=function(g,v){var E=this,T=this._getFs(g);this._containsMountPt(g)?v(p.ENOTEMPTY(g)):T.fs.rmdir(T.path,function(P){v(P?E.standardizeError(P,T.path,g):null)})},h.prototype._containsMountPt=function(g){for(var v=this.mountList,E=v.length,T=0;T<E;T++){var P=v[T];if(P.length>=g.length&&P.slice(0,g.length)===g)return!0}return!1},h}(Ce);Hf.Name="MountableFileSystem",Hf.Options={};function NF(b,h,y){return h?function(){for(var g=[],v=arguments.length;v--;)g[v]=arguments[v];var E=g[0],T=this._getFs(E);g[0]=T.path;try{return T.fs[b].apply(T.fs,g)}catch(P){throw this.standardizeError(P,T.path,E),P}}:function(){for(var g=this,v=[],E=arguments.length;E--;)v[E]=arguments[E];var T=v[0],P=this._getFs(T);if(v[0]=P.path,typeof v[v.length-1]=="function"){var z=v[v.length-1];v[v.length-1]=function(){for(var G=[],ue=arguments.length;ue--;)G[ue]=arguments[ue];G.length>0&&G[0]instanceof p&&g.standardizeError(G[0],P.path,T),z.apply(null,G)}}return P.fs[b].apply(P.fs,v)}}for(var PF=[["exists","unlink","readlink"],["stat","mkdir","realpath","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]],yg=0;yg<PF.length;yg++)for(var Gee=PF[yg],tk=0,LF=Gee;tk<LF.length;tk+=1){var Rv=LF[tk];Hf.prototype[Rv]=NF(Rv,!1,yg+1),Hf.prototype[Rv+"Sync"]=NF(Rv+"Sync",!0,yg+1)}var mg;if(typeof setImmediate<"u")mg=setImmediate;else{var Os=sn,Wf=[],FF="zero-timeout-message",Kee=function(){if(typeof Os.importScripts<"u"||!Os.postMessage)return!1;var b=!0,h=Os.onmessage;return Os.onmessage=function(){b=!1},Os.postMessage("","*"),Os.onmessage=h,b};if(Kee()){mg=function(b){Wf.push(b),Os.postMessage(FF,"*")};var DF=function(b){if(b.source===self&&b.data===FF&&(b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,Wf.length>0)){var h=Wf.shift();return h()}};Os.addEventListener?Os.addEventListener("message",DF,!0):Os.attachEvent("onmessage",DF)}else if(Os.MessageChannel){var jF=new Os.MessageChannel;jF.port1.onmessage=function(b){if(Wf.length>0)return Wf.shift()()},mg=function(b){Wf.push(b),jF.port2.postMessage("")}}else mg=function(b){return setTimeout(b,0)}}var rk=mg,bg=function(){this._locked=!1,this._waiters=[]};bg.prototype.lock=function(h){if(this._locked){this._waiters.push(h);return}this._locked=!0,h()},bg.prototype.unlock=function(){if(!this._locked)throw new Error("unlock of a non-locked mutex");var h=this._waiters.shift();if(h){rk(h);return}this._locked=!1},bg.prototype.tryLock=function(){return this._locked?!1:(this._locked=!0,!0)},bg.prototype.isLocked=function(){return this._locked};var Ot=function(h){this._fs=h,this._mu=new bg};Ot.prototype.getName=function(){return"LockedFS<"+this._fs.getName()+">"},Ot.prototype.getFSUnlocked=function(){return this._fs},Ot.prototype.initialize=function(h){this._fs.initialize(h)},Ot.prototype.diskSpace=function(h,y){this._fs.diskSpace(h,y)},Ot.prototype.isReadOnly=function(){return this._fs.isReadOnly()},Ot.prototype.supportsLinks=function(){return this._fs.supportsLinks()},Ot.prototype.supportsProps=function(){return this._fs.supportsProps()},Ot.prototype.supportsSynch=function(){return this._fs.supportsSynch()},Ot.prototype.rename=function(h,y,g){var v=this;this._mu.lock(function(){v._fs.rename(h,y,function(E){v._mu.unlock(),g(E)})})},Ot.prototype.renameSync=function(h,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.renameSync(h,y)},Ot.prototype.stat=function(h,y,g){var v=this;this._mu.lock(function(){v._fs.stat(h,y,function(E,T){v._mu.unlock(),g(E,T)})})},Ot.prototype.statSync=function(h,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.statSync(h,y)},Ot.prototype.open=function(h,y,g,v){var E=this;this._mu.lock(function(){E._fs.open(h,y,g,function(T,P){E._mu.unlock(),v(T,P)})})},Ot.prototype.openSync=function(h,y,g){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.openSync(h,y,g)},Ot.prototype.unlink=function(h,y){var g=this;this._mu.lock(function(){g._fs.unlink(h,function(v){g._mu.unlock(),y(v)})})},Ot.prototype.unlinkSync=function(h){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.unlinkSync(h)},Ot.prototype.rmdir=function(h,y){var g=this;this._mu.lock(function(){g._fs.rmdir(h,function(v){g._mu.unlock(),y(v)})})},Ot.prototype.rmdirSync=function(h){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.rmdirSync(h)},Ot.prototype.mkdir=function(h,y,g){var v=this;this._mu.lock(function(){v._fs.mkdir(h,y,function(E){v._mu.unlock(),g(E)})})},Ot.prototype.mkdirSync=function(h,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.mkdirSync(h,y)},Ot.prototype.readdir=function(h,y){var g=this;this._mu.lock(function(){g._fs.readdir(h,function(v,E){g._mu.unlock(),y(v,E)})})},Ot.prototype.readdirSync=function(h){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readdirSync(h)},Ot.prototype.exists=function(h,y){var g=this;this._mu.lock(function(){g._fs.exists(h,function(v){g._mu.unlock(),y(v)})})},Ot.prototype.existsSync=function(h){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.existsSync(h)},Ot.prototype.realpath=function(h,y,g){var v=this;this._mu.lock(function(){v._fs.realpath(h,y,function(E,T){v._mu.unlock(),g(E,T)})})},Ot.prototype.realpathSync=function(h,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.realpathSync(h,y)},Ot.prototype.truncate=function(h,y,g){var v=this;this._mu.lock(function(){v._fs.truncate(h,y,function(E){v._mu.unlock(),g(E)})})},Ot.prototype.truncateSync=function(h,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.truncateSync(h,y)},Ot.prototype.readFile=function(h,y,g,v){var E=this;this._mu.lock(function(){E._fs.readFile(h,y,g,function(T,P){E._mu.unlock(),v(T,P)})})},Ot.prototype.readFileSync=function(h,y,g){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readFileSync(h,y,g)},Ot.prototype.writeFile=function(h,y,g,v,E,T){var P=this;this._mu.lock(function(){P._fs.writeFile(h,y,g,v,E,function(z){P._mu.unlock(),T(z)})})},Ot.prototype.writeFileSync=function(h,y,g,v,E){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.writeFileSync(h,y,g,v,E)},Ot.prototype.appendFile=function(h,y,g,v,E,T){var P=this;this._mu.lock(function(){P._fs.appendFile(h,y,g,v,E,function(z){P._mu.unlock(),T(z)})})},Ot.prototype.appendFileSync=function(h,y,g,v,E){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.appendFileSync(h,y,g,v,E)},Ot.prototype.chmod=function(h,y,g,v){var E=this;this._mu.lock(function(){E._fs.chmod(h,y,g,function(T){E._mu.unlock(),v(T)})})},Ot.prototype.chmodSync=function(h,y,g){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chmodSync(h,y,g)},Ot.prototype.chown=function(h,y,g,v,E){var T=this;this._mu.lock(function(){T._fs.chown(h,y,g,v,function(P){T._mu.unlock(),E(P)})})},Ot.prototype.chownSync=function(h,y,g,v){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chownSync(h,y,g,v)},Ot.prototype.utimes=function(h,y,g,v){var E=this;this._mu.lock(function(){E._fs.utimes(h,y,g,function(T){E._mu.unlock(),v(T)})})},Ot.prototype.utimesSync=function(h,y,g){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.utimesSync(h,y,g)},Ot.prototype.link=function(h,y,g){var v=this;this._mu.lock(function(){v._fs.link(h,y,function(E){v._mu.unlock(),g(E)})})},Ot.prototype.linkSync=function(h,y){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.linkSync(h,y)},Ot.prototype.symlink=function(h,y,g,v){var E=this;this._mu.lock(function(){E._fs.symlink(h,y,g,function(T){E._mu.unlock(),v(T)})})},Ot.prototype.symlinkSync=function(h,y,g){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.symlinkSync(h,y,g)},Ot.prototype.readlink=function(h,y){var g=this;this._mu.lock(function(){g._fs.readlink(h,function(v,E){g._mu.unlock(),y(v,E)})})},Ot.prototype.readlinkSync=function(h){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readlinkSync(h)};var vo="/.deletedFiles.log";function BF(b){return 146|b}function as(b){return k.getFileFlag(b)}var MF=function(b){function h(y,g,v,E,T){b.call(this,y,g,v,E,T)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.sync=function(g){var v=this;if(!this.isDirty()){g(null);return}this._fs._syncAsync(this,function(E){v.resetDirty(),g(E)})},h.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},h.prototype.close=function(g){this.sync(g)},h.prototype.closeSync=function(){this.syncSync()},h}(kt),RF=function(b){function h(y,g){if(b.call(this),this._isInitialized=!1,this._initializeCallbacks=[],this._deletedFiles={},this._deleteLog="",this._deleteLogUpdatePending=!1,this._deleteLogUpdateNeeded=!1,this._deleteLogError=null,this._writable=y,this._readable=g,this._writable.isReadOnly())throw new p(u.EINVAL,"Writable file system must be writable.")}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.isAvailable=function(){return!0},h.prototype.getOverlayedFileSystems=function(){return{readable:this._readable,writable:this._writable}},h.prototype._syncAsync=function(g,v){var E=this;this.createParentDirectoriesAsync(g.getPath(),function(T){if(T)return v(T);E._writable.writeFile(g.getPath(),g.getBuffer(),null,as("w"),g.getStats().mode,v)})},h.prototype._syncSync=function(g){this.createParentDirectories(g.getPath()),this._writable.writeFileSync(g.getPath(),g.getBuffer(),null,as("w"),g.getStats().mode)},h.prototype.getName=function(){return vg.Name},h.prototype.initialize=function(g){var v=this,E=this._initializeCallbacks,T=function(P){v._isInitialized=!P,v._initializeCallbacks=[],E.forEach(function(z){return z(P)})};if(this._isInitialized)return g();E.push(g),E.length===1&&this._writable.readFile(vo,"utf8",as("r"),function(P,z){if(P){if(P.errno!==u.ENOENT)return T(P)}else v._deleteLog=z;v._reparseDeletionLog(),T()})},h.prototype.isReadOnly=function(){return!1},h.prototype.supportsSynch=function(){return this._readable.supportsSynch()&&this._writable.supportsSynch()},h.prototype.supportsLinks=function(){return!1},h.prototype.supportsProps=function(){return this._readable.supportsProps()&&this._writable.supportsProps()},h.prototype.getDeletionLog=function(){return this._deleteLog},h.prototype.restoreDeletionLog=function(g){this._deleteLog=g,this._reparseDeletionLog(),this.updateLog("")},h.prototype.rename=function(g,v,E){var T=this;if(!(!this.checkInitAsync(E)||this.checkPathAsync(g,E)||this.checkPathAsync(v,E))){if(g===vo||v===vo)return E(p.EPERM("Cannot rename deletion log."));if(g===v)return E();this.stat(g,!1,function(P,z){return P?E(P):T.stat(v,!1,function(G,ue){var xe=T;function Pe(Ke){var ht=Ke.shift();if(!ht)return E();var bt=f.resolve(g,ht),Pt=f.resolve(v,ht);xe.rename(bt,Pt,function(Rr){if(Rr)return E(Rr);Pe(Ke)})}var We=511;if(z.isDirectory()){if(G)return G.errno!==u.ENOENT?E(G):T._writable.exists(g,function(Ke){if(Ke)return T._writable.rename(g,v,E);T._writable.mkdir(v,We,function(ht){if(ht)return E(ht);T._readable.readdir(g,function(bt,Pt){if(bt)return E();Pe(Pt)})})});if(We=ue.mode,!ue.isDirectory())return E(p.ENOTDIR(v));T.readdir(v,function(Ke,ht){if(ht&&ht.length)return E(p.ENOTEMPTY(v));T._readable.readdir(g,function(bt,Pt){if(bt)return E();Pe(Pt)})})}if(ue&&ue.isDirectory())return E(p.EISDIR(v));T.readFile(g,null,as("r"),function(Ke,ht){return Ke?E(Ke):T.writeFile(v,ht,null,as("w"),z.mode,function(bt){return bt?E(bt):T.unlink(g,E)})})})})}},h.prototype.renameSync=function(g,v){var E=this;if(this.checkInitialized(),this.checkPath(g),this.checkPath(v),g===vo||v===vo)throw p.EPERM("Cannot rename deletion log.");var T=this.statSync(g,!1);if(T.isDirectory()){if(g===v)return;var P=511;if(this.existsSync(v)){var z=this.statSync(v,!1);if(P=z.mode,z.isDirectory()){if(this.readdirSync(v).length>0)throw p.ENOTEMPTY(v)}else throw p.ENOTDIR(v)}this._writable.existsSync(g)?this._writable.renameSync(g,v):this._writable.existsSync(v)||this._writable.mkdirSync(v,P),this._readable.existsSync(g)&&this._readable.readdirSync(g).forEach(function(G){E.renameSync(f.resolve(g,G),f.resolve(v,G))})}else{if(this.existsSync(v)&&this.statSync(v,!1).isDirectory())throw p.EISDIR(v);this.writeFileSync(v,this.readFileSync(g,null,as("r")),null,as("w"),T.mode)}g!==v&&this.existsSync(g)&&this.unlinkSync(g)},h.prototype.stat=function(g,v,E){var T=this;this.checkInitAsync(E)&&this._writable.stat(g,v,function(P,z){P&&P.errno===u.ENOENT?(T._deletedFiles[g]&&E(p.ENOENT(g)),T._readable.stat(g,v,function(G,ue){ue&&(ue=ue.clone(),ue.mode=BF(ue.mode)),E(G,ue)})):E(P,z)})},h.prototype.statSync=function(g,v){this.checkInitialized();try{return this._writable.statSync(g,v)}catch{if(this._deletedFiles[g])throw p.ENOENT(g);var E=this._readable.statSync(g,v).clone();return E.mode=BF(E.mode),E}},h.prototype.open=function(g,v,E,T){var P=this;!this.checkInitAsync(T)||this.checkPathAsync(g,T)||this.stat(g,!1,function(z,G){if(G)switch(v.pathExistsAction()){case w.TRUNCATE_FILE:return P.createParentDirectoriesAsync(g,function(ue){if(ue)return T(ue);P._writable.open(g,v,E,T)});case w.NOP:return P._writable.exists(g,function(ue){ue?P._writable.open(g,v,E,T):(G=G.clone(),G.mode=E,P._readable.readFile(g,null,as("r"),function(xe,Pe){if(xe)return T(xe);G.size===-1&&(G.size=Pe.length);var We=new MF(P,g,v,G,Pe);T(null,We)}))});default:return T(p.EEXIST(g))}else switch(v.pathNotExistsAction()){case w.CREATE_FILE:return P.createParentDirectoriesAsync(g,function(ue){return ue?T(ue):P._writable.open(g,v,E,T)});default:return T(p.ENOENT(g))}})},h.prototype.openSync=function(g,v,E){if(this.checkInitialized(),this.checkPath(g),g===vo)throw p.EPERM("Cannot open deletion log.");if(this.existsSync(g))switch(v.pathExistsAction()){case w.TRUNCATE_FILE:return this.createParentDirectories(g),this._writable.openSync(g,v,E);case w.NOP:if(this._writable.existsSync(g))return this._writable.openSync(g,v,E);var T=this._readable.readFileSync(g,null,as("r")),P=this._readable.statSync(g,!1).clone();return P.mode=E,new MF(this,g,v,P,T);default:throw p.EEXIST(g)}else switch(v.pathNotExistsAction()){case w.CREATE_FILE:return this.createParentDirectories(g),this._writable.openSync(g,v,E);default:throw p.ENOENT(g)}},h.prototype.unlink=function(g,v){var E=this;!this.checkInitAsync(v)||this.checkPathAsync(g,v)||this.exists(g,function(T){if(!T)return v(p.ENOENT(g));E._writable.exists(g,function(P){if(P)return E._writable.unlink(g,function(z){if(z)return v(z);E.exists(g,function(G){G&&E.deletePath(g),v(null)})});E.deletePath(g),v(null)})})},h.prototype.unlinkSync=function(g){if(this.checkInitialized(),this.checkPath(g),this.existsSync(g))this._writable.existsSync(g)&&this._writable.unlinkSync(g),this.existsSync(g)&&this.deletePath(g);else throw p.ENOENT(g)},h.prototype.rmdir=function(g,v){var E=this;if(this.checkInitAsync(v)){var T=function(){E.readdir(g,function(P,z){if(P)return v(P);if(z.length)return v(p.ENOTEMPTY(g));E.deletePath(g),v(null)})};this.exists(g,function(P){if(!P)return v(p.ENOENT(g));E._writable.exists(g,function(z){z?E._writable.rmdir(g,function(G){if(G)return v(G);E._readable.exists(g,function(ue){ue?T():v()})}):T()})})}},h.prototype.rmdirSync=function(g){if(this.checkInitialized(),this.existsSync(g)){if(this._writable.existsSync(g)&&this._writable.rmdirSync(g),this.existsSync(g)){if(this.readdirSync(g).length>0)throw p.ENOTEMPTY(g);this.deletePath(g)}}else throw p.ENOENT(g)},h.prototype.mkdir=function(g,v,E){var T=this;this.checkInitAsync(E)&&this.exists(g,function(P){if(P)return E(p.EEXIST(g));T.createParentDirectoriesAsync(g,function(z){if(z)return E(z);T._writable.mkdir(g,v,E)})})},h.prototype.mkdirSync=function(g,v){if(this.checkInitialized(),this.existsSync(g))throw p.EEXIST(g);this.createParentDirectories(g),this._writable.mkdirSync(g,v)},h.prototype.readdir=function(g,v){var E=this;this.checkInitAsync(v)&&this.stat(g,!1,function(T,P){if(T)return v(T);if(!P.isDirectory())return v(p.ENOTDIR(g));E._writable.readdir(g,function(z,G){if(z&&z.code!=="ENOENT")return v(z);(z||!G)&&(G=[]),E._readable.readdir(g,function(ue,xe){(ue||!xe)&&(xe=[]);var Pe={},We=G.concat(xe.filter(function(Ke){return!E._deletedFiles[g+"/"+Ke]})).filter(function(Ke){var ht=!Pe[Ke];return Pe[Ke]=!0,ht});v(null,We)})})})},h.prototype.readdirSync=function(g){var v=this;this.checkInitialized();var E=this.statSync(g,!1);if(!E.isDirectory())throw p.ENOTDIR(g);var T=[];try{T=T.concat(this._writable.readdirSync(g))}catch{}try{T=T.concat(this._readable.readdirSync(g).filter(function(z){return!v._deletedFiles[g+"/"+z]}))}catch{}var P={};return T.filter(function(z){var G=!P[z];return P[z]=!0,G})},h.prototype.exists=function(g,v){var E=this;this.checkInitialized(),this._writable.exists(g,function(T){if(T)return v(!0);E._readable.exists(g,function(P){v(P&&E._deletedFiles[g]!==!0)})})},h.prototype.existsSync=function(g){return this.checkInitialized(),this._writable.existsSync(g)||this._readable.existsSync(g)&&this._deletedFiles[g]!==!0},h.prototype.chmod=function(g,v,E,T){var P=this;this.checkInitAsync(T)&&this.operateOnWritableAsync(g,function(z){if(z)return T(z);P._writable.chmod(g,v,E,T)})},h.prototype.chmodSync=function(g,v,E){var T=this;this.checkInitialized(),this.operateOnWritable(g,function(){T._writable.chmodSync(g,v,E)})},h.prototype.chown=function(g,v,E,T,P){var z=this;this.checkInitAsync(P)&&this.operateOnWritableAsync(g,function(G){if(G)return P(G);z._writable.chown(g,v,E,T,P)})},h.prototype.chownSync=function(g,v,E,T){var P=this;this.checkInitialized(),this.operateOnWritable(g,function(){P._writable.chownSync(g,v,E,T)})},h.prototype.utimes=function(g,v,E,T){var P=this;this.checkInitAsync(T)&&this.operateOnWritableAsync(g,function(z){if(z)return T(z);P._writable.utimes(g,v,E,T)})},h.prototype.utimesSync=function(g,v,E){var T=this;this.checkInitialized(),this.operateOnWritable(g,function(){T._writable.utimesSync(g,v,E)})},h.prototype.deletePath=function(g){this._deletedFiles[g]=!0,this.updateLog("d"+g+`
`)},h.prototype.updateLog=function(g){var v=this;this._deleteLog+=g,this._deleteLogUpdatePending?this._deleteLogUpdateNeeded=!0:(this._deleteLogUpdatePending=!0,this._writable.writeFile(vo,this._deleteLog,"utf8",k.getFileFlag("w"),420,function(E){v._deleteLogUpdatePending=!1,E?v._deleteLogError=E:v._deleteLogUpdateNeeded&&(v._deleteLogUpdateNeeded=!1,v.updateLog(""))}))},h.prototype._reparseDeletionLog=function(){var g=this;this._deletedFiles={},this._deleteLog.split(`
`).forEach(function(v){g._deletedFiles[v.slice(1)]=v.slice(0,1)==="d"})},h.prototype.checkInitialized=function(){if(this._isInitialized){if(this._deleteLogError!==null){var g=this._deleteLogError;throw this._deleteLogError=null,g}}else throw new p(u.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")},h.prototype.checkInitAsync=function(g){if(this._isInitialized){if(this._deleteLogError!==null){var v=this._deleteLogError;return this._deleteLogError=null,g(v),!1}}else return g(new p(u.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")),!1;return!0},h.prototype.checkPath=function(g){if(g===vo)throw p.EPERM(g)},h.prototype.checkPathAsync=function(g,v){return g===vo?(v(p.EPERM(g)),!0):!1},h.prototype.createParentDirectoriesAsync=function(g,v){var E=f.dirname(g),T=[],P=this;this._writable.stat(E,!1,z);function z(ue,xe){ue?(T.push(E),E=f.dirname(E),P._writable.stat(E,!1,z)):G()}function G(){if(!T.length)return v();var ue=T.pop();P._readable.stat(ue,!1,function(xe,Pe){if(!Pe)return v();P._writable.mkdir(ue,Pe.mode,function(We){if(We)return v(We);G()})})}},h.prototype.createParentDirectories=function(g){for(var v=this,E=f.dirname(g),T=[];!this._writable.existsSync(E);)T.push(E),E=f.dirname(E);T=T.reverse(),T.forEach(function(P){v._writable.mkdirSync(P,v.statSync(P,!1).mode)})},h.prototype.operateOnWritable=function(g,v){if(this.existsSync(g))this._writable.existsSync(g)||this.copyToWritable(g),v();else throw p.ENOENT(g)},h.prototype.operateOnWritableAsync=function(g,v){var E=this;this.exists(g,function(T){if(!T)return v(p.ENOENT(g));E._writable.exists(g,function(P){if(P)v();else return E.copyToWritableAsync(g,v)})})},h.prototype.copyToWritable=function(g){var v=this.statSync(g,!1);v.isDirectory()?this._writable.mkdirSync(g,v.mode):this.writeFileSync(g,this._readable.readFileSync(g,null,as("r")),null,as("w"),this.statSync(g,!1).mode)},h.prototype.copyToWritableAsync=function(g,v){var E=this;this.stat(g,!1,function(T,P){if(T)return v(T);if(P.isDirectory())return E._writable.mkdir(g,P.mode,v);E._readable.readFile(g,null,as("r"),function(z,G){if(z)return v(z);E.writeFile(g,G,null,as("w"),P.mode,v)})})},h}(Ce),vg=function(b){function h(y,g,v){v===void 0&&(v=!0),b.call(this,new RF(y,g)),F(v,h.Name,{readable:"readable file system",writable:"writable file system"})}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){try{var E=new h(g.writable,g.readable,!1);E.initialize(function(T){v(T,E)},!1)}catch(T){v(T)}},h.isAvailable=function(){return RF.isAvailable()},h.prototype.initialize=function(g,v){v===void 0&&(v=!0),v&&console.warn("[OverlayFS] OverlayFS.initialize() is deprecated and will be removed in the next major release. Please use 'OverlayFS.Create({readable: readable file system instance, writable: writable file system instance}, cb)' to create and initialize OverlayFS instances."),b.prototype.initialize.call(this,g)},h.prototype.getOverlayedFileSystems=function(){return b.prototype.getFSUnlocked.call(this).getOverlayedFileSystems()},h.prototype.unwrap=function(){return b.prototype.getFSUnlocked.call(this)},h}(Ot);vg.Name="OverlayFS",vg.Options={writable:{type:"object",description:"The file system to write modified files to."},readable:{type:"object",description:"The file system that initially populates this file system."}};var Mr;(function(b){b[b.CB=0]="CB",b[b.FD=1]="FD",b[b.API_ERROR=2]="API_ERROR",b[b.STATS=3]="STATS",b[b.PROBE=4]="PROBE",b[b.FILEFLAG=5]="FILEFLAG",b[b.BUFFER=6]="BUFFER",b[b.ERROR=7]="ERROR"})(Mr||(Mr={}));var nk=function(){this._callbacks={},this._nextId=0};nk.prototype.toRemoteArg=function(h){var y=this._nextId++;return this._callbacks[y]=h,{type:Mr.CB,id:y}},nk.prototype.toLocalArg=function(h){var y=this._callbacks[h];return delete this._callbacks[h],y};var $v=function(){this._fileDescriptors={},this._nextId=0};$v.prototype.toRemoteArg=function(h,y,g,v){var E=this._nextId++,T,P;this._fileDescriptors[E]=h,h.stat(function(z,G){z?v(z):(P=Yc(G.toBuffer()),g.isReadable()?h.read(s.alloc(G.size),0,G.size,0,function(ue,xe,Pe){ue?v(ue):(T=Yc(Pe),v(null,{type:Mr.FD,id:E,data:T,stat:P,path:y,flag:g.getFlagString()}))}):v(null,{type:Mr.FD,id:E,data:new ArrayBuffer(0),stat:P,path:y,flag:g.getFlagString()}))})},$v.prototype.applyFdAPIRequest=function(h,y){var g=this,v=h.args[0];this._applyFdChanges(v,function(E,T){E?y(E):T[h.method](function(P){h.method==="close"&&delete g._fileDescriptors[v.id],y(P)})})},$v.prototype._applyFdChanges=function(h,y){var g=this._fileDescriptors[h.id],v=Xc(h.data),E=O.fromBuffer(Xc(h.stat)),T=k.getFileFlag(h.flag);T.isWriteable()?g.write(v,0,v.length,T.isAppendable()?g.getPos():0,function(P){function z(){g.stat(function(G,ue){G?y(G):ue.mode!==E.mode?g.chmod(E.mode,function(xe){y(xe,g)}):y(G,g)})}P?y(P):T.isAppendable()?z():g.truncate(v.length,function(){z()})}):y(null,g)};function Uv(b){return{type:Mr.API_ERROR,errorData:Yc(b.writeToBuffer())}}function $F(b){return p.fromBuffer(Xc(b.errorData))}function UF(b){return{type:Mr.ERROR,name:b.name,message:b.message,stack:b.stack}}function zF(b){var h=sn[b.name];typeof h!="function"&&(h=Error);var y=new h(b.message);return y.stack=b.stack,y}function qF(b){return{type:Mr.STATS,statsData:Yc(b.toBuffer())}}function VF(b){return O.fromBuffer(Xc(b.statsData))}function HF(b){return{type:Mr.FILEFLAG,flagStr:b.getFlagString()}}function WF(b){return k.getFileFlag(b.flagStr)}function Yc(b){return q(b)}function Xc(b){return _e(b)}function JF(b){return{type:Mr.BUFFER,data:Yc(b)}}function GF(b){return Xc(b.data)}function Yee(b){return b&&typeof b=="object"&&b.hasOwnProperty("browserfsMessage")&&b.browserfsMessage}function Xee(b){return b&&typeof b=="object"&&b.hasOwnProperty("browserfsMessage")&&b.browserfsMessage}var KF=function(b){function h(y,g,v,E,T,P){b.call(this,y,g,v,E,P),this._remoteFdId=T}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.getRemoteFdId=function(){return this._remoteFdId},h.prototype.toRemoteArg=function(){return{type:Mr.FD,id:this._remoteFdId,data:Yc(this.getBuffer()),stat:Yc(this.getStats().toBuffer()),path:this.getPath(),flag:this.getFlag().getFlagString()}},h.prototype.sync=function(g){this._syncClose("sync",g)},h.prototype.close=function(g){this._syncClose("close",g)},h.prototype._syncClose=function(g,v){var E=this;this.isDirty()?this._fs.syncClose(g,this,function(T){T||E.resetDirty(),v(T)}):v()},h}(kt),zv=function(b){function h(y,g){var v=this;g===void 0&&(g=!0),b.call(this),this._callbackConverter=new nk,this._isInitialized=!1,this._isReadOnly=!1,this._supportLinks=!1,this._supportProps=!1,this._worker=y,F(g,h.Name,{worker:"Web Worker instance"}),this._worker.addEventListener("message",function(E){var T=E.data;if(Xee(T)){var P,z=T.args,G=new Array(z.length);for(P=0;P<G.length;P++)G[P]=v._argRemote2Local(z[P]);v._callbackConverter.toLocalArg(T.cbId).apply(null,G)}})}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){var E=new h(g.worker,!1);E.initialize(function(){v(null,E)})},h.isAvailable=function(){return typeof importScripts<"u"||typeof Worker<"u"},h.attachRemoteListener=function(g){var v=new $v;function E(P,z,G){switch(typeof P){case"object":P instanceof O?G(null,qF(P)):P instanceof p?G(null,Uv(P)):P instanceof Ze?G(null,v.toRemoteArg(P,z[0],z[1],G)):P instanceof k?G(null,HF(P)):P instanceof s?G(null,JF(P)):P instanceof Error?G(null,UF(P)):G(null,P);break;default:G(null,P);break}}function T(P,z){if(!P)return P;switch(typeof P){case"object":if(typeof P.type=="number"){var G=P;switch(G.type){case Mr.CB:var ue=P.id;return function(){var xe=arguments,Pe,We=new Array(arguments.length),Ke,ht=arguments.length;function bt(Pt){ht>0&&(ht=-1,Ke={browserfsMessage:!0,cbId:ue,args:[Uv(Pt)]},g.postMessage(Ke))}for(Pe=0;Pe<arguments.length;Pe++)(function(Pt,Rr){E(Rr,z,function(Hn,ja){We[Pt]=ja,Hn?bt(Hn):--ht===0&&(Ke={browserfsMessage:!0,cbId:ue,args:We},g.postMessage(Ke))})})(Pe,xe[Pe]);arguments.length===0&&(Ke={browserfsMessage:!0,cbId:ue,args:We},g.postMessage(Ke))};case Mr.API_ERROR:return $F(G);case Mr.STATS:return VF(G);case Mr.FILEFLAG:return WF(G);case Mr.BUFFER:return GF(G);case Mr.ERROR:return zF(G);default:return P}}else return P;default:return P}}g.addEventListener("message",function(P){var z=P.data;if(Yee(z)){var G=z.args,ue=new Array(G.length);switch(z.method){case"close":case"sync":(function(){var We=G[1];v.applyFdAPIRequest(z,function(Ke){var ht={browserfsMessage:!0,cbId:We.id,args:Ke?[Uv(Ke)]:[]};g.postMessage(ht)})})();break;case"probe":(function(){var We=Z.getRootFS(),Ke=G[1],ht={type:Mr.PROBE,isReadOnly:We.isReadOnly(),supportsLinks:We.supportsLinks(),supportsProps:We.supportsProps()},bt={browserfsMessage:!0,cbId:Ke.id,args:[ht]};g.postMessage(bt)})();break;default:for(var xe=0;xe<G.length;xe++)ue[xe]=T(G[xe],ue);var Pe=Z.getRootFS();Pe[z.method].apply(Pe,ue);break}}})},h.prototype.getName=function(){return h.Name},h.prototype.initialize=function(g){var v=this;if(this._isInitialized)g();else{var E={browserfsMessage:!0,method:"probe",args:[this._argLocal2Remote(le()),this._callbackConverter.toRemoteArg(function(T){v._isInitialized=!0,v._isReadOnly=T.isReadOnly,v._supportLinks=T.supportsLinks,v._supportProps=T.supportsProps,g()})]};this._worker.postMessage(E)}},h.prototype.isReadOnly=function(){return this._isReadOnly},h.prototype.supportsSynch=function(){return!1},h.prototype.supportsLinks=function(){return this._supportLinks},h.prototype.supportsProps=function(){return this._supportProps},h.prototype.rename=function(g,v,E){this._rpc("rename",arguments)},h.prototype.stat=function(g,v,E){this._rpc("stat",arguments)},h.prototype.open=function(g,v,E,T){this._rpc("open",arguments)},h.prototype.unlink=function(g,v){this._rpc("unlink",arguments)},h.prototype.rmdir=function(g,v){this._rpc("rmdir",arguments)},h.prototype.mkdir=function(g,v,E){this._rpc("mkdir",arguments)},h.prototype.readdir=function(g,v){this._rpc("readdir",arguments)},h.prototype.exists=function(g,v){this._rpc("exists",arguments)},h.prototype.realpath=function(g,v,E){this._rpc("realpath",arguments)},h.prototype.truncate=function(g,v,E){this._rpc("truncate",arguments)},h.prototype.readFile=function(g,v,E,T){this._rpc("readFile",arguments)},h.prototype.writeFile=function(g,v,E,T,P,z){this._rpc("writeFile",arguments)},h.prototype.appendFile=function(g,v,E,T,P,z){this._rpc("appendFile",arguments)},h.prototype.chmod=function(g,v,E,T){this._rpc("chmod",arguments)},h.prototype.chown=function(g,v,E,T,P){this._rpc("chown",arguments)},h.prototype.utimes=function(g,v,E,T){this._rpc("utimes",arguments)},h.prototype.link=function(g,v,E){this._rpc("link",arguments)},h.prototype.symlink=function(g,v,E,T){this._rpc("symlink",arguments)},h.prototype.readlink=function(g,v){this._rpc("readlink",arguments)},h.prototype.syncClose=function(g,v,E){this._worker.postMessage({browserfsMessage:!0,method:g,args:[v.toRemoteArg(),this._callbackConverter.toRemoteArg(E)]})},h.prototype._argRemote2Local=function(g){if(!g)return g;switch(typeof g){case"object":if(typeof g.type=="number"){var v=g;switch(v.type){case Mr.API_ERROR:return $F(v);case Mr.FD:var E=v;return new KF(this,E.path,k.getFileFlag(E.flag),O.fromBuffer(Xc(E.stat)),E.id,Xc(E.data));case Mr.STATS:return VF(v);case Mr.FILEFLAG:return WF(v);case Mr.BUFFER:return GF(v);case Mr.ERROR:return zF(v);default:return g}}else return g;default:return g}},h.prototype._rpc=function(g,v){for(var E=this,T=new Array(v.length),P=0;P<v.length;P++)T[P]=E._argLocal2Remote(v[P]);var z={browserfsMessage:!0,method:g,args:T};this._worker.postMessage(z)},h.prototype._argLocal2Remote=function(g){if(!g)return g;switch(typeof g){case"object":return g instanceof O?qF(g):g instanceof p?Uv(g):g instanceof KF?g.toRemoteArg():g instanceof k?HF(g):g instanceof s?JF(g):g instanceof Error?UF(g):"Unknown argument";case"function":return this._callbackConverter.toRemoteArg(g);default:return g}},h}(Ce);zv.Name="WorkerFS",zv.Options={worker:{type:"object",description:"The target worker that you want to connect to, or the current worker if in a worker context.",validator:function(b,h){b.postMessage?h():h(new p(u.EINVAL,"option must be a Web Worker instance."))}}};function Zee(b,h,y){var g=new XMLHttpRequest;g.open("GET",b,!0);var v=!0;switch(h){case"buffer":g.responseType="arraybuffer";break;case"json":try{g.responseType="json",v=g.responseType==="json"}catch{v=!1}break;default:return y(new p(u.EINVAL,"Invalid download type: "+h))}g.onreadystatechange=function(E){if(g.readyState===4)if(g.status===200)switch(h){case"buffer":return y(null,g.response?s.from(g.response):le());case"json":return v?y(null,g.response):y(null,JSON.parse(g.responseText))}else return y(new p(g.status,"XHR error."))},g.send()}function Qee(b,h){var y=new XMLHttpRequest;y.open("GET",b,!1);var g=null,v=null;if(y.overrideMimeType("text/plain; charset=x-user-defined"),y.onreadystatechange=function(E){if(y.readyState===4)if(y.status===200)switch(h){case"buffer":var T=y.responseText;g=s.alloc(T.length);for(var P=0;P<T.length;P++)g[P]=T.charCodeAt(P);return;case"json":g=JSON.parse(y.responseText);return}else{v=new p(y.status,"XHR error.");return}},y.send(),v)throw v;return g}function ete(b,h){var y=new XMLHttpRequest;switch(y.open("GET",b,!1),h){case"buffer":y.responseType="arraybuffer";break;case"json":break;default:throw new p(u.EINVAL,"Invalid download type: "+h)}var g,v;if(y.onreadystatechange=function(E){if(y.readyState===4)if(y.status===200)switch(h){case"buffer":g=s.from(y.response);break;case"json":g=JSON.parse(y.response);break}else v=new p(y.status,"XHR error.")},y.send(),v)throw v;return g}function YF(b,h,y){var g=new XMLHttpRequest;g.open("HEAD",h,b),g.onreadystatechange=function(v){if(g.readyState===4)if(g.status===200)try{return y(null,parseInt(g.getResponseHeader("Content-Length")||"-1",10))}catch{return y(new p(u.EIO,"XHR HEAD error: Could not read content-length."))}else return y(new p(g.status,"XHR HEAD error."))},g.send()}var XF=Zee,tte=H&&typeof Blob<"u"?ete:Qee;function rte(b){var h=-1;return YF(!1,b,function(y,g){if(y)throw y;h=g}),h}function nte(b,h){YF(!0,b,h)}var As=function(){this._index={},this.addPath("/",new Ui)};As.fromListing=function(h){var y=new As,g=new Ui;y._index["/"]=g;for(var v=[["",h,g]];v.length>0;){var E=void 0,T=v.pop(),P=T[0],z=T[1],G=T[2];for(var ue in z)if(z.hasOwnProperty(ue)){var xe=z[ue],Pe=P+"/"+ue;xe?(y._index[Pe]=E=new Ui,v.push([Pe,xe,E])):E=new Jf(new O(S.FILE,-1,365)),G&&(G._ls[ue]=E)}}return y},As.prototype.fileIterator=function(h){var y=this;for(var g in y._index)if(y._index.hasOwnProperty(g))for(var v=y._index[g],E=v.getListing(),T=0,P=E;T<P.length;T+=1){var z=P[T],G=v.getItem(z);_o(G)&&h(G.getData())}},As.prototype.addPath=function(h,y){if(!y)throw new Error("Inode must be specified");if(h[0]!=="/")throw new Error("Path must be absolute, got: "+h);if(this._index.hasOwnProperty(h))return this._index[h]===y;var g=this._split_path(h),v=g[0],E=g[1],T=this._index[v];return T===void 0&&h!=="/"&&(T=new Ui,!this.addPath(v,T))||h!=="/"&&!T.addItem(E,y)?!1:(wl(y)&&(this._index[h]=y),!0)},As.prototype.addPathFast=function(h,y){var g=h.lastIndexOf("/"),v=g===0?"/":h.substring(0,g),E=h.substring(g+1),T=this._index[v];return T===void 0&&(T=new Ui,this.addPathFast(v,T)),T.addItem(E,y)?(y.isDir()&&(this._index[h]=y),!0):!1},As.prototype.removePath=function(h){var y=this,g=this._split_path(h),v=g[0],E=g[1],T=this._index[v];if(T===void 0)return null;var P=T.remItem(E);if(P===null)return null;if(wl(P)){for(var z=P.getListing(),G=0,ue=z;G<ue.length;G+=1){var xe=ue[G];y.removePath(h+"/"+xe)}h!=="/"&&delete this._index[h]}return P},As.prototype.ls=function(h){var y=this._index[h];return y===void 0?null:y.getListing()},As.prototype.getInode=function(h){var y=this._split_path(h),g=y[0],v=y[1],E=this._index[g];return E===void 0?null:g===h?E:E.getItem(v)},As.prototype._split_path=function(h){var y=f.dirname(h),g=h.substr(y.length+(y==="/"?0:1));return[y,g]};var Jf=function(h){this.data=h};Jf.prototype.isFile=function(){return!0},Jf.prototype.isDir=function(){return!1},Jf.prototype.getData=function(){return this.data},Jf.prototype.setData=function(h){this.data=h};var Ui=function(h){h===void 0&&(h=null),this.data=h,this._ls={}};Ui.prototype.isFile=function(){return!1},Ui.prototype.isDir=function(){return!0},Ui.prototype.getData=function(){return this.data},Ui.prototype.getStats=function(){return new O(S.DIRECTORY,4096,365)},Ui.prototype.getListing=function(){return Object.keys(this._ls)},Ui.prototype.getItem=function(h){var y=this._ls[h];return y||null},Ui.prototype.addItem=function(h,y){return h in this._ls?!1:(this._ls[h]=y,!0)},Ui.prototype.remItem=function(h){var y=this._ls[h];return y===void 0?null:(delete this._ls[h],y)};function _o(b){return!!b&&b.isFile()}function wl(b){return!!b&&b.isDir()}function ite(b,h,y){try{y(null,b.toString(h))}catch(g){y(g)}}var qv=function(b){function h(y,g,v){g===void 0&&(g=""),v===void 0&&(v=!0),b.call(this),y||(y="index.json"),g.length>0&&g.charAt(g.length-1)!=="/"&&(g=g+"/"),this.prefixUrl=g;var E=null;if(typeof y=="string"){if(E=this._requestFileSync(y,"json"),!E)throw new Error("Unable to find listing at URL: ${listingUrlOrObj}")}else E=y;F(v,h.Name,{index:typeof y=="string"?y:"file index as an object",baseUrl:g}),this._index=As.fromListing(E)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){g.index===void 0&&(g.index="index.json"),typeof g.index=="string"?h.FromURL(g.index,v,g.baseUrl,!1):v(null,new h(g.index,g.baseUrl,!1))},h.isAvailable=function(){return typeof XMLHttpRequest<"u"&&XMLHttpRequest!==null},h.FromURL=function(g,v,E,T){E===void 0&&(E=g.slice(0,g.lastIndexOf("/")+1)),T===void 0&&(T=!0),T&&console.warn(`[XmlHttpRequest] XmlHttpRequest.FromURL() is deprecated and will be removed in the next major release. Please use 'XmlHttpRequest.Create({ index: "`+g+'", baseUrl: "'+E+`" }, cb)' instead.`),XF(g,"json",function(P,z){P?v(P):v(null,new h(z,E,!1))})},h.prototype.empty=function(){this._index.fileIterator(function(g){g.fileData=null})},h.prototype.getName=function(){return h.Name},h.prototype.diskSpace=function(g,v){v(0,0)},h.prototype.isReadOnly=function(){return!0},h.prototype.supportsLinks=function(){return!1},h.prototype.supportsProps=function(){return!1},h.prototype.supportsSynch=function(){return!0},h.prototype.preloadFile=function(g,v){var E=this._index.getInode(g);if(_o(E)){if(E===null)throw p.ENOENT(g);var T=E.getData();T.size=v.length,T.fileData=v}else throw p.EISDIR(g)},h.prototype.stat=function(g,v,E){var T=this._index.getInode(g);if(T===null)return E(p.ENOENT(g));var P;_o(T)?(P=T.getData(),P.size<0?this._requestFileSizeAsync(g,function(z,G){if(z)return E(z);P.size=G,E(null,P.clone())}):E(null,P.clone())):wl(T)?(P=T.getStats(),E(null,P)):E(p.FileError(u.EINVAL,g))},h.prototype.statSync=function(g,v){var E=this._index.getInode(g);if(E===null)throw p.ENOENT(g);var T;if(_o(E))T=E.getData(),T.size<0&&(T.size=this._requestFileSizeSync(g));else if(wl(E))T=E.getStats();else throw p.FileError(u.EINVAL,g);return T},h.prototype.open=function(g,v,E,T){if(v.isWriteable())return T(new p(u.EPERM,g));var P=this,z=this._index.getInode(g);if(z===null)return T(p.ENOENT(g));if(_o(z)){var G=z.getData();switch(v.pathExistsAction()){case w.THROW_EXCEPTION:case w.TRUNCATE_FILE:return T(p.EEXIST(g));case w.NOP:if(G.fileData)return T(null,new St(P,g,v,G.clone(),G.fileData));this._requestFileAsync(g,"buffer",function(ue,xe){return ue?T(ue):(G.size=xe.length,G.fileData=xe,T(null,new St(P,g,v,G.clone(),xe)))});break;default:return T(new p(u.EINVAL,"Invalid FileMode object."))}}else return T(p.EISDIR(g))},h.prototype.openSync=function(g,v,E){if(v.isWriteable())throw new p(u.EPERM,g);var T=this._index.getInode(g);if(T===null)throw p.ENOENT(g);if(_o(T)){var P=T.getData();switch(v.pathExistsAction()){case w.THROW_EXCEPTION:case w.TRUNCATE_FILE:throw p.EEXIST(g);case w.NOP:if(P.fileData)return new St(this,g,v,P.clone(),P.fileData);var z=this._requestFileSync(g,"buffer");return P.size=z.length,P.fileData=z,new St(this,g,v,P.clone(),z);default:throw new p(u.EINVAL,"Invalid FileMode object.")}}else throw p.EISDIR(g)},h.prototype.readdir=function(g,v){try{v(null,this.readdirSync(g))}catch(E){v(E)}},h.prototype.readdirSync=function(g){var v=this._index.getInode(g);if(v===null)throw p.ENOENT(g);if(wl(v))return v.getListing();throw p.ENOTDIR(g)},h.prototype.readFile=function(g,v,E,T){var P=T;this.open(g,E,420,function(z,G){if(z)return T(z);T=function(Pe,We){G.close(function(Ke){return Pe||(Pe=Ke),P(Pe,We)})};var ue=G,xe=ue.getBuffer();v===null?T(z,Ee(xe)):ite(xe,v,T)})},h.prototype.readFileSync=function(g,v,E){var T=this.openSync(g,E,420);try{var P=T,z=P.getBuffer();return v===null?Ee(z):z.toString(v)}finally{T.closeSync()}},h.prototype.getXhrPath=function(g){return g.charAt(0)==="/"&&(g=g.slice(1)),this.prefixUrl+g},h.prototype._requestFileAsync=function(g,v,E){XF(this.getXhrPath(g),v,E)},h.prototype._requestFileSync=function(g,v){return tte(this.getXhrPath(g),v)},h.prototype._requestFileSizeAsync=function(g,v){nte(this.getXhrPath(g),v)},h.prototype._requestFileSizeSync=function(g){return rte(this.getXhrPath(g))},h}(Ce);qv.Name="XmlHttpRequest",qv.Options={index:{type:["string","object"],optional:!0,description:"URL to a file index as a JSON file or the file index object itself, generated with the make_xhrfs_index script. Defaults to `index.json`."},baseUrl:{type:"string",optional:!0,description:"Used as the URL prefix for fetched files. Default: Fetch files relative to the index."}};var Zc=function(){};Zc.str2byte=function(h,y){for(var g=h.length>y.length?y.length:h.length,v=0;v<g;v++){var E=h.charCodeAt(v);if(E>127){var T=Zc.extendedChars.indexOf(h.charAt(v));T>-1&&(E=T+128)}y[E]=v}return g},Zc.byte2str=function(h){for(var y=new Array(h.length),g=0;g<h.length;g++){var v=h[g];v>127?y[g]=Zc.extendedChars[v-128]:y[g]=String.fromCharCode(v)}return y.join("")},Zc.byteLength=function(h){return h.length},Zc.extendedChars=["\xC7","\xFC","\xE9","\xE2","\xE4","\xE0","\xE5","\xE7","\xEA","\xEB","\xE8","\xEF","\xEE","\xEC","\xC4","\xC5","\xC9","\xE6","\xC6","\xF4","\xF6","\xF2","\xFB","\xF9","\xFF","\xD6","\xDC","\xF8","\xA3","\xD8","\xD7","\u0192","\xE1","\xED","\xF3","\xFA","\xF1","\xD1","\xAA","\xBA","\xBF","\xAE","\xAC","\xBD","\xBC","\xA1","\xAB","\xBB","_","_","_","\xA6","\xA6","\xC1","\xC2","\xC0","\xA9","\xA6","\xA6","+","+","\xA2","\xA5","+","+","-","-","+","-","+","\xE3","\xC3","+","+","-","-","\xA6","-","+","\xA4","\xF0","\xD0","\xCA","\xCB","\xC8","i","\xCD","\xCE","\xCF","+","+","_","_","\xA6","\xCC","_","\xD3","\xDF","\xD4","\xD2","\xF5","\xD5","\xB5","\xFE","\xDE","\xDA","\xDB","\xD9","\xFD","\xDD","\xAF","\xB4","\xAD","\xB1","_","\xBE","\xB6","\xA7","\xF7","\xB8","\xB0","\xA8","\xB7","\xB9","\xB3","\xB2","_"," "];var ste=i(31).inflateRaw,ZF={},QF;(function(b){b[b.MSDOS=0]="MSDOS",b[b.AMIGA=1]="AMIGA",b[b.OPENVMS=2]="OPENVMS",b[b.UNIX=3]="UNIX",b[b.VM_CMS=4]="VM_CMS",b[b.ATARI_ST=5]="ATARI_ST",b[b.OS2_HPFS=6]="OS2_HPFS",b[b.MAC=7]="MAC",b[b.Z_SYSTEM=8]="Z_SYSTEM",b[b.CP_M=9]="CP_M",b[b.NTFS=10]="NTFS",b[b.MVS=11]="MVS",b[b.VSE=12]="VSE",b[b.ACORN_RISC=13]="ACORN_RISC",b[b.VFAT=14]="VFAT",b[b.ALT_MVS=15]="ALT_MVS",b[b.BEOS=16]="BEOS",b[b.TANDEM=17]="TANDEM",b[b.OS_400=18]="OS_400",b[b.OSX=19]="OSX"})(QF||(QF={}));var Gf;(function(b){b[b.STORED=0]="STORED",b[b.SHRUNK=1]="SHRUNK",b[b.REDUCED_1=2]="REDUCED_1",b[b.REDUCED_2=3]="REDUCED_2",b[b.REDUCED_3=4]="REDUCED_3",b[b.REDUCED_4=5]="REDUCED_4",b[b.IMPLODE=6]="IMPLODE",b[b.DEFLATE=8]="DEFLATE",b[b.DEFLATE64=9]="DEFLATE64",b[b.TERSE_OLD=10]="TERSE_OLD",b[b.BZIP2=12]="BZIP2",b[b.LZMA=14]="LZMA",b[b.TERSE_NEW=18]="TERSE_NEW",b[b.LZ77=19]="LZ77",b[b.WAVPACK=97]="WAVPACK",b[b.PPMD=98]="PPMD"})(Gf||(Gf={}));function eD(b,h){var y=h&31,g=(h>>5&15)-1,v=(h>>9)+1980,E=b&31,T=b>>5&63,P=b>>11;return new Date(v,g,y,P,T,E)}function Vv(b,h,y,g){return g===0?"":h?b.toString("utf8",y,y+g):Zc.byte2str(b.slice(y,y+g))}var os=function(h){if(this.data=h,h.readUInt32LE(0)!==67324752)throw new p(u.EINVAL,"Invalid Zip file: Local file header has invalid signature: "+this.data.readUInt32LE(0))};os.prototype.versionNeeded=function(){return this.data.readUInt16LE(4)},os.prototype.flags=function(){return this.data.readUInt16LE(6)},os.prototype.compressionMethod=function(){return this.data.readUInt16LE(8)},os.prototype.lastModFileTime=function(){return eD(this.data.readUInt16LE(10),this.data.readUInt16LE(12))},os.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(10)},os.prototype.crc32=function(){return this.data.readUInt32LE(14)},os.prototype.fileNameLength=function(){return this.data.readUInt16LE(26)},os.prototype.extraFieldLength=function(){return this.data.readUInt16LE(28)},os.prototype.fileName=function(){return Vv(this.data,this.useUTF8(),30,this.fileNameLength())},os.prototype.extraField=function(){var h=30+this.fileNameLength();return this.data.slice(h,h+this.extraFieldLength())},os.prototype.totalSize=function(){return 30+this.fileNameLength()+this.extraFieldLength()},os.prototype.useUTF8=function(){return(this.flags()&2048)===2048};var _g=function(h,y,g){this.header=h,this.record=y,this.data=g};_g.prototype.decompress=function(){var h=this.header.compressionMethod(),y=ZF[h];if(y)return y(this.data,this.record.compressedSize(),this.record.uncompressedSize(),this.record.flag());var g=Gf[h];throw g||(g="Unknown: "+h),new p(u.EINVAL,"Invalid compression method on file '"+this.header.fileName()+"': "+g)},_g.prototype.getHeader=function(){return this.header},_g.prototype.getRecord=function(){return this.record},_g.prototype.getRawData=function(){return this.data};var ik=function(h){this.data=h};ik.prototype.crc32=function(){return this.data.readUInt32LE(0)},ik.prototype.compressedSize=function(){return this.data.readUInt32LE(4)},ik.prototype.uncompressedSize=function(){return this.data.readUInt32LE(8)};var tD=function(h){if(this.data=h,this.data.readUInt32LE(0)!==134630224)throw new p(u.EINVAL,"Invalid archive extra data record signature: "+this.data.readUInt32LE(0))};tD.prototype.length=function(){return this.data.readUInt32LE(4)},tD.prototype.extraFieldData=function(){return this.data.slice(8,8+this.length())};var rD=function(h){if(this.data=h,this.data.readUInt32LE(0)!==84233040)throw new p(u.EINVAL,"Invalid digital signature signature: "+this.data.readUInt32LE(0))};rD.prototype.size=function(){return this.data.readUInt16LE(4)},rD.prototype.signatureData=function(){return this.data.slice(6,6+this.size())};var Kt=function(h,y){if(this.zipData=h,this.data=y,this.data.readUInt32LE(0)!==33639248)throw new p(u.EINVAL,"Invalid Zip file: Central directory record has invalid signature: "+this.data.readUInt32LE(0));this._filename=this.produceFilename()};Kt.prototype.versionMadeBy=function(){return this.data.readUInt16LE(4)},Kt.prototype.versionNeeded=function(){return this.data.readUInt16LE(6)},Kt.prototype.flag=function(){return this.data.readUInt16LE(8)},Kt.prototype.compressionMethod=function(){return this.data.readUInt16LE(10)},Kt.prototype.lastModFileTime=function(){return eD(this.data.readUInt16LE(12),this.data.readUInt16LE(14))},Kt.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(12)},Kt.prototype.crc32=function(){return this.data.readUInt32LE(16)},Kt.prototype.compressedSize=function(){return this.data.readUInt32LE(20)},Kt.prototype.uncompressedSize=function(){return this.data.readUInt32LE(24)},Kt.prototype.fileNameLength=function(){return this.data.readUInt16LE(28)},Kt.prototype.extraFieldLength=function(){return this.data.readUInt16LE(30)},Kt.prototype.fileCommentLength=function(){return this.data.readUInt16LE(32)},Kt.prototype.diskNumberStart=function(){return this.data.readUInt16LE(34)},Kt.prototype.internalAttributes=function(){return this.data.readUInt16LE(36)},Kt.prototype.externalAttributes=function(){return this.data.readUInt32LE(38)},Kt.prototype.headerRelativeOffset=function(){return this.data.readUInt32LE(42)},Kt.prototype.produceFilename=function(){var h=Vv(this.data,this.useUTF8(),46,this.fileNameLength());return h.replace(/\\/g,"/")},Kt.prototype.fileName=function(){return this._filename},Kt.prototype.rawFileName=function(){return this.data.slice(46,46+this.fileNameLength())},Kt.prototype.extraField=function(){var h=44+this.fileNameLength();return this.data.slice(h,h+this.extraFieldLength())},Kt.prototype.fileComment=function(){var h=46+this.fileNameLength()+this.extraFieldLength();return Vv(this.data,this.useUTF8(),h,this.fileCommentLength())},Kt.prototype.rawFileComment=function(){var h=46+this.fileNameLength()+this.extraFieldLength();return this.data.slice(h,h+this.fileCommentLength())},Kt.prototype.totalSize=function(){return 46+this.fileNameLength()+this.extraFieldLength()+this.fileCommentLength()},Kt.prototype.isDirectory=function(){var h=this.fileName();return!!(this.externalAttributes()&16)||h.charAt(h.length-1)==="/"},Kt.prototype.isFile=function(){return!this.isDirectory()},Kt.prototype.useUTF8=function(){return(this.flag()&2048)===2048},Kt.prototype.isEncrypted=function(){return(this.flag()&1)===1},Kt.prototype.getFileData=function(){var h=this.headerRelativeOffset(),y=new os(this.zipData.slice(h));return new _g(y,this,this.zipData.slice(h+y.totalSize()))},Kt.prototype.getData=function(){return this.getFileData().decompress()},Kt.prototype.getRawData=function(){return this.getFileData().getRawData()},Kt.prototype.getStats=function(){return new O(S.FILE,this.uncompressedSize(),365,new Date,this.lastModFileTime())};var Fa=function(h){if(this.data=h,this.data.readUInt32LE(0)!==101010256)throw new p(u.EINVAL,"Invalid Zip file: End of central directory record has invalid signature: "+this.data.readUInt32LE(0))};Fa.prototype.diskNumber=function(){return this.data.readUInt16LE(4)},Fa.prototype.cdDiskNumber=function(){return this.data.readUInt16LE(6)},Fa.prototype.cdDiskEntryCount=function(){return this.data.readUInt16LE(8)},Fa.prototype.cdTotalEntryCount=function(){return this.data.readUInt16LE(10)},Fa.prototype.cdSize=function(){return this.data.readUInt32LE(12)},Fa.prototype.cdOffset=function(){return this.data.readUInt32LE(16)},Fa.prototype.cdZipCommentLength=function(){return this.data.readUInt16LE(20)},Fa.prototype.cdZipComment=function(){return Vv(this.data,!0,22,this.cdZipCommentLength())},Fa.prototype.rawCdZipComment=function(){return this.data.slice(22,22+this.cdZipCommentLength())};var nD=function(h,y,g,v){this.index=h,this.directoryEntries=y,this.eocd=g,this.data=v},Qc=function(b){function h(y,g,v){g===void 0&&(g=""),v===void 0&&(v=!0),b.call(this),this.name=g,this._index=new As,this._directoryEntries=[],this._eocd=null,F(v,h.Name,{zipData:"zip data as a Buffer",name:g}),y instanceof nD?(this._index=y.index,this._directoryEntries=y.directoryEntries,this._eocd=y.eocd,this.data=y.data):(this.data=y,this.populateIndex())}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){try{h.computeIndex(g.zipData,function(E){var T=new h(E,g.name,!1);v(null,T)},!1)}catch(E){v(E)}},h.isAvailable=function(){return!0},h.RegisterDecompressionMethod=function(g,v){ZF[g]=v},h.computeIndex=function(g,v,E){E===void 0&&(E=!0),E&&console.warn("[ZipFS] ZipFS.computeIndex is now deprecated, and will be removed in the next major release. Please update your code to use 'ZipFS.Create({ zipData: zip file as a Buffer}, cb)' instead.");var T=new As,P=h.getEOCD(g);if(P.diskNumber()!==P.cdDiskNumber())throw new p(u.EINVAL,"ZipFS does not support spanned zip files.");var z=P.cdOffset();if(z===4294967295)throw new p(u.EINVAL,"ZipFS does not support Zip64.");var G=z+P.cdSize();h.computeIndexResponsive(g,T,z,G,v,[],P)},h.getEOCD=function(g){for(var v=22,E=Math.min(v+65535,g.length-1),T=v;T<E;T++)if(g.readUInt32LE(g.length-T)===101010256)return new Fa(g.slice(g.length-T));throw new p(u.EINVAL,"Invalid ZIP file: Could not locate End of Central Directory signature.")},h.addToIndex=function(g,v){var E=g.fileName();if(E.charAt(0)==="/")throw new Error("WHY IS THIS ABSOLUTE");E.charAt(E.length-1)==="/"&&(E=E.substr(0,E.length-1)),g.isDirectory()?v.addPathFast("/"+E,new Ui(g)):v.addPathFast("/"+E,new Jf(g))},h.computeIndexResponsive=function(g,v,E,T,P,z,G){if(E<T){for(var ue=0;ue++<200&&E<T;){var xe=new Kt(g,g.slice(E));h.addToIndex(xe,v),E+=xe.totalSize(),z.push(xe)}rk(function(){h.computeIndexResponsive(g,v,E,T,P,z,G)})}else P(new nD(v,z,G,g))},h.prototype.getName=function(){return h.Name+(this.name!==""?" "+this.name:"")},h.prototype.getCentralDirectoryEntry=function(g){var v=this._index.getInode(g);if(v===null)throw p.ENOENT(g);if(_o(v))return v.getData();if(wl(v))return v.getData();throw p.EPERM("Invalid inode: "+v)},h.prototype.getCentralDirectoryEntryAt=function(g){var v=this._directoryEntries[g];if(!v)throw new RangeError("Invalid directory index: "+g+".");return v},h.prototype.getNumberOfCentralDirectoryEntries=function(){return this._directoryEntries.length},h.prototype.getEndOfCentralDirectory=function(){return this._eocd},h.prototype.diskSpace=function(g,v){v(this.data.length,0)},h.prototype.isReadOnly=function(){return!0},h.prototype.supportsLinks=function(){return!1},h.prototype.supportsProps=function(){return!1},h.prototype.supportsSynch=function(){return!0},h.prototype.statSync=function(g,v){var E=this._index.getInode(g);if(E===null)throw p.ENOENT(g);var T;if(_o(E))T=E.getData().getStats();else if(wl(E))T=E.getStats();else throw new p(u.EINVAL,"Invalid inode.");return T},h.prototype.openSync=function(g,v,E){if(v.isWriteable())throw new p(u.EPERM,g);var T=this._index.getInode(g);if(T)if(_o(T)){var P=T.getData(),z=P.getStats();switch(v.pathExistsAction()){case w.THROW_EXCEPTION:case w.TRUNCATE_FILE:throw p.EEXIST(g);case w.NOP:return new St(this,g,v,z,P.getData());default:throw new p(u.EINVAL,"Invalid FileMode object.")}}else throw p.EISDIR(g);else throw p.ENOENT(g)},h.prototype.readdirSync=function(g){var v=this._index.getInode(g);if(v){if(wl(v))return v.getListing();throw p.ENOTDIR(g)}else throw p.ENOENT(g)},h.prototype.readFileSync=function(g,v,E){var T=this.openSync(g,E,420);try{var P=T,z=P.getBuffer();return v===null?Ee(z):z.toString(v)}finally{T.closeSync()}},h.prototype.populateIndex=function(){var g=this,v=this._eocd=h.getEOCD(this.data);if(v.diskNumber()!==v.cdDiskNumber())throw new p(u.EINVAL,"ZipFS does not support spanned zip files.");var E=v.cdOffset();if(E===4294967295)throw new p(u.EINVAL,"ZipFS does not support Zip64.");for(var T=E+v.cdSize();E<T;){var P=new Kt(g.data,g.data.slice(E));E+=P.totalSize(),h.addToIndex(P,g._index),g._directoryEntries.push(P)}},h}(Xe);Qc.Name="ZipFS",Qc.Options={zipData:{type:"object",description:"The zip file as a Buffer object.",validator:we},name:{type:"string",optional:!0,description:"The name of the zip file (optional)."}},Qc.CompressionMethod=Gf,Qc.RegisterDecompressionMethod(Gf.DEFLATE,function(b,h,y){return oe(ste(b.slice(0,h),{chunkSize:y}))}),Qc.RegisterDecompressionMethod(Gf.STORED,function(b,h,y){return Ee(b,0,y)});var ate="IEEE_P1282";function zi(b,h,y){return b.toString("ascii",h,h+y).trim()}function sk(b,h,y){if(y===1)return String.fromCharCode(b[h]);for(var g=Math.floor(y/2),v=new Array(g),E=0;E<g;E++){var T=h+(E<<1);v[E]=String.fromCharCode(b[T+1]|b[T]<<8)}return v.join("")}function Da(b,h){var y=parseInt(zi(b,h,4),10),g=parseInt(zi(b,h+4,2),10),v=parseInt(zi(b,h+6,2),10),E=parseInt(zi(b,h+8,2),10),T=parseInt(zi(b,h+10,2),10),P=parseInt(zi(b,h+12,2),10),z=parseInt(zi(b,h+14,2),10);return new Date(y,g,v,E,T,P,z*100)}function eu(b,h){var y=b[h],g=b[h+1],v=b[h+2],E=b[h+3],T=b[h+4],P=b[h+5];return new Date(y,g-1,v,E,T,P)}function ote(b,h){var y=b.slice(h),g=new an(y);switch(g.signatureWord()){case 17221:return new lD(y);case 20548:return new ute(y);case 21328:return new cD(y);case 21332:return new uD(y);case 17746:return new fD(y);case 17747:return new fte(y);case 20568:return new pD(y);case 20558:return new dte(y);case 21324:return new ak(y);case 20045:return new hD(y);case 17228:return new ok(y);case 20556:return new pte(y);case 21061:return new gD(y);case 21574:return new yD(y);case 21318:return new hte(y);case 21074:return new dD(y);default:return g}}function iD(b,h,y,g){y=y-4;for(var v=new Array;h<y;){var E=ote(b,h),T=E.length();if(T===0)return v;if(h+=T,E instanceof uD)break;E instanceof lD?v=v.concat(E.getEntries(g)):v.push(E)}return v}var Kf=function(h){this._data=h};Kf.prototype.type=function(){return this._data[0]},Kf.prototype.standardIdentifier=function(){return zi(this._data,1,5)},Kf.prototype.version=function(){return this._data[6]},Kf.prototype.data=function(){return this._data.slice(7,2048)};var sD=function(b){function h(y){b.call(this,y),this._root=null}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.systemIdentifier=function(){return this._getString32(8)},h.prototype.volumeIdentifier=function(){return this._getString32(40)},h.prototype.volumeSpaceSize=function(){return this._data.readUInt32LE(80)},h.prototype.volumeSetSize=function(){return this._data.readUInt16LE(120)},h.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(124)},h.prototype.logicalBlockSize=function(){return this._data.readUInt16LE(128)},h.prototype.pathTableSize=function(){return this._data.readUInt32LE(132)},h.prototype.locationOfTypeLPathTable=function(){return this._data.readUInt32LE(140)},h.prototype.locationOfOptionalTypeLPathTable=function(){return this._data.readUInt32LE(144)},h.prototype.locationOfTypeMPathTable=function(){return this._data.readUInt32BE(148)},h.prototype.locationOfOptionalTypeMPathTable=function(){return this._data.readUInt32BE(152)},h.prototype.rootDirectoryEntry=function(g){return this._root===null&&(this._root=this._constructRootDirectoryRecord(this._data.slice(156)),this._root.rootCheckForRockRidge(g)),this._root},h.prototype.volumeSetIdentifier=function(){return this._getString(190,128)},h.prototype.publisherIdentifier=function(){return this._getString(318,128)},h.prototype.dataPreparerIdentifier=function(){return this._getString(446,128)},h.prototype.applicationIdentifier=function(){return this._getString(574,128)},h.prototype.copyrightFileIdentifier=function(){return this._getString(702,38)},h.prototype.abstractFileIdentifier=function(){return this._getString(740,36)},h.prototype.bibliographicFileIdentifier=function(){return this._getString(776,37)},h.prototype.volumeCreationDate=function(){return Da(this._data,813)},h.prototype.volumeModificationDate=function(){return Da(this._data,830)},h.prototype.volumeExpirationDate=function(){return Da(this._data,847)},h.prototype.volumeEffectiveDate=function(){return Da(this._data,864)},h.prototype.fileStructureVersion=function(){return this._data[881]},h.prototype.applicationUsed=function(){return this._data.slice(883,883+512)},h.prototype.reserved=function(){return this._data.slice(1395,1395+653)},h.prototype._getString32=function(g){return this._getString(g,32)},h}(Kf),lte=function(b){function h(y){if(b.call(this,y),this.type()!==1)throw new p(u.EIO,"Invalid primary volume descriptor.")}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.name=function(){return"ISO9660"},h.prototype._constructRootDirectoryRecord=function(g){return new aD(g,-1)},h.prototype._getString=function(g,v){return this._getString(g,v)},h}(sD),cte=function(b){function h(y){if(b.call(this,y),this.type()!==2)throw new p(u.EIO,"Invalid supplementary volume descriptor.");var g=this.escapeSequence(),v=g[2];if(g[0]!==37||g[1]!==47||v!==64&&v!==67&&v!==69)throw new p(u.EIO,"Unrecognized escape sequence for SupplementaryVolumeDescriptor: "+g.toString())}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.name=function(){return"Joliet"},h.prototype.escapeSequence=function(){return this._data.slice(88,120)},h.prototype._constructRootDirectoryRecord=function(g){return new oD(g,-1)},h.prototype._getString=function(g,v){return sk(this._data,g,v)},h}(sD),Lr=function(h,y){this._suEntries=null,this._fileOrDir=null,this._data=h,this._rockRidgeOffset=y};Lr.prototype.hasRockRidge=function(){return this._rockRidgeOffset>-1},Lr.prototype.getRockRidgeOffset=function(){return this._rockRidgeOffset},Lr.prototype.rootCheckForRockRidge=function(h){var y=this.getDirectory(h);this._rockRidgeOffset=y.getDotEntry(h)._getRockRidgeOffset(h),this._rockRidgeOffset>-1&&(this._fileOrDir=null)},Lr.prototype.length=function(){return this._data[0]},Lr.prototype.extendedAttributeRecordLength=function(){return this._data[1]},Lr.prototype.lba=function(){return this._data.readUInt32LE(2)*2048},Lr.prototype.dataLength=function(){return this._data.readUInt32LE(10)},Lr.prototype.recordingDate=function(){return eu(this._data,18)},Lr.prototype.fileFlags=function(){return this._data[25]},Lr.prototype.fileUnitSize=function(){return this._data[26]},Lr.prototype.interleaveGapSize=function(){return this._data[27]},Lr.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(28)},Lr.prototype.identifier=function(){return this._getString(33,this._data[32])},Lr.prototype.fileName=function(h){if(this.hasRockRidge()){var y=this._rockRidgeFilename(h);if(y!==null)return y}var g=this.identifier();if(this.isDirectory(h))return g;var v=g.indexOf(";");return v===-1?g:g[v-1]==="."?g.slice(0,v-1):g.slice(0,v)},Lr.prototype.isDirectory=function(h){var y=!!(this.fileFlags()&2);return!y&&this.hasRockRidge()&&(y=this.getSUEntries(h).filter(function(g){return g instanceof ok}).length>0),y},Lr.prototype.isSymlink=function(h){return this.hasRockRidge()&&this.getSUEntries(h).filter(function(y){return y instanceof ak}).length>0},Lr.prototype.getSymlinkPath=function(h){for(var y="",g=this.getSUEntries(h),v=this._getGetString(),E=0,T=g;E<T.length;E+=1){var P=T[E];if(P instanceof ak){for(var z=P.componentRecords(),G=0,ue=z;G<ue.length;G+=1){var xe=ue[G],Pe=xe.flags();Pe&2?y+="./":Pe&4?y+="../":Pe&8?y+="/":(y+=xe.content(v),Pe&1||(y+="/"))}if(!P.continueFlag())break}}return y.length>1&&y[y.length-1]==="/"?y.slice(0,y.length-1):y},Lr.prototype.getFile=function(h){if(this.isDirectory(h))throw new Error("Tried to get a File from a directory.");return this._fileOrDir===null&&(this._fileOrDir=h.slice(this.lba(),this.lba()+this.dataLength())),this._fileOrDir},Lr.prototype.getDirectory=function(h){if(!this.isDirectory(h))throw new Error("Tried to get a Directory from a file.");return this._fileOrDir===null&&(this._fileOrDir=this._constructDirectory(h)),this._fileOrDir},Lr.prototype.getSUEntries=function(h){return this._suEntries||this._constructSUEntries(h),this._suEntries},Lr.prototype._rockRidgeFilename=function(h){var y=this.getSUEntries(h).filter(function(z){return z instanceof hD});if(y.length===0||y[0].flags()&6)return null;for(var g="",v=this._getGetString(),E=0,T=y;E<T.length;E+=1){var P=T[E];if(g+=P.name(v),!(P.flags()&1))break}return g},Lr.prototype._constructSUEntries=function(h){var y=33+this._data[32];y%2===1&&y++,y+=this._rockRidgeOffset,this._suEntries=iD(this._data,y,this.length(),h)},Lr.prototype._getRockRidgeOffset=function(h){this._rockRidgeOffset=0;var y=this.getSUEntries(h);if(y.length>0){var g=y[0];if(g instanceof cD&&g.checkBytesPass())for(var v=1;v<y.length;v++){var E=y[v];if(E instanceof dD||E instanceof fD&&E.extensionIdentifier()===ate)return g.bytesSkipped()}}return this._rockRidgeOffset=-1,-1};var aD=function(b){function h(y,g){b.call(this,y,g)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype._getString=function(g,v){return zi(this._data,g,v)},h.prototype._constructDirectory=function(g){return new gte(this,g)},h.prototype._getGetString=function(){return zi},h}(Lr),oD=function(b){function h(y,g){b.call(this,y,g)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype._getString=function(g,v){return sk(this._data,g,v)},h.prototype._constructDirectory=function(g){return new yte(this,g)},h.prototype._getGetString=function(){return sk},h}(Lr),an=function(h){this._data=h};an.prototype.signatureWord=function(){return this._data.readUInt16BE(0)},an.prototype.signatureWordString=function(){return zi(this._data,0,2)},an.prototype.length=function(){return this._data[2]},an.prototype.suVersion=function(){return this._data[3]};var lD=function(b){function h(y){b.call(this,y),this._entries=null}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.continuationLba=function(){return this._data.readUInt32LE(4)},h.prototype.continuationLbaOffset=function(){return this._data.readUInt32LE(12)},h.prototype.continuationLength=function(){return this._data.readUInt32LE(20)},h.prototype.getEntries=function(g){if(!this._entries){var v=this.continuationLba()*2048+this.continuationLbaOffset();this._entries=iD(g,v,this.continuationLength(),g)}return this._entries},h}(an),ute=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h}(an),cD=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.checkBytesPass=function(){return this._data[4]===190&&this._data[5]===239},h.prototype.bytesSkipped=function(){return this._data[6]},h}(an),uD=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h}(an),fD=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.identifierLength=function(){return this._data[4]},h.prototype.descriptorLength=function(){return this._data[5]},h.prototype.sourceLength=function(){return this._data[6]},h.prototype.extensionVersion=function(){return this._data[7]},h.prototype.extensionIdentifier=function(){return zi(this._data,8,this.identifierLength())},h.prototype.extensionDescriptor=function(){return zi(this._data,8+this.identifierLength(),this.descriptorLength())},h.prototype.extensionSource=function(){return zi(this._data,8+this.identifierLength()+this.descriptorLength(),this.sourceLength())},h}(an),fte=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.extensionSequence=function(){return this._data[4]},h}(an),dD=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h}(an),pD=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.mode=function(){return this._data.readUInt32LE(4)},h.prototype.fileLinks=function(){return this._data.readUInt32LE(12)},h.prototype.uid=function(){return this._data.readUInt32LE(20)},h.prototype.gid=function(){return this._data.readUInt32LE(28)},h.prototype.inode=function(){return this._data.readUInt32LE(36)},h}(an),dte=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.devTHigh=function(){return this._data.readUInt32LE(4)},h.prototype.devTLow=function(){return this._data.readUInt32LE(12)},h}(an),ak=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.flags=function(){return this._data[4]},h.prototype.continueFlag=function(){return this.flags()&1},h.prototype.componentRecords=function(){for(var g=this,v=new Array,E=5;E<this.length();){var T=new wg(g._data.slice(E));v.push(T),E+=T.length()}return v},h}(an),wg=function(h){this._data=h};wg.prototype.flags=function(){return this._data[0]},wg.prototype.length=function(){return 2+this.componentLength()},wg.prototype.componentLength=function(){return this._data[1]},wg.prototype.content=function(h){return h(this._data,2,this.componentLength())};var hD=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.flags=function(){return this._data[4]},h.prototype.name=function(g){return g(this._data,5,this.length()-5)},h}(an),ok=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.childDirectoryLba=function(){return this._data.readUInt32LE(4)},h}(an),pte=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.parentDirectoryLba=function(){return this._data.readUInt32LE(4)},h}(an),gD=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h}(an),yD=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.flags=function(){return this._data[4]},h.prototype.creation=function(){return this.flags()&1?this._longFormDates()?Da(this._data,5):eu(this._data,5):null},h.prototype.modify=function(){if(this.flags()&2){var g=this.flags()&1?1:0;return this._longFormDates?Da(this._data,5+g*17):eu(this._data,5+g*7)}else return null},h.prototype.access=function(){if(this.flags()&4){var g=this.flags()&1?1:0;return g+=this.flags()&2?1:0,this._longFormDates?Da(this._data,5+g*17):eu(this._data,5+g*7)}else return null},h.prototype.backup=function(){if(this.flags()&16){var g=this.flags()&1?1:0;return g+=this.flags()&2?1:0,g+=this.flags()&4?1:0,this._longFormDates?Da(this._data,5+g*17):eu(this._data,5+g*7)}else return null},h.prototype.expiration=function(){if(this.flags()&32){var g=this.flags()&1?1:0;return g+=this.flags()&2?1:0,g+=this.flags()&4?1:0,g+=this.flags()&16?1:0,this._longFormDates?Da(this._data,5+g*17):eu(this._data,5+g*7)}else return null},h.prototype.effective=function(){if(this.flags()&64){var g=this.flags()&1?1:0;return g+=this.flags()&2?1:0,g+=this.flags()&4?1:0,g+=this.flags()&16?1:0,g+=this.flags()&32?1:0,this._longFormDates?Da(this._data,5+g*17):eu(this._data,5+g*7)}else return null},h.prototype._longFormDates=function(){return!!this.flags()},h}(an),hte=function(b){function h(y){b.call(this,y)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype.virtualSizeHigh=function(){return this._data.readUInt32LE(4)},h.prototype.virtualSizeLow=function(){return this._data.readUInt32LE(12)},h.prototype.tableDepth=function(){return this._data[20]},h}(an),Sg=function(h,y){var g=this;this._fileList=[],this._fileMap={},this._record=h;var v=h.lba(),E=v+h.dataLength();if(!(h.fileFlags()&2)){var T=h.getSUEntries(y).filter(function(ue){return ue instanceof ok})[0];v=T.childDirectoryLba()*2048,E=1/0}for(;v<E;){var P=y[v];if(P===0){v++;continue}var z=g._constructDirectoryRecord(y.slice(v)),G=z.fileName(y);G!=="\0"&&G!==""?(!z.hasRockRidge()||z.getSUEntries(y).filter(function(ue){return ue instanceof gD}).length===0)&&(g._fileMap[G]=z,g._fileList.push(G)):E===1/0&&(E=v+z.dataLength()),v+=z.length()}};Sg.prototype.getRecord=function(h){return this._fileMap[h]},Sg.prototype.getFileList=function(){return this._fileList},Sg.prototype.getDotEntry=function(h){return this._constructDirectoryRecord(h.slice(this._record.lba()))};var gte=function(b){function h(y,g){b.call(this,y,g)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype._constructDirectoryRecord=function(g){return new aD(g,this._record.getRockRidgeOffset())},h}(Sg),yte=function(b){function h(y,g){b.call(this,y,g)}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.prototype._constructDirectoryRecord=function(g){return new oD(g,this._record.getRockRidgeOffset())},h}(Sg),Hv=function(b){function h(y,g,v){var E=this;g===void 0&&(g=""),v===void 0&&(v=!0),b.call(this),this._data=y,F(v,h.Name,{data:"ISO data as a Buffer",name:g});for(var T=!1,P=16*2048,z=new Array;!T;){var G=y.slice(P),ue=new Kf(G);switch(ue.type()){case 1:z.push(new lte(G));break;case 2:z.push(new cte(G));break;case 255:T=!0;break}P+=2048}if(z.length===0)throw new p(u.EIO,"Unable to find a suitable volume descriptor.");z.forEach(function(xe){(!E._pvd||E._pvd.type()!==2)&&(E._pvd=xe)}),this._root=this._pvd.rootDirectoryEntry(y),this._name=g}return b&&(h.__proto__=b),h.prototype=Object.create(b&&b.prototype),h.prototype.constructor=h,h.Create=function(g,v){var E,T;try{E=new h(g.data,g.name,!1)}catch(P){P=P}finally{v(T,E)}},h.isAvailable=function(){return!0},h.prototype.getName=function(){var g="IsoFS"+this._name+(this._pvd?"-"+this._pvd.name():"");return this._root&&this._root.hasRockRidge()&&(g+="-RockRidge"),g},h.prototype.diskSpace=function(g,v){v(this._data.length,0)},h.prototype.isReadOnly=function(){return!0},h.prototype.supportsLinks=function(){return!1},h.prototype.supportsProps=function(){return!1},h.prototype.supportsSynch=function(){return!0},h.prototype.statSync=function(g,v){var E=this._getDirectoryRecord(g);if(E===null)throw p.ENOENT(g);return this._getStats(g,E)},h.prototype.openSync=function(g,v,E){if(v.isWriteable())throw new p(u.EPERM,g);var T=this._getDirectoryRecord(g);if(T){if(T.isSymlink(this._data))return this.openSync(f.resolve(g,T.getSymlinkPath(this._data)),v,E);if(T.isDirectory(this._data))throw p.EISDIR(g);var P=T.getFile(this._data),z=this._getStats(g,T);switch(v.pathExistsAction()){case w.THROW_EXCEPTION:case w.TRUNCATE_FILE:throw p.EEXIST(g);case w.NOP:return new St(this,g,v,z,P);default:throw new p(u.EINVAL,"Invalid FileMode object.")}}else throw p.ENOENT(g)},h.prototype.readdirSync=function(g){var v=this._getDirectoryRecord(g);if(v){if(v.isDirectory(this._data))return v.getDirectory(this._data).getFileList().slice(0);throw p.ENOTDIR(g)}else throw p.ENOENT(g)},h.prototype.readFileSync=function(g,v,E){var T=this.openSync(g,E,420);try{var P=T,z=P.getBuffer();return v===null?Ee(z):z.toString(v)}finally{T.closeSync()}},h.prototype._getDirectoryRecord=function(g){var v=this;if(g==="/")return this._root;for(var E=g.split("/").slice(1),T=this._root,P=0,z=E;P<z.length;P+=1){var G=z[P];if(T.isDirectory(v._data)){if(T=T.getDirectory(v._data).getRecord(G),!T)return null}else return null}return T},h.prototype._getStats=function(g,v){if(v.isSymlink(this._data)){var E=f.resolve(g,v.getSymlinkPath(this._data)),T=this._getDirectoryRecord(E);return T?this._getStats(E,T):null}else{var P=v.dataLength(),z=365,G=v.recordingDate(),ue=G,xe=G,Pe=G;if(v.hasRockRidge())for(var We=v.getSUEntries(this._data),Ke=0,ht=We;Ke<ht.length;Ke+=1){var bt=ht[Ke];if(bt instanceof pD)z=bt.mode();else if(bt instanceof yD){var Pt=bt.flags();Pt&4&&(ue=bt.access()),Pt&2&&(xe=bt.modify()),Pt&1&&(Pe=bt.creation())}}return z=z&365,new O(v.isDirectory(this._data)?S.DIRECTORY:S.FILE,P,z,ue,xe,Pe)}},h}(Xe);Hv.Name="IsoFS",Hv.Options={data:{type:"object",description:"The ISO file in a buffer",validator:we}},[ee,Lv,Fv,qf,jv,Vf,pg,Hv,gg,Hf,vg,zv,qv,Qc].forEach(function(b){var h=b.Create;b.Create=function(y,g){var v=typeof y=="function",E=v?y:g,T=v?{}:y;function P(z){z?E(z):h.call(b,T,E)}W(b,T,P)}});var Wv={AsyncMirror:ee,Dropbox:Lv,Emscripten:Fv,FolderAdapter:qf,HTML5FS:jv,InMemory:Vf,IndexedDB:pg,IsoFS:Hv,LocalStorage:gg,MountableFileSystem:Hf,OverlayFS:vg,WorkerFS:zv,XmlHttpRequest:qv,ZipFS:Qc};l.initializeTTYs&&l.initializeTTYs();function mte(b){b.Buffer=s,b.process=l;var h=b.require?b.require:null;b.require=function(y){var g=mD(y);return g||h.apply(null,Array.prototype.slice.call(arguments,0))}}function bte(b,h){Wv[b]=h}function mD(b){switch(b){case"fs":return Z;case"path":return f;case"buffer":return c;case"process":return l;case"bfs_utils":return J;default:return Wv[b]}}function bD(b){return Z.initialize(b)}function vte(b,h){lk(b,function(y,g){g?(bD(g),h()):h(y)})}function lk(b,h){var y=b.fs;if(!y)return h(new p(u.EPERM,'Missing "fs" property on configuration object.'));var g=b.options,v=0,E=!1;function T(){if(!E){E=!0;var G=Wv[y];G?G.Create(g,h):h(new p(u.EPERM,"File system "+y+" is not available in BrowserFS."))}}if(g!==null&&typeof g=="object"){var P=!1,z=Object.keys(g).filter(function(G){return G!=="fs"});z.forEach(function(G){var ue=g[G];ue!==null&&typeof ue=="object"&&ue.fs&&(v++,lk(ue,function(xe,Pe){if(v--,xe){if(E)return;E=!0,h(xe)}else g[G]=Pe,v===0&&P&&T()}))}),P=!0}v===0&&T()}"ab".substr(-1)!=="b"&&(String.prototype.substr=function(b){return function(h,y){return h<0&&(h=this.length+h),b.call(this,h,y)}}(String.prototype.substr)),typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&(Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(b,h){b===void 0&&(b=0),h===void 0&&(h=this.length);var y=this;return b<0&&(b=this.length+b,b<0&&(b=0)),h<0&&(h=this.length+h,h<0&&(h=0)),h<b&&(h=b),new Uint8Array(y.buffer,y.byteOffset+b,h-b)})),n.install=mte,n.registerFileSystem=bte,n.BFSRequire=mD,n.initialize=bD,n.configure=vte,n.getFileSystem=lk,n.EmscriptenFS=Ne,n.FileSystem=Wv,n.Errors=_,n.setImmediate=rk}).call(n,i(1),function(){return this}(),i(5)(r),i(6))},function(r,n,i){r.exports=i(2).Buffer},function(r,n,i){(function(u){"use strict";var a=i(3),o=i(4);n.Buffer=u,n.SlowBuffer=I,n.INSPECT_MAX_BYTES=50;var l=2147483647;n.kMaxLength=l,u.TYPED_ARRAY_SUPPORT=c(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{var ee=new Uint8Array(1);return ee.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ee.foo()===42}catch{return!1}}function f(ee){if(ee>l)throw new RangeError("Invalid typed array length");var j=new Uint8Array(ee);return j.__proto__=u.prototype,j}function u(ee,j,B){if(typeof ee=="number"){if(typeof j=="string")throw new Error("If encoding is specified then the first argument must be a string");return w(ee)}return d(ee,j,B)}typeof Symbol<"u"&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),u.poolSize=8192;function d(ee,j,B){if(typeof ee=="number")throw new TypeError('"value" argument must not be a number');return kt(ee)?O(ee,j,B):typeof ee=="string"?k(ee,j):A(ee)}u.from=function(ee,j,B){return d(ee,j,B)},u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array;function p(ee){if(typeof ee!="number")throw new TypeError('"size" argument must be a number');if(ee<0)throw new RangeError('"size" argument must not be negative')}function _(ee,j,B){return p(ee),ee<=0?f(ee):j!==void 0?typeof B=="string"?f(ee).fill(j,B):f(ee).fill(j):f(ee)}u.alloc=function(ee,j,B){return _(ee,j,B)};function w(ee){return p(ee),f(ee<0?0:C(ee)|0)}u.allocUnsafe=function(ee){return w(ee)},u.allocUnsafeSlow=function(ee){return w(ee)};function k(ee,j){if((typeof j!="string"||j==="")&&(j="utf8"),!u.isEncoding(j))throw new TypeError('"encoding" must be a valid string encoding');var B=D(ee,j)|0,re=f(B),ke=re.write(ee,j);return ke!==B&&(re=re.slice(0,ke)),re}function S(ee){for(var j=ee.length<0?0:C(ee.length)|0,B=f(j),re=0;re<j;re+=1)B[re]=ee[re]&255;return B}function O(ee,j,B){if(j<0||ee.byteLength<j)throw new RangeError("'offset' is out of bounds");if(ee.byteLength<j+(B||0))throw new RangeError("'length' is out of bounds");var re;return j===void 0&&B===void 0?re=new Uint8Array(ee):B===void 0?re=new Uint8Array(ee,j):re=new Uint8Array(ee,j,B),re.__proto__=u.prototype,re}function A(ee){if(u.isBuffer(ee)){var j=C(ee.length)|0,B=f(j);return B.length===0||ee.copy(B,0,0,j),B}if(ee){if(St(ee)||"length"in ee)return typeof ee.length!="number"||pt(ee.length)?f(0):S(ee);if(ee.type==="Buffer"&&Array.isArray(ee.data))return S(ee.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function C(ee){if(ee>=l)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l.toString(16)+" bytes");return ee|0}function I(ee){return+ee!=ee&&(ee=0),u.alloc(+ee)}u.isBuffer=function(j){return j!=null&&j._isBuffer===!0},u.compare=function(j,B){if(!u.isBuffer(j)||!u.isBuffer(B))throw new TypeError("Arguments must be Buffers");if(j===B)return 0;for(var re=j.length,ke=B.length,Te=0,Me=Math.min(re,ke);Te<Me;++Te)if(j[Te]!==B[Te]){re=j[Te],ke=B[Te];break}return re<ke?-1:ke<re?1:0},u.isEncoding=function(j){switch(String(j).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(j,B){if(!Array.isArray(j))throw new TypeError('"list" argument must be an Array of Buffers');if(j.length===0)return u.alloc(0);var re;if(B===void 0)for(B=0,re=0;re<j.length;++re)B+=j[re].length;var ke=u.allocUnsafe(B),Te=0;for(re=0;re<j.length;++re){var Me=j[re];if(!u.isBuffer(Me))throw new TypeError('"list" argument must be an Array of Buffers');Me.copy(ke,Te),Te+=Me.length}return ke};function D(ee,j){if(u.isBuffer(ee))return ee.length;if(St(ee)||kt(ee))return ee.byteLength;typeof ee!="string"&&(ee=""+ee);var B=ee.length;if(B===0)return 0;for(var re=!1;;)switch(j){case"ascii":case"latin1":case"binary":return B;case"utf8":case"utf-8":case void 0:return Oe(ee).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B*2;case"hex":return B>>>1;case"base64":return Xe(ee).length;default:if(re)return Oe(ee).length;j=(""+j).toLowerCase(),re=!0}}u.byteLength=D;function L(ee,j,B){var re=!1;if((j===void 0||j<0)&&(j=0),j>this.length||((B===void 0||B>this.length)&&(B=this.length),B<=0)||(B>>>=0,j>>>=0,B<=j))return"";for(ee||(ee="utf8");;)switch(ee){case"hex":return oe(this,j,B);case"utf8":case"utf-8":return Q(this,j,B);case"ascii":return q(this,j,B);case"latin1":case"binary":return ie(this,j,B);case"base64":return H(this,j,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,j,B);default:if(re)throw new TypeError("Unknown encoding: "+ee);ee=(ee+"").toLowerCase(),re=!0}}u.prototype._isBuffer=!0;function U(ee,j,B){var re=ee[j];ee[j]=ee[B],ee[B]=re}u.prototype.swap16=function(){var j=this.length;if(j%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var B=0;B<j;B+=2)U(this,B,B+1);return this},u.prototype.swap32=function(){var j=this.length;if(j%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var B=0;B<j;B+=4)U(this,B,B+3),U(this,B+1,B+2);return this},u.prototype.swap64=function(){var j=this.length;if(j%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var B=0;B<j;B+=8)U(this,B,B+7),U(this,B+1,B+6),U(this,B+2,B+5),U(this,B+3,B+4);return this},u.prototype.toString=function(){var j=this.length;return j===0?"":arguments.length===0?Q(this,0,j):L.apply(this,arguments)},u.prototype.equals=function(j){if(!u.isBuffer(j))throw new TypeError("Argument must be a Buffer");return this===j?!0:u.compare(this,j)===0},u.prototype.inspect=function(){var j="",B=n.INSPECT_MAX_BYTES;return this.length>0&&(j=this.toString("hex",0,B).match(/.{2}/g).join(" "),this.length>B&&(j+=" ... ")),"<Buffer "+j+">"},u.prototype.compare=function(j,B,re,ke,Te){if(!u.isBuffer(j))throw new TypeError("Argument must be a Buffer");if(B===void 0&&(B=0),re===void 0&&(re=j?j.length:0),ke===void 0&&(ke=0),Te===void 0&&(Te=this.length),B<0||re>j.length||ke<0||Te>this.length)throw new RangeError("out of range index");if(ke>=Te&&B>=re)return 0;if(ke>=Te)return-1;if(B>=re)return 1;if(B>>>=0,re>>>=0,ke>>>=0,Te>>>=0,this===j)return 0;for(var Me=Te-ke,It=re-B,Dt=Math.min(Me,It),Qt=this.slice(ke,Te),Ir=j.slice(B,re),Jt=0;Jt<Dt;++Jt)if(Qt[Jt]!==Ir[Jt]){Me=Qt[Jt],It=Ir[Jt];break}return Me<It?-1:It<Me?1:0};function te(ee,j,B,re,ke){if(ee.length===0)return-1;if(typeof B=="string"?(re=B,B=0):B>2147483647?B=2147483647:B<-2147483648&&(B=-2147483648),B=+B,pt(B)&&(B=ke?0:ee.length-1),B<0&&(B=ee.length+B),B>=ee.length){if(ke)return-1;B=ee.length-1}else if(B<0)if(ke)B=0;else return-1;if(typeof j=="string"&&(j=u.from(j,re)),u.isBuffer(j))return j.length===0?-1:V(ee,j,B,re,ke);if(typeof j=="number")return j=j&255,typeof Uint8Array.prototype.indexOf=="function"?ke?Uint8Array.prototype.indexOf.call(ee,j,B):Uint8Array.prototype.lastIndexOf.call(ee,j,B):V(ee,[j],B,re,ke);throw new TypeError("val must be string, number or Buffer")}function V(ee,j,B,re,ke){var Te=1,Me=ee.length,It=j.length;if(re!==void 0&&(re=String(re).toLowerCase(),re==="ucs2"||re==="ucs-2"||re==="utf16le"||re==="utf-16le")){if(ee.length<2||j.length<2)return-1;Te=2,Me/=2,It/=2,B/=2}function Dt(yl,ho){return Te===1?yl[ho]:yl.readUInt16BE(ho*Te)}var Qt;if(ke){var Ir=-1;for(Qt=B;Qt<Me;Qt++)if(Dt(ee,Qt)===Dt(j,Ir===-1?0:Qt-Ir)){if(Ir===-1&&(Ir=Qt),Qt-Ir+1===It)return Ir*Te}else Ir!==-1&&(Qt-=Qt-Ir),Ir=-1}else for(B+It>Me&&(B=Me-It),Qt=B;Qt>=0;Qt--){for(var Jt=!0,ji=0;ji<It;ji++)if(Dt(ee,Qt+ji)!==Dt(j,ji)){Jt=!1;break}if(Jt)return Qt}return-1}u.prototype.includes=function(j,B,re){return this.indexOf(j,B,re)!==-1},u.prototype.indexOf=function(j,B,re){return te(this,j,B,re,!0)},u.prototype.lastIndexOf=function(j,B,re){return te(this,j,B,re,!1)};function X(ee,j,B,re){B=Number(B)||0;var ke=ee.length-B;re?(re=Number(re),re>ke&&(re=ke)):re=ke;var Te=j.length;if(Te%2!==0)throw new TypeError("Invalid hex string");re>Te/2&&(re=Te/2);for(var Me=0;Me<re;++Me){var It=parseInt(j.substr(Me*2,2),16);if(pt(It))return Me;ee[B+Me]=It}return Me}function Z(ee,j,B,re){return Ze(Oe(j,ee.length-B),ee,B,re)}function se(ee,j,B,re){return Ze(Ne(j),ee,B,re)}function pe(ee,j,B,re){return se(ee,j,B,re)}function de(ee,j,B,re){return Ze(Xe(j),ee,B,re)}function F(ee,j,B,re){return Ze(Ce(j,ee.length-B),ee,B,re)}u.prototype.write=function(j,B,re,ke){if(B===void 0)ke="utf8",re=this.length,B=0;else if(re===void 0&&typeof B=="string")ke=B,re=this.length,B=0;else if(isFinite(B))B=B>>>0,isFinite(re)?(re=re>>>0,ke===void 0&&(ke="utf8")):(ke=re,re=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Te=this.length-B;if((re===void 0||re>Te)&&(re=Te),j.length>0&&(re<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");ke||(ke="utf8");for(var Me=!1;;)switch(ke){case"hex":return X(this,j,B,re);case"utf8":case"utf-8":return Z(this,j,B,re);case"ascii":return se(this,j,B,re);case"latin1":case"binary":return pe(this,j,B,re);case"base64":return de(this,j,B,re);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,j,B,re);default:if(Me)throw new TypeError("Unknown encoding: "+ke);ke=(""+ke).toLowerCase(),Me=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function H(ee,j,B){return j===0&&B===ee.length?a.fromByteArray(ee):a.fromByteArray(ee.slice(j,B))}function Q(ee,j,B){B=Math.min(ee.length,B);for(var re=[],ke=j;ke<B;){var Te=ee[ke],Me=null,It=Te>239?4:Te>223?3:Te>191?2:1;if(ke+It<=B){var Dt,Qt,Ir,Jt;switch(It){case 1:Te<128&&(Me=Te);break;case 2:Dt=ee[ke+1],(Dt&192)===128&&(Jt=(Te&31)<<6|Dt&63,Jt>127&&(Me=Jt));break;case 3:Dt=ee[ke+1],Qt=ee[ke+2],(Dt&192)===128&&(Qt&192)===128&&(Jt=(Te&15)<<12|(Dt&63)<<6|Qt&63,Jt>2047&&(Jt<55296||Jt>57343)&&(Me=Jt));break;case 4:Dt=ee[ke+1],Qt=ee[ke+2],Ir=ee[ke+3],(Dt&192)===128&&(Qt&192)===128&&(Ir&192)===128&&(Jt=(Te&15)<<18|(Dt&63)<<12|(Qt&63)<<6|Ir&63,Jt>65535&&Jt<1114112&&(Me=Jt))}}Me===null?(Me=65533,It=1):Me>65535&&(Me-=65536,re.push(Me>>>10&1023|55296),Me=56320|Me&1023),re.push(Me),ke+=It}return $(re)}var R=4096;function $(ee){var j=ee.length;if(j<=R)return String.fromCharCode.apply(String,ee);for(var B="",re=0;re<j;)B+=String.fromCharCode.apply(String,ee.slice(re,re+=R));return B}function q(ee,j,B){var re="";B=Math.min(ee.length,B);for(var ke=j;ke<B;++ke)re+=String.fromCharCode(ee[ke]&127);return re}function ie(ee,j,B){var re="";B=Math.min(ee.length,B);for(var ke=j;ke<B;++ke)re+=String.fromCharCode(ee[ke]);return re}function oe(ee,j,B){var re=ee.length;(!j||j<0)&&(j=0),(!B||B<0||B>re)&&(B=re);for(var ke="",Te=j;Te<B;++Te)ke+=ne(ee[Te]);return ke}function fe(ee,j,B){for(var re=ee.slice(j,B),ke="",Te=0;Te<re.length;Te+=2)ke+=String.fromCharCode(re[Te]+re[Te+1]*256);return ke}u.prototype.slice=function(j,B){var re=this.length;j=~~j,B=B===void 0?re:~~B,j<0?(j+=re,j<0&&(j=0)):j>re&&(j=re),B<0?(B+=re,B<0&&(B=0)):B>re&&(B=re),B<j&&(B=j);var ke=this.subarray(j,B);return ke.__proto__=u.prototype,ke};function _e(ee,j,B){if(ee%1!==0||ee<0)throw new RangeError("offset is not uint");if(ee+j>B)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUIntLE=function(j,B,re){j=j>>>0,B=B>>>0,re||_e(j,B,this.length);for(var ke=this[j],Te=1,Me=0;++Me<B&&(Te*=256);)ke+=this[j+Me]*Te;return ke},u.prototype.readUIntBE=function(j,B,re){j=j>>>0,B=B>>>0,re||_e(j,B,this.length);for(var ke=this[j+--B],Te=1;B>0&&(Te*=256);)ke+=this[j+--B]*Te;return ke},u.prototype.readUInt8=function(j,B){return j=j>>>0,B||_e(j,1,this.length),this[j]},u.prototype.readUInt16LE=function(j,B){return j=j>>>0,B||_e(j,2,this.length),this[j]|this[j+1]<<8},u.prototype.readUInt16BE=function(j,B){return j=j>>>0,B||_e(j,2,this.length),this[j]<<8|this[j+1]},u.prototype.readUInt32LE=function(j,B){return j=j>>>0,B||_e(j,4,this.length),(this[j]|this[j+1]<<8|this[j+2]<<16)+this[j+3]*16777216},u.prototype.readUInt32BE=function(j,B){return j=j>>>0,B||_e(j,4,this.length),this[j]*16777216+(this[j+1]<<16|this[j+2]<<8|this[j+3])},u.prototype.readIntLE=function(j,B,re){j=j>>>0,B=B>>>0,re||_e(j,B,this.length);for(var ke=this[j],Te=1,Me=0;++Me<B&&(Te*=256);)ke+=this[j+Me]*Te;return Te*=128,ke>=Te&&(ke-=Math.pow(2,8*B)),ke},u.prototype.readIntBE=function(j,B,re){j=j>>>0,B=B>>>0,re||_e(j,B,this.length);for(var ke=B,Te=1,Me=this[j+--ke];ke>0&&(Te*=256);)Me+=this[j+--ke]*Te;return Te*=128,Me>=Te&&(Me-=Math.pow(2,8*B)),Me},u.prototype.readInt8=function(j,B){return j=j>>>0,B||_e(j,1,this.length),this[j]&128?(255-this[j]+1)*-1:this[j]},u.prototype.readInt16LE=function(j,B){j=j>>>0,B||_e(j,2,this.length);var re=this[j]|this[j+1]<<8;return re&32768?re|4294901760:re},u.prototype.readInt16BE=function(j,B){j=j>>>0,B||_e(j,2,this.length);var re=this[j+1]|this[j]<<8;return re&32768?re|4294901760:re},u.prototype.readInt32LE=function(j,B){return j=j>>>0,B||_e(j,4,this.length),this[j]|this[j+1]<<8|this[j+2]<<16|this[j+3]<<24},u.prototype.readInt32BE=function(j,B){return j=j>>>0,B||_e(j,4,this.length),this[j]<<24|this[j+1]<<16|this[j+2]<<8|this[j+3]},u.prototype.readFloatLE=function(j,B){return j=j>>>0,B||_e(j,4,this.length),o.read(this,j,!0,23,4)},u.prototype.readFloatBE=function(j,B){return j=j>>>0,B||_e(j,4,this.length),o.read(this,j,!1,23,4)},u.prototype.readDoubleLE=function(j,B){return j=j>>>0,B||_e(j,8,this.length),o.read(this,j,!0,52,8)},u.prototype.readDoubleBE=function(j,B){return j=j>>>0,B||_e(j,8,this.length),o.read(this,j,!1,52,8)};function Ee(ee,j,B,re,ke,Te){if(!u.isBuffer(ee))throw new TypeError('"buffer" argument must be a Buffer instance');if(j>ke||j<Te)throw new RangeError('"value" argument is out of bounds');if(B+re>ee.length)throw new RangeError("Index out of range")}u.prototype.writeUIntLE=function(j,B,re,ke){if(j=+j,B=B>>>0,re=re>>>0,!ke){var Te=Math.pow(2,8*re)-1;Ee(this,j,B,re,Te,0)}var Me=1,It=0;for(this[B]=j&255;++It<re&&(Me*=256);)this[B+It]=j/Me&255;return B+re},u.prototype.writeUIntBE=function(j,B,re,ke){if(j=+j,B=B>>>0,re=re>>>0,!ke){var Te=Math.pow(2,8*re)-1;Ee(this,j,B,re,Te,0)}var Me=re-1,It=1;for(this[B+Me]=j&255;--Me>=0&&(It*=256);)this[B+Me]=j/It&255;return B+re},u.prototype.writeUInt8=function(j,B,re){return j=+j,B=B>>>0,re||Ee(this,j,B,1,255,0),this[B]=j&255,B+1},u.prototype.writeUInt16LE=function(j,B,re){return j=+j,B=B>>>0,re||Ee(this,j,B,2,65535,0),this[B]=j&255,this[B+1]=j>>>8,B+2},u.prototype.writeUInt16BE=function(j,B,re){return j=+j,B=B>>>0,re||Ee(this,j,B,2,65535,0),this[B]=j>>>8,this[B+1]=j&255,B+2},u.prototype.writeUInt32LE=function(j,B,re){return j=+j,B=B>>>0,re||Ee(this,j,B,4,4294967295,0),this[B+3]=j>>>24,this[B+2]=j>>>16,this[B+1]=j>>>8,this[B]=j&255,B+4},u.prototype.writeUInt32BE=function(j,B,re){return j=+j,B=B>>>0,re||Ee(this,j,B,4,4294967295,0),this[B]=j>>>24,this[B+1]=j>>>16,this[B+2]=j>>>8,this[B+3]=j&255,B+4},u.prototype.writeIntLE=function(j,B,re,ke){if(j=+j,B=B>>>0,!ke){var Te=Math.pow(2,8*re-1);Ee(this,j,B,re,Te-1,-Te)}var Me=0,It=1,Dt=0;for(this[B]=j&255;++Me<re&&(It*=256);)j<0&&Dt===0&&this[B+Me-1]!==0&&(Dt=1),this[B+Me]=(j/It>>0)-Dt&255;return B+re},u.prototype.writeIntBE=function(j,B,re,ke){if(j=+j,B=B>>>0,!ke){var Te=Math.pow(2,8*re-1);Ee(this,j,B,re,Te-1,-Te)}var Me=re-1,It=1,Dt=0;for(this[B+Me]=j&255;--Me>=0&&(It*=256);)j<0&&Dt===0&&this[B+Me+1]!==0&&(Dt=1),this[B+Me]=(j/It>>0)-Dt&255;return B+re},u.prototype.writeInt8=function(j,B,re){return j=+j,B=B>>>0,re||Ee(this,j,B,1,127,-128),j<0&&(j=255+j+1),this[B]=j&255,B+1},u.prototype.writeInt16LE=function(j,B,re){return j=+j,B=B>>>0,re||Ee(this,j,B,2,32767,-32768),this[B]=j&255,this[B+1]=j>>>8,B+2},u.prototype.writeInt16BE=function(j,B,re){return j=+j,B=B>>>0,re||Ee(this,j,B,2,32767,-32768),this[B]=j>>>8,this[B+1]=j&255,B+2},u.prototype.writeInt32LE=function(j,B,re){return j=+j,B=B>>>0,re||Ee(this,j,B,4,2147483647,-2147483648),this[B]=j&255,this[B+1]=j>>>8,this[B+2]=j>>>16,this[B+3]=j>>>24,B+4},u.prototype.writeInt32BE=function(j,B,re){return j=+j,B=B>>>0,re||Ee(this,j,B,4,2147483647,-2147483648),j<0&&(j=4294967295+j+1),this[B]=j>>>24,this[B+1]=j>>>16,this[B+2]=j>>>8,this[B+3]=j&255,B+4};function Se(ee,j,B,re,ke,Te){if(B+re>ee.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("Index out of range")}function le(ee,j,B,re,ke){return j=+j,B=B>>>0,ke||Se(ee,j,B,4,34028234663852886e22,-34028234663852886e22),o.write(ee,j,B,re,23,4),B+4}u.prototype.writeFloatLE=function(j,B,re){return le(this,j,B,!0,re)},u.prototype.writeFloatBE=function(j,B,re){return le(this,j,B,!1,re)};function we(ee,j,B,re,ke){return j=+j,B=B>>>0,ke||Se(ee,j,B,8,17976931348623157e292,-17976931348623157e292),o.write(ee,j,B,re,52,8),B+8}u.prototype.writeDoubleLE=function(j,B,re){return we(this,j,B,!0,re)},u.prototype.writeDoubleBE=function(j,B,re){return we(this,j,B,!1,re)},u.prototype.copy=function(j,B,re,ke){if(re||(re=0),!ke&&ke!==0&&(ke=this.length),B>=j.length&&(B=j.length),B||(B=0),ke>0&&ke<re&&(ke=re),ke===re||j.length===0||this.length===0)return 0;if(B<0)throw new RangeError("targetStart out of bounds");if(re<0||re>=this.length)throw new RangeError("sourceStart out of bounds");if(ke<0)throw new RangeError("sourceEnd out of bounds");ke>this.length&&(ke=this.length),j.length-B<ke-re&&(ke=j.length-B+re);var Te=ke-re,Me;if(this===j&&re<B&&B<ke)for(Me=Te-1;Me>=0;--Me)j[Me+B]=this[Me+re];else if(Te<1e3)for(Me=0;Me<Te;++Me)j[Me+B]=this[Me+re];else Uint8Array.prototype.set.call(j,this.subarray(re,re+Te),B);return Te},u.prototype.fill=function(j,B,re,ke){if(typeof j=="string"){if(typeof B=="string"?(ke=B,B=0,re=this.length):typeof re=="string"&&(ke=re,re=this.length),j.length===1){var Te=j.charCodeAt(0);Te<256&&(j=Te)}if(ke!==void 0&&typeof ke!="string")throw new TypeError("encoding must be a string");if(typeof ke=="string"&&!u.isEncoding(ke))throw new TypeError("Unknown encoding: "+ke)}else typeof j=="number"&&(j=j&255);if(B<0||this.length<B||this.length<re)throw new RangeError("Out of range index");if(re<=B)return this;B=B>>>0,re=re===void 0?this.length:re>>>0,j||(j=0);var Me;if(typeof j=="number")for(Me=B;Me<re;++Me)this[Me]=j;else{var It=u.isBuffer(j)?j:new u(j,ke),Dt=It.length;for(Me=0;Me<re-B;++Me)this[Me+B]=It[Me%Dt]}return this};var W=/[^+/0-9A-Za-z-_]/g;function J(ee){if(ee=ee.trim().replace(W,""),ee.length<2)return"";for(;ee.length%4!==0;)ee=ee+"=";return ee}function ne(ee){return ee<16?"0"+ee.toString(16):ee.toString(16)}function Oe(ee,j){j=j||1/0;for(var B,re=ee.length,ke=null,Te=[],Me=0;Me<re;++Me){if(B=ee.charCodeAt(Me),B>55295&&B<57344){if(!ke){if(B>56319){(j-=3)>-1&&Te.push(239,191,189);continue}else if(Me+1===re){(j-=3)>-1&&Te.push(239,191,189);continue}ke=B;continue}if(B<56320){(j-=3)>-1&&Te.push(239,191,189),ke=B;continue}B=(ke-55296<<10|B-56320)+65536}else ke&&(j-=3)>-1&&Te.push(239,191,189);if(ke=null,B<128){if((j-=1)<0)break;Te.push(B)}else if(B<2048){if((j-=2)<0)break;Te.push(B>>6|192,B&63|128)}else if(B<65536){if((j-=3)<0)break;Te.push(B>>12|224,B>>6&63|128,B&63|128)}else if(B<1114112){if((j-=4)<0)break;Te.push(B>>18|240,B>>12&63|128,B>>6&63|128,B&63|128)}else throw new Error("Invalid code point")}return Te}function Ne(ee){for(var j=[],B=0;B<ee.length;++B)j.push(ee.charCodeAt(B)&255);return j}function Ce(ee,j){for(var B,re,ke,Te=[],Me=0;Me<ee.length&&!((j-=2)<0);++Me)B=ee.charCodeAt(Me),re=B>>8,ke=B%256,Te.push(ke),Te.push(re);return Te}function Xe(ee){return a.toByteArray(J(ee))}function Ze(ee,j,B,re){for(var ke=0;ke<re&&!(ke+B>=j.length||ke>=ee.length);++ke)j[ke+B]=ee[ke];return ke}function kt(ee){return ee instanceof ArrayBuffer||ee!=null&&ee.constructor!=null&&ee.constructor.name==="ArrayBuffer"&&typeof ee.byteLength=="number"}function St(ee){return typeof ArrayBuffer.isView=="function"&&ArrayBuffer.isView(ee)}function pt(ee){return ee!==ee}}).call(n,i(1))},function(r,n){"use strict";n.byteLength=u,n.toByteArray=d,n.fromByteArray=w;for(var i=[],s=[],a=typeof Uint8Array<"u"?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,c=o.length;l<c;++l)i[l]=o[l],s[o.charCodeAt(l)]=l;s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63;function f(k){var S=k.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return k[S-2]==="="?2:k[S-1]==="="?1:0}function u(k){return k.length*3/4-f(k)}function d(k){var S,O,A,C,I,D,L=k.length;I=f(k),D=new a(L*3/4-I),A=I>0?L-4:L;var U=0;for(S=0,O=0;S<A;S+=4,O+=3)C=s[k.charCodeAt(S)]<<18|s[k.charCodeAt(S+1)]<<12|s[k.charCodeAt(S+2)]<<6|s[k.charCodeAt(S+3)],D[U++]=C>>16&255,D[U++]=C>>8&255,D[U++]=C&255;return I===2?(C=s[k.charCodeAt(S)]<<2|s[k.charCodeAt(S+1)]>>4,D[U++]=C&255):I===1&&(C=s[k.charCodeAt(S)]<<10|s[k.charCodeAt(S+1)]<<4|s[k.charCodeAt(S+2)]>>2,D[U++]=C>>8&255,D[U++]=C&255),D}function p(k){return i[k>>18&63]+i[k>>12&63]+i[k>>6&63]+i[k&63]}function _(k,S,O){for(var A,C=[],I=S;I<O;I+=3)A=(k[I]<<16)+(k[I+1]<<8)+k[I+2],C.push(p(A));return C.join("")}function w(k){for(var S,O=k.length,A=O%3,C="",I=[],D=16383,L=0,U=O-A;L<U;L+=D)I.push(_(k,L,L+D>U?U:L+D));return A===1?(S=k[O-1],C+=i[S>>2],C+=i[S<<4&63],C+="=="):A===2&&(S=(k[O-2]<<8)+k[O-1],C+=i[S>>10],C+=i[S>>4&63],C+=i[S<<2&63],C+="="),I.push(C),I.join("")}},function(r,n){n.read=function(i,s,a,o,l){var c,f,u=l*8-o-1,d=(1<<u)-1,p=d>>1,_=-7,w=a?l-1:0,k=a?-1:1,S=i[s+w];for(w+=k,c=S&(1<<-_)-1,S>>=-_,_+=u;_>0;c=c*256+i[s+w],w+=k,_-=8);for(f=c&(1<<-_)-1,c>>=-_,_+=o;_>0;f=f*256+i[s+w],w+=k,_-=8);if(c===0)c=1-p;else{if(c===d)return f?NaN:(S?-1:1)*(1/0);f=f+Math.pow(2,o),c=c-p}return(S?-1:1)*f*Math.pow(2,c-o)},n.write=function(i,s,a,o,l,c){var f,u,d,p=c*8-l-1,_=(1<<p)-1,w=_>>1,k=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=o?0:c-1,O=o?1:-1,A=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(u=isNaN(s)?1:0,f=_):(f=Math.floor(Math.log(s)/Math.LN2),s*(d=Math.pow(2,-f))<1&&(f--,d*=2),f+w>=1?s+=k/d:s+=k*Math.pow(2,1-w),s*d>=2&&(f++,d/=2),f+w>=_?(u=0,f=_):f+w>=1?(u=(s*d-1)*Math.pow(2,l),f=f+w):(u=s*Math.pow(2,w-1)*Math.pow(2,l),f=0));l>=8;i[a+S]=u&255,S+=O,u/=256,l-=8);for(f=f<<l|u,p+=l;p>0;i[a+S]=f&255,S+=O,f/=256,p-=8);i[a+S-O]|=A*128}},function(r,n){r.exports=function(i){return i.webpackPolyfill||(i.deprecate=function(){},i.paths=[],i.children=[],i.webpackPolyfill=1),i}},function(r,n,i){"use strict";var s=i(7),a=new s,o={};function l(f){o[f]||(typeof a[f]=="function"?o[f]=function(){return a[f].apply(a,arguments)}:o[f]=a[f])}for(var c in a)l(c);o.initializeTTYs=function(){a.stdin===null&&(a.initializeTTYs(),o.stdin=a.stdin,o.stdout=a.stdout,o.stderr=a.stderr)},a.nextTick(function(){o.initializeTTYs()}),r.exports=o},function(r,n,i){(function(s){"use strict";var a=this&&this.__extends||function(d,p){for(var _ in p)p.hasOwnProperty(_)&&(d[_]=p[_]);function w(){this.constructor=d}d.prototype=p===null?Object.create(p):(w.prototype=p.prototype,new w)},o=i(8),l=null,c=function(){function d(p,_){this.fun=p,this.array=_}return d.prototype.run=function(){this.fun.apply(null,this.array)},d}(),f=function(){function d(){this._queue=[],this._draining=!1,this._currentQueue=null,this._queueIndex=-1}return d.prototype.push=function(p){var _=this;this._queue.push(p)===1&&!this._draining&&setTimeout(function(){return _._drainQueue()},0)},d.prototype._cleanUpNextTick=function(){this._draining=!1,this._currentQueue&&this._currentQueue.length?this._queue=this._currentQueue.concat(this._queue):this._queueIndex=-1,this._queue.length&&this._drainQueue()},d.prototype._drainQueue=function(){var p=this;if(!this._draining){var _=setTimeout(function(){return p._cleanUpNextTick()});this._draining=!0;for(var w=this._queue.length;w;){for(this._currentQueue=this._queue,this._queue=[];++this._queueIndex<w;)this._currentQueue&&this._currentQueue[this._queueIndex].run();this._queueIndex=-1,w=this._queue.length}this._currentQueue=null,this._draining=!1,clearTimeout(_)}},d}(),u=function(d){a(p,d);function p(){d.apply(this,arguments),this.startTime=Date.now(),this._cwd="/",this.platform="browser",this.argv=[],this.execArgv=[],this.stdout=null,this.stderr=null,this.stdin=null,this.domain=null,this._queue=new f,this.execPath=s,this.env={},this.exitCode=0,this._gid=1,this._uid=1,this.version="v5.0",this.versions={http_parser:"0.0",node:"5.0",v8:"0.0",uv:"0.0",zlib:"0.0",ares:"0.0",icu:"0.0",modules:"0",openssl:"0.0"},this.config={target_defaults:{cflags:[],default_configuration:"Release",defines:[],include_dirs:[],libraries:[]},variables:{clang:0,host_arch:"x32",node_install_npm:!1,node_install_waf:!1,node_prefix:"",node_shared_cares:!1,node_shared_http_parser:!1,node_shared_libuv:!1,node_shared_zlib:!1,node_shared_v8:!1,node_use_dtrace:!1,node_use_etw:!1,node_use_openssl:!1,node_shared_openssl:!1,strict_aliasing:!1,target_arch:"x32",v8_use_snapshot:!1,v8_no_strict_aliasing:0,visibility:""}},this.pid=Math.random()*1e3|0,this.title="node",this.arch="x32",this._mask=18,this.connected=void 0}return p.prototype.chdir=function(_){l===null&&(l=i(9)),this._cwd=l.resolve(_)},p.prototype.cwd=function(){return this._cwd},p.prototype.uptime=function(){return(Date.now()-this.startTime)/1e3|0},p.prototype.nextTick=function(_){for(var w=[],k=1;k<arguments.length;k++)w[k-1]=arguments[k];this._queue.push(new c(_,w))},p.prototype.abort=function(){this.emit("abort")},p.prototype.exit=function(_){this.exitCode=_,this.emit("exit",[_])},p.prototype.getgid=function(){return this._gid},p.prototype.setgid=function(_){typeof _=="number"?this._gid=_:this._gid=1},p.prototype.getuid=function(){return this._uid},p.prototype.setuid=function(_){typeof _=="number"?this._uid=_:this._uid=1},p.prototype.kill=function(_,w){this.emit("kill",[_,w])},p.prototype.memoryUsage=function(){return{rss:0,heapTotal:0,heapUsed:0}},p.prototype.umask=function(_){_===void 0&&(_=this._mask);var w=this._mask;return this._mask=_,this.emit("umask",[_]),w},p.prototype.hrtime=function(){var _;typeof performance<"u"?_=performance.now():Date.now?_=Date.now():_=new Date().getTime();var w=_/1e3|0;return _-=w*1e3,_=_*1e6|0,[w,_]},p.prototype.initializeTTYs=function(){if(this.stdout===null){var _=i(10);this.stdout=new _,this.stderr=new _,this.stdin=new _}},p.prototype.disconnect=function(){},p}(o.EventEmitter);r.exports=u}).call(n,"/")},function(r,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}r.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(c){if(!a(c)||c<0||isNaN(c))throw TypeError("n must be a positive number");return this._maxListeners=c,this},i.prototype.emit=function(c){var f,u,d,p,_,w;if(this._events||(this._events={}),c==="error"&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(f=arguments[1],f instanceof Error)throw f;var k=new Error('Uncaught, unspecified "error" event. ('+f+")");throw k.context=f,k}if(u=this._events[c],l(u))return!1;if(s(u))switch(arguments.length){case 1:u.call(this);break;case 2:u.call(this,arguments[1]);break;case 3:u.call(this,arguments[1],arguments[2]);break;default:p=Array.prototype.slice.call(arguments,1),u.apply(this,p)}else if(o(u))for(p=Array.prototype.slice.call(arguments,1),w=u.slice(),d=w.length,_=0;_<d;_++)w[_].apply(this,p);return!0},i.prototype.addListener=function(c,f){var u;if(!s(f))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",c,s(f.listener)?f.listener:f),this._events[c]?o(this._events[c])?this._events[c].push(f):this._events[c]=[this._events[c],f]:this._events[c]=f,o(this._events[c])&&!this._events[c].warned&&(l(this._maxListeners)?u=i.defaultMaxListeners:u=this._maxListeners,u&&u>0&&this._events[c].length>u&&(this._events[c].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[c].length),typeof console.trace=="function"&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(c,f){if(!s(f))throw TypeError("listener must be a function");var u=!1;function d(){this.removeListener(c,d),u||(u=!0,f.apply(this,arguments))}return d.listener=f,this.on(c,d),this},i.prototype.removeListener=function(c,f){var u,d,p,_;if(!s(f))throw TypeError("listener must be a function");if(!this._events||!this._events[c])return this;if(u=this._events[c],p=u.length,d=-1,u===f||s(u.listener)&&u.listener===f)delete this._events[c],this._events.removeListener&&this.emit("removeListener",c,f);else if(o(u)){for(_=p;_-- >0;)if(u[_]===f||u[_].listener&&u[_].listener===f){d=_;break}if(d<0)return this;u.length===1?(u.length=0,delete this._events[c]):u.splice(d,1),this._events.removeListener&&this.emit("removeListener",c,f)}return this},i.prototype.removeAllListeners=function(c){var f,u;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[c]&&delete this._events[c],this;if(arguments.length===0){for(f in this._events)f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events={},this}if(u=this._events[c],s(u))this.removeListener(c,u);else if(u)for(;u.length;)this.removeListener(c,u[u.length-1]);return delete this._events[c],this},i.prototype.listeners=function(c){var f;return!this._events||!this._events[c]?f=[]:s(this._events[c])?f=[this._events[c]]:f=this._events[c].slice(),f},i.prototype.listenerCount=function(c){if(this._events){var f=this._events[c];if(s(f))return 1;if(f)return f.length}return 0},i.listenerCount=function(c,f){return c.listenerCount(f)};function s(c){return typeof c=="function"}function a(c){return typeof c=="number"}function o(c){return typeof c=="object"&&c!==null}function l(c){return c===void 0}},function(r,n,i){(function(s){"use strict";var a=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function o(f){var u=a.exec(f);return u.shift(),u}var l=function(){function f(){}return f.normalize=function(u){u===""&&(u=".");var d=u.charAt(0)===f.sep;u=f._removeDuplicateSeps(u);for(var p=u.split(f.sep),_=[],w=0;w<p.length;w++){var k=p[w];k!=="."&&(k===".."&&(d||!d&&_.length>0&&_[0]!=="..")?_.pop():_.push(k))}if(!d&&_.length<2)switch(_.length){case 1:_[0]===""&&_.unshift(".");break;default:_.push(".")}return u=_.join(f.sep),d&&u.charAt(0)!==f.sep&&(u=f.sep+u),u},f.join=function(){for(var u=[],d=0;d<arguments.length;d++)u[d-0]=arguments[d];for(var p=[],_=0;_<u.length;_++){var w=u[_];if(typeof w!="string")throw new TypeError("Invalid argument type to path.join: "+typeof w);w!==""&&p.push(w)}return f.normalize(p.join(f.sep))},f.resolve=function(){for(var u=[],d=0;d<arguments.length;d++)u[d-0]=arguments[d];for(var p=[],_=0;_<u.length;_++){var w=u[_];if(typeof w!="string")throw new TypeError("Invalid argument type to path.join: "+typeof w);w!==""&&(w.charAt(0)===f.sep&&(p=[]),p.push(w))}var k=f.normalize(p.join(f.sep));if(k.length>1&&k.charAt(k.length-1)===f.sep)return k.substr(0,k.length-1);if(k.charAt(0)!==f.sep){k.charAt(0)==="."&&(k.length===1||k.charAt(1)===f.sep)&&(k=k.length===1?"":k.substr(2));var S=s.cwd();k!==""?k=this.normalize(S+(S!=="/"?f.sep:"")+k):k=S}return k},f.relative=function(u,d){var p;u=f.resolve(u),d=f.resolve(d);var _=u.split(f.sep),w=d.split(f.sep);w.shift(),_.shift();var k=0,S=[];for(p=0;p<_.length;p++){var O=_[p];if(O!==w[p]){k=_.length-p;break}}S=w.slice(p),_.length===1&&_[0]===""&&(k=0),k>_.length&&(k=_.length);var A="";for(p=0;p<k;p++)A+="../";return A+=S.join(f.sep),A.length>1&&A.charAt(A.length-1)===f.sep&&(A=A.substr(0,A.length-1)),A},f.dirname=function(u){u=f._removeDuplicateSeps(u);var d=u.charAt(0)===f.sep,p=u.split(f.sep);return p.pop()===""&&p.length>0&&p.pop(),p.length>1||p.length===1&&!d?p.join(f.sep):d?f.sep:"."},f.basename=function(u,d){if(d===void 0&&(d=""),u==="")return u;u=f.normalize(u);var p=u.split(f.sep),_=p[p.length-1];if(_===""&&p.length>1)return p[p.length-2];if(d.length>0){var w=_.substr(_.length-d.length);if(w===d)return _.substr(0,_.length-d.length)}return _},f.extname=function(u){u=f.normalize(u);var d=u.split(f.sep);if(u=d.pop(),u===""&&d.length>0&&(u=d.pop()),u==="..")return"";var p=u.lastIndexOf(".");return p===-1||p===0?"":u.substr(p)},f.isAbsolute=function(u){return u.length>0&&u.charAt(0)===f.sep},f._makeLong=function(u){return u},f.parse=function(u){var d=o(u);return{root:d[0],dir:d[0]+d[1].slice(0,-1),base:d[2],ext:d[3],name:d[2].slice(0,d[2].length-d[3].length)}},f.format=function(u){if(u===null||typeof u!="object")throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof u);var d=u.root||"";if(typeof d!="string")throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof u.root);var p=u.dir?u.dir+f.sep:"",_=u.base||"";return p+_},f._removeDuplicateSeps=function(u){return u=u.replace(this._replaceRegex,this.sep),u},f.sep="/",f._replaceRegex=new RegExp("//+","g"),f.delimiter=":",f.posix=f,f.win32=f,f}(),c=l;r.exports=l}).call(n,i(6))},function(r,n,i){(function(s){"use strict";var a=this&&this.__extends||function(c,f){for(var u in f)f.hasOwnProperty(u)&&(c[u]=f[u]);function d(){this.constructor=c}c.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},o=i(11),l=function(c){a(f,c);function f(){c.call(this),this.isRaw=!1,this.columns=80,this.rows=120,this.isTTY=!0,this._bufferedWrites=[],this._waitingForWrites=!1}return f.prototype.setRawMode=function(u){this.isRaw!==u&&(this.isRaw=u,this.emit("modeChange"))},f.prototype.changeColumns=function(u){u!==this.columns&&(this.columns=u,this.emit("resize"))},f.prototype.changeRows=function(u){u!==this.rows&&(this.rows=u,this.emit("resize"))},f.isatty=function(u){return u&&u instanceof f},f.prototype._write=function(u,d,p){var _;try{var w;typeof u=="string"?w=new s(u,d):w=u,this._bufferedWrites.push(w),this._waitingForWrites&&this._read(1024)}catch(k){_=k}finally{p(_)}},f.prototype._read=function(u){if(this._bufferedWrites.length===0)this._waitingForWrites=!0;else for(;this._bufferedWrites.length>0&&(this._waitingForWrites=this.push(this._bufferedWrites.shift()),!!this._waitingForWrites););},f}(o.Duplex);r.exports=l}).call(n,i(1))},function(r,n,i){r.exports=o;var s=i(8).EventEmitter,a=i(12);a(o,s),o.Readable=i(13),o.Writable=i(27),o.Duplex=i(28),o.Transform=i(29),o.PassThrough=i(30),o.Stream=o;function o(){s.call(this)}o.prototype.pipe=function(l,c){var f=this;function u(O){l.writable&&l.write(O)===!1&&f.pause&&f.pause()}f.on("data",u);function d(){f.readable&&f.resume&&f.resume()}l.on("drain",d),!l._isStdio&&(!c||c.end!==!1)&&(f.on("end",_),f.on("close",w));var p=!1;function _(){p||(p=!0,l.end())}function w(){p||(p=!0,typeof l.destroy=="function"&&l.destroy())}function k(O){if(S(),s.listenerCount(this,"error")===0)throw O}f.on("error",k),l.on("error",k);function S(){f.removeListener("data",u),l.removeListener("drain",d),f.removeListener("end",_),f.removeListener("close",w),f.removeListener("error",k),l.removeListener("error",k),f.removeListener("end",S),f.removeListener("close",S),l.removeListener("close",S)}return f.on("end",S),f.on("close",S),l.on("close",S),l.emit("pipe",f),l}},function(r,n){typeof Object.create=="function"?r.exports=function(s,a){s.super_=a,s.prototype=Object.create(a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}})}:r.exports=function(s,a){s.super_=a;var o=function(){};o.prototype=a.prototype,s.prototype=new o,s.prototype.constructor=s}},function(r,n,i){(function(s){var a=function(){try{return i(11)}catch{}}();n=r.exports=i(14),n.Stream=a||n,n.Readable=n,n.Writable=i(22),n.Duplex=i(21),n.Transform=i(25),n.PassThrough=i(26),!s.browser&&s.env.READABLE_STREAM==="disable"&&a&&(r.exports=a)}).call(n,i(6))},function(r,n,i){(function(s){"use strict";r.exports=I;var a=i(15),o=i(16),l;I.ReadableState=C;var c=i(8).EventEmitter,f=function(W,J){return W.listeners(J).length},u;(function(){try{u=i(11)}catch{}finally{u||(u=i(8).EventEmitter)}})();var d=i(2).Buffer,p=i(17),_=i(18);_.inherits=i(12);var w=i(19),k=void 0;w&&w.debuglog?k=w.debuglog("stream"):k=function(){};var S=i(20),O;_.inherits(I,u);function A(W,J,ne){if(typeof W.prependListener=="function")return W.prependListener(J,ne);!W._events||!W._events[J]?W.on(J,ne):o(W._events[J])?W._events[J].unshift(ne):W._events[J]=[ne,W._events[J]]}function C(W,J){l=l||i(21),W=W||{},this.objectMode=!!W.objectMode,J instanceof l&&(this.objectMode=this.objectMode||!!W.readableObjectMode);var ne=W.highWaterMark,Oe=this.objectMode?16:16*1024;this.highWaterMark=ne||ne===0?ne:Oe,this.highWaterMark=~~this.highWaterMark,this.buffer=new S,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=W.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,W.encoding&&(O||(O=i(24).StringDecoder),this.decoder=new O(W.encoding),this.encoding=W.encoding)}function I(W){if(l=l||i(21),!(this instanceof I))return new I(W);this._readableState=new C(W,this),this.readable=!0,W&&typeof W.read=="function"&&(this._read=W.read),u.call(this)}I.prototype.push=function(W,J){var ne=this._readableState;return!ne.objectMode&&typeof W=="string"&&(J=J||ne.defaultEncoding,J!==ne.encoding&&(W=p.from(W,J),J="")),D(this,ne,W,J,!1)},I.prototype.unshift=function(W){var J=this._readableState;return D(this,J,W,"",!0)},I.prototype.isPaused=function(){return this._readableState.flowing===!1};function D(W,J,ne,Oe,Ne){var Ce=X(J,ne);if(Ce)W.emit("error",Ce);else if(ne===null)J.reading=!1,Z(W,J);else if(J.objectMode||ne&&ne.length>0)if(J.ended&&!Ne){var Xe=new Error("stream.push() after EOF");W.emit("error",Xe)}else if(J.endEmitted&&Ne){var Ze=new Error("stream.unshift() after end event");W.emit("error",Ze)}else{var kt;J.decoder&&!Ne&&!Oe&&(ne=J.decoder.write(ne),kt=!J.objectMode&&ne.length===0),Ne||(J.reading=!1),kt||(J.flowing&&J.length===0&&!J.sync?(W.emit("data",ne),W.read(0)):(J.length+=J.objectMode?1:ne.length,Ne?J.buffer.unshift(ne):J.buffer.push(ne),J.needReadable&&se(W))),de(W,J)}else Ne||(J.reading=!1);return L(J)}function L(W){return!W.ended&&(W.needReadable||W.length<W.highWaterMark||W.length===0)}I.prototype.setEncoding=function(W){return O||(O=i(24).StringDecoder),this._readableState.decoder=new O(W),this._readableState.encoding=W,this};var U=8388608;function te(W){return W>=U?W=U:(W--,W|=W>>>1,W|=W>>>2,W|=W>>>4,W|=W>>>8,W|=W>>>16,W++),W}function V(W,J){return W<=0||J.length===0&&J.ended?0:J.objectMode?1:W!==W?J.flowing&&J.length?J.buffer.head.data.length:J.length:(W>J.highWaterMark&&(J.highWaterMark=te(W)),W<=J.length?W:J.ended?J.length:(J.needReadable=!0,0))}I.prototype.read=function(W){k("read",W),W=parseInt(W,10);var J=this._readableState,ne=W;if(W!==0&&(J.emittedReadable=!1),W===0&&J.needReadable&&(J.length>=J.highWaterMark||J.ended))return k("read: emitReadable",J.length,J.ended),J.length===0&&J.ended?Ee(this):se(this),null;if(W=V(W,J),W===0&&J.ended)return J.length===0&&Ee(this),null;var Oe=J.needReadable;k("need readable",Oe),(J.length===0||J.length-W<J.highWaterMark)&&(Oe=!0,k("length less than watermark",Oe)),J.ended||J.reading?(Oe=!1,k("reading or ended",Oe)):Oe&&(k("do read"),J.reading=!0,J.sync=!0,J.length===0&&(J.needReadable=!0),this._read(J.highWaterMark),J.sync=!1,J.reading||(W=V(ne,J)));var Ne;return W>0?Ne=ie(W,J):Ne=null,Ne===null?(J.needReadable=!0,W=0):J.length-=W,J.length===0&&(J.ended||(J.needReadable=!0),ne!==W&&J.ended&&Ee(this)),Ne!==null&&this.emit("data",Ne),Ne};function X(W,J){var ne=null;return!d.isBuffer(J)&&typeof J!="string"&&J!==null&&J!==void 0&&!W.objectMode&&(ne=new TypeError("Invalid non-string/buffer chunk")),ne}function Z(W,J){if(!J.ended){if(J.decoder){var ne=J.decoder.end();ne&&ne.length&&(J.buffer.push(ne),J.length+=J.objectMode?1:ne.length)}J.ended=!0,se(W)}}function se(W){var J=W._readableState;J.needReadable=!1,J.emittedReadable||(k("emitReadable",J.flowing),J.emittedReadable=!0,J.sync?a(pe,W):pe(W))}function pe(W){k("emit readable"),W.emit("readable"),q(W)}function de(W,J){J.readingMore||(J.readingMore=!0,a(F,W,J))}function F(W,J){for(var ne=J.length;!J.reading&&!J.flowing&&!J.ended&&J.length<J.highWaterMark&&(k("maybeReadMore read 0"),W.read(0),ne!==J.length);)ne=J.length;J.readingMore=!1}I.prototype._read=function(W){this.emit("error",new Error("_read() is not implemented"))},I.prototype.pipe=function(W,J){var ne=this,Oe=this._readableState;switch(Oe.pipesCount){case 0:Oe.pipes=W;break;case 1:Oe.pipes=[Oe.pipes,W];break;default:Oe.pipes.push(W);break}Oe.pipesCount+=1,k("pipe count=%d opts=%j",Oe.pipesCount,J);var Ne=(!J||J.end!==!1)&&W!==s.stdout&&W!==s.stderr,Ce=Ne?Ze:pt;Oe.endEmitted?a(Ce):ne.once("end",Ce),W.on("unpipe",Xe);function Xe(Me){k("onunpipe"),Me===ne&&pt()}function Ze(){k("onend"),W.end()}var kt=H(ne);W.on("drain",kt);var St=!1;function pt(){k("cleanup"),W.removeListener("close",re),W.removeListener("finish",ke),W.removeListener("drain",kt),W.removeListener("error",B),W.removeListener("unpipe",Xe),ne.removeListener("end",Ze),ne.removeListener("end",pt),ne.removeListener("data",j),St=!0,Oe.awaitDrain&&(!W._writableState||W._writableState.needDrain)&&kt()}var ee=!1;ne.on("data",j);function j(Me){k("ondata"),ee=!1;var It=W.write(Me);It===!1&&!ee&&((Oe.pipesCount===1&&Oe.pipes===W||Oe.pipesCount>1&&we(Oe.pipes,W)!==-1)&&!St&&(k("false write response, pause",ne._readableState.awaitDrain),ne._readableState.awaitDrain++,ee=!0),ne.pause())}function B(Me){k("onerror",Me),Te(),W.removeListener("error",B),f(W,"error")===0&&W.emit("error",Me)}A(W,"error",B);function re(){W.removeListener("finish",ke),Te()}W.once("close",re);function ke(){k("onfinish"),W.removeListener("close",re),Te()}W.once("finish",ke);function Te(){k("unpipe"),ne.unpipe(W)}return W.emit("pipe",ne),Oe.flowing||(k("pipe resume"),ne.resume()),W};function H(W){return function(){var J=W._readableState;k("pipeOnDrain",J.awaitDrain),J.awaitDrain&&J.awaitDrain--,J.awaitDrain===0&&f(W,"data")&&(J.flowing=!0,q(W))}}I.prototype.unpipe=function(W){var J=this._readableState;if(J.pipesCount===0)return this;if(J.pipesCount===1)return W&&W!==J.pipes?this:(W||(W=J.pipes),J.pipes=null,J.pipesCount=0,J.flowing=!1,W&&W.emit("unpipe",this),this);if(!W){var ne=J.pipes,Oe=J.pipesCount;J.pipes=null,J.pipesCount=0,J.flowing=!1;for(var Ne=0;Ne<Oe;Ne++)ne[Ne].emit("unpipe",this);return this}var Ce=we(J.pipes,W);return Ce===-1?this:(J.pipes.splice(Ce,1),J.pipesCount-=1,J.pipesCount===1&&(J.pipes=J.pipes[0]),W.emit("unpipe",this),this)},I.prototype.on=function(W,J){var ne=u.prototype.on.call(this,W,J);if(W==="data")this._readableState.flowing!==!1&&this.resume();else if(W==="readable"){var Oe=this._readableState;!Oe.endEmitted&&!Oe.readableListening&&(Oe.readableListening=Oe.needReadable=!0,Oe.emittedReadable=!1,Oe.reading?Oe.length&&se(this,Oe):a(Q,this))}return ne},I.prototype.addListener=I.prototype.on;function Q(W){k("readable nexttick read 0"),W.read(0)}I.prototype.resume=function(){var W=this._readableState;return W.flowing||(k("resume"),W.flowing=!0,R(this,W)),this};function R(W,J){J.resumeScheduled||(J.resumeScheduled=!0,a($,W,J))}function $(W,J){J.reading||(k("resume read 0"),W.read(0)),J.resumeScheduled=!1,J.awaitDrain=0,W.emit("resume"),q(W),J.flowing&&!J.reading&&W.read(0)}I.prototype.pause=function(){return k("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(k("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function q(W){var J=W._readableState;for(k("flow",J.flowing);J.flowing&&W.read()!==null;);}I.prototype.wrap=function(W){var J=this._readableState,ne=!1,Oe=this;W.on("end",function(){if(k("wrapped end"),J.decoder&&!J.ended){var Xe=J.decoder.end();Xe&&Xe.length&&Oe.push(Xe)}Oe.push(null)}),W.on("data",function(Xe){if(k("wrapped data"),J.decoder&&(Xe=J.decoder.write(Xe)),!(J.objectMode&&Xe==null)&&!(!J.objectMode&&(!Xe||!Xe.length))){var Ze=Oe.push(Xe);Ze||(ne=!0,W.pause())}});for(var Ne in W)this[Ne]===void 0&&typeof W[Ne]=="function"&&(this[Ne]=function(Xe){return function(){return W[Xe].apply(W,arguments)}}(Ne));var Ce=["error","close","destroy","pause","resume"];return le(Ce,function(Xe){W.on(Xe,Oe.emit.bind(Oe,Xe))}),Oe._read=function(Xe){k("wrapped _read",Xe),ne&&(ne=!1,W.resume())},Oe},I._fromList=ie;function ie(W,J){if(J.length===0)return null;var ne;return J.objectMode?ne=J.buffer.shift():!W||W>=J.length?(J.decoder?ne=J.buffer.join(""):J.buffer.length===1?ne=J.buffer.head.data:ne=J.buffer.concat(J.length),J.buffer.clear()):ne=oe(W,J.buffer,J.decoder),ne}function oe(W,J,ne){var Oe;return W<J.head.data.length?(Oe=J.head.data.slice(0,W),J.head.data=J.head.data.slice(W)):W===J.head.data.length?Oe=J.shift():Oe=ne?fe(W,J):_e(W,J),Oe}function fe(W,J){var ne=J.head,Oe=1,Ne=ne.data;for(W-=Ne.length;ne=ne.next;){var Ce=ne.data,Xe=W>Ce.length?Ce.length:W;if(Xe===Ce.length?Ne+=Ce:Ne+=Ce.slice(0,W),W-=Xe,W===0){Xe===Ce.length?(++Oe,ne.next?J.head=ne.next:J.head=J.tail=null):(J.head=ne,ne.data=Ce.slice(Xe));break}++Oe}return J.length-=Oe,Ne}function _e(W,J){var ne=p.allocUnsafe(W),Oe=J.head,Ne=1;for(Oe.data.copy(ne),W-=Oe.data.length;Oe=Oe.next;){var Ce=Oe.data,Xe=W>Ce.length?Ce.length:W;if(Ce.copy(ne,ne.length-W,0,Xe),W-=Xe,W===0){Xe===Ce.length?(++Ne,Oe.next?J.head=Oe.next:J.head=J.tail=null):(J.head=Oe,Oe.data=Ce.slice(Xe));break}++Ne}return J.length-=Ne,ne}function Ee(W){var J=W._readableState;if(J.length>0)throw new Error('"endReadable()" called on non-empty stream');J.endEmitted||(J.ended=!0,a(Se,J,W))}function Se(W,J){!W.endEmitted&&W.length===0&&(W.endEmitted=!0,J.readable=!1,J.emit("end"))}function le(W,J){for(var ne=0,Oe=W.length;ne<Oe;ne++)J(W[ne],ne)}function we(W,J){for(var ne=0,Oe=W.length;ne<Oe;ne++)if(W[ne]===J)return ne;return-1}}).call(n,i(6))},function(r,n,i){(function(s){"use strict";!s.version||s.version.indexOf("v0.")===0||s.version.indexOf("v1.")===0&&s.version.indexOf("v1.8.")!==0?r.exports=a:r.exports=s.nextTick;function a(o,l,c,f){if(typeof o!="function")throw new TypeError('"callback" argument must be a function');var u=arguments.length,d,p;switch(u){case 0:case 1:return s.nextTick(o);case 2:return s.nextTick(function(){o.call(null,l)});case 3:return s.nextTick(function(){o.call(null,l,c)});case 4:return s.nextTick(function(){o.call(null,l,c,f)});default:for(d=new Array(u-1),p=0;p<d.length;)d[p++]=arguments[p];return s.nextTick(function(){o.apply(null,d)})}}}).call(n,i(6))},function(r,n){var i={}.toString;r.exports=Array.isArray||function(s){return i.call(s)=="[object Array]"}},function(r,n,i){(function(s){"use strict";var a=i(2),o=a.Buffer,l=a.SlowBuffer,c=a.kMaxLength||2147483647;n.alloc=function(u,d,p){if(typeof o.alloc=="function")return o.alloc(u,d,p);if(typeof p=="number")throw new TypeError("encoding must not be number");if(typeof u!="number")throw new TypeError("size must be a number");if(u>c)throw new RangeError("size is too large");var _=p,w=d;w===void 0&&(_=void 0,w=0);var k=new o(u);if(typeof w=="string")for(var S=new o(w,_),O=S.length,A=-1;++A<u;)k[A]=S[A%O];else k.fill(w);return k},n.allocUnsafe=function(u){if(typeof o.allocUnsafe=="function")return o.allocUnsafe(u);if(typeof u!="number")throw new TypeError("size must be a number");if(u>c)throw new RangeError("size is too large");return new o(u)},n.from=function(u,d,p){if(typeof o.from=="function"&&(!s.Uint8Array||Uint8Array.from!==o.from))return o.from(u,d,p);if(typeof u=="number")throw new TypeError('"value" argument must not be a number');if(typeof u=="string")return new o(u,d);if(typeof ArrayBuffer<"u"&&u instanceof ArrayBuffer){var _=d;if(arguments.length===1)return new o(u);typeof _>"u"&&(_=0);var w=p;if(typeof w>"u"&&(w=u.byteLength-_),_>=u.byteLength)throw new RangeError("'offset' is out of bounds");if(w>u.byteLength-_)throw new RangeError("'length' is out of bounds");return new o(u.slice(_,_+w))}if(o.isBuffer(u)){var k=new o(u.length);return u.copy(k,0,0,u.length),k}if(u){if(Array.isArray(u)||typeof ArrayBuffer<"u"&&u.buffer instanceof ArrayBuffer||"length"in u)return new o(u);if(u.type==="Buffer"&&Array.isArray(u.data))return new o(u.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},n.allocUnsafeSlow=function(u){if(typeof o.allocUnsafeSlow=="function")return o.allocUnsafeSlow(u);if(typeof u!="number")throw new TypeError("size must be a number");if(u>=c)throw new RangeError("size is too large");return new l(u)}}).call(n,function(){return this}())},function(r,n,i){(function(s){function a(I){return Array.isArray?Array.isArray(I):C(I)==="[object Array]"}n.isArray=a;function o(I){return typeof I=="boolean"}n.isBoolean=o;function l(I){return I===null}n.isNull=l;function c(I){return I==null}n.isNullOrUndefined=c;function f(I){return typeof I=="number"}n.isNumber=f;function u(I){return typeof I=="string"}n.isString=u;function d(I){return typeof I=="symbol"}n.isSymbol=d;function p(I){return I===void 0}n.isUndefined=p;function _(I){return C(I)==="[object RegExp]"}n.isRegExp=_;function w(I){return typeof I=="object"&&I!==null}n.isObject=w;function k(I){return C(I)==="[object Date]"}n.isDate=k;function S(I){return C(I)==="[object Error]"||I instanceof Error}n.isError=S;function O(I){return typeof I=="function"}n.isFunction=O;function A(I){return I===null||typeof I=="boolean"||typeof I=="number"||typeof I=="string"||typeof I=="symbol"||typeof I>"u"}n.isPrimitive=A,n.isBuffer=s.isBuffer;function C(I){return Object.prototype.toString.call(I)}}).call(n,i(1))},function(r,n){},function(r,n,i){"use strict";var s=i(2).Buffer,a=i(17);r.exports=o;function o(){this.head=null,this.tail=null,this.length=0}o.prototype.push=function(l){var c={data:l,next:null};this.length>0?this.tail.next=c:this.head=c,this.tail=c,++this.length},o.prototype.unshift=function(l){var c={data:l,next:this.head};this.length===0&&(this.tail=c),this.head=c,++this.length},o.prototype.shift=function(){if(this.length!==0){var l=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,l}},o.prototype.clear=function(){this.head=this.tail=null,this.length=0},o.prototype.join=function(l){if(this.length===0)return"";for(var c=this.head,f=""+c.data;c=c.next;)f+=l+c.data;return f},o.prototype.concat=function(l){if(this.length===0)return a.alloc(0);if(this.length===1)return this.head.data;for(var c=a.allocUnsafe(l>>>0),f=this.head,u=0;f;)f.data.copy(c,u),u+=f.data.length,f=f.next;return c}},function(r,n,i){"use strict";var s=Object.keys||function(S){var O=[];for(var A in S)O.push(A);return O};r.exports=p;var a=i(15),o=i(18);o.inherits=i(12);var l=i(14),c=i(22);o.inherits(p,l);for(var f=s(c.prototype),u=0;u<f.length;u++){var d=f[u];p.prototype[d]||(p.prototype[d]=c.prototype[d])}function p(S){if(!(this instanceof p))return new p(S);l.call(this,S),c.call(this,S),S&&S.readable===!1&&(this.readable=!1),S&&S.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,S&&S.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",_)}function _(){this.allowHalfOpen||this._writableState.ended||a(w,this)}function w(S){S.end()}function k(S,O){for(var A=0,C=S.length;A<C;A++)O(S[A],A)}},function(r,n,i){(function(s){"use strict";r.exports=O;var a=i(15),o=!s.browser&&["v0.10","v0.9."].indexOf(s.version.slice(0,5))>-1?setImmediate:a,l;O.WritableState=k;var c=i(18);c.inherits=i(12);var f={deprecate:i(23)},u;(function(){try{u=i(11)}catch{}finally{u||(u=i(8).EventEmitter)}})();var d=i(2).Buffer,p=i(17);c.inherits(O,u);function _(){}function w(R,$,q){this.chunk=R,this.encoding=$,this.callback=q,this.next=null}function k(R,$){l=l||i(21),R=R||{},this.objectMode=!!R.objectMode,$ instanceof l&&(this.objectMode=this.objectMode||!!R.writableObjectMode);var q=R.highWaterMark,ie=this.objectMode?16:16*1024;this.highWaterMark=q||q===0?q:ie,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var oe=R.decodeStrings===!1;this.decodeStrings=!oe,this.defaultEncoding=R.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(fe){V($,fe)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Q(this)}k.prototype.getBuffer=function(){for(var $=this.bufferedRequest,q=[];$;)q.push($),$=$.next;return q},function(){try{Object.defineProperty(k.prototype,"buffer",{get:f.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch{}}();var S;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(S=Function.prototype[Symbol.hasInstance],Object.defineProperty(O,Symbol.hasInstance,{value:function(R){return S.call(this,R)?!0:R&&R._writableState instanceof k}})):S=function(R){return R instanceof this};function O(R){if(l=l||i(21),!S.call(O,this)&&!(this instanceof l))return new O(R);this._writableState=new k(R,this),this.writable=!0,R&&(typeof R.write=="function"&&(this._write=R.write),typeof R.writev=="function"&&(this._writev=R.writev)),u.call(this)}O.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function A(R,$){var q=new Error("write after end");R.emit("error",q),a($,q)}function C(R,$,q,ie){var oe=!0,fe=!1;return q===null?fe=new TypeError("May not write null values to stream"):typeof q!="string"&&q!==void 0&&!$.objectMode&&(fe=new TypeError("Invalid non-string/buffer chunk")),fe&&(R.emit("error",fe),a(ie,fe),oe=!1),oe}O.prototype.write=function(R,$,q){var ie=this._writableState,oe=!1,fe=d.isBuffer(R);return typeof $=="function"&&(q=$,$=null),fe?$="buffer":$||($=ie.defaultEncoding),typeof q!="function"&&(q=_),ie.ended?A(this,q):(fe||C(this,ie,R,q))&&(ie.pendingcb++,oe=D(this,ie,fe,R,$,q)),oe},O.prototype.cork=function(){var R=this._writableState;R.corked++},O.prototype.uncork=function(){var R=this._writableState;R.corked&&(R.corked--,!R.writing&&!R.corked&&!R.finished&&!R.bufferProcessing&&R.bufferedRequest&&se(this,R))},O.prototype.setDefaultEncoding=function($){if(typeof $=="string"&&($=$.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf(($+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+$);return this._writableState.defaultEncoding=$,this};function I(R,$,q){return!R.objectMode&&R.decodeStrings!==!1&&typeof $=="string"&&($=p.from($,q)),$}function D(R,$,q,ie,oe,fe){q||(ie=I($,ie,oe),d.isBuffer(ie)&&(oe="buffer"));var _e=$.objectMode?1:ie.length;$.length+=_e;var Ee=$.length<$.highWaterMark;if(Ee||($.needDrain=!0),$.writing||$.corked){var Se=$.lastBufferedRequest;$.lastBufferedRequest=new w(ie,oe,fe),Se?Se.next=$.lastBufferedRequest:$.bufferedRequest=$.lastBufferedRequest,$.bufferedRequestCount+=1}else L(R,$,!1,_e,ie,oe,fe);return Ee}function L(R,$,q,ie,oe,fe,_e){$.writelen=ie,$.writecb=_e,$.writing=!0,$.sync=!0,q?R._writev(oe,$.onwrite):R._write(oe,fe,$.onwrite),$.sync=!1}function U(R,$,q,ie,oe){--$.pendingcb,q?a(oe,ie):oe(ie),R._writableState.errorEmitted=!0,R.emit("error",ie)}function te(R){R.writing=!1,R.writecb=null,R.length-=R.writelen,R.writelen=0}function V(R,$){var q=R._writableState,ie=q.sync,oe=q.writecb;if(te(q),$)U(R,q,ie,$,oe);else{var fe=pe(q);!fe&&!q.corked&&!q.bufferProcessing&&q.bufferedRequest&&se(R,q),ie?o(X,R,q,fe,oe):X(R,q,fe,oe)}}function X(R,$,q,ie){q||Z(R,$),$.pendingcb--,ie(),F(R,$)}function Z(R,$){$.length===0&&$.needDrain&&($.needDrain=!1,R.emit("drain"))}function se(R,$){$.bufferProcessing=!0;var q=$.bufferedRequest;if(R._writev&&q&&q.next){var ie=$.bufferedRequestCount,oe=new Array(ie),fe=$.corkedRequestsFree;fe.entry=q;for(var _e=0;q;)oe[_e]=q,q=q.next,_e+=1;L(R,$,!0,$.length,oe,"",fe.finish),$.pendingcb++,$.lastBufferedRequest=null,fe.next?($.corkedRequestsFree=fe.next,fe.next=null):$.corkedRequestsFree=new Q($)}else{for(;q;){var Ee=q.chunk,Se=q.encoding,le=q.callback,we=$.objectMode?1:Ee.length;if(L(R,$,!1,we,Ee,Se,le),q=q.next,$.writing)break}q===null&&($.lastBufferedRequest=null)}$.bufferedRequestCount=0,$.bufferedRequest=q,$.bufferProcessing=!1}O.prototype._write=function(R,$,q){q(new Error("_write() is not implemented"))},O.prototype._writev=null,O.prototype.end=function(R,$,q){var ie=this._writableState;typeof R=="function"?(q=R,R=null,$=null):typeof $=="function"&&(q=$,$=null),R!=null&&this.write(R,$),ie.corked&&(ie.corked=1,this.uncork()),!ie.ending&&!ie.finished&&H(this,ie,q)};function pe(R){return R.ending&&R.length===0&&R.bufferedRequest===null&&!R.finished&&!R.writing}function de(R,$){$.prefinished||($.prefinished=!0,R.emit("prefinish"))}function F(R,$){var q=pe($);return q&&($.pendingcb===0?(de(R,$),$.finished=!0,R.emit("finish")):de(R,$)),q}function H(R,$,q){$.ending=!0,F(R,$),q&&($.finished?a(q):R.once("finish",q)),$.ended=!0,R.writable=!1}function Q(R){var $=this;this.next=null,this.entry=null,this.finish=function(q){var ie=$.entry;for($.entry=null;ie;){var oe=ie.callback;R.pendingcb--,oe(q),ie=ie.next}R.corkedRequestsFree?R.corkedRequestsFree.next=$:R.corkedRequestsFree=$}}}).call(n,i(6))},function(r,n){(function(i){r.exports=s;function s(o,l){if(a("noDeprecation"))return o;var c=!1;function f(){if(!c){if(a("throwDeprecation"))throw new Error(l);a("traceDeprecation")?console.trace(l):console.warn(l),c=!0}return o.apply(this,arguments)}return f}function a(o){try{if(!i.localStorage)return!1}catch{return!1}var l=i.localStorage[o];return l==null?!1:String(l).toLowerCase()==="true"}}).call(n,function(){return this}())},function(r,n,i){var s=i(2).Buffer,a=s.isEncoding||function(d){switch(d&&d.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(d){if(d&&!a(d))throw new Error("Unknown encoding: "+d)}var l=n.StringDecoder=function(d){switch(this.encoding=(d||"utf8").toLowerCase().replace(/[-_]/,""),o(d),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=u;break;default:this.write=c;return}this.charBuffer=new s(6),this.charReceived=0,this.charLength=0};l.prototype.write=function(d){for(var p="";this.charLength;){var _=d.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:d.length;if(d.copy(this.charBuffer,this.charReceived,0,_),this.charReceived+=_,this.charReceived<this.charLength)return"";d=d.slice(_,d.length),p=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var k=p.charCodeAt(p.length-1);if(k>=55296&&k<=56319){this.charLength+=this.surrogateSize,p="";continue}if(this.charReceived=this.charLength=0,d.length===0)return p;break}this.detectIncompleteChar(d);var w=d.length;this.charLength&&(d.copy(this.charBuffer,0,d.length-this.charReceived,w),w-=this.charReceived),p+=d.toString(this.encoding,0,w);var w=p.length-1,k=p.charCodeAt(w);if(k>=55296&&k<=56319){var S=this.surrogateSize;return this.charLength+=S,this.charReceived+=S,this.charBuffer.copy(this.charBuffer,S,0,S),d.copy(this.charBuffer,0,0,S),p.substring(0,w)}return p},l.prototype.detectIncompleteChar=function(d){for(var p=d.length>=3?3:d.length;p>0;p--){var _=d[d.length-p];if(p==1&&_>>5==6){this.charLength=2;break}if(p<=2&&_>>4==14){this.charLength=3;break}if(p<=3&&_>>3==30){this.charLength=4;break}}this.charReceived=p},l.prototype.end=function(d){var p="";if(d&&d.length&&(p=this.write(d)),this.charReceived){var _=this.charReceived,w=this.charBuffer,k=this.encoding;p+=w.slice(0,_).toString(k)}return p};function c(d){return d.toString(this.encoding)}function f(d){this.charReceived=d.length%2,this.charLength=this.charReceived?2:0}function u(d){this.charReceived=d.length%3,this.charLength=this.charReceived?3:0}},function(r,n,i){"use strict";r.exports=c;var s=i(21),a=i(18);a.inherits=i(12),a.inherits(c,s);function o(u){this.afterTransform=function(d,p){return l(u,d,p)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function l(u,d,p){var _=u._transformState;_.transforming=!1;var w=_.writecb;if(!w)return u.emit("error",new Error("no writecb in Transform class"));_.writechunk=null,_.writecb=null,p!=null&&u.push(p),w(d);var k=u._readableState;k.reading=!1,(k.needReadable||k.length<k.highWaterMark)&&u._read(k.highWaterMark)}function c(u){if(!(this instanceof c))return new c(u);s.call(this,u),this._transformState=new o(this);var d=this;this._readableState.needReadable=!0,this._readableState.sync=!1,u&&(typeof u.transform=="function"&&(this._transform=u.transform),typeof u.flush=="function"&&(this._flush=u.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(p,_){f(d,p,_)}):f(d)})}c.prototype.push=function(u,d){return this._transformState.needTransform=!1,s.prototype.push.call(this,u,d)},c.prototype._transform=function(u,d,p){throw new Error("_transform() is not implemented")},c.prototype._write=function(u,d,p){var _=this._transformState;if(_.writecb=p,_.writechunk=u,_.writeencoding=d,!_.transforming){var w=this._readableState;(_.needTransform||w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}},c.prototype._read=function(u){var d=this._transformState;d.writechunk!==null&&d.writecb&&!d.transforming?(d.transforming=!0,this._transform(d.writechunk,d.writeencoding,d.afterTransform)):d.needTransform=!0};function f(u,d,p){if(d)return u.emit("error",d);p!=null&&u.push(p);var _=u._writableState,w=u._transformState;if(_.length)throw new Error("Calling transform done when ws.length != 0");if(w.transforming)throw new Error("Calling transform done when still transforming");return u.push(null)}},function(r,n,i){"use strict";r.exports=o;var s=i(25),a=i(18);a.inherits=i(12),a.inherits(o,s);function o(l){if(!(this instanceof o))return new o(l);s.call(this,l)}o.prototype._transform=function(l,c,f){f(null,l)}},function(r,n,i){r.exports=i(22)},function(r,n,i){r.exports=i(21)},function(r,n,i){r.exports=i(25)},function(r,n,i){r.exports=i(26)},function(r,n,i){"use strict";var s=i(32),a=i(33),o=i(38),l=i(39),c=i(40),f=i(41),u=i(42),d=Object.prototype.toString;function p(k){if(!(this instanceof p))return new p(k);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},k||{});var S=this.options;S.raw&&S.windowBits>=0&&S.windowBits<16&&(S.windowBits=-S.windowBits,S.windowBits===0&&(S.windowBits=-15)),S.windowBits>=0&&S.windowBits<16&&!(k&&k.windowBits)&&(S.windowBits+=32),S.windowBits>15&&S.windowBits<48&&(S.windowBits&15||(S.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var O=s.inflateInit2(this.strm,S.windowBits);if(O!==l.Z_OK)throw new Error(c[O]);this.header=new u,s.inflateGetHeader(this.strm,this.header)}p.prototype.push=function(k,S){var O=this.strm,A=this.options.chunkSize,C=this.options.dictionary,I,D,L,U,te,V,X=!1;if(this.ended)return!1;D=S===~~S?S:S===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof k=="string"?O.input=o.binstring2buf(k):d.call(k)==="[object ArrayBuffer]"?O.input=new Uint8Array(k):O.input=k,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new a.Buf8(A),O.next_out=0,O.avail_out=A),I=s.inflate(O,l.Z_NO_FLUSH),I===l.Z_NEED_DICT&&C&&(typeof C=="string"?V=o.string2buf(C):d.call(C)==="[object ArrayBuffer]"?V=new Uint8Array(C):V=C,I=s.inflateSetDictionary(this.strm,V)),I===l.Z_BUF_ERROR&&X===!0&&(I=l.Z_OK,X=!1),I!==l.Z_STREAM_END&&I!==l.Z_OK)return this.onEnd(I),this.ended=!0,!1;O.next_out&&(O.avail_out===0||I===l.Z_STREAM_END||O.avail_in===0&&(D===l.Z_FINISH||D===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(L=o.utf8border(O.output,O.next_out),U=O.next_out-L,te=o.buf2string(O.output,L),O.next_out=U,O.avail_out=A-U,U&&a.arraySet(O.output,O.output,L,U,0),this.onData(te)):this.onData(a.shrinkBuf(O.output,O.next_out))),O.avail_in===0&&O.avail_out===0&&(X=!0)}while((O.avail_in>0||O.avail_out===0)&&I!==l.Z_STREAM_END);return I===l.Z_STREAM_END&&(D=l.Z_FINISH),D===l.Z_FINISH?(I=s.inflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===l.Z_OK):(D===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),O.avail_out=0),!0)},p.prototype.onData=function(k){this.chunks.push(k)},p.prototype.onEnd=function(k){k===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=k,this.msg=this.strm.msg};function _(k,S){var O=new p(S);if(O.push(k,!0),O.err)throw O.msg||c[O.err];return O.result}function w(k,S){return S=S||{},S.raw=!0,_(k,S)}n.Inflate=p,n.inflate=_,n.inflateRaw=w,n.ungzip=_},function(r,n,i){"use strict";var s=i(33),a=i(34),o=i(35),l=i(36),c=i(37),f=0,u=1,d=2,p=4,_=5,w=6,k=0,S=1,O=2,A=-2,C=-3,I=-4,D=-5,L=8,U=1,te=2,V=3,X=4,Z=5,se=6,pe=7,de=8,F=9,H=10,Q=11,R=12,$=13,q=14,ie=15,oe=16,fe=17,_e=18,Ee=19,Se=20,le=21,we=22,W=23,J=24,ne=25,Oe=26,Ne=27,Ce=28,Xe=29,Ze=30,kt=31,St=32,pt=852,ee=592,j=15,B=j;function re(Ae){return(Ae>>>24&255)+(Ae>>>8&65280)+((Ae&65280)<<8)+((Ae&255)<<24)}function ke(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Te(Ae){var nt;return!Ae||!Ae.state?A:(nt=Ae.state,Ae.total_in=Ae.total_out=nt.total=0,Ae.msg="",nt.wrap&&(Ae.adler=nt.wrap&1),nt.mode=U,nt.last=0,nt.havedict=0,nt.dmax=32768,nt.head=null,nt.hold=0,nt.bits=0,nt.lencode=nt.lendyn=new s.Buf32(pt),nt.distcode=nt.distdyn=new s.Buf32(ee),nt.sane=1,nt.back=-1,k)}function Me(Ae){var nt;return!Ae||!Ae.state?A:(nt=Ae.state,nt.wsize=0,nt.whave=0,nt.wnext=0,Te(Ae))}function It(Ae,nt){var Y,ot;return!Ae||!Ae.state||(ot=Ae.state,nt<0?(Y=0,nt=-nt):(Y=(nt>>4)+1,nt<48&&(nt&=15)),nt&&(nt<8||nt>15))?A:(ot.window!==null&&ot.wbits!==nt&&(ot.window=null),ot.wrap=Y,ot.wbits=nt,Me(Ae))}function Dt(Ae,nt){var Y,ot;return Ae?(ot=new ke,Ae.state=ot,ot.window=null,Y=It(Ae,nt),Y!==k&&(Ae.state=null),Y):A}function Qt(Ae){return Dt(Ae,B)}var Ir=!0,Jt,ji;function yl(Ae){if(Ir){var nt;for(Jt=new s.Buf32(512),ji=new s.Buf32(32),nt=0;nt<144;)Ae.lens[nt++]=8;for(;nt<256;)Ae.lens[nt++]=9;for(;nt<280;)Ae.lens[nt++]=7;for(;nt<288;)Ae.lens[nt++]=8;for(c(u,Ae.lens,0,288,Jt,0,Ae.work,{bits:9}),nt=0;nt<32;)Ae.lens[nt++]=5;c(d,Ae.lens,0,32,ji,0,Ae.work,{bits:5}),Ir=!1}Ae.lencode=Jt,Ae.lenbits=9,Ae.distcode=ji,Ae.distbits=5}function ho(Ae,nt,Y,ot){var er,it=Ae.state;return it.window===null&&(it.wsize=1<<it.wbits,it.wnext=0,it.whave=0,it.window=new s.Buf8(it.wsize)),ot>=it.wsize?(s.arraySet(it.window,nt,Y-it.wsize,it.wsize,0),it.wnext=0,it.whave=it.wsize):(er=it.wsize-it.wnext,er>ot&&(er=ot),s.arraySet(it.window,nt,Y-ot,er,it.wnext),ot-=er,ot?(s.arraySet(it.window,nt,Y-ot,ot,0),it.wnext=ot,it.whave=it.wsize):(it.wnext+=er,it.wnext===it.wsize&&(it.wnext=0),it.whave<it.wsize&&(it.whave+=er))),0}function he(Ae,nt){var Y,ot,er,it,Un,at,zr,De,je,ml,ur,ft,go,Qs,tr=0,Et,kr,qr,Nr,is,yo,rr,Pr,Ct=new s.Buf8(4),ei,wi,Pf=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Ae||!Ae.state||!Ae.output||!Ae.input&&Ae.avail_in!==0)return A;Y=Ae.state,Y.mode===R&&(Y.mode=$),Un=Ae.next_out,er=Ae.output,zr=Ae.avail_out,it=Ae.next_in,ot=Ae.input,at=Ae.avail_in,De=Y.hold,je=Y.bits,ml=at,ur=zr,Pr=k;e:for(;;)switch(Y.mode){case U:if(Y.wrap===0){Y.mode=$;break}for(;je<16;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}if(Y.wrap&2&&De===35615){Y.check=0,Ct[0]=De&255,Ct[1]=De>>>8&255,Y.check=o(Y.check,Ct,2,0),De=0,je=0,Y.mode=te;break}if(Y.flags=0,Y.head&&(Y.head.done=!1),!(Y.wrap&1)||(((De&255)<<8)+(De>>8))%31){Ae.msg="incorrect header check",Y.mode=Ze;break}if((De&15)!==L){Ae.msg="unknown compression method",Y.mode=Ze;break}if(De>>>=4,je-=4,rr=(De&15)+8,Y.wbits===0)Y.wbits=rr;else if(rr>Y.wbits){Ae.msg="invalid window size",Y.mode=Ze;break}Y.dmax=1<<rr,Ae.adler=Y.check=1,Y.mode=De&512?H:R,De=0,je=0;break;case te:for(;je<16;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}if(Y.flags=De,(Y.flags&255)!==L){Ae.msg="unknown compression method",Y.mode=Ze;break}if(Y.flags&57344){Ae.msg="unknown header flags set",Y.mode=Ze;break}Y.head&&(Y.head.text=De>>8&1),Y.flags&512&&(Ct[0]=De&255,Ct[1]=De>>>8&255,Y.check=o(Y.check,Ct,2,0)),De=0,je=0,Y.mode=V;case V:for(;je<32;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}Y.head&&(Y.head.time=De),Y.flags&512&&(Ct[0]=De&255,Ct[1]=De>>>8&255,Ct[2]=De>>>16&255,Ct[3]=De>>>24&255,Y.check=o(Y.check,Ct,4,0)),De=0,je=0,Y.mode=X;case X:for(;je<16;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}Y.head&&(Y.head.xflags=De&255,Y.head.os=De>>8),Y.flags&512&&(Ct[0]=De&255,Ct[1]=De>>>8&255,Y.check=o(Y.check,Ct,2,0)),De=0,je=0,Y.mode=Z;case Z:if(Y.flags&1024){for(;je<16;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}Y.length=De,Y.head&&(Y.head.extra_len=De),Y.flags&512&&(Ct[0]=De&255,Ct[1]=De>>>8&255,Y.check=o(Y.check,Ct,2,0)),De=0,je=0}else Y.head&&(Y.head.extra=null);Y.mode=se;case se:if(Y.flags&1024&&(ft=Y.length,ft>at&&(ft=at),ft&&(Y.head&&(rr=Y.head.extra_len-Y.length,Y.head.extra||(Y.head.extra=new Array(Y.head.extra_len)),s.arraySet(Y.head.extra,ot,it,ft,rr)),Y.flags&512&&(Y.check=o(Y.check,ot,ft,it)),at-=ft,it+=ft,Y.length-=ft),Y.length))break e;Y.length=0,Y.mode=pe;case pe:if(Y.flags&2048){if(at===0)break e;ft=0;do rr=ot[it+ft++],Y.head&&rr&&Y.length<65536&&(Y.head.name+=String.fromCharCode(rr));while(rr&&ft<at);if(Y.flags&512&&(Y.check=o(Y.check,ot,ft,it)),at-=ft,it+=ft,rr)break e}else Y.head&&(Y.head.name=null);Y.length=0,Y.mode=de;case de:if(Y.flags&4096){if(at===0)break e;ft=0;do rr=ot[it+ft++],Y.head&&rr&&Y.length<65536&&(Y.head.comment+=String.fromCharCode(rr));while(rr&&ft<at);if(Y.flags&512&&(Y.check=o(Y.check,ot,ft,it)),at-=ft,it+=ft,rr)break e}else Y.head&&(Y.head.comment=null);Y.mode=F;case F:if(Y.flags&512){for(;je<16;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}if(De!==(Y.check&65535)){Ae.msg="header crc mismatch",Y.mode=Ze;break}De=0,je=0}Y.head&&(Y.head.hcrc=Y.flags>>9&1,Y.head.done=!0),Ae.adler=Y.check=0,Y.mode=R;break;case H:for(;je<32;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}Ae.adler=Y.check=re(De),De=0,je=0,Y.mode=Q;case Q:if(Y.havedict===0)return Ae.next_out=Un,Ae.avail_out=zr,Ae.next_in=it,Ae.avail_in=at,Y.hold=De,Y.bits=je,O;Ae.adler=Y.check=1,Y.mode=R;case R:if(nt===_||nt===w)break e;case $:if(Y.last){De>>>=je&7,je-=je&7,Y.mode=Ne;break}for(;je<3;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}switch(Y.last=De&1,De>>>=1,je-=1,De&3){case 0:Y.mode=q;break;case 1:if(yl(Y),Y.mode=Se,nt===w){De>>>=2,je-=2;break e}break;case 2:Y.mode=fe;break;case 3:Ae.msg="invalid block type",Y.mode=Ze}De>>>=2,je-=2;break;case q:for(De>>>=je&7,je-=je&7;je<32;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}if((De&65535)!==(De>>>16^65535)){Ae.msg="invalid stored block lengths",Y.mode=Ze;break}if(Y.length=De&65535,De=0,je=0,Y.mode=ie,nt===w)break e;case ie:Y.mode=oe;case oe:if(ft=Y.length,ft){if(ft>at&&(ft=at),ft>zr&&(ft=zr),ft===0)break e;s.arraySet(er,ot,it,ft,Un),at-=ft,it+=ft,zr-=ft,Un+=ft,Y.length-=ft;break}Y.mode=R;break;case fe:for(;je<14;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}if(Y.nlen=(De&31)+257,De>>>=5,je-=5,Y.ndist=(De&31)+1,De>>>=5,je-=5,Y.ncode=(De&15)+4,De>>>=4,je-=4,Y.nlen>286||Y.ndist>30){Ae.msg="too many length or distance symbols",Y.mode=Ze;break}Y.have=0,Y.mode=_e;case _e:for(;Y.have<Y.ncode;){for(;je<3;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}Y.lens[Pf[Y.have++]]=De&7,De>>>=3,je-=3}for(;Y.have<19;)Y.lens[Pf[Y.have++]]=0;if(Y.lencode=Y.lendyn,Y.lenbits=7,ei={bits:Y.lenbits},Pr=c(f,Y.lens,0,19,Y.lencode,0,Y.work,ei),Y.lenbits=ei.bits,Pr){Ae.msg="invalid code lengths set",Y.mode=Ze;break}Y.have=0,Y.mode=Ee;case Ee:for(;Y.have<Y.nlen+Y.ndist;){for(;tr=Y.lencode[De&(1<<Y.lenbits)-1],Et=tr>>>24,kr=tr>>>16&255,qr=tr&65535,!(Et<=je);){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}if(qr<16)De>>>=Et,je-=Et,Y.lens[Y.have++]=qr;else{if(qr===16){for(wi=Et+2;je<wi;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}if(De>>>=Et,je-=Et,Y.have===0){Ae.msg="invalid bit length repeat",Y.mode=Ze;break}rr=Y.lens[Y.have-1],ft=3+(De&3),De>>>=2,je-=2}else if(qr===17){for(wi=Et+3;je<wi;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}De>>>=Et,je-=Et,rr=0,ft=3+(De&7),De>>>=3,je-=3}else{for(wi=Et+7;je<wi;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}De>>>=Et,je-=Et,rr=0,ft=11+(De&127),De>>>=7,je-=7}if(Y.have+ft>Y.nlen+Y.ndist){Ae.msg="invalid bit length repeat",Y.mode=Ze;break}for(;ft--;)Y.lens[Y.have++]=rr}}if(Y.mode===Ze)break;if(Y.lens[256]===0){Ae.msg="invalid code -- missing end-of-block",Y.mode=Ze;break}if(Y.lenbits=9,ei={bits:Y.lenbits},Pr=c(u,Y.lens,0,Y.nlen,Y.lencode,0,Y.work,ei),Y.lenbits=ei.bits,Pr){Ae.msg="invalid literal/lengths set",Y.mode=Ze;break}if(Y.distbits=6,Y.distcode=Y.distdyn,ei={bits:Y.distbits},Pr=c(d,Y.lens,Y.nlen,Y.ndist,Y.distcode,0,Y.work,ei),Y.distbits=ei.bits,Pr){Ae.msg="invalid distances set",Y.mode=Ze;break}if(Y.mode=Se,nt===w)break e;case Se:Y.mode=le;case le:if(at>=6&&zr>=258){Ae.next_out=Un,Ae.avail_out=zr,Ae.next_in=it,Ae.avail_in=at,Y.hold=De,Y.bits=je,l(Ae,ur),Un=Ae.next_out,er=Ae.output,zr=Ae.avail_out,it=Ae.next_in,ot=Ae.input,at=Ae.avail_in,De=Y.hold,je=Y.bits,Y.mode===R&&(Y.back=-1);break}for(Y.back=0;tr=Y.lencode[De&(1<<Y.lenbits)-1],Et=tr>>>24,kr=tr>>>16&255,qr=tr&65535,!(Et<=je);){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}if(kr&&!(kr&240)){for(Nr=Et,is=kr,yo=qr;tr=Y.lencode[yo+((De&(1<<Nr+is)-1)>>Nr)],Et=tr>>>24,kr=tr>>>16&255,qr=tr&65535,!(Nr+Et<=je);){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}De>>>=Nr,je-=Nr,Y.back+=Nr}if(De>>>=Et,je-=Et,Y.back+=Et,Y.length=qr,kr===0){Y.mode=Oe;break}if(kr&32){Y.back=-1,Y.mode=R;break}if(kr&64){Ae.msg="invalid literal/length code",Y.mode=Ze;break}Y.extra=kr&15,Y.mode=we;case we:if(Y.extra){for(wi=Y.extra;je<wi;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}Y.length+=De&(1<<Y.extra)-1,De>>>=Y.extra,je-=Y.extra,Y.back+=Y.extra}Y.was=Y.length,Y.mode=W;case W:for(;tr=Y.distcode[De&(1<<Y.distbits)-1],Et=tr>>>24,kr=tr>>>16&255,qr=tr&65535,!(Et<=je);){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}if(!(kr&240)){for(Nr=Et,is=kr,yo=qr;tr=Y.distcode[yo+((De&(1<<Nr+is)-1)>>Nr)],Et=tr>>>24,kr=tr>>>16&255,qr=tr&65535,!(Nr+Et<=je);){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}De>>>=Nr,je-=Nr,Y.back+=Nr}if(De>>>=Et,je-=Et,Y.back+=Et,kr&64){Ae.msg="invalid distance code",Y.mode=Ze;break}Y.offset=qr,Y.extra=kr&15,Y.mode=J;case J:if(Y.extra){for(wi=Y.extra;je<wi;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}Y.offset+=De&(1<<Y.extra)-1,De>>>=Y.extra,je-=Y.extra,Y.back+=Y.extra}if(Y.offset>Y.dmax){Ae.msg="invalid distance too far back",Y.mode=Ze;break}Y.mode=ne;case ne:if(zr===0)break e;if(ft=ur-zr,Y.offset>ft){if(ft=Y.offset-ft,ft>Y.whave&&Y.sane){Ae.msg="invalid distance too far back",Y.mode=Ze;break}ft>Y.wnext?(ft-=Y.wnext,go=Y.wsize-ft):go=Y.wnext-ft,ft>Y.length&&(ft=Y.length),Qs=Y.window}else Qs=er,go=Un-Y.offset,ft=Y.length;ft>zr&&(ft=zr),zr-=ft,Y.length-=ft;do er[Un++]=Qs[go++];while(--ft);Y.length===0&&(Y.mode=le);break;case Oe:if(zr===0)break e;er[Un++]=Y.length,zr--,Y.mode=le;break;case Ne:if(Y.wrap){for(;je<32;){if(at===0)break e;at--,De|=ot[it++]<<je,je+=8}if(ur-=zr,Ae.total_out+=ur,Y.total+=ur,ur&&(Ae.adler=Y.check=Y.flags?o(Y.check,er,ur,Un-ur):a(Y.check,er,ur,Un-ur)),ur=zr,(Y.flags?De:re(De))!==Y.check){Ae.msg="incorrect data check",Y.mode=Ze;break}De=0,je=0}Y.mode=Ce;case Ce:if(Y.wrap&&Y.flags){for(;je<32;){if(at===0)break e;at--,De+=ot[it++]<<je,je+=8}if(De!==(Y.total&4294967295)){Ae.msg="incorrect length check",Y.mode=Ze;break}De=0,je=0}Y.mode=Xe;case Xe:Pr=S;break e;case Ze:Pr=C;break e;case kt:return I;case St:default:return A}return Ae.next_out=Un,Ae.avail_out=zr,Ae.next_in=it,Ae.avail_in=at,Y.hold=De,Y.bits=je,(Y.wsize||ur!==Ae.avail_out&&Y.mode<Ze&&(Y.mode<Ne||nt!==p))&&ho(Ae,Ae.output,Ae.next_out,ur-Ae.avail_out)?(Y.mode=kt,I):(ml-=Ae.avail_in,ur-=Ae.avail_out,Ae.total_in+=ml,Ae.total_out+=ur,Y.total+=ur,Y.wrap&&ur&&(Ae.adler=Y.check=Y.flags?o(Y.check,er,ur,Ae.next_out-ur):a(Y.check,er,ur,Ae.next_out-ur)),Ae.data_type=Y.bits+(Y.last?64:0)+(Y.mode===R?128:0)+(Y.mode===Se||Y.mode===ie?256:0),(ml===0&&ur===0||nt===p)&&Pr===k&&(Pr=D),Pr)}function Hh(Ae){if(!Ae||!Ae.state)return A;var nt=Ae.state;return nt.window&&(nt.window=null),Ae.state=null,k}function Wh(Ae,nt){var Y;return!Ae||!Ae.state||(Y=Ae.state,!(Y.wrap&2))?A:(Y.head=nt,nt.done=!1,k)}function Jh(Ae,nt){var Y=nt.length,ot,er,it;return!Ae||!Ae.state||(ot=Ae.state,ot.wrap!==0&&ot.mode!==Q)?A:ot.mode===Q&&(er=1,er=a(er,nt,Y,0),er!==ot.check)?C:(it=ho(Ae,nt,Y,Y),it?(ot.mode=kt,I):(ot.havedict=1,k))}n.inflateReset=Me,n.inflateReset2=It,n.inflateResetKeep=Te,n.inflateInit=Qt,n.inflateInit2=Dt,n.inflate=he,n.inflateEnd=Hh,n.inflateGetHeader=Wh,n.inflateSetDictionary=Jh,n.inflateInfo="pako inflate (from Nodeca project)"},function(r,n){"use strict";var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(o){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var c=l.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var f in c)c.hasOwnProperty(f)&&(o[f]=c[f])}}return o},n.shrinkBuf=function(o,l){return o.length===l?o:o.subarray?o.subarray(0,l):(o.length=l,o)};var s={arraySet:function(o,l,c,f,u){if(l.subarray&&o.subarray){o.set(l.subarray(c,c+f),u);return}for(var d=0;d<f;d++)o[u+d]=l[c+d]},flattenChunks:function(o){var l,c,f,u,d,p;for(f=0,l=0,c=o.length;l<c;l++)f+=o[l].length;for(p=new Uint8Array(f),u=0,l=0,c=o.length;l<c;l++)d=o[l],p.set(d,u),u+=d.length;return p}},a={arraySet:function(o,l,c,f,u){for(var d=0;d<f;d++)o[u+d]=l[c+d]},flattenChunks:function(o){return[].concat.apply([],o)}};n.setTyped=function(o){o?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,s)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(i)},function(r,n){"use strict";function i(s,a,o,l){for(var c=s&65535|0,f=s>>>16&65535|0,u=0;o!==0;){u=o>2e3?2e3:o,o-=u;do c=c+a[l++]|0,f=f+c|0;while(--u);c%=65521,f%=65521}return c|f<<16|0}r.exports=i},function(r,n){"use strict";function i(){for(var o,l=[],c=0;c<256;c++){o=c;for(var f=0;f<8;f++)o=o&1?3988292384^o>>>1:o>>>1;l[c]=o}return l}var s=i();function a(o,l,c,f){var u=s,d=f+c;o^=-1;for(var p=f;p<d;p++)o=o>>>8^u[(o^l[p])&255];return o^-1}r.exports=a},function(r,n){"use strict";var i=30,s=12;r.exports=function(o,l){var c,f,u,d,p,_,w,k,S,O,A,C,I,D,L,U,te,V,X,Z,se,pe,de,F,H;c=o.state,f=o.next_in,F=o.input,u=f+(o.avail_in-5),d=o.next_out,H=o.output,p=d-(l-o.avail_out),_=d+(o.avail_out-257),w=c.dmax,k=c.wsize,S=c.whave,O=c.wnext,A=c.window,C=c.hold,I=c.bits,D=c.lencode,L=c.distcode,U=(1<<c.lenbits)-1,te=(1<<c.distbits)-1;e:do{I<15&&(C+=F[f++]<<I,I+=8,C+=F[f++]<<I,I+=8),V=D[C&U];t:for(;;){if(X=V>>>24,C>>>=X,I-=X,X=V>>>16&255,X===0)H[d++]=V&65535;else if(X&16){Z=V&65535,X&=15,X&&(I<X&&(C+=F[f++]<<I,I+=8),Z+=C&(1<<X)-1,C>>>=X,I-=X),I<15&&(C+=F[f++]<<I,I+=8,C+=F[f++]<<I,I+=8),V=L[C&te];r:for(;;){if(X=V>>>24,C>>>=X,I-=X,X=V>>>16&255,X&16){if(se=V&65535,X&=15,I<X&&(C+=F[f++]<<I,I+=8,I<X&&(C+=F[f++]<<I,I+=8)),se+=C&(1<<X)-1,se>w){o.msg="invalid distance too far back",c.mode=i;break e}if(C>>>=X,I-=X,X=d-p,se>X){if(X=se-X,X>S&&c.sane){o.msg="invalid distance too far back",c.mode=i;break e}if(pe=0,de=A,O===0){if(pe+=k-X,X<Z){Z-=X;do H[d++]=A[pe++];while(--X);pe=d-se,de=H}}else if(O<X){if(pe+=k+O-X,X-=O,X<Z){Z-=X;do H[d++]=A[pe++];while(--X);if(pe=0,O<Z){X=O,Z-=X;do H[d++]=A[pe++];while(--X);pe=d-se,de=H}}}else if(pe+=O-X,X<Z){Z-=X;do H[d++]=A[pe++];while(--X);pe=d-se,de=H}for(;Z>2;)H[d++]=de[pe++],H[d++]=de[pe++],H[d++]=de[pe++],Z-=3;Z&&(H[d++]=de[pe++],Z>1&&(H[d++]=de[pe++]))}else{pe=d-se;do H[d++]=H[pe++],H[d++]=H[pe++],H[d++]=H[pe++],Z-=3;while(Z>2);Z&&(H[d++]=H[pe++],Z>1&&(H[d++]=H[pe++]))}}else if(X&64){o.msg="invalid distance code",c.mode=i;break e}else{V=L[(V&65535)+(C&(1<<X)-1)];continue r}break}}else if(X&64)if(X&32){c.mode=s;break e}else{o.msg="invalid literal/length code",c.mode=i;break e}else{V=D[(V&65535)+(C&(1<<X)-1)];continue t}break}}while(f<u&&d<_);Z=I>>3,f-=Z,I-=Z<<3,C&=(1<<I)-1,o.next_in=f,o.next_out=d,o.avail_in=f<u?5+(u-f):5-(f-u),o.avail_out=d<_?257+(_-d):257-(d-_),c.hold=C,c.bits=I}},function(r,n,i){"use strict";var s=i(33),a=15,o=852,l=592,c=0,f=1,u=2,d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],_=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],w=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(S,O,A,C,I,D,L,U){var te=U.bits,V=0,X=0,Z=0,se=0,pe=0,de=0,F=0,H=0,Q=0,R=0,$,q,ie,oe,fe,_e=null,Ee=0,Se,le=new s.Buf16(a+1),we=new s.Buf16(a+1),W=null,J=0,ne,Oe,Ne;for(V=0;V<=a;V++)le[V]=0;for(X=0;X<C;X++)le[O[A+X]]++;for(pe=te,se=a;se>=1&&le[se]===0;se--);if(pe>se&&(pe=se),se===0)return I[D++]=1<<24|64<<16|0,I[D++]=1<<24|64<<16|0,U.bits=1,0;for(Z=1;Z<se&&le[Z]===0;Z++);for(pe<Z&&(pe=Z),H=1,V=1;V<=a;V++)if(H<<=1,H-=le[V],H<0)return-1;if(H>0&&(S===c||se!==1))return-1;for(we[1]=0,V=1;V<a;V++)we[V+1]=we[V]+le[V];for(X=0;X<C;X++)O[A+X]!==0&&(L[we[O[A+X]]++]=X);if(S===c?(_e=W=L,Se=19):S===f?(_e=d,Ee-=257,W=p,J-=257,Se=256):(_e=_,W=w,Se=-1),R=0,X=0,V=Z,fe=D,de=pe,F=0,ie=-1,Q=1<<pe,oe=Q-1,S===f&&Q>o||S===u&&Q>l)return 1;for(;;){ne=V-F,L[X]<Se?(Oe=0,Ne=L[X]):L[X]>Se?(Oe=W[J+L[X]],Ne=_e[Ee+L[X]]):(Oe=32+64,Ne=0),$=1<<V-F,q=1<<de,Z=q;do q-=$,I[fe+(R>>F)+q]=ne<<24|Oe<<16|Ne|0;while(q!==0);for($=1<<V-1;R&$;)$>>=1;if($!==0?(R&=$-1,R+=$):R=0,X++,--le[V]===0){if(V===se)break;V=O[A+L[X]]}if(V>pe&&(R&oe)!==ie){for(F===0&&(F=pe),fe+=Z,de=V-F,H=1<<de;de+F<se&&(H-=le[de+F],!(H<=0));)de++,H<<=1;if(Q+=1<<de,S===f&&Q>o||S===u&&Q>l)return 1;ie=R&oe,I[ie]=pe<<24|de<<16|fe-D|0}}return R!==0&&(I[fe+R]=V-F<<24|64<<16|0),U.bits=pe,0}},function(r,n,i){"use strict";var s=i(33),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;l[254]=l[254]=1,n.string2buf=function(u){var d,p,_,w,k,S=u.length,O=0;for(w=0;w<S;w++)p=u.charCodeAt(w),(p&64512)===55296&&w+1<S&&(_=u.charCodeAt(w+1),(_&64512)===56320&&(p=65536+(p-55296<<10)+(_-56320),w++)),O+=p<128?1:p<2048?2:p<65536?3:4;for(d=new s.Buf8(O),k=0,w=0;k<O;w++)p=u.charCodeAt(w),(p&64512)===55296&&w+1<S&&(_=u.charCodeAt(w+1),(_&64512)===56320&&(p=65536+(p-55296<<10)+(_-56320),w++)),p<128?d[k++]=p:p<2048?(d[k++]=192|p>>>6,d[k++]=128|p&63):p<65536?(d[k++]=224|p>>>12,d[k++]=128|p>>>6&63,d[k++]=128|p&63):(d[k++]=240|p>>>18,d[k++]=128|p>>>12&63,d[k++]=128|p>>>6&63,d[k++]=128|p&63);return d};function f(u,d){if(d<65537&&(u.subarray&&o||!u.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(u,d));for(var p="",_=0;_<d;_++)p+=String.fromCharCode(u[_]);return p}n.buf2binstring=function(u){return f(u,u.length)},n.binstring2buf=function(u){for(var d=new s.Buf8(u.length),p=0,_=d.length;p<_;p++)d[p]=u.charCodeAt(p);return d},n.buf2string=function(u,d){var p,_,w,k,S=d||u.length,O=new Array(S*2);for(_=0,p=0;p<S;){if(w=u[p++],w<128){O[_++]=w;continue}if(k=l[w],k>4){O[_++]=65533,p+=k-1;continue}for(w&=k===2?31:k===3?15:7;k>1&&p<S;)w=w<<6|u[p++]&63,k--;if(k>1){O[_++]=65533;continue}w<65536?O[_++]=w:(w-=65536,O[_++]=55296|w>>10&1023,O[_++]=56320|w&1023)}return f(O,_)},n.utf8border=function(u,d){var p;for(d=d||u.length,d>u.length&&(d=u.length),p=d-1;p>=0&&(u[p]&192)===128;)p--;return p<0||p===0?d:p+l[u[p]]>d?p:d}},function(r,n){"use strict";r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(r,n){"use strict";r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(r,n){"use strict";function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=i},function(r,n){"use strict";function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=i}])})}}),gy=class{constructor(e=this.onOpen,t=null,r=null){this.onOpen=e,this.notes=[],t!==null&&document.getElementById(t).addEventListener("click",this.saveCSV),r!==null&&document.getElementById(r).addEventListener("click",this.openCSV)}processArraysForCSV(e=["1|2|3","3|2|1"],t="|",r="a,b,c",n=!1){let i=r+`
`,s=0;return e.forEach((a,o)=>{e[o]==="string"&&t!==","?i+=a.split(t).join(","):csvData+=a.join(","),n===!0&&this.notes[s].idx===o&&(a+=this.notes[s].text,s++),a.indexOf(`
`)<0&&(i+=`
`)}),i}static saveCSV(e=`a,b,c
1,2,3
3,2,1
`,t=new Date().toISOString()){var r=document.createElement("a");r.href="data:text/csv;charset=utf-8,"+encodeURI(e),r.target="_blank",t!==""?r.download=t:r.download=new Date().toISOString()+".csv",r.click()}static openCSV(e=",",t=(r,n,i)=>i){return new Promise((r,n)=>{var i=document.createElement("input");i.accept=".csv",i.type="file",i.onchange=s=>{var a=s.target.files[0],o=new FileReader;o.onload=l=>{var c=l.target.result,f=c.split(`
`);let u=[];var d=[];f.pop(),f.forEach((p,_)=>{if(_==0)u=p.split(e);else{var w=p.split(e);d.push(w)}}),t(d,u,i.value),i.value="",r({data:d,header:u,filename:i.value})},o.readAsText(a)},i.click()})}static openCSVRaw(e=(t,r)=>r){return new Promise((t,r)=>{var n=document.createElement("input");n.accept=".csv",n.type="file",n.onchange=i=>{var s=i.target.files[0],a=new FileReader;a.onload=o=>{var l=o.target.result;e(l,n.value),n.value="",t({data:l,filename:n.value})},a.readAsText(s)},n.click()})}onOpen(e=[],t=[]){console.log("CSV Opened!",t,e)}},NO=(e,t,r,n=!0,i=(s,a,o)=>{let l={filename:a},c=o;typeof o=="string"&&(c=o.split(",")),l.header=c;for(let f=0;f<s.length;f++){let u=s[f].split(",");for(let d=0;d<u.length;d++)l[c[d]]||(l[c[d]]=[]),l[c[d]].push(u[d])}return l})=>{let s;return e.includes("\r")?s=e.split(`\r
`):s=e.split(`
`),r||(r=s[0]),s.shift(),n===!1&&s.pop(),i(s,t,r)};function CO(e){e=new Date(e);var t=s=>("0"+s).slice(-2),r=s=>("00"+s).slice(-3),n=e.getTimezoneOffset(),i=n<0?"+":"-";return n=Math.abs(n),e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"T"+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+r(e.getMilliseconds())+"(UTC"+i+t(n/60|0)+":00)"}var v0=Yne(Xne()),ai=!1,Bt=v0.BFSRequire("fs"),TLe=v0.BFSRequire("buffer").Buffer,b0,Oi=async(e=["data"],t=(i=[])=>{},r=i=>{},n="IndexedDB")=>ai?(b0&&await b0,!0):(ai=!0,b0=new Promise((i,s)=>{v0.FileSystem[n].Create({},(a,o)=>{if(a){s(a);return}if(!o){r(a),s(new Error("Error creating BrowserFS"));return}v0.initialize(o);let l=[];e.forEach(async c=>{l.push(Ai(Bt,c))}),Promise.all(l).then(c=>{t(c),i(!0)})})}),await b0),_0=async(e="")=>(ai?await Ai(Bt,e.split("/")[0]):await Oi([e.split("/")[0]]),await new Promise(t=>{Bt.exists("/"+e,function(r){t(r)})})),Zne=async(e="data")=>(ai?await Ai(Bt,e.split("/")[0]):await Oi([e.split("/")[0]]),await new Promise(t=>{Bt.readFile("/"+e,function(r,n){t(n)})}));async function nR(e="data",t=0,r=5120,n=i=>{}){if(ai?await Ai(Bt,e.split("/")[0]):await Oi([e.split("/")[0]]),e!="")return await new Promise(async(i,s)=>{Bt.open("/"+e,"r",(a,o)=>{if(a){s(a);return}Bt.read(o,r,t,"utf-8",(l,c,f)=>{if(l){s(l);return}if(f!==0){let u=c.toString();Bt.close(o,()=>{n(u,e),i(u)})}else i(void 0)})})});console.error("Path name is not defined")}var Qne=async(e="data",t=r=>{})=>(ai?await Ai(Bt,e):await Oi([e]),await new Promise((r,n)=>{Bt.readdir("/"+e,(i,s)=>{if(i){n(i);return}s?(t(s),r(s)):r(void 0)})})),w0=async(e,t,r=n=>{})=>(ai?await Ai(Bt,e.split("/")[0]):await Oi([e.split("/")[0]]),await new Promise((n,i)=>{Bt.writeFile("/"+e,t,s=>{if(s){i(s);return}r(t),n(!0)})})),IO=async(e,t,r=n=>{})=>(ai?await Ai(Bt,e.split("/")[0]):await Oi([e.split("/")[0]]),await new Promise((n,i)=>{Bt.appendFile("/"+e,t,s=>{if(s){i(s);return}r(t),n(!0)})})),iR=async(e="data",t=()=>{})=>(ai?await Ai(Bt,e.split("/")[0]):await Oi([e.split("/")[0]]),await new Promise(r=>{e!=""?Bt.unlink("/"+e,n=>{n&&console.error(n),t(),r(!0)}):(console.error("Path name is not defined"),r(!1))})),eie=async(e="data",t="end",r=0,n=(i,s)=>{})=>(ai?await Ai(Bt,e.split("/")[0]):await Oi([e.split("/")[0]]),await new Promise(async(i,s)=>{let a=await S0(e);(t==="end"||typeof t=="number"&&t>a)&&(t=a),Bt.open("/"+e,"r",(o,l)=>{if(o){s(o);return}Bt.read(l,t,r,"utf-8",(c,f,u)=>{if(c){s(c);return}if(u!==0){let d=f.toString();Bt.close(l,()=>{n(d,e),i(d)})}else i(void 0)})})})),sR=async(e="data",t=r=>{})=>(ai?await Ai(Bt,e):await Oi([e]),await new Promise((r,n)=>{Bt.readdir("/"+e,(i,s)=>{if(i){n(i);return}s&&t(s),r(s)})})),S0=async(e="data",t=r=>{})=>(ai?await Ai(Bt,e.split("/")[0]):await Oi([e.split("/")[0]]),await new Promise((r,n)=>{Bt.stat("/"+e,(i,s)=>{if(i){n(i);return}let a=s.size;t(a),r(a)})})),x0=async(e="data",t=(r,n)=>{})=>(ai?await Ai(Bt,e.split("/")[0]):await Oi([e.split("/")[0]]),await new Promise((r,n)=>{Bt.open("/"+e,"r",(i,s)=>{if(i){n(i);return}Bt.read(s,65535,0,"utf-8",(a,o,l)=>{if(a){n(a);return}if(l!==0){let u=o.toString().split(`
`)[0];Bt.close(s,()=>{t(u,e),r(u)})}else r(void 0)})})})),aR=async(e="data",t=10)=>(ai?await Ai(Bt,e.split("/")[0]):await Oi([e.split("/")[0]]),await new Promise((r,n)=>{e!=""?Bt.stat("/"+e,(i,s)=>{if(i){n(i);return}let a=s.size;Bt.open(e,"r",(o,l)=>{if(o){n(o);return}let c=0,f=t*1024*1024,u=f;if(a<f)u=a,Bt.read(l,u,0,"utf-8",(d,p,_)=>{if(d){n(d);return}_!==0&&gy.saveCSV(p.toString(),e.split("/")[1]),Bt.close(l),r(!0)});else{let d=async()=>{if(c<a){c+u>a&&(u=a-c);let p=0;Bt.read(l,u,c,"utf-8",(_,w,k)=>{if(_){n(_);return}k!==0&&(gy.saveCSV(w.toString(),e.split("/")[1]+"_"+p),c+=f,p++,d(),Bt.close(l),r(!0))})}}}})}):(console.error("File name is not defined."),r(!1))}));async function tie(e="data",t=(a,o,l,c)=>{},r=1e4,n=0,i="end",s={}){let a=await S0(e),o=n;return await new Promise((l,c)=>{let f=()=>{let u=o+r;u>a&&(u=a),oR(e,o,u,s).then(async d=>{await t(d,o,u,a),o=u,o!==a?f():l(!0)}).catch(c)};f()})}async function oR(e="data",t=0,r="end",n={}){ai?await Ai(Bt,e.split("/")[0]):await Oi([e.split("/")[0]]);let i=n.transpose||!1,s=await x0(e);if(s)s=s.split(",");else return;let a=[],o=[],l=i?[]:{};s.forEach(d=>{d?(o.push(d),a.push(1)):a[a.length-1]++});let c=await S0(e);r==="end"?r=c:r>c&&(t=c-(r-t),r=c);let f=(await nR(e,t,r))?.split(`
`).slice(1,-1),u=d=>{try{d=JSON.parse(d)}catch{}return d};return f&&f.forEach((d,p)=>{let _=d.split(",");if(i){let w={};n.json&&_.forEach((k,S)=>{n.json?w[o[S]]=u(k):w[o[S]]=k}),l.push(w)}else _.forEach((w,k)=>{let S=o[k];l[S]||(l[S]=[]),n.json?l[S].push(u(w)):l[S].push(w)})}),l}var Ad={},Ai=async(e,t)=>(ai||await Oi([t]),await new Promise((r,n)=>{t||n(!1),Ad[t]==="exists"||Ad[t]==="created"?r():(t[0]==="/"&&(t=t.substring(1)),t||n(!1),e.exists(`/${t}`,i=>{i?(Ad[t]="exists",r()):Ad[t]==="creating"?r():(Ad[t]="creating",e.mkdir(`/${t}`,1,s=>{if(s){n(s);return}Ad[t]="created",setTimeout(r,500)}))}))})),PO={initFS:Oi,dirExists:Ai,exists:_0,readFile:Zne,readFileChunk:nR,getFilenames:Qne,writeFile:w0,appendFile:IO,deleteFile:iR,readFileAsText:eie,getFileSize:S0,getCSVHeader:x0,listFiles:sR},Ds={};function rie(e,t,r){return(1-r)*e+r*t}function TO(e,t,r,n=!0){if(r<=2)return[e,t];let i=1/r,s=new Array(r);s[0]=e;for(let a=1;a<=r;a++)s[a]=rie(e,t,i*a),n&&(s[a]=Math.floor(s[a]));return s}var nie=async(e,t,r,n)=>{if(!t){let c=Object.keys(Ds);c.length>0?t=c[c.length-1]:t=`csv${new Date().toISOString()}`}let i=Ds[t];if(!i){let c=Array.from(Object.keys(e));c.indexOf("timestamp")>-1&&c.splice(c.indexOf("timestamp"),1),Ds[t]={header:r||["timestamp","localized",...c],lastX:void 0,buffer:"",buffered:0,bufferSize:n?.bufferSize?n.bufferSize:0,toFixed:n?.toFixed?n.toFixed:0,xIncrement:n?.xIncrement?n.xIncrement:0},i=Ds[t];let f=await x0(t).catch(()=>null);(!f||f!==i.header.join(","))&&(r=i.header)}if(!i.header||i.header?.length===0){let c=Array.from(Object.keys(e));c.indexOf("timestamp")>-1&&c.splice(c.indexOf("timestamp"),1),i.header=r||["timestamp","localized",...c]}else r&&(i.header=r);let s=1;for(let c in e){let f=e[c];i.header.indexOf(c)>-1&&f&&Array.isArray(f)&&f?.length>s&&(s=f?.length)}let a;if(i.xIncrement?i.lastX?e[i.header[2]]?Array.isArray(e[i.header[2]])?a=i.lastX+i.xIncrement*e[i.header[2]].length:a=i.lastX+i.xIncrement:e[i.header[0]]&&Array.isArray(e[i.header[0]])?a=i.lastX+i.xIncrement*e[i.header[0]].length:a=i.lastX+i.xIncrement:typeof e[i.header[0]]<"u"?a=e[i.header[0]]:(i.header[0].toLowerCase().includes("time")||i.header[0].toLowerCase().includes("unix"))&&(a=Date.now()):e[i.header[0]]?a=e[i.header[0]]:a=Date.now(),typeof i.lastX>"u"&&(i.lastX=Array.isArray(a)?a[0]:a),typeof a>"u")if(i.header[0].includes("time")){let c=Date.now();s===1?a=Date.now():(a=TO(i.lastX,c,s),a.shift())}else{let c=i.lastX+1;s>1?(a=new Array(s).fill(""),a[s-1]=c):a=c}else s>1&&a?.length!==s&&(!Array.isArray(a)||a.length===1?(a=TO(i.lastX,a,s,!0),a.shift()):(a=TO(a[0],a[a.length-1],s,!0),a.shift()));let o=[];if(Array.isArray(a)){let c={};for(let f=0;f<a.length;f++){o.push([]);for(let u=0;u<i.header.length;u++){let d=e[i.header[u]];if(u===0){o[f][0]=a[f],i.header[u+1]==="localized"&&(u++,o[f][u]=CO(a[f]));continue}d===void 0?o[f][u]="":Array.isArray(d)?d.length===a.length?o[f][u]=d[f]:i.header[u]in c?d.length===1&&f===a.length-1?o[f][u]=d[c[i.header[u]]]:Math.floor(d.length*f/a.length)>c[i.header[u]]?(c[i.header[u]]++,o[f][u]=d[c[i.header[u]]]):o[f][u]="":(c[i.header[u]]=f,d.length!==1&&(o[f][u]=d[f])):f===a.length-1?o[f][u]=d:o[f][u]="",typeof o[f][u]=="number"&&Math.floor(o[f][u])!==o[f][u]&&(o[f][u]=o[f][u].toFixed(Ds[t].toFixed))}}}else{o.push([]);for(let c=0;c<i.header.length;c++){if(c===0){o[0][0]=a,i.header[c+1]==="localized"&&(c++,o[0][c]=CO(a));continue}i.header[c]in e?o[0][c]=e[i.header[c]]:o[0][c]="",typeof o[0][c]=="number"&&Math.floor(o[0][c])!==o[0][c]&&(o[0][c]=o[0][c].toFixed(Ds[t].toFixed))}}let l="";if(r&&(l+=r.join(",")+`
`),o.forEach(c=>{l+=(n?.json?c.map(f=>JSON.stringify(f)):c).join(",")+`
`,i.bufferSize&&i.buffered++}),i.lastX=o[o.length-1][0],i.bufferSize)if(i.buffer+=l,i.buffered>i.bufferSize){let c=new Promise((f,u)=>{_0(t).then(d=>{d?IO(t,i.buffer,p=>{f(p)}):w0(t,i.buffer,p=>{f(p)})})});return await c,i.buffer="",i.buffered=0,c}else return await Promise.resolve(!0);else return await new Promise((c,f)=>{_0(t).then(u=>{u?IO(t,l,d=>{c(d)}):w0(t,l,d=>{c(d)})})})},iie=(e,t)=>{Ds[t]&&(Ds[t].header=e)},sie=(e,t,r=5,n=0,i)=>{if(!Ds[e])return t?.indexOf("timestamp")>1&&(t.splice(t.indexOf("timestamp"),1),t.unshift("timestamp")),(t?.[0].toLowerCase().includes("time")||t?.[0].toLowerCase().includes("unix"))&&t[1]!=="localized"&&t.splice(1,0,"localized"),Ds[e]={header:t,lastX:t[1]==="localized"?Date.now():0,bufferSize:n,buffer:"",buffered:0,toFixed:r,xIncrement:i},new Promise((s,a)=>{_0(e).then(o=>{o||w0(e,Ds[e].header?Ds[e].header.join(",")+`
`:"",l=>{s(l)}).catch(a)})})},lR=(e,t=document.body)=>new Promise(async(r,n)=>{t.querySelector("#bfs"+e)&&t.querySelector("#bfs"+e)?.remove(),t.insertAdjacentHTML("beforeend",`<div id='bfs${e}' class='bfs${e}'></div>`);let i=t.querySelector("#bfs"+e);await sR(e).then(s=>{s.length===0?i.innerHTML="No Files!":s.forEach(a=>{i?.insertAdjacentHTML("beforeend",`<div id='${a}' class='bfsfilediv'>
                        <span class='bfsfiletitle'>Data: </span>
                        <span>${a}</span>
                        <button class='bfsdownloadbtn' id='download${a}'>Download CSV</button>
                        ${a.indexOf(".")>-1?`<button class='bfsdeletebtn' id='delete${a}'>Delete</button>`:""}
                    </div>`),document.getElementById(`delete${a}`)&&(document.getElementById(`delete${a}`).onclick=()=>{iR(e+"/"+a,()=>{lR(e,t)})}),document.getElementById(`download${a}`)&&(document.getElementById(`download${a}`).onclick=()=>{aR(e+"/"+a,10)})}),r(s)}).catch(n)}),cR={appendCSV:nie,updateCSVHeader:iie,createCSV:sie,visualizeDirectory:lR,openCSV:gy.openCSV,saveCSV:gy.saveCSV,openCSVRaw:gy.openCSVRaw,parseCSVData:NO,getCSVHeader:x0,writeToCSVFromDB:aR,readCSVChunkFromDB:oR,processCSVChunksFromDB:tie,toISOLocal:CO};var aie=Object.create,HO=Object.defineProperty,oie=Object.getOwnPropertyDescriptor,mR=Object.getOwnPropertyNames,lie=Object.getPrototypeOf,cie=Object.prototype.hasOwnProperty,uie=(e,t,r)=>t in e?HO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fie=(e=>typeof ar<"u"?ar:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof ar<"u"?ar:t)[r]}):e)(function(e){if(typeof ar<"u")return ar.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),die=(e,t)=>function(){return t||(0,e[mR(e)[0]])((t={exports:{}}).exports,t),t.exports},pie=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of mR(t))!cie.call(e,i)&&i!==r&&HO(e,i,{get:()=>t[i],enumerable:!(n=oie(t,i))||n.enumerable});return e},hie=(e,t,r)=>(r=e!=null?aie(lie(e)):{},pie(t||!e||!e.__esModule?HO(r,"default",{value:e,enumerable:!0}):r,e)),gie=(e,t,r)=>(uie(e,typeof t!="symbol"?t+"":t,r),r),yie=die({"node_modules/web-worker/cjs/browser.js"(e,t){t.exports=Worker}}),mie=class{data={};triggers={};ctr=0;constructor(e){typeof e=="object"&&(this.data=e)}setState=e=>{Object.assign(this.data,e);let t=Object.getOwnPropertyNames(e);for(let r of t)this.triggerEvent(r,this.data[r]);if(this.triggers[yy]){let r=i=>{i(e)},n=this.triggers[yy].length;for(let i=n-1;i>=0;i--)r(this.triggers[yy][i].onchange)}return this.data};setValue=(e,t)=>{this.data[e]=t,this.triggerEvent(e,t)};triggerEvent=(e,t)=>{if(this.triggers[e]){let r=i=>{i.onchange(t)},n=this.triggers[e].length;for(let i=n-1;i>=0;i--)r(this.triggers[e][i])}};subscribeState=e=>this.subscribeEvent(yy,e);unsubscribeState=e=>this.unsubscribeEvent(yy,e);subscribeEvent=(e,t,r,n)=>{if(e){r&&n&&!this.triggers[e]&&Object.defineProperty(this.data,e,{get:()=>r[n],set:s=>{r[n]=s},enumerable:!0,configurable:!0}),this.triggers[e]||(this.triggers[e]=[]);let i=this.ctr;return this.ctr++,this.triggers[e].push({sub:i,onchange:t}),i}else return};unsubscribeEvent=(e,t)=>{let r=this.triggers[e];if(r)if(t===void 0)delete this.triggers[e],delete this.data[e];else{let n,i=r.find((s,a)=>{if(s.sub===t)return n=a,!0});return i&&r.splice(n,1),Object.keys(r).length===0&&(delete this.triggers[e],delete this.data[e]),this.onRemoved&&this.onRemoved(i),!0}};subscribeEventOnce=(e,t)=>{let r,n=i=>{t(i),this.unsubscribeEvent(e,r)};return r=this.subscribeEvent(e,n),r};getEvent=(e,t)=>{for(let r in this.triggers[e])if(this.triggers[e][r].sub===t)return this.triggers[e][r]};getSnapshot=()=>{let e={};for(let t in this.data)e[t]=this.data[t]};onRemoved},yy="*s",xt=new mie,_r=class{__node={tag:`node${Math.floor(Math.random()*1e15)}`,unique:`${Math.floor(Math.random()*1e15)}`,state:xt};__children;__parent;__operator;__listeners;__props;__args;constructor(e,t,r){this.__setProperties(e,t,r)}__setProperties=(e,t,r)=>{if((()=>{let i=e;typeof e=="function"?RO(e)?e=new e:e={__operator:e,__node:{forward:!0,tag:e.name}}:typeof e=="string"&&r?.get(e)&&(e=r.get(e)),"__node"in e||(e.__node={}),e.__node.initial||(e.__node.initial=i)})(),typeof e=="object"){let i=()=>{e.__node?.state?this.__node.state=e.__node.state:r&&(e.__node.state=r.__node.state)},s=()=>{e.__props&&(typeof e.__props=="function"&&(e.__props=new e.__props),typeof e.__props=="object"&&this.__proxyObject(e.__props))},a=()=>{e.__node.tag||(e.__operator?.name?e.__node.tag=e.__operator.name:e.__node.tag=`node${Math.floor(Math.random()*1e15)}`)},o=()=>{typeof e.__node=="string"?r?.get(e.__node.tag)?e=r.get(e.__node.tag):e.__node={}:e.__node||(e.__node={}),r&&(e.__node.graph=r),e instanceof yu&&(e.__node.source=e)},l=()=>{if(!e.__parent&&t&&(e.__parent=t),t?.__node&&!(t instanceof yu||e instanceof yu)&&(e.__node.tag=t.__node.tag+"."+e.__node.tag),t instanceof yu&&e instanceof yu&&(e.__node.loaders&&Object.assign(t.__node.loaders?t.__node.loaders:{},e.__node.loaders),t.__node.mapGraphs)){e.__node.nodes.forEach(p=>{t.set(e.__node.tag+"."+p.__node.tag,p)});let d=()=>{e.__node.nodes.forEach(p=>{t.__node.nodes.delete(e.__node.tag+"."+p.__node.tag)})};this.__addOndisconnected(d)}},c=()=>{if(typeof e.default=="function"&&!e.__operator&&(e.__operator=e.default),e.__operator){if(typeof e.__operator=="string"&&r){let d=r.get(e.__operator);d&&(e.__operator=d.__operator),!e.__node.tag&&e.__operator.name&&(e.__node.tag=e.__operator.name)}typeof e.__operator=="function"&&(e.__operator=this.__setOperator(e.__operator)),e.default&&(e.default=e.__operator)}},f=()=>{e.__node=Object.assign(this.__node,e.__node);let d=Object.getOwnPropertyNames(e).filter(p=>{if(!UO[p])return!0});for(let p of d)p in e&&(this[p]=e[p])},u=()=>{this.__onconnected&&(typeof this.__onconnected=="function"?this.__onconnected=this.__onconnected.bind(this):Array.isArray(this.__onconnected)&&(this.__onconnected=this.__onconnected.map(d=>d.bind(this))),typeof this.__ondisconnected=="function"?this.__ondisconnected=this.__ondisconnected.bind(this):Array.isArray(this.__ondisconnected)&&(this.__ondisconnected=this.__ondisconnected.map(d=>d.bind(this))))};i(),a(),s(),o(),l(),f(),u(),c()}};__subscribe=(e,t,r,n,i,s)=>{let a=(l,c=(u,d)=>d||u,f=e)=>{let u;if(s){let _=$O(f,s,this.__node.graph);f=_.__callback,u=_.__args}let d=this.__node.state.subscribeEvent(l,f,this,t),p=this.__node.state.getEvent(l,d);return this.__listeners||(this.__listeners={}),this.__listeners[l]=this.__node.state.triggers[l],p&&(p.source=this.__node.tag,t&&(p.key=t),p.target=c(e,n),r&&(p.subInput=r),s&&(p.arguments=s,p.__args=u),i&&(p.tkey=i),p.node=this,p.graph=this.__node.graph),d},o=l=>{let c=this.__node.graph.get(l);if(!c&&l.includes(".")){n=l.substring(0,l.lastIndexOf("."));let f=this.__node.graph.get(l.substring(0,n));i=l.lastIndexOf(".")+1,f&&typeof f[t]=="function"&&(l=(...u)=>f[i](...u))}else c.__operator&&(l=c.__operator,i="__operator")};if(t){if((!this.__node.localState||!this.__node.localState[t])&&this.__addLocalState(this,t),typeof e=="string"){if(i=e,n){if(this.__node.graph?.get(n)){let f=this.__node.graph?.get(n);if(typeof f[e]=="function"){let u=f[e];e=(...d)=>{u(...d)}}else{let u=e;e=p=>{f[u]=p}}}}else if(typeof this[e]=="function"){let f=this[e];e=(...u)=>{f(...u)}}else this.__node.graph?.get(e)&&o(e);if(typeof e!="function")return}let l,c=r?this.__node.unique+"."+t+"input":this.__node.unique+"."+t;return typeof e=="function"?l=a(c,(f,u)=>u||f,e):e?.__node&&(l=a(c,(f,u)=>u||f.__node.unique,(...f)=>{e.__operator&&e.__operator(...f)})),l}else{if(typeof e=="string"&&(this.__node.graph.get(e)&&(e=this.__node.graph.get(e)),i="__operator",typeof e!="object"))return;let l,c=r?this.__node.unique+"input":this.__node.unique;return typeof e=="function"?l=a(c,(f,u)=>u||f,e):e?.__node&&(l=a(c,(f,u)=>u||f.__node.unique,(...f)=>{e.__operator&&e.__operator(...f)})),l}};__unsubscribe=(e,t,r)=>t?this.__node.state.unsubscribeEvent(r?this.__node.unique+"."+t+"input":this.__node.unique+"."+t,e):this.__node.state.unsubscribeEvent(r?this.__node.unique+"input":this.__node.unique,e);__setOperator=e=>{e=e.bind(this),this.__args&&this.__node.graph&&(e=$O(e,this.__args,this.__node.graph).__callback);let t=`${this.__node.unique}input`;if(this.__operator=(...r)=>{this.__node.state.triggers[t]&&this.__node.state.setValue(t,r);let n=e(...r);return this.__node.state.triggers[this.__node.unique]&&(typeof n?.then=="function"?n.then(i=>{i!==void 0&&this.__node.state.setValue(this.__node.unique,i)}).catch(console.error):n!==void 0&&this.__node.state.setValue(this.__node.unique,n)),n},this.__parent instanceof _r&&!this.__subscribedToParent&&this.__parent.__operator){let r=this.__parent.__subscribe(this),n=()=>{this.__parent?.__unsubscribe(r),delete this.__subscribedToParent};this.__addOndisconnected(n),this.__subscribedToParent=!0}return this.__operator};__addLocalState=(e,t)=>{if(!e)return;this.__node.localState||(this.__node.localState={});let r=this.__node.localState,n=(i,s)=>{let a=this.__node.unique+"."+s,o=`${a}input`,l,c,f,u;if(typeof i[s]=="function"&&s!=="__operator")this.__props?.[s]?f=this.__props:f=r,l=()=>f[s],c=d=>{this.__props?.[s]||(d=d.bind(this)),f[s]=(...p)=>{this.__node.state.triggers[o]&&this.__node.state.setValue(o,p);let _=d(...p);return this.__node.state.triggers[a]&&(typeof _?.then=="function"?_.then(w=>{this.__node.state.triggerEvent(a,w)}).catch(console.error):this.__node.state.triggerEvent(a,_)),_}},r[s]=i[s].bind(this),u={get:l,set:c,enumerable:!0,configurable:!0};else{let d,p,_;this.__props?.[s]?_=this.__props:_=r,d=()=>_[s],p=w=>{_[s]=w,this.__node.state.triggers[a]&&this.__node.state.triggerEvent(a,w)},r[s]=i[s],u={get:d,set:p,enumerable:!0,configurable:!0}}if(Object.defineProperty(i,s,u),typeof this.__node.initial=="object"){let d=Object.getOwnPropertyDescriptor(this.__node.initial,s);(d===void 0||d?.configurable)&&Object.defineProperty(this.__node.initial,s,u)}};if(t)n(e,t);else for(let i in e)n(e,i)};__proxyObject=e=>{let t=bie(e);for(let r of t){let n={get:()=>e[r],set:i=>{e[r]=i},enumerable:!0,configurable:!0};if(Object.defineProperty(this,r,n),typeof this.__node.initial=="object"){let i=Object.getOwnPropertyDescriptor(this.__node.initial,r);(i===void 0||i?.configurable)&&Object.defineProperty(this.__node.initial,r,n)}}};__addOnconnected(e){e=e.bind(this),Array.isArray(this.__onconnected)?this.__onconnected.push(e):typeof this.__onconnected=="function"?this.__onconnected=[e,this.__onconnected]:this.__onconnected=e}__addOndisconnected(e){e=e.bind(this),Array.isArray(this.__ondisconnected)?this.__ondisconnected.push(e):typeof this.__ondisconnected=="function"?this.__ondisconnected=[e,this.__ondisconnected]:this.__ondisconnected=e}__callConnected(e=this){if(typeof this.__onconnected=="function")this.__onconnected(this);else if(Array.isArray(this.__onconnected)){let t=r=>{r(this)};this.__onconnected.forEach(t)}}__callDisconnected(e=this){if(typeof this.__ondisconnected=="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let t=r=>{r(this)};this.__ondisconnected.forEach(t)}}},yu=class{__node={tag:`graph${Math.floor(Math.random()*1e15)}`,unique:`${Math.random()}`,nodes:new Map,state:xt,roots:{}};constructor(e){this.init(e)}init=e=>{if(e){let t=Object.assign({},e);delete t.roots,_y(this.__node,t),e.roots&&this.load(e.roots)}};load=e=>{function t(i,s,a=!0,o=!0){if(o&&(i?Object.assign(i,s):i=Object.assign({},s),t(i,s,!0,!1)),s?.__children&&!a)s.__children?.constructor.name==="Object"?i.__children?.constructor.name==="Object"?t(i.__children,s.__children,!0,!1):i.__children=t({},s.__children,!0,!1):i.__children=s.__children;else if(a)for(let l in s)i[l]=Object.assign({},s[l]),s[l]?.__children&&t({},s[l].__children,!1,!1);return i}this.__node.roots=t(this.__node.roots?this.__node.roots:{},e);let r=Object.assign({},e);r.__node&&delete r.__node;let n=this.recursiveSet(r,this,void 0,e);if(e.__node){if(!e.__node.tag)e.__node._tag=`roots${Math.floor(Math.random()*1e15)}`;else if(!this.get(e.__node.tag)){let i=new _r(e,this,this);this.set(i.__node.tag,i),this.runLoaders(i,this,e,e.__node.tag),i.__listeners&&(n[i.__node.tag]=i.__listeners)}}else e.__listeners&&this.setListeners(e.__listeners);return this.setListeners(n),r};setLoaders=(e,t)=>(t?this.__node.loaders=e:Object.assign(this.__node.loaders,e),this.__node.loaders);runLoaders=(e,t,r,n)=>{for(let i in this.__node.loaders)typeof this.__node.loaders[i]=="object"?(this.__node.loaders[i].init&&this.__node.loaders[i](e,t,this,this.__node.roots,r,n),this.__node.loaders[i].connected&&e.__addOnconnected(this.__node.loaders[i].connect),this.__node.loaders[i].disconnected&&e.__addOndisconnected(this.__node.loaders[i].disconnect)):typeof this.__node.loaders[i]=="function"&&this.__node.loaders[i](e,t,this,this.__node.roots,r,n)};add=(e,t)=>{let r={};typeof t=="string"&&(t=this.get(t));let n;if(typeof e=="function"?RO(e)?e.prototype instanceof _r?(e=e.prototype.constructor(e,t,this),n=!0):e=new e:e={__operator:e}:typeof e=="string"&&(e=this.__node.roots[e]),!!e){if(!n){let i=Object.getOwnPropertyNames(e),s=Object.getOwnPropertyNames(Object.getPrototypeOf(e));i.push(...s),i=i.filter(o=>!UO.includes(o));let a={};for(let o of i)a[o]=e[o];e=a}if(e.__node||(e.__node={}),e.__node.initial=e,typeof e=="object"&&!this.get(e.__node.tag)){let i,s=_y({},e,2);if(n?i=e:i=new _r(e,t,this),this.set(i.__node.tag,i),this.runLoaders(i,t,e,i.__node.tag),this.__node.roots[i.__node.tag]=s,i.__children&&(i.__children=Object.assign({},i.__children),this.recursiveSet(i.__children,i,r,i.__children)),i.__listeners){r[i.__node.tag]=Object.assign({},i.__listeners);for(let a in i.__listeners){let o=i.__listeners[a];i[a]&&(delete r[i.__node.tag][a],r[i.__node.tag][i.__node.tag+"."+a]=o),typeof o=="string"&&(i.__children?.[o]?r[i.__node.tag][a]=i.__node.tag+"."+o:t instanceof _r&&(t.__node.tag===o||t.__node.tag.includes(".")&&t.__node.tag.split(".").pop()===o)&&(r[i.__node.tag][a]=t.__node.tag))}}return this.setListeners(r),i.__callConnected(),i}else if(e.__node.tag)return this.get(e.__node.tag)}};recursiveSet=(e,t,r={},n)=>{let i=Object.getOwnPropertyNames(n),s=Object.getOwnPropertyNames(Object.getPrototypeOf(n)).filter(a=>!UO.includes(a));i.push(...s);for(let a of i){if(a.includes("__"))continue;let o=n[a];if(Array.isArray(o))continue;let l;if(typeof o=="function"?RO(o)?(o=new o,o instanceof _r&&(o=o.prototype.constructor(o,t,this),l=!0)):o={__operator:o}:typeof o=="string"?this.__node.nodes.get(o)?o=this.__node.nodes.get(o):o=this.__node.roots[o]:typeof o=="boolean"&&(this.__node.nodes.get(a)?o=this.__node.nodes.get(a):o=this.__node.roots[a]),o instanceof Object){if(!l&&!(o instanceof _r)){let d=Object.getOwnPropertyNames(o),p=Object.getOwnPropertyNames(Object.getPrototypeOf(o));p.splice(p.indexOf("constructor"),1),d.push(...p);let _={};for(let w of d)_[w]=o[w];o=_}if(o.__node||(o.__node={}),o.__node.tag||(o.__node.tag=a),o.__node.initial||(o.__node.initial=e[a]),this.get(o.__node.tag)&&!(!(t instanceof yu)&&t?.__node)||t?.__node&&this.get(t.__node.tag+"."+o.__node.tag))continue;let c,f=!1,u=_y({},o,2);if(l||o instanceof _r?c=o:(c=new _r(o,t,this),f=!0),!f&&o instanceof _r&&!l&&t instanceof _r){let d=this.subscribe(t.__node.tag,c.__node.tag),p=_=>{this.unsubscribe(t.__node.tag,d)};c.__addOndisconnected(p)}else if(c){if(this.set(c.__node.tag,c),this.runLoaders(c,t,e[a],a),e[a]=c,this.__node.roots[c.__node.tag]=u,c.__children&&(c.__children=Object.assign({},c.__children),this.recursiveSet(c.__children,c,r,c.__children)),c.__listeners){r[c.__node.tag]=Object.assign({},c.__listeners);for(let d in c.__listeners){let p=c.__listeners[d],_=d;c[d]&&(delete r[c.__node.tag][d],_=c.__node.tag+"."+d,r[c.__node.tag][_]=p),typeof p=="string"&&(c.__children?.[p]?r[c.__node.tag][_]=c.__node.tag+"."+p:t instanceof _r&&(t.__node.tag===p||t.__node.tag.includes(".")&&t.__node.tag.split(".").pop()===p)&&(r[c.__node.tag][_]=t.__node.tag))}}c.__callConnected()}}}return r};remove=(e,t=!0)=>{if(this.unsubscribe(e),typeof e=="string"&&(e=this.get(e)),e instanceof _r){this.delete(e.__node.tag),delete this.__node.roots[e.__node.tag],t&&this.clearListeners(e),e.__callDisconnected();let r=n=>{for(let i in n)this.unsubscribe(n[i]),this.delete(n[i].__node.tag),delete this.__node.roots[n[i].__node.tag],this.delete(i),delete this.__node.roots[i],n[i].__node.tag=n[i].__node.tag.substring(n[i].__node.tag.lastIndexOf(".")+1),t&&this.clearListeners(n[i]),n[i].__callDisconnected(),n[i].__children&&r(n[i].__children)};e.__children&&r(e.__children)}return e?.__node.tag&&e?.__parent&&(delete e?.__parent,e.__node.tag=e.__node.tag.substring(e.__node.tag.indexOf(".")+1)),e?.__node.graph&&(e.__node.graph=void 0),e};run=(e,...t)=>{if(typeof e=="string"){let r=this.get(e);if(!r&&e.includes(".")){if(r=this.get(e.substring(0,e.lastIndexOf("."))),typeof r?.[e.substring(e.lastIndexOf(".")+1)]=="function")return r[e.substring(e.lastIndexOf(".")+1)](...t)}else if(r?.__operator)return r.__operator(...t)}if(e?.__operator)return e?.__operator(...t)};setListeners=e=>{for(let t in e){let r=this.get(t);if(typeof e[t]=="object")for(let n in e[t]){let i=this.get(n),s;if(typeof e[t][n]!="object")e[t][n]={__callback:e[t][n]};else if(!e[t][n].__callback)for(let a in e[t][n]){typeof e[t][n][a]!="object"&&(e[t][n][a]={__callback:e[t][n][a]},r.__operator&&(e[t][n][a].__callback===!0||typeof e[t][n][a].__callback>"u")&&(e[t][n][a].__callback=r.__operator));let o=this.get(a);if(o)s=this.subscribe(o,e[t][n][a].__callback,e[t][n].__args,void 0,e[t][n].inputState,t,n);else{let l=n.substring(0,n.lastIndexOf("."));if(o=this.get(l),o){let c=n.substring(n.lastIndexOf(".")+1);s=this.subscribe(o,e[t][n][a].__callback,e[t][n][a].__args,c,e[t][n][a].inputState,t,n)}}}if("__callback"in e[t][n])if(r&&((e[t][n].__callback===!0||typeof e[t][n].__callback>"u")&&(e[t][n].__callback=r.__operator),typeof e[t][n].__callback=="function"&&(e[t][n].__callback=e[t][n].__callback.bind(r))),i)s=this.subscribe(i,e[t][n].__callback,e[t][n].__args,void 0,e[t][n].inputState,t,n);else{let a=n.substring(0,n.lastIndexOf("."));i=this.get(a),i&&(s=this.subscribe(i,e[t][n].__callback,e[t][n].__args,n.substring(n.lastIndexOf(".")+1),e[t][n].inputState,t,n))}}}};clearListeners=(e,t)=>{if(typeof e=="string"&&(e=this.get(e)),e?.__listeners)for(let r in e.__listeners){if(t&&r!==t||typeof e.__listeners[r]?.sub!="number")continue;let n=this.get(r);if(n)if(typeof!e.__listeners[r]?.__callback=="number")for(let i in e.__listeners[r])e.__listeners[r][i]?.sub&&(this.unsubscribe(n,e.__listeners[r][i].sub,void 0,e.__listeners[r][i].inputState),e.__listeners[r][i].sub=void 0);else typeof e.__listeners[r]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r].sub,void 0,e.__listeners[r].inputState),e.__listeners[r].sub=void 0);else if(n=this.get(r.substring(0,r.lastIndexOf("."))),n)if(typeof e.__listeners[r]=="object"&&!e.__listeners[r]?.__callback)for(let i in e.__listeners[r])typeof e.__listeners[r][i]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r][i].sub,r.substring(r.lastIndexOf(".")+1),e.__listeners[r][i].inputState),e.__listeners[r][i].sub=void 0);else typeof e.__listeners[r]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r].sub,r.substring(r.lastIndexOf(".")+1),e.__listeners[r].inputState),e.__listeners[r].sub=void 0)}};get=e=>this.__node.nodes.get(e);set=(e,t)=>this.__node.nodes.set(e,t);delete=e=>this.__node.nodes.delete(e);getProps=(e,t)=>{if(typeof e=="string"&&(e=this.get(e)),e instanceof _r){let r;if(t)r=Object.assign({},this.__node.roots[e.__node.tag]);else{r=Object.assign({},e);for(let n in r)n.includes("__")&&delete r[n]}}};subscribe=(e,t,r,n,i,s,a,o)=>{let l=e;if(typeof e=="string"&&(l=this.get(e),!l&&e.includes(".")&&(l=this.get(e.substring(0,e.lastIndexOf("."))),n=e.substring(e.lastIndexOf(".")+1))),s instanceof _r&&(s=s.__node.tag),typeof t=="string"){let f=u=>{if(this.get(u)?.__operator){let d=this.get(u);s=u,u=function(...p){return d.__operator(...p)}}else if(u.includes(".")){s=u.substring(0,u.lastIndexOf("."));let d=this.get(s),p=u.substring(u.lastIndexOf(".")+1);o=p,typeof d[p]=="function"?d[p]instanceof _r?u=d[p]:u=function(..._){return d[p](..._)}:u=function(_){return d[p]=_,d[p]}}return u};if(s){let u=this.get(s);typeof u?.[t]=="function"?(o=t,t=function(...d){return u[n](...d)}):u[n]?(o=n,u[n]instanceof _r?t=u[n]:t=function(d){return u[n]=d,u[n]}):t=f(t)}else t=f(t)}let c;if(l instanceof _r){let f=()=>{c=l.__subscribe(t,n,i,s,o,r);let u=()=>{c!==void 0&&l.__unsubscribe(c,n,i),c=void 0};l.__addOndisconnected(()=>{u(),l.__addOnconnected(()=>{c===void 0&&l.__node.graph.__node.tag===this.__node.tag&&f()})}),typeof t=="string"&&this.get(t)&&(t=this.get(t)),t instanceof _r&&t.__addOndisconnected(()=>{u()})};f()}else if(typeof e=="string"){let f=this.get(e);if(f){if(t instanceof _r&&t.__operator){let u=()=>{c=f.__subscribe(t.__operator,n,i,s,o,r);let d=()=>{c!==void 0&&f.__unsubscribe(c,n,i)};f.__addOndisconnected(()=>{d(),f.__addOnconnected(()=>{c===void 0&&f.__node.graph.__node.tag===this.__node.tag&&u()})}),t.__addOndisconnected(d)};u()}else if(typeof t=="function"||typeof t=="string"){let u=()=>{c=f.__subscribe(t,n,i,s,o,r);let d=()=>{c!==void 0&&f.__unsubscribe(c,n,i),c=void 0};f.__addOndisconnected(()=>{d(),f.__addOnconnected(()=>{c===void 0&&f.__node.graph.__node.tag===this.__node.tag&&u()})}),typeof t=="string"&&this.get(t)&&this.get(t).__addOndisconnected(d)};u()}}else typeof t=="string"&&(t=this.__node.nodes.get(t).__operator),typeof t=="function"&&(c=this.__node.state.subscribeEvent(e,t))}return c};unsubscribe=(e,t,r,n)=>e instanceof _r?e.__unsubscribe(t,r,n):this.get(e)?.__unsubscribe(t,r,n);setState=e=>{this.__node.state.setState(e)}};function _y(e,t,r=1/0,n=0){for(let i in t)t[i]?.constructor.name==="Object"&&n<r?(n++,e[i]?.constructor.name==="Object"?_y(e[i],t[i],r,n):e[i]=_y({},t[i],r,n)):e[i]=t[i];return e}function bie(e){var t=[],r=e;do{var n=Object.getOwnPropertyNames(r);let i=function(s){t.indexOf(s)===-1&&t.push(s)};n.forEach(i)}while(r=Object.getPrototypeOf(r));return t}function RO(e){return vie(e)==="class"}function vie(e){return typeof e=="function"?e.prototype?Object.getOwnPropertyDescriptor(e,"prototype")?.writable?"function":"class":e.constructor.name==="AsyncFunction"?"async":"arrow":""}var k0=(e,t)=>{if(t.get(e)?.__operator){let r=t.get(e);return(...n)=>{r.__operator(...n)}}else if(e.includes(".")){let r=e.split("."),n=r.pop(),i=r.join("."),s=t.get(i);return typeof t.get(i)?.[n]=="function"?(...a)=>s[n](...a):()=>s[n]}else if(t.get(e)){let r=t.get(e);return()=>r}else{let r=e;return()=>r}},$O=(e,t,r)=>{let n=[],i=(a,o)=>{if(a==="__output"||a==="__input"||a==="__callback")n[o]={__callback:l=>l,__args:void 0,idx:o};else if(typeof a=="string")n[o]={__callback:k0(a,r),__args:void 0,idx:o};else if(typeof a=="function"){let l=a;n[o]={__callback:(...c)=>l(...c),__args:void 0,idx:o}}else if(typeof a=="object"&&(a.__input||a.__callback)){let l=function(c){let f=c.__input?c.__input:c.__callback;if(typeof c.__input=="string"&&(f={__callback:k0(c.__input,r),__args:void 0,idx:o}),c.__args){let u=$O(f,c.__args,r);f={__callback:u.__callback,__args:u.__args,idx:o}}else f={__callback:f,__args:void 0,idx:o};if(c.__output){let u=c.__output;if(typeof c.__output=="string"?u={__callback:k0(u,r),__args:void 0,idx:o}:typeof a.__output=="object"&&(u=l(u)),typeof u?.__callback=="function"){let d=f.__callback,p=u.__callback;f={__callback:(..._)=>p(d(..._)),__args:u.__args,idx:o}}}return f};n[o]=l(a)}else{let l=a;n[o]={__callback:()=>l,__args:void 0,idx:o}}};t.forEach(i),typeof e=="string"&&(e={__callback:k0(e,r),__args:void 0});let s=typeof e=="function"?e:e.__callback;return e=function(...a){let o=c=>c.__callback(...a);return s(...n.map(o))},{__callback:e,__args:n}},UO=Object.getOwnPropertyNames(Object.getPrototypeOf({})),_ie=(e,t,r)=>{e.__node.backward&&t instanceof _r&&r.setListeners({[t.__node.tag]:{[e.__node.tag]:t}})},wie=(e,t,r)=>{if(e.__operator&&!e.__node.looperSet){if(typeof e.__node.delay=="number"){let n=e.__operator;e.__setOperator((...i)=>new Promise((s,a)=>{setTimeout(async()=>{s(await n(...i))},e.__node.delay)}))}else if(e.__node.frame===!0){let n=e.__operator;e.__setOperator((...i)=>new Promise((s,a)=>{requestAnimationFrame(async()=>{s(await n(...i))})}))}if(typeof e.__node.repeat=="number"||typeof e.__node.recursive=="number"){let n=e.__operator;e.__setOperator(async(...i)=>{let s=e.__node.repeat?e.__node.repeat:e.__node.recursive,a,o=async(l,...c)=>{for(;l>0;){if(e.__node.delay||e.__node.frame){n(...c).then(async f=>{e.__node.recursive?await o(l,f):await o(l,...c)});break}else a=await n(...i);l--}};return await o(s,...i),a})}if(e.__node.loop&&typeof e.__node.loop=="number"){e.__node.looperSet=!0;let n=e.__operator,i=e.__node.loop;e.__setOperator((...a)=>{if("looping"in e.__node||(e.__node.looping=!0),e.__node.looping){let o=performance.now();n(...a),setTimeout(()=>{let c=performance.now()-o-e.__node.loop;c>0?i=e.__node.loop-c:i=e.__node.loop,i<=0&&(i=e.__node.loop),e.__operator(...a)},i)}}),e.__node.looping&&e.__operator();let s=a=>{a.__node.looping&&(a.__node.looping=!1)};e.__addOndisconnected(s)}}},Sie=(e,t,r)=>{if(e.__node.animate===!0||e.__animation){let n=e.__operator;e.__setOperator((...s)=>{"animating"in e.__node||(e.__node.animating=!0),e.__node.animating&&(typeof e.__animation=="function"?e.__animation(...s):n(...s),requestAnimationFrame(()=>{e.__operator(...s)}))}),(e.__node.animating||(!("animating"in e.__node)||e.__node.animating)&&e.__animation)&&setTimeout(()=>{requestAnimationFrame(e.__operator)},10);let i=s=>{s.__node.animating&&(s.__node.animating=!1)};e.__addOndisconnected(i)}},xie=(e,t,r)=>{if(typeof e.__branch=="object"&&e.__operator&&!e.__branchApplied){let n=e.__operator;e.__branchApplied=!0,e.__operator=(...i)=>{let s=n(...i);for(let a in e.__branch){let o=()=>{typeof e.__branch[a].then=="function"?e.__branch[a].then(s):e.__branch[a].then instanceof _r&&e.__branch[a].then.__operator?e.__branch[a].then.__operator(s):s=e.__branch[a].then};typeof e.__branch[a].if=="function"?e.__branch[a].if(s)==!0&&o():e.__branch[a].if===s&&o()}return s}}if(e.__listeners){for(let n in e.__listeners)if(typeof e.__listeners[n]=="object"&&e.__listeners[n].branch&&!e.__listeners[n].branchApplied){let i=e.__listeners[n].callback;e.__listeners[n].branchApplied=!0,e.__listeners.callback=s=>{let a=()=>{typeof e.__listeners[n].branch.then=="function"?s=e.__listeners[n].branch.then(s):e.__listeners[n].branch.then instanceof _r&&e.__listeners[n].branch.then.__operator?s=e.__listeners[n].branch.then.__operator(s):s=e.__listeners[n].branch.then};return typeof e.__listeners[n].branch.if=="function"?e.__listeners[n].branch.if(s)&&a():e.__listeners[n].branch.if===s&&a(),i(s)}}}},kie=(e,t,r)=>{if(e.__listeners)for(let n in e.__listeners)typeof e.__listeners[n]=="object"&&e.__listeners[n].oncreate&&e.__listeners[n].callback(e.__listeners[n].oncreate)},Eie=(e,t,r)=>{if(e.__listeners)for(let n in e.__listeners)typeof e.__listeners[n]=="object"&&typeof e.__listeners[n].binding=="object"&&(e.__listeners.callback=e.__listeners.callback.bind(e.__listeners[n].binding))},Oie=(e,t,r)=>{if(e.__listeners){for(let n in e.__listeners)if(typeof e.__listeners[n]=="object"&&typeof e.__listeners[n].transform=="function"&&!e.__listeners[n].transformApplied){let i=e.__listeners[n].callback;e.__listeners[n].transformApplied=!0,e.__listeners.callback=s=>(s=e.__listeners[n].transform(s),i(s))}}},Aie=(e,t,r)=>{e.post&&!e.__operator?e.__setOperator(e.post):!e.__operator&&typeof e.get=="function"&&e.__setOperator(e.get),!e.get&&e.__operator&&(e.get=e.__operator),e.aliases&&e.aliases.forEach(n=>{r.set(n,e);let i=s=>{r.__node.nodes.delete(n)};e.__addOndisconnected(i)}),typeof r.__node.roots?.[e.__node.tag]=="object"&&e.get&&(r.__node.roots[e.__node.tag].get=e.get)},uR={backprop:_ie,loop:wie,animate:Sie,branching:xie,triggerListenerOncreate:kie,bindListener:Eie,transformListenerResult:Oie,substitute__operator:Aie};var Tie=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(a,o){var l=t.length-1,c=t[l];if(typeof c=="object")if(c[a]===o||l===0)r.push(a),t.push(o.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[a]===o){l+=2,t.length=l,r.length=l,--l,t[l]=o,r[l]=a;break}l--}}function s(a,o){if(o!=null&&typeof o=="object"){a&&i(a,o);let l=e.get(o);if(l)return"[Circular Reference]"+l;e.set(o,r.join("."))}return o}return function(o,l){try{return t.push(o),JSON.stringify(o,s,l)}finally{n()}}}();JSON.stringifyWithCircularRefs===void 0&&(JSON.stringifyWithCircularRefs=Tie);var Cie=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(a,o){var l=t.length-1;if(t[l]){var c=t[l];if(typeof c=="object")if(c[a]===o||l===0)r.push(a),t.push(o.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[a]===o){l+=2,t.length=l,r.length=l,--l,t[l]=o,r[l]=a;break}l++}}}function s(a,o){let l;if(o!=null)if(typeof o=="object"){let c=o.constructor.name;a&&c==="Object"&&i(a,o);let f=e.get(o);if(f)return"[Circular Reference]"+f;if(e.set(o,r.join(".")),c==="Array")o.length>20?l=o.slice(o.length-20):l=o;else if(c.includes("Set"))l=Array.from(o);else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean")l="instanceof_"+c;else if(c==="Object"){let u={};for(let d in o)if(o[d]==null)u[d]=o[d];else if(Array.isArray(o[d]))o[d].length>20?u[d]=o[d].slice(o[d].length-20):u[d]=o[d];else if(o[d].constructor.name==="Object"){u[d]={};for(let p in o[d])if(Array.isArray(o[d][p]))o[d][p].length>20?u[d][p]=o[d][p].slice(o[d][p].length-20):u[d][p]=o[d][p];else if(o[d][p]!=null){let _=o[d][p].constructor.name;_.includes("Set")?u[d][p]=Array.from(o[d][p]):_!=="Number"&&_!=="String"&&_!=="Boolean"?u[d][p]="instanceof_"+_:u[d][p]=o[d][p]}else u[d][p]=o[d][p]}else{let p=o[d].constructor.name;p.includes("Set")?u[d]=Array.from(o[d]):p!=="Number"&&p!=="String"&&p!=="Boolean"?u[d]="instanceof_"+p:u[d]=o[d]}l=u}else l=o}else l=o;return l}return function(o,l){t.push(o);let c=JSON.stringify(o,s,l);return n(),c}}();JSON.stringifyFast===void 0&&(JSON.stringifyFast=Cie);var Iie=class extends yu{name=`service${Math.floor(Math.random()*1e15)}`;constructor(e){super({...e,loaders:e?.loaders?Object.assign({...uR},e.loaders):{...uR}}),e?.services&&this.addServices(e.services),this.load(this)}addServices=e=>{for(let t in e)if(typeof e[t]=="function"&&(e[t]=new e[t]),e[t]?.__node?.loaders&&Object.assign(this.__node.loaders,e[t].__node.loaders),e[t]?.__node?.nodes){e[t].__node.nodes.forEach((i,s)=>{this.get(s)?this.set(t+"."+s,i):this.set(s,i)}),this.__node.nodes.forEach((i,s)=>{e[t].__node.nodes.get(s)||e[t].__node.nodes.set(s,i)});let r=this.set;this.set=(i,s)=>(e[t].set(i,s),r(i,s));let n=this.delete;this.delete=i=>(e[t].delete(i),n(i))}else typeof e[t]=="object"&&this.load(e[t])};handleMethod=(e,t,r)=>{let n=t.toLowerCase(),i=this.__node.nodes.get(e);if(i||(i=this.__node.roots[e]),i?.[n])if(typeof i[n]!="function"){if(r){Array.isArray(r)&&r.length===1?i[n]=r[0]:i[n]=r;return}return i[n]}else return Array.isArray(r)?i[n](...r):i[n](r);else return this.handleServiceMessage({route:e,args:r,method:t})};handleServiceMessage(e){let t;return typeof e=="object"&&(e.route?t=e.route:e.node&&(t=e.node)),t?Array.isArray(e.args)?this.run(t,...e.args):this.run(t,e.args):e}handleGraphNodeCall(e,t){if(!e)return t;if(t?.args)this.handleServiceMessage(t);else return Array.isArray(t)?this.run(e,...t):this.run(e,t)}transmit=(...e)=>typeof e[0]=="object"?e[0].method?this.handleMethod(e[0].route,e[0].method,e[0].args):e[0].route?this.handleServiceMessage(e[0]):e[0].node?this.handleGraphNodeCall(e[0].node,e[0].args):(this.__node.keepState&&(e[0].route&&this.setState({[e[0].route]:e[0].args}),e[0].node&&this.setState({[e[0].node]:e[0].args})),e):e;receive=(...e)=>{if(e[0]&&typeof e[0]=="string"){let t=e[0].substring(0,8);(t.includes("{")||t.includes("["))&&(t.includes("\\")&&(e[0]=e[0].replace(/\\/g,"")),e[0][0]==='"'&&(e[0]=e[0].substring(1,e[0].length-1)),e[0]=JSON.parse(e[0]))}return typeof e[0]=="object"?e[0].method?this.handleMethod(e[0].route,e[0].method,e[0].args):e[0].route?this.handleServiceMessage(e[0]):e[0].node?this.handleGraphNodeCall(e[0].node,e[0].args):(this.__node.keepState&&(e[0].route&&this.setState({[e[0].route]:e[0].args}),e[0].node&&this.setState({[e[0].node]:e[0].args})),e):e};pipe=(e,t,r,n,i)=>{if(e instanceof _r)return i?this.subscribe(e,s=>{let a=i(s);a!==void 0?this.transmit({route:t,args:a,method:n}):this.transmit({route:t,args:s,method:n},r)}):this.subscribe(e,s=>{this.transmit({route:t,args:s,method:n},r)});if(typeof e=="string")return this.subscribe(e,s=>{this.transmit({route:t,args:s,method:n},r)})};pipeOnce=(e,t,r,n,i)=>{if(e instanceof _r)return i?e.__node.state.subscribeEventOnce(e.__node.unique,s=>{let a=i(s);a!==void 0?this.transmit({route:t,args:a,method:n}):this.transmit({route:t,args:s,method:n},r)}):this.__node.state.subscribeEventOnce(e.__node.unique,s=>{this.transmit({route:t,args:s,method:n},r)});if(typeof e=="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(e).__node.unique,s=>{this.transmit({route:t,args:s,method:n},r)})};terminate=(...e)=>{};isTypedArray=Nie;recursivelyAssign=zO;spliceTypedArray=Pie;ping=()=>(console.log("pinged!"),"pong");echo=(...e)=>(this.transmit(...e),e);log=(...e)=>(console.log(...e),!0);error=(...e)=>(console.error(...e),!0)};function Nie(e){return ArrayBuffer.isView(e)&&Object.prototype.toString.call(e)!=="[object DataView]"}var zO=(e,t)=>{for(let r in t)t[r]?.constructor.name==="Object"&&!Array.isArray(t[r])?e[r]?.constructor.name==="Object"&&!Array.isArray(e[r])?zO(e[r],t[r]):e[r]=zO({},t[r]):e[r]=t[r];return e};function Pie(e,t,r){let n=e.subarray(0,t),i;r&&(i=e.subarray(r+1));let s;return(n.length>0||i?.length>0)&&(s=new e.constructor(n.length+i.length)),s&&(n.length>0&&s.set(n),i&&i.length>0&&s.set(i,n.length)),s}function Lie(e,...t){return function(n=document.createElement("div")){let i=document.createElement("template");e.map(function(o,l){if(i.innerHTML+=o,t[l]instanceof HTMLElement){let c='<span id="dummyNode12345"></span>';c.id="dummyNode12345",i.innerHTML+=c}else i.innerHTML+=t[l]});let s=i.content.querySelectorAll("#dummyNode12345"),a=0;return t.forEach((o,l)=>{o instanceof HTMLElement&&(console.log(o,s[a]),i.content.replaceChild(o,s[a]),a++)}),n.appendChild(i.content),n}}var NLe=Lie``;var ge={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};ge.cipher.aes=function(e){this.s[0][0][0]||this.O();var t,r,n,i,s=this.s[0][4],a=this.s[1];t=e.length;var o=1;if(t!==4&&t!==6&&t!==8)throw new ge.exception.invalid("invalid aes key size");for(this.b=[n=e.slice(0),i=[]],e=t;e<4*t+28;e++)r=n[e-1],(e%t===0||t===8&&e%t===4)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[r&255],e%t===0&&(r=r<<8^r>>>24^o<<24,o=o<<1^283*(o>>7))),n[e]=n[e-t]^r;for(t=0;e;t++,e--)r=n[t&3?e:e-4],i[t]=4>=e||4>t?r:a[0][s[r>>>24]]^a[1][s[r>>16&255]]^a[2][s[r>>8&255]]^a[3][s[r&255]]};ge.cipher.aes.prototype={encrypt:function(e){return fR(this,e,0)},decrypt:function(e){return fR(this,e,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var e=this.s[0],t=this.s[1],r=e[4],n=t[4],i,s,a,o=[],l=[],c,f,u,d;for(i=0;256>i;i++)l[(o[i]=i<<1^283*(i>>7))^i]=i;for(s=a=0;!r[s];s^=c||1,a=l[a]||1)for(u=a^a<<1^a<<2^a<<3^a<<4,u=u>>8^u&255^99,r[s]=u,n[u]=s,f=o[i=o[c=o[s]]],d=16843009*f^65537*i^257*c^16843008*s,f=257*o[u]^16843008*u,i=0;4>i;i++)e[i][s]=f=f<<24^f>>>8,t[i][u]=d=d<<24^d>>>8;for(i=0;5>i;i++)e[i]=e[i].slice(0),t[i]=t[i].slice(0)}};function fR(e,t,r){if(t.length!==4)throw new ge.exception.invalid("invalid aes block size");var n=e.b[r],i=t[0]^n[0],s=t[r?3:1]^n[1],a=t[2]^n[2];t=t[r?1:3]^n[3];var o,l,c,f=n.length/4-2,u,d=4,p=[0,0,0,0];o=e.s[r],e=o[0];var _=o[1],w=o[2],k=o[3],S=o[4];for(u=0;u<f;u++)o=e[i>>>24]^_[s>>16&255]^w[a>>8&255]^k[t&255]^n[d],l=e[s>>>24]^_[a>>16&255]^w[t>>8&255]^k[i&255]^n[d+1],c=e[a>>>24]^_[t>>16&255]^w[i>>8&255]^k[s&255]^n[d+2],t=e[t>>>24]^_[i>>16&255]^w[s>>8&255]^k[a&255]^n[d+3],d+=4,i=o,s=l,a=c;for(u=0;4>u;u++)p[r?3&-u:u]=S[i>>>24]<<24^S[s>>16&255]<<16^S[a>>8&255]<<8^S[t&255]^n[d++],o=i,i=s,s=a,a=t,t=o;return p}ge.bitArray={bitSlice:function(e,t,r){return e=ge.bitArray.$(e.slice(t/32),32-(t&31)).slice(1),r===void 0?e:ge.bitArray.clamp(e,r-t)},extract:function(e,t,r){var n=Math.floor(-t-r&31);return((t+r-1^t)&-32?e[t/32|0]<<32-n^e[t/32+1|0]>>>n:e[t/32|0]>>>n)&(1<<r)-1},concat:function(e,t){if(e.length===0||t.length===0)return e.concat(t);var r=e[e.length-1],n=ge.bitArray.getPartial(r);return n===32?e.concat(t):ge.bitArray.$(t,n,r|0,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return t===0?0:32*(t-1)+ge.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;e=e.slice(0,Math.ceil(t/32));var r=e.length;return t=t&31,0<r&&t&&(e[r-1]=ge.bitArray.partial(t,e[r-1]&2147483648>>t-1,1)),e},partial:function(e,t,r){return e===32?t:(r?t|0:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(ge.bitArray.bitLength(e)!==ge.bitArray.bitLength(t))return!1;var r=0,n;for(n=0;n<e.length;n++)r|=e[n]^t[n];return r===0},$:function(e,t,r,n){var i;for(i=0,n===void 0&&(n=[]);32<=t;t-=32)n.push(r),r=0;if(t===0)return n.concat(e);for(i=0;i<e.length;i++)n.push(r|e[i]>>>t),r=e[i]<<32-t;return i=e.length?e[e.length-1]:0,e=ge.bitArray.getPartial(i),n.push(ge.bitArray.partial(t+e&31,32<t+e?r:n.pop(),1)),n},i:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,r;for(t=0;t<e.length;++t)r=e[t],e[t]=r>>>24|r>>>8&65280|(r&65280)<<8|r<<24;return e}};ge.codec.utf8String={fromBits:function(e){var t="",r=ge.bitArray.bitLength(e),n,i;for(n=0;n<r/8;n++)!(n&3)&&(i=e[n/4]),t+=String.fromCharCode(i>>>8>>>8>>>8),i<<=8;return decodeURIComponent(escape(t))},toBits:function(e){e=unescape(encodeURIComponent(e));var t=[],r,n=0;for(r=0;r<e.length;r++)n=n<<8|e.charCodeAt(r),(r&3)===3&&(t.push(n),n=0);return r&3&&t.push(ge.bitArray.partial(8*(r&3),n)),t}};ge.codec.hex={fromBits:function(e){var t="",r;for(r=0;r<e.length;r++)t+=((e[r]|0)+0xf00000000000).toString(16).substr(4);return t.substr(0,ge.bitArray.bitLength(e)/4)},toBits:function(e){var t,r=[],n;for(e=e.replace(/\s|0x/g,""),n=e.length,e=e+"00000000",t=0;t<e.length;t+=8)r.push(parseInt(e.substr(t,8),16)^0);return ge.bitArray.clamp(r,4*n)}};ge.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(e,t,r){var n=ge.codec.base32.BASE,i=ge.codec.base32.REMAINING,s="",a=0,o=ge.codec.base32.B,l=0,c=ge.bitArray.bitLength(e);for(r&&(o=ge.codec.base32.X),r=0;s.length*n<c;)s+=o.charAt((l^e[r]>>>a)>>>i),a<n?(l=e[r]<<n-a,a+=i,r++):(l<<=n,a-=n);for(;s.length&7&&!t;)s+="=";return s},toBits:function(e,t){e=e.replace(/\s|=/g,"").toUpperCase();var r=ge.codec.base32.BITS,n=ge.codec.base32.BASE,i=ge.codec.base32.REMAINING,s=[],a,o=0,l=ge.codec.base32.B,c=0,f,u="base32";for(t&&(l=ge.codec.base32.X,u="base32hex"),a=0;a<e.length;a++){if(f=l.indexOf(e.charAt(a)),0>f){if(!t)try{return ge.codec.base32hex.toBits(e)}catch{}throw new ge.exception.invalid("this isn't "+u+"!")}o>i?(o-=i,s.push(c^f>>>o),c=f<<r-o):(o+=n,c^=f<<r-o)}return o&56&&s.push(ge.bitArray.partial(o&56,c,1)),s}};ge.codec.base32hex={fromBits:function(e,t){return ge.codec.base32.fromBits(e,t,1)},toBits:function(e){return ge.codec.base32.toBits(e,1)}};ge.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,r){var n="",i=0,s=ge.codec.base64.B,a=0,o=ge.bitArray.bitLength(e);for(r&&(s=s.substr(0,62)+"-_"),r=0;6*n.length<o;)n+=s.charAt((a^e[r]>>>i)>>>26),6>i?(a=e[r]<<6-i,i+=26,r++):(a<<=6,i-=6);for(;n.length&3&&!t;)n+="=";return n},toBits:function(e,t){e=e.replace(/\s|=/g,"");var r=[],n,i=0,s=ge.codec.base64.B,a=0,o;for(t&&(s=s.substr(0,62)+"-_"),n=0;n<e.length;n++){if(o=s.indexOf(e.charAt(n)),0>o)throw new ge.exception.invalid("this isn't base64!");26<i?(i-=26,r.push(a^o>>>i),a=o<<32-i):(i+=6,a^=o<<32-i)}return i&56&&r.push(ge.bitArray.partial(i&56,a,1)),r}};ge.codec.base64url={fromBits:function(e){return ge.codec.base64.fromBits(e,1,1)},toBits:function(e){return ge.codec.base64.toBits(e,1)}};ge.hash.sha256=function(e){this.b[0]||this.O(),e?(this.F=e.F.slice(0),this.A=e.A.slice(0),this.l=e.l):this.reset()};ge.hash.sha256.hash=function(e){return new ge.hash.sha256().update(e).finalize()};ge.hash.sha256.prototype={blockSize:512,reset:function(){return this.F=this.Y.slice(0),this.A=[],this.l=0,this},update:function(e){typeof e=="string"&&(e=ge.codec.utf8String.toBits(e));var t,r=this.A=ge.bitArray.concat(this.A,e);if(t=this.l,e=this.l=t+ge.bitArray.bitLength(e),9007199254740991<e)throw new ge.exception.invalid("Cannot hash more than 2^53 - 1 bits");if(typeof Uint32Array<"u"){var n=new Uint32Array(r),i=0;for(t=512+t-(512+t&511);t<=e;t+=512)LO(this,n.subarray(16*i,16*(i+1))),i+=1;r.splice(0,16*i)}else for(t=512+t-(512+t&511);t<=e;t+=512)LO(this,r.splice(0,16));return this},finalize:function(){var e,r=this.A,t=this.F,r=ge.bitArray.concat(r,[ge.bitArray.partial(1,1)]);for(e=r.length+2;e&15;e++)r.push(0);for(r.push(Math.floor(this.l/4294967296)),r.push(this.l|0);r.length;)LO(this,r.splice(0,16));return this.reset(),t},Y:[],b:[],O:function(){function e(s){return 4294967296*(s-Math.floor(s))|0}for(var t=0,r=2,n,i;64>t;r++){for(i=!0,n=2;n*n<=r;n++)if(r%n===0){i=!1;break}i&&(8>t&&(this.Y[t]=e(Math.pow(r,.5))),this.b[t]=e(Math.pow(r,1/3)),t++)}}};function LO(e,t){var r,n,i,s=e.F,a=e.b,o=s[0],l=s[1],c=s[2],f=s[3],u=s[4],d=s[5],p=s[6],_=s[7];for(r=0;64>r;r++)16>r?n=t[r]:(n=t[r+1&15],i=t[r+14&15],n=t[r&15]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+t[r&15]+t[r+9&15]|0),n=n+_+(u>>>6^u>>>11^u>>>25^u<<26^u<<21^u<<7)+(p^u&(d^p))+a[r],_=p,p=d,d=u,u=f+n|0,f=c,c=l,l=o,o=n+(l&c^f&(l^c))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;s[0]=s[0]+o|0,s[1]=s[1]+l|0,s[2]=s[2]+c|0,s[3]=s[3]+f|0,s[4]=s[4]+u|0,s[5]=s[5]+d|0,s[6]=s[6]+p|0,s[7]=s[7]+_|0}ge.mode.ccm={name:"ccm",G:[],listenProgress:function(e){ge.mode.ccm.G.push(e)},unListenProgress:function(e){e=ge.mode.ccm.G.indexOf(e),-1<e&&ge.mode.ccm.G.splice(e,1)},fa:function(e){var t=ge.mode.ccm.G.slice(),r;for(r=0;r<t.length;r+=1)t[r](e)},encrypt:function(e,t,r,n,i){var s,a=t.slice(0),o=ge.bitArray,l=o.bitLength(r)/8,c=o.bitLength(a)/8;if(i=i||64,n=n||[],7>l)throw new ge.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;4>s&&c>>>8*s;s++);return s<15-l&&(s=15-l),r=o.clamp(r,8*(15-s)),t=ge.mode.ccm.V(e,t,r,n,i,s),a=ge.mode.ccm.C(e,a,r,t,i,s),o.concat(a.data,a.tag)},decrypt:function(e,t,r,n,i){i=i||64,n=n||[];var s=ge.bitArray,a=s.bitLength(r)/8,c=s.bitLength(t),o=s.clamp(t,c-i),l=s.bitSlice(t,c-i),c=(c-i)/8;if(7>a)throw new ge.exception.invalid("ccm: iv must be at least 7 bytes");for(t=2;4>t&&c>>>8*t;t++);if(t<15-a&&(t=15-a),r=s.clamp(r,8*(15-t)),o=ge.mode.ccm.C(e,o,r,l,i,t),e=ge.mode.ccm.V(e,o.data,r,n,i,t),!s.equal(o.tag,e))throw new ge.exception.corrupt("ccm: tag doesn't match");return o.data},na:function(e,t,r,n,i,s){var a=[],o=ge.bitArray,l=o.i;if(n=[o.partial(8,(t.length?64:0)|n-2<<2|s-1)],n=o.concat(n,r),n[3]|=i,n=e.encrypt(n),t.length)for(r=o.bitLength(t)/8,65279>=r?a=[o.partial(16,r)]:4294967295>=r&&(a=o.concat([o.partial(16,65534)],[r])),a=o.concat(a,t),t=0;t<a.length;t+=4)n=e.encrypt(l(n,a.slice(t,t+4).concat([0,0,0])));return n},V:function(e,t,r,n,i,s){var a=ge.bitArray,o=a.i;if(i/=8,i%2||4>i||16<i)throw new ge.exception.invalid("ccm: invalid tag length");if(4294967295<n.length||4294967295<t.length)throw new ge.exception.bug("ccm: can't deal with 4GiB or more data");for(r=ge.mode.ccm.na(e,n,r,i,a.bitLength(t)/8,s),n=0;n<t.length;n+=4)r=e.encrypt(o(r,t.slice(n,n+4).concat([0,0,0])));return a.clamp(r,8*i)},C:function(e,t,r,n,i,s){var a,o=ge.bitArray;a=o.i;var l=t.length,c=o.bitLength(t),f=l/50,u=f;if(r=o.concat([o.partial(8,s-1)],r).concat([0,0,0]).slice(0,4),n=o.bitSlice(a(n,e.encrypt(r)),0,i),!l)return{tag:n,data:[]};for(a=0;a<l;a+=4)a>f&&(ge.mode.ccm.fa(a/l),f+=u),r[3]++,i=e.encrypt(r),t[a]^=i[0],t[a+1]^=i[1],t[a+2]^=i[2],t[a+3]^=i[3];return{tag:n,data:o.clamp(t,c)}}};ge.mode.ocb2={name:"ocb2",encrypt:function(e,t,r,n,i,s){if(ge.bitArray.bitLength(r)!==128)throw new ge.exception.invalid("ocb iv must be 128 bits");var a,o=ge.mode.ocb2.S,l=ge.bitArray,c=l.i,f=[0,0,0,0];r=o(e.encrypt(r));var u,d=[];for(n=n||[],i=i||64,a=0;a+4<t.length;a+=4)u=t.slice(a,a+4),f=c(f,u),d=d.concat(c(r,e.encrypt(c(r,u)))),r=o(r);return u=t.slice(a),t=l.bitLength(u),a=e.encrypt(c(r,[0,0,0,t])),u=l.clamp(c(u.concat([0,0,0]),a),t),f=c(f,c(u.concat([0,0,0]),a)),f=e.encrypt(c(f,c(r,o(r)))),n.length&&(f=c(f,s?n:ge.mode.ocb2.pmac(e,n))),d.concat(l.concat(u,l.clamp(f,i)))},decrypt:function(e,t,r,n,i,s){if(ge.bitArray.bitLength(r)!==128)throw new ge.exception.invalid("ocb iv must be 128 bits");i=i||64;var a=ge.mode.ocb2.S,o=ge.bitArray,l=o.i,c=[0,0,0,0],f=a(e.encrypt(r)),u,d,p=ge.bitArray.bitLength(t)-i,_=[];for(n=n||[],r=0;r+4<p/32;r+=4)u=l(f,e.decrypt(l(f,t.slice(r,r+4)))),c=l(c,u),_=_.concat(u),f=a(f);if(d=p-32*r,u=e.encrypt(l(f,[0,0,0,d])),u=l(u,o.clamp(t.slice(r),d).concat([0,0,0])),c=l(c,u),c=e.encrypt(l(c,l(f,a(f)))),n.length&&(c=l(c,s?n:ge.mode.ocb2.pmac(e,n))),!o.equal(o.clamp(c,i),o.bitSlice(t,p)))throw new ge.exception.corrupt("ocb: tag doesn't match");return _.concat(o.clamp(u,d))},pmac:function(e,t){var r,n=ge.mode.ocb2.S,i=ge.bitArray,s=i.i,a=[0,0,0,0],o=e.encrypt([0,0,0,0]),o=s(o,n(n(o)));for(r=0;r+4<t.length;r+=4)o=n(o),a=s(a,e.encrypt(s(o,t.slice(r,r+4))));return r=t.slice(r),128>i.bitLength(r)&&(o=s(o,n(o)),r=i.concat(r,[-2147483648,0,0,0])),a=s(a,r),e.encrypt(s(n(s(o,n(o))),a))},S:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}};ge.mode.gcm={name:"gcm",encrypt:function(e,t,r,n,i){var s=t.slice(0);return t=ge.bitArray,n=n||[],e=ge.mode.gcm.C(!0,e,s,n,r,i||128),t.concat(e.data,e.tag)},decrypt:function(e,t,r,n,i){var s=t.slice(0),a=ge.bitArray,o=a.bitLength(s);if(i=i||128,n=n||[],i<=o?(t=a.bitSlice(s,o-i),s=a.bitSlice(s,0,o-i)):(t=s,s=[]),e=ge.mode.gcm.C(!1,e,s,n,r,i),!a.equal(e.tag,t))throw new ge.exception.corrupt("gcm: tag doesn't match");return e.data},ka:function(e,t){var r,n,i,s,a,o=ge.bitArray.i;for(i=[0,0,0,0],s=t.slice(0),r=0;128>r;r++){for((n=(e[Math.floor(r/32)]&1<<31-r%32)!==0)&&(i=o(i,s)),a=(s[3]&1)!==0,n=3;0<n;n--)s[n]=s[n]>>>1|(s[n-1]&1)<<31;s[0]>>>=1,a&&(s[0]^=-520093696)}return i},j:function(e,t,r){var n,i=r.length;for(t=t.slice(0),n=0;n<i;n+=4)t[0]^=4294967295&r[n],t[1]^=4294967295&r[n+1],t[2]^=4294967295&r[n+2],t[3]^=4294967295&r[n+3],t=ge.mode.gcm.ka(t,e);return t},C:function(e,t,r,n,i,s){var a,o,l,c,f,u,d,p,_=ge.bitArray;for(u=r.length,d=_.bitLength(r),p=_.bitLength(n),o=_.bitLength(i),a=t.encrypt([0,0,0,0]),o===96?(i=i.slice(0),i=_.concat(i,[1])):(i=ge.mode.gcm.j(a,[0,0,0,0],i),i=ge.mode.gcm.j(a,i,[0,0,Math.floor(o/4294967296),o&4294967295])),o=ge.mode.gcm.j(a,[0,0,0,0],n),f=i.slice(0),n=o.slice(0),e||(n=ge.mode.gcm.j(a,o,r)),c=0;c<u;c+=4)f[3]++,l=t.encrypt(f),r[c]^=l[0],r[c+1]^=l[1],r[c+2]^=l[2],r[c+3]^=l[3];return r=_.clamp(r,d),e&&(n=ge.mode.gcm.j(a,o,r)),e=[Math.floor(p/4294967296),p&4294967295,Math.floor(d/4294967296),d&4294967295],n=ge.mode.gcm.j(a,n,e),l=t.encrypt(i),n[0]^=l[0],n[1]^=l[1],n[2]^=l[2],n[3]^=l[3],{tag:_.bitSlice(n,0,s),data:r}}};ge.misc.hmac=function(e,t){this.W=t=t||ge.hash.sha256;var r=[[],[]],n,i=t.prototype.blockSize/32;for(this.w=[new t,new t],e.length>i&&(e=t.hash(e)),n=0;n<i;n++)r[0][n]=e[n]^909522486,r[1][n]=e[n]^1549556828;this.w[0].update(r[0]),this.w[1].update(r[1]),this.R=new t(this.w[0])};ge.misc.hmac.prototype.encrypt=ge.misc.hmac.prototype.mac=function(e){if(this.aa)throw new ge.exception.invalid("encrypt on already updated hmac called!");return this.update(e),this.digest(e)};ge.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]),this.aa=!1};ge.misc.hmac.prototype.update=function(e){this.aa=!0,this.R.update(e)};ge.misc.hmac.prototype.digest=function(){var e=this.R.finalize(),e=new this.W(this.w[1]).update(e).finalize();return this.reset(),e};ge.misc.pbkdf2=function(e,t,r,n,i){if(r=r||1e4,0>n||0>r)throw new ge.exception.invalid("invalid params to pbkdf2");typeof e=="string"&&(e=ge.codec.utf8String.toBits(e)),typeof t=="string"&&(t=ge.codec.utf8String.toBits(t)),i=i||ge.misc.hmac,e=new i(e);var s,a,o,l,c=[],f=ge.bitArray;for(l=1;32*c.length<(n||1);l++){for(i=s=e.encrypt(f.concat(t,[l])),a=1;a<r;a++)for(s=e.encrypt(s),o=0;o<s.length;o++)i[o]^=s[o];c=c.concat(i)}return n&&(c=f.clamp(c,n)),c};ge.prng=function(e){this.c=[new ge.hash.sha256],this.m=[0],this.P=0,this.H={},this.N=0,this.U={},this.Z=this.f=this.o=this.ha=0,this.b=[0,0,0,0,0,0,0,0],this.h=[0,0,0,0],this.L=void 0,this.M=e,this.D=!1,this.K={progress:{},seeded:{}},this.u=this.ga=0,this.I=1,this.J=2,this.ca=65536,this.T=[0,48,64,96,128,192,256,384,512,768,1024],this.da=3e4,this.ba=80};ge.prng.prototype={randomWords:function(e,t){var r=[],n;n=this.isReady(t);var i;if(n===this.u)throw new ge.exception.notReady("generator isn't seeded");if(n&this.J){n=!(n&this.I),i=[];var s=0,a;for(this.Z=i[0]=new Date().valueOf()+this.da,a=0;16>a;a++)i.push(4294967296*Math.random()|0);for(a=0;a<this.c.length&&(i=i.concat(this.c[a].finalize()),s+=this.m[a],this.m[a]=0,n||!(this.P&1<<a));a++);for(this.P>=1<<this.c.length&&(this.c.push(new ge.hash.sha256),this.m.push(0)),this.f-=s,s>this.o&&(this.o=s),this.P++,this.b=ge.hash.sha256.hash(this.b.concat(i)),this.L=new ge.cipher.aes(this.b),n=0;4>n&&(this.h[n]=this.h[n]+1|0,!this.h[n]);n++);}for(n=0;n<e;n+=4)(n+1)%this.ca===0&&pR(this),i=qO(this),r.push(i[0],i[1],i[2],i[3]);return pR(this),r.slice(0,e)},setDefaultParanoia:function(e,t){if(e===0&&t!=="Setting paranoia=0 will ruin your security; use it only for testing")throw new ge.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=e},addEntropy:function(e,t,r){r=r||"user";var n,i,s=new Date().valueOf(),a=this.H[r],o=this.isReady(),l=0;switch(n=this.U[r],n===void 0&&(n=this.U[r]=this.ha++),a===void 0&&(a=this.H[r]=0),this.H[r]=(this.H[r]+1)%this.c.length,typeof e){case"number":t===void 0&&(t=1),this.c[a].update([n,this.N++,1,t,s,1,e|0]);break;case"object":if(r=Object.prototype.toString.call(e),r==="[object Uint32Array]"){for(i=[],r=0;r<e.length;r++)i.push(e[r]);e=i}else for(r!=="[object Array]"&&(l=1),r=0;r<e.length&&!l;r++)typeof e[r]!="number"&&(l=1);if(!l){if(t===void 0)for(r=t=0;r<e.length;r++)for(i=e[r];0<i;)t++,i=i>>>1;this.c[a].update([n,this.N++,2,t,s,e.length].concat(e))}break;case"string":t===void 0&&(t=e.length),this.c[a].update([n,this.N++,3,t,s,e.length]),this.c[a].update(e);break;default:l=1}if(l)throw new ge.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[a]+=t,this.f+=t,o===this.u&&(this.isReady()!==this.u&&dR("seeded",Math.max(this.o,this.f)),dR("progress",this.getProgress()))},isReady:function(e){return e=this.T[e!==void 0?e:this.M],this.o&&this.o>=e?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=e?this.J|this.u:this.u},getProgress:function(e){return e=this.T[e||this.M],this.o>=e||this.f>e?1:this.f/e},startCollectors:function(){if(!this.D){if(this.a={loadTimeCollector:by(this,this.ma),mouseCollector:by(this,this.oa),keyboardCollector:by(this,this.la),accelerometerCollector:by(this,this.ea),touchCollector:by(this,this.qa)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new ge.exception.bug("can't attach event");this.D=!0}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=!1)},addEventListener:function(e,t){this.K[e][this.ga++]=t},removeEventListener:function(e,t){var r,n,i=this.K[e],s=[];for(n in i)i.hasOwnProperty(n)&&i[n]===t&&s.push(n);for(r=0;r<s.length;r++)n=s[r],delete i[n]},la:function(){my(this,1)},oa:function(e){var t,r;try{t=e.x||e.clientX||e.offsetX||0,r=e.y||e.clientY||e.offsetY||0}catch{r=t=0}t!=0&&r!=0&&this.addEntropy([t,r],2,"mouse"),my(this,0)},qa:function(e){e=e.touches[0]||e.changedTouches[0],this.addEntropy([e.pageX||e.clientX,e.pageY||e.clientY],1,"touch"),my(this,0)},ma:function(){my(this,2)},ea:function(e){if(e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,window.orientation){var t=window.orientation;typeof t=="number"&&this.addEntropy(t,1,"accelerometer")}e&&this.addEntropy(e,2,"accelerometer"),my(this,0)}};function dR(e,t){var r,n=ge.random.K[e],i=[];for(r in n)n.hasOwnProperty(r)&&i.push(n[r]);for(r=0;r<i.length;r++)i[r](t)}function my(e,t){typeof window<"u"&&window.performance&&typeof window.performance.now=="function"?e.addEntropy(window.performance.now(),t,"loadtime"):e.addEntropy(new Date().valueOf(),t,"loadtime")}function pR(e){e.b=qO(e).concat(qO(e)),e.L=new ge.cipher.aes(e.b)}function qO(e){for(var t=0;4>t&&(e.h[t]=e.h[t]+1|0,!e.h[t]);t++);return e.L.encrypt(e.h)}function by(e,t){return function(){t.apply(e,arguments)}}ge.random=new ge.prng(6);e:try{if(DO=typeof module<"u"&&module.exports){try{jO=fie("crypto")}catch{jO=null}DO=FO=jO}if(DO&&FO.randomBytes)E0=FO.randomBytes(128),E0=new Uint32Array(new Uint8Array(E0).buffer),ge.random.addEntropy(E0,1024,"crypto['randomBytes']");else if(typeof window<"u"&&typeof Uint32Array<"u"){if(O0=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(O0);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(O0);else break e;ge.random.addEntropy(O0,1024,"crypto['getRandomValues']")}}catch(e){typeof window<"u"&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}var E0,FO,O0,DO,jO;ge.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(e,t,r,n){r=r||{},n=n||{};var i=ge.json,s=i.g({iv:ge.random.randomWords(4,0)},i.defaults),a;if(i.g(s,r),r=s.adata,typeof s.salt=="string"&&(s.salt=ge.codec.base64.toBits(s.salt)),typeof s.iv=="string"&&(s.iv=ge.codec.base64.toBits(s.iv)),!ge.mode[s.mode]||!ge.cipher[s.cipher]||typeof e=="string"&&100>=s.iter||s.ts!==64&&s.ts!==96&&s.ts!==128||s.ks!==128&&s.ks!==192&&s.ks!==256||2>s.iv.length||4<s.iv.length)throw new ge.exception.invalid("json encrypt: invalid parameters");return typeof e=="string"?(a=ge.misc.cachedPbkdf2(e,s),e=a.key.slice(0,s.ks/32),s.salt=a.salt):ge.ecc&&e instanceof ge.ecc.elGamal.publicKey&&(a=e.kem(),s.kemtag=a.tag,e=a.key.slice(0,s.ks/32)),typeof t=="string"&&(t=ge.codec.utf8String.toBits(t)),typeof r=="string"&&(s.adata=r=ge.codec.utf8String.toBits(r)),a=new ge.cipher[s.cipher](e),i.g(n,s),n.key=e,s.ct=s.mode==="ccm"&&ge.arrayBuffer&&ge.arrayBuffer.ccm&&t instanceof ArrayBuffer?ge.arrayBuffer.ccm.encrypt(a,t,s.iv,r,s.ts):ge.mode[s.mode].encrypt(a,t,s.iv,r,s.ts),s},encrypt:function(e,t,r,n){var i=ge.json,s=i.ja.apply(i,arguments);return i.encode(s)},ia:function(e,t,r,n){r=r||{},n=n||{};var i=ge.json;t=i.g(i.g(i.g({},i.defaults),t),r,!0);var s,a;if(s=t.adata,typeof t.salt=="string"&&(t.salt=ge.codec.base64.toBits(t.salt)),typeof t.iv=="string"&&(t.iv=ge.codec.base64.toBits(t.iv)),!ge.mode[t.mode]||!ge.cipher[t.cipher]||typeof e=="string"&&100>=t.iter||t.ts!==64&&t.ts!==96&&t.ts!==128||t.ks!==128&&t.ks!==192&&t.ks!==256||!t.iv||2>t.iv.length||4<t.iv.length)throw new ge.exception.invalid("json decrypt: invalid parameters");return typeof e=="string"?(a=ge.misc.cachedPbkdf2(e,t),e=a.key.slice(0,t.ks/32),t.salt=a.salt):ge.ecc&&e instanceof ge.ecc.elGamal.secretKey&&(e=e.unkem(ge.codec.base64.toBits(t.kemtag)).slice(0,t.ks/32)),typeof s=="string"&&(s=ge.codec.utf8String.toBits(s)),a=new ge.cipher[t.cipher](e),s=t.mode==="ccm"&&ge.arrayBuffer&&ge.arrayBuffer.ccm&&t.ct instanceof ArrayBuffer?ge.arrayBuffer.ccm.decrypt(a,t.ct,t.iv,t.tag,s,t.ts):ge.mode[t.mode].decrypt(a,t.ct,t.iv,s,t.ts),i.g(n,t),n.key=e,r.raw===1?s:ge.codec.utf8String.fromBits(s)},decrypt:function(e,t,r,n){var i=ge.json;return i.ia(e,i.decode(t),r,n)},encode:function(e){var t,r="{",n="";for(t in e)if(e.hasOwnProperty(t)){if(!t.match(/^[a-z0-9]+$/i))throw new ge.exception.invalid("json encode: invalid property name");switch(r+=n+'"'+t+'":',n=",",typeof e[t]){case"number":case"boolean":r+=e[t];break;case"string":r+='"'+escape(e[t])+'"';break;case"object":r+='"'+ge.codec.base64.fromBits(e[t],0)+'"';break;default:throw new ge.exception.bug("json encode: unsupported type")}}return r+"}"},decode:function(e){if(e=e.replace(/\s/g,""),!e.match(/^\{.*\}$/))throw new ge.exception.invalid("json decode: this isn't json!");e=e.replace(/^\{|\}$/g,"").split(/,/);var t={},r,n;for(r=0;r<e.length;r++){if(!(n=e[r].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new ge.exception.invalid("json decode: this isn't json!");n[3]!=null?t[n[2]]=parseInt(n[3],10):n[4]!=null?t[n[2]]=n[2].match(/^(ct|adata|salt|iv)$/)?ge.codec.base64.toBits(n[4]):unescape(n[4]):n[5]!=null&&(t[n[2]]=n[5]==="true")}return t},g:function(e,t,r){if(e===void 0&&(e={}),t===void 0)return e;for(var n in t)if(t.hasOwnProperty(n)){if(r&&e[n]!==void 0&&e[n]!==t[n])throw new ge.exception.invalid("required parameter overridden");e[n]=t[n]}return e},sa:function(e,t){var r={},n;for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(r[n]=e[n]);return r},ra:function(e,t){var r={},n;for(n=0;n<t.length;n++)e[t[n]]!==void 0&&(r[t[n]]=e[t[n]]);return r}};ge.encrypt=ge.json.encrypt;ge.decrypt=ge.json.decrypt;ge.misc.pa={};ge.misc.cachedPbkdf2=function(e,t){var r=ge.misc.pa,n;return t=t||{},n=t.iter||1e3,r=r[e]=r[e]||{},n=r[n]=r[n]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):ge.random.randomWords(2,0)},r=t.salt===void 0?n.firstSalt:t.salt,n[r]=n[r]||ge.misc.pbkdf2(e,r,t.iter),{key:n[r].slice(0),salt:r.slice(0)}};var A0=class extends Iie{name="http";fetchProxied=!1;listening={};constructor(e,t,r){super(e),this.load(this),this.listen(t,r)}GET=(e="http://localhost:8080/ping",t="",r)=>(t==="json"&&(r="application/json"),new Promise((n,i)=>{let s=A0.request({method:"GET",url:e,responseType:t,mimeType:r,onload:a=>{let o;s.responseType===""||s.responseType==="text"?o=s.responseText:o=s.response,e instanceof URL&&(e=e.toString()),this.setState({[e]:o}),n(o)},onabort:a=>{i(a)}})}).catch(console.error));POST=(e,t="http://localhost:8080/echo",r="",n)=>(typeof e=="object"&&(r==="json"||r==="text"||!r)&&(e=JSON.stringify(e)),r==="json"&&(n="application/json"),new Promise((i,s)=>{let a=A0.request({method:"POST",url:t,data:e,responseType:r,mimeType:n,onload:o=>{let l;a.responseType===""||a.responseType==="text"?l=a.responseText:l=a.response,t instanceof URL&&(t=t.toString()),this.setState({[t]:l}),i(l)},onabort:o=>{s(o)}})}).catch(console.error));transmit=(e,t)=>{let r=e;return typeof r=="object"&&(e=JSON.stringify(r)),r?.method?.toLowerCase()=="get"||e?.toLowerCase()==="get"?this.GET(t):this.POST(e,t)};transponder=(e,t,r="",n)=>{typeof t=="object"&&(t=JSON.stringify(t));let i="GET";if(t&&(i="POST"),r==="json")n="application/json";else return new Promise((s,a)=>{let o=A0.request({method:i,url:e,data:t,responseType:r,onload:l=>{let c=o.response;if(typeof c=="string"){let f=c.substring(0,8);(f.includes("{")||f.includes("["))&&(f.includes("\\")&&(c=c.replace(/\\/g,"")),c[0]==='"'&&(c=c.substring(1,c.length-1)),c=JSON.parse(c))}return typeof c?.method=="string"?s(this.handleMethod(c.route,c.method,c.args)):typeof c?.route=="string"?s(this.handleServiceMessage(c)):typeof c?.node=="string"||c.node instanceof _r?s(this.handleGraphNodeCall(c.node,c.args)):s(c)},onabort:l=>{a(l)}})}).catch(console.error)};listen=(e="0",t=async(r,n,i)=>{let s=await r.text(),a=this.receive(s);this.setState({[i.url]:a})})=>{this.listening[e]={};let r=`${e}${Math.floor(Math.random()*1e15)}`;return this.listening[e][r]=t,this.fetchProxied||(globalThis.fetch=new Proxy(globalThis.fetch,{apply(n,i,s){let a=n.apply(i,s);return a.then(o=>{if(o.ok){if(this.listening[0])for(let l in this.listeners){let c=o.clone();this.listening[0][l](c,s,o)}else for(let l in this.listening)if(o.url.includes(l)){for(let c in this.listening[e]){let f=o.clone();this.listening[e][c](f,s,o)}break}}}).catch(o=>{console.error(o)}),a}}),this.fetchProxied=!0),r};stopListening=(e,t)=>{if(!e&&e!==0)for(let r in this.listening)delete this.listening[r];else t?delete this.listening[t]:delete this.listening[e]}},Fie=A0;gie(Fie,"request",e=>{let t=new XMLHttpRequest;return e.responseType?t.responseType=e.responseType:e.responseType="json",e.mimeType&&t.overrideMimeType(e.mimeType),e.onload&&t.addEventListener("load",e.onload,!1),e.onprogress&&t.addEventListener("progress",e.onprogress,!1),e.onabort&&t.addEventListener("abort",e.onabort,!1),e.onloadend&&t.addEventListener("loadend",e.onloadend,!1),e.onerror&&t.addEventListener("error",e.onerror,!1),t.open(e.method,e.url,!0,e.user,e.pass),e.onerror||(t.onerror=function(){t.abort()}),t.send(e.data),t});var PLe=hie(yie());var Lo=WO(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]),Die=WO(["deltaX","deltaY"]),jie=WO(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function hR(e,t){let r={type:e.type};r.isTrusted=e.isTrusted,r.bubbles=e.bubbles,r.cancelBubble=e.cancelBubble,r.cancelable=e.cancelable,r.composed=e.composed,r.defaultPrevent=e.defaultPrevented,r.eventPhase=e.eventPhase,r.returnValue=e.returnValue,r.currentTarget=e.currentTarget.id?e.currentTarget.id:e.currentTarget.constructor.name,r.target=r.currentTarget,r.srcElement=r.currentTarget,t(r)}function Bie(e,t,r){r&&e.preventDefault&&e.preventDefault(),Die(e,t)}function Mie(e,t,r){r&&e.preventDefault&&e.preventDefault()}function Rie(e,t,r){for(let n of t)r[n]=e[n]}function WO(e){return function(r,n){let i={type:r.type};Rie(r,e,i),n(i)}}function BO(e,t,r){r&&e.preventDefault&&e.preventDefault();let n=[],i={type:e.type,touches:n};for(let s=0;s<e.touches.length;++s){let a=e.touches[s];n.push({pageX:a.pageX,pageY:a.pageY})}t(i)}var MO=1,bR={};for(;MO<222;)bR[MO]=!0,MO++;function gR(e,t,r){let{keyCode:n}=e;bR[n]&&(r&&e.preventDefault&&(n<110||n>123)&&e.preventDefault(),jie(e,t))}var vy={contextmenu:Mie,mousedown:Lo,mousemove:Lo,mouseup:Lo,pointerdown:Lo,pointermove:Lo,pointerup:Lo,pointerlockchange:Lo,webkitpointerlockchange:Lo,focus:hR,blur:hR,pointerout:Lo,touchstart:BO,touchmove:BO,touchend:BO,wheel:Bie,keydown:gR,keyup:gR};function JO(e,t,r,n){r||(r="proxy"+Math.floor(Math.random()*1e15));let i=o=>{t?t.postMessage({route:"handleProxyEvent",args:[o,r]}):vR(o,r)},s=Object.entries(vy);for(let[o,l]of s)e.addEventListener(o,function(c){l(c,i,n)});vy.keydown&&globalThis.addEventListener("keydown",function(o){vy.keydown(o,i,n)}),vy.keyup&&globalThis.addEventListener("keyup",function(o){vy.keyup(o,i,n)});let a=()=>{let o=e.getBoundingClientRect();i({type:"resize",left:o.left,top:o.top,width:e.clientWidth,height:e.clientHeight})};return a(),globalThis.addEventListener("resize",a),r}var $ie=class{__listeners;addEventListener(e,t){this.__listeners===void 0&&(this.__listeners={});let r=this.__listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this.__listeners===void 0)return!1;let r=this.__listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this.__listeners===void 0)return;let n=this.__listeners[e];if(n!==void 0){let i=n.indexOf(t);i!==-1&&n.splice(i,1)}}dispatchEvent(e,t){if(this.__listeners===void 0)return;let n=this.__listeners[e.type];if(n!==void 0){t?e.target=t:e.target=this;let i=n.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e)}}};function yR(){}var Uie=class extends $ie{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super(),this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>({left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height});handleEvent=e=>{e.type==="resize"&&(this.left=e.left,this.top=e.top,this.width=e.width,this.height=e.height,typeof this.proxied=="object"&&(this.proxied.style.width=this.width+"px",this.proxied.style.height=this.height+"px",this.proxied.clientWidth=this.width,this.proxied.clientHeight=this.height)),e.preventDefault=yR,e.stopPropagation=yR,this.dispatchEvent(e,this.proxied)};focus(){}blur(){}},I0=class{targets={};constructor(){globalThis.document||(globalThis.document={elementFromPoint:(...e)=>this.targets[Object.keys(this.targets)[0]].proxied})}makeProxy=(e,t=void 0)=>{e||(e=`proxyReceiver${Math.floor(Math.random()*1e15)}`);let r;this.targets[e]?r=this.targets[e]:(r=new Uie,this.targets[e]=r),typeof t=="object"&&(t.proxy=r,r.proxied=t,typeof WorkerGlobalScope<"u"&&(t.style=r.style),r.width&&(t.style.width=r.width+"px",t.clientWidth=r.width),r.height&&(t.style.height=r.height+"px",t.clientHeight=r.height),t.setPointerCapture=r.setPointerCapture.bind(r),t.releasePointerCapture=r.releasePointerCapture.bind(r),t.getBoundingClientRect=r.getBoundingClientRect.bind(r),t.addEventListener=r.addEventListener.bind(r),t.removeEventListener=r.removeEventListener.bind(r),t.handleEvent=r.handleEvent.bind(r),t.dispatchEvent=r.dispatchEvent.bind(r),t.focus=r.focus.bind(r),t.blur=r.blur.bind(r))};getProxy=e=>this.targets[e];handleEvent=(e,t)=>{if(this.targets[t]||this.makeProxy(t),this.targets[t])return this.targets[t].handleEvent(e),!0}};function zie(e,t){return this?.__node?.graph?(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new I0),this.__node.graph.ProxyManager.makeProxy(e,t)):(globalThis.ProxyManager||(globalThis.ProxyManager=new I0),globalThis.ProxyManager.makeProxy(e,t)),e}function vR(e,t){if(this?.__node?.graph){if(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new I0),this.__node.graph.ProxyManager.handleEvent(e,t))return e}else if(globalThis.ProxyManager||(globalThis.ProxyManager=new I0),globalThis.ProxyManager.handleEvent(e,t))return e}var GO={initProxyElement:JO,makeProxy:zie,handleProxyEvent:vR};function qie(e){if(e.worker){let t=e.worker,r=e.route;return(t instanceof Blob||typeof t=="string")&&(t=new Worker(t)),delete e.worker,delete e.route,_R(t,e,r)}else return JO(e.canvas,void 0,e._id,e.preventDefault),wR(e)}function _R(e,t,r){if(!t)return;t._id||(t._id=`canvas${Math.floor(Math.random()*1e15)}`);let n=t.canvas.transferControlToOffscreen();t.width||(t.width=t.canvas.clientWidth),t.height||(t.height=t.canvas.clientHeight);let i={route:r||"setupCanvas",args:{...t,canvas:n}};this?.__node?.graph?this.__node.graph.run("initProxyElement",t.canvas,e,t._id,t.preventDefault):JO(t.canvas,e,t._id,t.preventDefault),t.draw&&(typeof t.draw=="function"?i.args.draw=t.draw.toString():i.args.draw=t.draw),t.update&&(typeof t.update=="function"?i.args.update=t.update.toString():i.args.update=t.update),t.init&&(typeof t.init=="function"?i.args.init=t.init.toString():i.args.init=t.init),t.clear&&(typeof t.clear=="function"?i.args.clear=t.clear.toString():i.args.clear=t.clear);let s=[n];return t.transfer&&(s.push(...t.transfer),delete t.transfer),e.postMessage(i,s),{_id:t._id,width:t.width,height:t.height,worker:e,draw:(o,l)=>{e.postMessage({route:"drawFrame",args:[o,t._id]},l)},update:(o,l)=>{e.postMessage({route:"updateCanvas",args:[o,t._id]},l)},clear:()=>{e.postMessage({route:"clearCanvas",args:t._id})},init:()=>{e.postMessage({route:"initCanvas",args:t._id})},stop:()=>{e.postMessage({route:"stopAnim",args:t._id})},start:()=>{e.postMessage({route:"startAnim",args:t._id})},set:(o,l)=>{e.postMessage({route:"setDraw",args:[o,t._id]},l)},terminate:()=>{e.terminate()}}}function T0(e,t){let r;if(this?.__node?.graph?t?r=this.__node.graph.CANVASES?.[e._id]:e._id?r=this.__node.graph.CANVASES?.[e._id]:r=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:t||e._id?r=globalThis.CANVASES?.[e._id]:r=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],r)return e.canvas&&(r.canvas=e.canvas,this?.__node?.graph?this.__node.graph.run("makeProxy",r._id,r.canvas):GO.makeProxy(r._id,r.canvas)),typeof e.context=="string"?r.context=r.canvas.getContext(e.context):e.context&&(r.context=e.context),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),typeof e.draw=="string"&&(e.draw=Fo(e.draw)),typeof e.draw=="function"&&(r.draw=e.draw.bind(e)),typeof e.update=="string"&&(e.update=Fo(e.update)),typeof e.update=="function"&&(r.update=e.update.bind(e)),typeof e.init=="string"&&(e.init=Fo(e.init)),typeof e.init=="function"&&(r.init=e.init.bind(e)),typeof e.clear=="string"&&(e.clear=Fo(e.clear)),typeof e.clear=="function"&&(r.clear=e.clear.bind(e)),e._id}function wR(e){this?.__node?.graph?this.__node.graph.CANVASES||(this.__node.graph.CANVASES={}):globalThis.CANVASES||(globalThis.CANVASES={});let t=e;if(e._id?t._id=e._id:t._id=`canvas${Math.floor(Math.random()*1e15)}`,typeof e.context=="string"?t.context=e.canvas.getContext(e.context):t.context=e.context,"animating"in e?t.animating=e.animating:t.animating=!0,this?.__node?.graph?.CANVASES[t._id])this.__node.graph.run("setDraw",t);else if(globalThis.CANVASES?.[t._id])T0(t);else if(this?.__node?.graph&&(t.graph=this.__node.graph,t.__node||(t.__node={}),t.__node.tag||(t.__node.tag=t._id),t=this.__node.graph.add(t),t.__addOndisconnected=()=>{t.stop(),delete this.__node.graph.CANVASES[t._id]}),this?.__node?.graph?this.__node.graph.CANVASES[t._id]=t:globalThis.CANVASES[t._id]=t,this?.__node?.graph?this.__node.graph.run("makeProxy",t._id,t.canvas):GO.makeProxy(t._id,t.canvas),e.width&&(t.canvas.width=e.width),e.height&&(t.canvas.height=e.height),typeof t.draw=="string"?t.draw=Fo(t.draw):typeof t.draw=="function"&&(t.draw=t.draw.bind(t)),typeof t.update=="string"?t.update=Fo(t.update):typeof t.update=="function"&&(t.update=t.update.bind(t)),typeof t.init=="string"?t.init=Fo(t.init):typeof t.init=="function"&&(t.init=t.init.bind(t)),typeof t.clear=="string"?t.clear=Fo(t.clear):typeof t.clear=="function"&&(t.clear=t.clear.bind(t)),typeof t.init=="function"&&t.init(t,t.canvas,t.context),t.stop=()=>{C0(t._id)},t.start=r=>{VO(t._id,r)},t.set=r=>{T0(r,t._id)},typeof t.draw=="function"&&t.animating){let r=(n,i,s)=>{n.animating&&(n.draw(n,i,s),requestAnimationFrame(()=>{r(n,i,s)}))};r(t,t.canvas,t.context)}return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?t._id:{_id:e._id,width:e.width,height:e.height,draw:n=>{SR(n,e._id)},update:n=>{ER(n,e._id)},clear:()=>{xR(e._id)},init:()=>{kR(e._id)},stop:()=>{C0(e._id)},start:()=>{VO(e._id)},set:n=>{T0(n,e._id)},terminate:()=>{this.__node?.graph?this.__node.graph.remove(e._id):(C0(e._id),this?.__node?.graph?delete this.__node.graph.CANVASES[t._id]:delete globalThis.CANVASES[t._id])}}}function SR(e,t){let r=ql.call(this,t);if(r&&(e&&Object.assign(r,e),r.draw))return r.draw(r,r.canvas,r.context),t}function xR(e){let t=ql.call(this,e);if(t?.clear)return t.clear(t,t.canvas,t.context),e}function kR(e){let t=ql.call(this,e);if(t?.init)return t.init(t,t.canvas,t.context),e}function ER(e,t){let r=ql.call(this,t);if(r?.update)return r.update(r,r.canvas,r.context,e),t}function Vie(e,t){let r=ql.call(this,t);if(r)return Object.assign(r,e),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),t}function VO(e,t){let r=ql.call(this,e);if(r.animating=!0,r&&t)return typeof t=="string"&&(t=Fo(t)),typeof t=="function"&&(r.draw=t),e;if(typeof r?.draw=="function"){let n=(i,s,a)=>{i.animating&&(i.draw(i,s,a),requestAnimationFrame(()=>{n(i,s,a)}))};return typeof r.clear=="function"&&r.clear(r,r.canvas,r.context),typeof r.init=="function"&&r.init(r,r.canvas,r.context),n(r,r.canvas,r.context),e}}function C0(e){let t=ql.call(this,e);if(t)return t.animating=!1,typeof t.clear=="function"&&requestAnimationFrame(t.clear(t,t.canvas,t.context)),e}function ql(e){let t;return this?.__node?.graph?e?t=this.__node.graph.CANVASES?.[e]:t=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:e?t=globalThis.CANVASES?.[e]:t=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],t}var LLe={...GO,Renderer:qie,transferCanvas:_R,setupCanvas:wR,setDraw:T0,drawFrame:SR,clearCanvas:xR,initCanvas:kR,updateCanvas:ER,setProps:Vie,startAnim:VO,stopAnim:C0,getCanvas:ql};function Fo(e=""){let t=a=>a.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),n=(a=>{let o=a.indexOf("=>")+1;return o<=0&&(o=a.indexOf("){")),o<=0&&(o=a.indexOf(") {")),a.slice(0,a.indexOf("{",o)+1)})(e),i=t(e),s;if(n.includes("function")){let a=n.split("(")[1].split(")")[0];s=new Function(a,i)}else if(n.substring(0,6)===i.substring(0,6)){let a=n.split("(")[1].split(")")[0];s=new Function(a,i.substring(i.indexOf("{")+1,i.length-1))}else try{s=(0,eval)(n+i+"}")}catch{}return s}var mu=xt.subscribeEvent,wy=xt.unsubscribeEvent,KO=xt.setState,YO=e=>xt.data[e],Td=KO;var Hie={heg:"./recordings/HEG_2023-08-11T03_20_27.528Z.csv",hr:"./recordings/HRV_2023-08-11T03_20_27.978Z.csv",breath:"./recordings/BREATH_2023-08-11T03_20_36.573Z.csv",fnirs:"./recordings/FNIRS_2023-08-11T03_20_27.528Z.csv"};async function Wie(e){let t=await fetch(e);if(t.status===200||t.status===0)return await t.text()}var Jie={};function Gie(e,t,r,n=1/0){let i=Hie[e];t||(e==="fnirs"?t=20:e==="heg"?t=11:e==="hr"?t=1:e==="breath"?t=.166667:e==="imu"&&(r=100)),r||(e==="fnirs"?r=1e3/20:e==="heg"?r=1e3/11:e==="imu"?r=333:e==="hr"?r=1e3:e==="breath"&&(r=1e3/.166667)),Wie(i).then(s=>{let a=NO(s,i,void 0),o={};function l(u=250,d=1e3,p){let _=Math.floor(u*(d/1e3)),w={};function k(S){w[S]=[],o[S]||(o[S]=0),new Array(_).fill(0).map((O,A)=>{w[S].push(parseFloat(a[S][o[S]+A]))}),o[S]+=_,o[S]+_>a[S].length&&(o[S]=0)}if(p)k(p),k("timestamp");else for(let S in a)S!=="header"&&S!=="filename"&&S!=="localized"&&k(S);return w}let c={running:!0};((u=250,d=1e3*9/250,p=5e3)=>{let _=Date.now(),w=_,k=async()=>{if(c.running){let O=l(u,d),A=e;for(let C in O)isNaN(O[C][0])&&delete O[C];xt.setState({[A]:O}),_+=d,_<=w+p&&(await new Promise(C=>setTimeout(C,d)),k())}};k()})(t,r,n),Jie[e]=c})}function OR(e=["fnirs","heg","breath","hr"]){let t={};for(let r of e)Gie(r),t["detected"+r.toUpperCase()]=!0;xt.setState({deviceConnected:!0,demoing:!0,...t})}var ln=ae(Je());var dt=ae(Je());function Sy(){return Sy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sy.apply(this,arguments)}var ca;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ca||(ca={}));var AR="popstate";function NR(e){e===void 0&&(e={});function t(i,s){let{pathname:a="/",search:o="",hash:l=""}=Wa(i.location.hash.substr(1));return ZO("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(i,s){let a=i.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let l=i.location.href,c=l.indexOf("#");o=c===-1?l:l.slice(0,c)}return o+"#"+(typeof s=="string"?s:bu(s))}function n(i,s){N0(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return Yie(t,r,n,e)}function Zr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function N0(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Kie(){return Math.random().toString(36).substr(2,8)}function TR(e,t){return{usr:e.state,key:e.key,idx:t}}function ZO(e,t,r,n){return r===void 0&&(r=null),Sy({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Wa(t):t,{state:r,key:t&&t.key||n||Kie()})}function bu(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Wa(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Yie(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=ca.Pop,l=null,c=f();c==null&&(c=0,a.replaceState(Sy({},a.state,{idx:c}),""));function f(){return(a.state||{idx:null}).idx}function u(){o=ca.Pop;let k=f(),S=k==null?null:k-c;c=k,l&&l({action:o,location:w.location,delta:S})}function d(k,S){o=ca.Push;let O=ZO(w.location,k,S);r&&r(O,k),c=f()+1;let A=TR(O,c),C=w.createHref(O);try{a.pushState(A,"",C)}catch{i.location.assign(C)}s&&l&&l({action:o,location:w.location,delta:1})}function p(k,S){o=ca.Replace;let O=ZO(w.location,k,S);r&&r(O,k),c=f();let A=TR(O,c),C=w.createHref(O);a.replaceState(A,"",C),s&&l&&l({action:o,location:w.location,delta:0})}function _(k){let S=i.location.origin!=="null"?i.location.origin:i.location.href,O=typeof k=="string"?k:bu(k);return Zr(S,"No window.location.(origin|href) available to create URL for href: "+O),new URL(O,S)}let w={get action(){return o},get location(){return e(i,a)},listen(k){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(AR,u),l=k,()=>{i.removeEventListener(AR,u),l=null}},createHref(k){return t(i,k)},createURL:_,encodeLocation(k){let S=_(k);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:d,replace:p,go(k){return a.go(k)}};return w}var CR;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(CR||(CR={}));function P0(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?Wa(t):t,i=xy(n.pathname||"/",r);if(i==null)return null;let s=PR(e);Xie(s);let a=null;for(let o=0;a==null&&o<s.length;++o)a=ase(s[o],lse(i));return a}function PR(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Zr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Ha([n,l.relativePath]),f=r.concat(l);s.children&&s.children.length>0&&(Zr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),PR(s.children,t,f,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:ise(c,s.index),routesMeta:f})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of LR(s.path))i(s,a,l)}),t}function LR(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=LR(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function Xie(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:sse(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var Zie=/^:\w+$/,Qie=3,ese=2,tse=1,rse=10,nse=-2,IR=e=>e==="*";function ise(e,t){let r=e.split("/"),n=r.length;return r.some(IR)&&(n+=nse),t&&(n+=ese),r.filter(i=>!IR(i)).reduce((i,s)=>i+(Zie.test(s)?Qie:s===""?tse:rse),n)}function sse(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function ase(e,t){let{routesMeta:r}=e,n={},i="/",s=[];for(let a=0;a<r.length;++a){let o=r[a],l=a===r.length-1,c=i==="/"?t:t.slice(i.length)||"/",f=L0({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},c);if(!f)return null;Object.assign(n,f.params);let u=o.route;s.push({params:n,pathname:Ha([i,f.pathname]),pathnameBase:fse(Ha([i,f.pathnameBase])),route:u}),f.pathnameBase!=="/"&&(i=Ha([i,f.pathnameBase]))}return s}function L0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=ose(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((c,f,u)=>{if(f==="*"){let d=o[u]||"";a=s.slice(0,s.length-d.length).replace(/(.)\/+$/,"$1")}return c[f]=cse(o[u]||"",f),c},{}),pathname:s,pathnameBase:a,pattern:e}}function ose(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),N0(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,o)=>(n.push(o),"/([^\\/]+)"));return e.endsWith("*")?(n.push("*"),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function lse(e){try{return decodeURI(e)}catch(t){return N0(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function cse(e,t){try{return decodeURIComponent(e)}catch(r){return N0(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function xy(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function QO(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?Wa(e):e;return{pathname:r?r.startsWith("/")?r:use(r,t):t,search:dse(n),hash:pse(i)}}function use(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function XO(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function eA(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function tA(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=Wa(e):(i=Sy({},e),Zr(!i.pathname||!i.pathname.includes("?"),XO("?","pathname","search",i)),Zr(!i.pathname||!i.pathname.includes("#"),XO("#","pathname","hash",i)),Zr(!i.search||!i.search.includes("#"),XO("#","search","hash",i)));let s=e===""||i.pathname==="",a=s?"/":i.pathname,o;if(n||a==null)o=r;else{let u=t.length-1;if(a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),u-=1;i.pathname=d.join("/")}o=u>=0?t[u]:"/"}let l=QO(i,o),c=a&&a!=="/"&&a.endsWith("/"),f=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}var Ha=e=>e.join("/").replace(/\/\/+/g,"/"),fse=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),dse=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,pse=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function F0(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var FR=["post","put","patch","delete"],KLe=new Set(FR),hse=["get",...FR],YLe=new Set(hse);var XLe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";var ZLe=Symbol("deferred");function D0(){return D0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D0.apply(this,arguments)}var Oy=dt.createContext(null),j0=dt.createContext(null);var Do=dt.createContext(null),Ay=dt.createContext(null),jo=dt.createContext({outlet:null,matches:[],isDataRoute:!1}),BR=dt.createContext(null);function iA(e,t){let{relative:r}=t===void 0?{}:t;Cd()||Zr(!1);let{basename:n,navigator:i}=dt.useContext(Do),{hash:s,pathname:a,search:o}=Ty(e,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:Ha([n,a])),i.createHref({pathname:l,search:o,hash:s})}function Cd(){return dt.useContext(Ay)!=null}function Bo(){return Cd()||Zr(!1),dt.useContext(Ay).location}function MR(e){dt.useContext(Do).static||dt.useLayoutEffect(e)}function sA(){let{isDataRoute:e}=dt.useContext(jo);return e?Cse():_se()}function _se(){Cd()||Zr(!1);let e=dt.useContext(Oy),{basename:t,navigator:r}=dt.useContext(Do),{matches:n}=dt.useContext(jo),{pathname:i}=Bo(),s=JSON.stringify(eA(n).map(l=>l.pathnameBase)),a=dt.useRef(!1);return MR(()=>{a.current=!0}),dt.useCallback(function(l,c){if(c===void 0&&(c={}),!a.current)return;if(typeof l=="number"){r.go(l);return}let f=tA(l,JSON.parse(s),i,c.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Ha([t,f.pathname])),(c.replace?r.replace:r.push)(f,c.state,c)},[t,r,s,i,e])}function Ty(e,t){let{relative:r}=t===void 0?{}:t,{matches:n}=dt.useContext(jo),{pathname:i}=Bo(),s=JSON.stringify(eA(n).map(a=>a.pathnameBase));return dt.useMemo(()=>tA(e,JSON.parse(s),i,r==="path"),[e,s,i,r])}function RR(e,t){return wse(e,t)}function wse(e,t,r){Cd()||Zr(!1);let{navigator:n}=dt.useContext(Do),{matches:i}=dt.useContext(jo),s=i[i.length-1],a=s?s.params:{},o=s?s.pathname:"/",l=s?s.pathnameBase:"/",c=s&&s.route,f=Bo(),u;if(t){var d;let S=typeof t=="string"?Wa(t):t;l==="/"||(d=S.pathname)!=null&&d.startsWith(l)||Zr(!1),u=S}else u=f;let p=u.pathname||"/",_=l==="/"?p:p.slice(l.length)||"/",w=P0(e,{pathname:_}),k=Ese(w&&w.map(S=>Object.assign({},S,{params:Object.assign({},a,S.params),pathname:Ha([l,n.encodeLocation?n.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?l:Ha([l,n.encodeLocation?n.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),i,r);return t&&k?dt.createElement(Ay.Provider,{value:{location:D0({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:ca.Pop}},k):k}function Sse(){let e=B0(),t=F0(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n};return dt.createElement(dt.Fragment,null,dt.createElement("h2",null,"Unexpected Application Error!"),dt.createElement("h3",{style:{fontStyle:"italic"}},t),r?dt.createElement("pre",{style:i},r):null,null)}var xse=dt.createElement(Sse,null),rA=class extends dt.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?dt.createElement(jo.Provider,{value:this.props.routeContext},dt.createElement(BR.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function kse(e){let{routeContext:t,match:r,children:n}=e,i=dt.useContext(Oy);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),dt.createElement(jo.Provider,{value:t},n)}function Ese(e,t,r){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var i;if((i=r)!=null&&i.errors)e=r.matches;else return null}let s=e,a=(n=r)==null?void 0:n.errors;if(a!=null){let o=s.findIndex(l=>l.route.id&&a?.[l.route.id]);o>=0||Zr(!1),s=s.slice(0,Math.min(s.length,o+1))}return s.reduceRight((o,l,c)=>{let f=l.route.id?a?.[l.route.id]:null,u=null;r&&(u=l.route.errorElement||xse);let d=t.concat(s.slice(0,c+1)),p=()=>{let _;return f?_=u:l.route.Component?_=dt.createElement(l.route.Component,null):l.route.element?_=l.route.element:_=o,dt.createElement(kse,{match:l,routeContext:{outlet:o,matches:d,isDataRoute:r!=null},children:_})};return r&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?dt.createElement(rA,{location:r.location,revalidation:r.revalidation,component:u,error:f,children:p(),routeContext:{outlet:null,matches:d,isDataRoute:!0}}):p()},null)}var nA;(function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate"})(nA||(nA={}));var ky;(function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId"})(ky||(ky={}));function Ose(e){let t=dt.useContext(Oy);return t||Zr(!1),t}function Ase(e){let t=dt.useContext(j0);return t||Zr(!1),t}function Tse(e){let t=dt.useContext(jo);return t||Zr(!1),t}function $R(e){let t=Tse(e),r=t.matches[t.matches.length-1];return r.route.id||Zr(!1),r.route.id}function B0(){var e;let t=dt.useContext(BR),r=Ase(ky.UseRouteError),n=$R(ky.UseRouteError);return t||((e=r.errors)==null?void 0:e[n])}function Cse(){let{router:e}=Ose(nA.UseNavigateStable),t=$R(ky.UseNavigateStable),r=dt.useRef(!1);return MR(()=>{r.current=!0}),dt.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,D0({fromRouteId:t},s)))},[e,t])}function vu(e){Zr(!1)}function aA(e){let{basename:t="/",children:r=null,location:n,navigationType:i=ca.Pop,navigator:s,static:a=!1}=e;Cd()&&Zr(!1);let o=t.replace(/^\/*/,"/"),l=dt.useMemo(()=>({basename:o,navigator:s,static:a}),[o,s,a]);typeof n=="string"&&(n=Wa(n));let{pathname:c="/",search:f="",hash:u="",state:d=null,key:p="default"}=n,_=dt.useMemo(()=>{let w=xy(c,o);return w==null?null:{location:{pathname:w,search:f,hash:u,state:d,key:p},navigationType:i}},[o,c,f,u,d,p,i]);return _==null?null:dt.createElement(Do.Provider,{value:l},dt.createElement(Ay.Provider,{children:r,value:_}))}function oA(e){let{children:t,location:r}=e;return RR(Ey(t),r)}var DR;(function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"})(DR||(DR={}));var nFe=new Promise(()=>{});function Ey(e,t){t===void 0&&(t=[]);let r=[];return dt.Children.forEach(e,(n,i)=>{if(!dt.isValidElement(n))return;let s=[...t,i];if(n.type===dt.Fragment){r.push.apply(r,Ey(n.props.children,s));return}n.type!==vu&&Zr(!1),!n.props.index||!n.props.children||Zr(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=Ey(n.props.children,s)),r.push(a)}),r}function M0(){return M0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M0.apply(this,arguments)}function qR(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Fse(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Dse(e,t){return e.button===0&&(!t||t==="_self")&&!Fse(e)}var jse=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],Bse=["aria-current","caseSensitive","className","end","style","to","children"];function VR(e){let{basename:t,children:r,window:n}=e,i=ln.useRef();i.current==null&&(i.current=NR({window:n,v5Compat:!0}));let s=i.current,[a,o]=ln.useState({action:s.action,location:s.location});return ln.useLayoutEffect(()=>s.listen(o),[s]),ln.createElement(aA,{basename:t,children:r,location:a.location,navigationType:a.action,navigator:s})}var Mse=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Rse=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ja=ln.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:f}=t,u=qR(t,jse),{basename:d}=ln.useContext(Do),p,_=!1;if(typeof c=="string"&&Rse.test(c)&&(p=c,Mse))try{let O=new URL(window.location.href),A=c.startsWith("//")?new URL(O.protocol+c):new URL(c),C=xy(A.pathname,d);A.origin===O.origin&&C!=null?c=C+A.search+A.hash:_=!0}catch{}let w=iA(c,{relative:i}),k=$se(c,{replace:a,state:o,target:l,preventScrollReset:f,relative:i});function S(O){n&&n(O),O.defaultPrevented||k(O)}return ln.createElement("a",M0({},u,{href:p||w,onClick:_||s?n:S,ref:r,target:l}))}),HR=ln.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:i=!1,className:s="",end:a=!1,style:o,to:l,children:c}=t,f=qR(t,Bse),u=Ty(l,{relative:f.relative}),d=Bo(),p=ln.useContext(j0),{navigator:_}=ln.useContext(Do),w=_.encodeLocation?_.encodeLocation(u).pathname:u.pathname,k=d.pathname,S=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;i||(k=k.toLowerCase(),S=S?S.toLowerCase():null,w=w.toLowerCase());let O=k===w||!a&&k.startsWith(w)&&k.charAt(w.length)==="/",A=S!=null&&(S===w||!a&&S.startsWith(w)&&S.charAt(w.length)==="/"),C=O?n:void 0,I;typeof s=="function"?I=s({isActive:O,isPending:A}):I=[s,O?"active":null,A?"pending":null].filter(Boolean).join(" ");let D=typeof o=="function"?o({isActive:O,isPending:A}):o;return ln.createElement(Ja,M0({},f,{"aria-current":C,className:I,ref:r,style:D,to:l}),typeof c=="function"?c({isActive:O,isPending:A}):c)});var UR;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(UR||(UR={}));var zR;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(zR||(zR={}));function $se(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a}=t===void 0?{}:t,o=sA(),l=Bo(),c=Ty(e,{relative:a});return ln.useCallback(f=>{if(Dse(f,r)){f.preventDefault();let u=n!==void 0?n:bu(l)===bu(c);o(e,{replace:u,state:i,preventScrollReset:s,relative:a})}},[l,o,c,n,i,r,e,s,a])}var wu=ae(Je(),1);function WR(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=WR(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function lA(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=WR(e))&&(n&&(n+=" "),n+=t);return n}var JR=lA;function GR(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=KR(t))&&(n&&(n+=" "),n+=r);return n}function KR(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=KR(e[n]))&&(r&&(r+=" "),r+=t);return r}var uA="-";function ZR(e){var t=zse(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,i=n===void 0?{}:n;function s(o){var l=o.split(uA);return l[0]===""&&l.length!==1&&l.shift(),QR(l,t)||Use(o)}function a(o,l){var c=r[o]||[];return l&&i[o]?[].concat(c,i[o]):c}return{getClassGroupId:s,getConflictingClassGroupIds:a}}function QR(e,t){if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),i=n?QR(e.slice(1),n):void 0;if(i)return i;if(t.validators.length!==0){var s=e.join(uA);return t.validators.find(function(a){var o=a.validator;return o(s)})?.classGroupId}}var YR=/^\[(.+)\]$/;function Use(e){if(YR.test(e)){var t=YR.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function zse(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},i=Vse(Object.entries(e.classGroups),r);return i.forEach(function(s){var a=s[0],o=s[1];cA(o,n,a,t)}),n}function cA(e,t,r,n){e.forEach(function(i){if(typeof i=="string"){var s=i===""?t:XR(t,i);s.classGroupId=r;return}if(typeof i=="function"){if(qse(i)){cA(i(n),t,r,n);return}t.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(function(a){var o=a[0],l=a[1];cA(l,XR(t,o),r,n)})})}function XR(e,t){var r=e;return t.split(uA).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function qse(e){return e.isThemeGetter}function Vse(e,t){return t?e.map(function(r){var n=r[0],i=r[1],s=i.map(function(a){return typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(function(o){var l=o[0],c=o[1];return[t+l,c]})):a});return[n,s]}):e}function e4(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function i(s,a){r.set(s,a),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(a){var o=r.get(a);if(o!==void 0)return o;if((o=n.get(a))!==void 0)return i(a,o),o},set:function(a,o){r.has(a)?r.set(a,o):i(a,o)}}}var fA="!";function t4(e){var t=e.separator||":",r=t.length===1,n=t[0],i=t.length;return function(a){for(var o=[],l=0,c=0,f,u=0;u<a.length;u++){var d=a[u];if(l===0){if(d===n&&(r||a.slice(u,u+i)===t)){o.push(a.slice(c,u)),c=u+i;continue}if(d==="/"){f=u;continue}}d==="["?l++:d==="]"&&l--}var p=o.length===0?a:a.substring(c),_=p.startsWith(fA),w=_?p.substring(1):p,k=f&&f>c?f-c:void 0;return{modifiers:o,hasImportantModifier:_,baseClassName:w,maybePostfixModifierPosition:k}}}function r4(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var i=n[0]==="[";i?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function n4(e){return{cache:e4(e.cacheSize),splitModifiers:t4(e),...ZR(e)}}var Hse=/\s+/;function i4(e,t){var r=t.splitModifiers,n=t.getClassGroupId,i=t.getConflictingClassGroupIds,s=new Set;return e.trim().split(Hse).map(function(a){var o=r(a),l=o.modifiers,c=o.hasImportantModifier,f=o.baseClassName,u=o.maybePostfixModifierPosition,d=n(u?f.substring(0,u):f),p=!!u;if(!d){if(!u)return{isTailwindClass:!1,originalClassName:a};if(d=n(f),!d)return{isTailwindClass:!1,originalClassName:a};p=!1}var _=r4(l).join(":"),w=c?_+fA:_;return{isTailwindClass:!0,modifierId:w,classGroupId:d,originalClassName:a,hasPostfixModifier:p}}).reverse().filter(function(a){if(!a.isTailwindClass)return!0;var o=a.modifierId,l=a.classGroupId,c=a.hasPostfixModifier,f=o+l;return s.has(f)?!1:(s.add(f),i(l,c).forEach(function(u){return s.add(o+u)}),!0)}).reverse().map(function(a){return a.originalClassName}).join(" ")}function s4(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i,s,a=o;function o(c){var f=t[0],u=t.slice(1),d=u.reduce(function(p,_){return _(p)},f());return n=n4(d),i=n.cache.get,s=n.cache.set,a=l,l(c)}function l(c){var f=i(c);if(f)return f;var u=i4(c,n);return s(c,u),u}return function(){return a(GR.apply(null,arguments))}}function Ar(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var o4=/^\[(?:([a-z-]+):)?(.+)\]$/i,Wse=/^\d+\/\d+$/,Jse=new Set(["px","full","screen"]),Gse=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Kse=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|^0$/,Yse=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function js(e){return Vl(e)||Jse.has(e)||Wse.test(e)||Mo(e)}function Mo(e){return _u(e,"length",Xse)}function l4(e){return _u(e,"size",p4)}function c4(e){return _u(e,"position",p4)}function u4(e){return _u(e,"url",Zse)}function Cy(e){return _u(e,"number",Vl)}function Vl(e){return!Number.isNaN(Number(e))}function f4(e){return e.endsWith("%")&&Vl(e.slice(0,-1))}function Id(e){return a4(e)||_u(e,"number",a4)}function Qr(e){return o4.test(e)}function Nd(){return!0}function Ro(e){return Gse.test(e)}function d4(e){return _u(e,"",Qse)}function _u(e,t,r){var n=o4.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function Xse(e){return Kse.test(e)}function p4(){return!1}function Zse(e){return e.startsWith("url(")}function a4(e){return Number.isInteger(Number(e))}function Qse(e){return Yse.test(e)}function h4(){var e=Ar("colors"),t=Ar("spacing"),r=Ar("blur"),n=Ar("brightness"),i=Ar("borderColor"),s=Ar("borderRadius"),a=Ar("borderSpacing"),o=Ar("borderWidth"),l=Ar("contrast"),c=Ar("grayscale"),f=Ar("hueRotate"),u=Ar("invert"),d=Ar("gap"),p=Ar("gradientColorStops"),_=Ar("gradientColorStopPositions"),w=Ar("inset"),k=Ar("margin"),S=Ar("opacity"),O=Ar("padding"),A=Ar("saturate"),C=Ar("scale"),I=Ar("sepia"),D=Ar("skew"),L=Ar("space"),U=Ar("translate"),te=function(){return["auto","contain","none"]},V=function(){return["auto","hidden","clip","visible","scroll"]},X=function(){return["auto",t]},Z=function(){return["",js]},se=function(){return["auto",Vl,Qr]},pe=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},de=function(){return["solid","dashed","dotted","double","none"]},F=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},H=function(){return["start","end","center","between","around","evenly","stretch"]},Q=function(){return["","0",Qr]},R=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},$=function(){return[Vl,Cy]},q=function(){return[Vl,Qr]};return{cacheSize:500,theme:{colors:[Nd],spacing:[js],blur:["none","",Ro,Mo],brightness:$(),borderColor:[e],borderRadius:["none","","full",Ro,Mo],borderSpacing:[t],borderWidth:Z(),contrast:$(),grayscale:Q(),hueRotate:q(),invert:Q(),gap:[t],gradientColorStops:[e],gradientColorStopPositions:[f4,Mo],inset:X(),margin:X(),opacity:$(),padding:[t],saturate:$(),scale:$(),sepia:Q(),skew:q(),space:[t],translate:[t]},classGroups:{aspect:[{aspect:["auto","square","video",Qr]}],container:["container"],columns:[{columns:[Ro]}],"break-after":[{"break-after":R()}],"break-before":[{"break-before":R()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(pe(),[Qr])}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:te()}],"overscroll-x":[{"overscroll-x":te()}],"overscroll-y":[{"overscroll-y":te()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[w]}],"inset-x":[{"inset-x":[w]}],"inset-y":[{"inset-y":[w]}],start:[{start:[w]}],end:[{end:[w]}],top:[{top:[w]}],right:[{right:[w]}],bottom:[{bottom:[w]}],left:[{left:[w]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Id]}],basis:[{basis:[t]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Qr]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",Id]}],"grid-cols":[{"grid-cols":[Nd]}],"col-start-end":[{col:["auto",{span:[Id]},Qr]}],"col-start":[{"col-start":se()}],"col-end":[{"col-end":se()}],"grid-rows":[{"grid-rows":[Nd]}],"row-start-end":[{row:["auto",{span:[Id]},Qr]}],"row-start":[{"row-start":se()}],"row-end":[{"row-end":se()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Qr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Qr]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal"].concat(H())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(H(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(H(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[O]}],px:[{px:[O]}],py:[{py:[O]}],ps:[{ps:[O]}],pe:[{pe:[O]}],pt:[{pt:[O]}],pr:[{pr:[O]}],pb:[{pb:[O]}],pl:[{pl:[O]}],m:[{m:[k]}],mx:[{mx:[k]}],my:[{my:[k]}],ms:[{ms:[k]}],me:[{me:[k]}],mt:[{mt:[k]}],mr:[{mr:[k]}],mb:[{mb:[k]}],ml:[{ml:[k]}],"space-x":[{"space-x":[L]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[L]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",t]}],"min-w":[{"min-w":["min","max","fit",js]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Ro]},Ro,Mo]}],h:[{h:[t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",js]}],"max-h":[{"max-h":[t,"min","max","fit"]}],"font-size":[{text:["base",Ro,Mo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Cy]}],"font-family":[{font:[Nd]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Mo]}],"line-clamp":[{"line-clamp":["none",Vl,Cy]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",js]}],"list-image":[{"list-image":["none",Qr]}],"list-style-type":[{list:["none","disc","decimal",Qr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[S]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[S]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(de(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",js]}],"underline-offset":[{"underline-offset":["auto",js]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:[t]}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Mo]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Qr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[S]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(pe(),[c4])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",l4]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},u4]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[_]}],"gradient-via-pos":[{via:[_]}],"gradient-to-pos":[{to:[_]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[S]}],"border-style":[{border:[].concat(de(),["hidden"])}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[S]}],"divide-style":[{divide:de()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:[""].concat(de())}],"outline-offset":[{"outline-offset":[js]}],"outline-w":[{outline:[js]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[S]}],"ring-offset-w":[{"ring-offset":[js]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ro,d4]}],"shadow-color":[{shadow:[Nd]}],opacity:[{opacity:[S]}],"mix-blend":[{"mix-blend":F()}],"bg-blend":[{"bg-blend":F()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ro,Qr]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[u]}],saturate:[{saturate:[A]}],sepia:[{sepia:[I]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[S]}],"backdrop-saturate":[{"backdrop-saturate":[A]}],"backdrop-sepia":[{"backdrop-sepia":[I]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Qr]}],duration:[{duration:q()}],ease:[{ease:["linear","in","out","in-out",Qr]}],delay:[{delay:q()}],animate:[{animate:["none","spin","ping","pulse","bounce",Qr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[Id,Qr]}],"translate-x":[{"translate-x":[U]}],"translate-y":[{"translate-y":[U]}],"skew-x":[{"skew-x":[D]}],"skew-y":[{"skew-y":[D]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Qr]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Qr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":[t]}],"scroll-mx":[{"scroll-mx":[t]}],"scroll-my":[{"scroll-my":[t]}],"scroll-ms":[{"scroll-ms":[t]}],"scroll-me":[{"scroll-me":[t]}],"scroll-mt":[{"scroll-mt":[t]}],"scroll-mr":[{"scroll-mr":[t]}],"scroll-mb":[{"scroll-mb":[t]}],"scroll-ml":[{"scroll-ml":[t]}],"scroll-p":[{"scroll-p":[t]}],"scroll-px":[{"scroll-px":[t]}],"scroll-py":[{"scroll-py":[t]}],"scroll-ps":[{"scroll-ps":[t]}],"scroll-pe":[{"scroll-pe":[t]}],"scroll-pt":[{"scroll-pt":[t]}],"scroll-pr":[{"scroll-pr":[t]}],"scroll-pb":[{"scroll-pb":[t]}],"scroll-pl":[{"scroll-pl":[t]}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Qr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[js,Cy]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var dA=s4(h4);function Lt(...e){return dA(lA(e))}var Su=ae(vt(),1),Pd=wu.forwardRef(({className:e,...t},r)=>(0,Su.jsx)("div",{ref:r,className:Lt("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Pd.displayName="Card";var Ld=wu.forwardRef(({className:e,...t},r)=>(0,Su.jsx)("div",{ref:r,className:Lt("flex flex-col space-y-1.5 p-6",e),...t}));Ld.displayName="CardHeader";var Fd=wu.forwardRef(({className:e,...t},r)=>(0,Su.jsx)("h3",{ref:r,className:Lt("text-lg font-semibold leading-none tracking-tight",e),...t}));Fd.displayName="CardTitle";var pA=wu.forwardRef(({className:e,...t},r)=>(0,Su.jsx)("p",{ref:r,className:Lt("text-sm text-muted-foreground",e),...t}));pA.displayName="CardDescription";var Dd=wu.forwardRef(({className:e,...t},r)=>(0,Su.jsx)("div",{ref:r,className:Lt("p-6 pt-0",e),...t}));Dd.displayName="CardContent";var aae=wu.forwardRef(({className:e,...t},r)=>(0,Su.jsx)("div",{ref:r,className:Lt(" flex items-center p-6 pt-0",e),...t}));aae.displayName="CardFooter";var V0=ae(Je(),1);function Ye(){return Ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ye.apply(this,arguments)}var Pn=ae(Je(),1);function gt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(i){if(e?.(i),r===!1||!i.defaultPrevented)return t?.(i)}}var ua=ae(Je(),1);function oi(e,t=[]){let r=[];function n(s,a){let o=(0,ua.createContext)(a),l=r.length;r=[...r,a];function c(u){let{scope:d,children:p,..._}=u,w=d?.[e][l]||o,k=(0,ua.useMemo)(()=>_,Object.values(_));return(0,ua.createElement)(w.Provider,{value:k},p)}function f(u,d){let p=d?.[e][l]||o,_=(0,ua.useContext)(p);if(_)return _;if(a!==void 0)return a;throw new Error(`\`${u}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,f]}let i=()=>{let s=r.map(a=>(0,ua.createContext)(a));return function(o){let l=o?.[e]||s;return(0,ua.useMemo)(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return i.scopeName=e,[n,oae(i,...t)]}function oae(...e){let t=e[0];if(e.length===1)return t;let r=()=>{let n=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){let a=n.reduce((o,{useScope:l,scopeName:c})=>{let u=l(s)[`__scope${c}`];return{...o,...u}},{});return(0,ua.useMemo)(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}var Tr=ae(Je(),1);var fa=ae(Je(),1);var b4=ae(Je(),1);function lae(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function xu(...e){return t=>e.forEach(r=>lae(r,t))}function hr(...e){return(0,b4.useCallback)(xu(...e),e)}var Gr=ae(Je(),1);var Bs=(0,Gr.forwardRef)((e,t)=>{let{children:r,...n}=e,i=Gr.Children.toArray(r),s=i.find(uae);if(s){let a=s.props.children,o=i.map(l=>l===s?Gr.Children.count(a)>1?Gr.Children.only(null):(0,Gr.isValidElement)(a)?a.props.children:null:l);return(0,Gr.createElement)(hA,Ye({},n,{ref:t}),(0,Gr.isValidElement)(a)?(0,Gr.cloneElement)(a,void 0,o):null)}return(0,Gr.createElement)(hA,Ye({},n,{ref:t}),r)});Bs.displayName="Slot";var hA=(0,Gr.forwardRef)((e,t)=>{let{children:r,...n}=e;return(0,Gr.isValidElement)(r)?(0,Gr.cloneElement)(r,{...fae(n,r.props),ref:t?xu(t,r.ref):r.ref}):Gr.Children.count(r)>1?Gr.Children.only(null):null});hA.displayName="SlotClone";var cae=({children:e})=>(0,Gr.createElement)(Gr.Fragment,null,e);function uae(e){return(0,Gr.isValidElement)(e)&&e.type===cae}function fae(e,t){let r={...t};for(let n in t){let i=e[n],s=t[n];/^on[A-Z]/.test(n)?i&&s?r[n]=(...o)=>{s(...o),i(...o)}:i&&(r[n]=i):n==="style"?r[n]={...i,...s}:n==="className"&&(r[n]=[i,s].filter(Boolean).join(" "))}return{...e,...r}}function jd(e){let t=e+"CollectionProvider",[r,n]=oi(t),[i,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),a=p=>{let{scope:_,children:w}=p,k=fa.default.useRef(null),S=fa.default.useRef(new Map).current;return fa.default.createElement(i,{scope:_,itemMap:S,collectionRef:k},w)},o=e+"CollectionSlot",l=fa.default.forwardRef((p,_)=>{let{scope:w,children:k}=p,S=s(o,w),O=hr(_,S.collectionRef);return fa.default.createElement(Bs,{ref:O},k)}),c=e+"CollectionItemSlot",f="data-radix-collection-item",u=fa.default.forwardRef((p,_)=>{let{scope:w,children:k,...S}=p,O=fa.default.useRef(null),A=hr(_,O),C=s(c,w);return fa.default.useEffect(()=>(C.itemMap.set(O,{ref:O,...S}),()=>void C.itemMap.delete(O))),fa.default.createElement(Bs,{[f]:"",ref:A},k)});function d(p){let _=s(e+"CollectionConsumer",p);return fa.default.useCallback(()=>{let k=_.collectionRef.current;if(!k)return[];let S=Array.from(k.querySelectorAll(`[${f}]`));return Array.from(_.itemMap.values()).sort((C,I)=>S.indexOf(C.ref.current)-S.indexOf(I.ref.current))},[_.collectionRef,_.itemMap])}return[{Provider:a,Slot:l,ItemSlot:u},d,n]}var gA=ae(Je(),1);var v4=ae(Je(),1),Nn=globalThis?.document?v4.useLayoutEffect:()=>{};var dae=gA["useId".toString()]||(()=>{}),pae=0;function da(e){let[t,r]=gA.useState(dae());return Nn(()=>{e||r(n=>n??String(pae++))},[e]),e||(t?`radix-${t}`:"")}var Bd=ae(Je(),1),_4=ae(Va(),1);var hae=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Tt=hae.reduce((e,t)=>{let r=(0,Bd.forwardRef)((n,i)=>{let{asChild:s,...a}=n,o=s?Bs:t;return(0,Bd.useEffect)(()=>{window[Symbol.for("radix-ui")]=!0},[]),(0,Bd.createElement)(o,Ye({},a,{ref:i}))});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function $0(e,t){e&&(0,_4.flushSync)(()=>e.dispatchEvent(t))}var Md=ae(Je(),1);function cn(e){let t=(0,Md.useRef)(e);return(0,Md.useEffect)(()=>{t.current=e}),(0,Md.useMemo)(()=>(...r)=>{var n;return(n=t.current)===null||n===void 0?void 0:n.call(t,...r)},[])}var Hl=ae(Je(),1);function $o({prop:e,defaultProp:t,onChange:r=()=>{}}){let[n,i]=gae({defaultProp:t,onChange:r}),s=e!==void 0,a=s?e:n,o=cn(r),l=(0,Hl.useCallback)(c=>{if(s){let u=typeof c=="function"?c(e):c;u!==e&&o(u)}else i(c)},[s,e,i,o]);return[a,l]}function gae({defaultProp:e,onChange:t}){let r=(0,Hl.useState)(e),[n]=r,i=(0,Hl.useRef)(n),s=cn(t);return(0,Hl.useEffect)(()=>{i.current!==n&&(s(n),i.current=n)},[n,i,s]),r}var Iy=ae(Je(),1),yae=(0,Iy.createContext)(void 0);function Wl(e){let t=(0,Iy.useContext)(yae);return e||t||"ltr"}var yA="rovingFocusGroup.onEntryFocus",mae={bubbles:!1,cancelable:!0},bA="RovingFocusGroup",[mA,w4,bae]=jd(bA),[vae,Rd]=oi(bA,[bae]),[_ae,wae]=vae(bA),Sae=(0,Tr.forwardRef)((e,t)=>(0,Tr.createElement)(mA.Provider,{scope:e.__scopeRovingFocusGroup},(0,Tr.createElement)(mA.Slot,{scope:e.__scopeRovingFocusGroup},(0,Tr.createElement)(xae,Ye({},e,{ref:t}))))),xae=(0,Tr.forwardRef)((e,t)=>{let{__scopeRovingFocusGroup:r,orientation:n,loop:i=!1,dir:s,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,...f}=e,u=(0,Tr.useRef)(null),d=hr(t,u),p=Wl(s),[_=null,w]=$o({prop:a,defaultProp:o,onChange:l}),[k,S]=(0,Tr.useState)(!1),O=cn(c),A=w4(r),C=(0,Tr.useRef)(!1),[I,D]=(0,Tr.useState)(0);return(0,Tr.useEffect)(()=>{let L=u.current;if(L)return L.addEventListener(yA,O),()=>L.removeEventListener(yA,O)},[O]),(0,Tr.createElement)(_ae,{scope:r,orientation:n,dir:p,loop:i,currentTabStopId:_,onItemFocus:(0,Tr.useCallback)(L=>w(L),[w]),onItemShiftTab:(0,Tr.useCallback)(()=>S(!0),[]),onFocusableItemAdd:(0,Tr.useCallback)(()=>D(L=>L+1),[]),onFocusableItemRemove:(0,Tr.useCallback)(()=>D(L=>L-1),[])},(0,Tr.createElement)(Tt.div,Ye({tabIndex:k||I===0?-1:0,"data-orientation":n},f,{ref:d,style:{outline:"none",...e.style},onMouseDown:gt(e.onMouseDown,()=>{C.current=!0}),onFocus:gt(e.onFocus,L=>{let U=!C.current;if(L.target===L.currentTarget&&U&&!k){let te=new CustomEvent(yA,mae);if(L.currentTarget.dispatchEvent(te),!te.defaultPrevented){let V=A().filter(de=>de.focusable),X=V.find(de=>de.active),Z=V.find(de=>de.id===_),pe=[X,Z,...V].filter(Boolean).map(de=>de.ref.current);S4(pe)}}C.current=!1}),onBlur:gt(e.onBlur,()=>S(!1))})))}),kae="RovingFocusGroupItem",Eae=(0,Tr.forwardRef)((e,t)=>{let{__scopeRovingFocusGroup:r,focusable:n=!0,active:i=!1,tabStopId:s,...a}=e,o=da(),l=s||o,c=wae(kae,r),f=c.currentTabStopId===l,u=w4(r),{onFocusableItemAdd:d,onFocusableItemRemove:p}=c;return(0,Tr.useEffect)(()=>{if(n)return d(),()=>p()},[n,d,p]),(0,Tr.createElement)(mA.ItemSlot,{scope:r,id:l,focusable:n,active:i},(0,Tr.createElement)(Tt.span,Ye({tabIndex:f?0:-1,"data-orientation":c.orientation},a,{ref:t,onMouseDown:gt(e.onMouseDown,_=>{n?c.onItemFocus(l):_.preventDefault()}),onFocus:gt(e.onFocus,()=>c.onItemFocus(l)),onKeyDown:gt(e.onKeyDown,_=>{if(_.key==="Tab"&&_.shiftKey){c.onItemShiftTab();return}if(_.target!==_.currentTarget)return;let w=Tae(_,c.orientation,c.dir);if(w!==void 0){_.preventDefault();let S=u().filter(O=>O.focusable).map(O=>O.ref.current);if(w==="last")S.reverse();else if(w==="prev"||w==="next"){w==="prev"&&S.reverse();let O=S.indexOf(_.currentTarget);S=c.loop?Cae(S,O+1):S.slice(O+1)}setTimeout(()=>S4(S))}})})))}),Oae={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Aae(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Tae(e,t,r){let n=Aae(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Oae[n]}function S4(e){let t=document.activeElement;for(let r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function Cae(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var U0=Sae,z0=Eae;var li=ae(Je(),1),x4=ae(Va(),1);function Iae(e,t){return(0,li.useReducer)((r,n)=>{let i=t[r][n];return i??r},e)}var Jl=e=>{let{present:t,children:r}=e,n=Nae(t),i=typeof r=="function"?r({present:n.isPresent}):li.Children.only(r),s=hr(n.ref,i.ref);return typeof r=="function"||n.isPresent?(0,li.cloneElement)(i,{ref:s}):null};Jl.displayName="Presence";function Nae(e){let[t,r]=(0,li.useState)(),n=(0,li.useRef)({}),i=(0,li.useRef)(e),s=(0,li.useRef)("none"),a=e?"mounted":"unmounted",[o,l]=Iae(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,li.useEffect)(()=>{let c=q0(n.current);s.current=o==="mounted"?c:"none"},[o]),Nn(()=>{let c=n.current,f=i.current;if(f!==e){let d=s.current,p=q0(c);e?l("MOUNT"):p==="none"||c?.display==="none"?l("UNMOUNT"):l(f&&d!==p?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,l]),Nn(()=>{if(t){let c=u=>{let p=q0(n.current).includes(u.animationName);u.target===t&&p&&(0,x4.flushSync)(()=>l("ANIMATION_END"))},f=u=>{u.target===t&&(s.current=q0(n.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",c),t.addEventListener("animationend",c),()=>{t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",c),t.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:(0,li.useCallback)(c=>{c&&(n.current=getComputedStyle(c)),r(c)},[])}}function q0(e){return e?.animationName||"none"}var k4="Tabs",[Pae,eje]=oi(k4,[Rd]),E4=Rd(),[Lae,vA]=Pae(k4),Fae=(0,Pn.forwardRef)((e,t)=>{let{__scopeTabs:r,value:n,onValueChange:i,defaultValue:s,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,f=Wl(o),[u,d]=$o({prop:n,onChange:i,defaultProp:s});return(0,Pn.createElement)(Lae,{scope:r,baseId:da(),value:u,onValueChange:d,orientation:a,dir:f,activationMode:l},(0,Pn.createElement)(Tt.div,Ye({dir:f,"data-orientation":a},c,{ref:t})))}),Dae="TabsList",jae=(0,Pn.forwardRef)((e,t)=>{let{__scopeTabs:r,loop:n=!0,...i}=e,s=vA(Dae,r),a=E4(r);return(0,Pn.createElement)(U0,Ye({asChild:!0},a,{orientation:s.orientation,dir:s.dir,loop:n}),(0,Pn.createElement)(Tt.div,Ye({role:"tablist","aria-orientation":s.orientation},i,{ref:t})))}),Bae="TabsTrigger",Mae=(0,Pn.forwardRef)((e,t)=>{let{__scopeTabs:r,value:n,disabled:i=!1,...s}=e,a=vA(Bae,r),o=E4(r),l=O4(a.baseId,n),c=A4(a.baseId,n),f=n===a.value;return(0,Pn.createElement)(z0,Ye({asChild:!0},o,{focusable:!i,active:f}),(0,Pn.createElement)(Tt.button,Ye({type:"button",role:"tab","aria-selected":f,"aria-controls":c,"data-state":f?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:l},s,{ref:t,onMouseDown:gt(e.onMouseDown,u=>{!i&&u.button===0&&u.ctrlKey===!1?a.onValueChange(n):u.preventDefault()}),onKeyDown:gt(e.onKeyDown,u=>{[" ","Enter"].includes(u.key)&&a.onValueChange(n)}),onFocus:gt(e.onFocus,()=>{let u=a.activationMode!=="manual";!f&&!i&&u&&a.onValueChange(n)})})))}),Rae="TabsContent",$ae=(0,Pn.forwardRef)((e,t)=>{let{__scopeTabs:r,value:n,forceMount:i,children:s,...a}=e,o=vA(Rae,r),l=O4(o.baseId,n),c=A4(o.baseId,n),f=n===o.value,u=(0,Pn.useRef)(f);return(0,Pn.useEffect)(()=>{let d=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(d)},[]),(0,Pn.createElement)(Jl,{present:i||f},({present:d})=>(0,Pn.createElement)(Tt.div,Ye({"data-state":f?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!d,id:c,tabIndex:0},a,{ref:t,style:{...e.style,animationDuration:u.current?"0s":void 0}}),d&&s))});function O4(e,t){return`${e}-trigger-${t}`}function A4(e,t){return`${e}-content-${t}`}var T4=Fae,_A=jae,wA=Mae,SA=$ae;var W0=ae(vt(),1),C4=T4,xA=V0.forwardRef(({className:e,...t},r)=>(0,W0.jsx)(_A,{ref:r,className:Lt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));xA.displayName=_A.displayName;var $d=V0.forwardRef(({className:e,...t},r)=>(0,W0.jsx)(wA,{ref:r,className:Lt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));$d.displayName=wA.displayName;var H0=V0.forwardRef(({className:e,...t},r)=>(0,W0.jsx)(SA,{ref:r,className:Lt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));H0.displayName=SA.displayName;var h2=ae(Je()),M6=ae(Kr());var P6=ae(Ms()),L6=ae(mn()),F6=ae(G0()),RA=ae(Eu()),Wd=ae(Rs()),Tu=ae(Yr()),Jd=ae(Je()),D6=ae(b6());var w6=ae(Eu()),S6=ae(Yr()),DA=ae(FA()),x6=ae(LA()),f2=ae(G0()),Kn=function(t){return t===0?0:t>0?1:-1},qo=function(t){return(0,f2.default)(t)&&t.indexOf("%")===t.length-1},qe=function(t){return(0,x6.default)(t)&&!(0,DA.default)(t)},Cr=function(t){return qe(t)||(0,f2.default)(t)},Hce=0,Ga=function(t){var r=++Hce;return"".concat(t||"").concat(r)},Ka=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!qe(t)&&!(0,f2.default)(t))return n;var s;if(qo(t)){var a=t.indexOf("%");s=r*parseFloat(t.slice(0,a))/100}else s=+t;return(0,DA.default)(s)&&(s=n),i&&s>r&&(s=r),s},Vo=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},k6=function(t){if(!(0,S6.default)(t))return!1;for(var r=t.length,n={},i=0;i<r;i++)if(!n[t[i]])n[t[i]]=!0;else return!0;return!1},ys=function(t,r){return qe(t)&&qe(r)?function(n){return t+n*(r-t)}:function(){return r}};function Hd(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):(0,w6.default)(n,t))===r})}function Ho(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}var BA=ae(Ms()),O6=ae(Je());function jA(e){"@babel/helpers - typeof";return jA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jA(e)}var Wce=["viewBox","children"],A6=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],E6=["points","pathLength"],d2={svg:Wce,polygon:E6,polyline:E6},p2=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Ou=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if((0,O6.isValidElement)(t)&&(n=t.props),!(0,BA.default)(n))return null;var i={};return Object.keys(n).forEach(function(s){p2.includes(s)&&(i[s]=r||function(a){return n[s](n,a)})}),i},Jce=function(t,r,n){return function(i){return t(r,n,i),null}},Au=function(t,r,n){if(!(0,BA.default)(t)||jA(t)!=="object")return null;var i=null;return Object.keys(t).forEach(function(s){var a=t[s];p2.includes(s)&&typeof a=="function"&&(i||(i={}),i[s]=Jce(a,r,n))}),i};var Gce=["children"],Kce=["children"];function T6(e,t){if(e==null)return{};var r=Yce(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Yce(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}var C6={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"};var Ya=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},I6=null,MA=null,$A=function e(t){if(t===I6&&(0,Tu.default)(MA))return MA;var r=[];return Jd.Children.forEach(t,function(n){(0,Wd.default)(n)||((0,D6.isFragment)(n)?r=r.concat(e(n.props.children)):r.push(n))}),MA=r,I6=t,r};function En(e,t){var r=[],n=[];return(0,Tu.default)(t)?n=t.map(function(i){return Ya(i)}):n=[Ya(t)],$A(e).forEach(function(i){var s=(0,RA.default)(i,"type.displayName")||(0,RA.default)(i,"type.name");n.indexOf(s)!==-1&&r.push(i)}),r}function $s(e,t){var r=En(e,t);return r&&r[0]}var UA=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,i=r.height;return!(!qe(n)||n<=0||!qe(i)||i<=0)},Xce=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Zce=function(t){return t&&t.type&&(0,F6.default)(t.type)&&Xce.indexOf(t.type)>=0},Qce=function(t,r,n,i){var s,a=(s=d2===null||d2===void 0?void 0:d2[i])!==null&&s!==void 0?s:[];return!(0,L6.default)(t)&&(i&&a.includes(r)||A6.includes(r))||n&&p2.includes(r)};var yt=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if((0,Jd.isValidElement)(t)&&(i=t.props),!(0,P6.default)(i))return null;var s={};return Object.keys(i).forEach(function(a){var o;Qce((o=i)===null||o===void 0?void 0:o[a],a,r,n)&&(s[a]=i[a])}),s},zA=function e(t,r){if(t===r)return!0;var n=Jd.Children.count(t);if(n!==Jd.Children.count(r))return!1;if(n===0)return!0;if(n===1)return N6((0,Tu.default)(t)?t[0]:t,(0,Tu.default)(r)?r[0]:r);for(var i=0;i<n;i++){var s=t[i],a=r[i];if((0,Tu.default)(s)||(0,Tu.default)(a)){if(!e(s,a))return!1}else if(!N6(s,a))return!1}return!0},N6=function(t,r){if((0,Wd.default)(t)&&(0,Wd.default)(r))return!0;if(!(0,Wd.default)(t)&&!(0,Wd.default)(r)){var n=t.props||{},i=n.children,s=T6(n,Gce),a=r.props||{},o=a.children,l=T6(a,Kce);return i&&o?Ho(s,l)&&zA(i,o):!i&&!o?Ho(s,l):!1}return!1},qA=function(t,r){var n=[],i={};return $A(t).forEach(function(s,a){if(Zce(s))n.push(s);else if(s){var o=Ya(s.type),l=r[o]||{},c=l.handler,f=l.once;if(c&&(!f||!i[o])){var u=c(s,o,a);n.push(u),i[o]=!0}}}),n},j6=function(t){var r=t&&t.type;return r&&C6[r]?C6[r]:null},B6=function(t,r){return $A(r).indexOf(t)};var eue=["children","width","height","viewBox","className","style"];function VA(){return VA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VA.apply(this,arguments)}function tue(e,t){if(e==null)return{};var r=rue(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rue(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function By(e){var t=e.children,r=e.width,n=e.height,i=e.viewBox,s=e.className,a=e.style,o=tue(e,eue),l=i||{width:r,height:n,x:0,y:0},c=(0,M6.default)("recharts-surface",s);return h2.default.createElement("svg",VA({},yt(o,!0,"svg"),{className:c,width:r,height:n,style:a,viewBox:"".concat(l.x," ").concat(l.y," ").concat(l.width," ").concat(l.height)}),h2.default.createElement("title",null,e.title),h2.default.createElement("desc",null,e.desc),t)}var WA=ae(Je()),R6=ae(Kr());var nue=["children","className"];function HA(){return HA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HA.apply(this,arguments)}function iue(e,t){if(e==null)return{};var r=sue(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function sue(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}var or=WA.default.forwardRef(function(e,t){var r=e.children,n=e.className,i=iue(e,nue),s=(0,R6.default)("recharts-layer",n);return WA.default.createElement("g",HA({className:s},yt(i,!0),{ref:t}),r)});var ZT=ae(mn()),YT=ae(gT()),Yl=ae(Je());var ms=ae(Je()),hz=ae(Kr());var JT=ae(S2()),C2=ae(Je());function lr(e){return function(){return e}}var vT=Math.cos;var zy=Math.sin,Fn=Math.sqrt;var Nu=Math.PI,VMe=Nu/2,Qd=2*Nu;var _T=Math.PI,wT=2*_T,Pu=1e-6,Tge=wT-Pu;function VU(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Cge(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return VU;let r=10**t;return function(n){this._+=n[0];for(let i=1,s=n.length;i<s;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}var Lu=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?VU:Cge(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,s,a){this._append`C${+t},${+r},${+n},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(t,r,n,i,s){if(t=+t,r=+r,n=+n,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=n-t,c=i-r,f=a-t,u=o-r,d=f*f+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(d>Pu)if(!(Math.abs(u*l-c*f)>Pu)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-a,_=i-o,w=l*l+c*c,k=p*p+_*_,S=Math.sqrt(w),O=Math.sqrt(d),A=s*Math.tan((_T-Math.acos((w+d-k)/(2*S*O)))/2),C=A/O,I=A/S;Math.abs(C-1)>Pu&&this._append`L${t+C*f},${r+C*u}`,this._append`A${s},${s},0,0,${+(u*p>f*_)},${this._x1=t+I*l},${this._y1=r+I*c}`}}arc(t,r,n,i,s,a){if(t=+t,r=+r,n=+n,a=!!a,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),l=n*Math.sin(i),c=t+o,f=r+l,u=1^a,d=a?i-s:s-i;this._x1===null?this._append`M${c},${f}`:(Math.abs(this._x1-c)>Pu||Math.abs(this._y1-f)>Pu)&&this._append`L${c},${f}`,n&&(d<0&&(d=d%wT+wT),d>Tge?this._append`A${n},${n},0,1,${u},${t-o},${r-l}A${n},${n},0,1,${u},${this._x1=c},${this._y1=f}`:d>Pu&&this._append`A${n},${n},0,${+(d>=_T)},${u},${this._x1=t+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}};function HU(){return new Lu}HU.prototype=Lu.prototype;function ep(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{let n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Lu(t)}var ZMe=Array.prototype.slice;function tp(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function WU(e){this._context=e}WU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Kl(e){return new WU(e)}function x2(e){return e[0]}function k2(e){return e[1]}function qy(e,t){var r=lr(!0),n=null,i=Kl,s=null,a=ep(o);e=typeof e=="function"?e:e===void 0?x2:lr(e),t=typeof t=="function"?t:t===void 0?k2:lr(t);function o(l){var c,f=(l=tp(l)).length,u,d=!1,p;for(n==null&&(s=i(p=a())),c=0;c<=f;++c)!(c<f&&r(u=l[c],c,l))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+e(u,c,l),+t(u,c,l));if(p)return s=null,p+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:lr(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:lr(+l),o):t},o.defined=function(l){return arguments.length?(r=typeof l=="function"?l:lr(!!l),o):r},o.curve=function(l){return arguments.length?(i=l,n!=null&&(s=i(n)),o):i},o.context=function(l){return arguments.length?(l==null?n=s=null:s=i(n=l),o):n},o}function rp(e,t,r){var n=null,i=lr(!0),s=null,a=Kl,o=null,l=ep(c);e=typeof e=="function"?e:e===void 0?x2:lr(+e),t=typeof t=="function"?t:t===void 0?lr(0):lr(+t),r=typeof r=="function"?r:r===void 0?k2:lr(+r);function c(u){var d,p,_,w=(u=tp(u)).length,k,S=!1,O,A=new Array(w),C=new Array(w);for(s==null&&(o=a(O=l())),d=0;d<=w;++d){if(!(d<w&&i(k=u[d],d,u))===S)if(S=!S)p=d,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),_=d-1;_>=p;--_)o.point(A[_],C[_]);o.lineEnd(),o.areaEnd()}S&&(A[d]=+e(k,d,u),C[d]=+t(k,d,u),o.point(n?+n(k,d,u):A[d],r?+r(k,d,u):C[d]))}if(O)return o=null,O+""||null}function f(){return qy().defined(i).curve(a).context(s)}return c.x=function(u){return arguments.length?(e=typeof u=="function"?u:lr(+u),n=null,c):e},c.x0=function(u){return arguments.length?(e=typeof u=="function"?u:lr(+u),c):e},c.x1=function(u){return arguments.length?(n=u==null?null:typeof u=="function"?u:lr(+u),c):n},c.y=function(u){return arguments.length?(t=typeof u=="function"?u:lr(+u),r=null,c):t},c.y0=function(u){return arguments.length?(t=typeof u=="function"?u:lr(+u),c):t},c.y1=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:lr(+u),c):r},c.lineX0=c.lineY0=function(){return f().x(e).y(t)},c.lineY1=function(){return f().x(e).y(r)},c.lineX1=function(){return f().x(n).y(t)},c.defined=function(u){return arguments.length?(i=typeof u=="function"?u:lr(!!u),c):i},c.curve=function(u){return arguments.length?(a=u,s!=null&&(o=a(s)),c):a},c.context=function(u){return arguments.length?(u==null?s=o=null:o=a(s=u),c):s},c}var np={draw(e,t){let r=Fn(t/Nu);e.moveTo(r,0),e.arc(0,0,r,0,Qd)}};var ST={draw(e,t){let r=Fn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}};var JU=Fn(1/3),Ige=JU*2,xT={draw(e,t){let r=Fn(t/Ige),n=r*JU;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}};var kT={draw(e,t){let r=Fn(t),n=-r/2;e.rect(n,n,r,r)}};var Nge=.8908130915292852,GU=zy(Nu/10)/zy(7*Nu/10),Pge=zy(Qd/10)*GU,Lge=-vT(Qd/10)*GU,ET={draw(e,t){let r=Fn(t*Nge),n=Pge*r,i=Lge*r;e.moveTo(0,-r),e.lineTo(n,i);for(let s=1;s<5;++s){let a=Qd*s/5,o=vT(a),l=zy(a);e.lineTo(l*r,-o*r),e.lineTo(o*n-l*i,l*n+o*i)}e.closePath()}};var OT=Fn(3),AT={draw(e,t){let r=-Fn(t/(OT*3));e.moveTo(0,r*2),e.lineTo(-OT*r,-r),e.lineTo(OT*r,-r),e.closePath()}};var Us=-.5,zs=Fn(3)/2,TT=1/Fn(12),Fge=(TT/2+1)*3,CT={draw(e,t){let r=Fn(t/Fge),n=r/2,i=r*TT,s=n,a=r*TT+r,o=-s,l=a;e.moveTo(n,i),e.lineTo(s,a),e.lineTo(o,l),e.lineTo(Us*n-zs*i,zs*n+Us*i),e.lineTo(Us*s-zs*a,zs*s+Us*a),e.lineTo(Us*o-zs*l,zs*o+Us*l),e.lineTo(Us*n+zs*i,Us*i-zs*n),e.lineTo(Us*s+zs*a,Us*a-zs*s),e.lineTo(Us*o+zs*l,Us*l-zs*o),e.closePath()}};function E2(e,t){let r=null,n=ep(i);e=typeof e=="function"?e:lr(e||np),t=typeof t=="function"?t:lr(t===void 0?64:+t);function i(){let s;if(r||(r=s=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:lr(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:lr(+s),i):t},i.context=function(s){return arguments.length?(r=s??null,i):r},i}function ip(){}function sp(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function KU(e){this._context=e}KU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:sp(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:sp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function IT(e){return new KU(e)}function YU(e){this._context=e}YU.prototype={areaStart:ip,areaEnd:ip,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:sp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function NT(e){return new YU(e)}function XU(e){this._context=e}XU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:sp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function PT(e){return new XU(e)}function ZU(e){this._context=e}ZU.prototype={areaStart:ip,areaEnd:ip,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function LT(e){return new ZU(e)}function QU(e){return e<0?-1:1}function ez(e,t,r){var n=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(n||i<0&&-0),a=(r-e._y1)/(i||n<0&&-0),o=(s*i+a*n)/(n+i);return(QU(s)+QU(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function tz(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function FT(e,t,r){var n=e._x0,i=e._y0,s=e._x1,a=e._y1,o=(s-n)/3;e._context.bezierCurveTo(n+o,i+o*t,s-o,a-o*r,s,a)}function O2(e){this._context=e}O2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:FT(this,this._t0,tz(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,FT(this,tz(this,r=ez(this,e,t)),r);break;default:FT(this,this._t0,r=ez(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function rz(e){this._context=new nz(e)}(rz.prototype=Object.create(O2.prototype)).point=function(e,t){O2.prototype.point.call(this,t,e)};function nz(e){this._context=e}nz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,s){this._context.bezierCurveTo(t,e,n,r,s,i)}};function DT(e){return new O2(e)}function jT(e){return new rz(e)}function sz(e){this._context=e}sz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=iz(e),i=iz(t),s=0,a=1;a<r;++s,++a)this._context.bezierCurveTo(n[0][s],i[0][s],n[1][s],i[1][s],e[a],t[a]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function iz(e){var t,r=e.length-1,n,i=new Array(r),s=new Array(r),a=new Array(r);for(i[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,s[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/s[t-1],s[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/s[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/s[t];for(s[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function BT(e){return new sz(e)}function A2(e,t){this._context=e,this._t=t}A2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function MT(e){return new A2(e,.5)}function RT(e){return new A2(e,0)}function $T(e){return new A2(e,1)}function qs(e,t){if((a=e.length)>1)for(var r=1,n,i,s=e[t[0]],a,o=s.length;r<a;++r)for(i=s,s=e[t[r]],n=0;n<o;++n)s[n][1]+=s[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function ap(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Dge(e,t){return e[t]}function jge(e){let t=[];return t.key=e,t}function UT(){var e=lr([]),t=ap,r=qs,n=Dge;function i(s){var a=Array.from(e.apply(this,arguments),jge),o,l=a.length,c=-1,f;for(let u of s)for(o=0,++c;o<l;++o)(a[o][c]=[0,+n(u,a[o].key,c,s)]).data=u;for(o=0,f=tp(t(a));o<l;++o)a[f[o]].index=o;return r(a,f),a}return i.keys=function(s){return arguments.length?(e=typeof s=="function"?s:lr(Array.from(s)),i):e},i.value=function(s){return arguments.length?(n=typeof s=="function"?s:lr(+s),i):n},i.order=function(s){return arguments.length?(t=s==null?ap:typeof s=="function"?s:lr(Array.from(s)),i):t},i.offset=function(s){return arguments.length?(r=s??qs,i):r},i}function zT(e,t){if((n=e.length)>0){for(var r,n,i=0,s=e[0].length,a;i<s;++i){for(a=r=0;r<n;++r)a+=e[r][i][1]||0;if(a)for(r=0;r<n;++r)e[r][i][1]/=a}qs(e,t)}}function qT(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,s=n.length;r<s;++r){for(var a=0,o=0;a<i;++a)o+=e[a][r][1]||0;n[r][1]+=n[r][0]=-o/2}qs(e,t)}}function VT(e,t){if(!(!((a=e.length)>0)||!((s=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,s,a;n<s;++n){for(var o=0,l=0,c=0;o<a;++o){for(var f=e[t[o]],u=f[n][1]||0,d=f[n-1][1]||0,p=(u-d)/2,_=0;_<o;++_){var w=e[t[_]],k=w[n][1]||0,S=w[n-1][1]||0;p+=k-S}l+=u,c+=p*u}i[n-1][1]+=i[n-1][0]=r,l&&(r-=c/l)}i[n-1][1]+=i[n-1][0]=r,qs(e,t)}}var cz=ae(Kr());function op(e){"@babel/helpers - typeof";return op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},op(e)}function HT(){return HT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HT.apply(this,arguments)}function Mge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function az(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lz(n.key),n)}}function Rge(e,t,r){return t&&az(e.prototype,t),r&&az(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $ge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WT(e,t)}function WT(e,t){return WT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WT(e,t)}function Uge(e){var t=Vge();return function(){var n=T2(e),i;if(t){var s=T2(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return zge(this,i)}}function zge(e,t){if(t&&(op(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qge(e)}function qge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T2(e){return T2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},T2(e)}function oz(e,t,r){return t=lz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lz(e){var t=Hge(e,"string");return op(t)==="symbol"?t:String(t)}function Hge(e,t){if(op(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(op(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uz={symbolCircle:np,symbolCross:ST,symbolDiamond:xT,symbolSquare:kT,symbolStar:ET,symbolTriangle:AT,symbolWye:CT},Wge=Math.PI/180,Jge=function(t){var r="symbol".concat((0,JT.default)(t));return uz[r]||np},Gge=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var i=18*Wge;return 1.25*t*t*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},I2=function(e){$ge(r,e);var t=Uge(r);function r(){return Mge(this,r),t.apply(this,arguments)}return Rge(r,[{key:"getPath",value:function(){var i=this.props,s=i.size,a=i.sizeType,o=i.type,l=Jge(o),c=E2().type(l).size(Gge(s,a,o));return c()}},{key:"render",value:function(){var i=this.props,s=i.className,a=i.cx,o=i.cy,l=i.size,c=yt(this.props,!0);return a===+a&&o===+o&&l===+l?C2.default.createElement("path",HT({},c,{className:(0,cz.default)("recharts-symbols",s),transform:"translate(".concat(a,", ").concat(o,")"),d:this.getPath()})):null}}]),r}(C2.PureComponent);oz(I2,"defaultProps",{type:"circle",size:64,sizeType:"area"});oz(I2,"registerSymbol",function(e,t){uz["symbol".concat((0,JT.default)(e))]=t});function lp(e){"@babel/helpers - typeof";return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lp(e)}function GT(){return GT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GT.apply(this,arguments)}function fz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Kge(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fz(Object(r),!0).forEach(function(n){Vy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pz(n.key),n)}}function Xge(e,t,r){return t&&dz(e.prototype,t),r&&dz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KT(e,t)}function KT(e,t){return KT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},KT(e,t)}function Qge(e){var t=rye();return function(){var n=N2(e),i;if(t){var s=N2(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return eye(this,i)}}function eye(e,t){if(t&&(lp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tye(e)}function tye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function N2(e){return N2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},N2(e)}function Vy(e,t,r){return t=pz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pz(e){var t=nye(e,"string");return lp(t)==="symbol"?t:String(t)}function nye(e,t){if(lp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vs=32,P2=function(e){Zge(r,e);var t=Qge(r);function r(){return Yge(this,r),t.apply(this,arguments)}return Xge(r,[{key:"renderIcon",value:function(i){var s=this.props.inactiveColor,a=Vs/2,o=Vs/6,l=Vs/3,c=i.inactive?s:i.color;if(i.type==="plainline")return ms.default.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:i.payload.strokeDasharray,x1:0,y1:a,x2:Vs,y2:a,className:"recharts-legend-icon"});if(i.type==="line")return ms.default.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(a,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(a,`
            H`).concat(Vs,"M").concat(2*l,",").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(a),className:"recharts-legend-icon"});if(i.type==="rect")return ms.default.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Vs/8,"h").concat(Vs,"v").concat(Vs*3/4,"h").concat(-Vs,"z"),className:"recharts-legend-icon"});if(ms.default.isValidElement(i.legendIcon)){var f=Kge({},i);return delete f.legendIcon,ms.default.cloneElement(i.legendIcon,f)}return ms.default.createElement(I2,{fill:c,cx:a,cy:a,size:Vs,sizeType:"diameter",type:i.type})}},{key:"renderItems",value:function(){var i=this,s=this.props,a=s.payload,o=s.iconSize,l=s.layout,c=s.formatter,f=s.inactiveColor,u={x:0,y:0,width:Vs,height:Vs},d={display:l==="horizontal"?"inline-block":"block",marginRight:10},p={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(_,w){var k,S=_.formatter||c,O=(0,hz.default)((k={"recharts-legend-item":!0},Vy(k,"legend-item-".concat(w),!0),Vy(k,"inactive",_.inactive),k));if(_.type==="none")return null;var A=_.inactive?f:_.color;return ms.default.createElement("li",GT({className:O,style:d,key:"legend-item-".concat(w)},Au(i.props,_,w)),ms.default.createElement(By,{width:o,height:o,viewBox:u,style:p},i.renderIcon(_)),ms.default.createElement("span",{className:"recharts-legend-item-text",style:{color:A}},S?S(_.value,_,w):_.value))})}},{key:"render",value:function(){var i=this.props,s=i.payload,a=i.layout,o=i.align;if(!s||!s.length)return null;var l={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return ms.default.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}]),r}(ms.PureComponent);Vy(P2,"displayName","Legend");Vy(P2,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});function up(e){"@babel/helpers - typeof";return up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},up(e)}var iye=["ref"];function gz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gz(Object(r),!0).forEach(function(n){F2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vz(n.key),n)}}function aye(e,t,r){return t&&yz(e.prototype,t),r&&yz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XT(e,t)}function XT(e,t){return XT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},XT(e,t)}function lye(e){var t=uye();return function(){var n=L2(e),i;if(t){var s=L2(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return cye(this,i)}}function cye(e,t){if(t&&(up(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bz(e)}function bz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function L2(e){return L2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},L2(e)}function F2(e,t,r){return t=vz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vz(e){var t=fye(e,"string");return up(t)==="symbol"?t:String(t)}function fye(e,t){if(up(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(up(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dye(e,t){if(e==null)return{};var r=pye(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function pye(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function hye(e){return e.value}function gye(e,t){return e===!0?(0,YT.default)(t,hye):(0,ZT.default)(e)?(0,YT.default)(t,e):t}function yye(e,t){if(Yl.default.isValidElement(e))return Yl.default.cloneElement(e,t);if((0,ZT.default)(e))return Yl.default.createElement(e,t);var r=t.ref,n=dye(t,iye);return Yl.default.createElement(P2,n)}var mz=1,Fu=function(e){oye(r,e);var t=lye(r);function r(){var n;sye(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=t.call.apply(t,[this].concat(s)),F2(bz(n),"state",{boxWidth:-1,boxHeight:-1}),n}return aye(r,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){return this.wrapperNode&&this.wrapperNode.getBoundingClientRect?this.wrapperNode.getBoundingClientRect():null}},{key:"getBBoxSnapshot",value:function(){var i=this.state,s=i.boxWidth,a=i.boxHeight;return s>=0&&a>=0?{width:s,height:a}:null}},{key:"getDefaultPosition",value:function(i){var s=this.props,a=s.layout,o=s.align,l=s.verticalAlign,c=s.margin,f=s.chartWidth,u=s.chartHeight,d,p;if(!i||(i.left===void 0||i.left===null)&&(i.right===void 0||i.right===null))if(o==="center"&&a==="vertical"){var _=this.getBBoxSnapshot()||{width:0};d={left:((f||0)-_.width)/2}}else d=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!i||(i.top===void 0||i.top===null)&&(i.bottom===void 0||i.bottom===null))if(l==="middle"){var w=this.getBBoxSnapshot()||{height:0};p={top:((u||0)-w.height)/2}}else p=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return cp(cp({},d),p)}},{key:"updateBBox",value:function(){var i=this.state,s=i.boxWidth,a=i.boxHeight,o=this.props.onBBoxUpdate;if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var l=this.wrapperNode.getBoundingClientRect();(Math.abs(l.width-s)>mz||Math.abs(l.height-a)>mz)&&this.setState({boxWidth:l.width,boxHeight:l.height},function(){o&&o(l)})}else(s!==-1||a!==-1)&&this.setState({boxWidth:-1,boxHeight:-1},function(){o&&o(null)})}},{key:"render",value:function(){var i=this,s=this.props,a=s.content,o=s.width,l=s.height,c=s.wrapperStyle,f=s.payloadUniqBy,u=s.payload,d=cp(cp({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return Yl.default.createElement("div",{className:"recharts-legend-wrapper",style:d,ref:function(_){i.wrapperNode=_}},yye(a,cp(cp({},this.props),{},{payload:gye(f,u)})))}}],[{key:"getWithHeight",value:function(i,s){var a=i.props.layout;return a==="vertical"&&qe(i.props.height)?{height:i.props.height}:a==="horizontal"?{width:i.props.width||s}:null}}]),r}(Yl.PureComponent);F2(Fu,"displayName","Legend");F2(Fu,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var Dq=ae(Rs()),UC=ae(mn()),$C=ae(gT()),Xn=ae(Je());var Xa=ae(Je()),ir=ae(Jo());var vye=Object.getOwnPropertyNames,_ye=Object.getOwnPropertySymbols,wye=Object.prototype.hasOwnProperty;function Az(e,t){return function(n,i,s){return e(n,i,s)&&t(n,i,s)}}function D2(e){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,i);var s=i.cache,a=s.get(r),o=s.get(n);if(a&&o)return a===n&&o===r;s.set(r,n),s.set(n,r);var l=e(r,n,i);return s.delete(r),s.delete(n),l}}function Tz(e){return vye(e).concat(_ye(e))}var Dz=Object.hasOwn||function(e,t){return wye.call(e,t)};function fp(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var jz="_owner",Cz=Object.getOwnPropertyDescriptor,Iz=Object.keys;function Sye(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function xye(e,t){return fp(e.getTime(),t.getTime())}function Nz(e,t,r){if(e.size!==t.size)return!1;for(var n={},i=e.entries(),s=0,a,o;(a=i.next())&&!a.done;){for(var l=t.entries(),c=!1,f=0;(o=l.next())&&!o.done;){var u=a.value,d=u[0],p=u[1],_=o.value,w=_[0],k=_[1];!c&&!n[f]&&(c=r.equals(d,w,s,f,e,t,r)&&r.equals(p,k,d,w,e,t,r))&&(n[f]=!0),f++}if(!c)return!1;s++}return!0}function kye(e,t,r){var n=Iz(e),i=n.length;if(Iz(t).length!==i)return!1;for(var s;i-- >0;)if(s=n[i],s===jz&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Dz(t,s)||!r.equals(e[s],t[s],s,s,e,t,r))return!1;return!0}function Hy(e,t,r){var n=Tz(e),i=n.length;if(Tz(t).length!==i)return!1;for(var s,a,o;i-- >0;)if(s=n[i],s===jz&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Dz(t,s)||!r.equals(e[s],t[s],s,s,e,t,r)||(a=Cz(e,s),o=Cz(t,s),(a||o)&&(!a||!o||a.configurable!==o.configurable||a.enumerable!==o.enumerable||a.writable!==o.writable)))return!1;return!0}function Eye(e,t){return fp(e.valueOf(),t.valueOf())}function Oye(e,t){return e.source===t.source&&e.flags===t.flags}function Pz(e,t,r){if(e.size!==t.size)return!1;for(var n={},i=e.values(),s,a;(s=i.next())&&!s.done;){for(var o=t.values(),l=!1,c=0;(a=o.next())&&!a.done;)!l&&!n[c]&&(l=r.equals(s.value,a.value,s.value,a.value,e,t,r))&&(n[c]=!0),c++;if(!l)return!1}return!0}function Aye(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}var Tye="[object Arguments]",Cye="[object Boolean]",Iye="[object Date]",Nye="[object Map]",Pye="[object Number]",Lye="[object Object]",Fye="[object RegExp]",Dye="[object Set]",jye="[object String]",Bye=Array.isArray,Lz=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Fz=Object.assign,Mye=Object.prototype.toString.call.bind(Object.prototype.toString);function Rye(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areMapsEqual,i=e.areObjectsEqual,s=e.arePrimitiveWrappersEqual,a=e.areRegExpsEqual,o=e.areSetsEqual,l=e.areTypedArraysEqual;return function(f,u,d){if(f===u)return!0;if(f==null||u==null||typeof f!="object"||typeof u!="object")return f!==f&&u!==u;var p=f.constructor;if(p!==u.constructor)return!1;if(p===Object)return i(f,u,d);if(Bye(f))return t(f,u,d);if(Lz!=null&&Lz(f))return l(f,u,d);if(p===Date)return r(f,u,d);if(p===RegExp)return a(f,u,d);if(p===Map)return n(f,u,d);if(p===Set)return o(f,u,d);var _=Mye(f);return _===Iye?r(f,u,d):_===Fye?a(f,u,d):_===Nye?n(f,u,d):_===Dye?o(f,u,d):_===Lye?typeof f.then!="function"&&typeof u.then!="function"&&i(f,u,d):_===Tye?i(f,u,d):_===Cye||_===Pye||_===jye?s(f,u,d):!1}}function $ye(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,i={areArraysEqual:n?Hy:Sye,areDatesEqual:xye,areMapsEqual:n?Az(Nz,Hy):Nz,areObjectsEqual:n?Hy:kye,arePrimitiveWrappersEqual:Eye,areRegExpsEqual:Oye,areSetsEqual:n?Az(Pz,Hy):Pz,areTypedArraysEqual:n?Hy:Aye};if(r&&(i=Fz({},i,r(i))),t){var s=D2(i.areArraysEqual),a=D2(i.areMapsEqual),o=D2(i.areObjectsEqual),l=D2(i.areSetsEqual);i=Fz({},i,{areArraysEqual:s,areMapsEqual:a,areObjectsEqual:o,areSetsEqual:l})}return i}function Uye(e){return function(t,r,n,i,s,a,o){return e(t,r,o)}}function zye(e){var t=e.circular,r=e.comparator,n=e.createState,i=e.equals,s=e.strict;if(n)return function(l,c){var f=n(),u=f.cache,d=u===void 0?t?new WeakMap:void 0:u,p=f.meta;return r(l,c,{cache:d,equals:i,meta:p,strict:s})};if(t)return function(l,c){return r(l,c,{cache:new WeakMap,equals:i,meta:void 0,strict:s})};var a={cache:void 0,equals:i,meta:void 0,strict:s};return function(l,c){return r(l,c,a)}}var Bz=Xl(),J4e=Xl({strict:!0}),G4e=Xl({circular:!0}),K4e=Xl({circular:!0,strict:!0}),Y4e=Xl({createInternalComparator:function(){return fp}}),X4e=Xl({strict:!0,createInternalComparator:function(){return fp}}),Z4e=Xl({circular:!0,createInternalComparator:function(){return fp}}),Q4e=Xl({circular:!0,createInternalComparator:function(){return fp},strict:!0});function Xl(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,i=e.createState,s=e.strict,a=s===void 0?!1:s,o=$ye(e),l=Rye(o),c=n?n(l):Uye(l);return zye({circular:r,comparator:l,createState:i,equals:c,strict:a})}function j2(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function i(s){r<0&&(r=s),s-r>t?(e(s),r=-1):requestAnimationFrame(i)};requestAnimationFrame(n)}function QT(e){"@babel/helpers - typeof";return QT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},QT(e)}function qye(e){return Jye(e)||Wye(e)||Hye(e)||Vye()}function Vye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hye(e,t){if(e){if(typeof e=="string")return Mz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mz(e,t)}}function Mz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Jye(e){if(Array.isArray(e))return e}function eC(){var e={},t=function(){return null},r=!1,n=function i(s){if(!r){if(Array.isArray(s)){if(!s.length)return;var a=s,o=qye(a),l=o[0],c=o.slice(1);if(typeof l=="number"){j2(i.bind(null,c),l);return}i(l),j2(i.bind(null,c));return}QT(s)==="object"&&(e=s,t(e)),typeof s=="function"&&s()}};return{stop:function(){r=!0},start:function(s){r=!1,n(s)},subscribe:function(s){return t=s,function(){t=function(){return null}}}}}function Wy(e){"@babel/helpers - typeof";return Wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wy(e)}function Rz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function dp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rz(Object(r),!0).forEach(function(n){B2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B2(e,t,r){return t=Gye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gye(e){var t=Kye(e,"string");return Wy(t)==="symbol"?t:String(t)}function Kye(e,t){if(Wy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yye=["Webkit","Moz","O","ms"],Xye=["-webkit-","-moz-","-o-","-ms-"],Zye=["transform","transformOrigin","transition"],$z=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,i){return n.filter(function(s){return i.includes(s)})})},Uz=function(t){return t},Qye=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},eme=function(t,r){if(Zye.indexOf(t)===-1)return B2({},t,Number.isNaN(r)?0:r);var n=t==="transition",i=t.replace(/(\w)/,function(a){return a.toUpperCase()}),s=r;return Yye.reduce(function(a,o,l){return n&&(s=r.replace(/(transform|transform-origin)/gim,"".concat(Xye[l],"$1"))),dp(dp({},a),{},B2({},o+i,s))},{})};var pp=function(t,r){return Object.keys(r).reduce(function(n,i){return dp(dp({},n),{},B2({},i,t(i,r[i])))},{})},hp=function(t){return Object.keys(t).reduce(function(r,n){return dp(dp({},r),eme(n,r[n]))},t)};var tC=function(t,r,n){return t.map(function(i){return"".concat(Qye(i)," ").concat(r,"ms ").concat(n)}).join(",")},tme=!1,Jy=function(t,r,n,i,s,a,o,l){if(tme&&typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,i,s,a,o,l],f=0;console.warn(r.replace(/%s/g,function(){return c[f++]}))}};function rme(e,t){return sme(e)||ime(e,t)||qz(e,t)||nme()}function nme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ime(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function sme(e){if(Array.isArray(e))return e}function ame(e){return cme(e)||lme(e)||qz(e)||ome()}function ome(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qz(e,t){if(e){if(typeof e=="string")return rC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rC(e,t)}}function lme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cme(e){if(Array.isArray(e))return rC(e)}function rC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var M2=1e-4,Vz=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},Hz=function(t,r){return t.map(function(n,i){return n*Math.pow(r,i)}).reduce(function(n,i){return n+i})},zz=function(t,r){return function(n){var i=Vz(t,r);return Hz(i,n)}},ume=function(t,r){return function(n){var i=Vz(t,r),s=[].concat(ame(i.map(function(a,o){return a*o}).slice(1)),[0]);return Hz(s,n)}},nC=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0],s=r[1],a=r[2],o=r[3];if(r.length===1)switch(r[0]){case"linear":i=0,s=0,a=1,o=1;break;case"ease":i=.25,s=.1,a=.25,o=1;break;case"ease-in":i=.42,s=0,a=1,o=1;break;case"ease-out":i=.42,s=0,a=.58,o=1;break;case"ease-in-out":i=0,s=0,a=.58,o=1;break;default:{var l=r[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var c=l[1].split(")")[0].split(",").map(function(k){return parseFloat(k)}),f=rme(c,4);i=f[0],s=f[1],a=f[2],o=f[3]}else Jy(!1,"[configBezier]: arguments should be one of oneOf 'linear', 'ease', 'ease-in', 'ease-out', 'ease-in-out','cubic-bezier(x1,y1,x2,y2)', instead received %s",r)}}Jy([i,a,s,o].every(function(k){return typeof k=="number"&&k>=0&&k<=1}),"[configBezier]: arguments should be x1, y1, x2, y2 of [0, 1] instead received %s",r);var u=zz(i,a),d=zz(s,o),p=ume(i,a),_=function(S){return S>1?1:S<0?0:S},w=function(S){for(var O=S>1?1:S,A=O,C=0;C<8;++C){var I=u(A)-O,D=p(A);if(Math.abs(I-O)<M2||D<M2)return d(A);A=_(A-I/D)}return d(A)};return w.isStepper=!1,w},Wz=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,i=t.damping,s=i===void 0?8:i,a=t.dt,o=a===void 0?17:a,l=function(f,u,d){var p=-(f-u)*n,_=d*s,w=d+(p-_)*o/1e3,k=d*o/1e3+f;return Math.abs(k-u)<M2&&Math.abs(w)<M2?[u,0]:[k,w]};return l.isStepper=!0,l.dt=o,l},Jz=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return nC(i);case"spring":return Wz();default:if(i.split("(")[0]==="cubic-bezier")return nC(i);Jy(!1,"[configEasing]: first argument should be one of 'ease', 'ease-in', 'ease-out', 'ease-in-out','cubic-bezier(x1,y1,x2,y2)', 'linear' and 'spring', instead  received %s",r)}return typeof i=="function"?i:(Jy(!1,"[configEasing]: first argument type should be function or string, instead received %s",r),null)};function Gy(e){"@babel/helpers - typeof";return Gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gy(e)}function Gz(e){return pme(e)||dme(e)||Yz(e)||fme()}function fme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pme(e){if(Array.isArray(e))return sC(e)}function Kz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Yn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kz(Object(r),!0).forEach(function(n){iC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iC(e,t,r){return t=hme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hme(e){var t=gme(e,"string");return Gy(t)==="symbol"?t:String(t)}function gme(e,t){if(Gy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yme(e,t){return vme(e)||bme(e,t)||Yz(e,t)||mme()}function mme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yz(e,t){if(e){if(typeof e=="string")return sC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sC(e,t)}}function sC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bme(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function vme(e){if(Array.isArray(e))return e}var R2=function(t,r,n){return t+(r-t)*n},aC=function(t){var r=t.from,n=t.to;return r!==n},_me=function e(t,r,n){var i=pp(function(s,a){if(aC(a)){var o=t(a.from,a.to,a.velocity),l=yme(o,2),c=l[0],f=l[1];return Yn(Yn({},a),{},{from:c,velocity:f})}return a},r);return n<1?pp(function(s,a){return aC(a)?Yn(Yn({},a),{},{velocity:R2(a.velocity,i[s].velocity,n),from:R2(a.from,i[s].from,n)}):a},r):e(t,i,n-1)},Xz=function(e,t,r,n,i){var s=$z(e,t),a=s.reduce(function(k,S){return Yn(Yn({},k),{},iC({},S,[e[S],t[S]]))},{}),o=s.reduce(function(k,S){return Yn(Yn({},k),{},iC({},S,{from:e[S],velocity:0,to:t[S]}))},{}),l=-1,c,f,u=function(){return null},d=function(){return pp(function(S,O){return O.from},o)},p=function(){return!Object.values(o).filter(aC).length},_=function(S){c||(c=S);var O=S-c,A=O/r.dt;o=_me(r,o,A),i(Yn(Yn(Yn({},e),t),d(o))),c=S,p()||(l=requestAnimationFrame(u))},w=function(S){f||(f=S);var O=(S-f)/n,A=pp(function(I,D){return R2.apply(void 0,Gz(D).concat([r(O)]))},a);if(i(Yn(Yn(Yn({},e),t),A)),O<1)l=requestAnimationFrame(u);else{var C=pp(function(I,D){return R2.apply(void 0,Gz(D).concat([r(1)]))},a);i(Yn(Yn(Yn({},e),t),C))}};return u=r.isStepper?_:w,function(){return requestAnimationFrame(u),function(){cancelAnimationFrame(l)}}};function gp(e){"@babel/helpers - typeof";return gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gp(e)}var wme=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Sme(e,t){if(e==null)return{};var r=xme(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xme(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function oC(e){return Ame(e)||Ome(e)||Eme(e)||kme()}function kme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eme(e,t){if(e){if(typeof e=="string")return lC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lC(e,t)}}function Ome(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ame(e){if(Array.isArray(e))return lC(e)}function lC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ha(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zz(Object(r),!0).forEach(function(n){Ky(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ky(e,t,r){return t=e9(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e9(n.key),n)}}function Cme(e,t,r){return t&&Qz(e.prototype,t),r&&Qz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e9(e){var t=Ime(e,"string");return gp(t)==="symbol"?t:String(t)}function Ime(e,t){if(gp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cC(e,t)}function cC(e,t){return cC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},cC(e,t)}function Pme(e){var t=Lme();return function(){var n=$2(e),i;if(t){var s=$2(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return uC(this,i)}}function uC(e,t){if(t&&(gp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fC(e)}function fC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $2(e){return $2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$2(e)}var U2=function(e){Nme(r,e);var t=Pme(r);function r(n,i){var s;Tme(this,r),s=t.call(this,n,i);var a=s.props,o=a.isActive,l=a.attributeName,c=a.from,f=a.to,u=a.steps,d=a.children,p=a.duration;if(s.handleStyleChange=s.handleStyleChange.bind(fC(s)),s.changeStyle=s.changeStyle.bind(fC(s)),!o||p<=0)return s.state={style:{}},typeof d=="function"&&(s.state={style:f}),uC(s);if(u&&u.length)s.state={style:u[0].style};else if(c){if(typeof d=="function")return s.state={style:c},uC(s);s.state={style:l?Ky({},l,c):c}}else s.state={style:{}};return s}return Cme(r,[{key:"componentDidMount",value:function(){var i=this.props,s=i.isActive,a=i.canBegin;this.mounted=!0,!(!s||!a)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var s=this.props,a=s.isActive,o=s.canBegin,l=s.attributeName,c=s.shouldReAnimate,f=s.to,u=s.from,d=this.state.style;if(o){if(!a){var p={style:l?Ky({},l,f):f};this.state&&d&&(l&&d[l]!==f||!l&&d!==f)&&this.setState(p);return}if(!(Bz(i.to,f)&&i.canBegin&&i.isActive)){var _=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var w=_||c?u:i.to;if(this.state&&d){var k={style:l?Ky({},l,w):w};(l&&[l]!==w||!l&&d!==w)&&this.setState(k)}this.runAnimation(ha(ha({},this.props),{},{from:w,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var s=this,a=i.from,o=i.to,l=i.duration,c=i.easing,f=i.begin,u=i.onAnimationEnd,d=i.onAnimationStart,p=Xz(a,o,Jz(c),l,this.changeStyle),_=function(){s.stopJSAnimation=p()};this.manager.start([d,f,_,l,u])}},{key:"runStepAnimation",value:function(i){var s=this,a=i.steps,o=i.begin,l=i.onAnimationStart,c=a[0],f=c.style,u=c.duration,d=u===void 0?0:u,p=function(w,k,S){if(S===0)return w;var O=k.duration,A=k.easing,C=A===void 0?"ease":A,I=k.style,D=k.properties,L=k.onAnimationEnd,U=S>0?a[S-1]:k,te=D||Object.keys(I);if(typeof C=="function"||C==="spring")return[].concat(oC(w),[s.runJSAnimation.bind(s,{from:U.style,to:I,duration:O,easing:C}),O]);var V=tC(te,O,C),X=ha(ha(ha({},U.style),I),{},{transition:V});return[].concat(oC(w),[X,O,L]).filter(Uz)};return this.manager.start([l].concat(oC(a.reduce(p,[f,Math.max(d,o)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=eC());var s=i.begin,a=i.duration,o=i.attributeName,l=i.to,c=i.easing,f=i.onAnimationStart,u=i.onAnimationEnd,d=i.steps,p=i.children,_=this.manager;if(this.unSubscribe=_.subscribe(this.handleStyleChange),typeof c=="function"||typeof p=="function"||c==="spring"){this.runJSAnimation(i);return}if(d.length>1){this.runStepAnimation(i);return}var w=o?Ky({},o,l):l,k=tC(Object.keys(w),a,c);_.start([f,s,ha(ha({},w),{},{transition:k}),a,u])}},{key:"render",value:function(){var i=this.props,s=i.children,a=i.begin,o=i.duration,l=i.attributeName,c=i.easing,f=i.isActive,u=i.steps,d=i.from,p=i.to,_=i.canBegin,w=i.onAnimationEnd,k=i.shouldReAnimate,S=i.onAnimationReStart,O=Sme(i,wme),A=Xa.Children.count(s),C=hp(this.state.style);if(typeof s=="function")return s(C);if(!f||A===0||o<=0)return s;var I=function(L){var U=L.props,te=U.style,V=te===void 0?{}:te,X=U.className,Z=(0,Xa.cloneElement)(L,ha(ha({},O),{},{style:ha(ha({},V),C),className:X}));return Z};return A===1?I(Xa.Children.only(s)):Xa.default.createElement("div",null,Xa.Children.map(s,function(D){return I(D)}))}}]),r}(Xa.PureComponent);U2.displayName="Animate";U2.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};U2.propTypes={from:ir.default.oneOfType([ir.default.object,ir.default.string]),to:ir.default.oneOfType([ir.default.object,ir.default.string]),attributeName:ir.default.string,duration:ir.default.number,begin:ir.default.number,easing:ir.default.oneOfType([ir.default.string,ir.default.func]),steps:ir.default.arrayOf(ir.default.shape({duration:ir.default.number.isRequired,style:ir.default.object.isRequired,easing:ir.default.oneOfType([ir.default.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),ir.default.func]),properties:ir.default.arrayOf("string"),onAnimationEnd:ir.default.func})),children:ir.default.oneOfType([ir.default.node,ir.default.func]),isActive:ir.default.bool,canBegin:ir.default.bool,onAnimationEnd:ir.default.func,shouldReAnimate:ir.default.bool,onAnimationStart:ir.default.func,onAnimationReStart:ir.default.func};var z2=U2;var nm=ae(Je()),L9=ae(EC()),Zl=ae(Jo());var Mu=ae(Je()),I9=ae(EC()),rm=ae(Jo());var _be=["children","appearOptions","enterOptions","leaveOptions"];function wp(e){"@babel/helpers - typeof";return wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wp(e)}function AC(){return AC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},AC.apply(this,arguments)}function wbe(e,t){if(e==null)return{};var r=Sbe(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Sbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function O9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function A9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O9(Object(r),!0).forEach(function(n){IC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C9(n.key),n)}}function kbe(e,t,r){return t&&T9(e.prototype,t),r&&T9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ebe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TC(e,t)}function TC(e,t){return TC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TC(e,t)}function Obe(e){var t=Tbe();return function(){var n=K2(e),i;if(t){var s=K2(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return Abe(this,i)}}function Abe(e,t){if(t&&(wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CC(e)}function CC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tbe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function K2(e){return K2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},K2(e)}function IC(e,t,r){return t=C9(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C9(e){var t=Cbe(e,"string");return wp(t)==="symbol"?t:String(t)}function Cbe(e,t){if(wp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}Number.isFinite===void 0&&(Number.isFinite=function(e){return typeof e=="number"&&isFinite(e)});var OC=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.steps,n=t.duration;return r&&r.length?r.reduce(function(i,s){return i+(Number.isFinite(s.duration)&&s.duration>0?s.duration:0)},0):Number.isFinite(n)?n:0},N9=function(e){Ebe(r,e);var t=Obe(r);function r(){var n;return xbe(this,r),n=t.call(this),IC(CC(n),"handleEnter",function(i,s){var a=n.props,o=a.appearOptions,l=a.enterOptions;n.handleStyleActive(s?o:l)}),IC(CC(n),"handleExit",function(){var i=n.props.leaveOptions;n.handleStyleActive(i)}),n.state={isActive:!1},n}return kbe(r,[{key:"handleStyleActive",value:function(i){if(i){var s=i.onAnimationEnd?function(){i.onAnimationEnd()}:null;this.setState(A9(A9({},i),{},{onAnimationEnd:s,isActive:!0}))}}},{key:"parseTimeout",value:function(){var i=this.props,s=i.appearOptions,a=i.enterOptions,o=i.leaveOptions;return OC(s)+OC(a)+OC(o)}},{key:"render",value:function(){var i=this,s=this.props,a=s.children,o=s.appearOptions,l=s.enterOptions,c=s.leaveOptions,f=wbe(s,_be);return Mu.default.createElement(I9.Transition,AC({},f,{onEnter:this.handleEnter,onExit:this.handleExit,timeout:this.parseTimeout()}),function(){return Mu.default.createElement(z2,i.state,Mu.Children.only(a))})}}]),r}(Mu.Component);N9.propTypes={appearOptions:rm.default.object,enterOptions:rm.default.object,leaveOptions:rm.default.object,children:rm.default.element};var P9=N9;function F9(e){var t=e.component,r=e.children,n=e.appear,i=e.enter,s=e.leave;return nm.default.createElement(L9.TransitionGroup,{component:t},nm.Children.map(r,function(a,o){return nm.default.createElement(P9,{appearOptions:n,enterOptions:i,leaveOptions:s,key:"child-".concat(o)},a)}))}F9.propTypes={appear:Zl.default.object,enter:Zl.default.object,leave:Zl.default.object,children:Zl.default.oneOfType([Zl.default.array,Zl.default.element]),component:Zl.default.any};F9.defaultProps={component:"span"};var Ru=z2;var jq=ae(Kr());var Tq=ae(Rs()),Cq=ae(X2()),Iq=ae(Yr()),Hs=ae(Je()),MC=ae(Kr());function Sp(e){"@babel/helpers - typeof";return Sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sp(e)}function Bve(e,t){return Uve(e)||$ve(e,t)||Rve(e,t)||Mve()}function Mve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rve(e,t){if(e){if(typeof e=="string")return Eq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Eq(e,t)}}function Eq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $ve(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function Uve(e){if(Array.isArray(e))return e}function Oq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Oq(Object(r),!0).forEach(function(n){RC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Aq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nq(n.key),n)}}function qve(e,t,r){return t&&Aq(e.prototype,t),r&&Aq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BC(e,t)}function BC(e,t){return BC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},BC(e,t)}function Hve(e){var t=Gve();return function(){var n=Z2(e),i;if(t){var s=Z2(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return Wve(this,i)}}function Wve(e,t){if(t&&(Sp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jve(e)}function Jve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Z2(e){return Z2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Z2(e)}function RC(e,t,r){return t=Nq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nq(e){var t=Kve(e,"string");return Sp(t)==="symbol"?t:String(t)}function Kve(e,t){if(Sp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yve(e){return(0,Iq.default)(e)&&Cr(e[0])&&Cr(e[1])?e.join(" ~ "):e}var Q2=function(e){Vve(r,e);var t=Hve(r);function r(){return zve(this,r),t.apply(this,arguments)}return qve(r,[{key:"renderContent",value:function(){var i=this.props,s=i.payload,a=i.separator,o=i.formatter,l=i.itemStyle,c=i.itemSorter;if(s&&s.length){var f={padding:0,margin:0},u=(c?(0,Cq.default)(s,c):s).map(function(d,p){if(d.type==="none")return null;var _=jC({display:"block",paddingTop:4,paddingBottom:4,color:d.color||"#000"},l),w=d.formatter||o||Yve,k=d.value,S=d.name;if(w&&k!=null&&S!=null){var O=w(k,S,d,p,s);if(Array.isArray(O)){var A=O,C=Bve(A,2);k=C[0],S=C[1]}else k=O}return Hs.default.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(p),style:_},Cr(S)?Hs.default.createElement("span",{className:"recharts-tooltip-item-name"},S):null,Cr(S)?Hs.default.createElement("span",{className:"recharts-tooltip-item-separator"},a):null,Hs.default.createElement("span",{className:"recharts-tooltip-item-value"},k),Hs.default.createElement("span",{className:"recharts-tooltip-item-unit"},d.unit||""))});return Hs.default.createElement("ul",{className:"recharts-tooltip-item-list",style:f},u)}return null}},{key:"render",value:function(){var i=this.props,s=i.wrapperClassName,a=i.contentStyle,o=i.labelClassName,l=i.labelStyle,c=i.label,f=i.labelFormatter,u=i.payload,d=jC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),p=jC({margin:0},l),_=!(0,Tq.default)(c),w=_?c:"",k=(0,MC.default)("recharts-default-tooltip",s),S=(0,MC.default)("recharts-tooltip-label",o);return _&&f&&u!==void 0&&u!==null&&(w=f(c,u)),Hs.default.createElement("div",{className:k,style:d},Hs.default.createElement("p",{className:S,style:p},Hs.default.isValidElement(w)?w:"".concat(w)),this.renderContent())}}]),r}(Hs.PureComponent);RC(Q2,"displayName","DefaultTooltipContent");RC(Q2,"defaultProps",{separator:" : ",contentStyle:{},itemStyle:{},labelStyle:{}});var Xve=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Ti={isSsr:Xve(),get:function(t){return Ti[t]},set:function(t,r){if(typeof t=="string")Ti[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(i){Ti[i]=t[i]})}}};function om(e){"@babel/helpers - typeof";return om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},om(e)}function Pq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ko(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pq(Object(r),!0).forEach(function(n){am(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function am(e,t,r){return t=Zve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zve(e){var t=Qve(e,"string");return om(t)==="symbol"?t:String(t)}function Qve(e,t){if(om(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(om(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ew(e,t){return n_e(e)||r_e(e,t)||t_e(e,t)||e_e()}function e_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t_e(e,t){if(e){if(typeof e=="string")return Lq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lq(e,t)}}function Lq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r_e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function n_e(e){if(Array.isArray(e))return e}var sm="recharts-tooltip-wrapper",Fq=1;function i_e(e){return e.dataKey}function s_e(e,t){return e===!0?(0,$C.default)(t,i_e):(0,UC.default)(e)?(0,$C.default)(t,e):t}function a_e(e,t){return Xn.default.isValidElement(e)?Xn.default.cloneElement(e,t):(0,UC.default)(e)?Xn.default.createElement(e,t):Xn.default.createElement(Q2,t)}var o_e={active:!1,allowEscapeViewBox:{x:!1,y:!1},reverseDirection:{x:!1,y:!1},offset:10,viewBox:{x:0,y:0,height:0,width:0},coordinate:{x:0,y:0},cursorStyle:{},separator:" : ",wrapperStyle:{},contentStyle:{},itemStyle:{},labelStyle:{},cursor:!0,trigger:"hover",isAnimationActive:!Ti.isSsr,animationEasing:"ease",animationDuration:400,filterNull:!0,useTranslate3d:!1},$u=function(t){var r,n=(0,Xn.useState)(-1),i=ew(n,2),s=i[0],a=i[1],o=(0,Xn.useState)(-1),l=ew(o,2),c=l[0],f=l[1],u=(0,Xn.useState)(!1),d=ew(u,2),p=d[0],_=d[1],w=(0,Xn.useState)({x:0,y:0}),k=ew(w,2),S=k[0],O=k[1],A=(0,Xn.useRef)(),C=t.allowEscapeViewBox,I=t.reverseDirection,D=t.coordinate,L=t.offset,U=t.position,te=t.viewBox,V=(0,Xn.useCallback)(function(le){le.key==="Escape"&&(_(!0),O(function(we){return Ko(Ko({},we),{},{x:D?.x,y:D?.y})}))},[D?.x,D?.y]);(0,Xn.useEffect)(function(){var le=function(){if(p?(document.removeEventListener("keydown",V),(D?.x!==S.x||D?.y!==S.y)&&_(!1)):document.addEventListener("keydown",V),A.current&&A.current.getBoundingClientRect){var W=A.current.getBoundingClientRect();(Math.abs(W.width-s)>Fq||Math.abs(W.height-c)>Fq)&&(a(W.width),f(W.height))}else(s!==-1||c!==-1)&&(a(-1),f(-1))};return le(),function(){document.removeEventListener("keydown",V)}},[c,s,D,p,S.x,S.y,V]);var X=function(we){var W=we.key,J=we.tooltipDimension,ne=we.viewBoxDimension;if(U&&qe(U[W]))return U[W];var Oe=D[W]-J-L,Ne=D[W]+L;if(C!=null&&C[W])return I[W]?Oe:Ne;if(I!=null&&I[W]){var Ce=Oe,Xe=te[W];return Ce<Xe?Math.max(Ne,te[W]):Math.max(Oe,te[W])}var Ze=Ne+J,kt=te[W]+ne;return Ze>kt?Math.max(Oe,te[W]):Math.max(Ne,te[W])},Z=t.payload,se=t.payloadUniqBy,pe=t.filterNull,de=t.active,F=t.wrapperStyle,H=t.useTranslate3d,Q=t.isAnimationActive,R=t.animationDuration,$=t.animationEasing,q=s_e(se,pe&&Z&&Z.length?Z.filter(function(le){return!(0,Dq.default)(le.value)}):Z),ie=q&&q.length,oe=t.content,fe=Ko({pointerEvents:"none",visibility:!p&&de&&ie?"visible":"hidden",position:"absolute",top:0,left:0},F),_e,Ee;U&&qe(U.x)&&qe(U.y)?(_e=U.x,Ee=U.y):s>0&&c>0&&D?(_e=X({key:"x",tooltipDimension:s,viewBoxDimension:te.width}),Ee=X({key:"y",tooltipDimension:c,viewBoxDimension:te.height})):fe.visibility="hidden",fe=Ko(Ko({},hp({transform:H?"translate3d(".concat(_e,"px, ").concat(Ee,"px, 0)"):"translate(".concat(_e,"px, ").concat(Ee,"px)")})),fe),Q&&de&&(fe=Ko(Ko({},hp({transition:"transform ".concat(R,"ms ").concat($)})),fe));var Se=(0,jq.default)(sm,(r={},am(r,"".concat(sm,"-right"),qe(_e)&&D&&qe(D.x)&&_e>=D.x),am(r,"".concat(sm,"-left"),qe(_e)&&D&&qe(D.x)&&_e<D.x),am(r,"".concat(sm,"-bottom"),qe(Ee)&&D&&qe(D.y)&&Ee>=D.y),am(r,"".concat(sm,"-top"),qe(Ee)&&D&&qe(D.y)&&Ee<D.y),r));return Xn.default.createElement("div",{tabIndex:-1,role:"dialog",className:Se,style:fe,ref:A},a_e(oe,Ko(Ko({},t),{},{payload:q})))};$u.displayName="Tooltip";$u.defaultProps=o_e;var r7=ae(Kr()),vn=ae(Je());var bn=ae(Je()),Xq=ae(Va()),Zq=ae(VC()),Qq=ae(HC());var WC=function(e,t){return WC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},WC(e,t)};function N_e(e,t){WC(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function P_e(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}var L_e=function(e,t,r,n){switch(t){case"debounce":return(0,Zq.default)(e,r,n);case"throttle":return(0,Qq.default)(e,r,n);default:return e}},Kq=function(e){return typeof e=="function"},xp=function(){return typeof window>"u"},Yq=function(e){return e instanceof Element||e instanceof HTMLDocument},F_e=function(e,t,r){return function(n){var i=n.width,s=n.height;e(function(a){return a.width===i&&a.height===s||a.width===i&&!r||a.height===s&&!t?a:{width:i,height:s}})}},e7=function(e){N_e(t,e);function t(r){var n=e.call(this,r)||this;n.cancelHandler=function(){n.resizeHandler&&n.resizeHandler.cancel&&(n.resizeHandler.cancel(),n.resizeHandler=null)},n.attachObserver=function(){var c=n.props,f=c.targetRef,u=c.observerOptions;if(!xp()){f&&f.current&&(n.targetRef.current=f.current);var d=n.getElement();d&&(n.observableElement&&n.observableElement===d||(n.observableElement=d,n.resizeObserver.observe(d,u)))}},n.getElement=function(){var c=n.props,f=c.querySelector,u=c.targetDomEl;if(xp())return null;if(f)return document.querySelector(f);if(u&&Yq(u))return u;if(n.targetRef&&Yq(n.targetRef.current))return n.targetRef.current;var d=(0,Xq.findDOMNode)(n);if(!d)return null;var p=n.getRenderType();switch(p){case"renderProp":return d;case"childFunction":return d;case"child":return d;case"childArray":return d;default:return d.parentElement}},n.createResizeHandler=function(c){var f=n.props,u=f.handleWidth,d=u===void 0?!0:u,p=f.handleHeight,_=p===void 0?!0:p,w=f.onResize;if(!(!d&&!_)){var k=F_e(function(S){return n.setState(S,function(){return w?.(n.state.width,n.state.height)})},d,_);c.forEach(function(S){var O=S&&S.contentRect||{},A=O.width,C=O.height,I=!n.skipOnMount&&!xp();I&&k({width:A,height:C}),n.skipOnMount=!1})}},n.getRenderType=function(){var c=n.props,f=c.render,u=c.children;return Kq(f)?"renderProp":Kq(u)?"childFunction":(0,bn.isValidElement)(u)?"child":Array.isArray(u)?"childArray":"parent"};var i=r.skipOnMount,s=r.refreshMode,a=r.refreshRate,o=a===void 0?1e3:a,l=r.refreshOptions;return n.state={width:void 0,height:void 0},n.skipOnMount=i,n.targetRef=(0,bn.createRef)(),n.observableElement=null,xp()||(n.resizeHandler=L_e(n.createResizeHandler,s,o,l),n.resizeObserver=new window.ResizeObserver(n.resizeHandler)),n}return t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver()},t.prototype.componentWillUnmount=function(){xp()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},t.prototype.render=function(){var r=this.props,n=r.render,i=r.children,s=r.nodeType,a=s===void 0?"div":s,o=this.state,l=o.width,c=o.height,f={width:l,height:c,targetRef:this.targetRef},u=this.getRenderType();switch(u){case"renderProp":return n?.(f);case"childFunction":{var d=i;return d?.(f)}case"child":{var p=i;if(p.type&&typeof p.type=="string"){f.targetRef;var _=P_e(f,["targetRef"]);return(0,bn.cloneElement)(p,_)}return(0,bn.cloneElement)(p,f)}case"childArray":{var w=i;return w.map(function(k){return!!k&&(0,bn.cloneElement)(k,f)})}default:return bn.default.createElement(a,null)}},t}(bn.PureComponent);var v6e=xp()?bn.useEffect:bn.useLayoutEffect;var D_e=!1,Qa=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];if(D_e&&typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var a=0;console.warn(r.replace(/%s/g,function(){return i[a++]}))}};function JC(){return JC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JC.apply(this,arguments)}function j_e(e,t){return $_e(e)||R_e(e,t)||M_e(e,t)||B_e()}function B_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M_e(e,t){if(e){if(typeof e=="string")return t7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t7(e,t)}}function t7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R_e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function $_e(e){if(Array.isArray(e))return e}var GC=(0,vn.forwardRef)(function(e,t){var r=e.aspect,n=e.width,i=n===void 0?"100%":n,s=e.height,a=s===void 0?"100%":s,o=e.minWidth,l=o===void 0?0:o,c=e.minHeight,f=e.maxHeight,u=e.children,d=e.debounce,p=d===void 0?0:d,_=e.id,w=e.className,k=e.onResize,S=(0,vn.useState)({containerWidth:-1,containerHeight:-1}),O=j_e(S,2),A=O[0],C=O[1],I=(0,vn.useRef)(null);(0,vn.useImperativeHandle)(t,function(){return I},[I]);var D=(0,vn.useCallback)(function(){return I.current?{containerWidth:I.current.clientWidth,containerHeight:I.current.clientHeight}:null},[]),L=(0,vn.useCallback)(function(){var V=D();if(V){var X=V.containerWidth,Z=V.containerHeight;k&&k(X,Z),C(function(se){var pe=se.containerWidth,de=se.containerHeight;return X!==pe||Z!==de?{containerWidth:X,containerHeight:Z}:se})}},[D,k]),U=(0,vn.useMemo)(function(){var V=A.containerWidth,X=A.containerHeight;if(V<0||X<0)return null;Qa(qo(i)||qo(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,a),Qa(!r||r>0,"The aspect(%s) must be greater than zero.",r);var Z=qo(i)?V:i,se=qo(a)?X:a;return r&&r>0&&(Z?se=Z/r:se&&(Z=se*r),f&&se>f&&(se=f)),Qa(Z>0||se>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Z,se,i,a,l,c,r),(0,vn.cloneElement)(u,{width:Z,height:se})},[r,u,a,f,c,l,A,i]);(0,vn.useEffect)(function(){var V=D();V&&C(V)},[D]);var te={width:i,height:a,minWidth:l,minHeight:c,maxHeight:f};return vn.default.createElement(e7,{handleWidth:!0,handleHeight:!0,onResize:L,targetRef:I,refreshMode:p>0?"debounce":void 0,refreshRate:p},vn.default.createElement("div",JC({},_!=null?{id:"".concat(_)}:{},{className:(0,r7.default)("recharts-responsive-container",w),style:te,ref:I}),U))});var kp=function(t){return null};kp.displayName="Cell";var cI=ae(Rs()),um=ae(Je()),cw=ae(C7()),R7=ae(Kr());function cm(e){"@babel/helpers - typeof";return cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cm(e)}function I7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function N7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I7(Object(r),!0).forEach(function(n){p0e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function p0e(e,t,r){return t=h0e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h0e(e){var t=g0e(e,"string");return cm(t)==="symbol"?t:String(t)}function g0e(e,t){if(cm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P7(e){return v0e(e)||b0e(e)||m0e(e)||y0e()}function y0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m0e(e,t){if(e){if(typeof e=="string")return oI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oI(e,t)}}function b0e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function v0e(e){if(Array.isArray(e))return oI(e)}function oI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ep={widthCache:{},cacheCount:0},_0e=2e3,w0e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},S0e=["minWidth","maxWidth","width","minHeight","maxHeight","height","top","left","fontSize","lineHeight","padding","margin","paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom"],L7="recharts_measurement_span";function x0e(e,t){return S0e.indexOf(e)>=0&&t===+t?"".concat(t,"px"):t}function k0e(e){var t=e.split(""),r=t.reduce(function(n,i){return i===i.toUpperCase()?[].concat(P7(n),["-",i.toLowerCase()]):[].concat(P7(n),[i])},[]);return r.join("")}var E0e=function(t){return Object.keys(t).reduce(function(r,n){return"".concat(r).concat(k0e(n),":").concat(x0e(n,t[n]),";")},"")},Xo=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ti.isSsr)return{width:0,height:0};var n="".concat(t),i=E0e(r),s="".concat(n,"-").concat(i);if(Ep.widthCache[s])return Ep.widthCache[s];try{var a=document.getElementById(L7);a||(a=document.createElement("span"),a.setAttribute("id",L7),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var o=N7(N7({},w0e),r);Object.keys(o).map(function(f){return a.style[f]=o[f],f}),a.textContent=n;var l=a.getBoundingClientRect(),c={width:l.width,height:l.height};return Ep.widthCache[s]=c,++Ep.cacheCount>_0e&&(Ep.cacheCount=0,Ep.widthCache={}),c}catch{return{width:0,height:0}}},F7=function(t){var r=t.ownerDocument.documentElement,n={top:0,left:0};return typeof t.getBoundingClientRect<"u"&&(n=t.getBoundingClientRect()),{top:n.top+window.pageYOffset-r.clientTop,left:n.left+window.pageXOffset-r.clientLeft}},D7=function(t,r){return{chartX:Math.round(t.pageX-r.left),chartY:Math.round(t.pageY-r.top)}};var O0e=["dx","dy","textAnchor","verticalAnchor","scaleToFit","angle","lineHeight","capHeight","className","breakAll"];function lI(){return lI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lI.apply(this,arguments)}function A0e(e,t){if(e==null)return{};var r=T0e(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function T0e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function j7(e,t){return P0e(e)||N0e(e,t)||I0e(e,t)||C0e()}function C0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I0e(e,t){if(e){if(typeof e=="string")return B7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B7(e,t)}}function B7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function P0e(e){if(Array.isArray(e))return e}var $7=/[ \f\n\r\t\v\u2028\u2029]+/,U7=function(t){var r=t.children,n=t.breakAll,i=t.style;try{var s=[];(0,cI.default)(r)||(n?s=r.toString().split(""):s=r.toString().split($7));var a=s.map(function(l){return{word:l,width:Xo(l,i).width}}),o=n?0:Xo("\xA0",i).width;return{wordsWithComputedWidth:a,spaceWidth:o}}catch{return null}},L0e=function(t,r,n,i,s){var a=t.maxLines,o=t.children,l=t.style,c=t.breakAll,f=qe(a),u=o,d=function(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return de.reduce(function(F,H){var Q=H.word,R=H.width,$=F[F.length-1];if($&&(i==null||s||$.width+R+n<Number(i)))$.words.push(Q),$.width+=R+n;else{var q={words:[Q],width:R};F.push(q)}return F},[])},p=d(r),_=function(de){return de.reduce(function(F,H){return F.width>H.width?F:H})};if(!f)return p;for(var w="\u2026",k=function(de){var F=u.slice(0,de),H=U7({breakAll:c,style:l,children:F+w}).wordsWithComputedWidth,Q=d(H),R=Q.length>a||_(Q).width>Number(i);return[R,Q]},S=0,O=u.length-1,A=0,C;S<=O&&A<=u.length-1;){var I=Math.floor((S+O)/2),D=I-1,L=k(D),U=j7(L,2),te=U[0],V=U[1],X=k(I),Z=j7(X,1),se=Z[0];if(!te&&!se&&(S=I+1),te&&se&&(O=I-1),!te&&se){C=V;break}A++}return C||p},M7=function(t){var r=(0,cI.default)(t)?[]:t.toString().split($7);return[{words:r}]},F0e=function(t){var r=t.width,n=t.scaleToFit,i=t.children,s=t.style,a=t.breakAll,o=t.maxLines;if((r||n)&&!Ti.isSsr){var l,c,f=U7({breakAll:a,children:i,style:s});if(f){var u=f.wordsWithComputedWidth,d=f.spaceWidth;l=u,c=d}else return M7(i);return L0e({breakAll:a,children:i,maxLines:o,style:s},l,c,r,n)}return M7(i)},z7={x:0,y:0,lineHeight:"1em",capHeight:"0.71em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",fill:"#808080"},ec=function(t){var r=(0,um.useMemo)(function(){return F0e({breakAll:t.breakAll,children:t.children,maxLines:t.maxLines,scaleToFit:t.scaleToFit,style:t.style,width:t.width})},[t.breakAll,t.children,t.maxLines,t.scaleToFit,t.style,t.width]),n=t.dx,i=t.dy,s=t.textAnchor,a=t.verticalAnchor,o=t.scaleToFit,l=t.angle,c=t.lineHeight,f=t.capHeight,u=t.className,d=t.breakAll,p=A0e(t,O0e);if(!Cr(p.x)||!Cr(p.y))return null;var _=p.x+(qe(n)?n:0),w=p.y+(qe(i)?i:0),k;switch(a){case"start":k=(0,cw.default)("calc(".concat(f,")"));break;case"middle":k=(0,cw.default)("calc(".concat((r.length-1)/2," * -").concat(c," + (").concat(f," / 2))"));break;default:k=(0,cw.default)("calc(".concat(r.length-1," * -").concat(c,")"));break}var S=[];if(o){var O=r[0].width,A=t.width;S.push("scale(".concat((qe(A)?A/O:1)/O,")"))}return l&&S.push("rotate(".concat(l,", ").concat(_,", ").concat(w,")")),S.length&&(p.transform=S.join(" ")),um.default.createElement("text",lI({},yt(p,!0),{x:_,y:w,className:(0,R7.default)("recharts-text",u),textAnchor:s,fill:p.fill.includes("url")?z7.fill:p.fill}),r.map(function(C,I){return um.default.createElement("tspan",{x:_,dy:I===0?k:c,key:I},C.words.join(d?"":" "))}))};ec.defaultProps=z7;var gN=ae(Ms()),Um=ae(mn()),zm=ae(Rs()),tn=ae(Je()),yN=ae(Kr());var Z1e=ae(Rs());var BH=ae(uw()),MH=ae(X2()),RH=ae(S2()),$H=ae(G0()),Xw=ae(FA()),Lm=ae(Yr()),Dm=ae(G7()),jm=ae(Z7()),UH=ae(rV()),ma=ae(mn()),iN=ae(Eu()),ba=ae(Rs());var Ww={};_D(Ww,{scaleBand:()=>tc,scaleDiverging:()=>Vw,scaleDivergingLog:()=>VI,scaleDivergingPow:()=>Hw,scaleDivergingSqrt:()=>xH,scaleDivergingSymlog:()=>HI,scaleIdentity:()=>Tw,scaleImplicit:()=>mw,scaleLinear:()=>Ku,scaleLog:()=>Cw,scaleOrdinal:()=>Tp,scalePoint:()=>rc,scalePow:()=>xm,scaleQuantile:()=>Pw,scaleQuantize:()=>Lw,scaleRadial:()=>Nw,scaleSequential:()=>$w,scaleSequentialLog:()=>zI,scaleSequentialPow:()=>Uw,scaleSequentialQuantile:()=>zw,scaleSequentialSqrt:()=>SH,scaleSequentialSymlog:()=>qI,scaleSqrt:()=>VV,scaleSymlog:()=>Iw,scaleThreshold:()=>Fw,scaleTime:()=>$I,scaleUtc:()=>UI,tickFormat:()=>bm});function Ci(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function fI(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Uu(e){let t,r,n;e.length!==2?(t=Ci,r=(o,l)=>Ci(e(o),l),n=(o,l)=>e(o)-l):(t=e===Ci||e===fI?e:n2e,r=e,n=e);function i(o,l,c=0,f=o.length){if(c<f){if(t(l,l)!==0)return f;do{let u=c+f>>>1;r(o[u],l)<0?c=u+1:f=u}while(c<f)}return c}function s(o,l,c=0,f=o.length){if(c<f){if(t(l,l)!==0)return f;do{let u=c+f>>>1;r(o[u],l)<=0?c=u+1:f=u}while(c<f)}return c}function a(o,l,c=0,f=o.length){let u=i(o,l,c,f-1);return u>c&&n(o[u-1],l)>-n(o[u],l)?u-1:u}return{left:i,center:a,right:s}}function n2e(){return 0}function fm(e){return e===null?NaN:+e}function*nV(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}var iV=Uu(Ci),sV=iV.right,i2e=iV.left,s2e=Uu(fm).center,ga=sV;var Op=class extends Map{constructor(t,r=l2e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let[n,i]of t)this.set(n,i)}get(t){return super.get(aV(this,t))}has(t){return super.has(aV(this,t))}set(t,r){return super.set(a2e(this,t),r)}delete(t){return super.delete(o2e(this,t))}};function aV({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):r}function a2e({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function o2e({_intern:e,_key:t},r){let n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function l2e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function oV(e=Ci){if(e===Ci)return dI;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{let n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function dI(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}var c2e=Math.sqrt(50),u2e=Math.sqrt(10),f2e=Math.sqrt(2);function fw(e,t,r){let n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),s=n/Math.pow(10,i),a=s>=c2e?10:s>=u2e?5:s>=f2e?2:1,o,l,c;return i<0?(c=Math.pow(10,-i)/a,o=Math.round(e*c),l=Math.round(t*c),o/c<e&&++o,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*a,o=Math.round(e/c),l=Math.round(t/c),o*c<e&&++o,l*c>t&&--l),l<o&&.5<=r&&r<2?fw(e,t,r*2):[o,l,c]}function zu(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];let n=t<e,[i,s,a]=n?fw(t,e,r):fw(e,t,r);if(!(s>=i))return[];let o=s-i+1,l=new Array(o);if(n)if(a<0)for(let c=0;c<o;++c)l[c]=(s-c)/-a;else for(let c=0;c<o;++c)l[c]=(s-c)*a;else if(a<0)for(let c=0;c<o;++c)l[c]=(i+c)/-a;else for(let c=0;c<o;++c)l[c]=(i+c)*a;return l}function dm(e,t,r){return t=+t,e=+e,r=+r,fw(e,t,r)[2]}function Ap(e,t,r){t=+t,e=+e,r=+r;let n=t<e,i=n?dm(t,e,r):dm(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function dw(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r<i||r===void 0&&i>=i)&&(r=i)}return r}function pw(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r>i||r===void 0&&i>=i)&&(r=i)}return r}function hw(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?dI:oV(i);n>r;){if(n-r>600){let l=n-r+1,c=t-r+1,f=Math.log(l),u=.5*Math.exp(2*f/3),d=.5*Math.sqrt(f*u*(l-u)/l)*(c-l/2<0?-1:1),p=Math.max(r,Math.floor(t-c*u/l+d)),_=Math.min(n,Math.floor(t+(l-c)*u/l+d));hw(e,t,p,_,i)}let s=e[t],a=r,o=n;for(pm(e,r,t),i(e[n],s)>0&&pm(e,r,n);a<o;){for(pm(e,a,o),++a,--o;i(e[a],s)<0;)++a;for(;i(e[o],s)>0;)--o}i(e[r],s)===0?pm(e,r,o):(++o,pm(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function pm(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function gw(e,t,r){if(e=Float64Array.from(nV(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return pw(e);if(t>=1)return dw(e);var n,i=(n-1)*t,s=Math.floor(i),a=dw(hw(e,s).subarray(0,s+1)),o=pw(e.subarray(s+1));return a+(o-a)*(i-s)}}function pI(e,t,r=fm){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,s=Math.floor(i),a=+r(e[s],s,e),o=+r(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function yw(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(i);++n<i;)s[n]=e+n*r;return s}function Ur(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ws(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var mw=Symbol("implicit");function Tp(){var e=new Op,t=[],r=[],n=mw;function i(s){let a=e.get(s);if(a===void 0){if(n!==mw)return n;e.set(s,a=t.push(s)-1)}return r[a%r.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new Op;for(let a of s)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(s){return arguments.length?(r=Array.from(s),i):r.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return Tp(t,r).unknown(n)},Ur.apply(i,arguments),i}function tc(){var e=Tp().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,s,a,o=!1,l=0,c=0,f=.5;delete e.unknown;function u(){var d=t().length,p=i<n,_=p?i:n,w=p?n:i;s=(w-_)/Math.max(1,d-l+c*2),o&&(s=Math.floor(s)),_+=(w-_-s*(d-l))*f,a=s*(1-l),o&&(_=Math.round(_),a=Math.round(a));var k=yw(d).map(function(S){return _+s*S});return r(p?k.reverse():k)}return e.domain=function(d){return arguments.length?(t(d),u()):t()},e.range=function(d){return arguments.length?([n,i]=d,n=+n,i=+i,u()):[n,i]},e.rangeRound=function(d){return[n,i]=d,n=+n,i=+i,o=!0,u()},e.bandwidth=function(){return a},e.step=function(){return s},e.round=function(d){return arguments.length?(o=!!d,u()):o},e.padding=function(d){return arguments.length?(l=Math.min(1,c=+d),u()):l},e.paddingInner=function(d){return arguments.length?(l=Math.min(1,d),u()):l},e.paddingOuter=function(d){return arguments.length?(c=+d,u()):c},e.align=function(d){return arguments.length?(f=Math.max(0,Math.min(1,d)),u()):f},e.copy=function(){return tc(t(),[n,i]).round(o).paddingInner(l).paddingOuter(c).align(f)},Ur.apply(u(),arguments)}function lV(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return lV(t())},e}function rc(){return lV(tc.apply(null,arguments).paddingInner(1))}function bw(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function hI(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function ym(){}var hm=.7,ww=1/hm,Cp="\\s*([+-]?\\d+)\\s*",gm="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",eo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",d2e=/^#([0-9a-f]{3,8})$/,p2e=new RegExp(`^rgb\\(${Cp},${Cp},${Cp}\\)$`),h2e=new RegExp(`^rgb\\(${eo},${eo},${eo}\\)$`),g2e=new RegExp(`^rgba\\(${Cp},${Cp},${Cp},${gm}\\)$`),y2e=new RegExp(`^rgba\\(${eo},${eo},${eo},${gm}\\)$`),m2e=new RegExp(`^hsl\\(${gm},${eo},${eo}\\)$`),b2e=new RegExp(`^hsla\\(${gm},${eo},${eo},${gm}\\)$`),cV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};bw(ym,nc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:uV,formatHex:uV,formatHex8:v2e,formatHsl:_2e,formatRgb:fV,toString:fV});function uV(){return this.rgb().formatHex()}function v2e(){return this.rgb().formatHex8()}function _2e(){return mV(this).formatHsl()}function fV(){return this.rgb().formatRgb()}function nc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=d2e.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?dV(t):r===3?new Yi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?vw(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?vw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=p2e.exec(e))?new Yi(t[1],t[2],t[3],1):(t=h2e.exec(e))?new Yi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=g2e.exec(e))?vw(t[1],t[2],t[3],t[4]):(t=y2e.exec(e))?vw(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=m2e.exec(e))?gV(t[1],t[2]/100,t[3]/100,1):(t=b2e.exec(e))?gV(t[1],t[2]/100,t[3]/100,t[4]):cV.hasOwnProperty(e)?dV(cV[e]):e==="transparent"?new Yi(NaN,NaN,NaN,0):null}function dV(e){return new Yi(e>>16&255,e>>8&255,e&255,1)}function vw(e,t,r,n){return n<=0&&(e=t=r=NaN),new Yi(e,t,r,n)}function w2e(e){return e instanceof ym||(e=nc(e)),e?(e=e.rgb(),new Yi(e.r,e.g,e.b,e.opacity)):new Yi}function Ip(e,t,r,n){return arguments.length===1?w2e(e):new Yi(e,t,r,n??1)}function Yi(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}bw(Yi,Ip,hI(ym,{brighter(e){return e=e==null?ww:Math.pow(ww,e),new Yi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?hm:Math.pow(hm,e),new Yi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Yi(Vu(this.r),Vu(this.g),Vu(this.b),Sw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:pV,formatHex:pV,formatHex8:S2e,formatRgb:hV,toString:hV}));function pV(){return`#${qu(this.r)}${qu(this.g)}${qu(this.b)}`}function S2e(){return`#${qu(this.r)}${qu(this.g)}${qu(this.b)}${qu((isNaN(this.opacity)?1:this.opacity)*255)}`}function hV(){let e=Sw(this.opacity);return`${e===1?"rgb(":"rgba("}${Vu(this.r)}, ${Vu(this.g)}, ${Vu(this.b)}${e===1?")":`, ${e})`}`}function Sw(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Vu(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function qu(e){return e=Vu(e),(e<16?"0":"")+e.toString(16)}function gV(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ya(e,t,r,n)}function mV(e){if(e instanceof ya)return new ya(e.h,e.s,e.l,e.opacity);if(e instanceof ym||(e=nc(e)),!e)return new ya;if(e instanceof ya)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(r-n)/o+(r<n)*6:r===s?a=(n-t)/o+2:a=(t-r)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new ya(a,o,l,e.opacity)}function bV(e,t,r,n){return arguments.length===1?mV(e):new ya(e,t,r,n??1)}function ya(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}bw(ya,bV,hI(ym,{brighter(e){return e=e==null?ww:Math.pow(ww,e),new ya(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?hm:Math.pow(hm,e),new ya(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Yi(gI(e>=240?e-240:e+120,i,n),gI(e,i,n),gI(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new ya(yV(this.h),_w(this.s),_w(this.l),Sw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=Sw(this.opacity);return`${e===1?"hsl(":"hsla("}${yV(this.h)}, ${_w(this.s)*100}%, ${_w(this.l)*100}%${e===1?")":`, ${e})`}`}}));function yV(e){return e=(e||0)%360,e<0?e+360:e}function _w(e){return Math.max(0,Math.min(1,e||0))}function gI(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function yI(e,t,r,n,i){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*r+(1+3*e+3*s-3*a)*n+a*i)/6}function vV(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],s=e[n+1],a=n>0?e[n-1]:2*i-s,o=n<t-1?e[n+2]:2*s-i;return yI((r-n/t)*t,a,i,s,o)}}function _V(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],s=e[n%t],a=e[(n+1)%t],o=e[(n+2)%t];return yI((r-n/t)*t,i,s,a,o)}}var mm=e=>()=>e;function x2e(e,t){return function(r){return e+r*t}}function k2e(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function wV(e){return(e=+e)==1?xw:function(t,r){return r-t?k2e(t,r,e):mm(isNaN(t)?r:t)}}function xw(e,t){var r=t-e;return r?x2e(e,r):mm(isNaN(e)?t:e)}var mI=function e(t){var r=wV(t);function n(i,s){var a=r((i=Ip(i)).r,(s=Ip(s)).r),o=r(i.g,s.g),l=r(i.b,s.b),c=xw(i.opacity,s.opacity);return function(f){return i.r=a(f),i.g=o(f),i.b=l(f),i.opacity=c(f),i+""}}return n.gamma=e,n}(1);function SV(e){return function(t){var r=t.length,n=new Array(r),i=new Array(r),s=new Array(r),a,o;for(a=0;a<r;++a)o=Ip(t[a]),n[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return n=e(n),i=e(i),s=e(s),o.opacity=1,function(l){return o.r=n(l),o.g=i(l),o.b=s(l),o+""}}}var e$e=SV(vV),t$e=SV(_V);function xV(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(s){for(i=0;i<r;++i)n[i]=e[i]*(1-s)+t[i]*s;return n}}function kV(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function EV(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),s=new Array(r),a;for(a=0;a<n;++a)i[a]=bs(e[a],t[a]);for(;a<r;++a)s[a]=t[a];return function(o){for(a=0;a<n;++a)s[a]=i[a](o);return s}}function OV(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function ic(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function AV(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=bs(e[i],t[i]):n[i]=t[i];return function(s){for(i in r)n[i]=r[i](s);return n}}var vI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,bI=new RegExp(vI.source,"g");function E2e(e){return function(){return e}}function O2e(e){return function(t){return e(t)+""}}function TV(e,t){var r=vI.lastIndex=bI.lastIndex=0,n,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(n=vI.exec(e))&&(i=bI.exec(t));)(s=i.index)>r&&(s=t.slice(r,s),o[a]?o[a]+=s:o[++a]=s),(n=n[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:ic(n,i)})),r=bI.lastIndex;return r<t.length&&(s=t.slice(r),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?O2e(l[0].x):E2e(t):(t=l.length,function(c){for(var f=0,u;f<t;++f)o[(u=l[f]).i]=u.x(c);return o.join("")})}function bs(e,t){var r=typeof t,n;return t==null||r==="boolean"?mm(t):(r==="number"?ic:r==="string"?(n=nc(t))?(t=n,mI):TV:t instanceof nc?mI:t instanceof Date?OV:kV(t)?xV:Array.isArray(t)?EV:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?AV:ic)(e,t)}function Hu(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function kw(e,t){t===void 0&&(t=e,e=bs);for(var r=0,n=t.length-1,i=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(i,i=t[++r]);return function(a){var o=Math.max(0,Math.min(n-1,Math.floor(a*=n)));return s[o](a-o)}}function _I(e){return function(){return e}}function sc(e){return+e}var CV=[0,1];function On(e){return e}function wI(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:_I(isNaN(t)?NaN:.5)}function A2e(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function T2e(e,t,r){var n=e[0],i=e[1],s=t[0],a=t[1];return i<n?(n=wI(i,n),s=r(a,s)):(n=wI(n,i),s=r(s,a)),function(o){return s(n(o))}}function C2e(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),s=new Array(n),a=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<n;)i[a]=wI(e[a],e[a+1]),s[a]=r(t[a],t[a+1]);return function(o){var l=ga(e,o,1,n)-1;return s[l](i[l](o))}}function to(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Wu(){var e=CV,t=CV,r=bs,n,i,s,a=On,o,l,c;function f(){var d=Math.min(e.length,t.length);return a!==On&&(a=A2e(e[0],e[d-1])),o=d>2?C2e:T2e,l=c=null,u}function u(d){return d==null||isNaN(d=+d)?s:(l||(l=o(e.map(n),t,r)))(n(a(d)))}return u.invert=function(d){return a(i((c||(c=o(t,e.map(n),ic)))(d)))},u.domain=function(d){return arguments.length?(e=Array.from(d,sc),f()):e.slice()},u.range=function(d){return arguments.length?(t=Array.from(d),f()):t.slice()},u.rangeRound=function(d){return t=Array.from(d),r=Hu,f()},u.clamp=function(d){return arguments.length?(a=d?!0:On,f()):a!==On},u.interpolate=function(d){return arguments.length?(r=d,f()):r},u.unknown=function(d){return arguments.length?(s=d,u):s},function(d,p){return n=d,i=p,f()}}function Ju(){return Wu()(On,On)}function IV(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Gu(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function ro(e){return e=Gu(Math.abs(e)),e?e[1]:NaN}function NV(e,t){return function(r,n){for(var i=r.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),s.push(r.substring(i-=o,i+o)),!((l+=o+1)>n));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function PV(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var I2e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function no(e){if(!(t=I2e.exec(e)))throw new Error("invalid format: "+e);var t;return new Ew({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}no.prototype=Ew.prototype;function Ew(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Ew.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function LV(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var SI;function FV(e,t){var r=Gu(e,t);if(!r)return e+"";var n=r[0],i=r[1],s=i-(SI=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=n.length;return s===a?n:s>a?n+new Array(s-a+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Gu(e,Math.max(0,t+s-1))[0]}function xI(e,t){var r=Gu(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}var kI={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:IV,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>xI(e*100,t),r:xI,s:FV,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function EI(e){return e}var DV=Array.prototype.map,jV=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function BV(e){var t=e.grouping===void 0||e.thousands===void 0?EI:NV(DV.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?EI:PV(DV.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(u){u=no(u);var d=u.fill,p=u.align,_=u.sign,w=u.symbol,k=u.zero,S=u.width,O=u.comma,A=u.precision,C=u.trim,I=u.type;I==="n"?(O=!0,I="g"):kI[I]||(A===void 0&&(A=12),C=!0,I="g"),(k||d==="0"&&p==="=")&&(k=!0,d="0",p="=");var D=w==="$"?r:w==="#"&&/[boxX]/.test(I)?"0"+I.toLowerCase():"",L=w==="$"?n:/[%p]/.test(I)?a:"",U=kI[I],te=/[defgprs%]/.test(I);A=A===void 0?6:/[gprs]/.test(I)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function V(X){var Z=D,se=L,pe,de,F;if(I==="c")se=U(X)+se,X="";else{X=+X;var H=X<0||1/X<0;if(X=isNaN(X)?l:U(Math.abs(X),A),C&&(X=LV(X)),H&&+X==0&&_!=="+"&&(H=!1),Z=(H?_==="("?_:o:_==="-"||_==="("?"":_)+Z,se=(I==="s"?jV[8+SI/3]:"")+se+(H&&_==="("?")":""),te){for(pe=-1,de=X.length;++pe<de;)if(F=X.charCodeAt(pe),48>F||F>57){se=(F===46?i+X.slice(pe+1):X.slice(pe))+se,X=X.slice(0,pe);break}}}O&&!k&&(X=t(X,1/0));var Q=Z.length+X.length+se.length,R=Q<S?new Array(S-Q+1).join(d):"";switch(O&&k&&(X=t(R+X,R.length?S-se.length:1/0),R=""),p){case"<":X=Z+X+se+R;break;case"=":X=Z+R+X+se;break;case"^":X=R.slice(0,Q=R.length>>1)+Z+X+se+R.slice(Q);break;default:X=R+Z+X+se;break}return s(X)}return V.toString=function(){return u+""},V}function f(u,d){var p=c((u=no(u),u.type="f",u)),_=Math.max(-8,Math.min(8,Math.floor(ro(d)/3)))*3,w=Math.pow(10,-_),k=jV[8+_/3];return function(S){return p(w*S)+k}}return{format:c,formatPrefix:f}}var Ow,Np,Aw;OI({thousands:",",grouping:[3],currency:["$",""]});function OI(e){return Ow=BV(e),Np=Ow.format,Aw=Ow.formatPrefix,Ow}function AI(e){return Math.max(0,-ro(Math.abs(e)))}function TI(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ro(t)/3)))*3-ro(Math.abs(e)))}function CI(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ro(t)-ro(e))+1}function bm(e,t,r,n){var i=Ap(e,t,r),s;switch(n=no(n??",f"),n.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(s=TI(i,a))&&(n.precision=s),Aw(n,a)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=CI(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=AI(i))&&(n.precision=s-(n.type==="%")*2);break}}return Np(n)}function Ii(e){var t=e.domain;return e.ticks=function(r){var n=t();return zu(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return bm(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,s=n.length-1,a=n[i],o=n[s],l,c,f=10;for(o<a&&(c=a,a=o,o=c,c=i,i=s,s=c);f-- >0;){if(c=dm(a,o,r),c===l)return n[i]=a,n[s]=o,t(n);if(c>0)a=Math.floor(a/c)*c,o=Math.ceil(o/c)*c;else if(c<0)a=Math.ceil(a*c)/c,o=Math.floor(o*c)/c;else break;l=c}return e},e}function Ku(){var e=Ju();return e.copy=function(){return to(e,Ku())},Ur.apply(e,arguments),Ii(e)}function Tw(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,sc),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return Tw(e).unknown(t)},e=arguments.length?Array.from(e,sc):[0,1],Ii(r)}function vm(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],s=e[n],a;return s<i&&(a=r,r=n,n=a,a=i,i=s,s=a),e[r]=t.floor(i),e[n]=t.ceil(s),e}function MV(e){return Math.log(e)}function RV(e){return Math.exp(e)}function N2e(e){return-Math.log(-e)}function P2e(e){return-Math.exp(-e)}function L2e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function F2e(e){return e===10?L2e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function D2e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function $V(e){return(t,r)=>-e(-t,r)}function _m(e){let t=e(MV,RV),r=t.domain,n=10,i,s;function a(){return i=D2e(n),s=F2e(n),r()[0]<0?(i=$V(i),s=$V(s),e(N2e,P2e)):e(MV,RV),t}return t.base=function(o){return arguments.length?(n=+o,a()):n},t.domain=function(o){return arguments.length?(r(o),a()):r()},t.ticks=o=>{let l=r(),c=l[0],f=l[l.length-1],u=f<c;u&&([c,f]=[f,c]);let d=i(c),p=i(f),_,w,k=o==null?10:+o,S=[];if(!(n%1)&&p-d<k){if(d=Math.floor(d),p=Math.ceil(p),c>0){for(;d<=p;++d)for(_=1;_<n;++_)if(w=d<0?_/s(-d):_*s(d),!(w<c)){if(w>f)break;S.push(w)}}else for(;d<=p;++d)for(_=n-1;_>=1;--_)if(w=d>0?_/s(-d):_*s(d),!(w<c)){if(w>f)break;S.push(w)}S.length*2<k&&(S=zu(c,f,k))}else S=zu(d,p,Math.min(p-d,k)).map(s);return u?S.reverse():S},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=no(l)).precision==null&&(l.trim=!0),l=Np(l)),o===1/0)return l;let c=Math.max(1,n*o/t.ticks().length);return f=>{let u=f/s(Math.round(i(f)));return u*n<n-.5&&(u*=n),u<=c?l(f):""}},t.nice=()=>r(vm(r(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),t}function Cw(){let e=_m(Wu()).domain([1,10]);return e.copy=()=>to(e,Cw()).base(e.base()),Ur.apply(e,arguments),e}function UV(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function zV(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function wm(e){var t=1,r=e(UV(t),zV(t));return r.constant=function(n){return arguments.length?e(UV(t=+n),zV(t)):t},Ii(r)}function Iw(){var e=wm(Wu());return e.copy=function(){return to(e,Iw()).constant(e.constant())},Ur.apply(e,arguments)}function qV(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function j2e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function B2e(e){return e<0?-e*e:e*e}function Sm(e){var t=e(On,On),r=1;function n(){return r===1?e(On,On):r===.5?e(j2e,B2e):e(qV(r),qV(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Ii(t)}function xm(){var e=Sm(Wu());return e.copy=function(){return to(e,xm()).exponent(e.exponent())},Ur.apply(e,arguments),e}function VV(){return xm.apply(null,arguments).exponent(.5)}function HV(e){return Math.sign(e)*e*e}function M2e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Nw(){var e=Ju(),t=[0,1],r=!1,n;function i(s){var a=M2e(e(s));return isNaN(a)?n:r?Math.round(a):a}return i.invert=function(s){return e.invert(HV(s))},i.domain=function(s){return arguments.length?(e.domain(s),i):e.domain()},i.range=function(s){return arguments.length?(e.range((t=Array.from(s,sc)).map(HV)),i):t.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(r=!!s,i):r},i.clamp=function(s){return arguments.length?(e.clamp(s),i):e.clamp()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return Nw(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ur.apply(i,arguments),Ii(i)}function Pw(){var e=[],t=[],r=[],n;function i(){var a=0,o=Math.max(1,t.length);for(r=new Array(o-1);++a<o;)r[a-1]=pI(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?n:t[ga(r,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Ci),i()},s.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return Pw().domain(e).range(t).unknown(n)},Ur.apply(s,arguments)}function Lw(){var e=0,t=1,r=1,n=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[ga(n,l,0,r)]:s}function o(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return a}return a.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},a.range=function(l){return arguments.length?(r=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var c=i.indexOf(l);return c<0?[NaN,NaN]:c<1?[e,n[0]]:c>=r?[n[r-1],t]:[n[c-1],n[c]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return n.slice()},a.copy=function(){return Lw().domain([e,t]).range(i).unknown(s)},Ur.apply(Ii(a),arguments)}function Fw(){var e=[.5],t=[0,1],r,n=1;function i(s){return s!=null&&s<=s?t[ga(e,s,0,n)]:r}return i.domain=function(s){return arguments.length?(e=Array.from(s),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return Fw().domain(e).range(t).unknown(r)},Ur.apply(i,arguments)}var II=new Date,NI=new Date;function wr(e,t,r,n){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{let a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{let l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let c;do l.push(c=new Date(+s)),t(s,o),e(s);while(c<s&&s<a);return l},i.filter=s=>wr(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),r&&(i.count=(s,a)=>(II.setTime(+s),NI.setTime(+a),e(II),e(NI),Math.floor(r(II,NI))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(n?a=>n(a)%s===0:a=>i.count(0,a)%s===0):i)),i}var km=wr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);km.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?wr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):km);var fze=km.range;var Js=wr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),WV=Js.range;var Pp=wr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),R2e=Pp.range,Lp=wr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),$2e=Lp.range;var Fp=wr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),U2e=Fp.range,Dp=wr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),z2e=Dp.range;var Zo=wr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),q2e=Zo.range,Zu=wr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),V2e=Zu.range,Dw=wr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),H2e=Dw.range;function Qu(e){return wr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}var Qo=Qu(0),jp=Qu(1),GV=Qu(2),KV=Qu(3),ac=Qu(4),YV=Qu(5),XV=Qu(6),ZV=Qo.range,W2e=jp.range,J2e=GV.range,G2e=KV.range,K2e=ac.range,Y2e=YV.range,X2e=XV.range;function ef(e){return wr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/6048e5)}var el=ef(0),Bp=ef(1),QV=ef(2),eH=ef(3),oc=ef(4),tH=ef(5),rH=ef(6),nH=el.range,Z2e=Bp.range,Q2e=QV.range,ewe=eH.range,twe=oc.range,rwe=tH.range,nwe=rH.range;var Mp=wr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),iwe=Mp.range,Rp=wr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),swe=Rp.range;var vs=wr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());vs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:wr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});var awe=vs.range,_s=wr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());_s.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:wr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});var owe=_s.range;function sH(e,t,r,n,i,s){let a=[[Js,1,1e3],[Js,5,5*1e3],[Js,15,15*1e3],[Js,30,30*1e3],[s,1,6e4],[s,5,5*6e4],[s,15,15*6e4],[s,30,30*6e4],[i,1,36e5],[i,3,3*36e5],[i,6,6*36e5],[i,12,12*36e5],[n,1,864e5],[n,2,2*864e5],[r,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function o(c,f,u){let d=f<c;d&&([c,f]=[f,c]);let p=u&&typeof u.range=="function"?u:l(c,f,u),_=p?p.range(c,+f+1):[];return d?_.reverse():_}function l(c,f,u){let d=Math.abs(f-c)/u,p=Uu(([,,k])=>k).right(a,d);if(p===a.length)return e.every(Ap(c/31536e6,f/31536e6,u));if(p===0)return km.every(Math.max(Ap(c,f,u),1));let[_,w]=a[d/a[p-1][2]<a[p][2]/d?p-1:p];return _.every(w)}return[o,l]}var[PI,LI]=sH(_s,Rp,el,Dw,Dp,Lp),[FI,DI]=sH(vs,Mp,Qo,Zo,Fp,Pp);function jI(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function BI(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Om(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function MI(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,c=Am(i),f=Tm(i),u=Am(s),d=Tm(s),p=Am(a),_=Tm(a),w=Am(o),k=Tm(o),S=Am(l),O=Tm(l),A={a:H,A:Q,b:R,B:$,c:null,d:fH,e:fH,f:Nwe,g:Uwe,G:qwe,H:Twe,I:Cwe,j:Iwe,L:yH,m:Pwe,M:Lwe,p:q,q:ie,Q:hH,s:gH,S:Fwe,u:Dwe,U:jwe,V:Bwe,w:Mwe,W:Rwe,x:null,X:null,y:$we,Y:zwe,Z:Vwe,"%":pH},C={a:oe,A:fe,b:_e,B:Ee,c:null,d:dH,e:dH,f:Gwe,g:i1e,G:a1e,H:Hwe,I:Wwe,j:Jwe,L:bH,m:Kwe,M:Ywe,p:Se,q:le,Q:hH,s:gH,S:Xwe,u:Zwe,U:Qwe,V:e1e,w:t1e,W:r1e,x:null,X:null,y:n1e,Y:s1e,Z:o1e,"%":pH},I={a:V,A:X,b:Z,B:se,c:pe,d:cH,e:cH,f:kwe,g:lH,G:oH,H:uH,I:uH,j:_we,L:xwe,m:vwe,M:wwe,p:te,q:bwe,Q:Owe,s:Awe,S:Swe,u:pwe,U:hwe,V:gwe,w:dwe,W:ywe,x:de,X:F,y:lH,Y:oH,Z:mwe,"%":Ewe};A.x=D(r,A),A.X=D(n,A),A.c=D(t,A),C.x=D(r,C),C.X=D(n,C),C.c=D(t,C);function D(we,W){return function(J){var ne=[],Oe=-1,Ne=0,Ce=we.length,Xe,Ze,kt;for(J instanceof Date||(J=new Date(+J));++Oe<Ce;)we.charCodeAt(Oe)===37&&(ne.push(we.slice(Ne,Oe)),(Ze=aH[Xe=we.charAt(++Oe)])!=null?Xe=we.charAt(++Oe):Ze=Xe==="e"?" ":"0",(kt=W[Xe])&&(Xe=kt(J,Ze)),ne.push(Xe),Ne=Oe+1);return ne.push(we.slice(Ne,Oe)),ne.join("")}}function L(we,W){return function(J){var ne=Om(1900,void 0,1),Oe=U(ne,we,J+="",0),Ne,Ce;if(Oe!=J.length)return null;if("Q"in ne)return new Date(ne.Q);if("s"in ne)return new Date(ne.s*1e3+("L"in ne?ne.L:0));if(W&&!("Z"in ne)&&(ne.Z=0),"p"in ne&&(ne.H=ne.H%12+ne.p*12),ne.m===void 0&&(ne.m="q"in ne?ne.q:0),"V"in ne){if(ne.V<1||ne.V>53)return null;"w"in ne||(ne.w=1),"Z"in ne?(Ne=BI(Om(ne.y,0,1)),Ce=Ne.getUTCDay(),Ne=Ce>4||Ce===0?Bp.ceil(Ne):Bp(Ne),Ne=Zu.offset(Ne,(ne.V-1)*7),ne.y=Ne.getUTCFullYear(),ne.m=Ne.getUTCMonth(),ne.d=Ne.getUTCDate()+(ne.w+6)%7):(Ne=jI(Om(ne.y,0,1)),Ce=Ne.getDay(),Ne=Ce>4||Ce===0?jp.ceil(Ne):jp(Ne),Ne=Zo.offset(Ne,(ne.V-1)*7),ne.y=Ne.getFullYear(),ne.m=Ne.getMonth(),ne.d=Ne.getDate()+(ne.w+6)%7)}else("W"in ne||"U"in ne)&&("w"in ne||(ne.w="u"in ne?ne.u%7:"W"in ne?1:0),Ce="Z"in ne?BI(Om(ne.y,0,1)).getUTCDay():jI(Om(ne.y,0,1)).getDay(),ne.m=0,ne.d="W"in ne?(ne.w+6)%7+ne.W*7-(Ce+5)%7:ne.w+ne.U*7-(Ce+6)%7);return"Z"in ne?(ne.H+=ne.Z/100|0,ne.M+=ne.Z%100,BI(ne)):jI(ne)}}function U(we,W,J,ne){for(var Oe=0,Ne=W.length,Ce=J.length,Xe,Ze;Oe<Ne;){if(ne>=Ce)return-1;if(Xe=W.charCodeAt(Oe++),Xe===37){if(Xe=W.charAt(Oe++),Ze=I[Xe in aH?W.charAt(Oe++):Xe],!Ze||(ne=Ze(we,J,ne))<0)return-1}else if(Xe!=J.charCodeAt(ne++))return-1}return ne}function te(we,W,J){var ne=c.exec(W.slice(J));return ne?(we.p=f.get(ne[0].toLowerCase()),J+ne[0].length):-1}function V(we,W,J){var ne=p.exec(W.slice(J));return ne?(we.w=_.get(ne[0].toLowerCase()),J+ne[0].length):-1}function X(we,W,J){var ne=u.exec(W.slice(J));return ne?(we.w=d.get(ne[0].toLowerCase()),J+ne[0].length):-1}function Z(we,W,J){var ne=S.exec(W.slice(J));return ne?(we.m=O.get(ne[0].toLowerCase()),J+ne[0].length):-1}function se(we,W,J){var ne=w.exec(W.slice(J));return ne?(we.m=k.get(ne[0].toLowerCase()),J+ne[0].length):-1}function pe(we,W,J){return U(we,t,W,J)}function de(we,W,J){return U(we,r,W,J)}function F(we,W,J){return U(we,n,W,J)}function H(we){return a[we.getDay()]}function Q(we){return s[we.getDay()]}function R(we){return l[we.getMonth()]}function $(we){return o[we.getMonth()]}function q(we){return i[+(we.getHours()>=12)]}function ie(we){return 1+~~(we.getMonth()/3)}function oe(we){return a[we.getUTCDay()]}function fe(we){return s[we.getUTCDay()]}function _e(we){return l[we.getUTCMonth()]}function Ee(we){return o[we.getUTCMonth()]}function Se(we){return i[+(we.getUTCHours()>=12)]}function le(we){return 1+~~(we.getUTCMonth()/3)}return{format:function(we){var W=D(we+="",A);return W.toString=function(){return we},W},parse:function(we){var W=L(we+="",!1);return W.toString=function(){return we},W},utcFormat:function(we){var W=D(we+="",C);return W.toString=function(){return we},W},utcParse:function(we){var W=L(we+="",!0);return W.toString=function(){return we},W}}}var aH={"-":"",_:" ",0:"0"},Dn=/^\s*\d+/,cwe=/^%/,uwe=/[\\^$*+?|[\]().{}]/g;function Zt(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",s=i.length;return n+(s<r?new Array(r-s+1).join(t)+i:i)}function fwe(e){return e.replace(uwe,"\\$&")}function Am(e){return new RegExp("^(?:"+e.map(fwe).join("|")+")","i")}function Tm(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function dwe(e,t,r){var n=Dn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function pwe(e,t,r){var n=Dn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function hwe(e,t,r){var n=Dn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function gwe(e,t,r){var n=Dn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function ywe(e,t,r){var n=Dn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function oH(e,t,r){var n=Dn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function lH(e,t,r){var n=Dn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function mwe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function bwe(e,t,r){var n=Dn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function vwe(e,t,r){var n=Dn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function cH(e,t,r){var n=Dn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function _we(e,t,r){var n=Dn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function uH(e,t,r){var n=Dn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function wwe(e,t,r){var n=Dn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function Swe(e,t,r){var n=Dn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function xwe(e,t,r){var n=Dn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function kwe(e,t,r){var n=Dn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Ewe(e,t,r){var n=cwe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Owe(e,t,r){var n=Dn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Awe(e,t,r){var n=Dn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function fH(e,t){return Zt(e.getDate(),t,2)}function Twe(e,t){return Zt(e.getHours(),t,2)}function Cwe(e,t){return Zt(e.getHours()%12||12,t,2)}function Iwe(e,t){return Zt(1+Zo.count(vs(e),e),t,3)}function yH(e,t){return Zt(e.getMilliseconds(),t,3)}function Nwe(e,t){return yH(e,t)+"000"}function Pwe(e,t){return Zt(e.getMonth()+1,t,2)}function Lwe(e,t){return Zt(e.getMinutes(),t,2)}function Fwe(e,t){return Zt(e.getSeconds(),t,2)}function Dwe(e){var t=e.getDay();return t===0?7:t}function jwe(e,t){return Zt(Qo.count(vs(e)-1,e),t,2)}function mH(e){var t=e.getDay();return t>=4||t===0?ac(e):ac.ceil(e)}function Bwe(e,t){return e=mH(e),Zt(ac.count(vs(e),e)+(vs(e).getDay()===4),t,2)}function Mwe(e){return e.getDay()}function Rwe(e,t){return Zt(jp.count(vs(e)-1,e),t,2)}function $we(e,t){return Zt(e.getFullYear()%100,t,2)}function Uwe(e,t){return e=mH(e),Zt(e.getFullYear()%100,t,2)}function zwe(e,t){return Zt(e.getFullYear()%1e4,t,4)}function qwe(e,t){var r=e.getDay();return e=r>=4||r===0?ac(e):ac.ceil(e),Zt(e.getFullYear()%1e4,t,4)}function Vwe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Zt(t/60|0,"0",2)+Zt(t%60,"0",2)}function dH(e,t){return Zt(e.getUTCDate(),t,2)}function Hwe(e,t){return Zt(e.getUTCHours(),t,2)}function Wwe(e,t){return Zt(e.getUTCHours()%12||12,t,2)}function Jwe(e,t){return Zt(1+Zu.count(_s(e),e),t,3)}function bH(e,t){return Zt(e.getUTCMilliseconds(),t,3)}function Gwe(e,t){return bH(e,t)+"000"}function Kwe(e,t){return Zt(e.getUTCMonth()+1,t,2)}function Ywe(e,t){return Zt(e.getUTCMinutes(),t,2)}function Xwe(e,t){return Zt(e.getUTCSeconds(),t,2)}function Zwe(e){var t=e.getUTCDay();return t===0?7:t}function Qwe(e,t){return Zt(el.count(_s(e)-1,e),t,2)}function vH(e){var t=e.getUTCDay();return t>=4||t===0?oc(e):oc.ceil(e)}function e1e(e,t){return e=vH(e),Zt(oc.count(_s(e),e)+(_s(e).getUTCDay()===4),t,2)}function t1e(e){return e.getUTCDay()}function r1e(e,t){return Zt(Bp.count(_s(e)-1,e),t,2)}function n1e(e,t){return Zt(e.getUTCFullYear()%100,t,2)}function i1e(e,t){return e=vH(e),Zt(e.getUTCFullYear()%100,t,2)}function s1e(e,t){return Zt(e.getUTCFullYear()%1e4,t,4)}function a1e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?oc(e):oc.ceil(e),Zt(e.getUTCFullYear()%1e4,t,4)}function o1e(){return"+0000"}function pH(){return"%"}function hH(e){return+e}function gH(e){return Math.floor(+e/1e3)}var $p,jw,_H,Bw,wH;RI({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function RI(e){return $p=MI(e),jw=$p.format,_H=$p.parse,Bw=$p.utcFormat,wH=$p.utcParse,$p}function l1e(e){return new Date(e)}function c1e(e){return e instanceof Date?+e:+new Date(+e)}function Mw(e,t,r,n,i,s,a,o,l,c){var f=Ju(),u=f.invert,d=f.domain,p=c(".%L"),_=c(":%S"),w=c("%I:%M"),k=c("%I %p"),S=c("%a %d"),O=c("%b %d"),A=c("%B"),C=c("%Y");function I(D){return(l(D)<D?p:o(D)<D?_:a(D)<D?w:s(D)<D?k:n(D)<D?i(D)<D?S:O:r(D)<D?A:C)(D)}return f.invert=function(D){return new Date(u(D))},f.domain=function(D){return arguments.length?d(Array.from(D,c1e)):d().map(l1e)},f.ticks=function(D){var L=d();return e(L[0],L[L.length-1],D??10)},f.tickFormat=function(D,L){return L==null?I:c(L)},f.nice=function(D){var L=d();return(!D||typeof D.range!="function")&&(D=t(L[0],L[L.length-1],D??10)),D?d(vm(L,D)):f},f.copy=function(){return to(f,Mw(e,t,r,n,i,s,a,o,l,c))},f}function $I(){return Ur.apply(Mw(FI,DI,vs,Mp,Qo,Zo,Fp,Pp,Js,jw).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function UI(){return Ur.apply(Mw(PI,LI,_s,Rp,el,Zu,Dp,Lp,Js,Bw).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Rw(){var e=0,t=1,r,n,i,s,a=On,o=!1,l;function c(u){return u==null||isNaN(u=+u)?l:a(i===0?.5:(u=(s(u)-r)*i,o?Math.max(0,Math.min(1,u)):u))}c.domain=function(u){return arguments.length?([e,t]=u,r=s(e=+e),n=s(t=+t),i=r===n?0:1/(n-r),c):[e,t]},c.clamp=function(u){return arguments.length?(o=!!u,c):o},c.interpolator=function(u){return arguments.length?(a=u,c):a};function f(u){return function(d){var p,_;return arguments.length?([p,_]=d,a=u(p,_),c):[a(0),a(1)]}}return c.range=f(bs),c.rangeRound=f(Hu),c.unknown=function(u){return arguments.length?(l=u,c):l},function(u){return s=u,r=u(e),n=u(t),i=r===n?0:1/(n-r),c}}function tl(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function $w(){var e=Ii(Rw()(On));return e.copy=function(){return tl(e,$w())},Ws.apply(e,arguments)}function zI(){var e=_m(Rw()).domain([1,10]);return e.copy=function(){return tl(e,zI()).base(e.base())},Ws.apply(e,arguments)}function qI(){var e=wm(Rw());return e.copy=function(){return tl(e,qI()).constant(e.constant())},Ws.apply(e,arguments)}function Uw(){var e=Sm(Rw());return e.copy=function(){return tl(e,Uw()).exponent(e.exponent())},Ws.apply(e,arguments)}function SH(){return Uw.apply(null,arguments).exponent(.5)}function zw(){var e=[],t=On;function r(n){if(n!=null&&!isNaN(n=+n))return t((ga(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Ci),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,s)=>gw(e,s/n))},r.copy=function(){return zw(t).domain(e)},Ws.apply(r,arguments)}function qw(){var e=0,t=.5,r=1,n=1,i,s,a,o,l,c=On,f,u=!1,d;function p(w){return isNaN(w=+w)?d:(w=.5+((w=+f(w))-s)*(n*w<n*s?o:l),c(u?Math.max(0,Math.min(1,w)):w))}p.domain=function(w){return arguments.length?([e,t,r]=w,i=f(e=+e),s=f(t=+t),a=f(r=+r),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),n=s<i?-1:1,p):[e,t,r]},p.clamp=function(w){return arguments.length?(u=!!w,p):u},p.interpolator=function(w){return arguments.length?(c=w,p):c};function _(w){return function(k){var S,O,A;return arguments.length?([S,O,A]=k,c=kw(w,[S,O,A]),p):[c(0),c(.5),c(1)]}}return p.range=_(bs),p.rangeRound=_(Hu),p.unknown=function(w){return arguments.length?(d=w,p):d},function(w){return f=w,i=w(e),s=w(t),a=w(r),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),n=s<i?-1:1,p}}function Vw(){var e=Ii(qw()(On));return e.copy=function(){return tl(e,Vw())},Ws.apply(e,arguments)}function VI(){var e=_m(qw()).domain([.1,1,10]);return e.copy=function(){return tl(e,VI()).base(e.base())},Ws.apply(e,arguments)}function HI(){var e=wm(qw());return e.copy=function(){return tl(e,HI()).constant(e.constant())},Ws.apply(e,arguments)}function Hw(){var e=Sm(qw());return e.copy=function(){return tl(e,Hw()).exponent(e.exponent())},Ws.apply(e,arguments)}function xH(){return Hw.apply(null,arguments).exponent(.5)}var cr=ae(WI());function u1e(e){return h1e(e)||p1e(e)||d1e(e)||f1e()}function f1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d1e(e,t){if(e){if(typeof e=="string")return JI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JI(e,t)}}function p1e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function h1e(e){if(Array.isArray(e))return JI(e)}function JI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var g1e=function(t){return t},OH={"@@functional/placeholder":!0},AH=function(t){return t===OH},EH=function(t){return function r(){return arguments.length===0||arguments.length===1&&AH(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},y1e=function e(t,r){return t===1?r:EH(function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];var a=i.filter(function(o){return o!==OH}).length;return a>=t?r.apply(void 0,i):e(t-a,EH(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var f=i.map(function(u){return AH(u)?l.shift():u});return r.apply(void 0,u1e(f).concat(l))}))})},Cm=function(t){return y1e(t.length,t)},Im=function(t,r){for(var n=[],i=t;i<r;++i)n[i-t]=i;return n},GI=Cm(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),KI=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return g1e;var i=r.reverse(),s=i[0],a=i.slice(1);return function(){return a.reduce(function(o,l){return l(o)},s.apply(void 0,arguments))}},Nm=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},Gw=function(t){var r=null,n=null;return function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return r&&s.every(function(o,l){return o===r[l]})||(r=s,n=t.apply(void 0,s)),n}};var YI=ae(WI());function m1e(e){var t;return e===0?t=1:t=Math.floor(new YI.default(e).abs().log(10).toNumber())+1,t}function b1e(e,t,r){for(var n=new YI.default(e),i=0,s=[];n.lt(t)&&i<1e5;)s.push(n.toNumber()),n=n.add(r),i++;return s}var v1e=Cm(function(e,t,r){var n=+e,i=+t;return n+r*(i-n)}),_1e=Cm(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),w1e=Cm(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))}),Pm={rangeStep:b1e,getDigitCount:m1e,interpolateNumber:v1e,uninterpolateNumber:_1e,uninterpolateTruncation:w1e};function XI(e){return k1e(e)||x1e(e)||TH(e)||S1e()}function S1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x1e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function k1e(e){if(Array.isArray(e))return ZI(e)}function tf(e,t){return A1e(e)||O1e(e,t)||TH(e,t)||E1e()}function E1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TH(e,t){if(e){if(typeof e=="string")return ZI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZI(e,t)}}function ZI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O1e(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,i=!1,s=void 0;try{for(var a=e[Symbol.iterator](),o;!(n=(o=a.next()).done)&&(r.push(o.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,s=l}finally{try{!n&&a.return!=null&&a.return()}finally{if(i)throw s}}return r}}function A1e(e){if(Array.isArray(e))return e}function QI(e){var t=tf(e,2),r=t[0],n=t[1],i=r,s=n;return r>n&&(i=n,s=r),[i,s]}function eN(e,t,r){if(e.lte(0))return new cr.default(0);var n=Pm.getDigitCount(e.toNumber()),i=new cr.default(10).pow(n),s=e.div(i),a=n!==1?.05:.1,o=new cr.default(Math.ceil(s.div(a).toNumber())).add(r).mul(a),l=o.mul(i);return t?l:new cr.default(Math.ceil(l))}function CH(e,t,r){var n=1,i=new cr.default(e);if(!i.isint()&&r){var s=Math.abs(e);s<1?(n=new cr.default(10).pow(Pm.getDigitCount(e)-1),i=new cr.default(Math.floor(i.div(n).toNumber())).mul(n)):s>1&&(i=new cr.default(Math.floor(e)))}else e===0?i=new cr.default(Math.floor((t-1)/2)):r||(i=new cr.default(Math.floor(e)));var a=Math.floor((t-1)/2),o=KI(GI(function(l){return i.add(new cr.default(l-a).mul(n)).toNumber()}),Im);return o(0,t)}function IH(e,t,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new cr.default(0),tickMin:new cr.default(0),tickMax:new cr.default(0)};var s=eN(new cr.default(t).sub(e).div(r-1),n,i),a;e<=0&&t>=0?a=new cr.default(0):(a=new cr.default(e).add(t).div(2),a=a.sub(new cr.default(a).mod(s)));var o=Math.ceil(a.sub(e).div(s).toNumber()),l=Math.ceil(new cr.default(t).sub(a).div(s).toNumber()),c=o+l+1;return c>r?IH(e,t,r,n,i+1):(c<r&&(l=t>0?l+(r-c):l,o=t>0?o:o+(r-c)),{step:s,tickMin:a.sub(new cr.default(o).mul(s)),tickMax:a.add(new cr.default(l).mul(s))})}function T1e(e){var t=tf(e,2),r=t[0],n=t[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(i,2),o=QI([r,n]),l=tf(o,2),c=l[0],f=l[1];if(c===-1/0||f===1/0){var u=f===1/0?[c].concat(XI(Im(0,i-1).map(function(){return 1/0}))):[].concat(XI(Im(0,i-1).map(function(){return-1/0})),[f]);return r>n?Nm(u):u}if(c===f)return CH(c,i,s);var d=IH(c,f,a,s),p=d.step,_=d.tickMin,w=d.tickMax,k=Pm.rangeStep(_,w.add(new cr.default(.1).mul(p)),p);return r>n?Nm(k):k}function C1e(e){var t=tf(e,2),r=t[0],n=t[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(i,2),o=QI([r,n]),l=tf(o,2),c=l[0],f=l[1];if(c===-1/0||f===1/0)return[r,n];if(c===f)return CH(c,i,s);var u=eN(new cr.default(f).sub(c).div(a-1),s,0),d=KI(GI(function(_){return new cr.default(c).add(new cr.default(_).mul(u)).toNumber()}),Im),p=d(0,a).filter(function(_){return _>=c&&_<=f});return r>n?Nm(p):p}function I1e(e,t){var r=tf(e,2),n=r[0],i=r[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=QI([n,i]),o=tf(a,2),l=o[0],c=o[1];if(l===-1/0||c===1/0)return[n,i];if(l===c)return[l];var f=Math.max(t,2),u=eN(new cr.default(c).sub(l).div(f-1),s,0),d=[].concat(XI(Pm.rangeStep(new cr.default(l),new cr.default(c).sub(new cr.default(.99).mul(u)),u)),[c]);return n>i?Nm(d):d}var tN=Gw(T1e),N1e=Gw(C1e),rN=Gw(I1e);var Kw=ae(Je());var P1e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Yw(){return Yw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yw.apply(this,arguments)}function L1e(e,t){return B1e(e)||j1e(e,t)||D1e(e,t)||F1e()}function F1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D1e(e,t){if(e){if(typeof e=="string")return NH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NH(e,t)}}function NH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function B1e(e){if(Array.isArray(e))return e}function M1e(e,t){if(e==null)return{};var r=R1e(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function R1e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function lc(e){var t=e.offset,r=e.layout,n=e.width,i=e.dataKey,s=e.data,a=e.dataPointFormatter,o=e.xAxis,l=e.yAxis,c=M1e(e,P1e),f=yt(c),u=s.map(function(d,p){var _=a(d,i),w=_.x,k=_.y,S=_.value,O=_.errorVal;if(!O)return null;var A=[],C,I;if(Array.isArray(O)){var D=L1e(O,2);C=D[0],I=D[1]}else C=I=O;if(r==="vertical"){var L=o.scale,U=k+t,te=U+n,V=U-n,X=L(S-C),Z=L(S+I);A.push({x1:Z,y1:te,x2:Z,y2:V}),A.push({x1:X,y1:U,x2:Z,y2:U}),A.push({x1:X,y1:te,x2:X,y2:V})}else if(r==="horizontal"){var se=l.scale,pe=w+t,de=pe-n,F=pe+n,H=se(S-C),Q=se(S+I);A.push({x1:de,y1:Q,x2:F,y2:Q}),A.push({x1:pe,y1:H,x2:pe,y2:Q}),A.push({x1:de,y1:H,x2:F,y2:H})}return Kw.default.createElement(or,Yw({className:"recharts-errorBar",key:"bar-".concat(p)},f),A.map(function(R,$){return Kw.default.createElement("line",Yw({},R,{key:"line-".concat($)}))}))});return Kw.default.createElement(or,{className:"recharts-errorBars"},u)}lc.defaultProps={stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"};lc.displayName="ErrorBar";function Fm(e){"@babel/helpers - typeof";return Fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fm(e)}function PH(e){return q1e(e)||z1e(e)||U1e(e)||$1e()}function $1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U1e(e,t){if(e){if(typeof e=="string")return nN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nN(e,t)}}function z1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function q1e(e){if(Array.isArray(e))return nN(e)}function nN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LH(Object(r),!0).forEach(function(n){Up(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Up(e,t,r){return t=V1e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V1e(e){var t=H1e(e,"string");return Fm(t)==="symbol"?t:String(t)}function H1e(e,t){if(Fm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zn(e,t,r){return(0,ba.default)(e)||(0,ba.default)(t)?r:Cr(t)?(0,iN.default)(e,t,r):(0,ma.default)(t)?t(e):r}function zp(e,t,r,n){var i=(0,UH.default)(e,function(o){return Zn(o,t)});if(r==="number"){var s=i.filter(function(o){return qe(o)||parseFloat(o)});return s.length?[(0,jm.default)(s),(0,Dm.default)(s)]:[1/0,-1/0]}var a=n?i.filter(function(o){return!(0,ba.default)(o)}):i;return a.map(function(o){return Cr(o)||o instanceof Date?o:""})}var zH=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,a=-1,o=(r=n?.length)!==null&&r!==void 0?r:0;if(o<=1)return 0;if(s&&s.axisType==="angleAxis"&&Math.abs(Math.abs(s.range[1]-s.range[0])-360)<=1e-6)for(var l=s.range,c=0;c<o;c++){var f=c>0?i[c-1].coordinate:i[o-1].coordinate,u=i[c].coordinate,d=c>=o-1?i[0].coordinate:i[c+1].coordinate,p=void 0;if(Kn(u-f)!==Kn(d-u)){var _=[];if(Kn(d-u)===Kn(l[1]-l[0])){p=d;var w=u+l[1]-l[0];_[0]=Math.min(w,(w+f)/2),_[1]=Math.max(w,(w+f)/2)}else{p=f;var k=d+l[1]-l[0];_[0]=Math.min(u,(k+u)/2),_[1]=Math.max(u,(k+u)/2)}var S=[Math.min(u,(p+u)/2),Math.max(u,(p+u)/2)];if(t>S[0]&&t<=S[1]||t>=_[0]&&t<=_[1]){a=i[c].index;break}}else{var O=Math.min(f,d),A=Math.max(f,d);if(t>(O+u)/2&&t<=(A+u)/2){a=i[c].index;break}}}else for(var C=0;C<o;C++)if(C===0&&t<=(n[C].coordinate+n[C+1].coordinate)/2||C>0&&C<o-1&&t>(n[C].coordinate+n[C-1].coordinate)/2&&t<=(n[C].coordinate+n[C+1].coordinate)/2||C===o-1&&t>(n[C].coordinate+n[C-1].coordinate)/2){a=n[C].index;break}return a},Zw=function(t){var r=t,n=r.type.displayName,i=t.props,s=i.stroke,a=i.fill,o;switch(n){case"Line":o=s;break;case"Area":case"Radar":o=s&&s!=="none"?s:a;break;default:o=a;break}return o},sN=function(t){var r=t.children,n=t.formattedGraphicalItems,i=t.legendWidth,s=t.legendContent,a=$s(r,Fu);if(!a)return null;var o;return a.props&&a.props.payload?o=a.props&&a.props.payload:s==="children"?o=(n||[]).reduce(function(l,c){var f=c.item,u=c.props,d=u.sectors||u.data||[];return l.concat(d.map(function(p){return{type:a.props.iconType||f.props.legendType,value:p.name,color:p.fill,payload:p}}))},[]):o=(n||[]).map(function(l){var c=l.item,f=c.props,u=f.dataKey,d=f.name,p=f.legendType,_=f.hide;return{inactive:_,dataKey:u,type:a.props.iconType||p||"square",color:Zw(c),value:d||u,payload:c.props}}),Ni(Ni(Ni({},a.props),Fu.getWithHeight(a,i)),{},{payload:o,item:a})},qH=function(t){var r=t.barSize,n=t.stackGroups,i=n===void 0?{}:n;if(!i)return{};for(var s={},a=Object.keys(i),o=0,l=a.length;o<l;o++)for(var c=i[a[o]].stackGroups,f=Object.keys(c),u=0,d=f.length;u<d;u++){var p=c[f[u]],_=p.items,w=p.cateAxisId,k=_.filter(function(A){return Ya(A.type).indexOf("Bar")>=0});if(k&&k.length){var S=k[0].props.barSize,O=k[0].props[w];s[O]||(s[O]=[]),s[O].push({item:k[0],stackList:k.slice(1),barSize:(0,ba.default)(S)?r:S})}}return s},VH=function(t){var r=t.barGap,n=t.barCategoryGap,i=t.bandSize,s=t.sizeList,a=s===void 0?[]:s,o=t.maxBarSize,l=a.length;if(l<1)return null;var c=Ka(r,i,0,!0),f;if(a[0].barSize===+a[0].barSize){var u=!1,d=i/l,p=a.reduce(function(A,C){return A+C.barSize||0},0);p+=(l-1)*c,p>=i&&(p-=(l-1)*c,c=0),p>=i&&d>0&&(u=!0,d*=.9,p=l*d);var _=(i-p)/2>>0,w={offset:_-c,size:0};f=a.reduce(function(A,C){var I=[].concat(PH(A),[{item:C.item,position:{offset:w.offset+w.size+c,size:u?d:C.barSize}}]);return w=I[I.length-1].position,C.stackList&&C.stackList.length&&C.stackList.forEach(function(D){I.push({item:D,position:w})}),I},[])}else{var k=Ka(n,i,0,!0);i-2*k-(l-1)*c<=0&&(c=0);var S=(i-2*k-(l-1)*c)/l;S>1&&(S>>=0);var O=o===+o?Math.min(S,o):S;f=a.reduce(function(A,C,I){var D=[].concat(PH(A),[{item:C.item,position:{offset:k+(S+c)*I+(S-O)/2,size:O}}]);return C.stackList&&C.stackList.length&&C.stackList.forEach(function(L){D.push({item:L,position:D[D.length-1].position})}),D},[])}return f},HH=function(t,r,n,i){var s=n.children,a=n.width,o=n.margin,l=a-(o.left||0)-(o.right||0),c=sN({children:s,legendWidth:l}),f=t;if(c){var u=i||{},d=c.align,p=c.verticalAlign,_=c.layout;(_==="vertical"||_==="horizontal"&&p==="middle")&&qe(t[d])&&(f=Ni(Ni({},t),{},Up({},d,f[d]+(u.width||0)))),(_==="horizontal"||_==="vertical"&&d==="center")&&qe(t[p])&&(f=Ni(Ni({},t),{},Up({},p,f[p]+(u.height||0))))}return f},W1e=function(t,r,n){return(0,ba.default)(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},WH=function(t,r,n,i,s){var a=r.props.children,o=En(a,lc).filter(function(c){return W1e(i,s,c.props.direction)});if(o&&o.length){var l=o.map(function(c){return c.props.dataKey});return t.reduce(function(c,f){var u=Zn(f,n,0),d=(0,Lm.default)(u)?[(0,jm.default)(u),(0,Dm.default)(u)]:[u,u],p=l.reduce(function(_,w){var k=Zn(f,w,0),S=d[0]-Math.abs((0,Lm.default)(k)?k[0]:k),O=d[1]+Math.abs((0,Lm.default)(k)?k[1]:k);return[Math.min(S,_[0]),Math.max(O,_[1])]},[1/0,-1/0]);return[Math.min(p[0],c[0]),Math.max(p[1],c[1])]},[1/0,-1/0])}return null},JH=function(t,r,n,i,s){var a=r.map(function(o){return WH(t,o,n,s,i)}).filter(function(o){return!(0,ba.default)(o)});return a&&a.length?a.reduce(function(o,l){return[Math.min(o[0],l[0]),Math.max(o[1],l[1])]},[1/0,-1/0]):null},aN=function(t,r,n,i,s){var a=r.map(function(l){var c=l.props.dataKey;return n==="number"&&c&&WH(t,l,c,i)||zp(t,c,n,s)});if(n==="number")return a.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]);var o={};return a.reduce(function(l,c){for(var f=0,u=c.length;f<u;f++)o[c[f]]||(o[c[f]]=!0,l.push(c[f]));return l},[])},oN=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},lN=function(t,r,n){var i,s,a=t.map(function(o){return o.coordinate===r&&(i=!0),o.coordinate===n&&(s=!0),o.coordinate});return i||a.push(r),s||a.push(n),a},rl=function(t,r,n){if(!t)return null;var i=t.scale,s=t.duplicateDomain,a=t.type,o=t.range,l=t.realScaleType==="scaleBand"?i.bandwidth()/2:2,c=(r||n)&&a==="category"&&i.bandwidth?i.bandwidth()/l:0;if(c=t.axisType==="angleAxis"&&o?.length>=2?Kn(o[0]-o[1])*2*c:c,r&&(t.ticks||t.niceTicks)){var f=(t.ticks||t.niceTicks).map(function(u){var d=s?s.indexOf(u):u;return{coordinate:i(d)+c,value:u,offset:c}});return f.filter(function(u){return!(0,Xw.default)(u.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(u,d){return{coordinate:i(u)+c,value:u,index:d,offset:c}}):i.ticks&&!n?i.ticks(t.tickCount).map(function(u){return{coordinate:i(u)+c,value:u,offset:c}}):i.domain().map(function(u,d){return{coordinate:i(u)+c,value:s?s[u]:u,index:d,offset:c}})},Bm=function(t,r,n){var i;return(0,ma.default)(n)?i=n:(0,ma.default)(r)&&(i=r),(0,ma.default)(t)||i?function(s,a,o,l){(0,ma.default)(t)&&t(s,a,o,l),(0,ma.default)(i)&&i(s,a,o,l)}:null},GH=function(t,r,n){var i=t.scale,s=t.type,a=t.layout,o=t.axisType;if(i==="auto")return a==="radial"&&o==="radiusAxis"?{scale:tc(),realScaleType:"band"}:a==="radial"&&o==="angleAxis"?{scale:Ku(),realScaleType:"linear"}:s==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:rc(),realScaleType:"point"}:s==="category"?{scale:tc(),realScaleType:"band"}:{scale:Ku(),realScaleType:"linear"};if((0,$H.default)(i)){var l="scale".concat((0,RH.default)(i));return{scale:(Ww[l]||rc)(),realScaleType:Ww[l]?l:"point"}}return(0,ma.default)(i)?{scale:i}:{scale:rc(),realScaleType:"point"}},FH=1e-4,KH=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,i=t.range(),s=Math.min(i[0],i[1])-FH,a=Math.max(i[0],i[1])+FH,o=t(r[0]),l=t(r[n-1]);(o<s||o>a||l<s||l>a)&&t.domain([r[0],r[n-1]])}},YH=function(t,r){if(!t)return null;for(var n=0,i=t.length;n<i;n++)if(t[n].item===r)return t[n].position;return null},XH=function(t,r){if(!r||r.length!==2||!qe(r[0])||!qe(r[1]))return t;var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]),s=[t[0],t[1]];return(!qe(t[0])||t[0]<n)&&(s[0]=n),(!qe(t[1])||t[1]>i)&&(s[1]=i),s[0]>i&&(s[0]=i),s[1]<n&&(s[1]=n),s},J1e=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var s=0,a=0,o=0;o<r;++o){var l=(0,Xw.default)(t[o][n][1])?t[o][n][0]:t[o][n][1];l>=0?(t[o][n][0]=s,t[o][n][1]=s+l,s=t[o][n][1]):(t[o][n][0]=a,t[o][n][1]=a+l,a=t[o][n][1])}},G1e=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var s=0,a=0;a<r;++a){var o=(0,Xw.default)(t[a][n][1])?t[a][n][0]:t[a][n][1];o>=0?(t[a][n][0]=s,t[a][n][1]=s+o,s=t[a][n][1]):(t[a][n][0]=0,t[a][n][1]=0)}},K1e={sign:J1e,expand:zT,none:qs,silhouette:qT,wiggle:VT,positive:G1e},Y1e=function(t,r,n){var i=r.map(function(a){return a.props.dataKey}),s=UT().keys(i).value(function(a,o){return+Zn(a,o,0)}).order(ap).offset(K1e[n]);return s(t)},ZH=function(t,r,n,i,s,a){if(!t)return null;var o=a?r.reverse():r,l=o.reduce(function(c,f){var u=f.props,d=u.stackId,p=u.hide;if(p)return c;var _=f.props[n],w=c[_]||{hasStack:!1,stackGroups:{}};if(Cr(d)){var k=w.stackGroups[d]||{numericAxisId:n,cateAxisId:i,items:[]};k.items.push(f),w.hasStack=!0,w.stackGroups[d]=k}else w.stackGroups[Ga("_stackId_")]={numericAxisId:n,cateAxisId:i,items:[f]};return Ni(Ni({},c),{},Up({},_,w))},{});return Object.keys(l).reduce(function(c,f){var u=l[f];return u.hasStack&&(u.stackGroups=Object.keys(u.stackGroups).reduce(function(d,p){var _=u.stackGroups[p];return Ni(Ni({},d),{},Up({},p,{numericAxisId:n,cateAxisId:i,items:_.items,stackedData:Y1e(t,_.items,s)}))},{})),Ni(Ni({},c),{},Up({},f,u))},{})},QH=function(t,r){var n=r.realScaleType,i=r.type,s=r.tickCount,a=r.originalDomain,o=r.allowDecimals,l=n||r.scale;if(l!=="auto"&&l!=="linear")return null;if(s&&i==="number"&&a&&(a[0]==="auto"||a[1]==="auto")){var c=t.domain();if(!c.length)return null;var f=tN(c,s,o);return t.domain([(0,jm.default)(f),(0,Dm.default)(f)]),{niceTicks:f}}if(s&&i==="number"){var u=t.domain(),d=rN(u,s,o);return{niceTicks:d}}return null},cN=function(t){var r=t.axis,n=t.ticks,i=t.bandSize,s=t.entry,a=t.index,o=t.dataKey;if(r.type==="category"){if(!r.allowDuplicatedCategory&&r.dataKey&&!(0,ba.default)(s[r.dataKey])){var l=Hd(n,"value",s[r.dataKey]);if(l)return l.coordinate+i/2}return n[a]?n[a].coordinate+i/2:null}var c=Zn(s,(0,ba.default)(o)?r.dataKey:o);return(0,ba.default)(c)?null:r.scale(c)},uN=function(t){var r=t.axis,n=t.ticks,i=t.offset,s=t.bandSize,a=t.entry,o=t.index;if(r.type==="category")return n[o]?n[o].coordinate+i:null;var l=Zn(a,r.dataKey,r.domain[o]);return(0,ba.default)(l)?null:r.scale(l)-s/2+i},eW=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var i=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]);return i<=0&&s>=0?0:s<0?s:i}return n[0]},tW=function(t,r){var n=t.props.stackId;if(Cr(n)){var i=r[n];if(i&&i.items.length){for(var s=-1,a=0,o=i.items.length;a<o;a++)if(i.items[a]===t){s=a;break}return s>=0?i.stackedData[s]:null}}return null},X1e=function(t){return t.reduce(function(r,n){return[(0,jm.default)(n.concat([r[0]]).filter(qe)),(0,Dm.default)(n.concat([r[1]]).filter(qe))]},[1/0,-1/0])},fN=function(t,r,n){return Object.keys(t).reduce(function(i,s){var a=t[s],o=a.stackedData,l=o.reduce(function(c,f){var u=X1e(f.slice(r,n+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(l[0],i[0]),Math.max(l[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},DH=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,jH=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Qw=function(t,r,n){if((0,ma.default)(t))return t(r,n);if(!(0,Lm.default)(t))return r;var i=[];if(qe(t[0]))i[0]=n?t[0]:Math.min(t[0],r[0]);else if(DH.test(t[0])){var s=+DH.exec(t[0])[1];i[0]=r[0]-s}else(0,ma.default)(t[0])?i[0]=t[0](r[0]):i[0]=r[0];if(qe(t[1]))i[1]=n?t[1]:Math.max(t[1],r[1]);else if(jH.test(t[1])){var a=+jH.exec(t[1])[1];i[1]=r[1]+a}else(0,ma.default)(t[1])?i[1]=t[1](r[1]):i[1]=r[1];return i},qp=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var i=t.scale.bandwidth();if(!n||i>0)return i}if(t&&r&&r.length>=2){for(var s=(0,MH.default)(r,function(u){return u.coordinate}),a=1/0,o=1,l=s.length;o<l;o++){var c=s[o],f=s[o-1];a=Math.min((c.coordinate||0)-(f.coordinate||0),a)}return a===1/0?0:a}return n?void 0:0},dN=function(t,r,n){return!t||!t.length||(0,BH.default)(t,(0,iN.default)(n,"type.defaultProps.domain"))?r:t},e1=function(t,r){var n=t.props,i=n.dataKey,s=n.name,a=n.unit,o=n.formatter,l=n.tooltipType,c=n.chartType;return Ni(Ni({},yt(t)),{},{dataKey:i,unit:a,formatter:o,name:s||i,color:Zw(t),value:Zn(r,i),type:l,payload:r,chartType:c})};function Mm(e){"@babel/helpers - typeof";return Mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mm(e)}function rW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rW(Object(r),!0).forEach(function(n){Q1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q1e(e,t,r){return t=eSe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eSe(e){var t=tSe(e,"string");return Mm(t)==="symbol"?t:String(t)}function tSe(e,t){if(Mm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rm=Math.PI/180;var rSe=function(t){return t*180/Math.PI},_n=function(t,r,n,i){return{x:t+Math.cos(-Rm*i)*n,y:r+Math.sin(-Rm*i)*n}};var nSe=function(t,r){var n=t.x,i=t.y,s=r.x,a=r.y;return Math.sqrt(Math.pow(n-s,2)+Math.pow(i-a,2))},iSe=function(t,r){var n=t.x,i=t.y,s=r.cx,a=r.cy,o=nSe({x:n,y:i},{x:s,y:a});if(o<=0)return{radius:o};var l=(n-s)/o,c=Math.acos(l);return i>a&&(c=2*Math.PI-c),{radius:o,angle:rSe(c),angleInRadian:c}},sSe=function(t){var r=t.startAngle,n=t.endAngle,i=Math.floor(r/360),s=Math.floor(n/360),a=Math.min(i,s);return{startAngle:r-a*360,endAngle:n-a*360}},aSe=function(t,r){var n=r.startAngle,i=r.endAngle,s=Math.floor(n/360),a=Math.floor(i/360),o=Math.min(s,a);return t+o*360},pN=function(t,r){var n=t.x,i=t.y,s=iSe({x:n,y:i},r),a=s.radius,o=s.angle,l=r.innerRadius,c=r.outerRadius;if(a<l||a>c)return!1;if(a===0)return!0;var f=sSe(r),u=f.startAngle,d=f.endAngle,p=o,_;if(u<=d){for(;p>d;)p-=360;for(;p<u;)p+=360;_=p>=u&&p<=d}else{for(;p>u;)p-=360;for(;p<d;)p+=360;_=p>=d&&p<=u}return _?nW(nW({},r),{},{radius:a,angle:aSe(p,r)}):null};function $m(e){"@babel/helpers - typeof";return $m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$m(e)}function oSe(e){return fSe(e)||uSe(e)||cSe(e)||lSe()}function lSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cSe(e,t){if(e){if(typeof e=="string")return hN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hN(e,t)}}function uSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fSe(e){if(Array.isArray(e))return hN(e)}function hN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iW(Object(r),!0).forEach(function(n){dSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dSe(e,t,r){return t=pSe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pSe(e){var t=hSe(e,"string");return $m(t)==="symbol"?t:String(t)}function hSe(e,t){if($m(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($m(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qm(){return qm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qm.apply(this,arguments)}var gSe=function(t){var r=t.value,n=t.formatter,i=(0,zm.default)(t.children)?r:t.children;return(0,Um.default)(n)?n(i):i},ySe=function(t,r){var n=Kn(r-t),i=Math.min(Math.abs(r-t),360);return n*i},mSe=function(t,r,n){var i=t.position,s=t.viewBox,a=t.offset,o=t.className,l=s,c=l.cx,f=l.cy,u=l.innerRadius,d=l.outerRadius,p=l.startAngle,_=l.endAngle,w=l.clockWise,k=(u+d)/2,S=ySe(p,_),O=S>=0?1:-1,A,C;i==="insideStart"?(A=p+O*a,C=w):i==="insideEnd"?(A=_-O*a,C=!w):i==="end"&&(A=_+O*a,C=w),C=S<=0?C:!C;var I=_n(c,f,k,A),D=_n(c,f,k,A+(C?1:-1)*359),L="M".concat(I.x,",").concat(I.y,`
    A`).concat(k,",").concat(k,",0,1,").concat(C?0:1,`,
    `).concat(D.x,",").concat(D.y),U=(0,zm.default)(t.id)?Ga("recharts-radial-line-"):t.id;return tn.default.createElement("text",qm({},n,{dominantBaseline:"central",className:(0,yN.default)("recharts-radial-bar-label",o)}),tn.default.createElement("defs",null,tn.default.createElement("path",{id:U,d:L})),tn.default.createElement("textPath",{xlinkHref:"#".concat(U)},r))},bSe=function(t){var r=t.viewBox,n=t.offset,i=t.position,s=r,a=s.cx,o=s.cy,l=s.innerRadius,c=s.outerRadius,f=s.startAngle,u=s.endAngle,d=(f+u)/2;if(i==="outside"){var p=_n(a,o,c+n,d),_=p.x,w=p.y;return{x:_,y:w,textAnchor:_>=a?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"end"};var k=(l+c)/2,S=_n(a,o,k,d),O=S.x,A=S.y;return{x:O,y:A,textAnchor:"middle",verticalAnchor:"middle"}},vSe=function(t){var r=t.viewBox,n=t.parentViewBox,i=t.offset,s=t.position,a=r,o=a.x,l=a.y,c=a.width,f=a.height,u=f>=0?1:-1,d=u*i,p=u>0?"end":"start",_=u>0?"start":"end",w=c>=0?1:-1,k=w*i,S=w>0?"end":"start",O=w>0?"start":"end";if(s==="top"){var A={x:o+c/2,y:l-u*i,textAnchor:"middle",verticalAnchor:p};return jn(jn({},A),n?{height:Math.max(l-n.y,0),width:c}:{})}if(s==="bottom"){var C={x:o+c/2,y:l+f+d,textAnchor:"middle",verticalAnchor:_};return jn(jn({},C),n?{height:Math.max(n.y+n.height-(l+f),0),width:c}:{})}if(s==="left"){var I={x:o-k,y:l+f/2,textAnchor:S,verticalAnchor:"middle"};return jn(jn({},I),n?{width:Math.max(I.x-n.x,0),height:f}:{})}if(s==="right"){var D={x:o+c+k,y:l+f/2,textAnchor:O,verticalAnchor:"middle"};return jn(jn({},D),n?{width:Math.max(n.x+n.width-D.x,0),height:f}:{})}var L=n?{width:c,height:f}:{};return s==="insideLeft"?jn({x:o+k,y:l+f/2,textAnchor:O,verticalAnchor:"middle"},L):s==="insideRight"?jn({x:o+c-k,y:l+f/2,textAnchor:S,verticalAnchor:"middle"},L):s==="insideTop"?jn({x:o+c/2,y:l+d,textAnchor:"middle",verticalAnchor:_},L):s==="insideBottom"?jn({x:o+c/2,y:l+f-d,textAnchor:"middle",verticalAnchor:p},L):s==="insideTopLeft"?jn({x:o+k,y:l+d,textAnchor:O,verticalAnchor:_},L):s==="insideTopRight"?jn({x:o+c-k,y:l+d,textAnchor:S,verticalAnchor:_},L):s==="insideBottomLeft"?jn({x:o+k,y:l+f-d,textAnchor:O,verticalAnchor:p},L):s==="insideBottomRight"?jn({x:o+c-k,y:l+f-d,textAnchor:S,verticalAnchor:p},L):(0,gN.default)(s)&&(qe(s.x)||qo(s.x))&&(qe(s.y)||qo(s.y))?jn({x:o+Ka(s.x,c),y:l+Ka(s.y,f),textAnchor:"end",verticalAnchor:"end"},L):jn({x:o+c/2,y:l+f/2,textAnchor:"middle",verticalAnchor:"middle"},L)},_Se=function(t){return"cx"in t&&qe(t.cx)};function en(e){var t=e.viewBox,r=e.position,n=e.value,i=e.children,s=e.content,a=e.className,o=a===void 0?"":a,l=e.textBreakAll;if(!t||(0,zm.default)(n)&&(0,zm.default)(i)&&!(0,tn.isValidElement)(s)&&!(0,Um.default)(s))return null;if((0,tn.isValidElement)(s))return(0,tn.cloneElement)(s,e);var c;if((0,Um.default)(s)){if(c=(0,tn.createElement)(s,e),(0,tn.isValidElement)(c))return c}else c=gSe(e);var f=_Se(t),u=yt(e,!0);if(f&&(r==="insideStart"||r==="insideEnd"||r==="end"))return mSe(e,c,u);var d=f?bSe(e):vSe(e);return tn.default.createElement(ec,qm({className:(0,yN.default)("recharts-label",o)},u,d,{breakAll:l}),c)}en.displayName="Label";en.defaultProps={offset:5};var sW=function(t){var r=t.cx,n=t.cy,i=t.angle,s=t.startAngle,a=t.endAngle,o=t.r,l=t.radius,c=t.innerRadius,f=t.outerRadius,u=t.x,d=t.y,p=t.top,_=t.left,w=t.width,k=t.height,S=t.clockWise,O=t.labelViewBox;if(O)return O;if(qe(w)&&qe(k)){if(qe(u)&&qe(d))return{x:u,y:d,width:w,height:k};if(qe(p)&&qe(_))return{x:p,y:_,width:w,height:k}}return qe(u)&&qe(d)?{x:u,y:d,width:0,height:0}:qe(r)&&qe(n)?{cx:r,cy:n,startAngle:s||i||0,endAngle:a||i||0,innerRadius:c||0,outerRadius:f||l||o||0,clockWise:S}:t.viewBox?t.viewBox:{}},wSe=function(t,r){return t?t===!0?tn.default.createElement(en,{key:"label-implicit",viewBox:r}):Cr(t)?tn.default.createElement(en,{key:"label-implicit",viewBox:r,value:t}):(0,tn.isValidElement)(t)?t.type===en?(0,tn.cloneElement)(t,{key:"label-implicit",viewBox:r}):tn.default.createElement(en,{key:"label-implicit",content:t,viewBox:r}):(0,Um.default)(t)?tn.default.createElement(en,{key:"label-implicit",content:t,viewBox:r}):(0,gN.default)(t)?tn.default.createElement(en,qm({viewBox:r},t,{key:"label-implicit"})):null:null},SSe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var i=t.children,s=sW(t),a=En(i,en).map(function(l,c){return(0,tn.cloneElement)(l,{viewBox:r||s,key:"label-".concat(c)})});if(!n)return a;var o=wSe(t.label,r||s);return[o].concat(oSe(a))};en.parseViewBox=sW;en.renderCallByParent=SSe;var uW=ae(Ms()),fW=ae(mn()),t1=ae(Rs()),dW=ae(oW()),pW=ae(Yr()),nl=ae(Je());function Vm(e){"@babel/helpers - typeof";return Vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vm(e)}var kSe=["data","valueAccessor","dataKey","clockWise","id","textBreakAll"];function ESe(e){return CSe(e)||TSe(e)||ASe(e)||OSe()}function OSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ASe(e,t){if(e){if(typeof e=="string")return mN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mN(e,t)}}function TSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CSe(e){if(Array.isArray(e))return mN(e)}function mN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r1(){return r1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r1.apply(this,arguments)}function lW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lW(Object(r),!0).forEach(function(n){ISe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ISe(e,t,r){return t=NSe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NSe(e){var t=PSe(e,"string");return Vm(t)==="symbol"?t:String(t)}function PSe(e,t){if(Vm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LSe(e,t){if(e==null)return{};var r=FSe(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function FSe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}var DSe={valueAccessor:function(t){return(0,pW.default)(t.value)?(0,dW.default)(t.value):t.value}};function va(e){var t=e.data,r=e.valueAccessor,n=e.dataKey,i=e.clockWise,s=e.id,a=e.textBreakAll,o=LSe(e,kSe);return!t||!t.length?null:nl.default.createElement(or,{className:"recharts-label-list"},t.map(function(l,c){var f=(0,t1.default)(n)?r(l,c):Zn(l&&l.payload,n),u=(0,t1.default)(s)?{}:{id:"".concat(s,"-").concat(c)};return nl.default.createElement(en,r1({},yt(l,!0),o,u,{parentViewBox:l.parentViewBox,index:c,value:f,textBreakAll:a,viewBox:en.parseViewBox((0,t1.default)(i)?l:cW(cW({},l),{},{clockWise:i})),key:"label-".concat(c)}))}))}va.displayName="LabelList";function jSe(e,t){return e?e===!0?nl.default.createElement(va,{key:"labelList-implicit",data:t}):nl.default.isValidElement(e)||(0,fW.default)(e)?nl.default.createElement(va,{key:"labelList-implicit",data:t,content:e}):(0,uW.default)(e)?nl.default.createElement(va,r1({data:t},e,{key:"labelList-implicit"})):null:null}function BSe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,i=En(n,va).map(function(a,o){return(0,nl.cloneElement)(a,{data:t,key:"labelList-".concat(o)})});if(!r)return i;var s=jSe(e.label,t);return[s].concat(ESe(i))}va.renderCallByParent=BSe;va.defaultProps=DSe;var s1=ae(Je()),yW=ae(Kr());function Vp(e){"@babel/helpers - typeof";return Vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vp(e)}function bN(){return bN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bN.apply(this,arguments)}function MSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gW(n.key),n)}}function RSe(e,t,r){return t&&hW(e.prototype,t),r&&hW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Se(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vN(e,t)}function vN(e,t){return vN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vN(e,t)}function USe(e){var t=VSe();return function(){var n=i1(e),i;if(t){var s=i1(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return zSe(this,i)}}function zSe(e,t){if(t&&(Vp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qSe(e)}function qSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function i1(e){return i1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},i1(e)}function HSe(e,t,r){return t=gW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gW(e){var t=WSe(e,"string");return Vp(t)==="symbol"?t:String(t)}function WSe(e,t){if(Vp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JSe=function(t,r){var n=Kn(r-t),i=Math.min(Math.abs(r-t),359.999);return n*i},n1=function(t){var r=t.cx,n=t.cy,i=t.radius,s=t.angle,a=t.sign,o=t.isExternal,l=t.cornerRadius,c=t.cornerIsExternal,f=l*(o?1:-1)+i,u=Math.asin(l/f)/Rm,d=c?s:s+a*u,p=_n(r,n,f,d),_=_n(r,n,i,d),w=c?s-a*u:s,k=_n(r,n,f*Math.cos(u*Rm),w);return{center:p,circleTangency:_,lineTangency:k,theta:u}},mW=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,s=t.outerRadius,a=t.startAngle,o=t.endAngle,l=JSe(a,o),c=a+l,f=_n(r,n,s,a),u=_n(r,n,s,c),d="M ".concat(f.x,",").concat(f.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(a>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(i>0){var p=_n(r,n,i,a),_=_n(r,n,i,c);d+="L ".concat(_.x,",").concat(_.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(a<=c),`,
            `).concat(p.x,",").concat(p.y," Z")}else d+="L ".concat(r,",").concat(n," Z");return d},GSe=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,s=t.outerRadius,a=t.cornerRadius,o=t.forceCornerRadius,l=t.cornerIsExternal,c=t.startAngle,f=t.endAngle,u=Kn(f-c),d=n1({cx:r,cy:n,radius:s,angle:c,sign:u,cornerRadius:a,cornerIsExternal:l}),p=d.circleTangency,_=d.lineTangency,w=d.theta,k=n1({cx:r,cy:n,radius:s,angle:f,sign:-u,cornerRadius:a,cornerIsExternal:l}),S=k.circleTangency,O=k.lineTangency,A=k.theta,C=l?Math.abs(c-f):Math.abs(c-f)-w-A;if(C<0)return o?"M ".concat(_.x,",").concat(_.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):mW({cx:r,cy:n,innerRadius:i,outerRadius:s,startAngle:c,endAngle:f});var I="M ".concat(_.x,",").concat(_.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(C>180),",").concat(+(u<0),",").concat(S.x,",").concat(S.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(O.x,",").concat(O.y,`
  `);if(i>0){var D=n1({cx:r,cy:n,radius:i,angle:c,sign:u,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),L=D.circleTangency,U=D.lineTangency,te=D.theta,V=n1({cx:r,cy:n,radius:i,angle:f,sign:-u,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),X=V.circleTangency,Z=V.lineTangency,se=V.theta,pe=l?Math.abs(c-f):Math.abs(c-f)-te-se;if(pe<0&&a===0)return"".concat(I,"L").concat(r,",").concat(n,"Z");I+="L".concat(Z.x,",").concat(Z.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(X.x,",").concat(X.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(pe>180),",").concat(+(u>0),",").concat(L.x,",").concat(L.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(U.x,",").concat(U.y,"Z")}else I+="L".concat(r,",").concat(n,"Z");return I},_N=function(e){$Se(r,e);var t=USe(r);function r(){return MSe(this,r),t.apply(this,arguments)}return RSe(r,[{key:"render",value:function(){var i=this.props,s=i.cx,a=i.cy,o=i.innerRadius,l=i.outerRadius,c=i.cornerRadius,f=i.forceCornerRadius,u=i.cornerIsExternal,d=i.startAngle,p=i.endAngle,_=i.className;if(l<o||d===p)return null;var w=(0,yW.default)("recharts-sector",_),k=l-o,S=Ka(c,k,0,!0),O;return S>0&&Math.abs(d-p)<360?O=GSe({cx:s,cy:a,innerRadius:o,outerRadius:l,cornerRadius:Math.min(S,k/2),forceCornerRadius:f,cornerIsExternal:u,startAngle:d,endAngle:p}):O=mW({cx:s,cy:a,innerRadius:o,outerRadius:l,startAngle:d,endAngle:p}),s1.default.createElement("path",bN({},yt(this.props,!0),{className:w,d:O,role:"img"}))}}]),r}(s1.PureComponent);HSe(_N,"defaultProps",{cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1});var wW=ae(Yr()),SW=ae(S2()),xW=ae(mn()),kW=ae(Je());var EW=ae(Kr());function Jm(e){"@babel/helpers - typeof";return Jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jm(e)}function wN(){return wN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wN.apply(this,arguments)}function bW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bW(Object(r),!0).forEach(function(n){KSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KSe(e,t,r){return t=YSe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YSe(e){var t=XSe(e,"string");return Jm(t)==="symbol"?t:String(t)}function XSe(e,t){if(Jm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _W={curveBasisClosed:NT,curveBasisOpen:PT,curveBasis:IT,curveLinearClosed:LT,curveLinear:Kl,curveMonotoneX:DT,curveMonotoneY:jT,curveNatural:BT,curveStep:MT,curveStepAfter:$T,curveStepBefore:RT},a1=function(t){return t.x===+t.x&&t.y===+t.y},Hm=function(t){return t.x},Wm=function(t){return t.y},ZSe=function(t,r){if((0,xW.default)(t))return t;var n="curve".concat((0,SW.default)(t));return n==="curveMonotone"&&r?_W["".concat(n).concat(r==="vertical"?"Y":"X")]:_W[n]||Kl},QSe=function(t){var r=t.type,n=t.points,i=t.baseLine,s=t.layout,a=t.connectNulls,o=ZSe(r,s),l=a?n.filter(function(d){return a1(d)}):n,c;if((0,wW.default)(i)){var f=a?i.filter(function(d){return a1(d)}):i,u=l.map(function(d,p){return vW(vW({},d),{},{base:f[p]})});return s==="vertical"?c=rp().y(Wm).x1(Hm).x0(function(d){return d.base.x}):c=rp().x(Hm).y1(Wm).y0(function(d){return d.base.y}),c.defined(a1).curve(o),c(u)}return s==="vertical"&&qe(i)?c=rp().y(Wm).x1(Hm).x0(i):qe(i)?c=rp().x(Hm).y1(Wm).y0(i):c=qy().x(Hm).y(Wm),c.defined(a1).curve(o),c(l)},Hp=function(t){var r=t.className,n=t.points,i=t.path,s=t.pathRef;if((!n||!n.length)&&!i)return null;var a=n&&n.length?QSe(t):i;return kW.default.createElement("path",wN({},yt(t),Ou(t),{className:(0,EW.default)("recharts-curve",r),d:a,ref:s}))};Hp.defaultProps={type:"linear",points:[],connectNulls:!1};var rf=ae(Je()),NW=ae(Kr());function Wp(e){"@babel/helpers - typeof";return Wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wp(e)}function o1(){return o1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o1.apply(this,arguments)}function exe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IW(n.key),n)}}function txe(e,t,r){return t&&OW(e.prototype,t),r&&OW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SN(e,t)}function SN(e,t){return SN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SN(e,t)}function nxe(e){var t=sxe();return function(){var n=l1(e),i;if(t){var s=l1(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return ixe(this,i)}}function ixe(e,t){if(t&&(Wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TW(e)}function TW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function l1(e){return l1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},l1(e)}function CW(e,t,r){return t=IW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IW(e){var t=axe(e,"string");return Wp(t)==="symbol"?t:String(t)}function axe(e,t){if(Wp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AW=function(t,r,n,i,s){var a=Math.min(Math.abs(n)/2,Math.abs(i)/2),o=i>=0?1:-1,l=n>=0?1:-1,c=i>=0&&n>=0||i<0&&n<0?1:0,f;if(a>0&&s instanceof Array){for(var u=[0,0,0,0],d=0,p=4;d<p;d++)u[d]=s[d]>a?a:s[d];f="M".concat(t,",").concat(r+o*u[0]),u[0]>0&&(f+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(t+l*u[0],",").concat(r)),f+="L ".concat(t+n-l*u[1],",").concat(r),u[1]>0&&(f+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(t+n,",").concat(r+o*u[1])),f+="L ".concat(t+n,",").concat(r+i-o*u[2]),u[2]>0&&(f+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(t+n-l*u[2],",").concat(r+i)),f+="L ".concat(t+l*u[3],",").concat(r+i),u[3]>0&&(f+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(t,",").concat(r+i-o*u[3])),f+="Z"}else if(a>0&&s===+s&&s>0){var _=Math.min(a,s);f="M ".concat(t,",").concat(r+o*_,`
            A `).concat(_,",").concat(_,",0,0,").concat(c,",").concat(t+l*_,",").concat(r,`
            L `).concat(t+n-l*_,",").concat(r,`
            A `).concat(_,",").concat(_,",0,0,").concat(c,",").concat(t+n,",").concat(r+o*_,`
            L `).concat(t+n,",").concat(r+i-o*_,`
            A `).concat(_,",").concat(_,",0,0,").concat(c,",").concat(t+n-l*_,",").concat(r+i,`
            L `).concat(t+l*_,",").concat(r+i,`
            A `).concat(_,",").concat(_,",0,0,").concat(c,",").concat(t,",").concat(r+i-o*_," Z")}else f="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(i," h ").concat(-n," Z");return f},PW=function(t,r){if(!t||!r)return!1;var n=t.x,i=t.y,s=r.x,a=r.y,o=r.width,l=r.height;if(Math.abs(o)>0&&Math.abs(l)>0){var c=Math.min(s,s+o),f=Math.max(s,s+o),u=Math.min(a,a+l),d=Math.max(a,a+l);return n>=c&&n<=f&&i>=u&&i<=d}return!1},nf=function(e){rxe(r,e);var t=nxe(r);function r(){var n;exe(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=t.call.apply(t,[this].concat(s)),CW(TW(n),"state",{totalLength:-1}),n}return txe(r,[{key:"componentDidMount",value:function(){if(this.node&&this.node.getTotalLength)try{var i=this.node.getTotalLength();i&&this.setState({totalLength:i})}catch{}}},{key:"render",value:function(){var i=this,s=this.props,a=s.x,o=s.y,l=s.width,c=s.height,f=s.radius,u=s.className,d=this.state.totalLength,p=this.props,_=p.animationEasing,w=p.animationDuration,k=p.animationBegin,S=p.isAnimationActive,O=p.isUpdateAnimationActive;if(a!==+a||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var A=(0,NW.default)("recharts-rectangle",u);return O?rf.default.createElement(Ru,{canBegin:d>0,from:{width:l,height:c,x:a,y:o},to:{width:l,height:c,x:a,y:o},duration:w,animationEasing:_,isActive:O},function(C){var I=C.width,D=C.height,L=C.x,U=C.y;return rf.default.createElement(Ru,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:k,duration:w,isActive:S,easing:_},rf.default.createElement("path",o1({},yt(i.props,!0),{className:A,d:AW(L,U,I,D,f),ref:function(V){i.node=V}})))}):rf.default.createElement("path",o1({},yt(this.props,!0),{className:A,d:AW(a,o,l,c,f)}))}}]),r}(rf.PureComponent);CW(nf,"defaultProps",{x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"});var u1=ae(Je()),FW=ae(Kr());function Jp(e){"@babel/helpers - typeof";return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jp(e)}function xN(){return xN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xN.apply(this,arguments)}function oxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cxe(n.key),n)}}function lxe(e,t,r){return t&&LW(e.prototype,t),r&&LW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cxe(e){var t=uxe(e,"string");return Jp(t)==="symbol"?t:String(t)}function uxe(e,t){if(Jp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kN(e,t)}function kN(e,t){return kN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kN(e,t)}function dxe(e){var t=gxe();return function(){var n=c1(e),i;if(t){var s=c1(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return pxe(this,i)}}function pxe(e,t){if(t&&(Jp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hxe(e)}function hxe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function c1(e){return c1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},c1(e)}var Gp=function(e){fxe(r,e);var t=dxe(r);function r(){return oxe(this,r),t.apply(this,arguments)}return lxe(r,[{key:"render",value:function(){var i=this.props,s=i.cx,a=i.cy,o=i.r,l=i.className,c=(0,FW.default)("recharts-dot",l);return s===+s&&a===+a&&o===+o?u1.default.createElement("circle",xN({},yt(this.props),Ou(this.props),{className:c,cx:s,cy:a,r:o})):null}}]),r}(u1.PureComponent);var DW=ae(Je()),jW=ae(Kr());function EN(){return EN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},EN.apply(this,arguments)}var yxe=function(t,r,n,i,s,a){return"M".concat(t,",").concat(s,"v").concat(i,"M").concat(a,",").concat(r,"h").concat(n)},ON=function(t){var r=t.x,n=t.y,i=t.width,s=t.height,a=t.top,o=t.left,l=t.className;return!qe(r)||!qe(n)||!qe(i)||!qe(s)||!qe(a)||!qe(o)?null:DW.default.createElement("path",EN({},yt(t,!0),{className:(0,jW.default)("recharts-cross",l),d:yxe(r,n,i,s,a,o)}))};ON.defaultProps={x:0,y:0,top:0,left:0,width:0,height:0};var NN=ae(mn()),XW=ae(CN()),un=ae(Je()),QW=ae(Kr());function Gm(e){"@babel/helpers - typeof";return Gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gm(e)}function VW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function HW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VW(Object(r),!0).forEach(function(n){WW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WW(e,t,r){return t=Txe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Txe(e){var t=Cxe(e,"string");return Gm(t)==="symbol"?t:String(t)}function Cxe(e,t){if(Gm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ixe=["Webkit","Moz","O","ms"],JW=function(t,r){if(!t)return null;var n=t.replace(/(\w)/,function(s){return s.toUpperCase()}),i=Ixe.reduce(function(s,a){return HW(HW({},s),{},WW({},a+n,r))},{});return i[t]=r,i};function Kp(e){"@babel/helpers - typeof";return Kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kp(e)}function f1(){return f1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f1.apply(this,arguments)}function GW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function IN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GW(Object(r),!0).forEach(function(n){Gs(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZW(n.key),n)}}function Pxe(e,t,r){return t&&KW(e.prototype,t),r&&KW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PN(e,t)}function PN(e,t){return PN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PN(e,t)}function Fxe(e){var t=jxe();return function(){var n=d1(e),i;if(t){var s=d1(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return Dxe(this,i)}}function Dxe(e,t){if(t&&(Kp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return so(e)}function so(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function d1(e){return d1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},d1(e)}function Gs(e,t,r){return t=ZW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZW(e){var t=Bxe(e,"string");return Kp(t)==="symbol"?t:String(t)}function Bxe(e,t){if(Kp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mxe=function(t){var r=t.data,n=t.startIndex,i=t.endIndex,s=t.x,a=t.width,o=t.travellerWidth;if(!r||!r.length)return{};var l=r.length,c=rc().domain((0,XW.default)(0,l)).range([s,s+a-o]),f=c.domain().map(function(u){return c(u)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,startX:c(n),endX:c(i),scale:c,scaleValues:f}},YW=function(t){return t.changedTouches&&!!t.changedTouches.length},Yp=function(e){Lxe(r,e);var t=Fxe(r);function r(n){var i;return Nxe(this,r),i=t.call(this,n),Gs(so(i),"handleDrag",function(s){i.leaveTimer&&(clearTimeout(i.leaveTimer),i.leaveTimer=null),i.state.isTravellerMoving?i.handleTravellerMove(s):i.state.isSlideMoving&&i.handleSlideDrag(s)}),Gs(so(i),"handleTouchMove",function(s){s.changedTouches!=null&&s.changedTouches.length>0&&i.handleDrag(s.changedTouches[0])}),Gs(so(i),"handleDragEnd",function(){i.setState({isTravellerMoving:!1,isSlideMoving:!1}),i.detachDragEndListener()}),Gs(so(i),"handleLeaveWrapper",function(){(i.state.isTravellerMoving||i.state.isSlideMoving)&&(i.leaveTimer=window.setTimeout(i.handleDragEnd,i.props.leaveTimeOut))}),Gs(so(i),"handleEnterSlideOrTraveller",function(){i.setState({isTextActive:!0})}),Gs(so(i),"handleLeaveSlideOrTraveller",function(){i.setState({isTextActive:!1})}),Gs(so(i),"handleSlideDragStart",function(s){var a=YW(s)?s.changedTouches[0]:s;i.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:a.pageX}),i.attachDragEndListener()}),i.travellerDragStartHandlers={startX:i.handleTravellerDragStart.bind(so(i),"startX"),endX:i.handleTravellerDragStart.bind(so(i),"endX")},i.state={},i}return Pxe(r,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(i){var s=i.startX,a=i.endX,o=this.state.scaleValues,l=this.props,c=l.gap,f=l.data,u=f.length-1,d=Math.min(s,a),p=Math.max(s,a),_=r.getIndexInRange(o,d),w=r.getIndexInRange(o,p);return{startIndex:_-_%c,endIndex:w===u?u:w-w%c}}},{key:"getTextOfTick",value:function(i){var s=this.props,a=s.data,o=s.tickFormatter,l=s.dataKey,c=Zn(a[i],l,i);return(0,NN.default)(o)?o(c,i):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(i){var s=this.state,a=s.slideMoveStartX,o=s.startX,l=s.endX,c=this.props,f=c.x,u=c.width,d=c.travellerWidth,p=c.startIndex,_=c.endIndex,w=c.onChange,k=i.pageX-a;k>0?k=Math.min(k,f+u-d-l,f+u-d-o):k<0&&(k=Math.max(k,f-o,f-l));var S=this.getIndex({startX:o+k,endX:l+k});(S.startIndex!==p||S.endIndex!==_)&&w&&w(S),this.setState({startX:o+k,endX:l+k,slideMoveStartX:i.pageX})}},{key:"handleTravellerDragStart",value:function(i,s){var a=YW(s)?s.changedTouches[0]:s;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:i,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(i){var s,a=this.state,o=a.brushMoveStartX,l=a.movingTravellerId,c=a.endX,f=a.startX,u=this.state[l],d=this.props,p=d.x,_=d.width,w=d.travellerWidth,k=d.onChange,S=d.gap,O=d.data,A={startX:this.state.startX,endX:this.state.endX},C=i.pageX-o;C>0?C=Math.min(C,p+_-w-u):C<0&&(C=Math.max(C,p-u)),A[l]=u+C;var I=this.getIndex(A),D=I.startIndex,L=I.endIndex,U=function(){var V=O.length-1;return l==="startX"&&(c>f?D%S===0:L%S===0)||c<f&&L===V||l==="endX"&&(c>f?L%S===0:D%S===0)||c>f&&L===V};this.setState((s={},Gs(s,l,u+C),Gs(s,"brushMoveStartX",i.pageX),s),function(){k&&U()&&k(I)})}},{key:"renderBackground",value:function(){var i=this.props,s=i.x,a=i.y,o=i.width,l=i.height,c=i.fill,f=i.stroke;return un.default.createElement("rect",{stroke:f,fill:c,x:s,y:a,width:o,height:l})}},{key:"renderPanorama",value:function(){var i=this.props,s=i.x,a=i.y,o=i.width,l=i.height,c=i.data,f=i.children,u=i.padding,d=un.Children.only(f);return d?un.default.cloneElement(d,{x:s,y:a,width:o,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(i,s){var a=this.props,o=a.y,l=a.travellerWidth,c=a.height,f=a.traveller,u=Math.max(i,this.props.x),d=IN(IN({},yt(this.props)),{},{x:u,y:o,width:l,height:c});return un.default.createElement(or,{className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[s],onTouchStart:this.travellerDragStartHandlers[s],style:{cursor:"col-resize"}},r.renderTraveller(f,d))}},{key:"renderSlide",value:function(i,s){var a=this.props,o=a.y,l=a.height,c=a.stroke,f=a.travellerWidth,u=Math.min(i,s)+f,d=Math.max(Math.abs(s-i)-f,0);return un.default.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:o,width:d,height:l})}},{key:"renderText",value:function(){var i=this.props,s=i.startIndex,a=i.endIndex,o=i.y,l=i.height,c=i.travellerWidth,f=i.stroke,u=this.state,d=u.startX,p=u.endX,_=5,w={pointerEvents:"none",fill:f};return un.default.createElement(or,{className:"recharts-brush-texts"},un.default.createElement(ec,f1({textAnchor:"end",verticalAnchor:"middle",x:Math.min(d,p)-_,y:o+l/2},w),this.getTextOfTick(s)),un.default.createElement(ec,f1({textAnchor:"start",verticalAnchor:"middle",x:Math.max(d,p)+c+_,y:o+l/2},w),this.getTextOfTick(a)))}},{key:"render",value:function(){var i=this.props,s=i.data,a=i.className,o=i.children,l=i.x,c=i.y,f=i.width,u=i.height,d=i.alwaysShowText,p=this.state,_=p.startX,w=p.endX,k=p.isTextActive,S=p.isSlideMoving,O=p.isTravellerMoving;if(!s||!s.length||!qe(l)||!qe(c)||!qe(f)||!qe(u)||f<=0||u<=0)return null;var A=(0,QW.default)("recharts-brush",a),C=un.default.Children.count(o)===1,I=JW("userSelect","none");return un.default.createElement(or,{className:A,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:I},this.renderBackground(),C&&this.renderPanorama(),this.renderSlide(_,w),this.renderTravellerLayer(_,"startX"),this.renderTravellerLayer(w,"endX"),(k||S||O||d)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(i){var s=i.x,a=i.y,o=i.width,l=i.height,c=i.stroke,f=Math.floor(a+l/2)-1;return un.default.createElement(un.default.Fragment,null,un.default.createElement("rect",{x:s,y:a,width:o,height:l,fill:c,stroke:"none"}),un.default.createElement("line",{x1:s+1,y1:f,x2:s+o-1,y2:f,fill:"none",stroke:"#fff"}),un.default.createElement("line",{x1:s+1,y1:f+2,x2:s+o-1,y2:f+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(i,s){var a;return un.default.isValidElement(i)?a=un.default.cloneElement(i,s):(0,NN.default)(i)?a=i(s):a=r.renderDefaultTraveller(s),a}},{key:"getDerivedStateFromProps",value:function(i,s){var a=i.data,o=i.width,l=i.x,c=i.travellerWidth,f=i.updateId,u=i.startIndex,d=i.endIndex;if(a!==s.prevData||f!==s.prevUpdateId)return IN({prevData:a,prevTravellerWidth:c,prevUpdateId:f,prevX:l,prevWidth:o},a&&a.length?Mxe({data:a,width:o,x:l,travellerWidth:c,startIndex:u,endIndex:d}):{scale:null,scaleValues:null});if(s.scale&&(o!==s.prevWidth||l!==s.prevX||c!==s.prevTravellerWidth)){s.scale.range([l,l+o-c]);var p=s.scale.domain().map(function(_){return s.scale(_)});return{prevData:a,prevTravellerWidth:c,prevUpdateId:f,prevX:l,prevWidth:o,startX:s.scale(i.startIndex),endX:s.scale(i.endIndex),scaleValues:p}}return null}},{key:"getIndexInRange",value:function(i,s){for(var a=i.length,o=0,l=a-1;l-o>1;){var c=Math.floor((o+l)/2);i[c]>s?l=c:o=c}return s>=i[l]?l:o}}]),r}(un.PureComponent);Gs(Yp,"displayName","Brush");Gs(Yp,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var PJ=ae(nJ()),LJ=ae(mn()),Xm=ae(Je()),FJ=ae(Kr());var Xi=function(t,r){var n=t.alwaysShow,i=t.ifOverflow;return n&&(i="extendDomain"),i===r};var kJ=ae(LN()),EJ=ae(pJ());var yJ=ae(Rs()),mJ=ae(uw()),bJ=ae(mn()),vJ=ae(Yr()),ui=ae(Je()),wJ=ae(Kr());var oke=["value","background"];function Xp(e){"@babel/helpers - typeof";return Xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xp(e)}function lke(e,t){if(e==null)return{};var r=cke(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cke(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function FN(){return FN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},FN.apply(this,arguments)}function hJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Bn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hJ(Object(r),!0).forEach(function(n){cc(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_J(n.key),n)}}function fke(e,t,r){return t&&gJ(e.prototype,t),r&&gJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DN(e,t)}function DN(e,t){return DN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DN(e,t)}function pke(e){var t=gke();return function(){var n=p1(e),i;if(t){var s=p1(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return hke(this,i)}}function hke(e,t){if(t&&(Xp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Km(e)}function Km(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p1(e){return p1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},p1(e)}function cc(e,t,r){return t=_J(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _J(e){var t=yke(e,"string");return Xp(t)==="symbol"?t:String(t)}function yke(e,t){if(Xp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ao=function(e){dke(r,e);var t=pke(r);function r(){var n;uke(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=t.call.apply(t,[this].concat(s)),cc(Km(n),"state",{isAnimationFinished:!1}),cc(Km(n),"id",Ga("recharts-bar-")),cc(Km(n),"handleAnimationEnd",function(){var o=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),o&&o()}),cc(Km(n),"handleAnimationStart",function(){var o=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),o&&o()}),n}return fke(r,[{key:"renderRectanglesStatically",value:function(i){var s=this,a=this.props.shape,o=yt(this.props);return i&&i.map(function(l,c){var f=Bn(Bn(Bn({},o),l),{},{index:c});return ui.default.createElement(or,FN({className:"recharts-bar-rectangle"},Au(s.props,l,c),{key:"rectangle-".concat(c),role:"img"}),r.renderRectangle(a,f))})}},{key:"renderRectanglesWithAnimation",value:function(){var i=this,s=this.props,a=s.data,o=s.layout,l=s.isAnimationActive,c=s.animationBegin,f=s.animationDuration,u=s.animationEasing,d=s.animationId,p=this.state.prevData;return ui.default.createElement(Ru,{begin:c,duration:f,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_){var w=_.t,k=a.map(function(S,O){var A=p&&p[O];if(A){var C=ys(A.x,S.x),I=ys(A.y,S.y),D=ys(A.width,S.width),L=ys(A.height,S.height);return Bn(Bn({},S),{},{x:C(w),y:I(w),width:D(w),height:L(w)})}if(o==="horizontal"){var U=ys(0,S.height),te=U(w);return Bn(Bn({},S),{},{y:S.y+S.height-te,height:te})}var V=ys(0,S.width),X=V(w);return Bn(Bn({},S),{},{width:X})});return ui.default.createElement(or,null,i.renderRectanglesStatically(k))})}},{key:"renderRectangles",value:function(){var i=this.props,s=i.data,a=i.isAnimationActive,o=this.state.prevData;return a&&s&&s.length&&(!o||!(0,mJ.default)(o,s))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(s)}},{key:"renderBackground",value:function(){var i=this,s=this.props.data,a=yt(this.props.background);return s.map(function(o,l){var c=o.value,f=o.background,u=lke(o,oke);if(!f)return null;var d=Bn(Bn(Bn(Bn(Bn({},u),{},{fill:"#eee"},f),a),Au(i.props,o,l)),{},{index:l,key:"background-bar-".concat(l),className:"recharts-bar-background-rectangle"});return r.renderRectangle(i.props.background,d)})}},{key:"renderErrorBar",value:function(i,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.data,l=a.xAxis,c=a.yAxis,f=a.layout,u=a.children,d=En(u,lc);if(!d)return null;var p=f==="vertical"?o[0].height/2:o[0].width/2;function _(k,S){return{x:k.x,y:k.y,value:k.value,errorVal:Zn(k,S)}}var w={clipPath:i?"url(#clipPath-".concat(s,")"):null};return ui.default.createElement(or,w,d.map(function(k,S){return ui.default.cloneElement(k,{key:"error-bar-".concat(S),data:o,xAxis:l,yAxis:c,layout:f,offset:p,dataPointFormatter:_})}))}},{key:"render",value:function(){var i=this.props,s=i.hide,a=i.data,o=i.className,l=i.xAxis,c=i.yAxis,f=i.left,u=i.top,d=i.width,p=i.height,_=i.isAnimationActive,w=i.background,k=i.id;if(s||!a||!a.length)return null;var S=this.state.isAnimationFinished,O=(0,wJ.default)("recharts-bar",o),A=l&&l.allowDataOverflow||c&&c.allowDataOverflow,C=(0,yJ.default)(k)?this.id:k;return ui.default.createElement(or,{className:O},A?ui.default.createElement("defs",null,ui.default.createElement("clipPath",{id:"clipPath-".concat(C)},ui.default.createElement("rect",{x:f,y:u,width:d,height:p}))):null,ui.default.createElement(or,{className:"recharts-bar-rectangles",clipPath:A?"url(#clipPath-".concat(C,")"):null},w?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(A,C),(!_||S)&&va.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(i,s){return i.animationId!==s.prevAnimationId?{prevAnimationId:i.animationId,curData:i.data,prevData:s.curData}:i.data!==s.curData?{curData:i.data}:null}},{key:"renderRectangle",value:function(i,s){var a;return ui.default.isValidElement(i)?a=ui.default.cloneElement(i,s):(0,bJ.default)(i)?a=i(s):a=ui.default.createElement(nf,s),a}}]),r}(ui.PureComponent);cc(ao,"displayName","Bar");cc(ao,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",isAnimationActive:!Ti.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});cc(ao,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,i=e.bandSize,s=e.xAxis,a=e.yAxis,o=e.xAxisTicks,l=e.yAxisTicks,c=e.stackedData,f=e.dataStartIndex,u=e.displayedData,d=e.offset,p=YH(n,r);if(!p)return null;var _=t.layout,w=r.props,k=w.dataKey,S=w.children,O=w.minPointSize,A=_==="horizontal"?a:s,C=c?A.scale.domain():null,I=eW({numericAxis:A}),D=En(S,kp),L=u.map(function(U,te){var V,X,Z,se,pe,de;if(c?V=XH(c[f+te],C):(V=Zn(U,k),(0,vJ.default)(V)||(V=[I,V])),_==="horizontal"){var F,H=[a.scale(V[0]),a.scale(V[1])],Q=H[0],R=H[1];X=uN({axis:s,ticks:o,bandSize:i,offset:p.offset,entry:U,index:te}),Z=(F=R??Q)!==null&&F!==void 0?F:void 0,se=p.size;var $=Q-R;if(pe=Number.isNaN($)?0:$,de={x:X,y:a.y,width:se,height:a.height},Math.abs(O)>0&&Math.abs(pe)<Math.abs(O)){var q=Kn(pe||O)*(Math.abs(O)-Math.abs(pe));Z-=q,pe+=q}}else{var ie=[s.scale(V[0]),s.scale(V[1])],oe=ie[0],fe=ie[1];if(X=oe,Z=uN({axis:a,ticks:l,bandSize:i,offset:p.offset,entry:U,index:te}),se=fe-oe,pe=p.size,de={x:s.x,y:Z,width:s.width,height:pe},Math.abs(O)>0&&Math.abs(se)<Math.abs(O)){var _e=Kn(se||O)*(Math.abs(O)-Math.abs(se));se+=_e}}return Bn(Bn(Bn({},U),{},{x:X,y:Z,width:se,height:pe,value:c?V:V[1],payload:U,background:de},D&&D[te]&&D[te].props),{},{tooltipPayload:[e1(r,U)],tooltipPosition:{x:X+se/2,y:Z+pe/2}})});return Bn({data:L,layout:_},d)});function Ym(e){"@babel/helpers - typeof";return Ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ym(e)}function mke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OJ(n.key),n)}}function bke(e,t,r){return t&&SJ(e.prototype,t),r&&SJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _a(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xJ(Object(r),!0).forEach(function(n){h1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function h1(e,t,r){return t=OJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OJ(e){var t=vke(e,"string");return Ym(t)==="symbol"?t:String(t)}function vke(e,t){if(Ym(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ym(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g1=function(t,r,n,i,s){var a=t.width,o=t.height,l=t.layout,c=t.children,f=Object.keys(r),u={left:n.left,leftMirror:n.left,right:a-n.right,rightMirror:a-n.right,top:n.top,topMirror:n.top,bottom:o-n.bottom,bottomMirror:o-n.bottom},d=!!$s(c,ao);return f.reduce(function(p,_){var w=r[_],k=w.orientation,S=w.domain,O=w.padding,A=O===void 0?{}:O,C=w.mirror,I=w.reversed,D="".concat(k).concat(C?"Mirror":""),L,U,te,V,X;if(w.type==="number"&&(w.padding==="gap"||w.padding==="no-gap")){var Z=S[1]-S[0],se=1/0,pe=w.categoricalDomain.sort();pe.forEach(function(fe,_e){_e>0&&(se=Math.min((fe||0)-(pe[_e-1]||0),se))});var de=se/Z,F=w.layout==="vertical"?n.height:n.width;if(w.padding==="gap"&&(L=de*F/2),w.padding==="no-gap"){var H=Ka(t.barCategoryGap,de*F),Q=de*F/2;L=Q-H-(Q-H)/F*H}}i==="xAxis"?U=[n.left+(A.left||0)+(L||0),n.left+n.width-(A.right||0)-(L||0)]:i==="yAxis"?U=l==="horizontal"?[n.top+n.height-(A.bottom||0),n.top+(A.top||0)]:[n.top+(A.top||0)+(L||0),n.top+n.height-(A.bottom||0)-(L||0)]:U=w.range,I&&(U=[U[1],U[0]]);var R=GH(w,s,d),$=R.scale,q=R.realScaleType;$.domain(S).range(U),KH($);var ie=QH($,_a(_a({},w),{},{realScaleType:q}));i==="xAxis"?(X=k==="top"&&!C||k==="bottom"&&C,te=n.left,V=u[D]-X*w.height):i==="yAxis"&&(X=k==="left"&&!C||k==="right"&&C,te=u[D]-X*w.width,V=n.top);var oe=_a(_a(_a({},w),ie),{},{realScaleType:q,x:te,y:V,scale:$,width:i==="xAxis"?n.width:w.width,height:i==="yAxis"?n.height:w.height});return oe.bandSize=qp(oe,ie),!w.hide&&i==="xAxis"?u[D]+=(X?-1:1)*oe.height:w.hide||(u[D]+=(X?-1:1)*oe.width),_a(_a({},p),{},h1({},_,oe))},{})},jN=function(t,r){var n=t.x,i=t.y,s=r.x,a=r.y;return{x:Math.min(n,s),y:Math.min(i,a),width:Math.abs(s-n),height:Math.abs(a-i)}},AJ=function(t){var r=t.x1,n=t.y1,i=t.x2,s=t.y2;return jN({x:r,y:n},{x:i,y:s})},TJ=function(){function e(t){mke(this,e),this.scale=t}return bke(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.bandAware,s=n.position;if(r!==void 0){if(s)switch(s){case"start":return this.scale(r);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+a}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(r)+o}default:return this.scale(r)}if(i){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+l}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),i=n[0],s=n[n.length-1];return i<=s?r>=i&&r<=s:r>=s&&r<=i}}],[{key:"create",value:function(r){return new e(r)}}]),e}();h1(TJ,"EPS",1e-4);var Zp=function(t){var r=Object.keys(t).reduce(function(n,i){return _a(_a({},n),{},h1({},i,TJ.create(t[i])))},{});return _a(_a({},r),{},{apply:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=s.bandAware,o=s.position;return(0,EJ.default)(i,function(l,c){return r[c].apply(l,{bandAware:a,position:o})})},isInRange:function(i){return(0,kJ.default)(i,function(s,a){return r[a].isInRange(s)})}})};function Zm(e){"@babel/helpers - typeof";return Zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zm(e)}function CJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function IJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CJ(Object(r),!0).forEach(function(n){_ke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _ke(e,t,r){return t=wke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wke(e){var t=Ske(e,"string");return Zm(t)==="symbol"?t:String(t)}function Ske(e,t){if(Zm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xke(e,t){return Ake(e)||Oke(e,t)||Eke(e,t)||kke()}function kke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eke(e,t){if(e){if(typeof e=="string")return NJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NJ(e,t)}}function NJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function Ake(e){if(Array.isArray(e))return e}function BN(){return BN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BN.apply(this,arguments)}var Tke=function(t,r){var n;return Xm.default.isValidElement(t)?n=Xm.default.cloneElement(t,r):(0,LJ.default)(t)?n=t(r):n=Xm.default.createElement("line",BN({},r,{className:"recharts-reference-line-line"})),n},Cke=function(t,r,n,i,s){var a=s.viewBox,o=a.x,l=a.y,c=a.width,f=a.height,u=s.position;if(n){var d=s.y,p=s.yAxis.orientation,_=t.y.apply(d,{position:u});if(Xi(s,"discard")&&!t.y.isInRange(_))return null;var w=[{x:o+c,y:_},{x:o,y:_}];return p==="left"?w.reverse():w}if(r){var k=s.x,S=s.xAxis.orientation,O=t.x.apply(k,{position:u});if(Xi(s,"discard")&&!t.x.isInRange(O))return null;var A=[{x:O,y:l+f},{x:O,y:l}];return S==="top"?A.reverse():A}if(i){var C=s.segment,I=C.map(function(D){return t.apply(D,{position:u})});return Xi(s,"discard")&&(0,PJ.default)(I,function(D){return!t.isInRange(D)})?null:I}return null};function y1(e){var t=e.x,r=e.y,n=e.segment,i=e.xAxis,s=e.yAxis,a=e.shape,o=e.className,l=e.alwaysShow,c=e.clipPathId;Qa(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=Zp({x:i.scale,y:s.scale}),u=Cr(t),d=Cr(r),p=n&&n.length===2,_=Cke(f,u,d,p,e);if(!_)return null;var w=xke(_,2),k=w[0],S=k.x,O=k.y,A=w[1],C=A.x,I=A.y,D=Xi(e,"hidden")?"url(#".concat(c,")"):void 0,L=IJ(IJ({clipPath:D},yt(e,!0)),{},{x1:S,y1:O,x2:C,y2:I});return Xm.default.createElement(or,{className:(0,FJ.default)("recharts-reference-line",o)},Tke(a,L),en.renderCallByParent(e,AJ({x1:S,y1:O,x2:C,y2:I})))}y1.displayName="ReferenceLine";y1.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"};var BJ=ae(mn()),Qm=ae(Je()),MJ=ae(Kr());function eb(e){"@babel/helpers - typeof";return eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eb(e)}function MN(){return MN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MN.apply(this,arguments)}function DJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DJ(Object(r),!0).forEach(function(n){Ike(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ike(e,t,r){return t=Nke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nke(e){var t=Pke(e,"string");return eb(t)==="symbol"?t:String(t)}function Pke(e,t){if(eb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lke=function(t){var r=t.x,n=t.y,i=t.xAxis,s=t.yAxis,a=Zp({x:i.scale,y:s.scale}),o=a.apply({x:r,y:n},{bandAware:!0});return Xi(t,"discard")&&!a.isInRange(o)?null:o};function Qp(e){var t=e.x,r=e.y,n=e.r,i=e.alwaysShow,s=e.clipPathId,a=Cr(t),o=Cr(r);if(Qa(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!a||!o)return null;var l=Lke(e);if(!l)return null;var c=l.x,f=l.y,u=e.shape,d=e.className,p=Xi(e,"hidden")?"url(#".concat(s,")"):void 0,_=jJ(jJ({clipPath:p},yt(e,!0)),{},{cx:c,cy:f});return Qm.default.createElement(or,{className:(0,MJ.default)("recharts-reference-dot",d)},Qp.renderDot(u,_),en.renderCallByParent(e,{x:c-n,y:f-n,width:2*n,height:2*n}))}Qp.displayName="ReferenceDot";Qp.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1};Qp.renderDot=function(e,t){var r;return Qm.default.isValidElement(e)?r=Qm.default.cloneElement(e,t):(0,BJ.default)(e)?r=e(t):r=Qm.default.createElement(Gp,MN({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r};var UJ=ae(mn()),tb=ae(Je()),zJ=ae(Kr());function rb(e){"@babel/helpers - typeof";return rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rb(e)}function RN(){return RN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RN.apply(this,arguments)}function RJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $J(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RJ(Object(r),!0).forEach(function(n){Fke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fke(e,t,r){return t=Dke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dke(e){var t=jke(e,"string");return rb(t)==="symbol"?t:String(t)}function jke(e,t){if(rb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bke=function(t,r,n,i,s){var a=s.x1,o=s.x2,l=s.y1,c=s.y2,f=s.xAxis,u=s.yAxis;if(!f||!u)return null;var d=Zp({x:f.scale,y:u.scale}),p={x:t?d.x.apply(a,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(l,{position:"start"}):d.y.rangeMin},_={x:r?d.x.apply(o,{position:"end"}):d.x.rangeMax,y:i?d.y.apply(c,{position:"end"}):d.y.rangeMax};return Xi(s,"discard")&&(!d.isInRange(p)||!d.isInRange(_))?null:jN(p,_)};function eh(e){var t=e.x1,r=e.x2,n=e.y1,i=e.y2,s=e.className,a=e.alwaysShow,o=e.clipPathId;Qa(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var l=Cr(t),c=Cr(r),f=Cr(n),u=Cr(i),d=e.shape;if(!l&&!c&&!f&&!u&&!d)return null;var p=Bke(l,c,f,u,e);if(!p&&!d)return null;var _=Xi(e,"hidden")?"url(#".concat(o,")"):void 0;return tb.default.createElement(or,{className:(0,zJ.default)("recharts-reference-area",s)},eh.renderRect(d,$J($J({clipPath:_},yt(e,!0)),p)),en.renderCallByParent(e,p))}eh.displayName="ReferenceArea";eh.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1};eh.renderRect=function(e,t){var r;return tb.default.isValidElement(e)?r=tb.default.cloneElement(e,t):(0,UJ.default)(e)?r=e(t):r=tb.default.createElement(nf,RN({},t,{className:"recharts-reference-area-rect"})),r};var v1=ae(mn()),UN=ae(Eu()),wa=ae(Je()),_1=ae(Kr());var b1=ae(mn());function m1(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],i=0;i<e.length;i+=t)if(r===void 0||r(e[i])===!0)n.push(e[i]);else return;return n}function nb(e){"@babel/helpers - typeof";return nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nb(e)}function qJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qJ(Object(r),!0).forEach(function(n){Mke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mke(e,t,r){return t=Rke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rke(e){var t=$ke(e,"string");return nb(t)==="symbol"?t:String(t)}function $ke(e,t){if(nb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uke(e){for(var t=1,r=m1(e,t,function(n){return n.isShow});t<=e.length;){if(r!==void 0)return r;t++,r=m1(e,t,function(n){return n.isShow})}return e.slice(0,1)}function zke(e,t){return m1(e,t+1)}function qke(e){var t=e.ticks,r=e.tickFormatter,n=e.viewBox,i=e.orientation,s=e.minTickGap,a=e.unit,o=e.fontSize,l=e.letterSpacing,c=n.x,f=n.y,u=n.width,d=n.height,p=i==="top"||i==="bottom"?"width":"height",_=a&&p==="width"?Xo(a,{fontSize:o,letterSpacing:l})[p]:0,w=(t||[]).slice(),k=w.length,S=k>=2?Kn(w[1].coordinate-w[0].coordinate):1,O,A;S===1?(O=p==="width"?c:f,A=p==="width"?c+u:f+d):(O=p==="width"?c+u:f+d,A=p==="width"?c:f);for(var C=k-1;C>=0;C--){var I=w[C],D=(0,b1.default)(r)?r(I.value,k-C-1):I.value,L=Xo(D,{fontSize:o,letterSpacing:l})[p]+_;if(C===k-1){var U=S*(I.coordinate+S*L/2-A);w[C]=I=fi(fi({},I),{},{tickCoord:U>0?I.coordinate-U*S:I.coordinate})}else w[C]=I=fi(fi({},I),{},{tickCoord:I.coordinate});var te=S*(I.tickCoord-S*L/2-O)>=0&&S*(I.tickCoord+S*L/2-A)<=0;te&&(A=I.tickCoord-S*(L/2+s),w[C]=fi(fi({},I),{},{isShow:!0}))}return w}function VJ(e,t){var r=e.ticks,n=e.tickFormatter,i=e.viewBox,s=e.orientation,a=e.minTickGap,o=e.unit,l=e.fontSize,c=e.letterSpacing,f=i.x,u=i.y,d=i.width,p=i.height,_=s==="top"||s==="bottom"?"width":"height",w=(r||[]).slice(),k=o&&_==="width"?Xo(o,{fontSize:l,letterSpacing:c})[_]:0,S=w.length,O=S>=2?Kn(w[1].coordinate-w[0].coordinate):1,A,C;if(O===1?(A=_==="width"?f:u,C=_==="width"?f+d:u+p):(A=_==="width"?f+d:u+p,C=_==="width"?f:u),t){var I=r[S-1],D=(0,b1.default)(n)?n(I.value,S-1):I.value,L=Xo(D,{fontSize:l,letterSpacing:c})[_]+k,U=O*(I.coordinate+O*L/2-C);w[S-1]=I=fi(fi({},I),{},{tickCoord:U>0?I.coordinate-U*O:I.coordinate});var te=O*(I.tickCoord-O*L/2-A)>=0&&O*(I.tickCoord+O*L/2-C)<=0;te&&(C=I.tickCoord-O*(L/2+a),w[S-1]=fi(fi({},I),{},{isShow:!0}))}for(var V=t?S-1:S,X=0;X<V;X++){var Z=w[X],se=(0,b1.default)(n)?n(Z.value,X):Z.value,pe=Xo(se,{fontSize:l,letterSpacing:c})[_]+k;if(X===0){var de=O*(Z.coordinate-O*pe/2-A);w[X]=Z=fi(fi({},Z),{},{tickCoord:de<0?Z.coordinate-de*O:Z.coordinate})}else w[X]=Z=fi(fi({},Z),{},{tickCoord:Z.coordinate});var F=O*(Z.tickCoord-O*pe/2-A)>=0&&O*(Z.tickCoord+O*pe/2-C)<=0;F&&(A=Z.tickCoord+O*(pe/2+a),w[X]=fi(fi({},Z),{},{isShow:!0}))}return w}function ib(e,t,r){var n=e.tick,i=e.ticks,s=e.viewBox,a=e.minTickGap,o=e.orientation,l=e.interval,c=e.tickFormatter,f=e.unit;if(!i||!i.length||!n)return[];if(qe(l)||Ti.isSsr)return zke(i,typeof l=="number"&&qe(l)?l:0);var u=[];return l==="equidistantPreserveStart"?(u=VJ({ticks:i,tickFormatter:c,viewBox:s,orientation:o,minTickGap:a,unit:f,fontSize:t,letterSpacing:r}),Uke(u)):(l==="preserveStart"||l==="preserveStartEnd"?u=VJ({ticks:i,tickFormatter:c,viewBox:s,orientation:o,minTickGap:a,unit:f,fontSize:t,letterSpacing:r},l==="preserveStartEnd"):u=qke({ticks:i,tickFormatter:c,viewBox:s,orientation:o,minTickGap:a,unit:f,fontSize:t,letterSpacing:r}),u.filter(function(d){return d.isShow}))}var Vke=["viewBox"],Hke=["viewBox"],Wke=["ticks"];function rh(e){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}function th(){return th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},th.apply(this,arguments)}function HJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Pi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HJ(Object(r),!0).forEach(function(n){qN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $N(e,t){if(e==null)return{};var r=Jke(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Jke(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Gke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JJ(n.key),n)}}function Kke(e,t,r){return t&&WJ(e.prototype,t),r&&WJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zN(e,t)}function zN(e,t){return zN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zN(e,t)}function Xke(e){var t=eEe();return function(){var n=w1(e),i;if(t){var s=w1(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return Zke(this,i)}}function Zke(e,t){if(t&&(rh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qke(e)}function Qke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function w1(e){return w1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},w1(e)}function qN(e,t,r){return t=JJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JJ(e){var t=tEe(e,"string");return rh(t)==="symbol"?t:String(t)}function tEe(e,t){if(rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nh=function(e){Yke(r,e);var t=Xke(r);function r(n){var i;return Gke(this,r),i=t.call(this,n),i.state={fontSize:"",letterSpacing:""},i}return Kke(r,[{key:"shouldComponentUpdate",value:function(i,s){var a=i.viewBox,o=$N(i,Vke),l=this.props,c=l.viewBox,f=$N(l,Hke);return!Ho(a,c)||!Ho(o,f)||!Ho(s,this.state)}},{key:"componentDidMount",value:function(){var i=this.layerReference;if(i){var s=i.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];s&&this.setState({fontSize:window.getComputedStyle(s).fontSize,letterSpacing:window.getComputedStyle(s).letterSpacing})}}},{key:"getTickLineCoord",value:function(i){var s=this.props,a=s.x,o=s.y,l=s.width,c=s.height,f=s.orientation,u=s.tickSize,d=s.mirror,p=s.tickMargin,_,w,k,S,O,A,C=d?-1:1,I=i.tickSize||u,D=qe(i.tickCoord)?i.tickCoord:i.coordinate;switch(f){case"top":_=w=i.coordinate,S=o+ +!d*c,k=S-C*I,A=k-C*p,O=D;break;case"left":k=S=i.coordinate,w=a+ +!d*l,_=w-C*I,O=_-C*p,A=D;break;case"right":k=S=i.coordinate,w=a+ +d*l,_=w+C*I,O=_+C*p,A=D;break;default:_=w=i.coordinate,S=o+ +d*c,k=S+C*I,A=k+C*p,O=D;break}return{line:{x1:_,y1:k,x2:w,y2:S},tick:{x:O,y:A}}}},{key:"getTickTextAnchor",value:function(){var i=this.props,s=i.orientation,a=i.mirror,o;switch(s){case"left":o=a?"start":"end";break;case"right":o=a?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var i=this.props,s=i.orientation,a=i.mirror,o="end";switch(s){case"left":case"right":o="middle";break;case"top":o=a?"start":"end";break;default:o=a?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var i=this.props,s=i.x,a=i.y,o=i.width,l=i.height,c=i.orientation,f=i.mirror,u=i.axisLine,d=Pi(Pi(Pi({},yt(this.props)),yt(u)),{},{fill:"none"});if(c==="top"||c==="bottom"){var p=+(c==="top"&&!f||c==="bottom"&&f);d=Pi(Pi({},d),{},{x1:s,y1:a+p*l,x2:s+o,y2:a+p*l})}else{var _=+(c==="left"&&!f||c==="right"&&f);d=Pi(Pi({},d),{},{x1:s+_*o,y1:a,x2:s+_*o,y2:a+l})}return wa.default.createElement("line",th({},d,{className:(0,_1.default)("recharts-cartesian-axis-line",(0,UN.default)(u,"className"))}))}},{key:"renderTicks",value:function(i,s,a){var o=this,l=this.props,c=l.tickLine,f=l.stroke,u=l.tick,d=l.tickFormatter,p=l.unit,_=ib(Pi(Pi({},this.props),{},{ticks:i}),s,a),w=this.getTickTextAnchor(),k=this.getTickVerticalAnchor(),S=yt(this.props),O=yt(u),A=Pi(Pi({},S),{},{fill:"none"},yt(c)),C=_.map(function(I,D){var L=o.getTickLineCoord(I),U=L.line,te=L.tick,V=Pi(Pi(Pi(Pi({textAnchor:w,verticalAnchor:k},S),{},{stroke:"none",fill:f},O),te),{},{index:D,payload:I,visibleTicksCount:_.length,tickFormatter:d});return wa.default.createElement(or,th({className:"recharts-cartesian-axis-tick",key:"tick-".concat(D)},Au(o.props,I,D)),c&&wa.default.createElement("line",th({},A,U,{className:(0,_1.default)("recharts-cartesian-axis-tick-line",(0,UN.default)(c,"className"))})),u&&r.renderTickItem(u,V,"".concat((0,v1.default)(d)?d(I.value,D):I.value).concat(p||"")))});return wa.default.createElement("g",{className:"recharts-cartesian-axis-ticks"},C)}},{key:"render",value:function(){var i=this,s=this.props,a=s.axisLine,o=s.width,l=s.height,c=s.ticksGenerator,f=s.className,u=s.hide;if(u)return null;var d=this.props,p=d.ticks,_=$N(d,Wke),w=p;return(0,v1.default)(c)&&(w=p&&p.length>0?c(this.props):c(_)),o<=0||l<=0||!w||!w.length?null:wa.default.createElement(or,{className:(0,_1.default)("recharts-cartesian-axis",f),ref:function(S){i.layerReference=S}},a&&this.renderAxisLine(),this.renderTicks(w,this.state.fontSize,this.state.letterSpacing),en.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(i,s,a){var o;return wa.default.isValidElement(i)?o=wa.default.cloneElement(i,s):(0,v1.default)(i)?o=i(s):o=wa.default.createElement(ec,th({},s,{className:"recharts-cartesian-axis-tick-value"}),a),o}}]),r}(wa.Component);qN(nh,"displayName","CartesianAxis");qN(nh,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var x1=ae(mn()),Zi=ae(Je());var rEe=["x1","y1","x2","y2","key"];function ih(e){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}function VN(){return VN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VN.apply(this,arguments)}function nEe(e,t){if(e==null)return{};var r=iEe(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iEe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function GJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function S1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GJ(Object(r),!0).forEach(function(n){WN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YJ(n.key),n)}}function aEe(e,t,r){return t&&KJ(e.prototype,t),r&&KJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HN(e,t)}function HN(e,t){return HN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},HN(e,t)}function lEe(e){var t=fEe();return function(){var n=k1(e),i;if(t){var s=k1(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return cEe(this,i)}}function cEe(e,t){if(t&&(ih(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uEe(e)}function uEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function k1(e){return k1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},k1(e)}function WN(e,t,r){return t=YJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YJ(e){var t=dEe(e,"string");return ih(t)==="symbol"?t:String(t)}function dEe(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sb=function(e){oEe(r,e);var t=lEe(r);function r(){return sEe(this,r),t.apply(this,arguments)}return aEe(r,[{key:"renderHorizontal",value:function(i){var s=this,a=this.props,o=a.x,l=a.width,c=a.horizontal;if(!i||!i.length)return null;var f=i.map(function(u,d){var p=S1(S1({},s.props),{},{x1:o,y1:u,x2:o+l,y2:u,key:"line-".concat(d),index:d});return r.renderLineItem(c,p)});return Zi.default.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}},{key:"renderVertical",value:function(i){var s=this,a=this.props,o=a.y,l=a.height,c=a.vertical;if(!i||!i.length)return null;var f=i.map(function(u,d){var p=S1(S1({},s.props),{},{x1:u,y1:o,x2:u,y2:o+l,key:"line-".concat(d),index:d});return r.renderLineItem(c,p)});return Zi.default.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}},{key:"renderVerticalStripes",value:function(i){var s=this.props.verticalFill;if(!s||!s.length)return null;var a=this.props,o=a.fillOpacity,l=a.x,c=a.y,f=a.width,u=a.height,d=i.map(function(_){return Math.round(_+l-l)}).sort(function(_,w){return _-w});l!==d[0]&&d.unshift(0);var p=d.map(function(_,w){var k=!d[w+1],S=k?l+f-_:d[w+1]-_;if(S<=0)return null;var O=w%s.length;return Zi.default.createElement("rect",{key:"react-".concat(w),x:_,y:c,width:S,height:u,stroke:"none",fill:s[O],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return Zi.default.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},p)}},{key:"renderHorizontalStripes",value:function(i){var s=this.props.horizontalFill;if(!s||!s.length)return null;var a=this.props,o=a.fillOpacity,l=a.x,c=a.y,f=a.width,u=a.height,d=i.map(function(_){return Math.round(_+c-c)}).sort(function(_,w){return _-w});c!==d[0]&&d.unshift(0);var p=d.map(function(_,w){var k=!d[w+1],S=k?c+u-_:d[w+1]-_;if(S<=0)return null;var O=w%s.length;return Zi.default.createElement("rect",{key:"react-".concat(w),y:_,x:l,height:S,width:f,stroke:"none",fill:s[O],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return Zi.default.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},p)}},{key:"renderBackground",value:function(){var i=this.props.fill;if(!i||i==="none")return null;var s=this.props,a=s.fillOpacity,o=s.x,l=s.y,c=s.width,f=s.height;return Zi.default.createElement("rect",{x:o,y:l,width:c,height:f,stroke:"none",fill:i,fillOpacity:a,className:"recharts-cartesian-grid-bg"})}},{key:"render",value:function(){var i=this.props,s=i.x,a=i.y,o=i.width,l=i.height,c=i.horizontal,f=i.vertical,u=i.horizontalCoordinatesGenerator,d=i.verticalCoordinatesGenerator,p=i.xAxis,_=i.yAxis,w=i.offset,k=i.chartWidth,S=i.chartHeight;if(!qe(o)||o<=0||!qe(l)||l<=0||!qe(s)||s!==+s||!qe(a)||a!==+a)return null;var O=this.props,A=O.horizontalPoints,C=O.verticalPoints;return(!A||!A.length)&&(0,x1.default)(u)&&(A=u({yAxis:_,width:k,height:S,offset:w})),(!C||!C.length)&&(0,x1.default)(d)&&(C=d({xAxis:p,width:k,height:S,offset:w})),Zi.default.createElement("g",{className:"recharts-cartesian-grid"},this.renderBackground(),c&&this.renderHorizontal(A),f&&this.renderVertical(C),c&&this.renderHorizontalStripes(A),f&&this.renderVerticalStripes(C))}}],[{key:"renderLineItem",value:function(i,s){var a;if(Zi.default.isValidElement(i))a=Zi.default.cloneElement(i,s);else if((0,x1.default)(i))a=i(s);else{var o=s.x1,l=s.y1,c=s.x2,f=s.y2,u=s.key,d=nEe(s,rEe);a=Zi.default.createElement("line",VN({},yt(d),{x1:o,y1:l,x2:c,y2:f,fill:"none",key:u}))}return a}}]),r}(Zi.PureComponent);WN(sb,"displayName","CartesianGrid");WN(sb,"defaultProps",{horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]});var QJ=ae(uw()),eG=ae(mn()),E1=ae(Rs()),Li=ae(Je());var KN=ae(Kr());var pEe=["type","layout","connectNulls","ref"];function ah(e){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function hEe(e,t){if(e==null)return{};var r=gEe(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function gEe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function ab(){return ab=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ab.apply(this,arguments)}function XJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ws(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XJ(Object(r),!0).forEach(function(n){oo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sh(e){return vEe(e)||bEe(e)||mEe(e)||yEe()}function yEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mEe(e,t){if(e){if(typeof e=="string")return JN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JN(e,t)}}function bEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vEe(e){if(Array.isArray(e))return JN(e)}function JN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Ee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tG(n.key),n)}}function wEe(e,t,r){return t&&ZJ(e.prototype,t),r&&ZJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GN(e,t)}function GN(e,t){return GN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GN(e,t)}function xEe(e){var t=EEe();return function(){var n=O1(e),i;if(t){var s=O1(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return kEe(this,i)}}function kEe(e,t){if(t&&(ah(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sf(e)}function sf(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function O1(e){return O1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},O1(e)}function oo(e,t,r){return t=tG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tG(e){var t=OEe(e,"string");return ah(t)==="symbol"?t:String(t)}function OEe(e,t){if(ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uc=function(e){SEe(r,e);var t=xEe(r);function r(){var n;_Ee(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=t.call.apply(t,[this].concat(s)),oo(sf(n),"state",{isAnimationFinished:!0,totalLength:0}),oo(sf(n),"getStrokeDasharray",function(o,l,c){for(var f=c.reduce(function(O,A){return O+A}),u=Math.floor(o/f),d=o%f,p=l-o,_=[],w=0,k=0;;k+=c[w],++w)if(k+c[w]>d){_=[].concat(sh(c.slice(0,w)),[d-k]);break}var S=_.length%2===0?[0,p]:[p];return[].concat(sh(r.repeat(c,u)),sh(_),S).map(function(O){return"".concat(O,"px")}).join(", ")}),oo(sf(n),"id",Ga("recharts-line-")),oo(sf(n),"pathRef",function(o){n.mainCurve=o}),oo(sf(n),"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),oo(sf(n),"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return wEe(r,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var i=this.getTotalLength();this.setState({totalLength:i})}}},{key:"getTotalLength",value:function(){var i=this.mainCurve;try{return i&&i.getTotalLength&&i.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(i,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.points,l=a.xAxis,c=a.yAxis,f=a.layout,u=a.children,d=En(u,lc);if(!d)return null;function p(w,k){return{x:w.x,y:w.y,value:w.value,errorVal:Zn(w.payload,k)}}var _={clipPath:i?"url(#clipPath-".concat(s,")"):null};return Li.default.createElement(or,_,d.map(function(w,k){return Li.default.cloneElement(w,{key:"bar-".concat(k),data:o,xAxis:l,yAxis:c,layout:f,dataPointFormatter:p})}))}},{key:"renderDots",value:function(i,s){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var o=this.props,l=o.dot,c=o.points,f=o.dataKey,u=yt(this.props),d=yt(l,!0),p=c.map(function(w,k){var S=ws(ws(ws({key:"dot-".concat(k),r:3},u),d),{},{value:w.value,dataKey:f,cx:w.x,cy:w.y,index:k,payload:w.payload});return r.renderDotItem(l,S)}),_={clipPath:i?"url(#clipPath-".concat(s,")"):null};return Li.default.createElement(or,ab({className:"recharts-line-dots",key:"dots"},_,{role:"img"}),p)}},{key:"renderCurveStatically",value:function(i,s,a,o){var l=this.props,c=l.type,f=l.layout,u=l.connectNulls,d=l.ref,p=hEe(l,pEe),_=ws(ws(ws({},yt(p,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:s?"url(#clipPath-".concat(a,")"):null,points:i},o),{},{type:c,layout:f,connectNulls:u});return Li.default.createElement(Hp,ab({},_,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(i,s){var a=this,o=this.props,l=o.points,c=o.strokeDasharray,f=o.isAnimationActive,u=o.animationBegin,d=o.animationDuration,p=o.animationEasing,_=o.animationId,w=o.animateNewValues,k=o.width,S=o.height,O=this.state,A=O.prevPoints,C=O.totalLength;return Li.default.createElement(Ru,{begin:u,duration:d,isActive:f,easing:p,from:{t:0},to:{t:1},key:"line-".concat(_),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(I){var D=I.t;if(A){var L=A.length/l.length,U=l.map(function(se,pe){var de=Math.floor(pe*L);if(A[de]){var F=A[de],H=ys(F.x,se.x),Q=ys(F.y,se.y);return ws(ws({},se),{},{x:H(D),y:Q(D)})}if(w){var R=ys(k*2,se.x),$=ys(S/2,se.y);return ws(ws({},se),{},{x:R(D),y:$(D)})}return ws(ws({},se),{},{x:se.x,y:se.y})});return a.renderCurveStatically(U,i,s)}var te=ys(0,C),V=te(D),X;if(c){var Z="".concat(c).split(/[,\s]+/gim).map(function(se){return parseFloat(se)});X=a.getStrokeDasharray(V,C,Z)}else X="".concat(V,"px ").concat(C-V,"px");return a.renderCurveStatically(l,i,s,{strokeDasharray:X})})}},{key:"renderCurve",value:function(i,s){var a=this.props,o=a.points,l=a.isAnimationActive,c=this.state,f=c.prevPoints,u=c.totalLength;return l&&o&&o.length&&(!f&&u>0||!(0,QJ.default)(f,o))?this.renderCurveWithAnimation(i,s):this.renderCurveStatically(o,i,s)}},{key:"render",value:function(){var i=this.props,s=i.hide,a=i.dot,o=i.points,l=i.className,c=i.xAxis,f=i.yAxis,u=i.top,d=i.left,p=i.width,_=i.height,w=i.isAnimationActive,k=i.id;if(s||!o||!o.length)return null;var S=this.state.isAnimationFinished,O=o.length===1,A=(0,KN.default)("recharts-line",l),C=c&&c.allowDataOverflow||f&&f.allowDataOverflow,I=(0,E1.default)(k)?this.id:k;return Li.default.createElement(or,{className:A},C?Li.default.createElement("defs",null,Li.default.createElement("clipPath",{id:"clipPath-".concat(I)},Li.default.createElement("rect",{x:d,y:u,width:p,height:_}))):null,!O&&this.renderCurve(C,I),this.renderErrorBar(C,I),(O||a)&&this.renderDots(C,I),(!w||S)&&va.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(i,s){return i.animationId!==s.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,prevPoints:s.curPoints}:i.points!==s.curPoints?{curPoints:i.points}:null}},{key:"repeat",value:function(i,s){for(var a=i.length%2!==0?[].concat(sh(i),[0]):i,o=[],l=0;l<s;++l)o=[].concat(sh(o),sh(a));return o}},{key:"renderDotItem",value:function(i,s){var a;if(Li.default.isValidElement(i))a=Li.default.cloneElement(i,s);else if((0,eG.default)(i))a=i(s);else{var o=(0,KN.default)("recharts-line-dot",i?i.className:"");a=Li.default.createElement(Gp,ab({},s,{className:o}))}return a}}]),r}(Li.PureComponent);oo(uc,"displayName","Line");oo(uc,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Ti.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});oo(uc,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,i=e.xAxisTicks,s=e.yAxisTicks,a=e.dataKey,o=e.bandSize,l=e.displayedData,c=e.offset,f=t.layout,u=l.map(function(d,p){var _=Zn(d,a);return f==="horizontal"?{x:cN({axis:r,ticks:i,bandSize:o,entry:d,index:p}),y:(0,E1.default)(_)?null:n.scale(_),value:_,payload:d}:{x:(0,E1.default)(_)?null:r.scale(_),y:cN({axis:n,ticks:s,bandSize:o,entry:d,index:p}),value:_,payload:d}});return ws({points:u,layout:f},c)});var il=function(){return null};il.displayName="XAxis";il.defaultProps={allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0};var Sa=function(){return null};Sa.displayName="YAxis";Sa.defaultProps={allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1};var TG=ae(LN()),CG=ae(cG()),lo=ae(mn()),IG=ae(HC()),NG=ae(X2()),lh=ae(Eu()),I1=ae(CN()),rn=ae(Rs()),PG=ae(fG()),QN=ae(Yr()),yr=ae(Je()),DG=ae(Kr());function dG(e){return GEe(e)||JEe(e)||WEe(e)||HEe()}function HEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WEe(e,t){if(e){if(typeof e=="string")return YN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YN(e,t)}}function JEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function GEe(e){if(Array.isArray(e))return YN(e)}function YN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var A1=function(t,r,n,i,s){var a=En(t,y1),o=En(t,Qp),l=[].concat(dG(a),dG(o)),c=En(t,eh),f="".concat(i,"Id"),u=i[0],d=r;if(l.length&&(d=l.reduce(function(w,k){if(k.props[f]===n&&Xi(k.props,"extendDomain")&&qe(k.props[u])){var S=k.props[u];return[Math.min(w[0],S),Math.max(w[1],S)]}return w},d)),c.length){var p="".concat(u,"1"),_="".concat(u,"2");d=c.reduce(function(w,k){if(k.props[f]===n&&Xi(k.props,"extendDomain")&&qe(k.props[p])&&qe(k.props[_])){var S=k.props[p],O=k.props[_];return[Math.min(w[0],S,O),Math.max(w[1],S,O)]}return w},d)}return s&&s.length&&(d=s.reduce(function(w,k){return qe(k)?[Math.min(w[0],k),Math.max(w[1],k)]:w},d)),d};var gG=ae(hG()),Qi=new gG.default;Qi.setMaxListeners&&Qi.setMaxListeners(10);var C1="recharts.syncMouseEvents";function lb(e){"@babel/helpers - typeof";return lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lb(e)}function XEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mG(n.key),n)}}function ZEe(e,t,r){return t&&yG(e.prototype,t),r&&yG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZN(e,t,r){return t=mG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mG(e){var t=QEe(e,"string");return lb(t)==="symbol"?t:String(t)}function QEe(e,t){if(lb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bG=function(){function e(){XEe(this,e),ZN(this,"activeIndex",0),ZN(this,"coordinateList",[]),ZN(this,"layout","horizontal")}return ZEe(e,[{key:"setDetails",value:function(r){var n=r.coordinateList,i=n===void 0?[]:n,s=r.container,a=s===void 0?null:s,o=r.layout,l=o===void 0?null:o,c=r.offset,f=c===void 0?null:c,u=r.mouseHandlerCallback,d=u===void 0?null:u;this.coordinateList=i??this.coordinateList,this.container=a??this.container,this.layout=l??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=d??this.mouseHandlerCallback,this.activeIndex>=this.coordinateList.length&&(this.activeIndex=this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}default:break}}},{key:"spoofMouse",value:function(){if(this.layout==="horizontal"){var r=this.container.getBoundingClientRect(),n=r.x,i=r.y,s=this.coordinateList[this.activeIndex].coordinate,a=n+s,o=i+this.offset.top;this.mouseHandlerCallback({pageX:a,pageY:o})}}}]),e}();var eOe=["item"],tOe=["children","className","width","height","style","compact","title","desc"];function ch(e){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function vG(e,t){return iOe(e)||nOe(e,t)||LG(e,t)||rOe()}function rOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function iOe(e){if(Array.isArray(e))return e}function oh(){return oh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oh.apply(this,arguments)}function _G(e,t){if(e==null)return{};var r=sOe(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function sOe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function aOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FG(n.key),n)}}function oOe(e,t,r){return t&&wG(e.prototype,t),r&&wG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e3(e,t)}function e3(e,t){return e3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},e3(e,t)}function cOe(e){var t=fOe();return function(){var n=N1(e),i;if(t){var s=N1(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return uOe(this,i)}}function uOe(e,t){if(t&&(ch(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mt(e)}function Mt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function N1(e){return N1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},N1(e)}function uh(e){return hOe(e)||pOe(e)||LG(e)||dOe()}function dOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LG(e,t){if(e){if(typeof e=="string")return t3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t3(e,t)}}function pOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hOe(e){if(Array.isArray(e))return t3(e)}function t3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Re(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SG(Object(r),!0).forEach(function(n){_t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _t(e,t,r){return t=FG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FG(e){var t=gOe(e,"string");return ch(t)==="symbol"?t:String(t)}function gOe(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yOe={xAxis:["bottom","top"],yAxis:["left","right"]},jG={x:0,y:0},mOe=Number.isFinite?Number.isFinite:isFinite,xG=typeof requestAnimationFrame=="function"?requestAnimationFrame:typeof setImmediate=="function"?setImmediate:setTimeout,kG=typeof cancelAnimationFrame=="function"?cancelAnimationFrame:typeof clearImmediate=="function"?clearImmediate:clearTimeout,bOe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},vOe=function(t,r,n,i){var s=r.find(function(f){return f&&f.index===n});if(s){if(t==="horizontal")return{x:s.coordinate,y:i.y};if(t==="vertical")return{x:i.x,y:s.coordinate};if(t==="centric"){var a=s.coordinate,o=i.radius;return Re(Re(Re({},i),_n(i.cx,i.cy,o,a)),{},{angle:a,radius:o})}var l=s.coordinate,c=i.angle;return Re(Re(Re({},i),_n(i.cx,i.cy,l,c)),{},{angle:c,radius:l})}return jG},P1=function(t,r,n){var i=r.graphicalItems,s=r.dataStartIndex,a=r.dataEndIndex,o=(i||[]).reduce(function(l,c){var f=c.props.data;return f&&f.length?[].concat(uh(l),uh(f)):l},[]);return o&&o.length>0?o:n&&n.props&&n.props.data&&n.props.data.length>0?n.props.data:t&&t.length&&qe(s)&&qe(a)?t.slice(s,a+1):[]};function _Oe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e?.[0],i=e?.[1];if(n&&i&&qe(n)&&qe(i))return!0}return!1}function BG(e){return e==="number"?[0,"auto"]:void 0}var MG=function(t,r,n,i){var s=t.graphicalItems,a=t.tooltipAxis,o=P1(r,t);return n<0||!s||!s.length||n>=o.length?null:s.reduce(function(l,c){var f=c.props.hide;if(f)return l;var u=c.props.data,d;if(a.dataKey&&!a.allowDuplicatedCategory){var p=u===void 0?o:u;d=Hd(p,a.dataKey,i)}else d=u&&u[n]||o[n];return d?[].concat(uh(l),[e1(c,d)]):l},[])},EG=function(t,r,n,i){var s=i||{x:t.chartX,y:t.chartY},a=bOe(s,n),o=t.orderedTooltipTicks,l=t.tooltipAxis,c=t.tooltipTicks,f=zH(a,o,c,l);if(f>=0&&c){var u=c[f]&&c[f].value,d=MG(t,r,f,u),p=vOe(n,o,f,s);return{activeTooltipIndex:f,activeLabel:u,activePayload:d,activeCoordinate:p}}return null},wOe=function(t,r){var n=r.axes,i=r.graphicalItems,s=r.axisType,a=r.axisIdKey,o=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,f=t.layout,u=t.children,d=t.stackOffset,p=oN(f,s),_=n.reduce(function(w,k){var S,O=k.props,A=O.type,C=O.dataKey,I=O.allowDataOverflow,D=O.allowDuplicatedCategory,L=O.scale,U=O.ticks,te=O.includeHidden,V=k.props[a];if(w[V])return w;var X=P1(t.data,{graphicalItems:i.filter(function(oe){return oe.props[a]===V}),dataStartIndex:l,dataEndIndex:c}),Z=X.length,se,pe,de;_Oe(k.props.domain,I,A)&&(se=Qw(k.props.domain,null,I),p&&(A==="number"||L!=="auto")&&(de=zp(X,C,"category")));var F=BG(A);if(!se||se.length===0){var H,Q=(H=k.props.domain)!==null&&H!==void 0?H:F;if(C){if(se=zp(X,C,A),A==="category"&&p){var R=k6(se);D&&R?(pe=se,se=(0,I1.default)(0,Z)):D||(se=dN(Q,se,k).reduce(function(oe,fe){return oe.indexOf(fe)>=0?oe:[].concat(uh(oe),[fe])},[]))}else if(A==="category")D?se=se.filter(function(oe){return oe!==""&&!(0,rn.default)(oe)}):se=dN(Q,se,k).reduce(function(oe,fe){return oe.indexOf(fe)>=0||fe===""||(0,rn.default)(fe)?oe:[].concat(uh(oe),[fe])},[]);else if(A==="number"){var $=JH(X,i.filter(function(oe){return oe.props[a]===V&&(te||!oe.props.hide)}),C,s,f);$&&(se=$)}p&&(A==="number"||L!=="auto")&&(de=zp(X,C,"category"))}else p?se=(0,I1.default)(0,Z):o&&o[V]&&o[V].hasStack&&A==="number"?se=d==="expand"?[0,1]:fN(o[V].stackGroups,l,c):se=aN(X,i.filter(function(oe){return oe.props[a]===V&&(te||!oe.props.hide)}),A,f,!0);if(A==="number")se=A1(u,se,V,s,U),Q&&(se=Qw(Q,se,I));else if(A==="category"&&Q){var q=Q,ie=se.every(function(oe){return q.indexOf(oe)>=0});ie&&(se=q)}}return Re(Re({},w),{},_t({},V,Re(Re({},k.props),{},{axisType:s,domain:se,categoricalDomain:de,duplicateDomain:pe,originalDomain:(S=k.props.domain)!==null&&S!==void 0?S:F,isCategorical:p,layout:f})))},{});return _},SOe=function(t,r){var n=r.graphicalItems,i=r.Axis,s=r.axisType,a=r.axisIdKey,o=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,f=t.layout,u=t.children,d=P1(t.data,{graphicalItems:n,dataStartIndex:l,dataEndIndex:c}),p=d.length,_=oN(f,s),w=-1,k=n.reduce(function(S,O){var A=O.props[a],C=BG("number");if(!S[A]){w++;var I;return _?I=(0,I1.default)(0,p):o&&o[A]&&o[A].hasStack?(I=fN(o[A].stackGroups,l,c),I=A1(u,I,A,s)):(I=Qw(C,aN(d,n.filter(function(D){return D.props[a]===A&&!D.props.hide}),"number",f),i.defaultProps.allowDataOverflow),I=A1(u,I,A,s)),Re(Re({},S),{},_t({},A,Re(Re({axisType:s},i.defaultProps),{},{hide:!0,orientation:(0,lh.default)(yOe,"".concat(s,".").concat(w%2),null),domain:I,originalDomain:C,isCategorical:_,layout:f})))}return S},{});return k},xOe=function(t,r){var n=r.axisType,i=n===void 0?"xAxis":n,s=r.AxisComp,a=r.graphicalItems,o=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,f=t.children,u="".concat(i,"Id"),d=En(f,s),p={};return d&&d.length?p=wOe(t,{axes:d,graphicalItems:a,axisType:i,axisIdKey:u,stackGroups:o,dataStartIndex:l,dataEndIndex:c}):a&&a.length&&(p=SOe(t,{Axis:s,graphicalItems:a,axisType:i,axisIdKey:u,stackGroups:o,dataStartIndex:l,dataEndIndex:c})),p},kOe=function(t){var r=Vo(t),n=rl(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:(0,NG.default)(n,function(i){return i.coordinate}),tooltipAxis:r,tooltipAxisBandSize:qp(r,n)}},OG=function(t){var r,n,i=t.children,s=t.defaultShowTooltip,a=$s(i,Yp),o=a&&a.props&&a.props.startIndex||0,l=(a==null||(r=a.props)===null||r===void 0?void 0:r.endIndex)!==void 0?a==null||(n=a.props)===null||n===void 0?void 0:n.endIndex:t.data&&t.data.length-1||0;return{chartX:0,chartY:0,dataStartIndex:o,dataEndIndex:l,activeTooltipIndex:-1,isTooltipActive:(0,rn.default)(s)?!1:s}},EOe=function(t){return!t||!t.length?!1:t.some(function(r){var n=Ya(r&&r.type);return n&&n.indexOf("Bar")>=0})},AG=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},OOe=function(t,r){var n=t.props,i=t.graphicalItems,s=t.xAxisMap,a=s===void 0?{}:s,o=t.yAxisMap,l=o===void 0?{}:o,c=n.width,f=n.height,u=n.children,d=n.margin||{},p=$s(u,Yp),_=$s(u,Fu),w=Object.keys(l).reduce(function(A,C){var I=l[C],D=I.orientation;return!I.mirror&&!I.hide?Re(Re({},A),{},_t({},D,A[D]+I.width)):A},{left:d.left||0,right:d.right||0}),k=Object.keys(a).reduce(function(A,C){var I=a[C],D=I.orientation;return!I.mirror&&!I.hide?Re(Re({},A),{},_t({},D,(0,lh.default)(A,"".concat(D))+I.height)):A},{top:d.top||0,bottom:d.bottom||0}),S=Re(Re({},k),w),O=S.bottom;return p&&(S.bottom+=p.props.height||Yp.defaultProps.height),_&&r&&(S=HH(S,i,n,r)),Re(Re({brushBottom:O},S),{},{width:c-S.left-S.right,height:f-S.top-S.bottom})},L1=function(t){var r,n=t.chartName,i=t.GraphicalChild,s=t.defaultTooltipEventType,a=s===void 0?"axis":s,o=t.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=t.axisComponents,f=t.legendContent,u=t.formatAxisMap,d=t.defaultProps,p=function(k,S){var O=S.graphicalItems,A=S.stackGroups,C=S.offset,I=S.updateId,D=S.dataStartIndex,L=S.dataEndIndex,U=k.barSize,te=k.layout,V=k.barGap,X=k.barCategoryGap,Z=k.maxBarSize,se=AG(te),pe=se.numericAxisName,de=se.cateAxisName,F=EOe(O),H=F&&qH({barSize:U,stackGroups:A}),Q=[];return O.forEach(function(R,$){var q=P1(k.data,{dataStartIndex:D,dataEndIndex:L},R),ie=R.props,oe=ie.dataKey,fe=ie.maxBarSize,_e=R.props["".concat(pe,"Id")],Ee=R.props["".concat(de,"Id")],Se=c.reduce(function(pt,ee){var j,B=S["".concat(ee.axisType,"Map")],re=R.props["".concat(ee.axisType,"Id")],ke=B&&B[re];return Re(Re({},pt),{},(j={},_t(j,ee.axisType,ke),_t(j,"".concat(ee.axisType,"Ticks"),rl(ke)),j))},{}),le=Se[de],we=Se["".concat(de,"Ticks")],W=A&&A[_e]&&A[_e].hasStack&&tW(R,A[_e].stackGroups),J=Ya(R.type).indexOf("Bar")>=0,ne=qp(le,we),Oe=[];if(J){var Ne,Ce,Xe=(0,rn.default)(fe)?Z:fe,Ze=(Ne=(Ce=qp(le,we,!0))!==null&&Ce!==void 0?Ce:Xe)!==null&&Ne!==void 0?Ne:0;Oe=VH({barGap:V,barCategoryGap:X,bandSize:Ze!==ne?Ze:ne,sizeList:H[Ee],maxBarSize:Xe}),Ze!==ne&&(Oe=Oe.map(function(pt){return Re(Re({},pt),{},{position:Re(Re({},pt.position),{},{offset:pt.position.offset-Ze/2})})}))}var kt=R&&R.type&&R.type.getComposedData;if(kt){var St;Q.push({props:Re(Re({},kt(Re(Re({},Se),{},{displayedData:q,props:k,dataKey:oe,item:R,bandSize:ne,barPosition:Oe,offset:C,stackedData:W,layout:te,dataStartIndex:D,dataEndIndex:L}))),{},(St={key:R.key||"item-".concat($)},_t(St,pe,Se[pe]),_t(St,de,Se[de]),_t(St,"animationId",I),St)),childIndex:B6(R,k.children),item:R})}}),Q},_=function(k,S){var O=k.props,A=k.dataStartIndex,C=k.dataEndIndex,I=k.updateId;if(!UA({props:O}))return null;var D=O.children,L=O.layout,U=O.stackOffset,te=O.data,V=O.reverseStackOrder,X=AG(L),Z=X.numericAxisName,se=X.cateAxisName,pe=En(D,i),de=ZH(te,pe,"".concat(Z,"Id"),"".concat(se,"Id"),U,V),F=c.reduce(function(q,ie){var oe="".concat(ie.axisType,"Map");return Re(Re({},q),{},_t({},oe,xOe(O,Re(Re({},ie),{},{graphicalItems:pe,stackGroups:ie.axisType===Z&&de,dataStartIndex:A,dataEndIndex:C}))))},{}),H=OOe(Re(Re({},F),{},{props:O,graphicalItems:pe}),S?.legendBBox);Object.keys(F).forEach(function(q){F[q]=u(O,F[q],H,q.replace("Map",""),n)});var Q=F["".concat(se,"Map")],R=kOe(Q),$=p(O,Re(Re({},F),{},{dataStartIndex:A,dataEndIndex:C,updateId:I,graphicalItems:pe,stackGroups:de,offset:H}));return Re(Re({formattedGraphicalItems:$,graphicalItems:pe,offset:H,stackGroups:de},R),F)};return r=function(w){lOe(S,w);var k=cOe(S);function S(O){var A;return aOe(this,S),A=k.call(this,O),_t(Mt(A),"accessibilityManager",new bG),_t(Mt(A),"clearDeferId",function(){!(0,rn.default)(A.deferId)&&kG&&kG(A.deferId),A.deferId=null}),_t(Mt(A),"handleLegendBBoxUpdate",function(C){if(C){var I=A.state,D=I.dataStartIndex,L=I.dataEndIndex,U=I.updateId;A.setState(Re({legendBBox:C},_({props:A.props,dataStartIndex:D,dataEndIndex:L,updateId:U},Re(Re({},A.state),{},{legendBBox:C}))))}}),_t(Mt(A),"handleReceiveSyncEvent",function(C,I,D){var L=A.props.syncId;L===C&&I!==A.uniqueChartId&&(A.clearDeferId(),A.deferId=xG&&xG(A.applySyncEvent.bind(Mt(A),D)))}),_t(Mt(A),"handleBrushChange",function(C){var I=C.startIndex,D=C.endIndex;if(I!==A.state.dataStartIndex||D!==A.state.dataEndIndex){var L=A.state.updateId;A.setState(function(){return Re({dataStartIndex:I,dataEndIndex:D},_({props:A.props,dataStartIndex:I,dataEndIndex:D,updateId:L},A.state))}),A.triggerSyncEvent({dataStartIndex:I,dataEndIndex:D})}}),_t(Mt(A),"handleMouseEnter",function(C){var I=A.props.onMouseEnter,D=A.getMouseInfo(C);if(D){var L=Re(Re({},D),{},{isTooltipActive:!0});A.setState(L),A.triggerSyncEvent(L),(0,lo.default)(I)&&I(L,C)}}),_t(Mt(A),"triggeredAfterMouseMove",function(C){var I=A.props.onMouseMove,D=A.getMouseInfo(C),L=D?Re(Re({},D),{},{isTooltipActive:!0}):{isTooltipActive:!1};A.setState(L),A.triggerSyncEvent(L),(0,lo.default)(I)&&I(L,C)}),_t(Mt(A),"handleItemMouseEnter",function(C){A.setState(function(){return{isTooltipActive:!0,activeItem:C,activePayload:C.tooltipPayload,activeCoordinate:C.tooltipPosition||{x:C.cx,y:C.cy}}})}),_t(Mt(A),"handleItemMouseLeave",function(){A.setState(function(){return{isTooltipActive:!1}})}),_t(Mt(A),"handleMouseMove",function(C){C&&(0,lo.default)(C.persist)&&C.persist(),A.triggeredAfterMouseMove(C)}),_t(Mt(A),"handleMouseLeave",function(C){var I=A.props.onMouseLeave,D={isTooltipActive:!1};A.setState(D),A.triggerSyncEvent(D),(0,lo.default)(I)&&I(D,C),A.cancelThrottledTriggerAfterMouseMove()}),_t(Mt(A),"handleOuterEvent",function(C){var I=j6(C),D=(0,lh.default)(A.props,"".concat(I));if(I&&(0,lo.default)(D)){var L;/.*touch.*/i.test(I)?L=A.getMouseInfo(C.changedTouches[0]):L=A.getMouseInfo(C);var U=D;U(L,C)}}),_t(Mt(A),"handleClick",function(C){var I=A.props.onClick,D=A.getMouseInfo(C);if(D){var L=Re(Re({},D),{},{isTooltipActive:!0});A.setState(L),A.triggerSyncEvent(L),(0,lo.default)(I)&&I(L,C)}}),_t(Mt(A),"handleMouseDown",function(C){var I=A.props.onMouseDown;if((0,lo.default)(I)){var D=A.getMouseInfo(C);I(D,C)}}),_t(Mt(A),"handleMouseUp",function(C){var I=A.props.onMouseUp;if((0,lo.default)(I)){var D=A.getMouseInfo(C);I(D,C)}}),_t(Mt(A),"handleTouchMove",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&A.handleMouseMove(C.changedTouches[0])}),_t(Mt(A),"handleTouchStart",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&A.handleMouseDown(C.changedTouches[0])}),_t(Mt(A),"handleTouchEnd",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&A.handleMouseUp(C.changedTouches[0])}),_t(Mt(A),"verticalCoordinatesGenerator",function(C){var I=C.xAxis,D=C.width,L=C.height,U=C.offset;return lN(ib(Re(Re(Re({},nh.defaultProps),I),{},{ticks:rl(I,!0),viewBox:{x:0,y:0,width:D,height:L}})),U.left,U.left+U.width)}),_t(Mt(A),"horizontalCoordinatesGenerator",function(C){var I=C.yAxis,D=C.width,L=C.height,U=C.offset;return lN(ib(Re(Re(Re({},nh.defaultProps),I),{},{ticks:rl(I,!0),viewBox:{x:0,y:0,width:D,height:L}})),U.top,U.top+U.height)}),_t(Mt(A),"axesTicksGenerator",function(C){return rl(C,!0)}),_t(Mt(A),"renderCursor",function(C){var I=A.state,D=I.isTooltipActive,L=I.activeCoordinate,U=I.activePayload,te=I.offset,V=I.activeTooltipIndex,X=A.getTooltipEventType();if(!C||!C.props.cursor||!D||!L||n!=="ScatterChart"&&X!=="axis")return null;var Z=A.props.layout,se,pe=Hp;if(n==="ScatterChart")se=L,pe=ON;else if(n==="BarChart")se=A.getCursorRectangle(),pe=nf;else if(Z==="radial"){var de=A.getCursorPoints(),F=de.cx,H=de.cy,Q=de.radius,R=de.startAngle,$=de.endAngle;se={cx:F,cy:H,startAngle:R,endAngle:$,innerRadius:Q,outerRadius:Q},pe=_N}else se={points:A.getCursorPoints()},pe=Hp;var q=C.key||"_recharts-cursor",ie=Re(Re(Re(Re({stroke:"#ccc",pointerEvents:"none"},te),se),yt(C.props.cursor)),{},{payload:U,payloadIndex:V,key:q,className:"recharts-tooltip-cursor"});return(0,yr.isValidElement)(C.props.cursor)?(0,yr.cloneElement)(C.props.cursor,ie):(0,yr.createElement)(pe,ie)}),_t(Mt(A),"renderPolarAxis",function(C,I,D){var L=(0,lh.default)(C,"type.axisType"),U=(0,lh.default)(A.state,"".concat(L,"Map")),te=U&&U[C.props["".concat(L,"Id")]];return(0,yr.cloneElement)(C,Re(Re({},te),{},{className:L,key:C.key||"".concat(I,"-").concat(D),ticks:rl(te,!0)}))}),_t(Mt(A),"renderXAxis",function(C,I,D){var L=A.state.xAxisMap,U=L[C.props.xAxisId];return A.renderAxis(U,C,I,D)}),_t(Mt(A),"renderYAxis",function(C,I,D){var L=A.state.yAxisMap,U=L[C.props.yAxisId];return A.renderAxis(U,C,I,D)}),_t(Mt(A),"renderGrid",function(C){var I=A.state,D=I.xAxisMap,L=I.yAxisMap,U=I.offset,te=A.props,V=te.width,X=te.height,Z=Vo(D),se=(0,CG.default)(L,function(F){return(0,TG.default)(F.domain,mOe)}),pe=se||Vo(L),de=C.props||{};return(0,yr.cloneElement)(C,{key:C.key||"grid",x:qe(de.x)?de.x:U.left,y:qe(de.y)?de.y:U.top,width:qe(de.width)?de.width:U.width,height:qe(de.height)?de.height:U.height,xAxis:Z,yAxis:pe,offset:U,chartWidth:V,chartHeight:X,verticalCoordinatesGenerator:de.verticalCoordinatesGenerator||A.verticalCoordinatesGenerator,horizontalCoordinatesGenerator:de.horizontalCoordinatesGenerator||A.horizontalCoordinatesGenerator})}),_t(Mt(A),"renderPolarGrid",function(C){var I=C.props,D=I.radialLines,L=I.polarAngles,U=I.polarRadius,te=A.state,V=te.radiusAxisMap,X=te.angleAxisMap,Z=Vo(V),se=Vo(X),pe=se.cx,de=se.cy,F=se.innerRadius,H=se.outerRadius;return(0,yr.cloneElement)(C,{polarAngles:(0,QN.default)(L)?L:rl(se,!0).map(function(Q){return Q.coordinate}),polarRadius:(0,QN.default)(U)?U:rl(Z,!0).map(function(Q){return Q.coordinate}),cx:pe,cy:de,innerRadius:F,outerRadius:H,key:C.key||"polar-grid",radialLines:D})}),_t(Mt(A),"renderLegend",function(){var C=A.state.formattedGraphicalItems,I=A.props,D=I.children,L=I.width,U=I.height,te=A.props.margin||{},V=L-(te.left||0)-(te.right||0),X=sN({children:D,formattedGraphicalItems:C,legendWidth:V,legendContent:f});if(!X)return null;var Z=X.item,se=_G(X,eOe);return(0,yr.cloneElement)(Z,Re(Re({},se),{},{chartWidth:L,chartHeight:U,margin:te,ref:function(de){A.legendInstance=de},onBBoxUpdate:A.handleLegendBBoxUpdate}))}),_t(Mt(A),"renderTooltip",function(){var C=A.props.children,I=$s(C,$u);if(!I)return null;var D=A.state,L=D.isTooltipActive,U=D.activeCoordinate,te=D.activePayload,V=D.activeLabel,X=D.offset;return(0,yr.cloneElement)(I,{viewBox:Re(Re({},X),{},{x:X.left,y:X.top}),active:L,label:V,payload:L?te:[],coordinate:U})}),_t(Mt(A),"renderBrush",function(C){var I=A.props,D=I.margin,L=I.data,U=A.state,te=U.offset,V=U.dataStartIndex,X=U.dataEndIndex,Z=U.updateId;return(0,yr.cloneElement)(C,{key:C.key||"_recharts-brush",onChange:Bm(A.handleBrushChange,null,C.props.onChange),data:L,x:qe(C.props.x)?C.props.x:te.left,y:qe(C.props.y)?C.props.y:te.top+te.height+te.brushBottom-(D.bottom||0),width:qe(C.props.width)?C.props.width:te.width,startIndex:V,endIndex:X,updateId:"brush-".concat(Z)})}),_t(Mt(A),"renderReferenceElement",function(C,I,D){if(!C)return null;var L=Mt(A),U=L.clipPathId,te=A.state,V=te.xAxisMap,X=te.yAxisMap,Z=te.offset,se=C.props,pe=se.xAxisId,de=se.yAxisId;return(0,yr.cloneElement)(C,{key:C.key||"".concat(I,"-").concat(D),xAxis:V[pe],yAxis:X[de],viewBox:{x:Z.left,y:Z.top,width:Z.width,height:Z.height},clipPathId:U})}),_t(Mt(A),"renderActivePoints",function(C){var I=C.item,D=C.activePoint,L=C.basePoint,U=C.childIndex,te=C.isRange,V=[],X=I.props.key,Z=I.item.props,se=Z.activeDot,pe=Z.dataKey,de=Re(Re({index:U,dataKey:pe,cx:D.x,cy:D.y,r:4,fill:Zw(I.item),strokeWidth:2,stroke:"#fff",payload:D.payload,value:D.value,key:"".concat(X,"-activePoint-").concat(U)},yt(se)),Ou(se));return V.push(S.renderActiveDot(se,de)),L?V.push(S.renderActiveDot(se,Re(Re({},de),{},{cx:L.x,cy:L.y,key:"".concat(X,"-basePoint-").concat(U)}))):te&&V.push(null),V}),_t(Mt(A),"renderGraphicChild",function(C,I,D){var L=A.filterFormatItem(C,I,D);if(!L)return null;var U=A.getTooltipEventType(),te=A.state,V=te.isTooltipActive,X=te.tooltipAxis,Z=te.activeTooltipIndex,se=te.activeLabel,pe=A.props.children,de=$s(pe,$u),F=L.props,H=F.points,Q=F.isRange,R=F.baseLine,$=L.item.props,q=$.activeDot,ie=$.hide,oe=!ie&&V&&de&&q&&Z>=0,fe={};U!=="axis"&&de&&de.props.trigger==="click"?fe={onClick:Bm(A.handleItemMouseEnter,null,C.props.onCLick)}:U!=="axis"&&(fe={onMouseLeave:Bm(A.handleItemMouseLeave,null,C.props.onMouseLeave),onMouseEnter:Bm(A.handleItemMouseEnter,null,C.props.onMouseEnter)});var _e=(0,yr.cloneElement)(C,Re(Re({},L.props),fe));function Ee(W){return typeof X.dataKey=="function"?X.dataKey(W.payload):null}if(oe){var Se,le;if(X.dataKey&&!X.allowDuplicatedCategory){var we=typeof X.dataKey=="function"?Ee:"payload.".concat(X.dataKey.toString());Se=Hd(H,we,se),le=Q&&R&&Hd(R,we,se)}else Se=H[Z],le=Q&&R&&R[Z];if(!(0,rn.default)(Se))return[_e].concat(uh(A.renderActivePoints({item:L,activePoint:Se,basePoint:le,childIndex:Z,isRange:Q})))}return Q?[_e,null,null]:[_e,null]}),_t(Mt(A),"renderCustomized",function(C,I,D){return(0,yr.cloneElement)(C,Re(Re({key:"recharts-customized-".concat(D)},A.props),A.state))}),A.uniqueChartId=(0,rn.default)(O.id)?Ga("recharts"):O.id,A.clipPathId="".concat(A.uniqueChartId,"-clip"),O.throttleDelay&&(A.triggeredAfterMouseMove=(0,IG.default)(A.triggeredAfterMouseMove,O.throttleDelay)),A.state={},A}return oOe(S,[{key:"componentDidMount",value:function(){var A,C;(0,rn.default)(this.props.syncId)||this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(A=this.props.margin.left)!==null&&A!==void 0?A:0,top:(C=this.props.margin.top)!==null&&C!==void 0?C:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.handleMouseMove,layout:this.props.layout})}},{key:"getSnapshotBeforeUpdate",value:function(A,C){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==C.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==A.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==A.margin){var I,D;this.accessibilityManager.setDetails({offset:{left:(I=this.props.margin.left)!==null&&I!==void 0?I:0,top:(D=this.props.margin.top)!==null&&D!==void 0?D:0}})}return null}},{key:"componentDidUpdate",value:function(A){(0,rn.default)(A.syncId)&&!(0,rn.default)(this.props.syncId)&&this.addListener(),!(0,rn.default)(A.syncId)&&(0,rn.default)(this.props.syncId)&&this.removeListener()}},{key:"componentWillUnmount",value:function(){this.clearDeferId(),(0,rn.default)(this.props.syncId)||this.removeListener(),this.cancelThrottledTriggerAfterMouseMove()}},{key:"cancelThrottledTriggerAfterMouseMove",value:function(){typeof this.triggeredAfterMouseMove.cancel=="function"&&this.triggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var A=$s(this.props.children,$u);if(A&&(0,PG.default)(A.props.shared)){var C=A.props.shared?"axis":"item";return l.indexOf(C)>=0?C:a}return a}},{key:"getMouseInfo",value:function(A){if(!this.container)return null;var C=F7(this.container),I=D7(A,C),D=this.inRange(I.chartX,I.chartY);if(!D)return null;var L=this.state,U=L.xAxisMap,te=L.yAxisMap,V=this.getTooltipEventType();if(V!=="axis"&&U&&te){var X=Vo(U).scale,Z=Vo(te).scale,se=X&&X.invert?X.invert(I.chartX):null,pe=Z&&Z.invert?Z.invert(I.chartY):null;return Re(Re({},I),{},{xValue:se,yValue:pe})}var de=EG(this.state,this.props.data,this.props.layout,D);return de?Re(Re({},I),de):null}},{key:"getCursorRectangle",value:function(){var A=this.props.layout,C=this.state,I=C.activeCoordinate,D=C.offset,L=C.tooltipAxisBandSize,U=L/2;return{stroke:"none",fill:"#ccc",x:A==="horizontal"?I.x-U:D.left+.5,y:A==="horizontal"?D.top+.5:I.y-U,width:A==="horizontal"?L:D.width-1,height:A==="horizontal"?D.height-1:L}}},{key:"getCursorPoints",value:function(){var A=this.props.layout,C=this.state,I=C.activeCoordinate,D=C.offset,L,U,te,V;if(A==="horizontal")L=I.x,te=L,U=D.top,V=D.top+D.height;else if(A==="vertical")U=I.y,V=U,L=D.left,te=D.left+D.width;else if(!(0,rn.default)(I.cx)||!(0,rn.default)(I.cy))if(A==="centric"){var X=I.cx,Z=I.cy,se=I.innerRadius,pe=I.outerRadius,de=I.angle,F=_n(X,Z,se,de),H=_n(X,Z,pe,de);L=F.x,U=F.y,te=H.x,V=H.y}else{var Q=I.cx,R=I.cy,$=I.radius,q=I.startAngle,ie=I.endAngle,oe=_n(Q,R,$,q),fe=_n(Q,R,$,ie);return{points:[oe,fe],cx:Q,cy:R,radius:$,startAngle:q,endAngle:ie}}return[{x:L,y:U},{x:te,y:V}]}},{key:"inRange",value:function(A,C){var I=this.props.layout;if(I==="horizontal"||I==="vertical"){var D=this.state.offset,L=A>=D.left&&A<=D.left+D.width&&C>=D.top&&C<=D.top+D.height;return L?{x:A,y:C}:null}var U=this.state,te=U.angleAxisMap,V=U.radiusAxisMap;if(te&&V){var X=Vo(te);return pN({x:A,y:C},X)}return null}},{key:"parseEventsOfWrapper",value:function(){var A=this.props.children,C=this.getTooltipEventType(),I=$s(A,$u),D={};I&&C==="axis"&&(I.props.trigger==="click"?D={onClick:this.handleClick}:D={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var L=Ou(this.props,this.handleOuterEvent);return Re(Re({},L),D)}},{key:"addListener",value:function(){Qi.on(C1,this.handleReceiveSyncEvent),Qi.setMaxListeners&&Qi._maxListeners&&Qi.setMaxListeners(Qi._maxListeners+1)}},{key:"removeListener",value:function(){Qi.removeListener(C1,this.handleReceiveSyncEvent),Qi.setMaxListeners&&Qi._maxListeners&&Qi.setMaxListeners(Qi._maxListeners-1)}},{key:"triggerSyncEvent",value:function(A){var C=this.props.syncId;(0,rn.default)(C)||Qi.emit(C1,C,this.uniqueChartId,A)}},{key:"applySyncEvent",value:function(A){var C=this.props,I=C.layout,D=C.syncMethod,L=this.state.updateId,U=A.dataStartIndex,te=A.dataEndIndex;if(!(0,rn.default)(A.dataStartIndex)||!(0,rn.default)(A.dataEndIndex))this.setState(Re({dataStartIndex:U,dataEndIndex:te},_({props:this.props,dataStartIndex:U,dataEndIndex:te,updateId:L},this.state)));else if((0,rn.default)(A.activeTooltipIndex))this.setState(A);else{var V=A.chartX,X=A.chartY,Z=A.activeTooltipIndex,se=this.state,pe=se.offset,de=se.tooltipTicks;if(!pe)return;if(typeof D=="function")Z=D(de,A);else if(D==="value"){Z=-1;for(var F=0;F<de.length;F++)if(de[F].value===A.activeLabel){Z=F;break}}var H=Re(Re({},pe),{},{x:pe.left,y:pe.top}),Q=Math.min(V,H.x+H.width),R=Math.min(X,H.y+H.height),$=de[Z]&&de[Z].value,q=MG(this.state,this.props.data,Z),ie=de[Z]?{x:I==="horizontal"?de[Z].coordinate:Q,y:I==="horizontal"?R:de[Z].coordinate}:jG;this.setState(Re(Re({},A),{},{activeLabel:$,activeCoordinate:ie,activePayload:q,activeTooltipIndex:Z}))}}},{key:"filterFormatItem",value:function(A,C,I){for(var D=this.state.formattedGraphicalItems,L=0,U=D.length;L<U;L++){var te=D[L];if(te.item===A||te.props.key===A.key||C===Ya(te.item.type)&&I===te.childIndex)return te}return null}},{key:"renderAxis",value:function(A,C,I,D){var L=this.props,U=L.width,te=L.height;return yr.default.createElement(nh,oh({},A,{className:"recharts-".concat(A.axisType," ").concat(A.axisType),key:C.key||"".concat(I,"-").concat(D),viewBox:{x:0,y:0,width:U,height:te},ticksGenerator:this.axesTicksGenerator}))}},{key:"renderClipPath",value:function(){var A=this.clipPathId,C=this.state.offset,I=C.left,D=C.top,L=C.height,U=C.width;return yr.default.createElement("defs",null,yr.default.createElement("clipPath",{id:A},yr.default.createElement("rect",{x:I,y:D,height:L,width:U})))}},{key:"getXScales",value:function(){var A=this.state.xAxisMap;return A?Object.entries(A).reduce(function(C,I){var D=vG(I,2),L=D[0],U=D[1];return Re(Re({},C),{},_t({},L,U.scale))},{}):null}},{key:"getYScales",value:function(){var A=this.state.yAxisMap;return A?Object.entries(A).reduce(function(C,I){var D=vG(I,2),L=D[0],U=D[1];return Re(Re({},C),{},_t({},L,U.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(A){var C,I;return(C=this.state.xAxisMap)===null||C===void 0||(I=C[A])===null||I===void 0?void 0:I.scale}},{key:"getYScaleByAxisId",value:function(A){var C,I;return(C=this.state.yAxisMap)===null||C===void 0||(I=C[A])===null||I===void 0?void 0:I.scale}},{key:"getItemByXY",value:function(A){var C=this.state.formattedGraphicalItems;if(C&&C.length)for(var I=0,D=C.length;I<D;I++){var L=C[I],U=L.props,te=L.item,V=Ya(te.type);if(V==="Bar"){var X=(U.data||[]).find(function(se){return PW(A,se)});if(X)return{graphicalItem:L,payload:X}}else if(V==="RadialBar"){var Z=(U.data||[]).find(function(se){return pN(A,se)});if(Z)return{graphicalItem:L,payload:Z}}}return null}},{key:"render",value:function(){var A=this;if(!UA(this))return null;var C=this.props,I=C.children,D=C.className,L=C.width,U=C.height,te=C.style,V=C.compact,X=C.title,Z=C.desc,se=_G(C,tOe),pe=yt(se),de={CartesianGrid:{handler:this.renderGrid,once:!0},ReferenceArea:{handler:this.renderReferenceElement},ReferenceLine:{handler:this.renderReferenceElement},ReferenceDot:{handler:this.renderReferenceElement},XAxis:{handler:this.renderXAxis},YAxis:{handler:this.renderYAxis},Brush:{handler:this.renderBrush,once:!0},Bar:{handler:this.renderGraphicChild},Line:{handler:this.renderGraphicChild},Area:{handler:this.renderGraphicChild},Radar:{handler:this.renderGraphicChild},RadialBar:{handler:this.renderGraphicChild},Scatter:{handler:this.renderGraphicChild},Pie:{handler:this.renderGraphicChild},Funnel:{handler:this.renderGraphicChild},Tooltip:{handler:this.renderCursor,once:!0},PolarGrid:{handler:this.renderPolarGrid,once:!0},PolarAngleAxis:{handler:this.renderPolarAxis},PolarRadiusAxis:{handler:this.renderPolarAxis},Customized:{handler:this.renderCustomized}};if(V)return yr.default.createElement(By,oh({},pe,{width:L,height:U,title:X,desc:Z}),this.renderClipPath(),qA(I,de));if(this.props.accessibilityLayer){var F,H;pe.tabIndex=(F=0)!==null&&F!==void 0?F:this.props.tabIndex,pe.role=(H="img")!==null&&H!==void 0?H:this.props.role,pe.onKeyDown=function(R){A.accessibilityManager.keyboardEvent(R)},pe.onFocus=function(){A.accessibilityManager.focus()}}var Q=this.parseEventsOfWrapper();return yr.default.createElement("div",oh({className:(0,DG.default)("recharts-wrapper",D),style:Re({position:"relative",cursor:"default",width:L,height:U},te)},Q,{ref:function($){A.container=$},role:"region"}),yr.default.createElement(By,oh({},pe,{width:L,height:U,title:X,desc:Z}),this.renderClipPath(),qA(I,de)),this.renderLegend(),this.renderTooltip())}}]),S}(yr.Component),_t(r,"displayName",n),_t(r,"defaultProps",Re({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),_t(r,"getDerivedStateFromProps",function(w,k){var S=w.data,O=w.children,A=w.width,C=w.height,I=w.layout,D=w.stackOffset,L=w.margin;if((0,rn.default)(k.updateId)){var U=OG(w);return Re(Re(Re({},U),{},{updateId:0},_(Re(Re({props:w},U),{},{updateId:0}),k)),{},{prevData:S,prevWidth:A,prevHeight:C,prevLayout:I,prevStackOffset:D,prevMargin:L,prevChildren:O})}if(S!==k.prevData||A!==k.prevWidth||C!==k.prevHeight||I!==k.prevLayout||D!==k.prevStackOffset||!Ho(L,k.prevMargin)){var te=OG(w),V={chartX:k.chartX,chartY:k.chartY,isTooltipActive:k.isTooltipActive},X=Re(Re({},EG(k,S,I)),{},{updateId:k.updateId+1}),Z=Re(Re(Re({},te),V),X);return Re(Re(Re({},Z),_(Re({props:w},Z),k)),{},{prevData:S,prevWidth:A,prevHeight:C,prevLayout:I,prevStackOffset:D,prevMargin:L,prevChildren:O})}if(!zA(O,k.prevChildren)){var se=!(0,rn.default)(S),pe=se?k.updateId:k.updateId+1;return Re(Re({updateId:pe},_(Re(Re({props:w},k),{},{updateId:pe}),k)),{},{prevChildren:O})}return null}),_t(r,"renderActiveDot",function(w,k){var S;return(0,yr.isValidElement)(w)?S=(0,yr.cloneElement)(w,k):(0,lo.default)(w)?S=w(k):S=yr.default.createElement(Gp,k),yr.default.createElement(or,{className:"recharts-active-dot",key:k.key},S)}),r};var r3=L1({chartName:"LineChart",GraphicalChild:uc,axisComponents:[{axisType:"xAxis",AxisComp:il},{axisType:"yAxis",AxisComp:Sa}],formatAxisMap:g1});var n3=L1({chartName:"BarChart",GraphicalChild:ao,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:il},{axisType:"yAxis",AxisComp:Sa}],formatAxisMap:g1});var fc=ae(vt(),1),AOe=[{name:"Jan",total:Math.floor(Math.random()*5e3)+1e3},{name:"Feb",total:Math.floor(Math.random()*5e3)+1e3},{name:"Mar",total:Math.floor(Math.random()*5e3)+1e3},{name:"Apr",total:Math.floor(Math.random()*5e3)+1e3},{name:"May",total:Math.floor(Math.random()*5e3)+1e3},{name:"Jun",total:Math.floor(Math.random()*5e3)+1e3},{name:"Jul",total:Math.floor(Math.random()*5e3)+1e3},{name:"Aug",total:Math.floor(Math.random()*5e3)+1e3},{name:"Sep",total:Math.floor(Math.random()*5e3)+1e3},{name:"Oct",total:Math.floor(Math.random()*5e3)+1e3},{name:"Nov",total:Math.floor(Math.random()*5e3)+1e3},{name:"Dec",total:Math.floor(Math.random()*5e3)+1e3}];function RG({toPlot:e=AOe}){return(0,fc.jsx)(GC,{width:"100%",height:350,children:(0,fc.jsxs)(n3,{data:e,children:[(0,fc.jsx)(il,{dataKey:"name",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,fc.jsx)(Sa,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:t=>t,domain:[-1,1]}),(0,fc.jsx)(ao,{dataKey:"total",children:e.map((t,r)=>(0,fc.jsx)(kp,{fill:t.total<0?"#FF886D":"#adfa1d",strokeWidth:r===2?4:1},`cell-${r}`))})]})})}var F1=ae(Je(),1);var pi=ae(Je(),1);var $G="Avatar",[TOe,qHe]=oi($G),[COe,UG]=TOe($G),IOe=(0,pi.forwardRef)((e,t)=>{let{__scopeAvatar:r,...n}=e,[i,s]=(0,pi.useState)("idle");return(0,pi.createElement)(COe,{scope:r,imageLoadingStatus:i,onImageLoadingStatusChange:s},(0,pi.createElement)(Tt.span,Ye({},n,{ref:t})))}),NOe="AvatarImage",POe=(0,pi.forwardRef)((e,t)=>{let{__scopeAvatar:r,src:n,onLoadingStatusChange:i=()=>{},...s}=e,a=UG(NOe,r),o=DOe(n),l=cn(c=>{i(c),a.onImageLoadingStatusChange(c)});return Nn(()=>{o!=="idle"&&l(o)},[o,l]),o==="loaded"?(0,pi.createElement)(Tt.img,Ye({},s,{ref:t,src:n})):null}),LOe="AvatarFallback",FOe=(0,pi.forwardRef)((e,t)=>{let{__scopeAvatar:r,delayMs:n,...i}=e,s=UG(LOe,r),[a,o]=(0,pi.useState)(n===void 0);return(0,pi.useEffect)(()=>{if(n!==void 0){let l=window.setTimeout(()=>o(!0),n);return()=>window.clearTimeout(l)}},[n]),a&&s.imageLoadingStatus!=="loaded"?(0,pi.createElement)(Tt.span,Ye({},i,{ref:t})):null});function DOe(e){let[t,r]=(0,pi.useState)("idle");return(0,pi.useEffect)(()=>{if(!e){r("error");return}let n=!0,i=new window.Image,s=a=>()=>{n&&r(a)};return r("loading"),i.onload=s("loaded"),i.onerror=s("error"),i.src=e,()=>{n=!1}},[e]),t}var i3=IOe,s3=POe,a3=FOe;var D1=ae(vt(),1),cb=F1.forwardRef(({className:e,...t},r)=>(0,D1.jsx)(i3,{ref:r,className:Lt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));cb.displayName=i3.displayName;var ub=F1.forwardRef(({className:e,...t},r)=>(0,D1.jsx)(s3,{ref:r,className:Lt("aspect-square h-full w-full",e),...t}));ub.displayName=s3.displayName;var fb=F1.forwardRef(({className:e,...t},r)=>(0,D1.jsx)(a3,{ref:r,className:Lt("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));fb.displayName=a3.displayName;var xa=ae(vt(),1);var BOe=({name:e,total:t})=>{let r=t.toFixed(2),n=r===0?r:Math.sign(r)===1?`+${r}`:r;return(0,xa.jsxs)("div",{className:"flex items-center",children:[(0,xa.jsxs)(cb,{className:"h-9 w-9",children:[(0,xa.jsx)(ub,{src:"/app/assets/csgo.png",alt:"CSGO Logo"}),(0,xa.jsx)(fb,{children:"GO"})]}),(0,xa.jsxs)("div",{className:"ml-4 space-y-1",children:[(0,xa.jsx)("p",{className:"text-sm font-medium leading-none",children:"CS:GO"}),(0,xa.jsx)("p",{className:"text-sm text-muted-foreground",children:e})]}),(0,xa.jsx)("div",{className:"ml-auto font-medium",children:n})]})};function zG({data:e=[]}){return(0,xa.jsx)("div",{className:"space-y-8",children:e.slice(0,5).map(t=>BOe(t))})}var o3=ae(Je(),1);var db=ae(Je());var qG={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};var MOe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),zt=(e,t)=>{let r=(0,db.forwardRef)(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,children:o,...l},c)=>(0,db.createElement)("svg",{ref:c,...qG,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:`lucide lucide-${MOe(e)}`,...l},[...t.map(([f,u])=>(0,db.createElement)(f,u)),...(Array.isArray(o)?o:[o])||[]]));return r.displayName=`${e}`,r};var pb=zt("Activity",[["polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12",key:"xez52g"}]]);var hb=zt("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);var af=zt("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]);var gb=zt("ChevronDown",[["polyline",{points:"6 9 12 15 18 9",key:"1do0m2"}]]);var yb=zt("ChevronRight",[["polyline",{points:"9 18 15 12 9 6",key:"1rtp27"}]]);var mb=zt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var of=zt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var bb=zt("Dumbbell",[["path",{d:"m6.5 6.5 11 11",key:"f7oqzb"}],["path",{d:"m21 21-1-1",key:"cpc6if"}],["path",{d:"m3 3 1 1",key:"d3rpuf"}],["path",{d:"m18 22 4-4",key:"1e32o6"}],["path",{d:"m2 6 4-4",key:"189tqz"}],["path",{d:"m3 10 7-7",key:"1bxui2"}],["path",{d:"m14 21 7-7",key:"16x78n"}]]);var vb=zt("Focus",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);var _b=zt("Gamepad",[["line",{x1:"6",x2:"10",y1:"12",y2:"12",key:"161bw2"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"15",x2:"15.01",y1:"13",y2:"13",key:"dqpgro"}],["line",{x1:"18",x2:"18.01",y1:"11",y2:"11",key:"meh2c"}],["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]]);var wb=zt("GlassWater",[["path",{d:"M15.2 22H8.8a2 2 0 0 1-2-1.79L5 3h14l-1.81 17.21A2 2 0 0 1 15.2 22Z",key:"48rfw3"}],["path",{d:"M6 12a5 5 0 0 1 6 0 5 5 0 0 0 6 0",key:"mjntcy"}]]);var Sb=zt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var xb=zt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var kb=zt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var Eb=zt("PersonStanding",[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]]);var Ob=zt("Power",[["path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0",key:"phirl6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"12",key:"aemgbe"}]]);var Ab=zt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var Tb=zt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var co=ae(vt(),1);function Ss({name:e="Card",Icon:t=of,primaryState:r="",secondaryState:n="",onPrimaryUpdate:i=a=>a,onSecondaryUpdate:s=a=>a}){return(0,co.jsxs)(Pd,{children:[(0,co.jsxs)(Ld,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,co.jsx)(Fd,{className:"text-sm font-medium",children:e}),(0,co.jsx)(t,{className:"h-4 w-4 text-muted-foreground"})]}),(0,co.jsx)(ROe,{primaryState:r,secondaryState:n,onPrimaryUpdate:i,onSecondaryUpdate:s})]})}function ROe({primaryState:e="",secondaryState:t="",onPrimaryUpdate:r=i=>i,onSecondaryUpdate:n=i=>i}){let[i,s]=(0,o3.useState)(e?YO(e):{});if(e){let l=mu(e,c=>{wy(e,l),s(c)})}let[a,o]=(0,o3.useState)(t?YO(t):{});if(t){let l=mu(t,c=>{wy(e,l),o(c)})}return(0,co.jsxs)(Dd,{children:[(0,co.jsx)("div",{className:"text-2xl font-bold",children:i.value?r(i.value):"N/A"}),t?(0,co.jsx)("p",{className:"text-xs text-muted-foreground",children:a.value?n(a.value):"No additional information"}):""]})}var uo=ae(vt(),1);function l3(){return(0,uo.jsxs)(uo.Fragment,{children:[(0,uo.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,uo.jsx)(Ss,{name:"Focus",Icon:vb,primaryState:"focus",onPrimaryUpdate:e=>`${e}%`}),(0,uo.jsx)(Ss,{name:"Cognitive Load",Icon:bb,primaryState:"cognitiveload",onPrimaryUpdate:e=>`${e}%`}),(0,uo.jsx)(Ss,{name:"Mental Fatigue",Icon:wb,primaryState:"mentalfatigue",onPrimaryUpdate:e=>`${e}%`})]}),(0,uo.jsx)("br",{})]})}var c3=ae(vt(),1);function VG({className:e,...t}){let r=[{name:"Home",path:"/"},{name:"Devices",path:"/devices"},{name:"Hyper+",path:"/plus"}],n=Bo();return(0,c3.jsx)("nav",{className:Lt("flex items-center space-x-4 lg:space-x-6",e),...t,children:r.map(i=>(0,c3.jsx)(HR,{to:i.path,className:`text-sm font-medium transition-colors hover:text-primary ${n.pathname===i.path?"":"text-muted-foreground"}`,children:i.name}))})}var GG=ae(Je(),1);var HG=e=>typeof e=="boolean"?"".concat(e):e===0?"0":e,WG=JR,JG=(e,t)=>r=>{var n;if(t?.variants==null)return WG(e,r?.class,r?.className);let{variants:i,defaultVariants:s}=t,a=Object.keys(i).map(c=>{let f=r?.[c],u=s?.[c];if(f===null)return null;let d=HG(f)||HG(u);return i[c][d]}),o=r&&Object.entries(r).reduce((c,f)=>{let[u,d]=f;return d===void 0||(c[u]=d),c},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,f)=>{let{class:u,className:d,...p}=f;return Object.entries(p).every(_=>{let[w,k]=_;return Array.isArray(k)?k.includes({...s,...o}[w]):{...s,...o}[w]===k})?[...c,u,d]:c},[]);return WG(e,a,l,r?.class,r?.className)};var KG=ae(vt(),1),fh=JG("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),lf=GG.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...i},s)=>(0,KG.jsx)(n?Bs:"button",{className:Lt(fh({variant:t,size:r,className:e})),ref:s,...i}));lf.displayName="Button";var al=ae(Je(),1);var Xt=ae(Je(),1);var He=ae(Je(),1);var fn=ae(Je(),1);var YG=ae(Je(),1);function XG(e,t=globalThis?.document){let r=cn(e);(0,YG.useEffect)(()=>{let n=i=>{i.key==="Escape"&&r(i)};return t.addEventListener("keydown",n),()=>t.removeEventListener("keydown",n)},[r,t])}var u3="dismissableLayer.update",$Oe="dismissableLayer.pointerDownOutside",UOe="dismissableLayer.focusOutside",ZG,zOe=(0,fn.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),j1=(0,fn.forwardRef)((e,t)=>{var r;let{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:o,onDismiss:l,...c}=e,f=(0,fn.useContext)(zOe),[u,d]=(0,fn.useState)(null),p=(r=u?.ownerDocument)!==null&&r!==void 0?r:globalThis?.document,[,_]=(0,fn.useState)({}),w=hr(t,U=>d(U)),k=Array.from(f.layers),[S]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),O=k.indexOf(S),A=u?k.indexOf(u):-1,C=f.layersWithOutsidePointerEventsDisabled.size>0,I=A>=O,D=qOe(U=>{let te=U.target,V=[...f.branches].some(X=>X.contains(te));!I||V||(s?.(U),o?.(U),U.defaultPrevented||l?.())},p),L=VOe(U=>{let te=U.target;[...f.branches].some(X=>X.contains(te))||(a?.(U),o?.(U),U.defaultPrevented||l?.())},p);return XG(U=>{A===f.layers.size-1&&(i?.(U),!U.defaultPrevented&&l&&(U.preventDefault(),l()))},p),(0,fn.useEffect)(()=>{if(u)return n&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(ZG=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(u)),f.layers.add(u),QG(),()=>{n&&f.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=ZG)}},[u,p,n,f]),(0,fn.useEffect)(()=>()=>{u&&(f.layers.delete(u),f.layersWithOutsidePointerEventsDisabled.delete(u),QG())},[u,f]),(0,fn.useEffect)(()=>{let U=()=>_({});return document.addEventListener(u3,U),()=>document.removeEventListener(u3,U)},[]),(0,fn.createElement)(Tt.div,Ye({},c,{ref:w,style:{pointerEvents:C?I?"auto":"none":void 0,...e.style},onFocusCapture:gt(e.onFocusCapture,L.onFocusCapture),onBlurCapture:gt(e.onBlurCapture,L.onBlurCapture),onPointerDownCapture:gt(e.onPointerDownCapture,D.onPointerDownCapture)}))});function qOe(e,t=globalThis?.document){let r=cn(e),n=(0,fn.useRef)(!1),i=(0,fn.useRef)(()=>{});return(0,fn.useEffect)(()=>{let s=o=>{if(o.target&&!n.current){let c=function(){eK($Oe,r,l,{discrete:!0})},l={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=c,t.addEventListener("click",i.current,{once:!0})):c()}n.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",s),t.removeEventListener("click",i.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function VOe(e,t=globalThis?.document){let r=cn(e),n=(0,fn.useRef)(!1);return(0,fn.useEffect)(()=>{let i=s=>{s.target&&!n.current&&eK(UOe,r,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function QG(){let e=new CustomEvent(u3);document.dispatchEvent(e)}function eK(e,t,r,{discrete:n}){let i=r.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?$0(i,s):i.dispatchEvent(s)}var rK=ae(Je(),1),f3=0;function B1(){(0,rK.useEffect)(()=>{var e,t;let r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=r[0])!==null&&e!==void 0?e:tK()),document.body.insertAdjacentElement("beforeend",(t=r[1])!==null&&t!==void 0?t:tK()),f3++,()=>{f3===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),f3--}},[])}function tK(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var es=ae(Je(),1);var d3="focusScope.autoFocusOnMount",p3="focusScope.autoFocusOnUnmount",nK={bubbles:!1,cancelable:!0};var M1=(0,es.forwardRef)((e,t)=>{let{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...a}=e,[o,l]=(0,es.useState)(null),c=cn(i),f=cn(s),u=(0,es.useRef)(null),d=hr(t,w=>l(w)),p=(0,es.useRef)({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;(0,es.useEffect)(()=>{if(n){let w=function(A){if(p.paused||!o)return;let C=A.target;o.contains(C)?u.current=C:dc(u.current,{select:!0})},k=function(A){if(p.paused||!o)return;let C=A.relatedTarget;C!==null&&(o.contains(C)||dc(u.current,{select:!0}))},S=function(A){let C=document.activeElement;for(let I of A)I.removedNodes.length>0&&(o!=null&&o.contains(C)||dc(o))};document.addEventListener("focusin",w),document.addEventListener("focusout",k);let O=new MutationObserver(S);return o&&O.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",w),document.removeEventListener("focusout",k),O.disconnect()}}},[n,o,p.paused]),(0,es.useEffect)(()=>{if(o){sK.add(p);let w=document.activeElement;if(!o.contains(w)){let S=new CustomEvent(d3,nK);o.addEventListener(d3,c),o.dispatchEvent(S),S.defaultPrevented||(HOe(YOe(oK(o)),{select:!0}),document.activeElement===w&&dc(o))}return()=>{o.removeEventListener(d3,c),setTimeout(()=>{let S=new CustomEvent(p3,nK);o.addEventListener(p3,f),o.dispatchEvent(S),S.defaultPrevented||dc(w??document.body,{select:!0}),o.removeEventListener(p3,f),sK.remove(p)},0)}}},[o,c,f,p]);let _=(0,es.useCallback)(w=>{if(!r&&!n||p.paused)return;let k=w.key==="Tab"&&!w.altKey&&!w.ctrlKey&&!w.metaKey,S=document.activeElement;if(k&&S){let O=w.currentTarget,[A,C]=WOe(O);A&&C?!w.shiftKey&&S===C?(w.preventDefault(),r&&dc(A,{select:!0})):w.shiftKey&&S===A&&(w.preventDefault(),r&&dc(C,{select:!0})):S===O&&w.preventDefault()}},[r,n,p.paused]);return(0,es.createElement)(Tt.div,Ye({tabIndex:-1},a,{ref:d,onKeyDown:_}))});function HOe(e,{select:t=!1}={}){let r=document.activeElement;for(let n of e)if(dc(n,{select:t}),document.activeElement!==r)return}function WOe(e){let t=oK(e),r=iK(t,e),n=iK(t.reverse(),e);return[r,n]}function oK(e){let t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{let i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function iK(e,t){for(let r of e)if(!JOe(r,{upTo:t}))return r}function JOe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function GOe(e){return e instanceof HTMLInputElement&&"select"in e}function dc(e,{select:t=!1}={}){if(e&&e.focus){let r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&GOe(e)&&t&&e.select()}}var sK=KOe();function KOe(){let e=[];return{add(t){let r=e[0];t!==r&&r?.pause(),e=aK(e,t),e.unshift(t)},remove(t){var r;e=aK(e,t),(r=e[0])===null||r===void 0||r.resume()}}}function aK(e,t){let r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function YOe(e){return e.filter(t=>t.tagName!=="A")}var Mn=ae(Je(),1);function dh(e){return e.split("-")[1]}function m3(e){return e==="y"?"height":"width"}function sl(e){return e.split("-")[0]}function ff(e){return["top","bottom"].includes(sl(e))?"x":"y"}function lK(e,t,r){let{reference:n,floating:i}=e,s=n.x+n.width/2-i.width/2,a=n.y+n.height/2-i.height/2,o=ff(t),l=m3(o),c=n[l]/2-i[l]/2,f=o==="x",u;switch(sl(t)){case"top":u={x:s,y:n.y-i.height};break;case"bottom":u={x:s,y:n.y+n.height};break;case"right":u={x:n.x+n.width,y:a};break;case"left":u={x:n.x-i.width,y:a};break;default:u={x:n.x,y:n.y}}switch(dh(t)){case"start":u[o]-=c*(r&&f?-1:1);break;case"end":u[o]+=c*(r&&f?-1:1)}return u}var fK=async(e,t,r)=>{let{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t)),c=await a.getElementRects({reference:e,floating:t,strategy:i}),{x:f,y:u}=lK(c,n,l),d=n,p={},_=0;for(let w=0;w<o.length;w++){let{name:k,fn:S}=o[w],{x:O,y:A,data:C,reset:I}=await S({x:f,y:u,initialPlacement:n,placement:d,strategy:i,middlewareData:p,rects:c,platform:a,elements:{reference:e,floating:t}});f=O??f,u=A??u,p={...p,[k]:{...p[k],...C}},I&&_<=50&&(_++,typeof I=="object"&&(I.placement&&(d=I.placement),I.rects&&(c=I.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:i}):I.rects),{x:f,y:u}=lK(c,d,l)),w=-1)}return{x:f,y:u,placement:d,strategy:i,middlewareData:p}};function dK(e){return typeof e!="number"?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(e):{top:e,right:e,bottom:e,left:e}}function Cb(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function uf(e,t){var r;t===void 0&&(t={});let{x:n,y:i,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:f="viewport",elementContext:u="floating",altBoundary:d=!1,padding:p=0}=t,_=dK(p),w=o[d?u==="floating"?"reference":"floating":u],k=Cb(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(w)))==null||r?w:w.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:f,strategy:l})),S=u==="floating"?{...a.floating,x:n,y:i}:a.reference,O=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),A=await(s.isElement==null?void 0:s.isElement(O))&&await(s.getScale==null?void 0:s.getScale(O))||{x:1,y:1},C=Cb(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:S,offsetParent:O,strategy:l}):S);return{top:(k.top-C.top+_.top)/A.y,bottom:(C.bottom-k.bottom+_.bottom)/A.y,left:(k.left-C.left+_.left)/A.x,right:(C.right-k.right+_.right)/A.x}}var g3=Math.min,cf=Math.max;function y3(e,t,r){return cf(e,g3(t,r))}var $1=e=>({name:"arrow",options:e,async fn(t){let{element:r,padding:n=0}=e||{},{x:i,y:s,placement:a,rects:o,platform:l,elements:c}=t;if(r==null)return{};let f=dK(n),u={x:i,y:s},d=ff(a),p=m3(d),_=await l.getDimensions(r),w=d==="y",k=w?"top":"left",S=w?"bottom":"right",O=w?"clientHeight":"clientWidth",A=o.reference[p]+o.reference[d]-u[d]-o.floating[p],C=u[d]-o.reference[d],I=await(l.getOffsetParent==null?void 0:l.getOffsetParent(r)),D=I?I[O]:0;D&&await(l.isElement==null?void 0:l.isElement(I))||(D=c.floating[O]||o.floating[p]);let L=A/2-C/2,U=f[k],te=D-_[p]-f[S],V=D/2-_[p]/2+L,X=y3(U,V,te),Z=dh(a)!=null&&V!=X&&o.reference[p]/2-(V<U?f[k]:f[S])-_[p]/2<0;return{[d]:u[d]-(Z?V<U?U-V:te-V:0),data:{[d]:X,centerOffset:V-X}}}}),pK=["top","right","bottom","left"],CJe=pK.reduce((e,t)=>e.concat(t,t+"-start",t+"-end"),[]),XOe={left:"right",right:"left",bottom:"top",top:"bottom"};function R1(e){return e.replace(/left|right|bottom|top/g,t=>XOe[t])}function ZOe(e,t,r){r===void 0&&(r=!1);let n=dh(e),i=ff(e),s=m3(i),a=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=R1(a)),{main:a,cross:R1(a)}}var QOe={start:"end",end:"start"};function h3(e){return e.replace(/start|end/g,t=>QOe[t])}var U1=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r;let{placement:n,middlewareData:i,rects:s,initialPlacement:a,platform:o,elements:l}=t,{mainAxis:c=!0,crossAxis:f=!0,fallbackPlacements:u,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:_=!0,...w}=e,k=sl(n),S=sl(a)===a,O=await(o.isRTL==null?void 0:o.isRTL(l.floating)),A=u||(S||!_?[R1(a)]:function(X){let Z=R1(X);return[h3(X),Z,h3(Z)]}(a));u||p==="none"||A.push(...function(X,Z,se,pe){let de=dh(X),F=function(H,Q,R){let $=["left","right"],q=["right","left"],ie=["top","bottom"],oe=["bottom","top"];switch(H){case"top":case"bottom":return R?Q?q:$:Q?$:q;case"left":case"right":return Q?ie:oe;default:return[]}}(sl(X),se==="start",pe);return de&&(F=F.map(H=>H+"-"+de),Z&&(F=F.concat(F.map(h3)))),F}(a,_,p,O));let C=[a,...A],I=await uf(t,w),D=[],L=((r=i.flip)==null?void 0:r.overflows)||[];if(c&&D.push(I[k]),f){let{main:X,cross:Z}=ZOe(n,s,O);D.push(I[X],I[Z])}if(L=[...L,{placement:n,overflows:D}],!D.every(X=>X<=0)){var U,te;let X=(((U=i.flip)==null?void 0:U.index)||0)+1,Z=C[X];if(Z)return{data:{index:X,overflows:L},reset:{placement:Z}};let se=(te=L.filter(pe=>pe.overflows[0]<=0).sort((pe,de)=>pe.overflows[1]-de.overflows[1])[0])==null?void 0:te.placement;if(!se)switch(d){case"bestFit":{var V;let pe=(V=L.map(de=>[de.placement,de.overflows.filter(F=>F>0).reduce((F,H)=>F+H,0)]).sort((de,F)=>de[1]-F[1])[0])==null?void 0:V[0];pe&&(se=pe);break}case"initialPlacement":se=a}if(n!==se)return{reset:{placement:se}}}return{}}}};function cK(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function uK(e){return pK.some(t=>e[t]>=0)}var z1=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){let{strategy:r="referenceHidden",...n}=e,{rects:i}=t;switch(r){case"referenceHidden":{let s=cK(await uf(t,{...n,elementContext:"reference"}),i.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:uK(s)}}}case"escaped":{let s=cK(await uf(t,{...n,altBoundary:!0}),i.floating);return{data:{escapedOffsets:s,escaped:uK(s)}}}default:return{}}}}};var q1=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){let{x:r,y:n}=t,i=await async function(s,a){let{placement:o,platform:l,elements:c}=s,f=await(l.isRTL==null?void 0:l.isRTL(c.floating)),u=sl(o),d=dh(o),p=ff(o)==="x",_=["left","top"].includes(u)?-1:1,w=f&&p?-1:1,k=typeof a=="function"?a(s):a,{mainAxis:S,crossAxis:O,alignmentAxis:A}=typeof k=="number"?{mainAxis:k,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...k};return d&&typeof A=="number"&&(O=d==="end"?-1*A:A),p?{x:O*w,y:S*_}:{x:S*_,y:O*w}}(t,e);return{x:r+i.x,y:n+i.y,data:i}}}};function hK(e){return e==="x"?"y":"x"}var V1=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){let{x:r,y:n,placement:i}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:k=>{let{x:S,y:O}=k;return{x:S,y:O}}},...l}=e,c={x:r,y:n},f=await uf(t,l),u=ff(sl(i)),d=hK(u),p=c[u],_=c[d];if(s){let k=u==="y"?"bottom":"right";p=y3(p+f[u==="y"?"top":"left"],p,p-f[k])}if(a){let k=d==="y"?"bottom":"right";_=y3(_+f[d==="y"?"top":"left"],_,_-f[k])}let w=o.fn({...t,[u]:p,[d]:_});return{...w,data:{x:w.x-r,y:w.y-n}}}}},H1=function(e){return e===void 0&&(e={}),{options:e,fn(t){let{x:r,y:n,placement:i,rects:s,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=e,f={x:r,y:n},u=ff(i),d=hK(u),p=f[u],_=f[d],w=typeof o=="function"?o(t):o,k=typeof w=="number"?{mainAxis:w,crossAxis:0}:{mainAxis:0,crossAxis:0,...w};if(l){let A=u==="y"?"height":"width",C=s.reference[u]-s.floating[A]+k.mainAxis,I=s.reference[u]+s.reference[A]-k.mainAxis;p<C?p=C:p>I&&(p=I)}if(c){var S,O;let A=u==="y"?"width":"height",C=["top","left"].includes(sl(i)),I=s.reference[d]-s.floating[A]+(C&&((S=a.offset)==null?void 0:S[d])||0)+(C?0:k.crossAxis),D=s.reference[d]+s.reference[A]+(C?0:((O=a.offset)==null?void 0:O[d])||0)-(C?k.crossAxis:0);_<I?_=I:_>D&&(_=D)}return{[u]:p,[d]:_}}}},W1=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){let{placement:r,rects:n,platform:i,elements:s}=t,{apply:a=()=>{},...o}=e,l=await uf(t,o),c=sl(r),f=dh(r),u=ff(r)==="x",{width:d,height:p}=n.floating,_,w;c==="top"||c==="bottom"?(_=c,w=f===(await(i.isRTL==null?void 0:i.isRTL(s.floating))?"start":"end")?"left":"right"):(w=c,_=f==="end"?"top":"bottom");let k=p-l[_],S=d-l[w],O=!t.middlewareData.shift,A=k,C=S;if(u){let D=d-l.left-l.right;C=f||O?g3(S,D):D}else{let D=p-l.top-l.bottom;A=f||O?g3(k,D):D}if(O&&!f){let D=cf(l.left,0),L=cf(l.right,0),U=cf(l.top,0),te=cf(l.bottom,0);u?C=d-2*(D!==0||L!==0?D+L:cf(l.left,l.right)):A=p-2*(U!==0||te!==0?U+te:cf(l.top,l.bottom))}await a({...t,availableWidth:C,availableHeight:A});let I=await i.getDimensions(s.floating);return d!==I.width||p!==I.height?{reset:{rects:!0}}:{}}}};function Ks(e){var t;return((t=e.ownerDocument)==null?void 0:t.defaultView)||window}function ka(e){return Ks(e).getComputedStyle(e)}function wK(e){return e instanceof Ks(e).Node}function hc(e){return wK(e)?(e.nodeName||"").toLowerCase():""}function Ea(e){return e instanceof Ks(e).HTMLElement}function xs(e){return e instanceof Ks(e).Element}function gK(e){return typeof ShadowRoot>"u"?!1:e instanceof Ks(e).ShadowRoot||e instanceof ShadowRoot}function Nb(e){let{overflow:t,overflowX:r,overflowY:n,display:i}=ka(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(i)}function rAe(e){return["table","td","th"].includes(hc(e))}function b3(e){let t=v3(),r=ka(e);return r.transform!=="none"||r.perspective!=="none"||!t&&!!r.backdropFilter&&r.backdropFilter!=="none"||!t&&!!r.filter&&r.filter!=="none"||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function v3(){return!(typeof CSS>"u"||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function G1(e){return["html","body","#document"].includes(hc(e))}var yK=Math.min,Ib=Math.max,J1=Math.round;function SK(e){let t=ka(e),r=parseFloat(t.width)||0,n=parseFloat(t.height)||0,i=Ea(e),s=i?e.offsetWidth:r,a=i?e.offsetHeight:n,o=J1(r)!==s||J1(n)!==a;return o&&(r=s,n=a),{width:r,height:n,fallback:o}}function xK(e){return xs(e)?e:e.contextElement}var kK={x:1,y:1};function ph(e){let t=xK(e);if(!Ea(t))return kK;let r=t.getBoundingClientRect(),{width:n,height:i,fallback:s}=SK(t),a=(s?J1(r.width):r.width)/n,o=(s?J1(r.height):r.height)/i;return a&&Number.isFinite(a)||(a=1),o&&Number.isFinite(o)||(o=1),{x:a,y:o}}var mK={x:0,y:0};function EK(e,t,r){var n,i;if(t===void 0&&(t=!0),!v3())return mK;let s=e?Ks(e):window;return!r||t&&r!==s?mK:{x:((n=s.visualViewport)==null?void 0:n.offsetLeft)||0,y:((i=s.visualViewport)==null?void 0:i.offsetTop)||0}}function df(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);let i=e.getBoundingClientRect(),s=xK(e),a=kK;t&&(n?xs(n)&&(a=ph(n)):a=ph(e));let o=EK(s,r,n),l=(i.left+o.x)/a.x,c=(i.top+o.y)/a.y,f=i.width/a.x,u=i.height/a.y;if(s){let d=Ks(s),p=n&&xs(n)?Ks(n):n,_=d.frameElement;for(;_&&n&&p!==d;){let w=ph(_),k=_.getBoundingClientRect(),S=getComputedStyle(_);k.x+=(_.clientLeft+parseFloat(S.paddingLeft))*w.x,k.y+=(_.clientTop+parseFloat(S.paddingTop))*w.y,l*=w.x,c*=w.y,f*=w.x,u*=w.y,l+=k.x,c+=k.y,_=Ks(_).frameElement}}return Cb({width:f,height:u,x:l,y:c})}function pc(e){return((wK(e)?e.ownerDocument:e.document)||window.document).documentElement}function K1(e){return xs(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function OK(e){return df(pc(e)).left+K1(e).scrollLeft}function gh(e){if(hc(e)==="html")return e;let t=e.assignedSlot||e.parentNode||gK(e)&&e.host||pc(e);return gK(t)?t.host:t}function AK(e){let t=gh(e);return G1(t)?t.ownerDocument.body:Ea(t)&&Nb(t)?t:AK(t)}function hh(e,t){var r;t===void 0&&(t=[]);let n=AK(e),i=n===((r=e.ownerDocument)==null?void 0:r.body),s=Ks(n);return i?t.concat(s,s.visualViewport||[],Nb(n)?n:[]):t.concat(n,hh(n))}function bK(e,t,r){let n;if(t==="viewport")n=function(i,s){let a=Ks(i),o=pc(i),l=a.visualViewport,c=o.clientWidth,f=o.clientHeight,u=0,d=0;if(l){c=l.width,f=l.height;let p=v3();(!p||p&&s==="fixed")&&(u=l.offsetLeft,d=l.offsetTop)}return{width:c,height:f,x:u,y:d}}(e,r);else if(t==="document")n=function(i){let s=pc(i),a=K1(i),o=i.ownerDocument.body,l=Ib(s.scrollWidth,s.clientWidth,o.scrollWidth,o.clientWidth),c=Ib(s.scrollHeight,s.clientHeight,o.scrollHeight,o.clientHeight),f=-a.scrollLeft+OK(i),u=-a.scrollTop;return ka(o).direction==="rtl"&&(f+=Ib(s.clientWidth,o.clientWidth)-l),{width:l,height:c,x:f,y:u}}(pc(e));else if(xs(t))n=function(i,s){let a=df(i,!0,s==="fixed"),o=a.top+i.clientTop,l=a.left+i.clientLeft,c=Ea(i)?ph(i):{x:1,y:1};return{width:i.clientWidth*c.x,height:i.clientHeight*c.y,x:l*c.x,y:o*c.y}}(t,r);else{let i=EK(e);n={...t,x:t.x-i.x,y:t.y-i.y}}return Cb(n)}function TK(e,t){let r=gh(e);return!(r===t||!xs(r)||G1(r))&&(ka(r).position==="fixed"||TK(r,t))}function vK(e,t){return Ea(e)&&ka(e).position!=="fixed"?t?t(e):e.offsetParent:null}function _K(e,t){let r=Ks(e);if(!Ea(e))return r;let n=vK(e,t);for(;n&&rAe(n)&&ka(n).position==="static";)n=vK(n,t);return n&&(hc(n)==="html"||hc(n)==="body"&&ka(n).position==="static"&&!b3(n))?r:n||function(i){let s=gh(i);for(;Ea(s)&&!G1(s);){if(b3(s))return s;s=gh(s)}return null}(e)||r}function nAe(e,t,r){let n=Ea(t),i=pc(t),s=r==="fixed",a=df(e,!0,s,t),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};if(n||!n&&!s)if((hc(t)!=="body"||Nb(i))&&(o=K1(t)),Ea(t)){let c=df(t,!0,s,t);l.x=c.x+t.clientLeft,l.y=c.y+t.clientTop}else i&&(l.x=OK(i));return{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}var CK={getClippingRect:function(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e,s=r==="clippingAncestors"?function(c,f){let u=f.get(c);if(u)return u;let d=hh(c).filter(k=>xs(k)&&hc(k)!=="body"),p=null,_=ka(c).position==="fixed",w=_?gh(c):c;for(;xs(w)&&!G1(w);){let k=ka(w),S=b3(w);S||k.position!=="fixed"||(p=null),(_?!S&&!p:!S&&k.position==="static"&&p&&["absolute","fixed"].includes(p.position)||Nb(w)&&!S&&TK(c,w))?d=d.filter(O=>O!==w):p=k,w=gh(w)}return f.set(c,d),d}(t,this._c):[].concat(r),a=[...s,n],o=a[0],l=a.reduce((c,f)=>{let u=bK(t,f,i);return c.top=Ib(u.top,c.top),c.right=yK(u.right,c.right),c.bottom=yK(u.bottom,c.bottom),c.left=Ib(u.left,c.left),c},bK(t,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:r,strategy:n}=e,i=Ea(r),s=pc(r);if(r===s)return t;let a={scrollLeft:0,scrollTop:0},o={x:1,y:1},l={x:0,y:0};if((i||!i&&n!=="fixed")&&((hc(r)!=="body"||Nb(s))&&(a=K1(r)),Ea(r))){let c=df(r);o=ph(r),l.x=c.x+r.clientLeft,l.y=c.y+r.clientTop}return{width:t.width*o.x,height:t.height*o.y,x:t.x*o.x-a.scrollLeft*o.x+l.x,y:t.y*o.y-a.scrollTop*o.y+l.y}},isElement:xs,getDimensions:function(e){return SK(e)},getOffsetParent:_K,getDocumentElement:pc,getScale:ph,async getElementRects(e){let{reference:t,floating:r,strategy:n}=e,i=this.getOffsetParent||_K,s=this.getDimensions;return{reference:nAe(t,await i(r),n),floating:{x:0,y:0,...await s(r)}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>ka(e).direction==="rtl"};function _3(e,t,r,n){n===void 0&&(n={});let{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=!0,animationFrame:o=!1}=n,l=i||s?[...xs(e)?hh(e):e.contextElement?hh(e.contextElement):[],...hh(t)]:[];l.forEach(d=>{let p=!xs(d)&&d.toString().includes("V");!i||o&&!p||d.addEventListener("scroll",r,{passive:!0}),s&&d.addEventListener("resize",r)});let c,f=null;a&&(f=new ResizeObserver(()=>{r()}),xs(e)&&!o&&f.observe(e),xs(e)||!e.contextElement||o||f.observe(e.contextElement),f.observe(t));let u=o?df(e):null;return o&&function d(){let p=df(e);!u||p.x===u.x&&p.y===u.y&&p.width===u.width&&p.height===u.height||r(),u=p,c=requestAnimationFrame(d)}(),r(),()=>{var d;l.forEach(p=>{i&&p.removeEventListener("scroll",r),s&&p.removeEventListener("resize",r)}),(d=f)==null||d.disconnect(),f=null,o&&cancelAnimationFrame(c)}}var w3=(e,t,r)=>{let n=new Map,i={platform:CK,...r},s={...i.platform,_c:n};return fK(e,t,{...i,platform:s})};var wn=ae(Je()),Z1=ae(Je()),PK=ae(Va()),LK=e=>{let{element:t,padding:r}=e;function n(i){return{}.hasOwnProperty.call(i,"current")}return{name:"arrow",options:e,fn(i){return t&&n(t)?t.current!=null?$1({element:t.current,padding:r}).fn(i):{}:t?$1({element:t,padding:r}).fn(i):{}}}},Y1=typeof document<"u"?Z1.useLayoutEffect:Z1.useEffect;function X1(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!X1(e[n],t[n]))return!1;return!0}if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){let s=i[n];if(!(s==="_owner"&&e.$$typeof)&&!X1(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function FK(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function IK(e,t){let r=FK(e);return Math.round(t*r)/r}function NK(e){let t=wn.useRef(e);return Y1(()=>{t.current=e}),t}function DK(e){e===void 0&&(e={});let{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[f,u]=wn.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[d,p]=wn.useState(n);X1(d,n)||p(n);let[_,w]=wn.useState(null),[k,S]=wn.useState(null),O=wn.useCallback(F=>{F!=D.current&&(D.current=F,w(F))},[w]),A=wn.useCallback(F=>{F!==L.current&&(L.current=F,S(F))},[S]),C=s||_,I=a||k,D=wn.useRef(null),L=wn.useRef(null),U=wn.useRef(f),te=NK(l),V=NK(i),X=wn.useCallback(()=>{if(!D.current||!L.current)return;let F={placement:t,strategy:r,middleware:d};V.current&&(F.platform=V.current),w3(D.current,L.current,F).then(H=>{let Q={...H,isPositioned:!0};Z.current&&!X1(U.current,Q)&&(U.current=Q,PK.flushSync(()=>{u(Q)}))})},[d,t,r,V]);Y1(()=>{c===!1&&U.current.isPositioned&&(U.current.isPositioned=!1,u(F=>({...F,isPositioned:!1})))},[c]);let Z=wn.useRef(!1);Y1(()=>(Z.current=!0,()=>{Z.current=!1}),[]),Y1(()=>{if(C&&(D.current=C),I&&(L.current=I),C&&I){if(te.current)return te.current(C,I,X);X()}},[C,I,X,te]);let se=wn.useMemo(()=>({reference:D,floating:L,setReference:O,setFloating:A}),[O,A]),pe=wn.useMemo(()=>({reference:C,floating:I}),[C,I]),de=wn.useMemo(()=>{let F={position:r,left:0,top:0};if(!pe.floating)return F;let H=IK(pe.floating,f.x),Q=IK(pe.floating,f.y);return o?{...F,transform:"translate("+H+"px, "+Q+"px)",...FK(pe.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:H,top:Q}},[r,o,pe.floating,f.x,f.y]);return wn.useMemo(()=>({...f,update:X,refs:se,elements:pe,floatingStyles:de}),[f,X,se,pe,de])}var jK=ae(Je(),1);function BK(e){let[t,r]=(0,jK.useState)(void 0);return Nn(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;let s=i[0],a,o;if("borderBoxSize"in s){let l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;r({width:a,height:o})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var MK="Popper",[RK,yh]=oi(MK),[iAe,$K]=RK(MK),sAe=e=>{let{__scopePopper:t,children:r}=e,[n,i]=(0,Mn.useState)(null);return(0,Mn.createElement)(iAe,{scope:t,anchor:n,onAnchorChange:i},r)},aAe="PopperAnchor",oAe=(0,Mn.forwardRef)((e,t)=>{let{__scopePopper:r,virtualRef:n,...i}=e,s=$K(aAe,r),a=(0,Mn.useRef)(null),o=hr(t,a);return(0,Mn.useEffect)(()=>{s.onAnchorChange(n?.current||a.current)}),n?null:(0,Mn.createElement)(Tt.div,Ye({},i,{ref:o}))}),UK="PopperContent",[lAe,JJe]=RK(UK),cAe=(0,Mn.forwardRef)((e,t)=>{var r,n,i,s,a,o,l,c;let{__scopePopper:f,side:u="bottom",sideOffset:d=0,align:p="center",alignOffset:_=0,arrowPadding:w=0,collisionBoundary:k=[],collisionPadding:S=0,sticky:O="partial",hideWhenDetached:A=!1,avoidCollisions:C=!0,onPlaced:I,...D}=e,L=$K(UK,f),[U,te]=(0,Mn.useState)(null),V=hr(t,Ne=>te(Ne)),[X,Z]=(0,Mn.useState)(null),se=BK(X),pe=(r=se?.width)!==null&&r!==void 0?r:0,de=(n=se?.height)!==null&&n!==void 0?n:0,F=u+(p!=="center"?"-"+p:""),H=typeof S=="number"?S:{top:0,right:0,bottom:0,left:0,...S},Q=Array.isArray(k)?k:[k],R=Q.length>0,$={padding:H,boundary:Q.filter(uAe),altBoundary:R},{refs:q,floatingStyles:ie,placement:oe,isPositioned:fe,middlewareData:_e}=DK({strategy:"fixed",placement:F,whileElementsMounted:_3,elements:{reference:L.anchor},middleware:[q1({mainAxis:d+de,alignmentAxis:_}),C&&V1({mainAxis:!0,crossAxis:!1,limiter:O==="partial"?H1():void 0,...$}),C&&U1({...$}),W1({...$,apply:({elements:Ne,rects:Ce,availableWidth:Xe,availableHeight:Ze})=>{let{width:kt,height:St}=Ce.reference,pt=Ne.floating.style;pt.setProperty("--radix-popper-available-width",`${Xe}px`),pt.setProperty("--radix-popper-available-height",`${Ze}px`),pt.setProperty("--radix-popper-anchor-width",`${kt}px`),pt.setProperty("--radix-popper-anchor-height",`${St}px`)}}),X&&LK({element:X,padding:w}),fAe({arrowWidth:pe,arrowHeight:de}),A&&z1({strategy:"referenceHidden"})]}),[Ee,Se]=zK(oe),le=cn(I);Nn(()=>{fe&&le?.()},[fe,le]);let we=(i=_e.arrow)===null||i===void 0?void 0:i.x,W=(s=_e.arrow)===null||s===void 0?void 0:s.y,J=((a=_e.arrow)===null||a===void 0?void 0:a.centerOffset)!==0,[ne,Oe]=(0,Mn.useState)();return Nn(()=>{U&&Oe(window.getComputedStyle(U).zIndex)},[U]),(0,Mn.createElement)("div",{ref:q.setFloating,"data-radix-popper-content-wrapper":"",style:{...ie,transform:fe?ie.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ne,["--radix-popper-transform-origin"]:[(o=_e.transformOrigin)===null||o===void 0?void 0:o.x,(l=_e.transformOrigin)===null||l===void 0?void 0:l.y].join(" ")},dir:e.dir},(0,Mn.createElement)(lAe,{scope:f,placedSide:Ee,onArrowChange:Z,arrowX:we,arrowY:W,shouldHideArrow:J},(0,Mn.createElement)(Tt.div,Ye({"data-side":Ee,"data-align":Se},D,{ref:V,style:{...D.style,animation:fe?void 0:"none",opacity:(c=_e.hide)!==null&&c!==void 0&&c.referenceHidden?0:void 0}}))))});function uAe(e){return e!==null}var fAe=e=>({name:"transformOrigin",options:e,fn(t){var r,n,i,s,a;let{placement:o,rects:l,middlewareData:c}=t,u=((r=c.arrow)===null||r===void 0?void 0:r.centerOffset)!==0,d=u?0:e.arrowWidth,p=u?0:e.arrowHeight,[_,w]=zK(o),k={start:"0%",center:"50%",end:"100%"}[w],S=((n=(i=c.arrow)===null||i===void 0?void 0:i.x)!==null&&n!==void 0?n:0)+d/2,O=((s=(a=c.arrow)===null||a===void 0?void 0:a.y)!==null&&s!==void 0?s:0)+p/2,A="",C="";return _==="bottom"?(A=u?k:`${S}px`,C=`${-p}px`):_==="top"?(A=u?k:`${S}px`,C=`${l.floating.height+p}px`):_==="right"?(A=`${-p}px`,C=u?k:`${O}px`):_==="left"&&(A=`${l.floating.width+p}px`,C=u?k:`${O}px`),{data:{x:A,y:C}}}});function zK(e){let[t,r="center"]=e.split("-");return[t,r]}var Q1=sAe,eS=oAe,tS=cAe;var rS=ae(Je(),1),qK=ae(Va(),1);var nS=(0,rS.forwardRef)((e,t)=>{var r;let{container:n=globalThis==null||(r=globalThis.document)===null||r===void 0?void 0:r.body,...i}=e;return n?qK.default.createPortal((0,rS.createElement)(Tt.div,Ye({},i,{ref:t})),n):null});var dAe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},mh=new WeakMap,iS=new WeakMap,sS={},S3=0,VK=function(e){return e&&(e.host||VK(e.parentNode))},pAe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=VK(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},hAe=function(e,t,r,n){var i=pAe(t,Array.isArray(e)?e:[e]);sS[r]||(sS[r]=new WeakMap);var s=sS[r],a=[],o=new Set,l=new Set(i),c=function(u){!u||o.has(u)||(o.add(u),c(u.parentNode))};i.forEach(c);var f=function(u){!u||l.has(u)||Array.prototype.forEach.call(u.children,function(d){if(o.has(d))f(d);else{var p=d.getAttribute(n),_=p!==null&&p!=="false",w=(mh.get(d)||0)+1,k=(s.get(d)||0)+1;mh.set(d,w),s.set(d,k),a.push(d),w===1&&_&&iS.set(d,!0),k===1&&d.setAttribute(r,"true"),_||d.setAttribute(n,"true")}})};return f(t),o.clear(),S3++,function(){a.forEach(function(u){var d=mh.get(u)-1,p=s.get(u)-1;mh.set(u,d),s.set(u,p),d||(iS.has(u)||u.removeAttribute(n),iS.delete(u)),p||u.removeAttribute(r)}),S3--,S3||(mh=new WeakMap,mh=new WeakMap,iS=new WeakMap,sS={})}},aS=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),i=t||dAe(e);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live]"))),hAe(n,i,r,"aria-hidden")):function(){return null}};var ts=function(){return ts=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},ts.apply(this,arguments)};function oS(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function HK(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}var fS=ae(Je());var hi=ae(Je());var pf="right-scroll-bar-position",hf="width-before-scroll-bar",x3="with-scroll-bars-hidden",k3="--removed-body-scroll-bar-size";function WK(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}var JK=ae(Je());function GK(e,t){var r=(0,JK.useState)(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=t,r.facade}function E3(e,t){return GK(t||null,function(r){return e.forEach(function(n){return WK(n,r)})})}function gAe(e){return e}function yAe(e,t){t===void 0&&(t=gAe);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(s){var a=t(s,n);return r.push(a),function(){r=r.filter(function(o){return o!==a})}},assignSyncMedium:function(s){for(n=!0;r.length;){var a=r;r=[],a.forEach(s)}r={push:function(o){return s(o)},filter:function(){return r}}},assignMedium:function(s){n=!0;var a=[];if(r.length){var o=r;r=[],o.forEach(s),a=r}var l=function(){var f=a;a=[],f.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(f){a.push(f),c()},filter:function(f){return a=a.filter(f),r}}}};return i}function O3(e){e===void 0&&(e={});var t=yAe(null);return t.options=ts({async:!0,ssr:!1},e),t}var KK=ae(Je()),YK=function(e){var t=e.sideCar,r=oS(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return KK.createElement(n,ts({},r))};YK.isSideCarExport=!0;function A3(e,t){return e.useMedium(t),YK}var lS=O3();var T3=function(){},Pb=hi.forwardRef(function(e,t){var r=hi.useRef(null),n=hi.useState({onScrollCapture:T3,onWheelCapture:T3,onTouchMoveCapture:T3}),i=n[0],s=n[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,f=e.enabled,u=e.shards,d=e.sideCar,p=e.noIsolation,_=e.inert,w=e.allowPinchZoom,k=e.as,S=k===void 0?"div":k,O=oS(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),A=d,C=E3([r,t]),I=ts(ts({},O),i);return hi.createElement(hi.Fragment,null,f&&hi.createElement(A,{sideCar:lS,removeScrollBar:c,shards:u,noIsolation:p,inert:_,setCallbacks:s,allowPinchZoom:!!w,lockRef:r}),a?hi.cloneElement(hi.Children.only(o),ts(ts({},I),{ref:C})):hi.createElement(S,ts({},I,{className:l,ref:C}),o))});Pb.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Pb.classNames={fullWidth:hf,zeroRight:pf};var Br=ae(Je());var cS=ae(Je());var QK=ae(Je());var XK;var ZK=function(){if(XK)return XK;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function mAe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=ZK();return t&&e.setAttribute("nonce",t),e}function bAe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function vAe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var C3=function(){var e=0,t=null;return{add:function(r){e==0&&(t=mAe())&&(bAe(t,r),vAe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}};var I3=function(){var e=C3();return function(t,r){QK.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}};var Lb=function(){var e=I3(),t=function(r){var n=r.styles,i=r.dynamic;return e(n,i),null};return t};var _Ae={left:0,top:0,right:0,gap:0},N3=function(e){return parseInt(e||"",10)||0},wAe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[N3(r),N3(n),N3(i)]},P3=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return _Ae;var t=wAe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}};var SAe=Lb(),xAe=function(e,t,r,n){var i=e.left,s=e.top,a=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(x3,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(pf,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(hf,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(pf," .").concat(pf,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(hf," .").concat(hf,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body {
    `).concat(k3,": ").concat(o,`px;
  }
`)},L3=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,i=n===void 0?"margin":n,s=cS.useMemo(function(){return P3(i)},[i]);return cS.createElement(SAe,{styles:xAe(s,!t,i,r?"":"!important")})};var F3=!1;if(typeof window<"u")try{Fb=Object.defineProperty({},"passive",{get:function(){return F3=!0,!0}}),window.addEventListener("test",Fb,Fb),window.removeEventListener("test",Fb,Fb)}catch{F3=!1}var Fb,gf=F3?{passive:!1}:!1;var kAe=function(e){return e.tagName==="TEXTAREA"},eY=function(e,t){var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!kAe(e)&&r[t]==="visible")},EAe=function(e){return eY(e,"overflowY")},OAe=function(e){return eY(e,"overflowX")},D3=function(e,t){var r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var n=tY(e,r);if(n){var i=rY(e,r),s=i[1],a=i[2];if(s>a)return!0}r=r.parentNode}while(r&&r!==document.body);return!1},AAe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},TAe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},tY=function(e,t){return e==="v"?EAe(t):OAe(t)},rY=function(e,t){return e==="v"?AAe(t):TAe(t)},CAe=function(e,t){return e==="h"&&t==="rtl"?-1:1},nY=function(e,t,r,n,i){var s=CAe(e,window.getComputedStyle(t).direction),a=s*n,o=r.target,l=t.contains(o),c=!1,f=a>0,u=0,d=0;do{var p=rY(e,o),_=p[0],w=p[1],k=p[2],S=w-k-s*_;(_||S)&&tY(e,o)&&(u+=S,d+=_),o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(f&&(i&&u===0||!i&&a>u)||!f&&(i&&d===0||!i&&-a>d))&&(c=!0),c};var uS=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},iY=function(e){return[e.deltaX,e.deltaY]},sY=function(e){return e&&"current"in e?e.current:e},IAe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},NAe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},PAe=0,bh=[];function aY(e){var t=Br.useRef([]),r=Br.useRef([0,0]),n=Br.useRef(),i=Br.useState(PAe++)[0],s=Br.useState(function(){return Lb()})[0],a=Br.useRef(e);Br.useEffect(function(){a.current=e},[e]),Br.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var w=HK([e.lockRef.current],(e.shards||[]).map(sY),!0).filter(Boolean);return w.forEach(function(k){return k.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),w.forEach(function(k){return k.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var o=Br.useCallback(function(w,k){if("touches"in w&&w.touches.length===2)return!a.current.allowPinchZoom;var S=uS(w),O=r.current,A="deltaX"in w?w.deltaX:O[0]-S[0],C="deltaY"in w?w.deltaY:O[1]-S[1],I,D=w.target,L=Math.abs(A)>Math.abs(C)?"h":"v";if("touches"in w&&L==="h"&&D.type==="range")return!1;var U=D3(L,D);if(!U)return!0;if(U?I=L:(I=L==="v"?"h":"v",U=D3(L,D)),!U)return!1;if(!n.current&&"changedTouches"in w&&(A||C)&&(n.current=I),!I)return!0;var te=n.current||I;return nY(te,k,w,te==="h"?A:C,!0)},[]),l=Br.useCallback(function(w){var k=w;if(!(!bh.length||bh[bh.length-1]!==s)){var S="deltaY"in k?iY(k):uS(k),O=t.current.filter(function(I){return I.name===k.type&&I.target===k.target&&IAe(I.delta,S)})[0];if(O&&O.should){k.cancelable&&k.preventDefault();return}if(!O){var A=(a.current.shards||[]).map(sY).filter(Boolean).filter(function(I){return I.contains(k.target)}),C=A.length>0?o(k,A[0]):!a.current.noIsolation;C&&k.cancelable&&k.preventDefault()}}},[]),c=Br.useCallback(function(w,k,S,O){var A={name:w,delta:k,target:S,should:O};t.current.push(A),setTimeout(function(){t.current=t.current.filter(function(C){return C!==A})},1)},[]),f=Br.useCallback(function(w){r.current=uS(w),n.current=void 0},[]),u=Br.useCallback(function(w){c(w.type,iY(w),w.target,o(w,e.lockRef.current))},[]),d=Br.useCallback(function(w){c(w.type,uS(w),w.target,o(w,e.lockRef.current))},[]);Br.useEffect(function(){return bh.push(s),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:d}),document.addEventListener("wheel",l,gf),document.addEventListener("touchmove",l,gf),document.addEventListener("touchstart",f,gf),function(){bh=bh.filter(function(w){return w!==s}),document.removeEventListener("wheel",l,gf),document.removeEventListener("touchmove",l,gf),document.removeEventListener("touchstart",f,gf)}},[]);var p=e.removeScrollBar,_=e.inert;return Br.createElement(Br.Fragment,null,_?Br.createElement(s,{styles:NAe(i)}):null,p?Br.createElement(L3,{gapMode:"margin"}):null)}var oY=A3(lS,aY);var lY=fS.forwardRef(function(e,t){return fS.createElement(Pb,ts({},e,{ref:t,sideCar:oY}))});lY.classNames=Pb.classNames;var Db=lY;var j3=["Enter"," "],FAe=["ArrowDown","PageUp","Home"],uY=["ArrowUp","PageDown","End"],DAe=[...FAe,...uY],jAe={ltr:[...j3,"ArrowRight"],rtl:[...j3,"ArrowLeft"]},BAe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},hS="Menu",[jb,MAe,RAe]=jd(hS),[yf,M3]=oi(hS,[RAe,yh,Rd]),R3=yh(),fY=Rd(),[$Ae,mf]=yf(hS),[UAe,Mb]=yf(hS),zAe=e=>{let{__scopeMenu:t,open:r=!1,children:n,dir:i,onOpenChange:s,modal:a=!0}=e,o=R3(t),[l,c]=(0,He.useState)(null),f=(0,He.useRef)(!1),u=cn(s),d=Wl(i);return(0,He.useEffect)(()=>{let p=()=>{f.current=!0,document.addEventListener("pointerdown",_,{capture:!0,once:!0}),document.addEventListener("pointermove",_,{capture:!0,once:!0})},_=()=>f.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",_,{capture:!0}),document.removeEventListener("pointermove",_,{capture:!0})}},[]),(0,He.createElement)(Q1,o,(0,He.createElement)($Ae,{scope:t,open:r,onOpenChange:u,content:l,onContentChange:c},(0,He.createElement)(UAe,{scope:t,onClose:(0,He.useCallback)(()=>u(!1),[u]),isUsingKeyboardRef:f,dir:d,modal:a},n)))};var dY=(0,He.forwardRef)((e,t)=>{let{__scopeMenu:r,...n}=e,i=R3(r);return(0,He.createElement)(eS,Ye({},i,n,{ref:t}))}),pY="MenuPortal",[qAe,hY]=yf(pY,{forceMount:void 0}),VAe=e=>{let{__scopeMenu:t,forceMount:r,children:n,container:i}=e,s=mf(pY,t);return(0,He.createElement)(qAe,{scope:t,forceMount:r},(0,He.createElement)(Jl,{present:r||s.open},(0,He.createElement)(nS,{asChild:!0,container:i},n)))},Oa="MenuContent",[HAe,$3]=yf(Oa),WAe=(0,He.forwardRef)((e,t)=>{let r=hY(Oa,e.__scopeMenu),{forceMount:n=r.forceMount,...i}=e,s=mf(Oa,e.__scopeMenu),a=Mb(Oa,e.__scopeMenu);return(0,He.createElement)(jb.Provider,{scope:e.__scopeMenu},(0,He.createElement)(Jl,{present:n||s.open},(0,He.createElement)(jb.Slot,{scope:e.__scopeMenu},a.modal?(0,He.createElement)(JAe,Ye({},i,{ref:t})):(0,He.createElement)(GAe,Ye({},i,{ref:t})))))}),JAe=(0,He.forwardRef)((e,t)=>{let r=mf(Oa,e.__scopeMenu),n=(0,He.useRef)(null),i=hr(t,n);return(0,He.useEffect)(()=>{let s=n.current;if(s)return aS(s)},[]),(0,He.createElement)(U3,Ye({},e,{ref:i,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:gt(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)}))}),GAe=(0,He.forwardRef)((e,t)=>{let r=mf(Oa,e.__scopeMenu);return(0,He.createElement)(U3,Ye({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)}))}),U3=(0,He.forwardRef)((e,t)=>{let{__scopeMenu:r,loop:n=!1,trapFocus:i,onOpenAutoFocus:s,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:u,onInteractOutside:d,onDismiss:p,disableOutsideScroll:_,...w}=e,k=mf(Oa,r),S=Mb(Oa,r),O=R3(r),A=fY(r),C=MAe(r),[I,D]=(0,He.useState)(null),L=(0,He.useRef)(null),U=hr(t,L,k.onContentChange),te=(0,He.useRef)(0),V=(0,He.useRef)(""),X=(0,He.useRef)(0),Z=(0,He.useRef)(null),se=(0,He.useRef)("right"),pe=(0,He.useRef)(0),de=_?Db:He.Fragment,F=_?{as:Bs,allowPinchZoom:!0}:void 0,H=R=>{var $,q;let ie=V.current+R,oe=C().filter(we=>!we.disabled),fe=document.activeElement,_e=($=oe.find(we=>we.ref.current===fe))===null||$===void 0?void 0:$.textValue,Ee=oe.map(we=>we.textValue),Se=fTe(Ee,ie,_e),le=(q=oe.find(we=>we.textValue===Se))===null||q===void 0?void 0:q.ref.current;(function we(W){V.current=W,window.clearTimeout(te.current),W!==""&&(te.current=window.setTimeout(()=>we(""),1e3))})(ie),le&&setTimeout(()=>le.focus())};(0,He.useEffect)(()=>()=>window.clearTimeout(te.current),[]),B1();let Q=(0,He.useCallback)(R=>{var $,q;return se.current===(($=Z.current)===null||$===void 0?void 0:$.side)&&pTe(R,(q=Z.current)===null||q===void 0?void 0:q.area)},[]);return(0,He.createElement)(HAe,{scope:r,searchRef:V,onItemEnter:(0,He.useCallback)(R=>{Q(R)&&R.preventDefault()},[Q]),onItemLeave:(0,He.useCallback)(R=>{var $;Q(R)||(($=L.current)===null||$===void 0||$.focus(),D(null))},[Q]),onTriggerLeave:(0,He.useCallback)(R=>{Q(R)&&R.preventDefault()},[Q]),pointerGraceTimerRef:X,onPointerGraceIntentChange:(0,He.useCallback)(R=>{Z.current=R},[])},(0,He.createElement)(de,F,(0,He.createElement)(M1,{asChild:!0,trapped:i,onMountAutoFocus:gt(s,R=>{var $;R.preventDefault(),($=L.current)===null||$===void 0||$.focus()}),onUnmountAutoFocus:a},(0,He.createElement)(j1,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:u,onInteractOutside:d,onDismiss:p},(0,He.createElement)(U0,Ye({asChild:!0},A,{dir:S.dir,orientation:"vertical",loop:n,currentTabStopId:I,onCurrentTabStopIdChange:D,onEntryFocus:gt(l,R=>{S.isUsingKeyboardRef.current||R.preventDefault()})}),(0,He.createElement)(tS,Ye({role:"menu","aria-orientation":"vertical","data-state":vY(k.open),"data-radix-menu-content":"",dir:S.dir},O,w,{ref:U,style:{outline:"none",...w.style},onKeyDown:gt(w.onKeyDown,R=>{let q=R.target.closest("[data-radix-menu-content]")===R.currentTarget,ie=R.ctrlKey||R.altKey||R.metaKey,oe=R.key.length===1;q&&(R.key==="Tab"&&R.preventDefault(),!ie&&oe&&H(R.key));let fe=L.current;if(R.target!==fe||!DAe.includes(R.key))return;R.preventDefault();let Ee=C().filter(Se=>!Se.disabled).map(Se=>Se.ref.current);uY.includes(R.key)&&Ee.reverse(),cTe(Ee)}),onBlur:gt(e.onBlur,R=>{R.currentTarget.contains(R.target)||(window.clearTimeout(te.current),V.current="")}),onPointerMove:gt(e.onPointerMove,Bb(R=>{let $=R.target,q=pe.current!==R.clientX;if(R.currentTarget.contains($)&&q){let ie=R.clientX>pe.current?"right":"left";se.current=ie,pe.current=R.clientX}}))})))))))});var KAe=(0,He.forwardRef)((e,t)=>{let{__scopeMenu:r,...n}=e;return(0,He.createElement)(Tt.div,Ye({role:"group"},n,{ref:t}))});var YAe=(0,He.forwardRef)((e,t)=>{let{__scopeMenu:r,...n}=e;return(0,He.createElement)(Tt.div,Ye({},n,{ref:t}))}),B3="MenuItem",cY="menu.itemSelect",z3=(0,He.forwardRef)((e,t)=>{let{disabled:r=!1,onSelect:n,...i}=e,s=(0,He.useRef)(null),a=Mb(B3,e.__scopeMenu),o=$3(B3,e.__scopeMenu),l=hr(t,s),c=(0,He.useRef)(!1),f=()=>{let u=s.current;if(!r&&u){let d=new CustomEvent(cY,{bubbles:!0,cancelable:!0});u.addEventListener(cY,p=>n?.(p),{once:!0}),$0(u,d),d.defaultPrevented?c.current=!1:a.onClose()}};return(0,He.createElement)(gY,Ye({},i,{ref:l,disabled:r,onClick:gt(e.onClick,f),onPointerDown:u=>{var d;(d=e.onPointerDown)===null||d===void 0||d.call(e,u),c.current=!0},onPointerUp:gt(e.onPointerUp,u=>{var d;c.current||(d=u.currentTarget)===null||d===void 0||d.click()}),onKeyDown:gt(e.onKeyDown,u=>{let d=o.searchRef.current!=="";r||d&&u.key===" "||j3.includes(u.key)&&(u.currentTarget.click(),u.preventDefault())})}))}),gY=(0,He.forwardRef)((e,t)=>{let{__scopeMenu:r,disabled:n=!1,textValue:i,...s}=e,a=$3(B3,r),o=fY(r),l=(0,He.useRef)(null),c=hr(t,l),[f,u]=(0,He.useState)(!1),[d,p]=(0,He.useState)("");return(0,He.useEffect)(()=>{let _=l.current;if(_){var w;p(((w=_.textContent)!==null&&w!==void 0?w:"").trim())}},[s.children]),(0,He.createElement)(jb.ItemSlot,{scope:r,disabled:n,textValue:i??d},(0,He.createElement)(z0,Ye({asChild:!0},o,{focusable:!n}),(0,He.createElement)(Tt.div,Ye({role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0},s,{ref:c,onPointerMove:gt(e.onPointerMove,Bb(_=>{n?a.onItemLeave(_):(a.onItemEnter(_),_.defaultPrevented||_.currentTarget.focus())})),onPointerLeave:gt(e.onPointerLeave,Bb(_=>a.onItemLeave(_))),onFocus:gt(e.onFocus,()=>u(!0)),onBlur:gt(e.onBlur,()=>u(!1))}))))});var XAe=(0,He.forwardRef)((e,t)=>{let{checked:r=!1,onCheckedChange:n,...i}=e;return(0,He.createElement)(mY,{scope:e.__scopeMenu,checked:r},(0,He.createElement)(z3,Ye({role:"menuitemcheckbox","aria-checked":pS(r)?"mixed":r},i,{ref:t,"data-state":q3(r),onSelect:gt(i.onSelect,()=>n?.(pS(r)?!0:!r),{checkForDefaultPrevented:!1})})))}),ZAe="MenuRadioGroup",[EKe,QAe]=yf(ZAe,{value:void 0,onValueChange:()=>{}});var eTe="MenuRadioItem",tTe=(0,He.forwardRef)((e,t)=>{let{value:r,...n}=e,i=QAe(eTe,e.__scopeMenu),s=r===i.value;return(0,He.createElement)(mY,{scope:e.__scopeMenu,checked:s},(0,He.createElement)(z3,Ye({role:"menuitemradio","aria-checked":s},n,{ref:t,"data-state":q3(s),onSelect:gt(n.onSelect,()=>{var a;return(a=i.onValueChange)===null||a===void 0?void 0:a.call(i,r)},{checkForDefaultPrevented:!1})})))}),yY="MenuItemIndicator",[mY,rTe]=yf(yY,{checked:!1}),nTe=(0,He.forwardRef)((e,t)=>{let{__scopeMenu:r,forceMount:n,...i}=e,s=rTe(yY,r);return(0,He.createElement)(Jl,{present:n||pS(s.checked)||s.checked===!0},(0,He.createElement)(Tt.span,Ye({},i,{ref:t,"data-state":q3(s.checked)})))});var iTe=(0,He.forwardRef)((e,t)=>{let{__scopeMenu:r,...n}=e;return(0,He.createElement)(Tt.div,Ye({role:"separator","aria-orientation":"horizontal"},n,{ref:t}))});var sTe="MenuSub",[OKe,bY]=yf(sTe);var dS="MenuSubTrigger",aTe=(0,He.forwardRef)((e,t)=>{let r=mf(dS,e.__scopeMenu),n=Mb(dS,e.__scopeMenu),i=bY(dS,e.__scopeMenu),s=$3(dS,e.__scopeMenu),a=(0,He.useRef)(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=s,c={__scopeMenu:e.__scopeMenu},f=(0,He.useCallback)(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return(0,He.useEffect)(()=>f,[f]),(0,He.useEffect)(()=>{let u=o.current;return()=>{window.clearTimeout(u),l(null)}},[o,l]),(0,He.createElement)(dY,Ye({asChild:!0},c),(0,He.createElement)(gY,Ye({id:i.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":i.contentId,"data-state":vY(r.open)},e,{ref:xu(t,i.onTriggerChange),onClick:u=>{var d;(d=e.onClick)===null||d===void 0||d.call(e,u),!(e.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:gt(e.onPointerMove,Bb(u=>{s.onItemEnter(u),!u.defaultPrevented&&!e.disabled&&!r.open&&!a.current&&(s.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{r.onOpenChange(!0),f()},100))})),onPointerLeave:gt(e.onPointerLeave,Bb(u=>{var d;f();let p=(d=r.content)===null||d===void 0?void 0:d.getBoundingClientRect();if(p){var _;let w=(_=r.content)===null||_===void 0?void 0:_.dataset.side,k=w==="right",S=k?-5:5,O=p[k?"left":"right"],A=p[k?"right":"left"];s.onPointerGraceIntentChange({area:[{x:u.clientX+S,y:u.clientY},{x:O,y:p.top},{x:A,y:p.top},{x:A,y:p.bottom},{x:O,y:p.bottom}],side:w}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(u),u.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:gt(e.onKeyDown,u=>{let d=s.searchRef.current!=="";if(!(e.disabled||d&&u.key===" ")&&jAe[n.dir].includes(u.key)){var p;r.onOpenChange(!0),(p=r.content)===null||p===void 0||p.focus(),u.preventDefault()}})})))}),oTe="MenuSubContent",lTe=(0,He.forwardRef)((e,t)=>{let r=hY(Oa,e.__scopeMenu),{forceMount:n=r.forceMount,...i}=e,s=mf(Oa,e.__scopeMenu),a=Mb(Oa,e.__scopeMenu),o=bY(oTe,e.__scopeMenu),l=(0,He.useRef)(null),c=hr(t,l);return(0,He.createElement)(jb.Provider,{scope:e.__scopeMenu},(0,He.createElement)(Jl,{present:n||s.open},(0,He.createElement)(jb.Slot,{scope:e.__scopeMenu},(0,He.createElement)(U3,Ye({id:o.contentId,"aria-labelledby":o.triggerId},i,{ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var u;a.isUsingKeyboardRef.current&&((u=l.current)===null||u===void 0||u.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:gt(e.onFocusOutside,f=>{f.target!==o.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:gt(e.onEscapeKeyDown,f=>{a.onClose(),f.preventDefault()}),onKeyDown:gt(e.onKeyDown,f=>{let u=f.currentTarget.contains(f.target),d=BAe[a.dir].includes(f.key);if(u&&d){var p;s.onOpenChange(!1),(p=o.trigger)===null||p===void 0||p.focus(),f.preventDefault()}})})))))});function vY(e){return e?"open":"closed"}function pS(e){return e==="indeterminate"}function q3(e){return pS(e)?"indeterminate":e?"checked":"unchecked"}function cTe(e){let t=document.activeElement;for(let r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function uTe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function fTe(e,t,r){let i=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=r?e.indexOf(r):-1,a=uTe(e,Math.max(s,0));i.length===1&&(a=a.filter(c=>c!==r));let l=a.find(c=>c.toLowerCase().startsWith(i.toLowerCase()));return l!==r?l:void 0}function dTe(e,t){let{x:r,y:n}=e,i=!1;for(let s=0,a=t.length-1;s<t.length;a=s++){let o=t[s].x,l=t[s].y,c=t[a].x,f=t[a].y;l>n!=f>n&&r<(c-o)*(n-l)/(f-l)+o&&(i=!i)}return i}function pTe(e,t){if(!t)return!1;let r={x:e.clientX,y:e.clientY};return dTe(r,t)}function Bb(e){return t=>t.pointerType==="mouse"?e(t):void 0}var _Y=zAe,wY=dY,SY=VAe,xY=WAe,kY=KAe,EY=YAe,OY=z3,AY=XAe;var TY=tTe,CY=nTe,IY=iTe;var NY=aTe,PY=lTe;var LY="DropdownMenu",[hTe,RKe]=oi(LY,[M3]),ks=M3(),[gTe,FY]=hTe(LY),yTe=e=>{let{__scopeDropdownMenu:t,children:r,dir:n,open:i,defaultOpen:s,onOpenChange:a,modal:o=!0}=e,l=ks(t),c=(0,Xt.useRef)(null),[f=!1,u]=$o({prop:i,defaultProp:s,onChange:a});return(0,Xt.createElement)(gTe,{scope:t,triggerId:da(),triggerRef:c,contentId:da(),open:f,onOpenChange:u,onOpenToggle:(0,Xt.useCallback)(()=>u(d=>!d),[u]),modal:o},(0,Xt.createElement)(_Y,Ye({},l,{open:f,onOpenChange:u,dir:n,modal:o}),r))},mTe="DropdownMenuTrigger",bTe=(0,Xt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,disabled:n=!1,...i}=e,s=FY(mTe,r),a=ks(r);return(0,Xt.createElement)(wY,Ye({asChild:!0},a),(0,Xt.createElement)(Tt.button,Ye({type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":n?"":void 0,disabled:n},i,{ref:xu(t,s.triggerRef),onPointerDown:gt(e.onPointerDown,o=>{!n&&o.button===0&&o.ctrlKey===!1&&(s.onOpenToggle(),s.open||o.preventDefault())}),onKeyDown:gt(e.onKeyDown,o=>{n||(["Enter"," "].includes(o.key)&&s.onOpenToggle(),o.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})))});var vTe=e=>{let{__scopeDropdownMenu:t,...r}=e,n=ks(t);return(0,Xt.createElement)(SY,Ye({},n,r))},_Te="DropdownMenuContent",wTe=(0,Xt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=FY(_Te,r),s=ks(r),a=(0,Xt.useRef)(!1);return(0,Xt.createElement)(xY,Ye({id:i.contentId,"aria-labelledby":i.triggerId},s,n,{ref:t,onCloseAutoFocus:gt(e.onCloseAutoFocus,o=>{var l;a.current||(l=i.triggerRef.current)===null||l===void 0||l.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:gt(e.onInteractOutside,o=>{let l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,f=l.button===2||c;(!i.modal||f)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))});var STe=(0,Xt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=ks(r);return(0,Xt.createElement)(kY,Ye({},i,n,{ref:t}))});var xTe=(0,Xt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=ks(r);return(0,Xt.createElement)(EY,Ye({},i,n,{ref:t}))});var kTe=(0,Xt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=ks(r);return(0,Xt.createElement)(OY,Ye({},i,n,{ref:t}))});var ETe=(0,Xt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=ks(r);return(0,Xt.createElement)(AY,Ye({},i,n,{ref:t}))});var OTe=(0,Xt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=ks(r);return(0,Xt.createElement)(TY,Ye({},i,n,{ref:t}))});var ATe=(0,Xt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=ks(r);return(0,Xt.createElement)(CY,Ye({},i,n,{ref:t}))});var TTe=(0,Xt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=ks(r);return(0,Xt.createElement)(IY,Ye({},i,n,{ref:t}))});var CTe=(0,Xt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=ks(r);return(0,Xt.createElement)(NY,Ye({},i,n,{ref:t}))});var ITe=(0,Xt.forwardRef)((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,i=ks(r);return(0,Xt.createElement)(PY,Ye({},i,n,{ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),DY=yTe,jY=bTe,BY=vTe,V3=wTe,MY=STe,H3=xTe,W3=kTe,J3=ETe;var G3=OTe,K3=ATe,Y3=TTe;var X3=CTe,Z3=ITe;var An=ae(vt(),1),RY=DY,$Y=jY,UY=MY;var PTe=al.forwardRef(({className:e,inset:t,children:r,...n},i)=>(0,An.jsxs)(X3,{ref:i,className:Lt("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,(0,An.jsx)(yb,{className:"ml-auto h-4 w-4"})]}));PTe.displayName=X3.displayName;var LTe=al.forwardRef(({className:e,...t},r)=>(0,An.jsx)(Z3,{ref:r,className:Lt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1",e),...t}));LTe.displayName=Z3.displayName;var Q3=al.forwardRef(({className:e,sideOffset:t=4,...r},n)=>(0,An.jsx)(BY,{children:(0,An.jsx)(V3,{ref:n,sideOffset:t,className:Lt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));Q3.displayName=V3.displayName;var vh=al.forwardRef(({className:e,inset:t,...r},n)=>(0,An.jsx)(W3,{ref:n,className:Lt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));vh.displayName=W3.displayName;var FTe=al.forwardRef(({className:e,children:t,checked:r,...n},i)=>(0,An.jsxs)(J3,{ref:i,className:Lt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[(0,An.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,An.jsx)(K3,{children:(0,An.jsx)(af,{className:"h-4 w-4"})})}),t]}));FTe.displayName=J3.displayName;var DTe=al.forwardRef(({className:e,children:t,...r},n)=>(0,An.jsxs)(G3,{ref:n,className:Lt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[(0,An.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,An.jsx)(K3,{children:(0,An.jsx)(mb,{className:"h-2 w-2 fill-current"})})}),t]}));DTe.displayName=G3.displayName;var eP=al.forwardRef(({className:e,inset:t,...r},n)=>(0,An.jsx)(H3,{ref:n,className:Lt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));eP.displayName=H3.displayName;var gS=al.forwardRef(({className:e,...t},r)=>(0,An.jsx)(Y3,{ref:r,className:Lt("-mx-1 my-1 h-px bg-muted",e),...t}));gS.displayName=Y3.displayName;var _h=({className:e,...t})=>(0,An.jsx)("span",{className:Lt("ml-auto text-xs tracking-widest opacity-60",e),...t});_h.displayName="DropdownMenuShortcut";var Ht=ae(vt(),1);function zY(){return(0,Ht.jsxs)(RY,{children:[(0,Ht.jsx)($Y,{asChild:!0,children:(0,Ht.jsx)(lf,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,Ht.jsxs)(cb,{className:"h-8 w-8",children:[(0,Ht.jsx)(ub,{src:"/avatars/01.png",alt:"@shadcn"}),(0,Ht.jsx)(fb,{children:"GF"})]})})}),(0,Ht.jsxs)(Q3,{className:"w-56",align:"end",forceMount:!0,children:[(0,Ht.jsx)(eP,{className:"font-normal",children:(0,Ht.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,Ht.jsx)("p",{className:"text-sm font-medium leading-none",children:"Garrett Flynn"}),(0,Ht.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:"GarrettFlynn@hypergamma.co.uk"})]})}),(0,Ht.jsx)(gS,{}),(0,Ht.jsxs)(UY,{children:[(0,Ht.jsx)(Ja,{to:"/profile",className:"disabled",children:(0,Ht.jsxs)(vh,{children:[(0,Ht.jsx)(Tb,{className:"mr-2 h-4 w-4"}),(0,Ht.jsx)("span",{children:"Profile"}),(0,Ht.jsx)(_h,{children:"\u21E7\u2318P"})]})}),(0,Ht.jsx)(Ja,{to:"/billing",className:"disabled",children:(0,Ht.jsxs)(vh,{children:[(0,Ht.jsx)(of,{className:"mr-2 h-4 w-4"}),(0,Ht.jsx)("span",{children:"Billing"}),(0,Ht.jsx)(_h,{children:"\u2318B"})]})}),(0,Ht.jsx)(Ja,{to:"/settings",className:"disabled",children:(0,Ht.jsxs)(vh,{children:[(0,Ht.jsx)(Ab,{className:"mr-2 h-4 w-4"}),(0,Ht.jsx)("span",{children:"Settings"}),(0,Ht.jsx)(_h,{children:"\u2318S"})]})})]}),(0,Ht.jsx)(gS,{}),(0,Ht.jsxs)(vh,{children:[(0,Ht.jsx)(kb,{className:"mr-2 h-4 w-4"}),(0,Ht.jsx)("span",{children:"Log out"}),(0,Ht.jsx)(_h,{children:"\u21E7\u2318Q"})]})]})]})}var gc=ae(vt(),1);function fo(){return(0,gc.jsx)("div",{className:"border-b sticky top-0 left-0 bg-background z-10",children:(0,gc.jsxs)("div",{className:"flex h-16 items-center px-4",children:[(0,gc.jsx)("span",{className:"font-semibold text-xl tracking-tight",children:"Hypergamma"}),(0,gc.jsx)(VG,{className:"mx-6"}),(0,gc.jsx)("div",{className:"ml-auto flex items-center space-x-4",children:(0,gc.jsx)(zY,{})})]})})}var mr=ae(vt(),1),jTe=(e=0)=>{let t=new Date;return t.setDate(t.getDate()+e),t.toDateString()},BTe=()=>(2*Math.random()-1)*.7,qY=Array.from({length:12},(e,t)=>({name:jTe(-(t+1)),total:BTe()}));function tP(){return(0,mr.jsxs)(mr.Fragment,{children:[(0,mr.jsx)(fo,{}),(0,mr.jsx)("div",{className:"flex-col md:flex",children:(0,mr.jsx)("div",{className:"flex-1 space-y-4 p-8 pt-6",children:(0,mr.jsxs)(C4,{defaultValue:"overview",className:"space-y-4",children:[(0,mr.jsxs)(xA,{children:[(0,mr.jsx)($d,{value:"overview",children:"Overview"}),(0,mr.jsx)($d,{value:"analytics",children:"Analytics"}),(0,mr.jsx)($d,{value:"reports",disabled:!0,children:"Reports"}),(0,mr.jsx)($d,{value:"experiments",disabled:!0,children:"Experiments"})]}),(0,mr.jsx)(H0,{value:"overview",className:"space-y-4",children:(0,mr.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[(0,mr.jsxs)(Pd,{className:"col-span-4",children:[(0,mr.jsx)(Ld,{children:(0,mr.jsx)(Fd,{children:"Overview"})}),(0,mr.jsx)(Dd,{className:"pl-2",children:(0,mr.jsx)(RG,{toPlot:qY.slice().reverse()})})]}),(0,mr.jsxs)(Pd,{className:"col-span-3",children:[(0,mr.jsxs)(Ld,{children:[(0,mr.jsx)(Fd,{children:"Recent Sessions"}),(0,mr.jsx)(pA,{children:"You had 20 sessions in the last 30 days."})]}),(0,mr.jsx)(Dd,{children:(0,mr.jsx)(zG,{data:qY})})]})]})}),(0,mr.jsx)(H0,{value:"analytics",className:"space-y-4",children:(0,mr.jsx)(l3,{})})]})})})]})}var yc=ae(vt(),1);function rP(){let e=B0();return console.error(e),(0,yc.jsx)("div",{id:"error-page",children:(0,yc.jsxs)("div",{children:[(0,yc.jsx)("h1",{children:"Oops!"}),(0,yc.jsx)("p",{children:"Sorry, an unexpected error has occurred."}),(0,yc.jsx)("p",{children:(0,yc.jsx)("i",{children:e.statusText||e.message})})]})})}var WY=ae(Je(),1);var yS=ae(Je(),1);var nP="horizontal",MTe=["horizontal","vertical"],VY=(0,yS.forwardRef)((e,t)=>{let{decorative:r,orientation:n=nP,...i}=e,s=HY(n)?n:nP,o=r?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return(0,yS.createElement)(Tt.div,Ye({"data-orientation":s},o,i,{ref:t}))});VY.propTypes={orientation(e,t,r){let n=e[t],i=String(n);return n&&!HY(n)?new Error(RTe(i,r)):null}};function RTe(e,t){return`Invalid prop \`orientation\` of value \`${e}\` supplied to \`${t}\`, expected one of:
  - horizontal
  - vertical

Defaulting to \`${nP}\`.`}function HY(e){return MTe.includes(e)}var iP=VY;var JY=ae(vt(),1),sP=WY.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},i)=>(0,JY.jsx)(iP,{ref:i,decorative:r,orientation:t,className:Lt("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));sP.displayName=iP.displayName;var aP=ae(vt(),1);function GY({className:e,items:t,...r}){return(0,aP.jsx)("nav",{className:Lt("flex space-x-2 lg:flex-col lg:space-x-0 lg:space-y-1",e),...r,children:t.map(n=>(0,aP.jsx)(Ja,{to:n.href,className:Lt(fh({variant:"ghost"}),"hover:bg-transparent hover:underline","justify-start"),children:n.title},n.href))})}var rs=ae(vt(),1),UTe=[{title:"Profile",href:"/settings"},{title:"Account",href:"/settings/account"},{title:"Appearance",href:"/settings/appearance"},{title:"Notifications",href:"/settings/notifications"},{title:"Display",href:"/settings/display"}];function oP(){return(0,rs.jsxs)(rs.Fragment,{children:[(0,rs.jsx)(fo,{}),(0,rs.jsxs)("div",{className:"space-y-6 p-10 pb-16 md:block",children:[(0,rs.jsxs)("div",{className:"space-y-0.5",children:[(0,rs.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Settings"}),(0,rs.jsx)("p",{className:"text-muted-foreground",children:"Manage your account settings and set e-mail preferences."})]}),(0,rs.jsx)(sP,{className:"my-6"}),(0,rs.jsx)("div",{className:"flex flex-col space-y-8 lg:flex-row lg:space-x-12 lg:space-y-0",children:(0,rs.jsx)("aside",{className:"-mx-4 lg:w-1/5",children:(0,rs.jsx)(GY,{items:UTe})})})]})]})}var xh=ae(Je(),1);var $e=ae(Je(),1),uP=ae(Va(),1);function lP(e,[t,r]){return Math.min(r,Math.max(t,e))}var mS=ae(Je(),1);function KY(e){let t=(0,mS.useRef)({value:e,previous:e});return(0,mS.useMemo)(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var bS=ae(Je(),1);var YY=(0,bS.forwardRef)((e,t)=>(0,bS.createElement)(Tt.span,Ye({},e,{ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}})));var zTe=[" ","Enter","ArrowUp","ArrowDown"],qTe=[" ","Enter"],_S="Select",[wS,fP,VTe]=jd(_S),[Sh,ZYe]=oi(_S,[VTe,yh]),dP=yh(),[HTe,bf]=Sh(_S),[WTe,JTe]=Sh(_S),GTe=e=>{let{__scopeSelect:t,children:r,open:n,defaultOpen:i,onOpenChange:s,value:a,defaultValue:o,onValueChange:l,dir:c,name:f,autoComplete:u,disabled:d,required:p}=e,_=dP(t),[w,k]=(0,$e.useState)(null),[S,O]=(0,$e.useState)(null),[A,C]=(0,$e.useState)(!1),I=Wl(c),[D=!1,L]=$o({prop:n,defaultProp:i,onChange:s}),[U,te]=$o({prop:a,defaultProp:o,onChange:l}),V=(0,$e.useRef)(null),X=w?!!w.closest("form"):!0,[Z,se]=(0,$e.useState)(new Set),pe=Array.from(Z).map(de=>de.props.value).join(";");return(0,$e.createElement)(Q1,_,(0,$e.createElement)(HTe,{required:p,scope:t,trigger:w,onTriggerChange:k,valueNode:S,onValueNodeChange:O,valueNodeHasChildren:A,onValueNodeHasChildrenChange:C,contentId:da(),value:U,onValueChange:te,open:D,onOpenChange:L,dir:I,triggerPointerDownPosRef:V,disabled:d},(0,$e.createElement)(wS.Provider,{scope:t},(0,$e.createElement)(WTe,{scope:e.__scopeSelect,onNativeOptionAdd:(0,$e.useCallback)(de=>{se(F=>new Set(F).add(de))},[]),onNativeOptionRemove:(0,$e.useCallback)(de=>{se(F=>{let H=new Set(F);return H.delete(de),H})},[])},r)),X?(0,$e.createElement)(tX,{key:pe,"aria-hidden":!0,required:p,tabIndex:-1,name:f,autoComplete:u,value:U,onChange:de=>te(de.target.value),disabled:d},U===void 0?(0,$e.createElement)("option",{value:""}):null,Array.from(Z)):null))},KTe="SelectTrigger",YTe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,disabled:n=!1,...i}=e,s=dP(r),a=bf(KTe,r),o=a.disabled||n,l=hr(t,a.onTriggerChange),c=fP(r),[f,u,d]=rX(_=>{let w=c().filter(O=>!O.disabled),k=w.find(O=>O.value===a.value),S=nX(w,_,k);S!==void 0&&a.onValueChange(S.value)}),p=()=>{o||(a.onOpenChange(!0),d())};return(0,$e.createElement)(eS,Ye({asChild:!0},s),(0,$e.createElement)(Tt.button,Ye({type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":a.value===void 0?"":void 0},i,{ref:l,onClick:gt(i.onClick,_=>{_.currentTarget.focus()}),onPointerDown:gt(i.onPointerDown,_=>{let w=_.target;w.hasPointerCapture(_.pointerId)&&w.releasePointerCapture(_.pointerId),_.button===0&&_.ctrlKey===!1&&(p(),a.triggerPointerDownPosRef.current={x:Math.round(_.pageX),y:Math.round(_.pageY)},_.preventDefault())}),onKeyDown:gt(i.onKeyDown,_=>{let w=f.current!=="";!(_.ctrlKey||_.altKey||_.metaKey)&&_.key.length===1&&u(_.key),!(w&&_.key===" ")&&zTe.includes(_.key)&&(p(),_.preventDefault())})})))}),XTe="SelectValue",ZTe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,className:n,style:i,children:s,placeholder:a,...o}=e,l=bf(XTe,r),{onValueNodeHasChildrenChange:c}=l,f=s!==void 0,u=hr(t,l.onValueNodeChange);return Nn(()=>{c(f)},[c,f]),(0,$e.createElement)(Tt.span,Ye({},o,{ref:u,style:{pointerEvents:"none"}}),l.value===void 0&&a!==void 0?a:s)});var QTe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,children:n,...i}=e;return(0,$e.createElement)(Tt.span,Ye({"aria-hidden":!0},i,{ref:t}),n||"\u25BC")});var eCe=e=>(0,$e.createElement)(nS,Ye({asChild:!0},e)),wh="SelectContent",tCe=(0,$e.forwardRef)((e,t)=>{let r=bf(wh,e.__scopeSelect),[n,i]=(0,$e.useState)();if(Nn(()=>{i(new DocumentFragment)},[]),!r.open){let s=n;return s?(0,uP.createPortal)((0,$e.createElement)(QY,{scope:e.__scopeSelect},(0,$e.createElement)(wS.Slot,{scope:e.__scopeSelect},(0,$e.createElement)("div",null,e.children))),s):null}return(0,$e.createElement)(rCe,Ye({},e,{ref:t}))}),ol=10,[QY,SS]=Sh(wh);var rCe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:s,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:f,arrowPadding:u,collisionBoundary:d,collisionPadding:p,sticky:_,hideWhenDetached:w,avoidCollisions:k,...S}=e,O=bf(wh,r),[A,C]=(0,$e.useState)(null),[I,D]=(0,$e.useState)(null),L=hr(t,Se=>C(Se)),[U,te]=(0,$e.useState)(null),[V,X]=(0,$e.useState)(null),Z=fP(r),[se,pe]=(0,$e.useState)(!1),de=(0,$e.useRef)(!1);(0,$e.useEffect)(()=>{if(A)return aS(A)},[A]),B1();let F=(0,$e.useCallback)(Se=>{let[le,...we]=Z().map(ne=>ne.ref.current),[W]=we.slice(-1),J=document.activeElement;for(let ne of Se)if(ne===J||(ne?.scrollIntoView({block:"nearest"}),ne===le&&I&&(I.scrollTop=0),ne===W&&I&&(I.scrollTop=I.scrollHeight),ne?.focus(),document.activeElement!==J))return},[Z,I]),H=(0,$e.useCallback)(()=>F([U,A]),[F,U,A]);(0,$e.useEffect)(()=>{se&&H()},[se,H]);let{onOpenChange:Q,triggerPointerDownPosRef:R}=O;(0,$e.useEffect)(()=>{if(A){let Se={x:0,y:0},le=W=>{var J,ne,Oe,Ne;Se={x:Math.abs(Math.round(W.pageX)-((J=(ne=R.current)===null||ne===void 0?void 0:ne.x)!==null&&J!==void 0?J:0)),y:Math.abs(Math.round(W.pageY)-((Oe=(Ne=R.current)===null||Ne===void 0?void 0:Ne.y)!==null&&Oe!==void 0?Oe:0))}},we=W=>{Se.x<=10&&Se.y<=10?W.preventDefault():A.contains(W.target)||Q(!1),document.removeEventListener("pointermove",le),R.current=null};return R.current!==null&&(document.addEventListener("pointermove",le),document.addEventListener("pointerup",we,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",le),document.removeEventListener("pointerup",we,{capture:!0})}}},[A,Q,R]),(0,$e.useEffect)(()=>{let Se=()=>Q(!1);return window.addEventListener("blur",Se),window.addEventListener("resize",Se),()=>{window.removeEventListener("blur",Se),window.removeEventListener("resize",Se)}},[Q]);let[$,q]=rX(Se=>{let le=Z().filter(J=>!J.disabled),we=le.find(J=>J.ref.current===document.activeElement),W=nX(le,Se,we);W&&setTimeout(()=>W.ref.current.focus())}),ie=(0,$e.useCallback)((Se,le,we)=>{let W=!de.current&&!we;(O.value!==void 0&&O.value===le||W)&&(te(Se),W&&(de.current=!0))},[O.value]),oe=(0,$e.useCallback)(()=>A?.focus(),[A]),fe=(0,$e.useCallback)((Se,le,we)=>{let W=!de.current&&!we;(O.value!==void 0&&O.value===le||W)&&X(Se)},[O.value]),_e=n==="popper"?XY:nCe,Ee=_e===XY?{side:o,sideOffset:l,align:c,alignOffset:f,arrowPadding:u,collisionBoundary:d,collisionPadding:p,sticky:_,hideWhenDetached:w,avoidCollisions:k}:{};return(0,$e.createElement)(QY,{scope:r,content:A,viewport:I,onViewportChange:D,itemRefCallback:ie,selectedItem:U,onItemLeave:oe,itemTextRefCallback:fe,focusSelectedItem:H,selectedItemText:V,position:n,isPositioned:se,searchRef:$},(0,$e.createElement)(Db,{as:Bs,allowPinchZoom:!0},(0,$e.createElement)(M1,{asChild:!0,trapped:O.open,onMountAutoFocus:Se=>{Se.preventDefault()},onUnmountAutoFocus:gt(i,Se=>{var le;(le=O.trigger)===null||le===void 0||le.focus({preventScroll:!0}),Se.preventDefault()})},(0,$e.createElement)(j1,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:Se=>Se.preventDefault(),onDismiss:()=>O.onOpenChange(!1)},(0,$e.createElement)(_e,Ye({role:"listbox",id:O.contentId,"data-state":O.open?"open":"closed",dir:O.dir,onContextMenu:Se=>Se.preventDefault()},S,Ee,{onPlaced:()=>pe(!0),ref:L,style:{display:"flex",flexDirection:"column",outline:"none",...S.style},onKeyDown:gt(S.onKeyDown,Se=>{let le=Se.ctrlKey||Se.altKey||Se.metaKey;if(Se.key==="Tab"&&Se.preventDefault(),!le&&Se.key.length===1&&q(Se.key),["ArrowUp","ArrowDown","Home","End"].includes(Se.key)){let W=Z().filter(J=>!J.disabled).map(J=>J.ref.current);if(["ArrowUp","End"].includes(Se.key)&&(W=W.slice().reverse()),["ArrowUp","ArrowDown"].includes(Se.key)){let J=Se.target,ne=W.indexOf(J);W=W.slice(ne+1)}setTimeout(()=>F(W)),Se.preventDefault()}})}))))))});var nCe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,onPlaced:n,...i}=e,s=bf(wh,r),a=SS(wh,r),[o,l]=(0,$e.useState)(null),[c,f]=(0,$e.useState)(null),u=hr(t,L=>f(L)),d=fP(r),p=(0,$e.useRef)(!1),_=(0,$e.useRef)(!0),{viewport:w,selectedItem:k,selectedItemText:S,focusSelectedItem:O}=a,A=(0,$e.useCallback)(()=>{if(s.trigger&&s.valueNode&&o&&c&&w&&k&&S){let L=s.trigger.getBoundingClientRect(),U=c.getBoundingClientRect(),te=s.valueNode.getBoundingClientRect(),V=S.getBoundingClientRect();if(s.dir!=="rtl"){let J=V.left-U.left,ne=te.left-J,Oe=L.left-ne,Ne=L.width+Oe,Ce=Math.max(Ne,U.width),Xe=window.innerWidth-ol,Ze=lP(ne,[ol,Xe-Ce]);o.style.minWidth=Ne+"px",o.style.left=Ze+"px"}else{let J=U.right-V.right,ne=window.innerWidth-te.right-J,Oe=window.innerWidth-L.right-ne,Ne=L.width+Oe,Ce=Math.max(Ne,U.width),Xe=window.innerWidth-ol,Ze=lP(ne,[ol,Xe-Ce]);o.style.minWidth=Ne+"px",o.style.right=Ze+"px"}let X=d(),Z=window.innerHeight-ol*2,se=w.scrollHeight,pe=window.getComputedStyle(c),de=parseInt(pe.borderTopWidth,10),F=parseInt(pe.paddingTop,10),H=parseInt(pe.borderBottomWidth,10),Q=parseInt(pe.paddingBottom,10),R=de+F+se+Q+H,$=Math.min(k.offsetHeight*5,R),q=window.getComputedStyle(w),ie=parseInt(q.paddingTop,10),oe=parseInt(q.paddingBottom,10),fe=L.top+L.height/2-ol,_e=Z-fe,Ee=k.offsetHeight/2,Se=k.offsetTop+Ee,le=de+F+Se,we=R-le;if(le<=fe){let J=k===X[X.length-1].ref.current;o.style.bottom="0px";let ne=c.clientHeight-w.offsetTop-w.offsetHeight,Oe=Math.max(_e,Ee+(J?oe:0)+ne+H),Ne=le+Oe;o.style.height=Ne+"px"}else{let J=k===X[0].ref.current;o.style.top="0px";let Oe=Math.max(fe,de+w.offsetTop+(J?ie:0)+Ee)+we;o.style.height=Oe+"px",w.scrollTop=le-fe+w.offsetTop}o.style.margin=`${ol}px 0`,o.style.minHeight=$+"px",o.style.maxHeight=Z+"px",n?.(),requestAnimationFrame(()=>p.current=!0)}},[d,s.trigger,s.valueNode,o,c,w,k,S,s.dir,n]);Nn(()=>A(),[A]);let[C,I]=(0,$e.useState)();Nn(()=>{c&&I(window.getComputedStyle(c).zIndex)},[c]);let D=(0,$e.useCallback)(L=>{L&&_.current===!0&&(A(),O?.(),_.current=!1)},[A,O]);return(0,$e.createElement)(iCe,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:p,onScrollButtonChange:D},(0,$e.createElement)("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C}},(0,$e.createElement)(Tt.div,Ye({},i,{ref:u,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}}))))});var XY=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,align:n="start",collisionPadding:i=ol,...s}=e,a=dP(r);return(0,$e.createElement)(tS,Ye({},a,s,{ref:t,align:n,collisionPadding:i,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[iCe,sCe]=Sh(wh,{}),ZY="SelectViewport",aCe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,...n}=e,i=SS(ZY,r),s=sCe(ZY,r),a=hr(t,i.onViewportChange),o=(0,$e.useRef)(0);return(0,$e.createElement)($e.Fragment,null,(0,$e.createElement)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),(0,$e.createElement)(wS.Slot,{scope:r},(0,$e.createElement)(Tt.div,Ye({"data-radix-select-viewport":"",role:"presentation"},n,{ref:a,style:{position:"relative",flex:1,overflow:"auto",...n.style},onScroll:gt(n.onScroll,l=>{let c=l.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:u}=s;if(u!=null&&u.current&&f){let d=Math.abs(o.current-c.scrollTop);if(d>0){let p=window.innerHeight-ol*2,_=parseFloat(f.style.minHeight),w=parseFloat(f.style.height),k=Math.max(_,w);if(k<p){let S=k+d,O=Math.min(p,S),A=S-O;f.style.height=O+"px",f.style.bottom==="0px"&&(c.scrollTop=A>0?A:0,f.style.justifyContent="flex-end")}}}o.current=c.scrollTop})}))))}),oCe="SelectGroup",[lCe,cCe]=Sh(oCe),uCe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,...n}=e,i=da();return(0,$e.createElement)(lCe,{scope:r,id:i},(0,$e.createElement)(Tt.div,Ye({role:"group","aria-labelledby":i},n,{ref:t})))}),fCe="SelectLabel",dCe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,...n}=e,i=cCe(fCe,r);return(0,$e.createElement)(Tt.div,Ye({id:i.id},n,{ref:t}))}),cP="SelectItem",[pCe,eX]=Sh(cP),hCe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,value:n,disabled:i=!1,textValue:s,...a}=e,o=bf(cP,r),l=SS(cP,r),c=o.value===n,[f,u]=(0,$e.useState)(s??""),[d,p]=(0,$e.useState)(!1),_=hr(t,S=>{var O;return(O=l.itemRefCallback)===null||O===void 0?void 0:O.call(l,S,n,i)}),w=da(),k=()=>{i||(o.onValueChange(n),o.onOpenChange(!1))};return(0,$e.createElement)(pCe,{scope:r,value:n,disabled:i,textId:w,isSelected:c,onItemTextChange:(0,$e.useCallback)(S=>{u(O=>{var A;return O||((A=S?.textContent)!==null&&A!==void 0?A:"").trim()})},[])},(0,$e.createElement)(wS.ItemSlot,{scope:r,value:n,disabled:i,textValue:f},(0,$e.createElement)(Tt.div,Ye({role:"option","aria-labelledby":w,"data-highlighted":d?"":void 0,"aria-selected":c&&d,"data-state":c?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1},a,{ref:_,onFocus:gt(a.onFocus,()=>p(!0)),onBlur:gt(a.onBlur,()=>p(!1)),onPointerUp:gt(a.onPointerUp,k),onPointerMove:gt(a.onPointerMove,S=>{if(i){var O;(O=l.onItemLeave)===null||O===void 0||O.call(l)}else S.currentTarget.focus({preventScroll:!0})}),onPointerLeave:gt(a.onPointerLeave,S=>{if(S.currentTarget===document.activeElement){var O;(O=l.onItemLeave)===null||O===void 0||O.call(l)}}),onKeyDown:gt(a.onKeyDown,S=>{var O;((O=l.searchRef)===null||O===void 0?void 0:O.current)!==""&&S.key===" "||(qTe.includes(S.key)&&k(),S.key===" "&&S.preventDefault())})}))))}),vS="SelectItemText",gCe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,className:n,style:i,...s}=e,a=bf(vS,r),o=SS(vS,r),l=eX(vS,r),c=JTe(vS,r),[f,u]=(0,$e.useState)(null),d=hr(t,S=>u(S),l.onItemTextChange,S=>{var O;return(O=o.itemTextRefCallback)===null||O===void 0?void 0:O.call(o,S,l.value,l.disabled)}),p=f?.textContent,_=(0,$e.useMemo)(()=>(0,$e.createElement)("option",{key:l.value,value:l.value,disabled:l.disabled},p),[l.disabled,l.value,p]),{onNativeOptionAdd:w,onNativeOptionRemove:k}=c;return Nn(()=>(w(_),()=>k(_)),[w,k,_]),(0,$e.createElement)($e.Fragment,null,(0,$e.createElement)(Tt.span,Ye({id:l.textId},s,{ref:d})),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?(0,uP.createPortal)(s.children,a.valueNode):null)}),yCe="SelectItemIndicator",mCe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,...n}=e;return eX(yCe,r).isSelected?(0,$e.createElement)(Tt.span,Ye({"aria-hidden":!0},n,{ref:t})):null});var bCe=(0,$e.forwardRef)((e,t)=>{let{__scopeSelect:r,...n}=e;return(0,$e.createElement)(Tt.div,Ye({"aria-hidden":!0},n,{ref:t}))});var tX=(0,$e.forwardRef)((e,t)=>{let{value:r,...n}=e,i=(0,$e.useRef)(null),s=hr(t,i),a=KY(r);return(0,$e.useEffect)(()=>{let o=i.current,l=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==r&&f){let u=new Event("change",{bubbles:!0});f.call(o,r),o.dispatchEvent(u)}},[a,r]),(0,$e.createElement)(YY,{asChild:!0},(0,$e.createElement)("select",Ye({},n,{ref:s,defaultValue:r})))});tX.displayName="BubbleSelect";function rX(e){let t=cn(e),r=(0,$e.useRef)(""),n=(0,$e.useRef)(0),i=(0,$e.useCallback)(a=>{let o=r.current+a;t(o),function l(c){r.current=c,window.clearTimeout(n.current),c!==""&&(n.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),s=(0,$e.useCallback)(()=>{r.current="",window.clearTimeout(n.current)},[]);return(0,$e.useEffect)(()=>()=>window.clearTimeout(n.current),[]),[r,i,s]}function nX(e,t,r){let i=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=r?e.indexOf(r):-1,a=vCe(e,Math.max(s,0));i.length===1&&(a=a.filter(c=>c!==r));let l=a.find(c=>c.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==r?l:void 0}function vCe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var iX=GTe,pP=YTe,sX=ZTe,aX=QTe,oX=eCe,hP=tCe,lX=aCe,cX=uCe,gP=dCe,yP=hCe,uX=gCe,fX=mCe;var mP=bCe;var Di=ae(vt(),1),dX=iX,pX=cX,hX=sX,bP=xh.forwardRef(({className:e,children:t,...r},n)=>(0,Di.jsxs)(pP,{ref:n,className:Lt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:[t,(0,Di.jsx)(aX,{asChild:!0,children:(0,Di.jsx)(gb,{className:"h-4 w-4 opacity-50"})})]}));bP.displayName=pP.displayName;var vP=xh.forwardRef(({className:e,children:t,position:r="popper",...n},i)=>(0,Di.jsx)(oX,{children:(0,Di.jsx)(hP,{ref:i,className:Lt("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md animate-in fade-in-80",r==="popper"&&"translate-y-1",e),position:r,...n,children:(0,Di.jsx)(lX,{className:Lt("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));vP.displayName=hP.displayName;var _P=xh.forwardRef(({className:e,...t},r)=>(0,Di.jsx)(gP,{ref:r,className:Lt("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));_P.displayName=gP.displayName;var wP=xh.forwardRef(({className:e,children:t,...r},n)=>(0,Di.jsxs)(yP,{ref:n,className:Lt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[(0,Di.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,Di.jsx)(fX,{children:(0,Di.jsx)(af,{className:"h-4 w-4"})})}),(0,Di.jsx)(uX,{children:t})]}));wP.displayName=yP.displayName;var wCe=xh.forwardRef(({className:e,...t},r)=>(0,Di.jsx)(mP,{ref:r,className:Lt("-mx-1 my-1 h-px bg-muted",e),...t}));wCe.displayName=mP.displayName;var SCe=Object.defineProperty,xCe=Object.getOwnPropertyNames,kh=(e=>typeof ar<"u"?ar:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof ar<"u"?ar:t)[r]}):e)(function(e){if(typeof ar<"u")return ar.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),zS=(e,t)=>function(){return e&&(t=(0,e[xCe(e)[0]])(e=0)),t},kCe=(e,t)=>{for(var r in t)SCe(e,r,{get:t[r],enumerable:!0})},gX,yX,SP,ECe,OCe,Eh,xS,mX,bX,vX,Ec,NS,ACe,PS,xP,kP,_X,TCe,wX,SX,xX,kX,EX,CCe,JP=zS({"src/ble/node_modules/@capacitor/core/dist/index.js"(){gX=e=>{let t=new Map;t.set("web",{name:"web"});let r=e.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:t},n=(s,a)=>{r.platforms.set(s,a)},i=s=>{r.platforms.has(s)&&(r.currentPlatform=r.platforms.get(s))};return r.addPlatform=n,r.setPlatform=i,r},yX=e=>e.CapacitorPlatforms=gX(e),SP=yX(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),ECe=SP.addPlatform,OCe=SP.setPlatform,function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(Eh||(Eh={})),xS=class extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}},mX=e=>{var t,r;return e?.androidBridge?"android":!((r=(t=e?.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},bX=e=>{var t,r,n,i,s;let a=e.CapacitorCustomPlatform||null,o=e.Capacitor||{},l=o.Plugins=o.Plugins||{},c=e.CapacitorPlatforms,f=()=>a!==null?a.name:mX(e),u=((t=c?.currentPlatform)===null||t===void 0?void 0:t.getPlatform)||f,d=()=>u()!=="web",p=((r=c?.currentPlatform)===null||r===void 0?void 0:r.isNativePlatform)||d,_=L=>{let U=C.get(L);return!!(U?.platforms.has(u())||S(L))},w=((n=c?.currentPlatform)===null||n===void 0?void 0:n.isPluginAvailable)||_,k=L=>{var U;return(U=o.PluginHeaders)===null||U===void 0?void 0:U.find(te=>te.name===L)},S=((i=c?.currentPlatform)===null||i===void 0?void 0:i.getPluginHeader)||k,O=L=>e.console.error(L),A=(L,U,te)=>Promise.reject(`${te} does not have an implementation of "${U}".`),C=new Map,I=(L,U={})=>{let te=C.get(L);if(te)return console.warn(`Capacitor plugin "${L}" already registered. Cannot register plugins twice.`),te.proxy;let V=u(),X=S(L),Z,se=async()=>(!Z&&V in U?Z=typeof U[V]=="function"?Z=await U[V]():Z=U[V]:a!==null&&!Z&&"web"in U&&(Z=typeof U.web=="function"?Z=await U.web():Z=U.web),Z),pe=($,q)=>{var ie,oe;if(X){let fe=X?.methods.find(_e=>q===_e.name);if(fe)return fe.rtype==="promise"?_e=>o.nativePromise(L,q.toString(),_e):(_e,Ee)=>o.nativeCallback(L,q.toString(),_e,Ee);if($)return(ie=$[q])===null||ie===void 0?void 0:ie.bind($)}else{if($)return(oe=$[q])===null||oe===void 0?void 0:oe.bind($);throw new xS(`"${L}" plugin is not implemented on ${V}`,Eh.Unimplemented)}},de=$=>{let q,ie=(...oe)=>{let fe=se().then(_e=>{let Ee=pe(_e,$);if(Ee){let Se=Ee(...oe);return q=Se?.remove,Se}else throw new xS(`"${L}.${$}()" is not implemented on ${V}`,Eh.Unimplemented)});return $==="addListener"&&(fe.remove=async()=>q()),fe};return ie.toString=()=>`${$.toString()}() { [capacitor code] }`,Object.defineProperty(ie,"name",{value:$,writable:!1,configurable:!1}),ie},F=de("addListener"),H=de("removeListener"),Q=($,q)=>{let ie=F({eventName:$},q),oe=async()=>{let _e=await ie;H({eventName:$,callbackId:_e},q)},fe=new Promise(_e=>ie.then(()=>_e({remove:oe})));return fe.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await oe()},fe},R=new Proxy({},{get($,q){switch(q){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return X?Q:F;case"removeListener":return H;default:return de(q)}}});return l[L]=R,C.set(L,{name:L,proxy:R,platforms:new Set([...Object.keys(U),...X?[V]:[]])}),R},D=((s=c?.currentPlatform)===null||s===void 0?void 0:s.registerPlugin)||I;return o.convertFileSrc||(o.convertFileSrc=L=>L),o.getPlatform=u,o.handleError=O,o.isNativePlatform=p,o.isPluginAvailable=w,o.pluginMethodNoop=A,o.registerPlugin=D,o.Exception=xS,o.DEBUG=!!o.DEBUG,o.isLoggingEnabled=!!o.isLoggingEnabled,o.platform=o.getPlatform(),o.isNative=o.isNativePlatform(),o},vX=e=>e.Capacitor=bX(e),Ec=vX(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),NS=Ec.registerPlugin,ACe=Ec.Plugins,PS=class{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);let n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n);let i=async()=>this.removeListener(e,t),s=Promise.resolve({remove:i});return Object.defineProperty(s,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await i()}}),s}async removeAllListeners(){this.listeners={};for(let e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t){let r=this.listeners[e];r&&r.forEach(n=>n(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new Ec.Exception(e,Eh.Unimplemented)}unavailable(e="not available"){return new Ec.Exception(e,Eh.Unavailable)}async removeListener(e,t){let r=this.listeners[e];if(!r)return;let n=r.indexOf(t);this.listeners[e].splice(n,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}},xP=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),kP=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent),_X=class extends PS{async getCookies(){let e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[n,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=kP(n).trim(),i=kP(i).trim(),t[n]=i}),t}async setCookie(e){try{let t=xP(e.key),r=xP(e.value),n=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),s=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${n}; path=${i}; ${s};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{let e=document.cookie.split(";")||[];for(let t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}},TCe=NS("CapacitorCookies",{web:()=>new _X}),wX=async e=>new Promise((t,r)=>{let n=new FileReader;n.onload=()=>{let i=n.result;t(i.indexOf(",")>=0?i.split(",")[1]:i)},n.onerror=i=>r(i),n.readAsDataURL(e)}),SX=(e={})=>{let t=Object.keys(e);return Object.keys(e).map(i=>i.toLocaleLowerCase()).reduce((i,s,a)=>(i[s]=e[t[a]],i),{})},xX=(e,t=!0)=>e?Object.entries(e).reduce((n,i)=>{let[s,a]=i,o,l;return Array.isArray(a)?(l="",a.forEach(c=>{o=t?encodeURIComponent(c):c,l+=`${s}=${o}&`}),l.slice(0,-1)):(o=t?encodeURIComponent(a):a,l=`${s}=${o}`),`${n}&${l}`},"").substr(1):null,kX=(e,t={})=>{let r=Object.assign({method:e.method||"GET",headers:e.headers},t),i=SX(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(i.includes("application/x-www-form-urlencoded")){let s=new URLSearchParams;for(let[a,o]of Object.entries(e.data||{}))s.set(a,o);r.body=s.toString()}else if(i.includes("multipart/form-data")){let s=new FormData;if(e.data instanceof FormData)e.data.forEach((o,l)=>{s.append(l,o)});else for(let o of Object.keys(e.data))s.append(o,e.data[o]);r.body=s;let a=new Headers(r.headers);a.delete("content-type"),r.headers=a}else(i.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r},EX=class extends PS{async request(e){let t=kX(e,e.webFetchExtra),r=xX(e.params,e.shouldEncodeUrlParams),n=r?`${e.url}?${r}`:e.url,i=await fetch(n,t),s=i.headers.get("content-type")||"",{responseType:a="text"}=i.ok?e:{};s.includes("application/json")&&(a="json");let o,l;switch(a){case"arraybuffer":case"blob":l=await i.blob(),o=await wX(l);break;case"json":o=await i.json();break;case"document":case"text":default:o=await i.text()}let c={};return i.headers.forEach((f,u)=>{c[u]=f}),{data:o,headers:c,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}},CCe=NS("CapacitorHttp",{web:()=>new EX})}});function ICe(e){return new DataView(Uint8Array.from(e).buffer)}function NCe(e){return Array.from(new Uint8Array(e.buffer))}function PCe(e){return`0000${e.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}function LS(e){let t=e.trim().split(" ").filter(r=>r!=="").map(r=>parseInt(r,16));return ICe(t)}function EP(e){return NCe(e).map(t=>{let r=t.toString(16);return r.length==1&&(r="0"+r),r}).join(" ")}function LCe(e){if(typeof e=="string")return e;if(typeof e=="number")return PCe(e);throw new Error("Invalid UUID")}function OX(e){let t={};if(e)return e.forEach((r,n)=>{t[n.toString()]=r}),t}var GP=zS({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/conversion.js"(){}});async function FCe(e,t,r){let n;return Promise.race([e,new Promise((i,s)=>{n=setTimeout(()=>s(r),t)})]).finally(()=>clearTimeout(n))}var DCe=zS({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/timeout.js"(){}}),zX={};kCe(zX,{BluetoothLeWeb:()=>qX});var qX,jCe=zS({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/web.js"(){JP(),GP(),DCe(),qX=class extends PS{constructor(){super(...arguments),this.deviceMap=new Map,this.discoveredDevices=new Map,this.scan=null,this.DEFAULT_CONNECTION_TIMEOUT=1e4,this.onAdvertisementReceivedCallback=this.onAdvertisementReceived.bind(this),this.onDisconnectedCallback=this.onDisconnected.bind(this),this.onCharacteristicValueChangedCallback=this.onCharacteristicValueChanged.bind(this)}async initialize(){if(typeof navigator>"u"||!navigator.bluetooth)throw this.unavailable("Web Bluetooth API not available in this browser.");if(!await navigator.bluetooth.getAvailability())throw this.unavailable("No Bluetooth radio available.")}async isEnabled(){return{value:!0}}async enable(){throw this.unavailable("enable is not available on web.")}async disable(){throw this.unavailable("disable is not available on web.")}async startEnabledNotifications(){}async stopEnabledNotifications(){}async isLocationEnabled(){throw this.unavailable("isLocationEnabled is not available on web.")}async openLocationSettings(){throw this.unavailable("openLocationSettings is not available on web.")}async openBluetoothSettings(){throw this.unavailable("openBluetoothSettings is not available on web.")}async openAppSettings(){throw this.unavailable("openAppSettings is not available on web.")}async setDisplayStrings(){}async requestDevice(e){let t=this.getFilters(e),r=await navigator.bluetooth.requestDevice({filters:t.length?t:void 0,optionalServices:e?.optionalServices,acceptAllDevices:t.length===0});return this.deviceMap.set(r.id,r),this.getBleDevice(r)}async requestLEScan(e){this.requestBleDeviceOptions=e;let t=this.getFilters(e);await this.stopLEScan(),this.discoveredDevices=new Map,navigator.bluetooth.removeEventListener("advertisementreceived",this.onAdvertisementReceivedCallback),navigator.bluetooth.addEventListener("advertisementreceived",this.onAdvertisementReceivedCallback),this.scan=await navigator.bluetooth.requestLEScan({filters:t.length?t:void 0,acceptAllAdvertisements:t.length===0,keepRepeatedDevices:e?.allowDuplicates})}onAdvertisementReceived(e){var t,r;let n=e.device.id;if(this.deviceMap.set(n,e.device),!this.discoveredDevices.has(n)||!((t=this.requestBleDeviceOptions)===null||t===void 0)&&t.allowDuplicates){this.discoveredDevices.set(n,!0);let s=this.getBleDevice(e.device),a={device:s,localName:s.name,rssi:e.rssi,txPower:e.txPower,manufacturerData:OX(e.manufacturerData),serviceData:OX(e.serviceData),uuids:(r=e.uuids)===null||r===void 0?void 0:r.map(LCe)};this.notifyListeners("onScanResult",a)}}async stopLEScan(){var e;!((e=this.scan)===null||e===void 0)&&e.active&&this.scan.stop(),this.scan=null}async getDevices(e){return{devices:(await navigator.bluetooth.getDevices()).filter(n=>e.deviceIds.includes(n.id)).map(n=>(this.deviceMap.set(n.id,n),this.getBleDevice(n)))}}async getConnectedDevices(e){return{devices:(await navigator.bluetooth.getDevices()).filter(n=>{var i;return(i=n.gatt)===null||i===void 0?void 0:i.connected}).map(n=>(this.deviceMap.set(n.id,n),this.getBleDevice(n)))}}async connect(e){var t,r;let n=this.getDeviceFromMap(e.deviceId);n.removeEventListener("gattserverdisconnected",this.onDisconnectedCallback),n.addEventListener("gattserverdisconnected",this.onDisconnectedCallback);let i=Symbol();if(n.gatt===void 0)throw new Error("No gatt server available.");try{let s=(t=e.timeout)!==null&&t!==void 0?t:this.DEFAULT_CONNECTION_TIMEOUT;await FCe(n.gatt.connect(),s,i)}catch(s){throw await((r=n.gatt)===null||r===void 0?void 0:r.disconnect()),s===i?new Error("Connection timeout"):s}}onDisconnected(e){let r=`disconnected|${e.target.id}`;this.notifyListeners(r,null)}async createBond(e){throw this.unavailable("createBond is not available on web.")}async isBonded(e){throw this.unavailable("isBonded is not available on web.")}async disconnect(e){var t;(t=this.getDeviceFromMap(e.deviceId).gatt)===null||t===void 0||t.disconnect()}async getServices(e){var t,r;let n=(r=await((t=this.getDeviceFromMap(e.deviceId).gatt)===null||t===void 0?void 0:t.getPrimaryServices()))!==null&&r!==void 0?r:[],i=[];for(let s of n){let a=await s.getCharacteristics(),o=[];for(let l of a)o.push({uuid:l.uuid,properties:this.getProperties(l),descriptors:await this.getDescriptors(l)});i.push({uuid:s.uuid,characteristics:o})}return{services:i}}async getDescriptors(e){try{return(await e.getDescriptors()).map(r=>({uuid:r.uuid}))}catch{return[]}}getProperties(e){return{broadcast:e.properties.broadcast,read:e.properties.read,writeWithoutResponse:e.properties.writeWithoutResponse,write:e.properties.write,notify:e.properties.notify,indicate:e.properties.indicate,authenticatedSignedWrites:e.properties.authenticatedSignedWrites,reliableWrite:e.properties.reliableWrite,writableAuxiliaries:e.properties.writableAuxiliaries}}async getCharacteristic(e){var t;let r=await((t=this.getDeviceFromMap(e.deviceId).gatt)===null||t===void 0?void 0:t.getPrimaryService(e?.service));return r?.getCharacteristic(e?.characteristic)}async getDescriptor(e){let t=await this.getCharacteristic(e);return t?.getDescriptor(e?.descriptor)}async discoverServices(e){throw this.unavailable("discoverServices is not available on web.")}async getMtu(e){throw this.unavailable("getMtu is not available on web.")}async requestConnectionPriority(e){throw this.unavailable("requestConnectionPriority is not available on web.")}async readRssi(e){throw this.unavailable("readRssi is not available on web.")}async read(e){let t=await this.getCharacteristic(e);return{value:await t?.readValue()}}async write(e){let t=await this.getCharacteristic(e),r;typeof e.value=="string"?r=LS(e.value):r=e.value,await t?.writeValueWithResponse(r)}async writeWithoutResponse(e){let t=await this.getCharacteristic(e),r;typeof e.value=="string"?r=LS(e.value):r=e.value,await t?.writeValueWithoutResponse(r)}async readDescriptor(e){let t=await this.getDescriptor(e);return{value:await t?.readValue()}}async writeDescriptor(e){let t=await this.getDescriptor(e),r;typeof e.value=="string"?r=LS(e.value):r=e.value,await t?.writeValue(r)}async startNotifications(e){let t=await this.getCharacteristic(e);t?.removeEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback),t?.addEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback),await t?.startNotifications()}onCharacteristicValueChanged(e){var t,r;let n=e.target,i=`notification|${(t=n.service)===null||t===void 0?void 0:t.device.id}|${(r=n.service)===null||r===void 0?void 0:r.uuid}|${n.uuid}`;this.notifyListeners(i,{value:n.value})}async stopNotifications(e){let t=await this.getCharacteristic(e);await t?.stopNotifications()}getFilters(e){var t;let r=[];for(let n of(t=e?.services)!==null&&t!==void 0?t:[])r.push({services:[n],name:e?.name,namePrefix:e?.namePrefix});return(e?.name||e?.namePrefix)&&r.length===0&&r.push({name:e.name,namePrefix:e.namePrefix}),r}getDeviceFromMap(e){let t=this.deviceMap.get(e);if(t===void 0)throw new Error('Device not found. Call "requestDevice", "requestLEScan" or "getDevices" first.');return t}getBleDevice(e){var t;return{deviceId:e.id,name:(t=e.name)!==null&&t!==void 0?t:void 0}}}}}),BCe=Object.create,KP=Object.defineProperty,MCe=Object.getOwnPropertyDescriptor,VX=Object.getOwnPropertyNames,RCe=Object.getPrototypeOf,$Ce=Object.prototype.hasOwnProperty,UCe=(e,t,r)=>t in e?KP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,zCe=(e=>typeof kh<"u"?kh:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof kh<"u"?kh:t)[r]}):e)(function(e){if(typeof kh<"u")return kh.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),qCe=(e,t)=>function(){return t||(0,e[VX(e)[0]])((t={exports:{}}).exports,t),t.exports},VCe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of VX(t))!$Ce.call(e,i)&&i!==r&&KP(e,i,{get:()=>t[i],enumerable:!(n=MCe(t,i))||n.enumerable});return e},HCe=(e,t,r)=>(r=e!=null?BCe(RCe(e)):{},VCe(t||!e||!e.__esModule?KP(r,"default",{value:e,enumerable:!0}):r,e)),WCe=(e,t,r)=>(UCe(e,typeof t!="symbol"?t+"":t,r),r),JCe=qCe({"node_modules/web-worker/cjs/browser.js"(e,t){t.exports=Worker}}),GCe=class{data={};triggers={};ctr=0;constructor(e){typeof e=="object"&&(this.data=e)}setState=e=>{Object.assign(this.data,e);let t=Object.getOwnPropertyNames(e);for(let r of t)this.triggerEvent(r,this.data[r]);if(this.triggers[Rb]){let r=i=>{i(e)},n=this.triggers[Rb].length;for(let i=n-1;i>=0;i--)r(this.triggers[Rb][i].onchange)}return this.data};setValue=(e,t)=>{this.data[e]=t,this.triggerEvent(e,t)};triggerEvent=(e,t)=>{if(this.triggers[e]){let r=i=>{i.onchange(t)},n=this.triggers[e].length;for(let i=n-1;i>=0;i--)r(this.triggers[e][i])}};subscribeState=e=>this.subscribeEvent(Rb,e);unsubscribeState=e=>this.unsubscribeEvent(Rb,e);subscribeEvent=(e,t,r,n)=>{if(e){r&&n&&!this.triggers[e]&&Object.defineProperty(this.data,e,{get:()=>r[n],set:s=>{r[n]=s},enumerable:!0,configurable:!0}),this.triggers[e]||(this.triggers[e]=[]);let i=this.ctr;return this.ctr++,this.triggers[e].push({sub:i,onchange:t}),i}else return};unsubscribeEvent=(e,t)=>{let r=this.triggers[e];if(r)if(t===void 0)delete this.triggers[e],delete this.data[e];else{let n,i=r.find((s,a)=>{if(s.sub===t)return n=a,!0});return i&&r.splice(n,1),Object.keys(r).length===0&&(delete this.triggers[e],delete this.data[e]),this.onRemoved&&this.onRemoved(i),!0}};subscribeEventOnce=(e,t)=>{let r,n=i=>{t(i),this.unsubscribeEvent(e,r)};return r=this.subscribeEvent(e,n),r};getEvent=(e,t)=>{for(let r in this.triggers[e])if(this.triggers[e][r].sub===t)return this.triggers[e][r]};getSnapshot=()=>{let e={};for(let t in this.data)e[t]=this.data[t]};onRemoved},Rb="*s",HX=new GCe,Sr=class{__node={tag:`node${Math.floor(Math.random()*1e15)}`,unique:`${Math.floor(Math.random()*1e15)}`,state:HX};__children;__parent;__operator;__listeners;__props;__args;constructor(e,t,r){this.__setProperties(e,t,r)}__setProperties=(e,t,r)=>{if((()=>{let i=e;typeof e=="function"?jP(e)?e=new e:e={__operator:e,__node:{forward:!0,tag:e.name}}:typeof e=="string"&&r?.get(e)&&(e=r.get(e)),"__node"in e||(e.__node={}),e.__node.initial||(e.__node.initial=i)})(),typeof e=="object"){let i=()=>{e.__node?.state?this.__node.state=e.__node.state:r&&(e.__node.state=r.__node.state)},s=()=>{e.__props&&(typeof e.__props=="function"&&(e.__props=new e.__props),typeof e.__props=="object"&&this.__proxyObject(e.__props))},a=()=>{e.__node.tag||(e.__operator?.name?e.__node.tag=e.__operator.name:e.__node.tag=`node${Math.floor(Math.random()*1e15)}`)},o=()=>{typeof e.__node=="string"?r?.get(e.__node.tag)?e=r.get(e.__node.tag):e.__node={}:e.__node||(e.__node={}),r&&(e.__node.graph=r),e instanceof _f&&(e.__node.source=e)},l=()=>{if(!e.__parent&&t&&(e.__parent=t),t?.__node&&!(t instanceof _f||e instanceof _f)&&(e.__node.tag=t.__node.tag+"."+e.__node.tag),t instanceof _f&&e instanceof _f&&(e.__node.loaders&&Object.assign(t.__node.loaders?t.__node.loaders:{},e.__node.loaders),t.__node.mapGraphs)){e.__node.nodes.forEach(p=>{t.set(e.__node.tag+"."+p.__node.tag,p)});let d=()=>{e.__node.nodes.forEach(p=>{t.__node.nodes.delete(e.__node.tag+"."+p.__node.tag)})};this.__addOndisconnected(d)}},c=()=>{if(typeof e.default=="function"&&!e.__operator&&(e.__operator=e.default),e.__operator){if(typeof e.__operator=="string"&&r){let d=r.get(e.__operator);d&&(e.__operator=d.__operator),!e.__node.tag&&e.__operator.name&&(e.__node.tag=e.__operator.name)}typeof e.__operator=="function"&&(e.__operator=this.__setOperator(e.__operator)),e.default&&(e.default=e.__operator)}},f=()=>{e.__node=Object.assign(this.__node,e.__node);let d=Object.getOwnPropertyNames(e).filter(p=>{if(!MP[p])return!0});for(let p of d)p in e&&(this[p]=e[p])},u=()=>{this.__onconnected&&(typeof this.__onconnected=="function"?this.__onconnected=this.__onconnected.bind(this):Array.isArray(this.__onconnected)&&(this.__onconnected=this.__onconnected.map(d=>d.bind(this))),typeof this.__ondisconnected=="function"?this.__ondisconnected=this.__ondisconnected.bind(this):Array.isArray(this.__ondisconnected)&&(this.__ondisconnected=this.__ondisconnected.map(d=>d.bind(this))))};i(),a(),s(),o(),l(),f(),u(),c()}};__subscribe=(e,t,r,n,i,s)=>{let a=(l,c=(u,d)=>d||u,f=e)=>{let u;if(s){let _=BP(f,s,this.__node.graph);f=_.__callback,u=_.__args}let d=this.__node.state.subscribeEvent(l,f,this,t),p=this.__node.state.getEvent(l,d);return this.__listeners||(this.__listeners={}),this.__listeners[l]=this.__node.state.triggers[l],p&&(p.source=this.__node.tag,t&&(p.key=t),p.target=c(e,n),r&&(p.subInput=r),s&&(p.arguments=s,p.__args=u),i&&(p.tkey=i),p.node=this,p.graph=this.__node.graph),d},o=l=>{let c=this.__node.graph.get(l);if(!c&&l.includes(".")){n=l.substring(0,l.lastIndexOf("."));let f=this.__node.graph.get(l.substring(0,n));i=l.lastIndexOf(".")+1,f&&typeof f[t]=="function"&&(l=(...u)=>f[i](...u))}else c.__operator&&(l=c.__operator,i="__operator")};if(t){if((!this.__node.localState||!this.__node.localState[t])&&this.__addLocalState(this,t),typeof e=="string"){if(i=e,n){if(this.__node.graph?.get(n)){let f=this.__node.graph?.get(n);if(typeof f[e]=="function"){let u=f[e];e=(...d)=>{u(...d)}}else{let u=e;e=p=>{f[u]=p}}}}else if(typeof this[e]=="function"){let f=this[e];e=(...u)=>{f(...u)}}else this.__node.graph?.get(e)&&o(e);if(typeof e!="function")return}let l,c=r?this.__node.unique+"."+t+"input":this.__node.unique+"."+t;return typeof e=="function"?l=a(c,(f,u)=>u||f,e):e?.__node&&(l=a(c,(f,u)=>u||f.__node.unique,(...f)=>{e.__operator&&e.__operator(...f)})),l}else{if(typeof e=="string"&&(this.__node.graph.get(e)&&(e=this.__node.graph.get(e)),i="__operator",typeof e!="object"))return;let l,c=r?this.__node.unique+"input":this.__node.unique;return typeof e=="function"?l=a(c,(f,u)=>u||f,e):e?.__node&&(l=a(c,(f,u)=>u||f.__node.unique,(...f)=>{e.__operator&&e.__operator(...f)})),l}};__unsubscribe=(e,t,r)=>t?this.__node.state.unsubscribeEvent(r?this.__node.unique+"."+t+"input":this.__node.unique+"."+t,e):this.__node.state.unsubscribeEvent(r?this.__node.unique+"input":this.__node.unique,e);__setOperator=e=>{e=e.bind(this),this.__args&&this.__node.graph&&(e=BP(e,this.__args,this.__node.graph).__callback);let t=`${this.__node.unique}input`;if(this.__operator=(...r)=>{this.__node.state.triggers[t]&&this.__node.state.setValue(t,r);let n=e(...r);return this.__node.state.triggers[this.__node.unique]&&(typeof n?.then=="function"?n.then(i=>{i!==void 0&&this.__node.state.setValue(this.__node.unique,i)}).catch(console.error):n!==void 0&&this.__node.state.setValue(this.__node.unique,n)),n},this.__parent instanceof Sr&&!this.__subscribedToParent&&this.__parent.__operator){let r=this.__parent.__subscribe(this),n=()=>{this.__parent?.__unsubscribe(r),delete this.__subscribedToParent};this.__addOndisconnected(n),this.__subscribedToParent=!0}return this.__operator};__addLocalState=(e,t)=>{if(!e)return;this.__node.localState||(this.__node.localState={});let r=this.__node.localState,n=(i,s)=>{let a=this.__node.unique+"."+s,o=`${a}input`,l,c,f,u;if(typeof i[s]=="function"&&s!=="__operator")this.__props?.[s]?f=this.__props:f=r,l=()=>f[s],c=d=>{this.__props?.[s]||(d=d.bind(this)),f[s]=(...p)=>{this.__node.state.triggers[o]&&this.__node.state.setValue(o,p);let _=d(...p);return this.__node.state.triggers[a]&&(typeof _?.then=="function"?_.then(w=>{this.__node.state.triggerEvent(a,w)}).catch(console.error):this.__node.state.triggerEvent(a,_)),_}},r[s]=i[s].bind(this),u={get:l,set:c,enumerable:!0,configurable:!0};else{let d,p,_;this.__props?.[s]?_=this.__props:_=r,d=()=>_[s],p=w=>{_[s]=w,this.__node.state.triggers[a]&&this.__node.state.triggerEvent(a,w)},r[s]=i[s],u={get:d,set:p,enumerable:!0,configurable:!0}}if(Object.defineProperty(i,s,u),typeof this.__node.initial=="object"){let d=Object.getOwnPropertyDescriptor(this.__node.initial,s);(d===void 0||d?.configurable)&&Object.defineProperty(this.__node.initial,s,u)}};if(t)n(e,t);else for(let i in e)n(e,i)};__proxyObject=e=>{let t=KCe(e);for(let r of t){let n={get:()=>e[r],set:i=>{e[r]=i},enumerable:!0,configurable:!0};if(Object.defineProperty(this,r,n),typeof this.__node.initial=="object"){let i=Object.getOwnPropertyDescriptor(this.__node.initial,r);(i===void 0||i?.configurable)&&Object.defineProperty(this.__node.initial,r,n)}}};__addOnconnected(e){e=e.bind(this),Array.isArray(this.__onconnected)?this.__onconnected.push(e):typeof this.__onconnected=="function"?this.__onconnected=[e,this.__onconnected]:this.__onconnected=e}__addOndisconnected(e){e=e.bind(this),Array.isArray(this.__ondisconnected)?this.__ondisconnected.push(e):typeof this.__ondisconnected=="function"?this.__ondisconnected=[e,this.__ondisconnected]:this.__ondisconnected=e}__callConnected(e=this){if(typeof this.__onconnected=="function")this.__onconnected(this);else if(Array.isArray(this.__onconnected)){let t=r=>{r(this)};this.__onconnected.forEach(t)}}__callDisconnected(e=this){if(typeof this.__ondisconnected=="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let t=r=>{r(this)};this.__ondisconnected.forEach(t)}}},_f=class{__node={tag:`graph${Math.floor(Math.random()*1e15)}`,unique:`${Math.random()}`,nodes:new Map,state:HX,roots:{}};constructor(e){this.init(e)}init=e=>{if(e){let t=Object.assign({},e);delete t.roots,Hb(this.__node,t),e.roots&&this.load(e.roots)}};load=e=>{function t(i,s,a=!0,o=!0){if(o&&(i?Object.assign(i,s):i=Object.assign({},s),t(i,s,!0,!1)),s?.__children&&!a)s.__children?.constructor.name==="Object"?i.__children?.constructor.name==="Object"?t(i.__children,s.__children,!0,!1):i.__children=t({},s.__children,!0,!1):i.__children=s.__children;else if(a)for(let l in s)i[l]=Object.assign({},s[l]),s[l]?.__children&&t({},s[l].__children,!1,!1);return i}this.__node.roots=t(this.__node.roots?this.__node.roots:{},e);let r=Object.assign({},e);r.__node&&delete r.__node;let n=this.recursiveSet(r,this,void 0,e);if(e.__node){if(!e.__node.tag)e.__node._tag=`roots${Math.floor(Math.random()*1e15)}`;else if(!this.get(e.__node.tag)){let i=new Sr(e,this,this);this.set(i.__node.tag,i),this.runLoaders(i,this,e,e.__node.tag),i.__listeners&&(n[i.__node.tag]=i.__listeners)}}else e.__listeners&&this.setListeners(e.__listeners);return this.setListeners(n),r};setLoaders=(e,t)=>(t?this.__node.loaders=e:Object.assign(this.__node.loaders,e),this.__node.loaders);runLoaders=(e,t,r,n)=>{for(let i in this.__node.loaders)typeof this.__node.loaders[i]=="object"?(this.__node.loaders[i].init&&this.__node.loaders[i](e,t,this,this.__node.roots,r,n),this.__node.loaders[i].connected&&e.__addOnconnected(this.__node.loaders[i].connect),this.__node.loaders[i].disconnected&&e.__addOndisconnected(this.__node.loaders[i].disconnect)):typeof this.__node.loaders[i]=="function"&&this.__node.loaders[i](e,t,this,this.__node.roots,r,n)};add=(e,t)=>{let r={};typeof t=="string"&&(t=this.get(t));let n;if(typeof e=="function"?jP(e)?e.prototype instanceof Sr?(e=e.prototype.constructor(e,t,this),n=!0):e=new e:e={__operator:e}:typeof e=="string"&&(e=this.__node.roots[e]),!!e){if(!n){let i=Object.getOwnPropertyNames(e),s=Object.getOwnPropertyNames(Object.getPrototypeOf(e));i.push(...s),i=i.filter(o=>!MP.includes(o));let a={};for(let o of i)a[o]=e[o];e=a}if(e.__node||(e.__node={}),e.__node.initial=e,typeof e=="object"&&!this.get(e.__node.tag)){let i,s=Hb({},e,2);if(n?i=e:i=new Sr(e,t,this),this.set(i.__node.tag,i),this.runLoaders(i,t,e,i.__node.tag),this.__node.roots[i.__node.tag]=s,i.__children&&(i.__children=Object.assign({},i.__children),this.recursiveSet(i.__children,i,r,i.__children)),i.__listeners){r[i.__node.tag]=Object.assign({},i.__listeners);for(let a in i.__listeners){let o=i.__listeners[a];i[a]&&(delete r[i.__node.tag][a],r[i.__node.tag][i.__node.tag+"."+a]=o),typeof o=="string"&&(i.__children?.[o]?r[i.__node.tag][a]=i.__node.tag+"."+o:t instanceof Sr&&(t.__node.tag===o||t.__node.tag.includes(".")&&t.__node.tag.split(".").pop()===o)&&(r[i.__node.tag][a]=t.__node.tag))}}return this.setListeners(r),i.__callConnected(),i}else if(e.__node.tag)return this.get(e.__node.tag)}};recursiveSet=(e,t,r={},n)=>{let i=Object.getOwnPropertyNames(n),s=Object.getOwnPropertyNames(Object.getPrototypeOf(n)).filter(a=>!MP.includes(a));i.push(...s);for(let a of i){if(a.includes("__"))continue;let o=n[a];if(Array.isArray(o))continue;let l;if(typeof o=="function"?jP(o)?(o=new o,o instanceof Sr&&(o=o.prototype.constructor(o,t,this),l=!0)):o={__operator:o}:typeof o=="string"?this.__node.nodes.get(o)?o=this.__node.nodes.get(o):o=this.__node.roots[o]:typeof o=="boolean"&&(this.__node.nodes.get(a)?o=this.__node.nodes.get(a):o=this.__node.roots[a]),o instanceof Object){if(!l&&!(o instanceof Sr)){let d=Object.getOwnPropertyNames(o),p=Object.getOwnPropertyNames(Object.getPrototypeOf(o));p.splice(p.indexOf("constructor"),1),d.push(...p);let _={};for(let w of d)_[w]=o[w];o=_}if(o.__node||(o.__node={}),o.__node.tag||(o.__node.tag=a),o.__node.initial||(o.__node.initial=e[a]),this.get(o.__node.tag)&&!(!(t instanceof _f)&&t?.__node)||t?.__node&&this.get(t.__node.tag+"."+o.__node.tag))continue;let c,f=!1,u=Hb({},o,2);if(l||o instanceof Sr?c=o:(c=new Sr(o,t,this),f=!0),!f&&o instanceof Sr&&!l&&t instanceof Sr){let d=this.subscribe(t.__node.tag,c.__node.tag),p=_=>{this.unsubscribe(t.__node.tag,d)};c.__addOndisconnected(p)}else if(c){if(this.set(c.__node.tag,c),this.runLoaders(c,t,e[a],a),e[a]=c,this.__node.roots[c.__node.tag]=u,c.__children&&(c.__children=Object.assign({},c.__children),this.recursiveSet(c.__children,c,r,c.__children)),c.__listeners){r[c.__node.tag]=Object.assign({},c.__listeners);for(let d in c.__listeners){let p=c.__listeners[d],_=d;c[d]&&(delete r[c.__node.tag][d],_=c.__node.tag+"."+d,r[c.__node.tag][_]=p),typeof p=="string"&&(c.__children?.[p]?r[c.__node.tag][_]=c.__node.tag+"."+p:t instanceof Sr&&(t.__node.tag===p||t.__node.tag.includes(".")&&t.__node.tag.split(".").pop()===p)&&(r[c.__node.tag][_]=t.__node.tag))}}c.__callConnected()}}}return r};remove=(e,t=!0)=>{if(this.unsubscribe(e),typeof e=="string"&&(e=this.get(e)),e instanceof Sr){this.delete(e.__node.tag),delete this.__node.roots[e.__node.tag],t&&this.clearListeners(e),e.__callDisconnected();let r=n=>{for(let i in n)this.unsubscribe(n[i]),this.delete(n[i].__node.tag),delete this.__node.roots[n[i].__node.tag],this.delete(i),delete this.__node.roots[i],n[i].__node.tag=n[i].__node.tag.substring(n[i].__node.tag.lastIndexOf(".")+1),t&&this.clearListeners(n[i]),n[i].__callDisconnected(),n[i].__children&&r(n[i].__children)};e.__children&&r(e.__children)}return e?.__node.tag&&e?.__parent&&(delete e?.__parent,e.__node.tag=e.__node.tag.substring(e.__node.tag.indexOf(".")+1)),e?.__node.graph&&(e.__node.graph=void 0),e};run=(e,...t)=>{if(typeof e=="string"){let r=this.get(e);if(!r&&e.includes(".")){if(r=this.get(e.substring(0,e.lastIndexOf("."))),typeof r?.[e.substring(e.lastIndexOf(".")+1)]=="function")return r[e.substring(e.lastIndexOf(".")+1)](...t)}else if(r?.__operator)return r.__operator(...t)}if(e?.__operator)return e?.__operator(...t)};setListeners=e=>{for(let t in e){let r=this.get(t);if(typeof e[t]=="object")for(let n in e[t]){let i=this.get(n),s;if(typeof e[t][n]!="object")e[t][n]={__callback:e[t][n]};else if(!e[t][n].__callback)for(let a in e[t][n]){typeof e[t][n][a]!="object"&&(e[t][n][a]={__callback:e[t][n][a]},r.__operator&&(e[t][n][a].__callback===!0||typeof e[t][n][a].__callback>"u")&&(e[t][n][a].__callback=r.__operator));let o=this.get(a);if(o)s=this.subscribe(o,e[t][n][a].__callback,e[t][n].__args,void 0,e[t][n].inputState,t,n);else{let l=n.substring(0,n.lastIndexOf("."));if(o=this.get(l),o){let c=n.substring(n.lastIndexOf(".")+1);s=this.subscribe(o,e[t][n][a].__callback,e[t][n][a].__args,c,e[t][n][a].inputState,t,n)}}}if("__callback"in e[t][n])if(r&&((e[t][n].__callback===!0||typeof e[t][n].__callback>"u")&&(e[t][n].__callback=r.__operator),typeof e[t][n].__callback=="function"&&(e[t][n].__callback=e[t][n].__callback.bind(r))),i)s=this.subscribe(i,e[t][n].__callback,e[t][n].__args,void 0,e[t][n].inputState,t,n);else{let a=n.substring(0,n.lastIndexOf("."));i=this.get(a),i&&(s=this.subscribe(i,e[t][n].__callback,e[t][n].__args,n.substring(n.lastIndexOf(".")+1),e[t][n].inputState,t,n))}}}};clearListeners=(e,t)=>{if(typeof e=="string"&&(e=this.get(e)),e?.__listeners)for(let r in e.__listeners){if(t&&r!==t||typeof e.__listeners[r]?.sub!="number")continue;let n=this.get(r);if(n)if(typeof!e.__listeners[r]?.__callback=="number")for(let i in e.__listeners[r])e.__listeners[r][i]?.sub&&(this.unsubscribe(n,e.__listeners[r][i].sub,void 0,e.__listeners[r][i].inputState),e.__listeners[r][i].sub=void 0);else typeof e.__listeners[r]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r].sub,void 0,e.__listeners[r].inputState),e.__listeners[r].sub=void 0);else if(n=this.get(r.substring(0,r.lastIndexOf("."))),n)if(typeof e.__listeners[r]=="object"&&!e.__listeners[r]?.__callback)for(let i in e.__listeners[r])typeof e.__listeners[r][i]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r][i].sub,r.substring(r.lastIndexOf(".")+1),e.__listeners[r][i].inputState),e.__listeners[r][i].sub=void 0);else typeof e.__listeners[r]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r].sub,r.substring(r.lastIndexOf(".")+1),e.__listeners[r].inputState),e.__listeners[r].sub=void 0)}};get=e=>this.__node.nodes.get(e);set=(e,t)=>this.__node.nodes.set(e,t);delete=e=>this.__node.nodes.delete(e);getProps=(e,t)=>{if(typeof e=="string"&&(e=this.get(e)),e instanceof Sr){let r;if(t)r=Object.assign({},this.__node.roots[e.__node.tag]);else{r=Object.assign({},e);for(let n in r)n.includes("__")&&delete r[n]}}};subscribe=(e,t,r,n,i,s,a,o)=>{let l=e;if(typeof e=="string"&&(l=this.get(e),!l&&e.includes(".")&&(l=this.get(e.substring(0,e.lastIndexOf("."))),n=e.substring(e.lastIndexOf(".")+1))),s instanceof Sr&&(s=s.__node.tag),typeof t=="string"){let f=u=>{if(this.get(u)?.__operator){let d=this.get(u);s=u,u=function(...p){return d.__operator(...p)}}else if(u.includes(".")){s=u.substring(0,u.lastIndexOf("."));let d=this.get(s),p=u.substring(u.lastIndexOf(".")+1);o=p,typeof d[p]=="function"?d[p]instanceof Sr?u=d[p]:u=function(..._){return d[p](..._)}:u=function(_){return d[p]=_,d[p]}}return u};if(s){let u=this.get(s);typeof u?.[t]=="function"?(o=t,t=function(...d){return u[n](...d)}):u[n]?(o=n,u[n]instanceof Sr?t=u[n]:t=function(d){return u[n]=d,u[n]}):t=f(t)}else t=f(t)}let c;if(l instanceof Sr){let f=()=>{c=l.__subscribe(t,n,i,s,o,r);let u=()=>{c!==void 0&&l.__unsubscribe(c,n,i),c=void 0};l.__addOndisconnected(()=>{u(),l.__addOnconnected(()=>{c===void 0&&l.__node.graph.__node.tag===this.__node.tag&&f()})}),typeof t=="string"&&this.get(t)&&(t=this.get(t)),t instanceof Sr&&t.__addOndisconnected(()=>{u()})};f()}else if(typeof e=="string"){let f=this.get(e);if(f){if(t instanceof Sr&&t.__operator){let u=()=>{c=f.__subscribe(t.__operator,n,i,s,o,r);let d=()=>{c!==void 0&&f.__unsubscribe(c,n,i)};f.__addOndisconnected(()=>{d(),f.__addOnconnected(()=>{c===void 0&&f.__node.graph.__node.tag===this.__node.tag&&u()})}),t.__addOndisconnected(d)};u()}else if(typeof t=="function"||typeof t=="string"){let u=()=>{c=f.__subscribe(t,n,i,s,o,r);let d=()=>{c!==void 0&&f.__unsubscribe(c,n,i),c=void 0};f.__addOndisconnected(()=>{d(),f.__addOnconnected(()=>{c===void 0&&f.__node.graph.__node.tag===this.__node.tag&&u()})}),typeof t=="string"&&this.get(t)&&this.get(t).__addOndisconnected(d)};u()}}else typeof t=="string"&&(t=this.__node.nodes.get(t).__operator),typeof t=="function"&&(c=this.__node.state.subscribeEvent(e,t))}return c};unsubscribe=(e,t,r,n)=>e instanceof Sr?e.__unsubscribe(t,r,n):this.get(e)?.__unsubscribe(t,r,n);setState=e=>{this.__node.state.setState(e)}};function Hb(e,t,r=1/0,n=0){for(let i in t)t[i]?.constructor.name==="Object"&&n<r?(n++,e[i]?.constructor.name==="Object"?Hb(e[i],t[i],r,n):e[i]=Hb({},t[i],r,n)):e[i]=t[i];return e}function KCe(e){var t=[],r=e;do{var n=Object.getOwnPropertyNames(r);let i=function(s){t.indexOf(s)===-1&&t.push(s)};n.forEach(i)}while(r=Object.getPrototypeOf(r));return t}function jP(e){return YCe(e)==="class"}function YCe(e){return typeof e=="function"?e.prototype?Object.getOwnPropertyDescriptor(e,"prototype")?.writable?"function":"class":e.constructor.name==="AsyncFunction"?"async":"arrow":""}var kS=(e,t)=>{if(t.get(e)?.__operator){let r=t.get(e);return(...n)=>{r.__operator(...n)}}else if(e.includes(".")){let r=e.split("."),n=r.pop(),i=r.join("."),s=t.get(i);return typeof t.get(i)?.[n]=="function"?(...a)=>s[n](...a):()=>s[n]}else if(t.get(e)){let r=t.get(e);return()=>r}else{let r=e;return()=>r}},BP=(e,t,r)=>{let n=[],i=(a,o)=>{if(a==="__output"||a==="__input"||a==="__callback")n[o]={__callback:l=>l,__args:void 0,idx:o};else if(typeof a=="string")n[o]={__callback:kS(a,r),__args:void 0,idx:o};else if(typeof a=="function"){let l=a;n[o]={__callback:(...c)=>l(...c),__args:void 0,idx:o}}else if(typeof a=="object"&&(a.__input||a.__callback)){let l=function(c){let f=c.__input?c.__input:c.__callback;if(typeof c.__input=="string"&&(f={__callback:kS(c.__input,r),__args:void 0,idx:o}),c.__args){let u=BP(f,c.__args,r);f={__callback:u.__callback,__args:u.__args,idx:o}}else f={__callback:f,__args:void 0,idx:o};if(c.__output){let u=c.__output;if(typeof c.__output=="string"?u={__callback:kS(u,r),__args:void 0,idx:o}:typeof a.__output=="object"&&(u=l(u)),typeof u?.__callback=="function"){let d=f.__callback,p=u.__callback;f={__callback:(..._)=>p(d(..._)),__args:u.__args,idx:o}}}return f};n[o]=l(a)}else{let l=a;n[o]={__callback:()=>l,__args:void 0,idx:o}}};t.forEach(i),typeof e=="string"&&(e={__callback:kS(e,r),__args:void 0});let s=typeof e=="function"?e:e.__callback;return e=function(...a){let o=c=>c.__callback(...a);return s(...n.map(o))},{__callback:e,__args:n}},MP=Object.getOwnPropertyNames(Object.getPrototypeOf({})),XCe=(e,t,r)=>{e.__node.backward&&t instanceof Sr&&r.setListeners({[t.__node.tag]:{[e.__node.tag]:t}})},ZCe=(e,t,r)=>{if(e.__operator&&!e.__node.looperSet){if(typeof e.__node.delay=="number"){let n=e.__operator;e.__setOperator((...i)=>new Promise((s,a)=>{setTimeout(async()=>{s(await n(...i))},e.__node.delay)}))}else if(e.__node.frame===!0){let n=e.__operator;e.__setOperator((...i)=>new Promise((s,a)=>{requestAnimationFrame(async()=>{s(await n(...i))})}))}if(typeof e.__node.repeat=="number"||typeof e.__node.recursive=="number"){let n=e.__operator;e.__setOperator(async(...i)=>{let s=e.__node.repeat?e.__node.repeat:e.__node.recursive,a,o=async(l,...c)=>{for(;l>0;){if(e.__node.delay||e.__node.frame){n(...c).then(async f=>{e.__node.recursive?await o(l,f):await o(l,...c)});break}else a=await n(...i);l--}};return await o(s,...i),a})}if(e.__node.loop&&typeof e.__node.loop=="number"){e.__node.looperSet=!0;let n=e.__operator,i=e.__node.loop;e.__setOperator((...a)=>{if("looping"in e.__node||(e.__node.looping=!0),e.__node.looping){let o=performance.now();n(...a),setTimeout(()=>{let c=performance.now()-o-e.__node.loop;c>0?i=e.__node.loop-c:i=e.__node.loop,i<=0&&(i=e.__node.loop),e.__operator(...a)},i)}}),e.__node.looping&&e.__operator();let s=a=>{a.__node.looping&&(a.__node.looping=!1)};e.__addOndisconnected(s)}}},QCe=(e,t,r)=>{if(e.__node.animate===!0||e.__animation){let n=e.__operator;e.__setOperator((...s)=>{"animating"in e.__node||(e.__node.animating=!0),e.__node.animating&&(typeof e.__animation=="function"?e.__animation(...s):n(...s),requestAnimationFrame(()=>{e.__operator(...s)}))}),(e.__node.animating||(!("animating"in e.__node)||e.__node.animating)&&e.__animation)&&setTimeout(()=>{requestAnimationFrame(e.__operator)},10);let i=s=>{s.__node.animating&&(s.__node.animating=!1)};e.__addOndisconnected(i)}},eIe=(e,t,r)=>{if(typeof e.__branch=="object"&&e.__operator&&!e.__branchApplied){let n=e.__operator;e.__branchApplied=!0,e.__operator=(...i)=>{let s=n(...i);for(let a in e.__branch){let o=()=>{typeof e.__branch[a].then=="function"?e.__branch[a].then(s):e.__branch[a].then instanceof Sr&&e.__branch[a].then.__operator?e.__branch[a].then.__operator(s):s=e.__branch[a].then};typeof e.__branch[a].if=="function"?e.__branch[a].if(s)==!0&&o():e.__branch[a].if===s&&o()}return s}}if(e.__listeners){for(let n in e.__listeners)if(typeof e.__listeners[n]=="object"&&e.__listeners[n].branch&&!e.__listeners[n].branchApplied){let i=e.__listeners[n].callback;e.__listeners[n].branchApplied=!0,e.__listeners.callback=s=>{let a=()=>{typeof e.__listeners[n].branch.then=="function"?s=e.__listeners[n].branch.then(s):e.__listeners[n].branch.then instanceof Sr&&e.__listeners[n].branch.then.__operator?s=e.__listeners[n].branch.then.__operator(s):s=e.__listeners[n].branch.then};return typeof e.__listeners[n].branch.if=="function"?e.__listeners[n].branch.if(s)&&a():e.__listeners[n].branch.if===s&&a(),i(s)}}}},tIe=(e,t,r)=>{if(e.__listeners)for(let n in e.__listeners)typeof e.__listeners[n]=="object"&&e.__listeners[n].oncreate&&e.__listeners[n].callback(e.__listeners[n].oncreate)},rIe=(e,t,r)=>{if(e.__listeners)for(let n in e.__listeners)typeof e.__listeners[n]=="object"&&typeof e.__listeners[n].binding=="object"&&(e.__listeners.callback=e.__listeners.callback.bind(e.__listeners[n].binding))},nIe=(e,t,r)=>{if(e.__listeners){for(let n in e.__listeners)if(typeof e.__listeners[n]=="object"&&typeof e.__listeners[n].transform=="function"&&!e.__listeners[n].transformApplied){let i=e.__listeners[n].callback;e.__listeners[n].transformApplied=!0,e.__listeners.callback=s=>(s=e.__listeners[n].transform(s),i(s))}}},iIe=(e,t,r)=>{e.post&&!e.__operator?e.__setOperator(e.post):!e.__operator&&typeof e.get=="function"&&e.__setOperator(e.get),!e.get&&e.__operator&&(e.get=e.__operator),e.aliases&&e.aliases.forEach(n=>{r.set(n,e);let i=s=>{r.__node.nodes.delete(n)};e.__addOndisconnected(i)}),typeof r.__node.roots?.[e.__node.tag]=="object"&&e.get&&(r.__node.roots[e.__node.tag].get=e.get)},AX={backprop:XCe,loop:ZCe,animate:QCe,branching:eIe,triggerListenerOncreate:tIe,bindListener:rIe,transformListenerResult:nIe,substitute__operator:iIe},RP=e=>{let t={};for(let r in e)typeof e[r]=="object"?t[r]=RP(e[r]):typeof e[r]=="function"?t[r]=e[r].toString():t[r]=e[r];return t};function Ih(e=""){let t=a=>a.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),n=(a=>{let o=a.indexOf("=>")+1;return o<=0&&(o=a.indexOf("){")),o<=0&&(o=a.indexOf(") {")),a.slice(0,a.indexOf("{",o)+1)})(e),i=t(e),s;if(n.includes("function")){let a=n.split("(")[1].split(")")[0];s=new Function(a,i)}else if(n.substring(0,6)===i.substring(0,6)){let a=n.split("(")[1].split(")")[0];s=new Function(a,i.substring(i.indexOf("{")+1,i.length-1))}else try{s=(0,eval)(e)}catch{}return s}var sIe=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(a,o){var l=t.length-1,c=t[l];if(typeof c=="object")if(c[a]===o||l===0)r.push(a),t.push(o.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[a]===o){l+=2,t.length=l,r.length=l,--l,t[l]=o,r[l]=a;break}l--}}function s(a,o){if(o!=null&&typeof o=="object"){a&&i(a,o);let l=e.get(o);if(l)return"[Circular Reference]"+l;e.set(o,r.join("."))}return o}return function(o,l){try{return t.push(o),JSON.stringify(o,s,l)}finally{n()}}}();JSON.stringifyWithCircularRefs===void 0&&(JSON.stringifyWithCircularRefs=sIe);var aIe=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(a,o){var l=t.length-1;if(t[l]){var c=t[l];if(typeof c=="object")if(c[a]===o||l===0)r.push(a),t.push(o.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[a]===o){l+=2,t.length=l,r.length=l,--l,t[l]=o,r[l]=a;break}l++}}}function s(a,o){let l;if(o!=null)if(typeof o=="object"){let c=o.constructor.name;a&&c==="Object"&&i(a,o);let f=e.get(o);if(f)return"[Circular Reference]"+f;if(e.set(o,r.join(".")),c==="Array")o.length>20?l=o.slice(o.length-20):l=o;else if(c.includes("Set"))l=Array.from(o);else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean")l="instanceof_"+c;else if(c==="Object"){let u={};for(let d in o)if(o[d]==null)u[d]=o[d];else if(Array.isArray(o[d]))o[d].length>20?u[d]=o[d].slice(o[d].length-20):u[d]=o[d];else if(o[d].constructor.name==="Object"){u[d]={};for(let p in o[d])if(Array.isArray(o[d][p]))o[d][p].length>20?u[d][p]=o[d][p].slice(o[d][p].length-20):u[d][p]=o[d][p];else if(o[d][p]!=null){let _=o[d][p].constructor.name;_.includes("Set")?u[d][p]=Array.from(o[d][p]):_!=="Number"&&_!=="String"&&_!=="Boolean"?u[d][p]="instanceof_"+_:u[d][p]=o[d][p]}else u[d][p]=o[d][p]}else{let p=o[d].constructor.name;p.includes("Set")?u[d]=Array.from(o[d]):p!=="Number"&&p!=="String"&&p!=="Boolean"?u[d]="instanceof_"+p:u[d]=o[d]}l=u}else l=o}else l=o;return l}return function(o,l){t.push(o);let c=JSON.stringify(o,s,l);return n(),c}}();JSON.stringifyFast===void 0&&(JSON.stringifyFast=aIe);function TX(e){if(typeof e.__methods=="object")for(let t in e.__methods){let r=e.__methods[t],n=typeof r=="function"?r:Ih(r);t==="__operator"?e.__setOperator(n):e[t]=n.bind(e)}}var WX=class extends _f{name=`service${Math.floor(Math.random()*1e15)}`;constructor(e){super({...e,loaders:e?.loaders?Object.assign({...AX},e.loaders):{...AX}}),e?.services&&this.addServices(e.services),this.load(this)}addServices=e=>{for(let t in e)if(typeof e[t]=="function"&&(e[t]=new e[t]),e[t]?.__node?.loaders&&Object.assign(this.__node.loaders,e[t].__node.loaders),e[t]?.__node?.nodes){e[t].__node.nodes.forEach((i,s)=>{this.get(s)?this.set(t+"."+s,i):this.set(s,i)}),this.__node.nodes.forEach((i,s)=>{e[t].__node.nodes.get(s)||e[t].__node.nodes.set(s,i)});let r=this.set;this.set=(i,s)=>(e[t].set(i,s),r(i,s));let n=this.delete;this.delete=i=>(e[t].delete(i),n(i))}else typeof e[t]=="object"&&this.load(e[t])};handleMethod=(e,t,r)=>{let n=t.toLowerCase(),i=this.__node.nodes.get(e);if(i||(i=this.__node.roots[e]),i?.[n])if(typeof i[n]!="function"){if(r){Array.isArray(r)&&r.length===1?i[n]=r[0]:i[n]=r;return}return i[n]}else return Array.isArray(r)?i[n](...r):i[n](r);else return this.handleServiceMessage({route:e,args:r,method:t})};handleServiceMessage(e){let t;return typeof e=="object"&&(e.route?t=e.route:e.node&&(t=e.node)),t?Array.isArray(e.args)?this.run(t,...e.args):this.run(t,e.args):e}handleGraphNodeCall(e,t){if(!e)return t;if(t?.args)this.handleServiceMessage(t);else return Array.isArray(t)?this.run(e,...t):this.run(e,t)}transmit=(...e)=>typeof e[0]=="object"?e[0].method?this.handleMethod(e[0].route,e[0].method,e[0].args):e[0].route?this.handleServiceMessage(e[0]):e[0].node?this.handleGraphNodeCall(e[0].node,e[0].args):(this.__node.keepState&&(e[0].route&&this.setState({[e[0].route]:e[0].args}),e[0].node&&this.setState({[e[0].node]:e[0].args})),e):e;receive=(...e)=>{if(e[0]&&typeof e[0]=="string"){let t=e[0].substring(0,8);(t.includes("{")||t.includes("["))&&(t.includes("\\")&&(e[0]=e[0].replace(/\\/g,"")),e[0][0]==='"'&&(e[0]=e[0].substring(1,e[0].length-1)),e[0]=JSON.parse(e[0]))}return typeof e[0]=="object"?e[0].method?this.handleMethod(e[0].route,e[0].method,e[0].args):e[0].route?this.handleServiceMessage(e[0]):e[0].node?this.handleGraphNodeCall(e[0].node,e[0].args):(this.__node.keepState&&(e[0].route&&this.setState({[e[0].route]:e[0].args}),e[0].node&&this.setState({[e[0].node]:e[0].args})),e):e};pipe=(e,t,r,n,i)=>{if(e instanceof Sr)return i?this.subscribe(e,s=>{let a=i(s);a!==void 0?this.transmit({route:t,args:a,method:n}):this.transmit({route:t,args:s,method:n},r)}):this.subscribe(e,s=>{this.transmit({route:t,args:s,method:n},r)});if(typeof e=="string")return this.subscribe(e,s=>{this.transmit({route:t,args:s,method:n},r)})};pipeOnce=(e,t,r,n,i)=>{if(e instanceof Sr)return i?e.__node.state.subscribeEventOnce(e.__node.unique,s=>{let a=i(s);a!==void 0?this.transmit({route:t,args:a,method:n}):this.transmit({route:t,args:s,method:n},r)}):this.__node.state.subscribeEventOnce(e.__node.unique,s=>{this.transmit({route:t,args:s,method:n},r)});if(typeof e=="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(e).__node.unique,s=>{this.transmit({route:t,args:s,method:n},r)})};terminate=(...e)=>{};isTypedArray=oIe;recursivelyAssign=MS;spliceTypedArray=lIe;ping=()=>(console.log("pinged!"),"pong");echo=(...e)=>(this.transmit(...e),e);log=(...e)=>(console.log(...e),!0);error=(...e)=>(console.error(...e),!0)};function oIe(e){return ArrayBuffer.isView(e)&&Object.prototype.toString.call(e)!=="[object DataView]"}var MS=(e,t)=>{for(let r in t)t[r]?.constructor.name==="Object"&&!Array.isArray(t[r])?e[r]?.constructor.name==="Object"&&!Array.isArray(e[r])?MS(e[r],t[r]):e[r]=MS({},t[r]):e[r]=t[r];return e};function lIe(e,t,r){let n=e.subarray(0,t),i;r&&(i=e.subarray(r+1));let s;return(n.length>0||i?.length>0)&&(s=new e.constructor(n.length+i.length)),s&&(n.length>0&&s.set(n),i&&i.length>0&&s.set(i,n.length)),s}var ES={},cIe={transferNode:(e,t,r)=>{let n;if(typeof e=="object"){e.__node||(e.__node={}),r&&(e.__node.tag=r);for(let i in e)typeof e[i]=="function"&&(e.__methods||(e.__methods={}),e.__methods[i]=e[i].toString());n=RP(e)}else typeof e=="function"?n=e.toString():typeof e=="string"&&(n=e);if(n){if(t.run)return t.run("setNode",[n]);if(t.postMessage)return t.postMessage({route:"setNode",args:n},void 0),new Promise(i=>i(r));if(t.send)return t.send(JSON.stringify({route:"setNode",args:n})),new Promise(i=>i(r))}},setNode:function(e,t){if(typeof e=="object"&&e.__methods&&(this.__node.graph.__node.loaders.methodstrings||(this.__node.graph.__node.loaders.methodstrings=TX)),typeof e=="string"){let r=Ih(e);typeof r=="function"?e={__operator:r,__node:{tag:t||r.name}}:(r=JSON.parse(e),typeof r=="object"&&(e=r))}if(typeof e=="object"||typeof e=="function"){let r={};typeof e=="object"?Object.assign(r,e):r.__operator=e;let n=this.__node.graph.add(r);return n?(ES[n.__node.tag]=r,n.__node?.tag):!1}else return!1},proxyRemoteNode:function(e,t){return new Promise((r,n)=>{t.run("getNodeProperties",e).then(i=>{let s={};if(typeof i=="object")for(let a in i)i[a]==="function"?s[a]=(...o)=>new Promise(l=>{t.run(e,o,a).then(l)}):Object.defineProperty(s,a,{get:()=>new Promise(o=>{t.run(e,void 0,a).then(o)}),set:o=>{t.post(e,o,a)},configurable:!0,enumerable:!0});r(s)})})},makeNodeTransferrable:function(e,t){e.__node||(e.__node={}),t&&(e.__node.tag=t);for(let n in e)typeof e[n]=="function"&&(e.__methods||(e.__methods={}),e.__methods[n]=e[n].toString());return RP(e)},setTemplate:function(e,t){if(typeof e=="object"&&e.__methods&&(this.__node.graph.__node.loaders.methodstrings||(this.__node.graph.__node.loaders.methodstrings=TX)),typeof e=="string"){let r=Ih(e);typeof r=="function"?(t||(t=r.name),e={__operator:r,__node:{tag:t}}):(r=JSON.parse(e),typeof r=="object"&&(e=r,!t&&r.__node?.tag&&(t=r.__node.tag)))}return t||(t=`node${Math.floor(Math.random()*1e15)}`),typeof e=="object"||typeof e=="function"?(ES[t]=e,t):!1},loadFromTemplate:function(e,t,r){if(ES[e]){let n=MS({},ES[e]);return t&&(n.__node||(n.__node={}),n.__node.tag=t),r&&Object.assign(n,r),this.__node.graph.add(n).__node.tag}},setMethod:function(e,t,r){if(typeof t=="string"){let n=Ih(t);typeof n=="function"&&(t=n)}return!r&&typeof t=="function"&&(r=t.name),this.__node.graph.get(e)?this.__node.graph.get(e)[r]=t:this.__node.graph.add({__node:{tag:r,[r]:t}}),!0},assignNode:function(e,t){this.__node.graph.get(e)&&typeof t=="object"&&Object.assign(this.__node.graph.get(e),t)},getNodeProperties:function(e){let t=this.__node.graph.get(e);if(t){let r=Object.getOwnPropertyNames(t),n={};for(let i in r)n[i]=typeof t[i];return n}},transferClass:(e,t,r)=>{if(typeof e=="object"){let n=e.toString(),i={route:"receiveClass",args:[n,r]};return t.run?t.run("receiveClass",[n,r]):t.postMessage?(t.postMessage({route:"receiveClass",args:[n,r]},void 0),new Promise(s=>s(name))):t.send?(t.send(JSON.stringify({route:"receiveClass",args:[n,r]})),new Promise(s=>s(name))):i}return!1},receiveClass:function(e,t){if(typeof e=="string"&&e.indexOf("class")===0){let r=(0,eval)("("+e+")"),n=t;return n||(n=r.name),this.__node.graph[n]=r,!0}return!1},transferFunction:(e,t,r)=>{r||(r=e.name);let n=e.toString(),i={route:"setNode",args:[n,r]};return t.run?t.run("setNode",[n,r]):t.postMessage?(t.postMessage({route:"setNode",args:[n,r]},void 0),new Promise(s=>s(name))):t.send?(t.send(JSON.stringify({route:"setNode",args:[n,r]})),new Promise(s=>s(name))):i},setGlobal:(e,t)=>(globalThis[e]=t,!0),assignGlobalObject:(e,t)=>globalThis[e]?(typeof t=="object"&&Object.assign(globalThis[e],t),!0):!1,setValue:function(e,t){return this.__node.graph[e]=t,!0},assignObject:function(e,t){return this.__node.graph[e]?(typeof t=="object"&&Object.assign(this.__node.graph[e],t),!0):!1},setGlobalFunction:(e,t)=>(typeof e=="string"&&(e=Ih(e)),typeof e=="function"?(t||(t=e.name),globalThis[t]=e,!0):!1),setGraphFunction:function(e,t){return typeof e=="string"&&(e=Ih(e)),typeof e=="function"?(t||(t=e.name),this.__node.graph[t]=e,!0):!1}};function uIe(e,...t){return function(n=document.createElement("div")){let i=document.createElement("template");e.map(function(o,l){if(i.innerHTML+=o,t[l]instanceof HTMLElement){let c='<span id="dummyNode12345"></span>';c.id="dummyNode12345",i.innerHTML+=c}else i.innerHTML+=t[l]});let s=i.content.querySelectorAll("#dummyNode12345"),a=0;return t.forEach((o,l)=>{o instanceof HTMLElement&&(console.log(o,s[a]),i.content.replaceChild(o,s[a]),a++)}),n.appendChild(i.content),n}}var rXe=uIe``,ye={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};ye.cipher.aes=function(e){this.s[0][0][0]||this.O();var t,r,n,i,s=this.s[0][4],a=this.s[1];t=e.length;var o=1;if(t!==4&&t!==6&&t!==8)throw new ye.exception.invalid("invalid aes key size");for(this.b=[n=e.slice(0),i=[]],e=t;e<4*t+28;e++)r=n[e-1],(e%t===0||t===8&&e%t===4)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[r&255],e%t===0&&(r=r<<8^r>>>24^o<<24,o=o<<1^283*(o>>7))),n[e]=n[e-t]^r;for(t=0;e;t++,e--)r=n[t&3?e:e-4],i[t]=4>=e||4>t?r:a[0][s[r>>>24]]^a[1][s[r>>16&255]]^a[2][s[r>>8&255]]^a[3][s[r&255]]};ye.cipher.aes.prototype={encrypt:function(e){return CX(this,e,0)},decrypt:function(e){return CX(this,e,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var e=this.s[0],t=this.s[1],r=e[4],n=t[4],i,s,a,o=[],l=[],c,f,u,d;for(i=0;256>i;i++)l[(o[i]=i<<1^283*(i>>7))^i]=i;for(s=a=0;!r[s];s^=c||1,a=l[a]||1)for(u=a^a<<1^a<<2^a<<3^a<<4,u=u>>8^u&255^99,r[s]=u,n[u]=s,f=o[i=o[c=o[s]]],d=16843009*f^65537*i^257*c^16843008*s,f=257*o[u]^16843008*u,i=0;4>i;i++)e[i][s]=f=f<<24^f>>>8,t[i][u]=d=d<<24^d>>>8;for(i=0;5>i;i++)e[i]=e[i].slice(0),t[i]=t[i].slice(0)}};function CX(e,t,r){if(t.length!==4)throw new ye.exception.invalid("invalid aes block size");var n=e.b[r],i=t[0]^n[0],s=t[r?3:1]^n[1],a=t[2]^n[2];t=t[r?1:3]^n[3];var o,l,c,f=n.length/4-2,u,d=4,p=[0,0,0,0];o=e.s[r],e=o[0];var _=o[1],w=o[2],k=o[3],S=o[4];for(u=0;u<f;u++)o=e[i>>>24]^_[s>>16&255]^w[a>>8&255]^k[t&255]^n[d],l=e[s>>>24]^_[a>>16&255]^w[t>>8&255]^k[i&255]^n[d+1],c=e[a>>>24]^_[t>>16&255]^w[i>>8&255]^k[s&255]^n[d+2],t=e[t>>>24]^_[i>>16&255]^w[s>>8&255]^k[a&255]^n[d+3],d+=4,i=o,s=l,a=c;for(u=0;4>u;u++)p[r?3&-u:u]=S[i>>>24]<<24^S[s>>16&255]<<16^S[a>>8&255]<<8^S[t&255]^n[d++],o=i,i=s,s=a,a=t,t=o;return p}ye.bitArray={bitSlice:function(e,t,r){return e=ye.bitArray.$(e.slice(t/32),32-(t&31)).slice(1),r===void 0?e:ye.bitArray.clamp(e,r-t)},extract:function(e,t,r){var n=Math.floor(-t-r&31);return((t+r-1^t)&-32?e[t/32|0]<<32-n^e[t/32+1|0]>>>n:e[t/32|0]>>>n)&(1<<r)-1},concat:function(e,t){if(e.length===0||t.length===0)return e.concat(t);var r=e[e.length-1],n=ye.bitArray.getPartial(r);return n===32?e.concat(t):ye.bitArray.$(t,n,r|0,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return t===0?0:32*(t-1)+ye.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;e=e.slice(0,Math.ceil(t/32));var r=e.length;return t=t&31,0<r&&t&&(e[r-1]=ye.bitArray.partial(t,e[r-1]&2147483648>>t-1,1)),e},partial:function(e,t,r){return e===32?t:(r?t|0:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(ye.bitArray.bitLength(e)!==ye.bitArray.bitLength(t))return!1;var r=0,n;for(n=0;n<e.length;n++)r|=e[n]^t[n];return r===0},$:function(e,t,r,n){var i;for(i=0,n===void 0&&(n=[]);32<=t;t-=32)n.push(r),r=0;if(t===0)return n.concat(e);for(i=0;i<e.length;i++)n.push(r|e[i]>>>t),r=e[i]<<32-t;return i=e.length?e[e.length-1]:0,e=ye.bitArray.getPartial(i),n.push(ye.bitArray.partial(t+e&31,32<t+e?r:n.pop(),1)),n},i:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,r;for(t=0;t<e.length;++t)r=e[t],e[t]=r>>>24|r>>>8&65280|(r&65280)<<8|r<<24;return e}};ye.codec.utf8String={fromBits:function(e){var t="",r=ye.bitArray.bitLength(e),n,i;for(n=0;n<r/8;n++)!(n&3)&&(i=e[n/4]),t+=String.fromCharCode(i>>>8>>>8>>>8),i<<=8;return decodeURIComponent(escape(t))},toBits:function(e){e=unescape(encodeURIComponent(e));var t=[],r,n=0;for(r=0;r<e.length;r++)n=n<<8|e.charCodeAt(r),(r&3)===3&&(t.push(n),n=0);return r&3&&t.push(ye.bitArray.partial(8*(r&3),n)),t}};ye.codec.hex={fromBits:function(e){var t="",r;for(r=0;r<e.length;r++)t+=((e[r]|0)+0xf00000000000).toString(16).substr(4);return t.substr(0,ye.bitArray.bitLength(e)/4)},toBits:function(e){var t,r=[],n;for(e=e.replace(/\s|0x/g,""),n=e.length,e=e+"00000000",t=0;t<e.length;t+=8)r.push(parseInt(e.substr(t,8),16)^0);return ye.bitArray.clamp(r,4*n)}};ye.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(e,t,r){var n=ye.codec.base32.BASE,i=ye.codec.base32.REMAINING,s="",a=0,o=ye.codec.base32.B,l=0,c=ye.bitArray.bitLength(e);for(r&&(o=ye.codec.base32.X),r=0;s.length*n<c;)s+=o.charAt((l^e[r]>>>a)>>>i),a<n?(l=e[r]<<n-a,a+=i,r++):(l<<=n,a-=n);for(;s.length&7&&!t;)s+="=";return s},toBits:function(e,t){e=e.replace(/\s|=/g,"").toUpperCase();var r=ye.codec.base32.BITS,n=ye.codec.base32.BASE,i=ye.codec.base32.REMAINING,s=[],a,o=0,l=ye.codec.base32.B,c=0,f,u="base32";for(t&&(l=ye.codec.base32.X,u="base32hex"),a=0;a<e.length;a++){if(f=l.indexOf(e.charAt(a)),0>f){if(!t)try{return ye.codec.base32hex.toBits(e)}catch{}throw new ye.exception.invalid("this isn't "+u+"!")}o>i?(o-=i,s.push(c^f>>>o),c=f<<r-o):(o+=n,c^=f<<r-o)}return o&56&&s.push(ye.bitArray.partial(o&56,c,1)),s}};ye.codec.base32hex={fromBits:function(e,t){return ye.codec.base32.fromBits(e,t,1)},toBits:function(e){return ye.codec.base32.toBits(e,1)}};ye.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,r){var n="",i=0,s=ye.codec.base64.B,a=0,o=ye.bitArray.bitLength(e);for(r&&(s=s.substr(0,62)+"-_"),r=0;6*n.length<o;)n+=s.charAt((a^e[r]>>>i)>>>26),6>i?(a=e[r]<<6-i,i+=26,r++):(a<<=6,i-=6);for(;n.length&3&&!t;)n+="=";return n},toBits:function(e,t){e=e.replace(/\s|=/g,"");var r=[],n,i=0,s=ye.codec.base64.B,a=0,o;for(t&&(s=s.substr(0,62)+"-_"),n=0;n<e.length;n++){if(o=s.indexOf(e.charAt(n)),0>o)throw new ye.exception.invalid("this isn't base64!");26<i?(i-=26,r.push(a^o>>>i),a=o<<32-i):(i+=6,a^=o<<32-i)}return i&56&&r.push(ye.bitArray.partial(i&56,a,1)),r}};ye.codec.base64url={fromBits:function(e){return ye.codec.base64.fromBits(e,1,1)},toBits:function(e){return ye.codec.base64.toBits(e,1)}};ye.hash.sha256=function(e){this.b[0]||this.O(),e?(this.F=e.F.slice(0),this.A=e.A.slice(0),this.l=e.l):this.reset()};ye.hash.sha256.hash=function(e){return new ye.hash.sha256().update(e).finalize()};ye.hash.sha256.prototype={blockSize:512,reset:function(){return this.F=this.Y.slice(0),this.A=[],this.l=0,this},update:function(e){typeof e=="string"&&(e=ye.codec.utf8String.toBits(e));var t,r=this.A=ye.bitArray.concat(this.A,e);if(t=this.l,e=this.l=t+ye.bitArray.bitLength(e),9007199254740991<e)throw new ye.exception.invalid("Cannot hash more than 2^53 - 1 bits");if(typeof Uint32Array<"u"){var n=new Uint32Array(r),i=0;for(t=512+t-(512+t&511);t<=e;t+=512)OP(this,n.subarray(16*i,16*(i+1))),i+=1;r.splice(0,16*i)}else for(t=512+t-(512+t&511);t<=e;t+=512)OP(this,r.splice(0,16));return this},finalize:function(){var e,r=this.A,t=this.F,r=ye.bitArray.concat(r,[ye.bitArray.partial(1,1)]);for(e=r.length+2;e&15;e++)r.push(0);for(r.push(Math.floor(this.l/4294967296)),r.push(this.l|0);r.length;)OP(this,r.splice(0,16));return this.reset(),t},Y:[],b:[],O:function(){function e(s){return 4294967296*(s-Math.floor(s))|0}for(var t=0,r=2,n,i;64>t;r++){for(i=!0,n=2;n*n<=r;n++)if(r%n===0){i=!1;break}i&&(8>t&&(this.Y[t]=e(Math.pow(r,.5))),this.b[t]=e(Math.pow(r,1/3)),t++)}}};function OP(e,t){var r,n,i,s=e.F,a=e.b,o=s[0],l=s[1],c=s[2],f=s[3],u=s[4],d=s[5],p=s[6],_=s[7];for(r=0;64>r;r++)16>r?n=t[r]:(n=t[r+1&15],i=t[r+14&15],n=t[r&15]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+t[r&15]+t[r+9&15]|0),n=n+_+(u>>>6^u>>>11^u>>>25^u<<26^u<<21^u<<7)+(p^u&(d^p))+a[r],_=p,p=d,d=u,u=f+n|0,f=c,c=l,l=o,o=n+(l&c^f&(l^c))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;s[0]=s[0]+o|0,s[1]=s[1]+l|0,s[2]=s[2]+c|0,s[3]=s[3]+f|0,s[4]=s[4]+u|0,s[5]=s[5]+d|0,s[6]=s[6]+p|0,s[7]=s[7]+_|0}ye.mode.ccm={name:"ccm",G:[],listenProgress:function(e){ye.mode.ccm.G.push(e)},unListenProgress:function(e){e=ye.mode.ccm.G.indexOf(e),-1<e&&ye.mode.ccm.G.splice(e,1)},fa:function(e){var t=ye.mode.ccm.G.slice(),r;for(r=0;r<t.length;r+=1)t[r](e)},encrypt:function(e,t,r,n,i){var s,a=t.slice(0),o=ye.bitArray,l=o.bitLength(r)/8,c=o.bitLength(a)/8;if(i=i||64,n=n||[],7>l)throw new ye.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;4>s&&c>>>8*s;s++);return s<15-l&&(s=15-l),r=o.clamp(r,8*(15-s)),t=ye.mode.ccm.V(e,t,r,n,i,s),a=ye.mode.ccm.C(e,a,r,t,i,s),o.concat(a.data,a.tag)},decrypt:function(e,t,r,n,i){i=i||64,n=n||[];var s=ye.bitArray,a=s.bitLength(r)/8,c=s.bitLength(t),o=s.clamp(t,c-i),l=s.bitSlice(t,c-i),c=(c-i)/8;if(7>a)throw new ye.exception.invalid("ccm: iv must be at least 7 bytes");for(t=2;4>t&&c>>>8*t;t++);if(t<15-a&&(t=15-a),r=s.clamp(r,8*(15-t)),o=ye.mode.ccm.C(e,o,r,l,i,t),e=ye.mode.ccm.V(e,o.data,r,n,i,t),!s.equal(o.tag,e))throw new ye.exception.corrupt("ccm: tag doesn't match");return o.data},na:function(e,t,r,n,i,s){var a=[],o=ye.bitArray,l=o.i;if(n=[o.partial(8,(t.length?64:0)|n-2<<2|s-1)],n=o.concat(n,r),n[3]|=i,n=e.encrypt(n),t.length)for(r=o.bitLength(t)/8,65279>=r?a=[o.partial(16,r)]:4294967295>=r&&(a=o.concat([o.partial(16,65534)],[r])),a=o.concat(a,t),t=0;t<a.length;t+=4)n=e.encrypt(l(n,a.slice(t,t+4).concat([0,0,0])));return n},V:function(e,t,r,n,i,s){var a=ye.bitArray,o=a.i;if(i/=8,i%2||4>i||16<i)throw new ye.exception.invalid("ccm: invalid tag length");if(4294967295<n.length||4294967295<t.length)throw new ye.exception.bug("ccm: can't deal with 4GiB or more data");for(r=ye.mode.ccm.na(e,n,r,i,a.bitLength(t)/8,s),n=0;n<t.length;n+=4)r=e.encrypt(o(r,t.slice(n,n+4).concat([0,0,0])));return a.clamp(r,8*i)},C:function(e,t,r,n,i,s){var a,o=ye.bitArray;a=o.i;var l=t.length,c=o.bitLength(t),f=l/50,u=f;if(r=o.concat([o.partial(8,s-1)],r).concat([0,0,0]).slice(0,4),n=o.bitSlice(a(n,e.encrypt(r)),0,i),!l)return{tag:n,data:[]};for(a=0;a<l;a+=4)a>f&&(ye.mode.ccm.fa(a/l),f+=u),r[3]++,i=e.encrypt(r),t[a]^=i[0],t[a+1]^=i[1],t[a+2]^=i[2],t[a+3]^=i[3];return{tag:n,data:o.clamp(t,c)}}};ye.mode.ocb2={name:"ocb2",encrypt:function(e,t,r,n,i,s){if(ye.bitArray.bitLength(r)!==128)throw new ye.exception.invalid("ocb iv must be 128 bits");var a,o=ye.mode.ocb2.S,l=ye.bitArray,c=l.i,f=[0,0,0,0];r=o(e.encrypt(r));var u,d=[];for(n=n||[],i=i||64,a=0;a+4<t.length;a+=4)u=t.slice(a,a+4),f=c(f,u),d=d.concat(c(r,e.encrypt(c(r,u)))),r=o(r);return u=t.slice(a),t=l.bitLength(u),a=e.encrypt(c(r,[0,0,0,t])),u=l.clamp(c(u.concat([0,0,0]),a),t),f=c(f,c(u.concat([0,0,0]),a)),f=e.encrypt(c(f,c(r,o(r)))),n.length&&(f=c(f,s?n:ye.mode.ocb2.pmac(e,n))),d.concat(l.concat(u,l.clamp(f,i)))},decrypt:function(e,t,r,n,i,s){if(ye.bitArray.bitLength(r)!==128)throw new ye.exception.invalid("ocb iv must be 128 bits");i=i||64;var a=ye.mode.ocb2.S,o=ye.bitArray,l=o.i,c=[0,0,0,0],f=a(e.encrypt(r)),u,d,p=ye.bitArray.bitLength(t)-i,_=[];for(n=n||[],r=0;r+4<p/32;r+=4)u=l(f,e.decrypt(l(f,t.slice(r,r+4)))),c=l(c,u),_=_.concat(u),f=a(f);if(d=p-32*r,u=e.encrypt(l(f,[0,0,0,d])),u=l(u,o.clamp(t.slice(r),d).concat([0,0,0])),c=l(c,u),c=e.encrypt(l(c,l(f,a(f)))),n.length&&(c=l(c,s?n:ye.mode.ocb2.pmac(e,n))),!o.equal(o.clamp(c,i),o.bitSlice(t,p)))throw new ye.exception.corrupt("ocb: tag doesn't match");return _.concat(o.clamp(u,d))},pmac:function(e,t){var r,n=ye.mode.ocb2.S,i=ye.bitArray,s=i.i,a=[0,0,0,0],o=e.encrypt([0,0,0,0]),o=s(o,n(n(o)));for(r=0;r+4<t.length;r+=4)o=n(o),a=s(a,e.encrypt(s(o,t.slice(r,r+4))));return r=t.slice(r),128>i.bitLength(r)&&(o=s(o,n(o)),r=i.concat(r,[-2147483648,0,0,0])),a=s(a,r),e.encrypt(s(n(s(o,n(o))),a))},S:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}};ye.mode.gcm={name:"gcm",encrypt:function(e,t,r,n,i){var s=t.slice(0);return t=ye.bitArray,n=n||[],e=ye.mode.gcm.C(!0,e,s,n,r,i||128),t.concat(e.data,e.tag)},decrypt:function(e,t,r,n,i){var s=t.slice(0),a=ye.bitArray,o=a.bitLength(s);if(i=i||128,n=n||[],i<=o?(t=a.bitSlice(s,o-i),s=a.bitSlice(s,0,o-i)):(t=s,s=[]),e=ye.mode.gcm.C(!1,e,s,n,r,i),!a.equal(e.tag,t))throw new ye.exception.corrupt("gcm: tag doesn't match");return e.data},ka:function(e,t){var r,n,i,s,a,o=ye.bitArray.i;for(i=[0,0,0,0],s=t.slice(0),r=0;128>r;r++){for((n=(e[Math.floor(r/32)]&1<<31-r%32)!==0)&&(i=o(i,s)),a=(s[3]&1)!==0,n=3;0<n;n--)s[n]=s[n]>>>1|(s[n-1]&1)<<31;s[0]>>>=1,a&&(s[0]^=-520093696)}return i},j:function(e,t,r){var n,i=r.length;for(t=t.slice(0),n=0;n<i;n+=4)t[0]^=4294967295&r[n],t[1]^=4294967295&r[n+1],t[2]^=4294967295&r[n+2],t[3]^=4294967295&r[n+3],t=ye.mode.gcm.ka(t,e);return t},C:function(e,t,r,n,i,s){var a,o,l,c,f,u,d,p,_=ye.bitArray;for(u=r.length,d=_.bitLength(r),p=_.bitLength(n),o=_.bitLength(i),a=t.encrypt([0,0,0,0]),o===96?(i=i.slice(0),i=_.concat(i,[1])):(i=ye.mode.gcm.j(a,[0,0,0,0],i),i=ye.mode.gcm.j(a,i,[0,0,Math.floor(o/4294967296),o&4294967295])),o=ye.mode.gcm.j(a,[0,0,0,0],n),f=i.slice(0),n=o.slice(0),e||(n=ye.mode.gcm.j(a,o,r)),c=0;c<u;c+=4)f[3]++,l=t.encrypt(f),r[c]^=l[0],r[c+1]^=l[1],r[c+2]^=l[2],r[c+3]^=l[3];return r=_.clamp(r,d),e&&(n=ye.mode.gcm.j(a,o,r)),e=[Math.floor(p/4294967296),p&4294967295,Math.floor(d/4294967296),d&4294967295],n=ye.mode.gcm.j(a,n,e),l=t.encrypt(i),n[0]^=l[0],n[1]^=l[1],n[2]^=l[2],n[3]^=l[3],{tag:_.bitSlice(n,0,s),data:r}}};ye.misc.hmac=function(e,t){this.W=t=t||ye.hash.sha256;var r=[[],[]],n,i=t.prototype.blockSize/32;for(this.w=[new t,new t],e.length>i&&(e=t.hash(e)),n=0;n<i;n++)r[0][n]=e[n]^909522486,r[1][n]=e[n]^1549556828;this.w[0].update(r[0]),this.w[1].update(r[1]),this.R=new t(this.w[0])};ye.misc.hmac.prototype.encrypt=ye.misc.hmac.prototype.mac=function(e){if(this.aa)throw new ye.exception.invalid("encrypt on already updated hmac called!");return this.update(e),this.digest(e)};ye.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]),this.aa=!1};ye.misc.hmac.prototype.update=function(e){this.aa=!0,this.R.update(e)};ye.misc.hmac.prototype.digest=function(){var e=this.R.finalize(),e=new this.W(this.w[1]).update(e).finalize();return this.reset(),e};ye.misc.pbkdf2=function(e,t,r,n,i){if(r=r||1e4,0>n||0>r)throw new ye.exception.invalid("invalid params to pbkdf2");typeof e=="string"&&(e=ye.codec.utf8String.toBits(e)),typeof t=="string"&&(t=ye.codec.utf8String.toBits(t)),i=i||ye.misc.hmac,e=new i(e);var s,a,o,l,c=[],f=ye.bitArray;for(l=1;32*c.length<(n||1);l++){for(i=s=e.encrypt(f.concat(t,[l])),a=1;a<r;a++)for(s=e.encrypt(s),o=0;o<s.length;o++)i[o]^=s[o];c=c.concat(i)}return n&&(c=f.clamp(c,n)),c};ye.prng=function(e){this.c=[new ye.hash.sha256],this.m=[0],this.P=0,this.H={},this.N=0,this.U={},this.Z=this.f=this.o=this.ha=0,this.b=[0,0,0,0,0,0,0,0],this.h=[0,0,0,0],this.L=void 0,this.M=e,this.D=!1,this.K={progress:{},seeded:{}},this.u=this.ga=0,this.I=1,this.J=2,this.ca=65536,this.T=[0,48,64,96,128,192,256,384,512,768,1024],this.da=3e4,this.ba=80};ye.prng.prototype={randomWords:function(e,t){var r=[],n;n=this.isReady(t);var i;if(n===this.u)throw new ye.exception.notReady("generator isn't seeded");if(n&this.J){n=!(n&this.I),i=[];var s=0,a;for(this.Z=i[0]=new Date().valueOf()+this.da,a=0;16>a;a++)i.push(4294967296*Math.random()|0);for(a=0;a<this.c.length&&(i=i.concat(this.c[a].finalize()),s+=this.m[a],this.m[a]=0,n||!(this.P&1<<a));a++);for(this.P>=1<<this.c.length&&(this.c.push(new ye.hash.sha256),this.m.push(0)),this.f-=s,s>this.o&&(this.o=s),this.P++,this.b=ye.hash.sha256.hash(this.b.concat(i)),this.L=new ye.cipher.aes(this.b),n=0;4>n&&(this.h[n]=this.h[n]+1|0,!this.h[n]);n++);}for(n=0;n<e;n+=4)(n+1)%this.ca===0&&NX(this),i=$P(this),r.push(i[0],i[1],i[2],i[3]);return NX(this),r.slice(0,e)},setDefaultParanoia:function(e,t){if(e===0&&t!=="Setting paranoia=0 will ruin your security; use it only for testing")throw new ye.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=e},addEntropy:function(e,t,r){r=r||"user";var n,i,s=new Date().valueOf(),a=this.H[r],o=this.isReady(),l=0;switch(n=this.U[r],n===void 0&&(n=this.U[r]=this.ha++),a===void 0&&(a=this.H[r]=0),this.H[r]=(this.H[r]+1)%this.c.length,typeof e){case"number":t===void 0&&(t=1),this.c[a].update([n,this.N++,1,t,s,1,e|0]);break;case"object":if(r=Object.prototype.toString.call(e),r==="[object Uint32Array]"){for(i=[],r=0;r<e.length;r++)i.push(e[r]);e=i}else for(r!=="[object Array]"&&(l=1),r=0;r<e.length&&!l;r++)typeof e[r]!="number"&&(l=1);if(!l){if(t===void 0)for(r=t=0;r<e.length;r++)for(i=e[r];0<i;)t++,i=i>>>1;this.c[a].update([n,this.N++,2,t,s,e.length].concat(e))}break;case"string":t===void 0&&(t=e.length),this.c[a].update([n,this.N++,3,t,s,e.length]),this.c[a].update(e);break;default:l=1}if(l)throw new ye.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[a]+=t,this.f+=t,o===this.u&&(this.isReady()!==this.u&&IX("seeded",Math.max(this.o,this.f)),IX("progress",this.getProgress()))},isReady:function(e){return e=this.T[e!==void 0?e:this.M],this.o&&this.o>=e?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=e?this.J|this.u:this.u},getProgress:function(e){return e=this.T[e||this.M],this.o>=e||this.f>e?1:this.f/e},startCollectors:function(){if(!this.D){if(this.a={loadTimeCollector:Ub(this,this.ma),mouseCollector:Ub(this,this.oa),keyboardCollector:Ub(this,this.la),accelerometerCollector:Ub(this,this.ea),touchCollector:Ub(this,this.qa)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new ye.exception.bug("can't attach event");this.D=!0}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=!1)},addEventListener:function(e,t){this.K[e][this.ga++]=t},removeEventListener:function(e,t){var r,n,i=this.K[e],s=[];for(n in i)i.hasOwnProperty(n)&&i[n]===t&&s.push(n);for(r=0;r<s.length;r++)n=s[r],delete i[n]},la:function(){$b(this,1)},oa:function(e){var t,r;try{t=e.x||e.clientX||e.offsetX||0,r=e.y||e.clientY||e.offsetY||0}catch{r=t=0}t!=0&&r!=0&&this.addEntropy([t,r],2,"mouse"),$b(this,0)},qa:function(e){e=e.touches[0]||e.changedTouches[0],this.addEntropy([e.pageX||e.clientX,e.pageY||e.clientY],1,"touch"),$b(this,0)},ma:function(){$b(this,2)},ea:function(e){if(e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,window.orientation){var t=window.orientation;typeof t=="number"&&this.addEntropy(t,1,"accelerometer")}e&&this.addEntropy(e,2,"accelerometer"),$b(this,0)}};function IX(e,t){var r,n=ye.random.K[e],i=[];for(r in n)n.hasOwnProperty(r)&&i.push(n[r]);for(r=0;r<i.length;r++)i[r](t)}function $b(e,t){typeof window<"u"&&window.performance&&typeof window.performance.now=="function"?e.addEntropy(window.performance.now(),t,"loadtime"):e.addEntropy(new Date().valueOf(),t,"loadtime")}function NX(e){e.b=$P(e).concat($P(e)),e.L=new ye.cipher.aes(e.b)}function $P(e){for(var t=0;4>t&&(e.h[t]=e.h[t]+1|0,!e.h[t]);t++);return e.L.encrypt(e.h)}function Ub(e,t){return function(){t.apply(e,arguments)}}ye.random=new ye.prng(6);e:try{if(TP=typeof module<"u"&&module.exports){try{CP=zCe("crypto")}catch{CP=null}TP=AP=CP}if(TP&&AP.randomBytes)OS=AP.randomBytes(128),OS=new Uint32Array(new Uint8Array(OS).buffer),ye.random.addEntropy(OS,1024,"crypto['randomBytes']");else if(typeof window<"u"&&typeof Uint32Array<"u"){if(AS=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(AS);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(AS);else break e;ye.random.addEntropy(AS,1024,"crypto['getRandomValues']")}}catch(e){typeof window<"u"&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}var OS,AP,AS,TP,CP;ye.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(e,t,r,n){r=r||{},n=n||{};var i=ye.json,s=i.g({iv:ye.random.randomWords(4,0)},i.defaults),a;if(i.g(s,r),r=s.adata,typeof s.salt=="string"&&(s.salt=ye.codec.base64.toBits(s.salt)),typeof s.iv=="string"&&(s.iv=ye.codec.base64.toBits(s.iv)),!ye.mode[s.mode]||!ye.cipher[s.cipher]||typeof e=="string"&&100>=s.iter||s.ts!==64&&s.ts!==96&&s.ts!==128||s.ks!==128&&s.ks!==192&&s.ks!==256||2>s.iv.length||4<s.iv.length)throw new ye.exception.invalid("json encrypt: invalid parameters");return typeof e=="string"?(a=ye.misc.cachedPbkdf2(e,s),e=a.key.slice(0,s.ks/32),s.salt=a.salt):ye.ecc&&e instanceof ye.ecc.elGamal.publicKey&&(a=e.kem(),s.kemtag=a.tag,e=a.key.slice(0,s.ks/32)),typeof t=="string"&&(t=ye.codec.utf8String.toBits(t)),typeof r=="string"&&(s.adata=r=ye.codec.utf8String.toBits(r)),a=new ye.cipher[s.cipher](e),i.g(n,s),n.key=e,s.ct=s.mode==="ccm"&&ye.arrayBuffer&&ye.arrayBuffer.ccm&&t instanceof ArrayBuffer?ye.arrayBuffer.ccm.encrypt(a,t,s.iv,r,s.ts):ye.mode[s.mode].encrypt(a,t,s.iv,r,s.ts),s},encrypt:function(e,t,r,n){var i=ye.json,s=i.ja.apply(i,arguments);return i.encode(s)},ia:function(e,t,r,n){r=r||{},n=n||{};var i=ye.json;t=i.g(i.g(i.g({},i.defaults),t),r,!0);var s,a;if(s=t.adata,typeof t.salt=="string"&&(t.salt=ye.codec.base64.toBits(t.salt)),typeof t.iv=="string"&&(t.iv=ye.codec.base64.toBits(t.iv)),!ye.mode[t.mode]||!ye.cipher[t.cipher]||typeof e=="string"&&100>=t.iter||t.ts!==64&&t.ts!==96&&t.ts!==128||t.ks!==128&&t.ks!==192&&t.ks!==256||!t.iv||2>t.iv.length||4<t.iv.length)throw new ye.exception.invalid("json decrypt: invalid parameters");return typeof e=="string"?(a=ye.misc.cachedPbkdf2(e,t),e=a.key.slice(0,t.ks/32),t.salt=a.salt):ye.ecc&&e instanceof ye.ecc.elGamal.secretKey&&(e=e.unkem(ye.codec.base64.toBits(t.kemtag)).slice(0,t.ks/32)),typeof s=="string"&&(s=ye.codec.utf8String.toBits(s)),a=new ye.cipher[t.cipher](e),s=t.mode==="ccm"&&ye.arrayBuffer&&ye.arrayBuffer.ccm&&t.ct instanceof ArrayBuffer?ye.arrayBuffer.ccm.decrypt(a,t.ct,t.iv,t.tag,s,t.ts):ye.mode[t.mode].decrypt(a,t.ct,t.iv,s,t.ts),i.g(n,t),n.key=e,r.raw===1?s:ye.codec.utf8String.fromBits(s)},decrypt:function(e,t,r,n){var i=ye.json;return i.ia(e,i.decode(t),r,n)},encode:function(e){var t,r="{",n="";for(t in e)if(e.hasOwnProperty(t)){if(!t.match(/^[a-z0-9]+$/i))throw new ye.exception.invalid("json encode: invalid property name");switch(r+=n+'"'+t+'":',n=",",typeof e[t]){case"number":case"boolean":r+=e[t];break;case"string":r+='"'+escape(e[t])+'"';break;case"object":r+='"'+ye.codec.base64.fromBits(e[t],0)+'"';break;default:throw new ye.exception.bug("json encode: unsupported type")}}return r+"}"},decode:function(e){if(e=e.replace(/\s/g,""),!e.match(/^\{.*\}$/))throw new ye.exception.invalid("json decode: this isn't json!");e=e.replace(/^\{|\}$/g,"").split(/,/);var t={},r,n;for(r=0;r<e.length;r++){if(!(n=e[r].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new ye.exception.invalid("json decode: this isn't json!");n[3]!=null?t[n[2]]=parseInt(n[3],10):n[4]!=null?t[n[2]]=n[2].match(/^(ct|adata|salt|iv)$/)?ye.codec.base64.toBits(n[4]):unescape(n[4]):n[5]!=null&&(t[n[2]]=n[5]==="true")}return t},g:function(e,t,r){if(e===void 0&&(e={}),t===void 0)return e;for(var n in t)if(t.hasOwnProperty(n)){if(r&&e[n]!==void 0&&e[n]!==t[n])throw new ye.exception.invalid("required parameter overridden");e[n]=t[n]}return e},sa:function(e,t){var r={},n;for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(r[n]=e[n]);return r},ra:function(e,t){var r={},n;for(n=0;n<t.length;n++)e[t[n]]!==void 0&&(r[t[n]]=e[t[n]]);return r}};ye.encrypt=ye.json.encrypt;ye.decrypt=ye.json.decrypt;ye.misc.pa={};ye.misc.cachedPbkdf2=function(e,t){var r=ye.misc.pa,n;return t=t||{},n=t.iter||1e3,r=r[e]=r[e]||{},n=r[n]=r[n]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):ye.random.randomWords(2,0)},r=t.salt===void 0?n.firstSalt:t.salt,n[r]=n[r]||ye.misc.pbkdf2(e,r,t.iter),{key:n[r].slice(0),salt:r.slice(0)}};var FS=class extends WX{name="http";fetchProxied=!1;listening={};constructor(e,t,r){super(e),this.load(this),this.listen(t,r)}GET=(e="http://localhost:8080/ping",t="",r)=>(t==="json"&&(r="application/json"),new Promise((n,i)=>{let s=FS.request({method:"GET",url:e,responseType:t,mimeType:r,onload:a=>{let o;s.responseType===""||s.responseType==="text"?o=s.responseText:o=s.response,e instanceof URL&&(e=e.toString()),this.setState({[e]:o}),n(o)},onabort:a=>{i(a)}})}).catch(console.error));POST=(e,t="http://localhost:8080/echo",r="",n)=>(typeof e=="object"&&(r==="json"||r==="text"||!r)&&(e=JSON.stringify(e)),r==="json"&&(n="application/json"),new Promise((i,s)=>{let a=FS.request({method:"POST",url:t,data:e,responseType:r,mimeType:n,onload:o=>{let l;a.responseType===""||a.responseType==="text"?l=a.responseText:l=a.response,t instanceof URL&&(t=t.toString()),this.setState({[t]:l}),i(l)},onabort:o=>{s(o)}})}).catch(console.error));transmit=(e,t)=>{let r=e;return typeof r=="object"&&(e=JSON.stringify(r)),r?.method?.toLowerCase()=="get"||e?.toLowerCase()==="get"?this.GET(t):this.POST(e,t)};transponder=(e,t,r="",n)=>{typeof t=="object"&&(t=JSON.stringify(t));let i="GET";if(t&&(i="POST"),r==="json")n="application/json";else return new Promise((s,a)=>{let o=FS.request({method:i,url:e,data:t,responseType:r,onload:l=>{let c=o.response;if(typeof c=="string"){let f=c.substring(0,8);(f.includes("{")||f.includes("["))&&(f.includes("\\")&&(c=c.replace(/\\/g,"")),c[0]==='"'&&(c=c.substring(1,c.length-1)),c=JSON.parse(c))}return typeof c?.method=="string"?s(this.handleMethod(c.route,c.method,c.args)):typeof c?.route=="string"?s(this.handleServiceMessage(c)):typeof c?.node=="string"||c.node instanceof Sr?s(this.handleGraphNodeCall(c.node,c.args)):s(c)},onabort:l=>{a(l)}})}).catch(console.error)};listen=(e="0",t=async(r,n,i)=>{let s=await r.text(),a=this.receive(s);this.setState({[i.url]:a})})=>{this.listening[e]={};let r=`${e}${Math.floor(Math.random()*1e15)}`;return this.listening[e][r]=t,this.fetchProxied||(globalThis.fetch=new Proxy(globalThis.fetch,{apply(n,i,s){let a=n.apply(i,s);return a.then(o=>{if(o.ok){if(this.listening[0])for(let l in this.listeners){let c=o.clone();this.listening[0][l](c,s,o)}else for(let l in this.listening)if(o.url.includes(l)){for(let c in this.listening[e]){let f=o.clone();this.listening[e][c](f,s,o)}break}}}).catch(o=>{console.error(o)}),a}}),this.fetchProxied=!0),r};stopListening=(e,t)=>{if(!e&&e!==0)for(let r in this.listening)delete this.listening[r];else t?delete this.listening[t]:delete this.listening[e]}},fIe=FS;WCe(fIe,"request",e=>{let t=new XMLHttpRequest;return e.responseType?t.responseType=e.responseType:e.responseType="json",e.mimeType&&t.overrideMimeType(e.mimeType),e.onload&&t.addEventListener("load",e.onload,!1),e.onprogress&&t.addEventListener("progress",e.onprogress,!1),e.onabort&&t.addEventListener("abort",e.onabort,!1),e.onloadend&&t.addEventListener("loadend",e.onloadend,!1),e.onerror&&t.addEventListener("error",e.onerror,!1),t.open(e.method,e.url,!0,e.user,e.pass),e.onerror||(t.onerror=function(){t.abort()}),t.send(e.data),t});var vf=HCe(JCe()),dIe=class extends WX{name="worker";workers={};threadRot=0;connections;constructor(e){super(),this.connections={workers:this.workers},e?.services&&this.addServices(e.services),this.load(this),this.setLoaders(this.workerloader),e&&this.init(e),typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope&&this.addDefaultMessageListener()}loadWorkerRoute=(e,t)=>{e.workerUrl&&(e.url=e.workerUrl),e.workerId&&(e.__node.tag=e.workerId),e.__node.tag||(e.__node.tag=t),e._id=e.__node.tag;let r;if(this.workers[e._id]?r=this.workers[e._id]:e.worker&&(r=e.worker),r||(r=this.addWorker(e)),e.worker=r,!e.worker.__ondisconnected){let n=i=>{i.worker?.terminate()};e.__addOndisconnected(n)}if(e.transferFunctions)for(let n in e.transferFunctions)this.transferFunction(r,e.transferFunctions[n],n);if(e.transferClasses)for(let n in e.transferClasses)this.transferClass(r,e.transferClasses[n],n);if(r)return e.__operator||(e.__operator=(...n)=>{if(e.callback)if(!this.__node.nodes.get(e.__node.tag)?.__children)r.post(e.callback,n);else return r.run(e.callback,n);else if(!this.__node.nodes.get(e.__node.tag)?.__children)r.send(n);else return r.request(n)}),e.init&&r.run(e.init,e.initArgs,void 0,e.initTransfer),r};workerloader={workers:(e,t,r,n)=>{let i=e;if(!e.parentRoute&&t?.callback&&t?.worker&&(e.parentRoute=t?.callback),i?.worker||i?.workerId||i?.workerUrl){let s=this.loadWorkerRoute(i,i.__node.tag);s&&(!i.parentRoute&&i.__parent?.callback&&(i.parentRoute=i.__parent.callback),i.__parent&&!i.portId&&(typeof i.__parent=="string"?i.__node.tag!==i.__parent&&s._id!==i.__parent&&(i.portId=this.establishMessageChannel(s,i.__parent)):i.__node.tag!==i.__parent?.__node?.tag&&s._id!==i.__parent?.tag&&(i.portId=this.establishMessageChannel(s,i.__parent.worker))),i.parentRoute?(i.stopped||(typeof i.__parent=="string"&&i.__parent===s._id?s.run("subscribe",[i.parentRoute,void 0,void 0,i.callback]):i.__node.tag===i.__parent?.__node?.tag||s._id===i.__parent?.__node?.tag?s.run("subscribe",[i.parentRoute,void 0,void 0,i.callback]):s.run("subscribeToWorker",[i.parentRoute,i.portId,void 0,i.callback,void 0,void 0,i.blocking]).then(a=>{s.workerSubs[i.parentRoute+i.portId].sub=a})),!(typeof i.__parent=="string"&&i.__parent===s._id)&&!(i.__node.tag===i.__parent?.__node?.tag||s._id===i.__parent?.__node?.tag)&&(s.workerSubs[i.parentRoute+i.portId]={sub:null,route:i.parentRoute,portId:i.portId,callback:i.callback,blocking:i.blocking})):i.__parent&&(typeof i.__parent=="string"?(i.stopped||(i.__parent===s._id?s.run("subscribe",[i.__parent,void 0,i.callback]):s.run("subscribeToWorker",[i.__parent,i.portId,void 0,i.callback,void 0,void 0,i.blocking]).then(a=>{s.workerSubs[i.__parent+i.portId].sub=a})),typeof i.__parent=="string"&&i.__parent===s._id||(s.workerSubs[i.__parent+i.portId]={sub:null,route:s._id,portId:i.portId,callback:i.callback,blocking:i.blocking})):i.__parent?.__node?.tag&&i.__parent?.worker&&(i.stopped||(i.__node.tag===i.__parent.__node.tag||s._id===i.__parent.__node.tag?s.run("subscribe",[i.__parent.__node.tag,void 0,void 0,i.callback]):s.run("subscribeToWorker",[i.__parent.__node.tag,i.portId,void 0,i.callback,void 0,void 0,i.blocking]).then(a=>{s.workerSubs[i.__parent.__node.tag+i.portId].sub=a})),i.__node.tag===i.__parent?.__node?.tag||s._id===i.__parent?.__node?.tag||(s.workerSubs[i.__parent.__node.tag+i.portId]={sub:null,route:i.__parent.__node.tag,portId:i.portId,callback:i.callback,blocking:i.blocking}))))}else i.__parent&&i.parentRoute&&(typeof i.__parent=="string"&&n[i.__parent]?.worker?n[i.__parent].worker.subscribe(i.parentRoute,i.__operator,void 0,void 0,void 0,i.blocking):i.__parent?.worker&&i.__parent.worker.subscribe(i.parentRoute,i.__operator,void 0,void 0,void 0,i.blocking));return i}};addDefaultMessageListener=()=>{globalThis.onmessage=e=>{let t=this.receive(e.data);this.__node.keepState&&this.setState({[this.name]:t})}};postMessage=(e,t,r)=>{this.workers[t]?this.workers[t].send(e,r):globalThis.postMessage(e,t,r)};addWorker=e=>{let t;if(e._id||(e._id=`worker${Math.floor(Math.random()*1e15)}`),e.url?t=new vf.default(e.url):e.port?t=e.port:this.workers[e._id]&&(this.workers[e._id].port?t=this.workers[e._id].port:t=this.workers[e._id].worker),!t)return;let r=(d,p)=>this.transmit(d,t,p),n=(d,p,_,w)=>{let k={route:d,args:p};return _&&(k.method=_),this.transmit(k,t,w)},i=(d,p,_,w)=>new Promise((k,S)=>{let O=Math.random(),A={route:"runRequest",args:[{route:d,args:p},e._id,O]};_&&(A.args[0].method=_);let C=I=>{typeof I.data=="object"&&I.data.callbackId===O&&(t.removeEventListener("message",C),k(I.data.args))};t.addEventListener("message",C),this.transmit(A,t,w)}),s=(d,p,_)=>new Promise((w,k)=>{let S=Math.random(),O={route:"runRequest",args:[d,e._id,S]};p&&(O.method=p);let A=C=>{typeof C.data=="object"&&C.data.callbackId===S&&(t.removeEventListener("message",A),w(C.data.args))};t.addEventListener("message",A),this.transmit(O,t,_)}),a={},o=(d,p,_,w,k,S)=>this.subscribeToWorker(d,e._id,p,_,w,k,S),l=(d,p)=>i("unsubscribe",[d,p]),c=async(d,p,_,w)=>{if(d)await i("subscribeToWorker",[d,p,void 0,_,w]).then(k=>{k&&(a[d+p]={sub:k,route:d,portId:p,callback:_,blocking:w})});else for(let k in a)typeof a[k].sub!="number"&&await i("subscribeToWorker",[a[k].route,a[k].portId,void 0,a[k].callback,void 0,a[k].blocking]).then(S=>{a[k].sub=S}),console.log(JSON.stringify(a));return!0},f=async(d,p)=>{if(d&&p&&a[d+p])await i("unsubscribe",[d,a[d+p].sub]),a[d+p].sub=!1;else for(let _ in a)typeof a[_].sub=="number"&&await i("unpipeWorkers",[a[_].route,a[_].portId,a[_].sub]).then(console.log),a[_].sub=!1;return!0},u=()=>{for(let d in a)typeof a[d].sub=="number"&&i("unpipeWorkers",[a[d].route,a[d].portId,a[d].sub]),a[d].sub=!1;return this.terminate(e._id)};return e.onmessage||(e.onmessage=d=>{this.receive(d.data),this.setState({[e._id]:d.data})}),e.onerror||(e.onerror=d=>{console.error(d.data)}),t.onmessage=e.onmessage,t.onerror=e.onerror,this.workers[e._id]={worker:t,send:r,post:n,run:i,request:s,subscribe:o,unsubscribe:l,terminate:u,start:c,stop:f,postMessage:t.postMessage,workerSubs:a,graph:this,...e},this.workers[e._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=e=>{let t=new Blob([e],{type:"text/javascript"});return URL.createObjectURL(t)};getTransferable(e){let t;if(typeof e=="object")if(e.args)if(e.args?.constructor?.name==="Object")for(let r in e.args)ArrayBuffer.isView(e.args[r])?t?t.push(e.args[r].buffer):t=[e.args[r].buffer]:e.args[r]?.constructor?.name==="ArrayBuffer"&&(t?t.push(e.args[r]):t=[e.args[r]]);else Array.isArray(e.args)&&e.args.length<11?e.args.forEach(r=>{ArrayBuffer.isView(r)?t=[r.buffer]:r?.constructor?.name==="ArrayBuffer"&&(t=[r])}):ArrayBuffer.isView(e.args)?t=[e.args.buffer]:e.args?.constructor?.name==="ArrayBuffer"&&(t=[e]);else if(e?.constructor?.name==="Object")for(let r in e)ArrayBuffer.isView(e[r])?t?t.push(e[r].buffer):t=[e[r].buffer]:e[r]?.constructor?.name==="ArrayBuffer"&&(t?t.push(e[r]):t=[e[r]]);else Array.isArray(e)&&e.length<11?e.forEach(r=>{ArrayBuffer.isView(r)?t=[r.buffer]:r.constructor?.name==="ArrayBuffer"&&(t=[r])}):ArrayBuffer.isView(e)?t=[e.buffer]:e.constructor?.name==="ArrayBuffer"&&(t=[e]);return t}transmit=(e,t,r)=>{if(r||(r=this.getTransferable(e)),t instanceof vf.default||t instanceof MessagePort)t.postMessage(e,r);else if(typeof t=="string")this.workers[t]&&(this.workers[t].port?this.workers[t].port.postMessage(e,r):this.workers[t].worker&&this.workers[t].worker.postMessage(e,r));else{let n=Object.keys(this.workers);this.workers[n[this.threadRot]].worker.postMessage(e,r),this.threadRot++,this.threadRot===n.length&&(this.threadRot=0)}return e};terminate=e=>{let t;if(typeof e=="string"){let r=this.workers[e];r&&(delete this.workers[e],e=r.worker,r.onclose&&(t=r.onclose))}else typeof e=="object"&&e?._id&&(e=e.worker,delete this.workers[e?._id]);return e instanceof vf.default?(e.terminate(),t&&t(e),!0):e instanceof MessagePort?(e.close(),t&&t(e),!0):!1};establishMessageChannel=(e,t)=>{let r;if(typeof e=="string"?(r=e,this.workers[e]&&(this.workers[e].port?e=this.workers[e].port:t=this.workers[e].worker)):e?.worker&&(e=e.worker),typeof t=="string"?this.workers[t]&&(this.workers[t].port?t=this.workers[t].port:t=this.workers[t].worker):t?.worker&&(t=t.worker),e instanceof vf.default||e instanceof MessagePort){let n=new MessageChannel,i=`port${Math.floor(Math.random()*1e15)}`;return e.postMessage({route:"addWorker",args:{port:n.port1,_id:i}},[n.port1]),t instanceof vf.default||t instanceof MessagePort?t.postMessage({route:"addWorker",args:{port:n.port2,_id:i}},[n.port2]):r&&this.workers[r]&&(n.port2.onmessage=this.workers[r].onmessage,this.workers[r].port=n.port2),i}return!1};request=(e,t,r,n)=>{let i=this.workers[t].worker;return new Promise((s,a)=>{let o=Math.random(),l={route:"runRequest",args:[e,o]};n&&(l.method=n);let c=f=>{typeof f.data=="object"&&f.data.callbackId===o&&(i.removeEventListener("message",c),s(f.data.args))};i.addEventListener("message",c),this.transmit(l,i,r)})};runRequest=(e,t,r)=>{let n=this.receive(e);return typeof t=="string"&&this.workers[t]&&(this.workers[t].port?t=this.workers[t].port:t=this.workers[t].worker),n instanceof Promise?n.then(i=>{t instanceof vf.default||t instanceof MessagePort?t.postMessage({args:i,callbackId:r}):typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&globalThis.postMessage({args:i,callbackId:r})}):t instanceof vf.default||t instanceof MessagePort?t.postMessage({args:n,callbackId:r}):typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&globalThis.postMessage({args:n,callbackId:r}),n};subscribeWorker=(e,t,r,n,i,s)=>{let a;if(s){let o=!1;a=l=>{o||(o=!0,l instanceof Promise?l.then(c=>{t?.run&&t.run("triggerSubscription",[e,t._id,c]).then(f=>{o=!1})}):t?.run&&t.run("triggerSubscription",[e,t._id,l]).then(c=>{o=!1}))}}else a=o=>{o instanceof Promise?o.then(l=>{t?.postMessage?t.postMessage({args:l,callbackId:e}):globalThis.postMessage&&globalThis.postMessage({args:l,callbackId:e})}):t?.postMessage?t.postMessage({args:o,callbackId:e}):globalThis.postMessage&&globalThis.postMessage({args:o,callbackId:e})};return!s&&t?.port?t=t.port:!s&&t?.worker?t=t.worker:typeof t=="string"&&this.workers[t]&&(s?t=this.workers[t]:this.workers[t].port?t=this.workers[t].port:t=this.workers[t].worker),this.subscribe(e,a,r,n,i)};subscribeToWorker=(e,t,r,n,i,s,a)=>{if(typeof t=="string"&&this.workers[t])return this.__node.state.subscribeEvent(t,o=>{o?.callbackId===e&&(r?typeof r=="string"?this.run(r,o.args):r(o.args):this.setState({[t]:o.args}))}),this.workers[t].run("subscribeWorker",[e,t,n,i,s,a])};triggerSubscription=async(e,t,r)=>{if(this.__node.state.triggers[t])for(let n=0;n<this.__node.state.triggers[t].length;n++)await this.__node.state.triggers[t][n].onchange({args:r,callbackId:e});return!0};pipeWorkers=(e,t,r,n,i,s,a,o,l)=>(typeof e=="string"&&(e=this.workers[e]),typeof t=="string"&&(t=this.workers[t]),i||(i=this.establishMessageChannel(e.worker,t.worker)),t.run("subscribeToWorker",[r,i,n,s,a,o,l]));unpipeWorkers=(e,t,r)=>{if(typeof t=="string"&&(t=this.workers[t]),typeof t=="object")return t.run("unsubscribe",[e,r])}},ll=YP(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]),pIe=YP(["deltaX","deltaY"]),hIe=YP(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function PX(e,t){let r={type:e.type};r.isTrusted=e.isTrusted,r.bubbles=e.bubbles,r.cancelBubble=e.cancelBubble,r.cancelable=e.cancelable,r.composed=e.composed,r.defaultPrevent=e.defaultPrevented,r.eventPhase=e.eventPhase,r.returnValue=e.returnValue,r.currentTarget=e.currentTarget.id?e.currentTarget.id:e.currentTarget.constructor.name,r.target=r.currentTarget,r.srcElement=r.currentTarget,t(r)}function gIe(e,t,r){r&&e.preventDefault&&e.preventDefault(),pIe(e,t)}function yIe(e,t,r){r&&e.preventDefault&&e.preventDefault()}function mIe(e,t,r){for(let n of t)r[n]=e[n]}function YP(e){return function(r,n){let i={type:r.type};mIe(r,e,i),n(i)}}function IP(e,t,r){r&&e.preventDefault&&e.preventDefault();let n=[],i={type:e.type,touches:n};for(let s=0;s<e.touches.length;++s){let a=e.touches[s];n.push({pageX:a.pageX,pageY:a.pageY})}t(i)}var NP=1,JX={};for(;NP<222;)JX[NP]=!0,NP++;function LX(e,t,r){let{keyCode:n}=e;JX[n]&&(r&&e.preventDefault&&(n<110||n>123)&&e.preventDefault(),hIe(e,t))}var zb={contextmenu:yIe,mousedown:ll,mousemove:ll,mouseup:ll,pointerdown:ll,pointermove:ll,pointerup:ll,pointerlockchange:ll,webkitpointerlockchange:ll,focus:PX,blur:PX,pointerout:ll,touchstart:IP,touchmove:IP,touchend:IP,wheel:gIe,keydown:LX,keyup:LX};function XP(e,t,r,n){r||(r="proxy"+Math.floor(Math.random()*1e15));let i=o=>{t?t.postMessage({route:"handleProxyEvent",args:[o,r]}):GX(o,r)},s=Object.entries(zb);for(let[o,l]of s)e.addEventListener(o,function(c){l(c,i,n)});zb.keydown&&globalThis.addEventListener("keydown",function(o){zb.keydown(o,i,n)}),zb.keyup&&globalThis.addEventListener("keyup",function(o){zb.keyup(o,i,n)});let a=()=>{let o=e.getBoundingClientRect();i({type:"resize",left:o.left,top:o.top,width:e.clientWidth,height:e.clientHeight})};return a(),globalThis.addEventListener("resize",a),r}var bIe=class{__listeners;addEventListener(e,t){this.__listeners===void 0&&(this.__listeners={});let r=this.__listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this.__listeners===void 0)return!1;let r=this.__listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this.__listeners===void 0)return;let n=this.__listeners[e];if(n!==void 0){let i=n.indexOf(t);i!==-1&&n.splice(i,1)}}dispatchEvent(e,t){if(this.__listeners===void 0)return;let n=this.__listeners[e.type];if(n!==void 0){t?e.target=t:e.target=this;let i=n.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e)}}};function FX(){}var vIe=class extends bIe{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super(),this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>({left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height});handleEvent=e=>{e.type==="resize"&&(this.left=e.left,this.top=e.top,this.width=e.width,this.height=e.height,typeof this.proxied=="object"&&(this.proxied.style.width=this.width+"px",this.proxied.style.height=this.height+"px",this.proxied.clientWidth=this.width,this.proxied.clientHeight=this.height)),e.preventDefault=FX,e.stopPropagation=FX,this.dispatchEvent(e,this.proxied)};focus(){}blur(){}},RS=class{targets={};constructor(){globalThis.document||(globalThis.document={elementFromPoint:(...e)=>this.targets[Object.keys(this.targets)[0]].proxied})}makeProxy=(e,t=void 0)=>{e||(e=`proxyReceiver${Math.floor(Math.random()*1e15)}`);let r;this.targets[e]?r=this.targets[e]:(r=new vIe,this.targets[e]=r),typeof t=="object"&&(t.proxy=r,r.proxied=t,typeof WorkerGlobalScope<"u"&&(t.style=r.style),r.width&&(t.style.width=r.width+"px",t.clientWidth=r.width),r.height&&(t.style.height=r.height+"px",t.clientHeight=r.height),t.setPointerCapture=r.setPointerCapture.bind(r),t.releasePointerCapture=r.releasePointerCapture.bind(r),t.getBoundingClientRect=r.getBoundingClientRect.bind(r),t.addEventListener=r.addEventListener.bind(r),t.removeEventListener=r.removeEventListener.bind(r),t.handleEvent=r.handleEvent.bind(r),t.dispatchEvent=r.dispatchEvent.bind(r),t.focus=r.focus.bind(r),t.blur=r.blur.bind(r))};getProxy=e=>this.targets[e];handleEvent=(e,t)=>{if(this.targets[t]||this.makeProxy(t),this.targets[t])return this.targets[t].handleEvent(e),!0}};function _Ie(e,t){return this?.__node?.graph?(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new RS),this.__node.graph.ProxyManager.makeProxy(e,t)):(globalThis.ProxyManager||(globalThis.ProxyManager=new RS),globalThis.ProxyManager.makeProxy(e,t)),e}function GX(e,t){if(this?.__node?.graph){if(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new RS),this.__node.graph.ProxyManager.handleEvent(e,t))return e}else if(globalThis.ProxyManager||(globalThis.ProxyManager=new RS),globalThis.ProxyManager.handleEvent(e,t))return e}var ZP={initProxyElement:XP,makeProxy:_Ie,handleProxyEvent:GX};function wIe(e){if(e.worker){let t=e.worker,r=e.route;return(t instanceof Blob||typeof t=="string")&&(t=new Worker(t)),delete e.worker,delete e.route,KX(t,e,r)}else return XP(e.canvas,void 0,e._id,e.preventDefault),YX(e)}function KX(e,t,r){if(!t)return;t._id||(t._id=`canvas${Math.floor(Math.random()*1e15)}`);let n=t.canvas.transferControlToOffscreen();t.width||(t.width=t.canvas.clientWidth),t.height||(t.height=t.canvas.clientHeight);let i={route:r||"setupCanvas",args:{...t,canvas:n}};this?.__node?.graph?this.__node.graph.run("initProxyElement",t.canvas,e,t._id,t.preventDefault):XP(t.canvas,e,t._id,t.preventDefault),t.draw&&(typeof t.draw=="function"?i.args.draw=t.draw.toString():i.args.draw=t.draw),t.update&&(typeof t.update=="function"?i.args.update=t.update.toString():i.args.update=t.update),t.init&&(typeof t.init=="function"?i.args.init=t.init.toString():i.args.init=t.init),t.clear&&(typeof t.clear=="function"?i.args.clear=t.clear.toString():i.args.clear=t.clear);let s=[n];return t.transfer&&(s.push(...t.transfer),delete t.transfer),e.postMessage(i,s),{_id:t._id,width:t.width,height:t.height,worker:e,draw:(o,l)=>{e.postMessage({route:"drawFrame",args:[o,t._id]},l)},update:(o,l)=>{e.postMessage({route:"updateCanvas",args:[o,t._id]},l)},clear:()=>{e.postMessage({route:"clearCanvas",args:t._id})},init:()=>{e.postMessage({route:"initCanvas",args:t._id})},stop:()=>{e.postMessage({route:"stopAnim",args:t._id})},start:()=>{e.postMessage({route:"startAnim",args:t._id})},set:(o,l)=>{e.postMessage({route:"setDraw",args:[o,t._id]},l)},terminate:()=>{e.terminate()}}}function DS(e,t){let r;if(this?.__node?.graph?t?r=this.__node.graph.CANVASES?.[e._id]:e._id?r=this.__node.graph.CANVASES?.[e._id]:r=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:t||e._id?r=globalThis.CANVASES?.[e._id]:r=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],r)return e.canvas&&(r.canvas=e.canvas,this?.__node?.graph?this.__node.graph.run("makeProxy",r._id,r.canvas):ZP.makeProxy(r._id,r.canvas)),typeof e.context=="string"?r.context=r.canvas.getContext(e.context):e.context&&(r.context=e.context),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),typeof e.draw=="string"&&(e.draw=cl(e.draw)),typeof e.draw=="function"&&(r.draw=e.draw.bind(e)),typeof e.update=="string"&&(e.update=cl(e.update)),typeof e.update=="function"&&(r.update=e.update.bind(e)),typeof e.init=="string"&&(e.init=cl(e.init)),typeof e.init=="function"&&(r.init=e.init.bind(e)),typeof e.clear=="string"&&(e.clear=cl(e.clear)),typeof e.clear=="function"&&(r.clear=e.clear.bind(e)),e._id}function YX(e){this?.__node?.graph?this.__node.graph.CANVASES||(this.__node.graph.CANVASES={}):globalThis.CANVASES||(globalThis.CANVASES={});let t=e;if(e._id?t._id=e._id:t._id=`canvas${Math.floor(Math.random()*1e15)}`,typeof e.context=="string"?t.context=e.canvas.getContext(e.context):t.context=e.context,"animating"in e?t.animating=e.animating:t.animating=!0,this?.__node?.graph?.CANVASES[t._id])this.__node.graph.run("setDraw",t);else if(globalThis.CANVASES?.[t._id])DS(t);else if(this?.__node?.graph&&(t.graph=this.__node.graph,t.__node||(t.__node={}),t.__node.tag||(t.__node.tag=t._id),t=this.__node.graph.add(t),t.__addOndisconnected=()=>{t.stop(),delete this.__node.graph.CANVASES[t._id]}),this?.__node?.graph?this.__node.graph.CANVASES[t._id]=t:globalThis.CANVASES[t._id]=t,this?.__node?.graph?this.__node.graph.run("makeProxy",t._id,t.canvas):ZP.makeProxy(t._id,t.canvas),e.width&&(t.canvas.width=e.width),e.height&&(t.canvas.height=e.height),typeof t.draw=="string"?t.draw=cl(t.draw):typeof t.draw=="function"&&(t.draw=t.draw.bind(t)),typeof t.update=="string"?t.update=cl(t.update):typeof t.update=="function"&&(t.update=t.update.bind(t)),typeof t.init=="string"?t.init=cl(t.init):typeof t.init=="function"&&(t.init=t.init.bind(t)),typeof t.clear=="string"?t.clear=cl(t.clear):typeof t.clear=="function"&&(t.clear=t.clear.bind(t)),typeof t.init=="function"&&t.init(t,t.canvas,t.context),t.stop=()=>{jS(t._id)},t.start=r=>{UP(t._id,r)},t.set=r=>{DS(r,t._id)},typeof t.draw=="function"&&t.animating){let r=(n,i,s)=>{n.animating&&(n.draw(n,i,s),requestAnimationFrame(()=>{r(n,i,s)}))};r(t,t.canvas,t.context)}return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?t._id:{_id:e._id,width:e.width,height:e.height,draw:n=>{XX(n,e._id)},update:n=>{eZ(n,e._id)},clear:()=>{ZX(e._id)},init:()=>{QX(e._id)},stop:()=>{jS(e._id)},start:()=>{UP(e._id)},set:n=>{DS(n,e._id)},terminate:()=>{this.__node?.graph?this.__node.graph.remove(e._id):(jS(e._id),this?.__node?.graph?delete this.__node.graph.CANVASES[t._id]:delete globalThis.CANVASES[t._id])}}}function XX(e,t){let r=Oc.call(this,t);if(r&&(e&&Object.assign(r,e),r.draw))return r.draw(r,r.canvas,r.context),t}function ZX(e){let t=Oc.call(this,e);if(t?.clear)return t.clear(t,t.canvas,t.context),e}function QX(e){let t=Oc.call(this,e);if(t?.init)return t.init(t,t.canvas,t.context),e}function eZ(e,t){let r=Oc.call(this,t);if(r?.update)return r.update(r,r.canvas,r.context,e),t}function SIe(e,t){let r=Oc.call(this,t);if(r)return Object.assign(r,e),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),t}function UP(e,t){let r=Oc.call(this,e);if(r.animating=!0,r&&t)return typeof t=="string"&&(t=cl(t)),typeof t=="function"&&(r.draw=t),e;if(typeof r?.draw=="function"){let n=(i,s,a)=>{i.animating&&(i.draw(i,s,a),requestAnimationFrame(()=>{n(i,s,a)}))};return typeof r.clear=="function"&&r.clear(r,r.canvas,r.context),typeof r.init=="function"&&r.init(r,r.canvas,r.context),n(r,r.canvas,r.context),e}}function jS(e){let t=Oc.call(this,e);if(t)return t.animating=!1,typeof t.clear=="function"&&requestAnimationFrame(t.clear(t,t.canvas,t.context)),e}function Oc(e){let t;return this?.__node?.graph?e?t=this.__node.graph.CANVASES?.[e]:t=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:e?t=globalThis.CANVASES?.[e]:t=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],t}var xIe={...ZP,Renderer:wIe,transferCanvas:KX,setupCanvas:YX,setDraw:DS,drawFrame:XX,clearCanvas:ZX,initCanvas:QX,updateCanvas:eZ,setProps:SIe,startAnim:UP,stopAnim:jS,getCanvas:Oc};function cl(e=""){let t=a=>a.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),n=(a=>{let o=a.indexOf("=>")+1;return o<=0&&(o=a.indexOf("){")),o<=0&&(o=a.indexOf(") {")),a.slice(0,a.indexOf("{",o)+1)})(e),i=t(e),s;if(n.includes("function")){let a=n.split("(")[1].split(")")[0];s=new Function(a,i)}else if(n.substring(0,6)===i.substring(0,6)){let a=n.split("(")[1].split(")")[0];s=new Function(a,i.substring(i.indexOf("{")+1,i.length-1))}else try{s=(0,eval)(n+i+"}")}catch{}return s}var kIe=`(()=>{var __require=(x=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(x,{get:(a,b)=>(typeof require!=="undefined"?require:a)[b]}):x)(function(x){if(typeof require!=="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+x+'" is not supported')});var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __require2=(x=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x)(function(x){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error('Dynamic require of "'+x+'" is not supported')});var __commonJS=(cb,mod)=>function __require22(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:true}):target,mod));var __publicField=(obj,key,value)=>{__defNormalProp(obj,typeof key!=="symbol"?key+"":key,value);return value};var require_browser=__commonJS({"node_modules/web-worker/cjs/browser.js"(exports,module2){module2.exports=Worker}});var EventHandler=class{data={};triggers={};ctr=0;constructor(data){if(typeof data==="object")this.data=data}setState=updateObj=>{Object.assign(this.data,updateObj);let props=Object.getOwnPropertyNames(updateObj);for(const prop of props){this.triggerEvent(prop,this.data[prop])}if(this.triggers[statesubKey]){let run=fn=>{fn(updateObj)};const l=this.triggers[statesubKey].length;for(let i2=l-1;i2>=0;i2--){run(this.triggers[statesubKey][i2].onchange)}}return this.data};setValue=(key,value)=>{this.data[key]=value;this.triggerEvent(key,value)};triggerEvent=(key,value)=>{if(this.triggers[key]){let fn=obj=>{obj.onchange(value)};const l=this.triggers[key].length;for(let i2=l-1;i2>=0;i2--){fn(this.triggers[key][i2])}}};subscribeState=onchange=>{return this.subscribeEvent(statesubKey,onchange)};unsubscribeState=sub=>{return this.unsubscribeEvent(statesubKey,sub)};subscribeEvent=(key,onchange,refObject,refKey)=>{if(key){if(refObject&&refKey&&!this.triggers[key]){Object.defineProperty(this.data,key,{get:()=>{return refObject[refKey]},set:value=>{refObject[refKey]=value},enumerable:true,configurable:true})}if(!this.triggers[key]){this.triggers[key]=[]}let l=this.ctr;this.ctr++;this.triggers[key].push({sub:l,onchange});return l}else return void 0};unsubscribeEvent=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(sub===void 0){delete this.triggers[key];delete this.data[key]}else{let idx=void 0;let obj=triggers.find((o,i2)=>{if(o.sub===sub){idx=i2;return true}});if(obj)triggers.splice(idx,1);if(Object.keys(triggers).length===0){delete this.triggers[key];delete this.data[key]}if(this.onRemoved)this.onRemoved(obj);return true}}};subscribeEventOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeEvent(key,sub)};sub=this.subscribeEvent(key,changed);return sub};getEvent=(key,sub)=>{for(const s in this.triggers[key]){if(this.triggers[key][s].sub===sub)return this.triggers[key][s]}};getSnapshot=()=>{const snapshot={};for(const key in this.data){snapshot[key]=this.data[key]}};onRemoved};var statesubKey="*s";var state=new EventHandler;var GraphNode=class{__node={tag:\`node\${Math.floor(Math.random()*1e15)}\`,unique:\`\${Math.floor(Math.random()*1e15)}\`,state};__children;__parent;__operator;__listeners;__props;__args;constructor(properties,parent,graph){this.__setProperties(properties,parent,graph)}__setProperties=(properties,parent,graph)=>{let enforceProperties=()=>{let orig=properties;if(typeof properties==="function"){if(isNativeClass(properties)){properties=new properties}else properties={__operator:properties,__node:{forward:true,tag:properties.name}}}else if(typeof properties==="string"){if(graph?.get(properties)){properties=graph.get(properties)}}if(!("__node"in properties))properties.__node={};if(!properties.__node.initial)properties.__node.initial=orig};enforceProperties();if(typeof properties==="object"){let assignState=()=>{if(properties.__node?.state)this.__node.state=properties.__node.state;else if(graph){properties.__node.state=graph.__node.state}};let setProps2=()=>{if(properties.__props){if(typeof properties.__props==="function")properties.__props=new properties.__props;if(typeof properties.__props==="object"){this.__proxyObject(properties.__props)}}};let setTag=()=>{if(!properties.__node.tag){if(properties.__operator?.name)properties.__node.tag=properties.__operator.name;else properties.__node.tag=\`node\${Math.floor(Math.random()*1e15)}\`}};let setNode=()=>{if(typeof properties.__node==="string"){if(graph?.get(properties.__node.tag)){properties=graph.get(properties.__node.tag)}else properties.__node={}}else if(!properties.__node)properties.__node={};if(graph){properties.__node.graph=graph}if(properties instanceof Graph)properties.__node.source=properties};let setParent=()=>{if(!properties.__parent&&parent)properties.__parent=parent;if(parent?.__node&&!(parent instanceof Graph||properties instanceof Graph))properties.__node.tag=parent.__node.tag+"."+properties.__node.tag;if(parent instanceof Graph&&properties instanceof Graph){if(properties.__node.loaders)Object.assign(parent.__node.loaders?parent.__node.loaders:{},properties.__node.loaders);if(parent.__node.mapGraphs){properties.__node.nodes.forEach(n=>{parent.set(properties.__node.tag+"."+n.__node.tag,n)});let ondelete=()=>{properties.__node.nodes.forEach(n=>{parent.__node.nodes.delete(properties.__node.tag+"."+n.__node.tag)})};this.__addOndisconnected(ondelete)}}};let setOp=()=>{if(typeof properties.default==="function"&&!properties.__operator){properties.__operator=properties.default}if(properties.__operator){if(typeof properties.__operator==="string"){if(graph){let n=graph.get(properties.__operator);if(n)properties.__operator=n.__operator;if(!properties.__node.tag&&properties.__operator.name)properties.__node.tag=properties.__operator.name}}if(typeof properties.__operator==="function")properties.__operator=this.__setOperator(properties.__operator);if(properties.default)properties.default=properties.__operator}};let assignProps=()=>{properties.__node=Object.assign(this.__node,properties.__node);let keys2=Object.getOwnPropertyNames(properties).filter(v=>{if(!objProps[v])return true});for(const key of keys2){if(key in properties)this[key]=properties[key]}};let bindCallbacks=()=>{if(this.__onconnected){if(typeof this.__onconnected==="function"){this.__onconnected=this.__onconnected.bind(this)}else if(Array.isArray(this.__onconnected)){this.__onconnected=this.__onconnected.map(f=>{return f.bind(this)})}if(typeof this.__ondisconnected==="function"){this.__ondisconnected=this.__ondisconnected.bind(this)}else if(Array.isArray(this.__ondisconnected)){this.__ondisconnected=this.__ondisconnected.map(f=>{return f.bind(this)})}}};assignState();setTag();setProps2();setNode();setParent();assignProps();bindCallbacks();setOp()}};__subscribe=(callback,key,subInput,target,tkey,args)=>{const subscribeToFunction=(k,setTarget=(callback2,target2)=>target2?target2:callback2,triggerCallback=callback)=>{let wrappedArgs;if(args){let wrapped=wrapArgs(triggerCallback,args,this.__node.graph);triggerCallback=wrapped.__callback;wrappedArgs=wrapped.__args}let sub=this.__node.state.subscribeEvent(k,triggerCallback,this,key);let trigger=this.__node.state.getEvent(k,sub);if(!this.__listeners)this.__listeners={};this.__listeners[k]=this.__node.state.triggers[k];if(!trigger)return sub;trigger.source=this.__node.tag;if(key)trigger.key=key;trigger.target=setTarget(callback,target);if(subInput)trigger.subInput=subInput;if(args){trigger.arguments=args;trigger.__args=wrappedArgs}if(tkey)trigger.tkey=tkey;trigger.node=this;trigger.graph=this.__node.graph;return sub};const subscribeToGraph=callback2=>{let fn=this.__node.graph.get(callback2);if(!fn&&callback2.includes(".")){target=callback2.substring(0,callback2.lastIndexOf("."));let n=this.__node.graph.get(callback2.substring(0,target));tkey=callback2.lastIndexOf(".")+1;if(n&&typeof n[key]==="function")callback2=(...args2)=>{return n[tkey](...args2)}}else if(fn.__operator){callback2=fn.__operator;tkey="__operator"}};if(key){if(!this.__node.localState||!this.__node.localState[key]){this.__addLocalState(this,key)}if(typeof callback==="string"){tkey=callback;if(target){if(this.__node.graph?.get(target)){let n=this.__node.graph?.get(target);if(typeof n[callback]==="function"){let fn=n[callback];callback=(...inp)=>{fn(...inp)}}else{let k2=callback;let setter=inp=>{n[k2]=inp};callback=setter}}}else if(typeof this[callback]==="function"){let fn=this[callback];callback=(...inp)=>{fn(...inp)}}else if(this.__node.graph?.get(callback))subscribeToGraph(callback);if(typeof callback!=="function")return void 0}let sub;let k=subInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node)sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)});return sub}else{if(typeof callback==="string"){if(this.__node.graph.get(callback))callback=this.__node.graph.get(callback);tkey="__operator";if(typeof callback!=="object")return void 0}let sub;let k=subInput?this.__node.unique+"input":this.__node.unique;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node){sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)})}return sub}};__unsubscribe=(sub,key,unsubInput)=>{if(key){return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key,sub)}else return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"input":this.__node.unique,sub)};__setOperator=fn=>{fn=fn.bind(this);if(this.__args&&this.__node.graph){fn=wrapArgs(fn,this.__args,this.__node.graph).__callback}let inpstr=\`\${this.__node.unique}input\`;this.__operator=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[this.__node.unique]){if(typeof result?.then==="function"){result.then(res=>{if(res!==void 0)this.__node.state.setValue(this.__node.unique,res)}).catch(console.error)}else if(result!==void 0)this.__node.state.setValue(this.__node.unique,result)}return result};if(this.__parent instanceof GraphNode&&!this.__subscribedToParent){if(this.__parent.__operator){let sub=this.__parent.__subscribe(this);let ondelete=()=>{this.__parent?.__unsubscribe(sub);delete this.__subscribedToParent};this.__addOndisconnected(ondelete);this.__subscribedToParent=true}}return this.__operator};__addLocalState=(props,key)=>{if(!props)return;if(!this.__node.localState){this.__node.localState={}}const localState=this.__node.localState;const initState=(props2,k)=>{let str2=this.__node.unique+"."+k;let inpstr=\`\${str2}input\`;let get,set;let obj,descriptor;if(typeof props2[k]==="function"&&k!=="__operator"){if(this.__props?.[k]){obj=this.__props}else{obj=localState}get=()=>{return obj[k]};set=fn=>{if(!this.__props?.[k])fn=fn.bind(this);obj[k]=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[str2]){if(typeof result?.then==="function"){result.then(res=>{this.__node.state.triggerEvent(str2,res)}).catch(console.error)}else this.__node.state.triggerEvent(str2,result)}return result}};localState[k]=props2[k].bind(this);descriptor={get,set,enumerable:true,configurable:true}}else{let get2,set2;let obj2;if(this.__props?.[k]){obj2=this.__props}else{obj2=localState}get2=()=>{return obj2[k]};set2=v=>{obj2[k]=v;if(this.__node.state.triggers[str2])this.__node.state.triggerEvent(str2,v)};localState[k]=props2[k];descriptor={get:get2,set:set2,enumerable:true,configurable:true}}Object.defineProperty(props2,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}};if(key)initState(props,key);else{for(let k in props){initState(props,k)}}};__proxyObject=obj=>{const allProps=getAllProperties(obj);for(const k of allProps){const descriptor={get:()=>{return obj[k]},set:value=>{obj[k]=value},enumerable:true,configurable:true};Object.defineProperty(this,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}}};__addOnconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__onconnected)){this.__onconnected.push(callback)}else if(typeof this.__onconnected==="function"){this.__onconnected=[callback,this.__onconnected]}else this.__onconnected=callback}__addOndisconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__ondisconnected)){this.__ondisconnected.push(callback)}else if(typeof this.__ondisconnected==="function"){this.__ondisconnected=[callback,this.__ondisconnected]}else this.__ondisconnected=callback}__callConnected(node=this){if(typeof this.__onconnected==="function"){this.__onconnected(this)}else if(Array.isArray(this.__onconnected)){let fn=o=>{o(this)};this.__onconnected.forEach(fn)}}__callDisconnected(node=this){if(typeof this.__ondisconnected==="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let fn=o=>{o(this)};this.__ondisconnected.forEach(fn)}}};var Graph=class{__node={tag:\`graph\${Math.floor(Math.random()*1e15)}\`,unique:\`\${Math.random()}\`,nodes:new Map,state,roots:{}};constructor(options){this.init(options)}init=options=>{if(options){let cpy=Object.assign({},options);delete cpy.roots;recursivelyAssign(this.__node,cpy);if(options.roots)this.load(options.roots)}};load=roots=>{function recursivelyAssignChildren(target,obj,inChildren=true,top=true){if(top){if(target)Object.assign(target,obj);else target=Object.assign({},obj);recursivelyAssignChildren(target,obj,true,false)}if(obj?.__children&&!inChildren){if(obj.__children?.constructor.name==="Object"){if(target.__children?.constructor.name==="Object")recursivelyAssignChildren(target.__children,obj.__children,true,false);else target.__children=recursivelyAssignChildren({},obj.__children,true,false)}else{target.__children=obj.__children}}else if(inChildren){for(const key in obj){target[key]=Object.assign({},obj[key]);if(obj[key]?.__children){recursivelyAssignChildren({},obj[key].__children,false,false)}}}return target}this.__node.roots=recursivelyAssignChildren(this.__node.roots?this.__node.roots:{},roots);let cpy=Object.assign({},roots);if(cpy.__node)delete cpy.__node;let listeners=this.recursiveSet(cpy,this,void 0,roots);if(roots.__node){if(!roots.__node.tag)roots.__node._tag=\`roots\${Math.floor(Math.random()*1e15)}\`;else if(!this.get(roots.__node.tag)){let node=new GraphNode(roots,this,this);this.set(node.__node.tag,node);this.runLoaders(node,this,roots,roots.__node.tag);if(node.__listeners){listeners[node.__node.tag]=node.__listeners}}}else if(roots.__listeners){this.setListeners(roots.__listeners)}this.setListeners(listeners);return cpy};setLoaders=(loaders2,replace)=>{if(replace)this.__node.loaders=loaders2;else Object.assign(this.__node.loaders,loaders2);return this.__node.loaders};runLoaders=(node,parent,properties,key)=>{for(const l in this.__node.loaders){if(typeof this.__node.loaders[l]==="object"){if(this.__node.loaders[l].init)this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key);if(this.__node.loaders[l].connected)node.__addOnconnected(this.__node.loaders[l].connect);if(this.__node.loaders[l].disconnected)node.__addOndisconnected(this.__node.loaders[l].disconnect)}else if(typeof this.__node.loaders[l]==="function")this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key)}};add=(properties,parent)=>{let listeners={};if(typeof parent==="string")parent=this.get(parent);let instanced;if(typeof properties==="function"){if(isNativeClass(properties)){if(properties.prototype instanceof GraphNode){properties=properties.prototype.constructor(properties,parent,this);instanced=true}else properties=new properties}else properties={__operator:properties}}else if(typeof properties==="string"){properties=this.__node.roots[properties]}if(!properties)return;if(!instanced){let keys2=Object.getOwnPropertyNames(properties);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(properties));keys2.push(...nonArrowFunctions);keys2=keys2.filter(v=>!objProps.includes(v));let cpy={};for(const key of keys2){cpy[key]=properties[key]}properties=cpy}if(!properties.__node)properties.__node={};properties.__node.initial=properties;if(typeof properties==="object"&&!this.get(properties.__node.tag)){let node;let root=recursivelyAssign({},properties,2);if(instanced)node=properties;else node=new GraphNode(properties,parent,this);this.set(node.__node.tag,node);this.runLoaders(node,parent,properties,node.__node.tag);this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key in node.__listeners){let listener=node.__listeners[key];if(node[key]){delete listeners[node.__node.tag][key];listeners[node.__node.tag][node.__node.tag+"."+key]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][key]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][key]=parent.__node.tag}}}}this.setListeners(listeners);node.__callConnected();return node}else if(properties.__node.tag)return this.get(properties.__node.tag)};recursiveSet=(t2,parent,listeners={},origin)=>{let keys2=Object.getOwnPropertyNames(origin);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(origin)).filter(v=>!objProps.includes(v));keys2.push(...nonArrowFunctions);for(const key of keys2){if(key.includes("__"))continue;let p=origin[key];if(Array.isArray(p))continue;let instanced;if(typeof p==="function"){if(isNativeClass(p)){p=new p;if(p instanceof GraphNode){p=p.prototype.constructor(p,parent,this);instanced=true}}else p={__operator:p}}else if(typeof p==="string"){if(this.__node.nodes.get(p))p=this.__node.nodes.get(p);else p=this.__node.roots[p]}else if(typeof p==="boolean"){if(this.__node.nodes.get(key))p=this.__node.nodes.get(key);else p=this.__node.roots[key]}if(p instanceof Object){if(!instanced&&!(p instanceof GraphNode)){let ks=Object.getOwnPropertyNames(p);let nonArrowFunctions2=Object.getOwnPropertyNames(Object.getPrototypeOf(p));nonArrowFunctions2.splice(nonArrowFunctions2.indexOf("constructor"),1);ks.push(...nonArrowFunctions2);let cpy={};for(const key2 of ks){cpy[key2]=p[key2]}p=cpy}if(!p.__node)p.__node={};if(!p.__node.tag)p.__node.tag=key;if(!p.__node.initial)p.__node.initial=t2[key];if(this.get(p.__node.tag)&&!(!(parent instanceof Graph)&&parent?.__node)||parent?.__node&&this.get(parent.__node.tag+"."+p.__node.tag))continue;let node;let newnode=false;let root=recursivelyAssign({},p,2);if(instanced||p instanceof GraphNode){node=p}else{node=new GraphNode(p,parent,this);newnode=true}if(!newnode&&p instanceof GraphNode&&!instanced&&parent instanceof GraphNode){let sub=this.subscribe(parent.__node.tag,node.__node.tag);let ondelete=node2=>{this.unsubscribe(parent.__node.tag,sub)};node.__addOndisconnected(ondelete)}else if(node){this.set(node.__node.tag,node);this.runLoaders(node,parent,t2[key],key);t2[key]=node;this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key2 in node.__listeners){let listener=node.__listeners[key2];let k=key2;if(node[key2]){delete listeners[node.__node.tag][key2];k=node.__node.tag+"."+key2;listeners[node.__node.tag][k]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][k]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][k]=parent.__node.tag}}}}node.__callConnected()}}}return listeners};remove=(node,clearListeners=true)=>{this.unsubscribe(node);if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){this.delete(node.__node.tag);delete this.__node.roots[node.__node.tag];if(clearListeners){this.clearListeners(node)}node.__callDisconnected();const recursiveRemove=t2=>{for(const key in t2){this.unsubscribe(t2[key]);this.delete(t2[key].__node.tag);delete this.__node.roots[t2[key].__node.tag];this.delete(key);delete this.__node.roots[key];t2[key].__node.tag=t2[key].__node.tag.substring(t2[key].__node.tag.lastIndexOf(".")+1);if(clearListeners){this.clearListeners(t2[key])}t2[key].__callDisconnected();if(t2[key].__children){recursiveRemove(t2[key].__children)}}};if(node.__children){recursiveRemove(node.__children)}}if(node?.__node.tag&&node?.__parent){delete node?.__parent;node.__node.tag=node.__node.tag.substring(node.__node.tag.indexOf(".")+1)}if(node?.__node.graph)node.__node.graph=void 0;return node};run=(node,...args)=>{if(typeof node==="string"){let nd=this.get(node);if(!nd&&node.includes(".")){nd=this.get(node.substring(0,node.lastIndexOf(".")));if(typeof nd?.[node.substring(node.lastIndexOf(".")+1)]==="function")return nd[node.substring(node.lastIndexOf(".")+1)](...args)}else if(nd?.__operator)return nd.__operator(...args)}if(node?.__operator){return node?.__operator(...args)}};setListeners=listeners=>{for(const key in listeners){let node=this.get(key);if(typeof listeners[key]==="object"){for(const k in listeners[key]){let n=this.get(k);let sub;if(typeof listeners[key][k]!=="object")listeners[key][k]={__callback:listeners[key][k]};else if(!listeners[key][k].__callback){for(const kk in listeners[key][k]){if(typeof listeners[key][k][kk]!=="object"){listeners[key][k][kk]={__callback:listeners[key][k][kk]};if(node.__operator&&(listeners[key][k][kk].__callback===true||typeof listeners[key][k][kk].__callback==="undefined"))listeners[key][k][kk].__callback=node.__operator}let nn=this.get(kk);if(!nn){let tag=k.substring(0,k.lastIndexOf("."));nn=this.get(tag);if(nn){let prop=k.substring(k.lastIndexOf(".")+1);sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k][kk].__args,prop,listeners[key][k][kk].inputState,key,k)}}else{sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}if("__callback"in listeners[key][k]){if(node){if(listeners[key][k].__callback===true||typeof listeners[key][k].__callback==="undefined")listeners[key][k].__callback=node.__operator;if(typeof listeners[key][k].__callback==="function")listeners[key][k].__callback=listeners[key][k].__callback.bind(node)}if(!n){let tag=k.substring(0,k.lastIndexOf("."));n=this.get(tag);if(n){sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,k.substring(k.lastIndexOf(".")+1),listeners[key][k].inputState,key,k)}}else{sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}}}};clearListeners=(node,listener)=>{if(typeof node==="string")node=this.get(node);if(node?.__listeners){for(const key in node.__listeners){if(listener&&key!==listener)continue;if(typeof node.__listeners[key]?.sub!=="number")continue;let n=this.get(key);if(!n){n=this.get(key.substring(0,key.lastIndexOf(".")));if(n){if(typeof node.__listeners[key]==="object"&&!node.__listeners[key]?.__callback){for(const k in node.__listeners[key]){if(typeof node.__listeners[key][k]?.sub==="number"){this.unsubscribe(n,node.__listeners[key][k].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}else{if(typeof!node.__listeners[key]?.__callback==="number"){for(const k in node.__listeners[key]){if(node.__listeners[key][k]?.sub){this.unsubscribe(n,node.__listeners[key][k].sub,void 0,node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,void 0,node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}}};get=tag=>{return this.__node.nodes.get(tag)};set=(tag,node)=>{return this.__node.nodes.set(tag,node)};delete=tag=>{return this.__node.nodes.delete(tag)};getProps=(node,getInitial)=>{if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){let cpy;if(getInitial)cpy=Object.assign({},this.__node.roots[node.__node.tag]);else{cpy=Object.assign({},node);for(const key in cpy){if(key.includes("__"))delete cpy[key]}}}};subscribe=(nodeEvent,onEvent,args,key,subInput,target,bound,tkey)=>{let nd=nodeEvent;if(typeof nodeEvent==="string"){nd=this.get(nodeEvent);if(!nd&&nodeEvent.includes(".")){nd=this.get(nodeEvent.substring(0,nodeEvent.lastIndexOf(".")));key=nodeEvent.substring(nodeEvent.lastIndexOf(".")+1)}}if(target instanceof GraphNode)target=target.__node.tag;if(typeof onEvent==="string"){let setOnEventFromString=onEvent2=>{if(this.get(onEvent2)?.__operator){let node=this.get(onEvent2);target=onEvent2;onEvent2=function(...inp){return node.__operator(...inp)}}else if(onEvent2.includes(".")){target=onEvent2.substring(0,onEvent2.lastIndexOf("."));let n=this.get(target);let k=onEvent2.substring(onEvent2.lastIndexOf(".")+1);tkey=k;if(typeof n[k]==="function"){if(n[k]instanceof GraphNode)onEvent2=n[k];else onEvent2=function(...inp){return n[k](...inp)}}else{onEvent2=function(inp){n[k]=inp;return n[k]}}}return onEvent2};if(target){let node=this.get(target);if(typeof node?.[onEvent]==="function"){tkey=onEvent;onEvent=function(...inp){return node[key](...inp)}}else if(node[key]){tkey=key;if(node[key]instanceof GraphNode)onEvent=node[key];else onEvent=function(inp){node[key]=inp;return node[key]}}else{onEvent=setOnEventFromString(onEvent)}}else{onEvent=setOnEventFromString(onEvent)}}let sub;if(nd instanceof GraphNode){const doSub=()=>{sub=nd.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)nd.__unsubscribe(sub,key,subInput);sub=void 0};nd.__addOndisconnected(()=>{ondelete();nd.__addOnconnected(()=>{if(sub===void 0&&nd.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))onEvent=this.get(onEvent);if(onEvent instanceof GraphNode){onEvent.__addOndisconnected(()=>{ondelete()})}};doSub()}else if(typeof nodeEvent==="string"){let node=this.get(nodeEvent);if(node){if(onEvent instanceof GraphNode&&onEvent.__operator){const doSub=()=>{sub=node.__subscribe(onEvent.__operator,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput)};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});onEvent.__addOndisconnected(ondelete)};doSub()}else if(typeof onEvent==="function"||typeof onEvent==="string"){const doSub=()=>{sub=node.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput);sub=void 0};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))this.get(onEvent).__addOndisconnected(ondelete)};doSub()}}else{if(typeof onEvent==="string")onEvent=this.__node.nodes.get(onEvent).__operator;if(typeof onEvent==="function")sub=this.__node.state.subscribeEvent(nodeEvent,onEvent)}}return sub};unsubscribe=(node,sub,key,subInput)=>{if(node instanceof GraphNode){return node.__unsubscribe(sub,key,subInput)}else return this.get(node)?.__unsubscribe(sub,key,subInput)};setState=update=>{this.__node.state.setState(update)}};function recursivelyAssign(target,obj,maxDepth=Infinity,curDepth=0){for(const key in obj){if(obj[key]?.constructor.name==="Object"&&curDepth<maxDepth){curDepth++;if(target[key]?.constructor.name==="Object")recursivelyAssign(target[key],obj[key],maxDepth,curDepth);else target[key]=recursivelyAssign({},obj[key],maxDepth,curDepth)}else{target[key]=obj[key]}}return target}function getAllProperties(obj){var allProps=[],curr=obj;do{var props=Object.getOwnPropertyNames(curr);let fn=function(prop){if(allProps.indexOf(prop)===-1)allProps.push(prop)};props.forEach(fn)}while(curr=Object.getPrototypeOf(curr));return allProps}function isNativeClass(thing){return isFunction(thing)==="class"}function isFunction(x){const res=typeof x==="function"?x.prototype?Object.getOwnPropertyDescriptor(x,"prototype")?.writable?"function":"class":x.constructor.name==="AsyncFunction"?"async":"arrow":"";return res}var getCallbackFromString=(a,graph)=>{if(graph.get(a)?.__operator){let node=graph.get(a);return(...inp)=>{node.__operator(...inp)}}else if(a.includes(".")){let split=a.split(".");let popped=split.pop();let joined=split.join(".");let node=graph.get(joined);if(typeof graph.get(joined)?.[popped]==="function"){return(...inp)=>{return node[popped](...inp)}}else return()=>{return node[popped]}}else if(graph.get(a)){let node=graph.get(a);return()=>{return node}}else{let arg=a;return()=>{return arg}}};var wrapArgs=(callback,argOrder,graph)=>{let args=[];let forArg=(a,i2)=>{if(a==="__output"||a==="__input"||a==="__callback"){args[i2]={__callback:inp=>{return inp},__args:void 0,idx:i2}}else if(typeof a==="string"){args[i2]={__callback:getCallbackFromString(a,graph),__args:void 0,idx:i2}}else if(typeof a==="function"){let fn2=a;args[i2]={__callback:(...inp)=>{return fn2(...inp)},__args:void 0,idx:i2}}else if(typeof a==="object"&&(a.__input||a.__callback)){let recursivelyCreateCallback=function(c){let input=c.__input?c.__input:c.__callback;if(typeof c.__input==="string"){input={__callback:getCallbackFromString(c.__input,graph),__args:void 0,idx:i2}}if(c.__args){let wrapped=wrapArgs(input,c.__args,graph);input={__callback:wrapped.__callback,__args:wrapped.__args,idx:i2}}else{input={__callback:input,__args:void 0,idx:i2}}if(c.__output){let output=c.__output;if(typeof c.__output==="string"){output={__callback:getCallbackFromString(output,graph),__args:void 0,idx:i2}}else if(typeof a.__output==="object"){output=recursivelyCreateCallback(output)}if(typeof output?.__callback==="function"){let fn2=input.__callback;let callback2=output.__callback;input={__callback:(...inp)=>{return callback2(fn2(...inp))},__args:output.__args,idx:i2}}}return input};args[i2]=recursivelyCreateCallback(a)}else{let arg=a;args[i2]={__callback:()=>{return arg},__args:void 0,idx:i2}}};argOrder.forEach(forArg);if(typeof callback==="string")callback={__callback:getCallbackFromString(callback,graph),__args:void 0};let fn=typeof callback==="function"?callback:callback.__callback;callback=function(...inp){let mapArg=arg=>{return arg.__callback(...inp)};const result=fn(...args.map(mapArg));return result};return{__callback:callback,__args:args}};var objProps=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var backprop=(node,parent,graph)=>{if(node.__node.backward&&parent instanceof GraphNode){graph.setListeners({[parent.__node.tag]:{[node.__node.tag]:parent}})}};var loop=(node,parent,graph)=>{if(node.__operator&&!node.__node.looperSet){if(typeof node.__node.delay==="number"){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{setTimeout(async()=>{res(await fn(...args))},node.__node.delay)})})}else if(node.__node.frame===true){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{requestAnimationFrame(async()=>{res(await fn(...args))})})})}if(typeof node.__node.repeat==="number"||typeof node.__node.recursive==="number"){let fn=node.__operator;node.__setOperator(async(...args)=>{let i2=node.__node.repeat?node.__node.repeat:node.__node.recursive;let result;let repeater=async(tick,...inp)=>{while(tick>0){if(node.__node.delay||node.__node.frame){fn(...inp).then(async res=>{if(node.__node.recursive){await repeater(tick,res)}else await repeater(tick,...inp)});break}else result=await fn(...args);tick--}};await repeater(i2,...args);return result})}if(node.__node.loop&&typeof node.__node.loop==="number"){node.__node.looperSet=true;let fn=node.__operator;let time=node.__node.loop;node.__setOperator((...args)=>{if(!("looping"in node.__node))node.__node.looping=true;if(node.__node.looping){let last=performance.now();fn(...args);setTimeout(()=>{let now=performance.now();let overshoot=now-last-node.__node.loop;if(overshoot>0)time=node.__node.loop-overshoot;else time=node.__node.loop;if(time<=0)time=node.__node.loop;node.__operator(...args)},time)}});if(node.__node.looping)node.__operator();let ondelete=node2=>{if(node2.__node.looping)node2.__node.looping=false};node.__addOndisconnected(ondelete)}}};var animate=(node,parent,graph)=>{if(node.__node.animate===true||node.__animation){let fn=node.__operator;node.__setOperator((...args)=>{if(!("animating"in node.__node))node.__node.animating=true;if(node.__node.animating){if(typeof node.__animation==="function")node.__animation(...args);else fn(...args);requestAnimationFrame(()=>{node.__operator(...args)})}});if(node.__node.animating||(!("animating"in node.__node)||node.__node.animating)&&node.__animation)setTimeout(()=>{requestAnimationFrame(node.__operator)},10);let ondelete=node2=>{if(node2.__node.animating)node2.__node.animating=false};node.__addOndisconnected(ondelete)}};var branching=(node,parent,graph)=>{if(typeof node.__branch==="object"&&node.__operator&&!node.__branchApplied){let fn=node.__operator;node.__branchApplied=true;node.__operator=(...args)=>{let result=fn(...args);for(const key in node.__branch){let triggered=()=>{if(typeof node.__branch[key].then==="function"){node.__branch[key].then(result)}else if(node.__branch[key].then instanceof GraphNode&&node.__branch[key].then.__operator){node.__branch[key].then.__operator(result)}else result=node.__branch[key].then};if(typeof node.__branch[key].if==="function"){if(node.__branch[key].if(result)==true){triggered()}}else if(node.__branch[key].if===result){triggered()}}return result}}if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].branch&&!node.__listeners[key].branchApplied){let fn=node.__listeners[key].callback;node.__listeners[key].branchApplied=true;node.__listeners.callback=ret=>{let triggered=()=>{if(typeof node.__listeners[key].branch.then==="function"){ret=node.__listeners[key].branch.then(ret)}else if(node.__listeners[key].branch.then instanceof GraphNode&&node.__listeners[key].branch.then.__operator){ret=node.__listeners[key].branch.then.__operator(ret)}else ret=node.__listeners[key].branch.then};if(typeof node.__listeners[key].branch.if==="function"){if(node.__listeners[key].branch.if(ret)){triggered()}}else if(node.__listeners[key].branch.if===ret){triggered()}return fn(ret)}}}}}};var triggerListenerOncreate=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].oncreate){node.__listeners[key].callback(node.__listeners[key].oncreate)}}}}};var bindListener=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].binding==="object"){node.__listeners.callback=node.__listeners.callback.bind(node.__listeners[key].binding)}}}}};var transformListenerResult=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].transform==="function"&&!node.__listeners[key].transformApplied){let fn=node.__listeners[key].callback;node.__listeners[key].transformApplied=true;node.__listeners.callback=ret=>{ret=node.__listeners[key].transform(ret);return fn(ret)}}}}}};var substitute__operator=(node,parent,graph)=>{if(node.post&&!node.__operator){node.__setOperator(node.post)}else if(!node.__operator&&typeof node.get=="function"){node.__setOperator(node.get)}if(!node.get&&node.__operator){node.get=node.__operator}if(node.aliases){node.aliases.forEach(a=>{graph.set(a,node);let ondelete=node2=>{graph.__node.nodes.delete(a)};node.__addOndisconnected(ondelete)})}if(typeof graph.__node.roots?.[node.__node.tag]==="object"&&node.get)graph.__node.roots[node.__node.tag].get=node.get};var loaders={backprop,loop,animate,branching,triggerListenerOncreate,bindListener,transformListenerResult,substitute__operator};var recursivelyStringifyFunctions=obj=>{let cpy={};for(const key in obj){if(typeof obj[key]==="object"){cpy[key]=recursivelyStringifyFunctions(obj[key])}else if(typeof obj[key]==="function"){cpy[key]=obj[key].toString()}else cpy[key]=obj[key]}return cpy};function parseFunctionFromText(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs22(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs}var stringifyFast=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p in value[prop]){if(Array.isArray(value[prop][p])){if(value[prop][p].length>20)obj[prop][p]=value[prop][p].slice(value[prop][p].length-20);else obj[prop][p]=value[prop][p]}else{if(value[prop][p]!=null){let con=value[prop][p].constructor.name;if(con.includes("Set")){obj[prop][p]=Array.from(value[prop][p])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p]="instanceof_"+con}else{obj[prop][p]=value[prop][p]}}else{obj[prop][p]=value[prop][p]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast22(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast}function methodstrings(node){if(typeof node.__methods==="object"){for(const key in node.__methods){let fstr=node.__methods[key];let fn=typeof fstr==="function"?fstr:parseFunctionFromText(fstr);if(key==="__operator"){node.__setOperator(fn)}else{node[key]=fn.bind(node)}}}}var Service=class extends Graph{name=\`service\${Math.floor(Math.random()*1e15)}\`;constructor(options){super({...options,loaders:options?.loaders?Object.assign({...loaders},options.loaders):{...loaders}});if(options?.services)this.addServices(options.services);this.load(this)}addServices=services=>{for(const s in services){if(typeof services[s]==="function")services[s]=new services[s];if(services[s]?.__node?.loaders)Object.assign(this.__node.loaders,services[s].__node.loaders);if(services[s]?.__node?.nodes){services[s].__node.nodes.forEach((n,tag)=>{if(!this.get(tag)){this.set(tag,n)}else this.set(s+"."+tag,n)});this.__node.nodes.forEach((n,k)=>{if(!services[s].__node.nodes.get(k))services[s].__node.nodes.set(k,n)});let set=this.set;this.set=(tag,node)=>{services[s].set(tag,node);return set(tag,node)};let del=this.delete;this.delete=tag=>{services[s].delete(tag);return del(tag)}}else if(typeof services[s]==="object"){this.load(services[s])}}};handleMethod=(route,method,args)=>{let m=method.toLowerCase();let src=this.__node.nodes.get(route);if(!src){src=this.__node.roots[route]}if(src?.[m]){if(typeof src[m]!=="function"){if(args){if(Array.isArray(args)&&args.length===1)src[m]=args[0];else src[m]=args;return}return src[m]}else{if(Array.isArray(args))return src[m](...args);else return src[m](args)}}else return this.handleServiceMessage({route,args,method})};handleServiceMessage(message){let call;if(typeof message==="object"){if(message.route)call=message.route;else if(message.node)call=message.node}if(call){if(Array.isArray(message.args))return this.run(call,...message.args);else return this.run(call,message.args)}else return message}handleGraphNodeCall(route,args){if(!route)return args;if(args?.args){this.handleServiceMessage(args)}else if(Array.isArray(args))return this.run(route,...args);else return this.run(route,args)}transmit=(...args)=>{if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};receive=(...args)=>{if(args[0]){if(typeof args[0]==="string"){let substr=args[0].substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))args[0]=args[0].replace(/\\\\/g,"");if(args[0][0]==='"'){args[0]=args[0].substring(1,args[0].length-1)};args[0]=JSON.parse(args[0])}}}if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};pipe=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return this.subscribe(source,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})};pipeOnce=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return source.__node.state.subscribeEventOnce(source.__node.unique,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.__node.state.subscribeEventOnce(source.__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(source).__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})};terminate=(...args)=>{};isTypedArray=isTypedArray;recursivelyAssign=recursivelyAssign2;spliceTypedArray=spliceTypedArray;ping=()=>{console.log("pinged!");return"pong"};echo=(...args)=>{this.transmit(...args);return args};log=(...args)=>{console.log(...args);return true};error=(...args)=>{console.error(...args);return true}};function isTypedArray(x){return ArrayBuffer.isView(x)&&Object.prototype.toString.call(x)!=="[object DataView]"}var recursivelyAssign2=(target,obj)=>{for(const key in obj){if(obj[key]?.constructor.name==="Object"&&!Array.isArray(obj[key])){if(target[key]?.constructor.name==="Object"&&!Array.isArray(target[key]))recursivelyAssign2(target[key],obj[key]);else target[key]=recursivelyAssign2({},obj[key])}else target[key]=obj[key]}return target};function spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let ta;if(s.length>0||e?.length>0)ta=new arr.constructor(s.length+e.length);if(ta){if(s.length>0)ta.set(s);if(e&&e.length>0)ta.set(e,s.length)}return ta}var nodeTemplates={};var remoteGraphRoutes={transferNode:(properties,connection,name2)=>{let str2;if(typeof properties==="object"){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}str2=recursivelyStringifyFunctions(properties)}else if(typeof properties==="function")str2=properties.toString();else if(typeof properties==="string")str2=properties;if(str2){if(connection.run)return connection.run("setNode",[str2]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:str2},void 0);return new Promise(r=>r(name2))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:str2}));return new Promise(r=>r(name2))}}},setNode:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function")properties={__operator:f,__node:{tag:name2?name2:f.name}};else{f=JSON.parse(properties);if(typeof f==="object")properties=f}}if(typeof properties==="object"||typeof properties==="function"){let template={};if(typeof properties==="object")Object.assign(template,properties);else template.__operator=properties;let node=this.__node.graph.add(template);if(node){nodeTemplates[node.__node.tag]=template;return node.__node?.tag}else return false}else return false},proxyRemoteNode:function(name2,connection){return new Promise((res,rej)=>{connection.run("getNodeProperties",name2).then(props=>{let proxy={};if(typeof props==="object"){for(const key in props){if(props[key]==="function"){proxy[key]=(...args)=>{return new Promise(r=>{connection.run(name2,args,key).then(r)})}}else{Object.defineProperty(proxy,key,{get:()=>{return new Promise(r=>{connection.run(name2,void 0,key).then(r)})},set:value=>{connection.post(name2,value,key)},configurable:true,enumerable:true})}}}res(proxy)})})},makeNodeTransferrable:function(properties,name2){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}const str2=recursivelyStringifyFunctions(properties);return str2},setTemplate:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function"){if(!name2)name2=f.name;properties={__operator:f,__node:{tag:name2}}}else{f=JSON.parse(properties);if(typeof f==="object"){properties=f;if(!name2&&f.__node?.tag)name2=f.__node.tag}}}if(!name2)name2=\`node\${Math.floor(Math.random()*1e15)}\`;if(typeof properties==="object"||typeof properties==="function"){nodeTemplates[name2]=properties;return name2}else return false},loadFromTemplate:function(templateName,name2,properties){if(nodeTemplates[templateName]){let cpy=recursivelyAssign2({},nodeTemplates[templateName]);if(name2){if(!cpy.__node)cpy.__node={};cpy.__node.tag=name2}if(properties)Object.assign(cpy,properties);let node=this.__node.graph.add(cpy);return node.__node.tag}},setMethod:function(nodeTag,fn,methodKey){if(typeof fn==="string"){let f=parseFunctionFromText(fn);if(typeof f==="function")fn=f}if(!methodKey&&typeof fn==="function")methodKey=fn.name;if(this.__node.graph.get(nodeTag)){this.__node.graph.get(nodeTag)[methodKey]=fn}else this.__node.graph.add({__node:{tag:methodKey,[methodKey]:fn}});return true},assignNode:function(nodeTag,source){if(this.__node.graph.get(nodeTag)&&typeof source==="object"){Object.assign(this.__node.graph.get(nodeTag),source)}},getNodeProperties:function(nodeTag){let node=this.__node.graph.get(nodeTag);if(node){let properties=Object.getOwnPropertyNames(node);let result={};for(const key in properties){result[key]=typeof node[key]}return result}return void 0},transferClass:(classObj,connection,className)=>{if(typeof classObj==="object"){let str2=classObj.toString();let message={route:"receiveClass",args:[str2,className]};if(connection.run)return connection.run("receiveClass",[str2,className]);else if(connection.postMessage){connection.postMessage({route:"receiveClass",args:[str2,className]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"receiveClass",args:[str2,className]}));return new Promise(r=>r(name))}return message}return false},receiveClass:function(stringified,className){if(typeof stringified==="string"){if(stringified.indexOf("class")===0){let cls=(0,eval)("("+stringified+")");let name2=className;if(!name2)name2=cls.name;this.__node.graph[name2]=cls;return true}}return false},transferFunction:(fn,connection,fnName)=>{if(!fnName)fnName=fn.name;let str2=fn.toString();let message={route:"setNode",args:[str2,fnName]};if(connection.run)return connection.run("setNode",[str2,fnName]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:[str2,fnName]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:[str2,fnName]}));return new Promise(r=>r(name))}return message},setGlobal:(key,value)=>{globalThis[key]=value;return true},assignGlobalObject:(target,source)=>{if(!globalThis[target])return false;if(typeof source==="object")Object.assign(globalThis[target],source);return true},setValue:function(key,value){this.__node.graph[key]=value;return true},assignObject:function(target,source){if(!this.__node.graph[target])return false;if(typeof source==="object")Object.assign(this.__node.graph[target],source);return true},setGlobalFunction:(fn,fnName)=>{if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;globalThis[fnName]=fn;return true}return false},setGraphFunction:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.__node.graph[fnName]=fn;return true}return false}};function html(strings,...args){return function append(elm=document.createElement("div")){let template=document.createElement("template");strings.map(function(s,i2){template.innerHTML+=s;if(args[i2]instanceof HTMLElement){let dummy2=\`<span id="dummyNode12345"></span>\`;dummy2.id="dummyNode12345";template.innerHTML+=dummy2}else template.innerHTML+=args[i2]});let query=template.content.querySelectorAll("#dummyNode12345");let ctr=0;args.forEach((arg,i2)=>{if(arg instanceof HTMLElement){console.log(arg,query[ctr]);template.content.replaceChild(arg,query[ctr]);ctr++}});elm.appendChild(template.content);return elm}}var dummy=html\`\`;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl.cipher.aes=function(a){this.s[0][0][0]||this.O();var b,c,d,e,f=this.s[0][4],g=this.s[1];b=a.length;var h=1;if(4!==b&&6!==b&&8!==b)throw new sjcl.exception.invalid("invalid aes key size");this.b=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));d[a]=d[a-b]^c}for(b=0;a;b++,a--)c=d[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]]};sjcl.cipher.aes.prototype={encrypt:function(a){return t(this,a,0)},decrypt:function(a){return t(this,a,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var a=this.s[0],b=this.s[1],c=a[4],d=b[4],e,f,g,h=[],k=[],l,n,m,p;for(e=0;256>e;e++)k[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=l||1,g=k[g]||1)for(m=g^g<<1^g<<2^g<<3^g<<4,m=m>>8^m&255^99,c[f]=m,d[m]=f,n=h[e=h[l=h[f]]],p=16843009*n^65537*e^257*l^16843008*f,n=257*h[m]^16843008*m,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p=p<<24^p>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};function t(a,b,c){if(4!==b.length)throw new sjcl.exception.invalid("invalid aes block size");var d=a.b[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,k,l,n=d.length/4-2,m,p=4,r=[0,0,0,0];h=a.s[c];a=h[0];var q=h[1],v=h[2],w=h[3],x=h[4];for(m=0;m<n;m++)h=a[e>>>24]^q[f>>16&255]^v[g>>8&255]^w[b&255]^d[p],k=a[f>>>24]^q[g>>16&255]^v[b>>8&255]^w[e&255]^d[p+1],l=a[g>>>24]^q[b>>16&255]^v[e>>8&255]^w[f&255]^d[p+2],b=a[b>>>24]^q[e>>16&255]^v[f>>8&255]^w[g&255]^d[p+3],p+=4,e=h,f=k,g=l;for(m=0;4>m;m++)r[c?3&-m:m]=x[e>>>24]<<24^x[f>>16&255]<<16^x[g>>8&255]<<8^x[b&255]^d[p++],h=e,e=f,f=g,g=b,b=h;return r}sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.$(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.$(b,d,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b=b&31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return false;var c=0,d;for(d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c},$:function(a,b,c,d){var e;e=0;for(void 0===d&&(d=[]);32<=b;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1));return d},i:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&65280|(c&65280)<<8|c<<24;return a}};sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++)0===(d&3)&&(e=a[d/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++)d=d<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d),d=0);c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b}};sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d;a=a.replace(/\\s|0x/g,"");d=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,4*d)}};sjcl.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(a,b,c){var d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f="",g=0,h=sjcl.codec.base32.B,k=0,l=sjcl.bitArray.bitLength(a);c&&(h=sjcl.codec.base32.X);for(c=0;f.length*d<l;)f+=h.charAt((k^a[c]>>>g)>>>e),g<d?(k=a[c]<<d-g,g+=e,c++):(k<<=d,g-=d);for(;f.length&7&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\\s|=/g,"").toUpperCase();var c=sjcl.codec.base32.BITS,d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f=[],g,h=0,k=sjcl.codec.base32.B,l=0,n,m="base32";b&&(k=sjcl.codec.base32.X,m="base32hex");for(g=0;g<a.length;g++){n=k.indexOf(a.charAt(g));if(0>n){if(!b)try{return sjcl.codec.base32hex.toBits(a)}catch(p){}throw new sjcl.exception.invalid("this isn't "+m+"!")}h>e?(h-=e,f.push(l^n>>>h),l=n<<c-h):(h+=d,l^=n<<c-h)}h&56&&f.push(sjcl.bitArray.partial(h&56,l,1));return f}};sjcl.codec.base32hex={fromBits:function(a,b){return sjcl.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl.codec.base32.toBits(a,1)}};sjcl.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.B,g=0,h=sjcl.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;d.length&3&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\\s|=/g,"");var c=[],d,e=0,f=sjcl.codec.base64.B,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d=0;d<a.length;d++){h=f.indexOf(a.charAt(d));if(0>h)throw new sjcl.exception.invalid("this isn't base64!");26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e)}e&56&&c.push(sjcl.bitArray.partial(e&56,g,1));return c}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}};sjcl.hash.sha256=function(a){this.b[0]||this.O();a?(this.F=a.F.slice(0),this.A=a.A.slice(0),this.l=a.l):this.reset()};sjcl.hash.sha256.hash=function(a){return new sjcl.hash.sha256().update(a).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.A=sjcl.bitArray.concat(this.A,a);b=this.l;a=this.l=b+sjcl.bitArray.bitLength(a);if(9007199254740991<a)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d=new Uint32Array(c),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u(this,d.subarray(16*e,16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u(this,c.splice(0,16));return this},finalize:function(){var a,b=this.A,c=this.F,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.l/4294967296));for(b.push(this.l|0);b.length;)u(this,b.splice(0,16));this.reset();return c},Y:[],b:[],O:function(){function a(a2){return 4294967296*(a2-Math.floor(a2))|0}for(var b=0,c=2,d,e;64>b;c++){e=true;for(d=2;d*d<=c;d++)if(0===c%d){e=false;break}e&&(8>b&&(this.Y[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}};function u(a,b){var c,d,e,f=a.F,g=a.b,h=f[0],k=f[1],l=f[2],n=f[3],m=f[4],p=f[5],r=f[6],q=f[7];for(c=0;64>c;c++)16>c?d=b[c]:(d=b[c+1&15],e=b[c+14&15],d=b[c&15]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c&15]+b[c+9&15]|0),d=d+q+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(r^m&(p^r))+g[c],q=r,r=p,p=m,m=n+d|0,n=l,l=k,k=h,h=d+(k&l^n&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+n|0;f[4]=f[4]+m|0;f[5]=f[5]+p|0;f[6]=f[6]+r|0;f[7]=f[7]+q|0}sjcl.mode.ccm={name:"ccm",G:[],listenProgress:function(a){sjcl.mode.ccm.G.push(a)},unListenProgress:function(a){a=sjcl.mode.ccm.G.indexOf(a);-1<a&&sjcl.mode.ccm.G.splice(a,1)},fa:function(a){var b=sjcl.mode.ccm.G.slice(),c;for(c=0;c<b.length;c+=1)b[c](a)},encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,k=h.bitLength(c)/8,l=h.bitLength(g)/8;e=e||64;d=d||[];if(7>k)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&l>>>8*f;f++);f<15-k&&(f=15-k);c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.V(a,b,c,d,e,f);g=sjcl.mode.ccm.C(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/8;if(7>g)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&h>>>8*b;b++);b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));k=sjcl.mode.ccm.C(a,k,c,l,e,b);a=sjcl.mode.ccm.V(a,k.data,c,d,e,b);if(!f.equal(k.tag,a))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return k.data},na:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,k=h.i;d=[h.partial(8,(b.length?64:0)|d-2<<2|f-1)];d=h.concat(d,c);d[3]|=e;d=a.encrypt(d);if(b.length)for(c=h.bitLength(b)/8,65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,b),b=0;b<g.length;b+=4)d=a.encrypt(k(d,g.slice(b,b+4).concat([0,0,0])));return d},V:function(a,b,c,d,e,f){var g=sjcl.bitArray,h=g.i;e/=8;if(e%2||4>e||16<e)throw new sjcl.exception.invalid("ccm: invalid tag length");if(4294967295<d.length||4294967295<b.length)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");c=sjcl.mode.ccm.na(a,d,c,e,g.bitLength(b)/8,f);for(d=0;d<b.length;d+=4)c=a.encrypt(h(c,b.slice(d,d+4).concat([0,0,0])));return g.clamp(c,8*e)},C:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.i;var k=b.length,l=h.bitLength(b),n=k/50,m=n;c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d=h.bitSlice(g(d,a.encrypt(c)),0,e);if(!k)return{tag:d,data:[]};for(g=0;g<k;g+=4)g>n&&(sjcl.mode.ccm.fa(g/k),n+=m),c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d,data:h.clamp(b,l)}}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var g,h=sjcl.mode.ocb2.S,k=sjcl.bitArray,l=k.i,n=[0,0,0,0];c=h(a.encrypt(c));var m,p=[];d=d||[];e=e||64;for(g=0;g+4<b.length;g+=4)m=b.slice(g,g+4),n=l(n,m),p=p.concat(l(c,a.encrypt(l(c,m)))),c=h(c);m=b.slice(g);b=k.bitLength(m);g=a.encrypt(l(c,[0,0,0,b]));m=k.clamp(l(m.concat([0,0,0]),g),b);n=l(n,l(m.concat([0,0,0]),g));n=a.encrypt(l(n,l(c,h(c))));d.length&&(n=l(n,f?d:sjcl.mode.ocb2.pmac(a,d)));return p.concat(k.concat(m,k.clamp(n,e)))},decrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");e=e||64;var g=sjcl.mode.ocb2.S,h=sjcl.bitArray,k=h.i,l=[0,0,0,0],n=g(a.encrypt(c)),m,p,r=sjcl.bitArray.bitLength(b)-e,q=[];d=d||[];for(c=0;c+4<r/32;c+=4)m=k(n,a.decrypt(k(n,b.slice(c,c+4)))),l=k(l,m),q=q.concat(m),n=g(n);p=r-32*c;m=a.encrypt(k(n,[0,0,0,p]));m=k(m,h.clamp(b.slice(c),p).concat([0,0,0]));l=k(l,m);l=a.encrypt(k(l,k(n,g(n))));d.length&&(l=k(l,f?d:sjcl.mode.ocb2.pmac(a,d)));if(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))throw new sjcl.exception.corrupt("ocb: tag doesn't match");return q.concat(h.clamp(m,p))},pmac:function(a,b){var c,d=sjcl.mode.ocb2.S,e=sjcl.bitArray,f=e.i,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4)h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d(f(h,d(h))),g))},S:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);b=sjcl.bitArray;d=d||[];a=sjcl.mode.gcm.C(true,a,f,d,c,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c,d,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);e=e||128;d=d||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.C(false,a,f,d,c,e);if(!g.equal(a.tag,b))throw new sjcl.exception.corrupt("gcm: tag doesn't match");return a.data},ka:function(a,b){var c,d,e,f,g,h=sjcl.bitArray.i;e=[0,0,0,0];f=b.slice(0);for(c=0;128>c;c++){(d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d=3;0<d;d--)f[d]=f[d]>>>1|(f[d-1]&1)<<31;f[0]>>>=1;g&&(f[0]^=-520093696)}return e},j:function(a,b,c){var d,e=c.length;b=b.slice(0);for(d=0;d<e;d+=4)b[0]^=4294967295&c[d],b[1]^=4294967295&c[d+1],b[2]^=4294967295&c[d+2],b[3]^=4294967295&c[d+3],b=sjcl.mode.gcm.ka(b,a);return b},C:function(a,b,c,d,e,f){var g,h,k,l,n,m,p,r,q=sjcl.bitArray;m=c.length;p=q.bitLength(c);r=q.bitLength(d);h=q.bitLength(e);g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=q.concat(e,[1])):(e=sjcl.mode.gcm.j(g,[0,0,0,0],e),e=sjcl.mode.gcm.j(g,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl.mode.gcm.j(g,[0,0,0,0],d);n=e.slice(0);d=h.slice(0);a||(d=sjcl.mode.gcm.j(g,h,c));for(l=0;l<m;l+=4)n[3]++,k=b.encrypt(n),c[l]^=k[0],c[l+1]^=k[1],c[l+2]^=k[2],c[l+3]^=k[3];c=q.clamp(c,p);a&&(d=sjcl.mode.gcm.j(g,h,c));a=[Math.floor(r/4294967296),r&4294967295,Math.floor(p/4294967296),p&4294967295];d=sjcl.mode.gcm.j(g,d,a);k=b.encrypt(e);d[0]^=k[0];d[1]^=k[1];d[2]^=k[2];d[3]^=k[3];return{tag:q.bitSlice(d,0,f),data:c}}};sjcl.misc.hmac=function(a,b){this.W=b=b||sjcl.hash.sha256;var c=[[],[]],d,e=b.prototype.blockSize/32;this.w=[new b,new b];a.length>e&&(a=b.hash(a));for(d=0;d<e;d++)c[0][d]=a[d]^909522486,c[1][d]=a[d]^1549556828;this.w[0].update(c[0]);this.w[1].update(c[1]);this.R=new b(this.w[0])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){if(this.aa)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");this.update(a);return this.digest(a)};sjcl.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=false};sjcl.misc.hmac.prototype.update=function(a){this.aa=true;this.R.update(a)};sjcl.misc.hmac.prototype.digest=function(){var a=this.R.finalize(),a=new this.W(this.w[1]).update(a).finalize();this.reset();return a};sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1e4;if(0>d||0>c)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,k,l=[],n=sjcl.bitArray;for(k=1;32*l.length<(d||1);k++){e=f=a.encrypt(n.concat(b,[k]));for(g=1;g<c;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];l=l.concat(e)}d&&(l=n.clamp(l,d));return l};sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=a;this.D=false;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=3e4;this.ba=80};sjcl.prng.prototype={randomWords:function(a,b){var c=[],d;d=this.isReady(b);var e;if(d===this.u)throw new sjcl.exception.notReady("generator isn't seeded");if(d&this.J){d=!(d&this.I);e=[];var f=0,g;this.Z=e[0]=new Date().valueOf()+this.da;for(g=0;16>g;g++)e.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.m[g],this.m[g]=0,d||!(this.P&1<<g));g++);this.P>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.m.push(0));this.f-=f;f>this.o&&(this.o=f);this.P++;this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.L=new sjcl.cipher.aes(this.b);for(d=0;4>d&&(this.h[d]=this.h[d]+1|0,!this.h[d]);d++);}for(d=0;d<a;d+=4)0===(d+1)%this.ca&&y(this),e=z(this),c.push(e[0],e[1],e[2],e[3]);y(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=new Date().valueOf(),g=this.H[c],h=this.isReady(),k=0;d=this.U[c];void 0===d&&(d=this.U[c]=this.ha++);void 0===g&&(g=this.H[c]=0);this.H[c]=(this.H[c]+1)%this.c.length;switch(typeof a){case"number":void 0===b&&(b=1);this.c[g].update([d,this.N++,1,b,f,1,a|0]);break;case"object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(k=1),c=0;c<a.length&&!k;c++)"number"!==typeof a[c]&&(k=1);if(!k){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e=e>>>1;this.c[g].update([d,this.N++,2,b,f,a.length].concat(a))}break;case"string":void 0===b&&(b=a.length);this.c[g].update([d,this.N++,3,b,f,a.length]);this.c[g].update(a);break;default:k=1}if(k)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[g]+=b;this.f+=b;h===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},isReady:function(a){a=this.T[void 0!==a?a:this.M];return this.o&&this.o>=a?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=a?this.J|this.u:this.u},getProgress:function(a){a=this.T[a?a:this.M];return this.o>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,false),window.addEventListener("mousemove",this.a.mouseCollector,false),window.addEventListener("keypress",this.a.keyboardCollector,false),window.addEventListener("devicemotion",this.a.accelerometerCollector,false),window.addEventListener("touchmove",this.a.touchCollector,false);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl.exception.bug("can't attach event");this.D=true}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,false),window.removeEventListener("mousemove",this.a.mouseCollector,false),window.removeEventListener("keypress",this.a.keyboardCollector,false),window.removeEventListener("devicemotion",this.a.accelerometerCollector,false),window.removeEventListener("touchmove",this.a.touchCollector,false)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=false)},addEventListener:function(a,b){this.K[a][this.ga++]=b},removeEventListener:function(a,b){var c,d,e=this.K[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},la:function(){C(this,1)},oa:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,"mouse");C(this,0)},qa:function(a){a=a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C(this,0)},ma:function(){C(this,2)},ea:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C(this,0)}};function A(a,b){var c,d=sjcl.random.K[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}function C(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy(new Date().valueOf(),b,"loadtime")}function y(a){a.b=z(a).concat(z(a));a.L=new sjcl.cipher.aes(a.b)}function z(a){for(var b=0;4>b&&(a.h[b]=a.h[b]+1|0,!a.h[b]);b++);return a.L.encrypt(a.h)}function B(a,b){return function(){b.apply(a,arguments)}}sjcl.random=new sjcl.prng(6);a:try{if(G="undefined"!==typeof module&&module.exports){try{H=__require2("crypto")}catch(a){H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array(new Uint8Array(D).buffer),sjcl.random.addEntropy(D,1024,"crypto['randomBytes']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F);else break a;sjcl.random.addEntropy(F,1024,"crypto['getRandomValues']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}var D;var E;var F;var G;var H;sjcl.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json,f=e.g({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.g(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl.codec.base64.toBits(f.iv));if(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)throw new sjcl.exception.invalid("json encrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));"string"===typeof c&&(f.adata=c=sjcl.codec.utf8String.toBits(c));g=new sjcl.cipher[f.cipher](a);e.g(d,f);d.key=a;f.ct="ccm"===f.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(g,b,f.iv,c,f.ts):sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f},encrypt:function(a,b,c,d){var e=sjcl.json,f=e.ja.apply(e,arguments);return e.encode(f)},ia:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json;b=e.g(e.g(e.g({},e.defaults),b),c,true);var f,g;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv));if(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjcl.exception.invalid("json decrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl.codec.utf8String.toBits(f));g=new sjcl.cipher[b.cipher](a);f="ccm"===b.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(g,b.ct,b.iv,b.tag,f,b.ts):sjcl.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.g(d,b);d.key=a;return 1===c.raw?f:sjcl.codec.utf8String.fromBits(f)},decrypt:function(a,b,c,d){var e=sjcl.json;return e.ia(a,e.decode(b),c,d)},encode:function(a){var b,c="{",d="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");c+=d+'"'+b+'":';d=",";switch(typeof a[b]){case"number":case"boolean":c+=a[b];break;case"string":c+='"'+escape(a[b])+'"';break;case"object":c+='"'+sjcl.codec.base64.fromBits(a[b],0)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return c+"}"},decode:function(a){a=a.replace(/\\s/g,"");if(!a.match(/^\\{.*\\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");a=a.replace(/^\\{|\\}$/g,"").split(/,/);var b={},c,d;for(c=0;c<a.length;c++){if(!(d=a[c].match(/^\\s*(?:(["']?)([a-z][a-z0-9]*)\\1)\\s*:\\s*(?:(-?\\d+)|"([a-z0-9+\\/%*_.@=\\-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");null!=d[3]?b[d[2]]=parseInt(d[3],10):null!=d[4]?b[d[2]]=d[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(d[4]):unescape(d[4]):null!=d[5]&&(b[d[2]]="true"===d[5])}return b},g:function(a,b,c){void 0===a&&(a={});if(void 0===b)return a;for(var d in b)if(b.hasOwnProperty(d)){if(c&&void 0!==a[d]&&a[d]!==b[d])throw new sjcl.exception.invalid("required parameter overridden");a[d]=b[d]}return a},sa:function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&a[d]!==b[d]&&(c[d]=a[d]);return c},ra:function(a,b){var c={},d;for(d=0;d<b.length;d++)void 0!==a[b[d]]&&(c[b[d]]=a[b[d]]);return c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.pa={};sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.pa,d;b=b||{};d=b.iter||1e3;c=c[a]=c[a]||{};d=c[d]=c[d]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=void 0===b.salt?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);return{key:d[c].slice(0),salt:c.slice(0)}};var _HTTPfrontend=class extends Service{name="http";fetchProxied=false;listening={};constructor(options,path,fetched){super(options);this.load(this);this.listen(path,fetched)}GET=(url="http://localhost:8080/ping",type="",mimeType)=>{if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"GET",url,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};POST=(message,url="http://localhost:8080/echo",type="",mimeType)=>{if(typeof message==="object"&&(type==="json"||type==="text"||!type)){message=JSON.stringify(message)}if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"POST",url,data:message,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};transmit=(message,url)=>{let obj=message;if(typeof obj==="object"){message=JSON.stringify(obj)}if(obj?.method?.toLowerCase()=="get"||message?.toLowerCase()==="get")return this.GET(url);return this.POST(message,url)};transponder=(url,message,type="",mimeType)=>{if(typeof message==="object")message=JSON.stringify(message);let method="GET";if(message){method="POST"}if(type==="json")mimeType="application/json";else return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method,url,data:message,responseType:type,onload:ev=>{let body=xhr.response;if(typeof body==="string"){let substr=body.substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))body=body.replace(/\\\\/g,"");if(body[0]==='"'){body=body.substring(1,body.length-1)};body=JSON.parse(body)}}if(typeof body?.method==="string"){return resolve(this.handleMethod(body.route,body.method,body.args))}else if(typeof body?.route==="string"){return resolve(this.handleServiceMessage(body))}else if(typeof body?.node==="string"||body.node instanceof GraphNode){return resolve(this.handleGraphNodeCall(body.node,body.args))}else return resolve(body)},onabort:er=>{reject(er)}})}).catch(console.error)};listen=(path="0",fetched=async(clone,args,response)=>{const result=await clone.text();const returned=this.receive(result);this.setState({[response.url]:returned})})=>{this.listening[path]={};let listenerId=\`\${path}\${Math.floor(Math.random()*1e15)}\`;this.listening[path][listenerId]=fetched;if(!this.fetchProxied){globalThis.fetch=new Proxy(globalThis.fetch,{apply(fetch,that,args){const result=fetch.apply(that,args);result.then(response=>{if(!response.ok)return;if(this.listening["0"]){for(const key in this.listeners){const clone=response.clone();this.listening["0"][key](clone,args,response)}}else{for(const key in this.listening){if(response.url.includes(key)){for(const key2 in this.listening[path]){const clone=response.clone();this.listening[path][key2](clone,args,response)}break}}}}).catch(er=>{console.error(er)});return result}});this.fetchProxied=true}return listenerId};stopListening=(path,listener)=>{if(!path&&path!==0){for(const key in this.listening)delete this.listening[key]}else{if(!listener)delete this.listening[path];else delete this.listening[listener]}}};var HTTPfrontend=_HTTPfrontend;__publicField(HTTPfrontend,"request",options=>{const xhr=new XMLHttpRequest;if(options.responseType)xhr.responseType=options.responseType;else options.responseType="json";if(options.mimeType){xhr.overrideMimeType(options.mimeType)}if(options.onload)xhr.addEventListener("load",options.onload,false);if(options.onprogress)xhr.addEventListener("progress",options.onprogress,false);if(options.onabort)xhr.addEventListener("abort",options.onabort,false);if(options.onloadend)xhr.addEventListener("loadend",options.onloadend,false);if(options.onerror)xhr.addEventListener("error",options.onerror,false);xhr.open(options.method,options.url,true,options.user,options.pass);if(!options.onerror)xhr.onerror=function(){xhr.abort()};xhr.send(options.data);return xhr});var import_web_worker=__toESM(require_browser());var WorkerService=class extends Service{name="worker";workers={};threadRot=0;connections;constructor(options){super();this.connections={workers:this.workers};if(options?.services)this.addServices(options.services);this.load(this);this.setLoaders(this.workerloader);if(options)this.init(options);if(typeof WorkerGlobalScope!=="undefined"&&globalThis instanceof WorkerGlobalScope){this.addDefaultMessageListener()}}loadWorkerRoute=(rt,routeKey)=>{if(rt.workerUrl)rt.url=rt.workerUrl;if(rt.workerId)rt.__node.tag=rt.workerId;if(!rt.__node.tag)rt.__node.tag=routeKey;rt._id=rt.__node.tag;let worker;if(this.workers[rt._id])worker=this.workers[rt._id];else if(rt.worker)worker=rt.worker;if(!worker){worker=this.addWorker(rt)}rt.worker=worker;if(!rt.worker.__ondisconnected){let ondelete=rt2=>{rt2.worker?.terminate()};rt.__addOndisconnected(ondelete)}if(rt.transferFunctions){for(const prop in rt.transferFunctions){this.transferFunction(worker,rt.transferFunctions[prop],prop)}}if(rt.transferClasses){for(const prop in rt.transferClasses){this.transferClass(worker,rt.transferClasses[prop],prop)}}if(worker){if(!rt.__operator){rt.__operator=(...args)=>{if(rt.callback){if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.post(rt.callback,args);else return worker.run(rt.callback,args)}else{if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.send(args);else return worker.request(args)}}}if(rt.init){worker.run(rt.init,rt.initArgs,void 0,rt.initTransfer)}return worker}};workerloader={"workers":(node,parent,graph,roots)=>{let rt=node;if(!node.parentRoute&&(parent?.callback&&parent?.worker))node.parentRoute=parent?.callback;if(rt?.worker||rt?.workerId||rt?.workerUrl){let worker=this.loadWorkerRoute(rt,rt.__node.tag);if(worker){if(!rt.parentRoute&&rt.__parent?.callback)rt.parentRoute=rt.__parent.callback;if(rt.__parent&&!rt.portId){if(typeof rt.__parent==="string"){if(rt.__node.tag!==rt.__parent&&worker._id!==rt.__parent)rt.portId=this.establishMessageChannel(worker,rt.__parent)}else if(rt.__node.tag!==rt.__parent?.__node?.tag&&worker._id!==rt.__parent?.tag){rt.portId=this.establishMessageChannel(worker,rt.__parent.worker)}};if(rt.parentRoute){if(!rt.stopped){if(typeof rt.__parent==="string"&&rt.__parent===worker._id){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else if(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.parentRoute,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id)&&!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent){if(typeof rt.__parent==="string"){if(!rt.stopped){if(rt.__parent===worker._id){worker.run("subscribe",[rt.__parent,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id))worker.workerSubs[rt.__parent+rt.portId]={sub:null,route:worker._id,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent?.__node?.tag&&rt.__parent?.worker){if(!rt.stopped){if(rt.__node.tag===rt.__parent.__node.tag||worker._id===rt.__parent.__node.tag){worker.run("subscribe",[rt.__parent.__node.tag,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent.__node.tag,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent.__node.tag+rt.portId].sub=sub})}if(!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.__parent.__node.tag+rt.portId]={sub:null,route:rt.__parent.__node.tag,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}}}}else if(rt.__parent&&rt.parentRoute){if(typeof rt.__parent==="string"&&roots[rt.__parent]?.worker){roots[rt.__parent].worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}else if(rt.__parent?.worker){rt.__parent.worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}}return rt}};addDefaultMessageListener=()=>{globalThis.onmessage=ev=>{let result=this.receive(ev.data);if(this.__node.keepState)this.setState({[this.name]:result})}};postMessage=(message,target,transfer)=>{if(this.workers[target]){this.workers[target].send(message,transfer)}else{globalThis.postMessage(message,target,transfer)}};addWorker=options=>{let worker;if(!options._id)options._id=\`worker\${Math.floor(Math.random()*1e15)}\`;if(options.url)worker=new import_web_worker.default(options.url);else if(options.port){worker=options.port}else if(this.workers[options._id]){if(this.workers[options._id].port)worker=this.workers[options._id].port;else worker=this.workers[options._id].worker}if(!worker)return;let send=(message,transfer)=>{return this.transmit(message,worker,transfer)};let post=(route,args,method,transfer)=>{let message={route,args};if(method)message.method=method;return this.transmit(message,worker,transfer)};let run=(route,args,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[{route,args},options._id,callbackId]};if(method)req.args[0].method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let request=(message,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,options._id,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let workerSubs={};let subscribe=(route,callback,args,key,subInput,blocking)=>{return this.subscribeToWorker(route,options._id,callback,args,key,subInput,blocking)};let unsubscribe=(route,sub)=>{return run("unsubscribe",[route,sub])};let start=async(route,portId,callback,blocking)=>{if(route)await run("subscribeToWorker",[route,portId,void 0,callback,blocking]).then(sub=>{if(sub)workerSubs[route+portId]={sub,route,portId,callback,blocking}});else for(const key in workerSubs){if(typeof workerSubs[key].sub!=="number")await run("subscribeToWorker",[workerSubs[key].route,workerSubs[key].portId,void 0,workerSubs[key].callback,void 0,workerSubs[key].blocking]).then(sub=>{workerSubs[key].sub=sub});console.log(JSON.stringify(workerSubs))}return true};let stop=async(route,portId)=>{if(route&&portId&&workerSubs[route+portId]){await run("unsubscribe",[route,workerSubs[route+portId].sub]);workerSubs[route+portId].sub=false}else{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){await run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub]).then(console.log)}workerSubs[key].sub=false}}return true};let terminate=()=>{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub])}workerSubs[key].sub=false}return this.terminate(options._id)};if(!options.onmessage)options.onmessage=ev=>{this.receive(ev.data);this.setState({[options._id]:ev.data})};if(!options.onerror){options.onerror=ev=>{console.error(ev.data)}}worker.onmessage=options.onmessage;worker.onerror=options.onerror;this.workers[options._id]={worker,send,post,run,request,subscribe,unsubscribe,terminate,start,stop,postMessage:worker.postMessage,workerSubs,graph:this,...options};return this.workers[options._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=scriptTemplate=>{let blob=new Blob([scriptTemplate],{type:"text/javascript"});return URL.createObjectURL(blob)};getTransferable(message){let transfer;if(typeof message==="object"){if(message.args){if(message.args?.constructor?.name==="Object"){for(const key in message.args){if(ArrayBuffer.isView(message.args[key])){if(!transfer)transfer=[message.args[key].buffer];else transfer.push(message.args[key].buffer)}else if(message.args[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message.args[key]];else transfer.push(message.args[key])}}}else if(Array.isArray(message.args)&&message.args.length<11){message.args.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg?.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message.args)){transfer=[message.args.buffer]}else if(message.args?.constructor?.name==="ArrayBuffer"){transfer=[message]}}else if(message?.constructor?.name==="Object"){for(const key in message){if(ArrayBuffer.isView(message[key])){if(!transfer)transfer=[message[key].buffer];else transfer.push(message[key].buffer)}else if(message[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message[key]];else transfer.push(message[key])}}}else if(Array.isArray(message)&&message.length<11){message.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message)){transfer=[message.buffer]}else if(message.constructor?.name==="ArrayBuffer"){transfer=[message]}}return transfer}transmit=(message,worker,transfer)=>{if(!transfer){transfer=this.getTransferable(message)}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){worker.postMessage(message,transfer)}else if(typeof worker==="string"){if(this.workers[worker]){if(this.workers[worker].port)this.workers[worker].port.postMessage(message,transfer);else if(this.workers[worker].worker)this.workers[worker].worker.postMessage(message,transfer)}}else{let keys2=Object.keys(this.workers);this.workers[keys2[this.threadRot]].worker.postMessage(message,transfer);this.threadRot++;if(this.threadRot===keys2.length)this.threadRot=0}return message};terminate=worker=>{let onclose;if(typeof worker==="string"){let obj=this.workers[worker];if(obj){delete this.workers[worker];worker=obj.worker;if(obj.onclose)onclose=obj.onclose}}else if(typeof worker==="object"){if(worker?._id){worker=worker.worker;delete this.workers[worker?._id]}}if(worker instanceof import_web_worker.default){worker.terminate();if(onclose)onclose(worker);return true}if(worker instanceof MessagePort){worker.close();if(onclose)onclose(worker);return true}return false};establishMessageChannel=(worker,worker2)=>{let workerId;if(typeof worker==="string"){workerId=worker;if(this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker2=this.workers[worker].worker}}else if(worker?.worker){worker=worker.worker}if(typeof worker2==="string"){if(this.workers[worker2]){if(this.workers[worker2].port)worker2=this.workers[worker2].port;else worker2=this.workers[worker2].worker}}else if(worker2?.worker){worker2=worker2.worker}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){let channel=new MessageChannel;let portId=\`port\${Math.floor(Math.random()*1e15)}\`;worker.postMessage({route:"addWorker",args:{port:channel.port1,_id:portId}},[channel.port1]);if(worker2 instanceof import_web_worker.default||worker2 instanceof MessagePort){worker2.postMessage({route:"addWorker",args:{port:channel.port2,_id:portId}},[channel.port2])}else if(workerId&&this.workers[workerId]){channel.port2.onmessage=this.workers[workerId].onmessage;this.workers[workerId].port=channel.port2}return portId}return false};request=(message,workerId,transfer,method)=>{let worker=this.workers[workerId].worker;return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};runRequest=(message,worker,callbackId)=>{let res=this.receive(message);if(typeof worker==="string"&&this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}if(res instanceof Promise){res.then(r=>{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:r,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:r,callbackId})})}else{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:res,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:res,callbackId})}return res};subscribeWorker=(route,worker,args,key,subInput,blocking)=>{let callback;if(blocking){let blocked=false;callback=res=>{if(!blocked){blocked=true;if(res instanceof Promise){res.then(r=>{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,r]).then(ret=>{blocked=false})})}else{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,res]).then(ret=>{blocked=false})}}}}else{callback=res=>{if(res instanceof Promise){res.then(r=>{if(worker?.postMessage)worker.postMessage({args:r,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:r,callbackId:route})})}else{if(worker?.postMessage)worker.postMessage({args:res,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:res,callbackId:route})}}}if(!blocking&&worker?.port){worker=worker.port}else if(!blocking&&worker?.worker){worker=worker.worker}else if(typeof worker==="string"&&this.workers[worker]){if(blocking)worker=this.workers[worker];else if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}return this.subscribe(route,callback,args,key,subInput)};subscribeToWorker=(route,workerId,callback,args,key,subInput,blocking)=>{if(typeof workerId==="string"&&this.workers[workerId]){this.__node.state.subscribeEvent(workerId,res=>{if(res?.callbackId===route){if(!callback)this.setState({[workerId]:res.args});else if(typeof callback==="string"){this.run(callback,res.args)}else callback(res.args)}});return this.workers[workerId].run("subscribeWorker",[route,workerId,args,key,subInput,blocking])}};triggerSubscription=async(route,workerId,result)=>{if(this.__node.state.triggers[workerId])for(let i2=0;i2<this.__node.state.triggers[workerId].length;i2++){await this.__node.state.triggers[workerId][i2].onchange({args:result,callbackId:route})}return true};pipeWorkers=(sourceWorker,listenerWorker,sourceRoute,listenerRoute,portId,args,key,subInput,blocking)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof listenerWorker==="string")listenerWorker=this.workers[listenerWorker];if(!portId){portId=this.establishMessageChannel(sourceWorker.worker,listenerWorker.worker)}return listenerWorker.run("subscribeToWorker",[sourceRoute,portId,listenerRoute,args,key,subInput,blocking])};unpipeWorkers=(sourceRoute,sourceWorker,sub)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof sourceWorker==="object"){return sourceWorker.run("unsubscribe",[sourceRoute,sub])}}};var mouseEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]);var wheelEventHandlerImpl=makeSendPropertiesHandler(["deltaX","deltaY"]);var keydownEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function focusEventHandler(event,sendFn){const data={type:event.type};data.isTrusted=event.isTrusted;data.bubbles=event.bubbles;data.cancelBubble=event.cancelBubble;data.cancelable=event.cancelable;data.composed=event.composed;data.defaultPrevent=event.defaultPrevented;data.eventPhase=event.eventPhase;data.returnValue=event.returnValue;data.currentTarget=event.currentTarget.id?event.currentTarget.id:event.currentTarget.constructor.name;data.target=data.currentTarget;data.srcElement=data.currentTarget;sendFn(data)}function wheelEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();wheelEventHandlerImpl(event,sendFn)}function preventDefaultHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault()}function copyProperties(src,properties,dst){for(const name2 of properties){dst[name2]=src[name2]}}function makeSendPropertiesHandler(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties(event,properties,data);sendFn(data)}}function touchEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();const touches=[];const data={type:event.type,touches};for(let i2=0;i2<event.touches.length;++i2){const touch=event.touches[i2];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var i=1;var keys={};while(i<222){keys[i]=true;i++}function filteredKeydownEventHandler(event,sendFn,preventDefault){let{keyCode}=event;if(keys[keyCode]){if(preventDefault&&event.preventDefault&&(keyCode<110||keyCode>123))event.preventDefault();keydownEventHandler(event,sendFn)}}var eventHandlers={contextmenu:preventDefaultHandler,mousedown:mouseEventHandler,mousemove:mouseEventHandler,mouseup:mouseEventHandler,pointerdown:mouseEventHandler,pointermove:mouseEventHandler,pointerup:mouseEventHandler,pointerlockchange:mouseEventHandler,webkitpointerlockchange:mouseEventHandler,focus:focusEventHandler,blur:focusEventHandler,pointerout:mouseEventHandler,touchstart:touchEventHandler,touchmove:touchEventHandler,touchend:touchEventHandler,wheel:wheelEventHandler,keydown:filteredKeydownEventHandler,keyup:filteredKeydownEventHandler};function initProxyElement(element,worker,id,preventDefault){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{if(!worker){handleProxyEvent(data,id)}else worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent,preventDefault)})}if(eventHandlers.keydown){globalThis.addEventListener("keydown",function(ev){eventHandlers.keydown(ev,sendEvent,preventDefault)})}if(eventHandlers.keyup){globalThis.addEventListener("keyup",function(ev){eventHandlers.keyup(ev,sendEvent,preventDefault)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher=class{__listeners;addEventListener(type,listener){if(this.__listeners===void 0)this.__listeners={};const listeners=this.__listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this.__listeners===void 0)return false;const listeners=this.__listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i2=0,l=array.length;i2<l;i2++){array[i2].call(this,event)}}}};function noop(){}var ElementProxyReceiver=class extends EventDispatcher{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super();this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.style.width=this.width+"px";this.proxied.style.height=this.height+"px";this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop;data.stopPropagation=noop;this.dispatchEvent(data,this.proxied)};focus(){}blur(){}};var ProxyManager=class{targets={};constructor(){if(!globalThis.document)globalThis.document={elementFromPoint:(...args)=>{return this.targets[Object.keys(this.targets)[0]].proxied}}}makeProxy=(id,addTo=void 0)=>{if(!id)id=\`proxyReceiver\${Math.floor(Math.random()*1e15)}\`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;if(typeof WorkerGlobalScope!=="undefined")addTo.style=proxy.style;if(proxy.width){addTo.style.width=proxy.width+"px";addTo.clientWidth=proxy.width}if(proxy.height){addTo.style.height=proxy.height+"px";addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy);addTo.blur=proxy.blur.bind(proxy)}};getProxy=id=>{return this.targets[id]};handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0}};function makeProxy(id,elm){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;this.__node.graph.ProxyManager.makeProxy(id,elm)}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;globalThis.ProxyManager.makeProxy(id,elm)}return id}function handleProxyEvent(data,id){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;if(this.__node.graph.ProxyManager.handleEvent(data,id))return data}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;if(globalThis.ProxyManager.handleEvent(data,id))return data}}var proxyElementWorkerRoutes={initProxyElement,makeProxy,handleProxyEvent};function Renderer(options){if(options.worker){let worker=options.worker;let route=options.route;if(worker instanceof Blob||typeof worker==="string"){worker=new Worker(worker)}delete options.worker;delete options.route;return transferCanvas(worker,options,route)}else{initProxyElement(options.canvas,void 0,options._id,options.preventDefault);return setupCanvas(options)}}function transferCanvas(worker,options,route){if(!options)return void 0;if(!options._id)options._id=\`canvas\${Math.floor(Math.random()*1e15)}\`;let offscreen=options.canvas.transferControlToOffscreen();if(!options.width)options.width=options.canvas.clientWidth;if(!options.height)options.height=options.canvas.clientHeight;let message={route:route?route:"setupCanvas",args:{...options,canvas:offscreen}};if(this?.__node?.graph)this.__node.graph.run("initProxyElement",options.canvas,worker,options._id,options.preventDefault);else initProxyElement(options.canvas,worker,options._id,options.preventDefault);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let tr=[offscreen];if(options.transfer){tr.push(...options.transfer);delete options.transfer}worker.postMessage(message,tr);const canvascontrols={_id:options._id,width:options.width,height:options.height,worker,draw:(props,transfer)=>{worker.postMessage({route:"drawFrame",args:[props,options._id]},transfer)},update:(props,transfer)=>{worker.postMessage({route:"updateCanvas",args:[props,options._id]},transfer)},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:(newDrawProps,transfer)=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]},transfer)},terminate:()=>{worker.terminate()}};return canvascontrols}function setDraw(settings,_id){let canvasopts;if(this?.__node?.graph){if(_id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]}else{if(_id)canvasopts=globalThis.CANVASES?.[settings._id];else if(settings._id)canvasopts=globalThis.CANVASES?.[settings._id];else canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]]}if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasopts._id,canvasopts.canvas);else proxyElementWorkerRoutes.makeProxy(canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText3(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw.bind(settings)}if(typeof settings.update==="string")settings.update=parseFunctionFromText3(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update.bind(settings)}if(typeof settings.init==="string")settings.init=parseFunctionFromText3(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init.bind(settings)}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText3(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear.bind(settings)}return settings._id}return void 0}function setupCanvas(options){if(this?.__node?.graph){if(!this.__node.graph.CANVASES)this.__node.graph.CANVASES={}}else if(!globalThis.CANVASES)globalThis.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=\`canvas\${Math.floor(Math.random()*1e15)}\`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this?.__node?.graph?.CANVASES[canvasOptions._id]){this.__node.graph.run("setDraw",canvasOptions)}else if(globalThis.CANVASES?.[canvasOptions._id]){setDraw(canvasOptions)}else{if(this?.__node?.graph){canvasOptions.graph=this.__node.graph;if(!canvasOptions.__node){canvasOptions.__node={}}if(!canvasOptions.__node.tag)canvasOptions.__node.tag=canvasOptions._id;canvasOptions=this.__node.graph.add(canvasOptions);canvasOptions.__addOndisconnected=()=>{canvasOptions.stop();delete this.__node.graph.CANVASES[canvasOptions._id]}}if(this?.__node?.graph)this.__node.graph.CANVASES[canvasOptions._id]=canvasOptions;else globalThis.CANVASES[canvasOptions._id]=canvasOptions;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);else proxyElementWorkerRoutes.makeProxy(canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText3(canvasOptions.draw)}else if(typeof canvasOptions.draw==="function"){canvasOptions.draw=canvasOptions.draw.bind(canvasOptions)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText3(canvasOptions.update)}else if(typeof canvasOptions.update==="function"){canvasOptions.update=canvasOptions.update.bind(canvasOptions)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText3(canvasOptions.init)}else if(typeof canvasOptions.init==="function"){canvasOptions.init=canvasOptions.init.bind(canvasOptions)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText3(canvasOptions.clear)}else if(typeof canvasOptions.clear==="function"){canvasOptions.clear=canvasOptions.clear.bind(canvasOptions)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);canvasOptions.stop=()=>{stopAnim(canvasOptions._id)};canvasOptions.start=draw=>{startAnim(canvasOptions._id,draw)};canvasOptions.set=settings=>{setDraw(settings,canvasOptions._id)};if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)return canvasOptions._id;else{const canvascontrols={_id:options._id,width:options.width,height:options.height,draw:props=>{drawFrame(props,options._id)},update:props=>{updateCanvas(props,options._id)},clear:()=>{clearCanvas(options._id)},init:()=>{initCanvas(options._id)},stop:()=>{stopAnim(options._id)},start:()=>{startAnim(options._id)},set:newDrawProps=>{setDraw(newDrawProps,options._id)},terminate:()=>{if(this.__node?.graph)this.__node.graph.remove(options._id);else{stopAnim(options._id);if(this?.__node?.graph)delete this.__node.graph.CANVASES[canvasOptions._id];else delete globalThis.CANVASES[canvasOptions._id]}}};return canvascontrols}}function drawFrame(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0}function clearCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function initCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function updateCanvas(input,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0}function setProps(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0}function startAnim(_id,draw){let canvasopts=getCanvas.call(this,_id);canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText3(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function stopAnim(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")requestAnimationFrame(canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context));return _id}return void 0}function getCanvas(_id){let canvasopts;if(this?.__node?.graph){if(!_id)canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]];else canvasopts=this.__node.graph.CANVASES?.[_id]}else{if(!_id)canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]];else canvasopts=globalThis.CANVASES?.[_id]}return canvasopts}var workerCanvasRoutes={...proxyElementWorkerRoutes,Renderer,transferCanvas,setupCanvas,setDraw,drawFrame,clearCanvas,initCanvas,updateCanvas,setProps,startAnim,stopAnim,getCanvas};function parseFunctionFromText3(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var _ArrayManip=class{constructor(){this.recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"){if(typeof target[key]==="object")this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target}}static autoscale(array,lineIdx=0,nLines=1,centerZero=false,ymin,ymax,clamp){if(array?.length===0)return array;let max=ymax?ymax:Math.max(...array);let min=ymin?ymin:Math.min(...array);let _lines=1/nLines;let scalar=1;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));if(absmax!==0)scalar=_lines/absmax;return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return y2*scalar+(_lines*(lineIdx+1)*2-1-_lines)})}else{if(max===min){if(max!==0){scalar=_lines/max}else if(min!==0){scalar=_lines/Math.abs(min)}}else scalar=_lines/(max-min);return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return 2*((y2-min)*scalar-1/(2*nLines))+(_lines*(lineIdx+1)*2-1-_lines)})}}static genTimestamps(ct,sps10){let now=Date.now();let toInterp=[now-ct*1e3/sps10,now];return _ArrayManip.upsample(toInterp,ct)}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i2=incr;i2<array.length;i2+=incr){let rounded=Math.round(i2);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static upsample(array,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array(fitCount);var springFactor=(array.length-1)/(fitCount-1);newData[0]=array[0];for(var i2=1;i2<fitCount-1;i2++){var tmp=i2*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i2]=linearInterpolate(array[before],array[after],atPoint)}newData[fitCount-1]=array[array.length-1];return newData}static interpolate(array,fitCount,scalar=1){if(array.length>fitCount){return _ArrayManip.downsample(array,fitCount,scalar)}else if(array.length<fitCount){return _ArrayManip.upsample(array,fitCount,scalar)}return array}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x;b=0}else if(60<=h&&h<120){r=x;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x}else if(180<=h&&h<240){r=0;g=x;b=c}else if(240<=h&&h<300){r=x;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static circularBuffer(arr,newEntries){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,newEntries.slice(len-newEntries.length))}else{arr.splice(0,arr.length,...newEntries)}return arr}static reformatData(data,key){if(Array.isArray(data)){if(Array.isArray(data[0])){let d={};data.forEach((arr,i2)=>{d[i2]=arr});data=d;if(isNaN(data[0][0]))return void 0}else if(key){data={[key]:data};if(isNaN(data[key][0]))return void 0}else{data={0:data};if(isNaN(data[0][0]))return void 0}}else if(typeof data==="object"){for(const key2 in data){if(typeof data[key2]==="number")data[key2]=[data[key2]];else if(data[key2]?.values){if(typeof data[key2].values==="number")data[key2].values=[data[key2].values]}if(isNaN(data[key2][0]))return void 0}}else if(typeof data==="string"){let split;if(data.includes("\\r\\n")){let lines=data.split("\\r\\n");data={};lines.forEach((l,j)=>{if(l.includes("	")){split=l.split("	")}else if(l.includes(",")){split=l.split(",")}else if(l.includes("|")){split=l.split("|")}if(Array.isArray(split)){split.forEach((val,i2)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl=parseFloat(v);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i2]=[fl];else return void 0}})}})}else if(data.includes("	")){split=data.split("	")}else if(data.includes(",")){split=data.split(",")}else if(data.includes("|")){split=data.split("|")}data={};if(Array.isArray(split)){split.forEach((val,i2)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl=parseFloat(v);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i2]=[fl];else return void 0}})}}else if(typeof data==="number"){if(key)data={[key]:[data]};else data={0:[data]}}return data}static padTime(data,lastValue,time,targetFit){let slopeIncr=(data[0]-lastValue)/time/targetFit;let padded=[...new Array(targetFit-data.length).map((_,i2)=>lastValue+slopeIncr*(i2+1)),...data];return padded}static interpolateForTime(data,time,targetSPS){return _ArrayManip.interpolate(data,Math.ceil(targetSPS*time))}isTypedArray(x){return ArrayBuffer.isView(x)&&Object.prototype.toString.call(x)!=="[object DataView]"}spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var ArrayManip=_ArrayManip;ArrayManip.bufferValues=(objects,property,keys2,buffer)=>{if(!Array.isArray(keys2)&&typeof keys2==="object")keys2=Object.keys(keys2);if(!buffer){let object_keys=Object.keys(objects);if(keys2)buffer=new Float32Array(object_keys.length*keys2.length);else{if(typeof objects[object_keys[0]][property]==="object"){keys2=Object.keys(objects[object_keys[0]][property]);buffer=new Float32Array(object_keys.length*keys2.length)}else buffer=new Float32Array(object_keys.length)}}let i2=0;for(const key in objects){if(objects[key][property]){if(keys2){for(let j=0;j<keys2.length;j++){buffer[i2]=objects[key][property][keys2[j]];i2++}}else{buffer[i2]=objects[key][property];i2++}}}return buffer};var rechk=/^([<>])?(([1-9]\\d*)?([xcbB?hHiIfdsp]))*$/;var refmt=/([1-9]\\d*)?([xcbB?hHiIfdsp])/g;var str=(v,o,c)=>String.fromCharCode(...new Uint8Array(v.buffer,v.byteOffset+o,c));var rts=(v,o,c,s)=>new Uint8Array(v.buffer,v.byteOffset+o,c).set(s.split("").map(str2=>str2.charCodeAt(0)));var pst=(v,o,c)=>str(v,o+1,Math.min(v.getUint8(o),c-1));var tsp=(v,o,c,s)=>{v.setUint8(o,s.length);rts(v,o+1,c-1,s)};var lut=le=>({x:c=>[1,c,0],c:c=>[c,1,o=>({u:v=>str(v,o,1),p:(v,c2)=>rts(v,o,1,c2)})],"?":c=>[c,1,o=>({u:v=>Boolean(v.getUint8(o)),p:(v,B2)=>v.setUint8(o,B2)})],b:c=>[c,1,o=>({u:v=>v.getInt8(o),p:(v,b)=>v.setInt8(o,b)})],B:c=>[c,1,o=>({u:v=>v.getUint8(o),p:(v,B2)=>v.setUint8(o,B2)})],h:c=>[c,2,o=>({u:v=>v.getInt16(o,le),p:(v,h)=>v.setInt16(o,h,le)})],H:c=>[c,2,o=>({u:v=>v.getUint16(o,le),p:(v,H2)=>v.setUint16(o,H2,le)})],i:c=>[c,4,o=>({u:v=>v.getInt32(o,le),p:(v,i2)=>v.setInt32(o,i2,le)})],I:c=>[c,4,o=>({u:v=>v.getUint32(o,le),p:(v,I)=>v.setUint32(o,I,le)})],f:c=>[c,4,o=>({u:v=>v.getFloat32(o,le),p:(v,f)=>v.setFloat32(o,f,le)})],d:c=>[c,8,o=>({u:v=>v.getFloat64(o,le),p:(v,d)=>v.setFloat64(o,d,le)})],s:c=>[1,c,o=>({u:v=>str(v,o,c),p:(v,s)=>rts(v,o,c,s.slice(0,c))})],p:c=>[1,c,o=>({u:v=>pst(v,o,c),p:(v,s)=>tsp(v,o,c,s.slice(0,c-1))})]});var errbuf=new RangeError("Structure larger than remaining buffer");var errval=new RangeError("Not enough values for structure");var _ByteParser=class extends ArrayManip{static toDataView(value){if(!(value instanceof DataView)){if(typeof value==="string"&&parseInt(value))value=parseInt(value);if(typeof value==="string"){let enc=new TextEncoder;let hascodes={};for(const code in _ByteParser.codes){while(value.indexOf(code)>-1){let idx=value.indexOf(code);value=value.replace(code,"");hascodes[idx]=code}}let encoded=Array.from(enc.encode(value));for(const key in hascodes){encoded.splice(parseInt(key),0,_ByteParser.codes[hascodes[key]])}value=new DataView(new Uint8Array(encoded).buffer)}else if(typeof value==="number"){let tmp=value;if(value<256){value=new DataView(new ArrayBuffer(1));value.setUint8(0,tmp)}else if(value<65536){value=new DataView(new ArrayBuffer(2));value.setInt16(0,tmp)}else{value=new DataView(new ArrayBuffer(4));value.setUint32(0,tmp)}}else if(value instanceof ArrayBuffer||typeof SharedArrayBuffer!=="undefined"&&value instanceof SharedArrayBuffer){value=new DataView(value)}else if(Array.isArray(value)){value=new DataView(Uint8Array.from(value).buffer)}else if(typeof value==="object"){value=new TextEncoder().encode(JSON.stringify(value))}}return value}static searchBuffer(buffer,searchString,limit){var needle=searchString;var haystack=buffer;var search=_ByteParser.boyerMoore(needle);var skip=search.byteLength;var indices=[];for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){indices.push(i2);if(limit){if(indices.length>=limit)break}}return indices}static bytesToInt16(x0,x1){let int16=(255&x0)<<8|255&x1;if((int16&32768)>0){int16|=4294901760}else{int16&=65535}return int16}static bytesToUInt16(x0,x1){return x0*256+x1}static Uint16ToBytes(y2){return[y2&255,y2>>8&255]}static bytesToInt24(x0,x1,x2){let int24=(255&x0)<<16|(255&x1)<<8|255&x2;if((int24&8388608)>0){int24|=4278190080}else{int24&=16777215}return int24}static bytesToUInt24(x0,x1,x2){return x0*65536+x1*256+x2}static Uint24ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255]}static bytesToInt32(x0,x1,x2,x3){let int32=(255&x0)<<24|(255&x1)<<16|(255&x2)<<8|255&x3;if((int32&2147483648)>0){int32|=0}else{int32&=4294967295}return int32}static bytesToUInt32(x0,x1,x2,x3){return x0*16777216+x1*65536+x2*256+x3}static Uint32ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255,y2>>24&255]}static get2sCompliment(val,nbits4){if(val>4294967296)return null;return val<<32-nbits4>>32-nbits4}static getSignedInt(...args){let pos=0;function getInt(size){var value=0;var first=true;while(size--){if(first){let byte=args[pos++];value+=byte&127;if(byte&128){value-=128}first=false}else{value*=256;value+=args[pos++]}}return value}return getInt(args.length)}static asUint8Array(input){if(input instanceof Uint8Array){return input}else if(typeof input==="string"){var arr=new Uint8Array(input.length);for(var i2=0;i2<input.length;i2++){var c=input.charCodeAt(i2);if(c>127){throw new TypeError("Only ASCII patterns are supported")}arr[i2]=c}return arr}else{return new Uint8Array(input)}}static boyerMoore(patternBuffer){var pattern=_ByteParser.asUint8Array(patternBuffer);var M=pattern.length;if(M===0){throw new TypeError("patternBuffer must be at least 1 byte long")}var R=256;var rightmost_positions=new Int32Array(R);for(var c=0;c<R;c++){rightmost_positions[c]=-1}for(var j=0;j<M;j++){rightmost_positions[pattern[j]]=j}var boyerMooreSearch=(txtBuffer,start,end)=>{var txt=_ByteParser.asUint8Array(txtBuffer);if(start===void 0)start=0;if(end===void 0)end=txt.length;var pat=pattern;var right=rightmost_positions;var lastIndex=end-pat.length;var lastPatIndex=pat.length-1;var skip;for(var i2=start;i2<=lastIndex;i2+=skip){skip=0;for(var j2=lastPatIndex;j2>=0;j2--){var c2=txt[i2+j2];if(pat[j2]!==c2){skip=Math.max(1,j2-right[c2]);break}}if(skip===0){return i2}}return-1};boyerMooreSearch.byteLength=pattern.byteLength;return boyerMooreSearch}static struct(format){let fns=[],size=0,m=rechk.exec(format);if(!m){throw new RangeError("Invalid format string")}const t2=lut("<"===m[1]),lu=(n,c)=>t2[c](n?parseInt(n,10):1);while(m=refmt.exec(format)){((r,s,f)=>{for(let i2=0;i2<r;++i2,size+=s){if(f){fns.push(f(size))}}})(...lu(...m.slice(1)))}const unpack_from=(arrb,offs)=>{if(arrb.byteLength<(offs|0)+size){throw errbuf}let v=new DataView(arrb,offs|0);return fns.map(f=>f.u(v))};const pack_into=(arrb,offs,...values)=>{if(values.length<fns.length){throw errval}if(arrb.byteLength<offs+size){throw errbuf}const v=new DataView(arrb,offs);new Uint8Array(arrb,offs,size).fill(0);fns.forEach((f,i2)=>f.p(v,values[i2]))};const pack=(...values)=>{let b=new ArrayBuffer(size);pack_into(b,0,...values);return b};const unpack=arrb=>unpack_from(arrb,0);function*iter_unpack(arrb){for(let offs=0;offs+size<=arrb.byteLength;offs+=size){yield unpack_from(arrb,offs)}}return Object.freeze({unpack,pack,unpack_from,pack_into,iter_unpack,format,size})}};var ByteParser=_ByteParser;ByteParser.codes={"\\\\n":10,"\\\\r":13,"\\\\t":9,"\\\\s":32,"\\\\b":8,"\\\\f":12,"\\\\":92};(function(s){var w,f={},l=console,m=Math,z2="postMessage",x="HackTimer.js by turuslan: ",v="Initialisation failed",p=0,r="hasOwnProperty",y2=[].slice,b=Worker;function d(){do{p=2147483647>p?p+1:0}while(f[r](p));return p}if(!/MSIE 10/i.test(navigator.userAgent)){try{s=URL.createObjectURL(new Blob(["var f={},p=postMessage,r='hasOwnProperty';onmessage=function(e){var d=e.data,i=d.i,t=d[r]('t')?d.t:0;switch(d.n){case'a':f[i]=setInterval(function(){p(i)},t);break;case'b':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case'c':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case'd':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch(e){}}if(typeof b!=="undefined"){try{w=new b(s);setInterval=function(c,t2){var i2=d();f[i2]={c,p:y2.call(arguments,2)};w[z2]({n:"a",i:i2,t:t2});return i2};clearInterval=function(i2){if(f[r](i2))delete f[i2],w[z2]({n:"b",i:i2})};setTimeout=function(c,t2){var i2=d();f[i2]={c,p:y2.call(arguments,2),t:true};w[z2]({n:"c",i:i2,t:t2});return i2};clearTimeout=function(i2){if(f[r](i2))delete f[i2],w[z2]({n:"d",i:i2})};w.onmessage=function(e){var i2=e.data,c,n;if(f[r](i2)){n=f[i2];c=n.c;if(n[r]("t"))delete f[i2]}if(typeof c=="string")try{c=new Function(c)}catch(k){l.log(x+"Error parsing callback code string: ",k)}if(typeof c=="function")c.apply(globalThis,n.p)};w.onerror=function(e){l.log(e)}}catch(e){l.log(x+v);l.error(e)}}else l.log(x+v+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js");var WebSerial=class extends ByteParser{constructor(){super(...arguments);this.streams={};this.createStream=options=>{let stream={_id:options._id?options._id:\`stream\${Math.floor(Math.random()*1e15)}\`,info:options.port.getInfo(),running:false,...options};if(options.port?.readable){if(options.transforms){stream.reader=WebSerial.setStreamTransforms(options.port.readable,options.transforms).getReader()}else{stream.reader=options.port.readable.getReader()}}this.streams[stream._id]=stream;return stream}}getPorts(){return navigator.serial.getPorts()}requestPort(usbVendorId,usbProductId){let options={};if(usbVendorId){options.usbVendorId=usbVendorId}if(usbProductId){options.usbProductId=usbProductId}if(options.usbVendorId)return navigator.serial.requestPort({filters:[options]});else return navigator.serial.requestPort()}openPort(port,options){if(options)options=Object.assign({},options);if(options?.ondisconnect){port.ondisconnect=options.ondisconnect;delete options.ondisconnect}return port.open(options).then(()=>{if(options?.onconnect)options.onconnect(port)})}async readWithTimeout(port,timeout){const reader=port.readable.getReader();const timer=setTimeout(()=>{reader.releaseLock()},timeout);const result=await reader.read();clearTimeout(timer);reader.releaseLock();return result}async writePort(port,message){const writer=port.writable.getWriter();await writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}getSignals(port){return port.getSignals()}setSignals(port,signals){return port.setSignals(signals)}readStream(stream){if(stream.reader&&!stream.running){let reader=stream.reader;if(stream.buffering){if(typeof stream.buffering!=="object")stream.buffering={};if(!stream.buffering.buffer){stream.buffering.buffer=[]}if(!stream.buffering.searchBytes)stream.buffering.searchBytes=new Uint8Array([13,10])}let readLoop=()=>{if(stream.port.readable&&stream.running){reader.read().then(result=>{if(result.done)reader.releaseLock();else{if(stream.buffering){stream.buffering.buffer.push(...result.value);const needle=stream.buffering.searchBytes;const haystack=stream.buffering.buffer;const search=WebSerial.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=stream.buffering.lockIdx??0;for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){if(!stream.buffering.locked&&!("lockIdx"in stream.buffering))used=stream.buffering.lockIdx=i2;else{nextIndex=i2;if(nextIndex>=0){const len=nextIndex-used;if(!stream.buffering.locked){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(data);stream.buffering.locked=true}else if(len>0){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(new Uint8Array(data))}used=nextIndex}}}}else stream.ondata(result.value);setTimeout(()=>{readLoop()},stream.frequency)}}).catch(er=>{console.error(stream._id," Read error:",er);if(er.message.includes("overrun")||er.message.includes("framing")){delete stream.reader;this.reconnect(stream)}})}else if(!stream.running&&stream.port.readable){try{reader.releaseLock()}catch(er){console.error(er)}}};stream.running=true;readLoop();return stream}return void 0}writeStream(stream,message){if(typeof stream==="string")stream=this.streams[stream];if(stream.port.writable){let writer=stream.port.writable.getWriter();writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}return void 0}closeStream(stream,onclose){if(typeof stream==="string")stream=this.streams[stream];stream.running=false;return new Promise((res,rej)=>{if(stream.settings.beforedisconnect){stream.settings.beforedisconnect(this,stream.port)}setTimeout(async()=>{if(stream.port.readable&&stream.reader){try{stream.reader.releaseLock()}catch(er){console.error(er)}if(stream.transforms)try{await stream.reader.cancel()}catch(err){console.error(err)}}try{await stream.port.close().then(()=>{if(onclose)onclose(this.streams[stream._id])});delete this.streams[stream._id];res(true)}catch(er){rej(er)}},300)})}reconnect(stream,options){if(typeof stream==="string")stream=this.streams[stream];return new Promise((res,rej)=>{if(typeof stream!=="object"){rej(void 0);return}let info=stream.port.getInfo();this.closeStream(stream._id).then(closed=>{setTimeout(()=>{this.getPorts().then(ports=>{for(let i2=0;i2<ports.length;i2++){if(ports[i2].getInfo().usbVendorId===info.usbVendorId&&ports[i2].getInfo().usbProductId===info.usbProductId){if(!options)options=stream;else options._id=stream._id;delete options.port;this.openPort(ports[i2],options.settings).then(()=>{const stream2=this.createStream({...options,port:ports[i2]});this.readStream(stream2);res(stream2)}).catch(rej)}}}).catch(rej)},100)})})}static setStreamTransforms(stream,transforms){let transform=[];Object.keys(transforms).forEach(t2=>{let opt=transforms[t2];if(opt instanceof TransformStream){transform.push(opt)}else{if(!opt.start)opt.start=function start(){};if(!opt.flush)opt.flush=function flush(){};let transformer=new TransformStream({start:opt.start,transform:opt.transform,flush:opt.flush},opt.writableStrategy,opt.readableStrategy);transform.push(transformer)}});let str2=stream;transform.forEach(transform2=>{str2=str2.pipeThrough(transform2)});return str2}};var sps=250;var gain=32;var nbits=24;var vref=1.2;var half24bit=Math.pow(2,24)/2;function ads131m08codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i2=0;i2<9;i2++){let j=i2*25;output[0][i2]=ByteParser.bytesToInt24(arr[j],arr[j+1],arr[j+2]);output[1][i2]=ByteParser.bytesToInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i2]=ByteParser.bytesToInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i2]=ByteParser.bytesToInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i2]=ByteParser.bytesToInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i2]=ByteParser.bytesToInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i2]=ByteParser.bytesToInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i2]=ByteParser.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])}if(arr.length>225){output.leds=arr.slice(225)}return output}function ads131m08codec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i2=0;i2<9;i2++){let j=i2*25;output[0][i2]=ByteParser.bytesToInt24(arr[j],arr[j+1],arr[j+2])+half24bit;output[1][i2]=ByteParser.bytesToInt24(arr[j+3],arr[j+4],arr[j+5])+half24bit;output[2][i2]=ByteParser.bytesToInt24(arr[j+6],arr[j+7],arr[j+8])+half24bit;output[3][i2]=ByteParser.bytesToInt24(arr[j+9],arr[j+10],arr[j+11])+half24bit;output[4][i2]=ByteParser.bytesToInt24(arr[j+12],arr[j+13],arr[j+14])+half24bit;output[5][i2]=ByteParser.bytesToInt24(arr[j+15],arr[j+16],arr[j+17])+half24bit;output[6][i2]=ByteParser.bytesToInt24(arr[j+18],arr[j+19],arr[j+20])+half24bit;output[7][i2]=ByteParser.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])+half24bit}if(arr.length>225){output.leds=arr.slice(225)}return output}var decoder=new TextDecoder;function ads131m08_arduinocodec(data){const parsed=decoder.decode(data);let split;if(parsed.includes("|"))split=parsed.split("|");else if(split.includes(","))split=parsed.split(",");else split=parsed.split("	");return{"0":parseInt(split[0]),"1":parseInt(split[1]),"2":parseInt(split[2]),"3":parseInt(split[3]),"4":parseInt(split[4]),"5":parseInt(split[5]),"6":parseInt(split[6]),"7":parseInt(split[7]),timestamp:Date.now()}}var defaultChartSetting={nSec:10,sps,units:"mV"};var ads131m08ChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting)),"1":JSON.parse(JSON.stringify(defaultChartSetting)),"2":JSON.parse(JSON.stringify(defaultChartSetting)),"3":JSON.parse(JSON.stringify(defaultChartSetting)),"4":JSON.parse(JSON.stringify(defaultChartSetting)),"5":JSON.parse(JSON.stringify(defaultChartSetting)),"6":JSON.parse(JSON.stringify(defaultChartSetting)),"7":JSON.parse(JSON.stringify(defaultChartSetting))}};var defaultsetting={sps,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))};var halfOffset=.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))*(Math.pow(2,nbits)-1)*.5;var ads131m08FilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting)),"1":JSON.parse(JSON.stringify(defaultsetting)),"2":JSON.parse(JSON.stringify(defaultsetting)),"3":JSON.parse(JSON.stringify(defaultsetting)),"4":JSON.parse(JSON.stringify(defaultsetting)),"5":JSON.parse(JSON.stringify(defaultsetting)),"6":JSON.parse(JSON.stringify(defaultsetting)),"7":JSON.parse(JSON.stringify(defaultsetting))};var accScale=.002/Math.pow(2,4);var getAcc=(arr,output,channels=8)=>{const accIdx=channels*3+1;const sum=(a,b)=>a+b;const accSum=arr.slice(accIdx).reduce(sum,0);if(accSum!==0){output.ax=accScale*ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output.ay=accScale*ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output.az=accScale*ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5])}};function cytoncodec(data){let arr;if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<8;i2++){let idx=1+3*i2;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);output.timestamp=Date.now();return output}function daisycytoncodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<8;i2++){let idx=1+3*i2;if(arr[0]%2===0)output[i2+7]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2]);else output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);return output}var sps2=250;var cytonSerialSettings={deviceType:"USB",deviceName:"cyton",baudRate:115200,codec:cytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var daisycytonSerialSettings={deviceType:"USB",deviceName:"cyton_daisy",baudRate:115200,codec:daisycytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var defaultChartSetting2={nSec:10,sps:sps2,units:"mV"};var defaultChartSetting22={nSec:10,sps:sps2};var cytonChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting2)),"1":JSON.parse(JSON.stringify(defaultChartSetting2)),"2":JSON.parse(JSON.stringify(defaultChartSetting2)),"3":JSON.parse(JSON.stringify(defaultChartSetting2)),"4":JSON.parse(JSON.stringify(defaultChartSetting2)),"5":JSON.parse(JSON.stringify(defaultChartSetting2)),"6":JSON.parse(JSON.stringify(defaultChartSetting2)),"7":JSON.parse(JSON.stringify(defaultChartSetting2)),"ax":JSON.parse(JSON.stringify(defaultChartSetting22)),"ay":JSON.parse(JSON.stringify(defaultChartSetting22)),"az":JSON.parse(JSON.stringify(defaultChartSetting22))},generateNewLines:true};var defaultsetting2={sps:sps2,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))};var cytonFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting2)),"1":JSON.parse(JSON.stringify(defaultsetting2)),"2":JSON.parse(JSON.stringify(defaultsetting2)),"3":JSON.parse(JSON.stringify(defaultsetting2)),"4":JSON.parse(JSON.stringify(defaultsetting2)),"5":JSON.parse(JSON.stringify(defaultsetting2)),"6":JSON.parse(JSON.stringify(defaultsetting2)),"7":JSON.parse(JSON.stringify(defaultsetting2)),"8":JSON.parse(JSON.stringify(defaultsetting2)),"9":JSON.parse(JSON.stringify(defaultsetting2)),"10":JSON.parse(JSON.stringify(defaultsetting2)),"11":JSON.parse(JSON.stringify(defaultsetting2)),"12":JSON.parse(JSON.stringify(defaultsetting2)),"13":JSON.parse(JSON.stringify(defaultsetting2)),"14":JSON.parse(JSON.stringify(defaultsetting2)),"15":JSON.parse(JSON.stringify(defaultsetting2))};function freeeeg128codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<128;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=385;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps3=250;var freeeeg128SerialSettings={deviceType:"USB",deviceName:"freeeeg128",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg128codec,sps:sps3,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg128ChartSettings={lines:{"ax":{nSec:10,sps:sps3},"ay":{nSec:10,sps:sps3},"az":{nSec:10,sps:sps3},"gx":{nSec:10,sps:sps3},"gy":{nSec:10,sps:sps3},"gz":{nSec:10,sps:sps3}}};var freeeeg128FilterSettings={};for(let i2=0;i2<128;i2++){freeeeg128ChartSettings.lines[i2]={sps:sps3,nSec:10,units:"mV"};freeeeg128FilterSettings[i2]={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))}}function freeeeg32codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<32;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=97;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps4=512;var freeeeg32SerialSettings={deviceType:"USB",deviceName:"freeeeg32",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg32_optical_SerialSettings={deviceType:"USB",deviceName:"freeeeg32_optical",baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting3={nSec:10,sps:sps4};var freeeeg32ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting3)),"ay":JSON.parse(JSON.stringify(defaultChartSetting3)),"az":JSON.parse(JSON.stringify(defaultChartSetting3)),"gx":JSON.parse(JSON.stringify(defaultChartSetting3)),"gy":JSON.parse(JSON.stringify(defaultChartSetting3)),"gz":JSON.parse(JSON.stringify(defaultChartSetting3))}};var freeeeg32FilterSettings={};for(let i2=0;i2<32;i2++){freeeeg32ChartSettings.lines[i2]={sps:sps4,nSec:10,units:"mV"};freeeeg32FilterSettings[i2]={sps:sps4,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))}}function freeeeg16codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<16;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var BLEBuffer=[];var locked;var lockIdx;function freeeeg16BLEcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;BLEBuffer.push(...data);const needle=new Uint8Array([192,160]);const haystack=BLEBuffer;const search=ByteParser.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=lockIdx??0;let pass=false;for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){if(!locked&&!(typeof lockIdx==="number"))used=lockIdx=i2;else{nextIndex=i2;if(nextIndex>=0){const len=nextIndex-used;if(!lockIdx){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true;locked=true}else if(len>0){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true}used=nextIndex}}}if(pass){let output={};for(let i3=0;i3<16;i3++){let idx=i3*3+1;output[i3]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}else return void 0}var sps5=250;var freeeeg16BLESettings={deviceType:"BLE",deviceName:"freeeeg16",services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:void 0},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:freeeeg16BLEcodec,sps:sps5}}}};var freeeeg16SerialSettings={deviceType:"USB",deviceName:"freeeeg16",baudRate:115200,bufferSize:2e3,frequency:3.5,codec:freeeeg16codec,sps:sps5,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting4={nSec:10,sps:sps5};var freeeeg16ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting4)),"ay":JSON.parse(JSON.stringify(defaultChartSetting4)),"az":JSON.parse(JSON.stringify(defaultChartSetting4)),"gx":JSON.parse(JSON.stringify(defaultChartSetting4)),"gy":JSON.parse(JSON.stringify(defaultChartSetting4)),"gz":JSON.parse(JSON.stringify(defaultChartSetting4))}};var freeeeg16FilterSettings={};var gain2=32;var nbits2=24;var vref2=1.2;for(let i2=0;i2<16;i2++){freeeeg16ChartSettings.lines[i2]={sps:sps5,nSec:10,units:"mV"};freeeeg16FilterSettings[i2]={sps:sps5,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref2/(gain2*(Math.pow(2,nbits2)-1))}}var textdecoder=new TextDecoder;function hegduinocodec(value){let output={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0};let txt=textdecoder.decode(value);let line=txt.split("|");if(line.length===3){output.timestamp=Date.now();output.red=parseInt(line[0]);output.infrared=parseInt(line[1]);output.heg=parseFloat(line[2])}else if(line.length>=2){output.timestamp=Date.now();output.red=parseInt(line[1]);output.infrared=parseInt(line[2]);output.heg=parseFloat(line[3]);if(line[4])output.ambient=parseFloat(line[4]);if(line[5])output.temperature=parseFloat(line[5]);return output}else return txt}var sps6=40;var hegduinoSerialSettings={deviceType:"USB",deviceName:"hegduino",baudRate:115200,write:"t\\n",codec:hegduinocodec,sps:sps6};var hegduinoV1SerialSettings=Object.assign({},hegduinoSerialSettings);hegduinoV1SerialSettings.sps=19;var hegduinoBLESettings={deviceType:"BLE",deviceName:"hegduino",sps:sps6,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:hegduinocodec,sps:sps6}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};var hegduinoV1BLESettings=Object.assign({},hegduinoSerialSettings);hegduinoV1BLESettings.sps=19;function max3010xcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let pktCt=32;const output={"red":new Array(pktCt),"ir":new Array(pktCt),"max_dietemp":ByteParser.get2sCompliment(arr[193],8)+.0625*arr[194],"timestamp":Date.now()};let i2=0;while(i2<pktCt){let idx=i2*6;if(i2%2===0){output["ir"][i2]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["ir"][i2+1]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}else{output["red"][i2-1]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["red"][i2]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}i2++}return output}function mpu6050codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={"ax":new Array(20),"ay":new Array(20),"az":new Array(20),"gx":new Array(20),"gy":new Array(20),"gz":new Array(20),"mpu_dietemp":(ByteParser.bytesToInt16(arr[241],arr[242])+521)/340+35,timestamp:Date.now()};for(let i2=0;i2<20;i2++){let idx=i2*12;output.ax[i2]=ByteParser.bytesToInt16(arr[idx+1],arr[idx+2]);output.ay[i2]=ByteParser.bytesToInt16(arr[idx+3],arr[idx+4]);output.az[i2]=ByteParser.bytesToInt16(arr[idx+5],arr[idx+6]);output.gx[i2]=ByteParser.bytesToInt16(arr[idx+7],arr[idx+8]);output.gy[i2]=ByteParser.bytesToInt16(arr[idx+9],arr[idx+10]);output.gz[i2]=ByteParser.bytesToInt16(arr[idx+11],arr[idx+12])}return output}function cognixionONE_EEG_codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let i2=0;i2<7;i2++){let j=i2*26+1;if(!arr[j+23])break;output[0][i2]=ByteParser.bytesToUInt24(arr[j],arr[j+1],arr[j+2]);output[1][i2]=ByteParser.bytesToUInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i2]=ByteParser.bytesToUInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i2]=ByteParser.bytesToUInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i2]=ByteParser.bytesToUInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i2]=ByteParser.bytesToUInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i2]=ByteParser.bytesToUInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i2]=ByteParser.bytesToUInt24(arr[j+21],arr[j+22],arr[j+23])}return output}var sps7=250;var cognixionONEBLESettings={deviceType:"BLE",deviceName:"cognixionONE",services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:true,notifyCallback:void 0,codec:cognixionONE_EEG_codec,sps:sps7}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:true}}},sps:sps7};var cognixionONESerialSettings=Object.assign({},cytonSerialSettings);cognixionONESerialSettings.sps=sps7;cognixionONESerialSettings.deviceName="cognixionONE";var defaultChartSetting5={nSec:10,sps:sps7,units:"mV"};var cognixionONEChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting5)),"1":JSON.parse(JSON.stringify(defaultChartSetting5)),"2":JSON.parse(JSON.stringify(defaultChartSetting5)),"3":JSON.parse(JSON.stringify(defaultChartSetting5)),"4":JSON.parse(JSON.stringify(defaultChartSetting5)),"5":JSON.parse(JSON.stringify(defaultChartSetting5)),"6":JSON.parse(JSON.stringify(defaultChartSetting5)),"7":JSON.parse(JSON.stringify(defaultChartSetting5))}};var PeanutCodes={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function peanutcodec(data){let result={};let i2=0;while(i2<data.length){if(PeanutCodes[data[i2]]&&i2+1+PeanutCodes[data[i2]].byteLength<=data.length){let slice=data.slice(i2+1,i2+1+PeanutCodes[data[i2]].byteLength).buffer;let unpacked=ByteParser.struct(PeanutCodes[data[i2]].format).unpack(slice);let code=PeanutCodes[data[i2]].type;if(code==="unfilteredHEG"||code==="heg")unpacked=unpacked[0]/256;else if(code==="POOR_SIGNAL"||code==="sampleNumber"||code==="debug0"||code==="debug1"||code==="debug2"||code==="debug3")unpacked=unpacked[0];if(!result[PeanutCodes[data[i2]].type]){if(Array.isArray(unpacked))result[PeanutCodes[data[i2]].type]=unpacked;else result[PeanutCodes[data[i2]].type]=[unpacked]}else{if(Array.isArray(unpacked))result[PeanutCodes[data[i2]].type].push(...unpacked);else result[PeanutCodes[data[i2]].type].push(unpacked)}i2+=PeanutCodes[data[i2]].byteLength+1}else i2++}result.timestamp=Date.now();return result}var peanutSerialSettings={deviceType:"USB",deviceName:"peanut",baudRate:38400,bufferSize:400,write:"protocol 3\\n",buffering:{searchBytes:new Uint8Array([170,170])},codec:peanutcodec,sps:10.101};var sealevel_hpa=1013.25;var bme280codec=data=>{let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={timestamp:Date.now(),temp:[],pressure:[],altitude:[]};let mode=0;if(arr[0].length===74)mode=1;if(!mode){for(let j=0;j<3;j++){let i2=j*16+2;let tint=ByteParser.bytesToInt32(arr[3+i2],arr[2+i2],arr[1+i2],arr[0+i2]);let tfrac=ByteParser.bytesToInt32(arr[7+i2],arr[6+i2],arr[5+i2],arr[4+i2]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser.bytesToInt32(arr[11+i2],arr[10+i2],arr[9+i2],arr[8+i2]);let pfrac=ByteParser.bytesToInt32(arr[15+i2],arr[14+i2],arr[13+i2],arr[12+i2]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}else{output.humidity=[];for(let j=0;j<3;j++){let i2=j*24+2;let tint=ByteParser.bytesToInt32(arr[3+i2],arr[2+i2],arr[1+i2],arr[0+i2]);let tfrac=ByteParser.bytesToInt32(arr[7+i2],arr[6+i2],arr[5+i2],arr[4+i2]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser.bytesToInt32(arr[11+i2],arr[10+i2],arr[9+i2],arr[8+i2]);let pfrac=ByteParser.bytesToInt32(arr[15+i2],arr[14+i2],arr[13+i2],arr[12+i2]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));let hint=ByteParser.bytesToInt32(arr[19+i2],arr[18+i2],arr[17+i2],arr[16+i2]);let hfrac=ByteParser.bytesToInt32(arr[23+i2],arr[22+i2],arr[21+i2],arr[20+i2]);output.humidity.push(hint+hfrac/Math.pow(10,Math.ceil(Math.log10(hfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}return output};function altitude(pressure,temperature){return 44330*(1-Math.pow(pressure/sealevel_hpa,.1903))}function nrf5x_usbcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i2)=>{output[i2+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec(arr.subarray(2))))}return output}function nrf5x_usbcodec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec_singleended(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i2)=>{output[i2+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec_singleended(arr.subarray(2))))}return output}var nrf5xSerialSettings={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec,sps:250};var nrf5xSerialSettings_singleended={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec_singleended,sps:250};var nrf5xBLESettings={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var nrf5xBLESettings_singleended={deviceType:"BLE",deviceName:"nrf5x_singleended",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var defaultChartSetting6={nSec:10,sps:250,units:"mV"};var nrf5x_usbChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting6)),"1":JSON.parse(JSON.stringify(defaultChartSetting6)),"2":JSON.parse(JSON.stringify(defaultChartSetting6)),"3":JSON.parse(JSON.stringify(defaultChartSetting6)),"4":JSON.parse(JSON.stringify(defaultChartSetting6)),"5":JSON.parse(JSON.stringify(defaultChartSetting6)),"6":JSON.parse(JSON.stringify(defaultChartSetting6)),"7":JSON.parse(JSON.stringify(defaultChartSetting6))},generateNewLines:true,cleanGeneration:false};var gain3=32;var nbits3=24;var vref3=1.2;var defaultsetting3={sps:250,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref3/(gain3*(Math.pow(2,nbits3)-1))};var nrf5x_usbFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting3)),"1":JSON.parse(JSON.stringify(defaultsetting3)),"2":JSON.parse(JSON.stringify(defaultsetting3)),"3":JSON.parse(JSON.stringify(defaultsetting3)),"4":JSON.parse(JSON.stringify(defaultsetting3)),"5":JSON.parse(JSON.stringify(defaultsetting3)),"6":JSON.parse(JSON.stringify(defaultsetting3)),"7":JSON.parse(JSON.stringify(defaultsetting3)),"8":JSON.parse(JSON.stringify(defaultsetting3)),"9":JSON.parse(JSON.stringify(defaultsetting3)),"10":JSON.parse(JSON.stringify(defaultsetting3)),"11":JSON.parse(JSON.stringify(defaultsetting3)),"12":JSON.parse(JSON.stringify(defaultsetting3)),"13":JSON.parse(JSON.stringify(defaultsetting3)),"14":JSON.parse(JSON.stringify(defaultsetting3)),"15":JSON.parse(JSON.stringify(defaultsetting3))};var textdecoder2=new TextDecoder;function statechangercodec(value){let output={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0};let txt=textdecoder2.decode(value);let line=txt.split("|");if(line.length>=5){output.timestamp=Date.now();output.left_red=parseInt(line[1]);output.left_infrared=parseInt(line[2]);output.left_heg=parseFloat(line[3]);output.center_red=parseInt(line[4]);output.center_infrared=parseInt(line[5]);output.center_heg=parseFloat(line[6]);output.right_red=parseInt(line[7]);output.right_infrared=parseInt(line[8]);output.right_heg=parseFloat(line[9]);return output}else return txt}var statechangerSerialSettings={deviceType:"USB",deviceName:"statechanger",baudRate:115200,codec:statechangercodec,sps:20};var statechangerBLESettings={deviceType:"BLE",deviceName:"statechanger",sps:20,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:statechangercodec}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};function blueberrycodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.red/(.5*(output.ir+output.ir2));return output}var sps8=40;var blueberryBLESettings={deviceType:"BLE",deviceName:"blueberry",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:true,notifyCallback:void 0,codec:blueberrycodec,sps:sps8}}},sps:sps8};function blueberryshortcodec(value){let output={sred:value.getInt32(2),sir:value.getInt32(6),sir2:value.getInt32(10),timestamp:Date.now()};output.sheg=output.sred/(.5*(output.sir+output.sir2));return output}function blueberrylongcodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.sred/(.5*(output.ir+output.ir2));return output}var sps9=40;var blueberry2BLESettings={deviceType:"BLE",deviceName:"blueberry2",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:true,notifyCallback:void 0,codec:blueberrylongcodec,sps:sps9},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:true,notifyCallback:void 0,codec:blueberryshortcodec,sps:sps9}}},sps:sps9};function hrcodec(data){return{hr:data.getInt8(1),timestamp:Date.now()}}var heartRateBLESettings={deviceType:"BLE",deviceName:"heartrate",services:{"heart_rate":{"heart_rate_measurement":{notify:true,notifyCallback:void 0,codec:hrcodec}}}};var simulatorSettings={sps:250,deviceType:"CUSTOM",deviceName:"simulator",simulate:{"0":{sps:250,freq:1,amplitude:1,offset:0},"1":{sps:250,freq:10,amplitude:1,offset:0},"2":{sps:250,freq:100,amplitude:.5,offset:.5},"3":{sps:250,freq:25,amplitude:1,offset:0}},connect:(settings={})=>{return new Promise(async(res,rej)=>{let _id=\`simulated\${Math.floor(Math.random()*1e15)}\`;let info={_id,settings:Object.assign(Object.assign({},simulatorSettings),settings)};info.settings.looping=true;let loopTime=50;let lastTime=Date.now();let loop2=()=>{if(info.settings.looping){let newData={};let now=Date.now();let frame=now-lastTime;for(const key in info.settings.simulate){let newPoints=Math.floor(info.settings.simulate[key].sps*frame/1e3);newData[key]=new Array(newPoints).fill(0);newData[key]=newData[key].map((v,i2)=>{return Math.sin(2*Math.PI*info.settings.simulate[key].freq*.001*(lastTime+frame*(i2+1)/newPoints))*info.settings.simulate[key].amplitude+info.settings.simulate[key].offset})}lastTime=now;newData.timestamp=lastTime;info.settings.ondata(newData);setTimeout(()=>{loop2()},loopTime)}};loop2();if(info.settings.onconnect)info.settings.onconnect(info);res(info)})},codec:reading=>{return reading},disconnect:info=>{console.log(info);info.settings.looping=false;info.settings.ondisconnect(info)},onconnect:info=>{console.log("simulator connected!",info)},ondisconnect:info=>{console.log("simulator disconnected!",info)},ondata:data=>{}};var BiquadChannelFilterer=class{constructor(options={sps:512,useSMA4:false,useNotch50:true,useNotch60:true,useLowpass:false,lowpassHz:100,useBandpass:false,bandpassLower:3,bandpassUpper:45,useDCBlock:true,DCBresonance:.995,trimOutliers:false,outlierTolerance:.2,useScaling:false,scalar:1}){this.idx=0;this.sps=options.sps;this.bandpassLower=options.bandpassLower?options.bandpassLower:3;this.bandpassUpper=options.bandpassUpper?options.bandpassUpper:45;this.useSMA4=options.useSMA4;this.last4=[];this.useNotch50=options.useNotch50;this.useNotch60=options.useNotch60;this.useLowpass=options.useLowpass;this.lowpassHz=options.lowpassHz?options.lowpassHz:100;this.useBandpass=options.useBandpass;this.useDCBlock=options.useDCBlock;this.DCBresonance=options.DCBresonance?options.DCBresonance:.995;this.useScaling=options.useScaling;this.scalar=options.scalar;this.trimOutliers=options.trimOutliers;this.outlierTolerance=options.outlierTolerance;let sps10=this.sps;this.notch50=[makeNotchFilter(50,sps10,2),makeNotchFilter(100,sps10,2)];this.notch60=[makeNotchFilter(60,sps10,2),makeNotchFilter(120,sps10,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1)];this.dcb=new DCBlocker(options.DCBresonance?options.DCBresonance:.995)}reset(sps10=this.sps){this.notch50=[makeNotchFilter(50,sps10,2),makeNotchFilter(100,sps10,2)];this.notch60=[makeNotchFilter(60,sps10,2),makeNotchFilter(120,sps10,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1)];this.dcb=new DCBlocker(this.DCBresonance)}setBandpass(bandpassLower=this.bandpassLower,bandpassUpper=this.bandpassUpper,sps10=this.sps){this.bandpassLower=bandpassLower;this.bandpassUpper=bandpassUpper;this.bp1=[makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10)]}apply(latestData=0){let out=latestData;if(this.useScaling===true){out*=this.scalar}if(this.filtered&&this.trimOutliers&&this.outlierTolerance){if(Math.abs(out-this.filtered)>this.outlierTolerance){out=this.filtered}}if(this.useDCBlock===true){out=this.dcb.applyFilter(out)}if(this.useSMA4===true){if(this.last4.length<4){this.last4.push(out)}else{out=this.last4.reduce((accumulator,currentValue)=>accumulator+currentValue)/this.last4.length;this.last4.shift();this.last4.push(out)}}if(this.useNotch50===true){this.notch50.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useNotch60===true){this.notch60.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useLowpass===true){this.lp1.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useBandpass===true){this.bp1.forEach((f,i2)=>{out=f.applyFilter(out)})}this.filtered=out;this.idx++;return out}};var Biquad=class{constructor(type,freq,sps10,Q=1/Math.sqrt(2),dbGain=0){this.a0=0;this.a1=0;this.a2=0;this.b0=0;this.b1=0;this.b2=0;this.x1=0;this.x2=0;this.y1=0;this.y2=0;let types=["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"];if(types.indexOf(type)<0){console.error("Valid types: 'lowpass','highpass','bandpass','notch','peak','lowshelf','highshelf'");return}this.type=type;this.freq=freq;this.sps=sps10;this.Q=Q;this.dbGain=dbGain;let A2=Math.pow(10,dbGain/40);let omega=2*Math.PI*freq/sps10;let sn=Math.sin(omega);let cs=Math.cos(omega);let alpha=sn/(2*Q);let beta=Math.sqrt(A2+A2);this[type](A2,sn,cs,alpha,beta);this.b0/=this.a0;this.b1/=this.a0;this.b2/=this.a0;this.a1/=this.a0;this.a2/=this.a0}lowpass(A2,sn,cs,alpha,beta){this.b0=(1-cs)*.5;this.b1=1-cs;this.b2=(1-cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}highpass(A2,sn,cs,alpha,beta){this.b0=(1+cs)*.5;this.b1=-(1+cs);this.b2=(1+cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}bandpass(A2,sn,cs,alpha,beta){this.b0=alpha;this.b1=0;this.b2=-alpha;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}notch(A2,sn,cs,alpha,beta){this.b0=1;this.b1=-2*cs;this.b2=1;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}peak(A2,sn,cs,alpha,beta){this.b0=1+alpha*A2;this.b1=-2*cs;this.b2=1-alpha*A2;this.a0=1+alpha/A2;this.a1=-2*cs;this.a2=1-alpha/A2}lowshelf(A2,sn,cs,alpha,beta){this.b0=A2*(A2+1-(A2-1)*cs+beta*sn);this.b1=2*A2*(A2-1-(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn);this.a0=A2+1+(A2+1)*cs+beta*sn;this.a1=2*(A2-1+(A2+1)*cs);this.a2=A2+1+(A2-1)*cs-beta*sn}highshelf(A2,sn,cs,alpha,beta){this.b0=A2*(A2+1+(A2-1)*cs+beta*sn);this.b1=2*A2*(A2-1+(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn);this.a0=A2+1-(A2+1)*cs-beta*sn;this.a1=2*(A2-1-(A2+1)*cs);this.a2=A2+1-(A2-1)*cs-beta*sn}applyFilter(signal_step){let y2=this.b0*signal_step+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;this.x2=this.x1;this.x1=signal_step;this.y2=this.y1;this.y1=y2;return y2}zResult(freq){try{let phi=Math.pow(Math.sin(Math.PI*freq*2/(2*this.sps)),2);let result=(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*phi+16*this.b0*this.b2*phi*phi)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*phi+16*this.a2*phi*phi);return result}catch(err){return-200}}static calcCenterFrequency(freqStart,freqEnd){return(freqStart+freqEnd)/2}static calcBandwidth(freqStart,freqEnd){return freqEnd-this.calcCenterFrequency(freqStart,freqEnd)}static calcBandpassQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*Math.sqrt((frequency-bandwidth)*(frequency+bandwidth))/(2*bandwidth);return Q}static calcNotchQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*frequency*bandwidth/Math.sqrt((frequency-bandwidth)*(frequency+bandwidth));return Q}};var DCBlocker=class{constructor(r=.995){this.r=r;this.y1=this.y2=this.x1=this.x2=0}applyFilter(signal_step){this.x2=this.x1;this.x1=signal_step;let y2=this.x1-this.x2+this.r*this.y1;this.y2=this.y1;this.y1=y2;return y2}};var makeNotchFilter=(frequency,sps10,bandwidth)=>{return new Biquad("notch",frequency,sps10,Biquad.calcNotchQ(frequency,bandwidth),0)};var makeBandpassFilter=(freqStart,freqEnd,sps10,resonance=Math.pow(10,Math.floor(Math.log10(Biquad.calcCenterFrequency(freqStart,freqEnd)))))=>{return new Biquad("bandpass",Biquad.calcCenterFrequency(freqStart,freqEnd),sps10,Biquad.calcBandpassQ(Biquad.calcCenterFrequency(freqStart,freqEnd),Biquad.calcBandwidth(freqStart,freqEnd),resonance),0)};var defaultsetting1={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var ganglionFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting1)),"1":JSON.parse(JSON.stringify(defaultsetting1)),"2":JSON.parse(JSON.stringify(defaultsetting1)),"3":JSON.parse(JSON.stringify(defaultsetting1))};var defaultChartSetting7={nSec:10,sps:250,units:"mV"};var ganglionChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting7)),"1":JSON.parse(JSON.stringify(defaultChartSetting7)),"2":JSON.parse(JSON.stringify(defaultChartSetting7)),"3":JSON.parse(JSON.stringify(defaultChartSetting7)),"ax":{nSec:10,sps:250,units:"mg"},"ay":{nSec:10,sps:250,units:"mg"},"az":{nSec:10,sps:250,units:"mg"}},generateNewLines:true};var defaultsetting4={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var museFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting4)),"1":JSON.parse(JSON.stringify(defaultsetting4)),"2":JSON.parse(JSON.stringify(defaultsetting4)),"3":JSON.parse(JSON.stringify(defaultsetting4)),"4":JSON.parse(JSON.stringify(defaultsetting4))};var Devices={BLE:{"nrf5x":nrf5xBLESettings,"nrf5x_singleended":nrf5xBLESettings_singleended,"hegduino":hegduinoBLESettings,"hegduinoV1":hegduinoV1BLESettings,"cognixionONE":cognixionONEBLESettings,"statechanger":statechangerBLESettings,"blueberry":blueberryBLESettings,"blueberry2":blueberry2BLESettings,"heart_rate":heartRateBLESettings,"freeEEG16":freeeeg16BLESettings},USB:{"nrf5x":nrf5xSerialSettings,"nrf5x_singleended":nrf5xSerialSettings_singleended,"freeEEG16":freeeeg16SerialSettings,"freeEEG32":freeeeg32SerialSettings,"freeEEG32_optical":freeeeg32_optical_SerialSettings,"freeEEG128":freeeeg128SerialSettings,"hegduino":hegduinoSerialSettings,"hegduinoV1":hegduinoV1SerialSettings,"cyton":cytonSerialSettings,"cyton_daisy":daisycytonSerialSettings,"peanut":peanutSerialSettings,"statechanger":statechangerSerialSettings,"cognixionONE":cytonSerialSettings},BLE_CUSTOM:{},USB_CUSTOM:{},CUSTOM:{"simulator":simulatorSettings}};var textdecoder3=new TextDecoder;var decoders={"raw":data=>{if(data?.buffer)return Array.from(new Uint8Array(data));else return data},"utf8":data=>{return textdecoder3.decode(data)},"console-f12":data=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(data);return data},"debug":(data,debugmessage)=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(debugmessage,data);return data},"ads131m08":ads131m08codec,"arduino_ads131m08":ads131m08_arduinocodec,"max3010x":max3010xcodec,"mpu6050":mpu6050codec,"bme280":bme280codec,"freeeeg16":freeeeg16codec,"freeeeg32":freeeeg32codec,"freeeeg128":freeeeg128codec,"cyton":cytoncodec,"cognixionONE_BLE":cognixionONE_EEG_codec,"hegduino":hegduinocodec,"nrf5x":nrf5x_usbcodec,"peanut":peanutcodec,"statechanger":statechangercodec,"blueberry":blueberrycodec,"heart_rate":hrcodec};function parseFunctionFromText2(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs3(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs2}var stringifyFast2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p in value[prop]){if(Array.isArray(value[prop][p])){if(value[prop][p].length>20)obj[prop][p]=value[prop][p].slice(value[prop][p].length-20);else obj[prop][p]=value[prop][p]}else{if(value[prop][p]!=null){let con=value[prop][p].constructor.name;if(con.includes("Set")){obj[prop][p]=Array.from(value[prop][p])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p]="instanceof_"+con}else{obj[prop][p]=value[prop][p]}}else{obj[prop][p]=value[prop][p]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast3(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast2}function loadStreamWorkerGlobals(){globalThis.Devices=Devices;globalThis.WebSerial=WebSerial;globalThis.decoders=decoders;globalThis.decoder="raw";globalThis.ByteParser=ByteParser;globalThis.filtering=false;globalThis.filters={};globalThis.BiquadChannelFilterer=BiquadChannelFilterer;globalThis.ArrayManip=ArrayManip}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){loadStreamWorkerGlobals()}var streamWorkerRoutes={"transferDevice":function transferDevice(device,worker){let cpy=Object.assign({},device);for(const key in cpy){if(typeof cpy[key]==="function")cpy[key]=cpy[key].toString()}worker.send({route:"receiveDevice",args:cpy})},"receiveDevice":function receiveDevice(device){for(const key in device){if(typeof device[key]==="string"){let fn=parseFunctionFromText2(device[key]);if(typeof fn==="function"){device[key]=fn}}}if(!globalThis.Devices[device.deviceType])globalThis.Devices[device.deviceType]={};globalThis.Devices[device.deviceType][device.deviceName]=device},"receiveDecoder":function receiveDecoder(decoder2,decoderName){globalThis.decoders[decoderName]=(0,eval)("("+decoder2+")")},"receiveCodec":function receiveDeviceCodec(decoder2,deviceType,device,service,characteristic){let codec=parseFunctionFromText2(decoder2);if(codec){if(deviceType==="BLE"&&service&&characteristic){if(globalThis.Devices[deviceType][device]){if(globalThis.Devices[deviceType][device][service]){if(globalThis.Devices[deviceType][device][characteristic]){globalThis.Devices[deviceType][device][characteristic].codec=codec}else{globalThis.Devices[deviceType][device][characteristic]={codec}}}else{globalThis.Devices[deviceType][device]={[characteristic]:{codec}}}}}else if(globalThis.Devices[deviceType][device]?.codec){if(globalThis.Devices[deviceType][device])globalThis.Devices[deviceType][device].codec=codec;else{globalThis.Devices[deviceType][device]={codec}}}}},"decode":function decode(data){return globalThis.decoder(data)},"decodeAndParse":function decodeAndParse(data){let decoded=this.__node.graph.run("decode",data);if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}}}}return parsed}}return decoded},"setActiveDecoder":function setActiveDecoder(deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device]?.codec;else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device][service][characteristic].codec;return true},"decodeDevice":function decodeDevice(data,deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)return globalThis.Devices[deviceType][device].codec(data);else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)return globalThis.Devices[deviceType][device][service][characteristic].codec(data)},"decodeAndParseDevice":function decodeAndParseDevice(data,deviceType,deviceName,service,characteristic){let decoded;if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][deviceName]?.services[service]?.[characteristic]?.codec)decoded=globalThis.Devices[deviceType][deviceName].services[service][characteristic].codec(data);else if(globalThis.Devices[deviceType][deviceName]?.codec)decoded=globalThis.Devices[deviceType][deviceName].codec(data);else decoded=data;if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}else if(typeof parsed[prop]==="number"){parsed[prop]=filter.apply(parsed[prop])}}}}return parsed}}return decoded},"toggleAnim":function toggleAnim(){globalThis.runningAnim=!globalThis.runningAnim;return globalThis.runningAnim},"setFilters":function setFilters(filters,clearFilters=false){if(!globalThis.filters||clearFilters){globalThis.filters={};if(clearFilters)globalThis.filtering=false}if(filters){for(const key in filters){globalThis.filters[key]=new BiquadChannelFilterer(filters[key])}globalThis.filtering=true}return true},"getFilterSettings":function getFilterSettings(){if(globalThis.filters){let filters={};for(const key in globalThis.filters){filters[key]={sps:globalThis.filters[key].sps,useScaling:globalThis.filters[key].useScaling,scalar:globalThis.filters[key].scalar,useNotch50:globalThis.filters[key].useNotch50,useNotch60:globalThis.filters[key].useNotch60,useDCBlock:globalThis.filters[key].useDCBlock,useLowpass:globalThis.filters[key].useLowpass,lowpassHz:globalThis.filters[key].lowpassHz,useBandpass:globalThis.filters[key].useBandpass,bandpassLower:globalThis.filters[key].bandpassLower,bandpassUpper:globalThis.filters[key].bandpassUpper}}return filters}return void 0},"setupSerial":function setupSerial(){globalThis.Serial=new globalThis.WebSerial;globalThis.decoder="raw";console.log("worker: Setting up Serial",globalThis.Serial);return true},"openPort":function openPort(settings){const WorkerService2=this.__node.graph;if(!globalThis.Serial)WorkerService2.run("setupSerial");return new Promise((res,rej)=>{globalThis.Serial.getPorts().then(ports=>{const Serial=globalThis.Serial;let port=ports.find(port2=>{return port2.getInfo().usbVendorId===settings.usbVendorId&&port2.getInfo().usbProductId===settings.usbProductId});if(port){let options=Object.assign({},settings);if(typeof settings.pipeTo==="object"&&settings.pipeTo.extraArgs&&globalThis.Devices?.[settings.pipeTo.extraArgs[0]]?.[settings.pipeTo.extraArgs[1]]){options.onconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].onconnect;options.ondisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].ondisconnect;options.beforedisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].beforedisconnect}Serial.openPort(port,options).then(()=>{const stream=Serial.createStream({port,settings:options,frequency:settings.frequency?settings.frequency:10,buffering:settings.buffering,ondata:value=>{if(stream.settings.pipeTo){if(stream.settings.pipeMain){WorkerService2.transmit(value,void 0,[value.buffer])}if(typeof stream.settings.pipeTo==="string")WorkerService2.transmit(value,stream.settings.pipeTo,[value.buffer]);else if(stream.settings.pipeTo?.route){let args=value;if(stream.settings.pipeTo.extraArgs)args=[value,...stream.settings.pipeTo.extraArgs];WorkerService2.transmit({route:stream.settings.pipeTo.route,args},stream.settings.pipeTo._id,[value.buffer])}}else{WorkerService2.transmit(value,void 0,[value.buffer])}}});Serial.readStream(stream);port.ondisconnect=()=>{postMessage(\`\${stream._id} disconnected\`)};res({_id:stream._id,settings,info:stream.info})}).catch(()=>{postMessage(\`disconnected\`)});;}else{rej(false)}})})},"closeStream":function closeStream(streamId){return new Promise((res,rej)=>{const Serial=globalThis.Serial;let ondisconnect;if(Serial.streams[streamId].port?.ondisconnect)ondisconnect=Serial.streams[streamId].port.ondisconnect;Serial.closeStream(Serial.streams[streamId]).then(resolved=>{if(ondisconnect)ondisconnect(void 0);res(resolved)}).catch(rej)})},"writeStream":function writeStream(streamId,message){globalThis.Serial.writeStream(globalThis.Serial.streams[streamId],message);return true},"updateStreamSettings":function updateStreamSettings(streamId,settings){if(globalThis.Serial?.streams[streamId]){for(const key in settings){if(typeof settings[key]==="object"){Object.assign(globalThis.Serial.streams[streamId].settings[key],settings[key])}else globalThis.Serial.streams[streamId][key]=settings[key]}}}};if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){globalThis.Devices=Devices;const worker=new WorkerService({roots:{...workerCanvasRoutes,...remoteGraphRoutes,...streamWorkerRoutes}})}var stream_worker_default=self;})();
`,EIe=URL.createObjectURL(new globalThis.Blob([kIe],{type:"text/javascript"})),OIe=EIe,Vb=class{constructor(){this.recursivelyAssign=(e,t)=>{for(let r in t)typeof t[r]=="object"?typeof e[r]=="object"?this.recursivelyAssign(e[r],t[r]):e[r]=this.recursivelyAssign({},t[r]):e[r]=t[r];return e}}static autoscale(e,t=0,r=1,n=!1,i,s,a){if(e?.length===0)return e;let o=s||Math.max(...e),l=i||Math.min(...e),c=1/r,f=1;if(n){let u=Math.max(Math.abs(l),Math.abs(o));return u!==0&&(f=c/u),e.map(d=>(a&&(d<l&&(d=l),d>o&&(d=o)),d*f+(c*(t+1)*2-1-c)))}else return o===l?o!==0?f=c/o:l!==0&&(f=c/Math.abs(l)):f=c/(o-l),e.map(u=>(a&&(u<l&&(u=l),u>o&&(u=o)),2*((u-l)*f-1/(2*r))+(c*(t+1)*2-1-c)))}static genTimestamps(e,t){let r=Date.now(),n=[r-e*1e3/t,r];return Vb.upsample(n,e)}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t,r=1){if(e.length>t){let n=new Array(t),i=e.length/t,s=e.length-1,a=0,o=0;for(let l=i;l<e.length;l+=i){let c=Math.round(l);c>s&&(c=s);for(let f=a;f<c;f++)n[o]+=e[f];n[o]/=(c-a)*r,o++,a=c}return n}else return e}static upsample(e,t,r=1){var n=function(u,d,p){return(u+(d-u)*p)*r},i=new Array(t),s=(e.length-1)/(t-1);i[0]=e[0];for(var a=1;a<t-1;a++){var o=a*s,l=Math.floor(o),c=Math.ceil(o),f=o-l;i[a]=n(e[l],e[c],f)}return i[t-1]=e[e.length-1],i}static interpolate(e,t,r=1){return e.length>t?Vb.downsample(e,t,r):e.length<t?Vb.upsample(e,t,r):e}static HSLToRGB(e,t,r,n=255){t/=100,r/=100;let i=(1-Math.abs(2*r-1))*t,s=i*(1-Math.abs(e/60%2-1)),a=r-i/2,o=0,l=0,c=0;return 0<=e&&e<60?(o=i,l=s,c=0):60<=e&&e<120?(o=s,l=i,c=0):120<=e&&e<180?(o=0,l=i,c=s):180<=e&&e<240?(o=0,l=s,c=i):240<=e&&e<300?(o=s,l=0,c=i):300<=e&&e<360&&(o=i,l=0,c=s),o=(o+a)*n,l=(l+a)*n,c=(c+a)*n,[o,l,c]}static circularBuffer(e,t){if(t.length<e.length){let r=e.slice(t.length),n=e.length;e.splice(0,n,...r,...t)}else if(t.length>e.length){let r=e.length;e.splice(0,r,t.slice(r-t.length))}else e.splice(0,e.length,...t);return e}static reformatData(e,t){if(Array.isArray(e)){if(Array.isArray(e[0])){let r={};if(e.forEach((n,i)=>{r[i]=n}),e=r,isNaN(e[0][0]))return}else if(t){if(e={[t]:e},isNaN(e[t][0]))return}else if(e={0:e},isNaN(e[0][0]))return}else if(typeof e=="object"){for(let r in e)if(typeof e[r]=="number"?e[r]=[e[r]]:e[r]?.values&&typeof e[r].values=="number"&&(e[r].values=[e[r].values]),isNaN(e[r][0]))return}else if(typeof e=="string"){let r;if(e.includes(`\r
`)){let n=e.split(`\r
`);e={},n.forEach((i,s)=>{i.includes("	")?r=i.split("	"):i.includes(",")?r=i.split(","):i.includes("|")&&(r=i.split("|")),Array.isArray(r)&&r.forEach((a,o)=>{if(a.includes(":")){let[l,c]=a.split(":"),f=parseFloat(c);if(f)e[l]=[f];else return}else{let l=parseFloat(a);if(l)e[o]=[l];else return}})})}else e.includes("	")?r=e.split("	"):e.includes(",")?r=e.split(","):e.includes("|")&&(r=e.split("|"));e={},Array.isArray(r)&&r.forEach((n,i)=>{if(n.includes(":")){let[s,a]=n.split(":"),o=parseFloat(a);if(o)e[s]=[o];else return}else{let s=parseFloat(n);if(s)e[i]=[s];else return}})}else typeof e=="number"&&(t?e={[t]:[e]}:e={0:[e]});return e}static padTime(e,t,r,n){let i=(e[0]-t)/r/n;return[...new Array(n-e.length).map((a,o)=>t+i*(o+1)),...e]}static interpolateForTime(e,t,r){return Vb.interpolate(e,Math.ceil(r*t))}isTypedArray(e){return ArrayBuffer.isView(e)&&Object.prototype.toString.call(e)!=="[object DataView]"}spliceTypedArray(e,t,r){let n=e.subarray(0,t),i;r&&(i=e.subarray(r+1));let s;return(n.length>0||i?.length>0)&&(s=new e.constructor(n.length+i.length)),n.length>0&&s.set(n),i&&i.length>0&&s.set(i,n.length),s}},QP=Vb;QP.bufferValues=(e,t,r,n)=>{if(!Array.isArray(r)&&typeof r=="object"&&(r=Object.keys(r)),!n){let s=Object.keys(e);r?n=new Float32Array(s.length*r.length):typeof e[s[0]][t]=="object"?(r=Object.keys(e[s[0]][t]),n=new Float32Array(s.length*r.length)):n=new Float32Array(s.length)}let i=0;for(let s in e)if(e[s][t])if(r)for(let a=0;a<r.length;a++)n[i]=e[s][t][r[a]],i++;else n[i]=e[s][t],i++;return n};var AIe=/^([<>])?(([1-9]\d*)?([xcbB?hHiIfdsp]))*$/,TIe=/([1-9]\d*)?([xcbB?hHiIfdsp])/g,zP=(e,t,r)=>String.fromCharCode(...new Uint8Array(e.buffer,e.byteOffset+t,r)),qP=(e,t,r,n)=>new Uint8Array(e.buffer,e.byteOffset+t,r).set(n.split("").map(i=>i.charCodeAt(0))),CIe=(e,t,r)=>zP(e,t+1,Math.min(e.getUint8(t),r-1)),IIe=(e,t,r,n)=>{e.setUint8(t,n.length),qP(e,t+1,r-1,n)},NIe=e=>({x:t=>[1,t,0],c:t=>[t,1,r=>({u:n=>zP(n,r,1),p:(n,i)=>qP(n,r,1,i)})],"?":t=>[t,1,r=>({u:n=>!!n.getUint8(r),p:(n,i)=>n.setUint8(r,i)})],b:t=>[t,1,r=>({u:n=>n.getInt8(r),p:(n,i)=>n.setInt8(r,i)})],B:t=>[t,1,r=>({u:n=>n.getUint8(r),p:(n,i)=>n.setUint8(r,i)})],h:t=>[t,2,r=>({u:n=>n.getInt16(r,e),p:(n,i)=>n.setInt16(r,i,e)})],H:t=>[t,2,r=>({u:n=>n.getUint16(r,e),p:(n,i)=>n.setUint16(r,i,e)})],i:t=>[t,4,r=>({u:n=>n.getInt32(r,e),p:(n,i)=>n.setInt32(r,i,e)})],I:t=>[t,4,r=>({u:n=>n.getUint32(r,e),p:(n,i)=>n.setUint32(r,i,e)})],f:t=>[t,4,r=>({u:n=>n.getFloat32(r,e),p:(n,i)=>n.setFloat32(r,i,e)})],d:t=>[t,8,r=>({u:n=>n.getFloat64(r,e),p:(n,i)=>n.setFloat64(r,i,e)})],s:t=>[1,t,r=>({u:n=>zP(n,r,t),p:(n,i)=>qP(n,r,t,i.slice(0,t))})],p:t=>[1,t,r=>({u:n=>CIe(n,r,t),p:(n,i)=>IIe(n,r,t,i.slice(0,t-1))})]}),DX=new RangeError("Structure larger than remaining buffer"),PIe=new RangeError("Not enough values for structure"),Nh=class extends QP{static toDataView(e){if(!(e instanceof DataView))if(typeof e=="string"&&parseInt(e)&&(e=parseInt(e)),typeof e=="string"){let t=new TextEncoder,r={};for(let i in Nh.codes)for(;e.indexOf(i)>-1;){let s=e.indexOf(i);e=e.replace(i,""),r[s]=i}let n=Array.from(t.encode(e));for(let i in r)n.splice(parseInt(i),0,Nh.codes[r[i]]);e=new DataView(new Uint8Array(n).buffer)}else if(typeof e=="number"){let t=e;e<256?(e=new DataView(new ArrayBuffer(1)),e.setUint8(0,t)):e<65536?(e=new DataView(new ArrayBuffer(2)),e.setInt16(0,t)):(e=new DataView(new ArrayBuffer(4)),e.setUint32(0,t))}else e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer?e=new DataView(e):Array.isArray(e)?e=new DataView(Uint8Array.from(e).buffer):typeof e=="object"&&(e=new TextEncoder().encode(JSON.stringify(e)));return e}static searchBuffer(e,t,r){for(var n=t,i=e,s=Nh.boyerMoore(n),a=s.byteLength,o=[],l=s(i);l!==-1&&(o.push(l),!(r&&o.length>=r));l=s(i,l+a));return o}static bytesToInt16(e,t){let r=(255&e)<<8|255&t;return(r&32768)>0?r|=4294901760:r&=65535,r}static bytesToUInt16(e,t){return e*256+t}static Uint16ToBytes(e){return[e&255,e>>8&255]}static bytesToInt24(e,t,r){let n=(255&e)<<16|(255&t)<<8|255&r;return(n&8388608)>0?n|=4278190080:n&=16777215,n}static bytesToUInt24(e,t,r){return e*65536+t*256+r}static Uint24ToBytes(e){return[e&255,e>>8&255,e>>16&255]}static bytesToInt32(e,t,r,n){let i=(255&e)<<24|(255&t)<<16|(255&r)<<8|255&n;return(i&2147483648)>0?i|=0:i&=4294967295,i}static bytesToUInt32(e,t,r,n){return e*16777216+t*65536+r*256+n}static Uint32ToBytes(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]}static get2sCompliment(e,t){return e>4294967296?null:e<<32-t>>32-t}static getSignedInt(...e){let t=0;function r(n){for(var i=0,s=!0;n--;)if(s){let a=e[t++];i+=a&127,a&128&&(i-=128),s=!1}else i*=256,i+=e[t++];return i}return r(e.length)}static asUint8Array(e){if(e instanceof Uint8Array)return e;if(typeof e=="string"){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n>127)throw new TypeError("Only ASCII patterns are supported");t[r]=n}return t}else return new Uint8Array(e)}static boyerMoore(e){var t=Nh.asUint8Array(e),r=t.length;if(r===0)throw new TypeError("patternBuffer must be at least 1 byte long");for(var n=256,i=new Int32Array(n),s=0;s<n;s++)i[s]=-1;for(var a=0;a<r;a++)i[t[a]]=a;var o=(l,c,f)=>{var u=Nh.asUint8Array(l);c===void 0&&(c=0),f===void 0&&(f=u.length);for(var d=t,p=i,_=f-d.length,w=d.length-1,k,S=c;S<=_;S+=k){k=0;for(var O=w;O>=0;O--){var A=u[S+O];if(d[O]!==A){k=Math.max(1,O-p[A]);break}}if(k===0)return S}return-1};return o.byteLength=t.byteLength,o}static struct(e){let t=[],r=0,n=AIe.exec(e);if(!n)throw new RangeError("Invalid format string");let i=NIe(n[1]==="<"),s=(u,d)=>i[d](u?parseInt(u,10):1);for(;n=TIe.exec(e);)((u,d,p)=>{for(let _=0;_<u;++_,r+=d)p&&t.push(p(r))})(...s(...n.slice(1)));let a=(u,d)=>{if(u.byteLength<(d|0)+r)throw DX;let p=new DataView(u,d|0);return t.map(_=>_.u(p))},o=(u,d,...p)=>{if(p.length<t.length)throw PIe;if(u.byteLength<d+r)throw DX;let _=new DataView(u,d);new Uint8Array(u,d,r).fill(0),t.forEach((w,k)=>w.p(_,p[k]))},l=(...u)=>{let d=new ArrayBuffer(r);return o(d,0,...u),d},c=u=>a(u,0);function*f(u){for(let d=0;d+r<=u.byteLength;d+=r)yield a(u,d)}return Object.freeze({unpack:c,pack:l,unpack_from:a,pack_into:o,iter_unpack:f,format:e,size:r})}},tt=Nh;tt.codes={"\\n":10,"\\r":13,"\\t":9,"\\s":32,"\\b":8,"\\f":12,"\\":92};var jX;(function(e){e[e.SCAN_MODE_LOW_POWER=0]="SCAN_MODE_LOW_POWER",e[e.SCAN_MODE_BALANCED=1]="SCAN_MODE_BALANCED",e[e.SCAN_MODE_LOW_LATENCY=2]="SCAN_MODE_LOW_LATENCY"})(jX||(jX={}));var BX;(function(e){e[e.CONNECTION_PRIORITY_BALANCED=0]="CONNECTION_PRIORITY_BALANCED",e[e.CONNECTION_PRIORITY_HIGH=1]="CONNECTION_PRIORITY_HIGH",e[e.CONNECTION_PRIORITY_LOW_POWER=2]="CONNECTION_PRIORITY_LOW_POWER"})(BX||(BX={}));JP();GP();JP();var qt=NS("BluetoothLe",{web:()=>Promise.resolve().then(()=>(jCe(),zX)).then(e=>new e.BluetoothLeWeb)}),LIe=()=>{let e=Promise.resolve();return t=>new Promise((r,n)=>{e=e.then(()=>t()).then(r).catch(n)})};function PP(e){return e?LIe():t=>t()}function Tn(e){if(typeof e!="string")throw new Error(`Invalid UUID type ${typeof e}. Expected string.`);if(e=e.toLowerCase(),!(e.search(/^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$/)>=0))throw new Error(`Invalid UUID format ${e}. Expected 128 bit string (e.g. "0000180d-0000-1000-8000-00805f9b34fb").`);return e}var FIe=class{constructor(){this.scanListener=null,this.eventListeners=new Map,this.queue=PP(!0)}enableQueue(){this.queue=PP(!0)}disableQueue(){this.queue=PP(!1)}async initialize(e){await this.queue(async()=>{await qt.initialize(e)})}async isEnabled(){return await this.queue(async()=>(await qt.isEnabled()).value)}async enable(){await this.queue(async()=>{await qt.enable()})}async disable(){await this.queue(async()=>{await qt.disable()})}async startEnabledNotifications(e){await this.queue(async()=>{var t;let r="onEnabledChanged";await((t=this.eventListeners.get(r))===null||t===void 0?void 0:t.remove());let n=await qt.addListener(r,i=>{e(i.value)});this.eventListeners.set(r,n),await qt.startEnabledNotifications()})}async stopEnabledNotifications(){await this.queue(async()=>{var e;let t="onEnabledChanged";await((e=this.eventListeners.get(t))===null||e===void 0?void 0:e.remove()),this.eventListeners.delete(t),await qt.stopEnabledNotifications()})}async isLocationEnabled(){return await this.queue(async()=>(await qt.isLocationEnabled()).value)}async openLocationSettings(){await this.queue(async()=>{await qt.openLocationSettings()})}async openBluetoothSettings(){await this.queue(async()=>{await qt.openBluetoothSettings()})}async openAppSettings(){await this.queue(async()=>{await qt.openAppSettings()})}async setDisplayStrings(e){await this.queue(async()=>{await qt.setDisplayStrings(e)})}async requestDevice(e){return e=e?this.validateRequestBleDeviceOptions(e):void 0,await this.queue(async()=>await qt.requestDevice(e))}async requestLEScan(e,t){e=this.validateRequestBleDeviceOptions(e),await this.queue(async()=>{var r;await((r=this.scanListener)===null||r===void 0?void 0:r.remove()),this.scanListener=await qt.addListener("onScanResult",n=>{let i=Object.assign(Object.assign({},n),{manufacturerData:this.convertObject(n.manufacturerData),serviceData:this.convertObject(n.serviceData),rawAdvertisement:n.rawAdvertisement?this.convertValue(n.rawAdvertisement):void 0});t(i)}),await qt.requestLEScan(e)})}async stopLEScan(){await this.queue(async()=>{var e;await((e=this.scanListener)===null||e===void 0?void 0:e.remove()),this.scanListener=null,await qt.stopLEScan()})}async getDevices(e){if(!Array.isArray(e))throw new Error("deviceIds must be an array");return this.queue(async()=>(await qt.getDevices({deviceIds:e})).devices)}async getConnectedDevices(e){if(!Array.isArray(e))throw new Error("services must be an array");return e=e.map(Tn),this.queue(async()=>(await qt.getConnectedDevices({services:e})).devices)}async connect(e,t,r){await this.queue(async()=>{var n;if(t){let i=`disconnected|${e}`;await((n=this.eventListeners.get(i))===null||n===void 0?void 0:n.remove());let s=await qt.addListener(i,()=>{t(e)});this.eventListeners.set(i,s)}await qt.connect(Object.assign({deviceId:e},r))})}async createBond(e){await this.queue(async()=>{await qt.createBond({deviceId:e})})}async isBonded(e){return await this.queue(async()=>(await qt.isBonded({deviceId:e})).value)}async disconnect(e){await this.queue(async()=>{await qt.disconnect({deviceId:e})})}async getServices(e){return await this.queue(async()=>(await qt.getServices({deviceId:e})).services)}async discoverServices(e){await this.queue(async()=>{await qt.discoverServices({deviceId:e})})}async getMtu(e){return await this.queue(async()=>(await qt.getMtu({deviceId:e})).value)}async requestConnectionPriority(e,t){await this.queue(async()=>{await qt.requestConnectionPriority({deviceId:e,connectionPriority:t})})}async readRssi(e){return await this.queue(async()=>{let r=await qt.readRssi({deviceId:e});return parseFloat(r.value)})}async read(e,t,r,n){return t=Tn(t),r=Tn(r),await this.queue(async()=>{let s=await qt.read(Object.assign({deviceId:e,service:t,characteristic:r},n));return this.convertValue(s.value)})}async write(e,t,r,n,i){return t=Tn(t),r=Tn(r),this.queue(async()=>{if(!n?.buffer)throw new Error("Invalid data.");let s=n;Ec.getPlatform()!=="web"&&(s=EP(n)),await qt.write(Object.assign({deviceId:e,service:t,characteristic:r,value:s},i))})}async writeWithoutResponse(e,t,r,n,i){t=Tn(t),r=Tn(r),await this.queue(async()=>{if(!n?.buffer)throw new Error("Invalid data.");let s=n;Ec.getPlatform()!=="web"&&(s=EP(n)),await qt.writeWithoutResponse(Object.assign({deviceId:e,service:t,characteristic:r,value:s},i))})}async readDescriptor(e,t,r,n,i){return t=Tn(t),r=Tn(r),n=Tn(n),await this.queue(async()=>{let a=await qt.readDescriptor(Object.assign({deviceId:e,service:t,characteristic:r,descriptor:n},i));return this.convertValue(a.value)})}async writeDescriptor(e,t,r,n,i,s){return t=Tn(t),r=Tn(r),n=Tn(n),this.queue(async()=>{if(!i?.buffer)throw new Error("Invalid data.");let a=i;Ec.getPlatform()!=="web"&&(a=EP(i)),await qt.writeDescriptor(Object.assign({deviceId:e,service:t,characteristic:r,descriptor:n,value:a},s))})}async startNotifications(e,t,r,n){t=Tn(t),r=Tn(r),await this.queue(async()=>{var i;let s=`notification|${e}|${t}|${r}`;await((i=this.eventListeners.get(s))===null||i===void 0?void 0:i.remove());let a=await qt.addListener(s,o=>{n(this.convertValue(o?.value))});this.eventListeners.set(s,a),await qt.startNotifications({deviceId:e,service:t,characteristic:r})})}async stopNotifications(e,t,r){t=Tn(t),r=Tn(r),await this.queue(async()=>{var n;let i=`notification|${e}|${t}|${r}`;await((n=this.eventListeners.get(i))===null||n===void 0?void 0:n.remove()),this.eventListeners.delete(i),await qt.stopNotifications({deviceId:e,service:t,characteristic:r})})}validateRequestBleDeviceOptions(e){return e.services&&(e.services=e.services.map(Tn)),e.optionalServices&&(e.optionalServices=e.optionalServices.map(Tn)),e}convertValue(e){return typeof e=="string"?LS(e):e===void 0?new DataView(new ArrayBuffer(0)):e}convertObject(e){if(e===void 0)return;let t={};for(let r of Object.keys(e))t[r]=this.convertValue(e[r]);return t}},DIe=new FIe;GP();var BS=class extends tt{constructor(e,t){super(),this.client=DIe,this.devices={},this.location=!1,this.initialized=!1,this.setupDevice=(r,n)=>new Promise(async(i,s)=>{this.devices[r.deviceId]={device:r,deviceId:r.deviceId,...n},this.client.connect(r.deviceId,a=>{this.devices[r.deviceId]?.ondisconnect&&this.devices[r.deviceId].ondisconnect(a)},n?.connectOptions).then(async()=>{let a=await this.getServices(r.deviceId);for(let o in n?.services){n?.services[o].UUID&&(o=n?.services[o].UUID);let l=a.find(c=>{if(c.uuid===o)return!0});if(l)for(let c in n.services[o]){if(n.services[o][c].characteristic&&(c=n.services[o][c].characteristic),!l.characteristics.find(u=>{if(u.uuid===c)return!0}))continue;let f=n.services[o][c];f.write&&await this.write(r,o,c,f.write,f.writeCallback,f.writeOptions),f.read&&await this.read(r,o,c,f.readCallback,f.readOptions),f.notify&&f.notifyCallback&&(await this.subscribe(r,o,c,f.notifyCallback),f.notifying=!0)}}}).catch(s),i(this.devices[r.deviceId])}),this.triangulate=(r,n=1500,i=60)=>new Promise((s,a)=>{if("Accelerometer"in globalThis){if(typeof globalThis.Accelerometer=="function"){let o=new globalThis.Accelerometer({frequency:i}),l=performance.now(),c=l,f={samples:[],vector:{}},u=()=>{if(c-l<n)this.readRssi(r).then(d=>{let p=o.x,_=o.y,w=o.z;c=performance.now(),f.samples.push({x:p,y:_,z:w,rssi:d,timestamp:c})});else{let d={x:0,y:0,z:0,rssiAvg:0};f.samples.forEach(p=>{}),o.removeEventListener("reading",u)}};o.addEventListener("reading",u)}}else a(new Error("No Accelerometer API detected"))}),t&&(this.location=t),e&&this.setup(e)}setup(e,t=this.location){let r=[];if(e)for(let i in e.services)e.services[i].UUID&&(i=e.services[i].UUID),r.push(i);let n={};return t||(n.androidNeverForLocation=!1),new Promise(async(i,s)=>{if(this.initialized||(await this.client.initialize(n),this.initialized=!0),e?.deviceId)i(await this.reconnect(e.deviceId));else if(e){let a=Array.from(Object.keys(e.services)),o={};this.isMobile()||(o.optionalServices=a),e.name&&(o.name=e.name),e.namePrefix&&(o.namePrefix=e.namePrefix),this.client.requestDevice(o).then(l=>{i(this.setupDevice(l,e))}).catch(s)}else this.client.requestDevice().then(a=>{i(this.setupDevice(a,e))}).catch(s)})}initialize(e){return new Promise((t,r)=>{this.client.initialize(e).then(()=>{t(!0)}).catch(r)})}requestDevice(e,t){return new Promise((r,n)=>{this.client.requestDevice(e).then(i=>{this.devices[i.deviceId]={device:i,deviceId:i.deviceId,...t},r(i)}).catch(n)})}getServices(e){return this.client.getServices(e)}connect(e,t){return new Promise((r,n)=>{this.client.connect(e.deviceId,i=>{t?.ondisconnect&&t.ondisconnect(i)},t?.connectOptions).then(i=>{r(e)}).catch(n)})}reconnect(e,t){return new Promise((r,n)=>{let i=t;this.devices[e]&&(i=Object.assign(Object.assign({},this.devices[e]),i)),i?.deviceId&&delete i.deviceId,this.client.getDevices([e]).then(s=>{this.setupDevice(s[0],i).then(a=>{r(a)})}).catch(n)})}disconnect(e){if(typeof e=="object"&&e?.deviceId&&(e=e.deviceId),typeof e=="string"){let t=this.devices[e];return t.beforedisconnect&&t.beforedisconnect(this,t),delete this.devices[e],this.client.disconnect(e)}}write(e,t,r,n,i,s){return typeof e=="object"&&(e=e.deviceId),i?this.client.write(e,t,r,BS.toDataView(n)).then(i):this.client.writeWithoutResponse(e,t,r,BS.toDataView(n),s)}read(e,t,r,n,i){return typeof e=="object"&&(e=e.deviceId),n?this.client.read(e,t,r,i).then(n):this.client.read(e,t,r,i)}subscribe(e,t,r,n){return typeof e=="object"&&(e=e.deviceId),this.client.startNotifications(e,t,r,n)}unsubscribe(e,t,r){return typeof e=="object"&&(e=e.deviceId),this.client.stopNotifications(e,t,r)}scan(e,t){return this.client.requestLEScan(e,t)}stopScanning(){return this.client.stopLEScan()}readDescriptor(e,t,r,n,i){return this.client.readDescriptor(e.deviceId,t,r,n,i)}writeDescriptor(e,t,r,n,i,s){return this.client.writeDescriptor(e.deviceId,t,r,n,BS.toDataView(i),s)}readRssi(e){return this.client.readRssi(e.deviceId)}isMobile(){let e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}isAndroid(){return navigator.userAgent.toLowerCase().indexOf("android")>-1}async distance(e,t,r,n,i){let s=await this.readRssi(e);if(s==0)return;let a=s/t;return a<1?Math.pow(a,10):r*Math.pow(a,n)+i}async distanceFromPhone(e,t,r){let n,i,s;return r&&(r==="nexus5"?(n=.42093,i=6.9476,s=.54992):r==="motoX"?(n=.9401940951,i=6.170094565,s=0):r==="iphone5"&&(n=.89976,i=7.7095,s=.111)),await this.distance(e,t,n,i,s)}};(function(e){var t,r={},n=console,i=Math,s="postMessage",a="HackTimer.js by turuslan: ",o="Initialisation failed",l=0,c="hasOwnProperty",f=[].slice,u=Worker;function d(){do l=2147483647>l?l+1:0;while(r[c](l));return l}if(!/MSIE 10/i.test(navigator.userAgent))try{e=URL.createObjectURL(new Blob(["var f={},p=postMessage,r='hasOwnProperty';onmessage=function(e){var d=e.data,i=d.i,t=d[r]('t')?d.t:0;switch(d.n){case'a':f[i]=setInterval(function(){p(i)},t);break;case'b':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case'c':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case'd':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch{}if(typeof u<"u")try{t=new u(e),setInterval=function(p,_){var w=d();return r[w]={c:p,p:f.call(arguments,2)},t[s]({n:"a",i:w,t:_}),w},clearInterval=function(p){r[c](p)&&(delete r[p],t[s]({n:"b",i:p}))},setTimeout=function(p,_){var w=d();return r[w]={c:p,p:f.call(arguments,2),t:!0},t[s]({n:"c",i:w,t:_}),w},clearTimeout=function(p){r[c](p)&&(delete r[p],t[s]({n:"d",i:p}))},t.onmessage=function(p){var _=p.data,w,k;if(r[c](_)&&(k=r[_],w=k.c,k[c]("t")&&delete r[_]),typeof w=="string")try{w=new Function(w)}catch(S){n.log(a+"Error parsing callback code string: ",S)}typeof w=="function"&&w.apply(globalThis,k.p)},t.onerror=function(p){n.log(p)}}catch(p){n.log(a+o),n.error(p)}else n.log(a+o+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js");var Ph=class extends tt{constructor(){super(...arguments),this.streams={},this.createStream=e=>{let t={_id:e._id?e._id:`stream${Math.floor(Math.random()*1e15)}`,info:e.port.getInfo(),running:!1,...e};return e.port?.readable&&(e.transforms?t.reader=Ph.setStreamTransforms(e.port.readable,e.transforms).getReader():t.reader=e.port.readable.getReader()),this.streams[t._id]=t,t}}getPorts(){return navigator.serial.getPorts()}requestPort(e,t){let r={};return e&&(r.usbVendorId=e),t&&(r.usbProductId=t),r.usbVendorId?navigator.serial.requestPort({filters:[r]}):navigator.serial.requestPort()}openPort(e,t){return t&&(t=Object.assign({},t)),t?.ondisconnect&&(e.ondisconnect=t.ondisconnect,delete t.ondisconnect),e.open(t).then(()=>{t?.onconnect&&t.onconnect(e)})}async readWithTimeout(e,t){let r=e.readable.getReader(),n=setTimeout(()=>{r.releaseLock()},t),i=await r.read();return clearTimeout(n),r.releaseLock(),i}async writePort(e,t){let r=e.writable.getWriter();return await r.write(Ph.toDataView(t)),r.releaseLock(),!0}getSignals(e){return e.getSignals()}setSignals(e,t){return e.setSignals(t)}readStream(e){if(e.reader&&!e.running){let t=e.reader;e.buffering&&(typeof e.buffering!="object"&&(e.buffering={}),e.buffering.buffer||(e.buffering.buffer=[]),e.buffering.searchBytes||(e.buffering.searchBytes=new Uint8Array([13,10])));let r=()=>{if(e.port.readable&&e.running)t.read().then(n=>{if(n.done)t.releaseLock();else{if(e.buffering){e.buffering.buffer.push(...n.value);let s=e.buffering.searchBytes,a=e.buffering.buffer,o=Ph.boyerMoore(s),l=o.byteLength,c=-1,f=e.buffering.lockIdx??0;for(var i=o(a);i!==-1;i=o(a,i+l))if(!e.buffering.locked&&!("lockIdx"in e.buffering))f=e.buffering.lockIdx=i;else if(c=i,c>=0){let u=c-f;if(e.buffering.locked){if(u>0){let d=e.buffering.buffer.splice(e.buffering.lockIdx,u),p=new Uint8Array(d.slice(e.buffering.searchBytes.length));e.ondata(new Uint8Array(p))}}else{let d=e.buffering.buffer.splice(e.buffering.lockIdx,u),p=new Uint8Array(d.slice(e.buffering.searchBytes.length));e.ondata(p),e.buffering.locked=!0}f=c}}else e.ondata(n.value);setTimeout(()=>{r()},e.frequency)}}).catch(n=>{console.error(e._id," Read error:",n),(n.message.includes("overrun")||n.message.includes("framing"))&&(delete e.reader,this.reconnect(e))});else if(!e.running&&e.port.readable)try{t.releaseLock()}catch(n){console.error(n)}};return e.running=!0,r(),e}}writeStream(e,t){if(typeof e=="string"&&(e=this.streams[e]),e.port.writable){let r=e.port.writable.getWriter();return r.write(Ph.toDataView(t)),r.releaseLock(),!0}}closeStream(e,t){return typeof e=="string"&&(e=this.streams[e]),e.running=!1,new Promise((r,n)=>{e.settings.beforedisconnect&&e.settings.beforedisconnect(this,e.port),setTimeout(async()=>{if(e.port.readable&&e.reader){try{e.reader.releaseLock()}catch(i){console.error(i)}if(e.transforms)try{await e.reader.cancel()}catch(i){console.error(i)}}try{await e.port.close().then(()=>{t&&t(this.streams[e._id])}),delete this.streams[e._id],r(!0)}catch(i){n(i)}},300)})}reconnect(e,t){return typeof e=="string"&&(e=this.streams[e]),new Promise((r,n)=>{if(typeof e!="object"){n(void 0);return}let i=e.port.getInfo();this.closeStream(e._id).then(s=>{setTimeout(()=>{this.getPorts().then(a=>{for(let o=0;o<a.length;o++)a[o].getInfo().usbVendorId===i.usbVendorId&&a[o].getInfo().usbProductId===i.usbProductId&&(t?t._id=e._id:t=e,delete t.port,this.openPort(a[o],t.settings).then(()=>{let l=this.createStream({...t,port:a[o]});this.readStream(l),r(l)}).catch(n))}).catch(n)},100)})})}static setStreamTransforms(e,t){let r=[];Object.keys(t).forEach(i=>{let s=t[i];if(s instanceof TransformStream)r.push(s);else{s.start||(s.start=function(){}),s.flush||(s.flush=function(){});let a=new TransformStream({start:s.start,transform:s.transform,flush:s.flush},s.writableStrategy,s.readableStrategy);r.push(a)}});let n=e;return r.forEach(i=>{n=n.pipeThrough(i)}),n}},tZ=250,rZ=32,VP=24,nZ=1.2,mc=Math.pow(2,24)/2;function wf(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let n=0;n<9;n++){let i=n*25;r[0][n]=tt.bytesToInt24(t[i],t[i+1],t[i+2]),r[1][n]=tt.bytesToInt24(t[i+3],t[i+4],t[i+5]),r[2][n]=tt.bytesToInt24(t[i+6],t[i+7],t[i+8]),r[3][n]=tt.bytesToInt24(t[i+9],t[i+10],t[i+11]),r[4][n]=tt.bytesToInt24(t[i+12],t[i+13],t[i+14]),r[5][n]=tt.bytesToInt24(t[i+15],t[i+16],t[i+17]),r[6][n]=tt.bytesToInt24(t[i+18],t[i+19],t[i+20]),r[7][n]=tt.bytesToInt24(t[i+21],t[i+22],t[i+23])}return t.length>225&&(r.leds=t.slice(225)),r}function $S(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let n=0;n<9;n++){let i=n*25;r[0][n]=tt.bytesToInt24(t[i],t[i+1],t[i+2])+mc,r[1][n]=tt.bytesToInt24(t[i+3],t[i+4],t[i+5])+mc,r[2][n]=tt.bytesToInt24(t[i+6],t[i+7],t[i+8])+mc,r[3][n]=tt.bytesToInt24(t[i+9],t[i+10],t[i+11])+mc,r[4][n]=tt.bytesToInt24(t[i+12],t[i+13],t[i+14])+mc,r[5][n]=tt.bytesToInt24(t[i+15],t[i+16],t[i+17])+mc,r[6][n]=tt.bytesToInt24(t[i+18],t[i+19],t[i+20])+mc,r[7][n]=tt.bytesToInt24(t[i+21],t[i+22],t[i+23])+mc}return t.length>225&&(r.leds=t.slice(225)),r}var jIe=new TextDecoder;function BIe(e){let t=jIe.decode(e),r;return t.includes("|")?r=t.split("|"):r.includes(",")?r=t.split(","):r=t.split("	"),{0:parseInt(r[0]),1:parseInt(r[1]),2:parseInt(r[2]),3:parseInt(r[3]),4:parseInt(r[4]),5:parseInt(r[5]),6:parseInt(r[6]),7:parseInt(r[7]),timestamp:Date.now()}}var bc={nSec:10,sps:tZ,units:"mV"},nXe={lines:{0:JSON.parse(JSON.stringify(bc)),1:JSON.parse(JSON.stringify(bc)),2:JSON.parse(JSON.stringify(bc)),3:JSON.parse(JSON.stringify(bc)),4:JSON.parse(JSON.stringify(bc)),5:JSON.parse(JSON.stringify(bc)),6:JSON.parse(JSON.stringify(bc)),7:JSON.parse(JSON.stringify(bc))}},vc={sps:tZ,useDCBlock:!1,useBandpass:!1,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:.96*1e3*nZ/(rZ*(Math.pow(2,VP)-1))},iXe=.96*1e3*nZ/(rZ*(Math.pow(2,VP)-1))*(Math.pow(2,VP)-1)*.5,sXe={0:JSON.parse(JSON.stringify(vc)),1:JSON.parse(JSON.stringify(vc)),2:JSON.parse(JSON.stringify(vc)),3:JSON.parse(JSON.stringify(vc)),4:JSON.parse(JSON.stringify(vc)),5:JSON.parse(JSON.stringify(vc)),6:JSON.parse(JSON.stringify(vc)),7:JSON.parse(JSON.stringify(vc))},LP=.002/Math.pow(2,4),iZ=(e,t,r=8)=>{let n=r*3+1,i=(a,o)=>a+o;e.slice(n).reduce(i,0)!==0&&(t.ax=LP*tt.bytesToInt16(e[n],e[n+1]),t.ay=LP*tt.bytesToInt16(e[n+2],e[n+3]),t.az=LP*tt.bytesToInt16(e[n+4],e[n+5]))};function sZ(e){let t;e.buffer?t=e:t=new Uint8Array(e);let r={};for(let n=0;n<8;n++){let i=1+3*n;r[n]=tt.bytesToInt24(t[i],t[i+1],t[i+2])}return iZ(t,r),r.timestamp=Date.now(),r}function MIe(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let n=0;n<8;n++){let i=1+3*n;t[0]%2===0?r[n+7]=tt.bytesToInt24(t[i],t[i+1],t[i+2]):r[n]=tt.bytesToInt24(t[i],t[i+1],t[i+2])}return iZ(t,r),r}var Gb=250,HP={deviceType:"USB",deviceName:"cyton",baudRate:115200,codec:sZ,write:"b",beforedisconnect:(e,t)=>{e.writePort(t,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:Gb},RIe={deviceType:"USB",deviceName:"cyton_daisy",baudRate:115200,codec:MIe,write:"b",beforedisconnect:(e,t)=>{e.writePort(t,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:Gb},_c={nSec:10,sps:Gb,units:"mV"},FP={nSec:10,sps:Gb},aXe={lines:{0:JSON.parse(JSON.stringify(_c)),1:JSON.parse(JSON.stringify(_c)),2:JSON.parse(JSON.stringify(_c)),3:JSON.parse(JSON.stringify(_c)),4:JSON.parse(JSON.stringify(_c)),5:JSON.parse(JSON.stringify(_c)),6:JSON.parse(JSON.stringify(_c)),7:JSON.parse(JSON.stringify(_c)),ax:JSON.parse(JSON.stringify(FP)),ay:JSON.parse(JSON.stringify(FP)),az:JSON.parse(JSON.stringify(FP))},generateNewLines:!0},gi={sps:Gb,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))},oXe={0:JSON.parse(JSON.stringify(gi)),1:JSON.parse(JSON.stringify(gi)),2:JSON.parse(JSON.stringify(gi)),3:JSON.parse(JSON.stringify(gi)),4:JSON.parse(JSON.stringify(gi)),5:JSON.parse(JSON.stringify(gi)),6:JSON.parse(JSON.stringify(gi)),7:JSON.parse(JSON.stringify(gi)),8:JSON.parse(JSON.stringify(gi)),9:JSON.parse(JSON.stringify(gi)),10:JSON.parse(JSON.stringify(gi)),11:JSON.parse(JSON.stringify(gi)),12:JSON.parse(JSON.stringify(gi)),13:JSON.parse(JSON.stringify(gi)),14:JSON.parse(JSON.stringify(gi)),15:JSON.parse(JSON.stringify(gi))};function aZ(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let i=0;i<128;i++){let s=i*3+1;r[i]=tt.bytesToInt24(t[s],t[s+1],t[s+2])}let n=385;return r.ax=tt.bytesToInt16(t[n],t[n+1]),r.ay=tt.bytesToInt16(t[n+2],t[n+3]),r.az=tt.bytesToInt16(t[n+4],t[n+5]),r.gx=tt.bytesToInt16(t[n+6],t[n+7]),r.gy=tt.bytesToInt16(t[n+8],t[n+9]),r.gz=tt.bytesToInt16(t[n+10],t[n+11]),r.timestamp=Date.now(),r}var kc=250,$Ie={deviceType:"USB",deviceName:"freeeeg128",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:aZ,sps:kc,buffering:{searchBytes:new Uint8Array([192,160])}},UIe={lines:{ax:{nSec:10,sps:kc},ay:{nSec:10,sps:kc},az:{nSec:10,sps:kc},gx:{nSec:10,sps:kc},gy:{nSec:10,sps:kc},gz:{nSec:10,sps:kc}}},zIe={};for(let e=0;e<128;e++)UIe.lines[e]={sps:kc,nSec:10,units:"mV"},zIe[e]={sps:250,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))};function eL(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let i=0;i<32;i++){let s=i*3+1;r[i]=tt.bytesToInt24(t[s],t[s+1],t[s+2])}let n=97;return r.ax=tt.bytesToInt16(t[n],t[n+1]),r.ay=tt.bytesToInt16(t[n+2],t[n+3]),r.az=tt.bytesToInt16(t[n+4],t[n+5]),r.gx=tt.bytesToInt16(t[n+6],t[n+7]),r.gy=tt.bytesToInt16(t[n+8],t[n+9]),r.gz=tt.bytesToInt16(t[n+10],t[n+11]),r.timestamp=Date.now(),r}var Wb=512,qIe={deviceType:"USB",deviceName:"freeeeg32",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:eL,sps:Wb,buffering:{searchBytes:new Uint8Array([192,160])}},VIe={deviceType:"USB",deviceName:"freeeeg32_optical",baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:eL,sps:Wb,buffering:{searchBytes:new Uint8Array([192,160])}},Oh={nSec:10,sps:Wb},HIe={lines:{ax:JSON.parse(JSON.stringify(Oh)),ay:JSON.parse(JSON.stringify(Oh)),az:JSON.parse(JSON.stringify(Oh)),gx:JSON.parse(JSON.stringify(Oh)),gy:JSON.parse(JSON.stringify(Oh)),gz:JSON.parse(JSON.stringify(Oh))}},WIe={};for(let e=0;e<32;e++)HIe.lines[e]={sps:Wb,nSec:10,units:"mV"},WIe[e]={sps:Wb,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))};function oZ(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let i=0;i<16;i++){let s=i*3+1;r[i]=tt.bytesToInt24(t[s],t[s+1],t[s+2])}let n=16*3+1;return r.ax=tt.bytesToInt16(t[n],t[n+1]),r.ay=tt.bytesToInt16(t[n+2],t[n+3]),r.az=tt.bytesToInt16(t[n+4],t[n+5]),r.gx=tt.bytesToInt16(t[n+6],t[n+7]),r.gy=tt.bytesToInt16(t[n+8],t[n+9]),r.gz=tt.bytesToInt16(t[n+10],t[n+11]),r.timestamp=Date.now(),r}var TS=[],MX,Ah;function JIe(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e),TS.push(...e);let r=new Uint8Array([192,160]),n=TS,i=tt.boyerMoore(r),s=i.byteLength,a=-1,o=Ah??0,l=!1;for(var c=i(n);c!==-1;c=i(n,c+s))if(!MX&&typeof Ah!="number")o=Ah=c;else if(a=c,a>=0){let f=a-o;if(Ah){if(f>0){let u=TS.splice(Ah,f);t=new Uint8Array(u.slice(r.length)),l=!0}}else{let u=TS.splice(Ah,f);t=new Uint8Array(u.slice(r.length)),l=!0,MX=!0}o=a}if(l){let f={};for(let d=0;d<16;d++){let p=d*3+1;f[d]=tt.bytesToInt24(t[p],t[p+1],t[p+2])}let u=16*3+1;return f.ax=tt.bytesToInt16(t[u],t[u+1]),f.ay=tt.bytesToInt16(t[u+2],t[u+3]),f.az=tt.bytesToInt16(t[u+4],t[u+5]),f.gx=tt.bytesToInt16(t[u+6],t[u+7]),f.gy=tt.bytesToInt16(t[u+8],t[u+9]),f.gz=tt.bytesToInt16(t[u+10],t[u+11]),f.timestamp=Date.now(),f}else return}var Jb=250,GIe={deviceType:"BLE",deviceName:"freeeeg16",services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:void 0},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:!0,notifyCallback:void 0,codec:JIe,sps:Jb}}}},KIe={deviceType:"USB",deviceName:"freeeeg16",baudRate:115200,bufferSize:2e3,frequency:3.5,codec:oZ,sps:Jb,buffering:{searchBytes:new Uint8Array([192,160])}},Th={nSec:10,sps:Jb},YIe={lines:{ax:JSON.parse(JSON.stringify(Th)),ay:JSON.parse(JSON.stringify(Th)),az:JSON.parse(JSON.stringify(Th)),gx:JSON.parse(JSON.stringify(Th)),gy:JSON.parse(JSON.stringify(Th)),gz:JSON.parse(JSON.stringify(Th))}},XIe={},ZIe=32,QIe=24,eNe=1.2;for(let e=0;e<16;e++)YIe.lines[e]={sps:Jb,nSec:10,units:"mV"},XIe[e]={sps:Jb,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:.96*1e3*eNe/(ZIe*(Math.pow(2,QIe)-1))};var tNe=new TextDecoder;function tL(e){let t={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0},r=tNe.decode(e),n=r.split("|");if(n.length===3)t.timestamp=Date.now(),t.red=parseInt(n[0]),t.infrared=parseInt(n[1]),t.heg=parseFloat(n[2]);else return n.length>=2?(t.timestamp=Date.now(),t.red=parseInt(n[1]),t.infrared=parseInt(n[2]),t.heg=parseFloat(n[3]),n[4]&&(t.ambient=parseFloat(n[4])),n[5]&&(t.temperature=parseFloat(n[5])),t):r}var WP=40,rL={deviceType:"USB",deviceName:"hegduino",baudRate:115200,write:`t
`,codec:tL,sps:WP},lZ=Object.assign({},rL);lZ.sps=19;var rNe={deviceType:"BLE",deviceName:"hegduino",sps:WP,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:!0,notifyCallback:void 0,codec:tL,sps:WP}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:!0,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0}}},androidWebBLE:"o"},cZ=Object.assign({},rL);cZ.sps=19;function Kb(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r=32,n={red:new Array(r),ir:new Array(r),max_dietemp:tt.get2sCompliment(t[193],8)+.0625*t[194],timestamp:Date.now()},i=0;for(;i<r;){let s=i*6;i%2===0?(n.ir[i]=(t[s+1]<<16|t[s+2]<<8|t[s+3])&524287,n.ir[i+1]=(t[s+4]<<16|t[s+5]<<8|t[s+6])&524287):(n.red[i-1]=(t[s+1]<<16|t[s+2]<<8|t[s+3])&524287,n.red[i]=(t[s+4]<<16|t[s+5]<<8|t[s+6])&524287),i++}return n}function Yb(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={ax:new Array(20),ay:new Array(20),az:new Array(20),gx:new Array(20),gy:new Array(20),gz:new Array(20),mpu_dietemp:(tt.bytesToInt16(t[241],t[242])+521)/340+35,timestamp:Date.now()};for(let n=0;n<20;n++){let i=n*12;r.ax[n]=tt.bytesToInt16(t[i+1],t[i+2]),r.ay[n]=tt.bytesToInt16(t[i+3],t[i+4]),r.az[n]=tt.bytesToInt16(t[i+5],t[i+6]),r.gx[n]=tt.bytesToInt16(t[i+7],t[i+8]),r.gy[n]=tt.bytesToInt16(t[i+9],t[i+10]),r.gz[n]=tt.bytesToInt16(t[i+11],t[i+12])}return r}function uZ(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let n=0;n<7;n++){let i=n*26+1;if(!t[i+23])break;r[0][n]=tt.bytesToUInt24(t[i],t[i+1],t[i+2]),r[1][n]=tt.bytesToUInt24(t[i+3],t[i+4],t[i+5]),r[2][n]=tt.bytesToUInt24(t[i+6],t[i+7],t[i+8]),r[3][n]=tt.bytesToUInt24(t[i+9],t[i+10],t[i+11]),r[4][n]=tt.bytesToUInt24(t[i+12],t[i+13],t[i+14]),r[5][n]=tt.bytesToUInt24(t[i+15],t[i+16],t[i+17]),r[6][n]=tt.bytesToUInt24(t[i+18],t[i+19],t[i+20]),r[7][n]=tt.bytesToUInt24(t[i+21],t[i+22],t[i+23])}return r}var US=250,nNe={deviceType:"BLE",deviceName:"cognixionONE",services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:!0,notifyCallback:void 0,codec:uZ,sps:US}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:!0}}},sps:US},fZ=Object.assign({},HP);fZ.sps=US;fZ.deviceName="cognixionONE";var wc={nSec:10,sps:US,units:"mV"},lXe={lines:{0:JSON.parse(JSON.stringify(wc)),1:JSON.parse(JSON.stringify(wc)),2:JSON.parse(JSON.stringify(wc)),3:JSON.parse(JSON.stringify(wc)),4:JSON.parse(JSON.stringify(wc)),5:JSON.parse(JSON.stringify(wc)),6:JSON.parse(JSON.stringify(wc)),7:JSON.parse(JSON.stringify(wc))}};var Aa={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function dZ(e){let t={},r=0;for(;r<e.length;)if(Aa[e[r]]&&r+1+Aa[e[r]].byteLength<=e.length){let n=e.slice(r+1,r+1+Aa[e[r]].byteLength).buffer,i=tt.struct(Aa[e[r]].format).unpack(n),s=Aa[e[r]].type;s==="unfilteredHEG"||s==="heg"?i=i[0]/256:(s==="POOR_SIGNAL"||s==="sampleNumber"||s==="debug0"||s==="debug1"||s==="debug2"||s==="debug3")&&(i=i[0]),t[Aa[e[r]].type]?Array.isArray(i)?t[Aa[e[r]].type].push(...i):t[Aa[e[r]].type].push(i):Array.isArray(i)?t[Aa[e[r]].type]=i:t[Aa[e[r]].type]=[i],r+=Aa[e[r]].byteLength+1}else r++;return t.timestamp=Date.now(),t}var iNe={deviceType:"USB",deviceName:"peanut",baudRate:38400,bufferSize:400,write:`protocol 3
`,buffering:{searchBytes:new Uint8Array([170,170])},codec:dZ,sps:10.101};var sNe=1013.25,Xb=e=>{let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={timestamp:Date.now(),temp:[],pressure:[],altitude:[]},n=0;if(t[0].length===74&&(n=1),n){r.humidity=[];for(let i=0;i<3;i++){let s=i*24+2,a=tt.bytesToInt32(t[3+s],t[2+s],t[1+s],t[0+s]),o=tt.bytesToInt32(t[7+s],t[6+s],t[5+s],t[4+s]);r.temp.push(a+o/Math.pow(10,Math.ceil(Math.log10(o))));let l=10*tt.bytesToInt32(t[11+s],t[10+s],t[9+s],t[8+s]),c=tt.bytesToInt32(t[15+s],t[14+s],t[13+s],t[12+s]);r.pressure.push(l+c/Math.pow(10,Math.ceil(Math.log10(c))));let f=tt.bytesToInt32(t[19+s],t[18+s],t[17+s],t[16+s]),u=tt.bytesToInt32(t[23+s],t[22+s],t[21+s],t[20+s]);r.humidity.push(f+u/Math.pow(10,Math.ceil(Math.log10(u)))),r.altitude.push(RX(r.pressure[i],r.temp[i]))}}else for(let i=0;i<3;i++){let s=i*16+2,a=tt.bytesToInt32(t[3+s],t[2+s],t[1+s],t[0+s]),o=tt.bytesToInt32(t[7+s],t[6+s],t[5+s],t[4+s]);r.temp.push(a+o/Math.pow(10,Math.ceil(Math.log10(o))));let l=10*tt.bytesToInt32(t[11+s],t[10+s],t[9+s],t[8+s]),c=tt.bytesToInt32(t[15+s],t[14+s],t[13+s],t[12+s]);r.pressure.push(l+c/Math.pow(10,Math.ceil(Math.log10(c)))),r.altitude.push(RX(r.pressure[i],r.temp[i]))}return r};function RX(e,t){return 44330*(1-Math.pow(e/sNe,.1903))}function pZ(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};if(t[0]===2)Object.assign(r,wf(t.subarray(2)));else if(t[0]===3){let n=Object.assign(r,wf(t.subarray(2)));Object.keys(n).forEach((i,s)=>{r[s+8]=n[i]})}else t[0]===4?Object.assign(r,Yb(t.subarray(2))):t[0]===5?Object.assign(r,Kb(t.subarray(2))):t[0]===6?Object.assign(r,Xb(t.subarray(2))):Object.assign(r,Object.assign(r,wf(t.subarray(2))));return r}function aNe(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};if(t[0]===2)Object.assign(r,$S(t.subarray(2)));else if(t[0]===3){let n=Object.assign(r,wf(t.subarray(2)));Object.keys(n).forEach((i,s)=>{r[s+8]=n[i]})}else t[0]===4?Object.assign(r,Yb(t.subarray(2))):t[0]===5?Object.assign(r,Kb(t.subarray(2))):t[0]===6?Object.assign(r,Xb(t.subarray(2))):Object.assign(r,Object.assign(r,$S(t.subarray(2))));return r}var oNe={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:pZ,sps:250},lNe={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:aNe,sps:250},cNe={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:wf,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Kb,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Yb,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:wf,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Xb,sps:3.33}}}},uNe={deviceType:"BLE",deviceName:"nrf5x_singleended",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:$S,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Kb,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Yb,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:$S,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Xb,sps:3.33}}}},Sc={nSec:10,sps:250,units:"mV"},cXe={lines:{0:JSON.parse(JSON.stringify(Sc)),1:JSON.parse(JSON.stringify(Sc)),2:JSON.parse(JSON.stringify(Sc)),3:JSON.parse(JSON.stringify(Sc)),4:JSON.parse(JSON.stringify(Sc)),5:JSON.parse(JSON.stringify(Sc)),6:JSON.parse(JSON.stringify(Sc)),7:JSON.parse(JSON.stringify(Sc))},generateNewLines:!0,cleanGeneration:!1},fNe=32,dNe=24,pNe=1.2,yi={sps:250,useDCBlock:!1,useBandpass:!1,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:.96*1e3*pNe/(fNe*(Math.pow(2,dNe)-1))},uXe={0:JSON.parse(JSON.stringify(yi)),1:JSON.parse(JSON.stringify(yi)),2:JSON.parse(JSON.stringify(yi)),3:JSON.parse(JSON.stringify(yi)),4:JSON.parse(JSON.stringify(yi)),5:JSON.parse(JSON.stringify(yi)),6:JSON.parse(JSON.stringify(yi)),7:JSON.parse(JSON.stringify(yi)),8:JSON.parse(JSON.stringify(yi)),9:JSON.parse(JSON.stringify(yi)),10:JSON.parse(JSON.stringify(yi)),11:JSON.parse(JSON.stringify(yi)),12:JSON.parse(JSON.stringify(yi)),13:JSON.parse(JSON.stringify(yi)),14:JSON.parse(JSON.stringify(yi)),15:JSON.parse(JSON.stringify(yi))},hNe=new TextDecoder;function nL(e){let t={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0},r=hNe.decode(e),n=r.split("|");return n.length>=5?(t.timestamp=Date.now(),t.left_red=parseInt(n[1]),t.left_infrared=parseInt(n[2]),t.left_heg=parseFloat(n[3]),t.center_red=parseInt(n[4]),t.center_infrared=parseInt(n[5]),t.center_heg=parseFloat(n[6]),t.right_red=parseInt(n[7]),t.right_infrared=parseInt(n[8]),t.right_heg=parseFloat(n[9]),t):r}var gNe={deviceType:"USB",deviceName:"statechanger",baudRate:115200,codec:nL,sps:20},yNe={deviceType:"BLE",deviceName:"statechanger",sps:20,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:!0,notifyCallback:void 0,codec:nL}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:!0,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0}}},androidWebBLE:"o"};function hZ(e){let t={red:e.getInt32(2),ir:e.getInt32(6),ir2:e.getInt32(10),timestamp:Date.now()};return t.heg=t.red/(.5*(t.ir+t.ir2)),t}var $X=40,mNe={deviceType:"BLE",deviceName:"blueberry",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:!0,notifyCallback:void 0,codec:hZ,sps:$X}}},sps:$X};function bNe(e){let t={sred:e.getInt32(2),sir:e.getInt32(6),sir2:e.getInt32(10),timestamp:Date.now()};return t.sheg=t.sred/(.5*(t.sir+t.sir2)),t}function vNe(e){let t={red:e.getInt32(2),ir:e.getInt32(6),ir2:e.getInt32(10),timestamp:Date.now()};return t.heg=t.sred/(.5*(t.ir+t.ir2)),t}var DP=40,_Ne={deviceType:"BLE",deviceName:"blueberry2",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:!0,notifyCallback:void 0,codec:vNe,sps:DP},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:!0,notifyCallback:void 0,codec:bNe,sps:DP}}},sps:DP};function gZ(e){return{hr:e.getInt8(1),timestamp:Date.now()}}var wNe={deviceType:"BLE",deviceName:"heartrate",services:{heart_rate:{heart_rate_measurement:{notify:!0,notifyCallback:void 0,codec:gZ}}}},yZ={sps:250,deviceType:"CUSTOM",deviceName:"simulator",simulate:{0:{sps:250,freq:1,amplitude:1,offset:0},1:{sps:250,freq:10,amplitude:1,offset:0},2:{sps:250,freq:100,amplitude:.5,offset:.5},3:{sps:250,freq:25,amplitude:1,offset:0}},connect:(e={})=>new Promise(async(t,r)=>{let i={_id:`simulated${Math.floor(Math.random()*1e15)}`,settings:Object.assign(Object.assign({},yZ),e)};i.settings.looping=!0;let s=50,a=Date.now(),o=()=>{if(i.settings.looping){let l={},c=Date.now(),f=c-a;for(let u in i.settings.simulate){let d=Math.floor(i.settings.simulate[u].sps*f/1e3);l[u]=new Array(d).fill(0),l[u]=l[u].map((p,_)=>Math.sin(2*Math.PI*i.settings.simulate[u].freq*.001*(a+f*(_+1)/d))*i.settings.simulate[u].amplitude+i.settings.simulate[u].offset)}a=c,l.timestamp=a,i.settings.ondata(l),setTimeout(()=>{o()},s)}};o(),i.settings.onconnect&&i.settings.onconnect(i),t(i)}),codec:e=>e,disconnect:e=>{console.log(e),e.settings.looping=!1,e.settings.ondisconnect(e)},onconnect:e=>{console.log("simulator connected!",e)},ondisconnect:e=>{console.log("simulator disconnected!",e)},ondata:e=>{}},SNe=class{constructor(e={sps:512,useSMA4:!1,useNotch50:!0,useNotch60:!0,useLowpass:!1,lowpassHz:100,useBandpass:!1,bandpassLower:3,bandpassUpper:45,useDCBlock:!0,DCBresonance:.995,trimOutliers:!1,outlierTolerance:.2,useScaling:!1,scalar:1}){this.idx=0,this.sps=e.sps,this.bandpassLower=e.bandpassLower?e.bandpassLower:3,this.bandpassUpper=e.bandpassUpper?e.bandpassUpper:45,this.useSMA4=e.useSMA4,this.last4=[],this.useNotch50=e.useNotch50,this.useNotch60=e.useNotch60,this.useLowpass=e.useLowpass,this.lowpassHz=e.lowpassHz?e.lowpassHz:100,this.useBandpass=e.useBandpass,this.useDCBlock=e.useDCBlock,this.DCBresonance=e.DCBresonance?e.DCBresonance:.995,this.useScaling=e.useScaling,this.scalar=e.scalar,this.trimOutliers=e.trimOutliers,this.outlierTolerance=e.outlierTolerance;let t=this.sps;this.notch50=[xc(50,t,2),xc(100,t,2)],this.notch60=[xc(60,t,2),xc(120,t,2)],this.lp1=[new mi("lowpass",this.lowpassHz,t),new mi("lowpass",this.lowpassHz,t),new mi("lowpass",this.lowpassHz,t),new mi("lowpass",this.lowpassHz,t)],this.bp1=[Ys(this.bandpassLower,this.bandpassUpper,t,1),Ys(this.bandpassLower,this.bandpassUpper,t,1),Ys(this.bandpassLower,this.bandpassUpper,t,1),Ys(this.bandpassLower,this.bandpassUpper,t,1)],this.dcb=new UX(e.DCBresonance?e.DCBresonance:.995)}reset(e=this.sps){this.notch50=[xc(50,e,2),xc(100,e,2)],this.notch60=[xc(60,e,2),xc(120,e,2)],this.lp1=[new mi("lowpass",this.lowpassHz,e),new mi("lowpass",this.lowpassHz,e),new mi("lowpass",this.lowpassHz,e),new mi("lowpass",this.lowpassHz,e)],this.bp1=[Ys(this.bandpassLower,this.bandpassUpper,e,1),Ys(this.bandpassLower,this.bandpassUpper,e,1),Ys(this.bandpassLower,this.bandpassUpper,e,1),Ys(this.bandpassLower,this.bandpassUpper,e,1)],this.dcb=new UX(this.DCBresonance)}setBandpass(e=this.bandpassLower,t=this.bandpassUpper,r=this.sps){this.bandpassLower=e,this.bandpassUpper=t,this.bp1=[Ys(e,t,r),Ys(e,t,r),Ys(e,t,r),Ys(e,t,r)]}apply(e=0){let t=e;return this.useScaling===!0&&(t*=this.scalar),this.filtered&&this.trimOutliers&&this.outlierTolerance&&Math.abs(t-this.filtered)>this.outlierTolerance&&(t=this.filtered),this.useDCBlock===!0&&(t=this.dcb.applyFilter(t)),this.useSMA4===!0&&(this.last4.length<4?this.last4.push(t):(t=this.last4.reduce((r,n)=>r+n)/this.last4.length,this.last4.shift(),this.last4.push(t))),this.useNotch50===!0&&this.notch50.forEach((r,n)=>{t=r.applyFilter(t)}),this.useNotch60===!0&&this.notch60.forEach((r,n)=>{t=r.applyFilter(t)}),this.useLowpass===!0&&this.lp1.forEach((r,n)=>{t=r.applyFilter(t)}),this.useBandpass===!0&&this.bp1.forEach((r,n)=>{t=r.applyFilter(t)}),this.filtered=t,this.idx++,t}},mi=class{constructor(e,t,r,n=1/Math.sqrt(2),i=0){if(this.a0=0,this.a1=0,this.a2=0,this.b0=0,this.b1=0,this.b2=0,this.x1=0,this.x2=0,this.y1=0,this.y2=0,["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"].indexOf(e)<0){console.error("Valid types: 'lowpass','highpass','bandpass','notch','peak','lowshelf','highshelf'");return}this.type=e,this.freq=t,this.sps=r,this.Q=n,this.dbGain=i;let a=Math.pow(10,i/40),o=2*Math.PI*t/r,l=Math.sin(o),c=Math.cos(o),f=l/(2*n),u=Math.sqrt(a+a);this[e](a,l,c,f,u),this.b0/=this.a0,this.b1/=this.a0,this.b2/=this.a0,this.a1/=this.a0,this.a2/=this.a0}lowpass(e,t,r,n,i){this.b0=(1-r)*.5,this.b1=1-r,this.b2=(1-r)*.5,this.a0=1+n,this.a1=-2*r,this.a2=1-n}highpass(e,t,r,n,i){this.b0=(1+r)*.5,this.b1=-(1+r),this.b2=(1+r)*.5,this.a0=1+n,this.a1=-2*r,this.a2=1-n}bandpass(e,t,r,n,i){this.b0=n,this.b1=0,this.b2=-n,this.a0=1+n,this.a1=-2*r,this.a2=1-n}notch(e,t,r,n,i){this.b0=1,this.b1=-2*r,this.b2=1,this.a0=1+n,this.a1=-2*r,this.a2=1-n}peak(e,t,r,n,i){this.b0=1+n*e,this.b1=-2*r,this.b2=1-n*e,this.a0=1+n/e,this.a1=-2*r,this.a2=1-n/e}lowshelf(e,t,r,n,i){this.b0=e*(e+1-(e-1)*r+i*t),this.b1=2*e*(e-1-(e+1)*r),this.b2=e*(e+1-(e-1)*r-i*t),this.a0=e+1+(e+1)*r+i*t,this.a1=2*(e-1+(e+1)*r),this.a2=e+1+(e-1)*r-i*t}highshelf(e,t,r,n,i){this.b0=e*(e+1+(e-1)*r+i*t),this.b1=2*e*(e-1+(e+1)*r),this.b2=e*(e+1-(e-1)*r-i*t),this.a0=e+1-(e+1)*r-i*t,this.a1=2*(e-1-(e+1)*r),this.a2=e+1-(e-1)*r-i*t}applyFilter(e){let t=this.b0*e+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;return this.x2=this.x1,this.x1=e,this.y2=this.y1,this.y1=t,t}zResult(e){try{let t=Math.pow(Math.sin(Math.PI*e*2/(2*this.sps)),2);return(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*t+16*this.b0*this.b2*t*t)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*t+16*this.a2*t*t)}catch{return-200}}static calcCenterFrequency(e,t){return(e+t)/2}static calcBandwidth(e,t){return t-this.calcCenterFrequency(e,t)}static calcBandpassQ(e,t,r=Math.pow(10,Math.floor(Math.log10(e)))){return r*Math.sqrt((e-t)*(e+t))/(2*t)}static calcNotchQ(e,t,r=Math.pow(10,Math.floor(Math.log10(e)))){return r*e*t/Math.sqrt((e-t)*(e+t))}},UX=class{constructor(e=.995){this.r=e,this.y1=this.y2=this.x1=this.x2=0}applyFilter(e){this.x2=this.x1,this.x1=e;let t=this.x1-this.x2+this.r*this.y1;return this.y2=this.y1,this.y1=t,t}},xc=(e,t,r)=>new mi("notch",e,t,mi.calcNotchQ(e,r),0),Ys=(e,t,r,n=Math.pow(10,Math.floor(Math.log10(mi.calcCenterFrequency(e,t)))))=>new mi("bandpass",mi.calcCenterFrequency(e,t),r,mi.calcBandpassQ(mi.calcCenterFrequency(e,t),mi.calcBandwidth(e,t),n),0),CS={sps:250,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45},fXe={0:JSON.parse(JSON.stringify(CS)),1:JSON.parse(JSON.stringify(CS)),2:JSON.parse(JSON.stringify(CS)),3:JSON.parse(JSON.stringify(CS))},IS={nSec:10,sps:250,units:"mV"},dXe={lines:{0:JSON.parse(JSON.stringify(IS)),1:JSON.parse(JSON.stringify(IS)),2:JSON.parse(JSON.stringify(IS)),3:JSON.parse(JSON.stringify(IS)),ax:{nSec:10,sps:250,units:"mg"},ay:{nSec:10,sps:250,units:"mg"},az:{nSec:10,sps:250,units:"mg"}},generateNewLines:!0},qb={sps:250,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45},pXe={0:JSON.parse(JSON.stringify(qb)),1:JSON.parse(JSON.stringify(qb)),2:JSON.parse(JSON.stringify(qb)),3:JSON.parse(JSON.stringify(qb)),4:JSON.parse(JSON.stringify(qb))};var qS={BLE:{nrf5x:cNe,nrf5x_singleended:uNe,hegduino:rNe,hegduinoV1:cZ,cognixionONE:nNe,statechanger:yNe,blueberry:mNe,blueberry2:_Ne,heart_rate:wNe,freeEEG16:GIe},USB:{nrf5x:oNe,nrf5x_singleended:lNe,freeEEG16:KIe,freeEEG32:qIe,freeEEG32_optical:VIe,freeEEG128:$Ie,hegduino:rL,hegduinoV1:lZ,cyton:HP,cyton_daisy:RIe,peanut:iNe,statechanger:gNe,cognixionONE:HP},BLE_CUSTOM:{},USB_CUSTOM:{},CUSTOM:{simulator:yZ}};var xNe=new TextDecoder,kNe={raw:e=>e?.buffer?Array.from(new Uint8Array(e)):e,utf8:e=>xNe.decode(e),"console-f12":e=>(e?.buffer&&(e=Array.from(new Uint8Array(e))),console.log(e),e),debug:(e,t)=>(e?.buffer&&(e=Array.from(new Uint8Array(e))),console.log(t,e),e),ads131m08:wf,arduino_ads131m08:BIe,max3010x:Kb,mpu6050:Yb,bme280:Xb,freeeeg16:oZ,freeeeg32:eL,freeeeg128:aZ,cyton:sZ,cognixionONE_BLE:uZ,hegduino:tL,nrf5x:pZ,peanut:dZ,statechanger:nL,blueberry:hZ,heart_rate:gZ};var ENe=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(a,o){var l=t.length-1,c=t[l];if(typeof c=="object")if(c[a]===o||l===0)r.push(a),t.push(o.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[a]===o){l+=2,t.length=l,r.length=l,--l,t[l]=o,r[l]=a;break}l--}}function s(a,o){if(o!=null&&typeof o=="object"){a&&i(a,o);let l=e.get(o);if(l)return"[Circular Reference]"+l;e.set(o,r.join("."))}return o}return function(o,l){try{return t.push(o),JSON.stringify(o,s,l)}finally{n()}}}();JSON.stringifyWithCircularRefs===void 0&&(JSON.stringifyWithCircularRefs=ENe);var ONe=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(a,o){var l=t.length-1;if(t[l]){var c=t[l];if(typeof c=="object")if(c[a]===o||l===0)r.push(a),t.push(o.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[a]===o){l+=2,t.length=l,r.length=l,--l,t[l]=o,r[l]=a;break}l++}}}function s(a,o){let l;if(o!=null)if(typeof o=="object"){let c=o.constructor.name;a&&c==="Object"&&i(a,o);let f=e.get(o);if(f)return"[Circular Reference]"+f;if(e.set(o,r.join(".")),c==="Array")o.length>20?l=o.slice(o.length-20):l=o;else if(c.includes("Set"))l=Array.from(o);else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean")l="instanceof_"+c;else if(c==="Object"){let u={};for(let d in o)if(o[d]==null)u[d]=o[d];else if(Array.isArray(o[d]))o[d].length>20?u[d]=o[d].slice(o[d].length-20):u[d]=o[d];else if(o[d].constructor.name==="Object"){u[d]={};for(let p in o[d])if(Array.isArray(o[d][p]))o[d][p].length>20?u[d][p]=o[d][p].slice(o[d][p].length-20):u[d][p]=o[d][p];else if(o[d][p]!=null){let _=o[d][p].constructor.name;_.includes("Set")?u[d][p]=Array.from(o[d][p]):_!=="Number"&&_!=="String"&&_!=="Boolean"?u[d][p]="instanceof_"+_:u[d][p]=o[d][p]}else u[d][p]=o[d][p]}else{let p=o[d].constructor.name;p.includes("Set")?u[d]=Array.from(o[d]):p!=="Number"&&p!=="String"&&p!=="Boolean"?u[d]="instanceof_"+p:u[d]=o[d]}l=u}else l=o}else l=o;return l}return function(o,l){t.push(o);let c=JSON.stringify(o,s,l);return n(),c}}();JSON.stringifyFast===void 0&&(JSON.stringifyFast=ONe);function ANe(){globalThis.Devices=qS,globalThis.WebSerial=Ph,globalThis.decoders=kNe,globalThis.decoder="raw",globalThis.ByteParser=tt,globalThis.filtering=!1,globalThis.filters={},globalThis.BiquadChannelFilterer=SNe,globalThis.ArrayManip=QP}typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&ANe();var Ch=new BS,TNe=new dIe({roots:{...xIe,...cIe}});function mZ(e,t){if(!e)return;t||(t={ondecoded:s=>{console.log(s)}});let r=e.deviceType,n=e.deviceName;t.workerUrl||(t.workerUrl=OIe),t.service||(t.service=TNe);let i=t.service.addWorker({url:t.workerUrl});if(t.devices||(t.devices=qS),!t.devices[r][n]){let s=Object.assign({},e);for(let a in s)typeof s[a]=="function"&&(s[a]=s[a].toString());i.post("receiveDevice",s)}if(t.filterSettings&&i.post("setFilters",[t.filterSettings]),t.roots){for(let s in t.roots){let a={callback:"decodeAndParseDevice",worker:i};t.roots[s].__parent=t.roots[s].__parent?Object.assign(t.roots[s].__parent,a):a}t.service.load(t.roots)}if(r.includes("CUSTOM"))return new Promise(async(s,a)=>{e.ondata=c=>{t.ondata&&t.ondata(c),typeof t.ondecoded=="function"&&i.run("decodeAndParseDevice",[c,r,n]).then(f=>{t.ondecoded(f)})},e.ondisconnect=()=>{if(t.service.terminate(i._id),t.roots)for(let c in t.roots)t.service.remove(c)};let o=await e.connect(e),l={workers:{streamworker:i},disconnect:()=>{if(t.beforedisconnect&&t.beforedisconnect(l),e.disconnect(o),t.ondisconnect&&t.ondisconnect(l),t.roots)for(let c in t.roots)t.service.remove(c)},device:o,options:t,read:c=>{if(e.read)return new Promise((f,u)=>{f(e.read(e,c))})},write:c=>{if(e.write)return new Promise((f,u)=>{f(e.write(e,c))})},setFilters:(c,f)=>i.run("setFilters",[c,f]),roots:t.roots};t.onconnect&&t.onconnect(l),s(l)}).catch(s=>{if(console.error(s),t.service.terminate(i._id),t.roots)for(let a in t.roots)t.service.remove(a)});if(r==="BLE"){for(let s in e.services){e.services[s].UUID&&(s=e.services[s].UUID);for(let a in e.services[s]){let o=a;if(e.services[s][a].characteristic&&(a=e.services[s][a].characteristic),typeof t.ondecoded=="function"){if(e.services?.[s]?.[o]?.notify){e.services[s][o].notifyCallback||(e.services[s][o].notifyCallback=l=>{t.ondata&&t.ondata(l),i.run("decodeAndParseDevice",[l,r,n,s,o],void 0,[l.buffer]).then(t.ondecoded)});break}}else if(typeof t.ondecoded=="object"){let l=t.ondecoded[a]?t.ondecoded[a]:t.ondecoded[o]?t.ondecoded[o]:null;l&&t.ondecoded[a]&&(e.services?.[s]?.[o]?.notify&&(e.services[s][o].notifyCallback||(e.services[s][o].notifyCallback=c=>{t.ondata&&t.ondata(c),i.run("decodeAndParseDevice",[c,r,n,s,o],void 0,[c.buffer]).then(l)})),e.services?.[s]?.[o]?.read&&(e.services[s][o].readCallback||(e.services[o].readCallback=c=>{t.ondata&&t.ondata(c),i.run("decodeAndParseDevice",[c,r,n,s,o],void 0,[c.buffer]).then(l)})))}else t.ondata&&(e.services?.[s]?.[o]?.notify&&(e.services[s][o].notifyCallback=t.ondata),e.services?.[s]?.[o]?.read&&(e.services[o].readCallback=t.ondata))}}return new Promise((s,a)=>{Ch.setup(e).then(o=>{let l={workers:{streamworker:i},options:t,device:o,subscribe:(c,f,u,d)=>Ch.subscribe(o.device,c,f,p=>{d?u?u(p):t.ondecoded?.[f]?t.ondecoded[f](p):typeof t.ondecoded=="function"&&t.ondecoded(p):i.run("decodeAndParseDevice",[p,r,n,c,f],void 0,[p.buffer]).then(u||(t.ondecoded?.[f]?t.ondecoded[f]:t.ondecoded))}),unsubscribe:(c,f)=>Ch.unsubscribe(o.device,c,f),disconnect:async()=>{if(await Ch.disconnect(o.deviceId),t.ondisconnect&&t.ondisconnect(l),i.terminate(),t.roots)for(let c in t.roots)t.service.remove(c)},read:c=>Ch.read(o.device,c.service,c.characteristic,c.ondata,c.timeout),write:c=>Ch.write(o.device,c.service,c.characteristic,c.data,c.callback,c.timeout),setFilters:(c,f)=>i.run("setFilters",[c,f]),roots:t.roots};t.onconnect&&t.onconnect(l),s(l)}).catch(o=>{if(console.error(o),i.terminate(),t.roots)for(let l in t.roots)t.service.remove(l);a(o)})})}else if(r==="USB"){let s=t.service.addWorker({url:t.workerUrl});s.worker.addEventListener("message",l=>{if(typeof l.data=="string"){if(l.data.includes("disconnected")&&(t.service.terminate(s._id),t.service.terminate(i._id),t.roots))for(let c in t.roots)t.service.remove(c)}else typeof t.ondata=="function"&&t.ondata(l.data)}),s.post("setupSerial");let a=t.service.establishMessageChannel(i.worker,s.worker),o=new Ph;return new Promise((l,c)=>{let f=d=>{if(console.error(d),t.service.terminate(s._id),t.service.terminate(i._id),t.roots)for(let p in t.roots)t.service.remove(p);c(d)},u=d=>{let p;d?p=d.getInfo():p={usbVendorId:e.usbVendorId,usbProductId:e.usbProductId},s.run("openPort",{baudRate:e.baudRate,usbVendorId:p.usbVendorId,usbProductId:p.usbProductId,bufferSize:e.bufferSize,buffering:e.buffering?e.buffering:void 0,frequency:e.frequency?e.frequency:void 0,pipeTo:{route:"decodeAndParseDevice",_id:a,extraArgs:[r,n]},pipeMain:t.ondata!==void 0}).then(_=>{e.write&&s.post("writeStream",[_._id,e.write]),typeof t.ondecoded=="function"&&i.subscribe("decodeAndParseDevice",k=>{t.ondecoded&&t.ondecoded(k)});let w={workers:{streamworker:i,serialworker:s},device:_,options:t,subscribeStream:k=>i.subscribe("decodeAndParseDevice",k),unsubscribeStream:k=>i.unsubscribe("decodeAndParseDevice",k),disconnect:()=>{s.post("closeStream",_._id),t.ondisconnect&&t.ondisconnect(w)},read:()=>new Promise((k,S)=>{let O;O=i.subscribe("decodeAndParseDevice",A=>{s.unsubscribe("decodeAndParseDevice",O),k(A)})}),write:k=>s.run("writeStream",[_._id,k]),setFilters:(k,S)=>i.run("setFilters",[k,S]),roots:t.roots};t.onconnect&&t.onconnect(w),l(w)}).catch(f)};t.reconnect?u():o.requestPort(e.usbVendorId,e.usbProductId).then(d=>{u(d)}).catch(f)})}else return}var iL=null,VS={BLE:{hegduino:"HEGduino",hegduinoV1:"HEGduino V1",statechanger:"Statechanger",blueberry2:"Blueberry",blueberry:"Blueberry V1",nrf5x:"NRF5x"},USB:{hegduino:"HEGduino",hegduinoV1:"HEGduino V1",peanut:"Biocomp Peanut",statechanger:"Statechanger",nrf5x:"NRF5x"}},vZ=async(e,t)=>{if(iL)throw new Error("Already connected to a device");let r=await mZ(qS[e][t],{ondecoded:n=>{Td({decoded:n})},ondisconnect:()=>{iL=null,Td({status:"disconnected"})},onconnect:n=>{iL=n,Td({status:"connected"})}});return Td({device:r}),r},bZ=1e3*60*60,sL;mu("decoded.heg",({value:e})=>{sL||(sL=Date.now());let t=Date.now()-sL,r=(bZ-t)/bZ;Td({focus:(100*e).toFixed(2),mentalfatigue:(100*(1-r)).toFixed(1),cognitiveload:(100*(1/e)/5).toFixed(2)})});var _Z=ae(Je(),1),Xs=ae(vt(),1);function aL({name:e="Dummy Chart",state:t,data:r=[],stroke:n="#8884d8",maxLength:i=200}){let[s,a]=(0,_Z.useState)(r),o=mu(t,l=>{wy(t,o),Array.isArray(l.value)?l.value.forEach(f=>s.push({timestamp:Date.now(),[t]:f})):s.push({timestamp:Date.now(),[t]:l.value});let c=[...s];c.length>i?a(c.slice(-i)):a(c)});return(0,Xs.jsx)(Xs.Fragment,{children:(0,Xs.jsx)("div",{className:"flex justify-center w-full",children:(0,Xs.jsxs)("div",{children:[(0,Xs.jsx)("span",{className:"block font-semibold text-xl w-full text-center p-2",children:e}),(0,Xs.jsxs)(r3,{width:730,height:250,data:s,children:[(0,Xs.jsx)(sb,{strokeDasharray:"3 3"}),(0,Xs.jsx)(Sa,{}),(0,Xs.jsx)(uc,{type:"monotone",dataKey:t,isAnimationActive:!1,stroke:n,dot:!1})]})]})})})}var wZ=ae(Je(),1);var Lh=class extends wZ.Component{constructor(r={state:xt}){super(r);br(this,"statemgr",xt);br(this,"state_subs",{});br(this,"UPDATED",[]);br(this,"unique",`component${Math.floor(Math.random()*1e15)}`);br(this,"react_setState",this.setState.bind(this));r.state&&(this.statemgr=r.state),this.setState=n=>{this.UPDATED=Object.keys(n),this.react_setState(n),typeof n=="object"&&xt.setState(n)},setTimeout(()=>{let n={};for(let i in this.state)r?.doNotSubscribe&&r.doNotSubscribe.indexOf(i)>-1||(i in this.statemgr.data&&(n[i]=this.statemgr.data[i]),this.state_subs[i]=this.__subscribeComponent(i));Object.keys(n).length>0&&this.react_setState(n)},.001)}__subscribeComponent(r,n){let i=this.statemgr.subscribeEvent(r,s=>{if(typeof this>"u")this.statemgr.unsubscribeEvent(r,i);else{n&&n(s);let o=this.UPDATED.indexOf(r);o>-1?this.UPDATED.splice(o,1):this.react_setState({[r]:s})}});return i}__unsubscribeComponent(r){if(!r)for(let n in this.state_subs)this.statemgr.unsubscribeEvent(n,this.state_subs[n])}};var INe=Object.create,vL=Object.defineProperty,NNe=Object.getOwnPropertyDescriptor,IZ=Object.getOwnPropertyNames,PNe=Object.getPrototypeOf,LNe=Object.prototype.hasOwnProperty,FNe=(e,t,r)=>t in e?vL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,DNe=(e=>typeof ar<"u"?ar:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof ar<"u"?ar:t)[r]}):e)(function(e){if(typeof ar<"u")return ar.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),jNe=(e,t)=>function(){return t||(0,e[IZ(e)[0]])((t={exports:{}}).exports,t),t.exports},BNe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of IZ(t))!LNe.call(e,i)&&i!==r&&vL(e,i,{get:()=>t[i],enumerable:!(n=NNe(t,i))||n.enumerable});return e},MNe=(e,t,r)=>(r=e!=null?INe(PNe(e)):{},BNe(t||!e||!e.__esModule?vL(r,"default",{value:e,enumerable:!0}):r,e)),RNe=(e,t,r)=>(FNe(e,typeof t!="symbol"?t+"":t,r),r),$Ne=jNe({"node_modules/web-worker/cjs/browser.js"(e,t){t.exports=Worker}}),UNe=class{data={};triggers={};ctr=0;constructor(e){typeof e=="object"&&(this.data=e)}setState=e=>{Object.assign(this.data,e);let t=Object.getOwnPropertyNames(e);for(let r of t)this.triggerEvent(r,this.data[r]);if(this.triggers[Zb]){let r=i=>{i(e)},n=this.triggers[Zb].length;for(let i=n-1;i>=0;i--)r(this.triggers[Zb][i].onchange)}return this.data};setValue=(e,t)=>{this.data[e]=t,this.triggerEvent(e,t)};triggerEvent=(e,t)=>{if(this.triggers[e]){let r=i=>{i.onchange(t)},n=this.triggers[e].length;for(let i=n-1;i>=0;i--)r(this.triggers[e][i])}};subscribeState=e=>this.subscribeEvent(Zb,e);unsubscribeState=e=>this.unsubscribeEvent(Zb,e);subscribeEvent=(e,t,r,n)=>{if(e){r&&n&&!this.triggers[e]&&Object.defineProperty(this.data,e,{get:()=>r[n],set:s=>{r[n]=s},enumerable:!0,configurable:!0}),this.triggers[e]||(this.triggers[e]=[]);let i=this.ctr;return this.ctr++,this.triggers[e].push({sub:i,onchange:t}),i}else return};unsubscribeEvent=(e,t)=>{let r=this.triggers[e];if(r)if(t===void 0)delete this.triggers[e],delete this.data[e];else{let n,i=r.find((s,a)=>{if(s.sub===t)return n=a,!0});return i&&r.splice(n,1),Object.keys(r).length===0&&(delete this.triggers[e],delete this.data[e]),this.onRemoved&&this.onRemoved(i),!0}};subscribeEventOnce=(e,t)=>{let r,n=i=>{t(i),this.unsubscribeEvent(e,r)};return r=this.subscribeEvent(e,n),r};getEvent=(e,t)=>{for(let r in this.triggers[e])if(this.triggers[e][r].sub===t)return this.triggers[e][r]};getSnapshot=()=>{let e={};for(let t in this.data)e[t]=this.data[t]};onRemoved},Zb="*s",NZ=new UNe,xr=class{__node={tag:`node${Math.floor(Math.random()*1e15)}`,unique:`${Math.floor(Math.random()*1e15)}`,state:NZ};__children;__parent;__operator;__listeners;__props;__args;constructor(e,t,r){this.__setProperties(e,t,r)}__setProperties=(e,t,r)=>{if((()=>{let i=e;typeof e=="function"?pL(e)?e=new e:e={__operator:e,__node:{forward:!0,tag:e.name}}:typeof e=="string"&&r?.get(e)&&(e=r.get(e)),"__node"in e||(e.__node={}),e.__node.initial||(e.__node.initial=i)})(),typeof e=="object"){let i=()=>{e.__node?.state?this.__node.state=e.__node.state:r&&(e.__node.state=r.__node.state)},s=()=>{e.__props&&(typeof e.__props=="function"&&(e.__props=new e.__props),typeof e.__props=="object"&&this.__proxyObject(e.__props))},a=()=>{e.__node.tag||(e.__operator?.name?e.__node.tag=e.__operator.name:e.__node.tag=`node${Math.floor(Math.random()*1e15)}`)},o=()=>{typeof e.__node=="string"?r?.get(e.__node.tag)?e=r.get(e.__node.tag):e.__node={}:e.__node||(e.__node={}),r&&(e.__node.graph=r),e instanceof xf&&(e.__node.source=e)},l=()=>{if(!e.__parent&&t&&(e.__parent=t),t?.__node&&!(t instanceof xf||e instanceof xf)&&(e.__node.tag=t.__node.tag+"."+e.__node.tag),t instanceof xf&&e instanceof xf&&(e.__node.loaders&&Object.assign(t.__node.loaders?t.__node.loaders:{},e.__node.loaders),t.__node.mapGraphs)){e.__node.nodes.forEach(p=>{t.set(e.__node.tag+"."+p.__node.tag,p)});let d=()=>{e.__node.nodes.forEach(p=>{t.__node.nodes.delete(e.__node.tag+"."+p.__node.tag)})};this.__addOndisconnected(d)}},c=()=>{if(typeof e.default=="function"&&!e.__operator&&(e.__operator=e.default),e.__operator){if(typeof e.__operator=="string"&&r){let d=r.get(e.__operator);d&&(e.__operator=d.__operator),!e.__node.tag&&e.__operator.name&&(e.__node.tag=e.__operator.name)}typeof e.__operator=="function"&&(e.__operator=this.__setOperator(e.__operator)),e.default&&(e.default=e.__operator)}},f=()=>{e.__node=Object.assign(this.__node,e.__node);let d=Object.getOwnPropertyNames(e).filter(p=>{if(!gL[p])return!0});for(let p of d)p in e&&(this[p]=e[p])},u=()=>{this.__onconnected&&(typeof this.__onconnected=="function"?this.__onconnected=this.__onconnected.bind(this):Array.isArray(this.__onconnected)&&(this.__onconnected=this.__onconnected.map(d=>d.bind(this))),typeof this.__ondisconnected=="function"?this.__ondisconnected=this.__ondisconnected.bind(this):Array.isArray(this.__ondisconnected)&&(this.__ondisconnected=this.__ondisconnected.map(d=>d.bind(this))))};i(),a(),s(),o(),l(),f(),u(),c()}};__subscribe=(e,t,r,n,i,s)=>{let a=(l,c=(u,d)=>d||u,f=e)=>{let u;if(s){let _=hL(f,s,this.__node.graph);f=_.__callback,u=_.__args}let d=this.__node.state.subscribeEvent(l,f,this,t),p=this.__node.state.getEvent(l,d);return this.__listeners||(this.__listeners={}),this.__listeners[l]=this.__node.state.triggers[l],p&&(p.source=this.__node.tag,t&&(p.key=t),p.target=c(e,n),r&&(p.subInput=r),s&&(p.arguments=s,p.__args=u),i&&(p.tkey=i),p.node=this,p.graph=this.__node.graph),d},o=l=>{let c=this.__node.graph.get(l);if(!c&&l.includes(".")){n=l.substring(0,l.lastIndexOf("."));let f=this.__node.graph.get(l.substring(0,n));i=l.lastIndexOf(".")+1,f&&typeof f[t]=="function"&&(l=(...u)=>f[i](...u))}else c.__operator&&(l=c.__operator,i="__operator")};if(t){if((!this.__node.localState||!this.__node.localState[t])&&this.__addLocalState(this,t),typeof e=="string"){if(i=e,n){if(this.__node.graph?.get(n)){let f=this.__node.graph?.get(n);if(typeof f[e]=="function"){let u=f[e];e=(...d)=>{u(...d)}}else{let u=e;e=p=>{f[u]=p}}}}else if(typeof this[e]=="function"){let f=this[e];e=(...u)=>{f(...u)}}else this.__node.graph?.get(e)&&o(e);if(typeof e!="function")return}let l,c=r?this.__node.unique+"."+t+"input":this.__node.unique+"."+t;return typeof e=="function"?l=a(c,(f,u)=>u||f,e):e?.__node&&(l=a(c,(f,u)=>u||f.__node.unique,(...f)=>{e.__operator&&e.__operator(...f)})),l}else{if(typeof e=="string"&&(this.__node.graph.get(e)&&(e=this.__node.graph.get(e)),i="__operator",typeof e!="object"))return;let l,c=r?this.__node.unique+"input":this.__node.unique;return typeof e=="function"?l=a(c,(f,u)=>u||f,e):e?.__node&&(l=a(c,(f,u)=>u||f.__node.unique,(...f)=>{e.__operator&&e.__operator(...f)})),l}};__unsubscribe=(e,t,r)=>t?this.__node.state.unsubscribeEvent(r?this.__node.unique+"."+t+"input":this.__node.unique+"."+t,e):this.__node.state.unsubscribeEvent(r?this.__node.unique+"input":this.__node.unique,e);__setOperator=e=>{e=e.bind(this),this.__args&&this.__node.graph&&(e=hL(e,this.__args,this.__node.graph).__callback);let t=`${this.__node.unique}input`;if(this.__operator=(...r)=>{this.__node.state.triggers[t]&&this.__node.state.setValue(t,r);let n=e(...r);return this.__node.state.triggers[this.__node.unique]&&(typeof n?.then=="function"?n.then(i=>{i!==void 0&&this.__node.state.setValue(this.__node.unique,i)}).catch(console.error):n!==void 0&&this.__node.state.setValue(this.__node.unique,n)),n},this.__parent instanceof xr&&!this.__subscribedToParent&&this.__parent.__operator){let r=this.__parent.__subscribe(this),n=()=>{this.__parent?.__unsubscribe(r),delete this.__subscribedToParent};this.__addOndisconnected(n),this.__subscribedToParent=!0}return this.__operator};__addLocalState=(e,t)=>{if(!e)return;this.__node.localState||(this.__node.localState={});let r=this.__node.localState,n=(i,s)=>{let a=this.__node.unique+"."+s,o=`${a}input`,l,c,f,u;if(typeof i[s]=="function"&&s!=="__operator")this.__props?.[s]?f=this.__props:f=r,l=()=>f[s],c=d=>{this.__props?.[s]||(d=d.bind(this)),f[s]=(...p)=>{this.__node.state.triggers[o]&&this.__node.state.setValue(o,p);let _=d(...p);return this.__node.state.triggers[a]&&(typeof _?.then=="function"?_.then(w=>{this.__node.state.triggerEvent(a,w)}).catch(console.error):this.__node.state.triggerEvent(a,_)),_}},r[s]=i[s].bind(this),u={get:l,set:c,enumerable:!0,configurable:!0};else{let d,p,_;this.__props?.[s]?_=this.__props:_=r,d=()=>_[s],p=w=>{_[s]=w,this.__node.state.triggers[a]&&this.__node.state.triggerEvent(a,w)},r[s]=i[s],u={get:d,set:p,enumerable:!0,configurable:!0}}if(Object.defineProperty(i,s,u),typeof this.__node.initial=="object"){let d=Object.getOwnPropertyDescriptor(this.__node.initial,s);(d===void 0||d?.configurable)&&Object.defineProperty(this.__node.initial,s,u)}};if(t)n(e,t);else for(let i in e)n(e,i)};__proxyObject=e=>{let t=zNe(e);for(let r of t){let n={get:()=>e[r],set:i=>{e[r]=i},enumerable:!0,configurable:!0};if(Object.defineProperty(this,r,n),typeof this.__node.initial=="object"){let i=Object.getOwnPropertyDescriptor(this.__node.initial,r);(i===void 0||i?.configurable)&&Object.defineProperty(this.__node.initial,r,n)}}};__addOnconnected(e){e=e.bind(this),Array.isArray(this.__onconnected)?this.__onconnected.push(e):typeof this.__onconnected=="function"?this.__onconnected=[e,this.__onconnected]:this.__onconnected=e}__addOndisconnected(e){e=e.bind(this),Array.isArray(this.__ondisconnected)?this.__ondisconnected.push(e):typeof this.__ondisconnected=="function"?this.__ondisconnected=[e,this.__ondisconnected]:this.__ondisconnected=e}__callConnected(e=this){if(typeof this.__onconnected=="function")this.__onconnected(this);else if(Array.isArray(this.__onconnected)){let t=r=>{r(this)};this.__onconnected.forEach(t)}}__callDisconnected(e=this){if(typeof this.__ondisconnected=="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let t=r=>{r(this)};this.__ondisconnected.forEach(t)}}},xf=class{__node={tag:`graph${Math.floor(Math.random()*1e15)}`,unique:`${Math.random()}`,nodes:new Map,state:NZ,roots:{}};constructor(e){this.init(e)}init=e=>{if(e){let t=Object.assign({},e);delete t.roots,nv(this.__node,t),e.roots&&this.load(e.roots)}};load=e=>{function t(i,s,a=!0,o=!0){if(o&&(i?Object.assign(i,s):i=Object.assign({},s),t(i,s,!0,!1)),s?.__children&&!a)s.__children?.constructor.name==="Object"?i.__children?.constructor.name==="Object"?t(i.__children,s.__children,!0,!1):i.__children=t({},s.__children,!0,!1):i.__children=s.__children;else if(a)for(let l in s)i[l]=Object.assign({},s[l]),s[l]?.__children&&t({},s[l].__children,!1,!1);return i}this.__node.roots=t(this.__node.roots?this.__node.roots:{},e);let r=Object.assign({},e);r.__node&&delete r.__node;let n=this.recursiveSet(r,this,void 0,e);if(e.__node){if(!e.__node.tag)e.__node._tag=`roots${Math.floor(Math.random()*1e15)}`;else if(!this.get(e.__node.tag)){let i=new xr(e,this,this);this.set(i.__node.tag,i),this.runLoaders(i,this,e,e.__node.tag),i.__listeners&&(n[i.__node.tag]=i.__listeners)}}else e.__listeners&&this.setListeners(e.__listeners);return this.setListeners(n),r};setLoaders=(e,t)=>(t?this.__node.loaders=e:Object.assign(this.__node.loaders,e),this.__node.loaders);runLoaders=(e,t,r,n)=>{for(let i in this.__node.loaders)typeof this.__node.loaders[i]=="object"?(this.__node.loaders[i].init&&this.__node.loaders[i](e,t,this,this.__node.roots,r,n),this.__node.loaders[i].connected&&e.__addOnconnected(this.__node.loaders[i].connect),this.__node.loaders[i].disconnected&&e.__addOndisconnected(this.__node.loaders[i].disconnect)):typeof this.__node.loaders[i]=="function"&&this.__node.loaders[i](e,t,this,this.__node.roots,r,n)};add=(e,t)=>{let r={};typeof t=="string"&&(t=this.get(t));let n;if(typeof e=="function"?pL(e)?e.prototype instanceof xr?(e=e.prototype.constructor(e,t,this),n=!0):e=new e:e={__operator:e}:typeof e=="string"&&(e=this.__node.roots[e]),!!e){if(!n){let i=Object.getOwnPropertyNames(e),s=Object.getOwnPropertyNames(Object.getPrototypeOf(e));i.push(...s),i=i.filter(o=>!gL.includes(o));let a={};for(let o of i)a[o]=e[o];e=a}if(e.__node||(e.__node={}),e.__node.initial=e,typeof e=="object"&&!this.get(e.__node.tag)){let i,s=nv({},e,2);if(n?i=e:i=new xr(e,t,this),this.set(i.__node.tag,i),this.runLoaders(i,t,e,i.__node.tag),this.__node.roots[i.__node.tag]=s,i.__children&&(i.__children=Object.assign({},i.__children),this.recursiveSet(i.__children,i,r,i.__children)),i.__listeners){r[i.__node.tag]=Object.assign({},i.__listeners);for(let a in i.__listeners){let o=i.__listeners[a];i[a]&&(delete r[i.__node.tag][a],r[i.__node.tag][i.__node.tag+"."+a]=o),typeof o=="string"&&(i.__children?.[o]?r[i.__node.tag][a]=i.__node.tag+"."+o:t instanceof xr&&(t.__node.tag===o||t.__node.tag.includes(".")&&t.__node.tag.split(".").pop()===o)&&(r[i.__node.tag][a]=t.__node.tag))}}return this.setListeners(r),i.__callConnected(),i}else if(e.__node.tag)return this.get(e.__node.tag)}};recursiveSet=(e,t,r={},n)=>{let i=Object.getOwnPropertyNames(n),s=Object.getOwnPropertyNames(Object.getPrototypeOf(n)).filter(a=>!gL.includes(a));i.push(...s);for(let a of i){if(a.includes("__"))continue;let o=n[a];if(Array.isArray(o))continue;let l;if(typeof o=="function"?pL(o)?(o=new o,o instanceof xr&&(o=o.prototype.constructor(o,t,this),l=!0)):o={__operator:o}:typeof o=="string"?this.__node.nodes.get(o)?o=this.__node.nodes.get(o):o=this.__node.roots[o]:typeof o=="boolean"&&(this.__node.nodes.get(a)?o=this.__node.nodes.get(a):o=this.__node.roots[a]),o instanceof Object){if(!l&&!(o instanceof xr)){let d=Object.getOwnPropertyNames(o),p=Object.getOwnPropertyNames(Object.getPrototypeOf(o));p.splice(p.indexOf("constructor"),1),d.push(...p);let _={};for(let w of d)_[w]=o[w];o=_}if(o.__node||(o.__node={}),o.__node.tag||(o.__node.tag=a),o.__node.initial||(o.__node.initial=e[a]),this.get(o.__node.tag)&&!(!(t instanceof xf)&&t?.__node)||t?.__node&&this.get(t.__node.tag+"."+o.__node.tag))continue;let c,f=!1,u=nv({},o,2);if(l||o instanceof xr?c=o:(c=new xr(o,t,this),f=!0),!f&&o instanceof xr&&!l&&t instanceof xr){let d=this.subscribe(t.__node.tag,c.__node.tag),p=_=>{this.unsubscribe(t.__node.tag,d)};c.__addOndisconnected(p)}else if(c){if(this.set(c.__node.tag,c),this.runLoaders(c,t,e[a],a),e[a]=c,this.__node.roots[c.__node.tag]=u,c.__children&&(c.__children=Object.assign({},c.__children),this.recursiveSet(c.__children,c,r,c.__children)),c.__listeners){r[c.__node.tag]=Object.assign({},c.__listeners);for(let d in c.__listeners){let p=c.__listeners[d],_=d;c[d]&&(delete r[c.__node.tag][d],_=c.__node.tag+"."+d,r[c.__node.tag][_]=p),typeof p=="string"&&(c.__children?.[p]?r[c.__node.tag][_]=c.__node.tag+"."+p:t instanceof xr&&(t.__node.tag===p||t.__node.tag.includes(".")&&t.__node.tag.split(".").pop()===p)&&(r[c.__node.tag][_]=t.__node.tag))}}c.__callConnected()}}}return r};remove=(e,t=!0)=>{if(this.unsubscribe(e),typeof e=="string"&&(e=this.get(e)),e instanceof xr){this.delete(e.__node.tag),delete this.__node.roots[e.__node.tag],t&&this.clearListeners(e),e.__callDisconnected();let r=n=>{for(let i in n)this.unsubscribe(n[i]),this.delete(n[i].__node.tag),delete this.__node.roots[n[i].__node.tag],this.delete(i),delete this.__node.roots[i],n[i].__node.tag=n[i].__node.tag.substring(n[i].__node.tag.lastIndexOf(".")+1),t&&this.clearListeners(n[i]),n[i].__callDisconnected(),n[i].__children&&r(n[i].__children)};e.__children&&r(e.__children)}return e?.__node.tag&&e?.__parent&&(delete e?.__parent,e.__node.tag=e.__node.tag.substring(e.__node.tag.indexOf(".")+1)),e?.__node.graph&&(e.__node.graph=void 0),e};run=(e,...t)=>{if(typeof e=="string"){let r=this.get(e);if(!r&&e.includes(".")){if(r=this.get(e.substring(0,e.lastIndexOf("."))),typeof r?.[e.substring(e.lastIndexOf(".")+1)]=="function")return r[e.substring(e.lastIndexOf(".")+1)](...t)}else if(r?.__operator)return r.__operator(...t)}if(e?.__operator)return e?.__operator(...t)};setListeners=e=>{for(let t in e){let r=this.get(t);if(typeof e[t]=="object")for(let n in e[t]){let i=this.get(n),s;if(typeof e[t][n]!="object")e[t][n]={__callback:e[t][n]};else if(!e[t][n].__callback)for(let a in e[t][n]){typeof e[t][n][a]!="object"&&(e[t][n][a]={__callback:e[t][n][a]},r.__operator&&(e[t][n][a].__callback===!0||typeof e[t][n][a].__callback>"u")&&(e[t][n][a].__callback=r.__operator));let o=this.get(a);if(o)s=this.subscribe(o,e[t][n][a].__callback,e[t][n].__args,void 0,e[t][n].inputState,t,n);else{let l=n.substring(0,n.lastIndexOf("."));if(o=this.get(l),o){let c=n.substring(n.lastIndexOf(".")+1);s=this.subscribe(o,e[t][n][a].__callback,e[t][n][a].__args,c,e[t][n][a].inputState,t,n)}}}if("__callback"in e[t][n])if(r&&((e[t][n].__callback===!0||typeof e[t][n].__callback>"u")&&(e[t][n].__callback=r.__operator),typeof e[t][n].__callback=="function"&&(e[t][n].__callback=e[t][n].__callback.bind(r))),i)s=this.subscribe(i,e[t][n].__callback,e[t][n].__args,void 0,e[t][n].inputState,t,n);else{let a=n.substring(0,n.lastIndexOf("."));i=this.get(a),i&&(s=this.subscribe(i,e[t][n].__callback,e[t][n].__args,n.substring(n.lastIndexOf(".")+1),e[t][n].inputState,t,n))}}}};clearListeners=(e,t)=>{if(typeof e=="string"&&(e=this.get(e)),e?.__listeners)for(let r in e.__listeners){if(t&&r!==t||typeof e.__listeners[r]?.sub!="number")continue;let n=this.get(r);if(n)if(typeof!e.__listeners[r]?.__callback=="number")for(let i in e.__listeners[r])e.__listeners[r][i]?.sub&&(this.unsubscribe(n,e.__listeners[r][i].sub,void 0,e.__listeners[r][i].inputState),e.__listeners[r][i].sub=void 0);else typeof e.__listeners[r]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r].sub,void 0,e.__listeners[r].inputState),e.__listeners[r].sub=void 0);else if(n=this.get(r.substring(0,r.lastIndexOf("."))),n)if(typeof e.__listeners[r]=="object"&&!e.__listeners[r]?.__callback)for(let i in e.__listeners[r])typeof e.__listeners[r][i]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r][i].sub,r.substring(r.lastIndexOf(".")+1),e.__listeners[r][i].inputState),e.__listeners[r][i].sub=void 0);else typeof e.__listeners[r]?.sub=="number"&&(this.unsubscribe(n,e.__listeners[r].sub,r.substring(r.lastIndexOf(".")+1),e.__listeners[r].inputState),e.__listeners[r].sub=void 0)}};get=e=>this.__node.nodes.get(e);set=(e,t)=>this.__node.nodes.set(e,t);delete=e=>this.__node.nodes.delete(e);getProps=(e,t)=>{if(typeof e=="string"&&(e=this.get(e)),e instanceof xr){let r;if(t)r=Object.assign({},this.__node.roots[e.__node.tag]);else{r=Object.assign({},e);for(let n in r)n.includes("__")&&delete r[n]}}};subscribe=(e,t,r,n,i,s,a,o)=>{let l=e;if(typeof e=="string"&&(l=this.get(e),!l&&e.includes(".")&&(l=this.get(e.substring(0,e.lastIndexOf("."))),n=e.substring(e.lastIndexOf(".")+1))),s instanceof xr&&(s=s.__node.tag),typeof t=="string"){let f=u=>{if(this.get(u)?.__operator){let d=this.get(u);s=u,u=function(...p){return d.__operator(...p)}}else if(u.includes(".")){s=u.substring(0,u.lastIndexOf("."));let d=this.get(s),p=u.substring(u.lastIndexOf(".")+1);o=p,typeof d[p]=="function"?d[p]instanceof xr?u=d[p]:u=function(..._){return d[p](..._)}:u=function(_){return d[p]=_,d[p]}}return u};if(s){let u=this.get(s);typeof u?.[t]=="function"?(o=t,t=function(...d){return u[n](...d)}):u[n]?(o=n,u[n]instanceof xr?t=u[n]:t=function(d){return u[n]=d,u[n]}):t=f(t)}else t=f(t)}let c;if(l instanceof xr){let f=()=>{c=l.__subscribe(t,n,i,s,o,r);let u=()=>{c!==void 0&&l.__unsubscribe(c,n,i),c=void 0};l.__addOndisconnected(()=>{u(),l.__addOnconnected(()=>{c===void 0&&l.__node.graph.__node.tag===this.__node.tag&&f()})}),typeof t=="string"&&this.get(t)&&(t=this.get(t)),t instanceof xr&&t.__addOndisconnected(()=>{u()})};f()}else if(typeof e=="string"){let f=this.get(e);if(f){if(t instanceof xr&&t.__operator){let u=()=>{c=f.__subscribe(t.__operator,n,i,s,o,r);let d=()=>{c!==void 0&&f.__unsubscribe(c,n,i)};f.__addOndisconnected(()=>{d(),f.__addOnconnected(()=>{c===void 0&&f.__node.graph.__node.tag===this.__node.tag&&u()})}),t.__addOndisconnected(d)};u()}else if(typeof t=="function"||typeof t=="string"){let u=()=>{c=f.__subscribe(t,n,i,s,o,r);let d=()=>{c!==void 0&&f.__unsubscribe(c,n,i),c=void 0};f.__addOndisconnected(()=>{d(),f.__addOnconnected(()=>{c===void 0&&f.__node.graph.__node.tag===this.__node.tag&&u()})}),typeof t=="string"&&this.get(t)&&this.get(t).__addOndisconnected(d)};u()}}else typeof t=="string"&&(t=this.__node.nodes.get(t).__operator),typeof t=="function"&&(c=this.__node.state.subscribeEvent(e,t))}return c};unsubscribe=(e,t,r,n)=>e instanceof xr?e.__unsubscribe(t,r,n):this.get(e)?.__unsubscribe(t,r,n);setState=e=>{this.__node.state.setState(e)}};function nv(e,t,r=1/0,n=0){for(let i in t)t[i]?.constructor.name==="Object"&&n<r?(n++,e[i]?.constructor.name==="Object"?nv(e[i],t[i],r,n):e[i]=nv({},t[i],r,n)):e[i]=t[i];return e}function zNe(e){var t=[],r=e;do{var n=Object.getOwnPropertyNames(r);let i=function(s){t.indexOf(s)===-1&&t.push(s)};n.forEach(i)}while(r=Object.getPrototypeOf(r));return t}function pL(e){return qNe(e)==="class"}function qNe(e){return typeof e=="function"?e.prototype?Object.getOwnPropertyDescriptor(e,"prototype")?.writable?"function":"class":e.constructor.name==="AsyncFunction"?"async":"arrow":""}var HS=(e,t)=>{if(t.get(e)?.__operator){let r=t.get(e);return(...n)=>{r.__operator(...n)}}else if(e.includes(".")){let r=e.split("."),n=r.pop(),i=r.join("."),s=t.get(i);return typeof t.get(i)?.[n]=="function"?(...a)=>s[n](...a):()=>s[n]}else if(t.get(e)){let r=t.get(e);return()=>r}else{let r=e;return()=>r}},hL=(e,t,r)=>{let n=[],i=(a,o)=>{if(a==="__output"||a==="__input"||a==="__callback")n[o]={__callback:l=>l,__args:void 0,idx:o};else if(typeof a=="string")n[o]={__callback:HS(a,r),__args:void 0,idx:o};else if(typeof a=="function"){let l=a;n[o]={__callback:(...c)=>l(...c),__args:void 0,idx:o}}else if(typeof a=="object"&&(a.__input||a.__callback)){let l=function(c){let f=c.__input?c.__input:c.__callback;if(typeof c.__input=="string"&&(f={__callback:HS(c.__input,r),__args:void 0,idx:o}),c.__args){let u=hL(f,c.__args,r);f={__callback:u.__callback,__args:u.__args,idx:o}}else f={__callback:f,__args:void 0,idx:o};if(c.__output){let u=c.__output;if(typeof c.__output=="string"?u={__callback:HS(u,r),__args:void 0,idx:o}:typeof a.__output=="object"&&(u=l(u)),typeof u?.__callback=="function"){let d=f.__callback,p=u.__callback;f={__callback:(..._)=>p(d(..._)),__args:u.__args,idx:o}}}return f};n[o]=l(a)}else{let l=a;n[o]={__callback:()=>l,__args:void 0,idx:o}}};t.forEach(i),typeof e=="string"&&(e={__callback:HS(e,r),__args:void 0});let s=typeof e=="function"?e:e.__callback;return e=function(...a){let o=c=>c.__callback(...a);return s(...n.map(o))},{__callback:e,__args:n}},gL=Object.getOwnPropertyNames(Object.getPrototypeOf({})),VNe=(e,t,r)=>{e.__node.backward&&t instanceof xr&&r.setListeners({[t.__node.tag]:{[e.__node.tag]:t}})},HNe=(e,t,r)=>{if(e.__operator&&!e.__node.looperSet){if(typeof e.__node.delay=="number"){let n=e.__operator;e.__setOperator((...i)=>new Promise((s,a)=>{setTimeout(async()=>{s(await n(...i))},e.__node.delay)}))}else if(e.__node.frame===!0){let n=e.__operator;e.__setOperator((...i)=>new Promise((s,a)=>{requestAnimationFrame(async()=>{s(await n(...i))})}))}if(typeof e.__node.repeat=="number"||typeof e.__node.recursive=="number"){let n=e.__operator;e.__setOperator(async(...i)=>{let s=e.__node.repeat?e.__node.repeat:e.__node.recursive,a,o=async(l,...c)=>{for(;l>0;){if(e.__node.delay||e.__node.frame){n(...c).then(async f=>{e.__node.recursive?await o(l,f):await o(l,...c)});break}else a=await n(...i);l--}};return await o(s,...i),a})}if(e.__node.loop&&typeof e.__node.loop=="number"){e.__node.looperSet=!0;let n=e.__operator,i=e.__node.loop;e.__setOperator((...a)=>{if("looping"in e.__node||(e.__node.looping=!0),e.__node.looping){let o=performance.now();n(...a),setTimeout(()=>{let c=performance.now()-o-e.__node.loop;c>0?i=e.__node.loop-c:i=e.__node.loop,i<=0&&(i=e.__node.loop),e.__operator(...a)},i)}}),e.__node.looping&&e.__operator();let s=a=>{a.__node.looping&&(a.__node.looping=!1)};e.__addOndisconnected(s)}}},WNe=(e,t,r)=>{if(e.__node.animate===!0||e.__animation){let n=e.__operator;e.__setOperator((...s)=>{"animating"in e.__node||(e.__node.animating=!0),e.__node.animating&&(typeof e.__animation=="function"?e.__animation(...s):n(...s),requestAnimationFrame(()=>{e.__operator(...s)}))}),(e.__node.animating||(!("animating"in e.__node)||e.__node.animating)&&e.__animation)&&setTimeout(()=>{requestAnimationFrame(e.__operator)},10);let i=s=>{s.__node.animating&&(s.__node.animating=!1)};e.__addOndisconnected(i)}},JNe=(e,t,r)=>{if(typeof e.__branch=="object"&&e.__operator&&!e.__branchApplied){let n=e.__operator;e.__branchApplied=!0,e.__operator=(...i)=>{let s=n(...i);for(let a in e.__branch){let o=()=>{typeof e.__branch[a].then=="function"?e.__branch[a].then(s):e.__branch[a].then instanceof xr&&e.__branch[a].then.__operator?e.__branch[a].then.__operator(s):s=e.__branch[a].then};typeof e.__branch[a].if=="function"?e.__branch[a].if(s)==!0&&o():e.__branch[a].if===s&&o()}return s}}if(e.__listeners){for(let n in e.__listeners)if(typeof e.__listeners[n]=="object"&&e.__listeners[n].branch&&!e.__listeners[n].branchApplied){let i=e.__listeners[n].callback;e.__listeners[n].branchApplied=!0,e.__listeners.callback=s=>{let a=()=>{typeof e.__listeners[n].branch.then=="function"?s=e.__listeners[n].branch.then(s):e.__listeners[n].branch.then instanceof xr&&e.__listeners[n].branch.then.__operator?s=e.__listeners[n].branch.then.__operator(s):s=e.__listeners[n].branch.then};return typeof e.__listeners[n].branch.if=="function"?e.__listeners[n].branch.if(s)&&a():e.__listeners[n].branch.if===s&&a(),i(s)}}}},GNe=(e,t,r)=>{if(e.__listeners)for(let n in e.__listeners)typeof e.__listeners[n]=="object"&&e.__listeners[n].oncreate&&e.__listeners[n].callback(e.__listeners[n].oncreate)},KNe=(e,t,r)=>{if(e.__listeners)for(let n in e.__listeners)typeof e.__listeners[n]=="object"&&typeof e.__listeners[n].binding=="object"&&(e.__listeners.callback=e.__listeners.callback.bind(e.__listeners[n].binding))},YNe=(e,t,r)=>{if(e.__listeners){for(let n in e.__listeners)if(typeof e.__listeners[n]=="object"&&typeof e.__listeners[n].transform=="function"&&!e.__listeners[n].transformApplied){let i=e.__listeners[n].callback;e.__listeners[n].transformApplied=!0,e.__listeners.callback=s=>(s=e.__listeners[n].transform(s),i(s))}}},XNe=(e,t,r)=>{e.post&&!e.__operator?e.__setOperator(e.post):!e.__operator&&typeof e.get=="function"&&e.__setOperator(e.get),!e.get&&e.__operator&&(e.get=e.__operator),e.aliases&&e.aliases.forEach(n=>{r.set(n,e);let i=s=>{r.__node.nodes.delete(n)};e.__addOndisconnected(i)}),typeof r.__node.roots?.[e.__node.tag]=="object"&&e.get&&(r.__node.roots[e.__node.tag].get=e.get)},SZ={backprop:VNe,loop:HNe,animate:WNe,branching:JNe,triggerListenerOncreate:GNe,bindListener:KNe,transformListenerResult:YNe,substitute__operator:XNe},yL=e=>{let t={};for(let r in e)typeof e[r]=="object"?t[r]=yL(e[r]):typeof e[r]=="function"?t[r]=e[r].toString():t[r]=e[r];return t};function Fh(e=""){let t=a=>a.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),n=(a=>{let o=a.indexOf("=>")+1;return o<=0&&(o=a.indexOf("){")),o<=0&&(o=a.indexOf(") {")),a.slice(0,a.indexOf("{",o)+1)})(e),i=t(e),s;if(n.includes("function")){let a=n.split("(")[1].split(")")[0];s=new Function(a,i)}else if(n.substring(0,6)===i.substring(0,6)){let a=n.split("(")[1].split(")")[0];s=new Function(a,i.substring(i.indexOf("{")+1,i.length-1))}else try{s=(0,eval)(e)}catch{}return s}var ZNe=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(a,o){var l=t.length-1,c=t[l];if(typeof c=="object")if(c[a]===o||l===0)r.push(a),t.push(o.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[a]===o){l+=2,t.length=l,r.length=l,--l,t[l]=o,r[l]=a;break}l--}}function s(a,o){if(o!=null&&typeof o=="object"){a&&i(a,o);let l=e.get(o);if(l)return"[Circular Reference]"+l;e.set(o,r.join("."))}return o}return function(o,l){try{return t.push(o),JSON.stringify(o,s,l)}finally{n()}}}();JSON.stringifyWithCircularRefs===void 0&&(JSON.stringifyWithCircularRefs=ZNe);var QNe=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(a,o){var l=t.length-1;if(t[l]){var c=t[l];if(typeof c=="object")if(c[a]===o||l===0)r.push(a),t.push(o.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[a]===o){l+=2,t.length=l,r.length=l,--l,t[l]=o,r[l]=a;break}l++}}}function s(a,o){let l;if(o!=null)if(typeof o=="object"){let c=o.constructor.name;a&&c==="Object"&&i(a,o);let f=e.get(o);if(f)return"[Circular Reference]"+f;if(e.set(o,r.join(".")),c==="Array")o.length>20?l=o.slice(o.length-20):l=o;else if(c.includes("Set"))l=Array.from(o);else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean")l="instanceof_"+c;else if(c==="Object"){let u={};for(let d in o)if(o[d]==null)u[d]=o[d];else if(Array.isArray(o[d]))o[d].length>20?u[d]=o[d].slice(o[d].length-20):u[d]=o[d];else if(o[d].constructor.name==="Object"){u[d]={};for(let p in o[d])if(Array.isArray(o[d][p]))o[d][p].length>20?u[d][p]=o[d][p].slice(o[d][p].length-20):u[d][p]=o[d][p];else if(o[d][p]!=null){let _=o[d][p].constructor.name;_.includes("Set")?u[d][p]=Array.from(o[d][p]):_!=="Number"&&_!=="String"&&_!=="Boolean"?u[d][p]="instanceof_"+_:u[d][p]=o[d][p]}else u[d][p]=o[d][p]}else{let p=o[d].constructor.name;p.includes("Set")?u[d]=Array.from(o[d]):p!=="Number"&&p!=="String"&&p!=="Boolean"?u[d]="instanceof_"+p:u[d]=o[d]}l=u}else l=o}else l=o;return l}return function(o,l){t.push(o);let c=JSON.stringify(o,s,l);return n(),c}}();JSON.stringifyFast===void 0&&(JSON.stringifyFast=QNe);function xZ(e){if(typeof e.__methods=="object")for(let t in e.__methods){let r=e.__methods[t],n=typeof r=="function"?r:Fh(r);t==="__operator"?e.__setOperator(n):e[t]=n.bind(e)}}var PZ=class extends xf{name=`service${Math.floor(Math.random()*1e15)}`;constructor(e){super({...e,loaders:e?.loaders?Object.assign({...SZ},e.loaders):{...SZ}}),e?.services&&this.addServices(e.services),this.load(this)}addServices=e=>{for(let t in e)if(typeof e[t]=="function"&&(e[t]=new e[t]),e[t]?.__node?.loaders&&Object.assign(this.__node.loaders,e[t].__node.loaders),e[t]?.__node?.nodes){e[t].__node.nodes.forEach((i,s)=>{this.get(s)?this.set(t+"."+s,i):this.set(s,i)}),this.__node.nodes.forEach((i,s)=>{e[t].__node.nodes.get(s)||e[t].__node.nodes.set(s,i)});let r=this.set;this.set=(i,s)=>(e[t].set(i,s),r(i,s));let n=this.delete;this.delete=i=>(e[t].delete(i),n(i))}else typeof e[t]=="object"&&this.load(e[t])};handleMethod=(e,t,r)=>{let n=t.toLowerCase(),i=this.__node.nodes.get(e);if(i||(i=this.__node.roots[e]),i?.[n])if(typeof i[n]!="function"){if(r){Array.isArray(r)&&r.length===1?i[n]=r[0]:i[n]=r;return}return i[n]}else return Array.isArray(r)?i[n](...r):i[n](r);else return this.handleServiceMessage({route:e,args:r,method:t})};handleServiceMessage(e){let t;return typeof e=="object"&&(e.route?t=e.route:e.node&&(t=e.node)),t?Array.isArray(e.args)?this.run(t,...e.args):this.run(t,e.args):e}handleGraphNodeCall(e,t){if(!e)return t;if(t?.args)this.handleServiceMessage(t);else return Array.isArray(t)?this.run(e,...t):this.run(e,t)}transmit=(...e)=>typeof e[0]=="object"?e[0].method?this.handleMethod(e[0].route,e[0].method,e[0].args):e[0].route?this.handleServiceMessage(e[0]):e[0].node?this.handleGraphNodeCall(e[0].node,e[0].args):(this.__node.keepState&&(e[0].route&&this.setState({[e[0].route]:e[0].args}),e[0].node&&this.setState({[e[0].node]:e[0].args})),e):e;receive=(...e)=>{if(e[0]&&typeof e[0]=="string"){let t=e[0].substring(0,8);(t.includes("{")||t.includes("["))&&(t.includes("\\")&&(e[0]=e[0].replace(/\\/g,"")),e[0][0]==='"'&&(e[0]=e[0].substring(1,e[0].length-1)),e[0]=JSON.parse(e[0]))}return typeof e[0]=="object"?e[0].method?this.handleMethod(e[0].route,e[0].method,e[0].args):e[0].route?this.handleServiceMessage(e[0]):e[0].node?this.handleGraphNodeCall(e[0].node,e[0].args):(this.__node.keepState&&(e[0].route&&this.setState({[e[0].route]:e[0].args}),e[0].node&&this.setState({[e[0].node]:e[0].args})),e):e};pipe=(e,t,r,n,i)=>{if(e instanceof xr)return i?this.subscribe(e,s=>{let a=i(s);a!==void 0?this.transmit({route:t,args:a,method:n}):this.transmit({route:t,args:s,method:n},r)}):this.subscribe(e,s=>{this.transmit({route:t,args:s,method:n},r)});if(typeof e=="string")return this.subscribe(e,s=>{this.transmit({route:t,args:s,method:n},r)})};pipeOnce=(e,t,r,n,i)=>{if(e instanceof xr)return i?e.__node.state.subscribeEventOnce(e.__node.unique,s=>{let a=i(s);a!==void 0?this.transmit({route:t,args:a,method:n}):this.transmit({route:t,args:s,method:n},r)}):this.__node.state.subscribeEventOnce(e.__node.unique,s=>{this.transmit({route:t,args:s,method:n},r)});if(typeof e=="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(e).__node.unique,s=>{this.transmit({route:t,args:s,method:n},r)})};terminate=(...e)=>{};isTypedArray=e3e;recursivelyAssign=ZS;spliceTypedArray=t3e;ping=()=>(console.log("pinged!"),"pong");echo=(...e)=>(this.transmit(...e),e);log=(...e)=>(console.log(...e),!0);error=(...e)=>(console.error(...e),!0)};function e3e(e){return ArrayBuffer.isView(e)&&Object.prototype.toString.call(e)!=="[object DataView]"}var ZS=(e,t)=>{for(let r in t)t[r]?.constructor.name==="Object"&&!Array.isArray(t[r])?e[r]?.constructor.name==="Object"&&!Array.isArray(e[r])?ZS(e[r],t[r]):e[r]=ZS({},t[r]):e[r]=t[r];return e};function t3e(e,t,r){let n=e.subarray(0,t),i;r&&(i=e.subarray(r+1));let s;return(n.length>0||i?.length>0)&&(s=new e.constructor(n.length+i.length)),s&&(n.length>0&&s.set(n),i&&i.length>0&&s.set(i,n.length)),s}var WS={},LZ={transferNode:(e,t,r)=>{let n;if(typeof e=="object"){e.__node||(e.__node={}),r&&(e.__node.tag=r);for(let i in e)typeof e[i]=="function"&&(e.__methods||(e.__methods={}),e.__methods[i]=e[i].toString());n=yL(e)}else typeof e=="function"?n=e.toString():typeof e=="string"&&(n=e);if(n){if(t.run)return t.run("setNode",[n]);if(t.postMessage)return t.postMessage({route:"setNode",args:n},void 0),new Promise(i=>i(r));if(t.send)return t.send(JSON.stringify({route:"setNode",args:n})),new Promise(i=>i(r))}},setNode:function(e,t){if(typeof e=="object"&&e.__methods&&(this.__node.graph.__node.loaders.methodstrings||(this.__node.graph.__node.loaders.methodstrings=xZ)),typeof e=="string"){let r=Fh(e);typeof r=="function"?e={__operator:r,__node:{tag:t||r.name}}:(r=JSON.parse(e),typeof r=="object"&&(e=r))}if(typeof e=="object"||typeof e=="function"){let r={};typeof e=="object"?Object.assign(r,e):r.__operator=e;let n=this.__node.graph.add(r);return n?(WS[n.__node.tag]=r,n.__node?.tag):!1}else return!1},proxyRemoteNode:function(e,t){return new Promise((r,n)=>{t.run("getNodeProperties",e).then(i=>{let s={};if(typeof i=="object")for(let a in i)i[a]==="function"?s[a]=(...o)=>new Promise(l=>{t.run(e,o,a).then(l)}):Object.defineProperty(s,a,{get:()=>new Promise(o=>{t.run(e,void 0,a).then(o)}),set:o=>{t.post(e,o,a)},configurable:!0,enumerable:!0});r(s)})})},makeNodeTransferrable:function(e,t){e.__node||(e.__node={}),t&&(e.__node.tag=t);for(let n in e)typeof e[n]=="function"&&(e.__methods||(e.__methods={}),e.__methods[n]=e[n].toString());return yL(e)},setTemplate:function(e,t){if(typeof e=="object"&&e.__methods&&(this.__node.graph.__node.loaders.methodstrings||(this.__node.graph.__node.loaders.methodstrings=xZ)),typeof e=="string"){let r=Fh(e);typeof r=="function"?(t||(t=r.name),e={__operator:r,__node:{tag:t}}):(r=JSON.parse(e),typeof r=="object"&&(e=r,!t&&r.__node?.tag&&(t=r.__node.tag)))}return t||(t=`node${Math.floor(Math.random()*1e15)}`),typeof e=="object"||typeof e=="function"?(WS[t]=e,t):!1},loadFromTemplate:function(e,t,r){if(WS[e]){let n=ZS({},WS[e]);return t&&(n.__node||(n.__node={}),n.__node.tag=t),r&&Object.assign(n,r),this.__node.graph.add(n).__node.tag}},setMethod:function(e,t,r){if(typeof t=="string"){let n=Fh(t);typeof n=="function"&&(t=n)}return!r&&typeof t=="function"&&(r=t.name),this.__node.graph.get(e)?this.__node.graph.get(e)[r]=t:this.__node.graph.add({__node:{tag:r,[r]:t}}),!0},assignNode:function(e,t){this.__node.graph.get(e)&&typeof t=="object"&&Object.assign(this.__node.graph.get(e),t)},getNodeProperties:function(e){let t=this.__node.graph.get(e);if(t){let r=Object.getOwnPropertyNames(t),n={};for(let i in r)n[i]=typeof t[i];return n}},transferClass:(e,t,r)=>{if(typeof e=="object"){let n=e.toString(),i={route:"receiveClass",args:[n,r]};return t.run?t.run("receiveClass",[n,r]):t.postMessage?(t.postMessage({route:"receiveClass",args:[n,r]},void 0),new Promise(s=>s(name))):t.send?(t.send(JSON.stringify({route:"receiveClass",args:[n,r]})),new Promise(s=>s(name))):i}return!1},receiveClass:function(e,t){if(typeof e=="string"&&e.indexOf("class")===0){let r=(0,eval)("("+e+")"),n=t;return n||(n=r.name),this.__node.graph[n]=r,!0}return!1},transferFunction:(e,t,r)=>{r||(r=e.name);let n=e.toString(),i={route:"setNode",args:[n,r]};return t.run?t.run("setNode",[n,r]):t.postMessage?(t.postMessage({route:"setNode",args:[n,r]},void 0),new Promise(s=>s(name))):t.send?(t.send(JSON.stringify({route:"setNode",args:[n,r]})),new Promise(s=>s(name))):i},setGlobal:(e,t)=>(globalThis[e]=t,!0),assignGlobalObject:(e,t)=>globalThis[e]?(typeof t=="object"&&Object.assign(globalThis[e],t),!0):!1,setValue:function(e,t){return this.__node.graph[e]=t,!0},assignObject:function(e,t){return this.__node.graph[e]?(typeof t=="object"&&Object.assign(this.__node.graph[e],t),!0):!1},setGlobalFunction:(e,t)=>(typeof e=="string"&&(e=Fh(e)),typeof e=="function"?(t||(t=e.name),globalThis[t]=e,!0):!1),setGraphFunction:function(e,t){return typeof e=="string"&&(e=Fh(e)),typeof e=="function"?(t||(t=e.name),this.__node.graph[t]=e,!0):!1}};function r3e(e,...t){return function(n=document.createElement("div")){let i=document.createElement("template");e.map(function(o,l){if(i.innerHTML+=o,t[l]instanceof HTMLElement){let c='<span id="dummyNode12345"></span>';c.id="dummyNode12345",i.innerHTML+=c}else i.innerHTML+=t[l]});let s=i.content.querySelectorAll("#dummyNode12345"),a=0;return t.forEach((o,l)=>{o instanceof HTMLElement&&(console.log(o,s[a]),i.content.replaceChild(o,s[a]),a++)}),n.appendChild(i.content),n}}var ZXe=r3e``;var me={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};me.cipher.aes=function(e){this.s[0][0][0]||this.O();var t,r,n,i,s=this.s[0][4],a=this.s[1];t=e.length;var o=1;if(t!==4&&t!==6&&t!==8)throw new me.exception.invalid("invalid aes key size");for(this.b=[n=e.slice(0),i=[]],e=t;e<4*t+28;e++)r=n[e-1],(e%t===0||t===8&&e%t===4)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[r&255],e%t===0&&(r=r<<8^r>>>24^o<<24,o=o<<1^283*(o>>7))),n[e]=n[e-t]^r;for(t=0;e;t++,e--)r=n[t&3?e:e-4],i[t]=4>=e||4>t?r:a[0][s[r>>>24]]^a[1][s[r>>16&255]]^a[2][s[r>>8&255]]^a[3][s[r&255]]};me.cipher.aes.prototype={encrypt:function(e){return kZ(this,e,0)},decrypt:function(e){return kZ(this,e,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var e=this.s[0],t=this.s[1],r=e[4],n=t[4],i,s,a,o=[],l=[],c,f,u,d;for(i=0;256>i;i++)l[(o[i]=i<<1^283*(i>>7))^i]=i;for(s=a=0;!r[s];s^=c||1,a=l[a]||1)for(u=a^a<<1^a<<2^a<<3^a<<4,u=u>>8^u&255^99,r[s]=u,n[u]=s,f=o[i=o[c=o[s]]],d=16843009*f^65537*i^257*c^16843008*s,f=257*o[u]^16843008*u,i=0;4>i;i++)e[i][s]=f=f<<24^f>>>8,t[i][u]=d=d<<24^d>>>8;for(i=0;5>i;i++)e[i]=e[i].slice(0),t[i]=t[i].slice(0)}};function kZ(e,t,r){if(t.length!==4)throw new me.exception.invalid("invalid aes block size");var n=e.b[r],i=t[0]^n[0],s=t[r?3:1]^n[1],a=t[2]^n[2];t=t[r?1:3]^n[3];var o,l,c,f=n.length/4-2,u,d=4,p=[0,0,0,0];o=e.s[r],e=o[0];var _=o[1],w=o[2],k=o[3],S=o[4];for(u=0;u<f;u++)o=e[i>>>24]^_[s>>16&255]^w[a>>8&255]^k[t&255]^n[d],l=e[s>>>24]^_[a>>16&255]^w[t>>8&255]^k[i&255]^n[d+1],c=e[a>>>24]^_[t>>16&255]^w[i>>8&255]^k[s&255]^n[d+2],t=e[t>>>24]^_[i>>16&255]^w[s>>8&255]^k[a&255]^n[d+3],d+=4,i=o,s=l,a=c;for(u=0;4>u;u++)p[r?3&-u:u]=S[i>>>24]<<24^S[s>>16&255]<<16^S[a>>8&255]<<8^S[t&255]^n[d++],o=i,i=s,s=a,a=t,t=o;return p}me.bitArray={bitSlice:function(e,t,r){return e=me.bitArray.$(e.slice(t/32),32-(t&31)).slice(1),r===void 0?e:me.bitArray.clamp(e,r-t)},extract:function(e,t,r){var n=Math.floor(-t-r&31);return((t+r-1^t)&-32?e[t/32|0]<<32-n^e[t/32+1|0]>>>n:e[t/32|0]>>>n)&(1<<r)-1},concat:function(e,t){if(e.length===0||t.length===0)return e.concat(t);var r=e[e.length-1],n=me.bitArray.getPartial(r);return n===32?e.concat(t):me.bitArray.$(t,n,r|0,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return t===0?0:32*(t-1)+me.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;e=e.slice(0,Math.ceil(t/32));var r=e.length;return t=t&31,0<r&&t&&(e[r-1]=me.bitArray.partial(t,e[r-1]&2147483648>>t-1,1)),e},partial:function(e,t,r){return e===32?t:(r?t|0:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(me.bitArray.bitLength(e)!==me.bitArray.bitLength(t))return!1;var r=0,n;for(n=0;n<e.length;n++)r|=e[n]^t[n];return r===0},$:function(e,t,r,n){var i;for(i=0,n===void 0&&(n=[]);32<=t;t-=32)n.push(r),r=0;if(t===0)return n.concat(e);for(i=0;i<e.length;i++)n.push(r|e[i]>>>t),r=e[i]<<32-t;return i=e.length?e[e.length-1]:0,e=me.bitArray.getPartial(i),n.push(me.bitArray.partial(t+e&31,32<t+e?r:n.pop(),1)),n},i:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,r;for(t=0;t<e.length;++t)r=e[t],e[t]=r>>>24|r>>>8&65280|(r&65280)<<8|r<<24;return e}};me.codec.utf8String={fromBits:function(e){var t="",r=me.bitArray.bitLength(e),n,i;for(n=0;n<r/8;n++)!(n&3)&&(i=e[n/4]),t+=String.fromCharCode(i>>>8>>>8>>>8),i<<=8;return decodeURIComponent(escape(t))},toBits:function(e){e=unescape(encodeURIComponent(e));var t=[],r,n=0;for(r=0;r<e.length;r++)n=n<<8|e.charCodeAt(r),(r&3)===3&&(t.push(n),n=0);return r&3&&t.push(me.bitArray.partial(8*(r&3),n)),t}};me.codec.hex={fromBits:function(e){var t="",r;for(r=0;r<e.length;r++)t+=((e[r]|0)+0xf00000000000).toString(16).substr(4);return t.substr(0,me.bitArray.bitLength(e)/4)},toBits:function(e){var t,r=[],n;for(e=e.replace(/\s|0x/g,""),n=e.length,e=e+"00000000",t=0;t<e.length;t+=8)r.push(parseInt(e.substr(t,8),16)^0);return me.bitArray.clamp(r,4*n)}};me.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(e,t,r){var n=me.codec.base32.BASE,i=me.codec.base32.REMAINING,s="",a=0,o=me.codec.base32.B,l=0,c=me.bitArray.bitLength(e);for(r&&(o=me.codec.base32.X),r=0;s.length*n<c;)s+=o.charAt((l^e[r]>>>a)>>>i),a<n?(l=e[r]<<n-a,a+=i,r++):(l<<=n,a-=n);for(;s.length&7&&!t;)s+="=";return s},toBits:function(e,t){e=e.replace(/\s|=/g,"").toUpperCase();var r=me.codec.base32.BITS,n=me.codec.base32.BASE,i=me.codec.base32.REMAINING,s=[],a,o=0,l=me.codec.base32.B,c=0,f,u="base32";for(t&&(l=me.codec.base32.X,u="base32hex"),a=0;a<e.length;a++){if(f=l.indexOf(e.charAt(a)),0>f){if(!t)try{return me.codec.base32hex.toBits(e)}catch{}throw new me.exception.invalid("this isn't "+u+"!")}o>i?(o-=i,s.push(c^f>>>o),c=f<<r-o):(o+=n,c^=f<<r-o)}return o&56&&s.push(me.bitArray.partial(o&56,c,1)),s}};me.codec.base32hex={fromBits:function(e,t){return me.codec.base32.fromBits(e,t,1)},toBits:function(e){return me.codec.base32.toBits(e,1)}};me.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,r){var n="",i=0,s=me.codec.base64.B,a=0,o=me.bitArray.bitLength(e);for(r&&(s=s.substr(0,62)+"-_"),r=0;6*n.length<o;)n+=s.charAt((a^e[r]>>>i)>>>26),6>i?(a=e[r]<<6-i,i+=26,r++):(a<<=6,i-=6);for(;n.length&3&&!t;)n+="=";return n},toBits:function(e,t){e=e.replace(/\s|=/g,"");var r=[],n,i=0,s=me.codec.base64.B,a=0,o;for(t&&(s=s.substr(0,62)+"-_"),n=0;n<e.length;n++){if(o=s.indexOf(e.charAt(n)),0>o)throw new me.exception.invalid("this isn't base64!");26<i?(i-=26,r.push(a^o>>>i),a=o<<32-i):(i+=6,a^=o<<32-i)}return i&56&&r.push(me.bitArray.partial(i&56,a,1)),r}};me.codec.base64url={fromBits:function(e){return me.codec.base64.fromBits(e,1,1)},toBits:function(e){return me.codec.base64.toBits(e,1)}};me.hash.sha256=function(e){this.b[0]||this.O(),e?(this.F=e.F.slice(0),this.A=e.A.slice(0),this.l=e.l):this.reset()};me.hash.sha256.hash=function(e){return new me.hash.sha256().update(e).finalize()};me.hash.sha256.prototype={blockSize:512,reset:function(){return this.F=this.Y.slice(0),this.A=[],this.l=0,this},update:function(e){typeof e=="string"&&(e=me.codec.utf8String.toBits(e));var t,r=this.A=me.bitArray.concat(this.A,e);if(t=this.l,e=this.l=t+me.bitArray.bitLength(e),9007199254740991<e)throw new me.exception.invalid("Cannot hash more than 2^53 - 1 bits");if(typeof Uint32Array<"u"){var n=new Uint32Array(r),i=0;for(t=512+t-(512+t&511);t<=e;t+=512)oL(this,n.subarray(16*i,16*(i+1))),i+=1;r.splice(0,16*i)}else for(t=512+t-(512+t&511);t<=e;t+=512)oL(this,r.splice(0,16));return this},finalize:function(){var e,r=this.A,t=this.F,r=me.bitArray.concat(r,[me.bitArray.partial(1,1)]);for(e=r.length+2;e&15;e++)r.push(0);for(r.push(Math.floor(this.l/4294967296)),r.push(this.l|0);r.length;)oL(this,r.splice(0,16));return this.reset(),t},Y:[],b:[],O:function(){function e(s){return 4294967296*(s-Math.floor(s))|0}for(var t=0,r=2,n,i;64>t;r++){for(i=!0,n=2;n*n<=r;n++)if(r%n===0){i=!1;break}i&&(8>t&&(this.Y[t]=e(Math.pow(r,.5))),this.b[t]=e(Math.pow(r,1/3)),t++)}}};function oL(e,t){var r,n,i,s=e.F,a=e.b,o=s[0],l=s[1],c=s[2],f=s[3],u=s[4],d=s[5],p=s[6],_=s[7];for(r=0;64>r;r++)16>r?n=t[r]:(n=t[r+1&15],i=t[r+14&15],n=t[r&15]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+t[r&15]+t[r+9&15]|0),n=n+_+(u>>>6^u>>>11^u>>>25^u<<26^u<<21^u<<7)+(p^u&(d^p))+a[r],_=p,p=d,d=u,u=f+n|0,f=c,c=l,l=o,o=n+(l&c^f&(l^c))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;s[0]=s[0]+o|0,s[1]=s[1]+l|0,s[2]=s[2]+c|0,s[3]=s[3]+f|0,s[4]=s[4]+u|0,s[5]=s[5]+d|0,s[6]=s[6]+p|0,s[7]=s[7]+_|0}me.mode.ccm={name:"ccm",G:[],listenProgress:function(e){me.mode.ccm.G.push(e)},unListenProgress:function(e){e=me.mode.ccm.G.indexOf(e),-1<e&&me.mode.ccm.G.splice(e,1)},fa:function(e){var t=me.mode.ccm.G.slice(),r;for(r=0;r<t.length;r+=1)t[r](e)},encrypt:function(e,t,r,n,i){var s,a=t.slice(0),o=me.bitArray,l=o.bitLength(r)/8,c=o.bitLength(a)/8;if(i=i||64,n=n||[],7>l)throw new me.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;4>s&&c>>>8*s;s++);return s<15-l&&(s=15-l),r=o.clamp(r,8*(15-s)),t=me.mode.ccm.V(e,t,r,n,i,s),a=me.mode.ccm.C(e,a,r,t,i,s),o.concat(a.data,a.tag)},decrypt:function(e,t,r,n,i){i=i||64,n=n||[];var s=me.bitArray,a=s.bitLength(r)/8,c=s.bitLength(t),o=s.clamp(t,c-i),l=s.bitSlice(t,c-i),c=(c-i)/8;if(7>a)throw new me.exception.invalid("ccm: iv must be at least 7 bytes");for(t=2;4>t&&c>>>8*t;t++);if(t<15-a&&(t=15-a),r=s.clamp(r,8*(15-t)),o=me.mode.ccm.C(e,o,r,l,i,t),e=me.mode.ccm.V(e,o.data,r,n,i,t),!s.equal(o.tag,e))throw new me.exception.corrupt("ccm: tag doesn't match");return o.data},na:function(e,t,r,n,i,s){var a=[],o=me.bitArray,l=o.i;if(n=[o.partial(8,(t.length?64:0)|n-2<<2|s-1)],n=o.concat(n,r),n[3]|=i,n=e.encrypt(n),t.length)for(r=o.bitLength(t)/8,65279>=r?a=[o.partial(16,r)]:4294967295>=r&&(a=o.concat([o.partial(16,65534)],[r])),a=o.concat(a,t),t=0;t<a.length;t+=4)n=e.encrypt(l(n,a.slice(t,t+4).concat([0,0,0])));return n},V:function(e,t,r,n,i,s){var a=me.bitArray,o=a.i;if(i/=8,i%2||4>i||16<i)throw new me.exception.invalid("ccm: invalid tag length");if(4294967295<n.length||4294967295<t.length)throw new me.exception.bug("ccm: can't deal with 4GiB or more data");for(r=me.mode.ccm.na(e,n,r,i,a.bitLength(t)/8,s),n=0;n<t.length;n+=4)r=e.encrypt(o(r,t.slice(n,n+4).concat([0,0,0])));return a.clamp(r,8*i)},C:function(e,t,r,n,i,s){var a,o=me.bitArray;a=o.i;var l=t.length,c=o.bitLength(t),f=l/50,u=f;if(r=o.concat([o.partial(8,s-1)],r).concat([0,0,0]).slice(0,4),n=o.bitSlice(a(n,e.encrypt(r)),0,i),!l)return{tag:n,data:[]};for(a=0;a<l;a+=4)a>f&&(me.mode.ccm.fa(a/l),f+=u),r[3]++,i=e.encrypt(r),t[a]^=i[0],t[a+1]^=i[1],t[a+2]^=i[2],t[a+3]^=i[3];return{tag:n,data:o.clamp(t,c)}}};me.mode.ocb2={name:"ocb2",encrypt:function(e,t,r,n,i,s){if(me.bitArray.bitLength(r)!==128)throw new me.exception.invalid("ocb iv must be 128 bits");var a,o=me.mode.ocb2.S,l=me.bitArray,c=l.i,f=[0,0,0,0];r=o(e.encrypt(r));var u,d=[];for(n=n||[],i=i||64,a=0;a+4<t.length;a+=4)u=t.slice(a,a+4),f=c(f,u),d=d.concat(c(r,e.encrypt(c(r,u)))),r=o(r);return u=t.slice(a),t=l.bitLength(u),a=e.encrypt(c(r,[0,0,0,t])),u=l.clamp(c(u.concat([0,0,0]),a),t),f=c(f,c(u.concat([0,0,0]),a)),f=e.encrypt(c(f,c(r,o(r)))),n.length&&(f=c(f,s?n:me.mode.ocb2.pmac(e,n))),d.concat(l.concat(u,l.clamp(f,i)))},decrypt:function(e,t,r,n,i,s){if(me.bitArray.bitLength(r)!==128)throw new me.exception.invalid("ocb iv must be 128 bits");i=i||64;var a=me.mode.ocb2.S,o=me.bitArray,l=o.i,c=[0,0,0,0],f=a(e.encrypt(r)),u,d,p=me.bitArray.bitLength(t)-i,_=[];for(n=n||[],r=0;r+4<p/32;r+=4)u=l(f,e.decrypt(l(f,t.slice(r,r+4)))),c=l(c,u),_=_.concat(u),f=a(f);if(d=p-32*r,u=e.encrypt(l(f,[0,0,0,d])),u=l(u,o.clamp(t.slice(r),d).concat([0,0,0])),c=l(c,u),c=e.encrypt(l(c,l(f,a(f)))),n.length&&(c=l(c,s?n:me.mode.ocb2.pmac(e,n))),!o.equal(o.clamp(c,i),o.bitSlice(t,p)))throw new me.exception.corrupt("ocb: tag doesn't match");return _.concat(o.clamp(u,d))},pmac:function(e,t){var r,n=me.mode.ocb2.S,i=me.bitArray,s=i.i,a=[0,0,0,0],o=e.encrypt([0,0,0,0]),o=s(o,n(n(o)));for(r=0;r+4<t.length;r+=4)o=n(o),a=s(a,e.encrypt(s(o,t.slice(r,r+4))));return r=t.slice(r),128>i.bitLength(r)&&(o=s(o,n(o)),r=i.concat(r,[-2147483648,0,0,0])),a=s(a,r),e.encrypt(s(n(s(o,n(o))),a))},S:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}};me.mode.gcm={name:"gcm",encrypt:function(e,t,r,n,i){var s=t.slice(0);return t=me.bitArray,n=n||[],e=me.mode.gcm.C(!0,e,s,n,r,i||128),t.concat(e.data,e.tag)},decrypt:function(e,t,r,n,i){var s=t.slice(0),a=me.bitArray,o=a.bitLength(s);if(i=i||128,n=n||[],i<=o?(t=a.bitSlice(s,o-i),s=a.bitSlice(s,0,o-i)):(t=s,s=[]),e=me.mode.gcm.C(!1,e,s,n,r,i),!a.equal(e.tag,t))throw new me.exception.corrupt("gcm: tag doesn't match");return e.data},ka:function(e,t){var r,n,i,s,a,o=me.bitArray.i;for(i=[0,0,0,0],s=t.slice(0),r=0;128>r;r++){for((n=(e[Math.floor(r/32)]&1<<31-r%32)!==0)&&(i=o(i,s)),a=(s[3]&1)!==0,n=3;0<n;n--)s[n]=s[n]>>>1|(s[n-1]&1)<<31;s[0]>>>=1,a&&(s[0]^=-520093696)}return i},j:function(e,t,r){var n,i=r.length;for(t=t.slice(0),n=0;n<i;n+=4)t[0]^=4294967295&r[n],t[1]^=4294967295&r[n+1],t[2]^=4294967295&r[n+2],t[3]^=4294967295&r[n+3],t=me.mode.gcm.ka(t,e);return t},C:function(e,t,r,n,i,s){var a,o,l,c,f,u,d,p,_=me.bitArray;for(u=r.length,d=_.bitLength(r),p=_.bitLength(n),o=_.bitLength(i),a=t.encrypt([0,0,0,0]),o===96?(i=i.slice(0),i=_.concat(i,[1])):(i=me.mode.gcm.j(a,[0,0,0,0],i),i=me.mode.gcm.j(a,i,[0,0,Math.floor(o/4294967296),o&4294967295])),o=me.mode.gcm.j(a,[0,0,0,0],n),f=i.slice(0),n=o.slice(0),e||(n=me.mode.gcm.j(a,o,r)),c=0;c<u;c+=4)f[3]++,l=t.encrypt(f),r[c]^=l[0],r[c+1]^=l[1],r[c+2]^=l[2],r[c+3]^=l[3];return r=_.clamp(r,d),e&&(n=me.mode.gcm.j(a,o,r)),e=[Math.floor(p/4294967296),p&4294967295,Math.floor(d/4294967296),d&4294967295],n=me.mode.gcm.j(a,n,e),l=t.encrypt(i),n[0]^=l[0],n[1]^=l[1],n[2]^=l[2],n[3]^=l[3],{tag:_.bitSlice(n,0,s),data:r}}};me.misc.hmac=function(e,t){this.W=t=t||me.hash.sha256;var r=[[],[]],n,i=t.prototype.blockSize/32;for(this.w=[new t,new t],e.length>i&&(e=t.hash(e)),n=0;n<i;n++)r[0][n]=e[n]^909522486,r[1][n]=e[n]^1549556828;this.w[0].update(r[0]),this.w[1].update(r[1]),this.R=new t(this.w[0])};me.misc.hmac.prototype.encrypt=me.misc.hmac.prototype.mac=function(e){if(this.aa)throw new me.exception.invalid("encrypt on already updated hmac called!");return this.update(e),this.digest(e)};me.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]),this.aa=!1};me.misc.hmac.prototype.update=function(e){this.aa=!0,this.R.update(e)};me.misc.hmac.prototype.digest=function(){var e=this.R.finalize(),e=new this.W(this.w[1]).update(e).finalize();return this.reset(),e};me.misc.pbkdf2=function(e,t,r,n,i){if(r=r||1e4,0>n||0>r)throw new me.exception.invalid("invalid params to pbkdf2");typeof e=="string"&&(e=me.codec.utf8String.toBits(e)),typeof t=="string"&&(t=me.codec.utf8String.toBits(t)),i=i||me.misc.hmac,e=new i(e);var s,a,o,l,c=[],f=me.bitArray;for(l=1;32*c.length<(n||1);l++){for(i=s=e.encrypt(f.concat(t,[l])),a=1;a<r;a++)for(s=e.encrypt(s),o=0;o<s.length;o++)i[o]^=s[o];c=c.concat(i)}return n&&(c=f.clamp(c,n)),c};me.prng=function(e){this.c=[new me.hash.sha256],this.m=[0],this.P=0,this.H={},this.N=0,this.U={},this.Z=this.f=this.o=this.ha=0,this.b=[0,0,0,0,0,0,0,0],this.h=[0,0,0,0],this.L=void 0,this.M=e,this.D=!1,this.K={progress:{},seeded:{}},this.u=this.ga=0,this.I=1,this.J=2,this.ca=65536,this.T=[0,48,64,96,128,192,256,384,512,768,1024],this.da=3e4,this.ba=80};me.prng.prototype={randomWords:function(e,t){var r=[],n;n=this.isReady(t);var i;if(n===this.u)throw new me.exception.notReady("generator isn't seeded");if(n&this.J){n=!(n&this.I),i=[];var s=0,a;for(this.Z=i[0]=new Date().valueOf()+this.da,a=0;16>a;a++)i.push(4294967296*Math.random()|0);for(a=0;a<this.c.length&&(i=i.concat(this.c[a].finalize()),s+=this.m[a],this.m[a]=0,n||!(this.P&1<<a));a++);for(this.P>=1<<this.c.length&&(this.c.push(new me.hash.sha256),this.m.push(0)),this.f-=s,s>this.o&&(this.o=s),this.P++,this.b=me.hash.sha256.hash(this.b.concat(i)),this.L=new me.cipher.aes(this.b),n=0;4>n&&(this.h[n]=this.h[n]+1|0,!this.h[n]);n++);}for(n=0;n<e;n+=4)(n+1)%this.ca===0&&OZ(this),i=mL(this),r.push(i[0],i[1],i[2],i[3]);return OZ(this),r.slice(0,e)},setDefaultParanoia:function(e,t){if(e===0&&t!=="Setting paranoia=0 will ruin your security; use it only for testing")throw new me.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=e},addEntropy:function(e,t,r){r=r||"user";var n,i,s=new Date().valueOf(),a=this.H[r],o=this.isReady(),l=0;switch(n=this.U[r],n===void 0&&(n=this.U[r]=this.ha++),a===void 0&&(a=this.H[r]=0),this.H[r]=(this.H[r]+1)%this.c.length,typeof e){case"number":t===void 0&&(t=1),this.c[a].update([n,this.N++,1,t,s,1,e|0]);break;case"object":if(r=Object.prototype.toString.call(e),r==="[object Uint32Array]"){for(i=[],r=0;r<e.length;r++)i.push(e[r]);e=i}else for(r!=="[object Array]"&&(l=1),r=0;r<e.length&&!l;r++)typeof e[r]!="number"&&(l=1);if(!l){if(t===void 0)for(r=t=0;r<e.length;r++)for(i=e[r];0<i;)t++,i=i>>>1;this.c[a].update([n,this.N++,2,t,s,e.length].concat(e))}break;case"string":t===void 0&&(t=e.length),this.c[a].update([n,this.N++,3,t,s,e.length]),this.c[a].update(e);break;default:l=1}if(l)throw new me.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[a]+=t,this.f+=t,o===this.u&&(this.isReady()!==this.u&&EZ("seeded",Math.max(this.o,this.f)),EZ("progress",this.getProgress()))},isReady:function(e){return e=this.T[e!==void 0?e:this.M],this.o&&this.o>=e?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=e?this.J|this.u:this.u},getProgress:function(e){return e=this.T[e||this.M],this.o>=e||this.f>e?1:this.f/e},startCollectors:function(){if(!this.D){if(this.a={loadTimeCollector:tv(this,this.ma),mouseCollector:tv(this,this.oa),keyboardCollector:tv(this,this.la),accelerometerCollector:tv(this,this.ea),touchCollector:tv(this,this.qa)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new me.exception.bug("can't attach event");this.D=!0}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=!1)},addEventListener:function(e,t){this.K[e][this.ga++]=t},removeEventListener:function(e,t){var r,n,i=this.K[e],s=[];for(n in i)i.hasOwnProperty(n)&&i[n]===t&&s.push(n);for(r=0;r<s.length;r++)n=s[r],delete i[n]},la:function(){Qb(this,1)},oa:function(e){var t,r;try{t=e.x||e.clientX||e.offsetX||0,r=e.y||e.clientY||e.offsetY||0}catch{r=t=0}t!=0&&r!=0&&this.addEntropy([t,r],2,"mouse"),Qb(this,0)},qa:function(e){e=e.touches[0]||e.changedTouches[0],this.addEntropy([e.pageX||e.clientX,e.pageY||e.clientY],1,"touch"),Qb(this,0)},ma:function(){Qb(this,2)},ea:function(e){if(e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,window.orientation){var t=window.orientation;typeof t=="number"&&this.addEntropy(t,1,"accelerometer")}e&&this.addEntropy(e,2,"accelerometer"),Qb(this,0)}};function EZ(e,t){var r,n=me.random.K[e],i=[];for(r in n)n.hasOwnProperty(r)&&i.push(n[r]);for(r=0;r<i.length;r++)i[r](t)}function Qb(e,t){typeof window<"u"&&window.performance&&typeof window.performance.now=="function"?e.addEntropy(window.performance.now(),t,"loadtime"):e.addEntropy(new Date().valueOf(),t,"loadtime")}function OZ(e){e.b=mL(e).concat(mL(e)),e.L=new me.cipher.aes(e.b)}function mL(e){for(var t=0;4>t&&(e.h[t]=e.h[t]+1|0,!e.h[t]);t++);return e.L.encrypt(e.h)}function tv(e,t){return function(){t.apply(e,arguments)}}me.random=new me.prng(6);e:try{if(cL=typeof module<"u"&&module.exports){try{uL=DNe("crypto")}catch{uL=null}cL=lL=uL}if(cL&&lL.randomBytes)JS=lL.randomBytes(128),JS=new Uint32Array(new Uint8Array(JS).buffer),me.random.addEntropy(JS,1024,"crypto['randomBytes']");else if(typeof window<"u"&&typeof Uint32Array<"u"){if(GS=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(GS);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(GS);else break e;me.random.addEntropy(GS,1024,"crypto['getRandomValues']")}}catch(e){typeof window<"u"&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}var JS,lL,GS,cL,uL;me.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(e,t,r,n){r=r||{},n=n||{};var i=me.json,s=i.g({iv:me.random.randomWords(4,0)},i.defaults),a;if(i.g(s,r),r=s.adata,typeof s.salt=="string"&&(s.salt=me.codec.base64.toBits(s.salt)),typeof s.iv=="string"&&(s.iv=me.codec.base64.toBits(s.iv)),!me.mode[s.mode]||!me.cipher[s.cipher]||typeof e=="string"&&100>=s.iter||s.ts!==64&&s.ts!==96&&s.ts!==128||s.ks!==128&&s.ks!==192&&s.ks!==256||2>s.iv.length||4<s.iv.length)throw new me.exception.invalid("json encrypt: invalid parameters");return typeof e=="string"?(a=me.misc.cachedPbkdf2(e,s),e=a.key.slice(0,s.ks/32),s.salt=a.salt):me.ecc&&e instanceof me.ecc.elGamal.publicKey&&(a=e.kem(),s.kemtag=a.tag,e=a.key.slice(0,s.ks/32)),typeof t=="string"&&(t=me.codec.utf8String.toBits(t)),typeof r=="string"&&(s.adata=r=me.codec.utf8String.toBits(r)),a=new me.cipher[s.cipher](e),i.g(n,s),n.key=e,s.ct=s.mode==="ccm"&&me.arrayBuffer&&me.arrayBuffer.ccm&&t instanceof ArrayBuffer?me.arrayBuffer.ccm.encrypt(a,t,s.iv,r,s.ts):me.mode[s.mode].encrypt(a,t,s.iv,r,s.ts),s},encrypt:function(e,t,r,n){var i=me.json,s=i.ja.apply(i,arguments);return i.encode(s)},ia:function(e,t,r,n){r=r||{},n=n||{};var i=me.json;t=i.g(i.g(i.g({},i.defaults),t),r,!0);var s,a;if(s=t.adata,typeof t.salt=="string"&&(t.salt=me.codec.base64.toBits(t.salt)),typeof t.iv=="string"&&(t.iv=me.codec.base64.toBits(t.iv)),!me.mode[t.mode]||!me.cipher[t.cipher]||typeof e=="string"&&100>=t.iter||t.ts!==64&&t.ts!==96&&t.ts!==128||t.ks!==128&&t.ks!==192&&t.ks!==256||!t.iv||2>t.iv.length||4<t.iv.length)throw new me.exception.invalid("json decrypt: invalid parameters");return typeof e=="string"?(a=me.misc.cachedPbkdf2(e,t),e=a.key.slice(0,t.ks/32),t.salt=a.salt):me.ecc&&e instanceof me.ecc.elGamal.secretKey&&(e=e.unkem(me.codec.base64.toBits(t.kemtag)).slice(0,t.ks/32)),typeof s=="string"&&(s=me.codec.utf8String.toBits(s)),a=new me.cipher[t.cipher](e),s=t.mode==="ccm"&&me.arrayBuffer&&me.arrayBuffer.ccm&&t.ct instanceof ArrayBuffer?me.arrayBuffer.ccm.decrypt(a,t.ct,t.iv,t.tag,s,t.ts):me.mode[t.mode].decrypt(a,t.ct,t.iv,s,t.ts),i.g(n,t),n.key=e,r.raw===1?s:me.codec.utf8String.fromBits(s)},decrypt:function(e,t,r,n){var i=me.json;return i.ia(e,i.decode(t),r,n)},encode:function(e){var t,r="{",n="";for(t in e)if(e.hasOwnProperty(t)){if(!t.match(/^[a-z0-9]+$/i))throw new me.exception.invalid("json encode: invalid property name");switch(r+=n+'"'+t+'":',n=",",typeof e[t]){case"number":case"boolean":r+=e[t];break;case"string":r+='"'+escape(e[t])+'"';break;case"object":r+='"'+me.codec.base64.fromBits(e[t],0)+'"';break;default:throw new me.exception.bug("json encode: unsupported type")}}return r+"}"},decode:function(e){if(e=e.replace(/\s/g,""),!e.match(/^\{.*\}$/))throw new me.exception.invalid("json decode: this isn't json!");e=e.replace(/^\{|\}$/g,"").split(/,/);var t={},r,n;for(r=0;r<e.length;r++){if(!(n=e[r].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new me.exception.invalid("json decode: this isn't json!");n[3]!=null?t[n[2]]=parseInt(n[3],10):n[4]!=null?t[n[2]]=n[2].match(/^(ct|adata|salt|iv)$/)?me.codec.base64.toBits(n[4]):unescape(n[4]):n[5]!=null&&(t[n[2]]=n[5]==="true")}return t},g:function(e,t,r){if(e===void 0&&(e={}),t===void 0)return e;for(var n in t)if(t.hasOwnProperty(n)){if(r&&e[n]!==void 0&&e[n]!==t[n])throw new me.exception.invalid("required parameter overridden");e[n]=t[n]}return e},sa:function(e,t){var r={},n;for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(r[n]=e[n]);return r},ra:function(e,t){var r={},n;for(n=0;n<t.length;n++)e[t[n]]!==void 0&&(r[t[n]]=e[t[n]]);return r}};me.encrypt=me.json.encrypt;me.decrypt=me.json.decrypt;me.misc.pa={};me.misc.cachedPbkdf2=function(e,t){var r=me.misc.pa,n;return t=t||{},n=t.iter||1e3,r=r[e]=r[e]||{},n=r[n]=r[n]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):me.random.randomWords(2,0)},r=t.salt===void 0?n.firstSalt:t.salt,n[r]=n[r]||me.misc.pbkdf2(e,r,t.iter),{key:n[r].slice(0),salt:r.slice(0)}};var KS=class extends PZ{name="http";fetchProxied=!1;listening={};constructor(e,t,r){super(e),this.load(this),this.listen(t,r)}GET=(e="http://localhost:8080/ping",t="",r)=>(t==="json"&&(r="application/json"),new Promise((n,i)=>{let s=KS.request({method:"GET",url:e,responseType:t,mimeType:r,onload:a=>{let o;s.responseType===""||s.responseType==="text"?o=s.responseText:o=s.response,e instanceof URL&&(e=e.toString()),this.setState({[e]:o}),n(o)},onabort:a=>{i(a)}})}).catch(console.error));POST=(e,t="http://localhost:8080/echo",r="",n)=>(typeof e=="object"&&(r==="json"||r==="text"||!r)&&(e=JSON.stringify(e)),r==="json"&&(n="application/json"),new Promise((i,s)=>{let a=KS.request({method:"POST",url:t,data:e,responseType:r,mimeType:n,onload:o=>{let l;a.responseType===""||a.responseType==="text"?l=a.responseText:l=a.response,t instanceof URL&&(t=t.toString()),this.setState({[t]:l}),i(l)},onabort:o=>{s(o)}})}).catch(console.error));transmit=(e,t)=>{let r=e;return typeof r=="object"&&(e=JSON.stringify(r)),r?.method?.toLowerCase()=="get"||e?.toLowerCase()==="get"?this.GET(t):this.POST(e,t)};transponder=(e,t,r="",n)=>{typeof t=="object"&&(t=JSON.stringify(t));let i="GET";if(t&&(i="POST"),r==="json")n="application/json";else return new Promise((s,a)=>{let o=KS.request({method:i,url:e,data:t,responseType:r,onload:l=>{let c=o.response;if(typeof c=="string"){let f=c.substring(0,8);(f.includes("{")||f.includes("["))&&(f.includes("\\")&&(c=c.replace(/\\/g,"")),c[0]==='"'&&(c=c.substring(1,c.length-1)),c=JSON.parse(c))}return typeof c?.method=="string"?s(this.handleMethod(c.route,c.method,c.args)):typeof c?.route=="string"?s(this.handleServiceMessage(c)):typeof c?.node=="string"||c.node instanceof xr?s(this.handleGraphNodeCall(c.node,c.args)):s(c)},onabort:l=>{a(l)}})}).catch(console.error)};listen=(e="0",t=async(r,n,i)=>{let s=await r.text(),a=this.receive(s);this.setState({[i.url]:a})})=>{this.listening[e]={};let r=`${e}${Math.floor(Math.random()*1e15)}`;return this.listening[e][r]=t,this.fetchProxied||(globalThis.fetch=new Proxy(globalThis.fetch,{apply(n,i,s){let a=n.apply(i,s);return a.then(o=>{if(o.ok){if(this.listening[0])for(let l in this.listeners){let c=o.clone();this.listening[0][l](c,s,o)}else for(let l in this.listening)if(o.url.includes(l)){for(let c in this.listening[e]){let f=o.clone();this.listening[e][c](f,s,o)}break}}}).catch(o=>{console.error(o)}),a}}),this.fetchProxied=!0),r};stopListening=(e,t)=>{if(!e&&e!==0)for(let r in this.listening)delete this.listening[r];else t?delete this.listening[t]:delete this.listening[e]}},n3e=KS;RNe(n3e,"request",e=>{let t=new XMLHttpRequest;return e.responseType?t.responseType=e.responseType:e.responseType="json",e.mimeType&&t.overrideMimeType(e.mimeType),e.onload&&t.addEventListener("load",e.onload,!1),e.onprogress&&t.addEventListener("progress",e.onprogress,!1),e.onabort&&t.addEventListener("abort",e.onabort,!1),e.onloadend&&t.addEventListener("loadend",e.onloadend,!1),e.onerror&&t.addEventListener("error",e.onerror,!1),t.open(e.method,e.url,!0,e.user,e.pass),e.onerror||(t.onerror=function(){t.abort()}),t.send(e.data),t});var Sf=MNe($Ne()),FZ=class extends PZ{name="worker";workers={};threadRot=0;connections;constructor(e){super(),this.connections={workers:this.workers},e?.services&&this.addServices(e.services),this.load(this),this.setLoaders(this.workerloader),e&&this.init(e),typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope&&this.addDefaultMessageListener()}loadWorkerRoute=(e,t)=>{e.workerUrl&&(e.url=e.workerUrl),e.workerId&&(e.__node.tag=e.workerId),e.__node.tag||(e.__node.tag=t),e._id=e.__node.tag;let r;if(this.workers[e._id]?r=this.workers[e._id]:e.worker&&(r=e.worker),r||(r=this.addWorker(e)),e.worker=r,!e.worker.__ondisconnected){let n=i=>{i.worker?.terminate()};e.__addOndisconnected(n)}if(e.transferFunctions)for(let n in e.transferFunctions)this.transferFunction(r,e.transferFunctions[n],n);if(e.transferClasses)for(let n in e.transferClasses)this.transferClass(r,e.transferClasses[n],n);if(r)return e.__operator||(e.__operator=(...n)=>{if(e.callback)if(!this.__node.nodes.get(e.__node.tag)?.__children)r.post(e.callback,n);else return r.run(e.callback,n);else if(!this.__node.nodes.get(e.__node.tag)?.__children)r.send(n);else return r.request(n)}),e.init&&r.run(e.init,e.initArgs,void 0,e.initTransfer),r};workerloader={workers:(e,t,r,n)=>{let i=e;if(!e.parentRoute&&t?.callback&&t?.worker&&(e.parentRoute=t?.callback),i?.worker||i?.workerId||i?.workerUrl){let s=this.loadWorkerRoute(i,i.__node.tag);s&&(!i.parentRoute&&i.__parent?.callback&&(i.parentRoute=i.__parent.callback),i.__parent&&!i.portId&&(typeof i.__parent=="string"?i.__node.tag!==i.__parent&&s._id!==i.__parent&&(i.portId=this.establishMessageChannel(s,i.__parent)):i.__node.tag!==i.__parent?.__node?.tag&&s._id!==i.__parent?.tag&&(i.portId=this.establishMessageChannel(s,i.__parent.worker))),i.parentRoute?(i.stopped||(typeof i.__parent=="string"&&i.__parent===s._id?s.run("subscribe",[i.parentRoute,void 0,void 0,i.callback]):i.__node.tag===i.__parent?.__node?.tag||s._id===i.__parent?.__node?.tag?s.run("subscribe",[i.parentRoute,void 0,void 0,i.callback]):s.run("subscribeToWorker",[i.parentRoute,i.portId,void 0,i.callback,void 0,void 0,i.blocking]).then(a=>{s.workerSubs[i.parentRoute+i.portId].sub=a})),!(typeof i.__parent=="string"&&i.__parent===s._id)&&!(i.__node.tag===i.__parent?.__node?.tag||s._id===i.__parent?.__node?.tag)&&(s.workerSubs[i.parentRoute+i.portId]={sub:null,route:i.parentRoute,portId:i.portId,callback:i.callback,blocking:i.blocking})):i.__parent&&(typeof i.__parent=="string"?(i.stopped||(i.__parent===s._id?s.run("subscribe",[i.__parent,void 0,i.callback]):s.run("subscribeToWorker",[i.__parent,i.portId,void 0,i.callback,void 0,void 0,i.blocking]).then(a=>{s.workerSubs[i.__parent+i.portId].sub=a})),typeof i.__parent=="string"&&i.__parent===s._id||(s.workerSubs[i.__parent+i.portId]={sub:null,route:s._id,portId:i.portId,callback:i.callback,blocking:i.blocking})):i.__parent?.__node?.tag&&i.__parent?.worker&&(i.stopped||(i.__node.tag===i.__parent.__node.tag||s._id===i.__parent.__node.tag?s.run("subscribe",[i.__parent.__node.tag,void 0,void 0,i.callback]):s.run("subscribeToWorker",[i.__parent.__node.tag,i.portId,void 0,i.callback,void 0,void 0,i.blocking]).then(a=>{s.workerSubs[i.__parent.__node.tag+i.portId].sub=a})),i.__node.tag===i.__parent?.__node?.tag||s._id===i.__parent?.__node?.tag||(s.workerSubs[i.__parent.__node.tag+i.portId]={sub:null,route:i.__parent.__node.tag,portId:i.portId,callback:i.callback,blocking:i.blocking}))))}else i.__parent&&i.parentRoute&&(typeof i.__parent=="string"&&n[i.__parent]?.worker?n[i.__parent].worker.subscribe(i.parentRoute,i.__operator,void 0,void 0,void 0,i.blocking):i.__parent?.worker&&i.__parent.worker.subscribe(i.parentRoute,i.__operator,void 0,void 0,void 0,i.blocking));return i}};addDefaultMessageListener=()=>{globalThis.onmessage=e=>{let t=this.receive(e.data);this.__node.keepState&&this.setState({[this.name]:t})}};postMessage=(e,t,r)=>{this.workers[t]?this.workers[t].send(e,r):globalThis.postMessage(e,t,r)};addWorker=e=>{let t;if(e._id||(e._id=`worker${Math.floor(Math.random()*1e15)}`),e.url?t=new Sf.default(e.url):e.port?t=e.port:this.workers[e._id]&&(this.workers[e._id].port?t=this.workers[e._id].port:t=this.workers[e._id].worker),!t)return;let r=(d,p)=>this.transmit(d,t,p),n=(d,p,_,w)=>{let k={route:d,args:p};return _&&(k.method=_),this.transmit(k,t,w)},i=(d,p,_,w)=>new Promise((k,S)=>{let O=Math.random(),A={route:"runRequest",args:[{route:d,args:p},e._id,O]};_&&(A.args[0].method=_);let C=I=>{typeof I.data=="object"&&I.data.callbackId===O&&(t.removeEventListener("message",C),k(I.data.args))};t.addEventListener("message",C),this.transmit(A,t,w)}),s=(d,p,_)=>new Promise((w,k)=>{let S=Math.random(),O={route:"runRequest",args:[d,e._id,S]};p&&(O.method=p);let A=C=>{typeof C.data=="object"&&C.data.callbackId===S&&(t.removeEventListener("message",A),w(C.data.args))};t.addEventListener("message",A),this.transmit(O,t,_)}),a={},o=(d,p,_,w,k,S)=>this.subscribeToWorker(d,e._id,p,_,w,k,S),l=(d,p)=>i("unsubscribe",[d,p]),c=async(d,p,_,w)=>{if(d)await i("subscribeToWorker",[d,p,void 0,_,w]).then(k=>{k&&(a[d+p]={sub:k,route:d,portId:p,callback:_,blocking:w})});else for(let k in a)typeof a[k].sub!="number"&&await i("subscribeToWorker",[a[k].route,a[k].portId,void 0,a[k].callback,void 0,a[k].blocking]).then(S=>{a[k].sub=S}),console.log(JSON.stringify(a));return!0},f=async(d,p)=>{if(d&&p&&a[d+p])await i("unsubscribe",[d,a[d+p].sub]),a[d+p].sub=!1;else for(let _ in a)typeof a[_].sub=="number"&&await i("unpipeWorkers",[a[_].route,a[_].portId,a[_].sub]).then(console.log),a[_].sub=!1;return!0},u=()=>{for(let d in a)typeof a[d].sub=="number"&&i("unpipeWorkers",[a[d].route,a[d].portId,a[d].sub]),a[d].sub=!1;return this.terminate(e._id)};return e.onmessage||(e.onmessage=d=>{this.receive(d.data),this.setState({[e._id]:d.data})}),e.onerror||(e.onerror=d=>{console.error(d.data)}),t.onmessage=e.onmessage,t.onerror=e.onerror,this.workers[e._id]={worker:t,send:r,post:n,run:i,request:s,subscribe:o,unsubscribe:l,terminate:u,start:c,stop:f,postMessage:t.postMessage,workerSubs:a,graph:this,...e},this.workers[e._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=e=>{let t=new Blob([e],{type:"text/javascript"});return URL.createObjectURL(t)};getTransferable(e){let t;if(typeof e=="object")if(e.args)if(e.args?.constructor?.name==="Object")for(let r in e.args)ArrayBuffer.isView(e.args[r])?t?t.push(e.args[r].buffer):t=[e.args[r].buffer]:e.args[r]?.constructor?.name==="ArrayBuffer"&&(t?t.push(e.args[r]):t=[e.args[r]]);else Array.isArray(e.args)&&e.args.length<11?e.args.forEach(r=>{ArrayBuffer.isView(r)?t=[r.buffer]:r?.constructor?.name==="ArrayBuffer"&&(t=[r])}):ArrayBuffer.isView(e.args)?t=[e.args.buffer]:e.args?.constructor?.name==="ArrayBuffer"&&(t=[e]);else if(e?.constructor?.name==="Object")for(let r in e)ArrayBuffer.isView(e[r])?t?t.push(e[r].buffer):t=[e[r].buffer]:e[r]?.constructor?.name==="ArrayBuffer"&&(t?t.push(e[r]):t=[e[r]]);else Array.isArray(e)&&e.length<11?e.forEach(r=>{ArrayBuffer.isView(r)?t=[r.buffer]:r.constructor?.name==="ArrayBuffer"&&(t=[r])}):ArrayBuffer.isView(e)?t=[e.buffer]:e.constructor?.name==="ArrayBuffer"&&(t=[e]);return t}transmit=(e,t,r)=>{if(r||(r=this.getTransferable(e)),t instanceof Sf.default||t instanceof MessagePort)t.postMessage(e,r);else if(typeof t=="string")this.workers[t]&&(this.workers[t].port?this.workers[t].port.postMessage(e,r):this.workers[t].worker&&this.workers[t].worker.postMessage(e,r));else{let n=Object.keys(this.workers);this.workers[n[this.threadRot]].worker.postMessage(e,r),this.threadRot++,this.threadRot===n.length&&(this.threadRot=0)}return e};terminate=e=>{let t;if(typeof e=="string"){let r=this.workers[e];r&&(delete this.workers[e],e=r.worker,r.onclose&&(t=r.onclose))}else typeof e=="object"&&e?._id&&(e=e.worker,delete this.workers[e?._id]);return e instanceof Sf.default?(e.terminate(),t&&t(e),!0):e instanceof MessagePort?(e.close(),t&&t(e),!0):!1};establishMessageChannel=(e,t)=>{let r;if(typeof e=="string"?(r=e,this.workers[e]&&(this.workers[e].port?e=this.workers[e].port:t=this.workers[e].worker)):e?.worker&&(e=e.worker),typeof t=="string"?this.workers[t]&&(this.workers[t].port?t=this.workers[t].port:t=this.workers[t].worker):t?.worker&&(t=t.worker),e instanceof Sf.default||e instanceof MessagePort){let n=new MessageChannel,i=`port${Math.floor(Math.random()*1e15)}`;return e.postMessage({route:"addWorker",args:{port:n.port1,_id:i}},[n.port1]),t instanceof Sf.default||t instanceof MessagePort?t.postMessage({route:"addWorker",args:{port:n.port2,_id:i}},[n.port2]):r&&this.workers[r]&&(n.port2.onmessage=this.workers[r].onmessage,this.workers[r].port=n.port2),i}return!1};request=(e,t,r,n)=>{let i=this.workers[t].worker;return new Promise((s,a)=>{let o=Math.random(),l={route:"runRequest",args:[e,o]};n&&(l.method=n);let c=f=>{typeof f.data=="object"&&f.data.callbackId===o&&(i.removeEventListener("message",c),s(f.data.args))};i.addEventListener("message",c),this.transmit(l,i,r)})};runRequest=(e,t,r)=>{let n=this.receive(e);return typeof t=="string"&&this.workers[t]&&(this.workers[t].port?t=this.workers[t].port:t=this.workers[t].worker),n instanceof Promise?n.then(i=>{t instanceof Sf.default||t instanceof MessagePort?t.postMessage({args:i,callbackId:r}):typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&globalThis.postMessage({args:i,callbackId:r})}):t instanceof Sf.default||t instanceof MessagePort?t.postMessage({args:n,callbackId:r}):typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&globalThis.postMessage({args:n,callbackId:r}),n};subscribeWorker=(e,t,r,n,i,s)=>{let a;if(s){let o=!1;a=l=>{o||(o=!0,l instanceof Promise?l.then(c=>{t?.run&&t.run("triggerSubscription",[e,t._id,c]).then(f=>{o=!1})}):t?.run&&t.run("triggerSubscription",[e,t._id,l]).then(c=>{o=!1}))}}else a=o=>{o instanceof Promise?o.then(l=>{t?.postMessage?t.postMessage({args:l,callbackId:e}):globalThis.postMessage&&globalThis.postMessage({args:l,callbackId:e})}):t?.postMessage?t.postMessage({args:o,callbackId:e}):globalThis.postMessage&&globalThis.postMessage({args:o,callbackId:e})};return!s&&t?.port?t=t.port:!s&&t?.worker?t=t.worker:typeof t=="string"&&this.workers[t]&&(s?t=this.workers[t]:this.workers[t].port?t=this.workers[t].port:t=this.workers[t].worker),this.subscribe(e,a,r,n,i)};subscribeToWorker=(e,t,r,n,i,s,a)=>{if(typeof t=="string"&&this.workers[t])return this.__node.state.subscribeEvent(t,o=>{o?.callbackId===e&&(r?typeof r=="string"?this.run(r,o.args):r(o.args):this.setState({[t]:o.args}))}),this.workers[t].run("subscribeWorker",[e,t,n,i,s,a])};triggerSubscription=async(e,t,r)=>{if(this.__node.state.triggers[t])for(let n=0;n<this.__node.state.triggers[t].length;n++)await this.__node.state.triggers[t][n].onchange({args:r,callbackId:e});return!0};pipeWorkers=(e,t,r,n,i,s,a,o,l)=>(typeof e=="string"&&(e=this.workers[e]),typeof t=="string"&&(t=this.workers[t]),i||(i=this.establishMessageChannel(e.worker,t.worker)),t.run("subscribeToWorker",[r,i,n,s,a,o,l]));unpipeWorkers=(e,t,r)=>{if(typeof t=="string"&&(t=this.workers[t]),typeof t=="object")return t.run("unsubscribe",[e,r])}},ul=_L(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]),i3e=_L(["deltaX","deltaY"]),s3e=_L(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function AZ(e,t){let r={type:e.type};r.isTrusted=e.isTrusted,r.bubbles=e.bubbles,r.cancelBubble=e.cancelBubble,r.cancelable=e.cancelable,r.composed=e.composed,r.defaultPrevent=e.defaultPrevented,r.eventPhase=e.eventPhase,r.returnValue=e.returnValue,r.currentTarget=e.currentTarget.id?e.currentTarget.id:e.currentTarget.constructor.name,r.target=r.currentTarget,r.srcElement=r.currentTarget,t(r)}function a3e(e,t,r){r&&e.preventDefault&&e.preventDefault(),i3e(e,t)}function o3e(e,t,r){r&&e.preventDefault&&e.preventDefault()}function l3e(e,t,r){for(let n of t)r[n]=e[n]}function _L(e){return function(r,n){let i={type:r.type};l3e(r,e,i),n(i)}}function fL(e,t,r){r&&e.preventDefault&&e.preventDefault();let n=[],i={type:e.type,touches:n};for(let s=0;s<e.touches.length;++s){let a=e.touches[s];n.push({pageX:a.pageX,pageY:a.pageY})}t(i)}var dL=1,DZ={};for(;dL<222;)DZ[dL]=!0,dL++;function TZ(e,t,r){let{keyCode:n}=e;DZ[n]&&(r&&e.preventDefault&&(n<110||n>123)&&e.preventDefault(),s3e(e,t))}var rv={contextmenu:o3e,mousedown:ul,mousemove:ul,mouseup:ul,pointerdown:ul,pointermove:ul,pointerup:ul,pointerlockchange:ul,webkitpointerlockchange:ul,focus:AZ,blur:AZ,pointerout:ul,touchstart:fL,touchmove:fL,touchend:fL,wheel:a3e,keydown:TZ,keyup:TZ};function wL(e,t,r,n){r||(r="proxy"+Math.floor(Math.random()*1e15));let i=o=>{t?t.postMessage({route:"handleProxyEvent",args:[o,r]}):jZ(o,r)},s=Object.entries(rv);for(let[o,l]of s)e.addEventListener(o,function(c){l(c,i,n)});rv.keydown&&globalThis.addEventListener("keydown",function(o){rv.keydown(o,i,n)}),rv.keyup&&globalThis.addEventListener("keyup",function(o){rv.keyup(o,i,n)});let a=()=>{let o=e.getBoundingClientRect();i({type:"resize",left:o.left,top:o.top,width:e.clientWidth,height:e.clientHeight})};return a(),globalThis.addEventListener("resize",a),r}var c3e=class{__listeners;addEventListener(e,t){this.__listeners===void 0&&(this.__listeners={});let r=this.__listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this.__listeners===void 0)return!1;let r=this.__listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this.__listeners===void 0)return;let n=this.__listeners[e];if(n!==void 0){let i=n.indexOf(t);i!==-1&&n.splice(i,1)}}dispatchEvent(e,t){if(this.__listeners===void 0)return;let n=this.__listeners[e.type];if(n!==void 0){t?e.target=t:e.target=this;let i=n.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e)}}};function CZ(){}var u3e=class extends c3e{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super(),this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>({left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height});handleEvent=e=>{e.type==="resize"&&(this.left=e.left,this.top=e.top,this.width=e.width,this.height=e.height,typeof this.proxied=="object"&&(this.proxied.style.width=this.width+"px",this.proxied.style.height=this.height+"px",this.proxied.clientWidth=this.width,this.proxied.clientHeight=this.height)),e.preventDefault=CZ,e.stopPropagation=CZ,this.dispatchEvent(e,this.proxied)};focus(){}blur(){}},QS=class{targets={};constructor(){globalThis.document||(globalThis.document={elementFromPoint:(...e)=>this.targets[Object.keys(this.targets)[0]].proxied})}makeProxy=(e,t=void 0)=>{e||(e=`proxyReceiver${Math.floor(Math.random()*1e15)}`);let r;this.targets[e]?r=this.targets[e]:(r=new u3e,this.targets[e]=r),typeof t=="object"&&(t.proxy=r,r.proxied=t,typeof WorkerGlobalScope<"u"&&(t.style=r.style),r.width&&(t.style.width=r.width+"px",t.clientWidth=r.width),r.height&&(t.style.height=r.height+"px",t.clientHeight=r.height),t.setPointerCapture=r.setPointerCapture.bind(r),t.releasePointerCapture=r.releasePointerCapture.bind(r),t.getBoundingClientRect=r.getBoundingClientRect.bind(r),t.addEventListener=r.addEventListener.bind(r),t.removeEventListener=r.removeEventListener.bind(r),t.handleEvent=r.handleEvent.bind(r),t.dispatchEvent=r.dispatchEvent.bind(r),t.focus=r.focus.bind(r),t.blur=r.blur.bind(r))};getProxy=e=>this.targets[e];handleEvent=(e,t)=>{if(this.targets[t]||this.makeProxy(t),this.targets[t])return this.targets[t].handleEvent(e),!0}};function f3e(e,t){return this?.__node?.graph?(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new QS),this.__node.graph.ProxyManager.makeProxy(e,t)):(globalThis.ProxyManager||(globalThis.ProxyManager=new QS),globalThis.ProxyManager.makeProxy(e,t)),e}function jZ(e,t){if(this?.__node?.graph){if(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new QS),this.__node.graph.ProxyManager.handleEvent(e,t))return e}else if(globalThis.ProxyManager||(globalThis.ProxyManager=new QS),globalThis.ProxyManager.handleEvent(e,t))return e}var SL={initProxyElement:wL,makeProxy:f3e,handleProxyEvent:jZ};function d3e(e){if(e.worker){let t=e.worker,r=e.route;return(t instanceof Blob||typeof t=="string")&&(t=new Worker(t)),delete e.worker,delete e.route,BZ(t,e,r)}else return wL(e.canvas,void 0,e._id,e.preventDefault),MZ(e)}function BZ(e,t,r){if(!t)return;t._id||(t._id=`canvas${Math.floor(Math.random()*1e15)}`);let n=t.canvas.transferControlToOffscreen();t.width||(t.width=t.canvas.clientWidth),t.height||(t.height=t.canvas.clientHeight);let i={route:r||"setupCanvas",args:{...t,canvas:n}};this?.__node?.graph?this.__node.graph.run("initProxyElement",t.canvas,e,t._id,t.preventDefault):wL(t.canvas,e,t._id,t.preventDefault),t.draw&&(typeof t.draw=="function"?i.args.draw=t.draw.toString():i.args.draw=t.draw),t.update&&(typeof t.update=="function"?i.args.update=t.update.toString():i.args.update=t.update),t.init&&(typeof t.init=="function"?i.args.init=t.init.toString():i.args.init=t.init),t.clear&&(typeof t.clear=="function"?i.args.clear=t.clear.toString():i.args.clear=t.clear);let s=[n];return t.transfer&&(s.push(...t.transfer),delete t.transfer),e.postMessage(i,s),{_id:t._id,width:t.width,height:t.height,worker:e,draw:(o,l)=>{e.postMessage({route:"drawFrame",args:[o,t._id]},l)},update:(o,l)=>{e.postMessage({route:"updateCanvas",args:[o,t._id]},l)},clear:()=>{e.postMessage({route:"clearCanvas",args:t._id})},init:()=>{e.postMessage({route:"initCanvas",args:t._id})},stop:()=>{e.postMessage({route:"stopAnim",args:t._id})},start:()=>{e.postMessage({route:"startAnim",args:t._id})},set:(o,l)=>{e.postMessage({route:"setDraw",args:[o,t._id]},l)},terminate:()=>{e.terminate()}}}function YS(e,t){let r;if(this?.__node?.graph?t?r=this.__node.graph.CANVASES?.[e._id]:e._id?r=this.__node.graph.CANVASES?.[e._id]:r=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:t||e._id?r=globalThis.CANVASES?.[e._id]:r=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],r)return e.canvas&&(r.canvas=e.canvas,this?.__node?.graph?this.__node.graph.run("makeProxy",r._id,r.canvas):SL.makeProxy(r._id,r.canvas)),typeof e.context=="string"?r.context=r.canvas.getContext(e.context):e.context&&(r.context=e.context),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),typeof e.draw=="string"&&(e.draw=fl(e.draw)),typeof e.draw=="function"&&(r.draw=e.draw.bind(e)),typeof e.update=="string"&&(e.update=fl(e.update)),typeof e.update=="function"&&(r.update=e.update.bind(e)),typeof e.init=="string"&&(e.init=fl(e.init)),typeof e.init=="function"&&(r.init=e.init.bind(e)),typeof e.clear=="string"&&(e.clear=fl(e.clear)),typeof e.clear=="function"&&(r.clear=e.clear.bind(e)),e._id}function MZ(e){this?.__node?.graph?this.__node.graph.CANVASES||(this.__node.graph.CANVASES={}):globalThis.CANVASES||(globalThis.CANVASES={});let t=e;if(e._id?t._id=e._id:t._id=`canvas${Math.floor(Math.random()*1e15)}`,typeof e.context=="string"?t.context=e.canvas.getContext(e.context):t.context=e.context,"animating"in e?t.animating=e.animating:t.animating=!0,this?.__node?.graph?.CANVASES[t._id])this.__node.graph.run("setDraw",t);else if(globalThis.CANVASES?.[t._id])YS(t);else if(this?.__node?.graph&&(t.graph=this.__node.graph,t.__node||(t.__node={}),t.__node.tag||(t.__node.tag=t._id),t=this.__node.graph.add(t),t.__addOndisconnected=()=>{t.stop(),delete this.__node.graph.CANVASES[t._id]}),this?.__node?.graph?this.__node.graph.CANVASES[t._id]=t:globalThis.CANVASES[t._id]=t,this?.__node?.graph?this.__node.graph.run("makeProxy",t._id,t.canvas):SL.makeProxy(t._id,t.canvas),e.width&&(t.canvas.width=e.width),e.height&&(t.canvas.height=e.height),typeof t.draw=="string"?t.draw=fl(t.draw):typeof t.draw=="function"&&(t.draw=t.draw.bind(t)),typeof t.update=="string"?t.update=fl(t.update):typeof t.update=="function"&&(t.update=t.update.bind(t)),typeof t.init=="string"?t.init=fl(t.init):typeof t.init=="function"&&(t.init=t.init.bind(t)),typeof t.clear=="string"?t.clear=fl(t.clear):typeof t.clear=="function"&&(t.clear=t.clear.bind(t)),typeof t.init=="function"&&t.init(t,t.canvas,t.context),t.stop=()=>{XS(t._id)},t.start=r=>{bL(t._id,r)},t.set=r=>{YS(r,t._id)},typeof t.draw=="function"&&t.animating){let r=(n,i,s)=>{n.animating&&(n.draw(n,i,s),requestAnimationFrame(()=>{r(n,i,s)}))};r(t,t.canvas,t.context)}return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?t._id:{_id:e._id,width:e.width,height:e.height,draw:n=>{RZ(n,e._id)},update:n=>{zZ(n,e._id)},clear:()=>{$Z(e._id)},init:()=>{UZ(e._id)},stop:()=>{XS(e._id)},start:()=>{bL(e._id)},set:n=>{YS(n,e._id)},terminate:()=>{this.__node?.graph?this.__node.graph.remove(e._id):(XS(e._id),this?.__node?.graph?delete this.__node.graph.CANVASES[t._id]:delete globalThis.CANVASES[t._id])}}}function RZ(e,t){let r=Ac.call(this,t);if(r&&(e&&Object.assign(r,e),r.draw))return r.draw(r,r.canvas,r.context),t}function $Z(e){let t=Ac.call(this,e);if(t?.clear)return t.clear(t,t.canvas,t.context),e}function UZ(e){let t=Ac.call(this,e);if(t?.init)return t.init(t,t.canvas,t.context),e}function zZ(e,t){let r=Ac.call(this,t);if(r?.update)return r.update(r,r.canvas,r.context,e),t}function p3e(e,t){let r=Ac.call(this,t);if(r)return Object.assign(r,e),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),t}function bL(e,t){let r=Ac.call(this,e);if(r.animating=!0,r&&t)return typeof t=="string"&&(t=fl(t)),typeof t=="function"&&(r.draw=t),e;if(typeof r?.draw=="function"){let n=(i,s,a)=>{i.animating&&(i.draw(i,s,a),requestAnimationFrame(()=>{n(i,s,a)}))};return typeof r.clear=="function"&&r.clear(r,r.canvas,r.context),typeof r.init=="function"&&r.init(r,r.canvas,r.context),n(r,r.canvas,r.context),e}}function XS(e){let t=Ac.call(this,e);if(t)return t.animating=!1,typeof t.clear=="function"&&requestAnimationFrame(t.clear(t,t.canvas,t.context)),e}function Ac(e){let t;return this?.__node?.graph?e?t=this.__node.graph.CANVASES?.[e]:t=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:e?t=globalThis.CANVASES?.[e]:t=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],t}var qZ={...SL,Renderer:d3e,transferCanvas:BZ,setupCanvas:MZ,setDraw:YS,drawFrame:RZ,clearCanvas:$Z,initCanvas:UZ,updateCanvas:zZ,setProps:p3e,startAnim:bL,stopAnim:XS,getCanvas:Ac};function fl(e=""){let t=a=>a.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),n=(a=>{let o=a.indexOf("=>")+1;return o<=0&&(o=a.indexOf("){")),o<=0&&(o=a.indexOf(") {")),a.slice(0,a.indexOf("{",o)+1)})(e),i=t(e),s;if(n.includes("function")){let a=n.split("(")[1].split(")")[0];s=new Function(a,i)}else if(n.substring(0,6)===i.substring(0,6)){let a=n.split("(")[1].split(")")[0];s=new Function(a,i.substring(i.indexOf("{")+1,i.length-1))}else try{s=(0,eval)(n+i+"}")}catch{}return s}var h3e=`(()=>{var __require=(x=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(x,{get:(a,b)=>(typeof require!=="undefined"?require:a)[b]}):x)(function(x){if(typeof require!=="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+x+'" is not supported')});var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __require2=(x=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x)(function(x){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error('Dynamic require of "'+x+'" is not supported')});var __commonJS=(cb,mod)=>function __require22(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:true}):target,mod));var __publicField=(obj,key,value)=>{__defNormalProp(obj,typeof key!=="symbol"?key+"":key,value);return value};var require_browser=__commonJS({"node_modules/web-worker/cjs/browser.js"(exports,module2){module2.exports=Worker}});var EventHandler=class{data={};triggers={};ctr=0;constructor(data){if(typeof data==="object")this.data=data}setState=updateObj=>{Object.assign(this.data,updateObj);let props=Object.getOwnPropertyNames(updateObj);for(const prop of props){this.triggerEvent(prop,this.data[prop])}if(this.triggers[statesubKey]){let run=fn=>{fn(updateObj)};const l=this.triggers[statesubKey].length;for(let i2=l-1;i2>=0;i2--){run(this.triggers[statesubKey][i2].onchange)}}return this.data};setValue=(key,value)=>{this.data[key]=value;this.triggerEvent(key,value)};triggerEvent=(key,value)=>{if(this.triggers[key]){let fn=obj=>{obj.onchange(value)};const l=this.triggers[key].length;for(let i2=l-1;i2>=0;i2--){fn(this.triggers[key][i2])}}};subscribeState=onchange=>{return this.subscribeEvent(statesubKey,onchange)};unsubscribeState=sub=>{return this.unsubscribeEvent(statesubKey,sub)};subscribeEvent=(key,onchange,refObject,refKey)=>{if(key){if(refObject&&refKey&&!this.triggers[key]){Object.defineProperty(this.data,key,{get:()=>{return refObject[refKey]},set:value=>{refObject[refKey]=value},enumerable:true,configurable:true})}if(!this.triggers[key]){this.triggers[key]=[]}let l=this.ctr;this.ctr++;this.triggers[key].push({sub:l,onchange});return l}else return void 0};unsubscribeEvent=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(sub===void 0){delete this.triggers[key];delete this.data[key]}else{let idx=void 0;let obj=triggers.find((o,i2)=>{if(o.sub===sub){idx=i2;return true}});if(obj)triggers.splice(idx,1);if(Object.keys(triggers).length===0){delete this.triggers[key];delete this.data[key]}if(this.onRemoved)this.onRemoved(obj);return true}}};subscribeEventOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeEvent(key,sub)};sub=this.subscribeEvent(key,changed);return sub};getEvent=(key,sub)=>{for(const s in this.triggers[key]){if(this.triggers[key][s].sub===sub)return this.triggers[key][s]}};getSnapshot=()=>{const snapshot={};for(const key in this.data){snapshot[key]=this.data[key]}};onRemoved};var statesubKey="*s";var state=new EventHandler;var GraphNode=class{__node={tag:\`node\${Math.floor(Math.random()*1e15)}\`,unique:\`\${Math.floor(Math.random()*1e15)}\`,state};__children;__parent;__operator;__listeners;__props;__args;constructor(properties,parent,graph){this.__setProperties(properties,parent,graph)}__setProperties=(properties,parent,graph)=>{let enforceProperties=()=>{let orig=properties;if(typeof properties==="function"){if(isNativeClass(properties)){properties=new properties}else properties={__operator:properties,__node:{forward:true,tag:properties.name}}}else if(typeof properties==="string"){if(graph?.get(properties)){properties=graph.get(properties)}}if(!("__node"in properties))properties.__node={};if(!properties.__node.initial)properties.__node.initial=orig};enforceProperties();if(typeof properties==="object"){let assignState=()=>{if(properties.__node?.state)this.__node.state=properties.__node.state;else if(graph){properties.__node.state=graph.__node.state}};let setProps2=()=>{if(properties.__props){if(typeof properties.__props==="function")properties.__props=new properties.__props;if(typeof properties.__props==="object"){this.__proxyObject(properties.__props)}}};let setTag=()=>{if(!properties.__node.tag){if(properties.__operator?.name)properties.__node.tag=properties.__operator.name;else properties.__node.tag=\`node\${Math.floor(Math.random()*1e15)}\`}};let setNode=()=>{if(typeof properties.__node==="string"){if(graph?.get(properties.__node.tag)){properties=graph.get(properties.__node.tag)}else properties.__node={}}else if(!properties.__node)properties.__node={};if(graph){properties.__node.graph=graph}if(properties instanceof Graph)properties.__node.source=properties};let setParent=()=>{if(!properties.__parent&&parent)properties.__parent=parent;if(parent?.__node&&!(parent instanceof Graph||properties instanceof Graph))properties.__node.tag=parent.__node.tag+"."+properties.__node.tag;if(parent instanceof Graph&&properties instanceof Graph){if(properties.__node.loaders)Object.assign(parent.__node.loaders?parent.__node.loaders:{},properties.__node.loaders);if(parent.__node.mapGraphs){properties.__node.nodes.forEach(n=>{parent.set(properties.__node.tag+"."+n.__node.tag,n)});let ondelete=()=>{properties.__node.nodes.forEach(n=>{parent.__node.nodes.delete(properties.__node.tag+"."+n.__node.tag)})};this.__addOndisconnected(ondelete)}}};let setOp=()=>{if(typeof properties.default==="function"&&!properties.__operator){properties.__operator=properties.default}if(properties.__operator){if(typeof properties.__operator==="string"){if(graph){let n=graph.get(properties.__operator);if(n)properties.__operator=n.__operator;if(!properties.__node.tag&&properties.__operator.name)properties.__node.tag=properties.__operator.name}}if(typeof properties.__operator==="function")properties.__operator=this.__setOperator(properties.__operator);if(properties.default)properties.default=properties.__operator}};let assignProps=()=>{properties.__node=Object.assign(this.__node,properties.__node);let keys2=Object.getOwnPropertyNames(properties).filter(v=>{if(!objProps[v])return true});for(const key of keys2){if(key in properties)this[key]=properties[key]}};let bindCallbacks=()=>{if(this.__onconnected){if(typeof this.__onconnected==="function"){this.__onconnected=this.__onconnected.bind(this)}else if(Array.isArray(this.__onconnected)){this.__onconnected=this.__onconnected.map(f=>{return f.bind(this)})}if(typeof this.__ondisconnected==="function"){this.__ondisconnected=this.__ondisconnected.bind(this)}else if(Array.isArray(this.__ondisconnected)){this.__ondisconnected=this.__ondisconnected.map(f=>{return f.bind(this)})}}};assignState();setTag();setProps2();setNode();setParent();assignProps();bindCallbacks();setOp()}};__subscribe=(callback,key,subInput,target,tkey,args)=>{const subscribeToFunction=(k,setTarget=(callback2,target2)=>target2?target2:callback2,triggerCallback=callback)=>{let wrappedArgs;if(args){let wrapped=wrapArgs(triggerCallback,args,this.__node.graph);triggerCallback=wrapped.__callback;wrappedArgs=wrapped.__args}let sub=this.__node.state.subscribeEvent(k,triggerCallback,this,key);let trigger=this.__node.state.getEvent(k,sub);if(!this.__listeners)this.__listeners={};this.__listeners[k]=this.__node.state.triggers[k];if(!trigger)return sub;trigger.source=this.__node.tag;if(key)trigger.key=key;trigger.target=setTarget(callback,target);if(subInput)trigger.subInput=subInput;if(args){trigger.arguments=args;trigger.__args=wrappedArgs}if(tkey)trigger.tkey=tkey;trigger.node=this;trigger.graph=this.__node.graph;return sub};const subscribeToGraph=callback2=>{let fn=this.__node.graph.get(callback2);if(!fn&&callback2.includes(".")){target=callback2.substring(0,callback2.lastIndexOf("."));let n=this.__node.graph.get(callback2.substring(0,target));tkey=callback2.lastIndexOf(".")+1;if(n&&typeof n[key]==="function")callback2=(...args2)=>{return n[tkey](...args2)}}else if(fn.__operator){callback2=fn.__operator;tkey="__operator"}};if(key){if(!this.__node.localState||!this.__node.localState[key]){this.__addLocalState(this,key)}if(typeof callback==="string"){tkey=callback;if(target){if(this.__node.graph?.get(target)){let n=this.__node.graph?.get(target);if(typeof n[callback]==="function"){let fn=n[callback];callback=(...inp)=>{fn(...inp)}}else{let k2=callback;let setter=inp=>{n[k2]=inp};callback=setter}}}else if(typeof this[callback]==="function"){let fn=this[callback];callback=(...inp)=>{fn(...inp)}}else if(this.__node.graph?.get(callback))subscribeToGraph(callback);if(typeof callback!=="function")return void 0}let sub;let k=subInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node)sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)});return sub}else{if(typeof callback==="string"){if(this.__node.graph.get(callback))callback=this.__node.graph.get(callback);tkey="__operator";if(typeof callback!=="object")return void 0}let sub;let k=subInput?this.__node.unique+"input":this.__node.unique;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node){sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)})}return sub}};__unsubscribe=(sub,key,unsubInput)=>{if(key){return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key,sub)}else return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"input":this.__node.unique,sub)};__setOperator=fn=>{fn=fn.bind(this);if(this.__args&&this.__node.graph){fn=wrapArgs(fn,this.__args,this.__node.graph).__callback}let inpstr=\`\${this.__node.unique}input\`;this.__operator=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[this.__node.unique]){if(typeof result?.then==="function"){result.then(res=>{if(res!==void 0)this.__node.state.setValue(this.__node.unique,res)}).catch(console.error)}else if(result!==void 0)this.__node.state.setValue(this.__node.unique,result)}return result};if(this.__parent instanceof GraphNode&&!this.__subscribedToParent){if(this.__parent.__operator){let sub=this.__parent.__subscribe(this);let ondelete=()=>{this.__parent?.__unsubscribe(sub);delete this.__subscribedToParent};this.__addOndisconnected(ondelete);this.__subscribedToParent=true}}return this.__operator};__addLocalState=(props,key)=>{if(!props)return;if(!this.__node.localState){this.__node.localState={}}const localState=this.__node.localState;const initState=(props2,k)=>{let str2=this.__node.unique+"."+k;let inpstr=\`\${str2}input\`;let get,set;let obj,descriptor;if(typeof props2[k]==="function"&&k!=="__operator"){if(this.__props?.[k]){obj=this.__props}else{obj=localState}get=()=>{return obj[k]};set=fn=>{if(!this.__props?.[k])fn=fn.bind(this);obj[k]=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[str2]){if(typeof result?.then==="function"){result.then(res=>{this.__node.state.triggerEvent(str2,res)}).catch(console.error)}else this.__node.state.triggerEvent(str2,result)}return result}};localState[k]=props2[k].bind(this);descriptor={get,set,enumerable:true,configurable:true}}else{let get2,set2;let obj2;if(this.__props?.[k]){obj2=this.__props}else{obj2=localState}get2=()=>{return obj2[k]};set2=v=>{obj2[k]=v;if(this.__node.state.triggers[str2])this.__node.state.triggerEvent(str2,v)};localState[k]=props2[k];descriptor={get:get2,set:set2,enumerable:true,configurable:true}}Object.defineProperty(props2,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}};if(key)initState(props,key);else{for(let k in props){initState(props,k)}}};__proxyObject=obj=>{const allProps=getAllProperties(obj);for(const k of allProps){const descriptor={get:()=>{return obj[k]},set:value=>{obj[k]=value},enumerable:true,configurable:true};Object.defineProperty(this,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}}};__addOnconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__onconnected)){this.__onconnected.push(callback)}else if(typeof this.__onconnected==="function"){this.__onconnected=[callback,this.__onconnected]}else this.__onconnected=callback}__addOndisconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__ondisconnected)){this.__ondisconnected.push(callback)}else if(typeof this.__ondisconnected==="function"){this.__ondisconnected=[callback,this.__ondisconnected]}else this.__ondisconnected=callback}__callConnected(node=this){if(typeof this.__onconnected==="function"){this.__onconnected(this)}else if(Array.isArray(this.__onconnected)){let fn=o=>{o(this)};this.__onconnected.forEach(fn)}}__callDisconnected(node=this){if(typeof this.__ondisconnected==="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let fn=o=>{o(this)};this.__ondisconnected.forEach(fn)}}};var Graph=class{__node={tag:\`graph\${Math.floor(Math.random()*1e15)}\`,unique:\`\${Math.random()}\`,nodes:new Map,state,roots:{}};constructor(options){this.init(options)}init=options=>{if(options){let cpy=Object.assign({},options);delete cpy.roots;recursivelyAssign(this.__node,cpy);if(options.roots)this.load(options.roots)}};load=roots=>{function recursivelyAssignChildren(target,obj,inChildren=true,top=true){if(top){if(target)Object.assign(target,obj);else target=Object.assign({},obj);recursivelyAssignChildren(target,obj,true,false)}if(obj?.__children&&!inChildren){if(obj.__children?.constructor.name==="Object"){if(target.__children?.constructor.name==="Object")recursivelyAssignChildren(target.__children,obj.__children,true,false);else target.__children=recursivelyAssignChildren({},obj.__children,true,false)}else{target.__children=obj.__children}}else if(inChildren){for(const key in obj){target[key]=Object.assign({},obj[key]);if(obj[key]?.__children){recursivelyAssignChildren({},obj[key].__children,false,false)}}}return target}this.__node.roots=recursivelyAssignChildren(this.__node.roots?this.__node.roots:{},roots);let cpy=Object.assign({},roots);if(cpy.__node)delete cpy.__node;let listeners=this.recursiveSet(cpy,this,void 0,roots);if(roots.__node){if(!roots.__node.tag)roots.__node._tag=\`roots\${Math.floor(Math.random()*1e15)}\`;else if(!this.get(roots.__node.tag)){let node=new GraphNode(roots,this,this);this.set(node.__node.tag,node);this.runLoaders(node,this,roots,roots.__node.tag);if(node.__listeners){listeners[node.__node.tag]=node.__listeners}}}else if(roots.__listeners){this.setListeners(roots.__listeners)}this.setListeners(listeners);return cpy};setLoaders=(loaders2,replace)=>{if(replace)this.__node.loaders=loaders2;else Object.assign(this.__node.loaders,loaders2);return this.__node.loaders};runLoaders=(node,parent,properties,key)=>{for(const l in this.__node.loaders){if(typeof this.__node.loaders[l]==="object"){if(this.__node.loaders[l].init)this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key);if(this.__node.loaders[l].connected)node.__addOnconnected(this.__node.loaders[l].connect);if(this.__node.loaders[l].disconnected)node.__addOndisconnected(this.__node.loaders[l].disconnect)}else if(typeof this.__node.loaders[l]==="function")this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key)}};add=(properties,parent)=>{let listeners={};if(typeof parent==="string")parent=this.get(parent);let instanced;if(typeof properties==="function"){if(isNativeClass(properties)){if(properties.prototype instanceof GraphNode){properties=properties.prototype.constructor(properties,parent,this);instanced=true}else properties=new properties}else properties={__operator:properties}}else if(typeof properties==="string"){properties=this.__node.roots[properties]}if(!properties)return;if(!instanced){let keys2=Object.getOwnPropertyNames(properties);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(properties));keys2.push(...nonArrowFunctions);keys2=keys2.filter(v=>!objProps.includes(v));let cpy={};for(const key of keys2){cpy[key]=properties[key]}properties=cpy}if(!properties.__node)properties.__node={};properties.__node.initial=properties;if(typeof properties==="object"&&!this.get(properties.__node.tag)){let node;let root=recursivelyAssign({},properties,2);if(instanced)node=properties;else node=new GraphNode(properties,parent,this);this.set(node.__node.tag,node);this.runLoaders(node,parent,properties,node.__node.tag);this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key in node.__listeners){let listener=node.__listeners[key];if(node[key]){delete listeners[node.__node.tag][key];listeners[node.__node.tag][node.__node.tag+"."+key]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][key]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][key]=parent.__node.tag}}}}this.setListeners(listeners);node.__callConnected();return node}else if(properties.__node.tag)return this.get(properties.__node.tag)};recursiveSet=(t2,parent,listeners={},origin)=>{let keys2=Object.getOwnPropertyNames(origin);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(origin)).filter(v=>!objProps.includes(v));keys2.push(...nonArrowFunctions);for(const key of keys2){if(key.includes("__"))continue;let p=origin[key];if(Array.isArray(p))continue;let instanced;if(typeof p==="function"){if(isNativeClass(p)){p=new p;if(p instanceof GraphNode){p=p.prototype.constructor(p,parent,this);instanced=true}}else p={__operator:p}}else if(typeof p==="string"){if(this.__node.nodes.get(p))p=this.__node.nodes.get(p);else p=this.__node.roots[p]}else if(typeof p==="boolean"){if(this.__node.nodes.get(key))p=this.__node.nodes.get(key);else p=this.__node.roots[key]}if(p instanceof Object){if(!instanced&&!(p instanceof GraphNode)){let ks=Object.getOwnPropertyNames(p);let nonArrowFunctions2=Object.getOwnPropertyNames(Object.getPrototypeOf(p));nonArrowFunctions2.splice(nonArrowFunctions2.indexOf("constructor"),1);ks.push(...nonArrowFunctions2);let cpy={};for(const key2 of ks){cpy[key2]=p[key2]}p=cpy}if(!p.__node)p.__node={};if(!p.__node.tag)p.__node.tag=key;if(!p.__node.initial)p.__node.initial=t2[key];if(this.get(p.__node.tag)&&!(!(parent instanceof Graph)&&parent?.__node)||parent?.__node&&this.get(parent.__node.tag+"."+p.__node.tag))continue;let node;let newnode=false;let root=recursivelyAssign({},p,2);if(instanced||p instanceof GraphNode){node=p}else{node=new GraphNode(p,parent,this);newnode=true}if(!newnode&&p instanceof GraphNode&&!instanced&&parent instanceof GraphNode){let sub=this.subscribe(parent.__node.tag,node.__node.tag);let ondelete=node2=>{this.unsubscribe(parent.__node.tag,sub)};node.__addOndisconnected(ondelete)}else if(node){this.set(node.__node.tag,node);this.runLoaders(node,parent,t2[key],key);t2[key]=node;this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key2 in node.__listeners){let listener=node.__listeners[key2];let k=key2;if(node[key2]){delete listeners[node.__node.tag][key2];k=node.__node.tag+"."+key2;listeners[node.__node.tag][k]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][k]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][k]=parent.__node.tag}}}}node.__callConnected()}}}return listeners};remove=(node,clearListeners=true)=>{this.unsubscribe(node);if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){this.delete(node.__node.tag);delete this.__node.roots[node.__node.tag];if(clearListeners){this.clearListeners(node)}node.__callDisconnected();const recursiveRemove=t2=>{for(const key in t2){this.unsubscribe(t2[key]);this.delete(t2[key].__node.tag);delete this.__node.roots[t2[key].__node.tag];this.delete(key);delete this.__node.roots[key];t2[key].__node.tag=t2[key].__node.tag.substring(t2[key].__node.tag.lastIndexOf(".")+1);if(clearListeners){this.clearListeners(t2[key])}t2[key].__callDisconnected();if(t2[key].__children){recursiveRemove(t2[key].__children)}}};if(node.__children){recursiveRemove(node.__children)}}if(node?.__node.tag&&node?.__parent){delete node?.__parent;node.__node.tag=node.__node.tag.substring(node.__node.tag.indexOf(".")+1)}if(node?.__node.graph)node.__node.graph=void 0;return node};run=(node,...args)=>{if(typeof node==="string"){let nd=this.get(node);if(!nd&&node.includes(".")){nd=this.get(node.substring(0,node.lastIndexOf(".")));if(typeof nd?.[node.substring(node.lastIndexOf(".")+1)]==="function")return nd[node.substring(node.lastIndexOf(".")+1)](...args)}else if(nd?.__operator)return nd.__operator(...args)}if(node?.__operator){return node?.__operator(...args)}};setListeners=listeners=>{for(const key in listeners){let node=this.get(key);if(typeof listeners[key]==="object"){for(const k in listeners[key]){let n=this.get(k);let sub;if(typeof listeners[key][k]!=="object")listeners[key][k]={__callback:listeners[key][k]};else if(!listeners[key][k].__callback){for(const kk in listeners[key][k]){if(typeof listeners[key][k][kk]!=="object"){listeners[key][k][kk]={__callback:listeners[key][k][kk]};if(node.__operator&&(listeners[key][k][kk].__callback===true||typeof listeners[key][k][kk].__callback==="undefined"))listeners[key][k][kk].__callback=node.__operator}let nn=this.get(kk);if(!nn){let tag=k.substring(0,k.lastIndexOf("."));nn=this.get(tag);if(nn){let prop=k.substring(k.lastIndexOf(".")+1);sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k][kk].__args,prop,listeners[key][k][kk].inputState,key,k)}}else{sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}if("__callback"in listeners[key][k]){if(node){if(listeners[key][k].__callback===true||typeof listeners[key][k].__callback==="undefined")listeners[key][k].__callback=node.__operator;if(typeof listeners[key][k].__callback==="function")listeners[key][k].__callback=listeners[key][k].__callback.bind(node)}if(!n){let tag=k.substring(0,k.lastIndexOf("."));n=this.get(tag);if(n){sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,k.substring(k.lastIndexOf(".")+1),listeners[key][k].inputState,key,k)}}else{sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}}}};clearListeners=(node,listener)=>{if(typeof node==="string")node=this.get(node);if(node?.__listeners){for(const key in node.__listeners){if(listener&&key!==listener)continue;if(typeof node.__listeners[key]?.sub!=="number")continue;let n=this.get(key);if(!n){n=this.get(key.substring(0,key.lastIndexOf(".")));if(n){if(typeof node.__listeners[key]==="object"&&!node.__listeners[key]?.__callback){for(const k in node.__listeners[key]){if(typeof node.__listeners[key][k]?.sub==="number"){this.unsubscribe(n,node.__listeners[key][k].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}else{if(typeof!node.__listeners[key]?.__callback==="number"){for(const k in node.__listeners[key]){if(node.__listeners[key][k]?.sub){this.unsubscribe(n,node.__listeners[key][k].sub,void 0,node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,void 0,node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}}};get=tag=>{return this.__node.nodes.get(tag)};set=(tag,node)=>{return this.__node.nodes.set(tag,node)};delete=tag=>{return this.__node.nodes.delete(tag)};getProps=(node,getInitial)=>{if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){let cpy;if(getInitial)cpy=Object.assign({},this.__node.roots[node.__node.tag]);else{cpy=Object.assign({},node);for(const key in cpy){if(key.includes("__"))delete cpy[key]}}}};subscribe=(nodeEvent,onEvent,args,key,subInput,target,bound,tkey)=>{let nd=nodeEvent;if(typeof nodeEvent==="string"){nd=this.get(nodeEvent);if(!nd&&nodeEvent.includes(".")){nd=this.get(nodeEvent.substring(0,nodeEvent.lastIndexOf(".")));key=nodeEvent.substring(nodeEvent.lastIndexOf(".")+1)}}if(target instanceof GraphNode)target=target.__node.tag;if(typeof onEvent==="string"){let setOnEventFromString=onEvent2=>{if(this.get(onEvent2)?.__operator){let node=this.get(onEvent2);target=onEvent2;onEvent2=function(...inp){return node.__operator(...inp)}}else if(onEvent2.includes(".")){target=onEvent2.substring(0,onEvent2.lastIndexOf("."));let n=this.get(target);let k=onEvent2.substring(onEvent2.lastIndexOf(".")+1);tkey=k;if(typeof n[k]==="function"){if(n[k]instanceof GraphNode)onEvent2=n[k];else onEvent2=function(...inp){return n[k](...inp)}}else{onEvent2=function(inp){n[k]=inp;return n[k]}}}return onEvent2};if(target){let node=this.get(target);if(typeof node?.[onEvent]==="function"){tkey=onEvent;onEvent=function(...inp){return node[key](...inp)}}else if(node[key]){tkey=key;if(node[key]instanceof GraphNode)onEvent=node[key];else onEvent=function(inp){node[key]=inp;return node[key]}}else{onEvent=setOnEventFromString(onEvent)}}else{onEvent=setOnEventFromString(onEvent)}}let sub;if(nd instanceof GraphNode){const doSub=()=>{sub=nd.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)nd.__unsubscribe(sub,key,subInput);sub=void 0};nd.__addOndisconnected(()=>{ondelete();nd.__addOnconnected(()=>{if(sub===void 0&&nd.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))onEvent=this.get(onEvent);if(onEvent instanceof GraphNode){onEvent.__addOndisconnected(()=>{ondelete()})}};doSub()}else if(typeof nodeEvent==="string"){let node=this.get(nodeEvent);if(node){if(onEvent instanceof GraphNode&&onEvent.__operator){const doSub=()=>{sub=node.__subscribe(onEvent.__operator,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput)};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});onEvent.__addOndisconnected(ondelete)};doSub()}else if(typeof onEvent==="function"||typeof onEvent==="string"){const doSub=()=>{sub=node.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput);sub=void 0};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))this.get(onEvent).__addOndisconnected(ondelete)};doSub()}}else{if(typeof onEvent==="string")onEvent=this.__node.nodes.get(onEvent).__operator;if(typeof onEvent==="function")sub=this.__node.state.subscribeEvent(nodeEvent,onEvent)}}return sub};unsubscribe=(node,sub,key,subInput)=>{if(node instanceof GraphNode){return node.__unsubscribe(sub,key,subInput)}else return this.get(node)?.__unsubscribe(sub,key,subInput)};setState=update=>{this.__node.state.setState(update)}};function recursivelyAssign(target,obj,maxDepth=Infinity,curDepth=0){for(const key in obj){if(obj[key]?.constructor.name==="Object"&&curDepth<maxDepth){curDepth++;if(target[key]?.constructor.name==="Object")recursivelyAssign(target[key],obj[key],maxDepth,curDepth);else target[key]=recursivelyAssign({},obj[key],maxDepth,curDepth)}else{target[key]=obj[key]}}return target}function getAllProperties(obj){var allProps=[],curr=obj;do{var props=Object.getOwnPropertyNames(curr);let fn=function(prop){if(allProps.indexOf(prop)===-1)allProps.push(prop)};props.forEach(fn)}while(curr=Object.getPrototypeOf(curr));return allProps}function isNativeClass(thing){return isFunction(thing)==="class"}function isFunction(x){const res=typeof x==="function"?x.prototype?Object.getOwnPropertyDescriptor(x,"prototype")?.writable?"function":"class":x.constructor.name==="AsyncFunction"?"async":"arrow":"";return res}var getCallbackFromString=(a,graph)=>{if(graph.get(a)?.__operator){let node=graph.get(a);return(...inp)=>{node.__operator(...inp)}}else if(a.includes(".")){let split=a.split(".");let popped=split.pop();let joined=split.join(".");let node=graph.get(joined);if(typeof graph.get(joined)?.[popped]==="function"){return(...inp)=>{return node[popped](...inp)}}else return()=>{return node[popped]}}else if(graph.get(a)){let node=graph.get(a);return()=>{return node}}else{let arg=a;return()=>{return arg}}};var wrapArgs=(callback,argOrder,graph)=>{let args=[];let forArg=(a,i2)=>{if(a==="__output"||a==="__input"||a==="__callback"){args[i2]={__callback:inp=>{return inp},__args:void 0,idx:i2}}else if(typeof a==="string"){args[i2]={__callback:getCallbackFromString(a,graph),__args:void 0,idx:i2}}else if(typeof a==="function"){let fn2=a;args[i2]={__callback:(...inp)=>{return fn2(...inp)},__args:void 0,idx:i2}}else if(typeof a==="object"&&(a.__input||a.__callback)){let recursivelyCreateCallback=function(c){let input=c.__input?c.__input:c.__callback;if(typeof c.__input==="string"){input={__callback:getCallbackFromString(c.__input,graph),__args:void 0,idx:i2}}if(c.__args){let wrapped=wrapArgs(input,c.__args,graph);input={__callback:wrapped.__callback,__args:wrapped.__args,idx:i2}}else{input={__callback:input,__args:void 0,idx:i2}}if(c.__output){let output=c.__output;if(typeof c.__output==="string"){output={__callback:getCallbackFromString(output,graph),__args:void 0,idx:i2}}else if(typeof a.__output==="object"){output=recursivelyCreateCallback(output)}if(typeof output?.__callback==="function"){let fn2=input.__callback;let callback2=output.__callback;input={__callback:(...inp)=>{return callback2(fn2(...inp))},__args:output.__args,idx:i2}}}return input};args[i2]=recursivelyCreateCallback(a)}else{let arg=a;args[i2]={__callback:()=>{return arg},__args:void 0,idx:i2}}};argOrder.forEach(forArg);if(typeof callback==="string")callback={__callback:getCallbackFromString(callback,graph),__args:void 0};let fn=typeof callback==="function"?callback:callback.__callback;callback=function(...inp){let mapArg=arg=>{return arg.__callback(...inp)};const result=fn(...args.map(mapArg));return result};return{__callback:callback,__args:args}};var objProps=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var backprop=(node,parent,graph)=>{if(node.__node.backward&&parent instanceof GraphNode){graph.setListeners({[parent.__node.tag]:{[node.__node.tag]:parent}})}};var loop=(node,parent,graph)=>{if(node.__operator&&!node.__node.looperSet){if(typeof node.__node.delay==="number"){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{setTimeout(async()=>{res(await fn(...args))},node.__node.delay)})})}else if(node.__node.frame===true){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{requestAnimationFrame(async()=>{res(await fn(...args))})})})}if(typeof node.__node.repeat==="number"||typeof node.__node.recursive==="number"){let fn=node.__operator;node.__setOperator(async(...args)=>{let i2=node.__node.repeat?node.__node.repeat:node.__node.recursive;let result;let repeater=async(tick,...inp)=>{while(tick>0){if(node.__node.delay||node.__node.frame){fn(...inp).then(async res=>{if(node.__node.recursive){await repeater(tick,res)}else await repeater(tick,...inp)});break}else result=await fn(...args);tick--}};await repeater(i2,...args);return result})}if(node.__node.loop&&typeof node.__node.loop==="number"){node.__node.looperSet=true;let fn=node.__operator;let time=node.__node.loop;node.__setOperator((...args)=>{if(!("looping"in node.__node))node.__node.looping=true;if(node.__node.looping){let last=performance.now();fn(...args);setTimeout(()=>{let now=performance.now();let overshoot=now-last-node.__node.loop;if(overshoot>0)time=node.__node.loop-overshoot;else time=node.__node.loop;if(time<=0)time=node.__node.loop;node.__operator(...args)},time)}});if(node.__node.looping)node.__operator();let ondelete=node2=>{if(node2.__node.looping)node2.__node.looping=false};node.__addOndisconnected(ondelete)}}};var animate=(node,parent,graph)=>{if(node.__node.animate===true||node.__animation){let fn=node.__operator;node.__setOperator((...args)=>{if(!("animating"in node.__node))node.__node.animating=true;if(node.__node.animating){if(typeof node.__animation==="function")node.__animation(...args);else fn(...args);requestAnimationFrame(()=>{node.__operator(...args)})}});if(node.__node.animating||(!("animating"in node.__node)||node.__node.animating)&&node.__animation)setTimeout(()=>{requestAnimationFrame(node.__operator)},10);let ondelete=node2=>{if(node2.__node.animating)node2.__node.animating=false};node.__addOndisconnected(ondelete)}};var branching=(node,parent,graph)=>{if(typeof node.__branch==="object"&&node.__operator&&!node.__branchApplied){let fn=node.__operator;node.__branchApplied=true;node.__operator=(...args)=>{let result=fn(...args);for(const key in node.__branch){let triggered=()=>{if(typeof node.__branch[key].then==="function"){node.__branch[key].then(result)}else if(node.__branch[key].then instanceof GraphNode&&node.__branch[key].then.__operator){node.__branch[key].then.__operator(result)}else result=node.__branch[key].then};if(typeof node.__branch[key].if==="function"){if(node.__branch[key].if(result)==true){triggered()}}else if(node.__branch[key].if===result){triggered()}}return result}}if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].branch&&!node.__listeners[key].branchApplied){let fn=node.__listeners[key].callback;node.__listeners[key].branchApplied=true;node.__listeners.callback=ret=>{let triggered=()=>{if(typeof node.__listeners[key].branch.then==="function"){ret=node.__listeners[key].branch.then(ret)}else if(node.__listeners[key].branch.then instanceof GraphNode&&node.__listeners[key].branch.then.__operator){ret=node.__listeners[key].branch.then.__operator(ret)}else ret=node.__listeners[key].branch.then};if(typeof node.__listeners[key].branch.if==="function"){if(node.__listeners[key].branch.if(ret)){triggered()}}else if(node.__listeners[key].branch.if===ret){triggered()}return fn(ret)}}}}}};var triggerListenerOncreate=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].oncreate){node.__listeners[key].callback(node.__listeners[key].oncreate)}}}}};var bindListener=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].binding==="object"){node.__listeners.callback=node.__listeners.callback.bind(node.__listeners[key].binding)}}}}};var transformListenerResult=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].transform==="function"&&!node.__listeners[key].transformApplied){let fn=node.__listeners[key].callback;node.__listeners[key].transformApplied=true;node.__listeners.callback=ret=>{ret=node.__listeners[key].transform(ret);return fn(ret)}}}}}};var substitute__operator=(node,parent,graph)=>{if(node.post&&!node.__operator){node.__setOperator(node.post)}else if(!node.__operator&&typeof node.get=="function"){node.__setOperator(node.get)}if(!node.get&&node.__operator){node.get=node.__operator}if(node.aliases){node.aliases.forEach(a=>{graph.set(a,node);let ondelete=node2=>{graph.__node.nodes.delete(a)};node.__addOndisconnected(ondelete)})}if(typeof graph.__node.roots?.[node.__node.tag]==="object"&&node.get)graph.__node.roots[node.__node.tag].get=node.get};var loaders={backprop,loop,animate,branching,triggerListenerOncreate,bindListener,transformListenerResult,substitute__operator};var recursivelyStringifyFunctions=obj=>{let cpy={};for(const key in obj){if(typeof obj[key]==="object"){cpy[key]=recursivelyStringifyFunctions(obj[key])}else if(typeof obj[key]==="function"){cpy[key]=obj[key].toString()}else cpy[key]=obj[key]}return cpy};function parseFunctionFromText(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs22(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs}var stringifyFast=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p in value[prop]){if(Array.isArray(value[prop][p])){if(value[prop][p].length>20)obj[prop][p]=value[prop][p].slice(value[prop][p].length-20);else obj[prop][p]=value[prop][p]}else{if(value[prop][p]!=null){let con=value[prop][p].constructor.name;if(con.includes("Set")){obj[prop][p]=Array.from(value[prop][p])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p]="instanceof_"+con}else{obj[prop][p]=value[prop][p]}}else{obj[prop][p]=value[prop][p]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast22(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast}function methodstrings(node){if(typeof node.__methods==="object"){for(const key in node.__methods){let fstr=node.__methods[key];let fn=typeof fstr==="function"?fstr:parseFunctionFromText(fstr);if(key==="__operator"){node.__setOperator(fn)}else{node[key]=fn.bind(node)}}}}var Service=class extends Graph{name=\`service\${Math.floor(Math.random()*1e15)}\`;constructor(options){super({...options,loaders:options?.loaders?Object.assign({...loaders},options.loaders):{...loaders}});if(options?.services)this.addServices(options.services);this.load(this)}addServices=services=>{for(const s in services){if(typeof services[s]==="function")services[s]=new services[s];if(services[s]?.__node?.loaders)Object.assign(this.__node.loaders,services[s].__node.loaders);if(services[s]?.__node?.nodes){services[s].__node.nodes.forEach((n,tag)=>{if(!this.get(tag)){this.set(tag,n)}else this.set(s+"."+tag,n)});this.__node.nodes.forEach((n,k)=>{if(!services[s].__node.nodes.get(k))services[s].__node.nodes.set(k,n)});let set=this.set;this.set=(tag,node)=>{services[s].set(tag,node);return set(tag,node)};let del=this.delete;this.delete=tag=>{services[s].delete(tag);return del(tag)}}else if(typeof services[s]==="object"){this.load(services[s])}}};handleMethod=(route,method,args)=>{let m=method.toLowerCase();let src=this.__node.nodes.get(route);if(!src){src=this.__node.roots[route]}if(src?.[m]){if(typeof src[m]!=="function"){if(args){if(Array.isArray(args)&&args.length===1)src[m]=args[0];else src[m]=args;return}return src[m]}else{if(Array.isArray(args))return src[m](...args);else return src[m](args)}}else return this.handleServiceMessage({route,args,method})};handleServiceMessage(message){let call;if(typeof message==="object"){if(message.route)call=message.route;else if(message.node)call=message.node}if(call){if(Array.isArray(message.args))return this.run(call,...message.args);else return this.run(call,message.args)}else return message}handleGraphNodeCall(route,args){if(!route)return args;if(args?.args){this.handleServiceMessage(args)}else if(Array.isArray(args))return this.run(route,...args);else return this.run(route,args)}transmit=(...args)=>{if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};receive=(...args)=>{if(args[0]){if(typeof args[0]==="string"){let substr=args[0].substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))args[0]=args[0].replace(/\\\\/g,"");if(args[0][0]==='"'){args[0]=args[0].substring(1,args[0].length-1)};args[0]=JSON.parse(args[0])}}}if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};pipe=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return this.subscribe(source,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})};pipeOnce=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return source.__node.state.subscribeEventOnce(source.__node.unique,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.__node.state.subscribeEventOnce(source.__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(source).__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})};terminate=(...args)=>{};isTypedArray=isTypedArray;recursivelyAssign=recursivelyAssign2;spliceTypedArray=spliceTypedArray;ping=()=>{console.log("pinged!");return"pong"};echo=(...args)=>{this.transmit(...args);return args};log=(...args)=>{console.log(...args);return true};error=(...args)=>{console.error(...args);return true}};function isTypedArray(x){return ArrayBuffer.isView(x)&&Object.prototype.toString.call(x)!=="[object DataView]"}var recursivelyAssign2=(target,obj)=>{for(const key in obj){if(obj[key]?.constructor.name==="Object"&&!Array.isArray(obj[key])){if(target[key]?.constructor.name==="Object"&&!Array.isArray(target[key]))recursivelyAssign2(target[key],obj[key]);else target[key]=recursivelyAssign2({},obj[key])}else target[key]=obj[key]}return target};function spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let ta;if(s.length>0||e?.length>0)ta=new arr.constructor(s.length+e.length);if(ta){if(s.length>0)ta.set(s);if(e&&e.length>0)ta.set(e,s.length)}return ta}var nodeTemplates={};var remoteGraphRoutes={transferNode:(properties,connection,name2)=>{let str2;if(typeof properties==="object"){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}str2=recursivelyStringifyFunctions(properties)}else if(typeof properties==="function")str2=properties.toString();else if(typeof properties==="string")str2=properties;if(str2){if(connection.run)return connection.run("setNode",[str2]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:str2},void 0);return new Promise(r=>r(name2))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:str2}));return new Promise(r=>r(name2))}}},setNode:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function")properties={__operator:f,__node:{tag:name2?name2:f.name}};else{f=JSON.parse(properties);if(typeof f==="object")properties=f}}if(typeof properties==="object"||typeof properties==="function"){let template={};if(typeof properties==="object")Object.assign(template,properties);else template.__operator=properties;let node=this.__node.graph.add(template);if(node){nodeTemplates[node.__node.tag]=template;return node.__node?.tag}else return false}else return false},proxyRemoteNode:function(name2,connection){return new Promise((res,rej)=>{connection.run("getNodeProperties",name2).then(props=>{let proxy={};if(typeof props==="object"){for(const key in props){if(props[key]==="function"){proxy[key]=(...args)=>{return new Promise(r=>{connection.run(name2,args,key).then(r)})}}else{Object.defineProperty(proxy,key,{get:()=>{return new Promise(r=>{connection.run(name2,void 0,key).then(r)})},set:value=>{connection.post(name2,value,key)},configurable:true,enumerable:true})}}}res(proxy)})})},makeNodeTransferrable:function(properties,name2){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}const str2=recursivelyStringifyFunctions(properties);return str2},setTemplate:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function"){if(!name2)name2=f.name;properties={__operator:f,__node:{tag:name2}}}else{f=JSON.parse(properties);if(typeof f==="object"){properties=f;if(!name2&&f.__node?.tag)name2=f.__node.tag}}}if(!name2)name2=\`node\${Math.floor(Math.random()*1e15)}\`;if(typeof properties==="object"||typeof properties==="function"){nodeTemplates[name2]=properties;return name2}else return false},loadFromTemplate:function(templateName,name2,properties){if(nodeTemplates[templateName]){let cpy=recursivelyAssign2({},nodeTemplates[templateName]);if(name2){if(!cpy.__node)cpy.__node={};cpy.__node.tag=name2}if(properties)Object.assign(cpy,properties);let node=this.__node.graph.add(cpy);return node.__node.tag}},setMethod:function(nodeTag,fn,methodKey){if(typeof fn==="string"){let f=parseFunctionFromText(fn);if(typeof f==="function")fn=f}if(!methodKey&&typeof fn==="function")methodKey=fn.name;if(this.__node.graph.get(nodeTag)){this.__node.graph.get(nodeTag)[methodKey]=fn}else this.__node.graph.add({__node:{tag:methodKey,[methodKey]:fn}});return true},assignNode:function(nodeTag,source){if(this.__node.graph.get(nodeTag)&&typeof source==="object"){Object.assign(this.__node.graph.get(nodeTag),source)}},getNodeProperties:function(nodeTag){let node=this.__node.graph.get(nodeTag);if(node){let properties=Object.getOwnPropertyNames(node);let result={};for(const key in properties){result[key]=typeof node[key]}return result}return void 0},transferClass:(classObj,connection,className)=>{if(typeof classObj==="object"){let str2=classObj.toString();let message={route:"receiveClass",args:[str2,className]};if(connection.run)return connection.run("receiveClass",[str2,className]);else if(connection.postMessage){connection.postMessage({route:"receiveClass",args:[str2,className]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"receiveClass",args:[str2,className]}));return new Promise(r=>r(name))}return message}return false},receiveClass:function(stringified,className){if(typeof stringified==="string"){if(stringified.indexOf("class")===0){let cls=(0,eval)("("+stringified+")");let name2=className;if(!name2)name2=cls.name;this.__node.graph[name2]=cls;return true}}return false},transferFunction:(fn,connection,fnName)=>{if(!fnName)fnName=fn.name;let str2=fn.toString();let message={route:"setNode",args:[str2,fnName]};if(connection.run)return connection.run("setNode",[str2,fnName]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:[str2,fnName]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:[str2,fnName]}));return new Promise(r=>r(name))}return message},setGlobal:(key,value)=>{globalThis[key]=value;return true},assignGlobalObject:(target,source)=>{if(!globalThis[target])return false;if(typeof source==="object")Object.assign(globalThis[target],source);return true},setValue:function(key,value){this.__node.graph[key]=value;return true},assignObject:function(target,source){if(!this.__node.graph[target])return false;if(typeof source==="object")Object.assign(this.__node.graph[target],source);return true},setGlobalFunction:(fn,fnName)=>{if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;globalThis[fnName]=fn;return true}return false},setGraphFunction:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.__node.graph[fnName]=fn;return true}return false}};function html(strings,...args){return function append(elm=document.createElement("div")){let template=document.createElement("template");strings.map(function(s,i2){template.innerHTML+=s;if(args[i2]instanceof HTMLElement){let dummy2=\`<span id="dummyNode12345"></span>\`;dummy2.id="dummyNode12345";template.innerHTML+=dummy2}else template.innerHTML+=args[i2]});let query=template.content.querySelectorAll("#dummyNode12345");let ctr=0;args.forEach((arg,i2)=>{if(arg instanceof HTMLElement){console.log(arg,query[ctr]);template.content.replaceChild(arg,query[ctr]);ctr++}});elm.appendChild(template.content);return elm}}var dummy=html\`\`;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl.cipher.aes=function(a){this.s[0][0][0]||this.O();var b,c,d,e,f=this.s[0][4],g=this.s[1];b=a.length;var h=1;if(4!==b&&6!==b&&8!==b)throw new sjcl.exception.invalid("invalid aes key size");this.b=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));d[a]=d[a-b]^c}for(b=0;a;b++,a--)c=d[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]]};sjcl.cipher.aes.prototype={encrypt:function(a){return t(this,a,0)},decrypt:function(a){return t(this,a,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var a=this.s[0],b=this.s[1],c=a[4],d=b[4],e,f,g,h=[],k=[],l,n,m,p;for(e=0;256>e;e++)k[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=l||1,g=k[g]||1)for(m=g^g<<1^g<<2^g<<3^g<<4,m=m>>8^m&255^99,c[f]=m,d[m]=f,n=h[e=h[l=h[f]]],p=16843009*n^65537*e^257*l^16843008*f,n=257*h[m]^16843008*m,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p=p<<24^p>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};function t(a,b,c){if(4!==b.length)throw new sjcl.exception.invalid("invalid aes block size");var d=a.b[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,k,l,n=d.length/4-2,m,p=4,r=[0,0,0,0];h=a.s[c];a=h[0];var q=h[1],v=h[2],w=h[3],x=h[4];for(m=0;m<n;m++)h=a[e>>>24]^q[f>>16&255]^v[g>>8&255]^w[b&255]^d[p],k=a[f>>>24]^q[g>>16&255]^v[b>>8&255]^w[e&255]^d[p+1],l=a[g>>>24]^q[b>>16&255]^v[e>>8&255]^w[f&255]^d[p+2],b=a[b>>>24]^q[e>>16&255]^v[f>>8&255]^w[g&255]^d[p+3],p+=4,e=h,f=k,g=l;for(m=0;4>m;m++)r[c?3&-m:m]=x[e>>>24]<<24^x[f>>16&255]<<16^x[g>>8&255]<<8^x[b&255]^d[p++],h=e,e=f,f=g,g=b,b=h;return r}sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.$(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.$(b,d,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b=b&31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return false;var c=0,d;for(d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c},$:function(a,b,c,d){var e;e=0;for(void 0===d&&(d=[]);32<=b;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1));return d},i:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&65280|(c&65280)<<8|c<<24;return a}};sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++)0===(d&3)&&(e=a[d/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++)d=d<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d),d=0);c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b}};sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d;a=a.replace(/\\s|0x/g,"");d=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,4*d)}};sjcl.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(a,b,c){var d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f="",g=0,h=sjcl.codec.base32.B,k=0,l=sjcl.bitArray.bitLength(a);c&&(h=sjcl.codec.base32.X);for(c=0;f.length*d<l;)f+=h.charAt((k^a[c]>>>g)>>>e),g<d?(k=a[c]<<d-g,g+=e,c++):(k<<=d,g-=d);for(;f.length&7&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\\s|=/g,"").toUpperCase();var c=sjcl.codec.base32.BITS,d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f=[],g,h=0,k=sjcl.codec.base32.B,l=0,n,m="base32";b&&(k=sjcl.codec.base32.X,m="base32hex");for(g=0;g<a.length;g++){n=k.indexOf(a.charAt(g));if(0>n){if(!b)try{return sjcl.codec.base32hex.toBits(a)}catch(p){}throw new sjcl.exception.invalid("this isn't "+m+"!")}h>e?(h-=e,f.push(l^n>>>h),l=n<<c-h):(h+=d,l^=n<<c-h)}h&56&&f.push(sjcl.bitArray.partial(h&56,l,1));return f}};sjcl.codec.base32hex={fromBits:function(a,b){return sjcl.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl.codec.base32.toBits(a,1)}};sjcl.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.B,g=0,h=sjcl.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;d.length&3&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\\s|=/g,"");var c=[],d,e=0,f=sjcl.codec.base64.B,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d=0;d<a.length;d++){h=f.indexOf(a.charAt(d));if(0>h)throw new sjcl.exception.invalid("this isn't base64!");26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e)}e&56&&c.push(sjcl.bitArray.partial(e&56,g,1));return c}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}};sjcl.hash.sha256=function(a){this.b[0]||this.O();a?(this.F=a.F.slice(0),this.A=a.A.slice(0),this.l=a.l):this.reset()};sjcl.hash.sha256.hash=function(a){return new sjcl.hash.sha256().update(a).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.A=sjcl.bitArray.concat(this.A,a);b=this.l;a=this.l=b+sjcl.bitArray.bitLength(a);if(9007199254740991<a)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d=new Uint32Array(c),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u(this,d.subarray(16*e,16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u(this,c.splice(0,16));return this},finalize:function(){var a,b=this.A,c=this.F,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.l/4294967296));for(b.push(this.l|0);b.length;)u(this,b.splice(0,16));this.reset();return c},Y:[],b:[],O:function(){function a(a2){return 4294967296*(a2-Math.floor(a2))|0}for(var b=0,c=2,d,e;64>b;c++){e=true;for(d=2;d*d<=c;d++)if(0===c%d){e=false;break}e&&(8>b&&(this.Y[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}};function u(a,b){var c,d,e,f=a.F,g=a.b,h=f[0],k=f[1],l=f[2],n=f[3],m=f[4],p=f[5],r=f[6],q=f[7];for(c=0;64>c;c++)16>c?d=b[c]:(d=b[c+1&15],e=b[c+14&15],d=b[c&15]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c&15]+b[c+9&15]|0),d=d+q+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(r^m&(p^r))+g[c],q=r,r=p,p=m,m=n+d|0,n=l,l=k,k=h,h=d+(k&l^n&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+n|0;f[4]=f[4]+m|0;f[5]=f[5]+p|0;f[6]=f[6]+r|0;f[7]=f[7]+q|0}sjcl.mode.ccm={name:"ccm",G:[],listenProgress:function(a){sjcl.mode.ccm.G.push(a)},unListenProgress:function(a){a=sjcl.mode.ccm.G.indexOf(a);-1<a&&sjcl.mode.ccm.G.splice(a,1)},fa:function(a){var b=sjcl.mode.ccm.G.slice(),c;for(c=0;c<b.length;c+=1)b[c](a)},encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,k=h.bitLength(c)/8,l=h.bitLength(g)/8;e=e||64;d=d||[];if(7>k)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&l>>>8*f;f++);f<15-k&&(f=15-k);c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.V(a,b,c,d,e,f);g=sjcl.mode.ccm.C(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/8;if(7>g)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&h>>>8*b;b++);b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));k=sjcl.mode.ccm.C(a,k,c,l,e,b);a=sjcl.mode.ccm.V(a,k.data,c,d,e,b);if(!f.equal(k.tag,a))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return k.data},na:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,k=h.i;d=[h.partial(8,(b.length?64:0)|d-2<<2|f-1)];d=h.concat(d,c);d[3]|=e;d=a.encrypt(d);if(b.length)for(c=h.bitLength(b)/8,65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,b),b=0;b<g.length;b+=4)d=a.encrypt(k(d,g.slice(b,b+4).concat([0,0,0])));return d},V:function(a,b,c,d,e,f){var g=sjcl.bitArray,h=g.i;e/=8;if(e%2||4>e||16<e)throw new sjcl.exception.invalid("ccm: invalid tag length");if(4294967295<d.length||4294967295<b.length)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");c=sjcl.mode.ccm.na(a,d,c,e,g.bitLength(b)/8,f);for(d=0;d<b.length;d+=4)c=a.encrypt(h(c,b.slice(d,d+4).concat([0,0,0])));return g.clamp(c,8*e)},C:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.i;var k=b.length,l=h.bitLength(b),n=k/50,m=n;c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d=h.bitSlice(g(d,a.encrypt(c)),0,e);if(!k)return{tag:d,data:[]};for(g=0;g<k;g+=4)g>n&&(sjcl.mode.ccm.fa(g/k),n+=m),c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d,data:h.clamp(b,l)}}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var g,h=sjcl.mode.ocb2.S,k=sjcl.bitArray,l=k.i,n=[0,0,0,0];c=h(a.encrypt(c));var m,p=[];d=d||[];e=e||64;for(g=0;g+4<b.length;g+=4)m=b.slice(g,g+4),n=l(n,m),p=p.concat(l(c,a.encrypt(l(c,m)))),c=h(c);m=b.slice(g);b=k.bitLength(m);g=a.encrypt(l(c,[0,0,0,b]));m=k.clamp(l(m.concat([0,0,0]),g),b);n=l(n,l(m.concat([0,0,0]),g));n=a.encrypt(l(n,l(c,h(c))));d.length&&(n=l(n,f?d:sjcl.mode.ocb2.pmac(a,d)));return p.concat(k.concat(m,k.clamp(n,e)))},decrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");e=e||64;var g=sjcl.mode.ocb2.S,h=sjcl.bitArray,k=h.i,l=[0,0,0,0],n=g(a.encrypt(c)),m,p,r=sjcl.bitArray.bitLength(b)-e,q=[];d=d||[];for(c=0;c+4<r/32;c+=4)m=k(n,a.decrypt(k(n,b.slice(c,c+4)))),l=k(l,m),q=q.concat(m),n=g(n);p=r-32*c;m=a.encrypt(k(n,[0,0,0,p]));m=k(m,h.clamp(b.slice(c),p).concat([0,0,0]));l=k(l,m);l=a.encrypt(k(l,k(n,g(n))));d.length&&(l=k(l,f?d:sjcl.mode.ocb2.pmac(a,d)));if(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))throw new sjcl.exception.corrupt("ocb: tag doesn't match");return q.concat(h.clamp(m,p))},pmac:function(a,b){var c,d=sjcl.mode.ocb2.S,e=sjcl.bitArray,f=e.i,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4)h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d(f(h,d(h))),g))},S:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);b=sjcl.bitArray;d=d||[];a=sjcl.mode.gcm.C(true,a,f,d,c,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c,d,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);e=e||128;d=d||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.C(false,a,f,d,c,e);if(!g.equal(a.tag,b))throw new sjcl.exception.corrupt("gcm: tag doesn't match");return a.data},ka:function(a,b){var c,d,e,f,g,h=sjcl.bitArray.i;e=[0,0,0,0];f=b.slice(0);for(c=0;128>c;c++){(d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d=3;0<d;d--)f[d]=f[d]>>>1|(f[d-1]&1)<<31;f[0]>>>=1;g&&(f[0]^=-520093696)}return e},j:function(a,b,c){var d,e=c.length;b=b.slice(0);for(d=0;d<e;d+=4)b[0]^=4294967295&c[d],b[1]^=4294967295&c[d+1],b[2]^=4294967295&c[d+2],b[3]^=4294967295&c[d+3],b=sjcl.mode.gcm.ka(b,a);return b},C:function(a,b,c,d,e,f){var g,h,k,l,n,m,p,r,q=sjcl.bitArray;m=c.length;p=q.bitLength(c);r=q.bitLength(d);h=q.bitLength(e);g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=q.concat(e,[1])):(e=sjcl.mode.gcm.j(g,[0,0,0,0],e),e=sjcl.mode.gcm.j(g,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl.mode.gcm.j(g,[0,0,0,0],d);n=e.slice(0);d=h.slice(0);a||(d=sjcl.mode.gcm.j(g,h,c));for(l=0;l<m;l+=4)n[3]++,k=b.encrypt(n),c[l]^=k[0],c[l+1]^=k[1],c[l+2]^=k[2],c[l+3]^=k[3];c=q.clamp(c,p);a&&(d=sjcl.mode.gcm.j(g,h,c));a=[Math.floor(r/4294967296),r&4294967295,Math.floor(p/4294967296),p&4294967295];d=sjcl.mode.gcm.j(g,d,a);k=b.encrypt(e);d[0]^=k[0];d[1]^=k[1];d[2]^=k[2];d[3]^=k[3];return{tag:q.bitSlice(d,0,f),data:c}}};sjcl.misc.hmac=function(a,b){this.W=b=b||sjcl.hash.sha256;var c=[[],[]],d,e=b.prototype.blockSize/32;this.w=[new b,new b];a.length>e&&(a=b.hash(a));for(d=0;d<e;d++)c[0][d]=a[d]^909522486,c[1][d]=a[d]^1549556828;this.w[0].update(c[0]);this.w[1].update(c[1]);this.R=new b(this.w[0])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){if(this.aa)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");this.update(a);return this.digest(a)};sjcl.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=false};sjcl.misc.hmac.prototype.update=function(a){this.aa=true;this.R.update(a)};sjcl.misc.hmac.prototype.digest=function(){var a=this.R.finalize(),a=new this.W(this.w[1]).update(a).finalize();this.reset();return a};sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1e4;if(0>d||0>c)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,k,l=[],n=sjcl.bitArray;for(k=1;32*l.length<(d||1);k++){e=f=a.encrypt(n.concat(b,[k]));for(g=1;g<c;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];l=l.concat(e)}d&&(l=n.clamp(l,d));return l};sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=a;this.D=false;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=3e4;this.ba=80};sjcl.prng.prototype={randomWords:function(a,b){var c=[],d;d=this.isReady(b);var e;if(d===this.u)throw new sjcl.exception.notReady("generator isn't seeded");if(d&this.J){d=!(d&this.I);e=[];var f=0,g;this.Z=e[0]=new Date().valueOf()+this.da;for(g=0;16>g;g++)e.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.m[g],this.m[g]=0,d||!(this.P&1<<g));g++);this.P>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.m.push(0));this.f-=f;f>this.o&&(this.o=f);this.P++;this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.L=new sjcl.cipher.aes(this.b);for(d=0;4>d&&(this.h[d]=this.h[d]+1|0,!this.h[d]);d++);}for(d=0;d<a;d+=4)0===(d+1)%this.ca&&y(this),e=z(this),c.push(e[0],e[1],e[2],e[3]);y(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=new Date().valueOf(),g=this.H[c],h=this.isReady(),k=0;d=this.U[c];void 0===d&&(d=this.U[c]=this.ha++);void 0===g&&(g=this.H[c]=0);this.H[c]=(this.H[c]+1)%this.c.length;switch(typeof a){case"number":void 0===b&&(b=1);this.c[g].update([d,this.N++,1,b,f,1,a|0]);break;case"object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(k=1),c=0;c<a.length&&!k;c++)"number"!==typeof a[c]&&(k=1);if(!k){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e=e>>>1;this.c[g].update([d,this.N++,2,b,f,a.length].concat(a))}break;case"string":void 0===b&&(b=a.length);this.c[g].update([d,this.N++,3,b,f,a.length]);this.c[g].update(a);break;default:k=1}if(k)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[g]+=b;this.f+=b;h===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},isReady:function(a){a=this.T[void 0!==a?a:this.M];return this.o&&this.o>=a?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=a?this.J|this.u:this.u},getProgress:function(a){a=this.T[a?a:this.M];return this.o>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,false),window.addEventListener("mousemove",this.a.mouseCollector,false),window.addEventListener("keypress",this.a.keyboardCollector,false),window.addEventListener("devicemotion",this.a.accelerometerCollector,false),window.addEventListener("touchmove",this.a.touchCollector,false);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl.exception.bug("can't attach event");this.D=true}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,false),window.removeEventListener("mousemove",this.a.mouseCollector,false),window.removeEventListener("keypress",this.a.keyboardCollector,false),window.removeEventListener("devicemotion",this.a.accelerometerCollector,false),window.removeEventListener("touchmove",this.a.touchCollector,false)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=false)},addEventListener:function(a,b){this.K[a][this.ga++]=b},removeEventListener:function(a,b){var c,d,e=this.K[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},la:function(){C(this,1)},oa:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,"mouse");C(this,0)},qa:function(a){a=a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C(this,0)},ma:function(){C(this,2)},ea:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C(this,0)}};function A(a,b){var c,d=sjcl.random.K[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}function C(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy(new Date().valueOf(),b,"loadtime")}function y(a){a.b=z(a).concat(z(a));a.L=new sjcl.cipher.aes(a.b)}function z(a){for(var b=0;4>b&&(a.h[b]=a.h[b]+1|0,!a.h[b]);b++);return a.L.encrypt(a.h)}function B(a,b){return function(){b.apply(a,arguments)}}sjcl.random=new sjcl.prng(6);a:try{if(G="undefined"!==typeof module&&module.exports){try{H=__require2("crypto")}catch(a){H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array(new Uint8Array(D).buffer),sjcl.random.addEntropy(D,1024,"crypto['randomBytes']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F);else break a;sjcl.random.addEntropy(F,1024,"crypto['getRandomValues']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}var D;var E;var F;var G;var H;sjcl.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json,f=e.g({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.g(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl.codec.base64.toBits(f.iv));if(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)throw new sjcl.exception.invalid("json encrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));"string"===typeof c&&(f.adata=c=sjcl.codec.utf8String.toBits(c));g=new sjcl.cipher[f.cipher](a);e.g(d,f);d.key=a;f.ct="ccm"===f.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(g,b,f.iv,c,f.ts):sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f},encrypt:function(a,b,c,d){var e=sjcl.json,f=e.ja.apply(e,arguments);return e.encode(f)},ia:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json;b=e.g(e.g(e.g({},e.defaults),b),c,true);var f,g;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv));if(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjcl.exception.invalid("json decrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl.codec.utf8String.toBits(f));g=new sjcl.cipher[b.cipher](a);f="ccm"===b.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(g,b.ct,b.iv,b.tag,f,b.ts):sjcl.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.g(d,b);d.key=a;return 1===c.raw?f:sjcl.codec.utf8String.fromBits(f)},decrypt:function(a,b,c,d){var e=sjcl.json;return e.ia(a,e.decode(b),c,d)},encode:function(a){var b,c="{",d="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");c+=d+'"'+b+'":';d=",";switch(typeof a[b]){case"number":case"boolean":c+=a[b];break;case"string":c+='"'+escape(a[b])+'"';break;case"object":c+='"'+sjcl.codec.base64.fromBits(a[b],0)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return c+"}"},decode:function(a){a=a.replace(/\\s/g,"");if(!a.match(/^\\{.*\\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");a=a.replace(/^\\{|\\}$/g,"").split(/,/);var b={},c,d;for(c=0;c<a.length;c++){if(!(d=a[c].match(/^\\s*(?:(["']?)([a-z][a-z0-9]*)\\1)\\s*:\\s*(?:(-?\\d+)|"([a-z0-9+\\/%*_.@=\\-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");null!=d[3]?b[d[2]]=parseInt(d[3],10):null!=d[4]?b[d[2]]=d[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(d[4]):unescape(d[4]):null!=d[5]&&(b[d[2]]="true"===d[5])}return b},g:function(a,b,c){void 0===a&&(a={});if(void 0===b)return a;for(var d in b)if(b.hasOwnProperty(d)){if(c&&void 0!==a[d]&&a[d]!==b[d])throw new sjcl.exception.invalid("required parameter overridden");a[d]=b[d]}return a},sa:function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&a[d]!==b[d]&&(c[d]=a[d]);return c},ra:function(a,b){var c={},d;for(d=0;d<b.length;d++)void 0!==a[b[d]]&&(c[b[d]]=a[b[d]]);return c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.pa={};sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.pa,d;b=b||{};d=b.iter||1e3;c=c[a]=c[a]||{};d=c[d]=c[d]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=void 0===b.salt?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);return{key:d[c].slice(0),salt:c.slice(0)}};var _HTTPfrontend=class extends Service{name="http";fetchProxied=false;listening={};constructor(options,path,fetched){super(options);this.load(this);this.listen(path,fetched)}GET=(url="http://localhost:8080/ping",type="",mimeType)=>{if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"GET",url,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};POST=(message,url="http://localhost:8080/echo",type="",mimeType)=>{if(typeof message==="object"&&(type==="json"||type==="text"||!type)){message=JSON.stringify(message)}if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"POST",url,data:message,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};transmit=(message,url)=>{let obj=message;if(typeof obj==="object"){message=JSON.stringify(obj)}if(obj?.method?.toLowerCase()=="get"||message?.toLowerCase()==="get")return this.GET(url);return this.POST(message,url)};transponder=(url,message,type="",mimeType)=>{if(typeof message==="object")message=JSON.stringify(message);let method="GET";if(message){method="POST"}if(type==="json")mimeType="application/json";else return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method,url,data:message,responseType:type,onload:ev=>{let body=xhr.response;if(typeof body==="string"){let substr=body.substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))body=body.replace(/\\\\/g,"");if(body[0]==='"'){body=body.substring(1,body.length-1)};body=JSON.parse(body)}}if(typeof body?.method==="string"){return resolve(this.handleMethod(body.route,body.method,body.args))}else if(typeof body?.route==="string"){return resolve(this.handleServiceMessage(body))}else if(typeof body?.node==="string"||body.node instanceof GraphNode){return resolve(this.handleGraphNodeCall(body.node,body.args))}else return resolve(body)},onabort:er=>{reject(er)}})}).catch(console.error)};listen=(path="0",fetched=async(clone,args,response)=>{const result=await clone.text();const returned=this.receive(result);this.setState({[response.url]:returned})})=>{this.listening[path]={};let listenerId=\`\${path}\${Math.floor(Math.random()*1e15)}\`;this.listening[path][listenerId]=fetched;if(!this.fetchProxied){globalThis.fetch=new Proxy(globalThis.fetch,{apply(fetch,that,args){const result=fetch.apply(that,args);result.then(response=>{if(!response.ok)return;if(this.listening["0"]){for(const key in this.listeners){const clone=response.clone();this.listening["0"][key](clone,args,response)}}else{for(const key in this.listening){if(response.url.includes(key)){for(const key2 in this.listening[path]){const clone=response.clone();this.listening[path][key2](clone,args,response)}break}}}}).catch(er=>{console.error(er)});return result}});this.fetchProxied=true}return listenerId};stopListening=(path,listener)=>{if(!path&&path!==0){for(const key in this.listening)delete this.listening[key]}else{if(!listener)delete this.listening[path];else delete this.listening[listener]}}};var HTTPfrontend=_HTTPfrontend;__publicField(HTTPfrontend,"request",options=>{const xhr=new XMLHttpRequest;if(options.responseType)xhr.responseType=options.responseType;else options.responseType="json";if(options.mimeType){xhr.overrideMimeType(options.mimeType)}if(options.onload)xhr.addEventListener("load",options.onload,false);if(options.onprogress)xhr.addEventListener("progress",options.onprogress,false);if(options.onabort)xhr.addEventListener("abort",options.onabort,false);if(options.onloadend)xhr.addEventListener("loadend",options.onloadend,false);if(options.onerror)xhr.addEventListener("error",options.onerror,false);xhr.open(options.method,options.url,true,options.user,options.pass);if(!options.onerror)xhr.onerror=function(){xhr.abort()};xhr.send(options.data);return xhr});var import_web_worker=__toESM(require_browser());var WorkerService=class extends Service{name="worker";workers={};threadRot=0;connections;constructor(options){super();this.connections={workers:this.workers};if(options?.services)this.addServices(options.services);this.load(this);this.setLoaders(this.workerloader);if(options)this.init(options);if(typeof WorkerGlobalScope!=="undefined"&&globalThis instanceof WorkerGlobalScope){this.addDefaultMessageListener()}}loadWorkerRoute=(rt,routeKey)=>{if(rt.workerUrl)rt.url=rt.workerUrl;if(rt.workerId)rt.__node.tag=rt.workerId;if(!rt.__node.tag)rt.__node.tag=routeKey;rt._id=rt.__node.tag;let worker;if(this.workers[rt._id])worker=this.workers[rt._id];else if(rt.worker)worker=rt.worker;if(!worker){worker=this.addWorker(rt)}rt.worker=worker;if(!rt.worker.__ondisconnected){let ondelete=rt2=>{rt2.worker?.terminate()};rt.__addOndisconnected(ondelete)}if(rt.transferFunctions){for(const prop in rt.transferFunctions){this.transferFunction(worker,rt.transferFunctions[prop],prop)}}if(rt.transferClasses){for(const prop in rt.transferClasses){this.transferClass(worker,rt.transferClasses[prop],prop)}}if(worker){if(!rt.__operator){rt.__operator=(...args)=>{if(rt.callback){if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.post(rt.callback,args);else return worker.run(rt.callback,args)}else{if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.send(args);else return worker.request(args)}}}if(rt.init){worker.run(rt.init,rt.initArgs,void 0,rt.initTransfer)}return worker}};workerloader={"workers":(node,parent,graph,roots)=>{let rt=node;if(!node.parentRoute&&(parent?.callback&&parent?.worker))node.parentRoute=parent?.callback;if(rt?.worker||rt?.workerId||rt?.workerUrl){let worker=this.loadWorkerRoute(rt,rt.__node.tag);if(worker){if(!rt.parentRoute&&rt.__parent?.callback)rt.parentRoute=rt.__parent.callback;if(rt.__parent&&!rt.portId){if(typeof rt.__parent==="string"){if(rt.__node.tag!==rt.__parent&&worker._id!==rt.__parent)rt.portId=this.establishMessageChannel(worker,rt.__parent)}else if(rt.__node.tag!==rt.__parent?.__node?.tag&&worker._id!==rt.__parent?.tag){rt.portId=this.establishMessageChannel(worker,rt.__parent.worker)}};if(rt.parentRoute){if(!rt.stopped){if(typeof rt.__parent==="string"&&rt.__parent===worker._id){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else if(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.parentRoute,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id)&&!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent){if(typeof rt.__parent==="string"){if(!rt.stopped){if(rt.__parent===worker._id){worker.run("subscribe",[rt.__parent,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id))worker.workerSubs[rt.__parent+rt.portId]={sub:null,route:worker._id,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent?.__node?.tag&&rt.__parent?.worker){if(!rt.stopped){if(rt.__node.tag===rt.__parent.__node.tag||worker._id===rt.__parent.__node.tag){worker.run("subscribe",[rt.__parent.__node.tag,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent.__node.tag,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent.__node.tag+rt.portId].sub=sub})}if(!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.__parent.__node.tag+rt.portId]={sub:null,route:rt.__parent.__node.tag,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}}}}else if(rt.__parent&&rt.parentRoute){if(typeof rt.__parent==="string"&&roots[rt.__parent]?.worker){roots[rt.__parent].worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}else if(rt.__parent?.worker){rt.__parent.worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}}return rt}};addDefaultMessageListener=()=>{globalThis.onmessage=ev=>{let result=this.receive(ev.data);if(this.__node.keepState)this.setState({[this.name]:result})}};postMessage=(message,target,transfer)=>{if(this.workers[target]){this.workers[target].send(message,transfer)}else{globalThis.postMessage(message,target,transfer)}};addWorker=options=>{let worker;if(!options._id)options._id=\`worker\${Math.floor(Math.random()*1e15)}\`;if(options.url)worker=new import_web_worker.default(options.url);else if(options.port){worker=options.port}else if(this.workers[options._id]){if(this.workers[options._id].port)worker=this.workers[options._id].port;else worker=this.workers[options._id].worker}if(!worker)return;let send=(message,transfer)=>{return this.transmit(message,worker,transfer)};let post=(route,args,method,transfer)=>{let message={route,args};if(method)message.method=method;return this.transmit(message,worker,transfer)};let run=(route,args,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[{route,args},options._id,callbackId]};if(method)req.args[0].method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let request=(message,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,options._id,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let workerSubs={};let subscribe=(route,callback,args,key,subInput,blocking)=>{return this.subscribeToWorker(route,options._id,callback,args,key,subInput,blocking)};let unsubscribe=(route,sub)=>{return run("unsubscribe",[route,sub])};let start=async(route,portId,callback,blocking)=>{if(route)await run("subscribeToWorker",[route,portId,void 0,callback,blocking]).then(sub=>{if(sub)workerSubs[route+portId]={sub,route,portId,callback,blocking}});else for(const key in workerSubs){if(typeof workerSubs[key].sub!=="number")await run("subscribeToWorker",[workerSubs[key].route,workerSubs[key].portId,void 0,workerSubs[key].callback,void 0,workerSubs[key].blocking]).then(sub=>{workerSubs[key].sub=sub});console.log(JSON.stringify(workerSubs))}return true};let stop=async(route,portId)=>{if(route&&portId&&workerSubs[route+portId]){await run("unsubscribe",[route,workerSubs[route+portId].sub]);workerSubs[route+portId].sub=false}else{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){await run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub]).then(console.log)}workerSubs[key].sub=false}}return true};let terminate=()=>{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub])}workerSubs[key].sub=false}return this.terminate(options._id)};if(!options.onmessage)options.onmessage=ev=>{this.receive(ev.data);this.setState({[options._id]:ev.data})};if(!options.onerror){options.onerror=ev=>{console.error(ev.data)}}worker.onmessage=options.onmessage;worker.onerror=options.onerror;this.workers[options._id]={worker,send,post,run,request,subscribe,unsubscribe,terminate,start,stop,postMessage:worker.postMessage,workerSubs,graph:this,...options};return this.workers[options._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=scriptTemplate=>{let blob=new Blob([scriptTemplate],{type:"text/javascript"});return URL.createObjectURL(blob)};getTransferable(message){let transfer;if(typeof message==="object"){if(message.args){if(message.args?.constructor?.name==="Object"){for(const key in message.args){if(ArrayBuffer.isView(message.args[key])){if(!transfer)transfer=[message.args[key].buffer];else transfer.push(message.args[key].buffer)}else if(message.args[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message.args[key]];else transfer.push(message.args[key])}}}else if(Array.isArray(message.args)&&message.args.length<11){message.args.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg?.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message.args)){transfer=[message.args.buffer]}else if(message.args?.constructor?.name==="ArrayBuffer"){transfer=[message]}}else if(message?.constructor?.name==="Object"){for(const key in message){if(ArrayBuffer.isView(message[key])){if(!transfer)transfer=[message[key].buffer];else transfer.push(message[key].buffer)}else if(message[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message[key]];else transfer.push(message[key])}}}else if(Array.isArray(message)&&message.length<11){message.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message)){transfer=[message.buffer]}else if(message.constructor?.name==="ArrayBuffer"){transfer=[message]}}return transfer}transmit=(message,worker,transfer)=>{if(!transfer){transfer=this.getTransferable(message)}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){worker.postMessage(message,transfer)}else if(typeof worker==="string"){if(this.workers[worker]){if(this.workers[worker].port)this.workers[worker].port.postMessage(message,transfer);else if(this.workers[worker].worker)this.workers[worker].worker.postMessage(message,transfer)}}else{let keys2=Object.keys(this.workers);this.workers[keys2[this.threadRot]].worker.postMessage(message,transfer);this.threadRot++;if(this.threadRot===keys2.length)this.threadRot=0}return message};terminate=worker=>{let onclose;if(typeof worker==="string"){let obj=this.workers[worker];if(obj){delete this.workers[worker];worker=obj.worker;if(obj.onclose)onclose=obj.onclose}}else if(typeof worker==="object"){if(worker?._id){worker=worker.worker;delete this.workers[worker?._id]}}if(worker instanceof import_web_worker.default){worker.terminate();if(onclose)onclose(worker);return true}if(worker instanceof MessagePort){worker.close();if(onclose)onclose(worker);return true}return false};establishMessageChannel=(worker,worker2)=>{let workerId;if(typeof worker==="string"){workerId=worker;if(this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker2=this.workers[worker].worker}}else if(worker?.worker){worker=worker.worker}if(typeof worker2==="string"){if(this.workers[worker2]){if(this.workers[worker2].port)worker2=this.workers[worker2].port;else worker2=this.workers[worker2].worker}}else if(worker2?.worker){worker2=worker2.worker}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){let channel=new MessageChannel;let portId=\`port\${Math.floor(Math.random()*1e15)}\`;worker.postMessage({route:"addWorker",args:{port:channel.port1,_id:portId}},[channel.port1]);if(worker2 instanceof import_web_worker.default||worker2 instanceof MessagePort){worker2.postMessage({route:"addWorker",args:{port:channel.port2,_id:portId}},[channel.port2])}else if(workerId&&this.workers[workerId]){channel.port2.onmessage=this.workers[workerId].onmessage;this.workers[workerId].port=channel.port2}return portId}return false};request=(message,workerId,transfer,method)=>{let worker=this.workers[workerId].worker;return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};runRequest=(message,worker,callbackId)=>{let res=this.receive(message);if(typeof worker==="string"&&this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}if(res instanceof Promise){res.then(r=>{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:r,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:r,callbackId})})}else{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:res,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:res,callbackId})}return res};subscribeWorker=(route,worker,args,key,subInput,blocking)=>{let callback;if(blocking){let blocked=false;callback=res=>{if(!blocked){blocked=true;if(res instanceof Promise){res.then(r=>{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,r]).then(ret=>{blocked=false})})}else{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,res]).then(ret=>{blocked=false})}}}}else{callback=res=>{if(res instanceof Promise){res.then(r=>{if(worker?.postMessage)worker.postMessage({args:r,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:r,callbackId:route})})}else{if(worker?.postMessage)worker.postMessage({args:res,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:res,callbackId:route})}}}if(!blocking&&worker?.port){worker=worker.port}else if(!blocking&&worker?.worker){worker=worker.worker}else if(typeof worker==="string"&&this.workers[worker]){if(blocking)worker=this.workers[worker];else if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}return this.subscribe(route,callback,args,key,subInput)};subscribeToWorker=(route,workerId,callback,args,key,subInput,blocking)=>{if(typeof workerId==="string"&&this.workers[workerId]){this.__node.state.subscribeEvent(workerId,res=>{if(res?.callbackId===route){if(!callback)this.setState({[workerId]:res.args});else if(typeof callback==="string"){this.run(callback,res.args)}else callback(res.args)}});return this.workers[workerId].run("subscribeWorker",[route,workerId,args,key,subInput,blocking])}};triggerSubscription=async(route,workerId,result)=>{if(this.__node.state.triggers[workerId])for(let i2=0;i2<this.__node.state.triggers[workerId].length;i2++){await this.__node.state.triggers[workerId][i2].onchange({args:result,callbackId:route})}return true};pipeWorkers=(sourceWorker,listenerWorker,sourceRoute,listenerRoute,portId,args,key,subInput,blocking)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof listenerWorker==="string")listenerWorker=this.workers[listenerWorker];if(!portId){portId=this.establishMessageChannel(sourceWorker.worker,listenerWorker.worker)}return listenerWorker.run("subscribeToWorker",[sourceRoute,portId,listenerRoute,args,key,subInput,blocking])};unpipeWorkers=(sourceRoute,sourceWorker,sub)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof sourceWorker==="object"){return sourceWorker.run("unsubscribe",[sourceRoute,sub])}}};var mouseEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]);var wheelEventHandlerImpl=makeSendPropertiesHandler(["deltaX","deltaY"]);var keydownEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function focusEventHandler(event,sendFn){const data={type:event.type};data.isTrusted=event.isTrusted;data.bubbles=event.bubbles;data.cancelBubble=event.cancelBubble;data.cancelable=event.cancelable;data.composed=event.composed;data.defaultPrevent=event.defaultPrevented;data.eventPhase=event.eventPhase;data.returnValue=event.returnValue;data.currentTarget=event.currentTarget.id?event.currentTarget.id:event.currentTarget.constructor.name;data.target=data.currentTarget;data.srcElement=data.currentTarget;sendFn(data)}function wheelEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();wheelEventHandlerImpl(event,sendFn)}function preventDefaultHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault()}function copyProperties(src,properties,dst){for(const name2 of properties){dst[name2]=src[name2]}}function makeSendPropertiesHandler(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties(event,properties,data);sendFn(data)}}function touchEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();const touches=[];const data={type:event.type,touches};for(let i2=0;i2<event.touches.length;++i2){const touch=event.touches[i2];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var i=1;var keys={};while(i<222){keys[i]=true;i++}function filteredKeydownEventHandler(event,sendFn,preventDefault){let{keyCode}=event;if(keys[keyCode]){if(preventDefault&&event.preventDefault&&(keyCode<110||keyCode>123))event.preventDefault();keydownEventHandler(event,sendFn)}}var eventHandlers={contextmenu:preventDefaultHandler,mousedown:mouseEventHandler,mousemove:mouseEventHandler,mouseup:mouseEventHandler,pointerdown:mouseEventHandler,pointermove:mouseEventHandler,pointerup:mouseEventHandler,pointerlockchange:mouseEventHandler,webkitpointerlockchange:mouseEventHandler,focus:focusEventHandler,blur:focusEventHandler,pointerout:mouseEventHandler,touchstart:touchEventHandler,touchmove:touchEventHandler,touchend:touchEventHandler,wheel:wheelEventHandler,keydown:filteredKeydownEventHandler,keyup:filteredKeydownEventHandler};function initProxyElement(element,worker,id,preventDefault){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{if(!worker){handleProxyEvent(data,id)}else worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent,preventDefault)})}if(eventHandlers.keydown){globalThis.addEventListener("keydown",function(ev){eventHandlers.keydown(ev,sendEvent,preventDefault)})}if(eventHandlers.keyup){globalThis.addEventListener("keyup",function(ev){eventHandlers.keyup(ev,sendEvent,preventDefault)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher=class{__listeners;addEventListener(type,listener){if(this.__listeners===void 0)this.__listeners={};const listeners=this.__listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this.__listeners===void 0)return false;const listeners=this.__listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i2=0,l=array.length;i2<l;i2++){array[i2].call(this,event)}}}};function noop(){}var ElementProxyReceiver=class extends EventDispatcher{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super();this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.style.width=this.width+"px";this.proxied.style.height=this.height+"px";this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop;data.stopPropagation=noop;this.dispatchEvent(data,this.proxied)};focus(){}blur(){}};var ProxyManager=class{targets={};constructor(){if(!globalThis.document)globalThis.document={elementFromPoint:(...args)=>{return this.targets[Object.keys(this.targets)[0]].proxied}}}makeProxy=(id,addTo=void 0)=>{if(!id)id=\`proxyReceiver\${Math.floor(Math.random()*1e15)}\`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;if(typeof WorkerGlobalScope!=="undefined")addTo.style=proxy.style;if(proxy.width){addTo.style.width=proxy.width+"px";addTo.clientWidth=proxy.width}if(proxy.height){addTo.style.height=proxy.height+"px";addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy);addTo.blur=proxy.blur.bind(proxy)}};getProxy=id=>{return this.targets[id]};handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0}};function makeProxy(id,elm){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;this.__node.graph.ProxyManager.makeProxy(id,elm)}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;globalThis.ProxyManager.makeProxy(id,elm)}return id}function handleProxyEvent(data,id){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;if(this.__node.graph.ProxyManager.handleEvent(data,id))return data}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;if(globalThis.ProxyManager.handleEvent(data,id))return data}}var proxyElementWorkerRoutes={initProxyElement,makeProxy,handleProxyEvent};function Renderer(options){if(options.worker){let worker=options.worker;let route=options.route;if(worker instanceof Blob||typeof worker==="string"){worker=new Worker(worker)}delete options.worker;delete options.route;return transferCanvas(worker,options,route)}else{initProxyElement(options.canvas,void 0,options._id,options.preventDefault);return setupCanvas(options)}}function transferCanvas(worker,options,route){if(!options)return void 0;if(!options._id)options._id=\`canvas\${Math.floor(Math.random()*1e15)}\`;let offscreen=options.canvas.transferControlToOffscreen();if(!options.width)options.width=options.canvas.clientWidth;if(!options.height)options.height=options.canvas.clientHeight;let message={route:route?route:"setupCanvas",args:{...options,canvas:offscreen}};if(this?.__node?.graph)this.__node.graph.run("initProxyElement",options.canvas,worker,options._id,options.preventDefault);else initProxyElement(options.canvas,worker,options._id,options.preventDefault);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let tr=[offscreen];if(options.transfer){tr.push(...options.transfer);delete options.transfer}worker.postMessage(message,tr);const canvascontrols={_id:options._id,width:options.width,height:options.height,worker,draw:(props,transfer)=>{worker.postMessage({route:"drawFrame",args:[props,options._id]},transfer)},update:(props,transfer)=>{worker.postMessage({route:"updateCanvas",args:[props,options._id]},transfer)},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:(newDrawProps,transfer)=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]},transfer)},terminate:()=>{worker.terminate()}};return canvascontrols}function setDraw(settings,_id){let canvasopts;if(this?.__node?.graph){if(_id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]}else{if(_id)canvasopts=globalThis.CANVASES?.[settings._id];else if(settings._id)canvasopts=globalThis.CANVASES?.[settings._id];else canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]]}if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasopts._id,canvasopts.canvas);else proxyElementWorkerRoutes.makeProxy(canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText3(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw.bind(settings)}if(typeof settings.update==="string")settings.update=parseFunctionFromText3(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update.bind(settings)}if(typeof settings.init==="string")settings.init=parseFunctionFromText3(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init.bind(settings)}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText3(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear.bind(settings)}return settings._id}return void 0}function setupCanvas(options){if(this?.__node?.graph){if(!this.__node.graph.CANVASES)this.__node.graph.CANVASES={}}else if(!globalThis.CANVASES)globalThis.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=\`canvas\${Math.floor(Math.random()*1e15)}\`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this?.__node?.graph?.CANVASES[canvasOptions._id]){this.__node.graph.run("setDraw",canvasOptions)}else if(globalThis.CANVASES?.[canvasOptions._id]){setDraw(canvasOptions)}else{if(this?.__node?.graph){canvasOptions.graph=this.__node.graph;if(!canvasOptions.__node){canvasOptions.__node={}}if(!canvasOptions.__node.tag)canvasOptions.__node.tag=canvasOptions._id;canvasOptions=this.__node.graph.add(canvasOptions);canvasOptions.__addOndisconnected=()=>{canvasOptions.stop();delete this.__node.graph.CANVASES[canvasOptions._id]}}if(this?.__node?.graph)this.__node.graph.CANVASES[canvasOptions._id]=canvasOptions;else globalThis.CANVASES[canvasOptions._id]=canvasOptions;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);else proxyElementWorkerRoutes.makeProxy(canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText3(canvasOptions.draw)}else if(typeof canvasOptions.draw==="function"){canvasOptions.draw=canvasOptions.draw.bind(canvasOptions)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText3(canvasOptions.update)}else if(typeof canvasOptions.update==="function"){canvasOptions.update=canvasOptions.update.bind(canvasOptions)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText3(canvasOptions.init)}else if(typeof canvasOptions.init==="function"){canvasOptions.init=canvasOptions.init.bind(canvasOptions)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText3(canvasOptions.clear)}else if(typeof canvasOptions.clear==="function"){canvasOptions.clear=canvasOptions.clear.bind(canvasOptions)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);canvasOptions.stop=()=>{stopAnim(canvasOptions._id)};canvasOptions.start=draw=>{startAnim(canvasOptions._id,draw)};canvasOptions.set=settings=>{setDraw(settings,canvasOptions._id)};if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)return canvasOptions._id;else{const canvascontrols={_id:options._id,width:options.width,height:options.height,draw:props=>{drawFrame(props,options._id)},update:props=>{updateCanvas(props,options._id)},clear:()=>{clearCanvas(options._id)},init:()=>{initCanvas(options._id)},stop:()=>{stopAnim(options._id)},start:()=>{startAnim(options._id)},set:newDrawProps=>{setDraw(newDrawProps,options._id)},terminate:()=>{if(this.__node?.graph)this.__node.graph.remove(options._id);else{stopAnim(options._id);if(this?.__node?.graph)delete this.__node.graph.CANVASES[canvasOptions._id];else delete globalThis.CANVASES[canvasOptions._id]}}};return canvascontrols}}function drawFrame(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0}function clearCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function initCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function updateCanvas(input,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0}function setProps(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0}function startAnim(_id,draw){let canvasopts=getCanvas.call(this,_id);canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText3(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function stopAnim(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")requestAnimationFrame(canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context));return _id}return void 0}function getCanvas(_id){let canvasopts;if(this?.__node?.graph){if(!_id)canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]];else canvasopts=this.__node.graph.CANVASES?.[_id]}else{if(!_id)canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]];else canvasopts=globalThis.CANVASES?.[_id]}return canvasopts}var workerCanvasRoutes={...proxyElementWorkerRoutes,Renderer,transferCanvas,setupCanvas,setDraw,drawFrame,clearCanvas,initCanvas,updateCanvas,setProps,startAnim,stopAnim,getCanvas};function parseFunctionFromText3(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var _ArrayManip=class{constructor(){this.recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"){if(typeof target[key]==="object")this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target}}static autoscale(array,lineIdx=0,nLines=1,centerZero=false,ymin,ymax,clamp){if(array?.length===0)return array;let max=ymax?ymax:Math.max(...array);let min=ymin?ymin:Math.min(...array);let _lines=1/nLines;let scalar=1;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));if(absmax!==0)scalar=_lines/absmax;return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return y2*scalar+(_lines*(lineIdx+1)*2-1-_lines)})}else{if(max===min){if(max!==0){scalar=_lines/max}else if(min!==0){scalar=_lines/Math.abs(min)}}else scalar=_lines/(max-min);return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return 2*((y2-min)*scalar-1/(2*nLines))+(_lines*(lineIdx+1)*2-1-_lines)})}}static genTimestamps(ct,sps10){let now=Date.now();let toInterp=[now-ct*1e3/sps10,now];return _ArrayManip.upsample(toInterp,ct)}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i2=incr;i2<array.length;i2+=incr){let rounded=Math.round(i2);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static upsample(array,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array(fitCount);var springFactor=(array.length-1)/(fitCount-1);newData[0]=array[0];for(var i2=1;i2<fitCount-1;i2++){var tmp=i2*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i2]=linearInterpolate(array[before],array[after],atPoint)}newData[fitCount-1]=array[array.length-1];return newData}static interpolate(array,fitCount,scalar=1){if(array.length>fitCount){return _ArrayManip.downsample(array,fitCount,scalar)}else if(array.length<fitCount){return _ArrayManip.upsample(array,fitCount,scalar)}return array}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x;b=0}else if(60<=h&&h<120){r=x;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x}else if(180<=h&&h<240){r=0;g=x;b=c}else if(240<=h&&h<300){r=x;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static circularBuffer(arr,newEntries){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,newEntries.slice(len-newEntries.length))}else{arr.splice(0,arr.length,...newEntries)}return arr}static reformatData(data,key){if(Array.isArray(data)){if(Array.isArray(data[0])){let d={};data.forEach((arr,i2)=>{d[i2]=arr});data=d;if(isNaN(data[0][0]))return void 0}else if(key){data={[key]:data};if(isNaN(data[key][0]))return void 0}else{data={0:data};if(isNaN(data[0][0]))return void 0}}else if(typeof data==="object"){for(const key2 in data){if(typeof data[key2]==="number")data[key2]=[data[key2]];else if(data[key2]?.values){if(typeof data[key2].values==="number")data[key2].values=[data[key2].values]}if(isNaN(data[key2][0]))return void 0}}else if(typeof data==="string"){let split;if(data.includes("\\r\\n")){let lines=data.split("\\r\\n");data={};lines.forEach((l,j)=>{if(l.includes("	")){split=l.split("	")}else if(l.includes(",")){split=l.split(",")}else if(l.includes("|")){split=l.split("|")}if(Array.isArray(split)){split.forEach((val,i2)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl=parseFloat(v);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i2]=[fl];else return void 0}})}})}else if(data.includes("	")){split=data.split("	")}else if(data.includes(",")){split=data.split(",")}else if(data.includes("|")){split=data.split("|")}data={};if(Array.isArray(split)){split.forEach((val,i2)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl=parseFloat(v);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i2]=[fl];else return void 0}})}}else if(typeof data==="number"){if(key)data={[key]:[data]};else data={0:[data]}}return data}static padTime(data,lastValue,time,targetFit){let slopeIncr=(data[0]-lastValue)/time/targetFit;let padded=[...new Array(targetFit-data.length).map((_,i2)=>lastValue+slopeIncr*(i2+1)),...data];return padded}static interpolateForTime(data,time,targetSPS){return _ArrayManip.interpolate(data,Math.ceil(targetSPS*time))}isTypedArray(x){return ArrayBuffer.isView(x)&&Object.prototype.toString.call(x)!=="[object DataView]"}spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var ArrayManip=_ArrayManip;ArrayManip.bufferValues=(objects,property,keys2,buffer)=>{if(!Array.isArray(keys2)&&typeof keys2==="object")keys2=Object.keys(keys2);if(!buffer){let object_keys=Object.keys(objects);if(keys2)buffer=new Float32Array(object_keys.length*keys2.length);else{if(typeof objects[object_keys[0]][property]==="object"){keys2=Object.keys(objects[object_keys[0]][property]);buffer=new Float32Array(object_keys.length*keys2.length)}else buffer=new Float32Array(object_keys.length)}}let i2=0;for(const key in objects){if(objects[key][property]){if(keys2){for(let j=0;j<keys2.length;j++){buffer[i2]=objects[key][property][keys2[j]];i2++}}else{buffer[i2]=objects[key][property];i2++}}}return buffer};var rechk=/^([<>])?(([1-9]\\d*)?([xcbB?hHiIfdsp]))*$/;var refmt=/([1-9]\\d*)?([xcbB?hHiIfdsp])/g;var str=(v,o,c)=>String.fromCharCode(...new Uint8Array(v.buffer,v.byteOffset+o,c));var rts=(v,o,c,s)=>new Uint8Array(v.buffer,v.byteOffset+o,c).set(s.split("").map(str2=>str2.charCodeAt(0)));var pst=(v,o,c)=>str(v,o+1,Math.min(v.getUint8(o),c-1));var tsp=(v,o,c,s)=>{v.setUint8(o,s.length);rts(v,o+1,c-1,s)};var lut=le=>({x:c=>[1,c,0],c:c=>[c,1,o=>({u:v=>str(v,o,1),p:(v,c2)=>rts(v,o,1,c2)})],"?":c=>[c,1,o=>({u:v=>Boolean(v.getUint8(o)),p:(v,B2)=>v.setUint8(o,B2)})],b:c=>[c,1,o=>({u:v=>v.getInt8(o),p:(v,b)=>v.setInt8(o,b)})],B:c=>[c,1,o=>({u:v=>v.getUint8(o),p:(v,B2)=>v.setUint8(o,B2)})],h:c=>[c,2,o=>({u:v=>v.getInt16(o,le),p:(v,h)=>v.setInt16(o,h,le)})],H:c=>[c,2,o=>({u:v=>v.getUint16(o,le),p:(v,H2)=>v.setUint16(o,H2,le)})],i:c=>[c,4,o=>({u:v=>v.getInt32(o,le),p:(v,i2)=>v.setInt32(o,i2,le)})],I:c=>[c,4,o=>({u:v=>v.getUint32(o,le),p:(v,I)=>v.setUint32(o,I,le)})],f:c=>[c,4,o=>({u:v=>v.getFloat32(o,le),p:(v,f)=>v.setFloat32(o,f,le)})],d:c=>[c,8,o=>({u:v=>v.getFloat64(o,le),p:(v,d)=>v.setFloat64(o,d,le)})],s:c=>[1,c,o=>({u:v=>str(v,o,c),p:(v,s)=>rts(v,o,c,s.slice(0,c))})],p:c=>[1,c,o=>({u:v=>pst(v,o,c),p:(v,s)=>tsp(v,o,c,s.slice(0,c-1))})]});var errbuf=new RangeError("Structure larger than remaining buffer");var errval=new RangeError("Not enough values for structure");var _ByteParser=class extends ArrayManip{static toDataView(value){if(!(value instanceof DataView)){if(typeof value==="string"&&parseInt(value))value=parseInt(value);if(typeof value==="string"){let enc=new TextEncoder;let hascodes={};for(const code in _ByteParser.codes){while(value.indexOf(code)>-1){let idx=value.indexOf(code);value=value.replace(code,"");hascodes[idx]=code}}let encoded=Array.from(enc.encode(value));for(const key in hascodes){encoded.splice(parseInt(key),0,_ByteParser.codes[hascodes[key]])}value=new DataView(new Uint8Array(encoded).buffer)}else if(typeof value==="number"){let tmp=value;if(value<256){value=new DataView(new ArrayBuffer(1));value.setUint8(0,tmp)}else if(value<65536){value=new DataView(new ArrayBuffer(2));value.setInt16(0,tmp)}else{value=new DataView(new ArrayBuffer(4));value.setUint32(0,tmp)}}else if(value instanceof ArrayBuffer||typeof SharedArrayBuffer!=="undefined"&&value instanceof SharedArrayBuffer){value=new DataView(value)}else if(Array.isArray(value)){value=new DataView(Uint8Array.from(value).buffer)}else if(typeof value==="object"){value=new TextEncoder().encode(JSON.stringify(value))}}return value}static searchBuffer(buffer,searchString,limit){var needle=searchString;var haystack=buffer;var search=_ByteParser.boyerMoore(needle);var skip=search.byteLength;var indices=[];for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){indices.push(i2);if(limit){if(indices.length>=limit)break}}return indices}static bytesToInt16(x0,x1){let int16=(255&x0)<<8|255&x1;if((int16&32768)>0){int16|=4294901760}else{int16&=65535}return int16}static bytesToUInt16(x0,x1){return x0*256+x1}static Uint16ToBytes(y2){return[y2&255,y2>>8&255]}static bytesToInt24(x0,x1,x2){let int24=(255&x0)<<16|(255&x1)<<8|255&x2;if((int24&8388608)>0){int24|=4278190080}else{int24&=16777215}return int24}static bytesToUInt24(x0,x1,x2){return x0*65536+x1*256+x2}static Uint24ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255]}static bytesToInt32(x0,x1,x2,x3){let int32=(255&x0)<<24|(255&x1)<<16|(255&x2)<<8|255&x3;if((int32&2147483648)>0){int32|=0}else{int32&=4294967295}return int32}static bytesToUInt32(x0,x1,x2,x3){return x0*16777216+x1*65536+x2*256+x3}static Uint32ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255,y2>>24&255]}static get2sCompliment(val,nbits4){if(val>4294967296)return null;return val<<32-nbits4>>32-nbits4}static getSignedInt(...args){let pos=0;function getInt(size){var value=0;var first=true;while(size--){if(first){let byte=args[pos++];value+=byte&127;if(byte&128){value-=128}first=false}else{value*=256;value+=args[pos++]}}return value}return getInt(args.length)}static asUint8Array(input){if(input instanceof Uint8Array){return input}else if(typeof input==="string"){var arr=new Uint8Array(input.length);for(var i2=0;i2<input.length;i2++){var c=input.charCodeAt(i2);if(c>127){throw new TypeError("Only ASCII patterns are supported")}arr[i2]=c}return arr}else{return new Uint8Array(input)}}static boyerMoore(patternBuffer){var pattern=_ByteParser.asUint8Array(patternBuffer);var M=pattern.length;if(M===0){throw new TypeError("patternBuffer must be at least 1 byte long")}var R=256;var rightmost_positions=new Int32Array(R);for(var c=0;c<R;c++){rightmost_positions[c]=-1}for(var j=0;j<M;j++){rightmost_positions[pattern[j]]=j}var boyerMooreSearch=(txtBuffer,start,end)=>{var txt=_ByteParser.asUint8Array(txtBuffer);if(start===void 0)start=0;if(end===void 0)end=txt.length;var pat=pattern;var right=rightmost_positions;var lastIndex=end-pat.length;var lastPatIndex=pat.length-1;var skip;for(var i2=start;i2<=lastIndex;i2+=skip){skip=0;for(var j2=lastPatIndex;j2>=0;j2--){var c2=txt[i2+j2];if(pat[j2]!==c2){skip=Math.max(1,j2-right[c2]);break}}if(skip===0){return i2}}return-1};boyerMooreSearch.byteLength=pattern.byteLength;return boyerMooreSearch}static struct(format){let fns=[],size=0,m=rechk.exec(format);if(!m){throw new RangeError("Invalid format string")}const t2=lut("<"===m[1]),lu=(n,c)=>t2[c](n?parseInt(n,10):1);while(m=refmt.exec(format)){((r,s,f)=>{for(let i2=0;i2<r;++i2,size+=s){if(f){fns.push(f(size))}}})(...lu(...m.slice(1)))}const unpack_from=(arrb,offs)=>{if(arrb.byteLength<(offs|0)+size){throw errbuf}let v=new DataView(arrb,offs|0);return fns.map(f=>f.u(v))};const pack_into=(arrb,offs,...values)=>{if(values.length<fns.length){throw errval}if(arrb.byteLength<offs+size){throw errbuf}const v=new DataView(arrb,offs);new Uint8Array(arrb,offs,size).fill(0);fns.forEach((f,i2)=>f.p(v,values[i2]))};const pack=(...values)=>{let b=new ArrayBuffer(size);pack_into(b,0,...values);return b};const unpack=arrb=>unpack_from(arrb,0);function*iter_unpack(arrb){for(let offs=0;offs+size<=arrb.byteLength;offs+=size){yield unpack_from(arrb,offs)}}return Object.freeze({unpack,pack,unpack_from,pack_into,iter_unpack,format,size})}};var ByteParser=_ByteParser;ByteParser.codes={"\\\\n":10,"\\\\r":13,"\\\\t":9,"\\\\s":32,"\\\\b":8,"\\\\f":12,"\\\\":92};(function(s){var w,f={},l=console,m=Math,z2="postMessage",x="HackTimer.js by turuslan: ",v="Initialisation failed",p=0,r="hasOwnProperty",y2=[].slice,b=Worker;function d(){do{p=2147483647>p?p+1:0}while(f[r](p));return p}if(!/MSIE 10/i.test(navigator.userAgent)){try{s=URL.createObjectURL(new Blob(["var f={},p=postMessage,r='hasOwnProperty';onmessage=function(e){var d=e.data,i=d.i,t=d[r]('t')?d.t:0;switch(d.n){case'a':f[i]=setInterval(function(){p(i)},t);break;case'b':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case'c':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case'd':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch(e){}}if(typeof b!=="undefined"){try{w=new b(s);setInterval=function(c,t2){var i2=d();f[i2]={c,p:y2.call(arguments,2)};w[z2]({n:"a",i:i2,t:t2});return i2};clearInterval=function(i2){if(f[r](i2))delete f[i2],w[z2]({n:"b",i:i2})};setTimeout=function(c,t2){var i2=d();f[i2]={c,p:y2.call(arguments,2),t:true};w[z2]({n:"c",i:i2,t:t2});return i2};clearTimeout=function(i2){if(f[r](i2))delete f[i2],w[z2]({n:"d",i:i2})};w.onmessage=function(e){var i2=e.data,c,n;if(f[r](i2)){n=f[i2];c=n.c;if(n[r]("t"))delete f[i2]}if(typeof c=="string")try{c=new Function(c)}catch(k){l.log(x+"Error parsing callback code string: ",k)}if(typeof c=="function")c.apply(globalThis,n.p)};w.onerror=function(e){l.log(e)}}catch(e){l.log(x+v);l.error(e)}}else l.log(x+v+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js");var WebSerial=class extends ByteParser{constructor(){super(...arguments);this.streams={};this.createStream=options=>{let stream={_id:options._id?options._id:\`stream\${Math.floor(Math.random()*1e15)}\`,info:options.port.getInfo(),running:false,...options};if(options.port?.readable){if(options.transforms){stream.reader=WebSerial.setStreamTransforms(options.port.readable,options.transforms).getReader()}else{stream.reader=options.port.readable.getReader()}}this.streams[stream._id]=stream;return stream}}getPorts(){return navigator.serial.getPorts()}requestPort(usbVendorId,usbProductId){let options={};if(usbVendorId){options.usbVendorId=usbVendorId}if(usbProductId){options.usbProductId=usbProductId}if(options.usbVendorId)return navigator.serial.requestPort({filters:[options]});else return navigator.serial.requestPort()}openPort(port,options){if(options)options=Object.assign({},options);if(options?.ondisconnect){port.ondisconnect=options.ondisconnect;delete options.ondisconnect}return port.open(options).then(()=>{if(options?.onconnect)options.onconnect(port)})}async readWithTimeout(port,timeout){const reader=port.readable.getReader();const timer=setTimeout(()=>{reader.releaseLock()},timeout);const result=await reader.read();clearTimeout(timer);reader.releaseLock();return result}async writePort(port,message){const writer=port.writable.getWriter();await writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}getSignals(port){return port.getSignals()}setSignals(port,signals){return port.setSignals(signals)}readStream(stream){if(stream.reader&&!stream.running){let reader=stream.reader;if(stream.buffering){if(typeof stream.buffering!=="object")stream.buffering={};if(!stream.buffering.buffer){stream.buffering.buffer=[]}if(!stream.buffering.searchBytes)stream.buffering.searchBytes=new Uint8Array([13,10])}let readLoop=()=>{if(stream.port.readable&&stream.running){reader.read().then(result=>{if(result.done)reader.releaseLock();else{if(stream.buffering){stream.buffering.buffer.push(...result.value);const needle=stream.buffering.searchBytes;const haystack=stream.buffering.buffer;const search=WebSerial.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=stream.buffering.lockIdx??0;for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){if(!stream.buffering.locked&&!("lockIdx"in stream.buffering))used=stream.buffering.lockIdx=i2;else{nextIndex=i2;if(nextIndex>=0){const len=nextIndex-used;if(!stream.buffering.locked){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(data);stream.buffering.locked=true}else if(len>0){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(new Uint8Array(data))}used=nextIndex}}}}else stream.ondata(result.value);setTimeout(()=>{readLoop()},stream.frequency)}}).catch(er=>{console.error(stream._id," Read error:",er);if(er.message.includes("overrun")||er.message.includes("framing")){delete stream.reader;this.reconnect(stream)}})}else if(!stream.running&&stream.port.readable){try{reader.releaseLock()}catch(er){console.error(er)}}};stream.running=true;readLoop();return stream}return void 0}writeStream(stream,message){if(typeof stream==="string")stream=this.streams[stream];if(stream.port.writable){let writer=stream.port.writable.getWriter();writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}return void 0}closeStream(stream,onclose){if(typeof stream==="string")stream=this.streams[stream];stream.running=false;return new Promise((res,rej)=>{if(stream.settings.beforedisconnect){stream.settings.beforedisconnect(this,stream.port)}setTimeout(async()=>{if(stream.port.readable&&stream.reader){try{stream.reader.releaseLock()}catch(er){console.error(er)}if(stream.transforms)try{await stream.reader.cancel()}catch(err){console.error(err)}}try{await stream.port.close().then(()=>{if(onclose)onclose(this.streams[stream._id])});delete this.streams[stream._id];res(true)}catch(er){rej(er)}},300)})}reconnect(stream,options){if(typeof stream==="string")stream=this.streams[stream];return new Promise((res,rej)=>{if(typeof stream!=="object"){rej(void 0);return}let info=stream.port.getInfo();this.closeStream(stream._id).then(closed=>{setTimeout(()=>{this.getPorts().then(ports=>{for(let i2=0;i2<ports.length;i2++){if(ports[i2].getInfo().usbVendorId===info.usbVendorId&&ports[i2].getInfo().usbProductId===info.usbProductId){if(!options)options=stream;else options._id=stream._id;delete options.port;this.openPort(ports[i2],options.settings).then(()=>{const stream2=this.createStream({...options,port:ports[i2]});this.readStream(stream2);res(stream2)}).catch(rej)}}}).catch(rej)},100)})})}static setStreamTransforms(stream,transforms){let transform=[];Object.keys(transforms).forEach(t2=>{let opt=transforms[t2];if(opt instanceof TransformStream){transform.push(opt)}else{if(!opt.start)opt.start=function start(){};if(!opt.flush)opt.flush=function flush(){};let transformer=new TransformStream({start:opt.start,transform:opt.transform,flush:opt.flush},opt.writableStrategy,opt.readableStrategy);transform.push(transformer)}});let str2=stream;transform.forEach(transform2=>{str2=str2.pipeThrough(transform2)});return str2}};var sps=250;var gain=32;var nbits=24;var vref=1.2;var half24bit=Math.pow(2,24)/2;function ads131m08codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i2=0;i2<9;i2++){let j=i2*25;output[0][i2]=ByteParser.bytesToInt24(arr[j],arr[j+1],arr[j+2]);output[1][i2]=ByteParser.bytesToInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i2]=ByteParser.bytesToInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i2]=ByteParser.bytesToInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i2]=ByteParser.bytesToInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i2]=ByteParser.bytesToInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i2]=ByteParser.bytesToInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i2]=ByteParser.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])}if(arr.length>225){output.leds=arr.slice(225)}return output}function ads131m08codec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i2=0;i2<9;i2++){let j=i2*25;output[0][i2]=ByteParser.bytesToInt24(arr[j],arr[j+1],arr[j+2])+half24bit;output[1][i2]=ByteParser.bytesToInt24(arr[j+3],arr[j+4],arr[j+5])+half24bit;output[2][i2]=ByteParser.bytesToInt24(arr[j+6],arr[j+7],arr[j+8])+half24bit;output[3][i2]=ByteParser.bytesToInt24(arr[j+9],arr[j+10],arr[j+11])+half24bit;output[4][i2]=ByteParser.bytesToInt24(arr[j+12],arr[j+13],arr[j+14])+half24bit;output[5][i2]=ByteParser.bytesToInt24(arr[j+15],arr[j+16],arr[j+17])+half24bit;output[6][i2]=ByteParser.bytesToInt24(arr[j+18],arr[j+19],arr[j+20])+half24bit;output[7][i2]=ByteParser.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])+half24bit}if(arr.length>225){output.leds=arr.slice(225)}return output}var decoder=new TextDecoder;function ads131m08_arduinocodec(data){const parsed=decoder.decode(data);let split;if(parsed.includes("|"))split=parsed.split("|");else if(split.includes(","))split=parsed.split(",");else split=parsed.split("	");return{"0":parseInt(split[0]),"1":parseInt(split[1]),"2":parseInt(split[2]),"3":parseInt(split[3]),"4":parseInt(split[4]),"5":parseInt(split[5]),"6":parseInt(split[6]),"7":parseInt(split[7]),timestamp:Date.now()}}var defaultChartSetting={nSec:10,sps,units:"mV"};var ads131m08ChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting)),"1":JSON.parse(JSON.stringify(defaultChartSetting)),"2":JSON.parse(JSON.stringify(defaultChartSetting)),"3":JSON.parse(JSON.stringify(defaultChartSetting)),"4":JSON.parse(JSON.stringify(defaultChartSetting)),"5":JSON.parse(JSON.stringify(defaultChartSetting)),"6":JSON.parse(JSON.stringify(defaultChartSetting)),"7":JSON.parse(JSON.stringify(defaultChartSetting))}};var defaultsetting={sps,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))};var halfOffset=.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))*(Math.pow(2,nbits)-1)*.5;var ads131m08FilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting)),"1":JSON.parse(JSON.stringify(defaultsetting)),"2":JSON.parse(JSON.stringify(defaultsetting)),"3":JSON.parse(JSON.stringify(defaultsetting)),"4":JSON.parse(JSON.stringify(defaultsetting)),"5":JSON.parse(JSON.stringify(defaultsetting)),"6":JSON.parse(JSON.stringify(defaultsetting)),"7":JSON.parse(JSON.stringify(defaultsetting))};var accScale=.002/Math.pow(2,4);var getAcc=(arr,output,channels=8)=>{const accIdx=channels*3+1;const sum=(a,b)=>a+b;const accSum=arr.slice(accIdx).reduce(sum,0);if(accSum!==0){output.ax=accScale*ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output.ay=accScale*ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output.az=accScale*ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5])}};function cytoncodec(data){let arr;if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<8;i2++){let idx=1+3*i2;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);output.timestamp=Date.now();return output}function daisycytoncodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<8;i2++){let idx=1+3*i2;if(arr[0]%2===0)output[i2+7]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2]);else output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);return output}var sps2=250;var cytonSerialSettings={deviceType:"USB",deviceName:"cyton",baudRate:115200,codec:cytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var daisycytonSerialSettings={deviceType:"USB",deviceName:"cyton_daisy",baudRate:115200,codec:daisycytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var defaultChartSetting2={nSec:10,sps:sps2,units:"mV"};var defaultChartSetting22={nSec:10,sps:sps2};var cytonChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting2)),"1":JSON.parse(JSON.stringify(defaultChartSetting2)),"2":JSON.parse(JSON.stringify(defaultChartSetting2)),"3":JSON.parse(JSON.stringify(defaultChartSetting2)),"4":JSON.parse(JSON.stringify(defaultChartSetting2)),"5":JSON.parse(JSON.stringify(defaultChartSetting2)),"6":JSON.parse(JSON.stringify(defaultChartSetting2)),"7":JSON.parse(JSON.stringify(defaultChartSetting2)),"ax":JSON.parse(JSON.stringify(defaultChartSetting22)),"ay":JSON.parse(JSON.stringify(defaultChartSetting22)),"az":JSON.parse(JSON.stringify(defaultChartSetting22))},generateNewLines:true};var defaultsetting2={sps:sps2,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))};var cytonFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting2)),"1":JSON.parse(JSON.stringify(defaultsetting2)),"2":JSON.parse(JSON.stringify(defaultsetting2)),"3":JSON.parse(JSON.stringify(defaultsetting2)),"4":JSON.parse(JSON.stringify(defaultsetting2)),"5":JSON.parse(JSON.stringify(defaultsetting2)),"6":JSON.parse(JSON.stringify(defaultsetting2)),"7":JSON.parse(JSON.stringify(defaultsetting2)),"8":JSON.parse(JSON.stringify(defaultsetting2)),"9":JSON.parse(JSON.stringify(defaultsetting2)),"10":JSON.parse(JSON.stringify(defaultsetting2)),"11":JSON.parse(JSON.stringify(defaultsetting2)),"12":JSON.parse(JSON.stringify(defaultsetting2)),"13":JSON.parse(JSON.stringify(defaultsetting2)),"14":JSON.parse(JSON.stringify(defaultsetting2)),"15":JSON.parse(JSON.stringify(defaultsetting2))};function freeeeg128codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<128;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=385;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps3=250;var freeeeg128SerialSettings={deviceType:"USB",deviceName:"freeeeg128",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg128codec,sps:sps3,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg128ChartSettings={lines:{"ax":{nSec:10,sps:sps3},"ay":{nSec:10,sps:sps3},"az":{nSec:10,sps:sps3},"gx":{nSec:10,sps:sps3},"gy":{nSec:10,sps:sps3},"gz":{nSec:10,sps:sps3}}};var freeeeg128FilterSettings={};for(let i2=0;i2<128;i2++){freeeeg128ChartSettings.lines[i2]={sps:sps3,nSec:10,units:"mV"};freeeeg128FilterSettings[i2]={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))}}function freeeeg32codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<32;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=97;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps4=512;var freeeeg32SerialSettings={deviceType:"USB",deviceName:"freeeeg32",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg32_optical_SerialSettings={deviceType:"USB",deviceName:"freeeeg32_optical",baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting3={nSec:10,sps:sps4};var freeeeg32ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting3)),"ay":JSON.parse(JSON.stringify(defaultChartSetting3)),"az":JSON.parse(JSON.stringify(defaultChartSetting3)),"gx":JSON.parse(JSON.stringify(defaultChartSetting3)),"gy":JSON.parse(JSON.stringify(defaultChartSetting3)),"gz":JSON.parse(JSON.stringify(defaultChartSetting3))}};var freeeeg32FilterSettings={};for(let i2=0;i2<32;i2++){freeeeg32ChartSettings.lines[i2]={sps:sps4,nSec:10,units:"mV"};freeeeg32FilterSettings[i2]={sps:sps4,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))}}function freeeeg16codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<16;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var BLEBuffer=[];var locked;var lockIdx;function freeeeg16BLEcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;BLEBuffer.push(...data);const needle=new Uint8Array([192,160]);const haystack=BLEBuffer;const search=ByteParser.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=lockIdx??0;let pass=false;for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){if(!locked&&!(typeof lockIdx==="number"))used=lockIdx=i2;else{nextIndex=i2;if(nextIndex>=0){const len=nextIndex-used;if(!lockIdx){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true;locked=true}else if(len>0){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true}used=nextIndex}}}if(pass){let output={};for(let i3=0;i3<16;i3++){let idx=i3*3+1;output[i3]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}else return void 0}var sps5=250;var freeeeg16BLESettings={deviceType:"BLE",deviceName:"freeeeg16",services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:void 0},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:freeeeg16BLEcodec,sps:sps5}}}};var freeeeg16SerialSettings={deviceType:"USB",deviceName:"freeeeg16",baudRate:115200,bufferSize:2e3,frequency:3.5,codec:freeeeg16codec,sps:sps5,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting4={nSec:10,sps:sps5};var freeeeg16ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting4)),"ay":JSON.parse(JSON.stringify(defaultChartSetting4)),"az":JSON.parse(JSON.stringify(defaultChartSetting4)),"gx":JSON.parse(JSON.stringify(defaultChartSetting4)),"gy":JSON.parse(JSON.stringify(defaultChartSetting4)),"gz":JSON.parse(JSON.stringify(defaultChartSetting4))}};var freeeeg16FilterSettings={};var gain2=32;var nbits2=24;var vref2=1.2;for(let i2=0;i2<16;i2++){freeeeg16ChartSettings.lines[i2]={sps:sps5,nSec:10,units:"mV"};freeeeg16FilterSettings[i2]={sps:sps5,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref2/(gain2*(Math.pow(2,nbits2)-1))}}var textdecoder=new TextDecoder;function hegduinocodec(value){let output={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0};let txt=textdecoder.decode(value);let line=txt.split("|");if(line.length===3){output.timestamp=Date.now();output.red=parseInt(line[0]);output.infrared=parseInt(line[1]);output.heg=parseFloat(line[2])}else if(line.length>=2){output.timestamp=Date.now();output.red=parseInt(line[1]);output.infrared=parseInt(line[2]);output.heg=parseFloat(line[3]);if(line[4])output.ambient=parseFloat(line[4]);if(line[5])output.temperature=parseFloat(line[5]);return output}else return txt}var sps6=40;var hegduinoSerialSettings={deviceType:"USB",deviceName:"hegduino",baudRate:115200,write:"t\\n",codec:hegduinocodec,sps:sps6};var hegduinoV1SerialSettings=Object.assign({},hegduinoSerialSettings);hegduinoV1SerialSettings.sps=19;var hegduinoBLESettings={deviceType:"BLE",deviceName:"hegduino",sps:sps6,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:hegduinocodec,sps:sps6}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};var hegduinoV1BLESettings=Object.assign({},hegduinoSerialSettings);hegduinoV1BLESettings.sps=19;function max3010xcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let pktCt=32;const output={"red":new Array(pktCt),"ir":new Array(pktCt),"max_dietemp":ByteParser.get2sCompliment(arr[193],8)+.0625*arr[194],"timestamp":Date.now()};let i2=0;while(i2<pktCt){let idx=i2*6;if(i2%2===0){output["ir"][i2]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["ir"][i2+1]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}else{output["red"][i2-1]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["red"][i2]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}i2++}return output}function mpu6050codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={"ax":new Array(20),"ay":new Array(20),"az":new Array(20),"gx":new Array(20),"gy":new Array(20),"gz":new Array(20),"mpu_dietemp":(ByteParser.bytesToInt16(arr[241],arr[242])+521)/340+35,timestamp:Date.now()};for(let i2=0;i2<20;i2++){let idx=i2*12;output.ax[i2]=ByteParser.bytesToInt16(arr[idx+1],arr[idx+2]);output.ay[i2]=ByteParser.bytesToInt16(arr[idx+3],arr[idx+4]);output.az[i2]=ByteParser.bytesToInt16(arr[idx+5],arr[idx+6]);output.gx[i2]=ByteParser.bytesToInt16(arr[idx+7],arr[idx+8]);output.gy[i2]=ByteParser.bytesToInt16(arr[idx+9],arr[idx+10]);output.gz[i2]=ByteParser.bytesToInt16(arr[idx+11],arr[idx+12])}return output}function cognixionONE_EEG_codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let i2=0;i2<7;i2++){let j=i2*26+1;if(!arr[j+23])break;output[0][i2]=ByteParser.bytesToUInt24(arr[j],arr[j+1],arr[j+2]);output[1][i2]=ByteParser.bytesToUInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i2]=ByteParser.bytesToUInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i2]=ByteParser.bytesToUInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i2]=ByteParser.bytesToUInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i2]=ByteParser.bytesToUInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i2]=ByteParser.bytesToUInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i2]=ByteParser.bytesToUInt24(arr[j+21],arr[j+22],arr[j+23])}return output}var sps7=250;var cognixionONEBLESettings={deviceType:"BLE",deviceName:"cognixionONE",services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:true,notifyCallback:void 0,codec:cognixionONE_EEG_codec,sps:sps7}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:true}}},sps:sps7};var cognixionONESerialSettings=Object.assign({},cytonSerialSettings);cognixionONESerialSettings.sps=sps7;cognixionONESerialSettings.deviceName="cognixionONE";var defaultChartSetting5={nSec:10,sps:sps7,units:"mV"};var cognixionONEChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting5)),"1":JSON.parse(JSON.stringify(defaultChartSetting5)),"2":JSON.parse(JSON.stringify(defaultChartSetting5)),"3":JSON.parse(JSON.stringify(defaultChartSetting5)),"4":JSON.parse(JSON.stringify(defaultChartSetting5)),"5":JSON.parse(JSON.stringify(defaultChartSetting5)),"6":JSON.parse(JSON.stringify(defaultChartSetting5)),"7":JSON.parse(JSON.stringify(defaultChartSetting5))}};var PeanutCodes={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function peanutcodec(data){let result={};let i2=0;while(i2<data.length){if(PeanutCodes[data[i2]]&&i2+1+PeanutCodes[data[i2]].byteLength<=data.length){let slice=data.slice(i2+1,i2+1+PeanutCodes[data[i2]].byteLength).buffer;let unpacked=ByteParser.struct(PeanutCodes[data[i2]].format).unpack(slice);let code=PeanutCodes[data[i2]].type;if(code==="unfilteredHEG"||code==="heg")unpacked=unpacked[0]/256;else if(code==="POOR_SIGNAL"||code==="sampleNumber"||code==="debug0"||code==="debug1"||code==="debug2"||code==="debug3")unpacked=unpacked[0];if(!result[PeanutCodes[data[i2]].type]){if(Array.isArray(unpacked))result[PeanutCodes[data[i2]].type]=unpacked;else result[PeanutCodes[data[i2]].type]=[unpacked]}else{if(Array.isArray(unpacked))result[PeanutCodes[data[i2]].type].push(...unpacked);else result[PeanutCodes[data[i2]].type].push(unpacked)}i2+=PeanutCodes[data[i2]].byteLength+1}else i2++}result.timestamp=Date.now();return result}var peanutSerialSettings={deviceType:"USB",deviceName:"peanut",baudRate:38400,bufferSize:400,write:"protocol 3\\n",buffering:{searchBytes:new Uint8Array([170,170])},codec:peanutcodec,sps:10.101};var sealevel_hpa=1013.25;var bme280codec=data=>{let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={timestamp:Date.now(),temp:[],pressure:[],altitude:[]};let mode=0;if(arr[0].length===74)mode=1;if(!mode){for(let j=0;j<3;j++){let i2=j*16+2;let tint=ByteParser.bytesToInt32(arr[3+i2],arr[2+i2],arr[1+i2],arr[0+i2]);let tfrac=ByteParser.bytesToInt32(arr[7+i2],arr[6+i2],arr[5+i2],arr[4+i2]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser.bytesToInt32(arr[11+i2],arr[10+i2],arr[9+i2],arr[8+i2]);let pfrac=ByteParser.bytesToInt32(arr[15+i2],arr[14+i2],arr[13+i2],arr[12+i2]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}else{output.humidity=[];for(let j=0;j<3;j++){let i2=j*24+2;let tint=ByteParser.bytesToInt32(arr[3+i2],arr[2+i2],arr[1+i2],arr[0+i2]);let tfrac=ByteParser.bytesToInt32(arr[7+i2],arr[6+i2],arr[5+i2],arr[4+i2]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser.bytesToInt32(arr[11+i2],arr[10+i2],arr[9+i2],arr[8+i2]);let pfrac=ByteParser.bytesToInt32(arr[15+i2],arr[14+i2],arr[13+i2],arr[12+i2]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));let hint=ByteParser.bytesToInt32(arr[19+i2],arr[18+i2],arr[17+i2],arr[16+i2]);let hfrac=ByteParser.bytesToInt32(arr[23+i2],arr[22+i2],arr[21+i2],arr[20+i2]);output.humidity.push(hint+hfrac/Math.pow(10,Math.ceil(Math.log10(hfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}return output};function altitude(pressure,temperature){return 44330*(1-Math.pow(pressure/sealevel_hpa,.1903))}function nrf5x_usbcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i2)=>{output[i2+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec(arr.subarray(2))))}return output}function nrf5x_usbcodec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec_singleended(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i2)=>{output[i2+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec_singleended(arr.subarray(2))))}return output}var nrf5xSerialSettings={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec,sps:250};var nrf5xSerialSettings_singleended={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec_singleended,sps:250};var nrf5xBLESettings={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var nrf5xBLESettings_singleended={deviceType:"BLE",deviceName:"nrf5x_singleended",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var defaultChartSetting6={nSec:10,sps:250,units:"mV"};var nrf5x_usbChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting6)),"1":JSON.parse(JSON.stringify(defaultChartSetting6)),"2":JSON.parse(JSON.stringify(defaultChartSetting6)),"3":JSON.parse(JSON.stringify(defaultChartSetting6)),"4":JSON.parse(JSON.stringify(defaultChartSetting6)),"5":JSON.parse(JSON.stringify(defaultChartSetting6)),"6":JSON.parse(JSON.stringify(defaultChartSetting6)),"7":JSON.parse(JSON.stringify(defaultChartSetting6))},generateNewLines:true,cleanGeneration:false};var gain3=32;var nbits3=24;var vref3=1.2;var defaultsetting3={sps:250,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref3/(gain3*(Math.pow(2,nbits3)-1))};var nrf5x_usbFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting3)),"1":JSON.parse(JSON.stringify(defaultsetting3)),"2":JSON.parse(JSON.stringify(defaultsetting3)),"3":JSON.parse(JSON.stringify(defaultsetting3)),"4":JSON.parse(JSON.stringify(defaultsetting3)),"5":JSON.parse(JSON.stringify(defaultsetting3)),"6":JSON.parse(JSON.stringify(defaultsetting3)),"7":JSON.parse(JSON.stringify(defaultsetting3)),"8":JSON.parse(JSON.stringify(defaultsetting3)),"9":JSON.parse(JSON.stringify(defaultsetting3)),"10":JSON.parse(JSON.stringify(defaultsetting3)),"11":JSON.parse(JSON.stringify(defaultsetting3)),"12":JSON.parse(JSON.stringify(defaultsetting3)),"13":JSON.parse(JSON.stringify(defaultsetting3)),"14":JSON.parse(JSON.stringify(defaultsetting3)),"15":JSON.parse(JSON.stringify(defaultsetting3))};var textdecoder2=new TextDecoder;function statechangercodec(value){let output={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0};let txt=textdecoder2.decode(value);let line=txt.split("|");if(line.length>=5){output.timestamp=Date.now();output.left_red=parseInt(line[1]);output.left_infrared=parseInt(line[2]);output.left_heg=parseFloat(line[3]);output.center_red=parseInt(line[4]);output.center_infrared=parseInt(line[5]);output.center_heg=parseFloat(line[6]);output.right_red=parseInt(line[7]);output.right_infrared=parseInt(line[8]);output.right_heg=parseFloat(line[9]);return output}else return txt}var statechangerSerialSettings={deviceType:"USB",deviceName:"statechanger",baudRate:115200,codec:statechangercodec,sps:20};var statechangerBLESettings={deviceType:"BLE",deviceName:"statechanger",sps:20,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:statechangercodec}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};function blueberrycodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.red/(.5*(output.ir+output.ir2));return output}var sps8=40;var blueberryBLESettings={deviceType:"BLE",deviceName:"blueberry",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:true,notifyCallback:void 0,codec:blueberrycodec,sps:sps8}}},sps:sps8};function blueberryshortcodec(value){let output={sred:value.getInt32(2),sir:value.getInt32(6),sir2:value.getInt32(10),timestamp:Date.now()};output.sheg=output.sred/(.5*(output.sir+output.sir2));return output}function blueberrylongcodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.sred/(.5*(output.ir+output.ir2));return output}var sps9=40;var blueberry2BLESettings={deviceType:"BLE",deviceName:"blueberry2",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:true,notifyCallback:void 0,codec:blueberrylongcodec,sps:sps9},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:true,notifyCallback:void 0,codec:blueberryshortcodec,sps:sps9}}},sps:sps9};function hrcodec(data){return{hr:data.getInt8(1),timestamp:Date.now()}}var heartRateBLESettings={deviceType:"BLE",deviceName:"heartrate",services:{"heart_rate":{"heart_rate_measurement":{notify:true,notifyCallback:void 0,codec:hrcodec}}}};var simulatorSettings={sps:250,deviceType:"CUSTOM",deviceName:"simulator",simulate:{"0":{sps:250,freq:1,amplitude:1,offset:0},"1":{sps:250,freq:10,amplitude:1,offset:0},"2":{sps:250,freq:100,amplitude:.5,offset:.5},"3":{sps:250,freq:25,amplitude:1,offset:0}},connect:(settings={})=>{return new Promise(async(res,rej)=>{let _id=\`simulated\${Math.floor(Math.random()*1e15)}\`;let info={_id,settings:Object.assign(Object.assign({},simulatorSettings),settings)};info.settings.looping=true;let loopTime=50;let lastTime=Date.now();let loop2=()=>{if(info.settings.looping){let newData={};let now=Date.now();let frame=now-lastTime;for(const key in info.settings.simulate){let newPoints=Math.floor(info.settings.simulate[key].sps*frame/1e3);newData[key]=new Array(newPoints).fill(0);newData[key]=newData[key].map((v,i2)=>{return Math.sin(2*Math.PI*info.settings.simulate[key].freq*.001*(lastTime+frame*(i2+1)/newPoints))*info.settings.simulate[key].amplitude+info.settings.simulate[key].offset})}lastTime=now;newData.timestamp=lastTime;info.settings.ondata(newData);setTimeout(()=>{loop2()},loopTime)}};loop2();if(info.settings.onconnect)info.settings.onconnect(info);res(info)})},codec:reading=>{return reading},disconnect:info=>{console.log(info);info.settings.looping=false;info.settings.ondisconnect(info)},onconnect:info=>{console.log("simulator connected!",info)},ondisconnect:info=>{console.log("simulator disconnected!",info)},ondata:data=>{}};var BiquadChannelFilterer=class{constructor(options={sps:512,useSMA4:false,useNotch50:true,useNotch60:true,useLowpass:false,lowpassHz:100,useBandpass:false,bandpassLower:3,bandpassUpper:45,useDCBlock:true,DCBresonance:.995,trimOutliers:false,outlierTolerance:.2,useScaling:false,scalar:1}){this.idx=0;this.sps=options.sps;this.bandpassLower=options.bandpassLower?options.bandpassLower:3;this.bandpassUpper=options.bandpassUpper?options.bandpassUpper:45;this.useSMA4=options.useSMA4;this.last4=[];this.useNotch50=options.useNotch50;this.useNotch60=options.useNotch60;this.useLowpass=options.useLowpass;this.lowpassHz=options.lowpassHz?options.lowpassHz:100;this.useBandpass=options.useBandpass;this.useDCBlock=options.useDCBlock;this.DCBresonance=options.DCBresonance?options.DCBresonance:.995;this.useScaling=options.useScaling;this.scalar=options.scalar;this.trimOutliers=options.trimOutliers;this.outlierTolerance=options.outlierTolerance;let sps10=this.sps;this.notch50=[makeNotchFilter(50,sps10,2),makeNotchFilter(100,sps10,2)];this.notch60=[makeNotchFilter(60,sps10,2),makeNotchFilter(120,sps10,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1)];this.dcb=new DCBlocker(options.DCBresonance?options.DCBresonance:.995)}reset(sps10=this.sps){this.notch50=[makeNotchFilter(50,sps10,2),makeNotchFilter(100,sps10,2)];this.notch60=[makeNotchFilter(60,sps10,2),makeNotchFilter(120,sps10,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1)];this.dcb=new DCBlocker(this.DCBresonance)}setBandpass(bandpassLower=this.bandpassLower,bandpassUpper=this.bandpassUpper,sps10=this.sps){this.bandpassLower=bandpassLower;this.bandpassUpper=bandpassUpper;this.bp1=[makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10)]}apply(latestData=0){let out=latestData;if(this.useScaling===true){out*=this.scalar}if(this.filtered&&this.trimOutliers&&this.outlierTolerance){if(Math.abs(out-this.filtered)>this.outlierTolerance){out=this.filtered}}if(this.useDCBlock===true){out=this.dcb.applyFilter(out)}if(this.useSMA4===true){if(this.last4.length<4){this.last4.push(out)}else{out=this.last4.reduce((accumulator,currentValue)=>accumulator+currentValue)/this.last4.length;this.last4.shift();this.last4.push(out)}}if(this.useNotch50===true){this.notch50.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useNotch60===true){this.notch60.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useLowpass===true){this.lp1.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useBandpass===true){this.bp1.forEach((f,i2)=>{out=f.applyFilter(out)})}this.filtered=out;this.idx++;return out}};var Biquad=class{constructor(type,freq,sps10,Q=1/Math.sqrt(2),dbGain=0){this.a0=0;this.a1=0;this.a2=0;this.b0=0;this.b1=0;this.b2=0;this.x1=0;this.x2=0;this.y1=0;this.y2=0;let types=["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"];if(types.indexOf(type)<0){console.error("Valid types: 'lowpass','highpass','bandpass','notch','peak','lowshelf','highshelf'");return}this.type=type;this.freq=freq;this.sps=sps10;this.Q=Q;this.dbGain=dbGain;let A2=Math.pow(10,dbGain/40);let omega=2*Math.PI*freq/sps10;let sn=Math.sin(omega);let cs=Math.cos(omega);let alpha=sn/(2*Q);let beta=Math.sqrt(A2+A2);this[type](A2,sn,cs,alpha,beta);this.b0/=this.a0;this.b1/=this.a0;this.b2/=this.a0;this.a1/=this.a0;this.a2/=this.a0}lowpass(A2,sn,cs,alpha,beta){this.b0=(1-cs)*.5;this.b1=1-cs;this.b2=(1-cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}highpass(A2,sn,cs,alpha,beta){this.b0=(1+cs)*.5;this.b1=-(1+cs);this.b2=(1+cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}bandpass(A2,sn,cs,alpha,beta){this.b0=alpha;this.b1=0;this.b2=-alpha;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}notch(A2,sn,cs,alpha,beta){this.b0=1;this.b1=-2*cs;this.b2=1;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}peak(A2,sn,cs,alpha,beta){this.b0=1+alpha*A2;this.b1=-2*cs;this.b2=1-alpha*A2;this.a0=1+alpha/A2;this.a1=-2*cs;this.a2=1-alpha/A2}lowshelf(A2,sn,cs,alpha,beta){this.b0=A2*(A2+1-(A2-1)*cs+beta*sn);this.b1=2*A2*(A2-1-(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn);this.a0=A2+1+(A2+1)*cs+beta*sn;this.a1=2*(A2-1+(A2+1)*cs);this.a2=A2+1+(A2-1)*cs-beta*sn}highshelf(A2,sn,cs,alpha,beta){this.b0=A2*(A2+1+(A2-1)*cs+beta*sn);this.b1=2*A2*(A2-1+(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn);this.a0=A2+1-(A2+1)*cs-beta*sn;this.a1=2*(A2-1-(A2+1)*cs);this.a2=A2+1-(A2-1)*cs-beta*sn}applyFilter(signal_step){let y2=this.b0*signal_step+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;this.x2=this.x1;this.x1=signal_step;this.y2=this.y1;this.y1=y2;return y2}zResult(freq){try{let phi=Math.pow(Math.sin(Math.PI*freq*2/(2*this.sps)),2);let result=(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*phi+16*this.b0*this.b2*phi*phi)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*phi+16*this.a2*phi*phi);return result}catch(err){return-200}}static calcCenterFrequency(freqStart,freqEnd){return(freqStart+freqEnd)/2}static calcBandwidth(freqStart,freqEnd){return freqEnd-this.calcCenterFrequency(freqStart,freqEnd)}static calcBandpassQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*Math.sqrt((frequency-bandwidth)*(frequency+bandwidth))/(2*bandwidth);return Q}static calcNotchQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*frequency*bandwidth/Math.sqrt((frequency-bandwidth)*(frequency+bandwidth));return Q}};var DCBlocker=class{constructor(r=.995){this.r=r;this.y1=this.y2=this.x1=this.x2=0}applyFilter(signal_step){this.x2=this.x1;this.x1=signal_step;let y2=this.x1-this.x2+this.r*this.y1;this.y2=this.y1;this.y1=y2;return y2}};var makeNotchFilter=(frequency,sps10,bandwidth)=>{return new Biquad("notch",frequency,sps10,Biquad.calcNotchQ(frequency,bandwidth),0)};var makeBandpassFilter=(freqStart,freqEnd,sps10,resonance=Math.pow(10,Math.floor(Math.log10(Biquad.calcCenterFrequency(freqStart,freqEnd)))))=>{return new Biquad("bandpass",Biquad.calcCenterFrequency(freqStart,freqEnd),sps10,Biquad.calcBandpassQ(Biquad.calcCenterFrequency(freqStart,freqEnd),Biquad.calcBandwidth(freqStart,freqEnd),resonance),0)};var defaultsetting1={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var ganglionFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting1)),"1":JSON.parse(JSON.stringify(defaultsetting1)),"2":JSON.parse(JSON.stringify(defaultsetting1)),"3":JSON.parse(JSON.stringify(defaultsetting1))};var defaultChartSetting7={nSec:10,sps:250,units:"mV"};var ganglionChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting7)),"1":JSON.parse(JSON.stringify(defaultChartSetting7)),"2":JSON.parse(JSON.stringify(defaultChartSetting7)),"3":JSON.parse(JSON.stringify(defaultChartSetting7)),"ax":{nSec:10,sps:250,units:"mg"},"ay":{nSec:10,sps:250,units:"mg"},"az":{nSec:10,sps:250,units:"mg"}},generateNewLines:true};var defaultsetting4={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var museFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting4)),"1":JSON.parse(JSON.stringify(defaultsetting4)),"2":JSON.parse(JSON.stringify(defaultsetting4)),"3":JSON.parse(JSON.stringify(defaultsetting4)),"4":JSON.parse(JSON.stringify(defaultsetting4))};var Devices={BLE:{"nrf5x":nrf5xBLESettings,"nrf5x_singleended":nrf5xBLESettings_singleended,"hegduino":hegduinoBLESettings,"hegduinoV1":hegduinoV1BLESettings,"cognixionONE":cognixionONEBLESettings,"statechanger":statechangerBLESettings,"blueberry":blueberryBLESettings,"blueberry2":blueberry2BLESettings,"heart_rate":heartRateBLESettings,"freeEEG16":freeeeg16BLESettings},USB:{"nrf5x":nrf5xSerialSettings,"nrf5x_singleended":nrf5xSerialSettings_singleended,"freeEEG16":freeeeg16SerialSettings,"freeEEG32":freeeeg32SerialSettings,"freeEEG32_optical":freeeeg32_optical_SerialSettings,"freeEEG128":freeeeg128SerialSettings,"hegduino":hegduinoSerialSettings,"hegduinoV1":hegduinoV1SerialSettings,"cyton":cytonSerialSettings,"cyton_daisy":daisycytonSerialSettings,"peanut":peanutSerialSettings,"statechanger":statechangerSerialSettings,"cognixionONE":cytonSerialSettings},BLE_CUSTOM:{},USB_CUSTOM:{},CUSTOM:{"simulator":simulatorSettings}};var textdecoder3=new TextDecoder;var decoders={"raw":data=>{if(data?.buffer)return Array.from(new Uint8Array(data));else return data},"utf8":data=>{return textdecoder3.decode(data)},"console-f12":data=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(data);return data},"debug":(data,debugmessage)=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(debugmessage,data);return data},"ads131m08":ads131m08codec,"arduino_ads131m08":ads131m08_arduinocodec,"max3010x":max3010xcodec,"mpu6050":mpu6050codec,"bme280":bme280codec,"freeeeg16":freeeeg16codec,"freeeeg32":freeeeg32codec,"freeeeg128":freeeeg128codec,"cyton":cytoncodec,"cognixionONE_BLE":cognixionONE_EEG_codec,"hegduino":hegduinocodec,"nrf5x":nrf5x_usbcodec,"peanut":peanutcodec,"statechanger":statechangercodec,"blueberry":blueberrycodec,"heart_rate":hrcodec};function parseFunctionFromText2(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs3(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs2}var stringifyFast2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p in value[prop]){if(Array.isArray(value[prop][p])){if(value[prop][p].length>20)obj[prop][p]=value[prop][p].slice(value[prop][p].length-20);else obj[prop][p]=value[prop][p]}else{if(value[prop][p]!=null){let con=value[prop][p].constructor.name;if(con.includes("Set")){obj[prop][p]=Array.from(value[prop][p])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p]="instanceof_"+con}else{obj[prop][p]=value[prop][p]}}else{obj[prop][p]=value[prop][p]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast3(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast2}function loadStreamWorkerGlobals(){globalThis.Devices=Devices;globalThis.WebSerial=WebSerial;globalThis.decoders=decoders;globalThis.decoder="raw";globalThis.ByteParser=ByteParser;globalThis.filtering=false;globalThis.filters={};globalThis.BiquadChannelFilterer=BiquadChannelFilterer;globalThis.ArrayManip=ArrayManip}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){loadStreamWorkerGlobals()}var streamWorkerRoutes={"transferDevice":function transferDevice(device,worker){let cpy=Object.assign({},device);for(const key in cpy){if(typeof cpy[key]==="function")cpy[key]=cpy[key].toString()}worker.send({route:"receiveDevice",args:cpy})},"receiveDevice":function receiveDevice(device){for(const key in device){if(typeof device[key]==="string"){let fn=parseFunctionFromText2(device[key]);if(typeof fn==="function"){device[key]=fn}}}if(!globalThis.Devices[device.deviceType])globalThis.Devices[device.deviceType]={};globalThis.Devices[device.deviceType][device.deviceName]=device},"receiveDecoder":function receiveDecoder(decoder2,decoderName){globalThis.decoders[decoderName]=(0,eval)("("+decoder2+")")},"receiveCodec":function receiveDeviceCodec(decoder2,deviceType,device,service,characteristic){let codec=parseFunctionFromText2(decoder2);if(codec){if(deviceType==="BLE"&&service&&characteristic){if(globalThis.Devices[deviceType][device]){if(globalThis.Devices[deviceType][device][service]){if(globalThis.Devices[deviceType][device][characteristic]){globalThis.Devices[deviceType][device][characteristic].codec=codec}else{globalThis.Devices[deviceType][device][characteristic]={codec}}}else{globalThis.Devices[deviceType][device]={[characteristic]:{codec}}}}}else if(globalThis.Devices[deviceType][device]?.codec){if(globalThis.Devices[deviceType][device])globalThis.Devices[deviceType][device].codec=codec;else{globalThis.Devices[deviceType][device]={codec}}}}},"decode":function decode(data){return globalThis.decoder(data)},"decodeAndParse":function decodeAndParse(data){let decoded=this.__node.graph.run("decode",data);if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}}}}return parsed}}return decoded},"setActiveDecoder":function setActiveDecoder(deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device]?.codec;else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device][service][characteristic].codec;return true},"decodeDevice":function decodeDevice(data,deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)return globalThis.Devices[deviceType][device].codec(data);else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)return globalThis.Devices[deviceType][device][service][characteristic].codec(data)},"decodeAndParseDevice":function decodeAndParseDevice(data,deviceType,deviceName,service,characteristic){let decoded;if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][deviceName]?.services[service]?.[characteristic]?.codec)decoded=globalThis.Devices[deviceType][deviceName].services[service][characteristic].codec(data);else if(globalThis.Devices[deviceType][deviceName]?.codec)decoded=globalThis.Devices[deviceType][deviceName].codec(data);else decoded=data;if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}else if(typeof parsed[prop]==="number"){parsed[prop]=filter.apply(parsed[prop])}}}}return parsed}}return decoded},"toggleAnim":function toggleAnim(){globalThis.runningAnim=!globalThis.runningAnim;return globalThis.runningAnim},"setFilters":function setFilters(filters,clearFilters=false){if(!globalThis.filters||clearFilters){globalThis.filters={};if(clearFilters)globalThis.filtering=false}if(filters){for(const key in filters){globalThis.filters[key]=new BiquadChannelFilterer(filters[key])}globalThis.filtering=true}return true},"getFilterSettings":function getFilterSettings(){if(globalThis.filters){let filters={};for(const key in globalThis.filters){filters[key]={sps:globalThis.filters[key].sps,useScaling:globalThis.filters[key].useScaling,scalar:globalThis.filters[key].scalar,useNotch50:globalThis.filters[key].useNotch50,useNotch60:globalThis.filters[key].useNotch60,useDCBlock:globalThis.filters[key].useDCBlock,useLowpass:globalThis.filters[key].useLowpass,lowpassHz:globalThis.filters[key].lowpassHz,useBandpass:globalThis.filters[key].useBandpass,bandpassLower:globalThis.filters[key].bandpassLower,bandpassUpper:globalThis.filters[key].bandpassUpper}}return filters}return void 0},"setupSerial":function setupSerial(){globalThis.Serial=new globalThis.WebSerial;globalThis.decoder="raw";console.log("worker: Setting up Serial",globalThis.Serial);return true},"openPort":function openPort(settings){const WorkerService2=this.__node.graph;if(!globalThis.Serial)WorkerService2.run("setupSerial");return new Promise((res,rej)=>{globalThis.Serial.getPorts().then(ports=>{const Serial=globalThis.Serial;let port=ports.find(port2=>{return port2.getInfo().usbVendorId===settings.usbVendorId&&port2.getInfo().usbProductId===settings.usbProductId});if(port){let options=Object.assign({},settings);if(typeof settings.pipeTo==="object"&&settings.pipeTo.extraArgs&&globalThis.Devices?.[settings.pipeTo.extraArgs[0]]?.[settings.pipeTo.extraArgs[1]]){options.onconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].onconnect;options.ondisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].ondisconnect;options.beforedisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].beforedisconnect}Serial.openPort(port,options).then(()=>{const stream=Serial.createStream({port,settings:options,frequency:settings.frequency?settings.frequency:10,buffering:settings.buffering,ondata:value=>{if(stream.settings.pipeTo){if(stream.settings.pipeMain){WorkerService2.transmit(value,void 0,[value.buffer])}if(typeof stream.settings.pipeTo==="string")WorkerService2.transmit(value,stream.settings.pipeTo,[value.buffer]);else if(stream.settings.pipeTo?.route){let args=value;if(stream.settings.pipeTo.extraArgs)args=[value,...stream.settings.pipeTo.extraArgs];WorkerService2.transmit({route:stream.settings.pipeTo.route,args},stream.settings.pipeTo._id,[value.buffer])}}else{WorkerService2.transmit(value,void 0,[value.buffer])}}});Serial.readStream(stream);port.ondisconnect=()=>{postMessage(\`\${stream._id} disconnected\`)};res({_id:stream._id,settings,info:stream.info})}).catch(()=>{postMessage(\`disconnected\`)});;}else{rej(false)}})})},"closeStream":function closeStream(streamId){return new Promise((res,rej)=>{const Serial=globalThis.Serial;let ondisconnect;if(Serial.streams[streamId].port?.ondisconnect)ondisconnect=Serial.streams[streamId].port.ondisconnect;Serial.closeStream(Serial.streams[streamId]).then(resolved=>{if(ondisconnect)ondisconnect(void 0);res(resolved)}).catch(rej)})},"writeStream":function writeStream(streamId,message){globalThis.Serial.writeStream(globalThis.Serial.streams[streamId],message);return true},"updateStreamSettings":function updateStreamSettings(streamId,settings){if(globalThis.Serial?.streams[streamId]){for(const key in settings){if(typeof settings[key]==="object"){Object.assign(globalThis.Serial.streams[streamId].settings[key],settings[key])}else globalThis.Serial.streams[streamId][key]=settings[key]}}}};if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){globalThis.Devices=Devices;const worker=new WorkerService({roots:{...workerCanvasRoutes,...remoteGraphRoutes,...streamWorkerRoutes}})}var stream_worker_default=self;})();
`,g3e=URL.createObjectURL(new globalThis.Blob([h3e],{type:"text/javascript"})),VZ=g3e;var Dh=class{constructor(){this.recursivelyAssign=(t,r)=>{for(let n in r)typeof r[n]=="object"?typeof t[n]=="object"?this.recursivelyAssign(t[n],r[n]):t[n]=this.recursivelyAssign({},r[n]):t[n]=r[n];return t}}static autoscale(t,r=0,n=1,i=!1,s,a,o){if(t?.length===0)return t;let l=a||Math.max(...t),c=s||Math.min(...t),f=1/n,u=1;if(i){let d=Math.max(Math.abs(c),Math.abs(l));return d!==0&&(u=f/d),t.map(p=>(o&&(p<c&&(p=c),p>l&&(p=l)),p*u+(f*(r+1)*2-1-f)))}else return l===c?l!==0?u=f/l:c!==0&&(u=f/Math.abs(c)):u=f/(l-c),t.map(d=>(o&&(d<c&&(d=c),d>l&&(d=l)),2*((d-c)*u-1/(2*n))+(f*(r+1)*2-1-f)))}static genTimestamps(t,r){let n=Date.now(),i=[n-t*1e3/r,n];return Dh.upsample(i,t)}static absmax(t){return Math.max(Math.abs(Math.min(...t)),Math.max(...t))}static downsample(t,r,n=1){if(t.length>r){let i=new Array(r),s=t.length/r,a=t.length-1,o=0,l=0;for(let c=s;c<t.length;c+=s){let f=Math.round(c);f>a&&(f=a);for(let u=o;u<f;u++)i[l]+=t[u];i[l]/=(f-o)*n,l++,o=f}return i}else return t}static upsample(t,r,n=1){var i=function(d,p,_){return(d+(p-d)*_)*n},s=new Array(r),a=(t.length-1)/(r-1);s[0]=t[0];for(var o=1;o<r-1;o++){var l=o*a,c=Math.floor(l),f=Math.ceil(l),u=l-c;s[o]=i(t[c],t[f],u)}return s[r-1]=t[t.length-1],s}static interpolate(t,r,n=1){return t.length>r?Dh.downsample(t,r,n):t.length<r?Dh.upsample(t,r,n):t}static HSLToRGB(t,r,n,i=255){r/=100,n/=100;let s=(1-Math.abs(2*n-1))*r,a=s*(1-Math.abs(t/60%2-1)),o=n-s/2,l=0,c=0,f=0;return 0<=t&&t<60?(l=s,c=a,f=0):60<=t&&t<120?(l=a,c=s,f=0):120<=t&&t<180?(l=0,c=s,f=a):180<=t&&t<240?(l=0,c=a,f=s):240<=t&&t<300?(l=a,c=0,f=s):300<=t&&t<360&&(l=s,c=0,f=a),l=(l+o)*i,c=(c+o)*i,f=(f+o)*i,[l,c,f]}static circularBuffer(t,r){if(r.length<t.length){let n=t.slice(r.length),i=t.length;t.splice(0,i,...n,...r)}else if(r.length>t.length){let n=t.length;t.splice(0,n,r.slice(n-r.length))}else t.splice(0,t.length,...r);return t}static reformatData(t,r){if(Array.isArray(t)){if(Array.isArray(t[0])){let n={};if(t.forEach((i,s)=>{n[s]=i}),t=n,isNaN(t[0][0]))return}else if(r){if(t={[r]:t},isNaN(t[r][0]))return}else if(t={0:t},isNaN(t[0][0]))return}else if(typeof t=="object"){for(let n in t)if(typeof t[n]=="number"?t[n]=[t[n]]:t[n]?.values&&typeof t[n].values=="number"&&(t[n].values=[t[n].values]),isNaN(t[n][0]))return}else if(typeof t=="string"){let n;if(t.includes(`\r
`)){let i=t.split(`\r
`);t={},i.forEach((s,a)=>{s.includes("	")?n=s.split("	"):s.includes(",")?n=s.split(","):s.includes("|")&&(n=s.split("|")),Array.isArray(n)&&n.forEach((o,l)=>{if(o.includes(":")){let[c,f]=o.split(":"),u=parseFloat(f);if(u)t[c]=[u];else return}else{let c=parseFloat(o);if(c)t[l]=[c];else return}})})}else t.includes("	")?n=t.split("	"):t.includes(",")?n=t.split(","):t.includes("|")&&(n=t.split("|"));t={},Array.isArray(n)&&n.forEach((i,s)=>{if(i.includes(":")){let[a,o]=i.split(":"),l=parseFloat(o);if(l)t[a]=[l];else return}else{let a=parseFloat(i);if(a)t[s]=[a];else return}})}else typeof t=="number"&&(r?t={[r]:[t]}:t={0:[t]});return t}static padTime(t,r,n,i){let s=(t[0]-r)/n/i;return[...new Array(i-t.length).map((o,l)=>r+s*(l+1)),...t]}static interpolateForTime(t,r,n){return Dh.interpolate(t,Math.ceil(n*r))}isTypedArray(t){return ArrayBuffer.isView(t)&&Object.prototype.toString.call(t)!=="[object DataView]"}spliceTypedArray(t,r,n){let i=t.subarray(0,r),s;n&&(s=t.subarray(n+1));let a;return(i.length>0||s?.length>0)&&(a=new t.constructor(i.length+s.length)),i.length>0&&a.set(i),s&&s.length>0&&a.set(s,i.length),a}},kf=Dh;kf.bufferValues=(t,r,n,i)=>{if(!Array.isArray(n)&&typeof n=="object"&&(n=Object.keys(n)),!i){let a=Object.keys(t);n?i=new Float32Array(a.length*n.length):typeof t[a[0]][r]=="object"?(n=Object.keys(t[a[0]][r]),i=new Float32Array(a.length*n.length)):i=new Float32Array(a.length)}let s=0;for(let a in t)if(t[a][r])if(n)for(let o=0;o<n.length;o++)i[s]=t[a][r][n[o]],s++;else i[s]=t[a][r],s++;return i};var y3e=/^([<>])?(([1-9]\d*)?([xcbB?hHiIfdsp]))*$/,m3e=/([1-9]\d*)?([xcbB?hHiIfdsp])/g,xL=(e,t,r)=>String.fromCharCode(...new Uint8Array(e.buffer,e.byteOffset+t,r)),kL=(e,t,r,n)=>new Uint8Array(e.buffer,e.byteOffset+t,r).set(n.split("").map(i=>i.charCodeAt(0))),b3e=(e,t,r)=>xL(e,t+1,Math.min(e.getUint8(t),r-1)),v3e=(e,t,r,n)=>{e.setUint8(t,n.length),kL(e,t+1,r-1,n)},_3e=e=>({x:t=>[1,t,0],c:t=>[t,1,r=>({u:n=>xL(n,r,1),p:(n,i)=>kL(n,r,1,i)})],"?":t=>[t,1,r=>({u:n=>!!n.getUint8(r),p:(n,i)=>n.setUint8(r,i)})],b:t=>[t,1,r=>({u:n=>n.getInt8(r),p:(n,i)=>n.setInt8(r,i)})],B:t=>[t,1,r=>({u:n=>n.getUint8(r),p:(n,i)=>n.setUint8(r,i)})],h:t=>[t,2,r=>({u:n=>n.getInt16(r,e),p:(n,i)=>n.setInt16(r,i,e)})],H:t=>[t,2,r=>({u:n=>n.getUint16(r,e),p:(n,i)=>n.setUint16(r,i,e)})],i:t=>[t,4,r=>({u:n=>n.getInt32(r,e),p:(n,i)=>n.setInt32(r,i,e)})],I:t=>[t,4,r=>({u:n=>n.getUint32(r,e),p:(n,i)=>n.setUint32(r,i,e)})],f:t=>[t,4,r=>({u:n=>n.getFloat32(r,e),p:(n,i)=>n.setFloat32(r,i,e)})],d:t=>[t,8,r=>({u:n=>n.getFloat64(r,e),p:(n,i)=>n.setFloat64(r,i,e)})],s:t=>[1,t,r=>({u:n=>xL(n,r,t),p:(n,i)=>kL(n,r,t,i.slice(0,t))})],p:t=>[1,t,r=>({u:n=>b3e(n,r,t),p:(n,i)=>v3e(n,r,t,i.slice(0,t-1))})]}),HZ=new RangeError("Structure larger than remaining buffer"),w3e=new RangeError("Not enough values for structure"),Ef=class extends kf{static toDataView(t){if(!(t instanceof DataView))if(typeof t=="string"&&parseInt(t)&&(t=parseInt(t)),typeof t=="string"){let r=new TextEncoder,n={};for(let s in Ef.codes)for(;t.indexOf(s)>-1;){let a=t.indexOf(s);t=t.replace(s,""),n[a]=s}let i=Array.from(r.encode(t));for(let s in n)i.splice(parseInt(s),0,Ef.codes[n[s]]);t=new DataView(new Uint8Array(i).buffer)}else if(typeof t=="number"){let r=t;t<256?(t=new DataView(new ArrayBuffer(1)),t.setUint8(0,r)):t<65536?(t=new DataView(new ArrayBuffer(2)),t.setInt16(0,r)):(t=new DataView(new ArrayBuffer(4)),t.setUint32(0,r))}else t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer?t=new DataView(t):Array.isArray(t)?t=new DataView(Uint8Array.from(t).buffer):typeof t=="object"&&(t=new TextEncoder().encode(JSON.stringify(t)));return t}static searchBuffer(t,r,n){for(var i=r,s=t,a=Ef.boyerMoore(i),o=a.byteLength,l=[],c=a(s);c!==-1&&(l.push(c),!(n&&l.length>=n));c=a(s,c+o));return l}static bytesToInt16(t,r){let n=(255&t)<<8|255&r;return(n&32768)>0?n|=4294901760:n&=65535,n}static bytesToUInt16(t,r){return t*256+r}static Uint16ToBytes(t){return[t&255,t>>8&255]}static bytesToInt24(t,r,n){let i=(255&t)<<16|(255&r)<<8|255&n;return(i&8388608)>0?i|=4278190080:i&=16777215,i}static bytesToUInt24(t,r,n){return t*65536+r*256+n}static Uint24ToBytes(t){return[t&255,t>>8&255,t>>16&255]}static bytesToInt32(t,r,n,i){let s=(255&t)<<24|(255&r)<<16|(255&n)<<8|255&i;return(s&2147483648)>0?s|=0:s&=4294967295,s}static bytesToUInt32(t,r,n,i){return t*16777216+r*65536+n*256+i}static Uint32ToBytes(t){return[t&255,t>>8&255,t>>16&255,t>>24&255]}static get2sCompliment(t,r){return t>4294967296?null:t<<32-r>>32-r}static getSignedInt(...t){let r=0;function n(i){for(var s=0,a=!0;i--;)if(a){let o=t[r++];s+=o&127,o&128&&(s-=128),a=!1}else s*=256,s+=t[r++];return s}return n(t.length)}static asUint8Array(t){if(t instanceof Uint8Array)return t;if(typeof t=="string"){for(var r=new Uint8Array(t.length),n=0;n<t.length;n++){var i=t.charCodeAt(n);if(i>127)throw new TypeError("Only ASCII patterns are supported");r[n]=i}return r}else return new Uint8Array(t)}static boyerMoore(t){var r=Ef.asUint8Array(t),n=r.length;if(n===0)throw new TypeError("patternBuffer must be at least 1 byte long");for(var i=256,s=new Int32Array(i),a=0;a<i;a++)s[a]=-1;for(var o=0;o<n;o++)s[r[o]]=o;var l=(c,f,u)=>{var d=Ef.asUint8Array(c);f===void 0&&(f=0),u===void 0&&(u=d.length);for(var p=r,_=s,w=u-p.length,k=p.length-1,S,O=f;O<=w;O+=S){S=0;for(var A=k;A>=0;A--){var C=d[O+A];if(p[A]!==C){S=Math.max(1,A-_[C]);break}}if(S===0)return O}return-1};return l.byteLength=r.byteLength,l}static struct(t){let r=[],n=0,i=y3e.exec(t);if(!i)throw new RangeError("Invalid format string");let s=_3e(i[1]==="<"),a=(d,p)=>s[p](d?parseInt(d,10):1);for(;i=m3e.exec(t);)((d,p,_)=>{for(let w=0;w<d;++w,n+=p)_&&r.push(_(n))})(...a(...i.slice(1)));let o=(d,p)=>{if(d.byteLength<(p|0)+n)throw HZ;let _=new DataView(d,p|0);return r.map(w=>w.u(_))},l=(d,p,..._)=>{if(_.length<r.length)throw w3e;if(d.byteLength<p+n)throw HZ;let w=new DataView(d,p);new Uint8Array(d,p,n).fill(0),r.forEach((k,S)=>k.p(w,_[S]))},c=(...d)=>{let p=new ArrayBuffer(n);return l(p,0,...d),p},f=d=>o(d,0);function*u(d){for(let p=0;p+n<=d.byteLength;p+=n)yield o(d,p)}return Object.freeze({unpack:f,pack:c,unpack_from:o,pack_into:l,iter_unpack:u,format:t,size:n})}},ze=Ef;ze.codes={"\\n":10,"\\r":13,"\\t":9,"\\s":32,"\\b":8,"\\f":12,"\\":92};var WZ;(function(e){e[e.SCAN_MODE_LOW_POWER=0]="SCAN_MODE_LOW_POWER",e[e.SCAN_MODE_BALANCED=1]="SCAN_MODE_BALANCED",e[e.SCAN_MODE_LOW_LATENCY=2]="SCAN_MODE_LOW_LATENCY"})(WZ||(WZ={}));var JZ;(function(e){e[e.CONNECTION_PRIORITY_BALANCED=0]="CONNECTION_PRIORITY_BALANCED",e[e.CONNECTION_PRIORITY_HIGH=1]="CONNECTION_PRIORITY_HIGH",e[e.CONNECTION_PRIORITY_LOW_POWER=2]="CONNECTION_PRIORITY_LOW_POWER"})(JZ||(JZ={}));tx();nx();tx();var Rt=ex("BluetoothLe",{web:()=>Promise.resolve().then(()=>(tQ(),eQ)).then(e=>new e.BluetoothLeWeb)});var F3e=()=>{let e=Promise.resolve();return t=>new Promise((r,n)=>{e=e.then(()=>t()).then(r).catch(n)})};function ix(e){return e?F3e():t=>t()}function Sn(e){if(typeof e!="string")throw new Error(`Invalid UUID type ${typeof e}. Expected string.`);if(e=e.toLowerCase(),!(e.search(/^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$/)>=0))throw new Error(`Invalid UUID format ${e}. Expected 128 bit string (e.g. "0000180d-0000-1000-8000-00805f9b34fb").`);return e}var CL=class{constructor(){this.scanListener=null,this.eventListeners=new Map,this.queue=ix(!0)}enableQueue(){this.queue=ix(!0)}disableQueue(){this.queue=ix(!1)}async initialize(t){await this.queue(async()=>{await Rt.initialize(t)})}async isEnabled(){return await this.queue(async()=>(await Rt.isEnabled()).value)}async enable(){await this.queue(async()=>{await Rt.enable()})}async disable(){await this.queue(async()=>{await Rt.disable()})}async startEnabledNotifications(t){await this.queue(async()=>{var r;let n="onEnabledChanged";await((r=this.eventListeners.get(n))===null||r===void 0?void 0:r.remove());let i=await Rt.addListener(n,s=>{t(s.value)});this.eventListeners.set(n,i),await Rt.startEnabledNotifications()})}async stopEnabledNotifications(){await this.queue(async()=>{var t;let r="onEnabledChanged";await((t=this.eventListeners.get(r))===null||t===void 0?void 0:t.remove()),this.eventListeners.delete(r),await Rt.stopEnabledNotifications()})}async isLocationEnabled(){return await this.queue(async()=>(await Rt.isLocationEnabled()).value)}async openLocationSettings(){await this.queue(async()=>{await Rt.openLocationSettings()})}async openBluetoothSettings(){await this.queue(async()=>{await Rt.openBluetoothSettings()})}async openAppSettings(){await this.queue(async()=>{await Rt.openAppSettings()})}async setDisplayStrings(t){await this.queue(async()=>{await Rt.setDisplayStrings(t)})}async requestDevice(t){return t=t?this.validateRequestBleDeviceOptions(t):void 0,await this.queue(async()=>await Rt.requestDevice(t))}async requestLEScan(t,r){t=this.validateRequestBleDeviceOptions(t),await this.queue(async()=>{var n;await((n=this.scanListener)===null||n===void 0?void 0:n.remove()),this.scanListener=await Rt.addListener("onScanResult",i=>{let s=Object.assign(Object.assign({},i),{manufacturerData:this.convertObject(i.manufacturerData),serviceData:this.convertObject(i.serviceData),rawAdvertisement:i.rawAdvertisement?this.convertValue(i.rawAdvertisement):void 0});r(s)}),await Rt.requestLEScan(t)})}async stopLEScan(){await this.queue(async()=>{var t;await((t=this.scanListener)===null||t===void 0?void 0:t.remove()),this.scanListener=null,await Rt.stopLEScan()})}async getDevices(t){if(!Array.isArray(t))throw new Error("deviceIds must be an array");return this.queue(async()=>(await Rt.getDevices({deviceIds:t})).devices)}async getConnectedDevices(t){if(!Array.isArray(t))throw new Error("services must be an array");return t=t.map(Sn),this.queue(async()=>(await Rt.getConnectedDevices({services:t})).devices)}async connect(t,r,n){await this.queue(async()=>{var i;if(r){let s=`disconnected|${t}`;await((i=this.eventListeners.get(s))===null||i===void 0?void 0:i.remove());let a=await Rt.addListener(s,()=>{r(t)});this.eventListeners.set(s,a)}await Rt.connect(Object.assign({deviceId:t},n))})}async createBond(t){await this.queue(async()=>{await Rt.createBond({deviceId:t})})}async isBonded(t){return await this.queue(async()=>(await Rt.isBonded({deviceId:t})).value)}async disconnect(t){await this.queue(async()=>{await Rt.disconnect({deviceId:t})})}async getServices(t){return await this.queue(async()=>(await Rt.getServices({deviceId:t})).services)}async discoverServices(t){await this.queue(async()=>{await Rt.discoverServices({deviceId:t})})}async getMtu(t){return await this.queue(async()=>(await Rt.getMtu({deviceId:t})).value)}async requestConnectionPriority(t,r){await this.queue(async()=>{await Rt.requestConnectionPriority({deviceId:t,connectionPriority:r})})}async readRssi(t){return await this.queue(async()=>{let n=await Rt.readRssi({deviceId:t});return parseFloat(n.value)})}async read(t,r,n,i){return r=Sn(r),n=Sn(n),await this.queue(async()=>{let a=await Rt.read(Object.assign({deviceId:t,service:r,characteristic:n},i));return this.convertValue(a.value)})}async write(t,r,n,i,s){return r=Sn(r),n=Sn(n),this.queue(async()=>{if(!i?.buffer)throw new Error("Invalid data.");let a=i;Tc.getPlatform()!=="web"&&(a=rx(i)),await Rt.write(Object.assign({deviceId:t,service:r,characteristic:n,value:a},s))})}async writeWithoutResponse(t,r,n,i,s){r=Sn(r),n=Sn(n),await this.queue(async()=>{if(!i?.buffer)throw new Error("Invalid data.");let a=i;Tc.getPlatform()!=="web"&&(a=rx(i)),await Rt.writeWithoutResponse(Object.assign({deviceId:t,service:r,characteristic:n,value:a},s))})}async readDescriptor(t,r,n,i,s){return r=Sn(r),n=Sn(n),i=Sn(i),await this.queue(async()=>{let o=await Rt.readDescriptor(Object.assign({deviceId:t,service:r,characteristic:n,descriptor:i},s));return this.convertValue(o.value)})}async writeDescriptor(t,r,n,i,s,a){return r=Sn(r),n=Sn(n),i=Sn(i),this.queue(async()=>{if(!s?.buffer)throw new Error("Invalid data.");let o=s;Tc.getPlatform()!=="web"&&(o=rx(s)),await Rt.writeDescriptor(Object.assign({deviceId:t,service:r,characteristic:n,descriptor:i,value:o},a))})}async startNotifications(t,r,n,i){r=Sn(r),n=Sn(n),await this.queue(async()=>{var s;let a=`notification|${t}|${r}|${n}`;await((s=this.eventListeners.get(a))===null||s===void 0?void 0:s.remove());let o=await Rt.addListener(a,l=>{i(this.convertValue(l?.value))});this.eventListeners.set(a,o),await Rt.startNotifications({deviceId:t,service:r,characteristic:n})})}async stopNotifications(t,r,n){r=Sn(r),n=Sn(n),await this.queue(async()=>{var i;let s=`notification|${t}|${r}|${n}`;await((i=this.eventListeners.get(s))===null||i===void 0?void 0:i.remove()),this.eventListeners.delete(s),await Rt.stopNotifications({deviceId:t,service:r,characteristic:n})})}validateRequestBleDeviceOptions(t){return t.services&&(t.services=t.services.map(Sn)),t.optionalServices&&(t.optionalServices=t.optionalServices.map(Sn)),t}convertValue(t){return typeof t=="string"?Mh(t):t===void 0?new DataView(new ArrayBuffer(0)):t}convertObject(t){if(t===void 0)return;let r={};for(let n of Object.keys(t))r[n]=this.convertValue(t[n]);return r}},rQ=new CL;nx();var Cc=class extends ze{constructor(r,n){super();this.client=rQ;this.devices={};this.location=!1;this.initialized=!1;this.setupDevice=(r,n)=>new Promise(async(i,s)=>{this.devices[r.deviceId]={device:r,deviceId:r.deviceId,...n},this.client.connect(r.deviceId,a=>{this.devices[r.deviceId]?.ondisconnect&&this.devices[r.deviceId].ondisconnect(a)},n?.connectOptions).then(async()=>{let a=await this.getServices(r.deviceId);for(let o in n?.services){n?.services[o].UUID&&(o=n?.services[o].UUID);let l=a.find(c=>{if(c.uuid===o)return!0});if(l)for(let c in n.services[o]){if(n.services[o][c].characteristic&&(c=n.services[o][c].characteristic),!l.characteristics.find(u=>{if(u.uuid===c)return!0}))continue;let f=n.services[o][c];f.write&&await this.write(r,o,c,f.write,f.writeCallback,f.writeOptions),f.read&&await this.read(r,o,c,f.readCallback,f.readOptions),f.notify&&f.notifyCallback&&(await this.subscribe(r,o,c,f.notifyCallback),f.notifying=!0)}}}).catch(s),i(this.devices[r.deviceId])});this.triangulate=(r,n=1500,i=60)=>new Promise((s,a)=>{if("Accelerometer"in globalThis){if(typeof globalThis.Accelerometer=="function"){let o=new globalThis.Accelerometer({frequency:i}),l=performance.now(),c=l,f={samples:[],vector:{}},u=()=>{if(c-l<n)this.readRssi(r).then(d=>{let p=o.x,_=o.y,w=o.z;c=performance.now(),f.samples.push({x:p,y:_,z:w,rssi:d,timestamp:c})});else{let d={x:0,y:0,z:0,rssiAvg:0};f.samples.forEach(p=>{}),o.removeEventListener("reading",u)}};o.addEventListener("reading",u)}}else a(new Error("No Accelerometer API detected"))});n&&(this.location=n),r&&this.setup(r)}setup(r,n=this.location){let i=[];if(r)for(let a in r.services)r.services[a].UUID&&(a=r.services[a].UUID),i.push(a);let s={};return n||(s.androidNeverForLocation=!1),new Promise(async(a,o)=>{if(this.initialized||(await this.client.initialize(s),this.initialized=!0),r?.deviceId)a(await this.reconnect(r.deviceId));else if(r){let l=Array.from(Object.keys(r.services)),c={};this.isMobile()||(c.optionalServices=l),r.name&&(c.name=r.name),r.namePrefix&&(c.namePrefix=r.namePrefix),this.client.requestDevice(c).then(f=>{a(this.setupDevice(f,r))}).catch(o)}else this.client.requestDevice().then(l=>{a(this.setupDevice(l,r))}).catch(o)})}initialize(r){return new Promise((n,i)=>{this.client.initialize(r).then(()=>{n(!0)}).catch(i)})}requestDevice(r,n){return new Promise((i,s)=>{this.client.requestDevice(r).then(a=>{this.devices[a.deviceId]={device:a,deviceId:a.deviceId,...n},i(a)}).catch(s)})}getServices(r){return this.client.getServices(r)}connect(r,n){return new Promise((i,s)=>{this.client.connect(r.deviceId,a=>{n?.ondisconnect&&n.ondisconnect(a)},n?.connectOptions).then(a=>{i(r)}).catch(s)})}reconnect(r,n){return new Promise((i,s)=>{let a=n;this.devices[r]&&(a=Object.assign(Object.assign({},this.devices[r]),a)),a?.deviceId&&delete a.deviceId,this.client.getDevices([r]).then(o=>{this.setupDevice(o[0],a).then(l=>{i(l)})}).catch(s)})}disconnect(r){if(typeof r=="object"&&r?.deviceId&&(r=r.deviceId),typeof r=="string"){let n=this.devices[r];return n.beforedisconnect&&n.beforedisconnect(this,n),delete this.devices[r],this.client.disconnect(r)}}write(r,n,i,s,a,o){return typeof r=="object"&&(r=r.deviceId),a?this.client.write(r,n,i,Cc.toDataView(s)).then(a):this.client.writeWithoutResponse(r,n,i,Cc.toDataView(s),o)}read(r,n,i,s,a){return typeof r=="object"&&(r=r.deviceId),s?this.client.read(r,n,i,a).then(s):this.client.read(r,n,i,a)}subscribe(r,n,i,s){return typeof r=="object"&&(r=r.deviceId),this.client.startNotifications(r,n,i,s)}unsubscribe(r,n,i){return typeof r=="object"&&(r=r.deviceId),this.client.stopNotifications(r,n,i)}scan(r,n){return this.client.requestLEScan(r,n)}stopScanning(){return this.client.stopLEScan()}readDescriptor(r,n,i,s,a){return this.client.readDescriptor(r.deviceId,n,i,s,a)}writeDescriptor(r,n,i,s,a,o){return this.client.writeDescriptor(r.deviceId,n,i,s,Cc.toDataView(a),o)}readRssi(r){return this.client.readRssi(r.deviceId)}isMobile(){let r=!1;return function(n){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4)))&&(r=!0)}(navigator.userAgent||navigator.vendor||window.opera),r}isAndroid(){return navigator.userAgent.toLowerCase().indexOf("android")>-1}async distance(r,n,i,s,a){let o=await this.readRssi(r);if(o==0)return;let l=o/n;return l<1?Math.pow(l,10):i*Math.pow(l,s)+a}async distanceFromPhone(r,n,i){let s,a,o;return i&&(i==="nexus5"?(s=.42093,a=6.9476,o=.54992):i==="motoX"?(s=.9401940951,a=6.170094565,o=0):i==="iphone5"&&(s=.89976,a=7.7095,o=.111)),await this.distance(r,n,s,a,o)}};(function(e){var t,r={},n=console,i=Math,s="postMessage",a="HackTimer.js by turuslan: ",o="Initialisation failed",l=0,c="hasOwnProperty",f=[].slice,u=Worker;function d(){do l=2147483647>l?l+1:0;while(r[c](l));return l}if(!/MSIE 10/i.test(navigator.userAgent))try{e=URL.createObjectURL(new Blob(["var f={},p=postMessage,r='hasOwnProperty';onmessage=function(e){var d=e.data,i=d.i,t=d[r]('t')?d.t:0;switch(d.n){case'a':f[i]=setInterval(function(){p(i)},t);break;case'b':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case'c':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case'd':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch{}if(typeof u<"u")try{t=new u(e),setInterval=function(p,_){var w=d();return r[w]={c:p,p:f.call(arguments,2)},t[s]({n:"a",i:w,t:_}),w},clearInterval=function(p){r[c](p)&&(delete r[p],t[s]({n:"b",i:p}))},setTimeout=function(p,_){var w=d();return r[w]={c:p,p:f.call(arguments,2),t:!0},t[s]({n:"c",i:w,t:_}),w},clearTimeout=function(p){r[c](p)&&(delete r[p],t[s]({n:"d",i:p}))},t.onmessage=function(p){var _=p.data,w,k;if(r[c](_)&&(k=r[_],w=k.c,k[c]("t")&&delete r[_]),typeof w=="string")try{w=new Function(w)}catch(S){n.log(a+"Error parsing callback code string: ",S)}typeof w=="function"&&w.apply(globalThis,k.p)},t.onerror=function(p){n.log(p)}}catch(p){n.log(a+o),n.error(p)}else n.log(a+o+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js");var Ta=class extends ze{constructor(){super(...arguments);this.streams={};this.createStream=r=>{let n={_id:r._id?r._id:`stream${Math.floor(Math.random()*1e15)}`,info:r.port.getInfo(),running:!1,...r};return r.port?.readable&&(r.transforms?n.reader=Ta.setStreamTransforms(r.port.readable,r.transforms).getReader():n.reader=r.port.readable.getReader()),this.streams[n._id]=n,n}}getPorts(){return navigator.serial.getPorts()}requestPort(r,n){let i={};return r&&(i.usbVendorId=r),n&&(i.usbProductId=n),i.usbVendorId?navigator.serial.requestPort({filters:[i]}):navigator.serial.requestPort()}openPort(r,n){return n&&(n=Object.assign({},n)),n?.ondisconnect&&(r.ondisconnect=n.ondisconnect,delete n.ondisconnect),r.open(n).then(()=>{n?.onconnect&&n.onconnect(r)})}async readWithTimeout(r,n){let i=r.readable.getReader(),s=setTimeout(()=>{i.releaseLock()},n),a=await i.read();return clearTimeout(s),i.releaseLock(),a}async writePort(r,n){let i=r.writable.getWriter();return await i.write(Ta.toDataView(n)),i.releaseLock(),!0}getSignals(r){return r.getSignals()}setSignals(r,n){return r.setSignals(n)}readStream(r){if(r.reader&&!r.running){let n=r.reader;r.buffering&&(typeof r.buffering!="object"&&(r.buffering={}),r.buffering.buffer||(r.buffering.buffer=[]),r.buffering.searchBytes||(r.buffering.searchBytes=new Uint8Array([13,10])));let i=()=>{if(r.port.readable&&r.running)n.read().then(s=>{if(s.done)n.releaseLock();else{if(r.buffering){r.buffering.buffer.push(...s.value);let o=r.buffering.searchBytes,l=r.buffering.buffer,c=Ta.boyerMoore(o),f=c.byteLength,u=-1,d=r.buffering.lockIdx??0;for(var a=c(l);a!==-1;a=c(l,a+f))if(!r.buffering.locked&&!("lockIdx"in r.buffering))d=r.buffering.lockIdx=a;else if(u=a,u>=0){let p=u-d;if(r.buffering.locked){if(p>0){let _=r.buffering.buffer.splice(r.buffering.lockIdx,p),w=new Uint8Array(_.slice(r.buffering.searchBytes.length));r.ondata(new Uint8Array(w))}}else{let _=r.buffering.buffer.splice(r.buffering.lockIdx,p),w=new Uint8Array(_.slice(r.buffering.searchBytes.length));r.ondata(w),r.buffering.locked=!0}d=u}}else r.ondata(s.value);setTimeout(()=>{i()},r.frequency)}}).catch(s=>{console.error(r._id," Read error:",s),(s.message.includes("overrun")||s.message.includes("framing"))&&(delete r.reader,this.reconnect(r))});else if(!r.running&&r.port.readable)try{n.releaseLock()}catch(s){console.error(s)}};return r.running=!0,i(),r}}writeStream(r,n){if(typeof r=="string"&&(r=this.streams[r]),r.port.writable){let i=r.port.writable.getWriter();return i.write(Ta.toDataView(n)),i.releaseLock(),!0}}closeStream(r,n){return typeof r=="string"&&(r=this.streams[r]),r.running=!1,new Promise((i,s)=>{r.settings.beforedisconnect&&r.settings.beforedisconnect(this,r.port),setTimeout(async()=>{if(r.port.readable&&r.reader){try{r.reader.releaseLock()}catch(a){console.error(a)}if(r.transforms)try{await r.reader.cancel()}catch(a){console.error(a)}}try{await r.port.close().then(()=>{n&&n(this.streams[r._id])}),delete this.streams[r._id],i(!0)}catch(a){s(a)}},300)})}reconnect(r,n){return typeof r=="string"&&(r=this.streams[r]),new Promise((i,s)=>{if(typeof r!="object"){s(void 0);return}let a=r.port.getInfo();this.closeStream(r._id).then(o=>{setTimeout(()=>{this.getPorts().then(l=>{for(let c=0;c<l.length;c++)l[c].getInfo().usbVendorId===a.usbVendorId&&l[c].getInfo().usbProductId===a.usbProductId&&(n?n._id=r._id:n=r,delete n.port,this.openPort(l[c],n.settings).then(()=>{let f=this.createStream({...n,port:l[c]});this.readStream(f),i(f)}).catch(s))}).catch(s)},100)})})}static setStreamTransforms(r,n){let i=[];Object.keys(n).forEach(a=>{let o=n[a];if(o instanceof TransformStream)i.push(o);else{o.start||(o.start=function(){}),o.flush||(o.flush=function(){});let l=new TransformStream({start:o.start,transform:o.transform,flush:o.flush},o.writableStrategy,o.readableStrategy);i.push(l)}});let s=r;return i.forEach(a=>{s=s.pipeThrough(a)}),s}};var nQ=250,iQ=32,IL=24,sQ=1.2,Ic=Math.pow(2,24)/2;function dl(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let n=0;n<9;n++){let i=n*25;r[0][n]=ze.bytesToInt24(t[i],t[i+1],t[i+2]),r[1][n]=ze.bytesToInt24(t[i+3],t[i+4],t[i+5]),r[2][n]=ze.bytesToInt24(t[i+6],t[i+7],t[i+8]),r[3][n]=ze.bytesToInt24(t[i+9],t[i+10],t[i+11]),r[4][n]=ze.bytesToInt24(t[i+12],t[i+13],t[i+14]),r[5][n]=ze.bytesToInt24(t[i+15],t[i+16],t[i+17]),r[6][n]=ze.bytesToInt24(t[i+18],t[i+19],t[i+20]),r[7][n]=ze.bytesToInt24(t[i+21],t[i+22],t[i+23])}return t.length>225&&(r.leds=t.slice(225)),r}function sv(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let n=0;n<9;n++){let i=n*25;r[0][n]=ze.bytesToInt24(t[i],t[i+1],t[i+2])+Ic,r[1][n]=ze.bytesToInt24(t[i+3],t[i+4],t[i+5])+Ic,r[2][n]=ze.bytesToInt24(t[i+6],t[i+7],t[i+8])+Ic,r[3][n]=ze.bytesToInt24(t[i+9],t[i+10],t[i+11])+Ic,r[4][n]=ze.bytesToInt24(t[i+12],t[i+13],t[i+14])+Ic,r[5][n]=ze.bytesToInt24(t[i+15],t[i+16],t[i+17])+Ic,r[6][n]=ze.bytesToInt24(t[i+18],t[i+19],t[i+20])+Ic,r[7][n]=ze.bytesToInt24(t[i+21],t[i+22],t[i+23])+Ic}return t.length>225&&(r.leds=t.slice(225)),r}var D3e=new TextDecoder;function aQ(e){let t=D3e.decode(e),r;return t.includes("|")?r=t.split("|"):r.includes(",")?r=t.split(","):r=t.split("	"),{0:parseInt(r[0]),1:parseInt(r[1]),2:parseInt(r[2]),3:parseInt(r[3]),4:parseInt(r[4]),5:parseInt(r[5]),6:parseInt(r[6]),7:parseInt(r[7]),timestamp:Date.now()}}var Nc={nSec:10,sps:nQ,units:"mV"},j3e={lines:{0:JSON.parse(JSON.stringify(Nc)),1:JSON.parse(JSON.stringify(Nc)),2:JSON.parse(JSON.stringify(Nc)),3:JSON.parse(JSON.stringify(Nc)),4:JSON.parse(JSON.stringify(Nc)),5:JSON.parse(JSON.stringify(Nc)),6:JSON.parse(JSON.stringify(Nc)),7:JSON.parse(JSON.stringify(Nc))}},Pc={sps:nQ,useDCBlock:!1,useBandpass:!1,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:.96*1e3*sQ/(iQ*(Math.pow(2,IL)-1))},tQe=.96*1e3*sQ/(iQ*(Math.pow(2,IL)-1))*(Math.pow(2,IL)-1)*.5,av={0:JSON.parse(JSON.stringify(Pc)),1:JSON.parse(JSON.stringify(Pc)),2:JSON.parse(JSON.stringify(Pc)),3:JSON.parse(JSON.stringify(Pc)),4:JSON.parse(JSON.stringify(Pc)),5:JSON.parse(JSON.stringify(Pc)),6:JSON.parse(JSON.stringify(Pc)),7:JSON.parse(JSON.stringify(Pc))};var NL=.002/Math.pow(2,4),oQ=(e,t,r=8)=>{let n=r*3+1,i=(a,o)=>a+o;e.slice(n).reduce(i,0)!==0&&(t.ax=NL*ze.bytesToInt16(e[n],e[n+1]),t.ay=NL*ze.bytesToInt16(e[n+2],e[n+3]),t.az=NL*ze.bytesToInt16(e[n+4],e[n+5]))};function LL(e){let t;e.buffer?t=e:t=new Uint8Array(e);let r={};for(let n=0;n<8;n++){let i=1+3*n;r[n]=ze.bytesToInt24(t[i],t[i+1],t[i+2])}return oQ(t,r),r.timestamp=Date.now(),r}function B3e(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let n=0;n<8;n++){let i=1+3*n;t[0]%2===0?r[n+7]=ze.bytesToInt24(t[i],t[i+1],t[i+2]):r[n]=ze.bytesToInt24(t[i],t[i+1],t[i+2])}return oQ(t,r),r}var ov=250,lv={deviceType:"USB",deviceName:"cyton",baudRate:115200,codec:LL,write:"b",beforedisconnect:(e,t)=>{e.writePort(t,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:ov},lQ={deviceType:"USB",deviceName:"cyton_daisy",baudRate:115200,codec:B3e,write:"b",beforedisconnect:(e,t)=>{e.writePort(t,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:ov},Lc={nSec:10,sps:ov,units:"mV"},PL={nSec:10,sps:ov},M3e={lines:{0:JSON.parse(JSON.stringify(Lc)),1:JSON.parse(JSON.stringify(Lc)),2:JSON.parse(JSON.stringify(Lc)),3:JSON.parse(JSON.stringify(Lc)),4:JSON.parse(JSON.stringify(Lc)),5:JSON.parse(JSON.stringify(Lc)),6:JSON.parse(JSON.stringify(Lc)),7:JSON.parse(JSON.stringify(Lc)),ax:JSON.parse(JSON.stringify(PL)),ay:JSON.parse(JSON.stringify(PL)),az:JSON.parse(JSON.stringify(PL))},generateNewLines:!0},bi={sps:ov,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))},R3e={0:JSON.parse(JSON.stringify(bi)),1:JSON.parse(JSON.stringify(bi)),2:JSON.parse(JSON.stringify(bi)),3:JSON.parse(JSON.stringify(bi)),4:JSON.parse(JSON.stringify(bi)),5:JSON.parse(JSON.stringify(bi)),6:JSON.parse(JSON.stringify(bi)),7:JSON.parse(JSON.stringify(bi)),8:JSON.parse(JSON.stringify(bi)),9:JSON.parse(JSON.stringify(bi)),10:JSON.parse(JSON.stringify(bi)),11:JSON.parse(JSON.stringify(bi)),12:JSON.parse(JSON.stringify(bi)),13:JSON.parse(JSON.stringify(bi)),14:JSON.parse(JSON.stringify(bi)),15:JSON.parse(JSON.stringify(bi))};function FL(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let i=0;i<128;i++){let s=i*3+1;r[i]=ze.bytesToInt24(t[s],t[s+1],t[s+2])}let n=385;return r.ax=ze.bytesToInt16(t[n],t[n+1]),r.ay=ze.bytesToInt16(t[n+2],t[n+3]),r.az=ze.bytesToInt16(t[n+4],t[n+5]),r.gx=ze.bytesToInt16(t[n+6],t[n+7]),r.gy=ze.bytesToInt16(t[n+8],t[n+9]),r.gz=ze.bytesToInt16(t[n+10],t[n+11]),r.timestamp=Date.now(),r}var Fc=250,cQ={deviceType:"USB",deviceName:"freeeeg128",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:FL,sps:Fc,buffering:{searchBytes:new Uint8Array([192,160])}},uQ={lines:{ax:{nSec:10,sps:Fc},ay:{nSec:10,sps:Fc},az:{nSec:10,sps:Fc},gx:{nSec:10,sps:Fc},gy:{nSec:10,sps:Fc},gz:{nSec:10,sps:Fc}}},fQ={};for(let e=0;e<128;e++)uQ.lines[e]={sps:Fc,nSec:10,units:"mV"},fQ[e]={sps:250,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))};function sx(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let i=0;i<32;i++){let s=i*3+1;r[i]=ze.bytesToInt24(t[s],t[s+1],t[s+2])}let n=97;return r.ax=ze.bytesToInt16(t[n],t[n+1]),r.ay=ze.bytesToInt16(t[n+2],t[n+3]),r.az=ze.bytesToInt16(t[n+4],t[n+5]),r.gx=ze.bytesToInt16(t[n+6],t[n+7]),r.gy=ze.bytesToInt16(t[n+8],t[n+9]),r.gz=ze.bytesToInt16(t[n+10],t[n+11]),r.timestamp=Date.now(),r}var cv=512,dQ={deviceType:"USB",deviceName:"freeeeg32",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:sx,sps:cv,buffering:{searchBytes:new Uint8Array([192,160])}},pQ={deviceType:"USB",deviceName:"freeeeg32_optical",baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:sx,sps:cv,buffering:{searchBytes:new Uint8Array([192,160])}},Rh={nSec:10,sps:cv},hQ={lines:{ax:JSON.parse(JSON.stringify(Rh)),ay:JSON.parse(JSON.stringify(Rh)),az:JSON.parse(JSON.stringify(Rh)),gx:JSON.parse(JSON.stringify(Rh)),gy:JSON.parse(JSON.stringify(Rh)),gz:JSON.parse(JSON.stringify(Rh))}},gQ={};for(let e=0;e<32;e++)hQ.lines[e]={sps:cv,nSec:10,units:"mV"},gQ[e]={sps:cv,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))};function DL(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};for(let i=0;i<16;i++){let s=i*3+1;r[i]=ze.bytesToInt24(t[s],t[s+1],t[s+2])}let n=16*3+1;return r.ax=ze.bytesToInt16(t[n],t[n+1]),r.ay=ze.bytesToInt16(t[n+2],t[n+3]),r.az=ze.bytesToInt16(t[n+4],t[n+5]),r.gx=ze.bytesToInt16(t[n+6],t[n+7]),r.gy=ze.bytesToInt16(t[n+8],t[n+9]),r.gz=ze.bytesToInt16(t[n+10],t[n+11]),r.timestamp=Date.now(),r}var ax=[],yQ,$h;function $3e(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e),ax.push(...e);let r=new Uint8Array([192,160]),n=ax,i=ze.boyerMoore(r),s=i.byteLength,a=-1,o=$h??0,l=!1;for(var c=i(n);c!==-1;c=i(n,c+s))if(!yQ&&typeof $h!="number")o=$h=c;else if(a=c,a>=0){let f=a-o;if($h){if(f>0){let u=ax.splice($h,f);t=new Uint8Array(u.slice(r.length)),l=!0}}else{let u=ax.splice($h,f);t=new Uint8Array(u.slice(r.length)),l=!0,yQ=!0}o=a}if(l){let f={};for(let d=0;d<16;d++){let p=d*3+1;f[d]=ze.bytesToInt24(t[p],t[p+1],t[p+2])}let u=16*3+1;return f.ax=ze.bytesToInt16(t[u],t[u+1]),f.ay=ze.bytesToInt16(t[u+2],t[u+3]),f.az=ze.bytesToInt16(t[u+4],t[u+5]),f.gx=ze.bytesToInt16(t[u+6],t[u+7]),f.gy=ze.bytesToInt16(t[u+8],t[u+9]),f.gz=ze.bytesToInt16(t[u+10],t[u+11]),f.timestamp=Date.now(),f}else return}var uv=250,mQ={deviceType:"BLE",deviceName:"freeeeg16",services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:void 0},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:!0,notifyCallback:void 0,codec:$3e,sps:uv}}}},bQ={deviceType:"USB",deviceName:"freeeeg16",baudRate:115200,bufferSize:2e3,frequency:3.5,codec:DL,sps:uv,buffering:{searchBytes:new Uint8Array([192,160])}},Uh={nSec:10,sps:uv},vQ={lines:{ax:JSON.parse(JSON.stringify(Uh)),ay:JSON.parse(JSON.stringify(Uh)),az:JSON.parse(JSON.stringify(Uh)),gx:JSON.parse(JSON.stringify(Uh)),gy:JSON.parse(JSON.stringify(Uh)),gz:JSON.parse(JSON.stringify(Uh))}},_Q={},U3e=32,z3e=24,q3e=1.2;for(let e=0;e<16;e++)vQ.lines[e]={sps:uv,nSec:10,units:"mV"},_Q[e]={sps:uv,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:.96*1e3*q3e/(U3e*(Math.pow(2,z3e)-1))};var V3e=new TextDecoder;function ox(e){let t={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0},r=V3e.decode(e),n=r.split("|");if(n.length===3)t.timestamp=Date.now(),t.red=parseInt(n[0]),t.infrared=parseInt(n[1]),t.heg=parseFloat(n[2]);else return n.length>=2?(t.timestamp=Date.now(),t.red=parseInt(n[1]),t.infrared=parseInt(n[2]),t.heg=parseFloat(n[3]),n[4]&&(t.ambient=parseFloat(n[4])),n[5]&&(t.temperature=parseFloat(n[5])),t):r}var jL=40,lx={deviceType:"USB",deviceName:"hegduino",baudRate:115200,write:`t
`,codec:ox,sps:jL},BL=Object.assign({},lx);BL.sps=19;var wQ={deviceType:"BLE",deviceName:"hegduino",sps:jL,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:!0,notifyCallback:void 0,codec:ox,sps:jL}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:!0,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0}}},androidWebBLE:"o"},ML=Object.assign({},lx);ML.sps=19;function Of(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r=32,n={red:new Array(r),ir:new Array(r),max_dietemp:ze.get2sCompliment(t[193],8)+.0625*t[194],timestamp:Date.now()},i=0;for(;i<r;){let s=i*6;i%2===0?(n.ir[i]=(t[s+1]<<16|t[s+2]<<8|t[s+3])&524287,n.ir[i+1]=(t[s+4]<<16|t[s+5]<<8|t[s+6])&524287):(n.red[i-1]=(t[s+1]<<16|t[s+2]<<8|t[s+3])&524287,n.red[i]=(t[s+4]<<16|t[s+5]<<8|t[s+6])&524287),i++}return n}function Af(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={ax:new Array(20),ay:new Array(20),az:new Array(20),gx:new Array(20),gy:new Array(20),gz:new Array(20),mpu_dietemp:(ze.bytesToInt16(t[241],t[242])+521)/340+35,timestamp:Date.now()};for(let n=0;n<20;n++){let i=n*12;r.ax[n]=ze.bytesToInt16(t[i+1],t[i+2]),r.ay[n]=ze.bytesToInt16(t[i+3],t[i+4]),r.az[n]=ze.bytesToInt16(t[i+5],t[i+6]),r.gx[n]=ze.bytesToInt16(t[i+7],t[i+8]),r.gy[n]=ze.bytesToInt16(t[i+9],t[i+10]),r.gz[n]=ze.bytesToInt16(t[i+11],t[i+12])}return r}function RL(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let n=0;n<7;n++){let i=n*26+1;if(!t[i+23])break;r[0][n]=ze.bytesToUInt24(t[i],t[i+1],t[i+2]),r[1][n]=ze.bytesToUInt24(t[i+3],t[i+4],t[i+5]),r[2][n]=ze.bytesToUInt24(t[i+6],t[i+7],t[i+8]),r[3][n]=ze.bytesToUInt24(t[i+9],t[i+10],t[i+11]),r[4][n]=ze.bytesToUInt24(t[i+12],t[i+13],t[i+14]),r[5][n]=ze.bytesToUInt24(t[i+15],t[i+16],t[i+17]),r[6][n]=ze.bytesToUInt24(t[i+18],t[i+19],t[i+20]),r[7][n]=ze.bytesToUInt24(t[i+21],t[i+22],t[i+23])}return r}var cx=250,SQ={deviceType:"BLE",deviceName:"cognixionONE",services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:!0,notifyCallback:void 0,codec:RL,sps:cx}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:!0}}},sps:cx},xQ=Object.assign({},lv);xQ.sps=cx;xQ.deviceName="cognixionONE";var Dc={nSec:10,sps:cx,units:"mV"},H3e={lines:{0:JSON.parse(JSON.stringify(Dc)),1:JSON.parse(JSON.stringify(Dc)),2:JSON.parse(JSON.stringify(Dc)),3:JSON.parse(JSON.stringify(Dc)),4:JSON.parse(JSON.stringify(Dc)),5:JSON.parse(JSON.stringify(Dc)),6:JSON.parse(JSON.stringify(Dc)),7:JSON.parse(JSON.stringify(Dc))}};var Ca={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function $L(e){let t={},r=0;for(;r<e.length;)if(Ca[e[r]]&&r+1+Ca[e[r]].byteLength<=e.length){let n=e.slice(r+1,r+1+Ca[e[r]].byteLength).buffer,i=ze.struct(Ca[e[r]].format).unpack(n),s=Ca[e[r]].type;s==="unfilteredHEG"||s==="heg"?i=i[0]/256:(s==="POOR_SIGNAL"||s==="sampleNumber"||s==="debug0"||s==="debug1"||s==="debug2"||s==="debug3")&&(i=i[0]),t[Ca[e[r]].type]?Array.isArray(i)?t[Ca[e[r]].type].push(...i):t[Ca[e[r]].type].push(i):Array.isArray(i)?t[Ca[e[r]].type]=i:t[Ca[e[r]].type]=[i],r+=Ca[e[r]].byteLength+1}else r++;return t.timestamp=Date.now(),t}var kQ={deviceType:"USB",deviceName:"peanut",baudRate:38400,bufferSize:400,write:`protocol 3
`,buffering:{searchBytes:new Uint8Array([170,170])},codec:$L,sps:10.101};var W3e=1013.25,Tf=e=>{let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={timestamp:Date.now(),temp:[],pressure:[],altitude:[]},n=0;if(t[0].length===74&&(n=1),n){r.humidity=[];for(let i=0;i<3;i++){let s=i*24+2,a=ze.bytesToInt32(t[3+s],t[2+s],t[1+s],t[0+s]),o=ze.bytesToInt32(t[7+s],t[6+s],t[5+s],t[4+s]);r.temp.push(a+o/Math.pow(10,Math.ceil(Math.log10(o))));let l=10*ze.bytesToInt32(t[11+s],t[10+s],t[9+s],t[8+s]),c=ze.bytesToInt32(t[15+s],t[14+s],t[13+s],t[12+s]);r.pressure.push(l+c/Math.pow(10,Math.ceil(Math.log10(c))));let f=ze.bytesToInt32(t[19+s],t[18+s],t[17+s],t[16+s]),u=ze.bytesToInt32(t[23+s],t[22+s],t[21+s],t[20+s]);r.humidity.push(f+u/Math.pow(10,Math.ceil(Math.log10(u)))),r.altitude.push(EQ(r.pressure[i],r.temp[i]))}}else for(let i=0;i<3;i++){let s=i*16+2,a=ze.bytesToInt32(t[3+s],t[2+s],t[1+s],t[0+s]),o=ze.bytesToInt32(t[7+s],t[6+s],t[5+s],t[4+s]);r.temp.push(a+o/Math.pow(10,Math.ceil(Math.log10(o))));let l=10*ze.bytesToInt32(t[11+s],t[10+s],t[9+s],t[8+s]),c=ze.bytesToInt32(t[15+s],t[14+s],t[13+s],t[12+s]);r.pressure.push(l+c/Math.pow(10,Math.ceil(Math.log10(c)))),r.altitude.push(EQ(r.pressure[i],r.temp[i]))}return r};function EQ(e,t){return 44330*(1-Math.pow(e/W3e,.1903))}function UL(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};if(t[0]===2)Object.assign(r,dl(t.subarray(2)));else if(t[0]===3){let n=Object.assign(r,dl(t.subarray(2)));Object.keys(n).forEach((i,s)=>{r[s+8]=n[i]})}else t[0]===4?Object.assign(r,Af(t.subarray(2))):t[0]===5?Object.assign(r,Of(t.subarray(2))):t[0]===6?Object.assign(r,Tf(t.subarray(2))):Object.assign(r,Object.assign(r,dl(t.subarray(2))));return r}function J3e(e){let t;e.getInt8?t=new Uint8Array(e.buffer):e.buffer?t=e:t=new Uint8Array(e);let r={};if(t[0]===2)Object.assign(r,sv(t.subarray(2)));else if(t[0]===3){let n=Object.assign(r,dl(t.subarray(2)));Object.keys(n).forEach((i,s)=>{r[s+8]=n[i]})}else t[0]===4?Object.assign(r,Af(t.subarray(2))):t[0]===5?Object.assign(r,Of(t.subarray(2))):t[0]===6?Object.assign(r,Tf(t.subarray(2))):Object.assign(r,Object.assign(r,sv(t.subarray(2))));return r}var OQ={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:UL,sps:250},AQ={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:J3e,sps:250},TQ={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:dl,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Of,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Af,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:dl,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Tf,sps:3.33}}}},CQ={deviceType:"BLE",deviceName:"nrf5x_singleended",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:sv,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Of,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Af,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:sv,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:!0,notifyCallback:void 0,codec:Tf,sps:3.33}}}},jc={nSec:10,sps:250,units:"mV"},G3e={lines:{0:JSON.parse(JSON.stringify(jc)),1:JSON.parse(JSON.stringify(jc)),2:JSON.parse(JSON.stringify(jc)),3:JSON.parse(JSON.stringify(jc)),4:JSON.parse(JSON.stringify(jc)),5:JSON.parse(JSON.stringify(jc)),6:JSON.parse(JSON.stringify(jc)),7:JSON.parse(JSON.stringify(jc))},generateNewLines:!0,cleanGeneration:!1},K3e=32,Y3e=24,X3e=1.2,vi={sps:250,useDCBlock:!1,useBandpass:!1,bandpassLower:3,bandpassUpper:45,useScaling:!0,scalar:.96*1e3*X3e/(K3e*(Math.pow(2,Y3e)-1))},Z3e={0:JSON.parse(JSON.stringify(vi)),1:JSON.parse(JSON.stringify(vi)),2:JSON.parse(JSON.stringify(vi)),3:JSON.parse(JSON.stringify(vi)),4:JSON.parse(JSON.stringify(vi)),5:JSON.parse(JSON.stringify(vi)),6:JSON.parse(JSON.stringify(vi)),7:JSON.parse(JSON.stringify(vi)),8:JSON.parse(JSON.stringify(vi)),9:JSON.parse(JSON.stringify(vi)),10:JSON.parse(JSON.stringify(vi)),11:JSON.parse(JSON.stringify(vi)),12:JSON.parse(JSON.stringify(vi)),13:JSON.parse(JSON.stringify(vi)),14:JSON.parse(JSON.stringify(vi)),15:JSON.parse(JSON.stringify(vi))};var Q3e=new TextDecoder;function ux(e){let t={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0},r=Q3e.decode(e),n=r.split("|");return n.length>=5?(t.timestamp=Date.now(),t.left_red=parseInt(n[1]),t.left_infrared=parseInt(n[2]),t.left_heg=parseFloat(n[3]),t.center_red=parseInt(n[4]),t.center_infrared=parseInt(n[5]),t.center_heg=parseFloat(n[6]),t.right_red=parseInt(n[7]),t.right_infrared=parseInt(n[8]),t.right_heg=parseFloat(n[9]),t):r}var IQ={deviceType:"USB",deviceName:"statechanger",baudRate:115200,codec:ux,sps:20},NQ={deviceType:"BLE",deviceName:"statechanger",sps:20,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:!0,notifyCallback:void 0,codec:ux}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:!0,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:!0}}},androidWebBLE:"o"};function zL(e){let t={red:e.getInt32(2),ir:e.getInt32(6),ir2:e.getInt32(10),timestamp:Date.now()};return t.heg=t.red/(.5*(t.ir+t.ir2)),t}var PQ=40,LQ={deviceType:"BLE",deviceName:"blueberry",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:!0,notifyCallback:void 0,codec:zL,sps:PQ}}},sps:PQ};function ePe(e){let t={sred:e.getInt32(2),sir:e.getInt32(6),sir2:e.getInt32(10),timestamp:Date.now()};return t.sheg=t.sred/(.5*(t.sir+t.sir2)),t}function tPe(e){let t={red:e.getInt32(2),ir:e.getInt32(6),ir2:e.getInt32(10),timestamp:Date.now()};return t.heg=t.sred/(.5*(t.ir+t.ir2)),t}var qL=40,FQ={deviceType:"BLE",deviceName:"blueberry2",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:!0,notifyCallback:void 0,codec:tPe,sps:qL},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:!0,notifyCallback:void 0,codec:ePe,sps:qL}}},sps:qL};function VL(e){return{hr:e.getInt8(1),timestamp:Date.now()}}var DQ={deviceType:"BLE",deviceName:"heartrate",services:{heart_rate:{heart_rate_measurement:{notify:!0,notifyCallback:void 0,codec:VL}}}};var HL={sps:250,deviceType:"CUSTOM",deviceName:"simulator",simulate:{0:{sps:250,freq:1,amplitude:1,offset:0},1:{sps:250,freq:10,amplitude:1,offset:0},2:{sps:250,freq:100,amplitude:.5,offset:.5},3:{sps:250,freq:25,amplitude:1,offset:0}},connect:(e={})=>new Promise(async(t,r)=>{let i={_id:`simulated${Math.floor(Math.random()*1e15)}`,settings:Object.assign(Object.assign({},HL),e)};i.settings.looping=!0;let s=50,a=Date.now(),o=()=>{if(i.settings.looping){let l={},c=Date.now(),f=c-a;for(let u in i.settings.simulate){let d=Math.floor(i.settings.simulate[u].sps*f/1e3);l[u]=new Array(d).fill(0),l[u]=l[u].map((p,_)=>Math.sin(2*Math.PI*i.settings.simulate[u].freq*.001*(a+f*(_+1)/d))*i.settings.simulate[u].amplitude+i.settings.simulate[u].offset)}a=c,l.timestamp=a,i.settings.ondata(l),setTimeout(()=>{o()},s)}};o(),i.settings.onconnect&&i.settings.onconnect(i),t(i)}),codec:e=>e,disconnect:e=>{console.log(e),e.settings.looping=!1,e.settings.ondisconnect(e)},onconnect:e=>{console.log("simulator connected!",e)},ondisconnect:e=>{console.log("simulator disconnected!",e)},ondata:e=>{}};var fx=class{constructor(t={sps:512,useSMA4:!1,useNotch50:!0,useNotch60:!0,useLowpass:!1,lowpassHz:100,useBandpass:!1,bandpassLower:3,bandpassUpper:45,useDCBlock:!0,DCBresonance:.995,trimOutliers:!1,outlierTolerance:.2,useScaling:!1,scalar:1}){this.idx=0,this.sps=t.sps,this.bandpassLower=t.bandpassLower?t.bandpassLower:3,this.bandpassUpper=t.bandpassUpper?t.bandpassUpper:45,this.useSMA4=t.useSMA4,this.last4=[],this.useNotch50=t.useNotch50,this.useNotch60=t.useNotch60,this.useLowpass=t.useLowpass,this.lowpassHz=t.lowpassHz?t.lowpassHz:100,this.useBandpass=t.useBandpass,this.useDCBlock=t.useDCBlock,this.DCBresonance=t.DCBresonance?t.DCBresonance:.995,this.useScaling=t.useScaling,this.scalar=t.scalar,this.trimOutliers=t.trimOutliers,this.outlierTolerance=t.outlierTolerance;let r=this.sps;this.notch50=[Bc(50,r,2),Bc(100,r,2)],this.notch60=[Bc(60,r,2),Bc(120,r,2)],this.lp1=[new Rn("lowpass",this.lowpassHz,r),new Rn("lowpass",this.lowpassHz,r),new Rn("lowpass",this.lowpassHz,r),new Rn("lowpass",this.lowpassHz,r)],this.bp1=[Zs(this.bandpassLower,this.bandpassUpper,r,1),Zs(this.bandpassLower,this.bandpassUpper,r,1),Zs(this.bandpassLower,this.bandpassUpper,r,1),Zs(this.bandpassLower,this.bandpassUpper,r,1)],this.dcb=new dx(t.DCBresonance?t.DCBresonance:.995)}reset(t=this.sps){this.notch50=[Bc(50,t,2),Bc(100,t,2)],this.notch60=[Bc(60,t,2),Bc(120,t,2)],this.lp1=[new Rn("lowpass",this.lowpassHz,t),new Rn("lowpass",this.lowpassHz,t),new Rn("lowpass",this.lowpassHz,t),new Rn("lowpass",this.lowpassHz,t)],this.bp1=[Zs(this.bandpassLower,this.bandpassUpper,t,1),Zs(this.bandpassLower,this.bandpassUpper,t,1),Zs(this.bandpassLower,this.bandpassUpper,t,1),Zs(this.bandpassLower,this.bandpassUpper,t,1)],this.dcb=new dx(this.DCBresonance)}setBandpass(t=this.bandpassLower,r=this.bandpassUpper,n=this.sps){this.bandpassLower=t,this.bandpassUpper=r,this.bp1=[Zs(t,r,n),Zs(t,r,n),Zs(t,r,n),Zs(t,r,n)]}apply(t=0){let r=t;return this.useScaling===!0&&(r*=this.scalar),this.filtered&&this.trimOutliers&&this.outlierTolerance&&Math.abs(r-this.filtered)>this.outlierTolerance&&(r=this.filtered),this.useDCBlock===!0&&(r=this.dcb.applyFilter(r)),this.useSMA4===!0&&(this.last4.length<4?this.last4.push(r):(r=this.last4.reduce((n,i)=>n+i)/this.last4.length,this.last4.shift(),this.last4.push(r))),this.useNotch50===!0&&this.notch50.forEach((n,i)=>{r=n.applyFilter(r)}),this.useNotch60===!0&&this.notch60.forEach((n,i)=>{r=n.applyFilter(r)}),this.useLowpass===!0&&this.lp1.forEach((n,i)=>{r=n.applyFilter(r)}),this.useBandpass===!0&&this.bp1.forEach((n,i)=>{r=n.applyFilter(r)}),this.filtered=r,this.idx++,r}},Rn=class{constructor(t,r,n,i=1/Math.sqrt(2),s=0){this.a0=0;this.a1=0;this.a2=0;this.b0=0;this.b1=0;this.b2=0;this.x1=0;this.x2=0;this.y1=0;this.y2=0;if(["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"].indexOf(t)<0){console.error("Valid types: 'lowpass','highpass','bandpass','notch','peak','lowshelf','highshelf'");return}this.type=t,this.freq=r,this.sps=n,this.Q=i,this.dbGain=s;let o=Math.pow(10,s/40),l=2*Math.PI*r/n,c=Math.sin(l),f=Math.cos(l),u=c/(2*i),d=Math.sqrt(o+o);this[t](o,c,f,u,d),this.b0/=this.a0,this.b1/=this.a0,this.b2/=this.a0,this.a1/=this.a0,this.a2/=this.a0}lowpass(t,r,n,i,s){this.b0=(1-n)*.5,this.b1=1-n,this.b2=(1-n)*.5,this.a0=1+i,this.a1=-2*n,this.a2=1-i}highpass(t,r,n,i,s){this.b0=(1+n)*.5,this.b1=-(1+n),this.b2=(1+n)*.5,this.a0=1+i,this.a1=-2*n,this.a2=1-i}bandpass(t,r,n,i,s){this.b0=i,this.b1=0,this.b2=-i,this.a0=1+i,this.a1=-2*n,this.a2=1-i}notch(t,r,n,i,s){this.b0=1,this.b1=-2*n,this.b2=1,this.a0=1+i,this.a1=-2*n,this.a2=1-i}peak(t,r,n,i,s){this.b0=1+i*t,this.b1=-2*n,this.b2=1-i*t,this.a0=1+i/t,this.a1=-2*n,this.a2=1-i/t}lowshelf(t,r,n,i,s){this.b0=t*(t+1-(t-1)*n+s*r),this.b1=2*t*(t-1-(t+1)*n),this.b2=t*(t+1-(t-1)*n-s*r),this.a0=t+1+(t+1)*n+s*r,this.a1=2*(t-1+(t+1)*n),this.a2=t+1+(t-1)*n-s*r}highshelf(t,r,n,i,s){this.b0=t*(t+1+(t-1)*n+s*r),this.b1=2*t*(t-1+(t+1)*n),this.b2=t*(t+1-(t-1)*n-s*r),this.a0=t+1-(t+1)*n-s*r,this.a1=2*(t-1-(t+1)*n),this.a2=t+1-(t-1)*n-s*r}applyFilter(t){let r=this.b0*t+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;return this.x2=this.x1,this.x1=t,this.y2=this.y1,this.y1=r,r}zResult(t){try{let r=Math.pow(Math.sin(Math.PI*t*2/(2*this.sps)),2);return(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*r+16*this.b0*this.b2*r*r)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*r+16*this.a2*r*r)}catch{return-200}}static calcCenterFrequency(t,r){return(t+r)/2}static calcBandwidth(t,r){return r-this.calcCenterFrequency(t,r)}static calcBandpassQ(t,r,n=Math.pow(10,Math.floor(Math.log10(t)))){return n*Math.sqrt((t-r)*(t+r))/(2*r)}static calcNotchQ(t,r,n=Math.pow(10,Math.floor(Math.log10(t)))){return n*t*r/Math.sqrt((t-r)*(t+r))}},dx=class{constructor(t=.995){this.r=t,this.y1=this.y2=this.x1=this.x2=0}applyFilter(t){this.x2=this.x1,this.x1=t;let r=this.x1-this.x2+this.r*this.y1;return this.y2=this.y1,this.y1=r,r}},Bc=(e,t,r)=>new Rn("notch",e,t,Rn.calcNotchQ(e,r),0),Zs=(e,t,r,n=Math.pow(10,Math.floor(Math.log10(Rn.calcCenterFrequency(e,t)))))=>new Rn("bandpass",Rn.calcCenterFrequency(e,t),r,Rn.calcBandpassQ(Rn.calcCenterFrequency(e,t),Rn.calcBandwidth(e,t),n),0);var px={sps:250,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45},rPe={0:JSON.parse(JSON.stringify(px)),1:JSON.parse(JSON.stringify(px)),2:JSON.parse(JSON.stringify(px)),3:JSON.parse(JSON.stringify(px))},hx={nSec:10,sps:250,units:"mV"},nPe={lines:{0:JSON.parse(JSON.stringify(hx)),1:JSON.parse(JSON.stringify(hx)),2:JSON.parse(JSON.stringify(hx)),3:JSON.parse(JSON.stringify(hx)),ax:{nSec:10,sps:250,units:"mg"},ay:{nSec:10,sps:250,units:"mg"},az:{nSec:10,sps:250,units:"mg"}},generateNewLines:!0},fv={sps:250,useDCBlock:!0,useBandpass:!0,bandpassLower:3,bandpassUpper:45},iPe={0:JSON.parse(JSON.stringify(fv)),1:JSON.parse(JSON.stringify(fv)),2:JSON.parse(JSON.stringify(fv)),3:JSON.parse(JSON.stringify(fv)),4:JSON.parse(JSON.stringify(fv))};var Mc={BLE:{nrf5x:TQ,nrf5x_singleended:CQ,hegduino:wQ,hegduinoV1:ML,cognixionONE:SQ,statechanger:NQ,blueberry:LQ,blueberry2:FQ,heart_rate:DQ,freeEEG16:mQ},USB:{nrf5x:OQ,nrf5x_singleended:AQ,freeEEG16:bQ,freeEEG32:dQ,freeEEG32_optical:pQ,freeEEG128:cQ,hegduino:lx,hegduinoV1:BL,cyton:lv,cyton_daisy:lQ,peanut:kQ,statechanger:IQ,cognixionONE:lv},BLE_CUSTOM:{},USB_CUSTOM:{},CUSTOM:{simulator:HL}};var sPe=new TextDecoder,WL={raw:e=>e?.buffer?Array.from(new Uint8Array(e)):e,utf8:e=>sPe.decode(e),"console-f12":e=>(e?.buffer&&(e=Array.from(new Uint8Array(e))),console.log(e),e),debug:(e,t)=>(e?.buffer&&(e=Array.from(new Uint8Array(e))),console.log(t,e),e),ads131m08:dl,arduino_ads131m08:aQ,max3010x:Of,mpu6050:Af,bme280:Tf,freeeeg16:DL,freeeeg32:sx,freeeeg128:FL,cyton:LL,cognixionONE_BLE:RL,hegduino:ox,nrf5x:UL,peanut:$L,statechanger:ux,blueberry:zL,heart_rate:VL};var aPe=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(a,o){var l=t.length-1,c=t[l];if(typeof c=="object")if(c[a]===o||l===0)r.push(a),t.push(o.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[a]===o){l+=2,t.length=l,r.length=l,--l,t[l]=o,r[l]=a;break}l--}}function s(a,o){if(o!=null&&typeof o=="object"){a&&i(a,o);let l=e.get(o);if(l)return"[Circular Reference]"+l;e.set(o,r.join("."))}return o}return function(o,l){try{return t.push(o),JSON.stringify(o,s,l)}finally{n()}}}();JSON.stringifyWithCircularRefs===void 0&&(JSON.stringifyWithCircularRefs=aPe);var oPe=function(){let e=new Map,t=[],r=["this"];function n(){e.clear(),t.length=0,r.length=1}function i(a,o){var l=t.length-1;if(t[l]){var c=t[l];if(typeof c=="object")if(c[a]===o||l===0)r.push(a),t.push(o.pushed);else for(;l-->=0;){if(c=t[l],typeof c=="object"&&c[a]===o){l+=2,t.length=l,r.length=l,--l,t[l]=o,r[l]=a;break}l++}}}function s(a,o){let l;if(o!=null)if(typeof o=="object"){let c=o.constructor.name;a&&c==="Object"&&i(a,o);let f=e.get(o);if(f)return"[Circular Reference]"+f;if(e.set(o,r.join(".")),c==="Array")o.length>20?l=o.slice(o.length-20):l=o;else if(c.includes("Set"))l=Array.from(o);else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean")l="instanceof_"+c;else if(c==="Object"){let u={};for(let d in o)if(o[d]==null)u[d]=o[d];else if(Array.isArray(o[d]))o[d].length>20?u[d]=o[d].slice(o[d].length-20):u[d]=o[d];else if(o[d].constructor.name==="Object"){u[d]={};for(let p in o[d])if(Array.isArray(o[d][p]))o[d][p].length>20?u[d][p]=o[d][p].slice(o[d][p].length-20):u[d][p]=o[d][p];else if(o[d][p]!=null){let _=o[d][p].constructor.name;_.includes("Set")?u[d][p]=Array.from(o[d][p]):_!=="Number"&&_!=="String"&&_!=="Boolean"?u[d][p]="instanceof_"+_:u[d][p]=o[d][p]}else u[d][p]=o[d][p]}else{let p=o[d].constructor.name;p.includes("Set")?u[d]=Array.from(o[d]):p!=="Number"&&p!=="String"&&p!=="Boolean"?u[d]="instanceof_"+p:u[d]=o[d]}l=u}else l=o}else l=o;return l}return function(o,l){t.push(o);let c=JSON.stringify(o,s,l);return n(),c}}();JSON.stringifyFast===void 0&&(JSON.stringifyFast=oPe);function lPe(){globalThis.Devices=Mc,globalThis.WebSerial=Ta,globalThis.decoders=WL,globalThis.decoder="raw",globalThis.ByteParser=ze,globalThis.filtering=!1,globalThis.filters={},globalThis.BiquadChannelFilterer=fx,globalThis.ArrayManip=kf}typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&lPe();var zh=new Cc,Rc=new FZ({roots:{...qZ,...LZ}});function jQ(e,t){if(!e)return;t||(t={ondecoded:s=>{console.log(s)}});let r=e.deviceType,n=e.deviceName;t.workerUrl||(t.workerUrl=VZ),t.service||(t.service=Rc);let i=t.service.addWorker({url:t.workerUrl});if(t.devices||(t.devices=Mc),!t.devices[r][n]){let s=Object.assign({},e);for(let a in s)typeof s[a]=="function"&&(s[a]=s[a].toString());i.post("receiveDevice",s)}if(t.filterSettings&&i.post("setFilters",[t.filterSettings]),t.roots){for(let s in t.roots){let a={callback:"decodeAndParseDevice",worker:i};t.roots[s].__parent=t.roots[s].__parent?Object.assign(t.roots[s].__parent,a):a}t.service.load(t.roots)}if(r.includes("CUSTOM"))return new Promise(async(s,a)=>{e.ondata=c=>{t.ondata&&t.ondata(c),typeof t.ondecoded=="function"&&i.run("decodeAndParseDevice",[c,r,n]).then(f=>{t.ondecoded(f)})},e.ondisconnect=()=>{if(t.service.terminate(i._id),t.roots)for(let c in t.roots)t.service.remove(c)};let o=await e.connect(e),l={workers:{streamworker:i},disconnect:()=>{if(t.beforedisconnect&&t.beforedisconnect(l),e.disconnect(o),t.ondisconnect&&t.ondisconnect(l),t.roots)for(let c in t.roots)t.service.remove(c)},device:o,options:t,read:c=>{if(e.read)return new Promise((f,u)=>{f(e.read(e,c))})},write:c=>{if(e.write)return new Promise((f,u)=>{f(e.write(e,c))})},setFilters:(c,f)=>i.run("setFilters",[c,f]),roots:t.roots};t.onconnect&&t.onconnect(l),s(l)}).catch(s=>{if(console.error(s),t.service.terminate(i._id),t.roots)for(let a in t.roots)t.service.remove(a)});if(r==="BLE"){for(let s in e.services){e.services[s].UUID&&(s=e.services[s].UUID);for(let a in e.services[s]){let o=a;if(e.services[s][a].characteristic&&(a=e.services[s][a].characteristic),typeof t.ondecoded=="function"){if(e.services?.[s]?.[o]?.notify){e.services[s][o].notifyCallback||(e.services[s][o].notifyCallback=l=>{t.ondata&&t.ondata(l),i.run("decodeAndParseDevice",[l,r,n,s,o],void 0,[l.buffer]).then(t.ondecoded)});break}}else if(typeof t.ondecoded=="object"){let l=t.ondecoded[a]?t.ondecoded[a]:t.ondecoded[o]?t.ondecoded[o]:null;l&&t.ondecoded[a]&&(e.services?.[s]?.[o]?.notify&&(e.services[s][o].notifyCallback||(e.services[s][o].notifyCallback=c=>{t.ondata&&t.ondata(c),i.run("decodeAndParseDevice",[c,r,n,s,o],void 0,[c.buffer]).then(l)})),e.services?.[s]?.[o]?.read&&(e.services[s][o].readCallback||(e.services[o].readCallback=c=>{t.ondata&&t.ondata(c),i.run("decodeAndParseDevice",[c,r,n,s,o],void 0,[c.buffer]).then(l)})))}else t.ondata&&(e.services?.[s]?.[o]?.notify&&(e.services[s][o].notifyCallback=t.ondata),e.services?.[s]?.[o]?.read&&(e.services[o].readCallback=t.ondata))}}return new Promise((s,a)=>{zh.setup(e).then(o=>{let l={workers:{streamworker:i},options:t,device:o,subscribe:(c,f,u,d)=>zh.subscribe(o.device,c,f,p=>{d?u?u(p):t.ondecoded?.[f]?t.ondecoded[f](p):typeof t.ondecoded=="function"&&t.ondecoded(p):i.run("decodeAndParseDevice",[p,r,n,c,f],void 0,[p.buffer]).then(u||(t.ondecoded?.[f]?t.ondecoded[f]:t.ondecoded))}),unsubscribe:(c,f)=>zh.unsubscribe(o.device,c,f),disconnect:async()=>{if(await zh.disconnect(o.deviceId),t.ondisconnect&&t.ondisconnect(l),i.terminate(),t.roots)for(let c in t.roots)t.service.remove(c)},read:c=>zh.read(o.device,c.service,c.characteristic,c.ondata,c.timeout),write:c=>zh.write(o.device,c.service,c.characteristic,c.data,c.callback,c.timeout),setFilters:(c,f)=>i.run("setFilters",[c,f]),roots:t.roots};t.onconnect&&t.onconnect(l),s(l)}).catch(o=>{if(console.error(o),i.terminate(),t.roots)for(let l in t.roots)t.service.remove(l);a(o)})})}else if(r==="USB"){let s=t.service.addWorker({url:t.workerUrl});s.worker.addEventListener("message",l=>{if(typeof l.data=="string"){if(l.data.includes("disconnected")&&(t.service.terminate(s._id),t.service.terminate(i._id),t.roots))for(let c in t.roots)t.service.remove(c)}else typeof t.ondata=="function"&&t.ondata(l.data)}),s.post("setupSerial");let a=t.service.establishMessageChannel(i.worker,s.worker),o=new Ta;return new Promise((l,c)=>{let f=d=>{if(console.error(d),t.service.terminate(s._id),t.service.terminate(i._id),t.roots)for(let p in t.roots)t.service.remove(p);c(d)},u=d=>{let p;d?p=d.getInfo():p={usbVendorId:e.usbVendorId,usbProductId:e.usbProductId},s.run("openPort",{baudRate:e.baudRate,usbVendorId:p.usbVendorId,usbProductId:p.usbProductId,bufferSize:e.bufferSize,buffering:e.buffering?e.buffering:void 0,frequency:e.frequency?e.frequency:void 0,pipeTo:{route:"decodeAndParseDevice",_id:a,extraArgs:[r,n]},pipeMain:t.ondata!==void 0}).then(_=>{e.write&&s.post("writeStream",[_._id,e.write]),typeof t.ondecoded=="function"&&i.subscribe("decodeAndParseDevice",k=>{t.ondecoded&&t.ondecoded(k)});let w={workers:{streamworker:i,serialworker:s},device:_,options:t,subscribeStream:k=>i.subscribe("decodeAndParseDevice",k),unsubscribeStream:k=>i.unsubscribe("decodeAndParseDevice",k),disconnect:()=>{s.post("closeStream",_._id),t.ondisconnect&&t.ondisconnect(w)},read:()=>new Promise((k,S)=>{let O;O=i.subscribe("decodeAndParseDevice",A=>{s.unsubscribe("decodeAndParseDevice",O),k(A)})}),write:k=>s.run("writeStream",[_._id,k]),setFilters:(k,S)=>i.run("setFilters",[k,S]),roots:t.roots};t.onconnect&&t.onconnect(w),l(w)}).catch(f)};t.reconnect?u():o.requestPort(e.usbVendorId,e.usbProductId).then(d=>{u(d)}).catch(f)})}else return}var cPe='(()=>{var __require=(x3=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(x3,{get:(a,b)=>(typeof require!=="undefined"?require:a)[b]}):x3)(function(x3){if(typeof require!=="undefined")return require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x3+\'" is not supported\')});var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __require2=(x3=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x3,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x3)(function(x3){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x3+\'" is not supported\')});var __commonJS=(cb,mod)=>function __require23(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:true}):target,mod));var __publicField=(obj,key,value)=>{__defNormalProp(obj,typeof key!=="symbol"?key+"":key,value);return value};var require_browser=__commonJS({"node_modules/web-worker/cjs/browser.js"(exports,module2){module2.exports=Worker}});var EventHandler=class{data={};triggers={};ctr=0;constructor(data){if(typeof data==="object")this.data=data}setState=updateObj=>{Object.assign(this.data,updateObj);let props=Object.getOwnPropertyNames(updateObj);for(const prop of props){this.triggerEvent(prop,this.data[prop])}if(this.triggers[statesubKey]){let run=fn=>{fn(updateObj)};const l=this.triggers[statesubKey].length;for(let i22=l-1;i22>=0;i22--){run(this.triggers[statesubKey][i22].onchange)}}return this.data};setValue=(key,value)=>{this.data[key]=value;this.triggerEvent(key,value)};triggerEvent=(key,value)=>{if(this.triggers[key]){let fn=obj=>{obj.onchange(value)};const l=this.triggers[key].length;for(let i22=l-1;i22>=0;i22--){fn(this.triggers[key][i22])}}};subscribeState=onchange=>{return this.subscribeEvent(statesubKey,onchange)};unsubscribeState=sub=>{return this.unsubscribeEvent(statesubKey,sub)};subscribeEvent=(key,onchange,refObject,refKey)=>{if(key){if(refObject&&refKey&&!this.triggers[key]){Object.defineProperty(this.data,key,{get:()=>{return refObject[refKey]},set:value=>{refObject[refKey]=value},enumerable:true,configurable:true})}if(!this.triggers[key]){this.triggers[key]=[]}let l=this.ctr;this.ctr++;this.triggers[key].push({sub:l,onchange});return l}else return void 0};unsubscribeEvent=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(sub===void 0){delete this.triggers[key];delete this.data[key]}else{let idx=void 0;let obj=triggers.find((o,i22)=>{if(o.sub===sub){idx=i22;return true}});if(obj)triggers.splice(idx,1);if(Object.keys(triggers).length===0){delete this.triggers[key];delete this.data[key]}if(this.onRemoved)this.onRemoved(obj);return true}}};subscribeEventOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeEvent(key,sub)};sub=this.subscribeEvent(key,changed);return sub};getEvent=(key,sub)=>{for(const s in this.triggers[key]){if(this.triggers[key][s].sub===sub)return this.triggers[key][s]}};getSnapshot=()=>{const snapshot={};for(const key in this.data){snapshot[key]=this.data[key]}};onRemoved};var statesubKey="*s";var state=new EventHandler;var GraphNode=class{__node={tag:`node${Math.floor(Math.random()*1e15)}`,unique:`${Math.floor(Math.random()*1e15)}`,state};__children;__parent;__operator;__listeners;__props;__args;constructor(properties,parent,graph){this.__setProperties(properties,parent,graph)}__setProperties=(properties,parent,graph)=>{let enforceProperties=()=>{let orig=properties;if(typeof properties==="function"){if(isNativeClass(properties)){properties=new properties}else properties={__operator:properties,__node:{forward:true,tag:properties.name}}}else if(typeof properties==="string"){if(graph?.get(properties)){properties=graph.get(properties)}}if(!("__node"in properties))properties.__node={};if(!properties.__node.initial)properties.__node.initial=orig};enforceProperties();if(typeof properties==="object"){let assignState=()=>{if(properties.__node?.state)this.__node.state=properties.__node.state;else if(graph){properties.__node.state=graph.__node.state}};let setProps22=()=>{if(properties.__props){if(typeof properties.__props==="function")properties.__props=new properties.__props;if(typeof properties.__props==="object"){this.__proxyObject(properties.__props)}}};let setTag=()=>{if(!properties.__node.tag){if(properties.__operator?.name)properties.__node.tag=properties.__operator.name;else properties.__node.tag=`node${Math.floor(Math.random()*1e15)}`}};let setNode=()=>{if(typeof properties.__node==="string"){if(graph?.get(properties.__node.tag)){properties=graph.get(properties.__node.tag)}else properties.__node={}}else if(!properties.__node)properties.__node={};if(graph){properties.__node.graph=graph}if(properties instanceof Graph)properties.__node.source=properties};let setParent=()=>{if(!properties.__parent&&parent)properties.__parent=parent;if(parent?.__node&&!(parent instanceof Graph||properties instanceof Graph))properties.__node.tag=parent.__node.tag+"."+properties.__node.tag;if(parent instanceof Graph&&properties instanceof Graph){if(properties.__node.loaders)Object.assign(parent.__node.loaders?parent.__node.loaders:{},properties.__node.loaders);if(parent.__node.mapGraphs){properties.__node.nodes.forEach(n=>{parent.set(properties.__node.tag+"."+n.__node.tag,n)});let ondelete=()=>{properties.__node.nodes.forEach(n=>{parent.__node.nodes.delete(properties.__node.tag+"."+n.__node.tag)})};this.__addOndisconnected(ondelete)}}};let setOp=()=>{if(typeof properties.default==="function"&&!properties.__operator){properties.__operator=properties.default}if(properties.__operator){if(typeof properties.__operator==="string"){if(graph){let n=graph.get(properties.__operator);if(n)properties.__operator=n.__operator;if(!properties.__node.tag&&properties.__operator.name)properties.__node.tag=properties.__operator.name}}if(typeof properties.__operator==="function")properties.__operator=this.__setOperator(properties.__operator);if(properties.default)properties.default=properties.__operator}};let assignProps=()=>{properties.__node=Object.assign(this.__node,properties.__node);let keys22=Object.getOwnPropertyNames(properties).filter(v2=>{if(!objProps[v2])return true});for(const key of keys22){if(key in properties)this[key]=properties[key]}};let bindCallbacks=()=>{if(this.__onconnected){if(typeof this.__onconnected==="function"){this.__onconnected=this.__onconnected.bind(this)}else if(Array.isArray(this.__onconnected)){this.__onconnected=this.__onconnected.map(f=>{return f.bind(this)})}if(typeof this.__ondisconnected==="function"){this.__ondisconnected=this.__ondisconnected.bind(this)}else if(Array.isArray(this.__ondisconnected)){this.__ondisconnected=this.__ondisconnected.map(f=>{return f.bind(this)})}}};assignState();setTag();setProps22();setNode();setParent();assignProps();bindCallbacks();setOp()}};__subscribe=(callback,key,subInput,target,tkey,args)=>{const subscribeToFunction=(k,setTarget=(callback2,target2)=>target2?target2:callback2,triggerCallback=callback)=>{let wrappedArgs;if(args){let wrapped=wrapArgs(triggerCallback,args,this.__node.graph);triggerCallback=wrapped.__callback;wrappedArgs=wrapped.__args}let sub=this.__node.state.subscribeEvent(k,triggerCallback,this,key);let trigger=this.__node.state.getEvent(k,sub);if(!this.__listeners)this.__listeners={};this.__listeners[k]=this.__node.state.triggers[k];if(!trigger)return sub;trigger.source=this.__node.tag;if(key)trigger.key=key;trigger.target=setTarget(callback,target);if(subInput)trigger.subInput=subInput;if(args){trigger.arguments=args;trigger.__args=wrappedArgs}if(tkey)trigger.tkey=tkey;trigger.node=this;trigger.graph=this.__node.graph;return sub};const subscribeToGraph=callback2=>{let fn=this.__node.graph.get(callback2);if(!fn&&callback2.includes(".")){target=callback2.substring(0,callback2.lastIndexOf("."));let n=this.__node.graph.get(callback2.substring(0,target));tkey=callback2.lastIndexOf(".")+1;if(n&&typeof n[key]==="function")callback2=(...args2)=>{return n[tkey](...args2)}}else if(fn.__operator){callback2=fn.__operator;tkey="__operator"}};if(key){if(!this.__node.localState||!this.__node.localState[key]){this.__addLocalState(this,key)}if(typeof callback==="string"){tkey=callback;if(target){if(this.__node.graph?.get(target)){let n=this.__node.graph?.get(target);if(typeof n[callback]==="function"){let fn=n[callback];callback=(...inp)=>{fn(...inp)}}else{let k2=callback;let setter=inp=>{n[k2]=inp};callback=setter}}}else if(typeof this[callback]==="function"){let fn=this[callback];callback=(...inp)=>{fn(...inp)}}else if(this.__node.graph?.get(callback))subscribeToGraph(callback);if(typeof callback!=="function")return void 0}let sub;let k=subInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node)sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)});return sub}else{if(typeof callback==="string"){if(this.__node.graph.get(callback))callback=this.__node.graph.get(callback);tkey="__operator";if(typeof callback!=="object")return void 0}let sub;let k=subInput?this.__node.unique+"input":this.__node.unique;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node){sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)})}return sub}};__unsubscribe=(sub,key,unsubInput)=>{if(key){return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key,sub)}else return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"input":this.__node.unique,sub)};__setOperator=fn=>{fn=fn.bind(this);if(this.__args&&this.__node.graph){fn=wrapArgs(fn,this.__args,this.__node.graph).__callback}let inpstr=`${this.__node.unique}input`;this.__operator=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[this.__node.unique]){if(typeof result?.then==="function"){result.then(res=>{if(res!==void 0)this.__node.state.setValue(this.__node.unique,res)}).catch(console.error)}else if(result!==void 0)this.__node.state.setValue(this.__node.unique,result)}return result};if(this.__parent instanceof GraphNode&&!this.__subscribedToParent){if(this.__parent.__operator){let sub=this.__parent.__subscribe(this);let ondelete=()=>{this.__parent?.__unsubscribe(sub);delete this.__subscribedToParent};this.__addOndisconnected(ondelete);this.__subscribedToParent=true}}return this.__operator};__addLocalState=(props,key)=>{if(!props)return;if(!this.__node.localState){this.__node.localState={}}const localState=this.__node.localState;const initState=(props2,k)=>{let str3=this.__node.unique+"."+k;let inpstr=`${str3}input`;let get,set;let obj,descriptor;if(typeof props2[k]==="function"&&k!=="__operator"){if(this.__props?.[k]){obj=this.__props}else{obj=localState}get=()=>{return obj[k]};set=fn=>{if(!this.__props?.[k])fn=fn.bind(this);obj[k]=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[str3]){if(typeof result?.then==="function"){result.then(res=>{this.__node.state.triggerEvent(str3,res)}).catch(console.error)}else this.__node.state.triggerEvent(str3,result)}return result}};localState[k]=props2[k].bind(this);descriptor={get,set,enumerable:true,configurable:true}}else{let get2,set2;let obj2;if(this.__props?.[k]){obj2=this.__props}else{obj2=localState}get2=()=>{return obj2[k]};set2=v2=>{obj2[k]=v2;if(this.__node.state.triggers[str3])this.__node.state.triggerEvent(str3,v2)};localState[k]=props2[k];descriptor={get:get2,set:set2,enumerable:true,configurable:true}}Object.defineProperty(props2,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}};if(key)initState(props,key);else{for(let k in props){initState(props,k)}}};__proxyObject=obj=>{const allProps=getAllProperties(obj);for(const k of allProps){const descriptor={get:()=>{return obj[k]},set:value=>{obj[k]=value},enumerable:true,configurable:true};Object.defineProperty(this,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}}};__addOnconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__onconnected)){this.__onconnected.push(callback)}else if(typeof this.__onconnected==="function"){this.__onconnected=[callback,this.__onconnected]}else this.__onconnected=callback}__addOndisconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__ondisconnected)){this.__ondisconnected.push(callback)}else if(typeof this.__ondisconnected==="function"){this.__ondisconnected=[callback,this.__ondisconnected]}else this.__ondisconnected=callback}__callConnected(node=this){if(typeof this.__onconnected==="function"){this.__onconnected(this)}else if(Array.isArray(this.__onconnected)){let fn=o=>{o(this)};this.__onconnected.forEach(fn)}}__callDisconnected(node=this){if(typeof this.__ondisconnected==="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let fn=o=>{o(this)};this.__ondisconnected.forEach(fn)}}};var Graph=class{__node={tag:`graph${Math.floor(Math.random()*1e15)}`,unique:`${Math.random()}`,nodes:new Map,state,roots:{}};constructor(options){this.init(options)}init=options=>{if(options){let cpy=Object.assign({},options);delete cpy.roots;recursivelyAssign(this.__node,cpy);if(options.roots)this.load(options.roots)}};load=roots=>{function recursivelyAssignChildren(target,obj,inChildren=true,top=true){if(top){if(target)Object.assign(target,obj);else target=Object.assign({},obj);recursivelyAssignChildren(target,obj,true,false)}if(obj?.__children&&!inChildren){if(obj.__children?.constructor.name==="Object"){if(target.__children?.constructor.name==="Object")recursivelyAssignChildren(target.__children,obj.__children,true,false);else target.__children=recursivelyAssignChildren({},obj.__children,true,false)}else{target.__children=obj.__children}}else if(inChildren){for(const key in obj){target[key]=Object.assign({},obj[key]);if(obj[key]?.__children){recursivelyAssignChildren({},obj[key].__children,false,false)}}}return target}this.__node.roots=recursivelyAssignChildren(this.__node.roots?this.__node.roots:{},roots);let cpy=Object.assign({},roots);if(cpy.__node)delete cpy.__node;let listeners=this.recursiveSet(cpy,this,void 0,roots);if(roots.__node){if(!roots.__node.tag)roots.__node._tag=`roots${Math.floor(Math.random()*1e15)}`;else if(!this.get(roots.__node.tag)){let node=new GraphNode(roots,this,this);this.set(node.__node.tag,node);this.runLoaders(node,this,roots,roots.__node.tag);if(node.__listeners){listeners[node.__node.tag]=node.__listeners}}}else if(roots.__listeners){this.setListeners(roots.__listeners)}this.setListeners(listeners);return cpy};setLoaders=(loaders22,replace)=>{if(replace)this.__node.loaders=loaders22;else Object.assign(this.__node.loaders,loaders22);return this.__node.loaders};runLoaders=(node,parent,properties,key)=>{for(const l in this.__node.loaders){if(typeof this.__node.loaders[l]==="object"){if(this.__node.loaders[l].init)this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key);if(this.__node.loaders[l].connected)node.__addOnconnected(this.__node.loaders[l].connect);if(this.__node.loaders[l].disconnected)node.__addOndisconnected(this.__node.loaders[l].disconnect)}else if(typeof this.__node.loaders[l]==="function")this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key)}};add=(properties,parent)=>{let listeners={};if(typeof parent==="string")parent=this.get(parent);let instanced;if(typeof properties==="function"){if(isNativeClass(properties)){if(properties.prototype instanceof GraphNode){properties=properties.prototype.constructor(properties,parent,this);instanced=true}else properties=new properties}else properties={__operator:properties}}else if(typeof properties==="string"){properties=this.__node.roots[properties]}if(!properties)return;if(!instanced){let keys22=Object.getOwnPropertyNames(properties);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(properties));keys22.push(...nonArrowFunctions);keys22=keys22.filter(v2=>!objProps.includes(v2));let cpy={};for(const key of keys22){cpy[key]=properties[key]}properties=cpy}if(!properties.__node)properties.__node={};properties.__node.initial=properties;if(typeof properties==="object"&&!this.get(properties.__node.tag)){let node;let root=recursivelyAssign({},properties,2);if(instanced)node=properties;else node=new GraphNode(properties,parent,this);this.set(node.__node.tag,node);this.runLoaders(node,parent,properties,node.__node.tag);this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key in node.__listeners){let listener=node.__listeners[key];if(node[key]){delete listeners[node.__node.tag][key];listeners[node.__node.tag][node.__node.tag+"."+key]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][key]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][key]=parent.__node.tag}}}}this.setListeners(listeners);node.__callConnected();return node}else if(properties.__node.tag)return this.get(properties.__node.tag)};recursiveSet=(t22,parent,listeners={},origin)=>{let keys22=Object.getOwnPropertyNames(origin);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(origin)).filter(v2=>!objProps.includes(v2));keys22.push(...nonArrowFunctions);for(const key of keys22){if(key.includes("__"))continue;let p2=origin[key];if(Array.isArray(p2))continue;let instanced;if(typeof p2==="function"){if(isNativeClass(p2)){p2=new p2;if(p2 instanceof GraphNode){p2=p2.prototype.constructor(p2,parent,this);instanced=true}}else p2={__operator:p2}}else if(typeof p2==="string"){if(this.__node.nodes.get(p2))p2=this.__node.nodes.get(p2);else p2=this.__node.roots[p2]}else if(typeof p2==="boolean"){if(this.__node.nodes.get(key))p2=this.__node.nodes.get(key);else p2=this.__node.roots[key]}if(p2 instanceof Object){if(!instanced&&!(p2 instanceof GraphNode)){let ks=Object.getOwnPropertyNames(p2);let nonArrowFunctions2=Object.getOwnPropertyNames(Object.getPrototypeOf(p2));nonArrowFunctions2.splice(nonArrowFunctions2.indexOf("constructor"),1);ks.push(...nonArrowFunctions2);let cpy={};for(const key2 of ks){cpy[key2]=p2[key2]}p2=cpy}if(!p2.__node)p2.__node={};if(!p2.__node.tag)p2.__node.tag=key;if(!p2.__node.initial)p2.__node.initial=t22[key];if(this.get(p2.__node.tag)&&!(!(parent instanceof Graph)&&parent?.__node)||parent?.__node&&this.get(parent.__node.tag+"."+p2.__node.tag))continue;let node;let newnode=false;let root=recursivelyAssign({},p2,2);if(instanced||p2 instanceof GraphNode){node=p2}else{node=new GraphNode(p2,parent,this);newnode=true}if(!newnode&&p2 instanceof GraphNode&&!instanced&&parent instanceof GraphNode){let sub=this.subscribe(parent.__node.tag,node.__node.tag);let ondelete=node2=>{this.unsubscribe(parent.__node.tag,sub)};node.__addOndisconnected(ondelete)}else if(node){this.set(node.__node.tag,node);this.runLoaders(node,parent,t22[key],key);t22[key]=node;this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key2 in node.__listeners){let listener=node.__listeners[key2];let k=key2;if(node[key2]){delete listeners[node.__node.tag][key2];k=node.__node.tag+"."+key2;listeners[node.__node.tag][k]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][k]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][k]=parent.__node.tag}}}}node.__callConnected()}}}return listeners};remove=(node,clearListeners=true)=>{this.unsubscribe(node);if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){this.delete(node.__node.tag);delete this.__node.roots[node.__node.tag];if(clearListeners){this.clearListeners(node)}node.__callDisconnected();const recursiveRemove=t22=>{for(const key in t22){this.unsubscribe(t22[key]);this.delete(t22[key].__node.tag);delete this.__node.roots[t22[key].__node.tag];this.delete(key);delete this.__node.roots[key];t22[key].__node.tag=t22[key].__node.tag.substring(t22[key].__node.tag.lastIndexOf(".")+1);if(clearListeners){this.clearListeners(t22[key])}t22[key].__callDisconnected();if(t22[key].__children){recursiveRemove(t22[key].__children)}}};if(node.__children){recursiveRemove(node.__children)}}if(node?.__node.tag&&node?.__parent){delete node?.__parent;node.__node.tag=node.__node.tag.substring(node.__node.tag.indexOf(".")+1)}if(node?.__node.graph)node.__node.graph=void 0;return node};run=(node,...args)=>{if(typeof node==="string"){let nd=this.get(node);if(!nd&&node.includes(".")){nd=this.get(node.substring(0,node.lastIndexOf(".")));if(typeof nd?.[node.substring(node.lastIndexOf(".")+1)]==="function")return nd[node.substring(node.lastIndexOf(".")+1)](...args)}else if(nd?.__operator)return nd.__operator(...args)}if(node?.__operator){return node?.__operator(...args)}};setListeners=listeners=>{for(const key in listeners){let node=this.get(key);if(typeof listeners[key]==="object"){for(const k in listeners[key]){let n=this.get(k);let sub;if(typeof listeners[key][k]!=="object")listeners[key][k]={__callback:listeners[key][k]};else if(!listeners[key][k].__callback){for(const kk in listeners[key][k]){if(typeof listeners[key][k][kk]!=="object"){listeners[key][k][kk]={__callback:listeners[key][k][kk]};if(node.__operator&&(listeners[key][k][kk].__callback===true||typeof listeners[key][k][kk].__callback==="undefined"))listeners[key][k][kk].__callback=node.__operator}let nn=this.get(kk);if(!nn){let tag=k.substring(0,k.lastIndexOf("."));nn=this.get(tag);if(nn){let prop=k.substring(k.lastIndexOf(".")+1);sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k][kk].__args,prop,listeners[key][k][kk].inputState,key,k)}}else{sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}if("__callback"in listeners[key][k]){if(node){if(listeners[key][k].__callback===true||typeof listeners[key][k].__callback==="undefined")listeners[key][k].__callback=node.__operator;if(typeof listeners[key][k].__callback==="function")listeners[key][k].__callback=listeners[key][k].__callback.bind(node)}if(!n){let tag=k.substring(0,k.lastIndexOf("."));n=this.get(tag);if(n){sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,k.substring(k.lastIndexOf(".")+1),listeners[key][k].inputState,key,k)}}else{sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}}}};clearListeners=(node,listener)=>{if(typeof node==="string")node=this.get(node);if(node?.__listeners){for(const key in node.__listeners){if(listener&&key!==listener)continue;if(typeof node.__listeners[key]?.sub!=="number")continue;let n=this.get(key);if(!n){n=this.get(key.substring(0,key.lastIndexOf(".")));if(n){if(typeof node.__listeners[key]==="object"&&!node.__listeners[key]?.__callback){for(const k in node.__listeners[key]){if(typeof node.__listeners[key][k]?.sub==="number"){this.unsubscribe(n,node.__listeners[key][k].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}else{if(typeof!node.__listeners[key]?.__callback==="number"){for(const k in node.__listeners[key]){if(node.__listeners[key][k]?.sub){this.unsubscribe(n,node.__listeners[key][k].sub,void 0,node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,void 0,node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}}};get=tag=>{return this.__node.nodes.get(tag)};set=(tag,node)=>{return this.__node.nodes.set(tag,node)};delete=tag=>{return this.__node.nodes.delete(tag)};getProps=(node,getInitial)=>{if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){let cpy;if(getInitial)cpy=Object.assign({},this.__node.roots[node.__node.tag]);else{cpy=Object.assign({},node);for(const key in cpy){if(key.includes("__"))delete cpy[key]}}}};subscribe=(nodeEvent,onEvent,args,key,subInput,target,bound,tkey)=>{let nd=nodeEvent;if(typeof nodeEvent==="string"){nd=this.get(nodeEvent);if(!nd&&nodeEvent.includes(".")){nd=this.get(nodeEvent.substring(0,nodeEvent.lastIndexOf(".")));key=nodeEvent.substring(nodeEvent.lastIndexOf(".")+1)}}if(target instanceof GraphNode)target=target.__node.tag;if(typeof onEvent==="string"){let setOnEventFromString=onEvent2=>{if(this.get(onEvent2)?.__operator){let node=this.get(onEvent2);target=onEvent2;onEvent2=function(...inp){return node.__operator(...inp)}}else if(onEvent2.includes(".")){target=onEvent2.substring(0,onEvent2.lastIndexOf("."));let n=this.get(target);let k=onEvent2.substring(onEvent2.lastIndexOf(".")+1);tkey=k;if(typeof n[k]==="function"){if(n[k]instanceof GraphNode)onEvent2=n[k];else onEvent2=function(...inp){return n[k](...inp)}}else{onEvent2=function(inp){n[k]=inp;return n[k]}}}return onEvent2};if(target){let node=this.get(target);if(typeof node?.[onEvent]==="function"){tkey=onEvent;onEvent=function(...inp){return node[key](...inp)}}else if(node[key]){tkey=key;if(node[key]instanceof GraphNode)onEvent=node[key];else onEvent=function(inp){node[key]=inp;return node[key]}}else{onEvent=setOnEventFromString(onEvent)}}else{onEvent=setOnEventFromString(onEvent)}}let sub;if(nd instanceof GraphNode){const doSub=()=>{sub=nd.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)nd.__unsubscribe(sub,key,subInput);sub=void 0};nd.__addOndisconnected(()=>{ondelete();nd.__addOnconnected(()=>{if(sub===void 0&&nd.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))onEvent=this.get(onEvent);if(onEvent instanceof GraphNode){onEvent.__addOndisconnected(()=>{ondelete()})}};doSub()}else if(typeof nodeEvent==="string"){let node=this.get(nodeEvent);if(node){if(onEvent instanceof GraphNode&&onEvent.__operator){const doSub=()=>{sub=node.__subscribe(onEvent.__operator,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput)};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});onEvent.__addOndisconnected(ondelete)};doSub()}else if(typeof onEvent==="function"||typeof onEvent==="string"){const doSub=()=>{sub=node.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput);sub=void 0};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))this.get(onEvent).__addOndisconnected(ondelete)};doSub()}}else{if(typeof onEvent==="string")onEvent=this.__node.nodes.get(onEvent).__operator;if(typeof onEvent==="function")sub=this.__node.state.subscribeEvent(nodeEvent,onEvent)}}return sub};unsubscribe=(node,sub,key,subInput)=>{if(node instanceof GraphNode){return node.__unsubscribe(sub,key,subInput)}else return this.get(node)?.__unsubscribe(sub,key,subInput)};setState=update=>{this.__node.state.setState(update)}};function recursivelyAssign(target,obj,maxDepth=Infinity,curDepth=0){for(const key in obj){if(obj[key]?.constructor.name==="Object"&&curDepth<maxDepth){curDepth++;if(target[key]?.constructor.name==="Object")recursivelyAssign(target[key],obj[key],maxDepth,curDepth);else target[key]=recursivelyAssign({},obj[key],maxDepth,curDepth)}else{target[key]=obj[key]}}return target}function getAllProperties(obj){var allProps=[],curr=obj;do{var props=Object.getOwnPropertyNames(curr);let fn=function(prop){if(allProps.indexOf(prop)===-1)allProps.push(prop)};props.forEach(fn)}while(curr=Object.getPrototypeOf(curr));return allProps}function isNativeClass(thing){return isFunction(thing)==="class"}function isFunction(x3){const res=typeof x3==="function"?x3.prototype?Object.getOwnPropertyDescriptor(x3,"prototype")?.writable?"function":"class":x3.constructor.name==="AsyncFunction"?"async":"arrow":"";return res}var getCallbackFromString=(a,graph)=>{if(graph.get(a)?.__operator){let node=graph.get(a);return(...inp)=>{node.__operator(...inp)}}else if(a.includes(".")){let split=a.split(".");let popped=split.pop();let joined=split.join(".");let node=graph.get(joined);if(typeof graph.get(joined)?.[popped]==="function"){return(...inp)=>{return node[popped](...inp)}}else return()=>{return node[popped]}}else if(graph.get(a)){let node=graph.get(a);return()=>{return node}}else{let arg=a;return()=>{return arg}}};var wrapArgs=(callback,argOrder,graph)=>{let args=[];let forArg=(a,i22)=>{if(a==="__output"||a==="__input"||a==="__callback"){args[i22]={__callback:inp=>{return inp},__args:void 0,idx:i22}}else if(typeof a==="string"){args[i22]={__callback:getCallbackFromString(a,graph),__args:void 0,idx:i22}}else if(typeof a==="function"){let fn2=a;args[i22]={__callback:(...inp)=>{return fn2(...inp)},__args:void 0,idx:i22}}else if(typeof a==="object"&&(a.__input||a.__callback)){let recursivelyCreateCallback=function(c){let input=c.__input?c.__input:c.__callback;if(typeof c.__input==="string"){input={__callback:getCallbackFromString(c.__input,graph),__args:void 0,idx:i22}}if(c.__args){let wrapped=wrapArgs(input,c.__args,graph);input={__callback:wrapped.__callback,__args:wrapped.__args,idx:i22}}else{input={__callback:input,__args:void 0,idx:i22}}if(c.__output){let output=c.__output;if(typeof c.__output==="string"){output={__callback:getCallbackFromString(output,graph),__args:void 0,idx:i22}}else if(typeof a.__output==="object"){output=recursivelyCreateCallback(output)}if(typeof output?.__callback==="function"){let fn2=input.__callback;let callback2=output.__callback;input={__callback:(...inp)=>{return callback2(fn2(...inp))},__args:output.__args,idx:i22}}}return input};args[i22]=recursivelyCreateCallback(a)}else{let arg=a;args[i22]={__callback:()=>{return arg},__args:void 0,idx:i22}}};argOrder.forEach(forArg);if(typeof callback==="string")callback={__callback:getCallbackFromString(callback,graph),__args:void 0};let fn=typeof callback==="function"?callback:callback.__callback;callback=function(...inp){let mapArg=arg=>{return arg.__callback(...inp)};const result=fn(...args.map(mapArg));return result};return{__callback:callback,__args:args}};var objProps=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var backprop=(node,parent,graph)=>{if(node.__node.backward&&parent instanceof GraphNode){graph.setListeners({[parent.__node.tag]:{[node.__node.tag]:parent}})}};var loop=(node,parent,graph)=>{if(node.__operator&&!node.__node.looperSet){if(typeof node.__node.delay==="number"){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{setTimeout(async()=>{res(await fn(...args))},node.__node.delay)})})}else if(node.__node.frame===true){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{requestAnimationFrame(async()=>{res(await fn(...args))})})})}if(typeof node.__node.repeat==="number"||typeof node.__node.recursive==="number"){let fn=node.__operator;node.__setOperator(async(...args)=>{let i22=node.__node.repeat?node.__node.repeat:node.__node.recursive;let result;let repeater=async(tick,...inp)=>{while(tick>0){if(node.__node.delay||node.__node.frame){fn(...inp).then(async res=>{if(node.__node.recursive){await repeater(tick,res)}else await repeater(tick,...inp)});break}else result=await fn(...args);tick--}};await repeater(i22,...args);return result})}if(node.__node.loop&&typeof node.__node.loop==="number"){node.__node.looperSet=true;let fn=node.__operator;let time=node.__node.loop;node.__setOperator((...args)=>{if(!("looping"in node.__node))node.__node.looping=true;if(node.__node.looping){let last=performance.now();fn(...args);setTimeout(()=>{let now=performance.now();let overshoot=now-last-node.__node.loop;if(overshoot>0)time=node.__node.loop-overshoot;else time=node.__node.loop;if(time<=0)time=node.__node.loop;node.__operator(...args)},time)}});if(node.__node.looping)node.__operator();let ondelete=node2=>{if(node2.__node.looping)node2.__node.looping=false};node.__addOndisconnected(ondelete)}}};var animate=(node,parent,graph)=>{if(node.__node.animate===true||node.__animation){let fn=node.__operator;node.__setOperator((...args)=>{if(!("animating"in node.__node))node.__node.animating=true;if(node.__node.animating){if(typeof node.__animation==="function")node.__animation(...args);else fn(...args);requestAnimationFrame(()=>{node.__operator(...args)})}});if(node.__node.animating||(!("animating"in node.__node)||node.__node.animating)&&node.__animation)setTimeout(()=>{requestAnimationFrame(node.__operator)},10);let ondelete=node2=>{if(node2.__node.animating)node2.__node.animating=false};node.__addOndisconnected(ondelete)}};var branching=(node,parent,graph)=>{if(typeof node.__branch==="object"&&node.__operator&&!node.__branchApplied){let fn=node.__operator;node.__branchApplied=true;node.__operator=(...args)=>{let result=fn(...args);for(const key in node.__branch){let triggered=()=>{if(typeof node.__branch[key].then==="function"){node.__branch[key].then(result)}else if(node.__branch[key].then instanceof GraphNode&&node.__branch[key].then.__operator){node.__branch[key].then.__operator(result)}else result=node.__branch[key].then};if(typeof node.__branch[key].if==="function"){if(node.__branch[key].if(result)==true){triggered()}}else if(node.__branch[key].if===result){triggered()}}return result}}if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].branch&&!node.__listeners[key].branchApplied){let fn=node.__listeners[key].callback;node.__listeners[key].branchApplied=true;node.__listeners.callback=ret=>{let triggered=()=>{if(typeof node.__listeners[key].branch.then==="function"){ret=node.__listeners[key].branch.then(ret)}else if(node.__listeners[key].branch.then instanceof GraphNode&&node.__listeners[key].branch.then.__operator){ret=node.__listeners[key].branch.then.__operator(ret)}else ret=node.__listeners[key].branch.then};if(typeof node.__listeners[key].branch.if==="function"){if(node.__listeners[key].branch.if(ret)){triggered()}}else if(node.__listeners[key].branch.if===ret){triggered()}return fn(ret)}}}}}};var triggerListenerOncreate=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].oncreate){node.__listeners[key].callback(node.__listeners[key].oncreate)}}}}};var bindListener=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].binding==="object"){node.__listeners.callback=node.__listeners.callback.bind(node.__listeners[key].binding)}}}}};var transformListenerResult=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].transform==="function"&&!node.__listeners[key].transformApplied){let fn=node.__listeners[key].callback;node.__listeners[key].transformApplied=true;node.__listeners.callback=ret=>{ret=node.__listeners[key].transform(ret);return fn(ret)}}}}}};var substitute__operator=(node,parent,graph)=>{if(node.post&&!node.__operator){node.__setOperator(node.post)}else if(!node.__operator&&typeof node.get=="function"){node.__setOperator(node.get)}if(!node.get&&node.__operator){node.get=node.__operator}if(node.aliases){node.aliases.forEach(a=>{graph.set(a,node);let ondelete=node2=>{graph.__node.nodes.delete(a)};node.__addOndisconnected(ondelete)})}if(typeof graph.__node.roots?.[node.__node.tag]==="object"&&node.get)graph.__node.roots[node.__node.tag].get=node.get};var loaders={backprop,loop,animate,branching,triggerListenerOncreate,bindListener,transformListenerResult,substitute__operator};var recursivelyStringifyFunctions=obj=>{let cpy={};for(const key in obj){if(typeof obj[key]==="object"){cpy[key]=recursivelyStringifyFunctions(obj[key])}else if(typeof obj[key]==="function"){cpy[key]=obj[key].toString()}else cpy[key]=obj[key]}return cpy};function parseFunctionFromText(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs23(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs}var stringifyFast=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p2 in value[prop]){if(Array.isArray(value[prop][p2])){if(value[prop][p2].length>20)obj[prop][p2]=value[prop][p2].slice(value[prop][p2].length-20);else obj[prop][p2]=value[prop][p2]}else{if(value[prop][p2]!=null){let con=value[prop][p2].constructor.name;if(con.includes("Set")){obj[prop][p2]=Array.from(value[prop][p2])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p2]="instanceof_"+con}else{obj[prop][p2]=value[prop][p2]}}else{obj[prop][p2]=value[prop][p2]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast23(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast}function methodstrings(node){if(typeof node.__methods==="object"){for(const key in node.__methods){let fstr=node.__methods[key];let fn=typeof fstr==="function"?fstr:parseFunctionFromText(fstr);if(key==="__operator"){node.__setOperator(fn)}else{node[key]=fn.bind(node)}}}}var Service=class extends Graph{name=`service${Math.floor(Math.random()*1e15)}`;constructor(options){super({...options,loaders:options?.loaders?Object.assign({...loaders},options.loaders):{...loaders}});if(options?.services)this.addServices(options.services);this.load(this)}addServices=services=>{for(const s in services){if(typeof services[s]==="function")services[s]=new services[s];if(services[s]?.__node?.loaders)Object.assign(this.__node.loaders,services[s].__node.loaders);if(services[s]?.__node?.nodes){services[s].__node.nodes.forEach((n,tag)=>{if(!this.get(tag)){this.set(tag,n)}else this.set(s+"."+tag,n)});this.__node.nodes.forEach((n,k)=>{if(!services[s].__node.nodes.get(k))services[s].__node.nodes.set(k,n)});let set=this.set;this.set=(tag,node)=>{services[s].set(tag,node);return set(tag,node)};let del=this.delete;this.delete=tag=>{services[s].delete(tag);return del(tag)}}else if(typeof services[s]==="object"){this.load(services[s])}}};handleMethod=(route,method,args)=>{let m=method.toLowerCase();let src=this.__node.nodes.get(route);if(!src){src=this.__node.roots[route]}if(src?.[m]){if(typeof src[m]!=="function"){if(args){if(Array.isArray(args)&&args.length===1)src[m]=args[0];else src[m]=args;return}return src[m]}else{if(Array.isArray(args))return src[m](...args);else return src[m](args)}}else return this.handleServiceMessage({route,args,method})};handleServiceMessage(message){let call;if(typeof message==="object"){if(message.route)call=message.route;else if(message.node)call=message.node}if(call){if(Array.isArray(message.args))return this.run(call,...message.args);else return this.run(call,message.args)}else return message}handleGraphNodeCall(route,args){if(!route)return args;if(args?.args){this.handleServiceMessage(args)}else if(Array.isArray(args))return this.run(route,...args);else return this.run(route,args)}transmit=(...args)=>{if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};receive=(...args)=>{if(args[0]){if(typeof args[0]==="string"){let substr=args[0].substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))args[0]=args[0].replace(/\\\\/g,"");if(args[0][0]===\'"\'){args[0]=args[0].substring(1,args[0].length-1)};args[0]=JSON.parse(args[0])}}}if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};pipe=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return this.subscribe(source,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})};pipeOnce=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return source.__node.state.subscribeEventOnce(source.__node.unique,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.__node.state.subscribeEventOnce(source.__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(source).__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})};terminate=(...args)=>{};isTypedArray=isTypedArray;recursivelyAssign=recursivelyAssign2;spliceTypedArray=spliceTypedArray;ping=()=>{console.log("pinged!");return"pong"};echo=(...args)=>{this.transmit(...args);return args};log=(...args)=>{console.log(...args);return true};error=(...args)=>{console.error(...args);return true}};function isTypedArray(x3){return ArrayBuffer.isView(x3)&&Object.prototype.toString.call(x3)!=="[object DataView]"}var recursivelyAssign2=(target,obj)=>{for(const key in obj){if(obj[key]?.constructor.name==="Object"&&!Array.isArray(obj[key])){if(target[key]?.constructor.name==="Object"&&!Array.isArray(target[key]))recursivelyAssign2(target[key],obj[key]);else target[key]=recursivelyAssign2({},obj[key])}else target[key]=obj[key]}return target};function spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let ta;if(s.length>0||e?.length>0)ta=new arr.constructor(s.length+e.length);if(ta){if(s.length>0)ta.set(s);if(e&&e.length>0)ta.set(e,s.length)}return ta}var nodeTemplates={};var remoteGraphRoutes={transferNode:(properties,connection,name2)=>{let str3;if(typeof properties==="object"){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}str3=recursivelyStringifyFunctions(properties)}else if(typeof properties==="function")str3=properties.toString();else if(typeof properties==="string")str3=properties;if(str3){if(connection.run)return connection.run("setNode",[str3]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:str3},void 0);return new Promise(r=>r(name2))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:str3}));return new Promise(r=>r(name2))}}},setNode:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function")properties={__operator:f,__node:{tag:name2?name2:f.name}};else{f=JSON.parse(properties);if(typeof f==="object")properties=f}}if(typeof properties==="object"||typeof properties==="function"){let template={};if(typeof properties==="object")Object.assign(template,properties);else template.__operator=properties;let node=this.__node.graph.add(template);if(node){nodeTemplates[node.__node.tag]=template;return node.__node?.tag}else return false}else return false},proxyRemoteNode:function(name2,connection){return new Promise((res,rej)=>{connection.run("getNodeProperties",name2).then(props=>{let proxy={};if(typeof props==="object"){for(const key in props){if(props[key]==="function"){proxy[key]=(...args)=>{return new Promise(r=>{connection.run(name2,args,key).then(r)})}}else{Object.defineProperty(proxy,key,{get:()=>{return new Promise(r=>{connection.run(name2,void 0,key).then(r)})},set:value=>{connection.post(name2,value,key)},configurable:true,enumerable:true})}}}res(proxy)})})},makeNodeTransferrable:function(properties,name2){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}const str3=recursivelyStringifyFunctions(properties);return str3},setTemplate:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function"){if(!name2)name2=f.name;properties={__operator:f,__node:{tag:name2}}}else{f=JSON.parse(properties);if(typeof f==="object"){properties=f;if(!name2&&f.__node?.tag)name2=f.__node.tag}}}if(!name2)name2=`node${Math.floor(Math.random()*1e15)}`;if(typeof properties==="object"||typeof properties==="function"){nodeTemplates[name2]=properties;return name2}else return false},loadFromTemplate:function(templateName,name2,properties){if(nodeTemplates[templateName]){let cpy=recursivelyAssign2({},nodeTemplates[templateName]);if(name2){if(!cpy.__node)cpy.__node={};cpy.__node.tag=name2}if(properties)Object.assign(cpy,properties);let node=this.__node.graph.add(cpy);return node.__node.tag}},setMethod:function(nodeTag,fn,methodKey){if(typeof fn==="string"){let f=parseFunctionFromText(fn);if(typeof f==="function")fn=f}if(!methodKey&&typeof fn==="function")methodKey=fn.name;if(this.__node.graph.get(nodeTag)){this.__node.graph.get(nodeTag)[methodKey]=fn}else this.__node.graph.add({__node:{tag:methodKey,[methodKey]:fn}});return true},assignNode:function(nodeTag,source){if(this.__node.graph.get(nodeTag)&&typeof source==="object"){Object.assign(this.__node.graph.get(nodeTag),source)}},getNodeProperties:function(nodeTag){let node=this.__node.graph.get(nodeTag);if(node){let properties=Object.getOwnPropertyNames(node);let result={};for(const key in properties){result[key]=typeof node[key]}return result}return void 0},transferClass:(classObj,connection,className)=>{if(typeof classObj==="object"){let str3=classObj.toString();let message={route:"receiveClass",args:[str3,className]};if(connection.run)return connection.run("receiveClass",[str3,className]);else if(connection.postMessage){connection.postMessage({route:"receiveClass",args:[str3,className]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"receiveClass",args:[str3,className]}));return new Promise(r=>r(name))}return message}return false},receiveClass:function(stringified,className){if(typeof stringified==="string"){if(stringified.indexOf("class")===0){let cls=(0,eval)("("+stringified+")");let name2=className;if(!name2)name2=cls.name;this.__node.graph[name2]=cls;return true}}return false},transferFunction:(fn,connection,fnName)=>{if(!fnName)fnName=fn.name;let str3=fn.toString();let message={route:"setNode",args:[str3,fnName]};if(connection.run)return connection.run("setNode",[str3,fnName]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:[str3,fnName]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:[str3,fnName]}));return new Promise(r=>r(name))}return message},setGlobal:(key,value)=>{globalThis[key]=value;return true},assignGlobalObject:(target,source)=>{if(!globalThis[target])return false;if(typeof source==="object")Object.assign(globalThis[target],source);return true},setValue:function(key,value){this.__node.graph[key]=value;return true},assignObject:function(target,source){if(!this.__node.graph[target])return false;if(typeof source==="object")Object.assign(this.__node.graph[target],source);return true},setGlobalFunction:(fn,fnName)=>{if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;globalThis[fnName]=fn;return true}return false},setGraphFunction:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.__node.graph[fnName]=fn;return true}return false}};function html(strings,...args){return function append(elm=document.createElement("div")){let template=document.createElement("template");strings.map(function(s,i22){template.innerHTML+=s;if(args[i22]instanceof HTMLElement){let dummy22=`<span id="dummyNode12345"></span>`;dummy22.id="dummyNode12345";template.innerHTML+=dummy22}else template.innerHTML+=args[i22]});let query=template.content.querySelectorAll("#dummyNode12345");let ctr=0;args.forEach((arg,i22)=>{if(arg instanceof HTMLElement){console.log(arg,query[ctr]);template.content.replaceChild(arg,query[ctr]);ctr++}});elm.appendChild(template.content);return elm}}var dummy=html``;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl.cipher.aes=function(a){this.s[0][0][0]||this.O();var b,c,d2,e,f=this.s[0][4],g=this.s[1];b=a.length;var h=1;if(4!==b&&6!==b&&8!==b)throw new sjcl.exception.invalid("invalid aes key size");this.b=[d2=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d2[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));d2[a]=d2[a-b]^c}for(b=0;a;b++,a--)c=d2[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]]};sjcl.cipher.aes.prototype={encrypt:function(a){return t(this,a,0)},decrypt:function(a){return t(this,a,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var a=this.s[0],b=this.s[1],c=a[4],d2=b[4],e,f,g,h=[],k=[],l,n,m,p2;for(e=0;256>e;e++)k[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=l||1,g=k[g]||1)for(m=g^g<<1^g<<2^g<<3^g<<4,m=m>>8^m&255^99,c[f]=m,d2[m]=f,n=h[e=h[l=h[f]]],p2=16843009*n^65537*e^257*l^16843008*f,n=257*h[m]^16843008*m,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p2=p2<<24^p2>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};function t(a,b,c){if(4!==b.length)throw new sjcl.exception.invalid("invalid aes block size");var d2=a.b[c],e=b[0]^d2[0],f=b[c?3:1]^d2[1],g=b[2]^d2[2];b=b[c?1:3]^d2[3];var h,k,l,n=d2.length/4-2,m,p2=4,r=[0,0,0,0];h=a.s[c];a=h[0];var q=h[1],v2=h[2],w=h[3],x3=h[4];for(m=0;m<n;m++)h=a[e>>>24]^q[f>>16&255]^v2[g>>8&255]^w[b&255]^d2[p2],k=a[f>>>24]^q[g>>16&255]^v2[b>>8&255]^w[e&255]^d2[p2+1],l=a[g>>>24]^q[b>>16&255]^v2[e>>8&255]^w[f&255]^d2[p2+2],b=a[b>>>24]^q[e>>16&255]^v2[f>>8&255]^w[g&255]^d2[p2+3],p2+=4,e=h,f=k,g=l;for(m=0;4>m;m++)r[c?3&-m:m]=x3[e>>>24]<<24^x3[f>>16&255]<<16^x3[g>>8&255]<<8^x3[b&255]^d2[p2++],h=e,e=f,f=g,g=b,b=h;return r}sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.$(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d2=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d2^a[b/32+1|0]>>>d2:a[b/32|0]>>>d2)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d2=sjcl.bitArray.getPartial(c);return 32===d2?a.concat(b):sjcl.bitArray.$(b,d2,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b=b&31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return false;var c=0,d2;for(d2=0;d2<a.length;d2++)c|=a[d2]^b[d2];return 0===c},$:function(a,b,c,d2){var e;e=0;for(void 0===d2&&(d2=[]);32<=b;b-=32)d2.push(c),c=0;if(0===b)return d2.concat(a);for(e=0;e<a.length;e++)d2.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d2.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d2.pop(),1));return d2},i:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&65280|(c&65280)<<8|c<<24;return a}};sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d2,e;for(d2=0;d2<c/8;d2++)0===(d2&3)&&(e=a[d2/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d2=0;for(c=0;c<a.length;c++)d2=d2<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d2),d2=0);c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d2));return b}};sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d2;a=a.replace(/\\s|0x/g,"");d2=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,4*d2)}};sjcl.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(a,b,c){var d2=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f="",g=0,h=sjcl.codec.base32.B,k=0,l=sjcl.bitArray.bitLength(a);c&&(h=sjcl.codec.base32.X);for(c=0;f.length*d2<l;)f+=h.charAt((k^a[c]>>>g)>>>e),g<d2?(k=a[c]<<d2-g,g+=e,c++):(k<<=d2,g-=d2);for(;f.length&7&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\\s|=/g,"").toUpperCase();var c=sjcl.codec.base32.BITS,d2=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f=[],g,h=0,k=sjcl.codec.base32.B,l=0,n,m="base32";b&&(k=sjcl.codec.base32.X,m="base32hex");for(g=0;g<a.length;g++){n=k.indexOf(a.charAt(g));if(0>n){if(!b)try{return sjcl.codec.base32hex.toBits(a)}catch(p2){}throw new sjcl.exception.invalid("this isn\'t "+m+"!")}h>e?(h-=e,f.push(l^n>>>h),l=n<<c-h):(h+=d2,l^=n<<c-h)}h&56&&f.push(sjcl.bitArray.partial(h&56,l,1));return f}};sjcl.codec.base32hex={fromBits:function(a,b){return sjcl.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl.codec.base32.toBits(a,1)}};sjcl.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d2="",e=0,f=sjcl.codec.base64.B,g=0,h=sjcl.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d2.length<h;)d2+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;d2.length&3&&!b;)d2+="=";return d2},toBits:function(a,b){a=a.replace(/\\s|=/g,"");var c=[],d2,e=0,f=sjcl.codec.base64.B,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d2=0;d2<a.length;d2++){h=f.indexOf(a.charAt(d2));if(0>h)throw new sjcl.exception.invalid("this isn\'t base64!");26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e)}e&56&&c.push(sjcl.bitArray.partial(e&56,g,1));return c}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}};sjcl.hash.sha256=function(a){this.b[0]||this.O();a?(this.F=a.F.slice(0),this.A=a.A.slice(0),this.l=a.l):this.reset()};sjcl.hash.sha256.hash=function(a){return new sjcl.hash.sha256().update(a).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.A=sjcl.bitArray.concat(this.A,a);b=this.l;a=this.l=b+sjcl.bitArray.bitLength(a);if(9007199254740991<a)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d2=new Uint32Array(c),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u(this,d2.subarray(16*e,16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u(this,c.splice(0,16));return this},finalize:function(){var a,b=this.A,c=this.F,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.l/4294967296));for(b.push(this.l|0);b.length;)u(this,b.splice(0,16));this.reset();return c},Y:[],b:[],O:function(){function a(a2){return 4294967296*(a2-Math.floor(a2))|0}for(var b=0,c=2,d2,e;64>b;c++){e=true;for(d2=2;d2*d2<=c;d2++)if(0===c%d2){e=false;break}e&&(8>b&&(this.Y[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}};function u(a,b){var c,d2,e,f=a.F,g=a.b,h=f[0],k=f[1],l=f[2],n=f[3],m=f[4],p2=f[5],r=f[6],q=f[7];for(c=0;64>c;c++)16>c?d2=b[c]:(d2=b[c+1&15],e=b[c+14&15],d2=b[c&15]=(d2>>>7^d2>>>18^d2>>>3^d2<<25^d2<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c&15]+b[c+9&15]|0),d2=d2+q+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(r^m&(p2^r))+g[c],q=r,r=p2,p2=m,m=n+d2|0,n=l,l=k,k=h,h=d2+(k&l^n&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+n|0;f[4]=f[4]+m|0;f[5]=f[5]+p2|0;f[6]=f[6]+r|0;f[7]=f[7]+q|0}sjcl.mode.ccm={name:"ccm",G:[],listenProgress:function(a){sjcl.mode.ccm.G.push(a)},unListenProgress:function(a){a=sjcl.mode.ccm.G.indexOf(a);-1<a&&sjcl.mode.ccm.G.splice(a,1)},fa:function(a){var b=sjcl.mode.ccm.G.slice(),c;for(c=0;c<b.length;c+=1)b[c](a)},encrypt:function(a,b,c,d2,e){var f,g=b.slice(0),h=sjcl.bitArray,k=h.bitLength(c)/8,l=h.bitLength(g)/8;e=e||64;d2=d2||[];if(7>k)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&l>>>8*f;f++);f<15-k&&(f=15-k);c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.V(a,b,c,d2,e,f);g=sjcl.mode.ccm.C(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d2,e){e=e||64;d2=d2||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/8;if(7>g)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&h>>>8*b;b++);b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));k=sjcl.mode.ccm.C(a,k,c,l,e,b);a=sjcl.mode.ccm.V(a,k.data,c,d2,e,b);if(!f.equal(k.tag,a))throw new sjcl.exception.corrupt("ccm: tag doesn\'t match");return k.data},na:function(a,b,c,d2,e,f){var g=[],h=sjcl.bitArray,k=h.i;d2=[h.partial(8,(b.length?64:0)|d2-2<<2|f-1)];d2=h.concat(d2,c);d2[3]|=e;d2=a.encrypt(d2);if(b.length)for(c=h.bitLength(b)/8,65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,b),b=0;b<g.length;b+=4)d2=a.encrypt(k(d2,g.slice(b,b+4).concat([0,0,0])));return d2},V:function(a,b,c,d2,e,f){var g=sjcl.bitArray,h=g.i;e/=8;if(e%2||4>e||16<e)throw new sjcl.exception.invalid("ccm: invalid tag length");if(4294967295<d2.length||4294967295<b.length)throw new sjcl.exception.bug("ccm: can\'t deal with 4GiB or more data");c=sjcl.mode.ccm.na(a,d2,c,e,g.bitLength(b)/8,f);for(d2=0;d2<b.length;d2+=4)c=a.encrypt(h(c,b.slice(d2,d2+4).concat([0,0,0])));return g.clamp(c,8*e)},C:function(a,b,c,d2,e,f){var g,h=sjcl.bitArray;g=h.i;var k=b.length,l=h.bitLength(b),n=k/50,m=n;c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d2=h.bitSlice(g(d2,a.encrypt(c)),0,e);if(!k)return{tag:d2,data:[]};for(g=0;g<k;g+=4)g>n&&(sjcl.mode.ccm.fa(g/k),n+=m),c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d2,data:h.clamp(b,l)}}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d2,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var g,h=sjcl.mode.ocb2.S,k=sjcl.bitArray,l=k.i,n=[0,0,0,0];c=h(a.encrypt(c));var m,p2=[];d2=d2||[];e=e||64;for(g=0;g+4<b.length;g+=4)m=b.slice(g,g+4),n=l(n,m),p2=p2.concat(l(c,a.encrypt(l(c,m)))),c=h(c);m=b.slice(g);b=k.bitLength(m);g=a.encrypt(l(c,[0,0,0,b]));m=k.clamp(l(m.concat([0,0,0]),g),b);n=l(n,l(m.concat([0,0,0]),g));n=a.encrypt(l(n,l(c,h(c))));d2.length&&(n=l(n,f?d2:sjcl.mode.ocb2.pmac(a,d2)));return p2.concat(k.concat(m,k.clamp(n,e)))},decrypt:function(a,b,c,d2,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");e=e||64;var g=sjcl.mode.ocb2.S,h=sjcl.bitArray,k=h.i,l=[0,0,0,0],n=g(a.encrypt(c)),m,p2,r=sjcl.bitArray.bitLength(b)-e,q=[];d2=d2||[];for(c=0;c+4<r/32;c+=4)m=k(n,a.decrypt(k(n,b.slice(c,c+4)))),l=k(l,m),q=q.concat(m),n=g(n);p2=r-32*c;m=a.encrypt(k(n,[0,0,0,p2]));m=k(m,h.clamp(b.slice(c),p2).concat([0,0,0]));l=k(l,m);l=a.encrypt(k(l,k(n,g(n))));d2.length&&(l=k(l,f?d2:sjcl.mode.ocb2.pmac(a,d2)));if(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))throw new sjcl.exception.corrupt("ocb: tag doesn\'t match");return q.concat(h.clamp(m,p2))},pmac:function(a,b){var c,d2=sjcl.mode.ocb2.S,e=sjcl.bitArray,f=e.i,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d2(d2(h)));for(c=0;c+4<b.length;c+=4)h=d2(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d2(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d2(f(h,d2(h))),g))},S:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d2,e){var f=b.slice(0);b=sjcl.bitArray;d2=d2||[];a=sjcl.mode.gcm.C(true,a,f,d2,c,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c,d2,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);e=e||128;d2=d2||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.C(false,a,f,d2,c,e);if(!g.equal(a.tag,b))throw new sjcl.exception.corrupt("gcm: tag doesn\'t match");return a.data},ka:function(a,b){var c,d2,e,f,g,h=sjcl.bitArray.i;e=[0,0,0,0];f=b.slice(0);for(c=0;128>c;c++){(d2=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d2=3;0<d2;d2--)f[d2]=f[d2]>>>1|(f[d2-1]&1)<<31;f[0]>>>=1;g&&(f[0]^=-520093696)}return e},j:function(a,b,c){var d2,e=c.length;b=b.slice(0);for(d2=0;d2<e;d2+=4)b[0]^=4294967295&c[d2],b[1]^=4294967295&c[d2+1],b[2]^=4294967295&c[d2+2],b[3]^=4294967295&c[d2+3],b=sjcl.mode.gcm.ka(b,a);return b},C:function(a,b,c,d2,e,f){var g,h,k,l,n,m,p2,r,q=sjcl.bitArray;m=c.length;p2=q.bitLength(c);r=q.bitLength(d2);h=q.bitLength(e);g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=q.concat(e,[1])):(e=sjcl.mode.gcm.j(g,[0,0,0,0],e),e=sjcl.mode.gcm.j(g,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl.mode.gcm.j(g,[0,0,0,0],d2);n=e.slice(0);d2=h.slice(0);a||(d2=sjcl.mode.gcm.j(g,h,c));for(l=0;l<m;l+=4)n[3]++,k=b.encrypt(n),c[l]^=k[0],c[l+1]^=k[1],c[l+2]^=k[2],c[l+3]^=k[3];c=q.clamp(c,p2);a&&(d2=sjcl.mode.gcm.j(g,h,c));a=[Math.floor(r/4294967296),r&4294967295,Math.floor(p2/4294967296),p2&4294967295];d2=sjcl.mode.gcm.j(g,d2,a);k=b.encrypt(e);d2[0]^=k[0];d2[1]^=k[1];d2[2]^=k[2];d2[3]^=k[3];return{tag:q.bitSlice(d2,0,f),data:c}}};sjcl.misc.hmac=function(a,b){this.W=b=b||sjcl.hash.sha256;var c=[[],[]],d2,e=b.prototype.blockSize/32;this.w=[new b,new b];a.length>e&&(a=b.hash(a));for(d2=0;d2<e;d2++)c[0][d2]=a[d2]^909522486,c[1][d2]=a[d2]^1549556828;this.w[0].update(c[0]);this.w[1].update(c[1]);this.R=new b(this.w[0])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){if(this.aa)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");this.update(a);return this.digest(a)};sjcl.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=false};sjcl.misc.hmac.prototype.update=function(a){this.aa=true;this.R.update(a)};sjcl.misc.hmac.prototype.digest=function(){var a=this.R.finalize(),a=new this.W(this.w[1]).update(a).finalize();this.reset();return a};sjcl.misc.pbkdf2=function(a,b,c,d2,e){c=c||1e4;if(0>d2||0>c)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,k,l=[],n=sjcl.bitArray;for(k=1;32*l.length<(d2||1);k++){e=f=a.encrypt(n.concat(b,[k]));for(g=1;g<c;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];l=l.concat(e)}d2&&(l=n.clamp(l,d2));return l};sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=a;this.D=false;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=3e4;this.ba=80};sjcl.prng.prototype={randomWords:function(a,b){var c=[],d2;d2=this.isReady(b);var e;if(d2===this.u)throw new sjcl.exception.notReady("generator isn\'t seeded");if(d2&this.J){d2=!(d2&this.I);e=[];var f=0,g;this.Z=e[0]=new Date().valueOf()+this.da;for(g=0;16>g;g++)e.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.m[g],this.m[g]=0,d2||!(this.P&1<<g));g++);this.P>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.m.push(0));this.f-=f;f>this.o&&(this.o=f);this.P++;this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.L=new sjcl.cipher.aes(this.b);for(d2=0;4>d2&&(this.h[d2]=this.h[d2]+1|0,!this.h[d2]);d2++);}for(d2=0;d2<a;d2+=4)0===(d2+1)%this.ca&&y(this),e=z(this),c.push(e[0],e[1],e[2],e[3]);y(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=a},addEntropy:function(a,b,c){c=c||"user";var d2,e,f=new Date().valueOf(),g=this.H[c],h=this.isReady(),k=0;d2=this.U[c];void 0===d2&&(d2=this.U[c]=this.ha++);void 0===g&&(g=this.H[c]=0);this.H[c]=(this.H[c]+1)%this.c.length;switch(typeof a){case"number":void 0===b&&(b=1);this.c[g].update([d2,this.N++,1,b,f,1,a|0]);break;case"object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(k=1),c=0;c<a.length&&!k;c++)"number"!==typeof a[c]&&(k=1);if(!k){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e=e>>>1;this.c[g].update([d2,this.N++,2,b,f,a.length].concat(a))}break;case"string":void 0===b&&(b=a.length);this.c[g].update([d2,this.N++,3,b,f,a.length]);this.c[g].update(a);break;default:k=1}if(k)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[g]+=b;this.f+=b;h===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},isReady:function(a){a=this.T[void 0!==a?a:this.M];return this.o&&this.o>=a?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=a?this.J|this.u:this.u},getProgress:function(a){a=this.T[a?a:this.M];return this.o>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,false),window.addEventListener("mousemove",this.a.mouseCollector,false),window.addEventListener("keypress",this.a.keyboardCollector,false),window.addEventListener("devicemotion",this.a.accelerometerCollector,false),window.addEventListener("touchmove",this.a.touchCollector,false);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl.exception.bug("can\'t attach event");this.D=true}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,false),window.removeEventListener("mousemove",this.a.mouseCollector,false),window.removeEventListener("keypress",this.a.keyboardCollector,false),window.removeEventListener("devicemotion",this.a.accelerometerCollector,false),window.removeEventListener("touchmove",this.a.touchCollector,false)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=false)},addEventListener:function(a,b){this.K[a][this.ga++]=b},removeEventListener:function(a,b){var c,d2,e=this.K[a],f=[];for(d2 in e)e.hasOwnProperty(d2)&&e[d2]===b&&f.push(d2);for(c=0;c<f.length;c++)d2=f[c],delete e[d2]},la:function(){C(this,1)},oa:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d2){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,"mouse");C(this,0)},qa:function(a){a=a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C(this,0)},ma:function(){C(this,2)},ea:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C(this,0)}};function A(a,b){var c,d2=sjcl.random.K[a],e=[];for(c in d2)d2.hasOwnProperty(c)&&e.push(d2[c]);for(c=0;c<e.length;c++)e[c](b)}function C(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy(new Date().valueOf(),b,"loadtime")}function y(a){a.b=z(a).concat(z(a));a.L=new sjcl.cipher.aes(a.b)}function z(a){for(var b=0;4>b&&(a.h[b]=a.h[b]+1|0,!a.h[b]);b++);return a.L.encrypt(a.h)}function B(a,b){return function(){b.apply(a,arguments)}}sjcl.random=new sjcl.prng(6);a:try{if(G="undefined"!==typeof module&&module.exports){try{H=__require2("crypto")}catch(a){H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array(new Uint8Array(D).buffer),sjcl.random.addEntropy(D,1024,"crypto[\'randomBytes\']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F);else break a;sjcl.random.addEntropy(F,1024,"crypto[\'getRandomValues\']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}var D;var E;var F;var G;var H;sjcl.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(a,b,c,d2){c=c||{};d2=d2||{};var e=sjcl.json,f=e.g({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.g(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl.codec.base64.toBits(f.iv));if(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)throw new sjcl.exception.invalid("json encrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));"string"===typeof c&&(f.adata=c=sjcl.codec.utf8String.toBits(c));g=new sjcl.cipher[f.cipher](a);e.g(d2,f);d2.key=a;f.ct="ccm"===f.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(g,b,f.iv,c,f.ts):sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f},encrypt:function(a,b,c,d2){var e=sjcl.json,f=e.ja.apply(e,arguments);return e.encode(f)},ia:function(a,b,c,d2){c=c||{};d2=d2||{};var e=sjcl.json;b=e.g(e.g(e.g({},e.defaults),b),c,true);var f,g;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv));if(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjcl.exception.invalid("json decrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl.codec.utf8String.toBits(f));g=new sjcl.cipher[b.cipher](a);f="ccm"===b.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(g,b.ct,b.iv,b.tag,f,b.ts):sjcl.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.g(d2,b);d2.key=a;return 1===c.raw?f:sjcl.codec.utf8String.fromBits(f)},decrypt:function(a,b,c,d2){var e=sjcl.json;return e.ia(a,e.decode(b),c,d2)},encode:function(a){var b,c="{",d2="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");c+=d2+\'"\'+b+\'":\';d2=",";switch(typeof a[b]){case"number":case"boolean":c+=a[b];break;case"string":c+=\'"\'+escape(a[b])+\'"\';break;case"object":c+=\'"\'+sjcl.codec.base64.fromBits(a[b],0)+\'"\';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return c+"}"},decode:function(a){a=a.replace(/\\s/g,"");if(!a.match(/^\\{.*\\}$/))throw new sjcl.exception.invalid("json decode: this isn\'t json!");a=a.replace(/^\\{|\\}$/g,"").split(/,/);var b={},c,d2;for(c=0;c<a.length;c++){if(!(d2=a[c].match(/^\\s*(?:(["\']?)([a-z][a-z0-9]*)\\1)\\s*:\\s*(?:(-?\\d+)|"([a-z0-9+\\/%*_.@=\\-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn\'t json!");null!=d2[3]?b[d2[2]]=parseInt(d2[3],10):null!=d2[4]?b[d2[2]]=d2[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(d2[4]):unescape(d2[4]):null!=d2[5]&&(b[d2[2]]="true"===d2[5])}return b},g:function(a,b,c){void 0===a&&(a={});if(void 0===b)return a;for(var d2 in b)if(b.hasOwnProperty(d2)){if(c&&void 0!==a[d2]&&a[d2]!==b[d2])throw new sjcl.exception.invalid("required parameter overridden");a[d2]=b[d2]}return a},sa:function(a,b){var c={},d2;for(d2 in a)a.hasOwnProperty(d2)&&a[d2]!==b[d2]&&(c[d2]=a[d2]);return c},ra:function(a,b){var c={},d2;for(d2=0;d2<b.length;d2++)void 0!==a[b[d2]]&&(c[b[d2]]=a[b[d2]]);return c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.pa={};sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.pa,d2;b=b||{};d2=b.iter||1e3;c=c[a]=c[a]||{};d2=c[d2]=c[d2]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=void 0===b.salt?d2.firstSalt:b.salt;d2[c]=d2[c]||sjcl.misc.pbkdf2(a,c,b.iter);return{key:d2[c].slice(0),salt:c.slice(0)}};var _HTTPfrontend=class extends Service{name="http";fetchProxied=false;listening={};constructor(options,path,fetched){super(options);this.load(this);this.listen(path,fetched)}GET=(url2="http://localhost:8080/ping",type="",mimeType)=>{if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"GET",url:url2,responseType:type,mimeType,onload:ev2=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url2 instanceof URL)url2=url2.toString();this.setState({[url2]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};POST=(message,url2="http://localhost:8080/echo",type="",mimeType)=>{if(typeof message==="object"&&(type==="json"||type==="text"||!type)){message=JSON.stringify(message)}if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"POST",url:url2,data:message,responseType:type,mimeType,onload:ev2=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url2 instanceof URL)url2=url2.toString();this.setState({[url2]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};transmit=(message,url2)=>{let obj=message;if(typeof obj==="object"){message=JSON.stringify(obj)}if(obj?.method?.toLowerCase()=="get"||message?.toLowerCase()==="get")return this.GET(url2);return this.POST(message,url2)};transponder=(url2,message,type="",mimeType)=>{if(typeof message==="object")message=JSON.stringify(message);let method="GET";if(message){method="POST"}if(type==="json")mimeType="application/json";else return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method,url:url2,data:message,responseType:type,onload:ev2=>{let body=xhr.response;if(typeof body==="string"){let substr=body.substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))body=body.replace(/\\\\/g,"");if(body[0]===\'"\'){body=body.substring(1,body.length-1)};body=JSON.parse(body)}}if(typeof body?.method==="string"){return resolve(this.handleMethod(body.route,body.method,body.args))}else if(typeof body?.route==="string"){return resolve(this.handleServiceMessage(body))}else if(typeof body?.node==="string"||body.node instanceof GraphNode){return resolve(this.handleGraphNodeCall(body.node,body.args))}else return resolve(body)},onabort:er=>{reject(er)}})}).catch(console.error)};listen=(path="0",fetched=async(clone,args,response)=>{const result=await clone.text();const returned=this.receive(result);this.setState({[response.url]:returned})})=>{this.listening[path]={};let listenerId=`${path}${Math.floor(Math.random()*1e15)}`;this.listening[path][listenerId]=fetched;if(!this.fetchProxied){globalThis.fetch=new Proxy(globalThis.fetch,{apply(fetch2,that,args){const result=fetch2.apply(that,args);result.then(response=>{if(!response.ok)return;if(this.listening["0"]){for(const key in this.listeners){const clone=response.clone();this.listening["0"][key](clone,args,response)}}else{for(const key in this.listening){if(response.url.includes(key)){for(const key2 in this.listening[path]){const clone=response.clone();this.listening[path][key2](clone,args,response)}break}}}}).catch(er=>{console.error(er)});return result}});this.fetchProxied=true}return listenerId};stopListening=(path,listener)=>{if(!path&&path!==0){for(const key in this.listening)delete this.listening[key]}else{if(!listener)delete this.listening[path];else delete this.listening[listener]}}};var HTTPfrontend=_HTTPfrontend;__publicField(HTTPfrontend,"request",options=>{const xhr=new XMLHttpRequest;if(options.responseType)xhr.responseType=options.responseType;else options.responseType="json";if(options.mimeType){xhr.overrideMimeType(options.mimeType)}if(options.onload)xhr.addEventListener("load",options.onload,false);if(options.onprogress)xhr.addEventListener("progress",options.onprogress,false);if(options.onabort)xhr.addEventListener("abort",options.onabort,false);if(options.onloadend)xhr.addEventListener("loadend",options.onloadend,false);if(options.onerror)xhr.addEventListener("error",options.onerror,false);xhr.open(options.method,options.url,true,options.user,options.pass);if(!options.onerror)xhr.onerror=function(){xhr.abort()};xhr.send(options.data);return xhr});var import_web_worker=__toESM(require_browser());var WorkerService=class extends Service{name="worker";workers={};threadRot=0;connections;constructor(options){super();this.connections={workers:this.workers};if(options?.services)this.addServices(options.services);this.load(this);this.setLoaders(this.workerloader);if(options)this.init(options);if(typeof WorkerGlobalScope!=="undefined"&&globalThis instanceof WorkerGlobalScope){this.addDefaultMessageListener()}}loadWorkerRoute=(rt,routeKey)=>{if(rt.workerUrl)rt.url=rt.workerUrl;if(rt.workerId)rt.__node.tag=rt.workerId;if(!rt.__node.tag)rt.__node.tag=routeKey;rt._id=rt.__node.tag;let worker;if(this.workers[rt._id])worker=this.workers[rt._id];else if(rt.worker)worker=rt.worker;if(!worker){worker=this.addWorker(rt)}rt.worker=worker;if(!rt.worker.__ondisconnected){let ondelete=rt2=>{rt2.worker?.terminate()};rt.__addOndisconnected(ondelete)}if(rt.transferFunctions){for(const prop in rt.transferFunctions){this.transferFunction(worker,rt.transferFunctions[prop],prop)}}if(rt.transferClasses){for(const prop in rt.transferClasses){this.transferClass(worker,rt.transferClasses[prop],prop)}}if(worker){if(!rt.__operator){rt.__operator=(...args)=>{if(rt.callback){if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.post(rt.callback,args);else return worker.run(rt.callback,args)}else{if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.send(args);else return worker.request(args)}}}if(rt.init){worker.run(rt.init,rt.initArgs,void 0,rt.initTransfer)}return worker}};workerloader={"workers":(node,parent,graph,roots)=>{let rt=node;if(!node.parentRoute&&(parent?.callback&&parent?.worker))node.parentRoute=parent?.callback;if(rt?.worker||rt?.workerId||rt?.workerUrl){let worker=this.loadWorkerRoute(rt,rt.__node.tag);if(worker){if(!rt.parentRoute&&rt.__parent?.callback)rt.parentRoute=rt.__parent.callback;if(rt.__parent&&!rt.portId){if(typeof rt.__parent==="string"){if(rt.__node.tag!==rt.__parent&&worker._id!==rt.__parent)rt.portId=this.establishMessageChannel(worker,rt.__parent)}else if(rt.__node.tag!==rt.__parent?.__node?.tag&&worker._id!==rt.__parent?.tag){rt.portId=this.establishMessageChannel(worker,rt.__parent.worker)}};if(rt.parentRoute){if(!rt.stopped){if(typeof rt.__parent==="string"&&rt.__parent===worker._id){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else if(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.parentRoute,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id)&&!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent){if(typeof rt.__parent==="string"){if(!rt.stopped){if(rt.__parent===worker._id){worker.run("subscribe",[rt.__parent,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id))worker.workerSubs[rt.__parent+rt.portId]={sub:null,route:worker._id,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent?.__node?.tag&&rt.__parent?.worker){if(!rt.stopped){if(rt.__node.tag===rt.__parent.__node.tag||worker._id===rt.__parent.__node.tag){worker.run("subscribe",[rt.__parent.__node.tag,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent.__node.tag,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent.__node.tag+rt.portId].sub=sub})}if(!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.__parent.__node.tag+rt.portId]={sub:null,route:rt.__parent.__node.tag,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}}}}else if(rt.__parent&&rt.parentRoute){if(typeof rt.__parent==="string"&&roots[rt.__parent]?.worker){roots[rt.__parent].worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}else if(rt.__parent?.worker){rt.__parent.worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}}return rt}};addDefaultMessageListener=()=>{globalThis.onmessage=ev2=>{let result=this.receive(ev2.data);if(this.__node.keepState)this.setState({[this.name]:result})}};postMessage=(message,target,transfer)=>{if(this.workers[target]){this.workers[target].send(message,transfer)}else{globalThis.postMessage(message,target,transfer)}};addWorker=options=>{let worker;if(!options._id)options._id=`worker${Math.floor(Math.random()*1e15)}`;if(options.url)worker=new import_web_worker.default(options.url);else if(options.port){worker=options.port}else if(this.workers[options._id]){if(this.workers[options._id].port)worker=this.workers[options._id].port;else worker=this.workers[options._id].worker}if(!worker)return;let send=(message,transfer)=>{return this.transmit(message,worker,transfer)};let post=(route,args,method,transfer)=>{let message={route,args};if(method)message.method=method;return this.transmit(message,worker,transfer)};let run=(route,args,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[{route,args},options._id,callbackId]};if(method)req.args[0].method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let request=(message,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,options._id,callbackId]};if(method)req.method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let workerSubs={};let subscribe=(route,callback,args,key,subInput,blocking)=>{return this.subscribeToWorker(route,options._id,callback,args,key,subInput,blocking)};let unsubscribe=(route,sub)=>{return run("unsubscribe",[route,sub])};let start=async(route,portId,callback,blocking)=>{if(route)await run("subscribeToWorker",[route,portId,void 0,callback,blocking]).then(sub=>{if(sub)workerSubs[route+portId]={sub,route,portId,callback,blocking}});else for(const key in workerSubs){if(typeof workerSubs[key].sub!=="number")await run("subscribeToWorker",[workerSubs[key].route,workerSubs[key].portId,void 0,workerSubs[key].callback,void 0,workerSubs[key].blocking]).then(sub=>{workerSubs[key].sub=sub});console.log(JSON.stringify(workerSubs))}return true};let stop=async(route,portId)=>{if(route&&portId&&workerSubs[route+portId]){await run("unsubscribe",[route,workerSubs[route+portId].sub]);workerSubs[route+portId].sub=false}else{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){await run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub]).then(console.log)}workerSubs[key].sub=false}}return true};let terminate=()=>{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub])}workerSubs[key].sub=false}return this.terminate(options._id)};if(!options.onmessage)options.onmessage=ev2=>{this.receive(ev2.data);this.setState({[options._id]:ev2.data})};if(!options.onerror){options.onerror=ev2=>{console.error(ev2.data)}}worker.onmessage=options.onmessage;worker.onerror=options.onerror;this.workers[options._id]={worker,send,post,run,request,subscribe,unsubscribe,terminate,start,stop,postMessage:worker.postMessage,workerSubs,graph:this,...options};return this.workers[options._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=scriptTemplate=>{let blob=new Blob([scriptTemplate],{type:"text/javascript"});return URL.createObjectURL(blob)};getTransferable(message){let transfer;if(typeof message==="object"){if(message.args){if(message.args?.constructor?.name==="Object"){for(const key in message.args){if(ArrayBuffer.isView(message.args[key])){if(!transfer)transfer=[message.args[key].buffer];else transfer.push(message.args[key].buffer)}else if(message.args[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message.args[key]];else transfer.push(message.args[key])}}}else if(Array.isArray(message.args)&&message.args.length<11){message.args.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg?.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message.args)){transfer=[message.args.buffer]}else if(message.args?.constructor?.name==="ArrayBuffer"){transfer=[message]}}else if(message?.constructor?.name==="Object"){for(const key in message){if(ArrayBuffer.isView(message[key])){if(!transfer)transfer=[message[key].buffer];else transfer.push(message[key].buffer)}else if(message[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message[key]];else transfer.push(message[key])}}}else if(Array.isArray(message)&&message.length<11){message.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message)){transfer=[message.buffer]}else if(message.constructor?.name==="ArrayBuffer"){transfer=[message]}}return transfer}transmit=(message,worker,transfer)=>{if(!transfer){transfer=this.getTransferable(message)}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){worker.postMessage(message,transfer)}else if(typeof worker==="string"){if(this.workers[worker]){if(this.workers[worker].port)this.workers[worker].port.postMessage(message,transfer);else if(this.workers[worker].worker)this.workers[worker].worker.postMessage(message,transfer)}}else{let keys22=Object.keys(this.workers);this.workers[keys22[this.threadRot]].worker.postMessage(message,transfer);this.threadRot++;if(this.threadRot===keys22.length)this.threadRot=0}return message};terminate=worker=>{let onclose;if(typeof worker==="string"){let obj=this.workers[worker];if(obj){delete this.workers[worker];worker=obj.worker;if(obj.onclose)onclose=obj.onclose}}else if(typeof worker==="object"){if(worker?._id){worker=worker.worker;delete this.workers[worker?._id]}}if(worker instanceof import_web_worker.default){worker.terminate();if(onclose)onclose(worker);return true}if(worker instanceof MessagePort){worker.close();if(onclose)onclose(worker);return true}return false};establishMessageChannel=(worker,worker2)=>{let workerId;if(typeof worker==="string"){workerId=worker;if(this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker2=this.workers[worker].worker}}else if(worker?.worker){worker=worker.worker}if(typeof worker2==="string"){if(this.workers[worker2]){if(this.workers[worker2].port)worker2=this.workers[worker2].port;else worker2=this.workers[worker2].worker}}else if(worker2?.worker){worker2=worker2.worker}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){let channel=new MessageChannel;let portId=`port${Math.floor(Math.random()*1e15)}`;worker.postMessage({route:"addWorker",args:{port:channel.port1,_id:portId}},[channel.port1]);if(worker2 instanceof import_web_worker.default||worker2 instanceof MessagePort){worker2.postMessage({route:"addWorker",args:{port:channel.port2,_id:portId}},[channel.port2])}else if(workerId&&this.workers[workerId]){channel.port2.onmessage=this.workers[workerId].onmessage;this.workers[workerId].port=channel.port2}return portId}return false};request=(message,workerId,transfer,method)=>{let worker=this.workers[workerId].worker;return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,callbackId]};if(method)req.method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};runRequest=(message,worker,callbackId)=>{let res=this.receive(message);if(typeof worker==="string"&&this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}if(res instanceof Promise){res.then(r=>{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:r,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:r,callbackId})})}else{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:res,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:res,callbackId})}return res};subscribeWorker=(route,worker,args,key,subInput,blocking)=>{let callback;if(blocking){let blocked=false;callback=res=>{if(!blocked){blocked=true;if(res instanceof Promise){res.then(r=>{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,r]).then(ret=>{blocked=false})})}else{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,res]).then(ret=>{blocked=false})}}}}else{callback=res=>{if(res instanceof Promise){res.then(r=>{if(worker?.postMessage)worker.postMessage({args:r,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:r,callbackId:route})})}else{if(worker?.postMessage)worker.postMessage({args:res,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:res,callbackId:route})}}}if(!blocking&&worker?.port){worker=worker.port}else if(!blocking&&worker?.worker){worker=worker.worker}else if(typeof worker==="string"&&this.workers[worker]){if(blocking)worker=this.workers[worker];else if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}return this.subscribe(route,callback,args,key,subInput)};subscribeToWorker=(route,workerId,callback,args,key,subInput,blocking)=>{if(typeof workerId==="string"&&this.workers[workerId]){this.__node.state.subscribeEvent(workerId,res=>{if(res?.callbackId===route){if(!callback)this.setState({[workerId]:res.args});else if(typeof callback==="string"){this.run(callback,res.args)}else callback(res.args)}});return this.workers[workerId].run("subscribeWorker",[route,workerId,args,key,subInput,blocking])}};triggerSubscription=async(route,workerId,result)=>{if(this.__node.state.triggers[workerId])for(let i22=0;i22<this.__node.state.triggers[workerId].length;i22++){await this.__node.state.triggers[workerId][i22].onchange({args:result,callbackId:route})}return true};pipeWorkers=(sourceWorker,listenerWorker,sourceRoute,listenerRoute,portId,args,key,subInput,blocking)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof listenerWorker==="string")listenerWorker=this.workers[listenerWorker];if(!portId){portId=this.establishMessageChannel(sourceWorker.worker,listenerWorker.worker)}return listenerWorker.run("subscribeToWorker",[sourceRoute,portId,listenerRoute,args,key,subInput,blocking])};unpipeWorkers=(sourceRoute,sourceWorker,sub)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof sourceWorker==="object"){return sourceWorker.run("unsubscribe",[sourceRoute,sub])}}};var mouseEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]);var wheelEventHandlerImpl=makeSendPropertiesHandler(["deltaX","deltaY"]);var keydownEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function focusEventHandler(event,sendFn){const data={type:event.type};data.isTrusted=event.isTrusted;data.bubbles=event.bubbles;data.cancelBubble=event.cancelBubble;data.cancelable=event.cancelable;data.composed=event.composed;data.defaultPrevent=event.defaultPrevented;data.eventPhase=event.eventPhase;data.returnValue=event.returnValue;data.currentTarget=event.currentTarget.id?event.currentTarget.id:event.currentTarget.constructor.name;data.target=data.currentTarget;data.srcElement=data.currentTarget;sendFn(data)}function wheelEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();wheelEventHandlerImpl(event,sendFn)}function preventDefaultHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault()}function copyProperties(src,properties,dst){for(const name2 of properties){dst[name2]=src[name2]}}function makeSendPropertiesHandler(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties(event,properties,data);sendFn(data)}}function touchEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();const touches=[];const data={type:event.type,touches};for(let i22=0;i22<event.touches.length;++i22){const touch=event.touches[i22];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var i=1;var keys={};while(i<222){keys[i]=true;i++}function filteredKeydownEventHandler(event,sendFn,preventDefault){let{keyCode}=event;if(keys[keyCode]){if(preventDefault&&event.preventDefault&&(keyCode<110||keyCode>123))event.preventDefault();keydownEventHandler(event,sendFn)}}var eventHandlers={contextmenu:preventDefaultHandler,mousedown:mouseEventHandler,mousemove:mouseEventHandler,mouseup:mouseEventHandler,pointerdown:mouseEventHandler,pointermove:mouseEventHandler,pointerup:mouseEventHandler,pointerlockchange:mouseEventHandler,webkitpointerlockchange:mouseEventHandler,focus:focusEventHandler,blur:focusEventHandler,pointerout:mouseEventHandler,touchstart:touchEventHandler,touchmove:touchEventHandler,touchend:touchEventHandler,wheel:wheelEventHandler,keydown:filteredKeydownEventHandler,keyup:filteredKeydownEventHandler};function initProxyElement(element,worker,id,preventDefault){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{if(!worker){handleProxyEvent(data,id)}else worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent,preventDefault)})}if(eventHandlers.keydown){globalThis.addEventListener("keydown",function(ev2){eventHandlers.keydown(ev2,sendEvent,preventDefault)})}if(eventHandlers.keyup){globalThis.addEventListener("keyup",function(ev2){eventHandlers.keyup(ev2,sendEvent,preventDefault)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher=class{__listeners;addEventListener(type,listener){if(this.__listeners===void 0)this.__listeners={};const listeners=this.__listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this.__listeners===void 0)return false;const listeners=this.__listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i22=0,l=array.length;i22<l;i22++){array[i22].call(this,event)}}}};function noop(){}var ElementProxyReceiver=class extends EventDispatcher{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super();this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.style.width=this.width+"px";this.proxied.style.height=this.height+"px";this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop;data.stopPropagation=noop;this.dispatchEvent(data,this.proxied)};focus(){}blur(){}};var ProxyManager=class{targets={};constructor(){if(!globalThis.document)globalThis.document={elementFromPoint:(...args)=>{return this.targets[Object.keys(this.targets)[0]].proxied}}}makeProxy=(id,addTo=void 0)=>{if(!id)id=`proxyReceiver${Math.floor(Math.random()*1e15)}`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;if(typeof WorkerGlobalScope!=="undefined")addTo.style=proxy.style;if(proxy.width){addTo.style.width=proxy.width+"px";addTo.clientWidth=proxy.width}if(proxy.height){addTo.style.height=proxy.height+"px";addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy);addTo.blur=proxy.blur.bind(proxy)}};getProxy=id=>{return this.targets[id]};handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0}};function makeProxy(id,elm){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;this.__node.graph.ProxyManager.makeProxy(id,elm)}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;globalThis.ProxyManager.makeProxy(id,elm)}return id}function handleProxyEvent(data,id){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;if(this.__node.graph.ProxyManager.handleEvent(data,id))return data}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;if(globalThis.ProxyManager.handleEvent(data,id))return data}}var proxyElementWorkerRoutes={initProxyElement,makeProxy,handleProxyEvent};function Renderer(options){if(options.worker){let worker=options.worker;let route=options.route;if(worker instanceof Blob||typeof worker==="string"){worker=new Worker(worker)}delete options.worker;delete options.route;return transferCanvas(worker,options,route)}else{initProxyElement(options.canvas,void 0,options._id,options.preventDefault);return setupCanvas(options)}}function transferCanvas(worker,options,route){if(!options)return void 0;if(!options._id)options._id=`canvas${Math.floor(Math.random()*1e15)}`;let offscreen=options.canvas.transferControlToOffscreen();if(!options.width)options.width=options.canvas.clientWidth;if(!options.height)options.height=options.canvas.clientHeight;let message={route:route?route:"setupCanvas",args:{...options,canvas:offscreen}};if(this?.__node?.graph)this.__node.graph.run("initProxyElement",options.canvas,worker,options._id,options.preventDefault);else initProxyElement(options.canvas,worker,options._id,options.preventDefault);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let tr=[offscreen];if(options.transfer){tr.push(...options.transfer);delete options.transfer}worker.postMessage(message,tr);const canvascontrols={_id:options._id,width:options.width,height:options.height,worker,draw:(props,transfer)=>{worker.postMessage({route:"drawFrame",args:[props,options._id]},transfer)},update:(props,transfer)=>{worker.postMessage({route:"updateCanvas",args:[props,options._id]},transfer)},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:(newDrawProps,transfer)=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]},transfer)},terminate:()=>{worker.terminate()}};return canvascontrols}function setDraw(settings,_id){let canvasopts;if(this?.__node?.graph){if(_id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]}else{if(_id)canvasopts=globalThis.CANVASES?.[settings._id];else if(settings._id)canvasopts=globalThis.CANVASES?.[settings._id];else canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]]}if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasopts._id,canvasopts.canvas);else proxyElementWorkerRoutes.makeProxy(canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText3(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw.bind(settings)}if(typeof settings.update==="string")settings.update=parseFunctionFromText3(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update.bind(settings)}if(typeof settings.init==="string")settings.init=parseFunctionFromText3(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init.bind(settings)}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText3(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear.bind(settings)}return settings._id}return void 0}function setupCanvas(options){if(this?.__node?.graph){if(!this.__node.graph.CANVASES)this.__node.graph.CANVASES={}}else if(!globalThis.CANVASES)globalThis.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=`canvas${Math.floor(Math.random()*1e15)}`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this?.__node?.graph?.CANVASES[canvasOptions._id]){this.__node.graph.run("setDraw",canvasOptions)}else if(globalThis.CANVASES?.[canvasOptions._id]){setDraw(canvasOptions)}else{if(this?.__node?.graph){canvasOptions.graph=this.__node.graph;if(!canvasOptions.__node){canvasOptions.__node={}}if(!canvasOptions.__node.tag)canvasOptions.__node.tag=canvasOptions._id;canvasOptions=this.__node.graph.add(canvasOptions);canvasOptions.__addOndisconnected=()=>{canvasOptions.stop();delete this.__node.graph.CANVASES[canvasOptions._id]}}if(this?.__node?.graph)this.__node.graph.CANVASES[canvasOptions._id]=canvasOptions;else globalThis.CANVASES[canvasOptions._id]=canvasOptions;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);else proxyElementWorkerRoutes.makeProxy(canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText3(canvasOptions.draw)}else if(typeof canvasOptions.draw==="function"){canvasOptions.draw=canvasOptions.draw.bind(canvasOptions)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText3(canvasOptions.update)}else if(typeof canvasOptions.update==="function"){canvasOptions.update=canvasOptions.update.bind(canvasOptions)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText3(canvasOptions.init)}else if(typeof canvasOptions.init==="function"){canvasOptions.init=canvasOptions.init.bind(canvasOptions)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText3(canvasOptions.clear)}else if(typeof canvasOptions.clear==="function"){canvasOptions.clear=canvasOptions.clear.bind(canvasOptions)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);canvasOptions.stop=()=>{stopAnim(canvasOptions._id)};canvasOptions.start=draw=>{startAnim(canvasOptions._id,draw)};canvasOptions.set=settings=>{setDraw(settings,canvasOptions._id)};if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)return canvasOptions._id;else{const canvascontrols={_id:options._id,width:options.width,height:options.height,draw:props=>{drawFrame(props,options._id)},update:props=>{updateCanvas(props,options._id)},clear:()=>{clearCanvas(options._id)},init:()=>{initCanvas(options._id)},stop:()=>{stopAnim(options._id)},start:()=>{startAnim(options._id)},set:newDrawProps=>{setDraw(newDrawProps,options._id)},terminate:()=>{if(this.__node?.graph)this.__node.graph.remove(options._id);else{stopAnim(options._id);if(this?.__node?.graph)delete this.__node.graph.CANVASES[canvasOptions._id];else delete globalThis.CANVASES[canvasOptions._id]}}};return canvascontrols}}function drawFrame(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0}function clearCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function initCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function updateCanvas(input,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0}function setProps(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0}function startAnim(_id,draw){let canvasopts=getCanvas.call(this,_id);canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText3(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function stopAnim(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")requestAnimationFrame(canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context));return _id}return void 0}function getCanvas(_id){let canvasopts;if(this?.__node?.graph){if(!_id)canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]];else canvasopts=this.__node.graph.CANVASES?.[_id]}else{if(!_id)canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]];else canvasopts=globalThis.CANVASES?.[_id]}return canvasopts}var workerCanvasRoutes={...proxyElementWorkerRoutes,Renderer,transferCanvas,setupCanvas,setDraw,drawFrame,clearCanvas,initCanvas,updateCanvas,setProps,startAnim,stopAnim,getCanvas};function parseFunctionFromText3(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var __create2=Object.create;var __defProp2=Object.defineProperty;var __getOwnPropDesc2=Object.getOwnPropertyDescriptor;var __getOwnPropNames2=Object.getOwnPropertyNames;var __getProtoOf2=Object.getPrototypeOf;var __hasOwnProp2=Object.prototype.hasOwnProperty;var __defNormalProp2=(obj,key,value)=>key in obj?__defProp2(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __require3=(x3=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x3,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x3)(function(x3){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x3+\'" is not supported\')});var __commonJS2=(cb,mod)=>function __require23(){return mod||(0,cb[__getOwnPropNames2(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __export=(target,all)=>{for(var name2 in all)__defProp2(target,name2,{get:all[name2],enumerable:true})};var __copyProps2=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames2(from))if(!__hasOwnProp2.call(to,key)&&key!==except)__defProp2(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc2(from,key))||desc.enumerable})}return to};var __toESM2=(mod,isNodeMode,target)=>(target=mod!=null?__create2(__getProtoOf2(mod)):{},__copyProps2(isNodeMode||!mod||!mod.__esModule?__defProp2(target,"default",{value:mod,enumerable:true}):target,mod));var __publicField2=(obj,key,value)=>{__defNormalProp2(obj,typeof key!=="symbol"?key+"":key,value);return value};var require_bson=__commonJS2({"struct/datastructures/bson.cjs"(exports){"use strict";var BSON_MAJOR_VERSION=5;var BSON_INT32_MAX=2147483647;var BSON_INT32_MIN=-2147483648;var BSON_INT64_MAX=Math.pow(2,63)-1;var BSON_INT64_MIN=-Math.pow(2,63);var JS_INT_MAX=Math.pow(2,53);var JS_INT_MIN=-Math.pow(2,53);var BSON_DATA_NUMBER=1;var BSON_DATA_STRING=2;var BSON_DATA_OBJECT=3;var BSON_DATA_ARRAY=4;var BSON_DATA_BINARY=5;var BSON_DATA_UNDEFINED=6;var BSON_DATA_OID=7;var BSON_DATA_BOOLEAN=8;var BSON_DATA_DATE=9;var BSON_DATA_NULL=10;var BSON_DATA_REGEXP=11;var BSON_DATA_DBPOINTER=12;var BSON_DATA_CODE=13;var BSON_DATA_SYMBOL=14;var BSON_DATA_CODE_W_SCOPE=15;var BSON_DATA_INT=16;var BSON_DATA_TIMESTAMP=17;var BSON_DATA_LONG=18;var BSON_DATA_DECIMAL128=19;var BSON_DATA_MIN_KEY=255;var BSON_DATA_MAX_KEY=127;var BSON_BINARY_SUBTYPE_DEFAULT=0;var BSON_BINARY_SUBTYPE_UUID_NEW=4;var BSONType=Object.freeze({double:1,string:2,object:3,array:4,binData:5,undefined:6,objectId:7,bool:8,date:9,null:10,regex:11,dbPointer:12,javascript:13,symbol:14,javascriptWithScope:15,int:16,timestamp:17,long:18,decimal:19,minKey:-1,maxKey:127});var BSONError=class extends Error{get bsonError(){return true}get name(){return"BSONError"}constructor(message){super(message)}static isBSONError(value){return value!=null&&typeof value==="object"&&"bsonError"in value&&value.bsonError===true&&"name"in value&&"message"in value&&"stack"in value}};var BSONVersionError=class extends BSONError{get name(){return"BSONVersionError"}constructor(){super(`Unsupported BSON version, bson types must be from bson ${BSON_MAJOR_VERSION}.0 or later`)}};var BSONRuntimeError=class extends BSONError{get name(){return"BSONRuntimeError"}constructor(message){super(message)}};function nodejsMathRandomBytes(byteLength){return nodeJsByteUtils.fromNumberArray(Array.from({length:byteLength},()=>Math.floor(Math.random()*256)))}var nodejsRandomBytes=(()=>{try{return __require3("crypto").randomBytes}catch{return nodejsMathRandomBytes}})();var nodeJsByteUtils={toLocalBufferType(potentialBuffer){if(Buffer.isBuffer(potentialBuffer)){return potentialBuffer}if(ArrayBuffer.isView(potentialBuffer)){return Buffer.from(potentialBuffer.buffer,potentialBuffer.byteOffset,potentialBuffer.byteLength)}const stringTag=potentialBuffer?.[Symbol.toStringTag]??Object.prototype.toString.call(potentialBuffer);if(stringTag==="ArrayBuffer"||stringTag==="SharedArrayBuffer"||stringTag==="[object ArrayBuffer]"||stringTag==="[object SharedArrayBuffer]"){return Buffer.from(potentialBuffer)}throw new BSONError(`Cannot create Buffer from ${String(potentialBuffer)}`)},allocate(size){return Buffer.alloc(size)},equals(a,b){return nodeJsByteUtils.toLocalBufferType(a).equals(b)},fromNumberArray(array){return Buffer.from(array)},fromBase64(base64){return Buffer.from(base64,"base64")},toBase64(buffer2){return nodeJsByteUtils.toLocalBufferType(buffer2).toString("base64")},fromISO88591(codePoints){return Buffer.from(codePoints,"binary")},toISO88591(buffer2){return nodeJsByteUtils.toLocalBufferType(buffer2).toString("binary")},fromHex(hex){return Buffer.from(hex,"hex")},toHex(buffer2){return nodeJsByteUtils.toLocalBufferType(buffer2).toString("hex")},fromUTF8(text){return Buffer.from(text,"utf8")},toUTF8(buffer2){return nodeJsByteUtils.toLocalBufferType(buffer2).toString("utf8")},utf8ByteLength(input){return Buffer.byteLength(input,"utf8")},encodeUTF8Into(buffer2,source,byteOffset){return nodeJsByteUtils.toLocalBufferType(buffer2).write(source,byteOffset,void 0,"utf8")},randomBytes:nodejsRandomBytes};function isReactNative(){const{navigator:navigator2}=globalThis;return typeof navigator2==="object"&&navigator2.product==="ReactNative"}function webMathRandomBytes(byteLength){if(byteLength<0){throw new RangeError(`The argument \'byteLength\' is invalid. Received ${byteLength}`)}return webByteUtils.fromNumberArray(Array.from({length:byteLength},()=>Math.floor(Math.random()*256)))}var webRandomBytes=(()=>{const{crypto}=globalThis;if(crypto!=null&&typeof crypto.getRandomValues==="function"){return byteLength=>{return crypto.getRandomValues(webByteUtils.allocate(byteLength))}}else{if(isReactNative()){const{console:console2}=globalThis;console2?.warn?.("BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.")}return webMathRandomBytes}})();var HEX_DIGIT=/(\\d|[a-f])/i;var webByteUtils={toLocalBufferType(potentialUint8array){const stringTag=potentialUint8array?.[Symbol.toStringTag]??Object.prototype.toString.call(potentialUint8array);if(stringTag==="Uint8Array"){return potentialUint8array}if(ArrayBuffer.isView(potentialUint8array)){return new Uint8Array(potentialUint8array.buffer.slice(potentialUint8array.byteOffset,potentialUint8array.byteOffset+potentialUint8array.byteLength))}if(stringTag==="ArrayBuffer"||stringTag==="SharedArrayBuffer"||stringTag==="[object ArrayBuffer]"||stringTag==="[object SharedArrayBuffer]"){return new Uint8Array(potentialUint8array)}throw new BSONError(`Cannot make a Uint8Array from ${String(potentialUint8array)}`)},allocate(size){if(typeof size!=="number"){throw new TypeError(`The "size" argument must be of type number. Received ${String(size)}`)}return new Uint8Array(size)},equals(a,b){if(a.byteLength!==b.byteLength){return false}for(let i3=0;i3<a.byteLength;i3++){if(a[i3]!==b[i3]){return false}}return true},fromNumberArray(array){return Uint8Array.from(array)},fromBase64(base64){return Uint8Array.from(atob(base64),c=>c.charCodeAt(0))},toBase64(uint8array){return btoa(webByteUtils.toISO88591(uint8array))},fromISO88591(codePoints){return Uint8Array.from(codePoints,c=>c.charCodeAt(0)&255)},toISO88591(uint8array){return Array.from(Uint16Array.from(uint8array),b=>String.fromCharCode(b)).join("")},fromHex(hex){const evenLengthHex=hex.length%2===0?hex:hex.slice(0,hex.length-1);const buffer2=[];for(let i3=0;i3<evenLengthHex.length;i3+=2){const firstDigit=evenLengthHex[i3];const secondDigit=evenLengthHex[i3+1];if(!HEX_DIGIT.test(firstDigit)){break}if(!HEX_DIGIT.test(secondDigit)){break}const hexDigit=Number.parseInt(`${firstDigit}${secondDigit}`,16);buffer2.push(hexDigit)}return Uint8Array.from(buffer2)},toHex(uint8array){return Array.from(uint8array,byte=>byte.toString(16).padStart(2,"0")).join("")},fromUTF8(text){return new TextEncoder().encode(text)},toUTF8(uint8array){return new TextDecoder("utf8",{fatal:false}).decode(uint8array)},utf8ByteLength(input){return webByteUtils.fromUTF8(input).byteLength},encodeUTF8Into(buffer2,source,byteOffset){const bytes=webByteUtils.fromUTF8(source);buffer2.set(bytes,byteOffset);return bytes.byteLength},randomBytes:webRandomBytes};var hasGlobalBuffer=typeof Buffer==="function"&&Buffer.prototype?._isBuffer!==true;var ByteUtils=hasGlobalBuffer?nodeJsByteUtils:webByteUtils;var BSONDataView=class extends DataView{static fromUint8Array(input){return new DataView(input.buffer,input.byteOffset,input.byteLength)}};var VALIDATION_REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i;var uuidValidateString=str23=>typeof str23==="string"&&VALIDATION_REGEX.test(str23);var uuidHexStringToBuffer=hexString=>{if(!uuidValidateString(hexString)){throw new BSONError(\'UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".\')}const sanitizedHexString=hexString.replace(/-/g,"");return ByteUtils.fromHex(sanitizedHexString)};function bufferToUuidHexString(buffer2,includeDashes=true){if(includeDashes){return[ByteUtils.toHex(buffer2.subarray(0,4)),ByteUtils.toHex(buffer2.subarray(4,6)),ByteUtils.toHex(buffer2.subarray(6,8)),ByteUtils.toHex(buffer2.subarray(8,10)),ByteUtils.toHex(buffer2.subarray(10,16))].join("-")}return ByteUtils.toHex(buffer2)}function isAnyArrayBuffer(value){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(value))}function isUint8Array(value){return Object.prototype.toString.call(value)==="[object Uint8Array]"}function isRegExp(d2){return Object.prototype.toString.call(d2)==="[object RegExp]"}function isMap(d2){return Object.prototype.toString.call(d2)==="[object Map]"}function isDate(d2){return Object.prototype.toString.call(d2)==="[object Date]"}var BSONValue=class{get[Symbol.for("@@mdb.bson.version")](){return BSON_MAJOR_VERSION}};var Binary=class extends BSONValue{get _bsontype(){return"Binary"}constructor(buffer2,subType){super();if(!(buffer2==null)&&!(typeof buffer2==="string")&&!ArrayBuffer.isView(buffer2)&&!(buffer2 instanceof ArrayBuffer)&&!Array.isArray(buffer2)){throw new BSONError("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>")}this.sub_type=subType??Binary.BSON_BINARY_SUBTYPE_DEFAULT;if(buffer2==null){this.buffer=ByteUtils.allocate(Binary.BUFFER_SIZE);this.position=0}else{if(typeof buffer2==="string"){this.buffer=ByteUtils.fromISO88591(buffer2)}else if(Array.isArray(buffer2)){this.buffer=ByteUtils.fromNumberArray(buffer2)}else{this.buffer=ByteUtils.toLocalBufferType(buffer2)}this.position=this.buffer.byteLength}}put(byteValue){if(typeof byteValue==="string"&&byteValue.length!==1){throw new BSONError("only accepts single character String")}else if(typeof byteValue!=="number"&&byteValue.length!==1)throw new BSONError("only accepts single character Uint8Array or Array");let decodedByte;if(typeof byteValue==="string"){decodedByte=byteValue.charCodeAt(0)}else if(typeof byteValue==="number"){decodedByte=byteValue}else{decodedByte=byteValue[0]}if(decodedByte<0||decodedByte>255){throw new BSONError("only accepts number in a valid unsigned byte range 0-255")}if(this.buffer.byteLength>this.position){this.buffer[this.position++]=decodedByte}else{const newSpace=ByteUtils.allocate(Binary.BUFFER_SIZE+this.buffer.length);newSpace.set(this.buffer,0);this.buffer=newSpace;this.buffer[this.position++]=decodedByte}}write(sequence,offset){offset=typeof offset==="number"?offset:this.position;if(this.buffer.byteLength<offset+sequence.length){const newSpace=ByteUtils.allocate(this.buffer.byteLength+sequence.length);newSpace.set(this.buffer,0);this.buffer=newSpace}if(ArrayBuffer.isView(sequence)){this.buffer.set(ByteUtils.toLocalBufferType(sequence),offset);this.position=offset+sequence.byteLength>this.position?offset+sequence.length:this.position}else if(typeof sequence==="string"){const bytes=ByteUtils.fromISO88591(sequence);this.buffer.set(bytes,offset);this.position=offset+sequence.length>this.position?offset+sequence.length:this.position}}read(position,length){length=length&&length>0?length:this.position;return this.buffer.slice(position,position+length)}value(asRaw){asRaw=!!asRaw;if(asRaw&&this.buffer.length===this.position){return this.buffer}if(asRaw){return this.buffer.slice(0,this.position)}return ByteUtils.toISO88591(this.buffer.subarray(0,this.position))}length(){return this.position}toJSON(){return ByteUtils.toBase64(this.buffer)}toString(encoding){if(encoding==="hex")return ByteUtils.toHex(this.buffer);if(encoding==="base64")return ByteUtils.toBase64(this.buffer);if(encoding==="utf8"||encoding==="utf-8")return ByteUtils.toUTF8(this.buffer);return ByteUtils.toUTF8(this.buffer)}toExtendedJSON(options){options=options||{};const base64String=ByteUtils.toBase64(this.buffer);const subType=Number(this.sub_type).toString(16);if(options.legacy){return{$binary:base64String,$type:subType.length===1?"0"+subType:subType}}return{$binary:{base64:base64String,subType:subType.length===1?"0"+subType:subType}}}toUUID(){if(this.sub_type===Binary.SUBTYPE_UUID){return new UUID(this.buffer.slice(0,this.position))}throw new BSONError(`Binary sub_type "${this.sub_type}" is not supported for converting to UUID. Only "${Binary.SUBTYPE_UUID}" is currently supported.`)}static fromExtendedJSON(doc,options){options=options||{};let data;let type;if("$binary"in doc){if(options.legacy&&typeof doc.$binary==="string"&&"$type"in doc){type=doc.$type?parseInt(doc.$type,16):0;data=ByteUtils.fromBase64(doc.$binary)}else{if(typeof doc.$binary!=="string"){type=doc.$binary.subType?parseInt(doc.$binary.subType,16):0;data=ByteUtils.fromBase64(doc.$binary.base64)}}}else if("$uuid"in doc){type=4;data=uuidHexStringToBuffer(doc.$uuid)}if(!data){throw new BSONError(`Unexpected Binary Extended JSON format ${JSON.stringify(doc)}`)}return type===BSON_BINARY_SUBTYPE_UUID_NEW?new UUID(data):new Binary(data,type)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Binary(Buffer.from("${ByteUtils.toHex(this.buffer)}", "hex"), ${this.sub_type})`}};Binary.BSON_BINARY_SUBTYPE_DEFAULT=0;Binary.BUFFER_SIZE=256;Binary.SUBTYPE_DEFAULT=0;Binary.SUBTYPE_FUNCTION=1;Binary.SUBTYPE_BYTE_ARRAY=2;Binary.SUBTYPE_UUID_OLD=3;Binary.SUBTYPE_UUID=4;Binary.SUBTYPE_MD5=5;Binary.SUBTYPE_ENCRYPTED=6;Binary.SUBTYPE_COLUMN=7;Binary.SUBTYPE_USER_DEFINED=128;var UUID_BYTE_LENGTH=16;var UUID=class extends Binary{constructor(input){let bytes;let hexStr;if(input==null){bytes=UUID.generate()}else if(input instanceof UUID){bytes=ByteUtils.toLocalBufferType(new Uint8Array(input.buffer));hexStr=input.__id}else if(ArrayBuffer.isView(input)&&input.byteLength===UUID_BYTE_LENGTH){bytes=ByteUtils.toLocalBufferType(input)}else if(typeof input==="string"){bytes=uuidHexStringToBuffer(input)}else{throw new BSONError("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).")}super(bytes,BSON_BINARY_SUBTYPE_UUID_NEW);this.__id=hexStr}get id(){return this.buffer}set id(value){this.buffer=value;if(UUID.cacheHexString){this.__id=bufferToUuidHexString(value)}}toHexString(includeDashes=true){if(UUID.cacheHexString&&this.__id){return this.__id}const uuidHexString=bufferToUuidHexString(this.id,includeDashes);if(UUID.cacheHexString){this.__id=uuidHexString}return uuidHexString}toString(encoding){if(encoding==="hex")return ByteUtils.toHex(this.id);if(encoding==="base64")return ByteUtils.toBase64(this.id);return this.toHexString()}toJSON(){return this.toHexString()}equals(otherId){if(!otherId){return false}if(otherId instanceof UUID){return ByteUtils.equals(otherId.id,this.id)}try{return ByteUtils.equals(new UUID(otherId).id,this.id)}catch{return false}}toBinary(){return new Binary(this.id,Binary.SUBTYPE_UUID)}static generate(){const bytes=ByteUtils.randomBytes(UUID_BYTE_LENGTH);bytes[6]=bytes[6]&15|64;bytes[8]=bytes[8]&63|128;return bytes}static isValid(input){if(!input){return false}if(input instanceof UUID){return true}if(typeof input==="string"){return uuidValidateString(input)}if(isUint8Array(input)){if(input.byteLength!==UUID_BYTE_LENGTH){return false}return(input[6]&240)===64&&(input[8]&128)===128}return false}static createFromHexString(hexString){const buffer2=uuidHexStringToBuffer(hexString);return new UUID(buffer2)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new UUID("${this.toHexString()}")`}};var Code=class extends BSONValue{get _bsontype(){return"Code"}constructor(code,scope){super();this.code=code.toString();this.scope=scope??null}toJSON(){if(this.scope!=null){return{code:this.code,scope:this.scope}}return{code:this.code}}toExtendedJSON(){if(this.scope){return{$code:this.code,$scope:this.scope}}return{$code:this.code}}static fromExtendedJSON(doc){return new Code(doc.$code,doc.$scope)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){const codeJson=this.toJSON();return`new Code("${String(codeJson.code)}"${codeJson.scope!=null?`, ${JSON.stringify(codeJson.scope)}`:""})`}};function isDBRefLike(value){return value!=null&&typeof value==="object"&&"$id"in value&&value.$id!=null&&"$ref"in value&&typeof value.$ref==="string"&&(!("$db"in value)||"$db"in value&&typeof value.$db==="string")}var DBRef=class extends BSONValue{get _bsontype(){return"DBRef"}constructor(collection,oid,db,fields){super();const parts=collection.split(".");if(parts.length===2){db=parts.shift();collection=parts.shift()}this.collection=collection;this.oid=oid;this.db=db;this.fields=fields||{}}get namespace(){return this.collection}set namespace(value){this.collection=value}toJSON(){const o=Object.assign({$ref:this.collection,$id:this.oid},this.fields);if(this.db!=null)o.$db=this.db;return o}toExtendedJSON(options){options=options||{};let o={$ref:this.collection,$id:this.oid};if(options.legacy){return o}if(this.db)o.$db=this.db;o=Object.assign(o,this.fields);return o}static fromExtendedJSON(doc){const copy=Object.assign({},doc);delete copy.$ref;delete copy.$id;delete copy.$db;return new DBRef(doc.$ref,doc.$id,doc.$db,copy)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){const oid=this.oid===void 0||this.oid.toString===void 0?this.oid:this.oid.toString();return`new DBRef("${this.namespace}", new ObjectId("${String(oid)}")${this.db?`, "${this.db}"`:""})`}};var wasm=void 0;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}var TWO_PWR_16_DBL=1<<16;var TWO_PWR_24_DBL=1<<24;var TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL;var TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL;var TWO_PWR_63_DBL=TWO_PWR_64_DBL/2;var INT_CACHE={};var UINT_CACHE={};var MAX_INT64_STRING_LENGTH=20;var DECIMAL_REG_EX=/^(\\+?0|(\\+|-)?[1-9][0-9]*)$/;var Long=class extends BSONValue{get _bsontype(){return"Long"}get __isLong__(){return true}constructor(low=0,high,unsigned){super();if(typeof low==="bigint"){Object.assign(this,Long.fromBigInt(low,!!high))}else if(typeof low==="string"){Object.assign(this,Long.fromString(low,!!high))}else{this.low=low|0;this.high=high|0;this.unsigned=!!unsigned}}static fromBits(lowBits,highBits,unsigned){return new Long(lowBits,highBits,unsigned)}static fromInt(value,unsigned){let obj,cachedObj,cache;if(unsigned){value>>>=0;if(cache=0<=value&&value<256){cachedObj=UINT_CACHE[value];if(cachedObj)return cachedObj}obj=Long.fromBits(value,(value|0)<0?-1:0,true);if(cache)UINT_CACHE[value]=obj;return obj}else{value|=0;if(cache=-128<=value&&value<128){cachedObj=INT_CACHE[value];if(cachedObj)return cachedObj}obj=Long.fromBits(value,value<0?-1:0,false);if(cache)INT_CACHE[value]=obj;return obj}}static fromNumber(value,unsigned){if(isNaN(value))return unsigned?Long.UZERO:Long.ZERO;if(unsigned){if(value<0)return Long.UZERO;if(value>=TWO_PWR_64_DBL)return Long.MAX_UNSIGNED_VALUE}else{if(value<=-TWO_PWR_63_DBL)return Long.MIN_VALUE;if(value+1>=TWO_PWR_63_DBL)return Long.MAX_VALUE}if(value<0)return Long.fromNumber(-value,unsigned).neg();return Long.fromBits(value%TWO_PWR_32_DBL|0,value/TWO_PWR_32_DBL|0,unsigned)}static fromBigInt(value,unsigned){return Long.fromString(value.toString(),unsigned)}static fromString(str23,unsigned,radix){if(str23.length===0)throw new BSONError("empty string");if(str23==="NaN"||str23==="Infinity"||str23==="+Infinity"||str23==="-Infinity")return Long.ZERO;if(typeof unsigned==="number"){radix=unsigned,unsigned=false}else{unsigned=!!unsigned}radix=radix||10;if(radix<2||36<radix)throw new BSONError("radix");let p2;if((p2=str23.indexOf("-"))>0)throw new BSONError("interior hyphen");else if(p2===0){return Long.fromString(str23.substring(1),unsigned,radix).neg()}const radixToPower=Long.fromNumber(Math.pow(radix,8));let result=Long.ZERO;for(let i3=0;i3<str23.length;i3+=8){const size=Math.min(8,str23.length-i3),value=parseInt(str23.substring(i3,i3+size),radix);if(size<8){const power=Long.fromNumber(Math.pow(radix,size));result=result.mul(power).add(Long.fromNumber(value))}else{result=result.mul(radixToPower);result=result.add(Long.fromNumber(value))}}result.unsigned=unsigned;return result}static fromBytes(bytes,unsigned,le){return le?Long.fromBytesLE(bytes,unsigned):Long.fromBytesBE(bytes,unsigned)}static fromBytesLE(bytes,unsigned){return new Long(bytes[0]|bytes[1]<<8|bytes[2]<<16|bytes[3]<<24,bytes[4]|bytes[5]<<8|bytes[6]<<16|bytes[7]<<24,unsigned)}static fromBytesBE(bytes,unsigned){return new Long(bytes[4]<<24|bytes[5]<<16|bytes[6]<<8|bytes[7],bytes[0]<<24|bytes[1]<<16|bytes[2]<<8|bytes[3],unsigned)}static isLong(value){return value!=null&&typeof value==="object"&&"__isLong__"in value&&value.__isLong__===true}static fromValue(val,unsigned){if(typeof val==="number")return Long.fromNumber(val,unsigned);if(typeof val==="string")return Long.fromString(val,unsigned);return Long.fromBits(val.low,val.high,typeof unsigned==="boolean"?unsigned:val.unsigned)}add(addend){if(!Long.isLong(addend))addend=Long.fromValue(addend);const a48=this.high>>>16;const a32=this.high&65535;const a16=this.low>>>16;const a00=this.low&65535;const b48=addend.high>>>16;const b32=addend.high&65535;const b16=addend.low>>>16;const b00=addend.low&65535;let c48=0,c32=0,c16=0,c00=0;c00+=a00+b00;c16+=c00>>>16;c00&=65535;c16+=a16+b16;c32+=c16>>>16;c16&=65535;c32+=a32+b32;c48+=c32>>>16;c32&=65535;c48+=a48+b48;c48&=65535;return Long.fromBits(c16<<16|c00,c48<<16|c32,this.unsigned)}and(other){if(!Long.isLong(other))other=Long.fromValue(other);return Long.fromBits(this.low&other.low,this.high&other.high,this.unsigned)}compare(other){if(!Long.isLong(other))other=Long.fromValue(other);if(this.eq(other))return 0;const thisNeg=this.isNegative(),otherNeg=other.isNegative();if(thisNeg&&!otherNeg)return-1;if(!thisNeg&&otherNeg)return 1;if(!this.unsigned)return this.sub(other).isNegative()?-1:1;return other.high>>>0>this.high>>>0||other.high===this.high&&other.low>>>0>this.low>>>0?-1:1}comp(other){return this.compare(other)}divide(divisor){if(!Long.isLong(divisor))divisor=Long.fromValue(divisor);if(divisor.isZero())throw new BSONError("division by zero");if(wasm){if(!this.unsigned&&this.high===-2147483648&&divisor.low===-1&&divisor.high===-1){return this}const low=(this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,divisor.low,divisor.high);return Long.fromBits(low,wasm.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Long.UZERO:Long.ZERO;let approx,rem,res;if(!this.unsigned){if(this.eq(Long.MIN_VALUE)){if(divisor.eq(Long.ONE)||divisor.eq(Long.NEG_ONE))return Long.MIN_VALUE;else if(divisor.eq(Long.MIN_VALUE))return Long.ONE;else{const halfThis=this.shr(1);approx=halfThis.div(divisor).shl(1);if(approx.eq(Long.ZERO)){return divisor.isNegative()?Long.ONE:Long.NEG_ONE}else{rem=this.sub(divisor.mul(approx));res=approx.add(rem.div(divisor));return res}}}else if(divisor.eq(Long.MIN_VALUE))return this.unsigned?Long.UZERO:Long.ZERO;if(this.isNegative()){if(divisor.isNegative())return this.neg().div(divisor.neg());return this.neg().div(divisor).neg()}else if(divisor.isNegative())return this.div(divisor.neg()).neg();res=Long.ZERO}else{if(!divisor.unsigned)divisor=divisor.toUnsigned();if(divisor.gt(this))return Long.UZERO;if(divisor.gt(this.shru(1)))return Long.UONE;res=Long.UZERO}rem=this;while(rem.gte(divisor)){approx=Math.max(1,Math.floor(rem.toNumber()/divisor.toNumber()));const log2=Math.ceil(Math.log(approx)/Math.LN2);const delta=log2<=48?1:Math.pow(2,log2-48);let approxRes=Long.fromNumber(approx);let approxRem=approxRes.mul(divisor);while(approxRem.isNegative()||approxRem.gt(rem)){approx-=delta;approxRes=Long.fromNumber(approx,this.unsigned);approxRem=approxRes.mul(divisor)}if(approxRes.isZero())approxRes=Long.ONE;res=res.add(approxRes);rem=rem.sub(approxRem)}return res}div(divisor){return this.divide(divisor)}equals(other){if(!Long.isLong(other))other=Long.fromValue(other);if(this.unsigned!==other.unsigned&&this.high>>>31===1&&other.high>>>31===1)return false;return this.high===other.high&&this.low===other.low}eq(other){return this.equals(other)}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative()){return this.eq(Long.MIN_VALUE)?64:this.neg().getNumBitsAbs()}const val=this.high!==0?this.high:this.low;let bit;for(bit=31;bit>0;bit--)if((val&1<<bit)!==0)break;return this.high!==0?bit+33:bit+1}greaterThan(other){return this.comp(other)>0}gt(other){return this.greaterThan(other)}greaterThanOrEqual(other){return this.comp(other)>=0}gte(other){return this.greaterThanOrEqual(other)}ge(other){return this.greaterThanOrEqual(other)}isEven(){return(this.low&1)===0}isNegative(){return!this.unsigned&&this.high<0}isOdd(){return(this.low&1)===1}isPositive(){return this.unsigned||this.high>=0}isZero(){return this.high===0&&this.low===0}lessThan(other){return this.comp(other)<0}lt(other){return this.lessThan(other)}lessThanOrEqual(other){return this.comp(other)<=0}lte(other){return this.lessThanOrEqual(other)}modulo(divisor){if(!Long.isLong(divisor))divisor=Long.fromValue(divisor);if(wasm){const low=(this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,divisor.low,divisor.high);return Long.fromBits(low,wasm.get_high(),this.unsigned)}return this.sub(this.div(divisor).mul(divisor))}mod(divisor){return this.modulo(divisor)}rem(divisor){return this.modulo(divisor)}multiply(multiplier){if(this.isZero())return Long.ZERO;if(!Long.isLong(multiplier))multiplier=Long.fromValue(multiplier);if(wasm){const low=wasm.mul(this.low,this.high,multiplier.low,multiplier.high);return Long.fromBits(low,wasm.get_high(),this.unsigned)}if(multiplier.isZero())return Long.ZERO;if(this.eq(Long.MIN_VALUE))return multiplier.isOdd()?Long.MIN_VALUE:Long.ZERO;if(multiplier.eq(Long.MIN_VALUE))return this.isOdd()?Long.MIN_VALUE:Long.ZERO;if(this.isNegative()){if(multiplier.isNegative())return this.neg().mul(multiplier.neg());else return this.neg().mul(multiplier).neg()}else if(multiplier.isNegative())return this.mul(multiplier.neg()).neg();if(this.lt(Long.TWO_PWR_24)&&multiplier.lt(Long.TWO_PWR_24))return Long.fromNumber(this.toNumber()*multiplier.toNumber(),this.unsigned);const a48=this.high>>>16;const a32=this.high&65535;const a16=this.low>>>16;const a00=this.low&65535;const b48=multiplier.high>>>16;const b32=multiplier.high&65535;const b16=multiplier.low>>>16;const b00=multiplier.low&65535;let c48=0,c32=0,c16=0,c00=0;c00+=a00*b00;c16+=c00>>>16;c00&=65535;c16+=a16*b00;c32+=c16>>>16;c16&=65535;c16+=a00*b16;c32+=c16>>>16;c16&=65535;c32+=a32*b00;c48+=c32>>>16;c32&=65535;c32+=a16*b16;c48+=c32>>>16;c32&=65535;c32+=a00*b32;c48+=c32>>>16;c32&=65535;c48+=a48*b00+a32*b16+a16*b32+a00*b48;c48&=65535;return Long.fromBits(c16<<16|c00,c48<<16|c32,this.unsigned)}mul(multiplier){return this.multiply(multiplier)}negate(){if(!this.unsigned&&this.eq(Long.MIN_VALUE))return Long.MIN_VALUE;return this.not().add(Long.ONE)}neg(){return this.negate()}not(){return Long.fromBits(~this.low,~this.high,this.unsigned)}notEquals(other){return!this.equals(other)}neq(other){return this.notEquals(other)}ne(other){return this.notEquals(other)}or(other){if(!Long.isLong(other))other=Long.fromValue(other);return Long.fromBits(this.low|other.low,this.high|other.high,this.unsigned)}shiftLeft(numBits){if(Long.isLong(numBits))numBits=numBits.toInt();if((numBits&=63)===0)return this;else if(numBits<32)return Long.fromBits(this.low<<numBits,this.high<<numBits|this.low>>>32-numBits,this.unsigned);else return Long.fromBits(0,this.low<<numBits-32,this.unsigned)}shl(numBits){return this.shiftLeft(numBits)}shiftRight(numBits){if(Long.isLong(numBits))numBits=numBits.toInt();if((numBits&=63)===0)return this;else if(numBits<32)return Long.fromBits(this.low>>>numBits|this.high<<32-numBits,this.high>>numBits,this.unsigned);else return Long.fromBits(this.high>>numBits-32,this.high>=0?0:-1,this.unsigned)}shr(numBits){return this.shiftRight(numBits)}shiftRightUnsigned(numBits){if(Long.isLong(numBits))numBits=numBits.toInt();numBits&=63;if(numBits===0)return this;else{const high=this.high;if(numBits<32){const low=this.low;return Long.fromBits(low>>>numBits|high<<32-numBits,high>>>numBits,this.unsigned)}else if(numBits===32)return Long.fromBits(high,0,this.unsigned);else return Long.fromBits(high>>>numBits-32,0,this.unsigned)}}shr_u(numBits){return this.shiftRightUnsigned(numBits)}shru(numBits){return this.shiftRightUnsigned(numBits)}subtract(subtrahend){if(!Long.isLong(subtrahend))subtrahend=Long.fromValue(subtrahend);return this.add(subtrahend.neg())}sub(subtrahend){return this.subtract(subtrahend)}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){if(this.unsigned)return(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0);return this.high*TWO_PWR_32_DBL+(this.low>>>0)}toBigInt(){return BigInt(this.toString())}toBytes(le){return le?this.toBytesLE():this.toBytesBE()}toBytesLE(){const hi=this.high,lo=this.low;return[lo&255,lo>>>8&255,lo>>>16&255,lo>>>24,hi&255,hi>>>8&255,hi>>>16&255,hi>>>24]}toBytesBE(){const hi=this.high,lo=this.low;return[hi>>>24,hi>>>16&255,hi>>>8&255,hi&255,lo>>>24,lo>>>16&255,lo>>>8&255,lo&255]}toSigned(){if(!this.unsigned)return this;return Long.fromBits(this.low,this.high,false)}toString(radix){radix=radix||10;if(radix<2||36<radix)throw new BSONError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Long.MIN_VALUE)){const radixLong=Long.fromNumber(radix),div=this.div(radixLong),rem1=div.mul(radixLong).sub(this);return div.toString(radix)+rem1.toInt().toString(radix)}else return"-"+this.neg().toString(radix)}const radixToPower=Long.fromNumber(Math.pow(radix,6),this.unsigned);let rem=this;let result="";while(true){const remDiv=rem.div(radixToPower);const intval=rem.sub(remDiv.mul(radixToPower)).toInt()>>>0;let digits=intval.toString(radix);rem=remDiv;if(rem.isZero()){return digits+result}else{while(digits.length<6)digits="0"+digits;result=""+digits+result}}}toUnsigned(){if(this.unsigned)return this;return Long.fromBits(this.low,this.high,true)}xor(other){if(!Long.isLong(other))other=Long.fromValue(other);return Long.fromBits(this.low^other.low,this.high^other.high,this.unsigned)}eqz(){return this.isZero()}le(other){return this.lessThanOrEqual(other)}toExtendedJSON(options){if(options&&options.relaxed)return this.toNumber();return{$numberLong:this.toString()}}static fromExtendedJSON(doc,options){const{useBigInt64=false,relaxed=true}={...options};if(doc.$numberLong.length>MAX_INT64_STRING_LENGTH){throw new BSONError("$numberLong string is too long")}if(!DECIMAL_REG_EX.test(doc.$numberLong)){throw new BSONError(`$numberLong string "${doc.$numberLong}" is in an invalid format`)}if(useBigInt64){const bigIntResult=BigInt(doc.$numberLong);return BigInt.asIntN(64,bigIntResult)}const longResult=Long.fromString(doc.$numberLong);if(relaxed){return longResult.toNumber()}return longResult}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Long("${this.toString()}"${this.unsigned?", true":""})`}};Long.TWO_PWR_24=Long.fromInt(TWO_PWR_24_DBL);Long.MAX_UNSIGNED_VALUE=Long.fromBits(4294967295|0,4294967295|0,true);Long.ZERO=Long.fromInt(0);Long.UZERO=Long.fromInt(0,true);Long.ONE=Long.fromInt(1);Long.UONE=Long.fromInt(1,true);Long.NEG_ONE=Long.fromInt(-1);Long.MAX_VALUE=Long.fromBits(4294967295|0,2147483647|0,false);Long.MIN_VALUE=Long.fromBits(0,2147483648|0,false);var PARSE_STRING_REGEXP=/^(\\+|-)?(\\d+|(\\d*\\.\\d*))?(E|e)?([-+])?(\\d+)?$/;var PARSE_INF_REGEXP=/^(\\+|-)?(Infinity|inf)$/i;var PARSE_NAN_REGEXP=/^(\\+|-)?NaN$/i;var EXPONENT_MAX=6111;var EXPONENT_MIN=-6176;var EXPONENT_BIAS=6176;var MAX_DIGITS=34;var NAN_BUFFER=ByteUtils.fromNumberArray([124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse());var INF_NEGATIVE_BUFFER=ByteUtils.fromNumberArray([248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse());var INF_POSITIVE_BUFFER=ByteUtils.fromNumberArray([120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse());var EXPONENT_REGEX=/^([-+])?(\\d+)?$/;var COMBINATION_MASK=31;var EXPONENT_MASK=16383;var COMBINATION_INFINITY=30;var COMBINATION_NAN=31;function isDigit(value){return!isNaN(parseInt(value,10))}function divideu128(value){const DIVISOR=Long.fromNumber(1e3*1e3*1e3);let _rem=Long.fromNumber(0);if(!value.parts[0]&&!value.parts[1]&&!value.parts[2]&&!value.parts[3]){return{quotient:value,rem:_rem}}for(let i3=0;i3<=3;i3++){_rem=_rem.shiftLeft(32);_rem=_rem.add(new Long(value.parts[i3],0));value.parts[i3]=_rem.div(DIVISOR).low;_rem=_rem.modulo(DIVISOR)}return{quotient:value,rem:_rem}}function multiply64x2(left,right){if(!left&&!right){return{high:Long.fromNumber(0),low:Long.fromNumber(0)}}const leftHigh=left.shiftRightUnsigned(32);const leftLow=new Long(left.getLowBits(),0);const rightHigh=right.shiftRightUnsigned(32);const rightLow=new Long(right.getLowBits(),0);let productHigh=leftHigh.multiply(rightHigh);let productMid=leftHigh.multiply(rightLow);const productMid2=leftLow.multiply(rightHigh);let productLow=leftLow.multiply(rightLow);productHigh=productHigh.add(productMid.shiftRightUnsigned(32));productMid=new Long(productMid.getLowBits(),0).add(productMid2).add(productLow.shiftRightUnsigned(32));productHigh=productHigh.add(productMid.shiftRightUnsigned(32));productLow=productMid.shiftLeft(32).add(new Long(productLow.getLowBits(),0));return{high:productHigh,low:productLow}}function lessThan(left,right){const uhleft=left.high>>>0;const uhright=right.high>>>0;if(uhleft<uhright){return true}else if(uhleft===uhright){const ulleft=left.low>>>0;const ulright=right.low>>>0;if(ulleft<ulright)return true}return false}function invalidErr(string,message){throw new BSONError(`"${string}" is not a valid Decimal128 string - ${message}`)}var Decimal128=class extends BSONValue{get _bsontype(){return"Decimal128"}constructor(bytes){super();if(typeof bytes==="string"){this.bytes=Decimal128.fromString(bytes).bytes}else if(isUint8Array(bytes)){if(bytes.byteLength!==16){throw new BSONError("Decimal128 must take a Buffer of 16 bytes")}this.bytes=bytes}else{throw new BSONError("Decimal128 must take a Buffer or string")}}static fromString(representation){let isNegative=false;let sawRadix=false;let foundNonZero=false;let significantDigits=0;let nDigitsRead=0;let nDigits=0;let radixPosition=0;let firstNonZero=0;const digits=[0];let nDigitsStored=0;let digitsInsert=0;let firstDigit=0;let lastDigit=0;let exponent=0;let i3=0;let significandHigh=new Long(0,0);let significandLow=new Long(0,0);let biasedExponent=0;let index=0;if(representation.length>=7e3){throw new BSONError(""+representation+" not a valid Decimal128 string")}const stringMatch=representation.match(PARSE_STRING_REGEXP);const infMatch=representation.match(PARSE_INF_REGEXP);const nanMatch=representation.match(PARSE_NAN_REGEXP);if(!stringMatch&&!infMatch&&!nanMatch||representation.length===0){throw new BSONError(""+representation+" not a valid Decimal128 string")}if(stringMatch){const unsignedNumber=stringMatch[2];const e=stringMatch[4];const expSign=stringMatch[5];const expNumber=stringMatch[6];if(e&&expNumber===void 0)invalidErr(representation,"missing exponent power");if(e&&unsignedNumber===void 0)invalidErr(representation,"missing exponent base");if(e===void 0&&(expSign||expNumber)){invalidErr(representation,"missing e before exponent")}}if(representation[index]==="+"||representation[index]==="-"){isNegative=representation[index++]==="-"}if(!isDigit(representation[index])&&representation[index]!=="."){if(representation[index]==="i"||representation[index]==="I"){return new Decimal128(isNegative?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER)}else if(representation[index]==="N"){return new Decimal128(NAN_BUFFER)}}while(isDigit(representation[index])||representation[index]==="."){if(representation[index]==="."){if(sawRadix)invalidErr(representation,"contains multiple periods");sawRadix=true;index=index+1;continue}if(nDigitsStored<34){if(representation[index]!=="0"||foundNonZero){if(!foundNonZero){firstNonZero=nDigitsRead}foundNonZero=true;digits[digitsInsert++]=parseInt(representation[index],10);nDigitsStored=nDigitsStored+1}}if(foundNonZero)nDigits=nDigits+1;if(sawRadix)radixPosition=radixPosition+1;nDigitsRead=nDigitsRead+1;index=index+1}if(sawRadix&&!nDigitsRead)throw new BSONError(""+representation+" not a valid Decimal128 string");if(representation[index]==="e"||representation[index]==="E"){const match=representation.substr(++index).match(EXPONENT_REGEX);if(!match||!match[2])return new Decimal128(NAN_BUFFER);exponent=parseInt(match[0],10);index=index+match[0].length}if(representation[index])return new Decimal128(NAN_BUFFER);firstDigit=0;if(!nDigitsStored){firstDigit=0;lastDigit=0;digits[0]=0;nDigits=1;nDigitsStored=1;significantDigits=0}else{lastDigit=nDigitsStored-1;significantDigits=nDigits;if(significantDigits!==1){while(digits[firstNonZero+significantDigits-1]===0){significantDigits=significantDigits-1}}}if(exponent<=radixPosition&&radixPosition-exponent>1<<14){exponent=EXPONENT_MIN}else{exponent=exponent-radixPosition}while(exponent>EXPONENT_MAX){lastDigit=lastDigit+1;if(lastDigit-firstDigit>MAX_DIGITS){const digitsString=digits.join("");if(digitsString.match(/^0+$/)){exponent=EXPONENT_MAX;break}invalidErr(representation,"overflow")}exponent=exponent-1}while(exponent<EXPONENT_MIN||nDigitsStored<nDigits){if(lastDigit===0&&significantDigits<nDigitsStored){exponent=EXPONENT_MIN;significantDigits=0;break}if(nDigitsStored<nDigits){nDigits=nDigits-1}else{lastDigit=lastDigit-1}if(exponent<EXPONENT_MAX){exponent=exponent+1}else{const digitsString=digits.join("");if(digitsString.match(/^0+$/)){exponent=EXPONENT_MAX;break}invalidErr(representation,"overflow")}}if(lastDigit-firstDigit+1<significantDigits){let endOfString=nDigitsRead;if(sawRadix){firstNonZero=firstNonZero+1;endOfString=endOfString+1}if(isNegative){firstNonZero=firstNonZero+1;endOfString=endOfString+1}const roundDigit=parseInt(representation[firstNonZero+lastDigit+1],10);let roundBit=0;if(roundDigit>=5){roundBit=1;if(roundDigit===5){roundBit=digits[lastDigit]%2===1?1:0;for(i3=firstNonZero+lastDigit+2;i3<endOfString;i3++){if(parseInt(representation[i3],10)){roundBit=1;break}}}}if(roundBit){let dIdx=lastDigit;for(;dIdx>=0;dIdx--){if(++digits[dIdx]>9){digits[dIdx]=0;if(dIdx===0){if(exponent<EXPONENT_MAX){exponent=exponent+1;digits[dIdx]=1}else{return new Decimal128(isNegative?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER)}}}}}}significandHigh=Long.fromNumber(0);significandLow=Long.fromNumber(0);if(significantDigits===0){significandHigh=Long.fromNumber(0);significandLow=Long.fromNumber(0)}else if(lastDigit-firstDigit<17){let dIdx=firstDigit;significandLow=Long.fromNumber(digits[dIdx++]);significandHigh=new Long(0,0);for(;dIdx<=lastDigit;dIdx++){significandLow=significandLow.multiply(Long.fromNumber(10));significandLow=significandLow.add(Long.fromNumber(digits[dIdx]))}}else{let dIdx=firstDigit;significandHigh=Long.fromNumber(digits[dIdx++]);for(;dIdx<=lastDigit-17;dIdx++){significandHigh=significandHigh.multiply(Long.fromNumber(10));significandHigh=significandHigh.add(Long.fromNumber(digits[dIdx]))}significandLow=Long.fromNumber(digits[dIdx++]);for(;dIdx<=lastDigit;dIdx++){significandLow=significandLow.multiply(Long.fromNumber(10));significandLow=significandLow.add(Long.fromNumber(digits[dIdx]))}}const significand=multiply64x2(significandHigh,Long.fromString("100000000000000000"));significand.low=significand.low.add(significandLow);if(lessThan(significand.low,significandLow)){significand.high=significand.high.add(Long.fromNumber(1))}biasedExponent=exponent+EXPONENT_BIAS;const dec={low:Long.fromNumber(0),high:Long.fromNumber(0)};if(significand.high.shiftRightUnsigned(49).and(Long.fromNumber(1)).equals(Long.fromNumber(1))){dec.high=dec.high.or(Long.fromNumber(3).shiftLeft(61));dec.high=dec.high.or(Long.fromNumber(biasedExponent).and(Long.fromNumber(16383).shiftLeft(47)));dec.high=dec.high.or(significand.high.and(Long.fromNumber(0x7fffffffffff)))}else{dec.high=dec.high.or(Long.fromNumber(biasedExponent&16383).shiftLeft(49));dec.high=dec.high.or(significand.high.and(Long.fromNumber(562949953421311)))}dec.low=significand.low;if(isNegative){dec.high=dec.high.or(Long.fromString("9223372036854775808"))}const buffer2=ByteUtils.allocate(16);index=0;buffer2[index++]=dec.low.low&255;buffer2[index++]=dec.low.low>>8&255;buffer2[index++]=dec.low.low>>16&255;buffer2[index++]=dec.low.low>>24&255;buffer2[index++]=dec.low.high&255;buffer2[index++]=dec.low.high>>8&255;buffer2[index++]=dec.low.high>>16&255;buffer2[index++]=dec.low.high>>24&255;buffer2[index++]=dec.high.low&255;buffer2[index++]=dec.high.low>>8&255;buffer2[index++]=dec.high.low>>16&255;buffer2[index++]=dec.high.low>>24&255;buffer2[index++]=dec.high.high&255;buffer2[index++]=dec.high.high>>8&255;buffer2[index++]=dec.high.high>>16&255;buffer2[index++]=dec.high.high>>24&255;return new Decimal128(buffer2)}toString(){let biased_exponent;let significand_digits=0;const significand=new Array(36);for(let i3=0;i3<significand.length;i3++)significand[i3]=0;let index=0;let is_zero=false;let significand_msb;let significand128={parts:[0,0,0,0]};let j,k;const string=[];index=0;const buffer2=this.bytes;const low=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const midl=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const midh=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const high=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;index=0;const dec={low:new Long(low,midl),high:new Long(midh,high)};if(dec.high.lessThan(Long.ZERO)){string.push("-")}const combination=high>>26&COMBINATION_MASK;if(combination>>3===3){if(combination===COMBINATION_INFINITY){return string.join("")+"Infinity"}else if(combination===COMBINATION_NAN){return"NaN"}else{biased_exponent=high>>15&EXPONENT_MASK;significand_msb=8+(high>>14&1)}}else{significand_msb=high>>14&7;biased_exponent=high>>17&EXPONENT_MASK}const exponent=biased_exponent-EXPONENT_BIAS;significand128.parts[0]=(high&16383)+((significand_msb&15)<<14);significand128.parts[1]=midh;significand128.parts[2]=midl;significand128.parts[3]=low;if(significand128.parts[0]===0&&significand128.parts[1]===0&&significand128.parts[2]===0&&significand128.parts[3]===0){is_zero=true}else{for(k=3;k>=0;k--){let least_digits=0;const result=divideu128(significand128);significand128=result.quotient;least_digits=result.rem.low;if(!least_digits)continue;for(j=8;j>=0;j--){significand[k*9+j]=least_digits%10;least_digits=Math.floor(least_digits/10)}}}if(is_zero){significand_digits=1;significand[index]=0}else{significand_digits=36;while(!significand[index]){significand_digits=significand_digits-1;index=index+1}}const scientific_exponent=significand_digits-1+exponent;if(scientific_exponent>=34||scientific_exponent<=-7||exponent>0){if(significand_digits>34){string.push(`${0}`);if(exponent>0)string.push(`E+${exponent}`);else if(exponent<0)string.push(`E${exponent}`);return string.join("")}string.push(`${significand[index++]}`);significand_digits=significand_digits-1;if(significand_digits){string.push(".")}for(let i3=0;i3<significand_digits;i3++){string.push(`${significand[index++]}`)}string.push("E");if(scientific_exponent>0){string.push(`+${scientific_exponent}`)}else{string.push(`${scientific_exponent}`)}}else{if(exponent>=0){for(let i3=0;i3<significand_digits;i3++){string.push(`${significand[index++]}`)}}else{let radix_position=significand_digits+exponent;if(radix_position>0){for(let i3=0;i3<radix_position;i3++){string.push(`${significand[index++]}`)}}else{string.push("0")}string.push(".");while(radix_position++<0){string.push("0")}for(let i3=0;i3<significand_digits-Math.max(radix_position-1,0);i3++){string.push(`${significand[index++]}`)}}}return string.join("")}toJSON(){return{$numberDecimal:this.toString()}}toExtendedJSON(){return{$numberDecimal:this.toString()}}static fromExtendedJSON(doc){return Decimal128.fromString(doc.$numberDecimal)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Decimal128("${this.toString()}")`}};var Double=class extends BSONValue{get _bsontype(){return"Double"}constructor(value){super();if(value instanceof Number){value=value.valueOf()}this.value=+value}valueOf(){return this.value}toJSON(){return this.value}toString(radix){return this.value.toString(radix)}toExtendedJSON(options){if(options&&(options.legacy||options.relaxed&&isFinite(this.value))){return this.value}if(Object.is(Math.sign(this.value),-0)){return{$numberDouble:"-0.0"}}return{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}}static fromExtendedJSON(doc,options){const doubleValue=parseFloat(doc.$numberDouble);return options&&options.relaxed?doubleValue:new Double(doubleValue)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){const eJSON=this.toExtendedJSON();return`new Double(${eJSON.$numberDouble})`}};var Int32=class extends BSONValue{get _bsontype(){return"Int32"}constructor(value){super();if(value instanceof Number){value=value.valueOf()}this.value=+value|0}valueOf(){return this.value}toString(radix){return this.value.toString(radix)}toJSON(){return this.value}toExtendedJSON(options){if(options&&(options.relaxed||options.legacy))return this.value;return{$numberInt:this.value.toString()}}static fromExtendedJSON(doc,options){return options&&options.relaxed?parseInt(doc.$numberInt,10):new Int32(doc.$numberInt)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Int32(${this.valueOf()})`}};var MaxKey=class extends BSONValue{get _bsontype(){return"MaxKey"}toExtendedJSON(){return{$maxKey:1}}static fromExtendedJSON(){return new MaxKey}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return"new MaxKey()"}};var MinKey=class extends BSONValue{get _bsontype(){return"MinKey"}toExtendedJSON(){return{$minKey:1}}static fromExtendedJSON(){return new MinKey}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return"new MinKey()"}};var checkForHexRegExp=new RegExp("^[0-9a-fA-F]{24}$");var PROCESS_UNIQUE=null;var kId=Symbol("id");var ObjectId2=class extends BSONValue{get _bsontype(){return"ObjectId"}constructor(inputId){super();let workingId;if(typeof inputId==="object"&&inputId&&"id"in inputId){if(typeof inputId.id!=="string"&&!ArrayBuffer.isView(inputId.id)){throw new BSONError("Argument passed in must have an id that is of type string or Buffer")}if("toHexString"in inputId&&typeof inputId.toHexString==="function"){workingId=ByteUtils.fromHex(inputId.toHexString())}else{workingId=inputId.id}}else{workingId=inputId}if(workingId==null||typeof workingId==="number"){this[kId]=ObjectId2.generate(typeof workingId==="number"?workingId:void 0)}else if(ArrayBuffer.isView(workingId)&&workingId.byteLength===12){this[kId]=ByteUtils.toLocalBufferType(workingId)}else if(typeof workingId==="string"){if(workingId.length===12){const bytes=ByteUtils.fromUTF8(workingId);if(bytes.byteLength===12){this[kId]=bytes}else{throw new BSONError("Argument passed in must be a string of 12 bytes")}}else if(workingId.length===24&&checkForHexRegExp.test(workingId)){this[kId]=ByteUtils.fromHex(workingId)}else{throw new BSONError("Argument passed in must be a string of 12 bytes or a string of 24 hex characters or an integer")}}else{throw new BSONError("Argument passed in does not match the accepted types")}if(ObjectId2.cacheHexString){this.__id=ByteUtils.toHex(this.id)}}get id(){return this[kId]}set id(value){this[kId]=value;if(ObjectId2.cacheHexString){this.__id=ByteUtils.toHex(value)}}toHexString(){if(ObjectId2.cacheHexString&&this.__id){return this.__id}const hexString=ByteUtils.toHex(this.id);if(ObjectId2.cacheHexString&&!this.__id){this.__id=hexString}return hexString}static getInc(){return ObjectId2.index=(ObjectId2.index+1)%16777215}static generate(time){if("number"!==typeof time){time=Math.floor(Date.now()/1e3)}const inc=ObjectId2.getInc();const buffer2=ByteUtils.allocate(12);BSONDataView.fromUint8Array(buffer2).setUint32(0,time,false);if(PROCESS_UNIQUE===null){PROCESS_UNIQUE=ByteUtils.randomBytes(5)}buffer2[4]=PROCESS_UNIQUE[0];buffer2[5]=PROCESS_UNIQUE[1];buffer2[6]=PROCESS_UNIQUE[2];buffer2[7]=PROCESS_UNIQUE[3];buffer2[8]=PROCESS_UNIQUE[4];buffer2[11]=inc&255;buffer2[10]=inc>>8&255;buffer2[9]=inc>>16&255;return buffer2}toString(encoding){if(encoding==="base64")return ByteUtils.toBase64(this.id);if(encoding==="hex")return this.toHexString();return this.toHexString()}toJSON(){return this.toHexString()}equals(otherId){if(otherId===void 0||otherId===null){return false}if(otherId instanceof ObjectId2){return this[kId][11]===otherId[kId][11]&&ByteUtils.equals(this[kId],otherId[kId])}if(typeof otherId==="string"&&ObjectId2.isValid(otherId)&&otherId.length===12&&isUint8Array(this.id)){return ByteUtils.equals(this.id,ByteUtils.fromISO88591(otherId))}if(typeof otherId==="string"&&ObjectId2.isValid(otherId)&&otherId.length===24){return otherId.toLowerCase()===this.toHexString()}if(typeof otherId==="string"&&ObjectId2.isValid(otherId)&&otherId.length===12){return ByteUtils.equals(ByteUtils.fromUTF8(otherId),this.id)}if(typeof otherId==="object"&&"toHexString"in otherId&&typeof otherId.toHexString==="function"){const otherIdString=otherId.toHexString();const thisIdString=this.toHexString().toLowerCase();return typeof otherIdString==="string"&&otherIdString.toLowerCase()===thisIdString}return false}getTimestamp(){const timestamp=new Date;const time=BSONDataView.fromUint8Array(this.id).getUint32(0,false);timestamp.setTime(Math.floor(time)*1e3);return timestamp}static createPk(){return new ObjectId2}static createFromTime(time){const buffer2=ByteUtils.fromNumberArray([0,0,0,0,0,0,0,0,0,0,0,0]);BSONDataView.fromUint8Array(buffer2).setUint32(0,time,false);return new ObjectId2(buffer2)}static createFromHexString(hexString){if(typeof hexString==="undefined"||hexString!=null&&hexString.length!==24){throw new BSONError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}return new ObjectId2(ByteUtils.fromHex(hexString))}static isValid(id){if(id==null)return false;try{new ObjectId2(id);return true}catch{return false}}toExtendedJSON(){if(this.toHexString)return{$oid:this.toHexString()};return{$oid:this.toString("hex")}}static fromExtendedJSON(doc){return new ObjectId2(doc.$oid)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new ObjectId("${this.toHexString()}")`}};ObjectId2.index=Math.floor(Math.random()*16777215);function internalCalculateObjectSize(object,serializeFunctions,ignoreUndefined){let totalLength=4+1;if(Array.isArray(object)){for(let i3=0;i3<object.length;i3++){totalLength+=calculateElement(i3.toString(),object[i3],serializeFunctions,true,ignoreUndefined)}}else{if(typeof object?.toBSON==="function"){object=object.toBSON()}for(const key of Object.keys(object)){totalLength+=calculateElement(key,object[key],serializeFunctions,false,ignoreUndefined)}}return totalLength}function calculateElement(name2,value,serializeFunctions=false,isArray=false,ignoreUndefined=false){if(typeof value?.toBSON==="function"){value=value.toBSON()}switch(typeof value){case"string":return 1+ByteUtils.utf8ByteLength(name2)+1+4+ByteUtils.utf8ByteLength(value)+1;case"number":if(Math.floor(value)===value&&value>=JS_INT_MIN&&value<=JS_INT_MAX){if(value>=BSON_INT32_MIN&&value<=BSON_INT32_MAX){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(4+1)}else{return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(8+1)}}else{return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(8+1)}case"undefined":if(isArray||!ignoreUndefined)return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1;return 0;case"boolean":return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(1+1);case"object":if(value!=null&&typeof value._bsontype==="string"&&value[Symbol.for("@@mdb.bson.version")]!==BSON_MAJOR_VERSION){throw new BSONVersionError}else if(value==null||value._bsontype==="MinKey"||value._bsontype==="MaxKey"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1}else if(value._bsontype==="ObjectId"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(12+1)}else if(value instanceof Date||isDate(value)){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(8+1)}else if(ArrayBuffer.isView(value)||value instanceof ArrayBuffer||isAnyArrayBuffer(value)){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(1+4+1)+value.byteLength}else if(value._bsontype==="Long"||value._bsontype==="Double"||value._bsontype==="Timestamp"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(8+1)}else if(value._bsontype==="Decimal128"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(16+1)}else if(value._bsontype==="Code"){if(value.scope!=null&&Object.keys(value.scope).length>0){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+4+4+ByteUtils.utf8ByteLength(value.code.toString())+1+internalCalculateObjectSize(value.scope,serializeFunctions,ignoreUndefined)}else{return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+4+ByteUtils.utf8ByteLength(value.code.toString())+1}}else if(value._bsontype==="Binary"){const binary=value;if(binary.sub_type===Binary.SUBTYPE_BYTE_ARRAY){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(binary.position+1+4+1+4)}else{return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+(binary.position+1+4+1)}}else if(value._bsontype==="Symbol"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+ByteUtils.utf8ByteLength(value.value)+4+1+1}else if(value._bsontype==="DBRef"){const ordered_values=Object.assign({$ref:value.collection,$id:value.oid},value.fields);if(value.db!=null){ordered_values["$db"]=value.db}return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+internalCalculateObjectSize(ordered_values,serializeFunctions,ignoreUndefined)}else if(value instanceof RegExp||isRegExp(value)){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+ByteUtils.utf8ByteLength(value.source)+1+(value.global?1:0)+(value.ignoreCase?1:0)+(value.multiline?1:0)+1}else if(value._bsontype==="BSONRegExp"){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+ByteUtils.utf8ByteLength(value.pattern)+1+ByteUtils.utf8ByteLength(value.options)+1}else{return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+internalCalculateObjectSize(value,serializeFunctions,ignoreUndefined)+1}case"function":if(serializeFunctions){return(name2!=null?ByteUtils.utf8ByteLength(name2)+1:0)+1+4+ByteUtils.utf8ByteLength(value.toString())+1}}return 0}function alphabetize(str23){return str23.split("").sort().join("")}var BSONRegExp=class extends BSONValue{get _bsontype(){return"BSONRegExp"}constructor(pattern,options){super();this.pattern=pattern;this.options=alphabetize(options??"");if(this.pattern.indexOf("\\0")!==-1){throw new BSONError(`BSON Regex patterns cannot contain null bytes, found: ${JSON.stringify(this.pattern)}`)}if(this.options.indexOf("\\0")!==-1){throw new BSONError(`BSON Regex options cannot contain null bytes, found: ${JSON.stringify(this.options)}`)}for(let i3=0;i3<this.options.length;i3++){if(!(this.options[i3]==="i"||this.options[i3]==="m"||this.options[i3]==="x"||this.options[i3]==="l"||this.options[i3]==="s"||this.options[i3]==="u")){throw new BSONError(`The regular expression option [${this.options[i3]}] is not supported`)}}}static parseOptions(options){return options?options.split("").sort().join(""):""}toExtendedJSON(options){options=options||{};if(options.legacy){return{$regex:this.pattern,$options:this.options}}return{$regularExpression:{pattern:this.pattern,options:this.options}}}static fromExtendedJSON(doc){if("$regex"in doc){if(typeof doc.$regex!=="string"){if(doc.$regex._bsontype==="BSONRegExp"){return doc}}else{return new BSONRegExp(doc.$regex,BSONRegExp.parseOptions(doc.$options))}}if("$regularExpression"in doc){return new BSONRegExp(doc.$regularExpression.pattern,BSONRegExp.parseOptions(doc.$regularExpression.options))}throw new BSONError(`Unexpected BSONRegExp EJSON object form: ${JSON.stringify(doc)}`)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new BSONRegExp(${JSON.stringify(this.pattern)}, ${JSON.stringify(this.options)})`}};var BSONSymbol=class extends BSONValue{get _bsontype(){return"BSONSymbol"}constructor(value){super();this.value=value}valueOf(){return this.value}toString(){return this.value}inspect(){return`new BSONSymbol("${this.value}")`}toJSON(){return this.value}toExtendedJSON(){return{$symbol:this.value}}static fromExtendedJSON(doc){return new BSONSymbol(doc.$symbol)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}};var LongWithoutOverridesClass=Long;var Timestamp=class extends LongWithoutOverridesClass{get _bsontype(){return"Timestamp"}constructor(low){if(low==null){super(0,0,true)}else if(typeof low==="bigint"){super(low,true)}else if(Long.isLong(low)){super(low.low,low.high,true)}else if(typeof low==="object"&&"t"in low&&"i"in low){if(typeof low.t!=="number"&&(typeof low.t!=="object"||low.t._bsontype!=="Int32")){throw new BSONError("Timestamp constructed from { t, i } must provide t as a number")}if(typeof low.i!=="number"&&(typeof low.i!=="object"||low.i._bsontype!=="Int32")){throw new BSONError("Timestamp constructed from { t, i } must provide i as a number")}if(low.t<0){throw new BSONError("Timestamp constructed from { t, i } must provide a positive t")}if(low.i<0){throw new BSONError("Timestamp constructed from { t, i } must provide a positive i")}if(low.t>4294967295){throw new BSONError("Timestamp constructed from { t, i } must provide t equal or less than uint32 max")}if(low.i>4294967295){throw new BSONError("Timestamp constructed from { t, i } must provide i equal or less than uint32 max")}super(low.i.valueOf(),low.t.valueOf(),true)}else{throw new BSONError("A Timestamp can only be constructed with: bigint, Long, or { t: number; i: number }")}}toJSON(){return{$timestamp:this.toString()}}static fromInt(value){return new Timestamp(Long.fromInt(value,true))}static fromNumber(value){return new Timestamp(Long.fromNumber(value,true))}static fromBits(lowBits,highBits){return new Timestamp({i:lowBits,t:highBits})}static fromString(str23,optRadix){return new Timestamp(Long.fromString(str23,true,optRadix))}toExtendedJSON(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}}static fromExtendedJSON(doc){const i3=Long.isLong(doc.$timestamp.i)?doc.$timestamp.i.getLowBitsUnsigned():doc.$timestamp.i;const t3=Long.isLong(doc.$timestamp.t)?doc.$timestamp.t.getLowBitsUnsigned():doc.$timestamp.t;return new Timestamp({t:t3,i:i3})}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Timestamp({ t: ${this.getHighBits()}, i: ${this.getLowBits()} })`}};Timestamp.MAX_VALUE=Long.MAX_UNSIGNED_VALUE;var FIRST_BIT=128;var FIRST_TWO_BITS=192;var FIRST_THREE_BITS=224;var FIRST_FOUR_BITS=240;var FIRST_FIVE_BITS=248;var TWO_BIT_CHAR=192;var THREE_BIT_CHAR=224;var FOUR_BIT_CHAR=240;var CONTINUING_CHAR=128;function validateUtf8(bytes,start,end){let continuation=0;for(let i3=start;i3<end;i3+=1){const byte=bytes[i3];if(continuation){if((byte&FIRST_TWO_BITS)!==CONTINUING_CHAR){return false}continuation-=1}else if(byte&FIRST_BIT){if((byte&FIRST_THREE_BITS)===TWO_BIT_CHAR){continuation=1}else if((byte&FIRST_FOUR_BITS)===THREE_BIT_CHAR){continuation=2}else if((byte&FIRST_FIVE_BITS)===FOUR_BIT_CHAR){continuation=3}else{return false}}}return!continuation}var JS_INT_MAX_LONG=Long.fromNumber(JS_INT_MAX);var JS_INT_MIN_LONG=Long.fromNumber(JS_INT_MIN);function internalDeserialize(buffer2,options,isArray){options=options==null?{}:options;const index=options&&options.index?options.index:0;const size=buffer2[index]|buffer2[index+1]<<8|buffer2[index+2]<<16|buffer2[index+3]<<24;if(size<5){throw new BSONError(`bson size must be >= 5, is ${size}`)}if(options.allowObjectSmallerThanBufferSize&&buffer2.length<size){throw new BSONError(`buffer length ${buffer2.length} must be >= bson size ${size}`)}if(!options.allowObjectSmallerThanBufferSize&&buffer2.length!==size){throw new BSONError(`buffer length ${buffer2.length} must === bson size ${size}`)}if(size+index>buffer2.byteLength){throw new BSONError(`(bson size ${size} + options.index ${index} must be <= buffer length ${buffer2.byteLength})`)}if(buffer2[index+size-1]!==0){throw new BSONError("One object, sized correctly, with a spot for an EOO, but the EOO isn\'t 0x00")}return deserializeObject(buffer2,index,options,isArray)}var allowedDBRefKeys=/^\\$ref$|^\\$id$|^\\$db$/;function deserializeObject(buffer2,index,options,isArray=false){const fieldsAsRaw=options["fieldsAsRaw"]==null?null:options["fieldsAsRaw"];const raw=options["raw"]==null?false:options["raw"];const bsonRegExp=typeof options["bsonRegExp"]==="boolean"?options["bsonRegExp"]:false;const promoteBuffers=options.promoteBuffers??false;const promoteLongs=options.promoteLongs??true;const promoteValues=options.promoteValues??true;const useBigInt64=options.useBigInt64??false;if(useBigInt64&&!promoteValues){throw new BSONError("Must either request bigint or Long for int64 deserialization")}if(useBigInt64&&!promoteLongs){throw new BSONError("Must either request bigint or Long for int64 deserialization")}const validation=options.validation==null?{utf8:true}:options.validation;let globalUTFValidation=true;let validationSetting;const utf8KeysSet=new Set;const utf8ValidatedKeys=validation.utf8;if(typeof utf8ValidatedKeys==="boolean"){validationSetting=utf8ValidatedKeys}else{globalUTFValidation=false;const utf8ValidationValues=Object.keys(utf8ValidatedKeys).map(function(key){return utf8ValidatedKeys[key]});if(utf8ValidationValues.length===0){throw new BSONError("UTF-8 validation setting cannot be empty")}if(typeof utf8ValidationValues[0]!=="boolean"){throw new BSONError("Invalid UTF-8 validation option, must specify boolean values")}validationSetting=utf8ValidationValues[0];if(!utf8ValidationValues.every(item=>item===validationSetting)){throw new BSONError("Invalid UTF-8 validation option - keys must be all true or all false")}}if(!globalUTFValidation){for(const key of Object.keys(utf8ValidatedKeys)){utf8KeysSet.add(key)}}const startIndex=index;if(buffer2.length<5)throw new BSONError("corrupt bson message < 5 bytes long");const size=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(size<5||size>buffer2.length)throw new BSONError("corrupt bson message");const object=isArray?[]:{};let arrayIndex=0;const done=false;let isPossibleDBRef=isArray?false:null;const dataview=new DataView(buffer2.buffer,buffer2.byteOffset,buffer2.byteLength);while(!done){const elementType=buffer2[index++];if(elementType===0)break;let i3=index;while(buffer2[i3]!==0&&i3<buffer2.length){i3++}if(i3>=buffer2.byteLength)throw new BSONError("Bad BSON Document: illegal CString");const name2=isArray?arrayIndex++:ByteUtils.toUTF8(buffer2.subarray(index,i3));let shouldValidateKey=true;if(globalUTFValidation||utf8KeysSet.has(name2)){shouldValidateKey=validationSetting}else{shouldValidateKey=!validationSetting}if(isPossibleDBRef!==false&&name2[0]==="$"){isPossibleDBRef=allowedDBRefKeys.test(name2)}let value;index=i3+1;if(elementType===BSON_DATA_STRING){const stringSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(stringSize<=0||stringSize>buffer2.length-index||buffer2[index+stringSize-1]!==0){throw new BSONError("bad string length in bson")}value=getValidatedString(buffer2,index,index+stringSize-1,shouldValidateKey);index=index+stringSize}else if(elementType===BSON_DATA_OID){const oid=ByteUtils.allocate(12);oid.set(buffer2.subarray(index,index+12));value=new ObjectId2(oid);index=index+12}else if(elementType===BSON_DATA_INT&&promoteValues===false){value=new Int32(buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24)}else if(elementType===BSON_DATA_INT){value=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24}else if(elementType===BSON_DATA_NUMBER&&promoteValues===false){value=new Double(dataview.getFloat64(index,true));index=index+8}else if(elementType===BSON_DATA_NUMBER){value=dataview.getFloat64(index,true);index=index+8}else if(elementType===BSON_DATA_DATE){const lowBits=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const highBits=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;value=new Date(new Long(lowBits,highBits).toNumber())}else if(elementType===BSON_DATA_BOOLEAN){if(buffer2[index]!==0&&buffer2[index]!==1)throw new BSONError("illegal boolean type value");value=buffer2[index++]===1}else if(elementType===BSON_DATA_OBJECT){const _index=index;const objectSize=buffer2[index]|buffer2[index+1]<<8|buffer2[index+2]<<16|buffer2[index+3]<<24;if(objectSize<=0||objectSize>buffer2.length-index)throw new BSONError("bad embedded document length in bson");if(raw){value=buffer2.slice(index,index+objectSize)}else{let objectOptions=options;if(!globalUTFValidation){objectOptions={...options,validation:{utf8:shouldValidateKey}}}value=deserializeObject(buffer2,_index,objectOptions,false)}index=index+objectSize}else if(elementType===BSON_DATA_ARRAY){const _index=index;const objectSize=buffer2[index]|buffer2[index+1]<<8|buffer2[index+2]<<16|buffer2[index+3]<<24;let arrayOptions=options;const stopIndex=index+objectSize;if(fieldsAsRaw&&fieldsAsRaw[name2]){arrayOptions={...options,raw:true}}if(!globalUTFValidation){arrayOptions={...arrayOptions,validation:{utf8:shouldValidateKey}}}value=deserializeObject(buffer2,_index,arrayOptions,true);index=index+objectSize;if(buffer2[index-1]!==0)throw new BSONError("invalid array terminator byte");if(index!==stopIndex)throw new BSONError("corrupted array bson")}else if(elementType===BSON_DATA_UNDEFINED){value=void 0}else if(elementType===BSON_DATA_NULL){value=null}else if(elementType===BSON_DATA_LONG){const dataview2=BSONDataView.fromUint8Array(buffer2.subarray(index,index+8));const lowBits=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const highBits=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const long=new Long(lowBits,highBits);if(useBigInt64){value=dataview2.getBigInt64(0,true)}else if(promoteLongs&&promoteValues===true){value=long.lessThanOrEqual(JS_INT_MAX_LONG)&&long.greaterThanOrEqual(JS_INT_MIN_LONG)?long.toNumber():long}else{value=long}}else if(elementType===BSON_DATA_DECIMAL128){const bytes=ByteUtils.allocate(16);bytes.set(buffer2.subarray(index,index+16),0);index=index+16;value=new Decimal128(bytes)}else if(elementType===BSON_DATA_BINARY){let binarySize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;const totalBinarySize=binarySize;const subType=buffer2[index++];if(binarySize<0)throw new BSONError("Negative binary type element size found");if(binarySize>buffer2.byteLength)throw new BSONError("Binary type size larger than document size");if(buffer2["slice"]!=null){if(subType===Binary.SUBTYPE_BYTE_ARRAY){binarySize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(binarySize<0)throw new BSONError("Negative binary type element size found for subtype 0x02");if(binarySize>totalBinarySize-4)throw new BSONError("Binary type with subtype 0x02 contains too long binary size");if(binarySize<totalBinarySize-4)throw new BSONError("Binary type with subtype 0x02 contains too short binary size")}if(promoteBuffers&&promoteValues){value=ByteUtils.toLocalBufferType(buffer2.slice(index,index+binarySize))}else{value=new Binary(buffer2.slice(index,index+binarySize),subType);if(subType===BSON_BINARY_SUBTYPE_UUID_NEW){value=value.toUUID()}}}else{const _buffer=ByteUtils.allocate(binarySize);if(subType===Binary.SUBTYPE_BYTE_ARRAY){binarySize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(binarySize<0)throw new BSONError("Negative binary type element size found for subtype 0x02");if(binarySize>totalBinarySize-4)throw new BSONError("Binary type with subtype 0x02 contains too long binary size");if(binarySize<totalBinarySize-4)throw new BSONError("Binary type with subtype 0x02 contains too short binary size")}for(i3=0;i3<binarySize;i3++){_buffer[i3]=buffer2[index+i3]}if(promoteBuffers&&promoteValues){value=_buffer}else if(subType===BSON_BINARY_SUBTYPE_UUID_NEW){value=new Binary(buffer2.slice(index,index+binarySize),subType).toUUID()}else{value=new Binary(buffer2.slice(index,index+binarySize),subType)}}index=index+binarySize}else if(elementType===BSON_DATA_REGEXP&&bsonRegExp===false){i3=index;while(buffer2[i3]!==0&&i3<buffer2.length){i3++}if(i3>=buffer2.length)throw new BSONError("Bad BSON Document: illegal CString");const source=ByteUtils.toUTF8(buffer2.subarray(index,i3));index=i3+1;i3=index;while(buffer2[i3]!==0&&i3<buffer2.length){i3++}if(i3>=buffer2.length)throw new BSONError("Bad BSON Document: illegal CString");const regExpOptions=ByteUtils.toUTF8(buffer2.subarray(index,i3));index=i3+1;const optionsArray=new Array(regExpOptions.length);for(i3=0;i3<regExpOptions.length;i3++){switch(regExpOptions[i3]){case"m":optionsArray[i3]="m";break;case"s":optionsArray[i3]="g";break;case"i":optionsArray[i3]="i";break}}value=new RegExp(source,optionsArray.join(""))}else if(elementType===BSON_DATA_REGEXP&&bsonRegExp===true){i3=index;while(buffer2[i3]!==0&&i3<buffer2.length){i3++}if(i3>=buffer2.length)throw new BSONError("Bad BSON Document: illegal CString");const source=ByteUtils.toUTF8(buffer2.subarray(index,i3));index=i3+1;i3=index;while(buffer2[i3]!==0&&i3<buffer2.length){i3++}if(i3>=buffer2.length)throw new BSONError("Bad BSON Document: illegal CString");const regExpOptions=ByteUtils.toUTF8(buffer2.subarray(index,i3));index=i3+1;value=new BSONRegExp(source,regExpOptions)}else if(elementType===BSON_DATA_SYMBOL){const stringSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(stringSize<=0||stringSize>buffer2.length-index||buffer2[index+stringSize-1]!==0){throw new BSONError("bad string length in bson")}const symbol=getValidatedString(buffer2,index,index+stringSize-1,shouldValidateKey);value=promoteValues?symbol:new BSONSymbol(symbol);index=index+stringSize}else if(elementType===BSON_DATA_TIMESTAMP){const i22=buffer2[index++]+buffer2[index++]*(1<<8)+buffer2[index++]*(1<<16)+buffer2[index++]*(1<<24);const t3=buffer2[index++]+buffer2[index++]*(1<<8)+buffer2[index++]*(1<<16)+buffer2[index++]*(1<<24);value=new Timestamp({i:i22,t:t3})}else if(elementType===BSON_DATA_MIN_KEY){value=new MinKey}else if(elementType===BSON_DATA_MAX_KEY){value=new MaxKey}else if(elementType===BSON_DATA_CODE){const stringSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(stringSize<=0||stringSize>buffer2.length-index||buffer2[index+stringSize-1]!==0){throw new BSONError("bad string length in bson")}const functionString=getValidatedString(buffer2,index,index+stringSize-1,shouldValidateKey);value=new Code(functionString);index=index+stringSize}else if(elementType===BSON_DATA_CODE_W_SCOPE){const totalSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(totalSize<4+4+4+1){throw new BSONError("code_w_scope total size shorter minimum expected length")}const stringSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(stringSize<=0||stringSize>buffer2.length-index||buffer2[index+stringSize-1]!==0){throw new BSONError("bad string length in bson")}const functionString=getValidatedString(buffer2,index,index+stringSize-1,shouldValidateKey);index=index+stringSize;const _index=index;const objectSize=buffer2[index]|buffer2[index+1]<<8|buffer2[index+2]<<16|buffer2[index+3]<<24;const scopeObject=deserializeObject(buffer2,_index,options,false);index=index+objectSize;if(totalSize<4+4+objectSize+stringSize){throw new BSONError("code_w_scope total size is too short, truncating scope")}if(totalSize>4+4+objectSize+stringSize){throw new BSONError("code_w_scope total size is too long, clips outer document")}value=new Code(functionString,scopeObject)}else if(elementType===BSON_DATA_DBPOINTER){const stringSize=buffer2[index++]|buffer2[index++]<<8|buffer2[index++]<<16|buffer2[index++]<<24;if(stringSize<=0||stringSize>buffer2.length-index||buffer2[index+stringSize-1]!==0)throw new BSONError("bad string length in bson");if(validation!=null&&validation.utf8){if(!validateUtf8(buffer2,index,index+stringSize-1)){throw new BSONError("Invalid UTF-8 string in BSON document")}}const namespace=ByteUtils.toUTF8(buffer2.subarray(index,index+stringSize-1));index=index+stringSize;const oidBuffer=ByteUtils.allocate(12);oidBuffer.set(buffer2.subarray(index,index+12),0);const oid=new ObjectId2(oidBuffer);index=index+12;value=new DBRef(namespace,oid)}else{throw new BSONError(`Detected unknown BSON type ${elementType.toString(16)} for fieldname "${name2}"`)}if(name2==="__proto__"){Object.defineProperty(object,name2,{value,writable:true,enumerable:true,configurable:true})}else{object[name2]=value}}if(size!==index-startIndex){if(isArray)throw new BSONError("corrupt array bson");throw new BSONError("corrupt object bson")}if(!isPossibleDBRef)return object;if(isDBRefLike(object)){const copy=Object.assign({},object);delete copy.$ref;delete copy.$id;delete copy.$db;return new DBRef(object.$ref,object.$id,object.$db,copy)}return object}function getValidatedString(buffer2,start,end,shouldValidateUtf8){const value=ByteUtils.toUTF8(buffer2.subarray(start,end));if(shouldValidateUtf8){for(let i3=0;i3<value.length;i3++){if(value.charCodeAt(i3)===65533){if(!validateUtf8(buffer2,start,end)){throw new BSONError("Invalid UTF-8 string in BSON document")}break}}}return value}var regexp=/\\x00/;var ignoreKeys=new Set(["$db","$ref","$id","$clusterTime"]);function serializeString(buffer2,key,value,index){buffer2[index++]=BSON_DATA_STRING;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes+1;buffer2[index-1]=0;const size=ByteUtils.encodeUTF8Into(buffer2,value,index+4);buffer2[index+3]=size+1>>24&255;buffer2[index+2]=size+1>>16&255;buffer2[index+1]=size+1>>8&255;buffer2[index]=size+1&255;index=index+4+size;buffer2[index++]=0;return index}var NUMBER_SPACE=new DataView(new ArrayBuffer(8),0,8);var FOUR_BYTE_VIEW_ON_NUMBER=new Uint8Array(NUMBER_SPACE.buffer,0,4);var EIGHT_BYTE_VIEW_ON_NUMBER=new Uint8Array(NUMBER_SPACE.buffer,0,8);function serializeNumber(buffer2,key,value,index){const isNegativeZero=Object.is(value,-0);const type=!isNegativeZero&&Number.isSafeInteger(value)&&value<=BSON_INT32_MAX&&value>=BSON_INT32_MIN?BSON_DATA_INT:BSON_DATA_NUMBER;if(type===BSON_DATA_INT){NUMBER_SPACE.setInt32(0,value,true)}else{NUMBER_SPACE.setFloat64(0,value,true)}const bytes=type===BSON_DATA_INT?FOUR_BYTE_VIEW_ON_NUMBER:EIGHT_BYTE_VIEW_ON_NUMBER;buffer2[index++]=type;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;buffer2.set(bytes,index);index+=bytes.byteLength;return index}function serializeBigInt(buffer2,key,value,index){buffer2[index++]=BSON_DATA_LONG;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index+=numberOfWrittenBytes;buffer2[index++]=0;NUMBER_SPACE.setBigInt64(0,value,true);buffer2.set(EIGHT_BYTE_VIEW_ON_NUMBER,index);index+=EIGHT_BYTE_VIEW_ON_NUMBER.byteLength;return index}function serializeNull(buffer2,key,_,index){buffer2[index++]=BSON_DATA_NULL;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;return index}function serializeBoolean(buffer2,key,value,index){buffer2[index++]=BSON_DATA_BOOLEAN;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;buffer2[index++]=value?1:0;return index}function serializeDate(buffer2,key,value,index){buffer2[index++]=BSON_DATA_DATE;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const dateInMilis=Long.fromNumber(value.getTime());const lowBits=dateInMilis.getLowBits();const highBits=dateInMilis.getHighBits();buffer2[index++]=lowBits&255;buffer2[index++]=lowBits>>8&255;buffer2[index++]=lowBits>>16&255;buffer2[index++]=lowBits>>24&255;buffer2[index++]=highBits&255;buffer2[index++]=highBits>>8&255;buffer2[index++]=highBits>>16&255;buffer2[index++]=highBits>>24&255;return index}function serializeRegExp(buffer2,key,value,index){buffer2[index++]=BSON_DATA_REGEXP;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;if(value.source&&value.source.match(regexp)!=null){throw new BSONError("value "+value.source+" must not contain null bytes")}index=index+ByteUtils.encodeUTF8Into(buffer2,value.source,index);buffer2[index++]=0;if(value.ignoreCase)buffer2[index++]=105;if(value.global)buffer2[index++]=115;if(value.multiline)buffer2[index++]=109;buffer2[index++]=0;return index}function serializeBSONRegExp(buffer2,key,value,index){buffer2[index++]=BSON_DATA_REGEXP;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;if(value.pattern.match(regexp)!=null){throw new BSONError("pattern "+value.pattern+" must not contain null bytes")}index=index+ByteUtils.encodeUTF8Into(buffer2,value.pattern,index);buffer2[index++]=0;const sortedOptions=value.options.split("").sort().join("");index=index+ByteUtils.encodeUTF8Into(buffer2,sortedOptions,index);buffer2[index++]=0;return index}function serializeMinMax(buffer2,key,value,index){if(value===null){buffer2[index++]=BSON_DATA_NULL}else if(value._bsontype==="MinKey"){buffer2[index++]=BSON_DATA_MIN_KEY}else{buffer2[index++]=BSON_DATA_MAX_KEY}const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;return index}function serializeObjectId(buffer2,key,value,index){buffer2[index++]=BSON_DATA_OID;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;if(isUint8Array(value.id)){buffer2.set(value.id.subarray(0,12),index)}else{throw new BSONError("object ["+JSON.stringify(value)+"] is not a valid ObjectId")}return index+12}function serializeBuffer(buffer2,key,value,index){buffer2[index++]=BSON_DATA_BINARY;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const size=value.length;buffer2[index++]=size&255;buffer2[index++]=size>>8&255;buffer2[index++]=size>>16&255;buffer2[index++]=size>>24&255;buffer2[index++]=BSON_BINARY_SUBTYPE_DEFAULT;buffer2.set(value,index);index=index+size;return index}function serializeObject(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path){if(path.has(value)){throw new BSONError("Cannot convert circular structure to BSON")}path.add(value);buffer2[index++]=Array.isArray(value)?BSON_DATA_ARRAY:BSON_DATA_OBJECT;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const endIndex=serializeInto(buffer2,value,checkKeys,index,depth+1,serializeFunctions,ignoreUndefined,path);path.delete(value);return endIndex}function serializeDecimal128(buffer2,key,value,index){buffer2[index++]=BSON_DATA_DECIMAL128;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;buffer2.set(value.bytes.subarray(0,16),index);return index+16}function serializeLong(buffer2,key,value,index){buffer2[index++]=value._bsontype==="Long"?BSON_DATA_LONG:BSON_DATA_TIMESTAMP;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const lowBits=value.getLowBits();const highBits=value.getHighBits();buffer2[index++]=lowBits&255;buffer2[index++]=lowBits>>8&255;buffer2[index++]=lowBits>>16&255;buffer2[index++]=lowBits>>24&255;buffer2[index++]=highBits&255;buffer2[index++]=highBits>>8&255;buffer2[index++]=highBits>>16&255;buffer2[index++]=highBits>>24&255;return index}function serializeInt32(buffer2,key,value,index){value=value.valueOf();buffer2[index++]=BSON_DATA_INT;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;buffer2[index++]=value&255;buffer2[index++]=value>>8&255;buffer2[index++]=value>>16&255;buffer2[index++]=value>>24&255;return index}function serializeDouble(buffer2,key,value,index){buffer2[index++]=BSON_DATA_NUMBER;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;NUMBER_SPACE.setFloat64(0,value.value,true);buffer2.set(EIGHT_BYTE_VIEW_ON_NUMBER,index);index=index+8;return index}function serializeFunction(buffer2,key,value,index){buffer2[index++]=BSON_DATA_CODE;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const functionString=value.toString();const size=ByteUtils.encodeUTF8Into(buffer2,functionString,index+4)+1;buffer2[index]=size&255;buffer2[index+1]=size>>8&255;buffer2[index+2]=size>>16&255;buffer2[index+3]=size>>24&255;index=index+4+size-1;buffer2[index++]=0;return index}function serializeCode(buffer2,key,value,index,checkKeys=false,depth=0,serializeFunctions=false,ignoreUndefined=true,path){if(value.scope&&typeof value.scope==="object"){buffer2[index++]=BSON_DATA_CODE_W_SCOPE;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;let startIndex=index;const functionString=value.code;index=index+4;const codeSize=ByteUtils.encodeUTF8Into(buffer2,functionString,index+4)+1;buffer2[index]=codeSize&255;buffer2[index+1]=codeSize>>8&255;buffer2[index+2]=codeSize>>16&255;buffer2[index+3]=codeSize>>24&255;buffer2[index+4+codeSize-1]=0;index=index+codeSize+4;const endIndex=serializeInto(buffer2,value.scope,checkKeys,index,depth+1,serializeFunctions,ignoreUndefined,path);index=endIndex-1;const totalSize=endIndex-startIndex;buffer2[startIndex++]=totalSize&255;buffer2[startIndex++]=totalSize>>8&255;buffer2[startIndex++]=totalSize>>16&255;buffer2[startIndex++]=totalSize>>24&255;buffer2[index++]=0}else{buffer2[index++]=BSON_DATA_CODE;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const functionString=value.code.toString();const size=ByteUtils.encodeUTF8Into(buffer2,functionString,index+4)+1;buffer2[index]=size&255;buffer2[index+1]=size>>8&255;buffer2[index+2]=size>>16&255;buffer2[index+3]=size>>24&255;index=index+4+size-1;buffer2[index++]=0}return index}function serializeBinary(buffer2,key,value,index){buffer2[index++]=BSON_DATA_BINARY;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const data=value.buffer;let size=value.position;if(value.sub_type===Binary.SUBTYPE_BYTE_ARRAY)size=size+4;buffer2[index++]=size&255;buffer2[index++]=size>>8&255;buffer2[index++]=size>>16&255;buffer2[index++]=size>>24&255;buffer2[index++]=value.sub_type;if(value.sub_type===Binary.SUBTYPE_BYTE_ARRAY){size=size-4;buffer2[index++]=size&255;buffer2[index++]=size>>8&255;buffer2[index++]=size>>16&255;buffer2[index++]=size>>24&255}buffer2.set(data,index);index=index+value.position;return index}function serializeSymbol(buffer2,key,value,index){buffer2[index++]=BSON_DATA_SYMBOL;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;const size=ByteUtils.encodeUTF8Into(buffer2,value.value,index+4)+1;buffer2[index]=size&255;buffer2[index+1]=size>>8&255;buffer2[index+2]=size>>16&255;buffer2[index+3]=size>>24&255;index=index+4+size-1;buffer2[index++]=0;return index}function serializeDBRef(buffer2,key,value,index,depth,serializeFunctions,path){buffer2[index++]=BSON_DATA_OBJECT;const numberOfWrittenBytes=ByteUtils.encodeUTF8Into(buffer2,key,index);index=index+numberOfWrittenBytes;buffer2[index++]=0;let startIndex=index;let output={$ref:value.collection||value.namespace,$id:value.oid};if(value.db!=null){output.$db=value.db}output=Object.assign(output,value.fields);const endIndex=serializeInto(buffer2,output,false,index,depth+1,serializeFunctions,true,path);const size=endIndex-startIndex;buffer2[startIndex++]=size&255;buffer2[startIndex++]=size>>8&255;buffer2[startIndex++]=size>>16&255;buffer2[startIndex++]=size>>24&255;return endIndex}function serializeInto(buffer2,object,checkKeys,startingIndex,depth,serializeFunctions,ignoreUndefined,path){if(path==null){if(object==null){buffer2[0]=5;buffer2[1]=0;buffer2[2]=0;buffer2[3]=0;buffer2[4]=0;return 5}if(Array.isArray(object)){throw new BSONError("serialize does not support an array as the root input")}if(typeof object!=="object"){throw new BSONError("serialize does not support non-object as the root input")}else if("_bsontype"in object&&typeof object._bsontype==="string"){throw new BSONError(`BSON types cannot be serialized as a document`)}else if(isDate(object)||isRegExp(object)||isUint8Array(object)||isAnyArrayBuffer(object)){throw new BSONError(`date, regexp, typedarray, and arraybuffer cannot be BSON documents`)}path=new Set}path.add(object);let index=startingIndex+4;if(Array.isArray(object)){for(let i3=0;i3<object.length;i3++){const key=`${i3}`;let value=object[i3];if(typeof value?.toBSON==="function"){value=value.toBSON()}if(typeof value==="string"){index=serializeString(buffer2,key,value,index)}else if(typeof value==="number"){index=serializeNumber(buffer2,key,value,index)}else if(typeof value==="bigint"){index=serializeBigInt(buffer2,key,value,index)}else if(typeof value==="boolean"){index=serializeBoolean(buffer2,key,value,index)}else if(value instanceof Date||isDate(value)){index=serializeDate(buffer2,key,value,index)}else if(value===void 0){index=serializeNull(buffer2,key,value,index)}else if(value===null){index=serializeNull(buffer2,key,value,index)}else if(isUint8Array(value)){index=serializeBuffer(buffer2,key,value,index)}else if(value instanceof RegExp||isRegExp(value)){index=serializeRegExp(buffer2,key,value,index)}else if(typeof value==="object"&&value._bsontype==null){index=serializeObject(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(typeof value==="object"&&value[Symbol.for("@@mdb.bson.version")]!==BSON_MAJOR_VERSION){throw new BSONVersionError}else if(value._bsontype==="ObjectId"){index=serializeObjectId(buffer2,key,value,index)}else if(value._bsontype==="Decimal128"){index=serializeDecimal128(buffer2,key,value,index)}else if(value._bsontype==="Long"||value._bsontype==="Timestamp"){index=serializeLong(buffer2,key,value,index)}else if(value._bsontype==="Double"){index=serializeDouble(buffer2,key,value,index)}else if(typeof value==="function"&&serializeFunctions){index=serializeFunction(buffer2,key,value,index)}else if(value._bsontype==="Code"){index=serializeCode(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(value._bsontype==="Binary"){index=serializeBinary(buffer2,key,value,index)}else if(value._bsontype==="BSONSymbol"){index=serializeSymbol(buffer2,key,value,index)}else if(value._bsontype==="DBRef"){index=serializeDBRef(buffer2,key,value,index,depth,serializeFunctions,path)}else if(value._bsontype==="BSONRegExp"){index=serializeBSONRegExp(buffer2,key,value,index)}else if(value._bsontype==="Int32"){index=serializeInt32(buffer2,key,value,index)}else if(value._bsontype==="MinKey"||value._bsontype==="MaxKey"){index=serializeMinMax(buffer2,key,value,index)}else if(typeof value._bsontype!=="undefined"){throw new BSONError(`Unrecognized or invalid _bsontype: ${String(value._bsontype)}`)}}}else if(object instanceof Map||isMap(object)){const iterator=object.entries();let done=false;while(!done){const entry=iterator.next();done=!!entry.done;if(done)continue;const key=entry.value[0];let value=entry.value[1];if(typeof value?.toBSON==="function"){value=value.toBSON()}const type=typeof value;if(typeof key==="string"&&!ignoreKeys.has(key)){if(key.match(regexp)!=null){throw new BSONError("key "+key+" must not contain null bytes")}if(checkKeys){if("$"===key[0]){throw new BSONError("key "+key+" must not start with \'$\'")}else if(~key.indexOf(".")){throw new BSONError("key "+key+" must not contain \'.\'")}}}if(type==="string"){index=serializeString(buffer2,key,value,index)}else if(type==="number"){index=serializeNumber(buffer2,key,value,index)}else if(type==="bigint"){index=serializeBigInt(buffer2,key,value,index)}else if(type==="boolean"){index=serializeBoolean(buffer2,key,value,index)}else if(value instanceof Date||isDate(value)){index=serializeDate(buffer2,key,value,index)}else if(value===null||value===void 0&&ignoreUndefined===false){index=serializeNull(buffer2,key,value,index)}else if(isUint8Array(value)){index=serializeBuffer(buffer2,key,value,index)}else if(value instanceof RegExp||isRegExp(value)){index=serializeRegExp(buffer2,key,value,index)}else if(type==="object"&&value._bsontype==null){index=serializeObject(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(typeof value==="object"&&value[Symbol.for("@@mdb.bson.version")]!==BSON_MAJOR_VERSION){throw new BSONVersionError}else if(value._bsontype==="ObjectId"){index=serializeObjectId(buffer2,key,value,index)}else if(type==="object"&&value._bsontype==="Decimal128"){index=serializeDecimal128(buffer2,key,value,index)}else if(value._bsontype==="Long"||value._bsontype==="Timestamp"){index=serializeLong(buffer2,key,value,index)}else if(value._bsontype==="Double"){index=serializeDouble(buffer2,key,value,index)}else if(value._bsontype==="Code"){index=serializeCode(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(typeof value==="function"&&serializeFunctions){index=serializeFunction(buffer2,key,value,index)}else if(value._bsontype==="Binary"){index=serializeBinary(buffer2,key,value,index)}else if(value._bsontype==="BSONSymbol"){index=serializeSymbol(buffer2,key,value,index)}else if(value._bsontype==="DBRef"){index=serializeDBRef(buffer2,key,value,index,depth,serializeFunctions,path)}else if(value._bsontype==="BSONRegExp"){index=serializeBSONRegExp(buffer2,key,value,index)}else if(value._bsontype==="Int32"){index=serializeInt32(buffer2,key,value,index)}else if(value._bsontype==="MinKey"||value._bsontype==="MaxKey"){index=serializeMinMax(buffer2,key,value,index)}else if(typeof value._bsontype!=="undefined"){throw new BSONError(`Unrecognized or invalid _bsontype: ${String(value._bsontype)}`)}}}else{if(typeof object?.toBSON==="function"){object=object.toBSON();if(object!=null&&typeof object!=="object"){throw new BSONError("toBSON function did not return an object")}}for(const key of Object.keys(object)){let value=object[key];if(typeof value?.toBSON==="function"){value=value.toBSON()}const type=typeof value;if(typeof key==="string"&&!ignoreKeys.has(key)){if(key.match(regexp)!=null){throw new BSONError("key "+key+" must not contain null bytes")}if(checkKeys){if("$"===key[0]){throw new BSONError("key "+key+" must not start with \'$\'")}else if(~key.indexOf(".")){throw new BSONError("key "+key+" must not contain \'.\'")}}}if(type==="string"){index=serializeString(buffer2,key,value,index)}else if(type==="number"){index=serializeNumber(buffer2,key,value,index)}else if(type==="bigint"){index=serializeBigInt(buffer2,key,value,index)}else if(type==="boolean"){index=serializeBoolean(buffer2,key,value,index)}else if(value instanceof Date||isDate(value)){index=serializeDate(buffer2,key,value,index)}else if(value===void 0){if(ignoreUndefined===false)index=serializeNull(buffer2,key,value,index)}else if(value===null){index=serializeNull(buffer2,key,value,index)}else if(isUint8Array(value)){index=serializeBuffer(buffer2,key,value,index)}else if(value instanceof RegExp||isRegExp(value)){index=serializeRegExp(buffer2,key,value,index)}else if(type==="object"&&value._bsontype==null){index=serializeObject(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(typeof value==="object"&&value[Symbol.for("@@mdb.bson.version")]!==BSON_MAJOR_VERSION){throw new BSONVersionError}else if(value._bsontype==="ObjectId"){index=serializeObjectId(buffer2,key,value,index)}else if(type==="object"&&value._bsontype==="Decimal128"){index=serializeDecimal128(buffer2,key,value,index)}else if(value._bsontype==="Long"||value._bsontype==="Timestamp"){index=serializeLong(buffer2,key,value,index)}else if(value._bsontype==="Double"){index=serializeDouble(buffer2,key,value,index)}else if(value._bsontype==="Code"){index=serializeCode(buffer2,key,value,index,checkKeys,depth,serializeFunctions,ignoreUndefined,path)}else if(typeof value==="function"&&serializeFunctions){index=serializeFunction(buffer2,key,value,index)}else if(value._bsontype==="Binary"){index=serializeBinary(buffer2,key,value,index)}else if(value._bsontype==="BSONSymbol"){index=serializeSymbol(buffer2,key,value,index)}else if(value._bsontype==="DBRef"){index=serializeDBRef(buffer2,key,value,index,depth,serializeFunctions,path)}else if(value._bsontype==="BSONRegExp"){index=serializeBSONRegExp(buffer2,key,value,index)}else if(value._bsontype==="Int32"){index=serializeInt32(buffer2,key,value,index)}else if(value._bsontype==="MinKey"||value._bsontype==="MaxKey"){index=serializeMinMax(buffer2,key,value,index)}else if(typeof value._bsontype!=="undefined"){throw new BSONError(`Unrecognized or invalid _bsontype: ${String(value._bsontype)}`)}}}path.delete(object);buffer2[index++]=0;const size=index-startingIndex;buffer2[startingIndex++]=size&255;buffer2[startingIndex++]=size>>8&255;buffer2[startingIndex++]=size>>16&255;buffer2[startingIndex++]=size>>24&255;return index}function isBSONType(value){return value!=null&&typeof value==="object"&&"_bsontype"in value&&typeof value._bsontype==="string"}var keysToCodecs={$oid:ObjectId2,$binary:Binary,$uuid:Binary,$symbol:BSONSymbol,$numberInt:Int32,$numberDecimal:Decimal128,$numberDouble:Double,$numberLong:Long,$minKey:MinKey,$maxKey:MaxKey,$regex:BSONRegExp,$regularExpression:BSONRegExp,$timestamp:Timestamp};function deserializeValue(value,options={}){if(typeof value==="number"){const in32BitRange=value<=BSON_INT32_MAX&&value>=BSON_INT32_MIN;const in64BitRange=value<=BSON_INT64_MAX&&value>=BSON_INT64_MIN;if(options.relaxed||options.legacy){return value}if(Number.isInteger(value)&&!Object.is(value,-0)){if(in32BitRange){return new Int32(value)}if(in64BitRange){if(options.useBigInt64){return BigInt(value)}return Long.fromNumber(value)}}return new Double(value)}if(value==null||typeof value!=="object")return value;if(value.$undefined)return null;const keys3=Object.keys(value).filter(k=>k.startsWith("$")&&value[k]!=null);for(let i3=0;i3<keys3.length;i3++){const c=keysToCodecs[keys3[i3]];if(c)return c.fromExtendedJSON(value,options)}if(value.$date!=null){const d2=value.$date;const date=new Date;if(options.legacy){if(typeof d2==="number")date.setTime(d2);else if(typeof d2==="string")date.setTime(Date.parse(d2));else if(typeof d2==="bigint")date.setTime(Number(d2));else throw new BSONRuntimeError(`Unrecognized type for EJSON date: ${typeof d2}`)}else{if(typeof d2==="string")date.setTime(Date.parse(d2));else if(Long.isLong(d2))date.setTime(d2.toNumber());else if(typeof d2==="number"&&options.relaxed)date.setTime(d2);else if(typeof d2==="bigint")date.setTime(Number(d2));else throw new BSONRuntimeError(`Unrecognized type for EJSON date: ${typeof d2}`)}return date}if(value.$code!=null){const copy=Object.assign({},value);if(value.$scope){copy.$scope=deserializeValue(value.$scope)}return Code.fromExtendedJSON(value)}if(isDBRefLike(value)||value.$dbPointer){const v2=value.$ref?value:value.$dbPointer;if(v2 instanceof DBRef)return v2;const dollarKeys=Object.keys(v2).filter(k=>k.startsWith("$"));let valid=true;dollarKeys.forEach(k=>{if(["$ref","$id","$db"].indexOf(k)===-1)valid=false});if(valid)return DBRef.fromExtendedJSON(v2)}return value}function serializeArray(array,options){return array.map((v2,index)=>{options.seenObjects.push({propertyName:`index ${index}`,obj:null});try{return serializeValue(v2,options)}finally{options.seenObjects.pop()}})}function getISOString(date){const isoStr=date.toISOString();return date.getUTCMilliseconds()!==0?isoStr:isoStr.slice(0,-5)+"Z"}function serializeValue(value,options){if(value instanceof Map||isMap(value)){const obj=Object.create(null);for(const[k,v2]of value){if(typeof k!=="string"){throw new BSONError("Can only serialize maps with string keys")}obj[k]=v2}return serializeValue(obj,options)}if((typeof value==="object"||typeof value==="function")&&value!==null){const index=options.seenObjects.findIndex(entry=>entry.obj===value);if(index!==-1){const props=options.seenObjects.map(entry=>entry.propertyName);const leadingPart=props.slice(0,index).map(prop=>`${prop} -> `).join("");const alreadySeen=props[index];const circularPart=" -> "+props.slice(index+1,props.length-1).map(prop=>`${prop} -> `).join("");const current=props[props.length-1];const leadingSpace=" ".repeat(leadingPart.length+alreadySeen.length/2);const dashes="-".repeat(circularPart.length+(alreadySeen.length+current.length)/2-1);throw new BSONError(`Converting circular structure to EJSON:\n    ${leadingPart}${alreadySeen}${circularPart}${current}\n    ${leadingSpace}\\\\${dashes}/`)}options.seenObjects[options.seenObjects.length-1].obj=value}if(Array.isArray(value))return serializeArray(value,options);if(value===void 0)return null;if(value instanceof Date||isDate(value)){const dateNum=value.getTime(),inRange=dateNum>-1&&dateNum<2534023188e5;if(options.legacy){return options.relaxed&&inRange?{$date:value.getTime()}:{$date:getISOString(value)}}return options.relaxed&&inRange?{$date:getISOString(value)}:{$date:{$numberLong:value.getTime().toString()}}}if(typeof value==="number"&&(!options.relaxed||!isFinite(value))){if(Number.isInteger(value)&&!Object.is(value,-0)){if(value>=BSON_INT32_MIN&&value<=BSON_INT32_MAX){return{$numberInt:value.toString()}}if(value>=BSON_INT64_MIN&&value<=BSON_INT64_MAX){return{$numberLong:value.toString()}}}return{$numberDouble:Object.is(value,-0)?"-0.0":value.toString()}}if(typeof value==="bigint"){if(!options.relaxed){return{$numberLong:BigInt.asIntN(64,value).toString()}}return Number(BigInt.asIntN(64,value))}if(value instanceof RegExp||isRegExp(value)){let flags=value.flags;if(flags===void 0){const match=value.toString().match(/[gimuy]*$/);if(match){flags=match[0]}}const rx=new BSONRegExp(value.source,flags);return rx.toExtendedJSON(options)}if(value!=null&&typeof value==="object")return serializeDocument(value,options);return value}var BSON_TYPE_MAPPINGS={Binary:o=>new Binary(o.value(),o.sub_type),Code:o=>new Code(o.code,o.scope),DBRef:o=>new DBRef(o.collection||o.namespace,o.oid,o.db,o.fields),Decimal128:o=>new Decimal128(o.bytes),Double:o=>new Double(o.value),Int32:o=>new Int32(o.value),Long:o=>Long.fromBits(o.low!=null?o.low:o.low_,o.low!=null?o.high:o.high_,o.low!=null?o.unsigned:o.unsigned_),MaxKey:()=>new MaxKey,MinKey:()=>new MinKey,ObjectId:o=>new ObjectId2(o),BSONRegExp:o=>new BSONRegExp(o.pattern,o.options),BSONSymbol:o=>new BSONSymbol(o.value),Timestamp:o=>Timestamp.fromBits(o.low,o.high)};function serializeDocument(doc,options){if(doc==null||typeof doc!=="object")throw new BSONError("not an object instance");const bsontype=doc._bsontype;if(typeof bsontype==="undefined"){const _doc={};for(const name2 of Object.keys(doc)){options.seenObjects.push({propertyName:name2,obj:null});try{const value=serializeValue(doc[name2],options);if(name2==="__proto__"){Object.defineProperty(_doc,name2,{value,writable:true,enumerable:true,configurable:true})}else{_doc[name2]=value}}finally{options.seenObjects.pop()}}return _doc}else if(doc!=null&&typeof doc==="object"&&typeof doc._bsontype==="string"&&doc[Symbol.for("@@mdb.bson.version")]!==BSON_MAJOR_VERSION){throw new BSONVersionError}else if(isBSONType(doc)){let outDoc=doc;if(typeof outDoc.toExtendedJSON!=="function"){const mapper=BSON_TYPE_MAPPINGS[doc._bsontype];if(!mapper){throw new BSONError("Unrecognized or invalid _bsontype: "+doc._bsontype)}outDoc=mapper(outDoc)}if(bsontype==="Code"&&outDoc.scope){outDoc=new Code(outDoc.code,serializeValue(outDoc.scope,options))}else if(bsontype==="DBRef"&&outDoc.oid){outDoc=new DBRef(serializeValue(outDoc.collection,options),serializeValue(outDoc.oid,options),serializeValue(outDoc.db,options),serializeValue(outDoc.fields,options))}return outDoc.toExtendedJSON(options)}else{throw new BSONError("_bsontype must be a string, but was: "+typeof bsontype)}}function parse(text,options){const ejsonOptions={useBigInt64:options?.useBigInt64??false,relaxed:options?.relaxed??true,legacy:options?.legacy??false};return JSON.parse(text,(key,value)=>{if(key.indexOf("\\0")!==-1){throw new BSONError(`BSON Document field names cannot contain null bytes, found: ${JSON.stringify(key)}`)}return deserializeValue(value,ejsonOptions)})}function stringify(value,replacer,space,options){if(space!=null&&typeof space==="object"){options=space;space=0}if(replacer!=null&&typeof replacer==="object"&&!Array.isArray(replacer)){options=replacer;replacer=void 0;space=0}const serializeOptions=Object.assign({relaxed:true,legacy:false},options,{seenObjects:[{propertyName:"(root)",obj:null}]});const doc=serializeValue(value,serializeOptions);return JSON.stringify(doc,replacer,space)}function EJSONserialize(value,options){options=options||{};return JSON.parse(stringify(value,options))}function EJSONdeserialize(ejson,options){options=options||{};return parse(JSON.stringify(ejson),options)}var EJSON=Object.create(null);EJSON.parse=parse;EJSON.stringify=stringify;EJSON.serialize=EJSONserialize;EJSON.deserialize=EJSONdeserialize;Object.freeze(EJSON);var MAXSIZE=1024*1024*17;var buffer=ByteUtils.allocate(MAXSIZE);function setInternalBufferSize(size){if(buffer.length<size){buffer=ByteUtils.allocate(size)}}function serialize(object,options={}){const checkKeys=typeof options.checkKeys==="boolean"?options.checkKeys:false;const serializeFunctions=typeof options.serializeFunctions==="boolean"?options.serializeFunctions:false;const ignoreUndefined=typeof options.ignoreUndefined==="boolean"?options.ignoreUndefined:true;const minInternalBufferSize=typeof options.minInternalBufferSize==="number"?options.minInternalBufferSize:MAXSIZE;if(buffer.length<minInternalBufferSize){buffer=ByteUtils.allocate(minInternalBufferSize)}const serializationIndex=serializeInto(buffer,object,checkKeys,0,0,serializeFunctions,ignoreUndefined,null);const finishedBuffer=ByteUtils.allocate(serializationIndex);finishedBuffer.set(buffer.subarray(0,serializationIndex),0);return finishedBuffer}function serializeWithBufferAndIndex(object,finalBuffer,options={}){const checkKeys=typeof options.checkKeys==="boolean"?options.checkKeys:false;const serializeFunctions=typeof options.serializeFunctions==="boolean"?options.serializeFunctions:false;const ignoreUndefined=typeof options.ignoreUndefined==="boolean"?options.ignoreUndefined:true;const startIndex=typeof options.index==="number"?options.index:0;const serializationIndex=serializeInto(buffer,object,checkKeys,0,0,serializeFunctions,ignoreUndefined,null);finalBuffer.set(buffer.subarray(0,serializationIndex),startIndex);return startIndex+serializationIndex-1}function deserialize(buffer2,options={}){return internalDeserialize(ByteUtils.toLocalBufferType(buffer2),options)}function calculateObjectSize(object,options={}){options=options||{};const serializeFunctions=typeof options.serializeFunctions==="boolean"?options.serializeFunctions:false;const ignoreUndefined=typeof options.ignoreUndefined==="boolean"?options.ignoreUndefined:true;return internalCalculateObjectSize(object,serializeFunctions,ignoreUndefined)}function deserializeStream(data,startIndex,numberOfDocuments,documents,docStartIndex,options){const internalOptions=Object.assign({allowObjectSmallerThanBufferSize:true,index:0},options);const bufferData=ByteUtils.toLocalBufferType(data);let index=startIndex;for(let i3=0;i3<numberOfDocuments;i3++){const size=bufferData[index]|bufferData[index+1]<<8|bufferData[index+2]<<16|bufferData[index+3]<<24;internalOptions.index=index;documents[docStartIndex+i3]=internalDeserialize(bufferData,internalOptions);index=index+size}return index}var bson=Object.freeze({__proto__:null,Code,BSONSymbol,DBRef,Binary,ObjectId:ObjectId2,UUID,Long,Timestamp,Double,Int32,MinKey,MaxKey,BSONRegExp,Decimal128,setInternalBufferSize,serialize,serializeWithBufferAndIndex,deserialize,calculateObjectSize,deserializeStream,BSONValue,BSONError,BSONVersionError,BSONRuntimeError,BSONType,EJSON});exports.BSON=bson;exports.BSONError=BSONError;exports.BSONRegExp=BSONRegExp;exports.BSONRuntimeError=BSONRuntimeError;exports.BSONSymbol=BSONSymbol;exports.BSONType=BSONType;exports.BSONValue=BSONValue;exports.BSONVersionError=BSONVersionError;exports.Binary=Binary;exports.Code=Code;exports.DBRef=DBRef;exports.Decimal128=Decimal128;exports.Double=Double;exports.EJSON=EJSON;exports.Int32=Int32;exports.Long=Long;exports.MaxKey=MaxKey;exports.MinKey=MinKey;exports.ObjectId=ObjectId2;exports.Timestamp=Timestamp;exports.UUID=UUID;exports.calculateObjectSize=calculateObjectSize;exports.deserialize=deserialize;exports.deserializeStream=deserializeStream;exports.serialize=serialize;exports.serializeWithBufferAndIndex=serializeWithBufferAndIndex;exports.setInternalBufferSize=setInternalBufferSize}});var DataStructures_exports={};__export(DataStructures_exports,{AuthorizationStruct:()=>AuthorizationStruct,ChatroomStruct:()=>ChatroomStruct,CoherenceMap:()=>CoherenceMap,CoherenceStruct:()=>CoherenceStruct,CommentStruct:()=>CommentStruct,Data:()=>Data,DataStruct:()=>DataStruct,DateStruct:()=>DateStruct,ECGStruct:()=>ECGStruct,EDAStruct:()=>EDAStruct,EEGCoordinates:()=>EEGCoordinates,EEGStruct:()=>EEGStruct,EMGStruct:()=>EMGStruct,EventStruct:()=>EventStruct,EyeTrackerStruct:()=>EyeTrackerStruct,FNIRSStruct:()=>FNIRSStruct,FrequencyBandsStruct:()=>FrequencyBandsStruct,GroupStruct:()=>GroupStruct,HRVStruct:()=>HRVStruct,IMUStruct:()=>IMUStruct,NotificationStruct:()=>NotificationStruct,PPGStruct:()=>PPGStruct,ProfileStruct:()=>ProfileStruct,ScheduleStruct:()=>ScheduleStruct,Struct:()=>Struct,eegCoordinates:()=>eegCoordinates,setCoordinate:()=>setCoordinate,structRegistry:()=>structRegistry});function Struct(structType="struct",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){function randomId3(tag=""){return`${tag+Math.floor(Math.random()+Math.random()*Math.random()*1e16)}`}let struct={_id:randomId3(structType+"defaultId"),structType,ownerId:parentUser?._id,timestamp:Date.now(),parent:{structType:parentStruct?.structType,_id:parentStruct?._id}};if(!struct.ownerId)delete struct.ownerId;if(!struct?.parent?._id)delete struct.parent;if(Object.keys(assignProps).length>0)Object.assign(struct,assignProps);return struct}var eegCoordinates={FP1:[-21.2,66.9,12.1],FPZ:[1.4,65.1,11.3],FP2:[24.3,66.3,12.5],AF7:[-41.7,52.8,11.3],AF3:[-32.7,48.4,32.8],AFZ:[1.8,54.8,37.9],AF4:[35.1,50.1,31.1],AF8:[43.9,52.7,9.3],F5:[-51.4,26.7,24.7],F3:[-39.7,25.3,44.7],F1:[-22.1,26.8,54.9],FZ:[0,26.8,60.6],F2:[23.6,28.2,55.6],F4:[41.9,27.5,43.9],F6:[52.9,28.7,25.2],F7:[-52.1,28.6,3.8],F8:[53.2,28.4,3.1],FC5:[-59.1,3,26.1],FC3:[-45.5,2.4,51.3],FC1:[-24.7,.3,66.4],FCZ:[1,1,72.8],FC2:[26.1,3.2,66],FC4:[47.5,4.6,49.7],FC6:[60.5,4.9,25.5],FT9:[-53.8,-2.1,-29.1],FT7:[-59.2,3.4,-2.1],FT8:[60.2,4.7,-2.8],FT10:[55,-3.6,-31],T7:[-65.8,-17.8,-2.9],T5:[-61.5,-65.3,1.1],T3:[-70.2,-21.3,-10.7],T4:[71.9,-25.2,-8.2],T6:[59.3,-67.6,3.8],T8:[67.4,-18.5,-3.4],C5:[-63.6,-18.9,25.8],C3:[-49.1,-20.7,53.2],C1:[-25.1,-22.5,70.1],CZ:[.8,-21.9,77.4],C2:[26.7,-20.9,69.5],C4:[50.3,-18.8,53],C6:[65.2,-18,26.4],CP5:[-61.8,-46.2,22.5],CP3:[-46.9,-47.7,49.7],CP1:[-24,-49.1,66.1],CPZ:[.7,-47.9,72.6],CP2:[25.8,-47.1,66],CP4:[49.5,-45.5,50.7],CP6:[62.9,-44.6,24.4],TP9:[-73.6,-46.7,-4],TP7:[-63.6,-44.7,-4],TP8:[64.6,-45.4,-3.7],TP10:[74.6,-47.4,-3.7],P9:[-50.8,-51.3,-37.7],P7:[-55.9,-64.8,0],P5:[-52.7,-67.1,19.9],P3:[-41.4,-67.8,42.4],P1:[-21.6,-71.3,52.6],PZ:[.7,-69.3,56.9],P2:[24.4,-69.9,53.5],P4:[44.2,-65.8,42.7],P6:[54.4,-65.3,20.2],P8:[56.4,-64.4,.1],P10:[51,-53.9,-36.5],PO7:[-44,-81.7,1.6],PO3:[-33.3,-84.3,26.5],POZ:[0,-87.9,33.5],PO4:[35.2,-82.6,26.1],PO8:[43.3,-82,.7],O1:[-25.8,-93.3,7.7],OZ:[.3,-97.1,8.7],O2:[25,-95.2,6.2]};function setCoordinate(channelDict,assignTo={}){if(!eegCoordinates[channelDict.tag]&&channelDict.position){eegCoordinates[channelDict.tag]=[channelDict.position.x,channelDict.position.y,channelDict.position.z]}if(eegCoordinates[channelDict.tag]){let props={channel:"",position:{x:eegCoordinates[channelDict.tag][0],y:eegCoordinates[channelDict.tag][1],z:eegCoordinates[channelDict.tag][2]}};return Object.assign(assignTo,props)}else return Object.assign(assignTo,channelDict)}function EEGCoordinates(channelDicts=[],genCoherenceMap=true){let structs=[];for(let channelDict of channelDicts){let struct=EEGStruct(channelDict);structs.push(struct)}if(genCoherenceMap){structs.push(...CoherenceMap({channelDicts}))}return structs}function FrequencyBandsStruct(additionalBands=[],assignTo={}){let bands={scp:[],delta:[],theta:[],alpha1:[],alpha2:[],beta:[],lowgamma:[],highgamma:[]};additionalBands.forEach(band=>bands[band]=[]);return Object.assign(assignTo,bands)}function EEGStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let bands=FrequencyBandsStruct();let props={tag,position:{x:0,y:0,z:0},count:0,times:[],raw:[],filtered:[],fftCount:0,fftTimes:[],ffts:[],slices:JSON.parse(JSON.stringify(bands)),means:JSON.parse(JSON.stringify(bands)),startTime:Date.now()};let struct=Struct("eeg",props,parentUser,parentStruct);if(tag)setCoordinate(props,struct);return Object.assign(struct,assignProps)}function CoherenceStruct(coords={0:EEGStruct("FP1"),1:EEGStruct("FP2")},assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let bands=FrequencyBandsStruct();let props={tag:coords[0]?.tag+"::"+coords[1]?.tag,x0:coords[0]?.position?.x,y0:coords[0]?.position?.y,z0:coords[0]?.position?.z,x1:coords[1]?.position?.x,y1:coords[1]?.position?.y,z1:coords[1]?.position?.z,fftCount:0,fftTimes:[],ffts:[],slices:JSON.parse(JSON.stringify(bands)),means:JSON.parse(JSON.stringify(bands)),startTime:Date.now()};let struct=Struct("coherence",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function CoherenceMap(opts={channelDicts:[{ch:0,tag:"FP1",analyze:false},{ch:1,tag:"FP2",analyze:false}],taggedOnly:true},_={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){var cmap=[];var l=1,k=0;for(var i3=0;i3<opts.channelDicts.length*(opts.channelDicts.length+1)/2-opts.channelDicts.length;i3++){if(opts.taggedOnly===false||opts.taggedOnly===true&&(opts.channelDicts[k].tag!==null&&opts.channelDicts[k+l].tag!==null&&(opts.channelDicts[k].tag!=="other"&&opts.channelDicts[k+l].tag!=="other")&&(opts.channelDicts[k].analyze===true&&opts.channelDicts[k+l].analyze===true))){var coord0=EEGStruct(opts.channelDicts[k].tag);var coord1=EEGStruct(opts.channelDicts[k+l].tag);cmap.push(CoherenceStruct({0:coord0,1:coord1},{},parentUser,parentStruct))}l++;if(l+k===opts.channelDicts.length){k++;l=1}}return cmap}function FNIRSStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,position:{x:0,y:0,z:0},count:0,times:[],red:[],ir:[],ir2:[],ambient:[],ratio:[],temp:[],beat_detect:{beats:[],breaths:[],rir:[],rir2:[],drir_dt:[],localmins:[],localmaxs:[],val_dists:[],peak_dists:[],localmins2:[],localmaxs2:[],val_dists2:[],peak_dists2:[]},startTime:Date.now()};let struct=Struct("fnirs",props,parentUser,parentStruct);if(tag)setCoordinate(props,struct);return Object.assign(struct,assignProps)}function IMUStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,Ax:[],Ay:[],Az:[],Gx:[],Gy:[],Gz:[],startTime:Date.now()};let struct=Struct("imu",props,parentUser,parentStruct);if(tag)setCoordinate(props,struct);return Object.assign(struct,assignProps)}function EyeTrackerStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,count:0,times:[],x:[],y:[],smax:[],smay:[],startTime:Date.now()};let struct=Struct("eyetracker",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function ECGStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,count:0,times:[],raw:[],filtered:[],bpm:[],hrv:[],startTime:Date.now()};let struct=Struct("ecg",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function EDAStruct(_="",__={},___={_id:""},____={structType:"struct",_id:""}){}function PPGStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let struct=FNIRSStruct(tag,parentUser,parentStruct,assignProps);struct.structType="ppg";return struct}function HRVStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let struct=ECGStruct(tag,parentUser,parentStruct,assignProps);struct.structType="hrv";return struct}function EMGStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let struct=EEGStruct(tag,parentUser,parentStruct,assignProps);struct.structType="emg";return struct}function ProfileStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,name:"",username:"",firstName:"",lastName:"",email:"",phone:"",sex:"",birthday:"",type:"",pictureUrl:"",userRoles:{},socials:{},data:{},hidden:false,accessToken:"",refreshToken:""};let struct=Struct("profile",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function AuthorizationStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,authorizedId:"",authorizedName:"",authorizerId:"",authorizerName:"",authorizations:{},structs:{},excluded:{},groups:{},status:"PENDING",expires:false,associatedAuthId:""};let struct=Struct("authorization",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function GroupStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,name:"",details:"",admins:{},peers:{},clients:{},users:{}};let struct=Struct("group",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function Data(type,data){return{type,data,timestamp:Date.now()}}function DataStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,title:"",author:"",expires:false,type:"",data:new Array};let struct=Struct("data",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function EventStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,event:"",author:"",startTime:"",endTime:"",grade:void 0,value:void 0,units:void 0,location:void 0,notes:"",attachments:new Array,users:{}};let struct=Struct("event",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function ChatroomStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,message:"",topic:"",author:"",attachments:new Array,comments:new Array,replies:new Array,users:{},audioChatActive:false,videoChatActive:false};let struct=Struct("chatroom",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function CommentStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,author:"",replyTo:"",message:"",rating:0,replies:new Array,users:{},attachments:new Array};let struct=Struct("comment",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function NotificationStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,note:"",parentUserId:""};let struct=Struct("notification",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function ScheduleStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,title:"",author:"",attachments:new Array,dates:new Array};let struct=Struct("schedule",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}function DateStruct(tag="",assignProps={},parentUser={_id:""},parentStruct={structType:"struct",_id:""}){let props={tag,timeSet:"",notes:"",recurs:"NEVER",attachments:new Array};let struct=Struct("date",props,parentUser,parentStruct);return Object.assign(struct,assignProps)}var structRegistry={Struct,EEGStruct,FNIRSStruct,CoherenceStruct,CoherenceMap,FrequencyBandsStruct,IMUStruct,EyeTrackerStruct,ECGStruct,EDAStruct,PPGStruct,HRVStruct,EMGStruct,ProfileStruct,AuthorizationStruct,GroupStruct,DataStruct,EventStruct,ChatroomStruct,CommentStruct,NotificationStruct,ScheduleStruct,DateStruct};var EventHandler2=class{data={};triggers={};ctr=0;constructor(data){if(typeof data==="object")this.data=data}setState=updateObj=>{Object.assign(this.data,updateObj);let props=Object.getOwnPropertyNames(updateObj);for(const prop of props){this.triggerEvent(prop,this.data[prop])}if(this.triggers[statesubKey2]){let run=fn=>{fn(updateObj)};const l=this.triggers[statesubKey2].length;for(let i3=l-1;i3>=0;i3--){run(this.triggers[statesubKey2][i3].onchange)}}return this.data};setValue=(key,value)=>{this.data[key]=value;this.triggerEvent(key,value)};triggerEvent=(key,value)=>{if(this.triggers[key]){let fn=obj=>{obj.onchange(value)};const l=this.triggers[key].length;for(let i3=l-1;i3>=0;i3--){fn(this.triggers[key][i3])}}};subscribeState=onchange=>{return this.subscribeEvent(statesubKey2,onchange)};unsubscribeState=sub=>{return this.unsubscribeEvent(statesubKey2,sub)};subscribeEvent=(key,onchange,refObject,refKey)=>{if(key){if(refObject&&refKey&&!this.triggers[key]){Object.defineProperty(this.data,key,{get:()=>{return refObject[refKey]},set:value=>{refObject[refKey]=value},enumerable:true,configurable:true})}if(!this.triggers[key]){this.triggers[key]=[]}let l=this.ctr;this.ctr++;this.triggers[key].push({sub:l,onchange});return l}else return void 0};unsubscribeEvent=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(sub===void 0){delete this.triggers[key];delete this.data[key]}else{let idx=void 0;let obj=triggers.find((o,i3)=>{if(o.sub===sub){idx=i3;return true}});if(obj)triggers.splice(idx,1);if(Object.keys(triggers).length===0){delete this.triggers[key];delete this.data[key]}if(this.onRemoved)this.onRemoved(obj);return true}}};subscribeEventOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeEvent(key,sub)};sub=this.subscribeEvent(key,changed);return sub};getEvent=(key,sub)=>{for(const s in this.triggers[key]){if(this.triggers[key][s].sub===sub)return this.triggers[key][s]}};getSnapshot=()=>{const snapshot={};for(const key in this.data){snapshot[key]=this.data[key]}};onRemoved};var statesubKey2="*s";var state2=new EventHandler2;var objProps2=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var import_bson=__toESM2(require_bson());var shallowqueryDummy=DataStructures_exports.ProfileStruct();for(const key in shallowqueryDummy){if(key==="username"||key==="lastName"||key==="firstName"||key==="name"||key==="_id"||key==="pictureUrl")shallowqueryDummy[key]=1;else delete shallowqueryDummy[key]}var Systems={collision:{setupEntities:function(entities){for(const key in entities){const entity=entities[key];if(entity.components){if(!entity.components[this.__node.tag])continue}this.setupEntity(entity)}return entities},setupEntity:function(entity){if(!("collisionEnabled"in entity))entity.collisionEnabled=true;if(!entity.collisionType)entity.collisionType="sphere";if(!entity.collisionRadius)entity.collisionRadius=1;if(!entity.collisionBoundsScale)entity.collisionBoundsScale={x:1,y:1,z:1};if(!entity.colliding)entity.colliding={};if(!entity.position)entity.position={x:0,y:0,z:0};return entity},__node:{tag:"collision"},__operator:function(entities){let keys3=this.entityKeys;for(let i3=0;i3<keys3.length;i3++){const entity1=entities[keys3[i3]];if(entity1.components){if(!entity1.components[this.__node.tag]||!entity1.collisionEnabled)continue}if(!entity1.collisionEnabled)continue;for(let j=0;j<keys3.length;j++){if(i3===j)continue;const entity2=entities[keys3[j]];if(entity2.components){if(!entity2.components[this.__node.tag])continue}if(!entity2.collisionEnabled)continue;let colliding=Systems.collision.collisionCheck(entity1,entity2);if(colliding!==false){if(!entity1.colliding)entity1.colliding={};if(!entity2.colliding)entity2.colliding={};entity1.colliding[entity2.__node.tag]=colliding;entity2.colliding[entity1.__node.tag]=colliding}}}return entities},collisionCheck:(body1,body2)=>{if(body1.collisionEnabled===false||body2.collisionEnabled===false)return false;const dist=Systems.collision.distance(body1.position,body2.position);if(dist<Math.max(...Object.values(body1.collisionBoundsScale))*body1.collisionRadius+Math.max(...Object.values(body2.collisionBoundsScale))*body2.collisionRadius){let isColliding=false;if(body1.collisionType==="sphere"){if(body2.collisionType==="sphere"){isColliding=Systems.collision.sphereCollisionCheck(body1,body2,dist)}else if(body2.collisionType==="box"){isColliding=Systems.collision.sphereBoxCollisionCheck(body1,body2,dist)}else if(body2.collisionType==="point"){isColliding=Systems.collision.isPointInsideSphere(body2.position,body1,dist)}}else if(body1.collisionType==="box"){if(body2.collisionType==="sphere"){isColliding=Systems.collision.sphereBoxCollisionCheck(body2,body1,dist)}else if(body2.collisionType==="box"){isColliding=Systems.collision.boxCollisionCheck(body1,body2)}else if(body2.collisionType==="point"){isColliding=Systems.collision.isPointInsideBox(body1.position,body1)}}else if(body1.collisionType==="point"){if(body2.collisionType==="sphere"){isColliding=Systems.collision.isPointInsideSphere(body1.position,body2,dist)}else if(body2.collisionType==="box"){isColliding=Systems.collision.isPointInsideBox(body1.position,body2)}}if(isColliding)return dist}return false},sphereCollisionCheck:(body1,body2,dist)=>{if(dist===void 0)dist=Systems.collision.distance(body1.position,body2.position);return dist<body1.collisionRadius+body2.collisionRadius},boxCollisionCheck:(body1,body2)=>{let body1minX=(body1.position.x-body1.collisionRadius)*body1.collisionBoundsScale.x;let body1maxX=(body1.position.x+body1.collisionRadius)*body1.collisionBoundsScale.x;let body1minY=(body1.position.y-body1.collisionRadius)*body1.collisionBoundsScale.y;let body1maxY=(body1.position.y+body1.collisionRadius)*body1.collisionBoundsScale.y;let body1minZ=(body1.position.z-body1.collisionRadius)*body1.collisionBoundsScale.z;let body1maxZ=(body1.position.z+body1.collisionRadius)*body1.collisionBoundsScale.z;let body2minX=(body2.position.x-body2.collisionRadius)*body1.collisionBoundsScale.x;let body2maxX=(body2.position.x+body2.collisionRadius)*body1.collisionBoundsScale.x;let body2minY=(body2.position.y-body2.collisionRadius)*body1.collisionBoundsScale.y;let body2maxY=(body2.position.y+body2.collisionRadius)*body1.collisionBoundsScale.y;let body2minZ=(body2.position.z-body2.collisionRadius)*body1.collisionBoundsScale.z;let body2maxZ=(body2.position.z+body2.collisionRadius)*body1.collisionBoundsScale.z;return(body1maxX<=body2maxX&&body1maxX>=body2minX||body1minX<=body2maxX&&body1minX>=body2minX)&&(body1maxY<=body2maxY&&body1maxY>=body2minY||body1minY<=body2maxY&&body1minY>=body2minY)&&(body1maxZ<=body2maxZ&&body1maxZ>=body2minZ||body1minZ<=body2maxZ&&body1minZ>=body2minZ)},sphereBoxCollisionCheck:(sphere,box,dist)=>{let boxMinX=(box.position.x-box.collisionRadius)*box.collisionBoundsScale.x;let boxMaxX=(box.position.x+box.collisionRadius)*box.collisionBoundsScale.x;let boxMinY=(box.position.y-box.collisionRadius)*box.collisionBoundsScale.y;let boxMaxY=(box.position.y+box.collisionRadius)*box.collisionBoundsScale.y;let boxMinZ=(box.position.z-box.collisionRadius)*box.collisionBoundsScale.z;let boxMaxZ=(box.position.z+box.collisionRadius)*box.collisionBoundsScale.z;let clamp={x:Math.max(boxMinX,Math.min(sphere.position.x,boxMaxX)),y:Math.max(boxMinY,Math.min(sphere.position.y,boxMaxY)),z:Math.max(boxMinZ,Math.min(sphere.position.z,boxMaxZ))};if(dist===void 0)dist=Systems.collision.distance(sphere.position,clamp);return dist>sphere.collisionRadius},isPointInsideSphere:(point,sphere,dist)=>{if(dist===void 0)dist=Systems.collision.distance(point,sphere.position);return dist<sphere.collisionRadius},isPointInsideBox:(point,box)=>{let boxminX=(box.position.x-box.collisionRadius)*box.collisionBoundsScale.x;let boxmaxX=(box.position.x+box.collisionRadius)*box.collisionBoundsScale.x;let boxminY=(box.position.y-box.collisionRadius)*box.collisionBoundsScale.x;let boxmaxY=(box.position.y+box.collisionRadius)*box.collisionBoundsScale.x;let boxminZ=(box.position.z-box.collisionRadius)*box.collisionBoundsScale.x;let boxmaxZ=(box.position.z+box.collisionRadius)*box.collisionBoundsScale.x;return point.x>=boxminX&&point.x<=boxmaxX&&(point.y>=boxminY&&point.y<=boxmaxY)&&(point.z>=boxminZ&&point.z<=boxmaxZ)},closestPointOnLine:(point,lineStart,lineEnd)=>{let a={x:lineEnd.x-lineStart.x,y:lineEnd.y-lineStart.y,z:lineEnd.z-lineStart.z};let b={x:lineStart.x-point.x,y:lineStart.y-point.y,z:lineStart.z-point.z};let c={x:lineEnd.x-point.x,y:lineEnd.y-point.y,z:lineEnd.z-point.z};let bdota=Systems.collision.dot(b,a);if(bdota<=0)return lineStart;let cdota=Systems.collision.dot(c,a);if(cdota<=0)return lineEnd;let _bdotapluscdota=1/(bdota+cdota);return{x:lineStart.x+(lineEnd.x-lineStart.x)*bdota*_bdotapluscdota,y:lineStart.y+(lineEnd.y-lineStart.y)*bdota*_bdotapluscdota,z:lineStart.z+(lineEnd.z-lineStart.z)*bdota*_bdotapluscdota}},closestPointOnPolygon:(point,t0,t1,t22)=>{let n=Systems.collision.calcNormal(t0,t1,t22);let dist=Systems.collision.dot(point,n)-Systems.collision.dot(t0,n);let projection=Systems.collision.vecadd(point,Systems.collision.vecscale(n,-dist));let v0x=t22[0]-t0[0];let v0y=t22[1]-t0[1];let v0z=t22[2]-t0[2];let v1x=t1[0]-t0[0];let v1y=t1[1]-t0[1];let v1z=t1[2]-t0[2];let v2x=projection[0]-t0[0];let v2y=projection[1]-t0[1];let v2z=projection[2]-t0[2];let dot00=v0x*v0x+v0y*v0y+v0z*v0z;let dot01=v0x*v1x+v0y*v1y+v0z*v1z;let dot02=v0x*v2x+v0y*v2y+v0z*v2z;let dot11=v1x*v1x+v1y*v1y+v1z*v1z;let dot12=v1x*v2x+v1y*v2y+v1z*v2z;let denom=dot00*dot11-dot01*dot01;if(Math.abs(denom)<1e-30){return void 0}let _denom=1/denom;let u3=(dot11*dot02-dot01*dot12)*_denom;let v2=(dot00*dot12-dot01*dot02)*_denom;if(u3>=0&&v2>=0&&u3+v2<1){return projection}else return void 0},calcNormal:(t0,t1,t22,positive=true)=>{var QR=Systems.collision.makeVec(t0,t1);var QS=Systems.collision.makeVec(t0,t22);if(positive===true){return Systems.collision.normalize(Systems.collision.cross3D(QR,QS))}else{return Systems.collision.normalize(Systems.collision.cross3D(QS,QR))}},dot:(v1,v2)=>{let dot=0;for(const key in v1){dot+=v1[key]*v2[key]}return dot},makeVec(p1,p2){return{x:p2.x-p1.x,y:p2.y-p1.y,z:p2.z-p1.z}},vecadd:(v1,v2)=>{let result=Object.assign({},v1);for(const key in result){result[key]+=v2[key]}return result},vecsub:(v1,v2)=>{let result=Object.assign({},v1);for(const key in result){result[key]-=v2[key]}return result},vecmul:(v1,v2)=>{let result=Object.assign({},v1);for(const key in result){result[key]*=v2[key]}return result},vecdiv:(v1,v2)=>{let result=Object.assign({},v1);for(const key in result){result[key]/=v2[key]}return result},vecscale:(v1,scalar)=>{let result=Object.assign({},v1);for(const key in result){result[key]*=scalar}return result},distance:(v1,v2)=>{let distance=0;for(const key in v1){distance+=Math.pow(v1[key]-v2[key],2)}return Math.sqrt(distance)},magnitude:v2=>{let magnitude=0;for(const key in v2){magnitude+=v2[key]*v2[key]}return Math.sqrt(magnitude)},normalize:v2=>{let magnitude=Systems.collision.magnitude(v2);let _mag=magnitude?1/magnitude:0;let vn={};for(const key in v2){vn[key]=v2[key]*_mag}return vn},distance3D(v1,v2){return Math.sqrt((v1.x-v2.x)*(v1.x-v2.x)+(v1.y-v2.y)*(v1.y-v2.y)+(v1.z-v2.z)*(v1.z-v2.z))},cross3D(v1,v2){return{x:v1.y*v2.z-v1.z*v2.y,y:v1.z*v2.x-v1.x*v2.z,z:v1.x*v2.y-v1.y*v2.x}},nearestNeighborSearch(entities,isWithinRadius=1e15){var tree={};;for(const key in entities){let newnode={tag:key,position:void 0,neighbors:[]};newnode.position=entities[key].position;tree[key]=newnode}for(const i3 in tree){for(const j in tree){var dist=Systems.collision.distance3D(tree[i3].position,tree[j].position);if(dist<isWithinRadius){var newNeighbori={tag:j,position:entities[j].position,dist};tree[i3].neighbors.push(newNeighbori);var newNeighborj={tag:j,position:entities[i3].position,dist};tree[j].neighbors.push(newNeighborj)}}tree[i3].neighbors.sort(function(a,b){return a.dist-b.dist})}return tree},generateBoundingVolumeTree(entities,mode="octree",withinRadius=1e15,minEntities=3){let dynamicBoundingVolumeTree={proto:{parent:void 0,children:{},entities:{},collisionType:"box",collisionRadius:1,collisionBoundsScale:{x:1,y:1,z:1},position:{x:0,y:0,z:0}},tree:{}};let maxX,maxY,maxZ;let minX=0,minY=0,minZ=0;let positions={};let minRadius=withinRadius;for(const key in entities){const body=entities[key];let xx=body.position.x+body.collisionRadius*body.collisionBoundsScale.x;let yy=body.position.y+body.collisionRadius*body.collisionBoundsScale.y;let zz=body.position.z+body.collisionRadius*body.collisionBoundsScale.z;if(maxX<xx)maxX=xx;if(minX>xx)minX=xx;if(maxY<yy)maxY=yy;if(minY>yy)minY=yy;if(maxZ<zz)maxZ=zz;if(minZ>zz)minZ=zz;if(minRadius>body.collisionRadius)minRadius=body.collisionRadius;positions[key]=body.position};let head=JSON.parse(JSON.stringify(dynamicBoundingVolumeTree.proto));let boxpos={x:(maxX+minX)*.5,y:(maxY+minY)*.5,z:(maxZ+minZ)*.5};let boxbounds={x:maxX-boxpos.x,y:maxY-boxpos.y,z:maxZ-boxpos.z};head.position=boxpos;head.collisionBoundsScale=boxbounds;head.entities=entities;dynamicBoundingVolumeTree.tree=head;minRadius*=2;if(mode==="octree"){let genOct=function(parentPos,halfbounds){let oct1={x:parentPos.x+halfbounds.x,y:parentPos.y+halfbounds.y,z:parentPos.z+halfbounds.z};let oct2={x:parentPos.x-halfbounds.x,y:parentPos.y+halfbounds.y,z:parentPos.z+halfbounds.z};let oct3={x:parentPos.x+halfbounds.x,y:parentPos.y-halfbounds.y,z:parentPos.z+halfbounds.z};let oct4={x:parentPos.x+halfbounds.x,y:parentPos.y+halfbounds.y,z:parentPos.z-halfbounds.z};let oct5={x:parentPos.x-halfbounds.x,y:parentPos.y-halfbounds.y,z:parentPos.z+halfbounds.z};let oct6={x:parentPos.x-halfbounds.x,y:parentPos.y+halfbounds.y,z:parentPos.z-halfbounds.z};let oct7={x:parentPos.x+halfbounds.x,y:parentPos.y-halfbounds.y,z:parentPos.z-halfbounds.z};let oct8={x:parentPos.x-halfbounds.x,y:parentPos.y-halfbounds.y,z:parentPos.z-halfbounds.z};return[oct1,oct2,oct3,oct4,oct5,oct6,oct7,oct8]},genOctTree=function(head2){let halfbounds={x:head2.collisionBoundsScale.x*.5,y:head2.collisionBoundsScale.y*.5,z:head2.collisionBoundsScale.z*.5};let octPos=genOct(head2.position,halfbounds);let check=Object.assign({},head2.bodies);for(let i3=0;i3<8;i3++){let octquadrant=Object.assign(JSON.parse(JSON.stringify(dynamicBoundingVolumeTree.proto)),{position:octPos[i3],collisionBoundsScale:halfbounds});octquadrant.parent=head2;for(const j in check){let collided=Systems.collision.collisionCheck(check[j],octquadrant);if(collided){octquadrant.entities[j]=check[j];delete check[j]}}if(Object.keys(octquadrant.entities).length>minEntities-1){head2.children[i3]=octquadrant;octquadrant.parent=head2;if(Object.keys(octquadrant.entities).length>minEntities&&octquadrant.collisionRadius*.5>minRadius){genOctTree(octquadrant)}}}};genOctTree(head);return head}else{let tree=Systems.collision.nearestNeighborSearch(positions,withinRadius);let keys3=Object.keys(tree);let tag=keys3[Math.floor(Math.random()*keys3.length)];let searching=true;let count=0;let genBoundingBoxLevel=(tree2,volumes)=>{let newVolumes={};let foundidxs={};let treekeys=Object.keys(tree2);while(searching&&count<treekeys.length){let node=tree2[tag];let i3=0;let j=0;let ux=positions[node.tag].x-volumes[node.tag].collisionBoundsScale.x,uy=positions[node.tag].y-volumes[node.tag].collisionBoundsScale.y,uz=positions[node.tag].z-volumes[node.tag].collisionBoundsScale.z,mx=positions[node.tag].x+volumes[node.tag].collisionBoundsScale.x,my=positions[node.tag].y+volumes[node.tag].collisionBoundsScale.y,mz=positions[node.tag].z+volumes[node.tag].collisionBoundsScale.z;let newvolume=JSON.parse(JSON.stringify(dynamicBoundingVolumeTree.proto));newvolume.tag=`bound${Math.floor(Math.random()*1e15)}`;newvolume.children[node.tag]=volumes[node.tag];newvolume.bodies[node.tag]=entities[node.tag];volumes[node.tag].parent=newvolume;foundidxs[node.tag]=true;i3++;j++;let nkeys=Object.keys(node.neighbors);while(i3<nkeys.length&&j<3){if(foundidxs[node.neighbors[i3].tag]){i3++;continue}let uxn=positions[node.neighbors[i3].tag].x-volumes[node.neighbors[i3].tag].collisionBoundsScale.x,uyn=positions[node.neighbors[i3].tag].y-volumes[node.neighbors[i3].tag].collisionBoundsScale.y,uzn=positions[node.neighbors[i3].tag].z-volumes[node.neighbors[i3].tag].collisionBoundsScale.z,mxn=positions[node.neighbors[i3].tag].x+volumes[node.neighbors[i3].tag].collisionBoundsScale.x,myn=positions[node.neighbors[i3].tag].y+volumes[node.neighbors[i3].tag].collisionBoundsScale.y,mzn=positions[node.neighbors[i3].tag].z+volumes[node.neighbors[i3].tag].collisionBoundsScale.z;if(ux>uxn)ux=uxn;if(mx<mxn)mx=mxn;if(uy>uyn)uy=uyn;if(my<myn)my=myn;if(uz>uzn)uz=uzn;if(mz<mzn)mz=mzn;newvolume.children[node.neighbors[i3].tag]=volumes[node.neighbors[i3].tag];newvolume.entities[node.neighbors[i3].tag]=entities[node.neighbors[i3].tag];volumes[node.neighbors[i3].tag].parent=newvolume;foundidxs[node.neighbors[i3].tag]=true;i3++;j++}let pos={x:(mx+ux)*.5,y:(my+uy)*.5,z:(mz+uz)*.5};let bounds={x:mx-pos.x,y:my-pos.y,z:mz-pos.z};newvolume.position=pos;newvolume.collisionBoundsScale=bounds;if(newvolume.bodies.length===1)newvolume=node;newVolumes[newvolume.tag]=newvolume;while(i3<node.neighbors.length){if(!foundidxs[node.neighbors[i3].tag])break;i3++}if(i3<node.neighbors.length){tag=node.neighbors[i3].tag}else if(Object.keys(foundidxs).length<Object.keys(tree2).length){tag=keys3[0]}else searching=false;count++}return newVolumes};let result=genBoundingBoxLevel(tree,entities);while(Object.keys(result).length>2){let nextTree=Systems.collision.nearestNeighborSearch(result,withinRadius);result=genBoundingBoxLevel(nextTree,result)}head.children=result;head.children.forEach(n=>{n.parent=head});return head}}},collider:{lastTime:performance.now(),setupEntities:function(entities){for(const key in entities){const entity=entities[key];if(entity.components){if(!entity.components[this.__node.tag])continue}this.setupEntity(entity)}return entities},setupEntity:function(entity){if(!("collisionEnabled"in entity))Systems.collision.setupEntity(entity);if(!("boundingBox"in entity))entity.boundingBox={bot:0,top:100,left:0,right:100,front:0,back:100};if(!("position"in entity)){Systems.movement.setupEntity(entity)}if(!("restitution"in entity))entity.restitution=1;if(!("useBoundingBox"in entity))entity.useBoundingBox=true;if(!entity.position.x&&!entity.position.y&&!entity.position.z){entity.position.x=Math.random()*entity.boundingBox.right;entity.position.y=Math.random()*entity.boundingBox.back;entity.position.z=Math.random()*entity.boundingBox.top}return entity},__operator:function(entities){let keys3=this.entityKeys;for(let i3=0;i3<keys3.length;i3++){const entity1=entities[keys3[i3]];if(entity1.components){if(!entity1.components[this.__node.tag]||!entity1.collisionEnabled)continue}if(entity1.useBoundingBox)this.checkBoundingBox(entity1);if(!entity1.collisionEnabled)continue;if(entity1.colliding){for(const key2 in entity1.colliding){const entity2=entities[key2];if(entity1.colliding[key2]===false){delete entity1.colliding[key2];delete entity2.colliding[entity1.__node.tag];continue}if(!entity2.collisionEnabled)continue;if(entity2.collisionType==="box"){this.resolveBoxCollision(entity1,entity2,entity1.colliding[key2])}else{if(entity1.collisionType==="box"){entity1.fixed=true;this.resolveSphereCollisions(entity1,entity2,entity1.colliding[key2]);entity1.fixed=false}else{this.resolveSphereCollisions(entity1,entity2,entity1.colliding[key2]);delete entity2.colliding[entity1.__node.tag]}}delete entity1.colliding[entity2.__node.tag]}delete entity1.colliding}}return entities},__node:{tag:"collider"},checkBoundingBox:entity=>{const xsize=entity.collisionRadius*entity.collisionBoundsScale.x;const ysize=entity.collisionRadius*entity.collisionBoundsScale.y;const zsize=entity.collisionRadius*entity.collisionBoundsScale.z;if(entity.position.y-ysize<=entity.boundingBox.front){entity.velocity.y*=-entity.restitution;entity.position.y=entity.boundingBox.front+ysize}if(entity.position.y+ysize>=entity.boundingBox.back){entity.velocity.y*=-entity.restitution;entity.position.y=entity.boundingBox.back-ysize}if(entity.position.x-xsize<=entity.boundingBox.left){entity.velocity.x*=-entity.restitution;entity.position.x=entity.boundingBox.left+xsize}if(entity.position.x+xsize>=entity.boundingBox.right){entity.velocity.x*=-entity.restitution;entity.position.x=entity.boundingBox.right-xsize}if(entity.position.z-zsize<=entity.boundingBox.bot){entity.velocity.z*=-entity.restitution;entity.position.z=entity.boundingBox.bot+zsize}if(entity.position.z+zsize>=entity.boundingBox.top){entity.velocity.z*=-entity.restitution;entity.position.z=entity.boundingBox.top-zsize}},resolveBoxCollision:(body1,box,negate)=>{let positionVec=Systems.collision.makeVec(body1.position,box.position);var directionVec=Object.values(positionVec);let closestSide;let closestDist=Infinity;let mul=-1;if(directionVec[idx]<0)mul=1;if(negate)mul=-mul;for(const key in body1.position){let dist=Math.abs(box.position[key]-body1.position[key]);if(dist<closestDist&&Math.abs(box.position[key]-body1.position[key]+body1.velocity[key]*1e-17)<dist){closestSide=key;closestDist=dist}}var idx=directionVec.indexOf(closestSide);if(idx===0)idx="x";if(idx===1)idx="y";if(idx===2)idx="z";if(idx===3)idx="w";let boxEdgeAxisPosition=box.position[idx]+box.collisionRadius*box.collisionBoundsScale[idx]*mul;if(negate){let body1Offset=boxEdgeAxisPosition-body1.collisionRadius*body1.collisionBoundsScale[idx]*mul;body1.position[idx]=body1Offset}else{let body1Offset=boxEdgeAxisPosition+body1.collisionRadius*body1.collisionBoundsScale[idx]*mul;body1.position[idx]=body1Offset}body1.velocity[idx]=-body1.velocity[idx]*body1.restitution;if(negate)body1.force[idx]=-body1.velocity[idx];var body2AccelMag=Systems.collision.magnitude(box.acceleration);var body2AccelNormal=Systems.collision.normalize(box.acceleration);body1.force[idx]=-body2AccelNormal[idx]*body2AccelMag*box.mass;if(negate)body1.force[idx]=-body1.force[idx]},resolveSphereCollisions:(entity1,entity2,dist)=>{if(dist===void 0)dist=Systems.collision.distance(entity1.position,entity2.position);let vecn=Systems.collision.normalize(Systems.collision.makeVec(entity1.position,entity2.position));let sumMass=entity1.mass+entity2.mass;let ratio=entity1.mass/sumMass;let rmin=1-ratio;if(entity1.fixed===false){entity1.position.x+=vecn.x*rmin*1.01;entity1.position.y+=vecn.y*rmin*1.01;entity1.position.z+=vecn.z*rmin*1.001}else{entity2.position.x-=vecn.x*1.01;entity2.position.y-=vecn.y*1.01;entity2.position.z-=vecn.z*1.01}if(entity2.fixed===false){entity2.position.x+=vecn.x*ratio*1.01;entity2.position.y+=vecn.y*ratio*1.01;entity2.position.z+=vecn.z*ratio*1.01}else{entity1.position.x+=vecn.x*1.01;entity1.position.y+=vecn.y*1.01;entity1.position.z+=vecn.z*1.01}dist=Systems.collision.distance(entity1.position,entity2.position);let vrel={x:entity1.velocity.x-entity2.velocity.x,y:entity1.velocity.y-entity2.velocity.y,z:entity1.velocity.z-entity2.velocity.z};let speed=vrel.x*vecn.x+vrel.y*vecn.y+vrel.z*vecn.z;if(speed>0){let impulse=2*speed/sumMass;if(entity1.fixed===false){entity1.velocity.x-=impulse*vecn.x*entity2.mass*entity1.restitution;entity1.velocity.y-=impulse*vecn.y*entity2.mass*entity1.restitution;entity1.velocity.z-=impulse*vecn.z*entity2.mass*entity1.restitution}if(entity2.fixed===false){entity2.velocity.x+=impulse*vecn.x*entity2.mass*entity2.restitution/entity2.mass;entity2.velocity.y+=impulse*vecn.y*entity2.mass*entity2.restitution/entity2.mass;entity2.velocity.z+=impulse*vecn.z*entity2.mass*entity2.restitution/entity2.mass}}}},nbody:{lastTime:performance.now(),G:6674e-14,setupEntities:function(entities){for(const key in entities){const entity=entities[key];if(entity.components){if(!entity.components[this.__node.tag])continue}this.setupEntity(entity)}return entities},setupEntity:function(entity){if(!("collisionEnabled"in entity))Systems.collider.setupEntity(entity);entity.isAttractor=true;if(!("attractorGroup"in entity))entity.attractorGroup=0;if(!("attractorFrameSearchMax"in entity))entity.attractorFrameSearchMax=10;if(!("attractorGroupRules"in entity))entity.attractorGroupRules={0:{G:this.G,maxDist:void 0}};return entity},__operator:function(entities){let keys3=this.entityKeys;for(let i3=0;i3<keys3.length;i3++){const entity=entities[keys3[i3]];if(entity.components){if(!entity.components[this.__node.tag])continue}if(!entity.mass)continue;let nSearched=0;nested:for(let j=0;j<keys3.length;j++){let randKey=keys3[Math.floor(Math.random()*keys3.length)];nSearched++;const entity2=entities[randKey];if(entity2.components){if(!entity2.components[this.__node.tag])continue nested}if(!entity2.mass||!entity2.isAttractor)continue nested;this.attract(entity,entity2,void 0,this.G);if(nSearched>entity.attractorFrameSearchMax)break nested}}return entities},__node:{tag:"nbody"},attract:function(body1,body2,dist,G3=this.G,vecn){if(dist===void 0)dist=Systems.collision.distance3D(body1.position,body2.position);if(vecn===void 0)vecn=Systems.collision.normalize(Systems.collision.makeVec(body1.position,body2.position));let Fg=0;if(dist<.01)dist=.01;if(body1.attractorGroupRules[body2.attractorGroup]){if(typeof body1.attractorGroupRules[body2.attractorGroup]==="object"){if(body1.attractorGroupRules[body2.attractorGroup].maxDist&&body1.attractorGroupRules[body2.attractorGroup].maxDist<dist){}else Fg=body1.attractorGroupRules[body2.attractorGroup].G*body1.mass*body2.mass/(dist*dist)}else Fg=body1.attractorGroupRules[body2.attractorGroup]*body1.mass*body2.mass/(dist*dist)}else Fg=G3*body1.mass*body2.mass/(dist*dist);body1.force.x+=vecn.x*Fg;body1.force.y+=vecn.y*Fg;body1.force.z+=vecn.z*Fg;body2.force.x-=vecn.x*Fg;body2.force.y-=vecn.y*Fg;body2.force.z-=vecn.z*Fg}},boid:{lastTime:performance.now(),defaultAnchor:{x:Math.random(),y:Math.random(),z:Math.random(),mul:.006},setupEntities:function(entities){for(const key in entities){const entity=entities[key];this.setupEntity(entity)}return entities},setupEntity:function(entity){if(!entity.position){Systems.collider.setupEntity(entity)}let adjustedAnchor=Object.assign({},this.defaultAnchor);adjustedAnchor.x*=entity.boundingBox.right;adjustedAnchor.y*=entity.boundingBox.back;adjustedAnchor.z*=entity.boundingBox.top;let boidDefaults={cohesion:1e-5,separation:1e-4,alignment:.006,swirl:adjustedAnchor,attractor:Object.assign(adjustedAnchor,{mul:.002}),useCohesion:true,useSeparation:true,useAlignment:true,useSwirl:true,useAttractor:true,useAttraction:false,groupRadius:200,groupSize:5,searchLimit:5};if(!entity.boid){entity.boid=boidDefaults}else entity.boid=Object.assign(boidDefaults,entity.boid);if(this.entityKeys.length>1e3){entity.boid.groupSize=1;entity.boid.searchLimit=1}return entity},__operator:function(entities){let now=performance.now();let timeStep=now-this.lastTime;this.lastTime=now;let keys3=this.entityKeys;let length=keys3.length;let _timeStep=1/timeStep;let w=-1;outer:for(let i3=0;i3<keys3.length;i3++){w++;let p0=entities[keys3[i3]];const inRange=[];const distances=[];const boidVelocities=[p0.position.x,p0.position.y,p0.position.z,0,0,0,p0.velocity.x,p0.velocity.y,p0.velocity.z,0,0,0,0,0,0,0,0,0];let groupCount=1;let k=-1;nested:for(let j=0;j<keys3.length;j++){k++;if(distances.length>p0.boid.groupSize||k>p0.boid.searchLimit){break nested}let randj=keys3[Math.floor(Math.random()*length)];if(k===w||randj===keys3[i3]||inRange.indexOf(randj)>-1){continue nested}else{let pr=entities[randj];let disttemp=Math.sqrt((p0.position.x-pr.position.x)*(p0.position.x-pr.position.x)+(p0.position.y-pr.position.y)*(p0.position.y-pr.position.y)+(p0.position.z-pr.position.z)*(p0.position.z-pr.position.z));if(disttemp>p0.boid.groupRadius){continue nested}else{distances.push(disttemp);inRange.push(randj);let distInv;if(p0.boid.useSeparation||p0.boid.useAlignment){distInv=p0.boid.groupRadius/(disttemp*disttemp);if(distInv>p0.maxSpeed)distInv=p0.maxSpeed;else if(distInv<-p0.maxSpeed)distInv=-p0.maxSpeed}if(p0.boid.useCohesion){boidVelocities[0]+=(pr.position.x-p0.position.x)*.5*disttemp*_timeStep;boidVelocities[1]+=(pr.position.y-p0.position.y)*.5*disttemp*_timeStep;boidVelocities[2]+=(pr.position.z-p0.position.z)*.5*disttemp*_timeStep}if(isNaN(disttemp)||isNaN(boidVelocities[0])||isNaN(pr.position.x)){console.log(disttemp,i3,randj,p0.position,pr.position,boidVelocities);p0.position.x=NaN;return}if(p0.boid.useSeparation){boidVelocities[3]=boidVelocities[3]+(p0.position.x-pr.position.x)*distInv;boidVelocities[4]=boidVelocities[4]+(p0.position.y-pr.position.y)*distInv;boidVelocities[5]=boidVelocities[5]+(p0.position.z-pr.position.z)*distInv}if(p0.boid.useAttraction&&pr.boid.useAttraction){Systems.nbody.attract(p0,pr,disttemp)}if(p0.boid.useAlignment){boidVelocities[6]=boidVelocities[6]+pr.velocity.x*distInv;boidVelocities[7]=boidVelocities[7]+pr.velocity.y*distInv;boidVelocities[8]=boidVelocities[8]+pr.velocity.z*distInv}groupCount++}}}let _groupCount=1/groupCount;if(p0.boid.useCohesion){boidVelocities[0]=p0.boid.cohesion*(boidVelocities[0]*_groupCount);boidVelocities[1]=p0.boid.cohesion*(boidVelocities[1]*_groupCount);boidVelocities[2]=p0.boid.cohesion*(boidVelocities[2]*_groupCount)}else{boidVelocities[0]=0;boidVelocities[1]=0;boidVelocities[2]=0}if(p0.boid.useSeparation){boidVelocities[3]=p0.boid.separation*boidVelocities[3];boidVelocities[4]=p0.boid.separation*boidVelocities[4];boidVelocities[5]=p0.boid.separation*boidVelocities[5]}else{boidVelocities[3]=0;boidVelocities[4]=0;boidVelocities[5]=0}if(p0.boid.useAlignment){boidVelocities[6]=-(p0.boid.alignment*boidVelocities[6]*_groupCount);boidVelocities[7]=p0.boid.alignment*boidVelocities[7]*_groupCount;boidVelocities[8]=p0.boid.alignment*boidVelocities[8]*_groupCount}else{boidVelocities[6]=0;boidVelocities[7]=0;boidVelocities[8]=0}const swirlVec=[0,0,0];if(p0.boid.useSwirl==true){boidVelocities[9]=-(p0.position.y-p0.boid.swirl.y)*p0.boid.swirl.mul;boidVelocities[10]=(p0.position.z-p0.boid.swirl.z)*p0.boid.swirl.mul;boidVelocities[11]=(p0.position.x-p0.boid.swirl.x)*p0.boid.swirl.mul}const attractorVec=[0,0,0];if(p0.boid.useAttractor==true){boidVelocities[12]=(p0.boid.attractor.x-p0.position.x)*p0.boid.attractor.mul;if(p0.position.x>p0.boundingBox.left||p0.position.x<p0.boundingBox.right){boidVelocities[12]*=3}boidVelocities[13]=(p0.boid.attractor.y-p0.position.y)*p0.boid.attractor.mul;if(p0.position.y>p0.boundingBox.top||p0.position.y<p0.boundingBox.bottom){boidVelocities[13]*=3}boidVelocities[14]=(p0.boid.attractor.z-p0.position.z)*p0.boid.attractor.mul;if(p0.position.z>p0.boundingBox.front||p0.position.z<p0.boundingBox.back){boidVelocities[14]*=3}}p0.velocity.x=p0.velocity.x+boidVelocities[0]+boidVelocities[3]+boidVelocities[6]+boidVelocities[9]+boidVelocities[12]+boidVelocities[15],p0.velocity.y=p0.velocity.y+boidVelocities[1]+boidVelocities[4]+boidVelocities[7]+boidVelocities[10]+boidVelocities[13]+boidVelocities[16],p0.velocity.z=p0.velocity.z+boidVelocities[2]+boidVelocities[5]+boidVelocities[8]+boidVelocities[11]+boidVelocities[14]+boidVelocities[17];if(isNaN(p0.velocity.x))console.error(p0,i3,groupCount,p0.position,p0.velocity,swirlVec,attractorVec)}return entities},__node:{tag:"boid"}},movement:{__node:{tag:"movement"},lastTime:performance.now(),setupEntities:function(entities){for(const key in entities){const entity=entities[key];if(entity.components){if(!entity.components[this.__node.tag])continue}this.setupEntity(entity)}},setupEntity:function(entity){if(!("mass"in entity))entity.mass=1;if(!("fixed"in entity))entity.fixed=false;if(!entity.force)entity.force={x:0,y:0,z:0};if(!("mass"in entity))entity.mass=1;if(!("gravity"in entity))entity.gravity=-9.81;if(!entity.acceleration)entity.acceleration={x:0,y:0,z:0};if(!entity.velocity)entity.velocity={x:0,y:0,z:0};if(!("maxSpeed"in entity))entity.maxSpeed=10;if(!entity.position)entity.position={x:0,y:0,z:0};return entity},__operator:function(entities){let now=performance.now();let timeStep=(now-this.lastTime)*.001;this.lastTime=now;let keys3=this.entityKeys;for(let i3=0;i3<keys3.length;i3++){const entity=entities[keys3[i3]];if(entity.components){if(!entity.components[this.__node.tag])continue}if(entity.fixed)continue;if(entity.mass){if(entity.force.x){entity.acceleration.x+=entity.force.x/entity.mass;entity.force.x=0}if(entity.force.y){entity.acceleration.y+=entity.force.y/entity.mass;entity.force.y=0}if(entity.force.z){entity.acceleration.z+=entity.force.z/entity.mass+entity.gravity;entity.force.z=0}}if(entity.drag){if(entity.acceleration.x)entity.acceleration.x-=entity.acceleration.x*entity.drag*timeStep;if(entity.acceleration.y)entity.acceleration.y-=entity.acceleration.y*entity.drag*timeStep;if(entity.acceleration.z)entity.acceleration.z-=entity.acceleration.z*entity.drag*timeStep}if(entity.acceleration.x)entity.velocity.x+=entity.acceleration.x*timeStep;if(entity.acceleration.y)entity.velocity.y+=entity.acceleration.y*timeStep;if(entity.acceleration.z)entity.velocity.z+=entity.acceleration.z*timeStep;if(entity.maxSpeed>0){let magnitude=Systems.collision.magnitude(entity.velocity);if(magnitude>entity.maxSpeed){let scalar=entity.maxSpeed/magnitude;entity.velocity.x*=scalar;entity.velocity.y*=scalar;entity.velocity.z*=scalar}}if(entity.velocity.x)entity.position.x+=entity.velocity.x*timeStep;if(entity.velocity.y)entity.position.y+=entity.velocity.y*timeStep;if(entity.velocity.z)entity.position.z+=entity.velocity.z*timeStep}return entities}}};var v=class{constructor(e,t3,s,h){this.r=e,this.g=t3,this.b=s,this.a=h}};var A2=class{constructor(){this.scaleX=1,this.scaleY=1,this.offsetX=0,this.offsetY=0,this.loop=false,this._vbuffer=0,this._coord=0,this.visible=true,this.intensity=1,this.xy=new Float32Array([]),this.numPoints=0,this.color=new v(0,0,0,1),this.webglNumPoints=0}};var d=class extends A2{constructor(e,t3){super(),this.currentIndex=0,this.webglNumPoints=t3,this.numPoints=t3,this.color=e,this.xy=new Float32Array(2*this.webglNumPoints)}setX(e,t3){this.xy[e*2]=t3}setY(e,t3){this.xy[e*2+1]=t3}getX(e){return this.xy[e*2]}getY(e){return this.xy[e*2+1]}lineSpaceX(e,t3){for(let s=0;s<this.numPoints;s++)this.setX(s,e+t3*s)}arrangeX(){this.lineSpaceX(-1,2/this.numPoints)}constY(e){for(let t3=0;t3<this.numPoints;t3++)this.setY(t3,e)}shiftAdd(e){let t3=e.length;for(let s=0;s<this.numPoints-t3;s++)this.setY(s,this.getY(s+t3));for(let s=0;s<t3;s++)this.setY(s+this.numPoints-t3,e[s])}addArrayY(e){if(this.currentIndex+e.length<=this.numPoints)for(let t3=0;t3<e.length;t3++)this.setY(this.currentIndex,e[t3]),this.currentIndex++}replaceArrayY(e){if(e.length==this.numPoints)for(let t3=0;t3<this.numPoints;t3++)this.setY(t3,e[t3])}};var M=(c,e,t3)=>{let s={x:0,y:0};return s.x=c.x+e.x*t3,s.y=c.y+e.y*t3,s};var P=c=>Y(-c.y,c.x);var x2=(c,e)=>{let t3=T(c,e);return t3=S(t3),t3};var C2=(c,e)=>{let t3={x:0,y:0};return t3.x=c.x+e.x,t3.y=c.y+e.y,t3};var R=(c,e)=>c.x*e.x+c.y*e.y;var S=c=>{let e={x:0,y:0},t3=c.x*c.x+c.y*c.y;return t3>0&&(t3=1/Math.sqrt(t3),e.x=c.x*t3,e.y=c.y*t3),e};var Y=(c,e)=>{let t3={x:0,y:0};return t3.x=c,t3.y=e,t3};var T=(c,e)=>{let t3={x:0,y:0};return t3.x=c.x-e.x,t3.y=c.y-e.y,t3};var F2=c=>{let e,t3={x:0,y:0},s={x:0,y:0},h=[],o=(n,l)=>{h.push({vec2:n,miterLength:l})},a=n=>({x:c[n*2],y:c[n*2+1]});t3=x2(a(1),a(0)),e=P(t3),o(e,1);let r=c.length/2;for(let n=1;n<r-1;n++){let l=a(n-1),i3=a(n),u3=a(n+1);t3=x2(i3,l),e=P(t3),s=x2(u3,i3);let g=N(t3,s),f=X(t3,g,1);o(g,f)}return t3=x2(a(r-1),a(r-2)),e=P(t3),o(e,1),h};var N=(c,e)=>{let t3=C2(c,e);return t3=S(t3),Y(-t3.y,t3.x)};var X=(c,e,t3)=>{let s=Y(-c.y,c.x);return t3/R(e,s)};var p=class extends A2{constructor(e,t3,s){super(),this.currentIndex=0,this._thicknessRequested=0,this._actualThickness=0,this.webglNumPoints=t3*2,this.numPoints=t3,this.color=e,this._thicknessRequested=s,this._linePoints=new Float32Array(t3*2),this.xy=new Float32Array(2*this.webglNumPoints)}convertToTriPoints(){let e=this._actualThickness/2,t3=F2(this._linePoints);for(let s=0;s<this.numPoints;s++){let h=this._linePoints[2*s],o=this._linePoints[2*s+1],a={x:h,y:o},r=M(a,t3[s].vec2,t3[s].miterLength*e),n=M(a,t3[s].vec2,-t3[s].miterLength*e);this.xy[s*4]=r.x,this.xy[s*4+1]=r.y,this.xy[s*4+2]=n.x,this.xy[s*4+3]=n.y}}setX(e,t3){this._linePoints[e*2]=t3}setY(e,t3){this._linePoints[e*2+1]=t3}lineSpaceX(e,t3){for(let s=0;s<this.numPoints;s++)this.setX(s,e+t3*s)}setThickness(e){this._thicknessRequested=e}getThickness(){return this._thicknessRequested}setActualThickness(e){this._actualThickness=e}};var L=class{constructor(e,t3){this.debug=false,this.addLine=this.addDataLine,t3==null?this.webgl=e.getContext("webgl",{antialias:true,transparent:false}):(this.webgl=e.getContext("webgl",{antialias:t3.antialias,transparent:t3.transparent,desynchronized:t3.deSync,powerPerformance:t3.powerPerformance,preserveDrawing:t3.preserveDrawing}),this.debug=t3.debug==null?false:t3.debug),this.log("canvas type is: "+e.constructor.name),this.log(`[webgl-plot]:width=${e.width}, height=${e.height}`),this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[],this.gScaleX=1,this.gScaleY=1,this.gXYratio=1,this.gOffsetX=0,this.gOffsetY=0,this.gLog10X=false,this.gLog10Y=false,this.webgl.clear(this.webgl.COLOR_BUFFER_BIT),this.webgl.viewport(0,0,e.width,e.height),this._progLine=this.webgl.createProgram(),this.initThinLineProgram(),this.webgl.enable(this.webgl.BLEND),this.webgl.blendFunc(this.webgl.SRC_ALPHA,this.webgl.ONE_MINUS_SRC_ALPHA)}get linesData(){return this._linesData}get linesAux(){return this._linesAux}get thickLines(){return this._thickLines}get surfaces(){return this._surfaces}_drawLines(e){let t3=this.webgl;e.forEach(s=>{if(s.visible){t3.useProgram(this._progLine);let h=t3.getUniformLocation(this._progLine,"uscale");t3.uniformMatrix2fv(h,false,new Float32Array([s.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,s.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let o=t3.getUniformLocation(this._progLine,"uoffset");t3.uniform2fv(o,new Float32Array([s.offsetX+this.gOffsetX,s.offsetY+this.gOffsetY]));let a=t3.getUniformLocation(this._progLine,"is_log");t3.uniform2iv(a,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let r=t3.getUniformLocation(this._progLine,"uColor");t3.uniform4fv(r,[s.color.r,s.color.g,s.color.b,s.color.a]),t3.bufferData(t3.ARRAY_BUFFER,s.xy,t3.STREAM_DRAW),t3.drawArrays(s.loop?t3.LINE_LOOP:t3.LINE_STRIP,0,s.webglNumPoints)}})}_drawSurfaces(e){let t3=this.webgl;e.forEach(s=>{if(s.visible){t3.useProgram(this._progLine);let h=t3.getUniformLocation(this._progLine,"uscale");t3.uniformMatrix2fv(h,false,new Float32Array([s.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,s.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let o=t3.getUniformLocation(this._progLine,"uoffset");t3.uniform2fv(o,new Float32Array([s.offsetX+this.gOffsetX,s.offsetY+this.gOffsetY]));let a=t3.getUniformLocation(this._progLine,"is_log");t3.uniform2iv(a,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let r=t3.getUniformLocation(this._progLine,"uColor");t3.uniform4fv(r,[s.color.r,s.color.g,s.color.b,s.color.a]),t3.bufferData(t3.ARRAY_BUFFER,s.xy,t3.STREAM_DRAW),t3.drawArrays(t3.TRIANGLE_STRIP,0,s.webglNumPoints)}})}_drawTriangles(e){let t3=this.webgl;t3.bufferData(t3.ARRAY_BUFFER,e.xy,t3.STREAM_DRAW),t3.useProgram(this._progLine);let s=t3.getUniformLocation(this._progLine,"uscale");t3.uniformMatrix2fv(s,false,new Float32Array([e.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,e.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let h=t3.getUniformLocation(this._progLine,"uoffset");t3.uniform2fv(h,new Float32Array([e.offsetX+this.gOffsetX,e.offsetY+this.gOffsetY]));let o=t3.getUniformLocation(this._progLine,"is_log");t3.uniform2iv(o,new Int32Array([0,0]));let a=t3.getUniformLocation(this._progLine,"uColor");t3.uniform4fv(a,[e.color.r,e.color.g,e.color.b,e.color.a]),t3.drawArrays(t3.TRIANGLE_STRIP,0,e.xy.length/2)}_drawThickLines(){this._thickLines.forEach(e=>{if(e.visible){let t3=Math.min(this.gScaleX,this.gScaleY);e.setActualThickness(e.getThickness()/t3),e.convertToTriPoints(),this._drawTriangles(e)}})}update(){this.clear(),this.draw()}draw(){this._drawLines(this.linesData),this._drawLines(this.linesAux),this._drawThickLines(),this._drawSurfaces(this.surfaces)}clear(){this.webgl.clear(this.webgl.COLOR_BUFFER_BIT)}_addLine(e){e._vbuffer=this.webgl.createBuffer(),this.webgl.bindBuffer(this.webgl.ARRAY_BUFFER,e._vbuffer),this.webgl.bufferData(this.webgl.ARRAY_BUFFER,e.xy,this.webgl.STREAM_DRAW),e._coord=this.webgl.getAttribLocation(this._progLine,"coordinates"),this.webgl.vertexAttribPointer(e._coord,2,this.webgl.FLOAT,false,0,0),this.webgl.enableVertexAttribArray(e._coord)}addDataLine(e){this._addLine(e),this.linesData.push(e)}addAuxLine(e){this._addLine(e),this.linesAux.push(e)}addThickLine(e){this._addLine(e),this._thickLines.push(e)}addSurface(e){this._addLine(e),this.surfaces.push(e)}initThinLineProgram(){let e=`\n      attribute vec2 coordinates;\n      uniform mat2 uscale;\n      uniform vec2 uoffset;\n      uniform ivec2 is_log;\n\n      void main(void) {\n         float x = (is_log[0]==1) ? log(coordinates.x) : coordinates.x;\n         float y = (is_log[1]==1) ? log(coordinates.y) : coordinates.y;\n         vec2 line = vec2(x, y);\n         gl_Position = vec4(uscale*line + uoffset, 0.0, 1.0);\n      }`,t3=this.webgl.createShader(this.webgl.VERTEX_SHADER);this.webgl.shaderSource(t3,e),this.webgl.compileShader(t3);let s=`\n         precision mediump float;\n         uniform highp vec4 uColor;\n         void main(void) {\n            gl_FragColor =  uColor;\n         }`,h=this.webgl.createShader(this.webgl.FRAGMENT_SHADER);this.webgl.shaderSource(h,s),this.webgl.compileShader(h),this._progLine=this.webgl.createProgram(),this.webgl.attachShader(this._progLine,t3),this.webgl.attachShader(this._progLine,h),this.webgl.linkProgram(this._progLine)}popDataLine(){this.linesData.pop()}removeAllLines(){this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[]}removeDataLines(){this._linesData=[]}removeAuxLines(){this._linesAux=[]}viewport(e,t3,s,h){this.webgl.viewport(e,t3,s,h)}log(e){this.debug&&console.log("[webgl-plot]:"+e)}};var y2=class{constructor(){this.plots={}}initPlot(e,t3){if(t3||(t3=new L(e.canvas,e.webglOptions)),!e._id)e._id=`plot${Math.floor(Math.random()*1e15)}`;else if(this.plots[e._id]){let l=this.plots[e._id].initial;if(e.lines){for(let i3 in e.lines)if(l.lines[i3]&&Array.isArray(e.lines[i3])){let u3=e.lines[i3];e.lines[i3]=l.lines[i3]}}e=Object.assign(l,e)}e.overlay&&(typeof e.overlay!="object"&&(e.overlay=document.createElement("canvas"),e.overlay.style.position="absolute",e.overlay.width=e.canvas.width,e.overlay.height=e.canvas.height,e.canvas.appendChild(e.overlay)),e.overlayCtx||(e.overlayCtx=e.overlay.getContext("2d"))),e.width&&(e.canvas.width=e.width,e.canvas.style&&(e.canvas.style.width=e.width+"px"),typeof e.overlay=="object"&&(e.overlay.width=e.width,e.overlay.style&&(e.overlay.style.width=e.width+"px"))),e.height&&(e.canvas.height=e.height,e.canvas.style&&(e.canvas.style.height=e.height+"px"),typeof e.overlay=="object"&&(e.overlay.height=e.height,e.overlay.style&&(e.overlay.style.height=e.height+"px"))),e.lines?.timestamp&&delete e.lines.timestamp,e.lines||(e.lines={});let s={};for(let l in e.lines)s[l]=Object.assign({},s[l]),"viewing"in e.lines[l]||(e.lines[l].viewing=true),s[l].viewing=e.lines[l].viewing,s[l].sps=e.lines[l].sps,s[l].nSec=e.lines[l].nSec,s[l].nPoints=e.lines[l].nPoints,s[l].ymin=e.lines[l].ymin,s[l].ymax=e.lines[l].ymax,s[l].units=e.lines[l].units;let h={plot:t3,settings:e,initial:Object.assign(Object.assign({},e),{lines:s}),anim:()=>{t3.update()}};this.plots[e._id]=h;let o=0,a=0;Object.keys(e.lines).forEach(l=>{e.lines[l]?.viewing!==false&&a++}),e.nLines=a;let r,n;typeof e.overlay=="object"&&(r=e.overlay,n=e.overlayCtx,n.clearRect(0,0,e.overlay.width,e.overlay.height),n.font=e.overlayFont?e.overlayFont:"1em Courier",n.fillStyle=e.overlayColor?e.overlayColor:"white");for(let l in e.lines){let i3=e.lines[l];if(Array.isArray(i3)&&(i3={values:i3},e.lines[l]=i3),"viewing"in i3||(i3.viewing=true),i3.color)Array.isArray(i3.color)&&(i3.color=new v(...i3.color));else{let m=y2.HSLToRGB(360*(o/a)%360,100,50,1);h.initial.lines[l].color=[...m,1],i3.color=new v(...m,1)}let u3;if(i3.nSec&&i3.sps?u3=Math.ceil(i3.nSec*i3.sps):i3.nPoints?u3=i3.nPoints:i3.points?u3=i3.points:e.linePoints?u3=e.linePoints:i3.values?u3=i3.values.length:u3=1e3,i3.points=u3,e.lines[l].viewing===false)continue;if((i3.width||e.lineWidth)&&i3.width!==0){let m=e.lineWidth;m||(m=i3.width),i3.width?i3.line=new p(i3.color,u3,i3.width):e.lineWidth&&(i3.line=new p(i3.color,u3,e.lineWidth)),i3.line.lineSpaceX(-1,2/i3.line.numPoints)}else i3.line=new d(i3.color,u3),i3.line.arrangeX();i3.values?.length===i3.points?i3.values.length!==u3&&(i3.interpolate?i3.values.length>u3?i3.values=y2.downsample(i3.values,u3):i3.values.length<u3&&(i3.values=y2.upsample(i3.values,u3)):i3.values.length>i3.points?i3.values=i3.values.slice(i3.values.length-i3.points):i3.values=[...new Array(i3.points-i3.values.length).fill(0),...i3.values]):Array.isArray(i3.values)?i3.values.length>u3?i3.values=i3.values.slice(i3.values.length-u3):i3.values.length<u3&&(i3.values=[...new Array(u3-i3.values.length).fill(0),...i3.values]):i3.values=new Array(i3.points).fill(0);let g=i3.ymin,f=i3.ymax,b=i3.values.length<=1e5;if(g===f?(f=b?Math.max(...i3.values):1,g=b?Math.min(...i3.values):0):isNaN(f)&&(f=b?Math.max(...i3.values):1),isNaN(g)&&(g=b?Math.min(...i3.values):0),g>f){let m=g;f=g,g=m}let w=Math.abs(g);if(i3.absmax=w>f?w:f,"autoscale"in i3||(i3.autoscale=true),i3.position||(i3.position=e.nLines-o-1),i3.autoscale?i3.autoscale===2?("clamp"in i3||(i3.clamp=true),i3.scaled=y2.autoscale(i3.values,i3.position,a,i3.centerZero,g,f,i3.clamp)):(i3.scaled=i3.values,i3.line.scaleY=y2.getYScalar(i3.values,a,i3.centerZero,g,f),i3.line.offsetY=y2.getYOffset(i3.position,a,g,i3.line.scaleY)):i3.scaled=i3.values,i3.scaled.forEach((m,_)=>i3.line.setY(_,m)),i3.line instanceof p?t3.addThickLine(i3.line):i3.line instanceof d&&t3.addDataLine(i3.line),"xAxis"in i3||(i3.xAxis=true),i3.xAxis){i3.xColor?Array.isArray(i3.xColor)&&(i3.xColor=new v(...i3.xColor)):i3.xColor=new v(1,1,1,.3);let m=new d(i3.xColor,2),_=i3.autoscale?(o+1)*2/a-1-1/a:0;m.constY(_),m.arrangeX(),m.xy[2]=1,i3.x=m,t3.addAuxLine(m)}if(a>1&&i3.autoscale&&o!==a-1){e.dividerColor?Array.isArray(e.dividerColor)&&(e.dividerColor=new v(...e.dividerColor)):e.dividerColor=new v(1,1,1,1);let m=new d(e.dividerColor,2);m.constY(i3.autoscale?(o+1)*2/a-1:1),m.arrangeX(),m.xy[2]=1,i3.divider=m,t3.addAuxLine(m)}if(typeof e.overlay=="object"&&(i3.useOverlay||!("useOverlay"in i3))){let m=e.nLines-i3.position-1;n.fillText(l,20,r.height*(m+.2)/e.nLines),n.fillText(`${Math.floor(f)===f?f:f?.toFixed(5)} ${i3.units?i3.units:""}`,r.width-100,r.height*(m+.2)/e.nLines),n.fillText(`${Math.floor(g)===g?g:g?.toFixed(5)} ${i3.units?i3.units:""}`,r.width-100,r.height*(m+.9)/e.nLines)}o++}return requestAnimationFrame(h.anim),this.plots[e._id]}deinitPlot(e){return typeof e=="string"&&(e=this.plots[e]),e.plot.clear(),e.plot.removeAllLines(),true}reinitPlot(e,t3){if(typeof e=="string"){let s=e;e=this.plots[e],t3._id||(t3._id=s)}if(e.plot)return e.plot.clear(),e.plot.removeAllLines(),e.settings.overlayCtx&&e.settings.overlayCtx.clearRect(0,0,e.settings.overlay?.width,e.settings.overlay?.height),this.initPlot(t3,e.plot)}getChartSettings(e,t3){let s=this.plots[e];if(s){let h=Object.assign({},s.initial);for(let o in s.initial.lines)typeof s.initial.lines[o]?.ymax!="number"&&(h.lines[o].ymax=s.settings.lines[o]?.ymax),typeof s.initial.lines[o]?.ymin!="number"&&(h.lines[o].ymin=s.settings.lines[o]?.ymin),t3&&(h.lines[o].values=s.settings.lines[o].values);return delete h.canvas,delete h.overlay,delete h.overlayCtx,h}}update(e,t3,s=true){if(typeof e=="string"&&(e=this.plots[e]),!e)return false;if(t3){let h=false,o,a;typeof e.settings.overlay=="object"&&(o=e.settings.overlay,a=e.settings.overlayCtx,a.font=e.settings.overlayFont?e.settings.overlayFont:"1em Courier",a.fillStyle=e.settings.overlayColor?e.settings.overlayColor:"white");for(let r in t3)if(e.settings.lines[r]&&e.settings.lines[r].line){if(e.settings.lines[r]?.viewing===false)continue;let n=e.settings.lines[r];if(n.values){if(e.settings.mode&&e.settings.mode==="sweep"){"ct"in n||(n.ct=0);let f=b=>{n.ct>n.values.length&&(n.ct=0),n.values[n.ct]=b,n.ct++};Array.isArray(t3[r])?t3[r].forEach(f):typeof t3[r]=="number"?f(t3[r]):t3[r].values&&t3[r].values.forEach(f)}else Array.isArray(t3[r])&&n.values?.length<1e5?(n.values.length===0&&(n.values.length=n.points?n.points:1e3),t3[r].length===n.values.length?n.values=t3[r]:y2.circularBuffer(n.values,t3[r])):typeof t3[r]=="number"?(n.values.push(t3[r]),n.values.shift()):t3[r]?.values&&(n.values.length===0&&(n.values.length=n.points?n.points:1e3),t3[r].values.length===n.values.length?n.values=t3[r].values:y2.circularBuffer(n.values,t3[r].values));n.values.length!==n.points&&(n.interpolate?n.values.length>n.points?n.values=y2.downsample(n.values,n.points):n.scaled.length<n.points&&(n.values=y2.upsample(n.values,n.points)):n.values.length>n.points?n.values.splice(0,n.values.length-n.points):n.values=new Array(n.points).fill(0).splice(n.points-n.values.length,0,n.values));let l=n.ymin,i3=n.ymax,u3=n.values.length<=1e5;if(l===i3?(i3=u3?Math.max(...n.values):1,l=u3?Math.min(...n.values):0):isNaN(i3)&&(i3=u3?Math.max(...n.values):1),isNaN(l)&&(l=u3?Math.min(...n.values):0),l>i3){let f=l;i3=l,l=f}let g=Math.abs(l);if(n.absmax=g>i3?g:i3,n.autoscale?n.autoscale===2?n.scaled=y2.autoscale(n.values,n.position,e.settings.nLines,n.centerZero,l,i3,n.clamp):(n.scaled=n.values,n.line.scaleY=y2.getYScalar(n.values,e.settings.nLines,n.centerZero,l,i3),n.line.offsetY=y2.getYOffset(n.position,e.settings.nLines,l,n.line.scaleY)):n.scaled=n.values,n.scaled.forEach((f,b)=>{!n.autoscale&&n.absmax>1?n.line.setY(b,f/n.absmax):n.line.setY(b,f)}),typeof e.settings.overlay=="object"&&(n.useOverlay||!("useOverlay"in n))){let f=e.settings.nLines-n.position-1,b=o.height*f/e.settings.nLines,w=o.height/e.settings.nLines;if(a.clearRect(0,b,o.width,w),e.settings.mode&&e.settings.mode==="sweep"){a.fillStyle=e.settings.sweepColor?e.settings.sweepColor:"rgba(0,255,0,0.25)",a.beginPath();let m=o.width*n.ct/n.values.length;a.moveTo(m,b),a.lineTo(m,w),a.stroke()}a.fillStyle=e.settings.overlayColor?e.settings.overlayColor:"white",a.fillText(r,20,o.height*(f+.2)/e.settings.nLines),a.fillText(`${Math.floor(i3)===i3?i3:i3?.toFixed(5)} ${n.units?n.units:""}`,o.width-100,o.height*(f+.2)/e.settings.nLines),a.fillText(`${Math.floor(l)===l?l:l?.toFixed(5)} ${n.units?n.units:""}`,o.width-100,o.height*(f+.9)/e.settings.nLines)}}}else e.settings.generateNewLines&&!r.includes("timestamp")&&(Array.isArray(t3[r])&&(t3[r]={values:t3[r]}),!t3[r].nSec&&!t3[r].nPoints&&!e.settings.linePoints&&(t3[r].nPoints=1e3),h=true);if(h)return e.settings.cleanGeneration||Object.keys(e.initial.lines).forEach(r=>{t3[r]?t3[r]=Object.assign(e.initial.lines[r],t3[r]):t3[r]=e.initial.lines[r]}),this.reinitPlot(e,{_id:e.settings._id,lines:t3}),true}return s&&requestAnimationFrame(e.anim),true}updateLine(e,t3,s,h,o,a,r){return e.numPoints!==t3.length&&(s?e.numPoints>t3.length?t3=y2.downsample(t3,e.numPoints):e.numPoints<t3.length&&(t3=y2.upsample(t3,e.numPoints)):t3.length>e.numPoints?t3=t3.slice(t3.length-e.numPoints):t3=[...new Array(t3.length).fill(0),...t3]),h&&(t3=y2.autoscale(t3,o,a,r)),t3.forEach((n,l)=>e.setY(l,n)),true}static autoscale(e,t3=0,s=1,h=false,o,a,r){if(e?.length===0)return e;let n=typeof a=="number"?a:e.length<=1e5?Math.max(...e):1,l=typeof o=="number"?o:e.length<=1e5?Math.min(...e):0,i3=1/s,u3=1;if(h){let g=Math.max(Math.abs(l),Math.abs(n));return g!==0&&(u3=i3/g),e.map(f=>(r&&(f<l&&(f=l),f>n&&(f=n)),f*u3+(i3*(t3+1)*2-1-i3)))}else return n===l?n!==0?u3=i3/n:l!==0&&(u3=i3/Math.abs(l)):u3=i3/(n-l),e.map(g=>(r&&(g<l&&(g=l),g>n&&(g=n)),2*((g-l)*u3-1/(2*s))+(i3*(t3+1)*2-1-i3)))}static getYScalar(e,t3=1,s=false,h,o){if(e?.length===0)return e;let a=typeof o=="number"?o:e.length<=1e5?Math.max(...e):1,r=typeof h=="number"?h:e.length<=1e5?Math.min(...e):0,n=1/t3,l=1;if(s){let i3=Math.max(Math.abs(r),Math.abs(a));return i3!==0&&(l=n/i3),2*l}else return a===r?a!==0?l=n/a:r!==0&&(l=n/Math.abs(r)):l=n/(a-r),2*l}static getYOffset(e=0,t3=1,s=0,h=1){let o=1/t3,a=o*(e+1)*2-1-o;return s!==0?a-=s*h+1/t3:a-=h+1/t3,a}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t3,s=1){if(e.length>t3){let h=new Array(t3),o=e.length/t3,a=e.length-1,r=0,n=0;for(let l=o;l<e.length;l+=o){let i3=Math.round(l);i3>a&&(i3=a);for(let u3=r;u3<i3;u3++)h[n]+=e[u3];h[n]/=(i3-r)*s,n++,r=i3}return h}else return e}static upsample(e,t3,s=1){var h=function(g,f,b){return(g+(f-g)*b)*s},o=new Array(t3),a=(e.length-1)/(t3-1);o[0]=e[0];for(var r=1;r<t3-1;r++){var n=r*a,l=Math.floor(n),i3=Math.ceil(n),u3=n-l;o[r]=h(e[l],e[i3],u3)}return o[t3-1]=e[e.length-1],o}static interpolate(e,t3,s=1){return e.length>t3?y2.downsample(e,t3,s):e.length<t3?y2.upsample(e,t3,s):e}static HSLToRGB(e,t3,s,h=255){t3/=100,s/=100;let o=(1-Math.abs(2*s-1))*t3,a=o*(1-Math.abs(e/60%2-1)),r=s-o/2,n=0,l=0,i3=0;return 0<=e&&e<60?(n=o,l=a,i3=0):60<=e&&e<120?(n=a,l=o,i3=0):120<=e&&e<180?(n=0,l=o,i3=a):180<=e&&e<240?(n=0,l=a,i3=o):240<=e&&e<300?(n=a,l=0,i3=o):300<=e&&e<360&&(n=o,l=0,i3=a),n=(n+r)*h,l=(l+r)*h,i3=(i3+r)*h,[n,l,i3]}static circularBuffer(e,t3){if(t3.length<e.length){let s=e.slice(t3.length),h=e.length;e.splice(0,h,...s,...t3)}else if(t3.length>e.length){let s=e.length;e.splice(0,s,...t3.slice(t3.length-s))}else e.splice(0,e.length,...t3);return e}static formatDataForCharts(e,t3){if(Array.isArray(e)){if(Array.isArray(e[0])){let s={};if(e.forEach((h,o)=>{s[o]=h}),e=s,isNaN(e[0][0]))return}else if(t3){if(e={[t3]:e},isNaN(e[t3][0]))return}else if(e={0:e},isNaN(e[0][0]))return}else if(typeof e=="object"){for(let s in e)if(typeof e[s]=="number"?e[s]=[e[s]]:e[s]?.values&&typeof e[s].values=="number"&&(e[s].values=[e[s].values]),isNaN(e[s][0]))return}else if(typeof e=="string"){let s;if(e.includes(`\\r\n`)){let h=e.split(`\\r\n`);e={},h.forEach((o,a)=>{o.includes("	")?s=o.split("	"):o.includes(",")?s=o.split(","):o.includes("|")&&(s=o.split("|")),s&&s.forEach((r,n)=>{if(r.includes(":")){let[l,i3]=r.split(":"),u3=parseFloat(i3);isNaN(u3)||(e[l]=[u3])}else{let l=parseFloat(r);isNaN(l)||(e[n]=[l])}})})}else e.includes("	")?s=e.split("	"):e.includes(",")?s=e.split(","):e.includes("|")&&(s=e.split("|"));e={},s&&s.forEach((h,o)=>{if(h.includes(":")){let[a,r]=h.split(":"),n=parseFloat(r);isNaN(n)||(e[a]=[n])}else{let a=parseFloat(h);isNaN(a)||(e[o]=[a])}})}else typeof e=="number"&&(t3?e={[t3]:[e]}:e={0:[e]});return e}static padTime(e,t3,s,h){let o=(e[0]-t3)/s/h;return[...new Array(h-e.length).map((r,n)=>t3+o*(n+1)),...e]}static interpolateForTime(e,t3,s){return y2.interpolate(e,Math.ceil(s*t3))}};var webglPlotRoutes={setupChart:function setupChart(settings){console.log("initializing chart",settings);if(!this?.__node?.graph?.plotter){this.__node.graph.plotter=new y2;return this.__node.graph.plotter.initPlot(settings).settings._id}else{globalThis.plotter=new y2;return globalThis.plotter.initPlot(settings).settings._id}},updateChartData:function updateChartData(plot,lines,draw=true){if(typeof lines==="object"){if(globalThis.plotter)globalThis.plotter.update(plot,lines,draw);else if(this?.__node?.graph?.plotter)this.__node.graph.plotter.update(plot,lines,draw);return true}return false},clearChart:function clearChart(plot){if(globalThis.plotter)globalThis.plotter.deinitPlot(plot);else if(this?.__node?.graph?.plotter)this.__node.graph.plotter.deinitPlot(plot);return true},resetChart:function resetChart(plot,settings){if(globalThis.plotter)globalThis.plotter.reinitPlot(plot,settings);else if(this?.__node?.graph?.plotter)this.__node.graph.plotter.reinitPlot(plot,settings);return settings._id},getChartSettings:function getChartSettings(plotId){let settings;if(globalThis.plotter)settings=globalThis.plotter.getChartSettings(plotId);else if(this?.__node?.graph?.plotter)settings=this.__node.graph.plotter.getChartSettings(plotId);return settings}};var __defProp22=Object.defineProperty;var __defNormalProp22=(obj,key,value)=>key in obj?__defProp22(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __publicField22=(obj,key,value)=>{__defNormalProp22(obj,typeof key!=="symbol"?key+"":key,value);return value};var _Math2=class{constructor(){}static genSineWave(freq=20,peakAmp=1,nSec=1,fs3=512,freq2=0,peakAmp2=1){var sineWave=[];var t3=[];var increment=1/fs3;for(var ti=0;ti<nSec;ti+=increment){var amplitude=Math.sin(2*Math.PI*freq*ti)*peakAmp;amplitude+=Math.sin(2*Math.PI*freq2*ti)*peakAmp2;sineWave.push(amplitude);t3.push(ti)}return[t3,sineWave]}static getSineAmplitude(frequency=20,peakAmplitude=1,ti=0,tOffset=0){return Math.sin(this.TWO_PI*frequency*ti+tOffset)*peakAmplitude}static mean(arr){var sum=arr.reduce((prev,curr)=>curr+=prev);return sum/arr.length}static mode(arr){return arr.sort((a,b)=>arr.filter(v2=>v2===a).length-arr.filter(v2=>v2===b).length).pop()}static std(arr,mean=void 0){let avg=mean;if(!mean)avg=this.mean(arr);let summed=0;for(let i3=0;i3<arr.length;i3++){let subbed=arr[i3]-avg;summed+=subbed*subbed}return Math.sqrt(summed/arr.length)}static relError(actual=[],forecast=[],abs=true){if(actual.length!==forecast.length)throw new Error("Input arrays of same length!");let i3=actual.length;let d2=new Array(actual.length);for(let j=0;j<i3;j++){let dd=(actual[j]-forecast[j])/actual[j];if(abs)dd=Math.abs(dd);d2[j]=dd}return d2}static informationEntropy(probabilities=[]){let len=probabilities.length;let entropy=new Array(len);for(let i3=0;i3<len;i3++){let ent=probabilities[i3]*Math.log(probabilities[i3]);if(isNaN(ent))ent=0;entropy[i3]=ent}return entropy}static zscore(arr){let mean=this.mean(arr);let std=this.std(arr,mean);let z3=new Array().length(arr.length);for(let i3=0;i3<arr.length;i3++){z3[i3]=(arr[i3]-mean)/std}return z3}static variance(arr){var mean=this.mean(arr);return arr.reduce((a,b)=>a+(b-mean)**2,0)/arr.length}static dot(vec1,vec2){var dot=0;for(var i3=0;i3<vec1.length;i3++){dot+=vec1[i3]*vec2[i3]}return dot}static cross3D(vec1,vec2){return[vec1[1]*vec2[2]-vec1[2]*vec2[1],vec1[2]*vec2[0]-vec1[0]*vec2[2],vec1[0]*vec2[1]-vec1[1]*vec2[0]]}static magnitude(vec){var sqrd=0;vec.forEach(c=>{sqrd+=c*c});return Math.sqrt(sqrd)}static distance(point1,point2){var dsqrd=0;point1.forEach((c,i3)=>{dsqrd+=(point2[i3]-c)*(point2[i3]-c)});return Math.sqrt(dsqrd)}static midpoint(point1=[1,2,3],point2=[3,4,5]){return point1.map((c,i3)=>{return(c+point2[i3])*.5})}static normalize(vec){var norm=0;norm=this.magnitude(vec);var vecn=new Array(vec.length);vec.forEach((c,i3)=>{vecn[i3]=c*norm});return vecn}static normalizeSeries(arr=[],fromZero=true){let max=Math.max(...arr);let min=Math.min(...arr);if(fromZero==false){max=Math.max(max,Math.abs(min));min=0}if(max-min===0){min=0;if(max===0)max=1e-13}return arr.map(v2=>(v2-min)/(max-min))}static quadraticFormula(a,b,c){let bbmac4=Math.sqrt(b*b-4*a*c);if(!isNaN(bbmac4))return["complex","complex"];let _a2=1/(2*a);if(bbmac4===0)return[b*_a2];let nb=-b;return[(nb+bbmac4)*_a2,(nb-bbmac4)*_a2]}static newtonsMethod(foo=x22=>{return Math.pow(x22,5)+x22*x22-x22-.2},start=0,end=1,precision=.01,attempts=10){let roots=[];for(let i3=0;i3<attempts;i3++){let seedx=Math.random()*(end-start);let guess=foo(seedx);let guess2=foo(seedx+precision);let slope=(guess2-guess)/precision;let xn=seedx+precision;while(Math.abs(slope)>precision){let step=-guess/slope2;let xn12=xn+step;guess=guess2;guess2=foo(xn12);let slope2=(guess2-guess)/(xn12-xn)}let idx;let f=roots.find((root,i22)=>{if(Math.abs(xn1-root)<precision){idx=i22;return true}});if(f)roots[idx]=(xn1+f)*.5;else roots.push(xn1)}return roots}static makeVec(point1,point2){var vec=[];point1.forEach((c,i3)=>{vec.push(point2[i3]-c)});return vec}static getBufferedValueByCoordinates(vb=new Array(300).fill(1),dims=[10,10,2],coordinate=[1,2,1],cardinal=void 0){let getIdx=(foundIdx=0,dimIdx=0)=>{if(dimIdx===dims.length)return foundIdx;if(dimIdx==0)foundIdx+=coordinate[dimIdx];else if(dims[dimIdx]==0)dimsAt0++;else{let reMul=(val=coordinate[dimIdx],di=dimIdx-1)=>{val*=dims[di];di--;if(di==0)return val;else return reMul(val,di)};foundIdx+=reMul(coordinate[dimIdx]+1,dimIdx-1)}dimIdx++;return getIdx(foundIdx,dimIdx)};let found=getIdx();if(cardinal){if(coordinate[coordinate.length-1]===0){let lastnonzero=0;let idx=0;while(idx!==coordinate.length-1){if(coordinate[idx]!==0)lastnonzero=idx;idx++}return vb[found-lastnonzero+cardinal]}return vb[found-dims.length+cardinal]}else{if(coordinate[coordinate.length-1]===0){let lastnonzero=0;let idx=0;while(idx!==coordinate.length-1){if(coordinate[idx]!==0)lastnonzero=idx;idx++}return vb.slice(found-lastnonzero,found+1)}return vb.slice(found-dims.length,found+1)}}static forBufferedMat(vb=new Array(100).fill(1),dims=[10,10],asIndex=(v2,i3,x22,y22)=>{return v2+x22+y22}){let coordinate=[];let idx=0;let recurseFor=(depth=0,nextDepth=depth+1)=>{let result=new Array(vb.length);for(let di=0;di<dims[depth];di++){coordinate[depth]=di;if(dims[nextDepth])recurseFor(nextDepth);else{result[idx]=asIndex(vb[idx],idx,...coordinate);idx++}}return result};let recurseForArrFuncs=(depth,nextDepth=depth+1)=>{let result=new Array(vb.length);for(let di=0;di<dims[depth];di++){coordinate[depth]=di;if(dims[nextDepth])recurseFor(nextDepth);else{for(let dj=0;dj<dims.length;dj++){result[idx]=asIndex[dj](vb[idx],idx,...coordinate);idx++}}}return result};if(typeof asIndex==="function"){return recurseFor()}else if(Array.isArray(asIndex)){return recurseForArrFuncs()}}static mapBufferedMat(buffer=new Array(100).fill(1),dimensions=[10,10],asIndex=(v2,idx,i3,j)=>{console.log(`value:${v2}, idx:${idx}, x:${i3},y:${j}`);return v2+i3+j}){let coordinate=new Array(dimensions.length).fill(0);const iterateCoordinate=(coord,idx=0)=>{if(coord[idx]>=dimensions[idx]){coord[idx]=0;idx++;if(idx===dimensions.length)return;iterateCoordinate(coord,idx)}else coord[idx]++};let result=new Array(buffer.length);let i3=0;if(typeof asIndex==="function"){while(i3<buffer.length){result[i3]=asIndex(buffer[i3],i3,...coordinate);i3+=dimensions.length;iterateCoordinate(coordinate)}}else if(Array.isArray(asIndex)){while(i3<buffer.length){asIndex.forEach(func=>{result[i3]=func(buffer[i3],i3,...coordinate);i3++;iterateCoordinate(coordinate)})}}return result}static combinations(choices=["a","b","c"],vecsize=3){var result=[];if(vecsize<=0){result.push([])}else{_Math2.combinations(choices,vecsize-1).forEach(function(previousComb){choices.forEach(function(element){result.push([element].concat(previousComb))})})}return result}static generateCoordinateSpace(upperBounds=[10,10,10],lowerBounds=[-10,-10,-10],steps=[1,1,1],mutater=void 0){for(let i3=0;i3<upperBounds.length;i3++){if(lowerBounds[i3]>upperBounds[i3]){let temp=upperBounds[i3];upperBounds[i3]=lowerBounds[i3];lowerBounds[i3]=temp}}let result=[];let copy=[...upperBounds];let lastindex=copy.length-1;result.push([...copy]);while(copy[0]>=lowerBounds[0]){let checkNextIndex=decrIdx2=>{if(copy[decrIdx2]<=lowerBounds[decrIdx2]){if(decrIdx2===0)return;copy[decrIdx2]=upperBounds[decrIdx2];decrIdx2--;if(decrIdx2<0)return;if(typeof steps[decrIdx2]=="function")copy[decrIdx2]-=steps[decrIdx2](copy[decrIdx2]);else copy[decrIdx2]-=steps[decrIdx2];checkNextIndex(decrIdx2)}};let decrIdx=lastindex;if(typeof steps[decrIdx]=="function")copy[decrIdx]-=steps[decrIdx](copy[decrIdx]);else copy[decrIdx]-=steps[decrIdx];result.push([...copy]);checkNextIndex(decrIdx);if(mutater)result[result.length-1]=mutater(result[result.length-1])}return result}static calcVectorField(coordinates=[[0,0],[0,1],[1,0],[1,1]],formula=(x22,y22)=>{return[x22*10,y22*10]}){return coordinates.map(vec=>formula(...vec))}static transpose(mat){return mat[0].map((_,colIndex)=>mat.map(row=>row[colIndex]))}static matmul(a,b){var aNumRows=a.length,aNumCols=a[0].length,bNumRows=b.length,bNumCols=b[0].length,m=new Array(aNumRows);for(var r=0;r<aNumRows;++r){m[r]=new Array(bNumCols);for(var c=0;c<bNumCols;++c){m[r][c]=0;for(var i3=0;i3<aNumCols;++i3){m[r][c]+=a[r][i3]*b[i3][c]}}}return m}static matscale(mat,scalar){let m=[];for(var i3=0;i3<mat.length;i3++){m[i3]=[];for(let j=0;j<mat[0].length;j++){m[i3][j]=mat[i3][j]*scalar}}return m}static matadd(a,b){let m=[];for(let i3=0;i3<a.length;i3++){m[i3]=[];for(var j=0;j<a[0].length;j++){m[i3][j]=a[i3][j]+b[i3][j]}}return m}static matsub(a,b){let m=[];for(let i3=0;i3<a.length;i3++){m[i3]=[];for(var j=0;j<a[0].length;j++){m[i3][j]=a[i3][j]-b[i3][j]}}return m}static histogram(arr=[],binSize=1,nBins=void 0){let copy=[...arr];copy.sort(function(a,b){return a-b});let binStart=Math.min(...copy);if(typeof nBins==="number"){let binEnd=Math.max(...copy);binSize=Math.abs((binEnd-binStart)/(nBins-1))}let j=binStart;let binx=[];let biny=[];for(let i3=0;i3<copy.length;i3++){let binidx=binSize*j;if(copy[i3]>binStart+binidx){j++;binidx+=binSize;let binmin=binStart+binidx;let binmid=binmin+binidx*.5;binx.push(binmid);biny.push(0)}biny[biny.length-1]++}return[binx,biny]}static normalDistribution(samples=[],normalize=true,cutoff=1e-4){let m=this.mean(samples);let vari=this.variance(samples);let nSamples=samples.length;let probabilities=[];let denom=1/(this.TWO_PI*vari);let _variance=1/vari;let sum=0;for(let i3=0;i3<nSamples;i3++){let px=Math.exp(-.5*Math.pow((samples[i3]-m)*_variance,2))*denom;if(px<cutoff)px=0;probabilities.push(px);sum+=px}if(normalize){let _sum=1/sum;probabilities=probabilities.map(x22=>x22*_sum)}return probabilities}static expectedValue(samples=[],probabilities=this.normalDistribution(samples)){return samples.reduce((sum,item,idx)=>sum+item*probabilities[idx])}static originMoment(samples=[],probabilities=this.normalDistribution(samples),order=1){return samples.reduce((sum,item,idx)=>sum+Math.pow(item,order)*probabilities[idx])}static centralMoment(samples=[],probabilities=this.normalDistribution(samples),order=1){let m=this.mean(samples);return samples.reduce((sum,item,idx)=>sum+Math.pow(item-m,order)*probabilities[idx]/samples.length)}static linearDiscriminantAnalysis(samples=[],classifier=[]){let mean=this.mean(samples);let meank=this.mean(classifier);let covariance=this.cov1d(samples,classifier);let probs=this.normalDistribution(samples);let dk=[];for(let i3=0;i3<samples.length;i3++){dk.push(x[i3]*covariance*meank-.5*mean*covariance*meank+Math.log10(probs[i3]))}return dk}static conv1D(arr=[],kern=[1/3,1/3,1/3],pad=Math.floor(kern.length*.5)){let result=[];let _n=1/kern.length;if(pad>0){let pads=new Array(pad).fill(0);arr=[...pads,...arr,...pads]}let start=Math.floor(kern.length*.5);let end=arr.length-kern.length+start;for(let i3=start;i3<end;i3++){let acc=0;for(let j=0;j<kern.length;j++){acc+=arr[i3-start]*kern[j]}result.push(acc*_n)}return result}static conv2D(mat=[[],[],[]],kern=[[],[],[]],pad=0){let result=new Array(mat.length-Math.ceil(kern.length*.5)).fill([]);let mat_t;let kern_t=_Math2.transpose(kern_t);if(pad>0){let pads=new Array(pad).fill(0);mat_t=_Math2.transpose(mat);for(let i22=0;i22<mat_t.length;i22++){mat_t[i22]=[...pads,...mat_t[i22],...pads]}mat=_Math2.transpose(mat_t);for(let j=0;j<mat.length;j++){mat[j]=[...pads,...mat[j],...pads]}}let startr=Math.floor(kern[0].length*.5);let startl=Math.floor(kern_t[0].length*.5);let endr=mat[0].length-kern[0].length+startr;let endl=mat_t[0].length-kern_t[0].length+startl;let _n=1/(kern[0].length*kern_t[0].length);let iters=endr*endl;let i3=startr;let x22;let y22=startl;while(i3<iters){let acc=0;x22=i3%mat[0].length;if(x22===0){y22++}for(let j=0;j<kern[0].length;j++){for(let k=0;k<kern_t[0].length;j++){acc+=mat[y22-startl+k][x22-startr+j]*kern[k][j]}result[y22].push(acc*_n)}i3++}return result}static cov2d(mat){var mattransposed=this.transpose(mat);var matproducts=[];var rowmeans=[];var colmeans=[];mat.forEach((row,idx)=>{rowmeans.push(this.mean(row))});mattransposed.forEach((col,idx)=>{colmeans.push(this.mean(col))});mat.forEach((row,idx)=>{matproducts.push([]);for(var col=0;col<row.length;col++){matproducts[idx].push((mat[idx][col]-rowmeans[idx])*(mat[idx][col]-colmeans[col])/(row.length-1))}});var matproductstransposed=this.transpose(matproducts);var aNumRows=matproducts.length,aNumCols=matproducts[0].length,bNumRows=matproductstransposed.length,bNumCols=matproductstransposed[0].length,m=new Array(aNumRows);for(var r=0;r<aNumRows;++r){m[r]=new Array(bNumCols);for(var c=0;c<bNumCols;++c){m[r][c]=0;for(var i3=0;i3<aNumCols;++i3){m[r][c]+=matproducts[r][i3]*matproductstransposed[i3][c]/(mat[0].length-1)}}}return m}static cov1d(arr1=[],arr2=[]){return this.cov2d([arr1,arr2])}static cov3d(x22=[],y22=[],z3=[]){return[[this.cov1d(x22,x22),this.cov1d(x22,y22),this.cov1d(x22,z3)],[this.cov1d(y22,x22),this.cov1d(y22,y22),this.cov1d(y22,z3)],[this.cov1d(z3,x22),this.cov1d(z3,y22),this.cov1d(z3,z3)]]}static covNd(dimensionalData=[]){let covariance=[];dimensionalData.forEach((arr,i3)=>{covariance.push([]);dimensionalData.forEach((arr2,j)=>{covariance[i3].push(this.cov1d(arr,arr2))})})}static eigens2x2(mat=[[1,2],[3,4]]){let det=mat[0][0]*mat[1][1]-mat[0][1]*mat[1][0];let mean=(mat[0][0]+mat[1][1])*.5;let sqrt=Math.sqrt(mean*mean-det);let eig1=mean+sqrt;let eig2=mean-sqrt;return[eig1,eig2]}static eigenvectors2x2(mat=[[1,2],[3,4]],eigens=[1,2]){let v1=[-mat[0][1],mat[0][0]-eigens[0]];if(v1[0]===0&&v1[1]===0){v1[0]=mat[1][1]-eigens[0];v1[1]=-mat[1][0]}let v2=[-mat[0][1],mat[0][0]-eigens[1]];if(v2[0]===0&&v2[1]===0){v2[0]=mat[1][1]-eigens[1];v2[1]=-mat[1][0]}return[v1,v2]}static fastpca2d(xarr,yarr){let cov1d=this.cov1d(xarr,yarr);let eigs=this.eigens2x2(cov1d);if(eigs[1]>eigs[0])eigs.reverse();let evs=this.eigenvectors2x2(cov1d,eigs);console.log(eigs,evs);return[eigs,evs]}static crosscorrelation(arr1,arr2){var arr2buf=[...arr2,...Array(arr2.length).fill(0)];var mean1=this.mean(arr1);var mean2=this.mean(arr2);var arr1Est=arr1.reduce((sum,item)=>sum+=Math.pow(item-mean1,2));arr1Est=Math.sqrt(Math.abs(arr1Est));var arr2Est2=arr2.reduce((sum,item)=>sum+=Math.pow(item-mean1,2));arr2Est2=Math.sqrt(Math.abs(arr2Est2));let denom=arr1Est*arr2Est2;if(denom===0)denom=1e-26;var _arrEstsMul=1/denom;var correlations=new Array(arr1.length).fill(0);for(var delay=0;delay<arr1.length;delay++){var r=arr1.reduce((sum,item,i3)=>sum+=(item-mean1)*(arr2buf[delay+i3]-mean2));correlations[delay]=r*_arrEstsMul}return correlations}static autocorrelation(arr1){var delaybuf=[...arr1,...Array(arr1.length).fill(0)];var mean1=this.mean(arr1);var arr1Est=arr1.reduce((sum,item)=>sum+=Math.pow(item-mean1,2));arr1Est=Math.sqrt(Math.abs(arr1Est));let denom=arr1Est*arr2Est;if(denom===0)denom=1e-26;var _arr1estsqrd=1/denom;var correlations=new Array(arr1.length).fill(0);for(var delay=0;delay<arr1.length;delay++){var r=arr1.reduce((sum,item,i3)=>sum+=(item-mean1)*(delaybuf[delay+i3]-mean1));correlations[delay]=r*_arr1estsqrd}return correlations}static autocorrelation2dNormalized(mat2d2){let result=[];for(let y22=0;y22<mat2d2.length;y22++){result.push([]);for(let x22=0;x22<mat2d2[y22].length;x22++){let G3=0;let _G=0;for(let b=0;b<mat2d2.length;b++){for(let a=0;a<mat2d2[b].length;a++){G3+=mat2d2[y22][x22]*mat2d2[mat2d2.length-1-b][mat2d2[y22].length-1-a];_G+=mat2d2[y22][x22]*mat2d2[mat2d2.length-1][mat2d2[y22].length-1]}}result[y22][x22]=G3/_G-1}}return result}static crosscorrelation2d(mat2d1,mat2d2){let result=[];for(let y22=0;y22<mat2d1.length;y22++){result.push([]);for(let x22=0;x22<mat2d1[y22].length;x22++){let G3=0;for(let b=0;b<mat2d2.length;b++){for(let a=0;a<mat2d2[b].length;a++){G3+=mat2d1[y22][x22]*mat2d2[mat2d2.length-1-b][mat2d2[y22].length-1-a]}}result[y22][x22]=G3}}return result}static crosscorrelation2dNormalized(mat2d1,mat2d2){let result=[];for(let y22=0;y22<mat2d1.length;y22++){result.push([]);for(let x22=0;x22<mat2d1[y22].length;x22++){let G3=0;let _G=0;for(let b=0;b<mat2d2.length;b++){for(let a=0;a<mat2d2[b].length;a++){G3+=mat2d1[y22][x22]*mat2d2[mat2d.length-1-b][mat2d2[y22].length-1-a];_G+=mat2d1[y22][x22]*mat2d2[mat2d2.length-1][mat2d2[y22].length-1]}}result[y22][x22]=G3/_G-1}}return result}static correlograms(dat=[[],[]]){var correlograms=[];dat.forEach((row1,i3)=>{dat.forEach((row2,j)=>{if(j>=i3){correlograms.push(_Math2.crosscorrelation(row1,row2))}})});return correlograms}static dft(sineWave=[]){var TWOPI=2*3.141592653589793;var real=[];var imag=[];var mags=[];for(var k=0;k<sineWave.length;k++){real.push(0);imag.push(0);for(var j=0;j<sineWave.length;j++){var shared=TWOPI*k*j/sineWave.length;real[k]=real[k]+sineWave[j]*Math.cos(shared);imag[k]=imag[k]-sineWave[j]*Math.sin(shared)}mags.push(Math.sqrt(real[k]*real[k]+imag[k]*imag[k]))}function orderMagnitudes(unorderedMags){return[...unorderedMags.slice(Math.ceil(unorderedMags.length*.5),unorderedMags.length),...unorderedMags.slice(0,Math.ceil(unorderedMags.length*.5))]}mags=orderMagnitudes(mags);let halflen=mags.length*.5;let freqs=mags.map((m,i3)=>{return i3-halflen});return{real,imag,freqs,mags}}static sma(arr=[],window2){var smaArr=[];for(var i3=0;i3<arr.length;i3++){if(i3==0){smaArr.push(arr[0])}else if(i3<window2){var arrslice=arr.slice(0,i3+1);smaArr.push(arrslice.reduce((previous,current)=>current+=previous)/(i3+1))}else{var arrslice=arr.slice(i3-window2,i3);smaArr.push(arrslice.reduce((previous,current)=>current+=previous)/window2)}}return smaArr}static sum(arr=[]){if(arr.length>0){var sum=arr.reduce((prev,curr)=>curr+=prev);return sum}else{return 0}}static reduceArrByFactor(arr,factor=2){let x22=arr.filter((element,index)=>{return index%factor===0});return x22}static makeArr(startValue,stopValue,nSteps){var arr=[];var step=(stopValue-startValue)/(nSteps-1);for(var i3=0;i3<nSteps;i3++){arr.push(startValue+step*i3)}return arr}static autoscale(array,stackedLines=1,stackPosition=0,centerZero=false){if(array?.length===0)return array;let max=Math.max(...array);let min=Math.min(...array);let _lines=1/stackedLines;let scalar;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));scalar=_lines/absmax;return array.map(y22=>y22*scalar+(_lines*(stackPosition+1)*2-1-_lines))}else{scalar=_lines/(max-min);return array.map(y22=>2*((y22-min)*scalar-1/(2*stackedLines))+(_lines*(stackPosition+1)*2-1-_lines))}}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i3=incr;i3<array.length;i3+=incr){let rounded=Math.round(i3);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static interpolateArray(data,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array;var springFactor=(data.length-1)/(fitCount-1);newData[0]=data[0];for(var i3=1;i3<fitCount-1;i3++){var tmp=i3*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i3]=linearInterpolate(data[before],data[after],atPoint)}newData[fitCount-1]=data[data.length-1];return newData}static isExtrema(arr,critical="peak"){let ref=[...arr];if(ref.length%2===0)ref.pop();if(arr.length>1){let pass=true;for(let i3=0;i3<ref.length;i3++){let val=ref[i3];if(critical==="peak"){if(i3<Math.floor(ref.length*.5)&&val>=ref[Math.floor(ref.length*.5)]){pass=false;break}else if(i3>Math.floor(ref.length*.5)&&val>=ref[Math.floor(ref.length*.5)]){pass=false;break}}else if(critical==="valley"){if(i3<Math.floor(ref.length*.5)&&val<=ref[Math.floor(ref.length*.5)]){pass=false;break}else if(i3>Math.floor(ref.length*.5)&&val<=ref[Math.floor(ref.length*.5)]){pass=false;break}}else{if(i3<Math.floor(ref.length*.5)&&val<=ref[Math.floor(ref.length*.5)]){pass=false;break}else if(i3>Math.floor(ref.length*.5)&&val<=ref[Math.floor(ref.length*.5)]){pass=false;break}}}if(critical!=="peak"&&critical!=="valley"&&pass===false){pass=true;for(let i3=0;i3<ref.length;i3++){let val=ref[i3];if(i3<Math.floor(ref.length*.5)&&val>=ref[Math.floor(ref.length*.5)]){pass=false;break}else if(i3>Math.floor(ref.length*.5)&&val>=ref[Math.floor(ref.length*.5)]){pass=false;break}}}return pass}else return void 0}static isCriticalPoint(arr,critical="peak"){let ref=[...arr];if(ref.length%2===0)ref.pop();if(arr.length>1){let pass=true;for(let i3=0;i3<ref.length;i3++){let val=ref[i3];if(critical==="peak"){if(i3<ref.length*.5&&val<=0){pass=false;break}else if(i3>ref.length*.5&&val>0){pass=false;break}}else if(critical==="valley"){if(i3<ref.length*.5&&val>=0){pass=false;break}else if(i3>ref.length*.5&&val<0){pass=false;break}}else{if(i3<ref.length*.5&&val>=0){pass=false;break}else if(i3>ref.length*.5&&val<0){pass=false;break}}}if(critical!=="peak"&&critical!=="valley"&&pass===false){pass=true;for(let i3=0;i3<ref.length;i3++){let val=ref[i3];if(i3<ref.length*.5&&val<=0){pass=false;break}else if(i3>ref.length*.5&&val>0){pass=false;break}}}return pass}else return void 0}static getPeakThreshold(arr,peakIndices,thresholdVar){let threshold;let filtered=arr.filter((o,i3)=>{if(peakIndices.indexOf(i3)>-1)return true});if(thresholdVar===0){threshold=this.mean(filtered)}else threshold=(thresholdVar+this.mean(filtered))*.5;return threshold}static column(mat,x22){let col=new Array(mat.length).fill(0).map(()=>new Array(1).fill(0));for(let i3=0;i3<mat.length;i3++){col[i3][0]=mat[i3][x22]}return col}static flatten_vector(v2){let v_new=[];for(let i3=0;i3<v2.length;i3++){v_new[i3]=v2[i3][0]}return v_new}static squared_difference(v1,v2){let sum=0;for(let i3=0;i3<v1.length;i3++){sum=sum+Math.pow(v1[i3]-v2[i3],2)}return sum}static shift_deflate(mat,eigenvalue,eigenvector){let len=Math.sqrt(this.matmul(this.transpose(eigenvector),eigenvector));let U=this.matscale(eigenvector,1/len);let delta=this.matscale(this.matmul(U,this.transpose(U)),eigenvalue);let M_new=this.matsub(mat,delta);return M_new}static eigenvalue_of_vector(mat,eigenvector){ev=this.matmul(this.matmul(this.transpose(eigenvector),mat),eigenvector);return ev}static power_iteration(mat,tolerance=1e-5,max_iterations=1e3){let rank=mat.length;let eigenvector=new Array(rank).fill(0).map(()=>new Array(1).fill(Math.sqrt(rank)));let eigenvalue=this.eigenvalue_of_vector(mat,eigenvector);let epsilon=1;let iter=0;while(epsilon>tolerance&&iter<max_iterations){let old_eigenvalue=JSON.parse(JSON.stringify(eigenvalue));let Mv=this.matmul(mat,eigenvector);eigenvector=this.normalize(Mv);eigenvalue=this.eigenvalue_of_vector(mat,eigenvector);epsilon=Math.abs(eigenvalue-old_eigenvalue);iter++};return[eigenvalue,eigenvector]}static eigens(mat,tolerance=1e-4,max_iterations=1e3){let eigenvalues=[];let eigenvectors=[];for(let i3=0;i3<mat.length;i3++){let result=this.power_iteration(mat,tolerance,max_iterations);let eigenvalue=result[0];let eigenvector=result[1];eigenvalues[i3]=eigenvalue;eigenvectors[i3]=this.flatten_vector(eigenvector);mat=this.shift_deflate(mat,eigenvalue,eigenvector)}return[eigenvalues,eigenvectors]}static pca(mat,tolerance=1e-5){let dims=mat.length;let t3=new Array(dims);let p2=new Array(dims);let mat_t=this.transpose(mat);t3[0]=this.column(mat,0);let epsilon=1;let iter=0;while(espilon>tolerance){iter++;p2[0]=this.matmul(mat_t,t3[0]);let tp=this.matmul(this.transpose(t3[0]),t3[0]);p2[0]=this.matscale(p2[0],1/tp);let p_length=Math.sqrt(this.matmul(this.transpose(p2[0]),p2[0]));p2[0]=this.matscale(p2[0],1/p_length);let t_new=this.matmul(mat,p2[0]);let pp=this.matmul(this.transpose(p2[0]),p2[0]);t_new=this.matscale(t_new,1/pp);epsilon=this.squared_difference(t3[0],t_new);t3[0]=JSON.parse(JSON.stringify(t_new))}let components=this.matmul(this.transpose(t3[0]),t3[0]);return components}static circularBuffer(arr,newEntries){if(Array.isArray(newEntries)){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,newEntries.slice(len-newEntries.length))}else{arr.splice(0,arr.length,...newEntries)}}else{arr.push(newEntries);arr.shift()}return arr}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x22=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x22;b=0}else if(60<=h&&h<120){r=x22;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x22}else if(180<=h&&h<240){r=0;g=x22;b=c}else if(240<=h&&h<300){r=x22;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x22}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static p300(event_timestamps=[],raw_signal=[],signal_timestamps=[],sps7=256){let smoothingstep=Math.floor(sps7/10);let smoothed=this.sma(raw_signal,smoothingstep);let peaks=this.peakDetect(smoothed,"peak",smoothingstep);let mean=this.mean(smoothed);let std=this.std(smoothed,mean);let p_idx=0;let candidates=[];if(peaks.length>0){event_timestamps.forEach((t3,j)=>{while(signal_timestamps[peaks[p_idx]]<t3+200){p_idx++;if(!peaks[p_idx])break}let tempi=0;let tempcandidates=[];while(signal_timestamps[peaks[p_idx+tempi]]<t3+600){tempcandidates.push(p_idx+tempi);tempi++;if(!peaks[p_idx+tempi])break}if(tempcandidates.length>1){let peakvals=[];tempcandidates.forEach(tc=>{peakvals.push(smoothed[peaks[tc]])});let max=Math.max(...peakvals);let maxi=tempcandidates[peakvals.indexOf(max)];candidates.push({event_timestamp:t3,event_index:j,peak_timestamp:signal_timestamps[[peaks[maxi]]],signal_index:[peaks[maxi]],signal_amplitude:raw_signal[[peaks[maxi]]],zscore:(smoothed[peaks[maxi]]-mean)/std})}else if(tempcandidates.length===1)candidates.push({event_timestamp:t3,event_index:j,peak_timestamp:signal_timestamps[peaks[tempcandidates[0]]],signal_index:peaks[tempcandidates[0]],signal_amplitude:raw_signal[[peaks[tempcandidates[0]]]],zscore:(smoothed[peaks[tempcandidates[0]]]-mean)/std})})}return candidates}};var Math2=_Math2;__publicField22(Math2,"TWO_PI",Math.PI*2);__publicField22(Math2,"C",299792458);__publicField22(Math2,"G",66743e-15);__publicField22(Math2,"h",662607015e-42);__publicField22(Math2,"R",8314.32);__publicField22(Math2,"Ra",287);__publicField22(Math2,"H",69.3);__publicField22(Math2,"kbar",1054571817e-43);__publicField22(Math2,"kB",1380649e-29);__publicField22(Math2,"ke",89875517923e-1);__publicField22(Math2,"me",91093837015e-41);__publicField22(Math2,"mp",167262192369e-38);__publicField22(Math2,"mn",167492749804e-38);__publicField22(Math2,"P0",101325);__publicField22(Math2,"T0",288.15);__publicField22(Math2,"p0",1.225);__publicField22(Math2,"Na",60220978e16);__publicField22(Math2,"y",1.405);__publicField22(Math2,"M0",28.96643);__publicField22(Math2,"g0",9.80665);__publicField22(Math2,"Re",6378100);__publicField22(Math2,"B",1458e-9);__publicField22(Math2,"S",110.4);__publicField22(Math2,"Sigma",365e-12);__publicField22(Math2,"imgkernels",{edgeDetection:[[-1,-1,-1],[-1,8,-1],[-1,-1,-1]],boxBlur:[[1/9,1/9,1/9],[1/9,1/9,1/9],[1/9,1/9,1/9]],sobelLeft:[[1,0,-1],[2,0,-2],[1,0,-1]],sobelRight:[[-1,0,1],[-2,0,2],[-1,0,1]],sobelTop:[[1,2,1],[0,0,0],[-1,-2,-1]],sobelBottom:[[-1,2,1],[0,0,0],[1,2,1]],identity:[[0,0,0],[0,1,0],[0,0,0]],gaussian3x3:[[1,2,1],[2,4,2],[1,2,1]],guassian7x7:[[0,0,0,5,0,0,0],[0,5,18,32,18,5,0],[0,18,64,100,64,18,0],[5,32,100,100,100,32,5],[0,18,64,100,64,18,0],[0,5,18,32,18,5,0],[0,0,0,5,0,0,0]],emboss:[[-2,-1,0],[-1,1,1],[0,1,2]],sharpen:[[0,-1,0],[-1,5,-1],[0,-1,0]]});__publicField22(Math2,"integral",(func=x22=>{let y22=x22;return y22},range=[],stepx=.01)=>{let area=0;for(let i3=range[0];i3<range[1];i3+=stepx){let y22=func(i3);area+=y22*stepx}return area});__publicField22(Math2,"dintegral",(func=(x22,y22)=>{let z3=x22+y22;return z3},range=[[],[]],stepx=.01,stepy=stepx)=>{let volume=0;for(let i3=range[0][0]+stepx;i3<range[0][1];i3+=stepx){for(let j=range[1][0]+stepy;j<range[1][1];j+=stepy){let z3=func(i3,j);volume+=z3*stepx*stepy}}return volume});__publicField22(Math2,"tintegral",(func=(x22,y22,z3)=>{let w=x22+y22+z3;return w},range=[[],[],[]],stepx=.01,stepy=stepx,stepz=stepx)=>{let volume=0;for(let i3=range[0][0]+stepx;i3<range[0][1];i3+=stepx){for(let j=range[1][0]+stepy;j<range[1][1];j+=stepy){for(let k=range[2][0]+stepz;k<range[2][1];k+=stepz){let w=func(i3,j,k);volume+=w*stepx*stepy*stepz}}}return volume});__publicField22(Math2,"pintegral",(func=x22=>{let y22=x22;return y22},range=[],stepx=.01)=>{let length=0;let y0=void 0;let yi=void 0;for(let i3=range[0];i3<range[1];i3+=stepx){y0=yi;yi=func(i3);if(y0)length+=_Math2.distance([0,y0],[stepx,yi])}return length});__publicField22(Math2,"meshgrid",_Math2.generateCoordinateSpace);__publicField22(Math2,"autocorrelation2d",mat2d2=>{let result=[];for(let y22=0;y22<mat2d2.length;y22++){result.push([]);for(let x22=0;x22<mat2d2[y22].length;x22++){let G3=0;for(let b=0;b<mat2d2.length;b++){for(let a=0;a<mat2d2[b].length;a++){G3+=mat2d2[y22][x22]*mat2d2[mat2d2.length-1-b][mat2d2[y22].length-1-a]}}result[y22][x22]=G3}}return result});__publicField22(Math2,"lerp",_Math2.makeArr);__publicField22(Math2,"upsample",_Math2.interpolateArray);__publicField22(Math2,"lerp",(v0,v1,fit,floor=true)=>{function lerp2(v02,v12,t3){return(1-t3)*v02+t3*v12}function interpolerp2(v02,v12,fit2,floor2=true){if(fit2<=2)return[v02,v12];let a=1/fit2;let result=new Array(fit2);result[0]=v02;for(let i3=1;i3<=fit2;i3++){result[i3]=lerp2(v02,v12,a*i3);if(floor2)result[i3]=Math.floor(result[i3])}return result}});__publicField22(Math2,"peakDetect",(smoothedArray,type="peak",window2=49)=>{let mid=Math.floor(window2*.5);let peaks=[];for(let i3=0;i3<smoothedArray.length-window2;i3++){let isPeak=_Math2.isExtrema(smoothedArray.slice(i3,i3+window2),type);if(isPeak){peaks.push(i3+mid-1)}}return peaks});Object.assign(Math,Math2);var accel_gyro={accelConstant:1/8192,gyroConstant:1/65.5,gyroXAngle:0,gyroYAngle:0,gyroZAngle:0,px:0,py:0,pz:0,sps:100,lastAccelTime:Date.now(),lastGyroTime:Date.now(),__operator:function(data){if(!("ax"in data)&&!("gx"in data))return void 0;if(!data.timestamp){if(data.ax&&Array.isArray(data.ax)||data.gx&&Array.isArray(data.gx)){let len=data.ax?data.ax.length:data.gx.length;let now=Date.now();let toInterp=[now-len*this.sps*1e3,now];data.timestamp=Math2.upsample(toInterp,len)}else{data.timestamp=Date.now()}}let result;if(data.ax){let apass=(timestamp,ax,ay,az)=>{ax=ax*this.accelConstant;ay=ay*this.accelConstant;az=az*this.accelConstant;const accelXAngle=Math.atan(ay/Math.sqrt(ax*ax)+az*az*180/Math.PI)+this.accelXError;const accelYAngle=Math.atan(-ax/Math.sqrt(ay*ay)+az*az*180/Math.PI)+this.accelYError;return{ax,ay,az,roll:accelXAngle,pitch:accelYAngle}};if(Array.isArray(data.timestamp)){result=data.timestamp.map((v2,i3)=>{return apass(v2,data.ax[i3],data.ay[i3],data.az[i3])})}else result=apass(data.timestamp,data.ax,data.ay,data.az)}if(data.gx){let gpass=(timestamp,gx,gy,gz)=>{const elapsed=timestamp-this.lastGyroTime;this.lastGyroTime=timestamp;gx=gx*this.gyroConstant+this.gyroXError;gy=gy*this.gyroConstant+this.gyroYError;gz=gz*this.gyroConstant+this.gyroZError;this.gyroXAngle+=gx*elapsed;this.gyroYAngle+=gy*elapsed;this.gyroZAngle+=gz*elapsed;return{gx,gy,gz,roll:this.gyroXAngle,pitch:this.gyroYAngle,yaw:this.gyroZAngle}};let res;if(Array.isArray(data.timestamp)){res=data.timestamp.map((v2,i3)=>{if(result){let r=gpass(v2,data.gx[i3],data.gy[i3],data.gz[i3]);result.roll=result.roll*.04+r.roll*.96;result.pitch=result.pitch*.04+r.pitch*.96;result.yaw=res.yaw}else return gpass(v2,data.gx[i3],data.gy[i3],data.gz[i3])});if(!result)result=res}else{res=gpass(data.timestamp,data.gx,data.gy,data.gz);if(result){result.roll=result.roll*.04+res.roll*.96;result.pitch=result.pitch*.04+res.pitch*.96;result.yaw=res.yaw}else result=res}}else if(this.gyroXAngle||this.gyroYAngle||this.gyroZAngle){result.roll=result.roll*.04+this.gyroXAngle*.96;result.pitch=result.pitch*.04+this.gyroYAngle*.96;result.yaw=this.gyroXAngle}if(result.ax){const setPositionOffset=(timestamp,result2)=>{const elapsed=timestamp-this.lastAccelTime;this.lastAccelTime=timestamp;this.px+=result2.ax*elapsed*elapsed*Math.cos(this.pitch*Math.PI*.005555555555);this.py+=result2.ay*elapsed*elapsed*Math.cos(this.roll*Math.PI*.005555555555);this.pz+=result2.az*elapsed*elapsed*Math.sin(this.pitch*Math.PI*.005555555555);result2.px=this.px;result2.py=this.py;result2.pz=this.pz;return result2};if(Array.isArray(data.timestamp)){data.timestamp.map((timestamp,i3)=>{setPositionOffset(timestamp,result)})}else{setPositionOffset(data.timestamp,result)}}return result}};var Biquad=class{type;freq;sps;Q;dbGain;a0=0;a1=0;a2=0;b0=0;b1=0;b2=0;x1=0;x2=0;y1=0;y2=0;constructor(type,freq,sps7,Q=1/Math.sqrt(2),dbGain=0){let types=["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"];if(types.indexOf(type)<0){console.error("Valid types: \'lowpass\',\'highpass\',\'bandpass\',\'notch\',\'peak\',\'lowshelf\',\'highshelf\'");return}this.type=type;this.freq=freq;this.sps=sps7;this.Q=Q;this.dbGain=dbGain;let A22=Math.pow(10,dbGain/40);let omega=2*Math.PI*freq/sps7;let sn=Math.sin(omega);let cs=Math.cos(omega);let alpha=sn/(2*Q);let beta=Math.sqrt(A22+A22);this[type](A22,sn,cs,alpha,beta);this.b0/=this.a0;this.b1/=this.a0;this.b2/=this.a0;this.a1/=this.a0;this.a2/=this.a0}lowpass(A22,sn,cs,alpha,beta){this.b0=(1-cs)*.5;this.b1=1-cs;this.b2=(1-cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}highpass(A22,sn,cs,alpha,beta){this.b0=(1+cs)*.5;this.b1=-(1+cs);this.b2=(1+cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}bandpass(A22,sn,cs,alpha,beta){this.b0=alpha;this.b1=0;this.b2=-alpha;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}notch(A22,sn,cs,alpha,beta){this.b0=1;this.b1=-2*cs;this.b2=1;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}peak(A22,sn,cs,alpha,beta){this.b0=1+alpha*A22;this.b1=-2*cs;this.b2=1-alpha*A22;this.a0=1+alpha/A22;this.a1=-2*cs;this.a2=1-alpha/A22}lowshelf(A22,sn,cs,alpha,beta){this.b0=A22*(A22+1-(A22-1)*cs+beta*sn);this.b1=2*A22*(A22-1-(A22+1)*cs);this.b2=A22*(A22+1-(A22-1)*cs-beta*sn);this.a0=A22+1+(A22+1)*cs+beta*sn;this.a1=2*(A22-1+(A22+1)*cs);this.a2=A22+1+(A22-1)*cs-beta*sn}highshelf(A22,sn,cs,alpha,beta){this.b0=A22*(A22+1+(A22-1)*cs+beta*sn);this.b1=2*A22*(A22-1+(A22+1)*cs);this.b2=A22*(A22+1-(A22-1)*cs-beta*sn);this.a0=A22+1-(A22+1)*cs-beta*sn;this.a1=2*(A22-1-(A22+1)*cs);this.a2=A22+1-(A22-1)*cs-beta*sn}applyFilter(signal_step){let y22=this.b0*signal_step+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;this.x2=this.x1;this.x1=signal_step;this.y2=this.y1;this.y1=y22;return y22}zResult(freq){try{let phi=Math.pow(Math.sin(Math.PI*freq*2/(2*this.sps)),2);let result=(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*phi+16*this.b0*this.b2*phi*phi)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*phi+16*this.a2*phi*phi);return result}catch(err){return-200}}static calcCenterFrequency(freqStart,freqEnd){return(freqStart+freqEnd)/2}static calcBandwidth(freqStart,freqEnd){return freqEnd-this.calcCenterFrequency(freqStart,freqEnd)}static calcBandpassQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*Math.sqrt((frequency-bandwidth)*(frequency+bandwidth))/(2*bandwidth);return Q}static calcNotchQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*frequency*bandwidth/Math.sqrt((frequency-bandwidth)*(frequency+bandwidth));return Q}};var beat_detect={refdata:[],lowpass:void 0,smoothed:[],timestamp:[],peaks:[],valleys:[],peak_distances:[],valley_distances:[],beats:[],lastPeak:0,lastValley:0,sps:100,maxFreq:4,limit:10,__onconnected:function(){if(!this.lowpass){let freq=this.maxFreq;if(!freq)freq=1;if(freq>1)freq*=.5;this.lowpass=new Biquad("lowpass",this.maxFreq,this.sps);this.peakFinderWindow=Math.floor(this.sps/this.maxFreq);if(this.peakFinderWindow%2===0)this.peakFinderWindow+=1;if(this.peakFinderWindow<5)this.peakFinderWindow=5;this.midpoint=Math.round(this.peakFinderWindow*.5)}},__operator:function(data){if(!("red"in data)&&!("heg"in data)&&!("raw"in data))return void 0;let refdata=data.red?data.red:data.heg?data.heg:data.raw;if(!("timestamp"in data)){if(Array.isArray(refdata)){let now=Date.now();let len;if(refdata)len=refdata.length;let toInterp=[now-refdata.length*this.sps*1e3,now];data.timestamp=Math2.upsample(toInterp,refdata.length)}else{data.timestamp=Date.now()}}let pass=(amplitude,timestamp)=>{if(amplitude){this.refdata.push(amplitude)}this.timestamp.push(timestamp);let beat;if(this.refdata.length>this.peakFinderWindow){this.refdata.shift();this.timestamp.shift()}this.smoothed.push(this.lowpass.applyFilter(this.refdata[this.refdata.length-1]));if(this.smoothed.length>this.peakFinderWindow){this.smoothed.shift()}if(this.smoothed.length===this.peakFinderWindow){if(Math2.isExtrema(this.smoothed,"valley")){this.valleys.push({value:this.smoothed[this.smoothed.length-this.midpoint?this.midpoint:1],timestamp:this.timestamp[this.timestamp.length-this.midpoint?this.midpoint:1]})}else if(Math2.isExtrema(this.smoothed,"peak")){this.peaks.push({value:this.smoothed[this.smoothed.length-this.midpoint?this.midpoint:1],timestamp:this.timestamp[this.timestamp.length-this.midpoint?this.midpoint:1]})}if(this.valleys.length>2&&this.peaks.length>2){if(this.valleys[this.valleys.length-1].timestamp<this.peaks[this.peaks.length-2].timestamp)this.peaks.splice(this.peaks.length-1);if(this.peaks[this.peaks.length-1].timestamp<this.valleys[this.valleys.length-2].timestamp)this.valleys.splice(this.valleys.length-1);this.valley_distances.push({distance:this.valleys[this.valleys.length-1].timestamp-this.valleys[this.valleys.length-2].timestamp,timestamp:this.valleys[this.valleys.length-1].timestamp,peak0:this.valleys[this.valleys.length-1].value,peak1:this.valleys[this.valleys.length-2].value});this.peak_distances.push({distance:this.peaks[this.peaks.length-1].timestamp-this.peaks[this.peaks.length-2].timestamp,timestamp:this.peaks[this.peaks.length-1].timestamp,peak0:this.peaks[this.peaks.length-1].value,peak1:this.peaks[this.peaks.length-2].value});if(this.peak_distances.length>1&&this.valley_distances.length>1){if(this.lastPeak<this.peaks[this.peaks.length-1].timestamp&&this.lastValley<this.peaks[this.peaks.length-1].timestamp){if(this.valley_distances[this.valley_distances.length-1].timestamp>this.peak_distances[this.peak_distances.length-1].timestamp){let bpm,change=0;if(this.beats.length<1){bpm=60/(5e-4*(this.peak_distances[this.peak_distances.length-1].distance+this.valley_distances[this.valley_distances.length-1].distance))}else if(this.beats[this.beats.length-1].timestamp!==this.peak_distances[this.peak_distances.length-1].timestamp){bpm=60/(5e-4*(this.peak_distances[this.peak_distances.length-1].dt+this.valley_distances[this.valley_distances.length-1].dt));change=Math.abs(bpm-this.beats[this.beats.length-1].bpm)}beat={timestamp:this.peak_distances[this.peak_distances.length-1].timestamp,change,bpm,height0:this.peak_distances[this.peak_distances.length-1].peak0-this.valley_distances[this.valley_distances.length-1].peak0,height1:this.peak_distances[this.peak_distances.length-1].peak1-this.valley_distances[this.valley_distances.length-1].peak1};this.beats.push(beat);this.lastPeak=this.peaks[this.peaks.length-1].timestamp;this.lastValley=this.peaks[this.peaks.length-1].timestamp}else{let bpm,change=0;if(this.beats.length<2){bpm=60/(5e-4*(this.peak_distances[this.peak_distances.length-2].distance+this.valley_distances[this.valley_distances.length-2].distance))}else if(this.beats[this.beats.length-1].timestamp!==this.peak_distances[this.peak_distances.length-2].timestamp){bpm=60/(5e-4*(this.peak_distances[this.peak_distances.length-2].distance+this.valley_distances[this.valley_distances.length-2].distance));change=Math.abs(bpm-this.beats[this.beats.length-2].bpm)}beat={timestamp:this.peak_distances[this.peak_distances.length-2].timestamp,change,bpm,height0:this.peak_distances[this.peak_distances.length-2].peak0-this.valley_distances[this.valley_distances.length-2].peak0,height1:this.peak_distances[this.peak_distances.length-2].peak1-this.valley_distances[this.valley_distances.length-2].peak1};if(Array.isArray(beat.timestamp))beat.timestamp=beat.timestamp[0];this.beats.push(beat);this.lastPeak=this.peaks[this.peaks.length-1].timestamp;this.lastValley=this.peaks[this.peaks.length-1].timestamp}}}if(this.peaks.length>this.limit){this.peaks.shift()}if(this.valleys.length>this.limit){this.valleys.shift()}if(this.peak_distances.length>this.limit){this.peak_distances.shift()}if(this.valley_distances.length>this.limit){this.valley_distances.shift()}if(this.beats.length>this.limit){this.beats.shift()}}}return beat};if(data.red){if("ir"in data&&!Array.isArray(data.red))return pass(data.red+data.ir,data.timestamp);let result;if(data.ir)result=data.red.map((v2,i3)=>{return pass(v2+data.ir[i3],data.timestamp[i3])}).filter(v2=>{if(v2)return true});else result=data.red.map((v2,i3)=>{return pass(v2,data.timestamp[i3])}).filter(v2=>{if(v2)return true});return result}else if(data.raw){if(!Array.isArray(data.raw))return pass(data.raw,data.timestamp);let result=data.raw.map((v2,i3)=>{return pass(v2,data.timestamp[i3])}).filter(v2=>{if(v2)return true});return result}else if(Array.isArray(data.heg)){if(!Array.isArray(data.heg))return pass(data.heg,data.timestamp);let result=data.heg.map((v2,i3)=>{return pass(v2,data.timestamp[i3])}).filter(v2=>{if(v2)return true});return result}}};var blink_detect={sps:250,intervals:{},watch:["0"],tolerance:.2,__onconnected:node=>{node.watch.forEach(ch=>node.intervals[ch]={lowpass:new Biquad("lowpass",20,node.sps),filtered:[],averaged:[]})},__operator:function(data){let checkCt=5;let averageCt=50;let found={};let passed=false;let pass=(key,n)=>{let next=this.intervals[key].lowpass.applyFilter(n);this.intervals[key].filtered.push(next);this.intervals[key].averaged.push(next);if(this.intervals[key].filtered.length>checkCt){if(this.intervals[key].averaged.length>averageCt){this.intervals[key].averaged.splice(0,checkCt);let mean=Math2.mean(this.intervals[key].averaged);if(Math.abs(Math.min(...this.intervals[key].filtered))>Math.abs(mean)+this.tolerance){this.intervals[key].filtered.length=0;passed=true;found[key]=true}}else this.intervals[key].filtered.shift()}};for(const key in this.intervals){if(data[key]){if(Array.isArray(data[key])){data[key].forEach(n=>{pass(key,n)})}else if(typeof data[key]==="number")pass(key,data[key])}}if(passed)return found}};var _ArrayManip=class{static autoscale(array,lineIdx=0,nLines=1,centerZero=false,ymin,ymax,clamp){if(array?.length===0)return array;let max=ymax?ymax:Math.max(...array);let min=ymin?ymin:Math.min(...array);let _lines=1/nLines;let scalar=1;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));if(absmax!==0)scalar=_lines/absmax;return array.map(y22=>{if(clamp){if(y22<min)y22=min;if(y22>max)y22=max}return y22*scalar+(_lines*(lineIdx+1)*2-1-_lines)})}else{if(max===min){if(max!==0){scalar=_lines/max}else if(min!==0){scalar=_lines/Math.abs(min)}}else scalar=_lines/(max-min);return array.map(y22=>{if(clamp){if(y22<min)y22=min;if(y22>max)y22=max}return 2*((y22-min)*scalar-1/(2*nLines))+(_lines*(lineIdx+1)*2-1-_lines)})}}static genTimestamps(ct,sps7){let now=Date.now();let toInterp=[now-ct*1e3/sps7,now];return _ArrayManip.upsample(toInterp,ct)}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i3=incr;i3<array.length;i3+=incr){let rounded=Math.round(i3);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static upsample(array,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array(fitCount);var springFactor=(array.length-1)/(fitCount-1);newData[0]=array[0];for(var i3=1;i3<fitCount-1;i3++){var tmp=i3*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i3]=linearInterpolate(array[before],array[after],atPoint)}newData[fitCount-1]=array[array.length-1];return newData}static interpolate(array,fitCount,scalar=1){if(array.length>fitCount){return _ArrayManip.downsample(array,fitCount,scalar)}else if(array.length<fitCount){return _ArrayManip.upsample(array,fitCount,scalar)}return array}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x3=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x3;b=0}else if(60<=h&&h<120){r=x3;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x3}else if(180<=h&&h<240){r=0;g=x3;b=c}else if(240<=h&&h<300){r=x3;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x3}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static circularBuffer(arr,newEntries){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,...newEntries.slice(newEntries.length-len))}else{arr.splice(0,arr.length,...newEntries)}return arr}static reformatData(data,key){if(Array.isArray(data)){if(Array.isArray(data[0])){let d2={};data.forEach((arr,i3)=>{d2[i3]=arr});data=d2;if(isNaN(data[0][0]))return void 0}else if(key){data={[key]:data};if(isNaN(data[key][0]))return void 0}else{data={0:data};if(isNaN(data[0][0]))return void 0}}else if(typeof data==="object"){for(const key2 in data){if(typeof data[key2]==="number")data[key2]=[data[key2]];else if(data[key2]?.values){if(typeof data[key2].values==="number")data[key2].values=[data[key2].values]}if(isNaN(data[key2][0]))return void 0}}else if(typeof data==="string"){let split;if(data.includes("\\r\\n")){let lines=data.split("\\r\\n");data={};lines.forEach((l,j)=>{if(l.includes("	")){split=l.split("	")}else if(l.includes(",")){split=l.split(",")}else if(l.includes("|")){split=l.split("|")}if(Array.isArray(split)){split.forEach((val,i3)=>{if(val.includes(":")){let[key2,v2]=val.split(":");let fl=parseFloat(v2);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i3]=[fl];else return void 0}})}})}else if(data.includes("	")){split=data.split("	")}else if(data.includes(",")){split=data.split(",")}else if(data.includes("|")){split=data.split("|")}data={};if(Array.isArray(split)){split.forEach((val,i3)=>{if(val.includes(":")){let[key2,v2]=val.split(":");let fl=parseFloat(v2);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i3]=[fl];else return void 0}})}}else if(typeof data==="number"){if(key)data={[key]:[data]};else data={0:[data]}}return data}static padTime(data,lastValue,time,targetFit){let slopeIncr=(data[0]-lastValue)/time/targetFit;let padded=[...new Array(targetFit-data.length).map((_,i3)=>lastValue+slopeIncr*(i3+1)),...data];return padded}static interpolateForTime(data,time,targetSPS){return _ArrayManip.interpolate(data,Math.ceil(targetSPS*time))}isTypedArray(x3){return ArrayBuffer.isView(x3)&&Object.prototype.toString.call(x3)!=="[object DataView]"}recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"){if(typeof target[key]==="object")this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target};spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var ArrayManip=_ArrayManip;__publicField2(ArrayManip,"bufferValues",(objects,property,keys3,buffer)=>{if(!Array.isArray(keys3)&&typeof keys3==="object")keys3=Object.keys(keys3);if(!buffer){let object_keys=Object.keys(objects);if(keys3)buffer=new Float32Array(object_keys.length*keys3.length);else{if(typeof objects[object_keys[0]][property]==="object"){keys3=Object.keys(objects[object_keys[0]][property]);buffer=new Float32Array(object_keys.length*keys3.length)}else buffer=new Float32Array(object_keys.length)}}let i3=0;for(const key in objects){if(objects[key][property]){if(keys3){for(let j=0;j<keys3.length;j++){buffer[i3]=objects[key][property][keys3[j]];i3++}}else{buffer[i3]=objects[key][property];i3++}}}return buffer});var rechk=/^([<>])?(([1-9]\\d*)?([xcbB?hHiIfdsp]))*$/;var refmt=/([1-9]\\d*)?([xcbB?hHiIfdsp])/g;var str=(v2,o,c)=>String.fromCharCode(...new Uint8Array(v2.buffer,v2.byteOffset+o,c));var rts=(v2,o,c,s)=>new Uint8Array(v2.buffer,v2.byteOffset+o,c).set(s.split("").map(str23=>str23.charCodeAt(0)));var pst=(v2,o,c)=>str(v2,o+1,Math.min(v2.getUint8(o),c-1));var tsp=(v2,o,c,s)=>{v2.setUint8(o,s.length);rts(v2,o+1,c-1,s)};var lut=le=>({x:c=>[1,c,0],c:c=>[c,1,o=>({u:v2=>str(v2,o,1),p:(v2,c2)=>rts(v2,o,1,c2)})],"?":c=>[c,1,o=>({u:v2=>Boolean(v2.getUint8(o)),p:(v2,B3)=>v2.setUint8(o,B3)})],b:c=>[c,1,o=>({u:v2=>v2.getInt8(o),p:(v2,b)=>v2.setInt8(o,b)})],B:c=>[c,1,o=>({u:v2=>v2.getUint8(o),p:(v2,B3)=>v2.setUint8(o,B3)})],h:c=>[c,2,o=>({u:v2=>v2.getInt16(o,le),p:(v2,h)=>v2.setInt16(o,h,le)})],H:c=>[c,2,o=>({u:v2=>v2.getUint16(o,le),p:(v2,H3)=>v2.setUint16(o,H3,le)})],i:c=>[c,4,o=>({u:v2=>v2.getInt32(o,le),p:(v2,i3)=>v2.setInt32(o,i3,le)})],I:c=>[c,4,o=>({u:v2=>v2.getUint32(o,le),p:(v2,I)=>v2.setUint32(o,I,le)})],f:c=>[c,4,o=>({u:v2=>v2.getFloat32(o,le),p:(v2,f)=>v2.setFloat32(o,f,le)})],d:c=>[c,8,o=>({u:v2=>v2.getFloat64(o,le),p:(v2,d2)=>v2.setFloat64(o,d2,le)})],s:c=>[1,c,o=>({u:v2=>str(v2,o,c),p:(v2,s)=>rts(v2,o,c,s.slice(0,c))})],p:c=>[1,c,o=>({u:v2=>pst(v2,o,c),p:(v2,s)=>tsp(v2,o,c,s.slice(0,c-1))})]});var errbuf=new RangeError("Structure larger than remaining buffer");var errval=new RangeError("Not enough values for structure");var _ByteParser=class extends ArrayManip{static toDataView(value){if(!(value instanceof DataView)){if(typeof value==="string"&&parseInt(value))value=parseInt(value);if(typeof value==="string"){let enc=new TextEncoder;let hascodes={};for(const code in _ByteParser.codes){while(value.indexOf(code)>-1){let idx=value.indexOf(code);value=value.replace(code,"");hascodes[idx]=code}}let encoded=Array.from(enc.encode(value));for(const key in hascodes){encoded.splice(parseInt(key),0,_ByteParser.codes[hascodes[key]])}value=new DataView(new Uint8Array(encoded).buffer)}else if(typeof value==="number"){let tmp=value;if(value<256){value=new DataView(new ArrayBuffer(1));value.setUint8(0,tmp)}else if(value<65536){value=new DataView(new ArrayBuffer(2));value.setInt16(0,tmp)}else{value=new DataView(new ArrayBuffer(4));value.setUint32(0,tmp)}}else if(value instanceof ArrayBuffer||typeof SharedArrayBuffer!=="undefined"&&value instanceof SharedArrayBuffer){value=new DataView(value)}else if(Array.isArray(value)){value=new DataView(Uint8Array.from(value).buffer)}else if(typeof value==="object"){value=new TextEncoder().encode(JSON.stringify(value))}}return value}static searchBuffer(buffer,searchString,limit){var needle=searchString;var haystack=buffer;var search=_ByteParser.boyerMoore(needle);var skip=search.byteLength;var indices=[];for(var i3=search(haystack);i3!==-1;i3=search(haystack,i3+skip)){indices.push(i3);if(limit){if(indices.length>=limit)break}}return indices}static bytesToInt16(x0,x1){let int16=(255&x0)<<8|255&x1;if((int16&32768)>0){int16|=4294901760}else{int16&=65535}return int16}static bytesToUInt16(x0,x1){return x0*256+x1}static Uint16ToBytes(y22){return[y22&255,y22>>8&255]}static bytesToInt24(x0,x1,x22){let int24=(255&x0)<<16|(255&x1)<<8|255&x22;if((int24&8388608)>0){int24|=4278190080}else{int24&=16777215}return int24}static bytesToUInt24(x0,x1,x22){return x0*65536+x1*256+x22}static Uint24ToBytes(y22){return[y22&255,y22>>8&255,y22>>16&255]}static bytesToInt32(x0,x1,x22,x3){let int32=(255&x0)<<24|(255&x1)<<16|(255&x22)<<8|255&x3;if((int32&2147483648)>0){int32|=0}else{int32&=4294967295}return int32}static bytesToUInt32(x0,x1,x22,x3){return x0*16777216+x1*65536+x22*256+x3}static Uint32ToBytes(y22){return[y22&255,y22>>8&255,y22>>16&255,y22>>24&255]}static get2sCompliment(val,nbits4){if(val>4294967296)return null;return val<<32-nbits4>>32-nbits4}static getSignedInt(...args){let pos=0;function getInt(size){var value=0;var first=true;while(size--){if(first){let byte=args[pos++];value+=byte&127;if(byte&128){value-=128}first=false}else{value*=256;value+=args[pos++]}}return value}return getInt(args.length)}static asUint8Array(input){if(input instanceof Uint8Array){return input}else if(typeof input==="string"){var arr=new Uint8Array(input.length);for(var i3=0;i3<input.length;i3++){var c=input.charCodeAt(i3);if(c>127){throw new TypeError("Only ASCII patterns are supported")}arr[i3]=c}return arr}else{return new Uint8Array(input)}}static boyerMoore(patternBuffer){var pattern=_ByteParser.asUint8Array(patternBuffer);var M2=pattern.length;if(M2===0){throw new TypeError("patternBuffer must be at least 1 byte long")}var R2=256;var rightmost_positions=new Int32Array(R2);for(var c=0;c<R2;c++){rightmost_positions[c]=-1}for(var j=0;j<M2;j++){rightmost_positions[pattern[j]]=j}var boyerMooreSearch=(txtBuffer,start,end)=>{var txt=_ByteParser.asUint8Array(txtBuffer);if(start===void 0)start=0;if(end===void 0)end=txt.length;var pat=pattern;var right=rightmost_positions;var lastIndex=end-pat.length;var lastPatIndex=pat.length-1;var skip;for(var i3=start;i3<=lastIndex;i3+=skip){skip=0;for(var j2=lastPatIndex;j2>=0;j2--){var c2=txt[i3+j2];if(pat[j2]!==c2){skip=Math.max(1,j2-right[c2]);break}}if(skip===0){return i3}}return-1};boyerMooreSearch.byteLength=pattern.byteLength;return boyerMooreSearch}static struct(format){let fns=[],size=0,m=rechk.exec(format);if(!m){throw new RangeError("Invalid format string")}const t3=lut("<"===m[1]),lu=(n,c)=>t3[c](n?parseInt(n,10):1);while(m=refmt.exec(format)){((r,s,f)=>{for(let i3=0;i3<r;++i3,size+=s){if(f){fns.push(f(size))}}})(...lu(...m.slice(1)))}const unpack_from=(arrb,offs)=>{if(arrb.byteLength<(offs|0)+size){throw errbuf}let v2=new DataView(arrb,offs|0);return fns.map(f=>f.u(v2))};const pack_into=(arrb,offs,...values)=>{if(values.length<fns.length){throw errval}if(arrb.byteLength<offs+size){throw errbuf}const v2=new DataView(arrb,offs);new Uint8Array(arrb,offs,size).fill(0);fns.forEach((f,i3)=>f.p(v2,values[i3]))};const pack=(...values)=>{let b=new ArrayBuffer(size);pack_into(b,0,...values);return b};const unpack=arrb=>unpack_from(arrb,0);function*iter_unpack(arrb){for(let offs=0;offs+size<=arrb.byteLength;offs+=size){yield unpack_from(arrb,offs)}}return Object.freeze({unpack,pack,unpack_from,pack_into,iter_unpack,format,size})}};var ByteParser=_ByteParser;__publicField2(ByteParser,"codes",{"\\\\n":10,"\\\\r":13,"\\\\t":9,"\\\\s":32,"\\\\b":8,"\\\\f":12,"\\\\":92});var rms={sps:250,nSec:1,watch:["0","1","2","3"],data:{},rms:{},__operator:function(data){this.watch.forEach(key=>{if(data[key]){if(!this.data[key]){if(Array.isArray(data[key])){this.data[key]=new Array(Math.floor(this.sps*this.nSec)).fill(data[key][0])}else this.data[key]=new Array(Math.floor(this.sps*this.nSec)).fill(data[key])}ByteParser.circularBuffer(this.data[key],data[key])}});if(data.timestamp){if(Array.isArray(data.timestamp)){this.rms.timestamp=data.timestamp[data.timestamp.length-1]}else this.rms.timestamp=data.timestamp}else this.rms.timestamp=Date.now();return new Promise(async res=>{await Promise.all(this.watch.map(async key=>{if(this.data[key])this.rms[key]=Math.sqrt(Math.abs(this.data[key].reduce((p2,v2,i3)=>p2+v2*v2)/this.data[key].length));else delete this.rms[key]}));res(this.rms)})}};var circularBuffer2d={bufferSize:250,watch:["0","1","2","3"],data:{},blocking:false,__onconnected:function(node){for(const key in node.watch){node.data[key]=new Array(node.bufferSize).fill(0)}},__operator:function(data){let buffer2d=[];this.watch.forEach(key=>{if(data[key]){ByteParser.circularBuffer(this.data[key],data[key]);buffer2d.push(this.data[key])}});return buffer2d}};var algorithms={beat_detect,accel_gyro,heartrate:beat_detect,breath:Object.assign({},beat_detect),blink_detect,rms,circularBuffer2d};algorithms["breath"].maxFreq=.2;var __defProp3=Object.defineProperty;var __getOwnPropNames3=Object.getOwnPropertyNames;var __require4=(x3=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x3,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x3)(function(x3){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x3+\'" is not supported\')});var __esm=(fn,res)=>function __init(){return fn&&(res=(0,fn[__getOwnPropNames3(fn)[0]])(fn=0)),res};var __export2=(target,all)=>{for(var name2 in all)__defProp3(target,name2,{get:all[name2],enumerable:true})};var createCapacitorPlatforms;var initPlatforms;var CapacitorPlatforms;var addPlatform;var setPlatform;var ExceptionCode;var CapacitorException;var getPlatformId;var createCapacitor;var initCapacitorGlobal;var Capacitor;var registerPlugin;var Plugins;var WebPlugin;var encode;var decode;var CapacitorCookiesPluginWeb;var CapacitorCookies;var readBlobAsBase64;var normalizeHttpHeaders;var buildUrlParams;var buildRequestInit;var CapacitorHttpPluginWeb;var CapacitorHttp;var init_dist=__esm({"src/ble/node_modules/@capacitor/core/dist/index.js"(){createCapacitorPlatforms=win=>{const defaultPlatformMap=new Map;defaultPlatformMap.set("web",{name:"web"});const capPlatforms=win.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:defaultPlatformMap};const addPlatform2=(name2,platform)=>{capPlatforms.platforms.set(name2,platform)};const setPlatform2=name2=>{if(capPlatforms.platforms.has(name2)){capPlatforms.currentPlatform=capPlatforms.platforms.get(name2)}};capPlatforms.addPlatform=addPlatform2;capPlatforms.setPlatform=setPlatform2;return capPlatforms};initPlatforms=win=>win.CapacitorPlatforms=createCapacitorPlatforms(win);CapacitorPlatforms=initPlatforms(typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{});addPlatform=CapacitorPlatforms.addPlatform;setPlatform=CapacitorPlatforms.setPlatform;(function(ExceptionCode2){ExceptionCode2["Unimplemented"]="UNIMPLEMENTED";ExceptionCode2["Unavailable"]="UNAVAILABLE"})(ExceptionCode||(ExceptionCode={}));CapacitorException=class extends Error{constructor(message,code,data){super(message);this.message=message;this.code=code;this.data=data}};getPlatformId=win=>{var _a,_b;if(win===null||win===void 0?void 0:win.androidBridge){return"android"}else if((_b=(_a=win===null||win===void 0?void 0:win.webkit)===null||_a===void 0?void 0:_a.messageHandlers)===null||_b===void 0?void 0:_b.bridge){return"ios"}else{return"web"}};createCapacitor=win=>{var _a,_b,_c,_d,_e;const capCustomPlatform=win.CapacitorCustomPlatform||null;const cap=win.Capacitor||{};const Plugins2=cap.Plugins=cap.Plugins||{};const capPlatforms=win.CapacitorPlatforms;const defaultGetPlatform=()=>{return capCustomPlatform!==null?capCustomPlatform.name:getPlatformId(win)};const getPlatform=((_a=capPlatforms===null||capPlatforms===void 0?void 0:capPlatforms.currentPlatform)===null||_a===void 0?void 0:_a.getPlatform)||defaultGetPlatform;const defaultIsNativePlatform=()=>getPlatform()!=="web";const isNativePlatform=((_b=capPlatforms===null||capPlatforms===void 0?void 0:capPlatforms.currentPlatform)===null||_b===void 0?void 0:_b.isNativePlatform)||defaultIsNativePlatform;const defaultIsPluginAvailable=pluginName=>{const plugin=registeredPlugins.get(pluginName);if(plugin===null||plugin===void 0?void 0:plugin.platforms.has(getPlatform())){return true}if(getPluginHeader(pluginName)){return true}return false};const isPluginAvailable=((_c=capPlatforms===null||capPlatforms===void 0?void 0:capPlatforms.currentPlatform)===null||_c===void 0?void 0:_c.isPluginAvailable)||defaultIsPluginAvailable;const defaultGetPluginHeader=pluginName=>{var _a2;return(_a2=cap.PluginHeaders)===null||_a2===void 0?void 0:_a2.find(h=>h.name===pluginName)};const getPluginHeader=((_d=capPlatforms===null||capPlatforms===void 0?void 0:capPlatforms.currentPlatform)===null||_d===void 0?void 0:_d.getPluginHeader)||defaultGetPluginHeader;const handleError=err=>win.console.error(err);const pluginMethodNoop=(_target,prop,pluginName)=>{return Promise.reject(`${pluginName} does not have an implementation of "${prop}".`)};const registeredPlugins=new Map;const defaultRegisterPlugin=(pluginName,jsImplementations={})=>{const registeredPlugin=registeredPlugins.get(pluginName);if(registeredPlugin){console.warn(`Capacitor plugin "${pluginName}" already registered. Cannot register plugins twice.`);return registeredPlugin.proxy}const platform=getPlatform();const pluginHeader=getPluginHeader(pluginName);let jsImplementation;const loadPluginImplementation=async()=>{if(!jsImplementation&&platform in jsImplementations){jsImplementation=typeof jsImplementations[platform]==="function"?jsImplementation=await jsImplementations[platform]():jsImplementation=jsImplementations[platform]}else if(capCustomPlatform!==null&&!jsImplementation&&"web"in jsImplementations){jsImplementation=typeof jsImplementations["web"]==="function"?jsImplementation=await jsImplementations["web"]():jsImplementation=jsImplementations["web"]}return jsImplementation};const createPluginMethod=(impl,prop)=>{var _a2,_b2;if(pluginHeader){const methodHeader=pluginHeader===null||pluginHeader===void 0?void 0:pluginHeader.methods.find(m=>prop===m.name);if(methodHeader){if(methodHeader.rtype==="promise"){return options=>cap.nativePromise(pluginName,prop.toString(),options)}else{return(options,callback)=>cap.nativeCallback(pluginName,prop.toString(),options,callback)}}else if(impl){return(_a2=impl[prop])===null||_a2===void 0?void 0:_a2.bind(impl)}}else if(impl){return(_b2=impl[prop])===null||_b2===void 0?void 0:_b2.bind(impl)}else{throw new CapacitorException(`"${pluginName}" plugin is not implemented on ${platform}`,ExceptionCode.Unimplemented)}};const createPluginMethodWrapper=prop=>{let remove;const wrapper=(...args)=>{const p2=loadPluginImplementation().then(impl=>{const fn=createPluginMethod(impl,prop);if(fn){const p22=fn(...args);remove=p22===null||p22===void 0?void 0:p22.remove;return p22}else{throw new CapacitorException(`"${pluginName}.${prop}()" is not implemented on ${platform}`,ExceptionCode.Unimplemented)}});if(prop==="addListener"){p2.remove=async()=>remove()}return p2};wrapper.toString=()=>`${prop.toString()}() { [capacitor code] }`;Object.defineProperty(wrapper,"name",{value:prop,writable:false,configurable:false});return wrapper};const addListener=createPluginMethodWrapper("addListener");const removeListener=createPluginMethodWrapper("removeListener");const addListenerNative=(eventName,callback)=>{const call=addListener({eventName},callback);const remove=async()=>{const callbackId=await call;removeListener({eventName,callbackId},callback)};const p2=new Promise(resolve=>call.then(()=>resolve({remove})));p2.remove=async()=>{console.warn(`Using addListener() without \'await\' is deprecated.`);await remove()};return p2};const proxy=new Proxy({},{get(_,prop){switch(prop){case"$$typeof":return void 0;case"toJSON":return()=>({});case"addListener":return pluginHeader?addListenerNative:addListener;case"removeListener":return removeListener;default:return createPluginMethodWrapper(prop)}}});Plugins2[pluginName]=proxy;registeredPlugins.set(pluginName,{name:pluginName,proxy,platforms:new Set([...Object.keys(jsImplementations),...pluginHeader?[platform]:[]])});return proxy};const registerPlugin2=((_e=capPlatforms===null||capPlatforms===void 0?void 0:capPlatforms.currentPlatform)===null||_e===void 0?void 0:_e.registerPlugin)||defaultRegisterPlugin;if(!cap.convertFileSrc){cap.convertFileSrc=filePath=>filePath}cap.getPlatform=getPlatform;cap.handleError=handleError;cap.isNativePlatform=isNativePlatform;cap.isPluginAvailable=isPluginAvailable;cap.pluginMethodNoop=pluginMethodNoop;cap.registerPlugin=registerPlugin2;cap.Exception=CapacitorException;cap.DEBUG=!!cap.DEBUG;cap.isLoggingEnabled=!!cap.isLoggingEnabled;cap.platform=cap.getPlatform();cap.isNative=cap.isNativePlatform();return cap};initCapacitorGlobal=win=>win.Capacitor=createCapacitor(win);Capacitor=initCapacitorGlobal(typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{});registerPlugin=Capacitor.registerPlugin;Plugins=Capacitor.Plugins;WebPlugin=class{constructor(config){this.listeners={};this.windowListeners={};if(config){console.warn(`Capacitor WebPlugin "${config.name}" config object was deprecated in v3 and will be removed in v4.`);this.config=config}}addListener(eventName,listenerFunc){const listeners=this.listeners[eventName];if(!listeners){this.listeners[eventName]=[]}this.listeners[eventName].push(listenerFunc);const windowListener=this.windowListeners[eventName];if(windowListener&&!windowListener.registered){this.addWindowListener(windowListener)}const remove=async()=>this.removeListener(eventName,listenerFunc);const p2=Promise.resolve({remove});Object.defineProperty(p2,"remove",{value:async()=>{console.warn(`Using addListener() without \'await\' is deprecated.`);await remove()}});return p2}async removeAllListeners(){this.listeners={};for(const listener in this.windowListeners){this.removeWindowListener(this.windowListeners[listener])}this.windowListeners={}}notifyListeners(eventName,data){const listeners=this.listeners[eventName];if(listeners){listeners.forEach(listener=>listener(data))}}hasListeners(eventName){return!!this.listeners[eventName].length}registerWindowListener(windowEventName,pluginEventName){this.windowListeners[pluginEventName]={registered:false,windowEventName,pluginEventName,handler:event=>{this.notifyListeners(pluginEventName,event)}}}unimplemented(msg="not implemented"){return new Capacitor.Exception(msg,ExceptionCode.Unimplemented)}unavailable(msg="not available"){return new Capacitor.Exception(msg,ExceptionCode.Unavailable)}async removeListener(eventName,listenerFunc){const listeners=this.listeners[eventName];if(!listeners){return}const index=listeners.indexOf(listenerFunc);this.listeners[eventName].splice(index,1);if(!this.listeners[eventName].length){this.removeWindowListener(this.windowListeners[eventName])}}addWindowListener(handle){window.addEventListener(handle.windowEventName,handle.handler);handle.registered=true}removeWindowListener(handle){if(!handle){return}window.removeEventListener(handle.windowEventName,handle.handler);handle.registered=false}};encode=str3=>encodeURIComponent(str3).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);decode=str3=>str3.replace(/(%[\\dA-F]{2})+/gi,decodeURIComponent);CapacitorCookiesPluginWeb=class extends WebPlugin{async getCookies(){const cookies=document.cookie;const cookieMap={};cookies.split(";").forEach(cookie=>{if(cookie.length<=0)return;let[key,value]=cookie.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");key=decode(key).trim();value=decode(value).trim();cookieMap[key]=value});return cookieMap}async setCookie(options){try{const encodedKey=encode(options.key);const encodedValue=encode(options.value);const expires=`; expires=${(options.expires||"").replace("expires=","")}`;const path=(options.path||"/").replace("path=","");const domain=options.url!=null&&options.url.length>0?`domain=${options.url}`:"";document.cookie=`${encodedKey}=${encodedValue||""}${expires}; path=${path}; ${domain};`}catch(error){return Promise.reject(error)}}async deleteCookie(options){try{document.cookie=`${options.key}=; Max-Age=0`}catch(error){return Promise.reject(error)}}async clearCookies(){try{const cookies=document.cookie.split(";")||[];for(const cookie of cookies){document.cookie=cookie.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}}catch(error){return Promise.reject(error)}}async clearAllCookies(){try{await this.clearCookies()}catch(error){return Promise.reject(error)}}};CapacitorCookies=registerPlugin("CapacitorCookies",{web:()=>new CapacitorCookiesPluginWeb});readBlobAsBase64=async blob=>new Promise((resolve,reject)=>{const reader=new FileReader;reader.onload=()=>{const base64String=reader.result;resolve(base64String.indexOf(",")>=0?base64String.split(",")[1]:base64String)};reader.onerror=error=>reject(error);reader.readAsDataURL(blob)});normalizeHttpHeaders=(headers={})=>{const originalKeys=Object.keys(headers);const loweredKeys=Object.keys(headers).map(k=>k.toLocaleLowerCase());const normalized=loweredKeys.reduce((acc,key,index)=>{acc[key]=headers[originalKeys[index]];return acc},{});return normalized};buildUrlParams=(params,shouldEncode=true)=>{if(!params)return null;const output=Object.entries(params).reduce((accumulator,entry)=>{const[key,value]=entry;let encodedValue;let item;if(Array.isArray(value)){item="";value.forEach(str3=>{encodedValue=shouldEncode?encodeURIComponent(str3):str3;item+=`${key}=${encodedValue}&`});item.slice(0,-1)}else{encodedValue=shouldEncode?encodeURIComponent(value):value;item=`${key}=${encodedValue}`}return`${accumulator}&${item}`},"");return output.substr(1)};buildRequestInit=(options,extra={})=>{const output=Object.assign({method:options.method||"GET",headers:options.headers},extra);const headers=normalizeHttpHeaders(options.headers);const type=headers["content-type"]||"";if(typeof options.data==="string"){output.body=options.data}else if(type.includes("application/x-www-form-urlencoded")){const params=new URLSearchParams;for(const[key,value]of Object.entries(options.data||{})){params.set(key,value)}output.body=params.toString()}else if(type.includes("multipart/form-data")){const form=new FormData;if(options.data instanceof FormData){options.data.forEach((value,key)=>{form.append(key,value)})}else{for(const key of Object.keys(options.data)){form.append(key,options.data[key])}}output.body=form;const headers2=new Headers(output.headers);headers2.delete("content-type");output.headers=headers2}else if(type.includes("application/json")||typeof options.data==="object"){output.body=JSON.stringify(options.data)}return output};CapacitorHttpPluginWeb=class extends WebPlugin{async request(options){const requestInit=buildRequestInit(options,options.webFetchExtra);const urlParams=buildUrlParams(options.params,options.shouldEncodeUrlParams);const url2=urlParams?`${options.url}?${urlParams}`:options.url;const response=await fetch(url2,requestInit);const contentType=response.headers.get("content-type")||"";let{responseType="text"}=response.ok?options:{};if(contentType.includes("application/json")){responseType="json"}let data;let blob;switch(responseType){case"arraybuffer":case"blob":blob=await response.blob();data=await readBlobAsBase64(blob);break;case"json":data=await response.json();break;case"document":case"text":default:data=await response.text()}const headers={};response.headers.forEach((value,key)=>{headers[key]=value});return{data,headers,status:response.status,url:response.url}}async get(options){return this.request(Object.assign(Object.assign({},options),{method:"GET"}))}async post(options){return this.request(Object.assign(Object.assign({},options),{method:"POST"}))}async put(options){return this.request(Object.assign(Object.assign({},options),{method:"PUT"}))}async patch(options){return this.request(Object.assign(Object.assign({},options),{method:"PATCH"}))}async delete(options){return this.request(Object.assign(Object.assign({},options),{method:"DELETE"}))}};CapacitorHttp=registerPlugin("CapacitorHttp",{web:()=>new CapacitorHttpPluginWeb})}});function numbersToDataView(value){return new DataView(Uint8Array.from(value).buffer)}function dataViewToNumbers(value){return Array.from(new Uint8Array(value.buffer))}function numberToUUID(value){return`0000${value.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}function hexStringToDataView(value){const numbers=value.trim().split(" ").filter(e=>e!=="").map(s=>parseInt(s,16));return numbersToDataView(numbers)}function dataViewToHexString(value){return dataViewToNumbers(value).map(n=>{let s=n.toString(16);if(s.length==1){s="0"+s}return s}).join(" ")}function webUUIDToString(uuid){if(typeof uuid==="string"){return uuid}else if(typeof uuid==="number"){return numberToUUID(uuid)}else{throw new Error("Invalid UUID")}}function mapToObject(map){const obj={};if(!map){return void 0}map.forEach((value,key)=>{obj[key.toString()]=value});return obj}var init_conversion=__esm({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/conversion.js"(){}});async function runWithTimeout(promise,time,exception){let timer;return Promise.race([promise,new Promise((_,reject)=>{timer=setTimeout(()=>reject(exception),time)})]).finally(()=>clearTimeout(timer))}var init_timeout=__esm({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/timeout.js"(){}});var web_exports={};__export2(web_exports,{BluetoothLeWeb:()=>BluetoothLeWeb});var BluetoothLeWeb;var init_web=__esm({"src/ble/node_modules/@capacitor-community/bluetooth-le/dist/esm/web.js"(){init_dist();init_conversion();init_timeout();BluetoothLeWeb=class extends WebPlugin{constructor(){super(...arguments);this.deviceMap=new Map;this.discoveredDevices=new Map;this.scan=null;this.DEFAULT_CONNECTION_TIMEOUT=1e4;this.onAdvertisementReceivedCallback=this.onAdvertisementReceived.bind(this);this.onDisconnectedCallback=this.onDisconnected.bind(this);this.onCharacteristicValueChangedCallback=this.onCharacteristicValueChanged.bind(this)}async initialize(){if(typeof navigator==="undefined"||!navigator.bluetooth){throw this.unavailable("Web Bluetooth API not available in this browser.")}const isAvailable=await navigator.bluetooth.getAvailability();if(!isAvailable){throw this.unavailable("No Bluetooth radio available.")}}async isEnabled(){return{value:true}}async enable(){throw this.unavailable("enable is not available on web.")}async disable(){throw this.unavailable("disable is not available on web.")}async startEnabledNotifications(){}async stopEnabledNotifications(){}async isLocationEnabled(){throw this.unavailable("isLocationEnabled is not available on web.")}async openLocationSettings(){throw this.unavailable("openLocationSettings is not available on web.")}async openBluetoothSettings(){throw this.unavailable("openBluetoothSettings is not available on web.")}async openAppSettings(){throw this.unavailable("openAppSettings is not available on web.")}async setDisplayStrings(){}async requestDevice(options){const filters=this.getFilters(options);const device=await navigator.bluetooth.requestDevice({filters:filters.length?filters:void 0,optionalServices:options===null||options===void 0?void 0:options.optionalServices,acceptAllDevices:filters.length===0});this.deviceMap.set(device.id,device);const bleDevice=this.getBleDevice(device);return bleDevice}async requestLEScan(options){this.requestBleDeviceOptions=options;const filters=this.getFilters(options);await this.stopLEScan();this.discoveredDevices=new Map;navigator.bluetooth.removeEventListener("advertisementreceived",this.onAdvertisementReceivedCallback);navigator.bluetooth.addEventListener("advertisementreceived",this.onAdvertisementReceivedCallback);this.scan=await navigator.bluetooth.requestLEScan({filters:filters.length?filters:void 0,acceptAllAdvertisements:filters.length===0,keepRepeatedDevices:options===null||options===void 0?void 0:options.allowDuplicates})}onAdvertisementReceived(event){var _a,_b;const deviceId=event.device.id;this.deviceMap.set(deviceId,event.device);const isNew=!this.discoveredDevices.has(deviceId);if(isNew||((_a=this.requestBleDeviceOptions)===null||_a===void 0?void 0:_a.allowDuplicates)){this.discoveredDevices.set(deviceId,true);const device=this.getBleDevice(event.device);const result={device,localName:device.name,rssi:event.rssi,txPower:event.txPower,manufacturerData:mapToObject(event.manufacturerData),serviceData:mapToObject(event.serviceData),uuids:(_b=event.uuids)===null||_b===void 0?void 0:_b.map(webUUIDToString)};this.notifyListeners("onScanResult",result)}}async stopLEScan(){var _a;if((_a=this.scan)===null||_a===void 0?void 0:_a.active){this.scan.stop()}this.scan=null}async getDevices(options){const devices=await navigator.bluetooth.getDevices();const bleDevices=devices.filter(device=>options.deviceIds.includes(device.id)).map(device=>{this.deviceMap.set(device.id,device);const bleDevice=this.getBleDevice(device);return bleDevice});return{devices:bleDevices}}async getConnectedDevices(_options){const devices=await navigator.bluetooth.getDevices();const bleDevices=devices.filter(device=>{var _a;return(_a=device.gatt)===null||_a===void 0?void 0:_a.connected}).map(device=>{this.deviceMap.set(device.id,device);const bleDevice=this.getBleDevice(device);return bleDevice});return{devices:bleDevices}}async connect(options){var _a,_b;const device=this.getDeviceFromMap(options.deviceId);device.removeEventListener("gattserverdisconnected",this.onDisconnectedCallback);device.addEventListener("gattserverdisconnected",this.onDisconnectedCallback);const timeoutError=Symbol();if(device.gatt===void 0){throw new Error("No gatt server available.")}try{const timeout=(_a=options.timeout)!==null&&_a!==void 0?_a:this.DEFAULT_CONNECTION_TIMEOUT;await runWithTimeout(device.gatt.connect(),timeout,timeoutError)}catch(error){await((_b=device.gatt)===null||_b===void 0?void 0:_b.disconnect());if(error===timeoutError){throw new Error("Connection timeout")}else{throw error}}}onDisconnected(event){const deviceId=event.target.id;const key=`disconnected|${deviceId}`;this.notifyListeners(key,null)}async createBond(_options){throw this.unavailable("createBond is not available on web.")}async isBonded(_options){throw this.unavailable("isBonded is not available on web.")}async disconnect(options){var _a;(_a=this.getDeviceFromMap(options.deviceId).gatt)===null||_a===void 0?void 0:_a.disconnect()}async getServices(options){var _a,_b;const services=(_b=await((_a=this.getDeviceFromMap(options.deviceId).gatt)===null||_a===void 0?void 0:_a.getPrimaryServices()))!==null&&_b!==void 0?_b:[];const bleServices=[];for(const service of services){const characteristics=await service.getCharacteristics();const bleCharacteristics=[];for(const characteristic of characteristics){bleCharacteristics.push({uuid:characteristic.uuid,properties:this.getProperties(characteristic),descriptors:await this.getDescriptors(characteristic)})}bleServices.push({uuid:service.uuid,characteristics:bleCharacteristics})}return{services:bleServices}}async getDescriptors(characteristic){try{const descriptors=await characteristic.getDescriptors();return descriptors.map(descriptor=>({uuid:descriptor.uuid}))}catch(_a){return[]}}getProperties(characteristic){return{broadcast:characteristic.properties.broadcast,read:characteristic.properties.read,writeWithoutResponse:characteristic.properties.writeWithoutResponse,write:characteristic.properties.write,notify:characteristic.properties.notify,indicate:characteristic.properties.indicate,authenticatedSignedWrites:characteristic.properties.authenticatedSignedWrites,reliableWrite:characteristic.properties.reliableWrite,writableAuxiliaries:characteristic.properties.writableAuxiliaries}}async getCharacteristic(options){var _a;const service=await((_a=this.getDeviceFromMap(options.deviceId).gatt)===null||_a===void 0?void 0:_a.getPrimaryService(options===null||options===void 0?void 0:options.service));return service===null||service===void 0?void 0:service.getCharacteristic(options===null||options===void 0?void 0:options.characteristic)}async getDescriptor(options){const characteristic=await this.getCharacteristic(options);return characteristic===null||characteristic===void 0?void 0:characteristic.getDescriptor(options===null||options===void 0?void 0:options.descriptor)}async discoverServices(_options){throw this.unavailable("discoverServices is not available on web.")}async getMtu(_options){throw this.unavailable("getMtu is not available on web.")}async requestConnectionPriority(_options){throw this.unavailable("requestConnectionPriority is not available on web.")}async readRssi(_options){throw this.unavailable("readRssi is not available on web.")}async read(options){const characteristic=await this.getCharacteristic(options);const value=await(characteristic===null||characteristic===void 0?void 0:characteristic.readValue());return{value}}async write(options){const characteristic=await this.getCharacteristic(options);let dataView;if(typeof options.value==="string"){dataView=hexStringToDataView(options.value)}else{dataView=options.value}await(characteristic===null||characteristic===void 0?void 0:characteristic.writeValueWithResponse(dataView))}async writeWithoutResponse(options){const characteristic=await this.getCharacteristic(options);let dataView;if(typeof options.value==="string"){dataView=hexStringToDataView(options.value)}else{dataView=options.value}await(characteristic===null||characteristic===void 0?void 0:characteristic.writeValueWithoutResponse(dataView))}async readDescriptor(options){const descriptor=await this.getDescriptor(options);const value=await(descriptor===null||descriptor===void 0?void 0:descriptor.readValue());return{value}}async writeDescriptor(options){const descriptor=await this.getDescriptor(options);let dataView;if(typeof options.value==="string"){dataView=hexStringToDataView(options.value)}else{dataView=options.value}await(descriptor===null||descriptor===void 0?void 0:descriptor.writeValue(dataView))}async startNotifications(options){const characteristic=await this.getCharacteristic(options);characteristic===null||characteristic===void 0?void 0:characteristic.removeEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback);characteristic===null||characteristic===void 0?void 0:characteristic.addEventListener("characteristicvaluechanged",this.onCharacteristicValueChangedCallback);await(characteristic===null||characteristic===void 0?void 0:characteristic.startNotifications())}onCharacteristicValueChanged(event){var _a,_b;const characteristic=event.target;const key=`notification|${(_a=characteristic.service)===null||_a===void 0?void 0:_a.device.id}|${(_b=characteristic.service)===null||_b===void 0?void 0:_b.uuid}|${characteristic.uuid}`;this.notifyListeners(key,{value:characteristic.value})}async stopNotifications(options){const characteristic=await this.getCharacteristic(options);await(characteristic===null||characteristic===void 0?void 0:characteristic.stopNotifications())}getFilters(options){var _a;const filters=[];for(const service of(_a=options===null||options===void 0?void 0:options.services)!==null&&_a!==void 0?_a:[]){filters.push({services:[service],name:options===null||options===void 0?void 0:options.name,namePrefix:options===null||options===void 0?void 0:options.namePrefix})}if(((options===null||options===void 0?void 0:options.name)||(options===null||options===void 0?void 0:options.namePrefix))&&filters.length===0){filters.push({name:options.name,namePrefix:options.namePrefix})}return filters}getDeviceFromMap(deviceId){const device=this.deviceMap.get(deviceId);if(device===void 0){throw new Error(\'Device not found. Call "requestDevice", "requestLEScan" or "getDevices" first.\')}return device}getBleDevice(device){var _a;const bleDevice={deviceId:device.id,name:(_a=device.name)!==null&&_a!==void 0?_a:void 0};return bleDevice}}}});var __create3=Object.create;var __defProp23=Object.defineProperty;var __getOwnPropDesc3=Object.getOwnPropertyDescriptor;var __getOwnPropNames22=Object.getOwnPropertyNames;var __getProtoOf3=Object.getPrototypeOf;var __hasOwnProp3=Object.prototype.hasOwnProperty;var __defNormalProp3=(obj,key,value)=>key in obj?__defProp23(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __require22=(x3=>typeof __require4!=="undefined"?__require4:typeof Proxy!=="undefined"?new Proxy(x3,{get:(a,b)=>(typeof __require4!=="undefined"?__require4:a)[b]}):x3)(function(x3){if(typeof __require4!=="undefined")return __require4.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x3+\'" is not supported\')});var __commonJS3=(cb,mod)=>function __require222(){return mod||(0,cb[__getOwnPropNames22(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps3=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames22(from))if(!__hasOwnProp3.call(to,key)&&key!==except)__defProp23(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc3(from,key))||desc.enumerable})}return to};var __toESM3=(mod,isNodeMode,target)=>(target=mod!=null?__create3(__getProtoOf3(mod)):{},__copyProps3(isNodeMode||!mod||!mod.__esModule?__defProp23(target,"default",{value:mod,enumerable:true}):target,mod));var __publicField3=(obj,key,value)=>{__defNormalProp3(obj,typeof key!=="symbol"?key+"":key,value);return value};var require_browser2=__commonJS3({"node_modules/web-worker/cjs/browser.js"(exports,module2){module2.exports=Worker}});var EventHandler3=class{data={};triggers={};ctr=0;constructor(data){if(typeof data==="object")this.data=data}setState=updateObj=>{Object.assign(this.data,updateObj);let props=Object.getOwnPropertyNames(updateObj);for(const prop of props){this.triggerEvent(prop,this.data[prop])}if(this.triggers[statesubKey3]){let run=fn=>{fn(updateObj)};const l=this.triggers[statesubKey3].length;for(let i22=l-1;i22>=0;i22--){run(this.triggers[statesubKey3][i22].onchange)}}return this.data};setValue=(key,value)=>{this.data[key]=value;this.triggerEvent(key,value)};triggerEvent=(key,value)=>{if(this.triggers[key]){let fn=obj=>{obj.onchange(value)};const l=this.triggers[key].length;for(let i22=l-1;i22>=0;i22--){fn(this.triggers[key][i22])}}};subscribeState=onchange=>{return this.subscribeEvent(statesubKey3,onchange)};unsubscribeState=sub=>{return this.unsubscribeEvent(statesubKey3,sub)};subscribeEvent=(key,onchange,refObject,refKey)=>{if(key){if(refObject&&refKey&&!this.triggers[key]){Object.defineProperty(this.data,key,{get:()=>{return refObject[refKey]},set:value=>{refObject[refKey]=value},enumerable:true,configurable:true})}if(!this.triggers[key]){this.triggers[key]=[]}let l=this.ctr;this.ctr++;this.triggers[key].push({sub:l,onchange});return l}else return void 0};unsubscribeEvent=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(sub===void 0){delete this.triggers[key];delete this.data[key]}else{let idx=void 0;let obj=triggers.find((o,i22)=>{if(o.sub===sub){idx=i22;return true}});if(obj)triggers.splice(idx,1);if(Object.keys(triggers).length===0){delete this.triggers[key];delete this.data[key]}if(this.onRemoved)this.onRemoved(obj);return true}}};subscribeEventOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeEvent(key,sub)};sub=this.subscribeEvent(key,changed);return sub};getEvent=(key,sub)=>{for(const s in this.triggers[key]){if(this.triggers[key][s].sub===sub)return this.triggers[key][s]}};getSnapshot=()=>{const snapshot={};for(const key in this.data){snapshot[key]=this.data[key]}};onRemoved};var statesubKey3="*s";var state3=new EventHandler3;var GraphNode2=class{__node={tag:`node${Math.floor(Math.random()*1e15)}`,unique:`${Math.floor(Math.random()*1e15)}`,state:state3};__children;__parent;__operator;__listeners;__props;__args;constructor(properties,parent,graph){this.__setProperties(properties,parent,graph)}__setProperties=(properties,parent,graph)=>{let enforceProperties=()=>{let orig=properties;if(typeof properties==="function"){if(isNativeClass2(properties)){properties=new properties}else properties={__operator:properties,__node:{forward:true,tag:properties.name}}}else if(typeof properties==="string"){if(graph?.get(properties)){properties=graph.get(properties)}}if(!("__node"in properties))properties.__node={};if(!properties.__node.initial)properties.__node.initial=orig};enforceProperties();if(typeof properties==="object"){let assignState=()=>{if(properties.__node?.state)this.__node.state=properties.__node.state;else if(graph){properties.__node.state=graph.__node.state}};let setProps22=()=>{if(properties.__props){if(typeof properties.__props==="function")properties.__props=new properties.__props;if(typeof properties.__props==="object"){this.__proxyObject(properties.__props)}}};let setTag=()=>{if(!properties.__node.tag){if(properties.__operator?.name)properties.__node.tag=properties.__operator.name;else properties.__node.tag=`node${Math.floor(Math.random()*1e15)}`}};let setNode=()=>{if(typeof properties.__node==="string"){if(graph?.get(properties.__node.tag)){properties=graph.get(properties.__node.tag)}else properties.__node={}}else if(!properties.__node)properties.__node={};if(graph){properties.__node.graph=graph}if(properties instanceof Graph2)properties.__node.source=properties};let setParent=()=>{if(!properties.__parent&&parent)properties.__parent=parent;if(parent?.__node&&!(parent instanceof Graph2||properties instanceof Graph2))properties.__node.tag=parent.__node.tag+"."+properties.__node.tag;if(parent instanceof Graph2&&properties instanceof Graph2){if(properties.__node.loaders)Object.assign(parent.__node.loaders?parent.__node.loaders:{},properties.__node.loaders);if(parent.__node.mapGraphs){properties.__node.nodes.forEach(n=>{parent.set(properties.__node.tag+"."+n.__node.tag,n)});let ondelete=()=>{properties.__node.nodes.forEach(n=>{parent.__node.nodes.delete(properties.__node.tag+"."+n.__node.tag)})};this.__addOndisconnected(ondelete)}}};let setOp=()=>{if(typeof properties.default==="function"&&!properties.__operator){properties.__operator=properties.default}if(properties.__operator){if(typeof properties.__operator==="string"){if(graph){let n=graph.get(properties.__operator);if(n)properties.__operator=n.__operator;if(!properties.__node.tag&&properties.__operator.name)properties.__node.tag=properties.__operator.name}}if(typeof properties.__operator==="function")properties.__operator=this.__setOperator(properties.__operator);if(properties.default)properties.default=properties.__operator}};let assignProps=()=>{properties.__node=Object.assign(this.__node,properties.__node);let keys22=Object.getOwnPropertyNames(properties).filter(v2=>{if(!objProps3[v2])return true});for(const key of keys22){if(key in properties)this[key]=properties[key]}};let bindCallbacks=()=>{if(this.__onconnected){if(typeof this.__onconnected==="function"){this.__onconnected=this.__onconnected.bind(this)}else if(Array.isArray(this.__onconnected)){this.__onconnected=this.__onconnected.map(f=>{return f.bind(this)})}if(typeof this.__ondisconnected==="function"){this.__ondisconnected=this.__ondisconnected.bind(this)}else if(Array.isArray(this.__ondisconnected)){this.__ondisconnected=this.__ondisconnected.map(f=>{return f.bind(this)})}}};assignState();setTag();setProps22();setNode();setParent();assignProps();bindCallbacks();setOp()}};__subscribe=(callback,key,subInput,target,tkey,args)=>{const subscribeToFunction=(k,setTarget=(callback2,target2)=>target2?target2:callback2,triggerCallback=callback)=>{let wrappedArgs;if(args){let wrapped=wrapArgs2(triggerCallback,args,this.__node.graph);triggerCallback=wrapped.__callback;wrappedArgs=wrapped.__args}let sub=this.__node.state.subscribeEvent(k,triggerCallback,this,key);let trigger=this.__node.state.getEvent(k,sub);if(!this.__listeners)this.__listeners={};this.__listeners[k]=this.__node.state.triggers[k];if(!trigger)return sub;trigger.source=this.__node.tag;if(key)trigger.key=key;trigger.target=setTarget(callback,target);if(subInput)trigger.subInput=subInput;if(args){trigger.arguments=args;trigger.__args=wrappedArgs}if(tkey)trigger.tkey=tkey;trigger.node=this;trigger.graph=this.__node.graph;return sub};const subscribeToGraph=callback2=>{let fn=this.__node.graph.get(callback2);if(!fn&&callback2.includes(".")){target=callback2.substring(0,callback2.lastIndexOf("."));let n=this.__node.graph.get(callback2.substring(0,target));tkey=callback2.lastIndexOf(".")+1;if(n&&typeof n[key]==="function")callback2=(...args2)=>{return n[tkey](...args2)}}else if(fn.__operator){callback2=fn.__operator;tkey="__operator"}};if(key){if(!this.__node.localState||!this.__node.localState[key]){this.__addLocalState(this,key)}if(typeof callback==="string"){tkey=callback;if(target){if(this.__node.graph?.get(target)){let n=this.__node.graph?.get(target);if(typeof n[callback]==="function"){let fn=n[callback];callback=(...inp)=>{fn(...inp)}}else{let k2=callback;let setter=inp=>{n[k2]=inp};callback=setter}}}else if(typeof this[callback]==="function"){let fn=this[callback];callback=(...inp)=>{fn(...inp)}}else if(this.__node.graph?.get(callback))subscribeToGraph(callback);if(typeof callback!=="function")return void 0}let sub;let k=subInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node)sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)});return sub}else{if(typeof callback==="string"){if(this.__node.graph.get(callback))callback=this.__node.graph.get(callback);tkey="__operator";if(typeof callback!=="object")return void 0}let sub;let k=subInput?this.__node.unique+"input":this.__node.unique;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node){sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)})}return sub}};__unsubscribe=(sub,key,unsubInput)=>{if(key){return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key,sub)}else return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"input":this.__node.unique,sub)};__setOperator=fn=>{fn=fn.bind(this);if(this.__args&&this.__node.graph){fn=wrapArgs2(fn,this.__args,this.__node.graph).__callback}let inpstr=`${this.__node.unique}input`;this.__operator=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[this.__node.unique]){if(typeof result?.then==="function"){result.then(res=>{if(res!==void 0)this.__node.state.setValue(this.__node.unique,res)}).catch(console.error)}else if(result!==void 0)this.__node.state.setValue(this.__node.unique,result)}return result};if(this.__parent instanceof GraphNode2&&!this.__subscribedToParent){if(this.__parent.__operator){let sub=this.__parent.__subscribe(this);let ondelete=()=>{this.__parent?.__unsubscribe(sub);delete this.__subscribedToParent};this.__addOndisconnected(ondelete);this.__subscribedToParent=true}}return this.__operator};__addLocalState=(props,key)=>{if(!props)return;if(!this.__node.localState){this.__node.localState={}}const localState=this.__node.localState;const initState=(props2,k)=>{let str3=this.__node.unique+"."+k;let inpstr=`${str3}input`;let get,set;let obj,descriptor;if(typeof props2[k]==="function"&&k!=="__operator"){if(this.__props?.[k]){obj=this.__props}else{obj=localState}get=()=>{return obj[k]};set=fn=>{if(!this.__props?.[k])fn=fn.bind(this);obj[k]=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[str3]){if(typeof result?.then==="function"){result.then(res=>{this.__node.state.triggerEvent(str3,res)}).catch(console.error)}else this.__node.state.triggerEvent(str3,result)}return result}};localState[k]=props2[k].bind(this);descriptor={get,set,enumerable:true,configurable:true}}else{let get2,set2;let obj2;if(this.__props?.[k]){obj2=this.__props}else{obj2=localState}get2=()=>{return obj2[k]};set2=v2=>{obj2[k]=v2;if(this.__node.state.triggers[str3])this.__node.state.triggerEvent(str3,v2)};localState[k]=props2[k];descriptor={get:get2,set:set2,enumerable:true,configurable:true}}Object.defineProperty(props2,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}};if(key)initState(props,key);else{for(let k in props){initState(props,k)}}};__proxyObject=obj=>{const allProps=getAllProperties2(obj);for(const k of allProps){const descriptor={get:()=>{return obj[k]},set:value=>{obj[k]=value},enumerable:true,configurable:true};Object.defineProperty(this,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}}};__addOnconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__onconnected)){this.__onconnected.push(callback)}else if(typeof this.__onconnected==="function"){this.__onconnected=[callback,this.__onconnected]}else this.__onconnected=callback}__addOndisconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__ondisconnected)){this.__ondisconnected.push(callback)}else if(typeof this.__ondisconnected==="function"){this.__ondisconnected=[callback,this.__ondisconnected]}else this.__ondisconnected=callback}__callConnected(node=this){if(typeof this.__onconnected==="function"){this.__onconnected(this)}else if(Array.isArray(this.__onconnected)){let fn=o=>{o(this)};this.__onconnected.forEach(fn)}}__callDisconnected(node=this){if(typeof this.__ondisconnected==="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let fn=o=>{o(this)};this.__ondisconnected.forEach(fn)}}};var Graph2=class{__node={tag:`graph${Math.floor(Math.random()*1e15)}`,unique:`${Math.random()}`,nodes:new Map,state:state3,roots:{}};constructor(options){this.init(options)}init=options=>{if(options){let cpy=Object.assign({},options);delete cpy.roots;recursivelyAssign3(this.__node,cpy);if(options.roots)this.load(options.roots)}};load=roots=>{function recursivelyAssignChildren(target,obj,inChildren=true,top=true){if(top){if(target)Object.assign(target,obj);else target=Object.assign({},obj);recursivelyAssignChildren(target,obj,true,false)}if(obj?.__children&&!inChildren){if(obj.__children?.constructor.name==="Object"){if(target.__children?.constructor.name==="Object")recursivelyAssignChildren(target.__children,obj.__children,true,false);else target.__children=recursivelyAssignChildren({},obj.__children,true,false)}else{target.__children=obj.__children}}else if(inChildren){for(const key in obj){target[key]=Object.assign({},obj[key]);if(obj[key]?.__children){recursivelyAssignChildren({},obj[key].__children,false,false)}}}return target}this.__node.roots=recursivelyAssignChildren(this.__node.roots?this.__node.roots:{},roots);let cpy=Object.assign({},roots);if(cpy.__node)delete cpy.__node;let listeners=this.recursiveSet(cpy,this,void 0,roots);if(roots.__node){if(!roots.__node.tag)roots.__node._tag=`roots${Math.floor(Math.random()*1e15)}`;else if(!this.get(roots.__node.tag)){let node=new GraphNode2(roots,this,this);this.set(node.__node.tag,node);this.runLoaders(node,this,roots,roots.__node.tag);if(node.__listeners){listeners[node.__node.tag]=node.__listeners}}}else if(roots.__listeners){this.setListeners(roots.__listeners)}this.setListeners(listeners);return cpy};setLoaders=(loaders22,replace)=>{if(replace)this.__node.loaders=loaders22;else Object.assign(this.__node.loaders,loaders22);return this.__node.loaders};runLoaders=(node,parent,properties,key)=>{for(const l in this.__node.loaders){if(typeof this.__node.loaders[l]==="object"){if(this.__node.loaders[l].init)this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key);if(this.__node.loaders[l].connected)node.__addOnconnected(this.__node.loaders[l].connect);if(this.__node.loaders[l].disconnected)node.__addOndisconnected(this.__node.loaders[l].disconnect)}else if(typeof this.__node.loaders[l]==="function")this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key)}};add=(properties,parent)=>{let listeners={};if(typeof parent==="string")parent=this.get(parent);let instanced;if(typeof properties==="function"){if(isNativeClass2(properties)){if(properties.prototype instanceof GraphNode2){properties=properties.prototype.constructor(properties,parent,this);instanced=true}else properties=new properties}else properties={__operator:properties}}else if(typeof properties==="string"){properties=this.__node.roots[properties]}if(!properties)return;if(!instanced){let keys22=Object.getOwnPropertyNames(properties);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(properties));keys22.push(...nonArrowFunctions);keys22=keys22.filter(v2=>!objProps3.includes(v2));let cpy={};for(const key of keys22){cpy[key]=properties[key]}properties=cpy}if(!properties.__node)properties.__node={};properties.__node.initial=properties;if(typeof properties==="object"&&!this.get(properties.__node.tag)){let node;let root=recursivelyAssign3({},properties,2);if(instanced)node=properties;else node=new GraphNode2(properties,parent,this);this.set(node.__node.tag,node);this.runLoaders(node,parent,properties,node.__node.tag);this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key in node.__listeners){let listener=node.__listeners[key];if(node[key]){delete listeners[node.__node.tag][key];listeners[node.__node.tag][node.__node.tag+"."+key]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][key]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode2&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][key]=parent.__node.tag}}}}this.setListeners(listeners);node.__callConnected();return node}else if(properties.__node.tag)return this.get(properties.__node.tag)};recursiveSet=(t22,parent,listeners={},origin)=>{let keys22=Object.getOwnPropertyNames(origin);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(origin)).filter(v2=>!objProps3.includes(v2));keys22.push(...nonArrowFunctions);for(const key of keys22){if(key.includes("__"))continue;let p2=origin[key];if(Array.isArray(p2))continue;let instanced;if(typeof p2==="function"){if(isNativeClass2(p2)){p2=new p2;if(p2 instanceof GraphNode2){p2=p2.prototype.constructor(p2,parent,this);instanced=true}}else p2={__operator:p2}}else if(typeof p2==="string"){if(this.__node.nodes.get(p2))p2=this.__node.nodes.get(p2);else p2=this.__node.roots[p2]}else if(typeof p2==="boolean"){if(this.__node.nodes.get(key))p2=this.__node.nodes.get(key);else p2=this.__node.roots[key]}if(p2 instanceof Object){if(!instanced&&!(p2 instanceof GraphNode2)){let ks=Object.getOwnPropertyNames(p2);let nonArrowFunctions2=Object.getOwnPropertyNames(Object.getPrototypeOf(p2));nonArrowFunctions2.splice(nonArrowFunctions2.indexOf("constructor"),1);ks.push(...nonArrowFunctions2);let cpy={};for(const key2 of ks){cpy[key2]=p2[key2]}p2=cpy}if(!p2.__node)p2.__node={};if(!p2.__node.tag)p2.__node.tag=key;if(!p2.__node.initial)p2.__node.initial=t22[key];if(this.get(p2.__node.tag)&&!(!(parent instanceof Graph2)&&parent?.__node)||parent?.__node&&this.get(parent.__node.tag+"."+p2.__node.tag))continue;let node;let newnode=false;let root=recursivelyAssign3({},p2,2);if(instanced||p2 instanceof GraphNode2){node=p2}else{node=new GraphNode2(p2,parent,this);newnode=true}if(!newnode&&p2 instanceof GraphNode2&&!instanced&&parent instanceof GraphNode2){let sub=this.subscribe(parent.__node.tag,node.__node.tag);let ondelete=node2=>{this.unsubscribe(parent.__node.tag,sub)};node.__addOndisconnected(ondelete)}else if(node){this.set(node.__node.tag,node);this.runLoaders(node,parent,t22[key],key);t22[key]=node;this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key2 in node.__listeners){let listener=node.__listeners[key2];let k=key2;if(node[key2]){delete listeners[node.__node.tag][key2];k=node.__node.tag+"."+key2;listeners[node.__node.tag][k]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][k]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode2&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][k]=parent.__node.tag}}}}node.__callConnected()}}}return listeners};remove=(node,clearListeners=true)=>{this.unsubscribe(node);if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode2){this.delete(node.__node.tag);delete this.__node.roots[node.__node.tag];if(clearListeners){this.clearListeners(node)}node.__callDisconnected();const recursiveRemove=t22=>{for(const key in t22){this.unsubscribe(t22[key]);this.delete(t22[key].__node.tag);delete this.__node.roots[t22[key].__node.tag];this.delete(key);delete this.__node.roots[key];t22[key].__node.tag=t22[key].__node.tag.substring(t22[key].__node.tag.lastIndexOf(".")+1);if(clearListeners){this.clearListeners(t22[key])}t22[key].__callDisconnected();if(t22[key].__children){recursiveRemove(t22[key].__children)}}};if(node.__children){recursiveRemove(node.__children)}}if(node?.__node.tag&&node?.__parent){delete node?.__parent;node.__node.tag=node.__node.tag.substring(node.__node.tag.indexOf(".")+1)}if(node?.__node.graph)node.__node.graph=void 0;return node};run=(node,...args)=>{if(typeof node==="string"){let nd=this.get(node);if(!nd&&node.includes(".")){nd=this.get(node.substring(0,node.lastIndexOf(".")));if(typeof nd?.[node.substring(node.lastIndexOf(".")+1)]==="function")return nd[node.substring(node.lastIndexOf(".")+1)](...args)}else if(nd?.__operator)return nd.__operator(...args)}if(node?.__operator){return node?.__operator(...args)}};setListeners=listeners=>{for(const key in listeners){let node=this.get(key);if(typeof listeners[key]==="object"){for(const k in listeners[key]){let n=this.get(k);let sub;if(typeof listeners[key][k]!=="object")listeners[key][k]={__callback:listeners[key][k]};else if(!listeners[key][k].__callback){for(const kk in listeners[key][k]){if(typeof listeners[key][k][kk]!=="object"){listeners[key][k][kk]={__callback:listeners[key][k][kk]};if(node.__operator&&(listeners[key][k][kk].__callback===true||typeof listeners[key][k][kk].__callback==="undefined"))listeners[key][k][kk].__callback=node.__operator}let nn=this.get(kk);if(!nn){let tag=k.substring(0,k.lastIndexOf("."));nn=this.get(tag);if(nn){let prop=k.substring(k.lastIndexOf(".")+1);sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k][kk].__args,prop,listeners[key][k][kk].inputState,key,k)}}else{sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}if("__callback"in listeners[key][k]){if(node){if(listeners[key][k].__callback===true||typeof listeners[key][k].__callback==="undefined")listeners[key][k].__callback=node.__operator;if(typeof listeners[key][k].__callback==="function")listeners[key][k].__callback=listeners[key][k].__callback.bind(node)}if(!n){let tag=k.substring(0,k.lastIndexOf("."));n=this.get(tag);if(n){sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,k.substring(k.lastIndexOf(".")+1),listeners[key][k].inputState,key,k)}}else{sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}}}};clearListeners=(node,listener)=>{if(typeof node==="string")node=this.get(node);if(node?.__listeners){for(const key in node.__listeners){if(listener&&key!==listener)continue;if(typeof node.__listeners[key]?.sub!=="number")continue;let n=this.get(key);if(!n){n=this.get(key.substring(0,key.lastIndexOf(".")));if(n){if(typeof node.__listeners[key]==="object"&&!node.__listeners[key]?.__callback){for(const k in node.__listeners[key]){if(typeof node.__listeners[key][k]?.sub==="number"){this.unsubscribe(n,node.__listeners[key][k].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}else{if(typeof!node.__listeners[key]?.__callback==="number"){for(const k in node.__listeners[key]){if(node.__listeners[key][k]?.sub){this.unsubscribe(n,node.__listeners[key][k].sub,void 0,node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,void 0,node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}}};get=tag=>{return this.__node.nodes.get(tag)};set=(tag,node)=>{return this.__node.nodes.set(tag,node)};delete=tag=>{return this.__node.nodes.delete(tag)};getProps=(node,getInitial)=>{if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode2){let cpy;if(getInitial)cpy=Object.assign({},this.__node.roots[node.__node.tag]);else{cpy=Object.assign({},node);for(const key in cpy){if(key.includes("__"))delete cpy[key]}}}};subscribe=(nodeEvent,onEvent,args,key,subInput,target,bound,tkey)=>{let nd=nodeEvent;if(typeof nodeEvent==="string"){nd=this.get(nodeEvent);if(!nd&&nodeEvent.includes(".")){nd=this.get(nodeEvent.substring(0,nodeEvent.lastIndexOf(".")));key=nodeEvent.substring(nodeEvent.lastIndexOf(".")+1)}}if(target instanceof GraphNode2)target=target.__node.tag;if(typeof onEvent==="string"){let setOnEventFromString=onEvent2=>{if(this.get(onEvent2)?.__operator){let node=this.get(onEvent2);target=onEvent2;onEvent2=function(...inp){return node.__operator(...inp)}}else if(onEvent2.includes(".")){target=onEvent2.substring(0,onEvent2.lastIndexOf("."));let n=this.get(target);let k=onEvent2.substring(onEvent2.lastIndexOf(".")+1);tkey=k;if(typeof n[k]==="function"){if(n[k]instanceof GraphNode2)onEvent2=n[k];else onEvent2=function(...inp){return n[k](...inp)}}else{onEvent2=function(inp){n[k]=inp;return n[k]}}}return onEvent2};if(target){let node=this.get(target);if(typeof node?.[onEvent]==="function"){tkey=onEvent;onEvent=function(...inp){return node[key](...inp)}}else if(node[key]){tkey=key;if(node[key]instanceof GraphNode2)onEvent=node[key];else onEvent=function(inp){node[key]=inp;return node[key]}}else{onEvent=setOnEventFromString(onEvent)}}else{onEvent=setOnEventFromString(onEvent)}}let sub;if(nd instanceof GraphNode2){const doSub=()=>{sub=nd.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)nd.__unsubscribe(sub,key,subInput);sub=void 0};nd.__addOndisconnected(()=>{ondelete();nd.__addOnconnected(()=>{if(sub===void 0&&nd.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))onEvent=this.get(onEvent);if(onEvent instanceof GraphNode2){onEvent.__addOndisconnected(()=>{ondelete()})}};doSub()}else if(typeof nodeEvent==="string"){let node=this.get(nodeEvent);if(node){if(onEvent instanceof GraphNode2&&onEvent.__operator){const doSub=()=>{sub=node.__subscribe(onEvent.__operator,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput)};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});onEvent.__addOndisconnected(ondelete)};doSub()}else if(typeof onEvent==="function"||typeof onEvent==="string"){const doSub=()=>{sub=node.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput);sub=void 0};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))this.get(onEvent).__addOndisconnected(ondelete)};doSub()}}else{if(typeof onEvent==="string")onEvent=this.__node.nodes.get(onEvent).__operator;if(typeof onEvent==="function")sub=this.__node.state.subscribeEvent(nodeEvent,onEvent)}}return sub};unsubscribe=(node,sub,key,subInput)=>{if(node instanceof GraphNode2){return node.__unsubscribe(sub,key,subInput)}else return this.get(node)?.__unsubscribe(sub,key,subInput)};setState=update=>{this.__node.state.setState(update)}};function recursivelyAssign3(target,obj,maxDepth=Infinity,curDepth=0){for(const key in obj){if(obj[key]?.constructor.name==="Object"&&curDepth<maxDepth){curDepth++;if(target[key]?.constructor.name==="Object")recursivelyAssign3(target[key],obj[key],maxDepth,curDepth);else target[key]=recursivelyAssign3({},obj[key],maxDepth,curDepth)}else{target[key]=obj[key]}}return target}function getAllProperties2(obj){var allProps=[],curr=obj;do{var props=Object.getOwnPropertyNames(curr);let fn=function(prop){if(allProps.indexOf(prop)===-1)allProps.push(prop)};props.forEach(fn)}while(curr=Object.getPrototypeOf(curr));return allProps}function isNativeClass2(thing){return isFunction2(thing)==="class"}function isFunction2(x3){const res=typeof x3==="function"?x3.prototype?Object.getOwnPropertyDescriptor(x3,"prototype")?.writable?"function":"class":x3.constructor.name==="AsyncFunction"?"async":"arrow":"";return res}var getCallbackFromString2=(a,graph)=>{if(graph.get(a)?.__operator){let node=graph.get(a);return(...inp)=>{node.__operator(...inp)}}else if(a.includes(".")){let split=a.split(".");let popped=split.pop();let joined=split.join(".");let node=graph.get(joined);if(typeof graph.get(joined)?.[popped]==="function"){return(...inp)=>{return node[popped](...inp)}}else return()=>{return node[popped]}}else if(graph.get(a)){let node=graph.get(a);return()=>{return node}}else{let arg=a;return()=>{return arg}}};var wrapArgs2=(callback,argOrder,graph)=>{let args=[];let forArg=(a,i22)=>{if(a==="__output"||a==="__input"||a==="__callback"){args[i22]={__callback:inp=>{return inp},__args:void 0,idx:i22}}else if(typeof a==="string"){args[i22]={__callback:getCallbackFromString2(a,graph),__args:void 0,idx:i22}}else if(typeof a==="function"){let fn2=a;args[i22]={__callback:(...inp)=>{return fn2(...inp)},__args:void 0,idx:i22}}else if(typeof a==="object"&&(a.__input||a.__callback)){let recursivelyCreateCallback=function(c){let input=c.__input?c.__input:c.__callback;if(typeof c.__input==="string"){input={__callback:getCallbackFromString2(c.__input,graph),__args:void 0,idx:i22}}if(c.__args){let wrapped=wrapArgs2(input,c.__args,graph);input={__callback:wrapped.__callback,__args:wrapped.__args,idx:i22}}else{input={__callback:input,__args:void 0,idx:i22}}if(c.__output){let output=c.__output;if(typeof c.__output==="string"){output={__callback:getCallbackFromString2(output,graph),__args:void 0,idx:i22}}else if(typeof a.__output==="object"){output=recursivelyCreateCallback(output)}if(typeof output?.__callback==="function"){let fn2=input.__callback;let callback2=output.__callback;input={__callback:(...inp)=>{return callback2(fn2(...inp))},__args:output.__args,idx:i22}}}return input};args[i22]=recursivelyCreateCallback(a)}else{let arg=a;args[i22]={__callback:()=>{return arg},__args:void 0,idx:i22}}};argOrder.forEach(forArg);if(typeof callback==="string")callback={__callback:getCallbackFromString2(callback,graph),__args:void 0};let fn=typeof callback==="function"?callback:callback.__callback;callback=function(...inp){let mapArg=arg=>{return arg.__callback(...inp)};const result=fn(...args.map(mapArg));return result};return{__callback:callback,__args:args}};var objProps3=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var backprop2=(node,parent,graph)=>{if(node.__node.backward&&parent instanceof GraphNode2){graph.setListeners({[parent.__node.tag]:{[node.__node.tag]:parent}})}};var loop2=(node,parent,graph)=>{if(node.__operator&&!node.__node.looperSet){if(typeof node.__node.delay==="number"){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{setTimeout(async()=>{res(await fn(...args))},node.__node.delay)})})}else if(node.__node.frame===true){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{requestAnimationFrame(async()=>{res(await fn(...args))})})})}if(typeof node.__node.repeat==="number"||typeof node.__node.recursive==="number"){let fn=node.__operator;node.__setOperator(async(...args)=>{let i22=node.__node.repeat?node.__node.repeat:node.__node.recursive;let result;let repeater=async(tick,...inp)=>{while(tick>0){if(node.__node.delay||node.__node.frame){fn(...inp).then(async res=>{if(node.__node.recursive){await repeater(tick,res)}else await repeater(tick,...inp)});break}else result=await fn(...args);tick--}};await repeater(i22,...args);return result})}if(node.__node.loop&&typeof node.__node.loop==="number"){node.__node.looperSet=true;let fn=node.__operator;let time=node.__node.loop;node.__setOperator((...args)=>{if(!("looping"in node.__node))node.__node.looping=true;if(node.__node.looping){let last=performance.now();fn(...args);setTimeout(()=>{let now=performance.now();let overshoot=now-last-node.__node.loop;if(overshoot>0)time=node.__node.loop-overshoot;else time=node.__node.loop;if(time<=0)time=node.__node.loop;node.__operator(...args)},time)}});if(node.__node.looping)node.__operator();let ondelete=node2=>{if(node2.__node.looping)node2.__node.looping=false};node.__addOndisconnected(ondelete)}}};var animate2=(node,parent,graph)=>{if(node.__node.animate===true||node.__animation){let fn=node.__operator;node.__setOperator((...args)=>{if(!("animating"in node.__node))node.__node.animating=true;if(node.__node.animating){if(typeof node.__animation==="function")node.__animation(...args);else fn(...args);requestAnimationFrame(()=>{node.__operator(...args)})}});if(node.__node.animating||(!("animating"in node.__node)||node.__node.animating)&&node.__animation)setTimeout(()=>{requestAnimationFrame(node.__operator)},10);let ondelete=node2=>{if(node2.__node.animating)node2.__node.animating=false};node.__addOndisconnected(ondelete)}};var branching2=(node,parent,graph)=>{if(typeof node.__branch==="object"&&node.__operator&&!node.__branchApplied){let fn=node.__operator;node.__branchApplied=true;node.__operator=(...args)=>{let result=fn(...args);for(const key in node.__branch){let triggered=()=>{if(typeof node.__branch[key].then==="function"){node.__branch[key].then(result)}else if(node.__branch[key].then instanceof GraphNode2&&node.__branch[key].then.__operator){node.__branch[key].then.__operator(result)}else result=node.__branch[key].then};if(typeof node.__branch[key].if==="function"){if(node.__branch[key].if(result)==true){triggered()}}else if(node.__branch[key].if===result){triggered()}}return result}}if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].branch&&!node.__listeners[key].branchApplied){let fn=node.__listeners[key].callback;node.__listeners[key].branchApplied=true;node.__listeners.callback=ret=>{let triggered=()=>{if(typeof node.__listeners[key].branch.then==="function"){ret=node.__listeners[key].branch.then(ret)}else if(node.__listeners[key].branch.then instanceof GraphNode2&&node.__listeners[key].branch.then.__operator){ret=node.__listeners[key].branch.then.__operator(ret)}else ret=node.__listeners[key].branch.then};if(typeof node.__listeners[key].branch.if==="function"){if(node.__listeners[key].branch.if(ret)){triggered()}}else if(node.__listeners[key].branch.if===ret){triggered()}return fn(ret)}}}}}};var triggerListenerOncreate2=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].oncreate){node.__listeners[key].callback(node.__listeners[key].oncreate)}}}}};var bindListener2=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].binding==="object"){node.__listeners.callback=node.__listeners.callback.bind(node.__listeners[key].binding)}}}}};var transformListenerResult2=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].transform==="function"&&!node.__listeners[key].transformApplied){let fn=node.__listeners[key].callback;node.__listeners[key].transformApplied=true;node.__listeners.callback=ret=>{ret=node.__listeners[key].transform(ret);return fn(ret)}}}}}};var substitute__operator2=(node,parent,graph)=>{if(node.post&&!node.__operator){node.__setOperator(node.post)}else if(!node.__operator&&typeof node.get=="function"){node.__setOperator(node.get)}if(!node.get&&node.__operator){node.get=node.__operator}if(node.aliases){node.aliases.forEach(a=>{graph.set(a,node);let ondelete=node2=>{graph.__node.nodes.delete(a)};node.__addOndisconnected(ondelete)})}if(typeof graph.__node.roots?.[node.__node.tag]==="object"&&node.get)graph.__node.roots[node.__node.tag].get=node.get};var loaders2={backprop:backprop2,loop:loop2,animate:animate2,branching:branching2,triggerListenerOncreate:triggerListenerOncreate2,bindListener:bindListener2,transformListenerResult:transformListenerResult2,substitute__operator:substitute__operator2};var recursivelyStringifyFunctions2=obj=>{let cpy={};for(const key in obj){if(typeof obj[key]==="object"){cpy[key]=recursivelyStringifyFunctions2(obj[key])}else if(typeof obj[key]==="function"){cpy[key]=obj[key].toString()}else cpy[key]=obj[key]}return cpy};function parseFunctionFromText2(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs222(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs2}var stringifyFast2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p2 in value[prop]){if(Array.isArray(value[prop][p2])){if(value[prop][p2].length>20)obj[prop][p2]=value[prop][p2].slice(value[prop][p2].length-20);else obj[prop][p2]=value[prop][p2]}else{if(value[prop][p2]!=null){let con=value[prop][p2].constructor.name;if(con.includes("Set")){obj[prop][p2]=Array.from(value[prop][p2])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p2]="instanceof_"+con}else{obj[prop][p2]=value[prop][p2]}}else{obj[prop][p2]=value[prop][p2]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast222(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast2}function methodstrings2(node){if(typeof node.__methods==="object"){for(const key in node.__methods){let fstr=node.__methods[key];let fn=typeof fstr==="function"?fstr:parseFunctionFromText2(fstr);if(key==="__operator"){node.__setOperator(fn)}else{node[key]=fn.bind(node)}}}}var Service2=class extends Graph2{name=`service${Math.floor(Math.random()*1e15)}`;constructor(options){super({...options,loaders:options?.loaders?Object.assign({...loaders2},options.loaders):{...loaders2}});if(options?.services)this.addServices(options.services);this.load(this)}addServices=services=>{for(const s in services){if(typeof services[s]==="function")services[s]=new services[s];if(services[s]?.__node?.loaders)Object.assign(this.__node.loaders,services[s].__node.loaders);if(services[s]?.__node?.nodes){services[s].__node.nodes.forEach((n,tag)=>{if(!this.get(tag)){this.set(tag,n)}else this.set(s+"."+tag,n)});this.__node.nodes.forEach((n,k)=>{if(!services[s].__node.nodes.get(k))services[s].__node.nodes.set(k,n)});let set=this.set;this.set=(tag,node)=>{services[s].set(tag,node);return set(tag,node)};let del=this.delete;this.delete=tag=>{services[s].delete(tag);return del(tag)}}else if(typeof services[s]==="object"){this.load(services[s])}}};handleMethod=(route,method,args)=>{let m=method.toLowerCase();let src=this.__node.nodes.get(route);if(!src){src=this.__node.roots[route]}if(src?.[m]){if(typeof src[m]!=="function"){if(args){if(Array.isArray(args)&&args.length===1)src[m]=args[0];else src[m]=args;return}return src[m]}else{if(Array.isArray(args))return src[m](...args);else return src[m](args)}}else return this.handleServiceMessage({route,args,method})};handleServiceMessage(message){let call;if(typeof message==="object"){if(message.route)call=message.route;else if(message.node)call=message.node}if(call){if(Array.isArray(message.args))return this.run(call,...message.args);else return this.run(call,message.args)}else return message}handleGraphNodeCall(route,args){if(!route)return args;if(args?.args){this.handleServiceMessage(args)}else if(Array.isArray(args))return this.run(route,...args);else return this.run(route,args)}transmit=(...args)=>{if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};receive=(...args)=>{if(args[0]){if(typeof args[0]==="string"){let substr=args[0].substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))args[0]=args[0].replace(/\\\\/g,"");if(args[0][0]===\'"\'){args[0]=args[0].substring(1,args[0].length-1)};args[0]=JSON.parse(args[0])}}}if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};pipe=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode2){if(callback)return this.subscribe(source,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})};pipeOnce=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode2){if(callback)return source.__node.state.subscribeEventOnce(source.__node.unique,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.__node.state.subscribeEventOnce(source.__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(source).__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})};terminate=(...args)=>{};isTypedArray=isTypedArray2;recursivelyAssign=recursivelyAssign22;spliceTypedArray=spliceTypedArray2;ping=()=>{console.log("pinged!");return"pong"};echo=(...args)=>{this.transmit(...args);return args};log=(...args)=>{console.log(...args);return true};error=(...args)=>{console.error(...args);return true}};function isTypedArray2(x3){return ArrayBuffer.isView(x3)&&Object.prototype.toString.call(x3)!=="[object DataView]"}var recursivelyAssign22=(target,obj)=>{for(const key in obj){if(obj[key]?.constructor.name==="Object"&&!Array.isArray(obj[key])){if(target[key]?.constructor.name==="Object"&&!Array.isArray(target[key]))recursivelyAssign22(target[key],obj[key]);else target[key]=recursivelyAssign22({},obj[key])}else target[key]=obj[key]}return target};function spliceTypedArray2(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let ta;if(s.length>0||e?.length>0)ta=new arr.constructor(s.length+e.length);if(ta){if(s.length>0)ta.set(s);if(e&&e.length>0)ta.set(e,s.length)}return ta}var nodeTemplates2={};var remoteGraphRoutes2={transferNode:(properties,connection,name2)=>{let str3;if(typeof properties==="object"){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}str3=recursivelyStringifyFunctions2(properties)}else if(typeof properties==="function")str3=properties.toString();else if(typeof properties==="string")str3=properties;if(str3){if(connection.run)return connection.run("setNode",[str3]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:str3},void 0);return new Promise(r=>r(name2))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:str3}));return new Promise(r=>r(name2))}}},setNode:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings2}}}if(typeof properties==="string"){let f=parseFunctionFromText2(properties);if(typeof f==="function")properties={__operator:f,__node:{tag:name2?name2:f.name}};else{f=JSON.parse(properties);if(typeof f==="object")properties=f}}if(typeof properties==="object"||typeof properties==="function"){let template={};if(typeof properties==="object")Object.assign(template,properties);else template.__operator=properties;let node=this.__node.graph.add(template);if(node){nodeTemplates2[node.__node.tag]=template;return node.__node?.tag}else return false}else return false},proxyRemoteNode:function(name2,connection){return new Promise((res,rej)=>{connection.run("getNodeProperties",name2).then(props=>{let proxy={};if(typeof props==="object"){for(const key in props){if(props[key]==="function"){proxy[key]=(...args)=>{return new Promise(r=>{connection.run(name2,args,key).then(r)})}}else{Object.defineProperty(proxy,key,{get:()=>{return new Promise(r=>{connection.run(name2,void 0,key).then(r)})},set:value=>{connection.post(name2,value,key)},configurable:true,enumerable:true})}}}res(proxy)})})},makeNodeTransferrable:function(properties,name2){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}const str3=recursivelyStringifyFunctions2(properties);return str3},setTemplate:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings2}}}if(typeof properties==="string"){let f=parseFunctionFromText2(properties);if(typeof f==="function"){if(!name2)name2=f.name;properties={__operator:f,__node:{tag:name2}}}else{f=JSON.parse(properties);if(typeof f==="object"){properties=f;if(!name2&&f.__node?.tag)name2=f.__node.tag}}}if(!name2)name2=`node${Math.floor(Math.random()*1e15)}`;if(typeof properties==="object"||typeof properties==="function"){nodeTemplates2[name2]=properties;return name2}else return false},loadFromTemplate:function(templateName,name2,properties){if(nodeTemplates2[templateName]){let cpy=recursivelyAssign22({},nodeTemplates2[templateName]);if(name2){if(!cpy.__node)cpy.__node={};cpy.__node.tag=name2}if(properties)Object.assign(cpy,properties);let node=this.__node.graph.add(cpy);return node.__node.tag}},setMethod:function(nodeTag,fn,methodKey){if(typeof fn==="string"){let f=parseFunctionFromText2(fn);if(typeof f==="function")fn=f}if(!methodKey&&typeof fn==="function")methodKey=fn.name;if(this.__node.graph.get(nodeTag)){this.__node.graph.get(nodeTag)[methodKey]=fn}else this.__node.graph.add({__node:{tag:methodKey,[methodKey]:fn}});return true},assignNode:function(nodeTag,source){if(this.__node.graph.get(nodeTag)&&typeof source==="object"){Object.assign(this.__node.graph.get(nodeTag),source)}},getNodeProperties:function(nodeTag){let node=this.__node.graph.get(nodeTag);if(node){let properties=Object.getOwnPropertyNames(node);let result={};for(const key in properties){result[key]=typeof node[key]}return result}return void 0},transferClass:(classObj,connection,className)=>{if(typeof classObj==="object"){let str3=classObj.toString();let message={route:"receiveClass",args:[str3,className]};if(connection.run)return connection.run("receiveClass",[str3,className]);else if(connection.postMessage){connection.postMessage({route:"receiveClass",args:[str3,className]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"receiveClass",args:[str3,className]}));return new Promise(r=>r(name))}return message}return false},receiveClass:function(stringified,className){if(typeof stringified==="string"){if(stringified.indexOf("class")===0){let cls=(0,eval)("("+stringified+")");let name2=className;if(!name2)name2=cls.name;this.__node.graph[name2]=cls;return true}}return false},transferFunction:(fn,connection,fnName)=>{if(!fnName)fnName=fn.name;let str3=fn.toString();let message={route:"setNode",args:[str3,fnName]};if(connection.run)return connection.run("setNode",[str3,fnName]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:[str3,fnName]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:[str3,fnName]}));return new Promise(r=>r(name))}return message},setGlobal:(key,value)=>{globalThis[key]=value;return true},assignGlobalObject:(target,source)=>{if(!globalThis[target])return false;if(typeof source==="object")Object.assign(globalThis[target],source);return true},setValue:function(key,value){this.__node.graph[key]=value;return true},assignObject:function(target,source){if(!this.__node.graph[target])return false;if(typeof source==="object")Object.assign(this.__node.graph[target],source);return true},setGlobalFunction:(fn,fnName)=>{if(typeof fn==="string")fn=parseFunctionFromText2(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;globalThis[fnName]=fn;return true}return false},setGraphFunction:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText2(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.__node.graph[fnName]=fn;return true}return false}};function html2(strings,...args){return function append(elm=document.createElement("div")){let template=document.createElement("template");strings.map(function(s,i22){template.innerHTML+=s;if(args[i22]instanceof HTMLElement){let dummy22=`<span id="dummyNode12345"></span>`;dummy22.id="dummyNode12345";template.innerHTML+=dummy22}else template.innerHTML+=args[i22]});let query=template.content.querySelectorAll("#dummyNode12345");let ctr=0;args.forEach((arg,i22)=>{if(arg instanceof HTMLElement){console.log(arg,query[ctr]);template.content.replaceChild(arg,query[ctr]);ctr++}});elm.appendChild(template.content);return elm}}var dummy2=html2``;var sjcl2={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl2.cipher.aes=function(a){this.s[0][0][0]||this.O();var b,c,d2,e,f=this.s[0][4],g=this.s[1];b=a.length;var h=1;if(4!==b&&6!==b&&8!==b)throw new sjcl2.exception.invalid("invalid aes key size");this.b=[d2=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d2[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));d2[a]=d2[a-b]^c}for(b=0;a;b++,a--)c=d2[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]]};sjcl2.cipher.aes.prototype={encrypt:function(a){return t2(this,a,0)},decrypt:function(a){return t2(this,a,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var a=this.s[0],b=this.s[1],c=a[4],d2=b[4],e,f,g,h=[],k=[],l,n,m,p2;for(e=0;256>e;e++)k[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=l||1,g=k[g]||1)for(m=g^g<<1^g<<2^g<<3^g<<4,m=m>>8^m&255^99,c[f]=m,d2[m]=f,n=h[e=h[l=h[f]]],p2=16843009*n^65537*e^257*l^16843008*f,n=257*h[m]^16843008*m,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p2=p2<<24^p2>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};function t2(a,b,c){if(4!==b.length)throw new sjcl2.exception.invalid("invalid aes block size");var d2=a.b[c],e=b[0]^d2[0],f=b[c?3:1]^d2[1],g=b[2]^d2[2];b=b[c?1:3]^d2[3];var h,k,l,n=d2.length/4-2,m,p2=4,r=[0,0,0,0];h=a.s[c];a=h[0];var q=h[1],v2=h[2],w=h[3],x3=h[4];for(m=0;m<n;m++)h=a[e>>>24]^q[f>>16&255]^v2[g>>8&255]^w[b&255]^d2[p2],k=a[f>>>24]^q[g>>16&255]^v2[b>>8&255]^w[e&255]^d2[p2+1],l=a[g>>>24]^q[b>>16&255]^v2[e>>8&255]^w[f&255]^d2[p2+2],b=a[b>>>24]^q[e>>16&255]^v2[f>>8&255]^w[g&255]^d2[p2+3],p2+=4,e=h,f=k,g=l;for(m=0;4>m;m++)r[c?3&-m:m]=x3[e>>>24]<<24^x3[f>>16&255]<<16^x3[g>>8&255]<<8^x3[b&255]^d2[p2++],h=e,e=f,f=g,g=b,b=h;return r}sjcl2.bitArray={bitSlice:function(a,b,c){a=sjcl2.bitArray.$(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl2.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d2=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d2^a[b/32+1|0]>>>d2:a[b/32|0]>>>d2)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d2=sjcl2.bitArray.getPartial(c);return 32===d2?a.concat(b):sjcl2.bitArray.$(b,d2,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl2.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b=b&31;0<c&&b&&(a[c-1]=sjcl2.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl2.bitArray.bitLength(a)!==sjcl2.bitArray.bitLength(b))return false;var c=0,d2;for(d2=0;d2<a.length;d2++)c|=a[d2]^b[d2];return 0===c},$:function(a,b,c,d2){var e;e=0;for(void 0===d2&&(d2=[]);32<=b;b-=32)d2.push(c),c=0;if(0===b)return d2.concat(a);for(e=0;e<a.length;e++)d2.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl2.bitArray.getPartial(e);d2.push(sjcl2.bitArray.partial(b+a&31,32<b+a?c:d2.pop(),1));return d2},i:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&65280|(c&65280)<<8|c<<24;return a}};sjcl2.codec.utf8String={fromBits:function(a){var b="",c=sjcl2.bitArray.bitLength(a),d2,e;for(d2=0;d2<c/8;d2++)0===(d2&3)&&(e=a[d2/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d2=0;for(c=0;c<a.length;c++)d2=d2<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d2),d2=0);c&3&&b.push(sjcl2.bitArray.partial(8*(c&3),d2));return b}};sjcl2.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl2.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d2;a=a.replace(/\\s|0x/g,"");d2=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl2.bitArray.clamp(c,4*d2)}};sjcl2.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(a,b,c){var d2=sjcl2.codec.base32.BASE,e=sjcl2.codec.base32.REMAINING,f="",g=0,h=sjcl2.codec.base32.B,k=0,l=sjcl2.bitArray.bitLength(a);c&&(h=sjcl2.codec.base32.X);for(c=0;f.length*d2<l;)f+=h.charAt((k^a[c]>>>g)>>>e),g<d2?(k=a[c]<<d2-g,g+=e,c++):(k<<=d2,g-=d2);for(;f.length&7&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\\s|=/g,"").toUpperCase();var c=sjcl2.codec.base32.BITS,d2=sjcl2.codec.base32.BASE,e=sjcl2.codec.base32.REMAINING,f=[],g,h=0,k=sjcl2.codec.base32.B,l=0,n,m="base32";b&&(k=sjcl2.codec.base32.X,m="base32hex");for(g=0;g<a.length;g++){n=k.indexOf(a.charAt(g));if(0>n){if(!b)try{return sjcl2.codec.base32hex.toBits(a)}catch(p2){}throw new sjcl2.exception.invalid("this isn\'t "+m+"!")}h>e?(h-=e,f.push(l^n>>>h),l=n<<c-h):(h+=d2,l^=n<<c-h)}h&56&&f.push(sjcl2.bitArray.partial(h&56,l,1));return f}};sjcl2.codec.base32hex={fromBits:function(a,b){return sjcl2.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl2.codec.base32.toBits(a,1)}};sjcl2.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d2="",e=0,f=sjcl2.codec.base64.B,g=0,h=sjcl2.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d2.length<h;)d2+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;d2.length&3&&!b;)d2+="=";return d2},toBits:function(a,b){a=a.replace(/\\s|=/g,"");var c=[],d2,e=0,f=sjcl2.codec.base64.B,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d2=0;d2<a.length;d2++){h=f.indexOf(a.charAt(d2));if(0>h)throw new sjcl2.exception.invalid("this isn\'t base64!");26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e)}e&56&&c.push(sjcl2.bitArray.partial(e&56,g,1));return c}};sjcl2.codec.base64url={fromBits:function(a){return sjcl2.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl2.codec.base64.toBits(a,1)}};sjcl2.hash.sha256=function(a){this.b[0]||this.O();a?(this.F=a.F.slice(0),this.A=a.A.slice(0),this.l=a.l):this.reset()};sjcl2.hash.sha256.hash=function(a){return new sjcl2.hash.sha256().update(a).finalize()};sjcl2.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(a){"string"===typeof a&&(a=sjcl2.codec.utf8String.toBits(a));var b,c=this.A=sjcl2.bitArray.concat(this.A,a);b=this.l;a=this.l=b+sjcl2.bitArray.bitLength(a);if(9007199254740991<a)throw new sjcl2.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d2=new Uint32Array(c),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u2(this,d2.subarray(16*e,16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u2(this,c.splice(0,16));return this},finalize:function(){var a,b=this.A,c=this.F,b=sjcl2.bitArray.concat(b,[sjcl2.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.l/4294967296));for(b.push(this.l|0);b.length;)u2(this,b.splice(0,16));this.reset();return c},Y:[],b:[],O:function(){function a(a2){return 4294967296*(a2-Math.floor(a2))|0}for(var b=0,c=2,d2,e;64>b;c++){e=true;for(d2=2;d2*d2<=c;d2++)if(0===c%d2){e=false;break}e&&(8>b&&(this.Y[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}};function u2(a,b){var c,d2,e,f=a.F,g=a.b,h=f[0],k=f[1],l=f[2],n=f[3],m=f[4],p2=f[5],r=f[6],q=f[7];for(c=0;64>c;c++)16>c?d2=b[c]:(d2=b[c+1&15],e=b[c+14&15],d2=b[c&15]=(d2>>>7^d2>>>18^d2>>>3^d2<<25^d2<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c&15]+b[c+9&15]|0),d2=d2+q+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(r^m&(p2^r))+g[c],q=r,r=p2,p2=m,m=n+d2|0,n=l,l=k,k=h,h=d2+(k&l^n&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+n|0;f[4]=f[4]+m|0;f[5]=f[5]+p2|0;f[6]=f[6]+r|0;f[7]=f[7]+q|0}sjcl2.mode.ccm={name:"ccm",G:[],listenProgress:function(a){sjcl2.mode.ccm.G.push(a)},unListenProgress:function(a){a=sjcl2.mode.ccm.G.indexOf(a);-1<a&&sjcl2.mode.ccm.G.splice(a,1)},fa:function(a){var b=sjcl2.mode.ccm.G.slice(),c;for(c=0;c<b.length;c+=1)b[c](a)},encrypt:function(a,b,c,d2,e){var f,g=b.slice(0),h=sjcl2.bitArray,k=h.bitLength(c)/8,l=h.bitLength(g)/8;e=e||64;d2=d2||[];if(7>k)throw new sjcl2.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&l>>>8*f;f++);f<15-k&&(f=15-k);c=h.clamp(c,8*(15-f));b=sjcl2.mode.ccm.V(a,b,c,d2,e,f);g=sjcl2.mode.ccm.C(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d2,e){e=e||64;d2=d2||[];var f=sjcl2.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/8;if(7>g)throw new sjcl2.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&h>>>8*b;b++);b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));k=sjcl2.mode.ccm.C(a,k,c,l,e,b);a=sjcl2.mode.ccm.V(a,k.data,c,d2,e,b);if(!f.equal(k.tag,a))throw new sjcl2.exception.corrupt("ccm: tag doesn\'t match");return k.data},na:function(a,b,c,d2,e,f){var g=[],h=sjcl2.bitArray,k=h.i;d2=[h.partial(8,(b.length?64:0)|d2-2<<2|f-1)];d2=h.concat(d2,c);d2[3]|=e;d2=a.encrypt(d2);if(b.length)for(c=h.bitLength(b)/8,65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,b),b=0;b<g.length;b+=4)d2=a.encrypt(k(d2,g.slice(b,b+4).concat([0,0,0])));return d2},V:function(a,b,c,d2,e,f){var g=sjcl2.bitArray,h=g.i;e/=8;if(e%2||4>e||16<e)throw new sjcl2.exception.invalid("ccm: invalid tag length");if(4294967295<d2.length||4294967295<b.length)throw new sjcl2.exception.bug("ccm: can\'t deal with 4GiB or more data");c=sjcl2.mode.ccm.na(a,d2,c,e,g.bitLength(b)/8,f);for(d2=0;d2<b.length;d2+=4)c=a.encrypt(h(c,b.slice(d2,d2+4).concat([0,0,0])));return g.clamp(c,8*e)},C:function(a,b,c,d2,e,f){var g,h=sjcl2.bitArray;g=h.i;var k=b.length,l=h.bitLength(b),n=k/50,m=n;c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d2=h.bitSlice(g(d2,a.encrypt(c)),0,e);if(!k)return{tag:d2,data:[]};for(g=0;g<k;g+=4)g>n&&(sjcl2.mode.ccm.fa(g/k),n+=m),c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d2,data:h.clamp(b,l)}}};sjcl2.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d2,e,f){if(128!==sjcl2.bitArray.bitLength(c))throw new sjcl2.exception.invalid("ocb iv must be 128 bits");var g,h=sjcl2.mode.ocb2.S,k=sjcl2.bitArray,l=k.i,n=[0,0,0,0];c=h(a.encrypt(c));var m,p2=[];d2=d2||[];e=e||64;for(g=0;g+4<b.length;g+=4)m=b.slice(g,g+4),n=l(n,m),p2=p2.concat(l(c,a.encrypt(l(c,m)))),c=h(c);m=b.slice(g);b=k.bitLength(m);g=a.encrypt(l(c,[0,0,0,b]));m=k.clamp(l(m.concat([0,0,0]),g),b);n=l(n,l(m.concat([0,0,0]),g));n=a.encrypt(l(n,l(c,h(c))));d2.length&&(n=l(n,f?d2:sjcl2.mode.ocb2.pmac(a,d2)));return p2.concat(k.concat(m,k.clamp(n,e)))},decrypt:function(a,b,c,d2,e,f){if(128!==sjcl2.bitArray.bitLength(c))throw new sjcl2.exception.invalid("ocb iv must be 128 bits");e=e||64;var g=sjcl2.mode.ocb2.S,h=sjcl2.bitArray,k=h.i,l=[0,0,0,0],n=g(a.encrypt(c)),m,p2,r=sjcl2.bitArray.bitLength(b)-e,q=[];d2=d2||[];for(c=0;c+4<r/32;c+=4)m=k(n,a.decrypt(k(n,b.slice(c,c+4)))),l=k(l,m),q=q.concat(m),n=g(n);p2=r-32*c;m=a.encrypt(k(n,[0,0,0,p2]));m=k(m,h.clamp(b.slice(c),p2).concat([0,0,0]));l=k(l,m);l=a.encrypt(k(l,k(n,g(n))));d2.length&&(l=k(l,f?d2:sjcl2.mode.ocb2.pmac(a,d2)));if(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))throw new sjcl2.exception.corrupt("ocb: tag doesn\'t match");return q.concat(h.clamp(m,p2))},pmac:function(a,b){var c,d2=sjcl2.mode.ocb2.S,e=sjcl2.bitArray,f=e.i,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d2(d2(h)));for(c=0;c+4<b.length;c+=4)h=d2(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d2(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d2(f(h,d2(h))),g))},S:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};sjcl2.mode.gcm={name:"gcm",encrypt:function(a,b,c,d2,e){var f=b.slice(0);b=sjcl2.bitArray;d2=d2||[];a=sjcl2.mode.gcm.C(true,a,f,d2,c,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c,d2,e){var f=b.slice(0),g=sjcl2.bitArray,h=g.bitLength(f);e=e||128;d2=d2||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl2.mode.gcm.C(false,a,f,d2,c,e);if(!g.equal(a.tag,b))throw new sjcl2.exception.corrupt("gcm: tag doesn\'t match");return a.data},ka:function(a,b){var c,d2,e,f,g,h=sjcl2.bitArray.i;e=[0,0,0,0];f=b.slice(0);for(c=0;128>c;c++){(d2=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d2=3;0<d2;d2--)f[d2]=f[d2]>>>1|(f[d2-1]&1)<<31;f[0]>>>=1;g&&(f[0]^=-520093696)}return e},j:function(a,b,c){var d2,e=c.length;b=b.slice(0);for(d2=0;d2<e;d2+=4)b[0]^=4294967295&c[d2],b[1]^=4294967295&c[d2+1],b[2]^=4294967295&c[d2+2],b[3]^=4294967295&c[d2+3],b=sjcl2.mode.gcm.ka(b,a);return b},C:function(a,b,c,d2,e,f){var g,h,k,l,n,m,p2,r,q=sjcl2.bitArray;m=c.length;p2=q.bitLength(c);r=q.bitLength(d2);h=q.bitLength(e);g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=q.concat(e,[1])):(e=sjcl2.mode.gcm.j(g,[0,0,0,0],e),e=sjcl2.mode.gcm.j(g,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl2.mode.gcm.j(g,[0,0,0,0],d2);n=e.slice(0);d2=h.slice(0);a||(d2=sjcl2.mode.gcm.j(g,h,c));for(l=0;l<m;l+=4)n[3]++,k=b.encrypt(n),c[l]^=k[0],c[l+1]^=k[1],c[l+2]^=k[2],c[l+3]^=k[3];c=q.clamp(c,p2);a&&(d2=sjcl2.mode.gcm.j(g,h,c));a=[Math.floor(r/4294967296),r&4294967295,Math.floor(p2/4294967296),p2&4294967295];d2=sjcl2.mode.gcm.j(g,d2,a);k=b.encrypt(e);d2[0]^=k[0];d2[1]^=k[1];d2[2]^=k[2];d2[3]^=k[3];return{tag:q.bitSlice(d2,0,f),data:c}}};sjcl2.misc.hmac=function(a,b){this.W=b=b||sjcl2.hash.sha256;var c=[[],[]],d2,e=b.prototype.blockSize/32;this.w=[new b,new b];a.length>e&&(a=b.hash(a));for(d2=0;d2<e;d2++)c[0][d2]=a[d2]^909522486,c[1][d2]=a[d2]^1549556828;this.w[0].update(c[0]);this.w[1].update(c[1]);this.R=new b(this.w[0])};sjcl2.misc.hmac.prototype.encrypt=sjcl2.misc.hmac.prototype.mac=function(a){if(this.aa)throw new sjcl2.exception.invalid("encrypt on already updated hmac called!");this.update(a);return this.digest(a)};sjcl2.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=false};sjcl2.misc.hmac.prototype.update=function(a){this.aa=true;this.R.update(a)};sjcl2.misc.hmac.prototype.digest=function(){var a=this.R.finalize(),a=new this.W(this.w[1]).update(a).finalize();this.reset();return a};sjcl2.misc.pbkdf2=function(a,b,c,d2,e){c=c||1e4;if(0>d2||0>c)throw new sjcl2.exception.invalid("invalid params to pbkdf2");"string"===typeof a&&(a=sjcl2.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl2.codec.utf8String.toBits(b));e=e||sjcl2.misc.hmac;a=new e(a);var f,g,h,k,l=[],n=sjcl2.bitArray;for(k=1;32*l.length<(d2||1);k++){e=f=a.encrypt(n.concat(b,[k]));for(g=1;g<c;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];l=l.concat(e)}d2&&(l=n.clamp(l,d2));return l};sjcl2.prng=function(a){this.c=[new sjcl2.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=a;this.D=false;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=3e4;this.ba=80};sjcl2.prng.prototype={randomWords:function(a,b){var c=[],d2;d2=this.isReady(b);var e;if(d2===this.u)throw new sjcl2.exception.notReady("generator isn\'t seeded");if(d2&this.J){d2=!(d2&this.I);e=[];var f=0,g;this.Z=e[0]=new Date().valueOf()+this.da;for(g=0;16>g;g++)e.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.m[g],this.m[g]=0,d2||!(this.P&1<<g));g++);this.P>=1<<this.c.length&&(this.c.push(new sjcl2.hash.sha256),this.m.push(0));this.f-=f;f>this.o&&(this.o=f);this.P++;this.b=sjcl2.hash.sha256.hash(this.b.concat(e));this.L=new sjcl2.cipher.aes(this.b);for(d2=0;4>d2&&(this.h[d2]=this.h[d2]+1|0,!this.h[d2]);d2++);}for(d2=0;d2<a;d2+=4)0===(d2+1)%this.ca&&y3(this),e=z2(this),c.push(e[0],e[1],e[2],e[3]);y3(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl2.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=a},addEntropy:function(a,b,c){c=c||"user";var d2,e,f=new Date().valueOf(),g=this.H[c],h=this.isReady(),k=0;d2=this.U[c];void 0===d2&&(d2=this.U[c]=this.ha++);void 0===g&&(g=this.H[c]=0);this.H[c]=(this.H[c]+1)%this.c.length;switch(typeof a){case"number":void 0===b&&(b=1);this.c[g].update([d2,this.N++,1,b,f,1,a|0]);break;case"object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(k=1),c=0;c<a.length&&!k;c++)"number"!==typeof a[c]&&(k=1);if(!k){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e=e>>>1;this.c[g].update([d2,this.N++,2,b,f,a.length].concat(a))}break;case"string":void 0===b&&(b=a.length);this.c[g].update([d2,this.N++,3,b,f,a.length]);this.c[g].update(a);break;default:k=1}if(k)throw new sjcl2.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[g]+=b;this.f+=b;h===this.u&&(this.isReady()!==this.u&&A3("seeded",Math.max(this.o,this.f)),A3("progress",this.getProgress()))},isReady:function(a){a=this.T[void 0!==a?a:this.M];return this.o&&this.o>=a?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=a?this.J|this.u:this.u},getProgress:function(a){a=this.T[a?a:this.M];return this.o>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B2(this,this.ma),mouseCollector:B2(this,this.oa),keyboardCollector:B2(this,this.la),accelerometerCollector:B2(this,this.ea),touchCollector:B2(this,this.qa)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,false),window.addEventListener("mousemove",this.a.mouseCollector,false),window.addEventListener("keypress",this.a.keyboardCollector,false),window.addEventListener("devicemotion",this.a.accelerometerCollector,false),window.addEventListener("touchmove",this.a.touchCollector,false);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl2.exception.bug("can\'t attach event");this.D=true}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,false),window.removeEventListener("mousemove",this.a.mouseCollector,false),window.removeEventListener("keypress",this.a.keyboardCollector,false),window.removeEventListener("devicemotion",this.a.accelerometerCollector,false),window.removeEventListener("touchmove",this.a.touchCollector,false)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=false)},addEventListener:function(a,b){this.K[a][this.ga++]=b},removeEventListener:function(a,b){var c,d2,e=this.K[a],f=[];for(d2 in e)e.hasOwnProperty(d2)&&e[d2]===b&&f.push(d2);for(c=0;c<f.length;c++)d2=f[c],delete e[d2]},la:function(){C3(this,1)},oa:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d2){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,"mouse");C3(this,0)},qa:function(a){a=a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C3(this,0)},ma:function(){C3(this,2)},ea:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C3(this,0)}};function A3(a,b){var c,d2=sjcl2.random.K[a],e=[];for(c in d2)d2.hasOwnProperty(c)&&e.push(d2[c]);for(c=0;c<e.length;c++)e[c](b)}function C3(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy(new Date().valueOf(),b,"loadtime")}function y3(a){a.b=z2(a).concat(z2(a));a.L=new sjcl2.cipher.aes(a.b)}function z2(a){for(var b=0;4>b&&(a.h[b]=a.h[b]+1|0,!a.h[b]);b++);return a.L.encrypt(a.h)}function B2(a,b){return function(){b.apply(a,arguments)}}sjcl2.random=new sjcl2.prng(6);a:try{if(G2="undefined"!==typeof module&&module.exports){try{H2=__require22("crypto")}catch(a){H2=null}G2=E2=H2}if(G2&&E2.randomBytes)D2=E2.randomBytes(128),D2=new Uint32Array(new Uint8Array(D2).buffer),sjcl2.random.addEntropy(D2,1024,"crypto[\'randomBytes\']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F3=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F3);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F3);else break a;sjcl2.random.addEntropy(F3,1024,"crypto[\'getRandomValues\']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}var D2;var E2;var F3;var G2;var H2;sjcl2.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(a,b,c,d2){c=c||{};d2=d2||{};var e=sjcl2.json,f=e.g({iv:sjcl2.random.randomWords(4,0)},e.defaults),g;e.g(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl2.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl2.codec.base64.toBits(f.iv));if(!sjcl2.mode[f.mode]||!sjcl2.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)throw new sjcl2.exception.invalid("json encrypt: invalid parameters");"string"===typeof a?(g=sjcl2.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl2.ecc&&a instanceof sjcl2.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl2.codec.utf8String.toBits(b));"string"===typeof c&&(f.adata=c=sjcl2.codec.utf8String.toBits(c));g=new sjcl2.cipher[f.cipher](a);e.g(d2,f);d2.key=a;f.ct="ccm"===f.mode&&sjcl2.arrayBuffer&&sjcl2.arrayBuffer.ccm&&b instanceof ArrayBuffer?sjcl2.arrayBuffer.ccm.encrypt(g,b,f.iv,c,f.ts):sjcl2.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f},encrypt:function(a,b,c,d2){var e=sjcl2.json,f=e.ja.apply(e,arguments);return e.encode(f)},ia:function(a,b,c,d2){c=c||{};d2=d2||{};var e=sjcl2.json;b=e.g(e.g(e.g({},e.defaults),b),c,true);var f,g;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl2.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl2.codec.base64.toBits(b.iv));if(!sjcl2.mode[b.mode]||!sjcl2.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjcl2.exception.invalid("json decrypt: invalid parameters");"string"===typeof a?(g=sjcl2.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):sjcl2.ecc&&a instanceof sjcl2.ecc.elGamal.secretKey&&(a=a.unkem(sjcl2.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl2.codec.utf8String.toBits(f));g=new sjcl2.cipher[b.cipher](a);f="ccm"===b.mode&&sjcl2.arrayBuffer&&sjcl2.arrayBuffer.ccm&&b.ct instanceof ArrayBuffer?sjcl2.arrayBuffer.ccm.decrypt(g,b.ct,b.iv,b.tag,f,b.ts):sjcl2.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.g(d2,b);d2.key=a;return 1===c.raw?f:sjcl2.codec.utf8String.fromBits(f)},decrypt:function(a,b,c,d2){var e=sjcl2.json;return e.ia(a,e.decode(b),c,d2)},encode:function(a){var b,c="{",d2="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl2.exception.invalid("json encode: invalid property name");c+=d2+\'"\'+b+\'":\';d2=",";switch(typeof a[b]){case"number":case"boolean":c+=a[b];break;case"string":c+=\'"\'+escape(a[b])+\'"\';break;case"object":c+=\'"\'+sjcl2.codec.base64.fromBits(a[b],0)+\'"\';break;default:throw new sjcl2.exception.bug("json encode: unsupported type")}}return c+"}"},decode:function(a){a=a.replace(/\\s/g,"");if(!a.match(/^\\{.*\\}$/))throw new sjcl2.exception.invalid("json decode: this isn\'t json!");a=a.replace(/^\\{|\\}$/g,"").split(/,/);var b={},c,d2;for(c=0;c<a.length;c++){if(!(d2=a[c].match(/^\\s*(?:(["\']?)([a-z][a-z0-9]*)\\1)\\s*:\\s*(?:(-?\\d+)|"([a-z0-9+\\/%*_.@=\\-]*)"|(true|false))$/i)))throw new sjcl2.exception.invalid("json decode: this isn\'t json!");null!=d2[3]?b[d2[2]]=parseInt(d2[3],10):null!=d2[4]?b[d2[2]]=d2[2].match(/^(ct|adata|salt|iv)$/)?sjcl2.codec.base64.toBits(d2[4]):unescape(d2[4]):null!=d2[5]&&(b[d2[2]]="true"===d2[5])}return b},g:function(a,b,c){void 0===a&&(a={});if(void 0===b)return a;for(var d2 in b)if(b.hasOwnProperty(d2)){if(c&&void 0!==a[d2]&&a[d2]!==b[d2])throw new sjcl2.exception.invalid("required parameter overridden");a[d2]=b[d2]}return a},sa:function(a,b){var c={},d2;for(d2 in a)a.hasOwnProperty(d2)&&a[d2]!==b[d2]&&(c[d2]=a[d2]);return c},ra:function(a,b){var c={},d2;for(d2=0;d2<b.length;d2++)void 0!==a[b[d2]]&&(c[b[d2]]=a[b[d2]]);return c}};sjcl2.encrypt=sjcl2.json.encrypt;sjcl2.decrypt=sjcl2.json.decrypt;sjcl2.misc.pa={};sjcl2.misc.cachedPbkdf2=function(a,b){var c=sjcl2.misc.pa,d2;b=b||{};d2=b.iter||1e3;c=c[a]=c[a]||{};d2=c[d2]=c[d2]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl2.random.randomWords(2,0)};c=void 0===b.salt?d2.firstSalt:b.salt;d2[c]=d2[c]||sjcl2.misc.pbkdf2(a,c,b.iter);return{key:d2[c].slice(0),salt:c.slice(0)}};var _HTTPfrontend2=class extends Service2{name="http";fetchProxied=false;listening={};constructor(options,path,fetched){super(options);this.load(this);this.listen(path,fetched)}GET=(url2="http://localhost:8080/ping",type="",mimeType)=>{if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend2.request({method:"GET",url:url2,responseType:type,mimeType,onload:ev2=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url2 instanceof URL)url2=url2.toString();this.setState({[url2]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};POST=(message,url2="http://localhost:8080/echo",type="",mimeType)=>{if(typeof message==="object"&&(type==="json"||type==="text"||!type)){message=JSON.stringify(message)}if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend2.request({method:"POST",url:url2,data:message,responseType:type,mimeType,onload:ev2=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url2 instanceof URL)url2=url2.toString();this.setState({[url2]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};transmit=(message,url2)=>{let obj=message;if(typeof obj==="object"){message=JSON.stringify(obj)}if(obj?.method?.toLowerCase()=="get"||message?.toLowerCase()==="get")return this.GET(url2);return this.POST(message,url2)};transponder=(url2,message,type="",mimeType)=>{if(typeof message==="object")message=JSON.stringify(message);let method="GET";if(message){method="POST"}if(type==="json")mimeType="application/json";else return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend2.request({method,url:url2,data:message,responseType:type,onload:ev2=>{let body=xhr.response;if(typeof body==="string"){let substr=body.substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\"))body=body.replace(/\\\\/g,"");if(body[0]===\'"\'){body=body.substring(1,body.length-1)};body=JSON.parse(body)}}if(typeof body?.method==="string"){return resolve(this.handleMethod(body.route,body.method,body.args))}else if(typeof body?.route==="string"){return resolve(this.handleServiceMessage(body))}else if(typeof body?.node==="string"||body.node instanceof GraphNode2){return resolve(this.handleGraphNodeCall(body.node,body.args))}else return resolve(body)},onabort:er=>{reject(er)}})}).catch(console.error)};listen=(path="0",fetched=async(clone,args,response)=>{const result=await clone.text();const returned=this.receive(result);this.setState({[response.url]:returned})})=>{this.listening[path]={};let listenerId=`${path}${Math.floor(Math.random()*1e15)}`;this.listening[path][listenerId]=fetched;if(!this.fetchProxied){globalThis.fetch=new Proxy(globalThis.fetch,{apply(fetch2,that,args){const result=fetch2.apply(that,args);result.then(response=>{if(!response.ok)return;if(this.listening["0"]){for(const key in this.listeners){const clone=response.clone();this.listening["0"][key](clone,args,response)}}else{for(const key in this.listening){if(response.url.includes(key)){for(const key2 in this.listening[path]){const clone=response.clone();this.listening[path][key2](clone,args,response)}break}}}}).catch(er=>{console.error(er)});return result}});this.fetchProxied=true}return listenerId};stopListening=(path,listener)=>{if(!path&&path!==0){for(const key in this.listening)delete this.listening[key]}else{if(!listener)delete this.listening[path];else delete this.listening[listener]}}};var HTTPfrontend2=_HTTPfrontend2;__publicField3(HTTPfrontend2,"request",options=>{const xhr=new XMLHttpRequest;if(options.responseType)xhr.responseType=options.responseType;else options.responseType="json";if(options.mimeType){xhr.overrideMimeType(options.mimeType)}if(options.onload)xhr.addEventListener("load",options.onload,false);if(options.onprogress)xhr.addEventListener("progress",options.onprogress,false);if(options.onabort)xhr.addEventListener("abort",options.onabort,false);if(options.onloadend)xhr.addEventListener("loadend",options.onloadend,false);if(options.onerror)xhr.addEventListener("error",options.onerror,false);xhr.open(options.method,options.url,true,options.user,options.pass);if(!options.onerror)xhr.onerror=function(){xhr.abort()};xhr.send(options.data);return xhr});var import_web_worker2=__toESM3(require_browser2());var WorkerService2=class extends Service2{name="worker";workers={};threadRot=0;connections;constructor(options){super();this.connections={workers:this.workers};if(options?.services)this.addServices(options.services);this.load(this);this.setLoaders(this.workerloader);if(options)this.init(options);if(typeof WorkerGlobalScope!=="undefined"&&globalThis instanceof WorkerGlobalScope){this.addDefaultMessageListener()}}loadWorkerRoute=(rt,routeKey)=>{if(rt.workerUrl)rt.url=rt.workerUrl;if(rt.workerId)rt.__node.tag=rt.workerId;if(!rt.__node.tag)rt.__node.tag=routeKey;rt._id=rt.__node.tag;let worker;if(this.workers[rt._id])worker=this.workers[rt._id];else if(rt.worker)worker=rt.worker;if(!worker){worker=this.addWorker(rt)}rt.worker=worker;if(!rt.worker.__ondisconnected){let ondelete=rt2=>{rt2.worker?.terminate()};rt.__addOndisconnected(ondelete)}if(rt.transferFunctions){for(const prop in rt.transferFunctions){this.transferFunction(worker,rt.transferFunctions[prop],prop)}}if(rt.transferClasses){for(const prop in rt.transferClasses){this.transferClass(worker,rt.transferClasses[prop],prop)}}if(worker){if(!rt.__operator){rt.__operator=(...args)=>{if(rt.callback){if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.post(rt.callback,args);else return worker.run(rt.callback,args)}else{if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.send(args);else return worker.request(args)}}}if(rt.init){worker.run(rt.init,rt.initArgs,void 0,rt.initTransfer)}return worker}};workerloader={"workers":(node,parent,graph,roots)=>{let rt=node;if(!node.parentRoute&&(parent?.callback&&parent?.worker))node.parentRoute=parent?.callback;if(rt?.worker||rt?.workerId||rt?.workerUrl){let worker=this.loadWorkerRoute(rt,rt.__node.tag);if(worker){if(!rt.parentRoute&&rt.__parent?.callback)rt.parentRoute=rt.__parent.callback;if(rt.__parent&&!rt.portId){if(typeof rt.__parent==="string"){if(rt.__node.tag!==rt.__parent&&worker._id!==rt.__parent)rt.portId=this.establishMessageChannel(worker,rt.__parent)}else if(rt.__node.tag!==rt.__parent?.__node?.tag&&worker._id!==rt.__parent?.tag){rt.portId=this.establishMessageChannel(worker,rt.__parent.worker)}};if(rt.parentRoute){if(!rt.stopped){if(typeof rt.__parent==="string"&&rt.__parent===worker._id){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else if(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.parentRoute,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id)&&!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent){if(typeof rt.__parent==="string"){if(!rt.stopped){if(rt.__parent===worker._id){worker.run("subscribe",[rt.__parent,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id))worker.workerSubs[rt.__parent+rt.portId]={sub:null,route:worker._id,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent?.__node?.tag&&rt.__parent?.worker){if(!rt.stopped){if(rt.__node.tag===rt.__parent.__node.tag||worker._id===rt.__parent.__node.tag){worker.run("subscribe",[rt.__parent.__node.tag,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent.__node.tag,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent.__node.tag+rt.portId].sub=sub})}if(!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.__parent.__node.tag+rt.portId]={sub:null,route:rt.__parent.__node.tag,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}}}}else if(rt.__parent&&rt.parentRoute){if(typeof rt.__parent==="string"&&roots[rt.__parent]?.worker){roots[rt.__parent].worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}else if(rt.__parent?.worker){rt.__parent.worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}}return rt}};addDefaultMessageListener=()=>{globalThis.onmessage=ev2=>{let result=this.receive(ev2.data);if(this.__node.keepState)this.setState({[this.name]:result})}};postMessage=(message,target,transfer)=>{if(this.workers[target]){this.workers[target].send(message,transfer)}else{globalThis.postMessage(message,target,transfer)}};addWorker=options=>{let worker;if(!options._id)options._id=`worker${Math.floor(Math.random()*1e15)}`;if(options.url)worker=new import_web_worker2.default(options.url);else if(options.port){worker=options.port}else if(this.workers[options._id]){if(this.workers[options._id].port)worker=this.workers[options._id].port;else worker=this.workers[options._id].worker}if(!worker)return;let send=(message,transfer)=>{return this.transmit(message,worker,transfer)};let post=(route,args,method,transfer)=>{let message={route,args};if(method)message.method=method;return this.transmit(message,worker,transfer)};let run=(route,args,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[{route,args},options._id,callbackId]};if(method)req.args[0].method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let request=(message,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,options._id,callbackId]};if(method)req.method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let workerSubs={};let subscribe=(route,callback,args,key,subInput,blocking)=>{return this.subscribeToWorker(route,options._id,callback,args,key,subInput,blocking)};let unsubscribe=(route,sub)=>{return run("unsubscribe",[route,sub])};let start=async(route,portId,callback,blocking)=>{if(route)await run("subscribeToWorker",[route,portId,void 0,callback,blocking]).then(sub=>{if(sub)workerSubs[route+portId]={sub,route,portId,callback,blocking}});else for(const key in workerSubs){if(typeof workerSubs[key].sub!=="number")await run("subscribeToWorker",[workerSubs[key].route,workerSubs[key].portId,void 0,workerSubs[key].callback,void 0,workerSubs[key].blocking]).then(sub=>{workerSubs[key].sub=sub});console.log(JSON.stringify(workerSubs))}return true};let stop=async(route,portId)=>{if(route&&portId&&workerSubs[route+portId]){await run("unsubscribe",[route,workerSubs[route+portId].sub]);workerSubs[route+portId].sub=false}else{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){await run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub]).then(console.log)}workerSubs[key].sub=false}}return true};let terminate=()=>{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub])}workerSubs[key].sub=false}return this.terminate(options._id)};if(!options.onmessage)options.onmessage=ev2=>{this.receive(ev2.data);this.setState({[options._id]:ev2.data})};if(!options.onerror){options.onerror=ev2=>{console.error(ev2.data)}}worker.onmessage=options.onmessage;worker.onerror=options.onerror;this.workers[options._id]={worker,send,post,run,request,subscribe,unsubscribe,terminate,start,stop,postMessage:worker.postMessage,workerSubs,graph:this,...options};return this.workers[options._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=scriptTemplate=>{let blob=new Blob([scriptTemplate],{type:"text/javascript"});return URL.createObjectURL(blob)};getTransferable(message){let transfer;if(typeof message==="object"){if(message.args){if(message.args?.constructor?.name==="Object"){for(const key in message.args){if(ArrayBuffer.isView(message.args[key])){if(!transfer)transfer=[message.args[key].buffer];else transfer.push(message.args[key].buffer)}else if(message.args[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message.args[key]];else transfer.push(message.args[key])}}}else if(Array.isArray(message.args)&&message.args.length<11){message.args.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg?.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message.args)){transfer=[message.args.buffer]}else if(message.args?.constructor?.name==="ArrayBuffer"){transfer=[message]}}else if(message?.constructor?.name==="Object"){for(const key in message){if(ArrayBuffer.isView(message[key])){if(!transfer)transfer=[message[key].buffer];else transfer.push(message[key].buffer)}else if(message[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message[key]];else transfer.push(message[key])}}}else if(Array.isArray(message)&&message.length<11){message.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message)){transfer=[message.buffer]}else if(message.constructor?.name==="ArrayBuffer"){transfer=[message]}}return transfer}transmit=(message,worker,transfer)=>{if(!transfer){transfer=this.getTransferable(message)}if(worker instanceof import_web_worker2.default||worker instanceof MessagePort){worker.postMessage(message,transfer)}else if(typeof worker==="string"){if(this.workers[worker]){if(this.workers[worker].port)this.workers[worker].port.postMessage(message,transfer);else if(this.workers[worker].worker)this.workers[worker].worker.postMessage(message,transfer)}}else{let keys22=Object.keys(this.workers);this.workers[keys22[this.threadRot]].worker.postMessage(message,transfer);this.threadRot++;if(this.threadRot===keys22.length)this.threadRot=0}return message};terminate=worker=>{let onclose;if(typeof worker==="string"){let obj=this.workers[worker];if(obj){delete this.workers[worker];worker=obj.worker;if(obj.onclose)onclose=obj.onclose}}else if(typeof worker==="object"){if(worker?._id){worker=worker.worker;delete this.workers[worker?._id]}}if(worker instanceof import_web_worker2.default){worker.terminate();if(onclose)onclose(worker);return true}if(worker instanceof MessagePort){worker.close();if(onclose)onclose(worker);return true}return false};establishMessageChannel=(worker,worker2)=>{let workerId;if(typeof worker==="string"){workerId=worker;if(this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker2=this.workers[worker].worker}}else if(worker?.worker){worker=worker.worker}if(typeof worker2==="string"){if(this.workers[worker2]){if(this.workers[worker2].port)worker2=this.workers[worker2].port;else worker2=this.workers[worker2].worker}}else if(worker2?.worker){worker2=worker2.worker}if(worker instanceof import_web_worker2.default||worker instanceof MessagePort){let channel=new MessageChannel;let portId=`port${Math.floor(Math.random()*1e15)}`;worker.postMessage({route:"addWorker",args:{port:channel.port1,_id:portId}},[channel.port1]);if(worker2 instanceof import_web_worker2.default||worker2 instanceof MessagePort){worker2.postMessage({route:"addWorker",args:{port:channel.port2,_id:portId}},[channel.port2])}else if(workerId&&this.workers[workerId]){channel.port2.onmessage=this.workers[workerId].onmessage;this.workers[workerId].port=channel.port2}return portId}return false};request=(message,workerId,transfer,method)=>{let worker=this.workers[workerId].worker;return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,callbackId]};if(method)req.method=method;let onmessage=ev2=>{if(typeof ev2.data==="object"){if(ev2.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev2.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};runRequest=(message,worker,callbackId)=>{let res=this.receive(message);if(typeof worker==="string"&&this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}if(res instanceof Promise){res.then(r=>{if(worker instanceof import_web_worker2.default||worker instanceof MessagePort)worker.postMessage({args:r,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:r,callbackId})})}else{if(worker instanceof import_web_worker2.default||worker instanceof MessagePort)worker.postMessage({args:res,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:res,callbackId})}return res};subscribeWorker=(route,worker,args,key,subInput,blocking)=>{let callback;if(blocking){let blocked=false;callback=res=>{if(!blocked){blocked=true;if(res instanceof Promise){res.then(r=>{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,r]).then(ret=>{blocked=false})})}else{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,res]).then(ret=>{blocked=false})}}}}else{callback=res=>{if(res instanceof Promise){res.then(r=>{if(worker?.postMessage)worker.postMessage({args:r,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:r,callbackId:route})})}else{if(worker?.postMessage)worker.postMessage({args:res,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:res,callbackId:route})}}}if(!blocking&&worker?.port){worker=worker.port}else if(!blocking&&worker?.worker){worker=worker.worker}else if(typeof worker==="string"&&this.workers[worker]){if(blocking)worker=this.workers[worker];else if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}return this.subscribe(route,callback,args,key,subInput)};subscribeToWorker=(route,workerId,callback,args,key,subInput,blocking)=>{if(typeof workerId==="string"&&this.workers[workerId]){this.__node.state.subscribeEvent(workerId,res=>{if(res?.callbackId===route){if(!callback)this.setState({[workerId]:res.args});else if(typeof callback==="string"){this.run(callback,res.args)}else callback(res.args)}});return this.workers[workerId].run("subscribeWorker",[route,workerId,args,key,subInput,blocking])}};triggerSubscription=async(route,workerId,result)=>{if(this.__node.state.triggers[workerId])for(let i22=0;i22<this.__node.state.triggers[workerId].length;i22++){await this.__node.state.triggers[workerId][i22].onchange({args:result,callbackId:route})}return true};pipeWorkers=(sourceWorker,listenerWorker,sourceRoute,listenerRoute,portId,args,key,subInput,blocking)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof listenerWorker==="string")listenerWorker=this.workers[listenerWorker];if(!portId){portId=this.establishMessageChannel(sourceWorker.worker,listenerWorker.worker)}return listenerWorker.run("subscribeToWorker",[sourceRoute,portId,listenerRoute,args,key,subInput,blocking])};unpipeWorkers=(sourceRoute,sourceWorker,sub)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof sourceWorker==="object"){return sourceWorker.run("unsubscribe",[sourceRoute,sub])}}};var mouseEventHandler2=makeSendPropertiesHandler2(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]);var wheelEventHandlerImpl2=makeSendPropertiesHandler2(["deltaX","deltaY"]);var keydownEventHandler2=makeSendPropertiesHandler2(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function focusEventHandler2(event,sendFn){const data={type:event.type};data.isTrusted=event.isTrusted;data.bubbles=event.bubbles;data.cancelBubble=event.cancelBubble;data.cancelable=event.cancelable;data.composed=event.composed;data.defaultPrevent=event.defaultPrevented;data.eventPhase=event.eventPhase;data.returnValue=event.returnValue;data.currentTarget=event.currentTarget.id?event.currentTarget.id:event.currentTarget.constructor.name;data.target=data.currentTarget;data.srcElement=data.currentTarget;sendFn(data)}function wheelEventHandler2(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();wheelEventHandlerImpl2(event,sendFn)}function preventDefaultHandler2(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault()}function copyProperties2(src,properties,dst){for(const name2 of properties){dst[name2]=src[name2]}}function makeSendPropertiesHandler2(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties2(event,properties,data);sendFn(data)}}function touchEventHandler2(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();const touches=[];const data={type:event.type,touches};for(let i22=0;i22<event.touches.length;++i22){const touch=event.touches[i22];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var i2=1;var keys2={};while(i2<222){keys2[i2]=true;i2++}function filteredKeydownEventHandler2(event,sendFn,preventDefault){let{keyCode}=event;if(keys2[keyCode]){if(preventDefault&&event.preventDefault&&(keyCode<110||keyCode>123))event.preventDefault();keydownEventHandler2(event,sendFn)}}var eventHandlers2={contextmenu:preventDefaultHandler2,mousedown:mouseEventHandler2,mousemove:mouseEventHandler2,mouseup:mouseEventHandler2,pointerdown:mouseEventHandler2,pointermove:mouseEventHandler2,pointerup:mouseEventHandler2,pointerlockchange:mouseEventHandler2,webkitpointerlockchange:mouseEventHandler2,focus:focusEventHandler2,blur:focusEventHandler2,pointerout:mouseEventHandler2,touchstart:touchEventHandler2,touchmove:touchEventHandler2,touchend:touchEventHandler2,wheel:wheelEventHandler2,keydown:filteredKeydownEventHandler2,keyup:filteredKeydownEventHandler2};function initProxyElement2(element,worker,id,preventDefault){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{if(!worker){handleProxyEvent2(data,id)}else worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers2);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent,preventDefault)})}if(eventHandlers2.keydown){globalThis.addEventListener("keydown",function(ev2){eventHandlers2.keydown(ev2,sendEvent,preventDefault)})}if(eventHandlers2.keyup){globalThis.addEventListener("keyup",function(ev2){eventHandlers2.keyup(ev2,sendEvent,preventDefault)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher2=class{__listeners;addEventListener(type,listener){if(this.__listeners===void 0)this.__listeners={};const listeners=this.__listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this.__listeners===void 0)return false;const listeners=this.__listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i22=0,l=array.length;i22<l;i22++){array[i22].call(this,event)}}}};function noop2(){}var ElementProxyReceiver2=class extends EventDispatcher2{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super();this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.style.width=this.width+"px";this.proxied.style.height=this.height+"px";this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop2;data.stopPropagation=noop2;this.dispatchEvent(data,this.proxied)};focus(){}blur(){}};var ProxyManager2=class{targets={};constructor(){if(!globalThis.document)globalThis.document={elementFromPoint:(...args)=>{return this.targets[Object.keys(this.targets)[0]].proxied}}}makeProxy=(id,addTo=void 0)=>{if(!id)id=`proxyReceiver${Math.floor(Math.random()*1e15)}`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver2;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;if(typeof WorkerGlobalScope!=="undefined")addTo.style=proxy.style;if(proxy.width){addTo.style.width=proxy.width+"px";addTo.clientWidth=proxy.width}if(proxy.height){addTo.style.height=proxy.height+"px";addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy);addTo.blur=proxy.blur.bind(proxy)}};getProxy=id=>{return this.targets[id]};handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0}};function makeProxy2(id,elm){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager2;this.__node.graph.ProxyManager.makeProxy(id,elm)}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager2;globalThis.ProxyManager.makeProxy(id,elm)}return id}function handleProxyEvent2(data,id){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager2;if(this.__node.graph.ProxyManager.handleEvent(data,id))return data}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager2;if(globalThis.ProxyManager.handleEvent(data,id))return data}}var proxyElementWorkerRoutes2={initProxyElement:initProxyElement2,makeProxy:makeProxy2,handleProxyEvent:handleProxyEvent2};function Renderer2(options){if(options.worker){let worker=options.worker;let route=options.route;if(worker instanceof Blob||typeof worker==="string"){worker=new Worker(worker)}delete options.worker;delete options.route;return transferCanvas2(worker,options,route)}else{initProxyElement2(options.canvas,void 0,options._id,options.preventDefault);return setupCanvas2(options)}}function transferCanvas2(worker,options,route){if(!options)return void 0;if(!options._id)options._id=`canvas${Math.floor(Math.random()*1e15)}`;let offscreen=options.canvas.transferControlToOffscreen();if(!options.width)options.width=options.canvas.clientWidth;if(!options.height)options.height=options.canvas.clientHeight;let message={route:route?route:"setupCanvas",args:{...options,canvas:offscreen}};if(this?.__node?.graph)this.__node.graph.run("initProxyElement",options.canvas,worker,options._id,options.preventDefault);else initProxyElement2(options.canvas,worker,options._id,options.preventDefault);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let tr=[offscreen];if(options.transfer){tr.push(...options.transfer);delete options.transfer}worker.postMessage(message,tr);const canvascontrols={_id:options._id,width:options.width,height:options.height,worker,draw:(props,transfer)=>{worker.postMessage({route:"drawFrame",args:[props,options._id]},transfer)},update:(props,transfer)=>{worker.postMessage({route:"updateCanvas",args:[props,options._id]},transfer)},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:(newDrawProps,transfer)=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]},transfer)},terminate:()=>{worker.terminate()}};return canvascontrols}function setDraw2(settings,_id){let canvasopts;if(this?.__node?.graph){if(_id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]}else{if(_id)canvasopts=globalThis.CANVASES?.[settings._id];else if(settings._id)canvasopts=globalThis.CANVASES?.[settings._id];else canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]]}if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasopts._id,canvasopts.canvas);else proxyElementWorkerRoutes2.makeProxy(canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText32(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw.bind(settings)}if(typeof settings.update==="string")settings.update=parseFunctionFromText32(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update.bind(settings)}if(typeof settings.init==="string")settings.init=parseFunctionFromText32(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init.bind(settings)}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText32(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear.bind(settings)}return settings._id}return void 0}function setupCanvas2(options){if(this?.__node?.graph){if(!this.__node.graph.CANVASES)this.__node.graph.CANVASES={}}else if(!globalThis.CANVASES)globalThis.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=`canvas${Math.floor(Math.random()*1e15)}`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this?.__node?.graph?.CANVASES[canvasOptions._id]){this.__node.graph.run("setDraw",canvasOptions)}else if(globalThis.CANVASES?.[canvasOptions._id]){setDraw2(canvasOptions)}else{if(this?.__node?.graph){canvasOptions.graph=this.__node.graph;if(!canvasOptions.__node){canvasOptions.__node={}}if(!canvasOptions.__node.tag)canvasOptions.__node.tag=canvasOptions._id;canvasOptions=this.__node.graph.add(canvasOptions);canvasOptions.__addOndisconnected=()=>{canvasOptions.stop();delete this.__node.graph.CANVASES[canvasOptions._id]}}if(this?.__node?.graph)this.__node.graph.CANVASES[canvasOptions._id]=canvasOptions;else globalThis.CANVASES[canvasOptions._id]=canvasOptions;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);else proxyElementWorkerRoutes2.makeProxy(canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText32(canvasOptions.draw)}else if(typeof canvasOptions.draw==="function"){canvasOptions.draw=canvasOptions.draw.bind(canvasOptions)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText32(canvasOptions.update)}else if(typeof canvasOptions.update==="function"){canvasOptions.update=canvasOptions.update.bind(canvasOptions)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText32(canvasOptions.init)}else if(typeof canvasOptions.init==="function"){canvasOptions.init=canvasOptions.init.bind(canvasOptions)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText32(canvasOptions.clear)}else if(typeof canvasOptions.clear==="function"){canvasOptions.clear=canvasOptions.clear.bind(canvasOptions)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);canvasOptions.stop=()=>{stopAnim2(canvasOptions._id)};canvasOptions.start=draw=>{startAnim2(canvasOptions._id,draw)};canvasOptions.set=settings=>{setDraw2(settings,canvasOptions._id)};if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)return canvasOptions._id;else{const canvascontrols={_id:options._id,width:options.width,height:options.height,draw:props=>{drawFrame2(props,options._id)},update:props=>{updateCanvas2(props,options._id)},clear:()=>{clearCanvas2(options._id)},init:()=>{initCanvas2(options._id)},stop:()=>{stopAnim2(options._id)},start:()=>{startAnim2(options._id)},set:newDrawProps=>{setDraw2(newDrawProps,options._id)},terminate:()=>{if(this.__node?.graph)this.__node.graph.remove(options._id);else{stopAnim2(options._id);if(this?.__node?.graph)delete this.__node.graph.CANVASES[canvasOptions._id];else delete globalThis.CANVASES[canvasOptions._id]}}};return canvascontrols}}function drawFrame2(props,_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0}function clearCanvas2(_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function initCanvas2(_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function updateCanvas2(input,_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0}function setProps2(props,_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0}function startAnim2(_id,draw){let canvasopts=getCanvas2.call(this,_id);canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText32(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function stopAnim2(_id){let canvasopts=getCanvas2.call(this,_id);if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")requestAnimationFrame(canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context));return _id}return void 0}function getCanvas2(_id){let canvasopts;if(this?.__node?.graph){if(!_id)canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]];else canvasopts=this.__node.graph.CANVASES?.[_id]}else{if(!_id)canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]];else canvasopts=globalThis.CANVASES?.[_id]}return canvasopts}var workerCanvasRoutes2={...proxyElementWorkerRoutes2,Renderer:Renderer2,transferCanvas:transferCanvas2,setupCanvas:setupCanvas2,setDraw:setDraw2,drawFrame:drawFrame2,clearCanvas:clearCanvas2,initCanvas:initCanvas2,updateCanvas:updateCanvas2,setProps:setProps2,startAnim:startAnim2,stopAnim:stopAnim2,getCanvas:getCanvas2};function parseFunctionFromText32(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var str2=String(`(()=>{var __require=(x=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(x,{get:(a,b)=>(typeof require!=="undefined"?require:a)[b]}):x)(function(x){if(typeof require!=="undefined")return require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x+\'" is not supported\')});var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value}):obj[key]=value;var __require2=(x=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x)(function(x){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error(\'Dynamic require of "\'+x+\'" is not supported\')});var __commonJS=(cb,mod)=>function __require22(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:true}):target,mod));var __publicField=(obj,key,value)=>{__defNormalProp(obj,typeof key!=="symbol"?key+"":key,value);return value};var require_browser=__commonJS({"node_modules/web-worker/cjs/browser.js"(exports,module2){module2.exports=Worker}});var EventHandler=class{data={};triggers={};ctr=0;constructor(data){if(typeof data==="object")this.data=data}setState=updateObj=>{Object.assign(this.data,updateObj);let props=Object.getOwnPropertyNames(updateObj);for(const prop of props){this.triggerEvent(prop,this.data[prop])}if(this.triggers[statesubKey]){let run=fn=>{fn(updateObj)};const l=this.triggers[statesubKey].length;for(let i2=l-1;i2>=0;i2--){run(this.triggers[statesubKey][i2].onchange)}}return this.data};setValue=(key,value)=>{this.data[key]=value;this.triggerEvent(key,value)};triggerEvent=(key,value)=>{if(this.triggers[key]){let fn=obj=>{obj.onchange(value)};const l=this.triggers[key].length;for(let i2=l-1;i2>=0;i2--){fn(this.triggers[key][i2])}}};subscribeState=onchange=>{return this.subscribeEvent(statesubKey,onchange)};unsubscribeState=sub=>{return this.unsubscribeEvent(statesubKey,sub)};subscribeEvent=(key,onchange,refObject,refKey)=>{if(key){if(refObject&&refKey&&!this.triggers[key]){Object.defineProperty(this.data,key,{get:()=>{return refObject[refKey]},set:value=>{refObject[refKey]=value},enumerable:true,configurable:true})}if(!this.triggers[key]){this.triggers[key]=[]}let l=this.ctr;this.ctr++;this.triggers[key].push({sub:l,onchange});return l}else return void 0};unsubscribeEvent=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(sub===void 0){delete this.triggers[key];delete this.data[key]}else{let idx=void 0;let obj=triggers.find((o,i2)=>{if(o.sub===sub){idx=i2;return true}});if(obj)triggers.splice(idx,1);if(Object.keys(triggers).length===0){delete this.triggers[key];delete this.data[key]}if(this.onRemoved)this.onRemoved(obj);return true}}};subscribeEventOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeEvent(key,sub)};sub=this.subscribeEvent(key,changed);return sub};getEvent=(key,sub)=>{for(const s in this.triggers[key]){if(this.triggers[key][s].sub===sub)return this.triggers[key][s]}};getSnapshot=()=>{const snapshot={};for(const key in this.data){snapshot[key]=this.data[key]}};onRemoved};var statesubKey="*s";var state=new EventHandler;var GraphNode=class{__node={tag:\\`node\\${Math.floor(Math.random()*1e15)}\\`,unique:\\`\\${Math.floor(Math.random()*1e15)}\\`,state};__children;__parent;__operator;__listeners;__props;__args;constructor(properties,parent,graph){this.__setProperties(properties,parent,graph)}__setProperties=(properties,parent,graph)=>{let enforceProperties=()=>{let orig=properties;if(typeof properties==="function"){if(isNativeClass(properties)){properties=new properties}else properties={__operator:properties,__node:{forward:true,tag:properties.name}}}else if(typeof properties==="string"){if(graph?.get(properties)){properties=graph.get(properties)}}if(!("__node"in properties))properties.__node={};if(!properties.__node.initial)properties.__node.initial=orig};enforceProperties();if(typeof properties==="object"){let assignState=()=>{if(properties.__node?.state)this.__node.state=properties.__node.state;else if(graph){properties.__node.state=graph.__node.state}};let setProps2=()=>{if(properties.__props){if(typeof properties.__props==="function")properties.__props=new properties.__props;if(typeof properties.__props==="object"){this.__proxyObject(properties.__props)}}};let setTag=()=>{if(!properties.__node.tag){if(properties.__operator?.name)properties.__node.tag=properties.__operator.name;else properties.__node.tag=\\`node\\${Math.floor(Math.random()*1e15)}\\`}};let setNode=()=>{if(typeof properties.__node==="string"){if(graph?.get(properties.__node.tag)){properties=graph.get(properties.__node.tag)}else properties.__node={}}else if(!properties.__node)properties.__node={};if(graph){properties.__node.graph=graph}if(properties instanceof Graph)properties.__node.source=properties};let setParent=()=>{if(!properties.__parent&&parent)properties.__parent=parent;if(parent?.__node&&!(parent instanceof Graph||properties instanceof Graph))properties.__node.tag=parent.__node.tag+"."+properties.__node.tag;if(parent instanceof Graph&&properties instanceof Graph){if(properties.__node.loaders)Object.assign(parent.__node.loaders?parent.__node.loaders:{},properties.__node.loaders);if(parent.__node.mapGraphs){properties.__node.nodes.forEach(n=>{parent.set(properties.__node.tag+"."+n.__node.tag,n)});let ondelete=()=>{properties.__node.nodes.forEach(n=>{parent.__node.nodes.delete(properties.__node.tag+"."+n.__node.tag)})};this.__addOndisconnected(ondelete)}}};let setOp=()=>{if(typeof properties.default==="function"&&!properties.__operator){properties.__operator=properties.default}if(properties.__operator){if(typeof properties.__operator==="string"){if(graph){let n=graph.get(properties.__operator);if(n)properties.__operator=n.__operator;if(!properties.__node.tag&&properties.__operator.name)properties.__node.tag=properties.__operator.name}}if(typeof properties.__operator==="function")properties.__operator=this.__setOperator(properties.__operator);if(properties.default)properties.default=properties.__operator}};let assignProps=()=>{properties.__node=Object.assign(this.__node,properties.__node);let keys2=Object.getOwnPropertyNames(properties).filter(v=>{if(!objProps[v])return true});for(const key of keys2){if(key in properties)this[key]=properties[key]}};let bindCallbacks=()=>{if(this.__onconnected){if(typeof this.__onconnected==="function"){this.__onconnected=this.__onconnected.bind(this)}else if(Array.isArray(this.__onconnected)){this.__onconnected=this.__onconnected.map(f=>{return f.bind(this)})}if(typeof this.__ondisconnected==="function"){this.__ondisconnected=this.__ondisconnected.bind(this)}else if(Array.isArray(this.__ondisconnected)){this.__ondisconnected=this.__ondisconnected.map(f=>{return f.bind(this)})}}};assignState();setTag();setProps2();setNode();setParent();assignProps();bindCallbacks();setOp()}};__subscribe=(callback,key,subInput,target,tkey,args)=>{const subscribeToFunction=(k,setTarget=(callback2,target2)=>target2?target2:callback2,triggerCallback=callback)=>{let wrappedArgs;if(args){let wrapped=wrapArgs(triggerCallback,args,this.__node.graph);triggerCallback=wrapped.__callback;wrappedArgs=wrapped.__args}let sub=this.__node.state.subscribeEvent(k,triggerCallback,this,key);let trigger=this.__node.state.getEvent(k,sub);if(!this.__listeners)this.__listeners={};this.__listeners[k]=this.__node.state.triggers[k];if(!trigger)return sub;trigger.source=this.__node.tag;if(key)trigger.key=key;trigger.target=setTarget(callback,target);if(subInput)trigger.subInput=subInput;if(args){trigger.arguments=args;trigger.__args=wrappedArgs}if(tkey)trigger.tkey=tkey;trigger.node=this;trigger.graph=this.__node.graph;return sub};const subscribeToGraph=callback2=>{let fn=this.__node.graph.get(callback2);if(!fn&&callback2.includes(".")){target=callback2.substring(0,callback2.lastIndexOf("."));let n=this.__node.graph.get(callback2.substring(0,target));tkey=callback2.lastIndexOf(".")+1;if(n&&typeof n[key]==="function")callback2=(...args2)=>{return n[tkey](...args2)}}else if(fn.__operator){callback2=fn.__operator;tkey="__operator"}};if(key){if(!this.__node.localState||!this.__node.localState[key]){this.__addLocalState(this,key)}if(typeof callback==="string"){tkey=callback;if(target){if(this.__node.graph?.get(target)){let n=this.__node.graph?.get(target);if(typeof n[callback]==="function"){let fn=n[callback];callback=(...inp)=>{fn(...inp)}}else{let k2=callback;let setter=inp=>{n[k2]=inp};callback=setter}}}else if(typeof this[callback]==="function"){let fn=this[callback];callback=(...inp)=>{fn(...inp)}}else if(this.__node.graph?.get(callback))subscribeToGraph(callback);if(typeof callback!=="function")return void 0}let sub;let k=subInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node)sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)});return sub}else{if(typeof callback==="string"){if(this.__node.graph.get(callback))callback=this.__node.graph.get(callback);tkey="__operator";if(typeof callback!=="object")return void 0}let sub;let k=subInput?this.__node.unique+"input":this.__node.unique;if(typeof callback==="function")sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2,callback);else if(callback?.__node){sub=subscribeToFunction(k,(callback2,target2)=>target2?target2:callback2.__node.unique,(...inp)=>{if(callback.__operator)callback.__operator(...inp)})}return sub}};__unsubscribe=(sub,key,unsubInput)=>{if(key){return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"."+key+"input":this.__node.unique+"."+key,sub)}else return this.__node.state.unsubscribeEvent(unsubInput?this.__node.unique+"input":this.__node.unique,sub)};__setOperator=fn=>{fn=fn.bind(this);if(this.__args&&this.__node.graph){fn=wrapArgs(fn,this.__args,this.__node.graph).__callback}let inpstr=\\`\\${this.__node.unique}input\\`;this.__operator=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[this.__node.unique]){if(typeof result?.then==="function"){result.then(res=>{if(res!==void 0)this.__node.state.setValue(this.__node.unique,res)}).catch(console.error)}else if(result!==void 0)this.__node.state.setValue(this.__node.unique,result)}return result};if(this.__parent instanceof GraphNode&&!this.__subscribedToParent){if(this.__parent.__operator){let sub=this.__parent.__subscribe(this);let ondelete=()=>{this.__parent?.__unsubscribe(sub);delete this.__subscribedToParent};this.__addOndisconnected(ondelete);this.__subscribedToParent=true}}return this.__operator};__addLocalState=(props,key)=>{if(!props)return;if(!this.__node.localState){this.__node.localState={}}const localState=this.__node.localState;const initState=(props2,k)=>{let str2=this.__node.unique+"."+k;let inpstr=\\`\\${str2}input\\`;let get,set;let obj,descriptor;if(typeof props2[k]==="function"&&k!=="__operator"){if(this.__props?.[k]){obj=this.__props}else{obj=localState}get=()=>{return obj[k]};set=fn=>{if(!this.__props?.[k])fn=fn.bind(this);obj[k]=(...args)=>{if(this.__node.state.triggers[inpstr])this.__node.state.setValue(inpstr,args);let result=fn(...args);if(this.__node.state.triggers[str2]){if(typeof result?.then==="function"){result.then(res=>{this.__node.state.triggerEvent(str2,res)}).catch(console.error)}else this.__node.state.triggerEvent(str2,result)}return result}};localState[k]=props2[k].bind(this);descriptor={get,set,enumerable:true,configurable:true}}else{let get2,set2;let obj2;if(this.__props?.[k]){obj2=this.__props}else{obj2=localState}get2=()=>{return obj2[k]};set2=v=>{obj2[k]=v;if(this.__node.state.triggers[str2])this.__node.state.triggerEvent(str2,v)};localState[k]=props2[k];descriptor={get:get2,set:set2,enumerable:true,configurable:true}}Object.defineProperty(props2,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}};if(key)initState(props,key);else{for(let k in props){initState(props,k)}}};__proxyObject=obj=>{const allProps=getAllProperties(obj);for(const k of allProps){const descriptor={get:()=>{return obj[k]},set:value=>{obj[k]=value},enumerable:true,configurable:true};Object.defineProperty(this,k,descriptor);if(typeof this.__node.initial==="object"){let dec=Object.getOwnPropertyDescriptor(this.__node.initial,k);if(dec===void 0||dec?.configurable){Object.defineProperty(this.__node.initial,k,descriptor)}}}};__addOnconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__onconnected)){this.__onconnected.push(callback)}else if(typeof this.__onconnected==="function"){this.__onconnected=[callback,this.__onconnected]}else this.__onconnected=callback}__addOndisconnected(callback){callback=callback.bind(this);if(Array.isArray(this.__ondisconnected)){this.__ondisconnected.push(callback)}else if(typeof this.__ondisconnected==="function"){this.__ondisconnected=[callback,this.__ondisconnected]}else this.__ondisconnected=callback}__callConnected(node=this){if(typeof this.__onconnected==="function"){this.__onconnected(this)}else if(Array.isArray(this.__onconnected)){let fn=o=>{o(this)};this.__onconnected.forEach(fn)}}__callDisconnected(node=this){if(typeof this.__ondisconnected==="function")this.__ondisconnected(this);else if(Array.isArray(this.__ondisconnected)){let fn=o=>{o(this)};this.__ondisconnected.forEach(fn)}}};var Graph=class{__node={tag:\\`graph\\${Math.floor(Math.random()*1e15)}\\`,unique:\\`\\${Math.random()}\\`,nodes:new Map,state,roots:{}};constructor(options){this.init(options)}init=options=>{if(options){let cpy=Object.assign({},options);delete cpy.roots;recursivelyAssign(this.__node,cpy);if(options.roots)this.load(options.roots)}};load=roots=>{function recursivelyAssignChildren(target,obj,inChildren=true,top=true){if(top){if(target)Object.assign(target,obj);else target=Object.assign({},obj);recursivelyAssignChildren(target,obj,true,false)}if(obj?.__children&&!inChildren){if(obj.__children?.constructor.name==="Object"){if(target.__children?.constructor.name==="Object")recursivelyAssignChildren(target.__children,obj.__children,true,false);else target.__children=recursivelyAssignChildren({},obj.__children,true,false)}else{target.__children=obj.__children}}else if(inChildren){for(const key in obj){target[key]=Object.assign({},obj[key]);if(obj[key]?.__children){recursivelyAssignChildren({},obj[key].__children,false,false)}}}return target}this.__node.roots=recursivelyAssignChildren(this.__node.roots?this.__node.roots:{},roots);let cpy=Object.assign({},roots);if(cpy.__node)delete cpy.__node;let listeners=this.recursiveSet(cpy,this,void 0,roots);if(roots.__node){if(!roots.__node.tag)roots.__node._tag=\\`roots\\${Math.floor(Math.random()*1e15)}\\`;else if(!this.get(roots.__node.tag)){let node=new GraphNode(roots,this,this);this.set(node.__node.tag,node);this.runLoaders(node,this,roots,roots.__node.tag);if(node.__listeners){listeners[node.__node.tag]=node.__listeners}}}else if(roots.__listeners){this.setListeners(roots.__listeners)}this.setListeners(listeners);return cpy};setLoaders=(loaders2,replace)=>{if(replace)this.__node.loaders=loaders2;else Object.assign(this.__node.loaders,loaders2);return this.__node.loaders};runLoaders=(node,parent,properties,key)=>{for(const l in this.__node.loaders){if(typeof this.__node.loaders[l]==="object"){if(this.__node.loaders[l].init)this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key);if(this.__node.loaders[l].connected)node.__addOnconnected(this.__node.loaders[l].connect);if(this.__node.loaders[l].disconnected)node.__addOndisconnected(this.__node.loaders[l].disconnect)}else if(typeof this.__node.loaders[l]==="function")this.__node.loaders[l](node,parent,this,this.__node.roots,properties,key)}};add=(properties,parent)=>{let listeners={};if(typeof parent==="string")parent=this.get(parent);let instanced;if(typeof properties==="function"){if(isNativeClass(properties)){if(properties.prototype instanceof GraphNode){properties=properties.prototype.constructor(properties,parent,this);instanced=true}else properties=new properties}else properties={__operator:properties}}else if(typeof properties==="string"){properties=this.__node.roots[properties]}if(!properties)return;if(!instanced){let keys2=Object.getOwnPropertyNames(properties);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(properties));keys2.push(...nonArrowFunctions);keys2=keys2.filter(v=>!objProps.includes(v));let cpy={};for(const key of keys2){cpy[key]=properties[key]}properties=cpy}if(!properties.__node)properties.__node={};properties.__node.initial=properties;if(typeof properties==="object"&&!this.get(properties.__node.tag)){let node;let root=recursivelyAssign({},properties,2);if(instanced)node=properties;else node=new GraphNode(properties,parent,this);this.set(node.__node.tag,node);this.runLoaders(node,parent,properties,node.__node.tag);this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key in node.__listeners){let listener=node.__listeners[key];if(node[key]){delete listeners[node.__node.tag][key];listeners[node.__node.tag][node.__node.tag+"."+key]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][key]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][key]=parent.__node.tag}}}}this.setListeners(listeners);node.__callConnected();return node}else if(properties.__node.tag)return this.get(properties.__node.tag)};recursiveSet=(t2,parent,listeners={},origin)=>{let keys2=Object.getOwnPropertyNames(origin);let nonArrowFunctions=Object.getOwnPropertyNames(Object.getPrototypeOf(origin)).filter(v=>!objProps.includes(v));keys2.push(...nonArrowFunctions);for(const key of keys2){if(key.includes("__"))continue;let p=origin[key];if(Array.isArray(p))continue;let instanced;if(typeof p==="function"){if(isNativeClass(p)){p=new p;if(p instanceof GraphNode){p=p.prototype.constructor(p,parent,this);instanced=true}}else p={__operator:p}}else if(typeof p==="string"){if(this.__node.nodes.get(p))p=this.__node.nodes.get(p);else p=this.__node.roots[p]}else if(typeof p==="boolean"){if(this.__node.nodes.get(key))p=this.__node.nodes.get(key);else p=this.__node.roots[key]}if(p instanceof Object){if(!instanced&&!(p instanceof GraphNode)){let ks=Object.getOwnPropertyNames(p);let nonArrowFunctions2=Object.getOwnPropertyNames(Object.getPrototypeOf(p));nonArrowFunctions2.splice(nonArrowFunctions2.indexOf("constructor"),1);ks.push(...nonArrowFunctions2);let cpy={};for(const key2 of ks){cpy[key2]=p[key2]}p=cpy}if(!p.__node)p.__node={};if(!p.__node.tag)p.__node.tag=key;if(!p.__node.initial)p.__node.initial=t2[key];if(this.get(p.__node.tag)&&!(!(parent instanceof Graph)&&parent?.__node)||parent?.__node&&this.get(parent.__node.tag+"."+p.__node.tag))continue;let node;let newnode=false;let root=recursivelyAssign({},p,2);if(instanced||p instanceof GraphNode){node=p}else{node=new GraphNode(p,parent,this);newnode=true}if(!newnode&&p instanceof GraphNode&&!instanced&&parent instanceof GraphNode){let sub=this.subscribe(parent.__node.tag,node.__node.tag);let ondelete=node2=>{this.unsubscribe(parent.__node.tag,sub)};node.__addOndisconnected(ondelete)}else if(node){this.set(node.__node.tag,node);this.runLoaders(node,parent,t2[key],key);t2[key]=node;this.__node.roots[node.__node.tag]=root;if(node.__children){node.__children=Object.assign({},node.__children);this.recursiveSet(node.__children,node,listeners,node.__children)}if(node.__listeners){listeners[node.__node.tag]=Object.assign({},node.__listeners);for(const key2 in node.__listeners){let listener=node.__listeners[key2];let k=key2;if(node[key2]){delete listeners[node.__node.tag][key2];k=node.__node.tag+"."+key2;listeners[node.__node.tag][k]=listener}if(typeof listener==="string"){if(node.__children?.[listener]){listeners[node.__node.tag][k]=node.__node.tag+"."+listener}else if(parent instanceof GraphNode&&(parent.__node.tag===listener||parent.__node.tag.includes(".")&&parent.__node.tag.split(".").pop()===listener)){listeners[node.__node.tag][k]=parent.__node.tag}}}}node.__callConnected()}}}return listeners};remove=(node,clearListeners=true)=>{this.unsubscribe(node);if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){this.delete(node.__node.tag);delete this.__node.roots[node.__node.tag];if(clearListeners){this.clearListeners(node)}node.__callDisconnected();const recursiveRemove=t2=>{for(const key in t2){this.unsubscribe(t2[key]);this.delete(t2[key].__node.tag);delete this.__node.roots[t2[key].__node.tag];this.delete(key);delete this.__node.roots[key];t2[key].__node.tag=t2[key].__node.tag.substring(t2[key].__node.tag.lastIndexOf(".")+1);if(clearListeners){this.clearListeners(t2[key])}t2[key].__callDisconnected();if(t2[key].__children){recursiveRemove(t2[key].__children)}}};if(node.__children){recursiveRemove(node.__children)}}if(node?.__node.tag&&node?.__parent){delete node?.__parent;node.__node.tag=node.__node.tag.substring(node.__node.tag.indexOf(".")+1)}if(node?.__node.graph)node.__node.graph=void 0;return node};run=(node,...args)=>{if(typeof node==="string"){let nd=this.get(node);if(!nd&&node.includes(".")){nd=this.get(node.substring(0,node.lastIndexOf(".")));if(typeof nd?.[node.substring(node.lastIndexOf(".")+1)]==="function")return nd[node.substring(node.lastIndexOf(".")+1)](...args)}else if(nd?.__operator)return nd.__operator(...args)}if(node?.__operator){return node?.__operator(...args)}};setListeners=listeners=>{for(const key in listeners){let node=this.get(key);if(typeof listeners[key]==="object"){for(const k in listeners[key]){let n=this.get(k);let sub;if(typeof listeners[key][k]!=="object")listeners[key][k]={__callback:listeners[key][k]};else if(!listeners[key][k].__callback){for(const kk in listeners[key][k]){if(typeof listeners[key][k][kk]!=="object"){listeners[key][k][kk]={__callback:listeners[key][k][kk]};if(node.__operator&&(listeners[key][k][kk].__callback===true||typeof listeners[key][k][kk].__callback==="undefined"))listeners[key][k][kk].__callback=node.__operator}let nn=this.get(kk);if(!nn){let tag=k.substring(0,k.lastIndexOf("."));nn=this.get(tag);if(nn){let prop=k.substring(k.lastIndexOf(".")+1);sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k][kk].__args,prop,listeners[key][k][kk].inputState,key,k)}}else{sub=this.subscribe(nn,listeners[key][k][kk].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}if("__callback"in listeners[key][k]){if(node){if(listeners[key][k].__callback===true||typeof listeners[key][k].__callback==="undefined")listeners[key][k].__callback=node.__operator;if(typeof listeners[key][k].__callback==="function")listeners[key][k].__callback=listeners[key][k].__callback.bind(node)}if(!n){let tag=k.substring(0,k.lastIndexOf("."));n=this.get(tag);if(n){sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,k.substring(k.lastIndexOf(".")+1),listeners[key][k].inputState,key,k)}}else{sub=this.subscribe(n,listeners[key][k].__callback,listeners[key][k].__args,void 0,listeners[key][k].inputState,key,k)}}}}}};clearListeners=(node,listener)=>{if(typeof node==="string")node=this.get(node);if(node?.__listeners){for(const key in node.__listeners){if(listener&&key!==listener)continue;if(typeof node.__listeners[key]?.sub!=="number")continue;let n=this.get(key);if(!n){n=this.get(key.substring(0,key.lastIndexOf(".")));if(n){if(typeof node.__listeners[key]==="object"&&!node.__listeners[key]?.__callback){for(const k in node.__listeners[key]){if(typeof node.__listeners[key][k]?.sub==="number"){this.unsubscribe(n,node.__listeners[key][k].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,key.substring(key.lastIndexOf(".")+1),node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}else{if(typeof!node.__listeners[key]?.__callback==="number"){for(const k in node.__listeners[key]){if(node.__listeners[key][k]?.sub){this.unsubscribe(n,node.__listeners[key][k].sub,void 0,node.__listeners[key][k].inputState);node.__listeners[key][k].sub=void 0}}}else if(typeof node.__listeners[key]?.sub==="number"){this.unsubscribe(n,node.__listeners[key].sub,void 0,node.__listeners[key].inputState);node.__listeners[key].sub=void 0}}}}};get=tag=>{return this.__node.nodes.get(tag)};set=(tag,node)=>{return this.__node.nodes.set(tag,node)};delete=tag=>{return this.__node.nodes.delete(tag)};getProps=(node,getInitial)=>{if(typeof node==="string")node=this.get(node);if(node instanceof GraphNode){let cpy;if(getInitial)cpy=Object.assign({},this.__node.roots[node.__node.tag]);else{cpy=Object.assign({},node);for(const key in cpy){if(key.includes("__"))delete cpy[key]}}}};subscribe=(nodeEvent,onEvent,args,key,subInput,target,bound,tkey)=>{let nd=nodeEvent;if(typeof nodeEvent==="string"){nd=this.get(nodeEvent);if(!nd&&nodeEvent.includes(".")){nd=this.get(nodeEvent.substring(0,nodeEvent.lastIndexOf(".")));key=nodeEvent.substring(nodeEvent.lastIndexOf(".")+1)}}if(target instanceof GraphNode)target=target.__node.tag;if(typeof onEvent==="string"){let setOnEventFromString=onEvent2=>{if(this.get(onEvent2)?.__operator){let node=this.get(onEvent2);target=onEvent2;onEvent2=function(...inp){return node.__operator(...inp)}}else if(onEvent2.includes(".")){target=onEvent2.substring(0,onEvent2.lastIndexOf("."));let n=this.get(target);let k=onEvent2.substring(onEvent2.lastIndexOf(".")+1);tkey=k;if(typeof n[k]==="function"){if(n[k]instanceof GraphNode)onEvent2=n[k];else onEvent2=function(...inp){return n[k](...inp)}}else{onEvent2=function(inp){n[k]=inp;return n[k]}}}return onEvent2};if(target){let node=this.get(target);if(typeof node?.[onEvent]==="function"){tkey=onEvent;onEvent=function(...inp){return node[key](...inp)}}else if(node[key]){tkey=key;if(node[key]instanceof GraphNode)onEvent=node[key];else onEvent=function(inp){node[key]=inp;return node[key]}}else{onEvent=setOnEventFromString(onEvent)}}else{onEvent=setOnEventFromString(onEvent)}}let sub;if(nd instanceof GraphNode){const doSub=()=>{sub=nd.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)nd.__unsubscribe(sub,key,subInput);sub=void 0};nd.__addOndisconnected(()=>{ondelete();nd.__addOnconnected(()=>{if(sub===void 0&&nd.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))onEvent=this.get(onEvent);if(onEvent instanceof GraphNode){onEvent.__addOndisconnected(()=>{ondelete()})}};doSub()}else if(typeof nodeEvent==="string"){let node=this.get(nodeEvent);if(node){if(onEvent instanceof GraphNode&&onEvent.__operator){const doSub=()=>{sub=node.__subscribe(onEvent.__operator,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput)};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});onEvent.__addOndisconnected(ondelete)};doSub()}else if(typeof onEvent==="function"||typeof onEvent==="string"){const doSub=()=>{sub=node.__subscribe(onEvent,key,subInput,target,tkey,args);let ondelete=()=>{if(sub!==void 0)node.__unsubscribe(sub,key,subInput);sub=void 0};node.__addOndisconnected(()=>{ondelete();node.__addOnconnected(()=>{if(sub===void 0&&node.__node.graph.__node.tag===this.__node.tag)doSub()})});if(typeof onEvent==="string"&&this.get(onEvent))this.get(onEvent).__addOndisconnected(ondelete)};doSub()}}else{if(typeof onEvent==="string")onEvent=this.__node.nodes.get(onEvent).__operator;if(typeof onEvent==="function")sub=this.__node.state.subscribeEvent(nodeEvent,onEvent)}}return sub};unsubscribe=(node,sub,key,subInput)=>{if(node instanceof GraphNode){return node.__unsubscribe(sub,key,subInput)}else return this.get(node)?.__unsubscribe(sub,key,subInput)};setState=update=>{this.__node.state.setState(update)}};function recursivelyAssign(target,obj,maxDepth=Infinity,curDepth=0){for(const key in obj){if(obj[key]?.constructor.name==="Object"&&curDepth<maxDepth){curDepth++;if(target[key]?.constructor.name==="Object")recursivelyAssign(target[key],obj[key],maxDepth,curDepth);else target[key]=recursivelyAssign({},obj[key],maxDepth,curDepth)}else{target[key]=obj[key]}}return target}function getAllProperties(obj){var allProps=[],curr=obj;do{var props=Object.getOwnPropertyNames(curr);let fn=function(prop){if(allProps.indexOf(prop)===-1)allProps.push(prop)};props.forEach(fn)}while(curr=Object.getPrototypeOf(curr));return allProps}function isNativeClass(thing){return isFunction(thing)==="class"}function isFunction(x){const res=typeof x==="function"?x.prototype?Object.getOwnPropertyDescriptor(x,"prototype")?.writable?"function":"class":x.constructor.name==="AsyncFunction"?"async":"arrow":"";return res}var getCallbackFromString=(a,graph)=>{if(graph.get(a)?.__operator){let node=graph.get(a);return(...inp)=>{node.__operator(...inp)}}else if(a.includes(".")){let split=a.split(".");let popped=split.pop();let joined=split.join(".");let node=graph.get(joined);if(typeof graph.get(joined)?.[popped]==="function"){return(...inp)=>{return node[popped](...inp)}}else return()=>{return node[popped]}}else if(graph.get(a)){let node=graph.get(a);return()=>{return node}}else{let arg=a;return()=>{return arg}}};var wrapArgs=(callback,argOrder,graph)=>{let args=[];let forArg=(a,i2)=>{if(a==="__output"||a==="__input"||a==="__callback"){args[i2]={__callback:inp=>{return inp},__args:void 0,idx:i2}}else if(typeof a==="string"){args[i2]={__callback:getCallbackFromString(a,graph),__args:void 0,idx:i2}}else if(typeof a==="function"){let fn2=a;args[i2]={__callback:(...inp)=>{return fn2(...inp)},__args:void 0,idx:i2}}else if(typeof a==="object"&&(a.__input||a.__callback)){let recursivelyCreateCallback=function(c){let input=c.__input?c.__input:c.__callback;if(typeof c.__input==="string"){input={__callback:getCallbackFromString(c.__input,graph),__args:void 0,idx:i2}}if(c.__args){let wrapped=wrapArgs(input,c.__args,graph);input={__callback:wrapped.__callback,__args:wrapped.__args,idx:i2}}else{input={__callback:input,__args:void 0,idx:i2}}if(c.__output){let output=c.__output;if(typeof c.__output==="string"){output={__callback:getCallbackFromString(output,graph),__args:void 0,idx:i2}}else if(typeof a.__output==="object"){output=recursivelyCreateCallback(output)}if(typeof output?.__callback==="function"){let fn2=input.__callback;let callback2=output.__callback;input={__callback:(...inp)=>{return callback2(fn2(...inp))},__args:output.__args,idx:i2}}}return input};args[i2]=recursivelyCreateCallback(a)}else{let arg=a;args[i2]={__callback:()=>{return arg},__args:void 0,idx:i2}}};argOrder.forEach(forArg);if(typeof callback==="string")callback={__callback:getCallbackFromString(callback,graph),__args:void 0};let fn=typeof callback==="function"?callback:callback.__callback;callback=function(...inp){let mapArg=arg=>{return arg.__callback(...inp)};const result=fn(...args.map(mapArg));return result};return{__callback:callback,__args:args}};var objProps=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var backprop=(node,parent,graph)=>{if(node.__node.backward&&parent instanceof GraphNode){graph.setListeners({[parent.__node.tag]:{[node.__node.tag]:parent}})}};var loop=(node,parent,graph)=>{if(node.__operator&&!node.__node.looperSet){if(typeof node.__node.delay==="number"){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{setTimeout(async()=>{res(await fn(...args))},node.__node.delay)})})}else if(node.__node.frame===true){let fn=node.__operator;node.__setOperator((...args)=>{return new Promise((res,rej)=>{requestAnimationFrame(async()=>{res(await fn(...args))})})})}if(typeof node.__node.repeat==="number"||typeof node.__node.recursive==="number"){let fn=node.__operator;node.__setOperator(async(...args)=>{let i2=node.__node.repeat?node.__node.repeat:node.__node.recursive;let result;let repeater=async(tick,...inp)=>{while(tick>0){if(node.__node.delay||node.__node.frame){fn(...inp).then(async res=>{if(node.__node.recursive){await repeater(tick,res)}else await repeater(tick,...inp)});break}else result=await fn(...args);tick--}};await repeater(i2,...args);return result})}if(node.__node.loop&&typeof node.__node.loop==="number"){node.__node.looperSet=true;let fn=node.__operator;let time=node.__node.loop;node.__setOperator((...args)=>{if(!("looping"in node.__node))node.__node.looping=true;if(node.__node.looping){let last=performance.now();fn(...args);setTimeout(()=>{let now=performance.now();let overshoot=now-last-node.__node.loop;if(overshoot>0)time=node.__node.loop-overshoot;else time=node.__node.loop;if(time<=0)time=node.__node.loop;node.__operator(...args)},time)}});if(node.__node.looping)node.__operator();let ondelete=node2=>{if(node2.__node.looping)node2.__node.looping=false};node.__addOndisconnected(ondelete)}}};var animate=(node,parent,graph)=>{if(node.__node.animate===true||node.__animation){let fn=node.__operator;node.__setOperator((...args)=>{if(!("animating"in node.__node))node.__node.animating=true;if(node.__node.animating){if(typeof node.__animation==="function")node.__animation(...args);else fn(...args);requestAnimationFrame(()=>{node.__operator(...args)})}});if(node.__node.animating||(!("animating"in node.__node)||node.__node.animating)&&node.__animation)setTimeout(()=>{requestAnimationFrame(node.__operator)},10);let ondelete=node2=>{if(node2.__node.animating)node2.__node.animating=false};node.__addOndisconnected(ondelete)}};var branching=(node,parent,graph)=>{if(typeof node.__branch==="object"&&node.__operator&&!node.__branchApplied){let fn=node.__operator;node.__branchApplied=true;node.__operator=(...args)=>{let result=fn(...args);for(const key in node.__branch){let triggered=()=>{if(typeof node.__branch[key].then==="function"){node.__branch[key].then(result)}else if(node.__branch[key].then instanceof GraphNode&&node.__branch[key].then.__operator){node.__branch[key].then.__operator(result)}else result=node.__branch[key].then};if(typeof node.__branch[key].if==="function"){if(node.__branch[key].if(result)==true){triggered()}}else if(node.__branch[key].if===result){triggered()}}return result}}if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].branch&&!node.__listeners[key].branchApplied){let fn=node.__listeners[key].callback;node.__listeners[key].branchApplied=true;node.__listeners.callback=ret=>{let triggered=()=>{if(typeof node.__listeners[key].branch.then==="function"){ret=node.__listeners[key].branch.then(ret)}else if(node.__listeners[key].branch.then instanceof GraphNode&&node.__listeners[key].branch.then.__operator){ret=node.__listeners[key].branch.then.__operator(ret)}else ret=node.__listeners[key].branch.then};if(typeof node.__listeners[key].branch.if==="function"){if(node.__listeners[key].branch.if(ret)){triggered()}}else if(node.__listeners[key].branch.if===ret){triggered()}return fn(ret)}}}}}};var triggerListenerOncreate=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(node.__listeners[key].oncreate){node.__listeners[key].callback(node.__listeners[key].oncreate)}}}}};var bindListener=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].binding==="object"){node.__listeners.callback=node.__listeners.callback.bind(node.__listeners[key].binding)}}}}};var transformListenerResult=(node,parent,graph)=>{if(node.__listeners){for(const key in node.__listeners){if(typeof node.__listeners[key]==="object"){if(typeof node.__listeners[key].transform==="function"&&!node.__listeners[key].transformApplied){let fn=node.__listeners[key].callback;node.__listeners[key].transformApplied=true;node.__listeners.callback=ret=>{ret=node.__listeners[key].transform(ret);return fn(ret)}}}}}};var substitute__operator=(node,parent,graph)=>{if(node.post&&!node.__operator){node.__setOperator(node.post)}else if(!node.__operator&&typeof node.get=="function"){node.__setOperator(node.get)}if(!node.get&&node.__operator){node.get=node.__operator}if(node.aliases){node.aliases.forEach(a=>{graph.set(a,node);let ondelete=node2=>{graph.__node.nodes.delete(a)};node.__addOndisconnected(ondelete)})}if(typeof graph.__node.roots?.[node.__node.tag]==="object"&&node.get)graph.__node.roots[node.__node.tag].get=node.get};var loaders={backprop,loop,animate,branching,triggerListenerOncreate,bindListener,transformListenerResult,substitute__operator};var recursivelyStringifyFunctions=obj=>{let cpy={};for(const key in obj){if(typeof obj[key]==="object"){cpy[key]=recursivelyStringifyFunctions(obj[key])}else if(typeof obj[key]==="function"){cpy[key]=obj[key].toString()}else cpy[key]=obj[key]}return cpy};function parseFunctionFromText(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\\\W*(function[^{]+\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>[^{]*\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs22(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs}var stringifyFast=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p in value[prop]){if(Array.isArray(value[prop][p])){if(value[prop][p].length>20)obj[prop][p]=value[prop][p].slice(value[prop][p].length-20);else obj[prop][p]=value[prop][p]}else{if(value[prop][p]!=null){let con=value[prop][p].constructor.name;if(con.includes("Set")){obj[prop][p]=Array.from(value[prop][p])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p]="instanceof_"+con}else{obj[prop][p]=value[prop][p]}}else{obj[prop][p]=value[prop][p]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast22(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast}function methodstrings(node){if(typeof node.__methods==="object"){for(const key in node.__methods){let fstr=node.__methods[key];let fn=typeof fstr==="function"?fstr:parseFunctionFromText(fstr);if(key==="__operator"){node.__setOperator(fn)}else{node[key]=fn.bind(node)}}}}var Service=class extends Graph{name=\\`service\\${Math.floor(Math.random()*1e15)}\\`;constructor(options){super({...options,loaders:options?.loaders?Object.assign({...loaders},options.loaders):{...loaders}});if(options?.services)this.addServices(options.services);this.load(this)}addServices=services=>{for(const s in services){if(typeof services[s]==="function")services[s]=new services[s];if(services[s]?.__node?.loaders)Object.assign(this.__node.loaders,services[s].__node.loaders);if(services[s]?.__node?.nodes){services[s].__node.nodes.forEach((n,tag)=>{if(!this.get(tag)){this.set(tag,n)}else this.set(s+"."+tag,n)});this.__node.nodes.forEach((n,k)=>{if(!services[s].__node.nodes.get(k))services[s].__node.nodes.set(k,n)});let set=this.set;this.set=(tag,node)=>{services[s].set(tag,node);return set(tag,node)};let del=this.delete;this.delete=tag=>{services[s].delete(tag);return del(tag)}}else if(typeof services[s]==="object"){this.load(services[s])}}};handleMethod=(route,method,args)=>{let m=method.toLowerCase();let src=this.__node.nodes.get(route);if(!src){src=this.__node.roots[route]}if(src?.[m]){if(typeof src[m]!=="function"){if(args){if(Array.isArray(args)&&args.length===1)src[m]=args[0];else src[m]=args;return}return src[m]}else{if(Array.isArray(args))return src[m](...args);else return src[m](args)}}else return this.handleServiceMessage({route,args,method})};handleServiceMessage(message){let call;if(typeof message==="object"){if(message.route)call=message.route;else if(message.node)call=message.node}if(call){if(Array.isArray(message.args))return this.run(call,...message.args);else return this.run(call,message.args)}else return message}handleGraphNodeCall(route,args){if(!route)return args;if(args?.args){this.handleServiceMessage(args)}else if(Array.isArray(args))return this.run(route,...args);else return this.run(route,args)}transmit=(...args)=>{if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};receive=(...args)=>{if(args[0]){if(typeof args[0]==="string"){let substr=args[0].substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\\\\\"))args[0]=args[0].replace(/\\\\\\\\/g,"");if(args[0][0]===\'"\'){args[0]=args[0].substring(1,args[0].length-1)};args[0]=JSON.parse(args[0])}}}if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.__node.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};pipe=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return this.subscribe(source,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})};pipeOnce=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return source.__node.state.subscribeEventOnce(source.__node.unique,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.__node.state.subscribeEventOnce(source.__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.__node.state.subscribeEventOnce(this.__node.nodes.get(source).__node.unique,res=>{this.transmit({route:destination,args:res,method},endpoint)})};terminate=(...args)=>{};isTypedArray=isTypedArray;recursivelyAssign=recursivelyAssign2;spliceTypedArray=spliceTypedArray;ping=()=>{console.log("pinged!");return"pong"};echo=(...args)=>{this.transmit(...args);return args};log=(...args)=>{console.log(...args);return true};error=(...args)=>{console.error(...args);return true}};function isTypedArray(x){return ArrayBuffer.isView(x)&&Object.prototype.toString.call(x)!=="[object DataView]"}var recursivelyAssign2=(target,obj)=>{for(const key in obj){if(obj[key]?.constructor.name==="Object"&&!Array.isArray(obj[key])){if(target[key]?.constructor.name==="Object"&&!Array.isArray(target[key]))recursivelyAssign2(target[key],obj[key]);else target[key]=recursivelyAssign2({},obj[key])}else target[key]=obj[key]}return target};function spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let ta;if(s.length>0||e?.length>0)ta=new arr.constructor(s.length+e.length);if(ta){if(s.length>0)ta.set(s);if(e&&e.length>0)ta.set(e,s.length)}return ta}var nodeTemplates={};var remoteGraphRoutes={transferNode:(properties,connection,name2)=>{let str2;if(typeof properties==="object"){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}str2=recursivelyStringifyFunctions(properties)}else if(typeof properties==="function")str2=properties.toString();else if(typeof properties==="string")str2=properties;if(str2){if(connection.run)return connection.run("setNode",[str2]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:str2},void 0);return new Promise(r=>r(name2))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:str2}));return new Promise(r=>r(name2))}}},setNode:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function")properties={__operator:f,__node:{tag:name2?name2:f.name}};else{f=JSON.parse(properties);if(typeof f==="object")properties=f}}if(typeof properties==="object"||typeof properties==="function"){let template={};if(typeof properties==="object")Object.assign(template,properties);else template.__operator=properties;let node=this.__node.graph.add(template);if(node){nodeTemplates[node.__node.tag]=template;return node.__node?.tag}else return false}else return false},proxyRemoteNode:function(name2,connection){return new Promise((res,rej)=>{connection.run("getNodeProperties",name2).then(props=>{let proxy={};if(typeof props==="object"){for(const key in props){if(props[key]==="function"){proxy[key]=(...args)=>{return new Promise(r=>{connection.run(name2,args,key).then(r)})}}else{Object.defineProperty(proxy,key,{get:()=>{return new Promise(r=>{connection.run(name2,void 0,key).then(r)})},set:value=>{connection.post(name2,value,key)},configurable:true,enumerable:true})}}}res(proxy)})})},makeNodeTransferrable:function(properties,name2){if(!properties.__node){properties.__node={}}if(name2)properties.__node.tag=name2;for(const key in properties){if(typeof properties[key]==="function"){if(!properties.__methods)properties.__methods={};properties.__methods[key]=properties[key].toString()}}const str2=recursivelyStringifyFunctions(properties);return str2},setTemplate:function(properties,name2){if(typeof properties==="object"){if(properties.__methods){if(!this.__node.graph.__node.loaders.methodstrings){this.__node.graph.__node.loaders.methodstrings=methodstrings}}}if(typeof properties==="string"){let f=parseFunctionFromText(properties);if(typeof f==="function"){if(!name2)name2=f.name;properties={__operator:f,__node:{tag:name2}}}else{f=JSON.parse(properties);if(typeof f==="object"){properties=f;if(!name2&&f.__node?.tag)name2=f.__node.tag}}}if(!name2)name2=\\`node\\${Math.floor(Math.random()*1e15)}\\`;if(typeof properties==="object"||typeof properties==="function"){nodeTemplates[name2]=properties;return name2}else return false},loadFromTemplate:function(templateName,name2,properties){if(nodeTemplates[templateName]){let cpy=recursivelyAssign2({},nodeTemplates[templateName]);if(name2){if(!cpy.__node)cpy.__node={};cpy.__node.tag=name2}if(properties)Object.assign(cpy,properties);let node=this.__node.graph.add(cpy);return node.__node.tag}},setMethod:function(nodeTag,fn,methodKey){if(typeof fn==="string"){let f=parseFunctionFromText(fn);if(typeof f==="function")fn=f}if(!methodKey&&typeof fn==="function")methodKey=fn.name;if(this.__node.graph.get(nodeTag)){this.__node.graph.get(nodeTag)[methodKey]=fn}else this.__node.graph.add({__node:{tag:methodKey,[methodKey]:fn}});return true},assignNode:function(nodeTag,source){if(this.__node.graph.get(nodeTag)&&typeof source==="object"){Object.assign(this.__node.graph.get(nodeTag),source)}},getNodeProperties:function(nodeTag){let node=this.__node.graph.get(nodeTag);if(node){let properties=Object.getOwnPropertyNames(node);let result={};for(const key in properties){result[key]=typeof node[key]}return result}return void 0},transferClass:(classObj,connection,className)=>{if(typeof classObj==="object"){let str2=classObj.toString();let message={route:"receiveClass",args:[str2,className]};if(connection.run)return connection.run("receiveClass",[str2,className]);else if(connection.postMessage){connection.postMessage({route:"receiveClass",args:[str2,className]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"receiveClass",args:[str2,className]}));return new Promise(r=>r(name))}return message}return false},receiveClass:function(stringified,className){if(typeof stringified==="string"){if(stringified.indexOf("class")===0){let cls=(0,eval)("("+stringified+")");let name2=className;if(!name2)name2=cls.name;this.__node.graph[name2]=cls;return true}}return false},transferFunction:(fn,connection,fnName)=>{if(!fnName)fnName=fn.name;let str2=fn.toString();let message={route:"setNode",args:[str2,fnName]};if(connection.run)return connection.run("setNode",[str2,fnName]);else if(connection.postMessage){connection.postMessage({route:"setNode",args:[str2,fnName]},void 0);return new Promise(r=>r(name))}else if(connection.send){connection.send(JSON.stringify({route:"setNode",args:[str2,fnName]}));return new Promise(r=>r(name))}return message},setGlobal:(key,value)=>{globalThis[key]=value;return true},assignGlobalObject:(target,source)=>{if(!globalThis[target])return false;if(typeof source==="object")Object.assign(globalThis[target],source);return true},setValue:function(key,value){this.__node.graph[key]=value;return true},assignObject:function(target,source){if(!this.__node.graph[target])return false;if(typeof source==="object")Object.assign(this.__node.graph[target],source);return true},setGlobalFunction:(fn,fnName)=>{if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;globalThis[fnName]=fn;return true}return false},setGraphFunction:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.__node.graph[fnName]=fn;return true}return false}};function html(strings,...args){return function append(elm=document.createElement("div")){let template=document.createElement("template");strings.map(function(s,i2){template.innerHTML+=s;if(args[i2]instanceof HTMLElement){let dummy2=\\`<span id="dummyNode12345"></span>\\`;dummy2.id="dummyNode12345";template.innerHTML+=dummy2}else template.innerHTML+=args[i2]});let query=template.content.querySelectorAll("#dummyNode12345");let ctr=0;args.forEach((arg,i2)=>{if(arg instanceof HTMLElement){console.log(arg,query[ctr]);template.content.replaceChild(arg,query[ctr]);ctr++}});elm.appendChild(template.content);return elm}}var dummy=html\\`\\`;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl.cipher.aes=function(a){this.s[0][0][0]||this.O();var b,c,d,e,f=this.s[0][4],g=this.s[1];b=a.length;var h=1;if(4!==b&&6!==b&&8!==b)throw new sjcl.exception.invalid("invalid aes key size");this.b=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7));d[a]=d[a-b]^c}for(b=0;a;b++,a--)c=d[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]]};sjcl.cipher.aes.prototype={encrypt:function(a){return t(this,a,0)},decrypt:function(a){return t(this,a,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var a=this.s[0],b=this.s[1],c=a[4],d=b[4],e,f,g,h=[],k=[],l,n,m,p;for(e=0;256>e;e++)k[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=l||1,g=k[g]||1)for(m=g^g<<1^g<<2^g<<3^g<<4,m=m>>8^m&255^99,c[f]=m,d[m]=f,n=h[e=h[l=h[f]]],p=16843009*n^65537*e^257*l^16843008*f,n=257*h[m]^16843008*m,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p=p<<24^p>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};function t(a,b,c){if(4!==b.length)throw new sjcl.exception.invalid("invalid aes block size");var d=a.b[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,k,l,n=d.length/4-2,m,p=4,r=[0,0,0,0];h=a.s[c];a=h[0];var q=h[1],v=h[2],w=h[3],x=h[4];for(m=0;m<n;m++)h=a[e>>>24]^q[f>>16&255]^v[g>>8&255]^w[b&255]^d[p],k=a[f>>>24]^q[g>>16&255]^v[b>>8&255]^w[e&255]^d[p+1],l=a[g>>>24]^q[b>>16&255]^v[e>>8&255]^w[f&255]^d[p+2],b=a[b>>>24]^q[e>>16&255]^v[f>>8&255]^w[g&255]^d[p+3],p+=4,e=h,f=k,g=l;for(m=0;4>m;m++)r[c?3&-m:m]=x[e>>>24]<<24^x[f>>16&255]<<16^x[g>>8&255]<<8^x[b&255]^d[p++],h=e,e=f,f=g,g=b,b=h;return r}sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.$(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.$(b,d,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b=b&31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return false;var c=0,d;for(d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c},$:function(a,b,c,d){var e;e=0;for(void 0===d&&(d=[]);32<=b;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1));return d},i:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&65280|(c&65280)<<8|c<<24;return a}};sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++)0===(d&3)&&(e=a[d/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++)d=d<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d),d=0);c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b}};sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d;a=a.replace(/\\\\s|0x/g,"");d=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,4*d)}};sjcl.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(a,b,c){var d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f="",g=0,h=sjcl.codec.base32.B,k=0,l=sjcl.bitArray.bitLength(a);c&&(h=sjcl.codec.base32.X);for(c=0;f.length*d<l;)f+=h.charAt((k^a[c]>>>g)>>>e),g<d?(k=a[c]<<d-g,g+=e,c++):(k<<=d,g-=d);for(;f.length&7&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\\\\s|=/g,"").toUpperCase();var c=sjcl.codec.base32.BITS,d=sjcl.codec.base32.BASE,e=sjcl.codec.base32.REMAINING,f=[],g,h=0,k=sjcl.codec.base32.B,l=0,n,m="base32";b&&(k=sjcl.codec.base32.X,m="base32hex");for(g=0;g<a.length;g++){n=k.indexOf(a.charAt(g));if(0>n){if(!b)try{return sjcl.codec.base32hex.toBits(a)}catch(p){}throw new sjcl.exception.invalid("this isn\'t "+m+"!")}h>e?(h-=e,f.push(l^n>>>h),l=n<<c-h):(h+=d,l^=n<<c-h)}h&56&&f.push(sjcl.bitArray.partial(h&56,l,1));return f}};sjcl.codec.base32hex={fromBits:function(a,b){return sjcl.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl.codec.base32.toBits(a,1)}};sjcl.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.B,g=0,h=sjcl.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;d.length&3&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\\\\s|=/g,"");var c=[],d,e=0,f=sjcl.codec.base64.B,g=0,h;b&&(f=f.substr(0,62)+"-_");for(d=0;d<a.length;d++){h=f.indexOf(a.charAt(d));if(0>h)throw new sjcl.exception.invalid("this isn\'t base64!");26<e?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e)}e&56&&c.push(sjcl.bitArray.partial(e&56,g,1));return c}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}};sjcl.hash.sha256=function(a){this.b[0]||this.O();a?(this.F=a.F.slice(0),this.A=a.A.slice(0),this.l=a.l):this.reset()};sjcl.hash.sha256.hash=function(a){return new sjcl.hash.sha256().update(a).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.A=sjcl.bitArray.concat(this.A,a);b=this.l;a=this.l=b+sjcl.bitArray.bitLength(a);if(9007199254740991<a)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d=new Uint32Array(c),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u(this,d.subarray(16*e,16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u(this,c.splice(0,16));return this},finalize:function(){var a,b=this.A,c=this.F,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.l/4294967296));for(b.push(this.l|0);b.length;)u(this,b.splice(0,16));this.reset();return c},Y:[],b:[],O:function(){function a(a2){return 4294967296*(a2-Math.floor(a2))|0}for(var b=0,c=2,d,e;64>b;c++){e=true;for(d=2;d*d<=c;d++)if(0===c%d){e=false;break}e&&(8>b&&(this.Y[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}};function u(a,b){var c,d,e,f=a.F,g=a.b,h=f[0],k=f[1],l=f[2],n=f[3],m=f[4],p=f[5],r=f[6],q=f[7];for(c=0;64>c;c++)16>c?d=b[c]:(d=b[c+1&15],e=b[c+14&15],d=b[c&15]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c&15]+b[c+9&15]|0),d=d+q+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(r^m&(p^r))+g[c],q=r,r=p,p=m,m=n+d|0,n=l,l=k,k=h,h=d+(k&l^n&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+n|0;f[4]=f[4]+m|0;f[5]=f[5]+p|0;f[6]=f[6]+r|0;f[7]=f[7]+q|0}sjcl.mode.ccm={name:"ccm",G:[],listenProgress:function(a){sjcl.mode.ccm.G.push(a)},unListenProgress:function(a){a=sjcl.mode.ccm.G.indexOf(a);-1<a&&sjcl.mode.ccm.G.splice(a,1)},fa:function(a){var b=sjcl.mode.ccm.G.slice(),c;for(c=0;c<b.length;c+=1)b[c](a)},encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,k=h.bitLength(c)/8,l=h.bitLength(g)/8;e=e||64;d=d||[];if(7>k)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&l>>>8*f;f++);f<15-k&&(f=15-k);c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.V(a,b,c,d,e,f);g=sjcl.mode.ccm.C(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/8;if(7>g)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&h>>>8*b;b++);b<15-g&&(b=15-g);c=f.clamp(c,8*(15-b));k=sjcl.mode.ccm.C(a,k,c,l,e,b);a=sjcl.mode.ccm.V(a,k.data,c,d,e,b);if(!f.equal(k.tag,a))throw new sjcl.exception.corrupt("ccm: tag doesn\'t match");return k.data},na:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,k=h.i;d=[h.partial(8,(b.length?64:0)|d-2<<2|f-1)];d=h.concat(d,c);d[3]|=e;d=a.encrypt(d);if(b.length)for(c=h.bitLength(b)/8,65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,b),b=0;b<g.length;b+=4)d=a.encrypt(k(d,g.slice(b,b+4).concat([0,0,0])));return d},V:function(a,b,c,d,e,f){var g=sjcl.bitArray,h=g.i;e/=8;if(e%2||4>e||16<e)throw new sjcl.exception.invalid("ccm: invalid tag length");if(4294967295<d.length||4294967295<b.length)throw new sjcl.exception.bug("ccm: can\'t deal with 4GiB or more data");c=sjcl.mode.ccm.na(a,d,c,e,g.bitLength(b)/8,f);for(d=0;d<b.length;d+=4)c=a.encrypt(h(c,b.slice(d,d+4).concat([0,0,0])));return g.clamp(c,8*e)},C:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.i;var k=b.length,l=h.bitLength(b),n=k/50,m=n;c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4);d=h.bitSlice(g(d,a.encrypt(c)),0,e);if(!k)return{tag:d,data:[]};for(g=0;g<k;g+=4)g>n&&(sjcl.mode.ccm.fa(g/k),n+=m),c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d,data:h.clamp(b,l)}}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var g,h=sjcl.mode.ocb2.S,k=sjcl.bitArray,l=k.i,n=[0,0,0,0];c=h(a.encrypt(c));var m,p=[];d=d||[];e=e||64;for(g=0;g+4<b.length;g+=4)m=b.slice(g,g+4),n=l(n,m),p=p.concat(l(c,a.encrypt(l(c,m)))),c=h(c);m=b.slice(g);b=k.bitLength(m);g=a.encrypt(l(c,[0,0,0,b]));m=k.clamp(l(m.concat([0,0,0]),g),b);n=l(n,l(m.concat([0,0,0]),g));n=a.encrypt(l(n,l(c,h(c))));d.length&&(n=l(n,f?d:sjcl.mode.ocb2.pmac(a,d)));return p.concat(k.concat(m,k.clamp(n,e)))},decrypt:function(a,b,c,d,e,f){if(128!==sjcl.bitArray.bitLength(c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");e=e||64;var g=sjcl.mode.ocb2.S,h=sjcl.bitArray,k=h.i,l=[0,0,0,0],n=g(a.encrypt(c)),m,p,r=sjcl.bitArray.bitLength(b)-e,q=[];d=d||[];for(c=0;c+4<r/32;c+=4)m=k(n,a.decrypt(k(n,b.slice(c,c+4)))),l=k(l,m),q=q.concat(m),n=g(n);p=r-32*c;m=a.encrypt(k(n,[0,0,0,p]));m=k(m,h.clamp(b.slice(c),p).concat([0,0,0]));l=k(l,m);l=a.encrypt(k(l,k(n,g(n))));d.length&&(l=k(l,f?d:sjcl.mode.ocb2.pmac(a,d)));if(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))throw new sjcl.exception.corrupt("ocb: tag doesn\'t match");return q.concat(h.clamp(m,p))},pmac:function(a,b){var c,d=sjcl.mode.ocb2.S,e=sjcl.bitArray,f=e.i,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4)h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));c=b.slice(c);128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0]));g=f(g,c);return a.encrypt(f(d(f(h,d(h))),g))},S:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);b=sjcl.bitArray;d=d||[];a=sjcl.mode.gcm.C(true,a,f,d,c,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c,d,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);e=e||128;d=d||[];e<=h?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl.mode.gcm.C(false,a,f,d,c,e);if(!g.equal(a.tag,b))throw new sjcl.exception.corrupt("gcm: tag doesn\'t match");return a.data},ka:function(a,b){var c,d,e,f,g,h=sjcl.bitArray.i;e=[0,0,0,0];f=b.slice(0);for(c=0;128>c;c++){(d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f));g=0!==(f[3]&1);for(d=3;0<d;d--)f[d]=f[d]>>>1|(f[d-1]&1)<<31;f[0]>>>=1;g&&(f[0]^=-520093696)}return e},j:function(a,b,c){var d,e=c.length;b=b.slice(0);for(d=0;d<e;d+=4)b[0]^=4294967295&c[d],b[1]^=4294967295&c[d+1],b[2]^=4294967295&c[d+2],b[3]^=4294967295&c[d+3],b=sjcl.mode.gcm.ka(b,a);return b},C:function(a,b,c,d,e,f){var g,h,k,l,n,m,p,r,q=sjcl.bitArray;m=c.length;p=q.bitLength(c);r=q.bitLength(d);h=q.bitLength(e);g=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=q.concat(e,[1])):(e=sjcl.mode.gcm.j(g,[0,0,0,0],e),e=sjcl.mode.gcm.j(g,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl.mode.gcm.j(g,[0,0,0,0],d);n=e.slice(0);d=h.slice(0);a||(d=sjcl.mode.gcm.j(g,h,c));for(l=0;l<m;l+=4)n[3]++,k=b.encrypt(n),c[l]^=k[0],c[l+1]^=k[1],c[l+2]^=k[2],c[l+3]^=k[3];c=q.clamp(c,p);a&&(d=sjcl.mode.gcm.j(g,h,c));a=[Math.floor(r/4294967296),r&4294967295,Math.floor(p/4294967296),p&4294967295];d=sjcl.mode.gcm.j(g,d,a);k=b.encrypt(e);d[0]^=k[0];d[1]^=k[1];d[2]^=k[2];d[3]^=k[3];return{tag:q.bitSlice(d,0,f),data:c}}};sjcl.misc.hmac=function(a,b){this.W=b=b||sjcl.hash.sha256;var c=[[],[]],d,e=b.prototype.blockSize/32;this.w=[new b,new b];a.length>e&&(a=b.hash(a));for(d=0;d<e;d++)c[0][d]=a[d]^909522486,c[1][d]=a[d]^1549556828;this.w[0].update(c[0]);this.w[1].update(c[1]);this.R=new b(this.w[0])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){if(this.aa)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");this.update(a);return this.digest(a)};sjcl.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=false};sjcl.misc.hmac.prototype.update=function(a){this.aa=true;this.R.update(a)};sjcl.misc.hmac.prototype.digest=function(){var a=this.R.finalize(),a=new this.W(this.w[1]).update(a).finalize();this.reset();return a};sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1e4;if(0>d||0>c)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,k,l=[],n=sjcl.bitArray;for(k=1;32*l.length<(d||1);k++){e=f=a.encrypt(n.concat(b,[k]));for(g=1;g<c;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];l=l.concat(e)}d&&(l=n.clamp(l,d));return l};sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=a;this.D=false;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=3e4;this.ba=80};sjcl.prng.prototype={randomWords:function(a,b){var c=[],d;d=this.isReady(b);var e;if(d===this.u)throw new sjcl.exception.notReady("generator isn\'t seeded");if(d&this.J){d=!(d&this.I);e=[];var f=0,g;this.Z=e[0]=new Date().valueOf()+this.da;for(g=0;16>g;g++)e.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.m[g],this.m[g]=0,d||!(this.P&1<<g));g++);this.P>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.m.push(0));this.f-=f;f>this.o&&(this.o=f);this.P++;this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.L=new sjcl.cipher.aes(this.b);for(d=0;4>d&&(this.h[d]=this.h[d]+1|0,!this.h[d]);d++);}for(d=0;d<a;d+=4)0===(d+1)%this.ca&&y(this),e=z(this),c.push(e[0],e[1],e[2],e[3]);y(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=new Date().valueOf(),g=this.H[c],h=this.isReady(),k=0;d=this.U[c];void 0===d&&(d=this.U[c]=this.ha++);void 0===g&&(g=this.H[c]=0);this.H[c]=(this.H[c]+1)%this.c.length;switch(typeof a){case"number":void 0===b&&(b=1);this.c[g].update([d,this.N++,1,b,f,1,a|0]);break;case"object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(k=1),c=0;c<a.length&&!k;c++)"number"!==typeof a[c]&&(k=1);if(!k){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e=e>>>1;this.c[g].update([d,this.N++,2,b,f,a.length].concat(a))}break;case"string":void 0===b&&(b=a.length);this.c[g].update([d,this.N++,3,b,f,a.length]);this.c[g].update(a);break;default:k=1}if(k)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[g]+=b;this.f+=b;h===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},isReady:function(a){a=this.T[void 0!==a?a:this.M];return this.o&&this.o>=a?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=a?this.J|this.u:this.u},getProgress:function(a){a=this.T[a?a:this.M];return this.o>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,false),window.addEventListener("mousemove",this.a.mouseCollector,false),window.addEventListener("keypress",this.a.keyboardCollector,false),window.addEventListener("devicemotion",this.a.accelerometerCollector,false),window.addEventListener("touchmove",this.a.touchCollector,false);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl.exception.bug("can\'t attach event");this.D=true}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,false),window.removeEventListener("mousemove",this.a.mouseCollector,false),window.removeEventListener("keypress",this.a.keyboardCollector,false),window.removeEventListener("devicemotion",this.a.accelerometerCollector,false),window.removeEventListener("touchmove",this.a.touchCollector,false)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=false)},addEventListener:function(a,b){this.K[a][this.ga++]=b},removeEventListener:function(a,b){var c,d,e=this.K[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},la:function(){C(this,1)},oa:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,"mouse");C(this,0)},qa:function(a){a=a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C(this,0)},ma:function(){C(this,2)},ea:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C(this,0)}};function A(a,b){var c,d=sjcl.random.K[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}function C(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy(new Date().valueOf(),b,"loadtime")}function y(a){a.b=z(a).concat(z(a));a.L=new sjcl.cipher.aes(a.b)}function z(a){for(var b=0;4>b&&(a.h[b]=a.h[b]+1|0,!a.h[b]);b++);return a.L.encrypt(a.h)}function B(a,b){return function(){b.apply(a,arguments)}}sjcl.random=new sjcl.prng(6);a:try{if(G="undefined"!==typeof module&&module.exports){try{H=__require2("crypto")}catch(a){H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array(new Uint8Array(D).buffer),sjcl.random.addEntropy(D,1024,"crypto[\'randomBytes\']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F);else break a;sjcl.random.addEntropy(F,1024,"crypto[\'getRandomValues\']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}var D;var E;var F;var G;var H;sjcl.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json,f=e.g({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.g(f,c);c=f.adata;"string"===typeof f.salt&&(f.salt=sjcl.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl.codec.base64.toBits(f.iv));if(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)throw new sjcl.exception.invalid("json encrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,f),a=g.key.slice(0,f.ks/32),f.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(g=a.kem(),f.kemtag=g.tag,a=g.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl.codec.utf8String.toBits(b));"string"===typeof c&&(f.adata=c=sjcl.codec.utf8String.toBits(c));g=new sjcl.cipher[f.cipher](a);e.g(d,f);d.key=a;f.ct="ccm"===f.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(g,b,f.iv,c,f.ts):sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return f},encrypt:function(a,b,c,d){var e=sjcl.json,f=e.ja.apply(e,arguments);return e.encode(f)},ia:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json;b=e.g(e.g(e.g({},e.defaults),b),c,true);var f,g;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv));if(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjcl.exception.invalid("json decrypt: invalid parameters");"string"===typeof a?(g=sjcl.misc.cachedPbkdf2(a,b),a=g.key.slice(0,b.ks/32),b.salt=g.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl.codec.utf8String.toBits(f));g=new sjcl.cipher[b.cipher](a);f="ccm"===b.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(g,b.ct,b.iv,b.tag,f,b.ts):sjcl.mode[b.mode].decrypt(g,b.ct,b.iv,f,b.ts);e.g(d,b);d.key=a;return 1===c.raw?f:sjcl.codec.utf8String.fromBits(f)},decrypt:function(a,b,c,d){var e=sjcl.json;return e.ia(a,e.decode(b),c,d)},encode:function(a){var b,c="{",d="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");c+=d+\'"\'+b+\'":\';d=",";switch(typeof a[b]){case"number":case"boolean":c+=a[b];break;case"string":c+=\'"\'+escape(a[b])+\'"\';break;case"object":c+=\'"\'+sjcl.codec.base64.fromBits(a[b],0)+\'"\';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return c+"}"},decode:function(a){a=a.replace(/\\\\s/g,"");if(!a.match(/^\\\\{.*\\\\}$/))throw new sjcl.exception.invalid("json decode: this isn\'t json!");a=a.replace(/^\\\\{|\\\\}$/g,"").split(/,/);var b={},c,d;for(c=0;c<a.length;c++){if(!(d=a[c].match(/^\\\\s*(?:(["\']?)([a-z][a-z0-9]*)\\\\1)\\\\s*:\\\\s*(?:(-?\\\\d+)|"([a-z0-9+\\\\/%*_.@=\\\\-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn\'t json!");null!=d[3]?b[d[2]]=parseInt(d[3],10):null!=d[4]?b[d[2]]=d[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(d[4]):unescape(d[4]):null!=d[5]&&(b[d[2]]="true"===d[5])}return b},g:function(a,b,c){void 0===a&&(a={});if(void 0===b)return a;for(var d in b)if(b.hasOwnProperty(d)){if(c&&void 0!==a[d]&&a[d]!==b[d])throw new sjcl.exception.invalid("required parameter overridden");a[d]=b[d]}return a},sa:function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&a[d]!==b[d]&&(c[d]=a[d]);return c},ra:function(a,b){var c={},d;for(d=0;d<b.length;d++)void 0!==a[b[d]]&&(c[b[d]]=a[b[d]]);return c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.pa={};sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.pa,d;b=b||{};d=b.iter||1e3;c=c[a]=c[a]||{};d=c[d]=c[d]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=void 0===b.salt?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);return{key:d[c].slice(0),salt:c.slice(0)}};var _HTTPfrontend=class extends Service{name="http";fetchProxied=false;listening={};constructor(options,path,fetched){super(options);this.load(this);this.listen(path,fetched)}GET=(url="http://localhost:8080/ping",type="",mimeType)=>{if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"GET",url,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};POST=(message,url="http://localhost:8080/echo",type="",mimeType)=>{if(typeof message==="object"&&(type==="json"||type==="text"||!type)){message=JSON.stringify(message)}if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"POST",url,data:message,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};transmit=(message,url)=>{let obj=message;if(typeof obj==="object"){message=JSON.stringify(obj)}if(obj?.method?.toLowerCase()=="get"||message?.toLowerCase()==="get")return this.GET(url);return this.POST(message,url)};transponder=(url,message,type="",mimeType)=>{if(typeof message==="object")message=JSON.stringify(message);let method="GET";if(message){method="POST"}if(type==="json")mimeType="application/json";else return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method,url,data:message,responseType:type,onload:ev=>{let body=xhr.response;if(typeof body==="string"){let substr=body.substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\\\\\\\"))body=body.replace(/\\\\\\\\/g,"");if(body[0]===\'"\'){body=body.substring(1,body.length-1)};body=JSON.parse(body)}}if(typeof body?.method==="string"){return resolve(this.handleMethod(body.route,body.method,body.args))}else if(typeof body?.route==="string"){return resolve(this.handleServiceMessage(body))}else if(typeof body?.node==="string"||body.node instanceof GraphNode){return resolve(this.handleGraphNodeCall(body.node,body.args))}else return resolve(body)},onabort:er=>{reject(er)}})}).catch(console.error)};listen=(path="0",fetched=async(clone,args,response)=>{const result=await clone.text();const returned=this.receive(result);this.setState({[response.url]:returned})})=>{this.listening[path]={};let listenerId=\\`\\${path}\\${Math.floor(Math.random()*1e15)}\\`;this.listening[path][listenerId]=fetched;if(!this.fetchProxied){globalThis.fetch=new Proxy(globalThis.fetch,{apply(fetch,that,args){const result=fetch.apply(that,args);result.then(response=>{if(!response.ok)return;if(this.listening["0"]){for(const key in this.listeners){const clone=response.clone();this.listening["0"][key](clone,args,response)}}else{for(const key in this.listening){if(response.url.includes(key)){for(const key2 in this.listening[path]){const clone=response.clone();this.listening[path][key2](clone,args,response)}break}}}}).catch(er=>{console.error(er)});return result}});this.fetchProxied=true}return listenerId};stopListening=(path,listener)=>{if(!path&&path!==0){for(const key in this.listening)delete this.listening[key]}else{if(!listener)delete this.listening[path];else delete this.listening[listener]}}};var HTTPfrontend=_HTTPfrontend;__publicField(HTTPfrontend,"request",options=>{const xhr=new XMLHttpRequest;if(options.responseType)xhr.responseType=options.responseType;else options.responseType="json";if(options.mimeType){xhr.overrideMimeType(options.mimeType)}if(options.onload)xhr.addEventListener("load",options.onload,false);if(options.onprogress)xhr.addEventListener("progress",options.onprogress,false);if(options.onabort)xhr.addEventListener("abort",options.onabort,false);if(options.onloadend)xhr.addEventListener("loadend",options.onloadend,false);if(options.onerror)xhr.addEventListener("error",options.onerror,false);xhr.open(options.method,options.url,true,options.user,options.pass);if(!options.onerror)xhr.onerror=function(){xhr.abort()};xhr.send(options.data);return xhr});var import_web_worker=__toESM(require_browser());var WorkerService=class extends Service{name="worker";workers={};threadRot=0;connections;constructor(options){super();this.connections={workers:this.workers};if(options?.services)this.addServices(options.services);this.load(this);this.setLoaders(this.workerloader);if(options)this.init(options);if(typeof WorkerGlobalScope!=="undefined"&&globalThis instanceof WorkerGlobalScope){this.addDefaultMessageListener()}}loadWorkerRoute=(rt,routeKey)=>{if(rt.workerUrl)rt.url=rt.workerUrl;if(rt.workerId)rt.__node.tag=rt.workerId;if(!rt.__node.tag)rt.__node.tag=routeKey;rt._id=rt.__node.tag;let worker;if(this.workers[rt._id])worker=this.workers[rt._id];else if(rt.worker)worker=rt.worker;if(!worker){worker=this.addWorker(rt)}rt.worker=worker;if(!rt.worker.__ondisconnected){let ondelete=rt2=>{rt2.worker?.terminate()};rt.__addOndisconnected(ondelete)}if(rt.transferFunctions){for(const prop in rt.transferFunctions){this.transferFunction(worker,rt.transferFunctions[prop],prop)}}if(rt.transferClasses){for(const prop in rt.transferClasses){this.transferClass(worker,rt.transferClasses[prop],prop)}}if(worker){if(!rt.__operator){rt.__operator=(...args)=>{if(rt.callback){if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.post(rt.callback,args);else return worker.run(rt.callback,args)}else{if(!this.__node.nodes.get(rt.__node.tag)?.__children)worker.send(args);else return worker.request(args)}}}if(rt.init){worker.run(rt.init,rt.initArgs,void 0,rt.initTransfer)}return worker}};workerloader={"workers":(node,parent,graph,roots)=>{let rt=node;if(!node.parentRoute&&(parent?.callback&&parent?.worker))node.parentRoute=parent?.callback;if(rt?.worker||rt?.workerId||rt?.workerUrl){let worker=this.loadWorkerRoute(rt,rt.__node.tag);if(worker){if(!rt.parentRoute&&rt.__parent?.callback)rt.parentRoute=rt.__parent.callback;if(rt.__parent&&!rt.portId){if(typeof rt.__parent==="string"){if(rt.__node.tag!==rt.__parent&&worker._id!==rt.__parent)rt.portId=this.establishMessageChannel(worker,rt.__parent)}else if(rt.__node.tag!==rt.__parent?.__node?.tag&&worker._id!==rt.__parent?.tag){rt.portId=this.establishMessageChannel(worker,rt.__parent.worker)}};if(rt.parentRoute){if(!rt.stopped){if(typeof rt.__parent==="string"&&rt.__parent===worker._id){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else if(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag){worker.run("subscribe",[rt.parentRoute,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.parentRoute,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id)&&!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent){if(typeof rt.__parent==="string"){if(!rt.stopped){if(rt.__parent===worker._id){worker.run("subscribe",[rt.__parent,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent+rt.portId].sub=sub})}if(!(typeof rt.__parent==="string"&&rt.__parent===worker._id))worker.workerSubs[rt.__parent+rt.portId]={sub:null,route:worker._id,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.__parent?.__node?.tag&&rt.__parent?.worker){if(!rt.stopped){if(rt.__node.tag===rt.__parent.__node.tag||worker._id===rt.__parent.__node.tag){worker.run("subscribe",[rt.__parent.__node.tag,void 0,void 0,rt.callback])}else worker.run("subscribeToWorker",[rt.__parent.__node.tag,rt.portId,void 0,rt.callback,void 0,void 0,rt.blocking]).then(sub=>{worker.workerSubs[rt.__parent.__node.tag+rt.portId].sub=sub})}if(!(rt.__node.tag===rt.__parent?.__node?.tag||worker._id===rt.__parent?.__node?.tag))worker.workerSubs[rt.__parent.__node.tag+rt.portId]={sub:null,route:rt.__parent.__node.tag,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}}}}else if(rt.__parent&&rt.parentRoute){if(typeof rt.__parent==="string"&&roots[rt.__parent]?.worker){roots[rt.__parent].worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}else if(rt.__parent?.worker){rt.__parent.worker.subscribe(rt.parentRoute,rt.__operator,void 0,void 0,void 0,rt.blocking)}}return rt}};addDefaultMessageListener=()=>{globalThis.onmessage=ev=>{let result=this.receive(ev.data);if(this.__node.keepState)this.setState({[this.name]:result})}};postMessage=(message,target,transfer)=>{if(this.workers[target]){this.workers[target].send(message,transfer)}else{globalThis.postMessage(message,target,transfer)}};addWorker=options=>{let worker;if(!options._id)options._id=\\`worker\\${Math.floor(Math.random()*1e15)}\\`;if(options.url)worker=new import_web_worker.default(options.url);else if(options.port){worker=options.port}else if(this.workers[options._id]){if(this.workers[options._id].port)worker=this.workers[options._id].port;else worker=this.workers[options._id].worker}if(!worker)return;let send=(message,transfer)=>{return this.transmit(message,worker,transfer)};let post=(route,args,method,transfer)=>{let message={route,args};if(method)message.method=method;return this.transmit(message,worker,transfer)};let run=(route,args,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[{route,args},options._id,callbackId]};if(method)req.args[0].method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let request=(message,method,transfer)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,options._id,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let workerSubs={};let subscribe=(route,callback,args,key,subInput,blocking)=>{return this.subscribeToWorker(route,options._id,callback,args,key,subInput,blocking)};let unsubscribe=(route,sub)=>{return run("unsubscribe",[route,sub])};let start=async(route,portId,callback,blocking)=>{if(route)await run("subscribeToWorker",[route,portId,void 0,callback,blocking]).then(sub=>{if(sub)workerSubs[route+portId]={sub,route,portId,callback,blocking}});else for(const key in workerSubs){if(typeof workerSubs[key].sub!=="number")await run("subscribeToWorker",[workerSubs[key].route,workerSubs[key].portId,void 0,workerSubs[key].callback,void 0,workerSubs[key].blocking]).then(sub=>{workerSubs[key].sub=sub});console.log(JSON.stringify(workerSubs))}return true};let stop=async(route,portId)=>{if(route&&portId&&workerSubs[route+portId]){await run("unsubscribe",[route,workerSubs[route+portId].sub]);workerSubs[route+portId].sub=false}else{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){await run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub]).then(console.log)}workerSubs[key].sub=false}}return true};let terminate=()=>{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub])}workerSubs[key].sub=false}return this.terminate(options._id)};if(!options.onmessage)options.onmessage=ev=>{this.receive(ev.data);this.setState({[options._id]:ev.data})};if(!options.onerror){options.onerror=ev=>{console.error(ev.data)}}worker.onmessage=options.onmessage;worker.onerror=options.onerror;this.workers[options._id]={worker,send,post,run,request,subscribe,unsubscribe,terminate,start,stop,postMessage:worker.postMessage,workerSubs,graph:this,...options};return this.workers[options._id]};open=this.addWorker;close=()=>{globalThis.close()};toObjectURL=scriptTemplate=>{let blob=new Blob([scriptTemplate],{type:"text/javascript"});return URL.createObjectURL(blob)};getTransferable(message){let transfer;if(typeof message==="object"){if(message.args){if(message.args?.constructor?.name==="Object"){for(const key in message.args){if(ArrayBuffer.isView(message.args[key])){if(!transfer)transfer=[message.args[key].buffer];else transfer.push(message.args[key].buffer)}else if(message.args[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message.args[key]];else transfer.push(message.args[key])}}}else if(Array.isArray(message.args)&&message.args.length<11){message.args.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg?.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message.args)){transfer=[message.args.buffer]}else if(message.args?.constructor?.name==="ArrayBuffer"){transfer=[message]}}else if(message?.constructor?.name==="Object"){for(const key in message){if(ArrayBuffer.isView(message[key])){if(!transfer)transfer=[message[key].buffer];else transfer.push(message[key].buffer)}else if(message[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message[key]];else transfer.push(message[key])}}}else if(Array.isArray(message)&&message.length<11){message.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message)){transfer=[message.buffer]}else if(message.constructor?.name==="ArrayBuffer"){transfer=[message]}}return transfer}transmit=(message,worker,transfer)=>{if(!transfer){transfer=this.getTransferable(message)}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){worker.postMessage(message,transfer)}else if(typeof worker==="string"){if(this.workers[worker]){if(this.workers[worker].port)this.workers[worker].port.postMessage(message,transfer);else if(this.workers[worker].worker)this.workers[worker].worker.postMessage(message,transfer)}}else{let keys2=Object.keys(this.workers);this.workers[keys2[this.threadRot]].worker.postMessage(message,transfer);this.threadRot++;if(this.threadRot===keys2.length)this.threadRot=0}return message};terminate=worker=>{let onclose;if(typeof worker==="string"){let obj=this.workers[worker];if(obj){delete this.workers[worker];worker=obj.worker;if(obj.onclose)onclose=obj.onclose}}else if(typeof worker==="object"){if(worker?._id){worker=worker.worker;delete this.workers[worker?._id]}}if(worker instanceof import_web_worker.default){worker.terminate();if(onclose)onclose(worker);return true}if(worker instanceof MessagePort){worker.close();if(onclose)onclose(worker);return true}return false};establishMessageChannel=(worker,worker2)=>{let workerId;if(typeof worker==="string"){workerId=worker;if(this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker2=this.workers[worker].worker}}else if(worker?.worker){worker=worker.worker}if(typeof worker2==="string"){if(this.workers[worker2]){if(this.workers[worker2].port)worker2=this.workers[worker2].port;else worker2=this.workers[worker2].worker}}else if(worker2?.worker){worker2=worker2.worker}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){let channel=new MessageChannel;let portId=\\`port\\${Math.floor(Math.random()*1e15)}\\`;worker.postMessage({route:"addWorker",args:{port:channel.port1,_id:portId}},[channel.port1]);if(worker2 instanceof import_web_worker.default||worker2 instanceof MessagePort){worker2.postMessage({route:"addWorker",args:{port:channel.port2,_id:portId}},[channel.port2])}else if(workerId&&this.workers[workerId]){channel.port2.onmessage=this.workers[workerId].onmessage;this.workers[workerId].port=channel.port2}return portId}return false};request=(message,workerId,transfer,method)=>{let worker=this.workers[workerId].worker;return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};runRequest=(message,worker,callbackId)=>{let res=this.receive(message);if(typeof worker==="string"&&this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}if(res instanceof Promise){res.then(r=>{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:r,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:r,callbackId})})}else{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:res,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:res,callbackId})}return res};subscribeWorker=(route,worker,args,key,subInput,blocking)=>{let callback;if(blocking){let blocked=false;callback=res=>{if(!blocked){blocked=true;if(res instanceof Promise){res.then(r=>{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,r]).then(ret=>{blocked=false})})}else{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,res]).then(ret=>{blocked=false})}}}}else{callback=res=>{if(res instanceof Promise){res.then(r=>{if(worker?.postMessage)worker.postMessage({args:r,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:r,callbackId:route})})}else{if(worker?.postMessage)worker.postMessage({args:res,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:res,callbackId:route})}}}if(!blocking&&worker?.port){worker=worker.port}else if(!blocking&&worker?.worker){worker=worker.worker}else if(typeof worker==="string"&&this.workers[worker]){if(blocking)worker=this.workers[worker];else if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}return this.subscribe(route,callback,args,key,subInput)};subscribeToWorker=(route,workerId,callback,args,key,subInput,blocking)=>{if(typeof workerId==="string"&&this.workers[workerId]){this.__node.state.subscribeEvent(workerId,res=>{if(res?.callbackId===route){if(!callback)this.setState({[workerId]:res.args});else if(typeof callback==="string"){this.run(callback,res.args)}else callback(res.args)}});return this.workers[workerId].run("subscribeWorker",[route,workerId,args,key,subInput,blocking])}};triggerSubscription=async(route,workerId,result)=>{if(this.__node.state.triggers[workerId])for(let i2=0;i2<this.__node.state.triggers[workerId].length;i2++){await this.__node.state.triggers[workerId][i2].onchange({args:result,callbackId:route})}return true};pipeWorkers=(sourceWorker,listenerWorker,sourceRoute,listenerRoute,portId,args,key,subInput,blocking)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof listenerWorker==="string")listenerWorker=this.workers[listenerWorker];if(!portId){portId=this.establishMessageChannel(sourceWorker.worker,listenerWorker.worker)}return listenerWorker.run("subscribeToWorker",[sourceRoute,portId,listenerRoute,args,key,subInput,blocking])};unpipeWorkers=(sourceRoute,sourceWorker,sub)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof sourceWorker==="object"){return sourceWorker.run("unsubscribe",[sourceRoute,sub])}}};var mouseEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]);var wheelEventHandlerImpl=makeSendPropertiesHandler(["deltaX","deltaY"]);var keydownEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function focusEventHandler(event,sendFn){const data={type:event.type};data.isTrusted=event.isTrusted;data.bubbles=event.bubbles;data.cancelBubble=event.cancelBubble;data.cancelable=event.cancelable;data.composed=event.composed;data.defaultPrevent=event.defaultPrevented;data.eventPhase=event.eventPhase;data.returnValue=event.returnValue;data.currentTarget=event.currentTarget.id?event.currentTarget.id:event.currentTarget.constructor.name;data.target=data.currentTarget;data.srcElement=data.currentTarget;sendFn(data)}function wheelEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();wheelEventHandlerImpl(event,sendFn)}function preventDefaultHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault()}function copyProperties(src,properties,dst){for(const name2 of properties){dst[name2]=src[name2]}}function makeSendPropertiesHandler(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties(event,properties,data);sendFn(data)}}function touchEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();const touches=[];const data={type:event.type,touches};for(let i2=0;i2<event.touches.length;++i2){const touch=event.touches[i2];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var i=1;var keys={};while(i<222){keys[i]=true;i++}function filteredKeydownEventHandler(event,sendFn,preventDefault){let{keyCode}=event;if(keys[keyCode]){if(preventDefault&&event.preventDefault&&(keyCode<110||keyCode>123))event.preventDefault();keydownEventHandler(event,sendFn)}}var eventHandlers={contextmenu:preventDefaultHandler,mousedown:mouseEventHandler,mousemove:mouseEventHandler,mouseup:mouseEventHandler,pointerdown:mouseEventHandler,pointermove:mouseEventHandler,pointerup:mouseEventHandler,pointerlockchange:mouseEventHandler,webkitpointerlockchange:mouseEventHandler,focus:focusEventHandler,blur:focusEventHandler,pointerout:mouseEventHandler,touchstart:touchEventHandler,touchmove:touchEventHandler,touchend:touchEventHandler,wheel:wheelEventHandler,keydown:filteredKeydownEventHandler,keyup:filteredKeydownEventHandler};function initProxyElement(element,worker,id,preventDefault){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{if(!worker){handleProxyEvent(data,id)}else worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent,preventDefault)})}if(eventHandlers.keydown){globalThis.addEventListener("keydown",function(ev){eventHandlers.keydown(ev,sendEvent,preventDefault)})}if(eventHandlers.keyup){globalThis.addEventListener("keyup",function(ev){eventHandlers.keyup(ev,sendEvent,preventDefault)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher=class{__listeners;addEventListener(type,listener){if(this.__listeners===void 0)this.__listeners={};const listeners=this.__listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this.__listeners===void 0)return false;const listeners=this.__listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i2=0,l=array.length;i2<l;i2++){array[i2].call(this,event)}}}};function noop(){}var ElementProxyReceiver=class extends EventDispatcher{__listeners={};proxied;style={};width;left;right;top;height;constructor(){super();this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}setPointerCapture=()=>{};releasePointerCapture=()=>{};getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.style.width=this.width+"px";this.proxied.style.height=this.height+"px";this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop;data.stopPropagation=noop;this.dispatchEvent(data,this.proxied)};focus(){}blur(){}};var ProxyManager=class{targets={};constructor(){if(!globalThis.document)globalThis.document={elementFromPoint:(...args)=>{return this.targets[Object.keys(this.targets)[0]].proxied}}}makeProxy=(id,addTo=void 0)=>{if(!id)id=\\`proxyReceiver\\${Math.floor(Math.random()*1e15)}\\`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;if(typeof WorkerGlobalScope!=="undefined")addTo.style=proxy.style;if(proxy.width){addTo.style.width=proxy.width+"px";addTo.clientWidth=proxy.width}if(proxy.height){addTo.style.height=proxy.height+"px";addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy);addTo.blur=proxy.blur.bind(proxy)}};getProxy=id=>{return this.targets[id]};handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0}};function makeProxy(id,elm){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;this.__node.graph.ProxyManager.makeProxy(id,elm)}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;globalThis.ProxyManager.makeProxy(id,elm)}return id}function handleProxyEvent(data,id){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;if(this.__node.graph.ProxyManager.handleEvent(data,id))return data}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;if(globalThis.ProxyManager.handleEvent(data,id))return data}}var proxyElementWorkerRoutes={initProxyElement,makeProxy,handleProxyEvent};function Renderer(options){if(options.worker){let worker=options.worker;let route=options.route;if(worker instanceof Blob||typeof worker==="string"){worker=new Worker(worker)}delete options.worker;delete options.route;return transferCanvas(worker,options,route)}else{initProxyElement(options.canvas,void 0,options._id,options.preventDefault);return setupCanvas(options)}}function transferCanvas(worker,options,route){if(!options)return void 0;if(!options._id)options._id=\\`canvas\\${Math.floor(Math.random()*1e15)}\\`;let offscreen=options.canvas.transferControlToOffscreen();if(!options.width)options.width=options.canvas.clientWidth;if(!options.height)options.height=options.canvas.clientHeight;let message={route:route?route:"setupCanvas",args:{...options,canvas:offscreen}};if(this?.__node?.graph)this.__node.graph.run("initProxyElement",options.canvas,worker,options._id,options.preventDefault);else initProxyElement(options.canvas,worker,options._id,options.preventDefault);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let tr=[offscreen];if(options.transfer){tr.push(...options.transfer);delete options.transfer}worker.postMessage(message,tr);const canvascontrols={_id:options._id,width:options.width,height:options.height,worker,draw:(props,transfer)=>{worker.postMessage({route:"drawFrame",args:[props,options._id]},transfer)},update:(props,transfer)=>{worker.postMessage({route:"updateCanvas",args:[props,options._id]},transfer)},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:(newDrawProps,transfer)=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]},transfer)},terminate:()=>{worker.terminate()}};return canvascontrols}function setDraw(settings,_id){let canvasopts;if(this?.__node?.graph){if(_id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]}else{if(_id)canvasopts=globalThis.CANVASES?.[settings._id];else if(settings._id)canvasopts=globalThis.CANVASES?.[settings._id];else canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]]}if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasopts._id,canvasopts.canvas);else proxyElementWorkerRoutes.makeProxy(canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText3(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw.bind(settings)}if(typeof settings.update==="string")settings.update=parseFunctionFromText3(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update.bind(settings)}if(typeof settings.init==="string")settings.init=parseFunctionFromText3(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init.bind(settings)}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText3(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear.bind(settings)}return settings._id}return void 0}function setupCanvas(options){if(this?.__node?.graph){if(!this.__node.graph.CANVASES)this.__node.graph.CANVASES={}}else if(!globalThis.CANVASES)globalThis.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=\\`canvas\\${Math.floor(Math.random()*1e15)}\\`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this?.__node?.graph?.CANVASES[canvasOptions._id]){this.__node.graph.run("setDraw",canvasOptions)}else if(globalThis.CANVASES?.[canvasOptions._id]){setDraw(canvasOptions)}else{if(this?.__node?.graph){canvasOptions.graph=this.__node.graph;if(!canvasOptions.__node){canvasOptions.__node={}}if(!canvasOptions.__node.tag)canvasOptions.__node.tag=canvasOptions._id;canvasOptions=this.__node.graph.add(canvasOptions);canvasOptions.__addOndisconnected=()=>{canvasOptions.stop();delete this.__node.graph.CANVASES[canvasOptions._id]}}if(this?.__node?.graph)this.__node.graph.CANVASES[canvasOptions._id]=canvasOptions;else globalThis.CANVASES[canvasOptions._id]=canvasOptions;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);else proxyElementWorkerRoutes.makeProxy(canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText3(canvasOptions.draw)}else if(typeof canvasOptions.draw==="function"){canvasOptions.draw=canvasOptions.draw.bind(canvasOptions)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText3(canvasOptions.update)}else if(typeof canvasOptions.update==="function"){canvasOptions.update=canvasOptions.update.bind(canvasOptions)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText3(canvasOptions.init)}else if(typeof canvasOptions.init==="function"){canvasOptions.init=canvasOptions.init.bind(canvasOptions)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText3(canvasOptions.clear)}else if(typeof canvasOptions.clear==="function"){canvasOptions.clear=canvasOptions.clear.bind(canvasOptions)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);canvasOptions.stop=()=>{stopAnim(canvasOptions._id)};canvasOptions.start=draw=>{startAnim(canvasOptions._id,draw)};canvasOptions.set=settings=>{setDraw(settings,canvasOptions._id)};if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)return canvasOptions._id;else{const canvascontrols={_id:options._id,width:options.width,height:options.height,draw:props=>{drawFrame(props,options._id)},update:props=>{updateCanvas(props,options._id)},clear:()=>{clearCanvas(options._id)},init:()=>{initCanvas(options._id)},stop:()=>{stopAnim(options._id)},start:()=>{startAnim(options._id)},set:newDrawProps=>{setDraw(newDrawProps,options._id)},terminate:()=>{if(this.__node?.graph)this.__node.graph.remove(options._id);else{stopAnim(options._id);if(this?.__node?.graph)delete this.__node.graph.CANVASES[canvasOptions._id];else delete globalThis.CANVASES[canvasOptions._id]}}};return canvascontrols}}function drawFrame(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0}function clearCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function initCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function updateCanvas(input,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0}function setProps(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0}function startAnim(_id,draw){let canvasopts=getCanvas.call(this,_id);canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText3(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function stopAnim(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")requestAnimationFrame(canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context));return _id}return void 0}function getCanvas(_id){let canvasopts;if(this?.__node?.graph){if(!_id)canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]];else canvasopts=this.__node.graph.CANVASES?.[_id]}else{if(!_id)canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]];else canvasopts=globalThis.CANVASES?.[_id]}return canvasopts}var workerCanvasRoutes={...proxyElementWorkerRoutes,Renderer,transferCanvas,setupCanvas,setDraw,drawFrame,clearCanvas,initCanvas,updateCanvas,setProps,startAnim,stopAnim,getCanvas};function parseFunctionFromText3(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\\\W*(function[^{]+\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>[^{]*\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var _ArrayManip=class{constructor(){this.recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"){if(typeof target[key]==="object")this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target}}static autoscale(array,lineIdx=0,nLines=1,centerZero=false,ymin,ymax,clamp){if(array?.length===0)return array;let max=ymax?ymax:Math.max(...array);let min=ymin?ymin:Math.min(...array);let _lines=1/nLines;let scalar=1;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));if(absmax!==0)scalar=_lines/absmax;return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return y2*scalar+(_lines*(lineIdx+1)*2-1-_lines)})}else{if(max===min){if(max!==0){scalar=_lines/max}else if(min!==0){scalar=_lines/Math.abs(min)}}else scalar=_lines/(max-min);return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return 2*((y2-min)*scalar-1/(2*nLines))+(_lines*(lineIdx+1)*2-1-_lines)})}}static genTimestamps(ct,sps10){let now=Date.now();let toInterp=[now-ct*1e3/sps10,now];return _ArrayManip.upsample(toInterp,ct)}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i2=incr;i2<array.length;i2+=incr){let rounded=Math.round(i2);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static upsample(array,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array(fitCount);var springFactor=(array.length-1)/(fitCount-1);newData[0]=array[0];for(var i2=1;i2<fitCount-1;i2++){var tmp=i2*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i2]=linearInterpolate(array[before],array[after],atPoint)}newData[fitCount-1]=array[array.length-1];return newData}static interpolate(array,fitCount,scalar=1){if(array.length>fitCount){return _ArrayManip.downsample(array,fitCount,scalar)}else if(array.length<fitCount){return _ArrayManip.upsample(array,fitCount,scalar)}return array}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x;b=0}else if(60<=h&&h<120){r=x;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x}else if(180<=h&&h<240){r=0;g=x;b=c}else if(240<=h&&h<300){r=x;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static circularBuffer(arr,newEntries){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,newEntries.slice(len-newEntries.length))}else{arr.splice(0,arr.length,...newEntries)}return arr}static reformatData(data,key){if(Array.isArray(data)){if(Array.isArray(data[0])){let d={};data.forEach((arr,i2)=>{d[i2]=arr});data=d;if(isNaN(data[0][0]))return void 0}else if(key){data={[key]:data};if(isNaN(data[key][0]))return void 0}else{data={0:data};if(isNaN(data[0][0]))return void 0}}else if(typeof data==="object"){for(const key2 in data){if(typeof data[key2]==="number")data[key2]=[data[key2]];else if(data[key2]?.values){if(typeof data[key2].values==="number")data[key2].values=[data[key2].values]}if(isNaN(data[key2][0]))return void 0}}else if(typeof data==="string"){let split;if(data.includes("\\\\r\\\\n")){let lines=data.split("\\\\r\\\\n");data={};lines.forEach((l,j)=>{if(l.includes("	")){split=l.split("	")}else if(l.includes(",")){split=l.split(",")}else if(l.includes("|")){split=l.split("|")}if(Array.isArray(split)){split.forEach((val,i2)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl=parseFloat(v);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i2]=[fl];else return void 0}})}})}else if(data.includes("	")){split=data.split("	")}else if(data.includes(",")){split=data.split(",")}else if(data.includes("|")){split=data.split("|")}data={};if(Array.isArray(split)){split.forEach((val,i2)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl=parseFloat(v);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i2]=[fl];else return void 0}})}}else if(typeof data==="number"){if(key)data={[key]:[data]};else data={0:[data]}}return data}static padTime(data,lastValue,time,targetFit){let slopeIncr=(data[0]-lastValue)/time/targetFit;let padded=[...new Array(targetFit-data.length).map((_,i2)=>lastValue+slopeIncr*(i2+1)),...data];return padded}static interpolateForTime(data,time,targetSPS){return _ArrayManip.interpolate(data,Math.ceil(targetSPS*time))}isTypedArray(x){return ArrayBuffer.isView(x)&&Object.prototype.toString.call(x)!=="[object DataView]"}spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var ArrayManip=_ArrayManip;ArrayManip.bufferValues=(objects,property,keys2,buffer)=>{if(!Array.isArray(keys2)&&typeof keys2==="object")keys2=Object.keys(keys2);if(!buffer){let object_keys=Object.keys(objects);if(keys2)buffer=new Float32Array(object_keys.length*keys2.length);else{if(typeof objects[object_keys[0]][property]==="object"){keys2=Object.keys(objects[object_keys[0]][property]);buffer=new Float32Array(object_keys.length*keys2.length)}else buffer=new Float32Array(object_keys.length)}}let i2=0;for(const key in objects){if(objects[key][property]){if(keys2){for(let j=0;j<keys2.length;j++){buffer[i2]=objects[key][property][keys2[j]];i2++}}else{buffer[i2]=objects[key][property];i2++}}}return buffer};var rechk=/^([<>])?(([1-9]\\\\d*)?([xcbB?hHiIfdsp]))*$/;var refmt=/([1-9]\\\\d*)?([xcbB?hHiIfdsp])/g;var str=(v,o,c)=>String.fromCharCode(...new Uint8Array(v.buffer,v.byteOffset+o,c));var rts=(v,o,c,s)=>new Uint8Array(v.buffer,v.byteOffset+o,c).set(s.split("").map(str2=>str2.charCodeAt(0)));var pst=(v,o,c)=>str(v,o+1,Math.min(v.getUint8(o),c-1));var tsp=(v,o,c,s)=>{v.setUint8(o,s.length);rts(v,o+1,c-1,s)};var lut=le=>({x:c=>[1,c,0],c:c=>[c,1,o=>({u:v=>str(v,o,1),p:(v,c2)=>rts(v,o,1,c2)})],"?":c=>[c,1,o=>({u:v=>Boolean(v.getUint8(o)),p:(v,B2)=>v.setUint8(o,B2)})],b:c=>[c,1,o=>({u:v=>v.getInt8(o),p:(v,b)=>v.setInt8(o,b)})],B:c=>[c,1,o=>({u:v=>v.getUint8(o),p:(v,B2)=>v.setUint8(o,B2)})],h:c=>[c,2,o=>({u:v=>v.getInt16(o,le),p:(v,h)=>v.setInt16(o,h,le)})],H:c=>[c,2,o=>({u:v=>v.getUint16(o,le),p:(v,H2)=>v.setUint16(o,H2,le)})],i:c=>[c,4,o=>({u:v=>v.getInt32(o,le),p:(v,i2)=>v.setInt32(o,i2,le)})],I:c=>[c,4,o=>({u:v=>v.getUint32(o,le),p:(v,I)=>v.setUint32(o,I,le)})],f:c=>[c,4,o=>({u:v=>v.getFloat32(o,le),p:(v,f)=>v.setFloat32(o,f,le)})],d:c=>[c,8,o=>({u:v=>v.getFloat64(o,le),p:(v,d)=>v.setFloat64(o,d,le)})],s:c=>[1,c,o=>({u:v=>str(v,o,c),p:(v,s)=>rts(v,o,c,s.slice(0,c))})],p:c=>[1,c,o=>({u:v=>pst(v,o,c),p:(v,s)=>tsp(v,o,c,s.slice(0,c-1))})]});var errbuf=new RangeError("Structure larger than remaining buffer");var errval=new RangeError("Not enough values for structure");var _ByteParser=class extends ArrayManip{static toDataView(value){if(!(value instanceof DataView)){if(typeof value==="string"&&parseInt(value))value=parseInt(value);if(typeof value==="string"){let enc=new TextEncoder;let hascodes={};for(const code in _ByteParser.codes){while(value.indexOf(code)>-1){let idx=value.indexOf(code);value=value.replace(code,"");hascodes[idx]=code}}let encoded=Array.from(enc.encode(value));for(const key in hascodes){encoded.splice(parseInt(key),0,_ByteParser.codes[hascodes[key]])}value=new DataView(new Uint8Array(encoded).buffer)}else if(typeof value==="number"){let tmp=value;if(value<256){value=new DataView(new ArrayBuffer(1));value.setUint8(0,tmp)}else if(value<65536){value=new DataView(new ArrayBuffer(2));value.setInt16(0,tmp)}else{value=new DataView(new ArrayBuffer(4));value.setUint32(0,tmp)}}else if(value instanceof ArrayBuffer||typeof SharedArrayBuffer!=="undefined"&&value instanceof SharedArrayBuffer){value=new DataView(value)}else if(Array.isArray(value)){value=new DataView(Uint8Array.from(value).buffer)}else if(typeof value==="object"){value=new TextEncoder().encode(JSON.stringify(value))}}return value}static searchBuffer(buffer,searchString,limit){var needle=searchString;var haystack=buffer;var search=_ByteParser.boyerMoore(needle);var skip=search.byteLength;var indices=[];for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){indices.push(i2);if(limit){if(indices.length>=limit)break}}return indices}static bytesToInt16(x0,x1){let int16=(255&x0)<<8|255&x1;if((int16&32768)>0){int16|=4294901760}else{int16&=65535}return int16}static bytesToUInt16(x0,x1){return x0*256+x1}static Uint16ToBytes(y2){return[y2&255,y2>>8&255]}static bytesToInt24(x0,x1,x2){let int24=(255&x0)<<16|(255&x1)<<8|255&x2;if((int24&8388608)>0){int24|=4278190080}else{int24&=16777215}return int24}static bytesToUInt24(x0,x1,x2){return x0*65536+x1*256+x2}static Uint24ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255]}static bytesToInt32(x0,x1,x2,x3){let int32=(255&x0)<<24|(255&x1)<<16|(255&x2)<<8|255&x3;if((int32&2147483648)>0){int32|=0}else{int32&=4294967295}return int32}static bytesToUInt32(x0,x1,x2,x3){return x0*16777216+x1*65536+x2*256+x3}static Uint32ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255,y2>>24&255]}static get2sCompliment(val,nbits4){if(val>4294967296)return null;return val<<32-nbits4>>32-nbits4}static getSignedInt(...args){let pos=0;function getInt(size){var value=0;var first=true;while(size--){if(first){let byte=args[pos++];value+=byte&127;if(byte&128){value-=128}first=false}else{value*=256;value+=args[pos++]}}return value}return getInt(args.length)}static asUint8Array(input){if(input instanceof Uint8Array){return input}else if(typeof input==="string"){var arr=new Uint8Array(input.length);for(var i2=0;i2<input.length;i2++){var c=input.charCodeAt(i2);if(c>127){throw new TypeError("Only ASCII patterns are supported")}arr[i2]=c}return arr}else{return new Uint8Array(input)}}static boyerMoore(patternBuffer){var pattern=_ByteParser.asUint8Array(patternBuffer);var M=pattern.length;if(M===0){throw new TypeError("patternBuffer must be at least 1 byte long")}var R=256;var rightmost_positions=new Int32Array(R);for(var c=0;c<R;c++){rightmost_positions[c]=-1}for(var j=0;j<M;j++){rightmost_positions[pattern[j]]=j}var boyerMooreSearch=(txtBuffer,start,end)=>{var txt=_ByteParser.asUint8Array(txtBuffer);if(start===void 0)start=0;if(end===void 0)end=txt.length;var pat=pattern;var right=rightmost_positions;var lastIndex=end-pat.length;var lastPatIndex=pat.length-1;var skip;for(var i2=start;i2<=lastIndex;i2+=skip){skip=0;for(var j2=lastPatIndex;j2>=0;j2--){var c2=txt[i2+j2];if(pat[j2]!==c2){skip=Math.max(1,j2-right[c2]);break}}if(skip===0){return i2}}return-1};boyerMooreSearch.byteLength=pattern.byteLength;return boyerMooreSearch}static struct(format){let fns=[],size=0,m=rechk.exec(format);if(!m){throw new RangeError("Invalid format string")}const t2=lut("<"===m[1]),lu=(n,c)=>t2[c](n?parseInt(n,10):1);while(m=refmt.exec(format)){((r,s,f)=>{for(let i2=0;i2<r;++i2,size+=s){if(f){fns.push(f(size))}}})(...lu(...m.slice(1)))}const unpack_from=(arrb,offs)=>{if(arrb.byteLength<(offs|0)+size){throw errbuf}let v=new DataView(arrb,offs|0);return fns.map(f=>f.u(v))};const pack_into=(arrb,offs,...values)=>{if(values.length<fns.length){throw errval}if(arrb.byteLength<offs+size){throw errbuf}const v=new DataView(arrb,offs);new Uint8Array(arrb,offs,size).fill(0);fns.forEach((f,i2)=>f.p(v,values[i2]))};const pack=(...values)=>{let b=new ArrayBuffer(size);pack_into(b,0,...values);return b};const unpack=arrb=>unpack_from(arrb,0);function*iter_unpack(arrb){for(let offs=0;offs+size<=arrb.byteLength;offs+=size){yield unpack_from(arrb,offs)}}return Object.freeze({unpack,pack,unpack_from,pack_into,iter_unpack,format,size})}};var ByteParser=_ByteParser;ByteParser.codes={"\\\\\\\\n":10,"\\\\\\\\r":13,"\\\\\\\\t":9,"\\\\\\\\s":32,"\\\\\\\\b":8,"\\\\\\\\f":12,"\\\\\\\\":92};(function(s){var w,f={},l=console,m=Math,z2="postMessage",x="HackTimer.js by turuslan: ",v="Initialisation failed",p=0,r="hasOwnProperty",y2=[].slice,b=Worker;function d(){do{p=2147483647>p?p+1:0}while(f[r](p));return p}if(!/MSIE 10/i.test(navigator.userAgent)){try{s=URL.createObjectURL(new Blob(["var f={},p=postMessage,r=\'hasOwnProperty\';onmessage=function(e){var d=e.data,i=d.i,t=d[r](\'t\')?d.t:0;switch(d.n){case\'a\':f[i]=setInterval(function(){p(i)},t);break;case\'b\':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case\'c\':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case\'d\':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch(e){}}if(typeof b!=="undefined"){try{w=new b(s);setInterval=function(c,t2){var i2=d();f[i2]={c,p:y2.call(arguments,2)};w[z2]({n:"a",i:i2,t:t2});return i2};clearInterval=function(i2){if(f[r](i2))delete f[i2],w[z2]({n:"b",i:i2})};setTimeout=function(c,t2){var i2=d();f[i2]={c,p:y2.call(arguments,2),t:true};w[z2]({n:"c",i:i2,t:t2});return i2};clearTimeout=function(i2){if(f[r](i2))delete f[i2],w[z2]({n:"d",i:i2})};w.onmessage=function(e){var i2=e.data,c,n;if(f[r](i2)){n=f[i2];c=n.c;if(n[r]("t"))delete f[i2]}if(typeof c=="string")try{c=new Function(c)}catch(k){l.log(x+"Error parsing callback code string: ",k)}if(typeof c=="function")c.apply(globalThis,n.p)};w.onerror=function(e){l.log(e)}}catch(e){l.log(x+v);l.error(e)}}else l.log(x+v+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js");var WebSerial=class extends ByteParser{constructor(){super(...arguments);this.streams={};this.createStream=options=>{let stream={_id:options._id?options._id:\\`stream\\${Math.floor(Math.random()*1e15)}\\`,info:options.port.getInfo(),running:false,...options};if(options.port?.readable){if(options.transforms){stream.reader=WebSerial.setStreamTransforms(options.port.readable,options.transforms).getReader()}else{stream.reader=options.port.readable.getReader()}}this.streams[stream._id]=stream;return stream}}getPorts(){return navigator.serial.getPorts()}requestPort(usbVendorId,usbProductId){let options={};if(usbVendorId){options.usbVendorId=usbVendorId}if(usbProductId){options.usbProductId=usbProductId}if(options.usbVendorId)return navigator.serial.requestPort({filters:[options]});else return navigator.serial.requestPort()}openPort(port,options){if(options)options=Object.assign({},options);if(options?.ondisconnect){port.ondisconnect=options.ondisconnect;delete options.ondisconnect}return port.open(options).then(()=>{if(options?.onconnect)options.onconnect(port)})}async readWithTimeout(port,timeout){const reader=port.readable.getReader();const timer=setTimeout(()=>{reader.releaseLock()},timeout);const result=await reader.read();clearTimeout(timer);reader.releaseLock();return result}async writePort(port,message){const writer=port.writable.getWriter();await writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}getSignals(port){return port.getSignals()}setSignals(port,signals){return port.setSignals(signals)}readStream(stream){if(stream.reader&&!stream.running){let reader=stream.reader;if(stream.buffering){if(typeof stream.buffering!=="object")stream.buffering={};if(!stream.buffering.buffer){stream.buffering.buffer=[]}if(!stream.buffering.searchBytes)stream.buffering.searchBytes=new Uint8Array([13,10])}let readLoop=()=>{if(stream.port.readable&&stream.running){reader.read().then(result=>{if(result.done)reader.releaseLock();else{if(stream.buffering){stream.buffering.buffer.push(...result.value);const needle=stream.buffering.searchBytes;const haystack=stream.buffering.buffer;const search=WebSerial.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=stream.buffering.lockIdx??0;for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){if(!stream.buffering.locked&&!("lockIdx"in stream.buffering))used=stream.buffering.lockIdx=i2;else{nextIndex=i2;if(nextIndex>=0){const len=nextIndex-used;if(!stream.buffering.locked){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(data);stream.buffering.locked=true}else if(len>0){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(new Uint8Array(data))}used=nextIndex}}}}else stream.ondata(result.value);setTimeout(()=>{readLoop()},stream.frequency)}}).catch(er=>{console.error(stream._id," Read error:",er);if(er.message.includes("overrun")||er.message.includes("framing")){delete stream.reader;this.reconnect(stream)}})}else if(!stream.running&&stream.port.readable){try{reader.releaseLock()}catch(er){console.error(er)}}};stream.running=true;readLoop();return stream}return void 0}writeStream(stream,message){if(typeof stream==="string")stream=this.streams[stream];if(stream.port.writable){let writer=stream.port.writable.getWriter();writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}return void 0}closeStream(stream,onclose){if(typeof stream==="string")stream=this.streams[stream];stream.running=false;return new Promise((res,rej)=>{if(stream.settings.beforedisconnect){stream.settings.beforedisconnect(this,stream.port)}setTimeout(async()=>{if(stream.port.readable&&stream.reader){try{stream.reader.releaseLock()}catch(er){console.error(er)}if(stream.transforms)try{await stream.reader.cancel()}catch(err){console.error(err)}}try{await stream.port.close().then(()=>{if(onclose)onclose(this.streams[stream._id])});delete this.streams[stream._id];res(true)}catch(er){rej(er)}},300)})}reconnect(stream,options){if(typeof stream==="string")stream=this.streams[stream];return new Promise((res,rej)=>{if(typeof stream!=="object"){rej(void 0);return}let info=stream.port.getInfo();this.closeStream(stream._id).then(closed=>{setTimeout(()=>{this.getPorts().then(ports=>{for(let i2=0;i2<ports.length;i2++){if(ports[i2].getInfo().usbVendorId===info.usbVendorId&&ports[i2].getInfo().usbProductId===info.usbProductId){if(!options)options=stream;else options._id=stream._id;delete options.port;this.openPort(ports[i2],options.settings).then(()=>{const stream2=this.createStream({...options,port:ports[i2]});this.readStream(stream2);res(stream2)}).catch(rej)}}}).catch(rej)},100)})})}static setStreamTransforms(stream,transforms){let transform=[];Object.keys(transforms).forEach(t2=>{let opt=transforms[t2];if(opt instanceof TransformStream){transform.push(opt)}else{if(!opt.start)opt.start=function start(){};if(!opt.flush)opt.flush=function flush(){};let transformer=new TransformStream({start:opt.start,transform:opt.transform,flush:opt.flush},opt.writableStrategy,opt.readableStrategy);transform.push(transformer)}});let str2=stream;transform.forEach(transform2=>{str2=str2.pipeThrough(transform2)});return str2}};var sps=250;var gain=32;var nbits=24;var vref=1.2;var half24bit=Math.pow(2,24)/2;function ads131m08codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i2=0;i2<9;i2++){let j=i2*25;output[0][i2]=ByteParser.bytesToInt24(arr[j],arr[j+1],arr[j+2]);output[1][i2]=ByteParser.bytesToInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i2]=ByteParser.bytesToInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i2]=ByteParser.bytesToInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i2]=ByteParser.bytesToInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i2]=ByteParser.bytesToInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i2]=ByteParser.bytesToInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i2]=ByteParser.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])}if(arr.length>225){output.leds=arr.slice(225)}return output}function ads131m08codec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i2=0;i2<9;i2++){let j=i2*25;output[0][i2]=ByteParser.bytesToInt24(arr[j],arr[j+1],arr[j+2])+half24bit;output[1][i2]=ByteParser.bytesToInt24(arr[j+3],arr[j+4],arr[j+5])+half24bit;output[2][i2]=ByteParser.bytesToInt24(arr[j+6],arr[j+7],arr[j+8])+half24bit;output[3][i2]=ByteParser.bytesToInt24(arr[j+9],arr[j+10],arr[j+11])+half24bit;output[4][i2]=ByteParser.bytesToInt24(arr[j+12],arr[j+13],arr[j+14])+half24bit;output[5][i2]=ByteParser.bytesToInt24(arr[j+15],arr[j+16],arr[j+17])+half24bit;output[6][i2]=ByteParser.bytesToInt24(arr[j+18],arr[j+19],arr[j+20])+half24bit;output[7][i2]=ByteParser.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])+half24bit}if(arr.length>225){output.leds=arr.slice(225)}return output}var decoder=new TextDecoder;function ads131m08_arduinocodec(data){const parsed=decoder.decode(data);let split;if(parsed.includes("|"))split=parsed.split("|");else if(split.includes(","))split=parsed.split(",");else split=parsed.split("	");return{"0":parseInt(split[0]),"1":parseInt(split[1]),"2":parseInt(split[2]),"3":parseInt(split[3]),"4":parseInt(split[4]),"5":parseInt(split[5]),"6":parseInt(split[6]),"7":parseInt(split[7]),timestamp:Date.now()}}var defaultChartSetting={nSec:10,sps,units:"mV"};var ads131m08ChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting)),"1":JSON.parse(JSON.stringify(defaultChartSetting)),"2":JSON.parse(JSON.stringify(defaultChartSetting)),"3":JSON.parse(JSON.stringify(defaultChartSetting)),"4":JSON.parse(JSON.stringify(defaultChartSetting)),"5":JSON.parse(JSON.stringify(defaultChartSetting)),"6":JSON.parse(JSON.stringify(defaultChartSetting)),"7":JSON.parse(JSON.stringify(defaultChartSetting))}};var defaultsetting={sps,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))};var halfOffset=.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))*(Math.pow(2,nbits)-1)*.5;var ads131m08FilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting)),"1":JSON.parse(JSON.stringify(defaultsetting)),"2":JSON.parse(JSON.stringify(defaultsetting)),"3":JSON.parse(JSON.stringify(defaultsetting)),"4":JSON.parse(JSON.stringify(defaultsetting)),"5":JSON.parse(JSON.stringify(defaultsetting)),"6":JSON.parse(JSON.stringify(defaultsetting)),"7":JSON.parse(JSON.stringify(defaultsetting))};var accScale=.002/Math.pow(2,4);var getAcc=(arr,output,channels=8)=>{const accIdx=channels*3+1;const sum=(a,b)=>a+b;const accSum=arr.slice(accIdx).reduce(sum,0);if(accSum!==0){output.ax=accScale*ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output.ay=accScale*ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output.az=accScale*ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5])}};function cytoncodec(data){let arr;if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<8;i2++){let idx=1+3*i2;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);output.timestamp=Date.now();return output}function daisycytoncodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<8;i2++){let idx=1+3*i2;if(arr[0]%2===0)output[i2+7]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2]);else output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);return output}var sps2=250;var cytonSerialSettings={deviceType:"USB",deviceName:"cyton",baudRate:115200,codec:cytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var daisycytonSerialSettings={deviceType:"USB",deviceName:"cyton_daisy",baudRate:115200,codec:daisycytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var defaultChartSetting2={nSec:10,sps:sps2,units:"mV"};var defaultChartSetting22={nSec:10,sps:sps2};var cytonChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting2)),"1":JSON.parse(JSON.stringify(defaultChartSetting2)),"2":JSON.parse(JSON.stringify(defaultChartSetting2)),"3":JSON.parse(JSON.stringify(defaultChartSetting2)),"4":JSON.parse(JSON.stringify(defaultChartSetting2)),"5":JSON.parse(JSON.stringify(defaultChartSetting2)),"6":JSON.parse(JSON.stringify(defaultChartSetting2)),"7":JSON.parse(JSON.stringify(defaultChartSetting2)),"ax":JSON.parse(JSON.stringify(defaultChartSetting22)),"ay":JSON.parse(JSON.stringify(defaultChartSetting22)),"az":JSON.parse(JSON.stringify(defaultChartSetting22))},generateNewLines:true};var defaultsetting2={sps:sps2,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))};var cytonFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting2)),"1":JSON.parse(JSON.stringify(defaultsetting2)),"2":JSON.parse(JSON.stringify(defaultsetting2)),"3":JSON.parse(JSON.stringify(defaultsetting2)),"4":JSON.parse(JSON.stringify(defaultsetting2)),"5":JSON.parse(JSON.stringify(defaultsetting2)),"6":JSON.parse(JSON.stringify(defaultsetting2)),"7":JSON.parse(JSON.stringify(defaultsetting2)),"8":JSON.parse(JSON.stringify(defaultsetting2)),"9":JSON.parse(JSON.stringify(defaultsetting2)),"10":JSON.parse(JSON.stringify(defaultsetting2)),"11":JSON.parse(JSON.stringify(defaultsetting2)),"12":JSON.parse(JSON.stringify(defaultsetting2)),"13":JSON.parse(JSON.stringify(defaultsetting2)),"14":JSON.parse(JSON.stringify(defaultsetting2)),"15":JSON.parse(JSON.stringify(defaultsetting2))};function freeeeg128codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<128;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=385;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps3=250;var freeeeg128SerialSettings={deviceType:"USB",deviceName:"freeeeg128",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg128codec,sps:sps3,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg128ChartSettings={lines:{"ax":{nSec:10,sps:sps3},"ay":{nSec:10,sps:sps3},"az":{nSec:10,sps:sps3},"gx":{nSec:10,sps:sps3},"gy":{nSec:10,sps:sps3},"gz":{nSec:10,sps:sps3}}};var freeeeg128FilterSettings={};for(let i2=0;i2<128;i2++){freeeeg128ChartSettings.lines[i2]={sps:sps3,nSec:10,units:"mV"};freeeeg128FilterSettings[i2]={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))}}function freeeeg32codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<32;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=97;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps4=512;var freeeeg32SerialSettings={deviceType:"USB",deviceName:"freeeeg32",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg32_optical_SerialSettings={deviceType:"USB",deviceName:"freeeeg32_optical",baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting3={nSec:10,sps:sps4};var freeeeg32ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting3)),"ay":JSON.parse(JSON.stringify(defaultChartSetting3)),"az":JSON.parse(JSON.stringify(defaultChartSetting3)),"gx":JSON.parse(JSON.stringify(defaultChartSetting3)),"gy":JSON.parse(JSON.stringify(defaultChartSetting3)),"gz":JSON.parse(JSON.stringify(defaultChartSetting3))}};var freeeeg32FilterSettings={};for(let i2=0;i2<32;i2++){freeeeg32ChartSettings.lines[i2]={sps:sps4,nSec:10,units:"mV"};freeeeg32FilterSettings[i2]={sps:sps4,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))}}function freeeeg16codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i2=0;i2<16;i2++){let idx=i2*3+1;output[i2]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var BLEBuffer=[];var locked;var lockIdx;function freeeeg16BLEcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;BLEBuffer.push(...data);const needle=new Uint8Array([192,160]);const haystack=BLEBuffer;const search=ByteParser.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=lockIdx??0;let pass=false;for(var i2=search(haystack);i2!==-1;i2=search(haystack,i2+skip)){if(!locked&&!(typeof lockIdx==="number"))used=lockIdx=i2;else{nextIndex=i2;if(nextIndex>=0){const len=nextIndex-used;if(!lockIdx){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true;locked=true}else if(len>0){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true}used=nextIndex}}}if(pass){let output={};for(let i3=0;i3<16;i3++){let idx=i3*3+1;output[i3]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}else return void 0}var sps5=250;var freeeeg16BLESettings={deviceType:"BLE",deviceName:"freeeeg16",services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:void 0},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:freeeeg16BLEcodec,sps:sps5}}}};var freeeeg16SerialSettings={deviceType:"USB",deviceName:"freeeeg16",baudRate:115200,bufferSize:2e3,frequency:3.5,codec:freeeeg16codec,sps:sps5,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting4={nSec:10,sps:sps5};var freeeeg16ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting4)),"ay":JSON.parse(JSON.stringify(defaultChartSetting4)),"az":JSON.parse(JSON.stringify(defaultChartSetting4)),"gx":JSON.parse(JSON.stringify(defaultChartSetting4)),"gy":JSON.parse(JSON.stringify(defaultChartSetting4)),"gz":JSON.parse(JSON.stringify(defaultChartSetting4))}};var freeeeg16FilterSettings={};var gain2=32;var nbits2=24;var vref2=1.2;for(let i2=0;i2<16;i2++){freeeeg16ChartSettings.lines[i2]={sps:sps5,nSec:10,units:"mV"};freeeeg16FilterSettings[i2]={sps:sps5,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref2/(gain2*(Math.pow(2,nbits2)-1))}}var textdecoder=new TextDecoder;function hegduinocodec(value){let output={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0};let txt=textdecoder.decode(value);let line=txt.split("|");if(line.length===3){output.timestamp=Date.now();output.red=parseInt(line[0]);output.infrared=parseInt(line[1]);output.heg=parseFloat(line[2])}else if(line.length>=2){output.timestamp=Date.now();output.red=parseInt(line[1]);output.infrared=parseInt(line[2]);output.heg=parseFloat(line[3]);if(line[4])output.ambient=parseFloat(line[4]);if(line[5])output.temperature=parseFloat(line[5]);return output}else return txt}var sps6=40;var hegduinoSerialSettings={deviceType:"USB",deviceName:"hegduino",baudRate:115200,write:"t\\\\n",codec:hegduinocodec,sps:sps6};var hegduinoV1SerialSettings=Object.assign({},hegduinoSerialSettings);hegduinoV1SerialSettings.sps=19;var hegduinoBLESettings={deviceType:"BLE",deviceName:"hegduino",sps:sps6,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:hegduinocodec,sps:sps6}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};var hegduinoV1BLESettings=Object.assign({},hegduinoSerialSettings);hegduinoV1BLESettings.sps=19;function max3010xcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let pktCt=32;const output={"red":new Array(pktCt),"ir":new Array(pktCt),"max_dietemp":ByteParser.get2sCompliment(arr[193],8)+.0625*arr[194],"timestamp":Date.now()};let i2=0;while(i2<pktCt){let idx=i2*6;if(i2%2===0){output["ir"][i2]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["ir"][i2+1]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}else{output["red"][i2-1]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["red"][i2]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}i2++}return output}function mpu6050codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={"ax":new Array(20),"ay":new Array(20),"az":new Array(20),"gx":new Array(20),"gy":new Array(20),"gz":new Array(20),"mpu_dietemp":(ByteParser.bytesToInt16(arr[241],arr[242])+521)/340+35,timestamp:Date.now()};for(let i2=0;i2<20;i2++){let idx=i2*12;output.ax[i2]=ByteParser.bytesToInt16(arr[idx+1],arr[idx+2]);output.ay[i2]=ByteParser.bytesToInt16(arr[idx+3],arr[idx+4]);output.az[i2]=ByteParser.bytesToInt16(arr[idx+5],arr[idx+6]);output.gx[i2]=ByteParser.bytesToInt16(arr[idx+7],arr[idx+8]);output.gy[i2]=ByteParser.bytesToInt16(arr[idx+9],arr[idx+10]);output.gz[i2]=ByteParser.bytesToInt16(arr[idx+11],arr[idx+12])}return output}function cognixionONE_EEG_codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let i2=0;i2<7;i2++){let j=i2*26+1;if(!arr[j+23])break;output[0][i2]=ByteParser.bytesToUInt24(arr[j],arr[j+1],arr[j+2]);output[1][i2]=ByteParser.bytesToUInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i2]=ByteParser.bytesToUInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i2]=ByteParser.bytesToUInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i2]=ByteParser.bytesToUInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i2]=ByteParser.bytesToUInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i2]=ByteParser.bytesToUInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i2]=ByteParser.bytesToUInt24(arr[j+21],arr[j+22],arr[j+23])}return output}var sps7=250;var cognixionONEBLESettings={deviceType:"BLE",deviceName:"cognixionONE",services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:true,notifyCallback:void 0,codec:cognixionONE_EEG_codec,sps:sps7}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:true}}},sps:sps7};var cognixionONESerialSettings=Object.assign({},cytonSerialSettings);cognixionONESerialSettings.sps=sps7;cognixionONESerialSettings.deviceName="cognixionONE";var defaultChartSetting5={nSec:10,sps:sps7,units:"mV"};var cognixionONEChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting5)),"1":JSON.parse(JSON.stringify(defaultChartSetting5)),"2":JSON.parse(JSON.stringify(defaultChartSetting5)),"3":JSON.parse(JSON.stringify(defaultChartSetting5)),"4":JSON.parse(JSON.stringify(defaultChartSetting5)),"5":JSON.parse(JSON.stringify(defaultChartSetting5)),"6":JSON.parse(JSON.stringify(defaultChartSetting5)),"7":JSON.parse(JSON.stringify(defaultChartSetting5))}};var PeanutCodes={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function peanutcodec(data){let result={};let i2=0;while(i2<data.length){if(PeanutCodes[data[i2]]&&i2+1+PeanutCodes[data[i2]].byteLength<=data.length){let slice=data.slice(i2+1,i2+1+PeanutCodes[data[i2]].byteLength).buffer;let unpacked=ByteParser.struct(PeanutCodes[data[i2]].format).unpack(slice);let code=PeanutCodes[data[i2]].type;if(code==="unfilteredHEG"||code==="heg")unpacked=unpacked[0]/256;else if(code==="POOR_SIGNAL"||code==="sampleNumber"||code==="debug0"||code==="debug1"||code==="debug2"||code==="debug3")unpacked=unpacked[0];if(!result[PeanutCodes[data[i2]].type]){if(Array.isArray(unpacked))result[PeanutCodes[data[i2]].type]=unpacked;else result[PeanutCodes[data[i2]].type]=[unpacked]}else{if(Array.isArray(unpacked))result[PeanutCodes[data[i2]].type].push(...unpacked);else result[PeanutCodes[data[i2]].type].push(unpacked)}i2+=PeanutCodes[data[i2]].byteLength+1}else i2++}result.timestamp=Date.now();return result}var peanutSerialSettings={deviceType:"USB",deviceName:"peanut",baudRate:38400,bufferSize:400,write:"protocol 3\\\\n",buffering:{searchBytes:new Uint8Array([170,170])},codec:peanutcodec,sps:10.101};var sealevel_hpa=1013.25;var bme280codec=data=>{let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={timestamp:Date.now(),temp:[],pressure:[],altitude:[]};let mode=0;if(arr[0].length===74)mode=1;if(!mode){for(let j=0;j<3;j++){let i2=j*16+2;let tint=ByteParser.bytesToInt32(arr[3+i2],arr[2+i2],arr[1+i2],arr[0+i2]);let tfrac=ByteParser.bytesToInt32(arr[7+i2],arr[6+i2],arr[5+i2],arr[4+i2]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser.bytesToInt32(arr[11+i2],arr[10+i2],arr[9+i2],arr[8+i2]);let pfrac=ByteParser.bytesToInt32(arr[15+i2],arr[14+i2],arr[13+i2],arr[12+i2]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}else{output.humidity=[];for(let j=0;j<3;j++){let i2=j*24+2;let tint=ByteParser.bytesToInt32(arr[3+i2],arr[2+i2],arr[1+i2],arr[0+i2]);let tfrac=ByteParser.bytesToInt32(arr[7+i2],arr[6+i2],arr[5+i2],arr[4+i2]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser.bytesToInt32(arr[11+i2],arr[10+i2],arr[9+i2],arr[8+i2]);let pfrac=ByteParser.bytesToInt32(arr[15+i2],arr[14+i2],arr[13+i2],arr[12+i2]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));let hint=ByteParser.bytesToInt32(arr[19+i2],arr[18+i2],arr[17+i2],arr[16+i2]);let hfrac=ByteParser.bytesToInt32(arr[23+i2],arr[22+i2],arr[21+i2],arr[20+i2]);output.humidity.push(hint+hfrac/Math.pow(10,Math.ceil(Math.log10(hfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}return output};function altitude(pressure,temperature){return 44330*(1-Math.pow(pressure/sealevel_hpa,.1903))}function nrf5x_usbcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i2)=>{output[i2+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec(arr.subarray(2))))}return output}function nrf5x_usbcodec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec_singleended(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i2)=>{output[i2+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec_singleended(arr.subarray(2))))}return output}var nrf5xSerialSettings={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec,sps:250};var nrf5xSerialSettings_singleended={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec_singleended,sps:250};var nrf5xBLESettings={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var nrf5xBLESettings_singleended={deviceType:"BLE",deviceName:"nrf5x_singleended",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var defaultChartSetting6={nSec:10,sps:250,units:"mV"};var nrf5x_usbChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting6)),"1":JSON.parse(JSON.stringify(defaultChartSetting6)),"2":JSON.parse(JSON.stringify(defaultChartSetting6)),"3":JSON.parse(JSON.stringify(defaultChartSetting6)),"4":JSON.parse(JSON.stringify(defaultChartSetting6)),"5":JSON.parse(JSON.stringify(defaultChartSetting6)),"6":JSON.parse(JSON.stringify(defaultChartSetting6)),"7":JSON.parse(JSON.stringify(defaultChartSetting6))},generateNewLines:true,cleanGeneration:false};var gain3=32;var nbits3=24;var vref3=1.2;var defaultsetting3={sps:250,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref3/(gain3*(Math.pow(2,nbits3)-1))};var nrf5x_usbFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting3)),"1":JSON.parse(JSON.stringify(defaultsetting3)),"2":JSON.parse(JSON.stringify(defaultsetting3)),"3":JSON.parse(JSON.stringify(defaultsetting3)),"4":JSON.parse(JSON.stringify(defaultsetting3)),"5":JSON.parse(JSON.stringify(defaultsetting3)),"6":JSON.parse(JSON.stringify(defaultsetting3)),"7":JSON.parse(JSON.stringify(defaultsetting3)),"8":JSON.parse(JSON.stringify(defaultsetting3)),"9":JSON.parse(JSON.stringify(defaultsetting3)),"10":JSON.parse(JSON.stringify(defaultsetting3)),"11":JSON.parse(JSON.stringify(defaultsetting3)),"12":JSON.parse(JSON.stringify(defaultsetting3)),"13":JSON.parse(JSON.stringify(defaultsetting3)),"14":JSON.parse(JSON.stringify(defaultsetting3)),"15":JSON.parse(JSON.stringify(defaultsetting3))};var textdecoder2=new TextDecoder;function statechangercodec(value){let output={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0};let txt=textdecoder2.decode(value);let line=txt.split("|");if(line.length>=5){output.timestamp=Date.now();output.left_red=parseInt(line[1]);output.left_infrared=parseInt(line[2]);output.left_heg=parseFloat(line[3]);output.center_red=parseInt(line[4]);output.center_infrared=parseInt(line[5]);output.center_heg=parseFloat(line[6]);output.right_red=parseInt(line[7]);output.right_infrared=parseInt(line[8]);output.right_heg=parseFloat(line[9]);return output}else return txt}var statechangerSerialSettings={deviceType:"USB",deviceName:"statechanger",baudRate:115200,codec:statechangercodec,sps:20};var statechangerBLESettings={deviceType:"BLE",deviceName:"statechanger",sps:20,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:statechangercodec}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};function blueberrycodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.red/(.5*(output.ir+output.ir2));return output}var sps8=40;var blueberryBLESettings={deviceType:"BLE",deviceName:"blueberry",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:true,notifyCallback:void 0,codec:blueberrycodec,sps:sps8}}},sps:sps8};function blueberryshortcodec(value){let output={sred:value.getInt32(2),sir:value.getInt32(6),sir2:value.getInt32(10),timestamp:Date.now()};output.sheg=output.sred/(.5*(output.sir+output.sir2));return output}function blueberrylongcodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.sred/(.5*(output.ir+output.ir2));return output}var sps9=40;var blueberry2BLESettings={deviceType:"BLE",deviceName:"blueberry2",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:true,notifyCallback:void 0,codec:blueberrylongcodec,sps:sps9},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:true,notifyCallback:void 0,codec:blueberryshortcodec,sps:sps9}}},sps:sps9};function hrcodec(data){return{hr:data.getInt8(1),timestamp:Date.now()}}var heartRateBLESettings={deviceType:"BLE",deviceName:"heartrate",services:{"heart_rate":{"heart_rate_measurement":{notify:true,notifyCallback:void 0,codec:hrcodec}}}};var simulatorSettings={sps:250,deviceType:"CUSTOM",deviceName:"simulator",simulate:{"0":{sps:250,freq:1,amplitude:1,offset:0},"1":{sps:250,freq:10,amplitude:1,offset:0},"2":{sps:250,freq:100,amplitude:.5,offset:.5},"3":{sps:250,freq:25,amplitude:1,offset:0}},connect:(settings={})=>{return new Promise(async(res,rej)=>{let _id=\\`simulated\\${Math.floor(Math.random()*1e15)}\\`;let info={_id,settings:Object.assign(Object.assign({},simulatorSettings),settings)};info.settings.looping=true;let loopTime=50;let lastTime=Date.now();let loop2=()=>{if(info.settings.looping){let newData={};let now=Date.now();let frame=now-lastTime;for(const key in info.settings.simulate){let newPoints=Math.floor(info.settings.simulate[key].sps*frame/1e3);newData[key]=new Array(newPoints).fill(0);newData[key]=newData[key].map((v,i2)=>{return Math.sin(2*Math.PI*info.settings.simulate[key].freq*.001*(lastTime+frame*(i2+1)/newPoints))*info.settings.simulate[key].amplitude+info.settings.simulate[key].offset})}lastTime=now;newData.timestamp=lastTime;info.settings.ondata(newData);setTimeout(()=>{loop2()},loopTime)}};loop2();if(info.settings.onconnect)info.settings.onconnect(info);res(info)})},codec:reading=>{return reading},disconnect:info=>{console.log(info);info.settings.looping=false;info.settings.ondisconnect(info)},onconnect:info=>{console.log("simulator connected!",info)},ondisconnect:info=>{console.log("simulator disconnected!",info)},ondata:data=>{}};var BiquadChannelFilterer=class{constructor(options={sps:512,useSMA4:false,useNotch50:true,useNotch60:true,useLowpass:false,lowpassHz:100,useBandpass:false,bandpassLower:3,bandpassUpper:45,useDCBlock:true,DCBresonance:.995,trimOutliers:false,outlierTolerance:.2,useScaling:false,scalar:1}){this.idx=0;this.sps=options.sps;this.bandpassLower=options.bandpassLower?options.bandpassLower:3;this.bandpassUpper=options.bandpassUpper?options.bandpassUpper:45;this.useSMA4=options.useSMA4;this.last4=[];this.useNotch50=options.useNotch50;this.useNotch60=options.useNotch60;this.useLowpass=options.useLowpass;this.lowpassHz=options.lowpassHz?options.lowpassHz:100;this.useBandpass=options.useBandpass;this.useDCBlock=options.useDCBlock;this.DCBresonance=options.DCBresonance?options.DCBresonance:.995;this.useScaling=options.useScaling;this.scalar=options.scalar;this.trimOutliers=options.trimOutliers;this.outlierTolerance=options.outlierTolerance;let sps10=this.sps;this.notch50=[makeNotchFilter(50,sps10,2),makeNotchFilter(100,sps10,2)];this.notch60=[makeNotchFilter(60,sps10,2),makeNotchFilter(120,sps10,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1)];this.dcb=new DCBlocker(options.DCBresonance?options.DCBresonance:.995)}reset(sps10=this.sps){this.notch50=[makeNotchFilter(50,sps10,2),makeNotchFilter(100,sps10,2)];this.notch60=[makeNotchFilter(60,sps10,2),makeNotchFilter(120,sps10,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10),new Biquad("lowpass",this.lowpassHz,sps10)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps10,1)];this.dcb=new DCBlocker(this.DCBresonance)}setBandpass(bandpassLower=this.bandpassLower,bandpassUpper=this.bandpassUpper,sps10=this.sps){this.bandpassLower=bandpassLower;this.bandpassUpper=bandpassUpper;this.bp1=[makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10),makeBandpassFilter(bandpassLower,bandpassUpper,sps10)]}apply(latestData=0){let out=latestData;if(this.useScaling===true){out*=this.scalar}if(this.filtered&&this.trimOutliers&&this.outlierTolerance){if(Math.abs(out-this.filtered)>this.outlierTolerance){out=this.filtered}}if(this.useDCBlock===true){out=this.dcb.applyFilter(out)}if(this.useSMA4===true){if(this.last4.length<4){this.last4.push(out)}else{out=this.last4.reduce((accumulator,currentValue)=>accumulator+currentValue)/this.last4.length;this.last4.shift();this.last4.push(out)}}if(this.useNotch50===true){this.notch50.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useNotch60===true){this.notch60.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useLowpass===true){this.lp1.forEach((f,i2)=>{out=f.applyFilter(out)})}if(this.useBandpass===true){this.bp1.forEach((f,i2)=>{out=f.applyFilter(out)})}this.filtered=out;this.idx++;return out}};var Biquad=class{constructor(type,freq,sps10,Q=1/Math.sqrt(2),dbGain=0){this.a0=0;this.a1=0;this.a2=0;this.b0=0;this.b1=0;this.b2=0;this.x1=0;this.x2=0;this.y1=0;this.y2=0;let types=["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"];if(types.indexOf(type)<0){console.error("Valid types: \'lowpass\',\'highpass\',\'bandpass\',\'notch\',\'peak\',\'lowshelf\',\'highshelf\'");return}this.type=type;this.freq=freq;this.sps=sps10;this.Q=Q;this.dbGain=dbGain;let A2=Math.pow(10,dbGain/40);let omega=2*Math.PI*freq/sps10;let sn=Math.sin(omega);let cs=Math.cos(omega);let alpha=sn/(2*Q);let beta=Math.sqrt(A2+A2);this[type](A2,sn,cs,alpha,beta);this.b0/=this.a0;this.b1/=this.a0;this.b2/=this.a0;this.a1/=this.a0;this.a2/=this.a0}lowpass(A2,sn,cs,alpha,beta){this.b0=(1-cs)*.5;this.b1=1-cs;this.b2=(1-cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}highpass(A2,sn,cs,alpha,beta){this.b0=(1+cs)*.5;this.b1=-(1+cs);this.b2=(1+cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}bandpass(A2,sn,cs,alpha,beta){this.b0=alpha;this.b1=0;this.b2=-alpha;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}notch(A2,sn,cs,alpha,beta){this.b0=1;this.b1=-2*cs;this.b2=1;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}peak(A2,sn,cs,alpha,beta){this.b0=1+alpha*A2;this.b1=-2*cs;this.b2=1-alpha*A2;this.a0=1+alpha/A2;this.a1=-2*cs;this.a2=1-alpha/A2}lowshelf(A2,sn,cs,alpha,beta){this.b0=A2*(A2+1-(A2-1)*cs+beta*sn);this.b1=2*A2*(A2-1-(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn);this.a0=A2+1+(A2+1)*cs+beta*sn;this.a1=2*(A2-1+(A2+1)*cs);this.a2=A2+1+(A2-1)*cs-beta*sn}highshelf(A2,sn,cs,alpha,beta){this.b0=A2*(A2+1+(A2-1)*cs+beta*sn);this.b1=2*A2*(A2-1+(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn);this.a0=A2+1-(A2+1)*cs-beta*sn;this.a1=2*(A2-1-(A2+1)*cs);this.a2=A2+1-(A2-1)*cs-beta*sn}applyFilter(signal_step){let y2=this.b0*signal_step+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;this.x2=this.x1;this.x1=signal_step;this.y2=this.y1;this.y1=y2;return y2}zResult(freq){try{let phi=Math.pow(Math.sin(Math.PI*freq*2/(2*this.sps)),2);let result=(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*phi+16*this.b0*this.b2*phi*phi)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*phi+16*this.a2*phi*phi);return result}catch(err){return-200}}static calcCenterFrequency(freqStart,freqEnd){return(freqStart+freqEnd)/2}static calcBandwidth(freqStart,freqEnd){return freqEnd-this.calcCenterFrequency(freqStart,freqEnd)}static calcBandpassQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*Math.sqrt((frequency-bandwidth)*(frequency+bandwidth))/(2*bandwidth);return Q}static calcNotchQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*frequency*bandwidth/Math.sqrt((frequency-bandwidth)*(frequency+bandwidth));return Q}};var DCBlocker=class{constructor(r=.995){this.r=r;this.y1=this.y2=this.x1=this.x2=0}applyFilter(signal_step){this.x2=this.x1;this.x1=signal_step;let y2=this.x1-this.x2+this.r*this.y1;this.y2=this.y1;this.y1=y2;return y2}};var makeNotchFilter=(frequency,sps10,bandwidth)=>{return new Biquad("notch",frequency,sps10,Biquad.calcNotchQ(frequency,bandwidth),0)};var makeBandpassFilter=(freqStart,freqEnd,sps10,resonance=Math.pow(10,Math.floor(Math.log10(Biquad.calcCenterFrequency(freqStart,freqEnd)))))=>{return new Biquad("bandpass",Biquad.calcCenterFrequency(freqStart,freqEnd),sps10,Biquad.calcBandpassQ(Biquad.calcCenterFrequency(freqStart,freqEnd),Biquad.calcBandwidth(freqStart,freqEnd),resonance),0)};var defaultsetting1={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var ganglionFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting1)),"1":JSON.parse(JSON.stringify(defaultsetting1)),"2":JSON.parse(JSON.stringify(defaultsetting1)),"3":JSON.parse(JSON.stringify(defaultsetting1))};var defaultChartSetting7={nSec:10,sps:250,units:"mV"};var ganglionChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting7)),"1":JSON.parse(JSON.stringify(defaultChartSetting7)),"2":JSON.parse(JSON.stringify(defaultChartSetting7)),"3":JSON.parse(JSON.stringify(defaultChartSetting7)),"ax":{nSec:10,sps:250,units:"mg"},"ay":{nSec:10,sps:250,units:"mg"},"az":{nSec:10,sps:250,units:"mg"}},generateNewLines:true};var defaultsetting4={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var museFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting4)),"1":JSON.parse(JSON.stringify(defaultsetting4)),"2":JSON.parse(JSON.stringify(defaultsetting4)),"3":JSON.parse(JSON.stringify(defaultsetting4)),"4":JSON.parse(JSON.stringify(defaultsetting4))};var Devices={BLE:{"nrf5x":nrf5xBLESettings,"nrf5x_singleended":nrf5xBLESettings_singleended,"hegduino":hegduinoBLESettings,"hegduinoV1":hegduinoV1BLESettings,"cognixionONE":cognixionONEBLESettings,"statechanger":statechangerBLESettings,"blueberry":blueberryBLESettings,"blueberry2":blueberry2BLESettings,"heart_rate":heartRateBLESettings,"freeEEG16":freeeeg16BLESettings},USB:{"nrf5x":nrf5xSerialSettings,"nrf5x_singleended":nrf5xSerialSettings_singleended,"freeEEG16":freeeeg16SerialSettings,"freeEEG32":freeeeg32SerialSettings,"freeEEG32_optical":freeeeg32_optical_SerialSettings,"freeEEG128":freeeeg128SerialSettings,"hegduino":hegduinoSerialSettings,"hegduinoV1":hegduinoV1SerialSettings,"cyton":cytonSerialSettings,"cyton_daisy":daisycytonSerialSettings,"peanut":peanutSerialSettings,"statechanger":statechangerSerialSettings,"cognixionONE":cytonSerialSettings},BLE_CUSTOM:{},USB_CUSTOM:{},CUSTOM:{"simulator":simulatorSettings}};var textdecoder3=new TextDecoder;var decoders={"raw":data=>{if(data?.buffer)return Array.from(new Uint8Array(data));else return data},"utf8":data=>{return textdecoder3.decode(data)},"console-f12":data=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(data);return data},"debug":(data,debugmessage)=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(debugmessage,data);return data},"ads131m08":ads131m08codec,"arduino_ads131m08":ads131m08_arduinocodec,"max3010x":max3010xcodec,"mpu6050":mpu6050codec,"bme280":bme280codec,"freeeeg16":freeeeg16codec,"freeeeg32":freeeeg32codec,"freeeeg128":freeeeg128codec,"cyton":cytoncodec,"cognixionONE_BLE":cognixionONE_EEG_codec,"hegduino":hegduinocodec,"nrf5x":nrf5x_usbcodec,"peanut":peanutcodec,"statechanger":statechangercodec,"blueberry":blueberrycodec,"heart_rate":hrcodec};function parseFunctionFromText2(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\\\W*(function[^{]+\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>[^{]*\\\\{([\\\\s\\\\S]*)\\\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs3(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs2}var stringifyFast2=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p in value[prop]){if(Array.isArray(value[prop][p])){if(value[prop][p].length>20)obj[prop][p]=value[prop][p].slice(value[prop][p].length-20);else obj[prop][p]=value[prop][p]}else{if(value[prop][p]!=null){let con=value[prop][p].constructor.name;if(con.includes("Set")){obj[prop][p]=Array.from(value[prop][p])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p]="instanceof_"+con}else{obj[prop][p]=value[prop][p]}}else{obj[prop][p]=value[prop][p]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast3(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast2}function loadStreamWorkerGlobals(){globalThis.Devices=Devices;globalThis.WebSerial=WebSerial;globalThis.decoders=decoders;globalThis.decoder="raw";globalThis.ByteParser=ByteParser;globalThis.filtering=false;globalThis.filters={};globalThis.BiquadChannelFilterer=BiquadChannelFilterer;globalThis.ArrayManip=ArrayManip}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){loadStreamWorkerGlobals()}var streamWorkerRoutes={"transferDevice":function transferDevice(device,worker){let cpy=Object.assign({},device);for(const key in cpy){if(typeof cpy[key]==="function")cpy[key]=cpy[key].toString()}worker.send({route:"receiveDevice",args:cpy})},"receiveDevice":function receiveDevice(device){for(const key in device){if(typeof device[key]==="string"){let fn=parseFunctionFromText2(device[key]);if(typeof fn==="function"){device[key]=fn}}}if(!globalThis.Devices[device.deviceType])globalThis.Devices[device.deviceType]={};globalThis.Devices[device.deviceType][device.deviceName]=device},"receiveDecoder":function receiveDecoder(decoder2,decoderName){globalThis.decoders[decoderName]=(0,eval)("("+decoder2+")")},"receiveCodec":function receiveDeviceCodec(decoder2,deviceType,device,service,characteristic){let codec=parseFunctionFromText2(decoder2);if(codec){if(deviceType==="BLE"&&service&&characteristic){if(globalThis.Devices[deviceType][device]){if(globalThis.Devices[deviceType][device][service]){if(globalThis.Devices[deviceType][device][characteristic]){globalThis.Devices[deviceType][device][characteristic].codec=codec}else{globalThis.Devices[deviceType][device][characteristic]={codec}}}else{globalThis.Devices[deviceType][device]={[characteristic]:{codec}}}}}else if(globalThis.Devices[deviceType][device]?.codec){if(globalThis.Devices[deviceType][device])globalThis.Devices[deviceType][device].codec=codec;else{globalThis.Devices[deviceType][device]={codec}}}}},"decode":function decode(data){return globalThis.decoder(data)},"decodeAndParse":function decodeAndParse(data){let decoded=this.__node.graph.run("decode",data);if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}}}}return parsed}}return decoded},"setActiveDecoder":function setActiveDecoder(deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device]?.codec;else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device][service][characteristic].codec;return true},"decodeDevice":function decodeDevice(data,deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)return globalThis.Devices[deviceType][device].codec(data);else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)return globalThis.Devices[deviceType][device][service][characteristic].codec(data)},"decodeAndParseDevice":function decodeAndParseDevice(data,deviceType,deviceName,service,characteristic){let decoded;if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][deviceName]?.services[service]?.[characteristic]?.codec)decoded=globalThis.Devices[deviceType][deviceName].services[service][characteristic].codec(data);else if(globalThis.Devices[deviceType][deviceName]?.codec)decoded=globalThis.Devices[deviceType][deviceName].codec(data);else decoded=data;if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}else if(typeof parsed[prop]==="number"){parsed[prop]=filter.apply(parsed[prop])}}}}return parsed}}return decoded},"toggleAnim":function toggleAnim(){globalThis.runningAnim=!globalThis.runningAnim;return globalThis.runningAnim},"setFilters":function setFilters(filters,clearFilters=false){if(!globalThis.filters||clearFilters){globalThis.filters={};if(clearFilters)globalThis.filtering=false}if(filters){for(const key in filters){globalThis.filters[key]=new BiquadChannelFilterer(filters[key])}globalThis.filtering=true}return true},"getFilterSettings":function getFilterSettings(){if(globalThis.filters){let filters={};for(const key in globalThis.filters){filters[key]={sps:globalThis.filters[key].sps,useScaling:globalThis.filters[key].useScaling,scalar:globalThis.filters[key].scalar,useNotch50:globalThis.filters[key].useNotch50,useNotch60:globalThis.filters[key].useNotch60,useDCBlock:globalThis.filters[key].useDCBlock,useLowpass:globalThis.filters[key].useLowpass,lowpassHz:globalThis.filters[key].lowpassHz,useBandpass:globalThis.filters[key].useBandpass,bandpassLower:globalThis.filters[key].bandpassLower,bandpassUpper:globalThis.filters[key].bandpassUpper}}return filters}return void 0},"setupSerial":function setupSerial(){globalThis.Serial=new globalThis.WebSerial;globalThis.decoder="raw";console.log("worker: Setting up Serial",globalThis.Serial);return true},"openPort":function openPort(settings){const WorkerService2=this.__node.graph;if(!globalThis.Serial)WorkerService2.run("setupSerial");return new Promise((res,rej)=>{globalThis.Serial.getPorts().then(ports=>{const Serial=globalThis.Serial;let port=ports.find(port2=>{return port2.getInfo().usbVendorId===settings.usbVendorId&&port2.getInfo().usbProductId===settings.usbProductId});if(port){let options=Object.assign({},settings);if(typeof settings.pipeTo==="object"&&settings.pipeTo.extraArgs&&globalThis.Devices?.[settings.pipeTo.extraArgs[0]]?.[settings.pipeTo.extraArgs[1]]){options.onconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].onconnect;options.ondisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].ondisconnect;options.beforedisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].beforedisconnect}Serial.openPort(port,options).then(()=>{const stream=Serial.createStream({port,settings:options,frequency:settings.frequency?settings.frequency:10,buffering:settings.buffering,ondata:value=>{if(stream.settings.pipeTo){if(stream.settings.pipeMain){WorkerService2.transmit(value,void 0,[value.buffer])}if(typeof stream.settings.pipeTo==="string")WorkerService2.transmit(value,stream.settings.pipeTo,[value.buffer]);else if(stream.settings.pipeTo?.route){let args=value;if(stream.settings.pipeTo.extraArgs)args=[value,...stream.settings.pipeTo.extraArgs];WorkerService2.transmit({route:stream.settings.pipeTo.route,args},stream.settings.pipeTo._id,[value.buffer])}}else{WorkerService2.transmit(value,void 0,[value.buffer])}}});Serial.readStream(stream);port.ondisconnect=()=>{postMessage(\\`\\${stream._id} disconnected\\`)};res({_id:stream._id,settings,info:stream.info})}).catch(()=>{postMessage(\\`disconnected\\`)});;}else{rej(false)}})})},"closeStream":function closeStream(streamId){return new Promise((res,rej)=>{const Serial=globalThis.Serial;let ondisconnect;if(Serial.streams[streamId].port?.ondisconnect)ondisconnect=Serial.streams[streamId].port.ondisconnect;Serial.closeStream(Serial.streams[streamId]).then(resolved=>{if(ondisconnect)ondisconnect(void 0);res(resolved)}).catch(rej)})},"writeStream":function writeStream(streamId,message){globalThis.Serial.writeStream(globalThis.Serial.streams[streamId],message);return true},"updateStreamSettings":function updateStreamSettings(streamId,settings){if(globalThis.Serial?.streams[streamId]){for(const key in settings){if(typeof settings[key]==="object"){Object.assign(globalThis.Serial.streams[streamId].settings[key],settings[key])}else globalThis.Serial.streams[streamId][key]=settings[key]}}}};if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){globalThis.Devices=Devices;const worker=new WorkerService({roots:{...workerCanvasRoutes,...remoteGraphRoutes,...streamWorkerRoutes}})}var stream_worker_default=self;})();\n`);var url=URL.createObjectURL(new globalThis.Blob([str2],{type:"text/javascript"}));var _ArrayManip2=class{constructor(){this.recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"){if(typeof target[key]==="object")this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target}}static autoscale(array,lineIdx=0,nLines=1,centerZero=false,ymin,ymax,clamp){if(array?.length===0)return array;let max=ymax?ymax:Math.max(...array);let min=ymin?ymin:Math.min(...array);let _lines=1/nLines;let scalar=1;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));if(absmax!==0)scalar=_lines/absmax;return array.map(y22=>{if(clamp){if(y22<min)y22=min;if(y22>max)y22=max}return y22*scalar+(_lines*(lineIdx+1)*2-1-_lines)})}else{if(max===min){if(max!==0){scalar=_lines/max}else if(min!==0){scalar=_lines/Math.abs(min)}}else scalar=_lines/(max-min);return array.map(y22=>{if(clamp){if(y22<min)y22=min;if(y22>max)y22=max}return 2*((y22-min)*scalar-1/(2*nLines))+(_lines*(lineIdx+1)*2-1-_lines)})}}static genTimestamps(ct,sps11){let now=Date.now();let toInterp=[now-ct*1e3/sps11,now];return _ArrayManip2.upsample(toInterp,ct)}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i22=incr;i22<array.length;i22+=incr){let rounded=Math.round(i22);if(rounded>lastIdx)rounded=lastIdx;for(let j=last;j<rounded;j++){output[counter]+=array[j]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static upsample(array,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array(fitCount);var springFactor=(array.length-1)/(fitCount-1);newData[0]=array[0];for(var i22=1;i22<fitCount-1;i22++){var tmp=i22*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i22]=linearInterpolate(array[before],array[after],atPoint)}newData[fitCount-1]=array[array.length-1];return newData}static interpolate(array,fitCount,scalar=1){if(array.length>fitCount){return _ArrayManip2.downsample(array,fitCount,scalar)}else if(array.length<fitCount){return _ArrayManip2.upsample(array,fitCount,scalar)}return array}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c=(1-Math.abs(2*l-1))*s,x3=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r=0,g=0,b=0;if(0<=h&&h<60){r=c;g=x3;b=0}else if(60<=h&&h<120){r=x3;g=c;b=0}else if(120<=h&&h<180){r=0;g=c;b=x3}else if(180<=h&&h<240){r=0;g=x3;b=c}else if(240<=h&&h<300){r=x3;g=0;b=c}else if(300<=h&&h<360){r=c;g=0;b=x3}r=(r+m)*scalar;g=(g+m)*scalar;b=(b+m)*scalar;return[r,g,b]}static circularBuffer(arr,newEntries){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,newEntries.slice(len-newEntries.length))}else{arr.splice(0,arr.length,...newEntries)}return arr}static reformatData(data,key){if(Array.isArray(data)){if(Array.isArray(data[0])){let d2={};data.forEach((arr,i22)=>{d2[i22]=arr});data=d2;if(isNaN(data[0][0]))return void 0}else if(key){data={[key]:data};if(isNaN(data[key][0]))return void 0}else{data={0:data};if(isNaN(data[0][0]))return void 0}}else if(typeof data==="object"){for(const key2 in data){if(typeof data[key2]==="number")data[key2]=[data[key2]];else if(data[key2]?.values){if(typeof data[key2].values==="number")data[key2].values=[data[key2].values]}if(isNaN(data[key2][0]))return void 0}}else if(typeof data==="string"){let split;if(data.includes("\\r\\n")){let lines=data.split("\\r\\n");data={};lines.forEach((l,j)=>{if(l.includes("	")){split=l.split("	")}else if(l.includes(",")){split=l.split(",")}else if(l.includes("|")){split=l.split("|")}if(Array.isArray(split)){split.forEach((val,i22)=>{if(val.includes(":")){let[key2,v2]=val.split(":");let fl=parseFloat(v2);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i22]=[fl];else return void 0}})}})}else if(data.includes("	")){split=data.split("	")}else if(data.includes(",")){split=data.split(",")}else if(data.includes("|")){split=data.split("|")}data={};if(Array.isArray(split)){split.forEach((val,i22)=>{if(val.includes(":")){let[key2,v2]=val.split(":");let fl=parseFloat(v2);if(fl)data[key2]=[fl];else return void 0}else{let fl=parseFloat(val);if(fl)data[i22]=[fl];else return void 0}})}}else if(typeof data==="number"){if(key)data={[key]:[data]};else data={0:[data]}}return data}static padTime(data,lastValue,time,targetFit){let slopeIncr=(data[0]-lastValue)/time/targetFit;let padded=[...new Array(targetFit-data.length).map((_,i22)=>lastValue+slopeIncr*(i22+1)),...data];return padded}static interpolateForTime(data,time,targetSPS){return _ArrayManip2.interpolate(data,Math.ceil(targetSPS*time))}isTypedArray(x3){return ArrayBuffer.isView(x3)&&Object.prototype.toString.call(x3)!=="[object DataView]"}spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var ArrayManip2=_ArrayManip2;ArrayManip2.bufferValues=(objects,property,keys22,buffer)=>{if(!Array.isArray(keys22)&&typeof keys22==="object")keys22=Object.keys(keys22);if(!buffer){let object_keys=Object.keys(objects);if(keys22)buffer=new Float32Array(object_keys.length*keys22.length);else{if(typeof objects[object_keys[0]][property]==="object"){keys22=Object.keys(objects[object_keys[0]][property]);buffer=new Float32Array(object_keys.length*keys22.length)}else buffer=new Float32Array(object_keys.length)}}let i22=0;for(const key in objects){if(objects[key][property]){if(keys22){for(let j=0;j<keys22.length;j++){buffer[i22]=objects[key][property][keys22[j]];i22++}}else{buffer[i22]=objects[key][property];i22++}}}return buffer};var rechk2=/^([<>])?(([1-9]\\d*)?([xcbB?hHiIfdsp]))*$/;var refmt2=/([1-9]\\d*)?([xcbB?hHiIfdsp])/g;var str22=(v2,o,c)=>String.fromCharCode(...new Uint8Array(v2.buffer,v2.byteOffset+o,c));var rts2=(v2,o,c,s)=>new Uint8Array(v2.buffer,v2.byteOffset+o,c).set(s.split("").map(str3=>str3.charCodeAt(0)));var pst2=(v2,o,c)=>str22(v2,o+1,Math.min(v2.getUint8(o),c-1));var tsp2=(v2,o,c,s)=>{v2.setUint8(o,s.length);rts2(v2,o+1,c-1,s)};var lut2=le=>({x:c=>[1,c,0],c:c=>[c,1,o=>({u:v2=>str22(v2,o,1),p:(v2,c2)=>rts2(v2,o,1,c2)})],"?":c=>[c,1,o=>({u:v2=>Boolean(v2.getUint8(o)),p:(v2,B22)=>v2.setUint8(o,B22)})],b:c=>[c,1,o=>({u:v2=>v2.getInt8(o),p:(v2,b)=>v2.setInt8(o,b)})],B:c=>[c,1,o=>({u:v2=>v2.getUint8(o),p:(v2,B22)=>v2.setUint8(o,B22)})],h:c=>[c,2,o=>({u:v2=>v2.getInt16(o,le),p:(v2,h)=>v2.setInt16(o,h,le)})],H:c=>[c,2,o=>({u:v2=>v2.getUint16(o,le),p:(v2,H22)=>v2.setUint16(o,H22,le)})],i:c=>[c,4,o=>({u:v2=>v2.getInt32(o,le),p:(v2,i22)=>v2.setInt32(o,i22,le)})],I:c=>[c,4,o=>({u:v2=>v2.getUint32(o,le),p:(v2,I)=>v2.setUint32(o,I,le)})],f:c=>[c,4,o=>({u:v2=>v2.getFloat32(o,le),p:(v2,f)=>v2.setFloat32(o,f,le)})],d:c=>[c,8,o=>({u:v2=>v2.getFloat64(o,le),p:(v2,d2)=>v2.setFloat64(o,d2,le)})],s:c=>[1,c,o=>({u:v2=>str22(v2,o,c),p:(v2,s)=>rts2(v2,o,c,s.slice(0,c))})],p:c=>[1,c,o=>({u:v2=>pst2(v2,o,c),p:(v2,s)=>tsp2(v2,o,c,s.slice(0,c-1))})]});var errbuf2=new RangeError("Structure larger than remaining buffer");var errval2=new RangeError("Not enough values for structure");var _ByteParser2=class extends ArrayManip2{static toDataView(value){if(!(value instanceof DataView)){if(typeof value==="string"&&parseInt(value))value=parseInt(value);if(typeof value==="string"){let enc=new TextEncoder;let hascodes={};for(const code in _ByteParser2.codes){while(value.indexOf(code)>-1){let idx=value.indexOf(code);value=value.replace(code,"");hascodes[idx]=code}}let encoded=Array.from(enc.encode(value));for(const key in hascodes){encoded.splice(parseInt(key),0,_ByteParser2.codes[hascodes[key]])}value=new DataView(new Uint8Array(encoded).buffer)}else if(typeof value==="number"){let tmp=value;if(value<256){value=new DataView(new ArrayBuffer(1));value.setUint8(0,tmp)}else if(value<65536){value=new DataView(new ArrayBuffer(2));value.setInt16(0,tmp)}else{value=new DataView(new ArrayBuffer(4));value.setUint32(0,tmp)}}else if(value instanceof ArrayBuffer||typeof SharedArrayBuffer!=="undefined"&&value instanceof SharedArrayBuffer){value=new DataView(value)}else if(Array.isArray(value)){value=new DataView(Uint8Array.from(value).buffer)}else if(typeof value==="object"){value=new TextEncoder().encode(JSON.stringify(value))}}return value}static searchBuffer(buffer,searchString,limit){var needle=searchString;var haystack=buffer;var search=_ByteParser2.boyerMoore(needle);var skip=search.byteLength;var indices=[];for(var i22=search(haystack);i22!==-1;i22=search(haystack,i22+skip)){indices.push(i22);if(limit){if(indices.length>=limit)break}}return indices}static bytesToInt16(x0,x1){let int16=(255&x0)<<8|255&x1;if((int16&32768)>0){int16|=4294901760}else{int16&=65535}return int16}static bytesToUInt16(x0,x1){return x0*256+x1}static Uint16ToBytes(y22){return[y22&255,y22>>8&255]}static bytesToInt24(x0,x1,x22){let int24=(255&x0)<<16|(255&x1)<<8|255&x22;if((int24&8388608)>0){int24|=4278190080}else{int24&=16777215}return int24}static bytesToUInt24(x0,x1,x22){return x0*65536+x1*256+x22}static Uint24ToBytes(y22){return[y22&255,y22>>8&255,y22>>16&255]}static bytesToInt32(x0,x1,x22,x3){let int32=(255&x0)<<24|(255&x1)<<16|(255&x22)<<8|255&x3;if((int32&2147483648)>0){int32|=0}else{int32&=4294967295}return int32}static bytesToUInt32(x0,x1,x22,x3){return x0*16777216+x1*65536+x22*256+x3}static Uint32ToBytes(y22){return[y22&255,y22>>8&255,y22>>16&255,y22>>24&255]}static get2sCompliment(val,nbits4){if(val>4294967296)return null;return val<<32-nbits4>>32-nbits4}static getSignedInt(...args){let pos=0;function getInt(size){var value=0;var first=true;while(size--){if(first){let byte=args[pos++];value+=byte&127;if(byte&128){value-=128}first=false}else{value*=256;value+=args[pos++]}}return value}return getInt(args.length)}static asUint8Array(input){if(input instanceof Uint8Array){return input}else if(typeof input==="string"){var arr=new Uint8Array(input.length);for(var i22=0;i22<input.length;i22++){var c=input.charCodeAt(i22);if(c>127){throw new TypeError("Only ASCII patterns are supported")}arr[i22]=c}return arr}else{return new Uint8Array(input)}}static boyerMoore(patternBuffer){var pattern=_ByteParser2.asUint8Array(patternBuffer);var M2=pattern.length;if(M2===0){throw new TypeError("patternBuffer must be at least 1 byte long")}var R2=256;var rightmost_positions=new Int32Array(R2);for(var c=0;c<R2;c++){rightmost_positions[c]=-1}for(var j=0;j<M2;j++){rightmost_positions[pattern[j]]=j}var boyerMooreSearch=(txtBuffer,start,end)=>{var txt=_ByteParser2.asUint8Array(txtBuffer);if(start===void 0)start=0;if(end===void 0)end=txt.length;var pat=pattern;var right=rightmost_positions;var lastIndex=end-pat.length;var lastPatIndex=pat.length-1;var skip;for(var i22=start;i22<=lastIndex;i22+=skip){skip=0;for(var j2=lastPatIndex;j2>=0;j2--){var c2=txt[i22+j2];if(pat[j2]!==c2){skip=Math.max(1,j2-right[c2]);break}}if(skip===0){return i22}}return-1};boyerMooreSearch.byteLength=pattern.byteLength;return boyerMooreSearch}static struct(format){let fns=[],size=0,m=rechk2.exec(format);if(!m){throw new RangeError("Invalid format string")}const t22=lut2("<"===m[1]),lu=(n,c)=>t22[c](n?parseInt(n,10):1);while(m=refmt2.exec(format)){((r,s,f)=>{for(let i22=0;i22<r;++i22,size+=s){if(f){fns.push(f(size))}}})(...lu(...m.slice(1)))}const unpack_from=(arrb,offs)=>{if(arrb.byteLength<(offs|0)+size){throw errbuf2}let v2=new DataView(arrb,offs|0);return fns.map(f=>f.u(v2))};const pack_into=(arrb,offs,...values)=>{if(values.length<fns.length){throw errval2}if(arrb.byteLength<offs+size){throw errbuf2}const v2=new DataView(arrb,offs);new Uint8Array(arrb,offs,size).fill(0);fns.forEach((f,i22)=>f.p(v2,values[i22]))};const pack=(...values)=>{let b=new ArrayBuffer(size);pack_into(b,0,...values);return b};const unpack=arrb=>unpack_from(arrb,0);function*iter_unpack(arrb){for(let offs=0;offs+size<=arrb.byteLength;offs+=size){yield unpack_from(arrb,offs)}}return Object.freeze({unpack,pack,unpack_from,pack_into,iter_unpack,format,size})}};var ByteParser2=_ByteParser2;ByteParser2.codes={"\\\\n":10,"\\\\r":13,"\\\\t":9,"\\\\s":32,"\\\\b":8,"\\\\f":12,"\\\\":92};var ScanMode;(function(ScanMode2){ScanMode2[ScanMode2["SCAN_MODE_LOW_POWER"]=0]="SCAN_MODE_LOW_POWER";ScanMode2[ScanMode2["SCAN_MODE_BALANCED"]=1]="SCAN_MODE_BALANCED";ScanMode2[ScanMode2["SCAN_MODE_LOW_LATENCY"]=2]="SCAN_MODE_LOW_LATENCY"})(ScanMode||(ScanMode={}));var ConnectionPriority;(function(ConnectionPriority2){ConnectionPriority2[ConnectionPriority2["CONNECTION_PRIORITY_BALANCED"]=0]="CONNECTION_PRIORITY_BALANCED";ConnectionPriority2[ConnectionPriority2["CONNECTION_PRIORITY_HIGH"]=1]="CONNECTION_PRIORITY_HIGH";ConnectionPriority2[ConnectionPriority2["CONNECTION_PRIORITY_LOW_POWER"]=2]="CONNECTION_PRIORITY_LOW_POWER"})(ConnectionPriority||(ConnectionPriority={}));init_dist();init_conversion();init_dist();var BluetoothLe=registerPlugin("BluetoothLe",{web:()=>Promise.resolve().then(()=>(init_web(),web_exports)).then(m=>new m.BluetoothLeWeb)});var makeQueue=()=>{let currentTask=Promise.resolve();return fn=>new Promise((resolve,reject)=>{currentTask=currentTask.then(()=>fn()).then(resolve).catch(reject)})};function getQueue(enabled){if(enabled){return makeQueue()}return fn=>fn()}function parseUUID(uuid){if(typeof uuid!=="string"){throw new Error(`Invalid UUID type ${typeof uuid}. Expected string.`)}uuid=uuid.toLowerCase();const is128BitUuid=uuid.search(/^[0-9a-f]{8}\\b-[0-9a-f]{4}\\b-[0-9a-f]{4}\\b-[0-9a-f]{4}\\b-[0-9a-f]{12}$/)>=0;if(!is128BitUuid){throw new Error(`Invalid UUID format ${uuid}. Expected 128 bit string (e.g. "0000180d-0000-1000-8000-00805f9b34fb").`)}return uuid}var BleClientClass=class{constructor(){this.scanListener=null;this.eventListeners=new Map;this.queue=getQueue(true)}enableQueue(){this.queue=getQueue(true)}disableQueue(){this.queue=getQueue(false)}async initialize(options){await this.queue(async()=>{await BluetoothLe.initialize(options)})}async isEnabled(){const enabled=await this.queue(async()=>{const result=await BluetoothLe.isEnabled();return result.value});return enabled}async enable(){await this.queue(async()=>{await BluetoothLe.enable()})}async disable(){await this.queue(async()=>{await BluetoothLe.disable()})}async startEnabledNotifications(callback){await this.queue(async()=>{var _a;const key=`onEnabledChanged`;await((_a=this.eventListeners.get(key))===null||_a===void 0?void 0:_a.remove());const listener=await BluetoothLe.addListener(key,result=>{callback(result.value)});this.eventListeners.set(key,listener);await BluetoothLe.startEnabledNotifications()})}async stopEnabledNotifications(){await this.queue(async()=>{var _a;const key=`onEnabledChanged`;await((_a=this.eventListeners.get(key))===null||_a===void 0?void 0:_a.remove());this.eventListeners.delete(key);await BluetoothLe.stopEnabledNotifications()})}async isLocationEnabled(){const enabled=await this.queue(async()=>{const result=await BluetoothLe.isLocationEnabled();return result.value});return enabled}async openLocationSettings(){await this.queue(async()=>{await BluetoothLe.openLocationSettings()})}async openBluetoothSettings(){await this.queue(async()=>{await BluetoothLe.openBluetoothSettings()})}async openAppSettings(){await this.queue(async()=>{await BluetoothLe.openAppSettings()})}async setDisplayStrings(displayStrings){await this.queue(async()=>{await BluetoothLe.setDisplayStrings(displayStrings)})}async requestDevice(options){options=options?this.validateRequestBleDeviceOptions(options):void 0;const result=await this.queue(async()=>{const device=await BluetoothLe.requestDevice(options);return device});return result}async requestLEScan(options,callback){options=this.validateRequestBleDeviceOptions(options);await this.queue(async()=>{var _a;await((_a=this.scanListener)===null||_a===void 0?void 0:_a.remove());this.scanListener=await BluetoothLe.addListener("onScanResult",resultInternal=>{const result=Object.assign(Object.assign({},resultInternal),{manufacturerData:this.convertObject(resultInternal.manufacturerData),serviceData:this.convertObject(resultInternal.serviceData),rawAdvertisement:resultInternal.rawAdvertisement?this.convertValue(resultInternal.rawAdvertisement):void 0});callback(result)});await BluetoothLe.requestLEScan(options)})}async stopLEScan(){await this.queue(async()=>{var _a;await((_a=this.scanListener)===null||_a===void 0?void 0:_a.remove());this.scanListener=null;await BluetoothLe.stopLEScan()})}async getDevices(deviceIds){if(!Array.isArray(deviceIds)){throw new Error("deviceIds must be an array")}return this.queue(async()=>{const result=await BluetoothLe.getDevices({deviceIds});return result.devices})}async getConnectedDevices(services){if(!Array.isArray(services)){throw new Error("services must be an array")}services=services.map(parseUUID);return this.queue(async()=>{const result=await BluetoothLe.getConnectedDevices({services});return result.devices})}async connect(deviceId,onDisconnect,options){await this.queue(async()=>{var _a;if(onDisconnect){const key=`disconnected|${deviceId}`;await((_a=this.eventListeners.get(key))===null||_a===void 0?void 0:_a.remove());const listener=await BluetoothLe.addListener(key,()=>{onDisconnect(deviceId)});this.eventListeners.set(key,listener)}await BluetoothLe.connect(Object.assign({deviceId},options))})}async createBond(deviceId){await this.queue(async()=>{await BluetoothLe.createBond({deviceId})})}async isBonded(deviceId){const isBonded=await this.queue(async()=>{const result=await BluetoothLe.isBonded({deviceId});return result.value});return isBonded}async disconnect(deviceId){await this.queue(async()=>{await BluetoothLe.disconnect({deviceId})})}async getServices(deviceId){const services=await this.queue(async()=>{const result=await BluetoothLe.getServices({deviceId});return result.services});return services}async discoverServices(deviceId){await this.queue(async()=>{await BluetoothLe.discoverServices({deviceId})})}async getMtu(deviceId){const value=await this.queue(async()=>{const result=await BluetoothLe.getMtu({deviceId});return result.value});return value}async requestConnectionPriority(deviceId,connectionPriority){await this.queue(async()=>{await BluetoothLe.requestConnectionPriority({deviceId,connectionPriority})})}async readRssi(deviceId){const value=await this.queue(async()=>{const result=await BluetoothLe.readRssi({deviceId});return parseFloat(result.value)});return value}async read(deviceId,service,characteristic,options){service=parseUUID(service);characteristic=parseUUID(characteristic);const value=await this.queue(async()=>{const result=await BluetoothLe.read(Object.assign({deviceId,service,characteristic},options));return this.convertValue(result.value)});return value}async write(deviceId,service,characteristic,value,options){service=parseUUID(service);characteristic=parseUUID(characteristic);return this.queue(async()=>{if(!(value===null||value===void 0?void 0:value.buffer)){throw new Error("Invalid data.")}let writeValue=value;if(Capacitor.getPlatform()!=="web"){writeValue=dataViewToHexString(value)}await BluetoothLe.write(Object.assign({deviceId,service,characteristic,value:writeValue},options))})}async writeWithoutResponse(deviceId,service,characteristic,value,options){service=parseUUID(service);characteristic=parseUUID(characteristic);await this.queue(async()=>{if(!(value===null||value===void 0?void 0:value.buffer)){throw new Error("Invalid data.")}let writeValue=value;if(Capacitor.getPlatform()!=="web"){writeValue=dataViewToHexString(value)}await BluetoothLe.writeWithoutResponse(Object.assign({deviceId,service,characteristic,value:writeValue},options))})}async readDescriptor(deviceId,service,characteristic,descriptor,options){service=parseUUID(service);characteristic=parseUUID(characteristic);descriptor=parseUUID(descriptor);const value=await this.queue(async()=>{const result=await BluetoothLe.readDescriptor(Object.assign({deviceId,service,characteristic,descriptor},options));return this.convertValue(result.value)});return value}async writeDescriptor(deviceId,service,characteristic,descriptor,value,options){service=parseUUID(service);characteristic=parseUUID(characteristic);descriptor=parseUUID(descriptor);return this.queue(async()=>{if(!(value===null||value===void 0?void 0:value.buffer)){throw new Error("Invalid data.")}let writeValue=value;if(Capacitor.getPlatform()!=="web"){writeValue=dataViewToHexString(value)}await BluetoothLe.writeDescriptor(Object.assign({deviceId,service,characteristic,descriptor,value:writeValue},options))})}async startNotifications(deviceId,service,characteristic,callback){service=parseUUID(service);characteristic=parseUUID(characteristic);await this.queue(async()=>{var _a;const key=`notification|${deviceId}|${service}|${characteristic}`;await((_a=this.eventListeners.get(key))===null||_a===void 0?void 0:_a.remove());const listener=await BluetoothLe.addListener(key,event=>{callback(this.convertValue(event===null||event===void 0?void 0:event.value))});this.eventListeners.set(key,listener);await BluetoothLe.startNotifications({deviceId,service,characteristic})})}async stopNotifications(deviceId,service,characteristic){service=parseUUID(service);characteristic=parseUUID(characteristic);await this.queue(async()=>{var _a;const key=`notification|${deviceId}|${service}|${characteristic}`;await((_a=this.eventListeners.get(key))===null||_a===void 0?void 0:_a.remove());this.eventListeners.delete(key);await BluetoothLe.stopNotifications({deviceId,service,characteristic})})}validateRequestBleDeviceOptions(options){if(options.services){options.services=options.services.map(parseUUID)}if(options.optionalServices){options.optionalServices=options.optionalServices.map(parseUUID)}return options}convertValue(value){if(typeof value==="string"){return hexStringToDataView(value)}else if(value===void 0){return new DataView(new ArrayBuffer(0))}return value}convertObject(obj){if(obj===void 0){return void 0}const result={};for(const key of Object.keys(obj)){result[key]=this.convertValue(obj[key])}return result}};var BleClient=new BleClientClass;init_conversion();var BLEClient=class extends ByteParser2{constructor(options,location){super();this.client=BleClient;this.devices={};this.location=false;this.initialized=false;this.setupDevice=(device,options2)=>{return new Promise(async(res,rej)=>{this.devices[device.deviceId]={device,deviceId:device.deviceId,...options2};this.client.connect(device.deviceId,deviceId=>{if(this.devices[device.deviceId]?.ondisconnect)this.devices[device.deviceId].ondisconnect(deviceId)},options2?.connectOptions).then(async()=>{let services=await this.getServices(device.deviceId);for(let service in options2?.services){if(options2?.services[service].UUID)service=options2?.services[service].UUID;let svc=services.find(o=>{if(o.uuid===service)return true});if(svc)for(let characteristic in options2.services[service]){if(options2.services[service][characteristic].characteristic)characteristic=options2.services[service][characteristic].characteristic;if(!svc.characteristics.find(o=>{if(o.uuid===characteristic)return true}))continue;let opt=options2.services[service][characteristic];if(opt.write){await this.write(device,service,characteristic,opt.write,opt.writeCallback,opt.writeOptions)}if(opt.read){await this.read(device,service,characteristic,opt.readCallback,opt.readOptions)}if(opt.notify&&opt.notifyCallback){await this.subscribe(device,service,characteristic,opt.notifyCallback);opt.notifying=true}}}}).catch(rej);res(this.devices[device.deviceId])})};this.triangulate=(device,duration=1500,sampleRate=60)=>{return new Promise((res,rej)=>{if("Accelerometer"in globalThis){if(typeof globalThis.Accelerometer==="function"){let acl=new globalThis.Accelerometer({frequency:sampleRate});let start=performance.now();let now=start;let result={samples:[],vector:{}};let onread=()=>{if(now-start<duration){this.readRssi(device).then(rssi=>{let x3=acl.x;let y22=acl.y;let z22=acl.z;now=performance.now();result.samples.push({x:x3,y:y22,z:z22,rssi,timestamp:now})})}else{let vector={x:0,y:0,z:0,rssiAvg:0};result.samples.forEach(s=>{});acl.removeEventListener("reading",onread)}};acl.addEventListener("reading",onread)}}else rej(new Error("No Accelerometer API detected"))})};if(location)this.location=location;if(options){this.setup(options)}}setup(options,location=this.location){let services=[];if(options){for(let serviceuuid in options.services){if(options.services[serviceuuid].UUID)serviceuuid=options.services[serviceuuid].UUID;services.push(serviceuuid)}}let opts={};if(!location)opts.androidNeverForLocation=false;return new Promise(async(res,rej)=>{if(!this.initialized){await this.client.initialize(opts);this.initialized=true}if(options?.deviceId){res(await this.reconnect(options.deviceId))}else{if(options){let services2=Array.from(Object.keys(options.services));let deviceRequest={};if(!this.isMobile()){deviceRequest.optionalServices=services2}if(options.name)deviceRequest.name=options.name;if(options.namePrefix)deviceRequest.namePrefix=options.namePrefix;this.client.requestDevice(deviceRequest).then(device=>{res(this.setupDevice(device,options))}).catch(rej)}else{this.client.requestDevice().then(device=>{res(this.setupDevice(device,options))}).catch(rej)}}})}initialize(options){return new Promise((res,rej)=>{this.client.initialize(options).then(()=>{res(true)}).catch(rej)})}requestDevice(request,options){return new Promise((res,rej)=>{this.client.requestDevice(request).then(device=>{this.devices[device.deviceId]={device,deviceId:device.deviceId,...options};res(device)}).catch(rej)})}getServices(deviceId){return this.client.getServices(deviceId)}connect(device,options){return new Promise((res,rej)=>{this.client.connect(device.deviceId,deviceId=>{if(options?.ondisconnect)options.ondisconnect(deviceId)},options?.connectOptions).then(connected=>{res(device)}).catch(rej)})}reconnect(deviceId,options){return new Promise((res,rej)=>{let opts=options;if(this.devices[deviceId])opts=Object.assign(Object.assign({},this.devices[deviceId]),opts);if(opts?.deviceId)delete opts.deviceId;this.client.getDevices([deviceId]).then(devices=>{this.setupDevice(devices[0],opts).then(device=>{res(device)})}).catch(rej)})}disconnect(device){if(typeof device==="object"){if(device?.deviceId){device=device.deviceId};}if(typeof device==="string"){let info=this.devices[device];if(info.beforedisconnect)info.beforedisconnect(this,info);delete this.devices[device];return this.client.disconnect(device)}}write(device,service,characteristic,value,callback,options){if(typeof device==="object")device=device.deviceId;if(callback){return this.client.write(device,service,characteristic,BLEClient.toDataView(value)).then(callback)}else return this.client.writeWithoutResponse(device,service,characteristic,BLEClient.toDataView(value),options)}read(device,service,characteristic,ondata,options){if(typeof device==="object")device=device.deviceId;if(ondata)return this.client.read(device,service,characteristic,options).then(ondata);else return this.client.read(device,service,characteristic,options)}subscribe(device,service,characteristic,ondata){if(typeof device==="object")device=device.deviceId;return this.client.startNotifications(device,service,characteristic,ondata)}unsubscribe(device,service,characteristic){if(typeof device==="object")device=device.deviceId;return this.client.stopNotifications(device,service,characteristic)}scan(options,callback){return this.client.requestLEScan(options,callback)}stopScanning(){return this.client.stopLEScan()}readDescriptor(device,service,characteristic,descriptor,options){return this.client.readDescriptor(device.deviceId,service,characteristic,descriptor,options)}writeDescriptor(device,service,characteristic,descriptor,value,options){return this.client.writeDescriptor(device.deviceId,service,characteristic,descriptor,BLEClient.toDataView(value),options)}readRssi(device){return this.client.readRssi(device.deviceId)}isMobile(){let check=false;(function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4)))check=true})(navigator.userAgent||navigator.vendor||window.opera);return check}isAndroid(){const device=navigator.userAgent.toLowerCase();return device.indexOf("android")>-1}async distance(device,txPower,x3,exp,c){let rssi=await this.readRssi(device);if(rssi==0)return void 0;let ratio=rssi/txPower;if(ratio<1){return Math.pow(ratio,10)}else{return x3*Math.pow(ratio,exp)+c}}async distanceFromPhone(device,txPower,model){let x3,exp,c;if(model){if(model==="nexus5"){x3=.42093;exp=6.9476;c=.54992}else if(model==="motoX"){x3=.9401940951;exp=6.170094565;c=0}else if(model==="iphone5"){x3=.89976;exp=7.7095;c=.111}}return await this.distance(device,txPower,x3,exp,c)}};(function(s){var w,f={},l=console,m=Math,z22="postMessage",x3="HackTimer.js by turuslan: ",v2="Initialisation failed",p2=0,r="hasOwnProperty",y22=[].slice,b=Worker;function d2(){do{p2=2147483647>p2?p2+1:0}while(f[r](p2));return p2}if(!/MSIE 10/i.test(navigator.userAgent)){try{s=URL.createObjectURL(new Blob(["var f={},p=postMessage,r=\'hasOwnProperty\';onmessage=function(e){var d=e.data,i=d.i,t=d[r](\'t\')?d.t:0;switch(d.n){case\'a\':f[i]=setInterval(function(){p(i)},t);break;case\'b\':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case\'c\':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case\'d\':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch(e){}}if(typeof b!=="undefined"){try{w=new b(s);setInterval=function(c,t22){var i22=d2();f[i22]={c,p:y22.call(arguments,2)};w[z22]({n:"a",i:i22,t:t22});return i22};clearInterval=function(i22){if(f[r](i22))delete f[i22],w[z22]({n:"b",i:i22})};setTimeout=function(c,t22){var i22=d2();f[i22]={c,p:y22.call(arguments,2),t:true};w[z22]({n:"c",i:i22,t:t22});return i22};clearTimeout=function(i22){if(f[r](i22))delete f[i22],w[z22]({n:"d",i:i22})};w.onmessage=function(e){var i22=e.data,c,n;if(f[r](i22)){n=f[i22];c=n.c;if(n[r]("t"))delete f[i22]}if(typeof c=="string")try{c=new Function(c)}catch(k){l.log(x3+"Error parsing callback code string: ",k)}if(typeof c=="function")c.apply(globalThis,n.p)};w.onerror=function(e){l.log(e)}}catch(e){l.log(x3+v2);l.error(e)}}else l.log(x3+v2+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js");var WebSerial=class extends ByteParser2{constructor(){super(...arguments);this.streams={};this.createStream=options=>{let stream={_id:options._id?options._id:`stream${Math.floor(Math.random()*1e15)}`,info:options.port.getInfo(),running:false,...options};if(options.port?.readable){if(options.transforms){stream.reader=WebSerial.setStreamTransforms(options.port.readable,options.transforms).getReader()}else{stream.reader=options.port.readable.getReader()}}this.streams[stream._id]=stream;return stream}}getPorts(){return navigator.serial.getPorts()}requestPort(usbVendorId,usbProductId){let options={};if(usbVendorId){options.usbVendorId=usbVendorId}if(usbProductId){options.usbProductId=usbProductId}if(options.usbVendorId)return navigator.serial.requestPort({filters:[options]});else return navigator.serial.requestPort()}openPort(port,options){if(options)options=Object.assign({},options);if(options?.ondisconnect){port.ondisconnect=options.ondisconnect;delete options.ondisconnect}return port.open(options).then(()=>{if(options?.onconnect)options.onconnect(port)})}async readWithTimeout(port,timeout){const reader=port.readable.getReader();const timer=setTimeout(()=>{reader.releaseLock()},timeout);const result=await reader.read();clearTimeout(timer);reader.releaseLock();return result}async writePort(port,message){const writer=port.writable.getWriter();await writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}getSignals(port){return port.getSignals()}setSignals(port,signals){return port.setSignals(signals)}readStream(stream){if(stream.reader&&!stream.running){let reader=stream.reader;if(stream.buffering){if(typeof stream.buffering!=="object")stream.buffering={};if(!stream.buffering.buffer){stream.buffering.buffer=[]}if(!stream.buffering.searchBytes)stream.buffering.searchBytes=new Uint8Array([13,10])}let readLoop=()=>{if(stream.port.readable&&stream.running){reader.read().then(result=>{if(result.done)reader.releaseLock();else{if(stream.buffering){stream.buffering.buffer.push(...result.value);const needle=stream.buffering.searchBytes;const haystack=stream.buffering.buffer;const search=WebSerial.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=stream.buffering.lockIdx??0;for(var i22=search(haystack);i22!==-1;i22=search(haystack,i22+skip)){if(!stream.buffering.locked&&!("lockIdx"in stream.buffering))used=stream.buffering.lockIdx=i22;else{nextIndex=i22;if(nextIndex>=0){const len=nextIndex-used;if(!stream.buffering.locked){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(data);stream.buffering.locked=true}else if(len>0){const line=stream.buffering.buffer.splice(stream.buffering.lockIdx,len);const data=new Uint8Array(line.slice(stream.buffering.searchBytes.length));stream.ondata(new Uint8Array(data))}used=nextIndex}}}}else stream.ondata(result.value);setTimeout(()=>{readLoop()},stream.frequency)}}).catch(er=>{console.error(stream._id," Read error:",er);if(er.message.includes("overrun")||er.message.includes("framing")){delete stream.reader;this.reconnect(stream)}})}else if(!stream.running&&stream.port.readable){try{reader.releaseLock()}catch(er){console.error(er)}}};stream.running=true;readLoop();return stream}return void 0}writeStream(stream,message){if(typeof stream==="string")stream=this.streams[stream];if(stream.port.writable){let writer=stream.port.writable.getWriter();writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}return void 0}closeStream(stream,onclose){if(typeof stream==="string")stream=this.streams[stream];stream.running=false;return new Promise((res,rej)=>{if(stream.settings.beforedisconnect){stream.settings.beforedisconnect(this,stream.port)}setTimeout(async()=>{if(stream.port.readable&&stream.reader){try{stream.reader.releaseLock()}catch(er){console.error(er)}if(stream.transforms)try{await stream.reader.cancel()}catch(err){console.error(err)}}try{await stream.port.close().then(()=>{if(onclose)onclose(this.streams[stream._id])});delete this.streams[stream._id];res(true)}catch(er){rej(er)}},300)})}reconnect(stream,options){if(typeof stream==="string")stream=this.streams[stream];return new Promise((res,rej)=>{if(typeof stream!=="object"){rej(void 0);return}let info=stream.port.getInfo();this.closeStream(stream._id).then(closed=>{setTimeout(()=>{this.getPorts().then(ports=>{for(let i22=0;i22<ports.length;i22++){if(ports[i22].getInfo().usbVendorId===info.usbVendorId&&ports[i22].getInfo().usbProductId===info.usbProductId){if(!options)options=stream;else options._id=stream._id;delete options.port;this.openPort(ports[i22],options.settings).then(()=>{const stream2=this.createStream({...options,port:ports[i22]});this.readStream(stream2);res(stream2)}).catch(rej)}}}).catch(rej)},100)})})}static setStreamTransforms(stream,transforms){let transform=[];Object.keys(transforms).forEach(t22=>{let opt=transforms[t22];if(opt instanceof TransformStream){transform.push(opt)}else{if(!opt.start)opt.start=function start(){};if(!opt.flush)opt.flush=function flush(){};let transformer=new TransformStream({start:opt.start,transform:opt.transform,flush:opt.flush},opt.writableStrategy,opt.readableStrategy);transform.push(transformer)}});let str3=stream;transform.forEach(transform2=>{str3=str3.pipeThrough(transform2)});return str3}};var sps=250;var gain=32;var nbits=24;var vref=1.2;var half24bit=Math.pow(2,24)/2;function ads131m08codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i22=0;i22<9;i22++){let j=i22*25;output[0][i22]=ByteParser2.bytesToInt24(arr[j],arr[j+1],arr[j+2]);output[1][i22]=ByteParser2.bytesToInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i22]=ByteParser2.bytesToInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i22]=ByteParser2.bytesToInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i22]=ByteParser2.bytesToInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i22]=ByteParser2.bytesToInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i22]=ByteParser2.bytesToInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i22]=ByteParser2.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])}if(arr.length>225){output.leds=arr.slice(225)}return output}function ads131m08codec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i22=0;i22<9;i22++){let j=i22*25;output[0][i22]=ByteParser2.bytesToInt24(arr[j],arr[j+1],arr[j+2])+half24bit;output[1][i22]=ByteParser2.bytesToInt24(arr[j+3],arr[j+4],arr[j+5])+half24bit;output[2][i22]=ByteParser2.bytesToInt24(arr[j+6],arr[j+7],arr[j+8])+half24bit;output[3][i22]=ByteParser2.bytesToInt24(arr[j+9],arr[j+10],arr[j+11])+half24bit;output[4][i22]=ByteParser2.bytesToInt24(arr[j+12],arr[j+13],arr[j+14])+half24bit;output[5][i22]=ByteParser2.bytesToInt24(arr[j+15],arr[j+16],arr[j+17])+half24bit;output[6][i22]=ByteParser2.bytesToInt24(arr[j+18],arr[j+19],arr[j+20])+half24bit;output[7][i22]=ByteParser2.bytesToInt24(arr[j+21],arr[j+22],arr[j+23])+half24bit}if(arr.length>225){output.leds=arr.slice(225)}return output}var decoder=new TextDecoder;function ads131m08_arduinocodec(data){const parsed=decoder.decode(data);let split;if(parsed.includes("|"))split=parsed.split("|");else if(split.includes(","))split=parsed.split(",");else split=parsed.split("	");return{"0":parseInt(split[0]),"1":parseInt(split[1]),"2":parseInt(split[2]),"3":parseInt(split[3]),"4":parseInt(split[4]),"5":parseInt(split[5]),"6":parseInt(split[6]),"7":parseInt(split[7]),timestamp:Date.now()}}var defaultChartSetting={nSec:10,sps,units:"mV"};var ads131m08ChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting)),"1":JSON.parse(JSON.stringify(defaultChartSetting)),"2":JSON.parse(JSON.stringify(defaultChartSetting)),"3":JSON.parse(JSON.stringify(defaultChartSetting)),"4":JSON.parse(JSON.stringify(defaultChartSetting)),"5":JSON.parse(JSON.stringify(defaultChartSetting)),"6":JSON.parse(JSON.stringify(defaultChartSetting)),"7":JSON.parse(JSON.stringify(defaultChartSetting))}};var defaultsetting={sps,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))};var halfOffset=.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))*(Math.pow(2,nbits)-1)*.5;var ads131m08FilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting)),"1":JSON.parse(JSON.stringify(defaultsetting)),"2":JSON.parse(JSON.stringify(defaultsetting)),"3":JSON.parse(JSON.stringify(defaultsetting)),"4":JSON.parse(JSON.stringify(defaultsetting)),"5":JSON.parse(JSON.stringify(defaultsetting)),"6":JSON.parse(JSON.stringify(defaultsetting)),"7":JSON.parse(JSON.stringify(defaultsetting))};var accScale=.002/Math.pow(2,4);var getAcc=(arr,output,channels=8)=>{const accIdx=channels*3+1;const sum=(a,b)=>a+b;const accSum=arr.slice(accIdx).reduce(sum,0);if(accSum!==0){output.ax=accScale*ByteParser2.bytesToInt16(arr[accIdx],arr[accIdx+1]);output.ay=accScale*ByteParser2.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output.az=accScale*ByteParser2.bytesToInt16(arr[accIdx+4],arr[accIdx+5])}};function cytoncodec(data){let arr;if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i22=0;i22<8;i22++){let idx=1+3*i22;output[i22]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);output.timestamp=Date.now();return output}function daisycytoncodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i22=0;i22<8;i22++){let idx=1+3*i22;if(arr[0]%2===0)output[i22+7]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2]);else output[i22]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}getAcc(arr,output);return output}var sps2=250;var cytonSerialSettings={deviceType:"USB",deviceName:"cyton",baudRate:115200,codec:cytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var daisycytonSerialSettings={deviceType:"USB",deviceName:"cyton_daisy",baudRate:115200,codec:daisycytoncodec,write:"b",beforedisconnect:(client,port)=>{client.writePort(port,"s")},buffering:{searchBytes:new Uint8Array([192,160])},sps:sps2};var defaultChartSetting2={nSec:10,sps:sps2,units:"mV"};var defaultChartSetting22={nSec:10,sps:sps2};var cytonChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting2)),"1":JSON.parse(JSON.stringify(defaultChartSetting2)),"2":JSON.parse(JSON.stringify(defaultChartSetting2)),"3":JSON.parse(JSON.stringify(defaultChartSetting2)),"4":JSON.parse(JSON.stringify(defaultChartSetting2)),"5":JSON.parse(JSON.stringify(defaultChartSetting2)),"6":JSON.parse(JSON.stringify(defaultChartSetting2)),"7":JSON.parse(JSON.stringify(defaultChartSetting2)),"ax":JSON.parse(JSON.stringify(defaultChartSetting22)),"ay":JSON.parse(JSON.stringify(defaultChartSetting22)),"az":JSON.parse(JSON.stringify(defaultChartSetting22))},generateNewLines:true};var defaultsetting2={sps:sps2,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))};var cytonFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting2)),"1":JSON.parse(JSON.stringify(defaultsetting2)),"2":JSON.parse(JSON.stringify(defaultsetting2)),"3":JSON.parse(JSON.stringify(defaultsetting2)),"4":JSON.parse(JSON.stringify(defaultsetting2)),"5":JSON.parse(JSON.stringify(defaultsetting2)),"6":JSON.parse(JSON.stringify(defaultsetting2)),"7":JSON.parse(JSON.stringify(defaultsetting2)),"8":JSON.parse(JSON.stringify(defaultsetting2)),"9":JSON.parse(JSON.stringify(defaultsetting2)),"10":JSON.parse(JSON.stringify(defaultsetting2)),"11":JSON.parse(JSON.stringify(defaultsetting2)),"12":JSON.parse(JSON.stringify(defaultsetting2)),"13":JSON.parse(JSON.stringify(defaultsetting2)),"14":JSON.parse(JSON.stringify(defaultsetting2)),"15":JSON.parse(JSON.stringify(defaultsetting2))};function freeeeg128codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i22=0;i22<128;i22++){let idx=i22*3+1;output[i22]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=385;output["ax"]=ByteParser2.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser2.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser2.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser2.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser2.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser2.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps3=250;var freeeeg128SerialSettings={deviceType:"USB",deviceName:"freeeeg128",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg128codec,sps:sps3,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg128ChartSettings={lines:{"ax":{nSec:10,sps:sps3},"ay":{nSec:10,sps:sps3},"az":{nSec:10,sps:sps3},"gx":{nSec:10,sps:sps3},"gy":{nSec:10,sps:sps3},"gz":{nSec:10,sps:sps3}}};var freeeeg128FilterSettings={};for(let i22=0;i22<128;i22++){freeeeg128ChartSettings.lines[i22]={sps:sps3,nSec:10,units:"mV"};freeeeg128FilterSettings[i22]={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))}}function freeeeg32codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i22=0;i22<32;i22++){let idx=i22*3+1;output[i22]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=97;output["ax"]=ByteParser2.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser2.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser2.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser2.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser2.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser2.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps4=512;var freeeeg32SerialSettings={deviceType:"USB",deviceName:"freeeeg32",baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var freeeeg32_optical_SerialSettings={deviceType:"USB",deviceName:"freeeeg32_optical",baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting3={nSec:10,sps:sps4};var freeeeg32ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting3)),"ay":JSON.parse(JSON.stringify(defaultChartSetting3)),"az":JSON.parse(JSON.stringify(defaultChartSetting3)),"gx":JSON.parse(JSON.stringify(defaultChartSetting3)),"gy":JSON.parse(JSON.stringify(defaultChartSetting3)),"gz":JSON.parse(JSON.stringify(defaultChartSetting3))}};var freeeeg32FilterSettings={};for(let i22=0;i22<32;i22++){freeeeg32ChartSettings.lines[i22]={sps:sps4,nSec:10,units:"mV"};freeeeg32FilterSettings[i22]={sps:sps4,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))}}function freeeeg16codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i22=0;i22<16;i22++){let idx=i22*3+1;output[i22]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser2.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser2.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser2.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser2.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser2.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser2.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var BLEBuffer=[];var locked;var lockIdx;function freeeeg16BLEcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;BLEBuffer.push(...data);const needle=new Uint8Array([192,160]);const haystack=BLEBuffer;const search=ByteParser2.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;let used=lockIdx??0;let pass=false;for(var i22=search(haystack);i22!==-1;i22=search(haystack,i22+skip)){if(!locked&&!(typeof lockIdx==="number"))used=lockIdx=i22;else{nextIndex=i22;if(nextIndex>=0){const len=nextIndex-used;if(!lockIdx){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true;locked=true}else if(len>0){const line=BLEBuffer.splice(lockIdx,len);arr=new Uint8Array(line.slice(needle.length));pass=true}used=nextIndex}}}if(pass){let output={};for(let i3=0;i3<16;i3++){let idx=i3*3+1;output[i3]=ByteParser2.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=16*3+1;output["ax"]=ByteParser2.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser2.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser2.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser2.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser2.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser2.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}else return void 0}var sps5=250;var freeeeg16BLESettings={deviceType:"BLE",deviceName:"freeeeg16",services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:void 0},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:freeeeg16BLEcodec,sps:sps5}}}};var freeeeg16SerialSettings={deviceType:"USB",deviceName:"freeeeg16",baudRate:115200,bufferSize:2e3,frequency:3.5,codec:freeeeg16codec,sps:sps5,buffering:{searchBytes:new Uint8Array([192,160])}};var defaultChartSetting4={nSec:10,sps:sps5};var freeeeg16ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting4)),"ay":JSON.parse(JSON.stringify(defaultChartSetting4)),"az":JSON.parse(JSON.stringify(defaultChartSetting4)),"gx":JSON.parse(JSON.stringify(defaultChartSetting4)),"gy":JSON.parse(JSON.stringify(defaultChartSetting4)),"gz":JSON.parse(JSON.stringify(defaultChartSetting4))}};var freeeeg16FilterSettings={};var gain2=32;var nbits2=24;var vref2=1.2;for(let i22=0;i22<16;i22++){freeeeg16ChartSettings.lines[i22]={sps:sps5,nSec:10,units:"mV"};freeeeg16FilterSettings[i22]={sps:sps5,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref2/(gain2*(Math.pow(2,nbits2)-1))}}var textdecoder=new TextDecoder;function hegduinocodec(value){let output={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0};let txt=textdecoder.decode(value);let line=txt.split("|");if(line.length===3){output.timestamp=Date.now();output.red=parseInt(line[0]);output.infrared=parseInt(line[1]);output.heg=parseFloat(line[2])}else if(line.length>=2){output.timestamp=Date.now();output.red=parseInt(line[1]);output.infrared=parseInt(line[2]);output.heg=parseFloat(line[3]);if(line[4])output.ambient=parseFloat(line[4]);if(line[5])output.temperature=parseFloat(line[5]);return output}else return txt}var sps6=40;var hegduinoSerialSettings={deviceType:"USB",deviceName:"hegduino",baudRate:115200,write:"t\\n",codec:hegduinocodec,sps:sps6};var hegduinoV1SerialSettings=Object.assign({},hegduinoSerialSettings);hegduinoV1SerialSettings.sps=19;var hegduinoBLESettings={deviceType:"BLE",deviceName:"hegduino",sps:sps6,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:hegduinocodec,sps:sps6}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};var hegduinoV1BLESettings=Object.assign({},hegduinoSerialSettings);hegduinoV1BLESettings.sps=19;function max3010xcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let pktCt=32;const output={"red":new Array(pktCt),"ir":new Array(pktCt),"max_dietemp":ByteParser2.get2sCompliment(arr[193],8)+.0625*arr[194],"timestamp":Date.now()};let i22=0;while(i22<pktCt){let idx=i22*6;if(i22%2===0){output["ir"][i22]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["ir"][i22+1]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}else{output["red"][i22-1]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["red"][i22]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}i22++}return output}function mpu6050codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={"ax":new Array(20),"ay":new Array(20),"az":new Array(20),"gx":new Array(20),"gy":new Array(20),"gz":new Array(20),"mpu_dietemp":(ByteParser2.bytesToInt16(arr[241],arr[242])+521)/340+35,timestamp:Date.now()};for(let i22=0;i22<20;i22++){let idx=i22*12;output.ax[i22]=ByteParser2.bytesToInt16(arr[idx+1],arr[idx+2]);output.ay[i22]=ByteParser2.bytesToInt16(arr[idx+3],arr[idx+4]);output.az[i22]=ByteParser2.bytesToInt16(arr[idx+5],arr[idx+6]);output.gx[i22]=ByteParser2.bytesToInt16(arr[idx+7],arr[idx+8]);output.gy[i22]=ByteParser2.bytesToInt16(arr[idx+9],arr[idx+10]);output.gz[i22]=ByteParser2.bytesToInt16(arr[idx+11],arr[idx+12])}return output}function cognixionONE_EEG_codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let i22=0;i22<7;i22++){let j=i22*26+1;if(!arr[j+23])break;output[0][i22]=ByteParser2.bytesToUInt24(arr[j],arr[j+1],arr[j+2]);output[1][i22]=ByteParser2.bytesToUInt24(arr[j+3],arr[j+4],arr[j+5]);output[2][i22]=ByteParser2.bytesToUInt24(arr[j+6],arr[j+7],arr[j+8]);output[3][i22]=ByteParser2.bytesToUInt24(arr[j+9],arr[j+10],arr[j+11]);output[4][i22]=ByteParser2.bytesToUInt24(arr[j+12],arr[j+13],arr[j+14]);output[5][i22]=ByteParser2.bytesToUInt24(arr[j+15],arr[j+16],arr[j+17]);output[6][i22]=ByteParser2.bytesToUInt24(arr[j+18],arr[j+19],arr[j+20]);output[7][i22]=ByteParser2.bytesToUInt24(arr[j+21],arr[j+22],arr[j+23])}return output}var sps8=250;var cognixionONEBLESettings={deviceType:"BLE",deviceName:"cognixionONE",services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:true,notifyCallback:void 0,codec:cognixionONE_EEG_codec,sps:sps8}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:true}}},sps:sps8};var cognixionONESerialSettings=Object.assign({},cytonSerialSettings);cognixionONESerialSettings.sps=sps8;cognixionONESerialSettings.deviceName="cognixionONE";var defaultChartSetting5={nSec:10,sps:sps8,units:"mV"};var cognixionONEChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting5)),"1":JSON.parse(JSON.stringify(defaultChartSetting5)),"2":JSON.parse(JSON.stringify(defaultChartSetting5)),"3":JSON.parse(JSON.stringify(defaultChartSetting5)),"4":JSON.parse(JSON.stringify(defaultChartSetting5)),"5":JSON.parse(JSON.stringify(defaultChartSetting5)),"6":JSON.parse(JSON.stringify(defaultChartSetting5)),"7":JSON.parse(JSON.stringify(defaultChartSetting5))}};var PeanutCodes={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function peanutcodec(data){let result={};let i22=0;while(i22<data.length){if(PeanutCodes[data[i22]]&&i22+1+PeanutCodes[data[i22]].byteLength<=data.length){let slice=data.slice(i22+1,i22+1+PeanutCodes[data[i22]].byteLength).buffer;let unpacked=ByteParser2.struct(PeanutCodes[data[i22]].format).unpack(slice);let code=PeanutCodes[data[i22]].type;if(code==="unfilteredHEG"||code==="heg")unpacked=unpacked[0]/256;else if(code==="POOR_SIGNAL"||code==="sampleNumber"||code==="debug0"||code==="debug1"||code==="debug2"||code==="debug3")unpacked=unpacked[0];if(!result[PeanutCodes[data[i22]].type]){if(Array.isArray(unpacked))result[PeanutCodes[data[i22]].type]=unpacked;else result[PeanutCodes[data[i22]].type]=[unpacked]}else{if(Array.isArray(unpacked))result[PeanutCodes[data[i22]].type].push(...unpacked);else result[PeanutCodes[data[i22]].type].push(unpacked)}i22+=PeanutCodes[data[i22]].byteLength+1}else i22++}result.timestamp=Date.now();return result}var peanutSerialSettings={deviceType:"USB",deviceName:"peanut",baudRate:38400,bufferSize:400,write:"protocol 3\\n",buffering:{searchBytes:new Uint8Array([170,170])},codec:peanutcodec,sps:10.101};var sealevel_hpa=1013.25;var bme280codec=data=>{let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={timestamp:Date.now(),temp:[],pressure:[],altitude:[]};let mode=0;if(arr[0].length===74)mode=1;if(!mode){for(let j=0;j<3;j++){let i22=j*16+2;let tint=ByteParser2.bytesToInt32(arr[3+i22],arr[2+i22],arr[1+i22],arr[0+i22]);let tfrac=ByteParser2.bytesToInt32(arr[7+i22],arr[6+i22],arr[5+i22],arr[4+i22]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser2.bytesToInt32(arr[11+i22],arr[10+i22],arr[9+i22],arr[8+i22]);let pfrac=ByteParser2.bytesToInt32(arr[15+i22],arr[14+i22],arr[13+i22],arr[12+i22]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}else{output.humidity=[];for(let j=0;j<3;j++){let i22=j*24+2;let tint=ByteParser2.bytesToInt32(arr[3+i22],arr[2+i22],arr[1+i22],arr[0+i22]);let tfrac=ByteParser2.bytesToInt32(arr[7+i22],arr[6+i22],arr[5+i22],arr[4+i22]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=10*ByteParser2.bytesToInt32(arr[11+i22],arr[10+i22],arr[9+i22],arr[8+i22]);let pfrac=ByteParser2.bytesToInt32(arr[15+i22],arr[14+i22],arr[13+i22],arr[12+i22]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));let hint=ByteParser2.bytesToInt32(arr[19+i22],arr[18+i22],arr[17+i22],arr[16+i22]);let hfrac=ByteParser2.bytesToInt32(arr[23+i22],arr[22+i22],arr[21+i22],arr[20+i22]);output.humidity.push(hint+hfrac/Math.pow(10,Math.ceil(Math.log10(hfrac))));output.altitude.push(altitude(output.pressure[j],output.temp[j]))}}return output};function altitude(pressure,temperature){return 44330*(1-Math.pow(pressure/sealevel_hpa,.1903))}function nrf5x_usbcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i22)=>{output[i22+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec(arr.subarray(2))))}return output}function nrf5x_usbcodec_singleended(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec_singleended(arr.subarray(2)))}else if(arr[0]===3){let result=Object.assign(output,ads131m08codec(arr.subarray(2)));Object.keys(result).forEach((key,i22)=>{output[i22+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,Object.assign(output,ads131m08codec_singleended(arr.subarray(2))))}return output}var nrf5xSerialSettings={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec,sps:250};var nrf5xSerialSettings_singleended={deviceType:"USB",deviceName:"nrf5x",baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec_singleended,sps:250};var nrf5xBLESettings={deviceType:"BLE",deviceName:"nrf5x",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var nrf5xBLESettings_singleended={deviceType:"BLE",deviceName:"nrf5x_singleended",sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec_singleended,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var defaultChartSetting6={nSec:10,sps:250,units:"mV"};var nrf5x_usbChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting6)),"1":JSON.parse(JSON.stringify(defaultChartSetting6)),"2":JSON.parse(JSON.stringify(defaultChartSetting6)),"3":JSON.parse(JSON.stringify(defaultChartSetting6)),"4":JSON.parse(JSON.stringify(defaultChartSetting6)),"5":JSON.parse(JSON.stringify(defaultChartSetting6)),"6":JSON.parse(JSON.stringify(defaultChartSetting6)),"7":JSON.parse(JSON.stringify(defaultChartSetting6))},generateNewLines:true,cleanGeneration:false};var gain3=32;var nbits3=24;var vref3=1.2;var defaultsetting3={sps:250,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref3/(gain3*(Math.pow(2,nbits3)-1))};var nrf5x_usbFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting3)),"1":JSON.parse(JSON.stringify(defaultsetting3)),"2":JSON.parse(JSON.stringify(defaultsetting3)),"3":JSON.parse(JSON.stringify(defaultsetting3)),"4":JSON.parse(JSON.stringify(defaultsetting3)),"5":JSON.parse(JSON.stringify(defaultsetting3)),"6":JSON.parse(JSON.stringify(defaultsetting3)),"7":JSON.parse(JSON.stringify(defaultsetting3)),"8":JSON.parse(JSON.stringify(defaultsetting3)),"9":JSON.parse(JSON.stringify(defaultsetting3)),"10":JSON.parse(JSON.stringify(defaultsetting3)),"11":JSON.parse(JSON.stringify(defaultsetting3)),"12":JSON.parse(JSON.stringify(defaultsetting3)),"13":JSON.parse(JSON.stringify(defaultsetting3)),"14":JSON.parse(JSON.stringify(defaultsetting3)),"15":JSON.parse(JSON.stringify(defaultsetting3))};var textdecoder2=new TextDecoder;function statechangercodec(value){let output={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0};let txt=textdecoder2.decode(value);let line=txt.split("|");if(line.length>=5){output.timestamp=Date.now();output.left_red=parseInt(line[1]);output.left_infrared=parseInt(line[2]);output.left_heg=parseFloat(line[3]);output.center_red=parseInt(line[4]);output.center_infrared=parseInt(line[5]);output.center_heg=parseFloat(line[6]);output.right_red=parseInt(line[7]);output.right_infrared=parseInt(line[8]);output.right_heg=parseFloat(line[9]);return output}else return txt}var statechangerSerialSettings={deviceType:"USB",deviceName:"statechanger",baudRate:115200,codec:statechangercodec,sps:20};var statechangerBLESettings={deviceType:"BLE",deviceName:"statechanger",sps:20,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:statechangercodec}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};function blueberrycodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.red/(.5*(output.ir+output.ir2));return output}var sps9=40;var blueberryBLESettings={deviceType:"BLE",deviceName:"blueberry",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:true,notifyCallback:void 0,codec:blueberrycodec,sps:sps9}}},sps:sps9};function blueberryshortcodec(value){let output={sred:value.getInt32(2),sir:value.getInt32(6),sir2:value.getInt32(10),timestamp:Date.now()};output.sheg=output.sred/(.5*(output.sir+output.sir2));return output}function blueberrylongcodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.sred/(.5*(output.ir+output.ir2));return output}var sps10=40;var blueberry2BLESettings={deviceType:"BLE",deviceName:"blueberry2",namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:true,notifyCallback:void 0,codec:blueberrylongcodec,sps:sps10},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:true,notifyCallback:void 0,codec:blueberryshortcodec,sps:sps10}}},sps:sps10};function hrcodec(data){return{hr:data.getInt8(1),timestamp:Date.now()}}var heartRateBLESettings={deviceType:"BLE",deviceName:"heartrate",services:{"heart_rate":{"heart_rate_measurement":{notify:true,notifyCallback:void 0,codec:hrcodec}}}};var simulatorSettings={sps:250,deviceType:"CUSTOM",deviceName:"simulator",simulate:{"0":{sps:250,freq:1,amplitude:1,offset:0},"1":{sps:250,freq:10,amplitude:1,offset:0},"2":{sps:250,freq:100,amplitude:.5,offset:.5},"3":{sps:250,freq:25,amplitude:1,offset:0}},connect:(settings={})=>{return new Promise(async(res,rej)=>{let _id=`simulated${Math.floor(Math.random()*1e15)}`;let info={_id,settings:Object.assign(Object.assign({},simulatorSettings),settings)};info.settings.looping=true;let loopTime=50;let lastTime=Date.now();let loop22=()=>{if(info.settings.looping){let newData={};let now=Date.now();let frame=now-lastTime;for(const key in info.settings.simulate){let newPoints=Math.floor(info.settings.simulate[key].sps*frame/1e3);newData[key]=new Array(newPoints).fill(0);newData[key]=newData[key].map((v2,i22)=>{return Math.sin(2*Math.PI*info.settings.simulate[key].freq*.001*(lastTime+frame*(i22+1)/newPoints))*info.settings.simulate[key].amplitude+info.settings.simulate[key].offset})}lastTime=now;newData.timestamp=lastTime;info.settings.ondata(newData);setTimeout(()=>{loop22()},loopTime)}};loop22();if(info.settings.onconnect)info.settings.onconnect(info);res(info)})},codec:reading=>{return reading},disconnect:info=>{console.log(info);info.settings.looping=false;info.settings.ondisconnect(info)},onconnect:info=>{console.log("simulator connected!",info)},ondisconnect:info=>{console.log("simulator disconnected!",info)},ondata:data=>{}};var BiquadChannelFilterer=class{constructor(options={sps:512,useSMA4:false,useNotch50:true,useNotch60:true,useLowpass:false,lowpassHz:100,useBandpass:false,bandpassLower:3,bandpassUpper:45,useDCBlock:true,DCBresonance:.995,trimOutliers:false,outlierTolerance:.2,useScaling:false,scalar:1}){this.idx=0;this.sps=options.sps;this.bandpassLower=options.bandpassLower?options.bandpassLower:3;this.bandpassUpper=options.bandpassUpper?options.bandpassUpper:45;this.useSMA4=options.useSMA4;this.last4=[];this.useNotch50=options.useNotch50;this.useNotch60=options.useNotch60;this.useLowpass=options.useLowpass;this.lowpassHz=options.lowpassHz?options.lowpassHz:100;this.useBandpass=options.useBandpass;this.useDCBlock=options.useDCBlock;this.DCBresonance=options.DCBresonance?options.DCBresonance:.995;this.useScaling=options.useScaling;this.scalar=options.scalar;this.trimOutliers=options.trimOutliers;this.outlierTolerance=options.outlierTolerance;let sps11=this.sps;this.notch50=[makeNotchFilter(50,sps11,2),makeNotchFilter(100,sps11,2)];this.notch60=[makeNotchFilter(60,sps11,2),makeNotchFilter(120,sps11,2)];this.lp1=[new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1)];this.dcb=new DCBlocker(options.DCBresonance?options.DCBresonance:.995)}reset(sps11=this.sps){this.notch50=[makeNotchFilter(50,sps11,2),makeNotchFilter(100,sps11,2)];this.notch60=[makeNotchFilter(60,sps11,2),makeNotchFilter(120,sps11,2)];this.lp1=[new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11),new Biquad2("lowpass",this.lowpassHz,sps11)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1)];this.dcb=new DCBlocker(this.DCBresonance)}setBandpass(bandpassLower=this.bandpassLower,bandpassUpper=this.bandpassUpper,sps11=this.sps){this.bandpassLower=bandpassLower;this.bandpassUpper=bandpassUpper;this.bp1=[makeBandpassFilter(bandpassLower,bandpassUpper,sps11),makeBandpassFilter(bandpassLower,bandpassUpper,sps11),makeBandpassFilter(bandpassLower,bandpassUpper,sps11),makeBandpassFilter(bandpassLower,bandpassUpper,sps11)]}apply(latestData=0){let out=latestData;if(this.useScaling===true){out*=this.scalar}if(this.filtered&&this.trimOutliers&&this.outlierTolerance){if(Math.abs(out-this.filtered)>this.outlierTolerance){out=this.filtered}}if(this.useDCBlock===true){out=this.dcb.applyFilter(out)}if(this.useSMA4===true){if(this.last4.length<4){this.last4.push(out)}else{out=this.last4.reduce((accumulator,currentValue)=>accumulator+currentValue)/this.last4.length;this.last4.shift();this.last4.push(out)}}if(this.useNotch50===true){this.notch50.forEach((f,i22)=>{out=f.applyFilter(out)})}if(this.useNotch60===true){this.notch60.forEach((f,i22)=>{out=f.applyFilter(out)})}if(this.useLowpass===true){this.lp1.forEach((f,i22)=>{out=f.applyFilter(out)})}if(this.useBandpass===true){this.bp1.forEach((f,i22)=>{out=f.applyFilter(out)})}this.filtered=out;this.idx++;return out}};var Biquad2=class{constructor(type,freq,sps11,Q=1/Math.sqrt(2),dbGain=0){this.a0=0;this.a1=0;this.a2=0;this.b0=0;this.b1=0;this.b2=0;this.x1=0;this.x2=0;this.y1=0;this.y2=0;let types=["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"];if(types.indexOf(type)<0){console.error("Valid types: \'lowpass\',\'highpass\',\'bandpass\',\'notch\',\'peak\',\'lowshelf\',\'highshelf\'");return}this.type=type;this.freq=freq;this.sps=sps11;this.Q=Q;this.dbGain=dbGain;let A22=Math.pow(10,dbGain/40);let omega=2*Math.PI*freq/sps11;let sn=Math.sin(omega);let cs=Math.cos(omega);let alpha=sn/(2*Q);let beta=Math.sqrt(A22+A22);this[type](A22,sn,cs,alpha,beta);this.b0/=this.a0;this.b1/=this.a0;this.b2/=this.a0;this.a1/=this.a0;this.a2/=this.a0}lowpass(A22,sn,cs,alpha,beta){this.b0=(1-cs)*.5;this.b1=1-cs;this.b2=(1-cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}highpass(A22,sn,cs,alpha,beta){this.b0=(1+cs)*.5;this.b1=-(1+cs);this.b2=(1+cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}bandpass(A22,sn,cs,alpha,beta){this.b0=alpha;this.b1=0;this.b2=-alpha;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}notch(A22,sn,cs,alpha,beta){this.b0=1;this.b1=-2*cs;this.b2=1;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}peak(A22,sn,cs,alpha,beta){this.b0=1+alpha*A22;this.b1=-2*cs;this.b2=1-alpha*A22;this.a0=1+alpha/A22;this.a1=-2*cs;this.a2=1-alpha/A22}lowshelf(A22,sn,cs,alpha,beta){this.b0=A22*(A22+1-(A22-1)*cs+beta*sn);this.b1=2*A22*(A22-1-(A22+1)*cs);this.b2=A22*(A22+1-(A22-1)*cs-beta*sn);this.a0=A22+1+(A22+1)*cs+beta*sn;this.a1=2*(A22-1+(A22+1)*cs);this.a2=A22+1+(A22-1)*cs-beta*sn}highshelf(A22,sn,cs,alpha,beta){this.b0=A22*(A22+1+(A22-1)*cs+beta*sn);this.b1=2*A22*(A22-1+(A22+1)*cs);this.b2=A22*(A22+1-(A22-1)*cs-beta*sn);this.a0=A22+1-(A22+1)*cs-beta*sn;this.a1=2*(A22-1-(A22+1)*cs);this.a2=A22+1-(A22-1)*cs-beta*sn}applyFilter(signal_step){let y22=this.b0*signal_step+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;this.x2=this.x1;this.x1=signal_step;this.y2=this.y1;this.y1=y22;return y22}zResult(freq){try{let phi=Math.pow(Math.sin(Math.PI*freq*2/(2*this.sps)),2);let result=(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*phi+16*this.b0*this.b2*phi*phi)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*phi+16*this.a2*phi*phi);return result}catch(err){return-200}}static calcCenterFrequency(freqStart,freqEnd){return(freqStart+freqEnd)/2}static calcBandwidth(freqStart,freqEnd){return freqEnd-this.calcCenterFrequency(freqStart,freqEnd)}static calcBandpassQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*Math.sqrt((frequency-bandwidth)*(frequency+bandwidth))/(2*bandwidth);return Q}static calcNotchQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q=resonance*frequency*bandwidth/Math.sqrt((frequency-bandwidth)*(frequency+bandwidth));return Q}};var DCBlocker=class{constructor(r=.995){this.r=r;this.y1=this.y2=this.x1=this.x2=0}applyFilter(signal_step){this.x2=this.x1;this.x1=signal_step;let y22=this.x1-this.x2+this.r*this.y1;this.y2=this.y1;this.y1=y22;return y22}};var makeNotchFilter=(frequency,sps11,bandwidth)=>{return new Biquad2("notch",frequency,sps11,Biquad2.calcNotchQ(frequency,bandwidth),0)};var makeBandpassFilter=(freqStart,freqEnd,sps11,resonance=Math.pow(10,Math.floor(Math.log10(Biquad2.calcCenterFrequency(freqStart,freqEnd)))))=>{return new Biquad2("bandpass",Biquad2.calcCenterFrequency(freqStart,freqEnd),sps11,Biquad2.calcBandpassQ(Biquad2.calcCenterFrequency(freqStart,freqEnd),Biquad2.calcBandwidth(freqStart,freqEnd),resonance),0)};var defaultsetting1={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var ganglionFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting1)),"1":JSON.parse(JSON.stringify(defaultsetting1)),"2":JSON.parse(JSON.stringify(defaultsetting1)),"3":JSON.parse(JSON.stringify(defaultsetting1))};var defaultChartSetting7={nSec:10,sps:250,units:"mV"};var ganglionChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting7)),"1":JSON.parse(JSON.stringify(defaultChartSetting7)),"2":JSON.parse(JSON.stringify(defaultChartSetting7)),"3":JSON.parse(JSON.stringify(defaultChartSetting7)),"ax":{nSec:10,sps:250,units:"mg"},"ay":{nSec:10,sps:250,units:"mg"},"az":{nSec:10,sps:250,units:"mg"}},generateNewLines:true};var defaultsetting4={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var museFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting4)),"1":JSON.parse(JSON.stringify(defaultsetting4)),"2":JSON.parse(JSON.stringify(defaultsetting4)),"3":JSON.parse(JSON.stringify(defaultsetting4)),"4":JSON.parse(JSON.stringify(defaultsetting4))};var Devices={BLE:{"nrf5x":nrf5xBLESettings,"nrf5x_singleended":nrf5xBLESettings_singleended,"hegduino":hegduinoBLESettings,"hegduinoV1":hegduinoV1BLESettings,"cognixionONE":cognixionONEBLESettings,"statechanger":statechangerBLESettings,"blueberry":blueberryBLESettings,"blueberry2":blueberry2BLESettings,"heart_rate":heartRateBLESettings,"freeEEG16":freeeeg16BLESettings},USB:{"nrf5x":nrf5xSerialSettings,"nrf5x_singleended":nrf5xSerialSettings_singleended,"freeEEG16":freeeeg16SerialSettings,"freeEEG32":freeeeg32SerialSettings,"freeEEG32_optical":freeeeg32_optical_SerialSettings,"freeEEG128":freeeeg128SerialSettings,"hegduino":hegduinoSerialSettings,"hegduinoV1":hegduinoV1SerialSettings,"cyton":cytonSerialSettings,"cyton_daisy":daisycytonSerialSettings,"peanut":peanutSerialSettings,"statechanger":statechangerSerialSettings,"cognixionONE":cytonSerialSettings},BLE_CUSTOM:{},USB_CUSTOM:{},CUSTOM:{"simulator":simulatorSettings}};var textdecoder3=new TextDecoder;var decoders={"raw":data=>{if(data?.buffer)return Array.from(new Uint8Array(data));else return data},"utf8":data=>{return textdecoder3.decode(data)},"console-f12":data=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(data);return data},"debug":(data,debugmessage)=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(debugmessage,data);return data},"ads131m08":ads131m08codec,"arduino_ads131m08":ads131m08_arduinocodec,"max3010x":max3010xcodec,"mpu6050":mpu6050codec,"bme280":bme280codec,"freeeeg16":freeeeg16codec,"freeeeg32":freeeeg32codec,"freeeeg128":freeeeg128codec,"cyton":cytoncodec,"cognixionONE_BLE":cognixionONE_EEG_codec,"hegduino":hegduinocodec,"nrf5x":nrf5x_usbcodec,"peanut":peanutcodec,"statechanger":statechangercodec,"blueberry":blueberrycodec,"heart_rate":hrcodec};function parseFunctionFromText22(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(method)}catch{}}}return newFunc}var stringifyWithCircularRefs22=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs3(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs22}var stringifyFast22=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c=value.constructor.name;if(key&&c==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c.includes("Set")){val=Array.from(value)}else if(c!=="Object"&&c!=="Number"&&c!=="String"&&c!=="Boolean"){val="instanceof_"+c}else if(c==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p2 in value[prop]){if(Array.isArray(value[prop][p2])){if(value[prop][p2].length>20)obj[prop][p2]=value[prop][p2].slice(value[prop][p2].length-20);else obj[prop][p2]=value[prop][p2]}else{if(value[prop][p2]!=null){let con=value[prop][p2].constructor.name;if(con.includes("Set")){obj[prop][p2]=Array.from(value[prop][p2])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p2]="instanceof_"+con}else{obj[prop][p2]=value[prop][p2]}}else{obj[prop][p2]=value[prop][p2]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast3(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast22}function loadStreamWorkerGlobals(){globalThis.Devices=Devices;globalThis.WebSerial=WebSerial;globalThis.decoders=decoders;globalThis.decoder="raw";globalThis.ByteParser=ByteParser2;globalThis.filtering=false;globalThis.filters={};globalThis.BiquadChannelFilterer=BiquadChannelFilterer;globalThis.ArrayManip=ArrayManip2}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){loadStreamWorkerGlobals()}var streamWorkerRoutes={"transferDevice":function transferDevice(device,worker){let cpy=Object.assign({},device);for(const key in cpy){if(typeof cpy[key]==="function")cpy[key]=cpy[key].toString()}worker.send({route:"receiveDevice",args:cpy})},"receiveDevice":function receiveDevice(device){for(const key in device){if(typeof device[key]==="string"){let fn=parseFunctionFromText22(device[key]);if(typeof fn==="function"){device[key]=fn}}}if(!globalThis.Devices[device.deviceType])globalThis.Devices[device.deviceType]={};globalThis.Devices[device.deviceType][device.deviceName]=device},"receiveDecoder":function receiveDecoder(decoder2,decoderName){globalThis.decoders[decoderName]=(0,eval)("("+decoder2+")")},"receiveCodec":function receiveDeviceCodec(decoder2,deviceType,device,service,characteristic){let codec=parseFunctionFromText22(decoder2);if(codec){if(deviceType==="BLE"&&service&&characteristic){if(globalThis.Devices[deviceType][device]){if(globalThis.Devices[deviceType][device][service]){if(globalThis.Devices[deviceType][device][characteristic]){globalThis.Devices[deviceType][device][characteristic].codec=codec}else{globalThis.Devices[deviceType][device][characteristic]={codec}}}else{globalThis.Devices[deviceType][device]={[characteristic]:{codec}}}}}else if(globalThis.Devices[deviceType][device]?.codec){if(globalThis.Devices[deviceType][device])globalThis.Devices[deviceType][device].codec=codec;else{globalThis.Devices[deviceType][device]={codec}}}}},"decode":function decode2(data){return globalThis.decoder(data)},"decodeAndParse":function decodeAndParse(data){let decoded=this.__node.graph.run("decode",data);if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v2=>filter.apply(v2))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v2=>filter.apply(v2))}}}}return parsed}}return decoded},"setActiveDecoder":function setActiveDecoder(deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device]?.codec;else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device][service][characteristic].codec;return true},"decodeDevice":function decodeDevice(data,deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)return globalThis.Devices[deviceType][device].codec(data);else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)return globalThis.Devices[deviceType][device][service][characteristic].codec(data)},"decodeAndParseDevice":function decodeAndParseDevice(data,deviceType,deviceName,service,characteristic){let decoded;if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][deviceName]?.services[service]?.[characteristic]?.codec)decoded=globalThis.Devices[deviceType][deviceName].services[service][characteristic].codec(data);else if(globalThis.Devices[deviceType][deviceName]?.codec)decoded=globalThis.Devices[deviceType][deviceName].codec(data);else decoded=data;if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v2=>filter.apply(v2))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v2=>filter.apply(v2))}else if(typeof parsed[prop]==="number"){parsed[prop]=filter.apply(parsed[prop])}}}}return parsed}}return decoded},"toggleAnim":function toggleAnim(){globalThis.runningAnim=!globalThis.runningAnim;return globalThis.runningAnim},"setFilters":function setFilters(filters,clearFilters=false){if(!globalThis.filters||clearFilters){globalThis.filters={};if(clearFilters)globalThis.filtering=false}if(filters){for(const key in filters){globalThis.filters[key]=new BiquadChannelFilterer(filters[key])}globalThis.filtering=true}return true},"getFilterSettings":function getFilterSettings(){if(globalThis.filters){let filters={};for(const key in globalThis.filters){filters[key]={sps:globalThis.filters[key].sps,useScaling:globalThis.filters[key].useScaling,scalar:globalThis.filters[key].scalar,useNotch50:globalThis.filters[key].useNotch50,useNotch60:globalThis.filters[key].useNotch60,useDCBlock:globalThis.filters[key].useDCBlock,useLowpass:globalThis.filters[key].useLowpass,lowpassHz:globalThis.filters[key].lowpassHz,useBandpass:globalThis.filters[key].useBandpass,bandpassLower:globalThis.filters[key].bandpassLower,bandpassUpper:globalThis.filters[key].bandpassUpper}}return filters}return void 0},"setupSerial":function setupSerial(){globalThis.Serial=new globalThis.WebSerial;globalThis.decoder="raw";console.log("worker: Setting up Serial",globalThis.Serial);return true},"openPort":function openPort(settings){const WorkerService22=this.__node.graph;if(!globalThis.Serial)WorkerService22.run("setupSerial");return new Promise((res,rej)=>{globalThis.Serial.getPorts().then(ports=>{const Serial=globalThis.Serial;let port=ports.find(port2=>{return port2.getInfo().usbVendorId===settings.usbVendorId&&port2.getInfo().usbProductId===settings.usbProductId});if(port){let options=Object.assign({},settings);if(typeof settings.pipeTo==="object"&&settings.pipeTo.extraArgs&&globalThis.Devices?.[settings.pipeTo.extraArgs[0]]?.[settings.pipeTo.extraArgs[1]]){options.onconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].onconnect;options.ondisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].ondisconnect;options.beforedisconnect=globalThis.Devices[settings.pipeTo.extraArgs[0]][settings.pipeTo.extraArgs[1]].beforedisconnect}Serial.openPort(port,options).then(()=>{const stream=Serial.createStream({port,settings:options,frequency:settings.frequency?settings.frequency:10,buffering:settings.buffering,ondata:value=>{if(stream.settings.pipeTo){if(stream.settings.pipeMain){WorkerService22.transmit(value,void 0,[value.buffer])}if(typeof stream.settings.pipeTo==="string")WorkerService22.transmit(value,stream.settings.pipeTo,[value.buffer]);else if(stream.settings.pipeTo?.route){let args=value;if(stream.settings.pipeTo.extraArgs)args=[value,...stream.settings.pipeTo.extraArgs];WorkerService22.transmit({route:stream.settings.pipeTo.route,args},stream.settings.pipeTo._id,[value.buffer])}}else{WorkerService22.transmit(value,void 0,[value.buffer])}}});Serial.readStream(stream);port.ondisconnect=()=>{postMessage(`${stream._id} disconnected`)};res({_id:stream._id,settings,info:stream.info})}).catch(()=>{postMessage(`disconnected`)});;}else{rej(false)}})})},"closeStream":function closeStream(streamId){return new Promise((res,rej)=>{const Serial=globalThis.Serial;let ondisconnect;if(Serial.streams[streamId].port?.ondisconnect)ondisconnect=Serial.streams[streamId].port.ondisconnect;Serial.closeStream(Serial.streams[streamId]).then(resolved=>{if(ondisconnect)ondisconnect(void 0);res(resolved)}).catch(rej)})},"writeStream":function writeStream(streamId,message){globalThis.Serial.writeStream(globalThis.Serial.streams[streamId],message);return true},"updateStreamSettings":function updateStreamSettings(streamId,settings){if(globalThis.Serial?.streams[streamId]){for(const key in settings){if(typeof settings[key]==="object"){Object.assign(globalThis.Serial.streams[streamId].settings[key],settings[key])}else globalThis.Serial.streams[streamId][key]=settings[key]}}}};var BLE=new BLEClient;var workers=new WorkerService2({roots:{...workerCanvasRoutes2,...remoteGraphRoutes2}});var __create4=Object.create;var __defProp4=Object.defineProperty;var __getOwnPropDesc4=Object.getOwnPropertyDescriptor;var __getOwnPropNames4=Object.getOwnPropertyNames;var __getProtoOf4=Object.getPrototypeOf;var __hasOwnProp4=Object.prototype.hasOwnProperty;var __commonJS4=(cb,mod)=>function __require5(){return mod||(0,cb[__getOwnPropNames4(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps4=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames4(from))if(!__hasOwnProp4.call(to,key)&&key!==except)__defProp4(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc4(from,key))||desc.enumerable})}return to};var __toESM4=(mod,isNodeMode,target)=>(target=mod!=null?__create4(__getProtoOf4(mod)):{},__copyProps4(isNodeMode||!mod||!mod.__esModule?__defProp4(target,"default",{value:mod,enumerable:true}):target,mod));var require_browserfs=__commonJS4({"node_modules/browserfs/dist/browserfs.js"(exports,module2){(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module2==="object")module2.exports=factory();else if(typeof define==="function"&&define.amd)define([],factory);else if(typeof exports==="object")exports["BrowserFS"]=factory();else root["BrowserFS"]=factory()})(exports,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module22=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module22.exports,module22,module22.exports,__webpack_require__);module22.loaded=true;return module22.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)}([function(module22,exports2,__webpack_require__){(function(Buffer2,global2,module3,process){"use strict";Object.defineProperty(exports2,"__esModule",{value:true});var buffer=__webpack_require__(2);var path=__webpack_require__(9);var ErrorCode;(function(ErrorCode2){ErrorCode2[ErrorCode2["EPERM"]=1]="EPERM";ErrorCode2[ErrorCode2["ENOENT"]=2]="ENOENT";ErrorCode2[ErrorCode2["EIO"]=5]="EIO";ErrorCode2[ErrorCode2["EBADF"]=9]="EBADF";ErrorCode2[ErrorCode2["EACCES"]=13]="EACCES";ErrorCode2[ErrorCode2["EBUSY"]=16]="EBUSY";ErrorCode2[ErrorCode2["EEXIST"]=17]="EEXIST";ErrorCode2[ErrorCode2["ENOTDIR"]=20]="ENOTDIR";ErrorCode2[ErrorCode2["EISDIR"]=21]="EISDIR";ErrorCode2[ErrorCode2["EINVAL"]=22]="EINVAL";ErrorCode2[ErrorCode2["EFBIG"]=27]="EFBIG";ErrorCode2[ErrorCode2["ENOSPC"]=28]="ENOSPC";ErrorCode2[ErrorCode2["EROFS"]=30]="EROFS";ErrorCode2[ErrorCode2["ENOTEMPTY"]=39]="ENOTEMPTY";ErrorCode2[ErrorCode2["ENOTSUP"]=95]="ENOTSUP"})(ErrorCode||(ErrorCode={}));var ErrorStrings={};ErrorStrings[ErrorCode.EPERM]="Operation not permitted.";ErrorStrings[ErrorCode.ENOENT]="No such file or directory.";ErrorStrings[ErrorCode.EIO]="Input/output error.";ErrorStrings[ErrorCode.EBADF]="Bad file descriptor.";ErrorStrings[ErrorCode.EACCES]="Permission denied.";ErrorStrings[ErrorCode.EBUSY]="Resource busy or locked.";ErrorStrings[ErrorCode.EEXIST]="File exists.";ErrorStrings[ErrorCode.ENOTDIR]="File is not a directory.";ErrorStrings[ErrorCode.EISDIR]="File is a directory.";ErrorStrings[ErrorCode.EINVAL]="Invalid argument.";ErrorStrings[ErrorCode.EFBIG]="File is too big.";ErrorStrings[ErrorCode.ENOSPC]="No space left on disk.";ErrorStrings[ErrorCode.EROFS]="Cannot modify a read-only file system.";ErrorStrings[ErrorCode.ENOTEMPTY]="Directory is not empty.";ErrorStrings[ErrorCode.ENOTSUP]="Operation is not supported.";var ApiError=function(Error2){function ApiError2(type,message,path$$1){if(message===void 0)message=ErrorStrings[type];Error2.call(this,message);this.syscall="";this.errno=type;this.code=ErrorCode[type];this.path=path$$1;this.stack=new Error2().stack;this.message="Error: "+this.code+": "+message+(this.path?", \'"+this.path+"\'":"")}if(Error2)ApiError2.__proto__=Error2;ApiError2.prototype=Object.create(Error2&&Error2.prototype);ApiError2.prototype.constructor=ApiError2;ApiError2.fromJSON=function fromJSON(json){var err=new ApiError2(0);err.errno=json.errno;err.code=json.code;err.path=json.path;err.stack=json.stack;err.message=json.message;return err};ApiError2.fromBuffer=function fromBuffer(buffer$$1,i22){if(i22===void 0)i22=0;return ApiError2.fromJSON(JSON.parse(buffer$$1.toString("utf8",i22+4,i22+4+buffer$$1.readUInt32LE(i22))))};ApiError2.FileError=function FileError(code,p2){return new ApiError2(code,ErrorStrings[code],p2)};ApiError2.ENOENT=function ENOENT(path$$1){return this.FileError(ErrorCode.ENOENT,path$$1)};ApiError2.EEXIST=function EEXIST(path$$1){return this.FileError(ErrorCode.EEXIST,path$$1)};ApiError2.EISDIR=function EISDIR(path$$1){return this.FileError(ErrorCode.EISDIR,path$$1)};ApiError2.ENOTDIR=function ENOTDIR(path$$1){return this.FileError(ErrorCode.ENOTDIR,path$$1)};ApiError2.EPERM=function EPERM(path$$1){return this.FileError(ErrorCode.EPERM,path$$1)};ApiError2.ENOTEMPTY=function ENOTEMPTY(path$$1){return this.FileError(ErrorCode.ENOTEMPTY,path$$1)};ApiError2.prototype.toString=function toString(){return this.message};ApiError2.prototype.toJSON=function toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message}};ApiError2.prototype.writeToBuffer=function writeToBuffer(buffer$$1,i22){if(buffer$$1===void 0)buffer$$1=Buffer2.alloc(this.bufferSize());if(i22===void 0)i22=0;var bytesWritten=buffer$$1.write(JSON.stringify(this.toJSON()),i22+4);buffer$$1.writeUInt32LE(bytesWritten,i22);return buffer$$1};ApiError2.prototype.bufferSize=function bufferSize(){return 4+Buffer2.byteLength(JSON.stringify(this.toJSON()))};return ApiError2}(Error);var api_error=Object.freeze({get ErrorCode(){return ErrorCode},ErrorStrings,ApiError});var ActionType;(function(ActionType2){ActionType2[ActionType2["NOP"]=0]="NOP";ActionType2[ActionType2["THROW_EXCEPTION"]=1]="THROW_EXCEPTION";ActionType2[ActionType2["TRUNCATE_FILE"]=2]="TRUNCATE_FILE";ActionType2[ActionType2["CREATE_FILE"]=3]="CREATE_FILE"})(ActionType||(ActionType={}));var FileFlag=function FileFlag2(flagStr){this.flagStr=flagStr;if(FileFlag2.validFlagStrs.indexOf(flagStr)<0){throw new ApiError(ErrorCode.EINVAL,"Invalid flag: "+flagStr)}};FileFlag.getFileFlag=function getFileFlag(flagStr){if(FileFlag.flagCache.hasOwnProperty(flagStr)){return FileFlag.flagCache[flagStr]}return FileFlag.flagCache[flagStr]=new FileFlag(flagStr)};FileFlag.prototype.getFlagString=function getFlagString(){return this.flagStr};FileFlag.prototype.isReadable=function isReadable(){return this.flagStr.indexOf("r")!==-1||this.flagStr.indexOf("+")!==-1};FileFlag.prototype.isWriteable=function isWriteable(){return this.flagStr.indexOf("w")!==-1||this.flagStr.indexOf("a")!==-1||this.flagStr.indexOf("+")!==-1};FileFlag.prototype.isTruncating=function isTruncating(){return this.flagStr.indexOf("w")!==-1};FileFlag.prototype.isAppendable=function isAppendable(){return this.flagStr.indexOf("a")!==-1};FileFlag.prototype.isSynchronous=function isSynchronous(){return this.flagStr.indexOf("s")!==-1};FileFlag.prototype.isExclusive=function isExclusive(){return this.flagStr.indexOf("x")!==-1};FileFlag.prototype.pathExistsAction=function pathExistsAction(){if(this.isExclusive()){return ActionType.THROW_EXCEPTION}else if(this.isTruncating()){return ActionType.TRUNCATE_FILE}else{return ActionType.NOP}};FileFlag.prototype.pathNotExistsAction=function pathNotExistsAction(){if((this.isWriteable()||this.isAppendable())&&this.flagStr!=="r+"){return ActionType.CREATE_FILE}else{return ActionType.THROW_EXCEPTION}};FileFlag.flagCache={};FileFlag.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"];var FileType;(function(FileType2){FileType2[FileType2["FILE"]=32768]="FILE";FileType2[FileType2["DIRECTORY"]=16384]="DIRECTORY";FileType2[FileType2["SYMLINK"]=40960]="SYMLINK"})(FileType||(FileType={}));var Stats=function Stats2(itemType,size,mode,atime,mtime,ctime){if(atime===void 0)atime=new Date;if(mtime===void 0)mtime=new Date;if(ctime===void 0)ctime=new Date;this.size=size;this.atime=atime;this.mtime=mtime;this.ctime=ctime;this.dev=0;this.ino=0;this.rdev=0;this.nlink=1;this.blksize=4096;this.uid=0;this.gid=0;this.birthtime=new Date(0);this.fileData=null;if(!mode){switch(itemType){case FileType.FILE:this.mode=420;break;case FileType.DIRECTORY:default:this.mode=511}}else{this.mode=mode}this.blocks=Math.ceil(size/512);if(this.mode<4096){this.mode|=itemType}};Stats.fromBuffer=function fromBuffer(buffer$$1){var size=buffer$$1.readUInt32LE(0),mode=buffer$$1.readUInt32LE(4),atime=buffer$$1.readDoubleLE(8),mtime=buffer$$1.readDoubleLE(16),ctime=buffer$$1.readDoubleLE(24);return new Stats(mode&61440,size,mode&4095,new Date(atime),new Date(mtime),new Date(ctime))};Stats.prototype.toBuffer=function toBuffer(){var buffer$$1=Buffer2.alloc(32);buffer$$1.writeUInt32LE(this.size,0);buffer$$1.writeUInt32LE(this.mode,4);buffer$$1.writeDoubleLE(this.atime.getTime(),8);buffer$$1.writeDoubleLE(this.mtime.getTime(),16);buffer$$1.writeDoubleLE(this.ctime.getTime(),24);return buffer$$1};Stats.prototype.clone=function clone(){return new Stats(this.mode&61440,this.size,this.mode&4095,this.atime,this.mtime,this.ctime)};Stats.prototype.isFile=function isFile(){return(this.mode&61440)===FileType.FILE};Stats.prototype.isDirectory=function isDirectory(){return(this.mode&61440)===FileType.DIRECTORY};Stats.prototype.isSymbolicLink=function isSymbolicLink(){return(this.mode&61440)===FileType.SYMLINK};Stats.prototype.chmod=function chmod(mode){this.mode=this.mode&61440|mode};Stats.prototype.isSocket=function isSocket(){return false};Stats.prototype.isBlockDevice=function isBlockDevice(){return false};Stats.prototype.isCharacterDevice=function isCharacterDevice(){return false};Stats.prototype.isFIFO=function isFIFO(){return false};var wrapCb=function(cb,numArgs){return cb};function assertRoot(fs4){if(fs4){return fs4}throw new ApiError(ErrorCode.EIO,"Initialize BrowserFS with a file system using BrowserFS.initialize(filesystem)")}function normalizeMode(mode,def){switch(typeof mode){case"number":return mode;case"string":var trueMode=parseInt(mode,8);if(!isNaN(trueMode)){return trueMode}return def;default:return def}}function normalizeTime(time){if(time instanceof Date){return time}else if(typeof time==="number"){return new Date(time*1e3)}else{throw new ApiError(ErrorCode.EINVAL,"Invalid time.")}}function normalizePath(p2){if(p2.indexOf("\\0")>=0){throw new ApiError(ErrorCode.EINVAL,"Path must be a string without null bytes.")}else if(p2===""){throw new ApiError(ErrorCode.EINVAL,"Path must not be empty.")}return path.resolve(p2)}function normalizeOptions(options,defEnc,defFlag,defMode){switch(typeof options){case"object":return{encoding:typeof options["encoding"]!=="undefined"?options["encoding"]:defEnc,flag:typeof options["flag"]!=="undefined"?options["flag"]:defFlag,mode:normalizeMode(options["mode"],defMode)};case"string":return{encoding:options,flag:defFlag,mode:defMode};default:return{encoding:defEnc,flag:defFlag,mode:defMode}}}function nopCb(){}var FS=function FS2(){this.F_OK=0;this.R_OK=4;this.W_OK=2;this.X_OK=1;this.root=null;this.fdMap={};this.nextFd=100};FS.prototype.initialize=function initialize3(rootFS){if(!rootFS.constructor.isAvailable()){throw new ApiError(ErrorCode.EINVAL,"Tried to instantiate BrowserFS with an unavailable file system.")}return this.root=rootFS};FS.prototype._toUnixTimestamp=function _toUnixTimestamp(time){if(typeof time==="number"){return time}else if(time instanceof Date){return time.getTime()/1e3}throw new Error("Cannot parse time: "+time)};FS.prototype.getRootFS=function getRootFS(){if(this.root){return this.root}else{return null}};FS.prototype.rename=function rename(oldPath,newPath,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{assertRoot(this.root).rename(normalizePath(oldPath),normalizePath(newPath),newCb)}catch(e){newCb(e)}};FS.prototype.renameSync=function renameSync(oldPath,newPath){assertRoot(this.root).renameSync(normalizePath(oldPath),normalizePath(newPath))};FS.prototype.exists=function exists2(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{return assertRoot(this.root).exists(normalizePath(path$$1),newCb)}catch(e){return newCb(false)}};FS.prototype.existsSync=function existsSync(path$$1){try{return assertRoot(this.root).existsSync(normalizePath(path$$1))}catch(e){return false}};FS.prototype.stat=function stat(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,2);try{return assertRoot(this.root).stat(normalizePath(path$$1),false,newCb)}catch(e){return newCb(e)}};FS.prototype.statSync=function statSync(path$$1){return assertRoot(this.root).statSync(normalizePath(path$$1),false)};FS.prototype.lstat=function lstat(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,2);try{return assertRoot(this.root).stat(normalizePath(path$$1),true,newCb)}catch(e){return newCb(e)}};FS.prototype.lstatSync=function lstatSync(path$$1){return assertRoot(this.root).statSync(normalizePath(path$$1),true)};FS.prototype.truncate=function truncate(path$$1,arg2,cb){if(arg2===void 0)arg2=0;if(cb===void 0)cb=nopCb;var len=0;if(typeof arg2==="function"){cb=arg2}else if(typeof arg2==="number"){len=arg2}var newCb=wrapCb(cb,1);try{if(len<0){throw new ApiError(ErrorCode.EINVAL)}return assertRoot(this.root).truncate(normalizePath(path$$1),len,newCb)}catch(e){return newCb(e)}};FS.prototype.truncateSync=function truncateSync(path$$1,len){if(len===void 0)len=0;if(len<0){throw new ApiError(ErrorCode.EINVAL)}return assertRoot(this.root).truncateSync(normalizePath(path$$1),len)};FS.prototype.unlink=function unlink(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{return assertRoot(this.root).unlink(normalizePath(path$$1),newCb)}catch(e){return newCb(e)}};FS.prototype.unlinkSync=function unlinkSync(path$$1){return assertRoot(this.root).unlinkSync(normalizePath(path$$1))};FS.prototype.open=function open(path$$1,flag,arg2,cb){var this$1=this;if(cb===void 0)cb=nopCb;var mode=normalizeMode(arg2,420);cb=typeof arg2==="function"?arg2:cb;var newCb=wrapCb(cb,2);try{assertRoot(this.root).open(normalizePath(path$$1),FileFlag.getFileFlag(flag),mode,function(e,file){if(file){newCb(e,this$1.getFdForFile(file))}else{newCb(e)}})}catch(e){newCb(e)}};FS.prototype.openSync=function openSync(path$$1,flag,mode){if(mode===void 0)mode=420;return this.getFdForFile(assertRoot(this.root).openSync(normalizePath(path$$1),FileFlag.getFileFlag(flag),normalizeMode(mode,420)))};FS.prototype.readFile=function readFile2(filename,arg2,cb){if(arg2===void 0)arg2={};if(cb===void 0)cb=nopCb;var options=normalizeOptions(arg2,null,"r",null);cb=typeof arg2==="function"?arg2:cb;var newCb=wrapCb(cb,2);try{var flag=FileFlag.getFileFlag(options["flag"]);if(!flag.isReadable()){return newCb(new ApiError(ErrorCode.EINVAL,"Flag passed to readFile must allow for reading."))}return assertRoot(this.root).readFile(normalizePath(filename),options.encoding,flag,newCb)}catch(e){return newCb(e)}};FS.prototype.readFileSync=function readFileSync(filename,arg2){if(arg2===void 0)arg2={};var options=normalizeOptions(arg2,null,"r",null);var flag=FileFlag.getFileFlag(options.flag);if(!flag.isReadable()){throw new ApiError(ErrorCode.EINVAL,"Flag passed to readFile must allow for reading.")}return assertRoot(this.root).readFileSync(normalizePath(filename),options.encoding,flag)};FS.prototype.writeFile=function writeFile2(filename,data,arg3,cb){if(arg3===void 0)arg3={};if(cb===void 0)cb=nopCb;var options=normalizeOptions(arg3,"utf8","w",420);cb=typeof arg3==="function"?arg3:cb;var newCb=wrapCb(cb,1);try{var flag=FileFlag.getFileFlag(options.flag);if(!flag.isWriteable()){return newCb(new ApiError(ErrorCode.EINVAL,"Flag passed to writeFile must allow for writing."))}return assertRoot(this.root).writeFile(normalizePath(filename),data,options.encoding,flag,options.mode,newCb)}catch(e){return newCb(e)}};FS.prototype.writeFileSync=function writeFileSync(filename,data,arg3){var options=normalizeOptions(arg3,"utf8","w",420);var flag=FileFlag.getFileFlag(options.flag);if(!flag.isWriteable()){throw new ApiError(ErrorCode.EINVAL,"Flag passed to writeFile must allow for writing.")}return assertRoot(this.root).writeFileSync(normalizePath(filename),data,options.encoding,flag,options.mode)};FS.prototype.appendFile=function appendFile3(filename,data,arg3,cb){if(cb===void 0)cb=nopCb;var options=normalizeOptions(arg3,"utf8","a",420);cb=typeof arg3==="function"?arg3:cb;var newCb=wrapCb(cb,1);try{var flag=FileFlag.getFileFlag(options.flag);if(!flag.isAppendable()){return newCb(new ApiError(ErrorCode.EINVAL,"Flag passed to appendFile must allow for appending."))}assertRoot(this.root).appendFile(normalizePath(filename),data,options.encoding,flag,options.mode,newCb)}catch(e){newCb(e)}};FS.prototype.appendFileSync=function appendFileSync(filename,data,arg3){var options=normalizeOptions(arg3,"utf8","a",420);var flag=FileFlag.getFileFlag(options.flag);if(!flag.isAppendable()){throw new ApiError(ErrorCode.EINVAL,"Flag passed to appendFile must allow for appending.")}return assertRoot(this.root).appendFileSync(normalizePath(filename),data,options.encoding,flag,options.mode)};FS.prototype.fstat=function fstat(fd,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,2);try{var file=this.fd2file(fd);file.stat(newCb)}catch(e){newCb(e)}};FS.prototype.fstatSync=function fstatSync(fd){return this.fd2file(fd).statSync()};FS.prototype.close=function close(fd,cb){var this$1=this;if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{this.fd2file(fd).close(function(e){if(!e){this$1.closeFd(fd)}newCb(e)})}catch(e){newCb(e)}};FS.prototype.closeSync=function closeSync(fd){this.fd2file(fd).closeSync();this.closeFd(fd)};FS.prototype.ftruncate=function ftruncate(fd,arg2,cb){if(cb===void 0)cb=nopCb;var length=typeof arg2==="number"?arg2:0;cb=typeof arg2==="function"?arg2:cb;var newCb=wrapCb(cb,1);try{var file=this.fd2file(fd);if(length<0){throw new ApiError(ErrorCode.EINVAL)}file.truncate(length,newCb)}catch(e){newCb(e)}};FS.prototype.ftruncateSync=function ftruncateSync(fd,len){if(len===void 0)len=0;var file=this.fd2file(fd);if(len<0){throw new ApiError(ErrorCode.EINVAL)}file.truncateSync(len)};FS.prototype.fsync=function fsync(fd,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{this.fd2file(fd).sync(newCb)}catch(e){newCb(e)}};FS.prototype.fsyncSync=function fsyncSync(fd){this.fd2file(fd).syncSync()};FS.prototype.fdatasync=function fdatasync(fd,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{this.fd2file(fd).datasync(newCb)}catch(e){newCb(e)}};FS.prototype.fdatasyncSync=function fdatasyncSync(fd){this.fd2file(fd).datasyncSync()};FS.prototype.write=function write(fd,arg2,arg3,arg4,arg5,cb){if(cb===void 0)cb=nopCb;var buffer$$1,offset,length,position=null;if(typeof arg2==="string"){var encoding="utf8";switch(typeof arg3){case"function":cb=arg3;break;case"number":position=arg3;encoding=typeof arg4==="string"?arg4:"utf8";cb=typeof arg5==="function"?arg5:cb;break;default:cb=typeof arg4==="function"?arg4:typeof arg5==="function"?arg5:cb;return cb(new ApiError(ErrorCode.EINVAL,"Invalid arguments."))}buffer$$1=Buffer2.from(arg2,encoding);offset=0;length=buffer$$1.length}else{buffer$$1=arg2;offset=arg3;length=arg4;position=typeof arg5==="number"?arg5:null;cb=typeof arg5==="function"?arg5:cb}var newCb=wrapCb(cb,3);try{var file=this.fd2file(fd);if(position===void 0||position===null){position=file.getPos()}file.write(buffer$$1,offset,length,position,newCb)}catch(e){newCb(e)}};FS.prototype.writeSync=function writeSync(fd,arg2,arg3,arg4,arg5){var buffer$$1,offset=0,length,position;if(typeof arg2==="string"){position=typeof arg3==="number"?arg3:null;var encoding=typeof arg4==="string"?arg4:"utf8";offset=0;buffer$$1=Buffer2.from(arg2,encoding);length=buffer$$1.length}else{buffer$$1=arg2;offset=arg3;length=arg4;position=typeof arg5==="number"?arg5:null}var file=this.fd2file(fd);if(position===void 0||position===null){position=file.getPos()}return file.writeSync(buffer$$1,offset,length,position)};FS.prototype.read=function read(fd,arg2,arg3,arg4,arg5,cb){if(cb===void 0)cb=nopCb;var position,offset,length,buffer$$1,newCb;if(typeof arg2==="number"){length=arg2;position=arg3;var encoding=arg4;cb=typeof arg5==="function"?arg5:cb;offset=0;buffer$$1=Buffer2.alloc(length);newCb=wrapCb(function(err,bytesRead,buf){if(err){return cb(err)}cb(err,buf.toString(encoding),bytesRead)},3)}else{buffer$$1=arg2;offset=arg3;length=arg4;position=arg5;newCb=wrapCb(cb,3)}try{var file=this.fd2file(fd);if(position===void 0||position===null){position=file.getPos()}file.read(buffer$$1,offset,length,position,newCb)}catch(e){newCb(e)}};FS.prototype.readSync=function readSync(fd,arg2,arg3,arg4,arg5){var shenanigans=false;var buffer$$1,offset,length,position,encoding="utf8";if(typeof arg2==="number"){length=arg2;position=arg3;encoding=arg4;offset=0;buffer$$1=Buffer2.alloc(length);shenanigans=true}else{buffer$$1=arg2;offset=arg3;length=arg4;position=arg5}var file=this.fd2file(fd);if(position===void 0||position===null){position=file.getPos()}var rv=file.readSync(buffer$$1,offset,length,position);if(!shenanigans){return rv}else{return[buffer$$1.toString(encoding),rv]}};FS.prototype.fchown=function fchown(fd,uid,gid,callback){if(callback===void 0)callback=nopCb;var newCb=wrapCb(callback,1);try{this.fd2file(fd).chown(uid,gid,newCb)}catch(e){newCb(e)}};FS.prototype.fchownSync=function fchownSync(fd,uid,gid){this.fd2file(fd).chownSync(uid,gid)};FS.prototype.fchmod=function fchmod(fd,mode,cb){var newCb=wrapCb(cb,1);try{var numMode=typeof mode==="string"?parseInt(mode,8):mode;this.fd2file(fd).chmod(numMode,newCb)}catch(e){newCb(e)}};FS.prototype.fchmodSync=function fchmodSync(fd,mode){var numMode=typeof mode==="string"?parseInt(mode,8):mode;this.fd2file(fd).chmodSync(numMode)};FS.prototype.futimes=function futimes(fd,atime,mtime,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{var file=this.fd2file(fd);if(typeof atime==="number"){atime=new Date(atime*1e3)}if(typeof mtime==="number"){mtime=new Date(mtime*1e3)}file.utimes(atime,mtime,newCb)}catch(e){newCb(e)}};FS.prototype.futimesSync=function futimesSync(fd,atime,mtime){this.fd2file(fd).utimesSync(normalizeTime(atime),normalizeTime(mtime))};FS.prototype.rmdir=function rmdir(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{path$$1=normalizePath(path$$1);assertRoot(this.root).rmdir(path$$1,newCb)}catch(e){newCb(e)}};FS.prototype.rmdirSync=function rmdirSync(path$$1){path$$1=normalizePath(path$$1);return assertRoot(this.root).rmdirSync(path$$1)};FS.prototype.mkdir=function mkdir(path$$1,mode,cb){if(cb===void 0)cb=nopCb;if(typeof mode==="function"){cb=mode;mode=511}var newCb=wrapCb(cb,1);try{path$$1=normalizePath(path$$1);assertRoot(this.root).mkdir(path$$1,mode,newCb)}catch(e){newCb(e)}};FS.prototype.mkdirSync=function mkdirSync(path$$1,mode){assertRoot(this.root).mkdirSync(normalizePath(path$$1),normalizeMode(mode,511))};FS.prototype.readdir=function readdir(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,2);try{path$$1=normalizePath(path$$1);assertRoot(this.root).readdir(path$$1,newCb)}catch(e){newCb(e)}};FS.prototype.readdirSync=function readdirSync(path$$1){path$$1=normalizePath(path$$1);return assertRoot(this.root).readdirSync(path$$1)};FS.prototype.link=function link(srcpath,dstpath,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{srcpath=normalizePath(srcpath);dstpath=normalizePath(dstpath);assertRoot(this.root).link(srcpath,dstpath,newCb)}catch(e){newCb(e)}};FS.prototype.linkSync=function linkSync(srcpath,dstpath){srcpath=normalizePath(srcpath);dstpath=normalizePath(dstpath);return assertRoot(this.root).linkSync(srcpath,dstpath)};FS.prototype.symlink=function symlink(srcpath,dstpath,arg3,cb){if(cb===void 0)cb=nopCb;var type=typeof arg3==="string"?arg3:"file";cb=typeof arg3==="function"?arg3:cb;var newCb=wrapCb(cb,1);try{if(type!=="file"&&type!=="dir"){return newCb(new ApiError(ErrorCode.EINVAL,"Invalid type: "+type))}srcpath=normalizePath(srcpath);dstpath=normalizePath(dstpath);assertRoot(this.root).symlink(srcpath,dstpath,type,newCb)}catch(e){newCb(e)}};FS.prototype.symlinkSync=function symlinkSync(srcpath,dstpath,type){if(!type){type="file"}else if(type!=="file"&&type!=="dir"){throw new ApiError(ErrorCode.EINVAL,"Invalid type: "+type)}srcpath=normalizePath(srcpath);dstpath=normalizePath(dstpath);return assertRoot(this.root).symlinkSync(srcpath,dstpath,type)};FS.prototype.readlink=function readlink(path$$1,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,2);try{path$$1=normalizePath(path$$1);assertRoot(this.root).readlink(path$$1,newCb)}catch(e){newCb(e)}};FS.prototype.readlinkSync=function readlinkSync(path$$1){path$$1=normalizePath(path$$1);return assertRoot(this.root).readlinkSync(path$$1)};FS.prototype.chown=function chown(path$$1,uid,gid,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{path$$1=normalizePath(path$$1);assertRoot(this.root).chown(path$$1,false,uid,gid,newCb)}catch(e){newCb(e)}};FS.prototype.chownSync=function chownSync(path$$1,uid,gid){path$$1=normalizePath(path$$1);assertRoot(this.root).chownSync(path$$1,false,uid,gid)};FS.prototype.lchown=function lchown(path$$1,uid,gid,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{path$$1=normalizePath(path$$1);assertRoot(this.root).chown(path$$1,true,uid,gid,newCb)}catch(e){newCb(e)}};FS.prototype.lchownSync=function lchownSync(path$$1,uid,gid){path$$1=normalizePath(path$$1);assertRoot(this.root).chownSync(path$$1,true,uid,gid)};FS.prototype.chmod=function chmod(path$$1,mode,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{var numMode=normalizeMode(mode,-1);if(numMode<0){throw new ApiError(ErrorCode.EINVAL,"Invalid mode.")}assertRoot(this.root).chmod(normalizePath(path$$1),false,numMode,newCb)}catch(e){newCb(e)}};FS.prototype.chmodSync=function chmodSync(path$$1,mode){var numMode=normalizeMode(mode,-1);if(numMode<0){throw new ApiError(ErrorCode.EINVAL,"Invalid mode.")}path$$1=normalizePath(path$$1);assertRoot(this.root).chmodSync(path$$1,false,numMode)};FS.prototype.lchmod=function lchmod(path$$1,mode,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{var numMode=normalizeMode(mode,-1);if(numMode<0){throw new ApiError(ErrorCode.EINVAL,"Invalid mode.")}assertRoot(this.root).chmod(normalizePath(path$$1),true,numMode,newCb)}catch(e){newCb(e)}};FS.prototype.lchmodSync=function lchmodSync(path$$1,mode){var numMode=normalizeMode(mode,-1);if(numMode<1){throw new ApiError(ErrorCode.EINVAL,"Invalid mode.")}assertRoot(this.root).chmodSync(normalizePath(path$$1),true,numMode)};FS.prototype.utimes=function utimes(path$$1,atime,mtime,cb){if(cb===void 0)cb=nopCb;var newCb=wrapCb(cb,1);try{assertRoot(this.root).utimes(normalizePath(path$$1),normalizeTime(atime),normalizeTime(mtime),newCb)}catch(e){newCb(e)}};FS.prototype.utimesSync=function utimesSync(path$$1,atime,mtime){assertRoot(this.root).utimesSync(normalizePath(path$$1),normalizeTime(atime),normalizeTime(mtime))};FS.prototype.realpath=function realpath(path$$1,arg2,cb){if(cb===void 0)cb=nopCb;var cache=typeof arg2==="object"?arg2:{};cb=typeof arg2==="function"?arg2:nopCb;var newCb=wrapCb(cb,2);try{path$$1=normalizePath(path$$1);assertRoot(this.root).realpath(path$$1,cache,newCb)}catch(e){newCb(e)}};FS.prototype.realpathSync=function realpathSync(path$$1,cache){if(cache===void 0)cache={};path$$1=normalizePath(path$$1);return assertRoot(this.root).realpathSync(path$$1,cache)};FS.prototype.watchFile=function watchFile(filename,arg2,listener){if(listener===void 0)listener=nopCb;throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.unwatchFile=function unwatchFile(filename,listener){if(listener===void 0)listener=nopCb;throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.watch=function watch(filename,arg2,listener){if(listener===void 0)listener=nopCb;throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.access=function access(path$$1,arg2,cb){if(cb===void 0)cb=nopCb;throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.accessSync=function accessSync(path$$1,mode){throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.createReadStream=function createReadStream(path$$1,options){throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.createWriteStream=function createWriteStream(path$$1,options){throw new ApiError(ErrorCode.ENOTSUP)};FS.prototype.wrapCallbacks=function wrapCallbacks(cbWrapper){wrapCb=cbWrapper};FS.prototype.getFdForFile=function getFdForFile(file){var fd=this.nextFd++;this.fdMap[fd]=file;return fd};FS.prototype.fd2file=function fd2file(fd){var rv=this.fdMap[fd];if(rv){return rv}else{throw new ApiError(ErrorCode.EBADF,"Invalid file descriptor.")}};FS.prototype.closeFd=function closeFd(fd){delete this.fdMap[fd]};FS.Stats=Stats;var fs3=new FS;var _fsMock={};var fsProto=FS.prototype;Object.keys(fsProto).forEach(function(key){if(typeof fs3[key]==="function"){_fsMock[key]=function(){return fs3[key].apply(fs3,arguments)}}else{_fsMock[key]=fs3[key]}});_fsMock["changeFSModule"]=function(newFs){fs3=newFs};_fsMock["getFSModule"]=function(){return fs3};_fsMock["FS"]=FS;function _min(d0,d1,d2,bx,ay){return d0<d1||d2<d1?d0>d2?d2+1:d0+1:bx===ay?d1:d1+1}function levenshtein(a,b){if(a===b){return 0}if(a.length>b.length){var tmp=a;a=b;b=tmp}var la=a.length;var lb=b.length;while(la>0&&a.charCodeAt(la-1)===b.charCodeAt(lb-1)){la--;lb--}var offset=0;while(offset<la&&a.charCodeAt(offset)===b.charCodeAt(offset)){offset++}la-=offset;lb-=offset;if(la===0||lb===1){return lb}var vector=new Array(la<<1);for(var y4=0;y4<la;){vector[la+y4]=a.charCodeAt(offset+y4);vector[y4]=++y4}var x3;var d0;var d1;var d2;var d3;for(x3=0;x3+3<lb;){var bx0=b.charCodeAt(offset+(d0=x3));var bx1=b.charCodeAt(offset+(d1=x3+1));var bx2=b.charCodeAt(offset+(d2=x3+2));var bx3=b.charCodeAt(offset+(d3=x3+3));var dd$1=x3+=4;for(var y$1=0;y$1<la;){var ay=vector[la+y$1];var dy=vector[y$1];d0=_min(dy,d0,d1,bx0,ay);d1=_min(d0,d1,d2,bx1,ay);d2=_min(d1,d2,d3,bx2,ay);dd$1=_min(d2,d3,dd$1,bx3,ay);vector[y$1++]=dd$1;d3=d2;d2=d1;d1=d0;d0=dy}}var dd=0;for(;x3<lb;){var bx0$1=b.charCodeAt(offset+(d0=x3));dd=++x3;for(var y$2=0;y$2<la;y$2++){var dy$1=vector[y$2];vector[y$2]=dd=dy$1<d0||dd<d0?dy$1>dd?dd+1:dy$1+1:bx0$1===vector[la+y$2]?d0:d0+1;d0=dy$1}}return dd}function deprecationMessage(print,fsName,opts){if(print){console.warn("["+fsName+"] Direct file system constructor usage is deprecated for this file system, and will be removed in the next major version. Please use the \'"+fsName+".Create("+JSON.stringify(opts)+", callback)\' method instead. See https://github.com/jvilk/BrowserFS/issues/176 for more details.")}}var isIE=typeof navigator!=="undefined"&&!!(/(msie) ([\\w.]+)/.exec(navigator.userAgent.toLowerCase())||navigator.userAgent.indexOf("Trident")!==-1);var isWebWorker=typeof window==="undefined";function fail(){throw new Error("BFS has reached an impossible code path; please file a bug.")}function mkdirpSync(p2,mode,fs4){if(!fs4.existsSync(p2)){mkdirpSync(path.dirname(p2),mode,fs4);fs4.mkdirSync(p2,mode)}}function buffer2ArrayBuffer(buff){var u8=buffer2Uint8array(buff),u8offset=u8.byteOffset,u8Len=u8.byteLength;if(u8offset===0&&u8Len===u8.buffer.byteLength){return u8.buffer}else{return u8.buffer.slice(u8offset,u8offset+u8Len)}}function buffer2Uint8array(buff){if(buff instanceof Uint8Array){return buff}else{return new Uint8Array(buff)}}function arrayish2Buffer(arr){if(arr instanceof Buffer2){return arr}else if(arr instanceof Uint8Array){return uint8Array2Buffer(arr)}else{return Buffer2.from(arr)}}function uint8Array2Buffer(u8){if(u8 instanceof Buffer2){return u8}else if(u8.byteOffset===0&&u8.byteLength===u8.buffer.byteLength){return arrayBuffer2Buffer(u8.buffer)}else{return Buffer2.from(u8.buffer,u8.byteOffset,u8.byteLength)}}function arrayBuffer2Buffer(ab){return Buffer2.from(ab)}function copyingSlice(buff,start,end){if(start===void 0)start=0;if(end===void 0)end=buff.length;if(start<0||end<0||end>buff.length||start>end){throw new TypeError("Invalid slice bounds on buffer of length "+buff.length+": ["+start+", "+end+"]")}if(buff.length===0){return emptyBuffer()}else{var u8=buffer2Uint8array(buff),s0=buff[0],newS0=(s0+1)%255;buff[0]=newS0;if(u8[0]===newS0){u8[0]=s0;return uint8Array2Buffer(u8.slice(start,end))}else{buff[0]=s0;return uint8Array2Buffer(u8.subarray(start,end))}}}var emptyBuff=null;function emptyBuffer(){if(emptyBuff){return emptyBuff}return emptyBuff=Buffer2.alloc(0)}function bufferValidator(v2,cb){if(Buffer2.isBuffer(v2)){cb()}else{cb(new ApiError(ErrorCode.EINVAL,"option must be a Buffer."))}}function checkOptions(fsType,opts,cb){var optsInfo=fsType.Options;var fsName=fsType.Name;var pendingValidators=0;var callbackCalled=false;var loopEnded=false;function validatorCallback(e){if(!callbackCalled){if(e){callbackCalled=true;cb(e)}pendingValidators--;if(pendingValidators===0&&loopEnded){cb()}}}var loop3=function(optName2){if(optsInfo.hasOwnProperty(optName2)){var opt=optsInfo[optName2];var providedValue=opts[optName2];if(providedValue===void 0||providedValue===null){if(!opt.optional){var incorrectOptions=Object.keys(opts).filter(function(o){return!(o in optsInfo)}).map(function(a){return{str:a,distance:levenshtein(optName2,a)}}).filter(function(o){return o.distance<5}).sort(function(a,b){return a.distance-b.distance});if(callbackCalled){return{}}callbackCalled=true;return{v:cb(new ApiError(ErrorCode.EINVAL,"["+fsName+"] Required option \'"+optName2+"\' not provided."+(incorrectOptions.length>0?" You provided unrecognized option \'"+incorrectOptions[0].str+"\'; perhaps you meant to type \'"+optName2+"\'.":"")+"\\nOption description: "+opt.description))}}}else{var typeMatches=false;if(Array.isArray(opt.type)){typeMatches=opt.type.indexOf(typeof providedValue)!==-1}else{typeMatches=typeof providedValue===opt.type}if(!typeMatches){if(callbackCalled){return{}}callbackCalled=true;return{v:cb(new ApiError(ErrorCode.EINVAL,"["+fsName+"] Value provided for option "+optName2+" is not the proper type. Expected "+(Array.isArray(opt.type)?"one of {"+opt.type.join(", ")+"}":opt.type)+", but received "+typeof providedValue+"\\nOption description: "+opt.description))}}else if(opt.validator){pendingValidators++;opt.validator(providedValue,validatorCallback)}}}};for(var optName in optsInfo){var returned=loop3(optName);if(returned)return returned.v}loopEnded=true;if(pendingValidators===0&&!callbackCalled){cb()}}var BFSUtils=Object.freeze({deprecationMessage,isIE,isWebWorker,fail,mkdirpSync,buffer2ArrayBuffer,buffer2Uint8array,arrayish2Buffer,uint8Array2Buffer,arrayBuffer2Buffer,copyingSlice,emptyBuffer,bufferValidator,checkOptions});var BFSEmscriptenStreamOps=function BFSEmscriptenStreamOps2(fs4){this.fs=fs4;this.nodefs=fs4.getNodeFS();this.FS=fs4.getFS();this.PATH=fs4.getPATH();this.ERRNO_CODES=fs4.getERRNO_CODES()};BFSEmscriptenStreamOps.prototype.open=function open(stream){var path$$1=this.fs.realPath(stream.node);var FS2=this.FS;try{if(FS2.isFile(stream.node.mode)){stream.nfd=this.nodefs.openSync(path$$1,this.fs.flagsToPermissionString(stream.flags))}}catch(e){if(!e.code){throw e}throw new FS2.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenStreamOps.prototype.close=function close(stream){var FS2=this.FS;try{if(FS2.isFile(stream.node.mode)&&stream.nfd){this.nodefs.closeSync(stream.nfd)}}catch(e){if(!e.code){throw e}throw new FS2.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenStreamOps.prototype.read=function read(stream,buffer$$1,offset,length,position){try{return this.nodefs.readSync(stream.nfd,uint8Array2Buffer(buffer$$1),offset,length,position)}catch(e){throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenStreamOps.prototype.write=function write(stream,buffer$$1,offset,length,position){try{return this.nodefs.writeSync(stream.nfd,uint8Array2Buffer(buffer$$1),offset,length,position)}catch(e){throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenStreamOps.prototype.llseek=function llseek(stream,offset,whence){var position=offset;if(whence===1){position+=stream.position}else if(whence===2){if(this.FS.isFile(stream.node.mode)){try{var stat=this.nodefs.fstatSync(stream.nfd);position+=stat.size}catch(e){throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}}}if(position<0){throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL)}stream.position=position;return position};var BFSEmscriptenNodeOps=function BFSEmscriptenNodeOps2(fs4){this.fs=fs4;this.nodefs=fs4.getNodeFS();this.FS=fs4.getFS();this.PATH=fs4.getPATH();this.ERRNO_CODES=fs4.getERRNO_CODES()};BFSEmscriptenNodeOps.prototype.getattr=function getattr(node){var path$$1=this.fs.realPath(node);var stat;try{stat=this.nodefs.lstatSync(path$$1)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}return{dev:stat.dev,ino:stat.ino,mode:stat.mode,nlink:stat.nlink,uid:stat.uid,gid:stat.gid,rdev:stat.rdev,size:stat.size,atime:stat.atime,mtime:stat.mtime,ctime:stat.ctime,blksize:stat.blksize,blocks:stat.blocks}};BFSEmscriptenNodeOps.prototype.setattr=function setattr(node,attr){var path$$1=this.fs.realPath(node);try{if(attr.mode!==void 0){this.nodefs.chmodSync(path$$1,attr.mode);node.mode=attr.mode}if(attr.timestamp!==void 0){var date=new Date(attr.timestamp);this.nodefs.utimesSync(path$$1,date,date)}}catch(e){if(!e.code){throw e}if(e.code!=="ENOTSUP"){throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}}if(attr.size!==void 0){try{this.nodefs.truncateSync(path$$1,attr.size)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}}};BFSEmscriptenNodeOps.prototype.lookup=function lookup(parent,name2){var path$$1=this.PATH.join2(this.fs.realPath(parent),name2);var mode=this.fs.getMode(path$$1);return this.fs.createNode(parent,name2,mode)};BFSEmscriptenNodeOps.prototype.mknod=function mknod(parent,name2,mode,dev){var node=this.fs.createNode(parent,name2,mode,dev);var path$$1=this.fs.realPath(node);try{if(this.FS.isDir(node.mode)){this.nodefs.mkdirSync(path$$1,node.mode)}else{this.nodefs.writeFileSync(path$$1,"",{mode:node.mode})}}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}return node};BFSEmscriptenNodeOps.prototype.rename=function rename(oldNode,newDir,newName){var oldPath=this.fs.realPath(oldNode);var newPath=this.PATH.join2(this.fs.realPath(newDir),newName);try{this.nodefs.renameSync(oldPath,newPath);oldNode.name=newName;oldNode.parent=newDir}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenNodeOps.prototype.unlink=function unlink(parent,name2){var path$$1=this.PATH.join2(this.fs.realPath(parent),name2);try{this.nodefs.unlinkSync(path$$1)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenNodeOps.prototype.rmdir=function rmdir(parent,name2){var path$$1=this.PATH.join2(this.fs.realPath(parent),name2);try{this.nodefs.rmdirSync(path$$1)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenNodeOps.prototype.readdir=function readdir(node){var path$$1=this.fs.realPath(node);try{var contents=this.nodefs.readdirSync(path$$1);contents.push(".","..");return contents}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenNodeOps.prototype.symlink=function symlink(parent,newName,oldPath){var newPath=this.PATH.join2(this.fs.realPath(parent),newName);try{this.nodefs.symlinkSync(oldPath,newPath)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};BFSEmscriptenNodeOps.prototype.readlink=function readlink(node){var path$$1=this.fs.realPath(node);try{return this.nodefs.readlinkSync(path$$1)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}};var BFSEmscriptenFS=function BFSEmscriptenFS2(_FS,_PATH,_ERRNO_CODES,nodefs){if(_FS===void 0)_FS=self["FS"];if(_PATH===void 0)_PATH=self["PATH"];if(_ERRNO_CODES===void 0)_ERRNO_CODES=self["ERRNO_CODES"];if(nodefs===void 0)nodefs=_fsMock;this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"};this.nodefs=nodefs;this.FS=_FS;this.PATH=_PATH;this.ERRNO_CODES=_ERRNO_CODES;this.node_ops=new BFSEmscriptenNodeOps(this);this.stream_ops=new BFSEmscriptenStreamOps(this)};BFSEmscriptenFS.prototype.mount=function mount(m){return this.createNode(null,"/",this.getMode(m.opts.root),0)};BFSEmscriptenFS.prototype.createNode=function createNode(parent,name2,mode,dev){var FS2=this.FS;if(!FS2.isDir(mode)&&!FS2.isFile(mode)&&!FS2.isLink(mode)){throw new FS2.ErrnoError(this.ERRNO_CODES.EINVAL)}var node=FS2.createNode(parent,name2,mode);node.node_ops=this.node_ops;node.stream_ops=this.stream_ops;return node};BFSEmscriptenFS.prototype.getMode=function getMode(path$$1){var stat;try{stat=this.nodefs.lstatSync(path$$1)}catch(e){if(!e.code){throw e}throw new this.FS.ErrnoError(this.ERRNO_CODES[e.code])}return stat.mode};BFSEmscriptenFS.prototype.realPath=function realPath(node){var parts=[];while(node.parent!==node){parts.push(node.name);node=node.parent}parts.push(node.mount.opts.root);parts.reverse();return this.PATH.join.apply(null,parts)};BFSEmscriptenFS.prototype.flagsToPermissionString=function flagsToPermissionString(flags){var parsedFlags=typeof flags==="string"?parseInt(flags,10):flags;parsedFlags&=8191;if(parsedFlags in this.flagsToPermissionStringMap){return this.flagsToPermissionStringMap[parsedFlags]}else{return flags}};BFSEmscriptenFS.prototype.getNodeFS=function getNodeFS(){return this.nodefs};BFSEmscriptenFS.prototype.getFS=function getFS(){return this.FS};BFSEmscriptenFS.prototype.getPATH=function getPATH(){return this.PATH};BFSEmscriptenFS.prototype.getERRNO_CODES=function getERRNO_CODES(){return this.ERRNO_CODES};var BaseFileSystem=function BaseFileSystem2(){};BaseFileSystem.prototype.supportsLinks=function supportsLinks(){return false};BaseFileSystem.prototype.diskSpace=function diskSpace(p2,cb){cb(0,0)};BaseFileSystem.prototype.openFile=function openFile(p2,flag,cb){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.createFile=function createFile(p2,flag,mode,cb){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.open=function open(p2,flag,mode,cb){var this$1=this;var mustBeFile=function(e,stats){if(e){switch(flag.pathNotExistsAction()){case ActionType.CREATE_FILE:return this$1.stat(path.dirname(p2),false,function(e2,parentStats){if(e2){cb(e2)}else if(parentStats&&!parentStats.isDirectory()){cb(ApiError.ENOTDIR(path.dirname(p2)))}else{this$1.createFile(p2,flag,mode,cb)}});case ActionType.THROW_EXCEPTION:return cb(ApiError.ENOENT(p2));default:return cb(new ApiError(ErrorCode.EINVAL,"Invalid FileFlag object."))}}else{if(stats&&stats.isDirectory()){return cb(ApiError.EISDIR(p2))}switch(flag.pathExistsAction()){case ActionType.THROW_EXCEPTION:return cb(ApiError.EEXIST(p2));case ActionType.TRUNCATE_FILE:return this$1.openFile(p2,flag,function(e2,fd){if(e2){cb(e2)}else if(fd){fd.truncate(0,function(){fd.sync(function(){cb(null,fd)})})}else{fail()}});case ActionType.NOP:return this$1.openFile(p2,flag,cb);default:return cb(new ApiError(ErrorCode.EINVAL,"Invalid FileFlag object."))}}};this.stat(p2,false,mustBeFile)};BaseFileSystem.prototype.rename=function rename(oldPath,newPath,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.renameSync=function renameSync(oldPath,newPath){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.stat=function stat(p2,isLstat,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.statSync=function statSync(p2,isLstat){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.openFileSync=function openFileSync(p2,flag,mode){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.createFileSync=function createFileSync(p2,flag,mode){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.openSync=function openSync(p2,flag,mode){var stats;try{stats=this.statSync(p2,false)}catch(e){switch(flag.pathNotExistsAction()){case ActionType.CREATE_FILE:var parentStats=this.statSync(path.dirname(p2),false);if(!parentStats.isDirectory()){throw ApiError.ENOTDIR(path.dirname(p2))}return this.createFileSync(p2,flag,mode);case ActionType.THROW_EXCEPTION:throw ApiError.ENOENT(p2);default:throw new ApiError(ErrorCode.EINVAL,"Invalid FileFlag object.")}}if(stats.isDirectory()){throw ApiError.EISDIR(p2)}switch(flag.pathExistsAction()){case ActionType.THROW_EXCEPTION:throw ApiError.EEXIST(p2);case ActionType.TRUNCATE_FILE:this.unlinkSync(p2);return this.createFileSync(p2,flag,stats.mode);case ActionType.NOP:return this.openFileSync(p2,flag,mode);default:throw new ApiError(ErrorCode.EINVAL,"Invalid FileFlag object.")}};BaseFileSystem.prototype.unlink=function unlink(p2,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.unlinkSync=function unlinkSync(p2){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.rmdir=function rmdir(p2,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.rmdirSync=function rmdirSync(p2){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.mkdir=function mkdir(p2,mode,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.mkdirSync=function mkdirSync(p2,mode){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.readdir=function readdir(p2,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.readdirSync=function readdirSync(p2){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.exists=function exists2(p2,cb){this.stat(p2,null,function(err){cb(!err)})};BaseFileSystem.prototype.existsSync=function existsSync(p2){try{this.statSync(p2,true);return true}catch(e){return false}};BaseFileSystem.prototype.realpath=function realpath(p2,cache,cb){if(this.supportsLinks()){var splitPath=p2.split(path.sep);for(var i22=0;i22<splitPath.length;i22++){var addPaths=splitPath.slice(0,i22+1);splitPath[i22]=path.join.apply(null,addPaths)}}else{this.exists(p2,function(doesExist){if(doesExist){cb(null,p2)}else{cb(ApiError.ENOENT(p2))}})}};BaseFileSystem.prototype.realpathSync=function realpathSync(p2,cache){if(this.supportsLinks()){var splitPath=p2.split(path.sep);for(var i22=0;i22<splitPath.length;i22++){var addPaths=splitPath.slice(0,i22+1);splitPath[i22]=path.join.apply(path,addPaths)}return splitPath.join(path.sep)}else{if(this.existsSync(p2)){return p2}else{throw ApiError.ENOENT(p2)}}};BaseFileSystem.prototype.truncate=function truncate(p2,len,cb){this.open(p2,FileFlag.getFileFlag("r+"),420,function(er,fd){if(er){return cb(er)}fd.truncate(len,function(er2){fd.close(function(er22){cb(er2||er22)})})})};BaseFileSystem.prototype.truncateSync=function truncateSync(p2,len){var fd=this.openSync(p2,FileFlag.getFileFlag("r+"),420);try{fd.truncateSync(len)}catch(e){throw e}finally{fd.closeSync()}};BaseFileSystem.prototype.readFile=function readFile2(fname,encoding,flag,cb){var oldCb=cb;this.open(fname,flag,420,function(err,fd){if(err){return cb(err)}cb=function(err2,arg){fd.close(function(err22){if(!err2){err2=err22}return oldCb(err2,arg)})};fd.stat(function(err2,stat){if(err2){return cb(err2)}var buf=Buffer2.alloc(stat.size);fd.read(buf,0,stat.size,0,function(err3){if(err3){return cb(err3)}else if(encoding===null){return cb(err3,buf)}try{cb(null,buf.toString(encoding))}catch(e){cb(e)}})})})};BaseFileSystem.prototype.readFileSync=function readFileSync(fname,encoding,flag){var fd=this.openSync(fname,flag,420);try{var stat=fd.statSync();var buf=Buffer2.alloc(stat.size);fd.readSync(buf,0,stat.size,0);fd.closeSync();if(encoding===null){return buf}return buf.toString(encoding)}finally{fd.closeSync()}};BaseFileSystem.prototype.writeFile=function writeFile2(fname,data,encoding,flag,mode,cb){var oldCb=cb;this.open(fname,flag,420,function(err,fd){if(err){return cb(err)}cb=function(err2){fd.close(function(err22){oldCb(err2?err2:err22)})};try{if(typeof data==="string"){data=Buffer2.from(data,encoding)}}catch(e){return cb(e)}fd.write(data,0,data.length,0,cb)})};BaseFileSystem.prototype.writeFileSync=function writeFileSync(fname,data,encoding,flag,mode){var fd=this.openSync(fname,flag,mode);try{if(typeof data==="string"){data=Buffer2.from(data,encoding)}fd.writeSync(data,0,data.length,0)}finally{fd.closeSync()}};BaseFileSystem.prototype.appendFile=function appendFile3(fname,data,encoding,flag,mode,cb){var oldCb=cb;this.open(fname,flag,mode,function(err,fd){if(err){return cb(err)}cb=function(err2){fd.close(function(err22){oldCb(err2?err2:err22)})};if(typeof data==="string"){data=Buffer2.from(data,encoding)}fd.write(data,0,data.length,null,cb)})};BaseFileSystem.prototype.appendFileSync=function appendFileSync(fname,data,encoding,flag,mode){var fd=this.openSync(fname,flag,mode);try{if(typeof data==="string"){data=Buffer2.from(data,encoding)}fd.writeSync(data,0,data.length,null)}finally{fd.closeSync()}};BaseFileSystem.prototype.chmod=function chmod(p2,isLchmod,mode,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.chmodSync=function chmodSync(p2,isLchmod,mode){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.chown=function chown(p2,isLchown,uid,gid,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.chownSync=function chownSync(p2,isLchown,uid,gid){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.utimes=function utimes(p2,atime,mtime,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.utimesSync=function utimesSync(p2,atime,mtime){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.link=function link(srcpath,dstpath,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.linkSync=function linkSync(srcpath,dstpath){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.symlink=function symlink(srcpath,dstpath,type,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.symlinkSync=function symlinkSync(srcpath,dstpath,type){throw new ApiError(ErrorCode.ENOTSUP)};BaseFileSystem.prototype.readlink=function readlink(p2,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFileSystem.prototype.readlinkSync=function readlinkSync(p2){throw new ApiError(ErrorCode.ENOTSUP)};var SynchronousFileSystem=function(BaseFileSystem2){function SynchronousFileSystem2(){BaseFileSystem2.apply(this,arguments)}if(BaseFileSystem2)SynchronousFileSystem2.__proto__=BaseFileSystem2;SynchronousFileSystem2.prototype=Object.create(BaseFileSystem2&&BaseFileSystem2.prototype);SynchronousFileSystem2.prototype.constructor=SynchronousFileSystem2;SynchronousFileSystem2.prototype.supportsSynch=function supportsSynch(){return true};SynchronousFileSystem2.prototype.rename=function rename(oldPath,newPath,cb){try{this.renameSync(oldPath,newPath);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.stat=function stat(p2,isLstat,cb){try{cb(null,this.statSync(p2,isLstat))}catch(e){cb(e)}};SynchronousFileSystem2.prototype.open=function open(p2,flags,mode,cb){try{cb(null,this.openSync(p2,flags,mode))}catch(e){cb(e)}};SynchronousFileSystem2.prototype.unlink=function unlink(p2,cb){try{this.unlinkSync(p2);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.rmdir=function rmdir(p2,cb){try{this.rmdirSync(p2);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.mkdir=function mkdir(p2,mode,cb){try{this.mkdirSync(p2,mode);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.readdir=function readdir(p2,cb){try{cb(null,this.readdirSync(p2))}catch(e){cb(e)}};SynchronousFileSystem2.prototype.chmod=function chmod(p2,isLchmod,mode,cb){try{this.chmodSync(p2,isLchmod,mode);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.chown=function chown(p2,isLchown,uid,gid,cb){try{this.chownSync(p2,isLchown,uid,gid);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.utimes=function utimes(p2,atime,mtime,cb){try{this.utimesSync(p2,atime,mtime);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.link=function link(srcpath,dstpath,cb){try{this.linkSync(srcpath,dstpath);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.symlink=function symlink(srcpath,dstpath,type,cb){try{this.symlinkSync(srcpath,dstpath,type);cb()}catch(e){cb(e)}};SynchronousFileSystem2.prototype.readlink=function readlink(p2,cb){try{cb(null,this.readlinkSync(p2))}catch(e){cb(e)}};return SynchronousFileSystem2}(BaseFileSystem);var BaseFile=function BaseFile2(){};BaseFile.prototype.sync=function sync(cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFile.prototype.syncSync=function syncSync(){throw new ApiError(ErrorCode.ENOTSUP)};BaseFile.prototype.datasync=function datasync(cb){this.sync(cb)};BaseFile.prototype.datasyncSync=function datasyncSync(){return this.syncSync()};BaseFile.prototype.chown=function chown(uid,gid,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFile.prototype.chownSync=function chownSync(uid,gid){throw new ApiError(ErrorCode.ENOTSUP)};BaseFile.prototype.chmod=function chmod(mode,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFile.prototype.chmodSync=function chmodSync(mode){throw new ApiError(ErrorCode.ENOTSUP)};BaseFile.prototype.utimes=function utimes(atime,mtime,cb){cb(new ApiError(ErrorCode.ENOTSUP))};BaseFile.prototype.utimesSync=function utimesSync(atime,mtime){throw new ApiError(ErrorCode.ENOTSUP)};var PreloadFile=function(BaseFile$$1){function PreloadFile2(_fs,_path,_flag,_stat,contents){BaseFile$$1.call(this);this._pos=0;this._dirty=false;this._fs=_fs;this._path=_path;this._flag=_flag;this._stat=_stat;if(contents){this._buffer=contents}else{this._buffer=emptyBuffer()}if(this._stat.size!==this._buffer.length&&this._flag.isReadable()){throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}}if(BaseFile$$1)PreloadFile2.__proto__=BaseFile$$1;PreloadFile2.prototype=Object.create(BaseFile$$1&&BaseFile$$1.prototype);PreloadFile2.prototype.constructor=PreloadFile2;PreloadFile2.prototype.getBuffer=function getBuffer(){return this._buffer};PreloadFile2.prototype.getStats=function getStats(){return this._stat};PreloadFile2.prototype.getFlag=function getFlag2(){return this._flag};PreloadFile2.prototype.getPath=function getPath(){return this._path};PreloadFile2.prototype.getPos=function getPos(){if(this._flag.isAppendable()){return this._stat.size}return this._pos};PreloadFile2.prototype.advancePos=function advancePos(delta){return this._pos+=delta};PreloadFile2.prototype.setPos=function setPos(newPos){return this._pos=newPos};PreloadFile2.prototype.sync=function sync(cb){try{this.syncSync();cb()}catch(e){cb(e)}};PreloadFile2.prototype.syncSync=function syncSync(){throw new ApiError(ErrorCode.ENOTSUP)};PreloadFile2.prototype.close=function close(cb){try{this.closeSync();cb()}catch(e){cb(e)}};PreloadFile2.prototype.closeSync=function closeSync(){throw new ApiError(ErrorCode.ENOTSUP)};PreloadFile2.prototype.stat=function stat(cb){try{cb(null,this._stat.clone())}catch(e){cb(e)}};PreloadFile2.prototype.statSync=function statSync(){return this._stat.clone()};PreloadFile2.prototype.truncate=function truncate(len,cb){try{this.truncateSync(len);if(this._flag.isSynchronous()&&!_fsMock.getRootFS().supportsSynch()){this.sync(cb)}cb()}catch(e){return cb(e)}};PreloadFile2.prototype.truncateSync=function truncateSync(len){this._dirty=true;if(!this._flag.isWriteable()){throw new ApiError(ErrorCode.EPERM,"File not opened with a writeable mode.")}this._stat.mtime=new Date;if(len>this._buffer.length){var buf=Buffer2.alloc(len-this._buffer.length,0);this.writeSync(buf,0,buf.length,this._buffer.length);if(this._flag.isSynchronous()&&_fsMock.getRootFS().supportsSynch()){this.syncSync()}return}this._stat.size=len;var newBuff=Buffer2.alloc(len);this._buffer.copy(newBuff,0,0,len);this._buffer=newBuff;if(this._flag.isSynchronous()&&_fsMock.getRootFS().supportsSynch()){this.syncSync()}};PreloadFile2.prototype.write=function write(buffer$$1,offset,length,position,cb){try{cb(null,this.writeSync(buffer$$1,offset,length,position),buffer$$1)}catch(e){cb(e)}};PreloadFile2.prototype.writeSync=function writeSync(buffer$$1,offset,length,position){this._dirty=true;if(position===void 0||position===null){position=this.getPos()}if(!this._flag.isWriteable()){throw new ApiError(ErrorCode.EPERM,"File not opened with a writeable mode.")}var endFp=position+length;if(endFp>this._stat.size){this._stat.size=endFp;if(endFp>this._buffer.length){var newBuff=Buffer2.alloc(endFp);this._buffer.copy(newBuff);this._buffer=newBuff}}var len=buffer$$1.copy(this._buffer,position,offset,offset+length);this._stat.mtime=new Date;if(this._flag.isSynchronous()){this.syncSync();return len}this.setPos(position+len);return len};PreloadFile2.prototype.read=function read(buffer$$1,offset,length,position,cb){try{cb(null,this.readSync(buffer$$1,offset,length,position),buffer$$1)}catch(e){cb(e)}};PreloadFile2.prototype.readSync=function readSync(buffer$$1,offset,length,position){if(!this._flag.isReadable()){throw new ApiError(ErrorCode.EPERM,"File not opened with a readable mode.")}if(position===void 0||position===null){position=this.getPos()}var endRead=position+length;if(endRead>this._stat.size){length=this._stat.size-position}var rv=this._buffer.copy(buffer$$1,offset,position,position+length);this._stat.atime=new Date;this._pos=position+length;return rv};PreloadFile2.prototype.chmod=function chmod(mode,cb){try{this.chmodSync(mode);cb()}catch(e){cb(e)}};PreloadFile2.prototype.chmodSync=function chmodSync(mode){if(!this._fs.supportsProps()){throw new ApiError(ErrorCode.ENOTSUP)}this._dirty=true;this._stat.chmod(mode);this.syncSync()};PreloadFile2.prototype.isDirty=function isDirty(){return this._dirty};PreloadFile2.prototype.resetDirty=function resetDirty(){this._dirty=false};return PreloadFile2}(BaseFile);var NoSyncFile=function(PreloadFile2){function NoSyncFile2(_fs,_path,_flag,_stat,contents){PreloadFile2.call(this,_fs,_path,_flag,_stat,contents)}if(PreloadFile2)NoSyncFile2.__proto__=PreloadFile2;NoSyncFile2.prototype=Object.create(PreloadFile2&&PreloadFile2.prototype);NoSyncFile2.prototype.constructor=NoSyncFile2;NoSyncFile2.prototype.sync=function sync(cb){cb()};NoSyncFile2.prototype.syncSync=function syncSync(){};NoSyncFile2.prototype.close=function close(cb){cb()};NoSyncFile2.prototype.closeSync=function closeSync(){};return NoSyncFile2}(PreloadFile);var MirrorFile=function(PreloadFile$$1){function MirrorFile2(fs4,path$$1,flag,stat,data){PreloadFile$$1.call(this,fs4,path$$1,flag,stat,data)}if(PreloadFile$$1)MirrorFile2.__proto__=PreloadFile$$1;MirrorFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);MirrorFile2.prototype.constructor=MirrorFile2;MirrorFile2.prototype.syncSync=function syncSync(){if(this.isDirty()){this._fs._syncSync(this);this.resetDirty()}};MirrorFile2.prototype.closeSync=function closeSync(){this.syncSync()};return MirrorFile2}(PreloadFile);var AsyncMirror=function(SynchronousFileSystem$$1){function AsyncMirror2(sync,async,deprecateMsg){if(deprecateMsg===void 0)deprecateMsg=true;SynchronousFileSystem$$1.call(this);this._queue=[];this._queueRunning=false;this._isInitialized=false;this._initializeCallbacks=[];this._sync=sync;this._async=async;if(!sync.supportsSynch()){throw new Error("The first argument to AsyncMirror needs to be a synchronous file system.")}deprecationMessage(deprecateMsg,AsyncMirror2.Name,{sync:"sync file system instance",async:"async file system instance"})}if(SynchronousFileSystem$$1)AsyncMirror2.__proto__=SynchronousFileSystem$$1;AsyncMirror2.prototype=Object.create(SynchronousFileSystem$$1&&SynchronousFileSystem$$1.prototype);AsyncMirror2.prototype.constructor=AsyncMirror2;AsyncMirror2.Create=function Create(opts,cb){try{var fs4=new AsyncMirror2(opts.sync,opts.async,false);fs4.initialize(function(e){if(e){cb(e)}else{cb(null,fs4)}},false)}catch(e){cb(e)}};AsyncMirror2.isAvailable=function isAvailable(){return true};AsyncMirror2.prototype.getName=function getName(){return AsyncMirror2.Name};AsyncMirror2.prototype._syncSync=function _syncSync(fd){this._sync.writeFileSync(fd.getPath(),fd.getBuffer(),null,FileFlag.getFileFlag("w"),fd.getStats().mode);this.enqueueOp({apiMethod:"writeFile",arguments:[fd.getPath(),fd.getBuffer(),null,fd.getFlag(),fd.getStats().mode]})};AsyncMirror2.prototype.initialize=function initialize3(userCb,deprecateMsg){var this$1=this;if(deprecateMsg===void 0)deprecateMsg=true;if(deprecateMsg){console.warn("[AsyncMirror] AsyncMirror.initialize() is deprecated and will be removed in the next major version. Please use \'AsyncMirror.Create({ sync: (sync file system instance), async: (async file system instance)}, cb)\' to create and initialize AsyncMirror instances.")}var callbacks=this._initializeCallbacks;var end=function(e){this$1._isInitialized=!e;this$1._initializeCallbacks=[];callbacks.forEach(function(cb){return cb(e)})};if(!this._isInitialized){if(callbacks.push(userCb)===1){var copyDirectory=function(p2,mode,cb){if(p2!=="/"){this$1._sync.mkdirSync(p2,mode)}this$1._async.readdir(p2,function(err,files){var i22=0;function copyNextFile(err2){if(err2){cb(err2)}else if(i22<files.length){copyItem(path.join(p2,files[i22]),copyNextFile);i22++}else{cb()}}if(err){cb(err)}else{copyNextFile()}})},copyFile=function(p2,mode,cb){this$1._async.readFile(p2,null,FileFlag.getFileFlag("r"),function(err,data){if(err){cb(err)}else{try{this$1._sync.writeFileSync(p2,data,null,FileFlag.getFileFlag("w"),mode)}catch(e){err=e}finally{cb(err)}}})},copyItem=function(p2,cb){this$1._async.stat(p2,false,function(err,stats){if(err){cb(err)}else if(stats.isDirectory()){copyDirectory(p2,stats.mode,cb)}else{copyFile(p2,stats.mode,cb)}})};copyDirectory("/",0,end)}}else{userCb()}};AsyncMirror2.prototype.isReadOnly=function isReadOnly(){return false};AsyncMirror2.prototype.supportsSynch=function supportsSynch(){return true};AsyncMirror2.prototype.supportsLinks=function supportsLinks(){return false};AsyncMirror2.prototype.supportsProps=function supportsProps(){return this._sync.supportsProps()&&this._async.supportsProps()};AsyncMirror2.prototype.renameSync=function renameSync(oldPath,newPath){this.checkInitialized();this._sync.renameSync(oldPath,newPath);this.enqueueOp({apiMethod:"rename",arguments:[oldPath,newPath]})};AsyncMirror2.prototype.statSync=function statSync(p2,isLstat){this.checkInitialized();return this._sync.statSync(p2,isLstat)};AsyncMirror2.prototype.openSync=function openSync(p2,flag,mode){this.checkInitialized();var fd=this._sync.openSync(p2,flag,mode);fd.closeSync();return new MirrorFile(this,p2,flag,this._sync.statSync(p2,false),this._sync.readFileSync(p2,null,FileFlag.getFileFlag("r")))};AsyncMirror2.prototype.unlinkSync=function unlinkSync(p2){this.checkInitialized();this._sync.unlinkSync(p2);this.enqueueOp({apiMethod:"unlink",arguments:[p2]})};AsyncMirror2.prototype.rmdirSync=function rmdirSync(p2){this.checkInitialized();this._sync.rmdirSync(p2);this.enqueueOp({apiMethod:"rmdir",arguments:[p2]})};AsyncMirror2.prototype.mkdirSync=function mkdirSync(p2,mode){this.checkInitialized();this._sync.mkdirSync(p2,mode);this.enqueueOp({apiMethod:"mkdir",arguments:[p2,mode]})};AsyncMirror2.prototype.readdirSync=function readdirSync(p2){this.checkInitialized();return this._sync.readdirSync(p2)};AsyncMirror2.prototype.existsSync=function existsSync(p2){this.checkInitialized();return this._sync.existsSync(p2)};AsyncMirror2.prototype.chmodSync=function chmodSync(p2,isLchmod,mode){this.checkInitialized();this._sync.chmodSync(p2,isLchmod,mode);this.enqueueOp({apiMethod:"chmod",arguments:[p2,isLchmod,mode]})};AsyncMirror2.prototype.chownSync=function chownSync(p2,isLchown,uid,gid){this.checkInitialized();this._sync.chownSync(p2,isLchown,uid,gid);this.enqueueOp({apiMethod:"chown",arguments:[p2,isLchown,uid,gid]})};AsyncMirror2.prototype.utimesSync=function utimesSync(p2,atime,mtime){this.checkInitialized();this._sync.utimesSync(p2,atime,mtime);this.enqueueOp({apiMethod:"utimes",arguments:[p2,atime,mtime]})};AsyncMirror2.prototype.checkInitialized=function checkInitialized(){if(!this._isInitialized){throw new ApiError(ErrorCode.EPERM,"AsyncMirrorFS is not initialized. Please initialize AsyncMirrorFS using its initialize() method before using it.")}};AsyncMirror2.prototype.enqueueOp=function enqueueOp(op){var this$1=this;this._queue.push(op);if(!this._queueRunning){this._queueRunning=true;var doNextOp=function(err){if(err){console.error("WARNING: File system has desynchronized. Received following error: "+err+"\\n$")}if(this$1._queue.length>0){var op2=this$1._queue.shift(),args=op2.arguments;args.push(doNextOp);this$1._async[op2.apiMethod].apply(this$1._async,args)}else{this$1._queueRunning=false}};doNextOp()}};return AsyncMirror2}(SynchronousFileSystem);AsyncMirror.Name="AsyncMirror";AsyncMirror.Options={sync:{type:"object",description:"The synchronous file system to mirror the asynchronous file system to."},async:{type:"object",description:"The asynchronous file system to mirror."}};function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}var nativeMax=Math.max;function overRest$1(func,start,transform){start=nativeMax(start===void 0?func.length-1:start,0);return function(){var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);while(++index<length){array[index]=args[start+index]}index=-1;var otherArgs=Array(start+1);while(++index<start){otherArgs[index]=args[index]}otherArgs[start]=transform(array);return apply(func,this,otherArgs)}}function identity(value){return value}function rest(func,start){return overRest$1(func,start,identity)}var initialParams=function(fn){return rest(function(args){var callback=args.pop();fn.call(this,args,callback)})};function applyEach$1(eachfn){return rest(function(fns,args){var go=initialParams(function(args2,callback){var that=this;return eachfn(fns,function(fn,cb){fn.apply(that,args2.concat(cb))},callback)});if(args.length){return go.apply(this,args)}else{return go}})}var freeGlobal=typeof global2=="object"&&global2&&global2.Object===Object&&global2;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self;var root=freeGlobal||freeSelf||Function("return this")();var Symbol$1=root.Symbol;var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;var nativeObjectToString=objectProto.toString;var symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(value){var isOwn=hasOwnProperty.call(value,symToStringTag$1),tag=value[symToStringTag$1];try{value[symToStringTag$1]=void 0;var unmasked=true}catch(e){}var result=nativeObjectToString.call(value);if(unmasked){if(isOwn){value[symToStringTag$1]=tag}else{delete value[symToStringTag$1]}}return result}var objectProto$1=Object.prototype;var nativeObjectToString$1=objectProto$1.toString;function objectToString(value){return nativeObjectToString$1.call(value)}var nullTag="[object Null]";var undefinedTag="[object Undefined]";var symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(value){if(value==null){return value===void 0?undefinedTag:nullTag}return symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}function isObject(value){var type=typeof value;return value!=null&&(type=="object"||type=="function")}var asyncTag="[object AsyncFunction]";var funcTag="[object Function]";var genTag="[object GeneratorFunction]";var proxyTag="[object Proxy]";function isFunction3(value){if(!isObject(value)){return false}var tag=baseGetTag(value);return tag==funcTag||tag==genTag||tag==asyncTag||tag==proxyTag}var MAX_SAFE_INTEGER=9007199254740991;function isLength(value){return typeof value=="number"&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isArrayLike(value){return value!=null&&isLength(value.length)&&!isFunction3(value)}var breakLoop={};function noop3(){}function once(fn){return function(){if(fn===null){return}var callFn=fn;fn=null;callFn.apply(this,arguments)}}var iteratorSymbol=typeof Symbol==="function"&&Symbol.iterator;var getIterator=function(coll){return iteratorSymbol&&coll[iteratorSymbol]&&coll[iteratorSymbol]()};function baseTimes(n,iteratee){var index=-1,result=Array(n);while(++index<n){result[index]=iteratee(index)}return result}function isObjectLike(value){return value!=null&&typeof value=="object"}var argsTag="[object Arguments]";function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag}var objectProto$3=Object.prototype;var hasOwnProperty$2=objectProto$3.hasOwnProperty;var propertyIsEnumerable=objectProto$3.propertyIsEnumerable;var isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty$2.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")};var isArray=Array.isArray;function stubFalse(){return false}var freeExports=typeof exports2=="object"&&exports2&&!exports2.nodeType&&exports2;var freeModule=freeExports&&typeof module3=="object"&&module3&&!module3.nodeType&&module3;var moduleExports=freeModule&&freeModule.exports===freeExports;var Buffer$1=moduleExports?root.Buffer:void 0;var nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0;var isBuffer=nativeIsBuffer||stubFalse;var MAX_SAFE_INTEGER$1=9007199254740991;var reIsUint=/^(?:0|[1-9]\\d*)$/;function isIndex(value,length){length=length==null?MAX_SAFE_INTEGER$1:length;return!!length&&(typeof value=="number"||reIsUint.test(value))&&(value>-1&&value%1==0&&value<length)}var argsTag$1="[object Arguments]";var arrayTag="[object Array]";var boolTag="[object Boolean]";var dateTag="[object Date]";var errorTag="[object Error]";var funcTag$1="[object Function]";var mapTag="[object Map]";var numberTag="[object Number]";var objectTag="[object Object]";var regexpTag="[object RegExp]";var setTag="[object Set]";var stringTag="[object String]";var weakMapTag="[object WeakMap]";var arrayBufferTag="[object ArrayBuffer]";var dataViewTag="[object DataView]";var float32Tag="[object Float32Array]";var float64Tag="[object Float64Array]";var int8Tag="[object Int8Array]";var int16Tag="[object Int16Array]";var int32Tag="[object Int32Array]";var uint8Tag="[object Uint8Array]";var uint8ClampedTag="[object Uint8ClampedArray]";var uint16Tag="[object Uint16Array]";var uint32Tag="[object Uint32Array]";var typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=true;typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=false;function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}function baseUnary(func){return function(value){return func(value)}}var freeExports$1=typeof exports2=="object"&&exports2&&!exports2.nodeType&&exports2;var freeModule$1=freeExports$1&&typeof module3=="object"&&module3&&!module3.nodeType&&module3;var moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1;var freeProcess=moduleExports$1&&freeGlobal.process;var nodeUtil=function(){try{return freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();var nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray;var isTypedArray3=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;var objectProto$2=Object.prototype;var hasOwnProperty$1=objectProto$2.hasOwnProperty;function arrayLikeKeys(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray3(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value){if((inherited||hasOwnProperty$1.call(value,key))&&!(skipIndexes&&(key=="length"||isBuff&&(key=="offset"||key=="parent")||isType&&(key=="buffer"||key=="byteLength"||key=="byteOffset")||isIndex(key,length)))){result.push(key)}}return result}var objectProto$5=Object.prototype;function isPrototype(value){var Ctor=value&&value.constructor,proto=typeof Ctor=="function"&&Ctor.prototype||objectProto$5;return value===proto}function overArg(func,transform){return function(arg){return func(transform(arg))}}var nativeKeys=overArg(Object.keys,Object);var objectProto$4=Object.prototype;var hasOwnProperty$3=objectProto$4.hasOwnProperty;function baseKeys(object){if(!isPrototype(object)){return nativeKeys(object)}var result=[];for(var key in Object(object)){if(hasOwnProperty$3.call(object,key)&&key!="constructor"){result.push(key)}}return result}function keys3(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function createArrayIterator(coll){var i22=-1;var len=coll.length;return function next(){return++i22<len?{value:coll[i22],key:i22}:null}}function createES2015Iterator(iterator2){var i22=-1;return function next(){var item=iterator2.next();if(item.done){return null}i22++;return{value:item.value,key:i22}}}function createObjectIterator(obj){var okeys=keys3(obj);var i22=-1;var len=okeys.length;return function next(){var key=okeys[++i22];return i22<len?{value:obj[key],key}:null}}function iterator(coll){if(isArrayLike(coll)){return createArrayIterator(coll)}var iterator2=getIterator(coll);return iterator2?createES2015Iterator(iterator2):createObjectIterator(coll)}function onlyOnce(fn){return function(){if(fn===null){throw new Error("Callback was already called.")}var callFn=fn;fn=null;callFn.apply(this,arguments)}}function _eachOfLimit(limit){return function(obj,iteratee,callback){callback=once(callback||noop3);if(limit<=0||!obj){return callback(null)}var nextElem=iterator(obj);var done=false;var running=0;function iterateeCallback(err,value){running-=1;if(err){done=true;callback(err)}else if(value===breakLoop||done&&running<=0){done=true;return callback(null)}else{replenish()}}function replenish(){while(running<limit&&!done){var elem=nextElem();if(elem===null){done=true;if(running<=0){callback(null)}return}running+=1;iteratee(elem.value,elem.key,onlyOnce(iterateeCallback))}}replenish()}}function eachOfLimit(coll,limit,iteratee,callback){_eachOfLimit(limit)(coll,iteratee,callback)}function doLimit(fn,limit){return function(iterable,iteratee,callback){return fn(iterable,limit,iteratee,callback)}}function eachOfArrayLike(coll,iteratee,callback){callback=once(callback||noop3);var index=0,completed=0,length=coll.length;if(length===0){callback(null)}function iteratorCallback(err,value){if(err){callback(err)}else if(++completed===length||value===breakLoop){callback(null)}}for(;index<length;index++){iteratee(coll[index],index,onlyOnce(iteratorCallback))}}var eachOfGeneric=doLimit(eachOfLimit,Infinity);var eachOf=function(coll,iteratee,callback){var eachOfImplementation=isArrayLike(coll)?eachOfArrayLike:eachOfGeneric;eachOfImplementation(coll,iteratee,callback)};function doParallel(fn){return function(obj,iteratee,callback){return fn(eachOf,obj,iteratee,callback)}}function _asyncMap(eachfn,arr,iteratee,callback){callback=callback||noop3;arr=arr||[];var results=[];var counter=0;eachfn(arr,function(value,_,callback2){var index=counter++;iteratee(value,function(err,v2){results[index]=v2;callback2(err)})},function(err){callback(err,results)})}var map=doParallel(_asyncMap);applyEach$1(map);function doParallelLimit(fn){return function(obj,limit,iteratee,callback){return fn(_eachOfLimit(limit),obj,iteratee,callback)}}var mapLimit=doParallelLimit(_asyncMap);var mapSeries=doLimit(mapLimit,1);applyEach$1(mapSeries);rest(function(fn,args){return rest(function(callArgs){return fn.apply(null,args.concat(callArgs))})});function arrayEach(array,iteratee){var index=-1,length=array==null?0:array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break}}return array}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;while(length--){var key=props[fromRight?length:++index];if(iteratee(iterable[key],key,iterable)===false){break}}return object}}var baseFor=createBaseFor();function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys3)}function baseFindIndex(array,predicate,fromIndex,fromRight){var length=array.length,index=fromIndex+(fromRight?1:-1);while(fromRight?index--:++index<length){if(predicate(array[index],index,array)){return index}}return-1}function baseIsNaN(value){return value!==value}function strictIndexOf(array,value,fromIndex){var index=fromIndex-1,length=array.length;while(++index<length){if(array[index]===value){return index}}return-1}function baseIndexOf(array,value,fromIndex){return value===value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}var rsAstralRange$1="\\\\ud800-\\\\udfff";var rsComboMarksRange$1="\\\\u0300-\\\\u036f";var reComboHalfMarksRange$1="\\\\ufe20-\\\\ufe2f";var rsComboSymbolsRange$1="\\\\u20d0-\\\\u20ff";var rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1;var rsVarRange$1="\\\\ufe0e\\\\ufe0f";var rsAstral="["+rsAstralRange$1+"]";var rsCombo="["+rsComboRange$1+"]";var rsFitz="\\\\ud83c[\\\\udffb-\\\\udfff]";var rsModifier="(?:"+rsCombo+"|"+rsFitz+")";var rsNonAstral="[^"+rsAstralRange$1+"]";var rsRegional="(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}";var rsSurrPair="[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]";var rsZWJ$1="\\\\u200d";var reOptMod=rsModifier+"?";var rsOptVar="["+rsVarRange$1+"]?";var rsOptJoin="(?:"+rsZWJ$1+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*";var rsSeq=rsOptVar+reOptMod+rsOptJoin;var rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")";var hasSetImmediate=typeof setImmediate==="function"&&setImmediate;var hasNextTick=typeof process==="object"&&typeof process.nextTick==="function";function fallback(fn){setTimeout(fn,0)}function wrap(defer){return rest(function(fn,args){defer(function(){fn.apply(null,args)})})}var _defer;if(hasSetImmediate){_defer=setImmediate}else if(hasNextTick){_defer=process.nextTick}else{_defer=fallback}wrap(_defer);var eachOfSeries=doLimit(eachOfLimit,1);function reduce(coll,memo,iteratee,callback){callback=once(callback||noop3);eachOfSeries(coll,function(x3,i22,callback2){iteratee(memo,x3,function(err,v2){memo=v2;callback2(err)})},function(err){callback(err,memo)})}var seq=rest(function seq2(functions){return rest(function(args){var that=this;var cb=args[args.length-1];if(typeof cb=="function"){args.pop()}else{cb=noop3}reduce(functions,args,function(newargs,fn,cb2){fn.apply(that,newargs.concat(rest(function(err,nextargs){cb2(err,nextargs)})))},function(err,results){cb.apply(that,[err].concat(results))})})});rest(function(args){return seq.apply(null,args.reverse())});rest(function(values){var args=[null].concat(values);return initialParams(function(ignoredArgs,callback){return callback.apply(this,args)})});function consoleFunc(name2){return rest(function(fn,args){fn.apply(null,args.concat(rest(function(err,args2){if(typeof console==="object"){if(err){if(console.error){console.error(err)}}else if(console[name2]){arrayEach(args2,function(x3){console[name2](x3)})}}})))})}consoleFunc("dir");function _withoutIndex(iteratee){return function(value,index,callback){return iteratee(value,callback)}}function eachLimit(coll,iteratee,callback){eachOf(coll,_withoutIndex(iteratee),callback)}consoleFunc("log");var _defer$1;if(hasNextTick){_defer$1=process.nextTick}else if(hasSetImmediate){_defer$1=setImmediate}else{_defer$1=fallback}wrap(_defer$1);var nativeCeil=Math.ceil;var nativeMax$1=Math.max;var errorCodeLookup;function constructErrorCodeLookup(){if(errorCodeLookup){return}errorCodeLookup={};errorCodeLookup[Dropbox.ApiError.NETWORK_ERROR]=ErrorCode.EIO;errorCodeLookup[Dropbox.ApiError.INVALID_PARAM]=ErrorCode.EINVAL;errorCodeLookup[Dropbox.ApiError.INVALID_TOKEN]=ErrorCode.EPERM;errorCodeLookup[Dropbox.ApiError.OAUTH_ERROR]=ErrorCode.EPERM;errorCodeLookup[Dropbox.ApiError.NOT_FOUND]=ErrorCode.ENOENT;errorCodeLookup[Dropbox.ApiError.INVALID_METHOD]=ErrorCode.EINVAL;errorCodeLookup[Dropbox.ApiError.NOT_ACCEPTABLE]=ErrorCode.EINVAL;errorCodeLookup[Dropbox.ApiError.CONFLICT]=ErrorCode.EINVAL;errorCodeLookup[Dropbox.ApiError.RATE_LIMITED]=ErrorCode.EBUSY;errorCodeLookup[Dropbox.ApiError.SERVER_ERROR]=ErrorCode.EBUSY;errorCodeLookup[Dropbox.ApiError.OVER_QUOTA]=ErrorCode.ENOSPC}function isFileInfo(cache){return cache&&cache.stat.isFile}function isDirInfo(cache){return cache&&cache.stat.isFolder}function isArrayBuffer(ab){return ab===null||ab===void 0||typeof ab==="object"&&typeof ab["byteLength"]==="number"}var CachedDropboxClient=function CachedDropboxClient2(client){this._cache={};this._client=client};CachedDropboxClient.prototype.readdir=function readdir(p2,cb){var this$1=this;var cacheInfo=this.getCachedDirInfo(p2);this._wrap(function(interceptCb){if(cacheInfo!==null&&cacheInfo.contents){this$1._client.readdir(p2,{contentHash:cacheInfo.stat.contentHash},interceptCb)}else{this$1._client.readdir(p2,interceptCb)}},function(err,filenames,stat,folderEntries){if(err){if(err.status===Dropbox.ApiError.NO_CONTENT&&cacheInfo!==null){cb(null,cacheInfo.contents.slice(0))}else{cb(err)}}else{this$1.updateCachedDirInfo(p2,stat,filenames.slice(0));folderEntries.forEach(function(entry){this$1.updateCachedInfo(path.join(p2,entry.name),entry)});cb(null,filenames)}})};CachedDropboxClient.prototype.remove=function remove(p2,cb){var this$1=this;this._wrap(function(interceptCb){this$1._client.remove(p2,interceptCb)},function(err,stat){if(!err){this$1.updateCachedInfo(p2,stat)}cb(err)})};CachedDropboxClient.prototype.move=function move(src,dest,cb){var this$1=this;this._wrap(function(interceptCb){this$1._client.move(src,dest,interceptCb)},function(err,stat){if(!err){this$1.deleteCachedInfo(src);this$1.updateCachedInfo(dest,stat)}cb(err)})};CachedDropboxClient.prototype.stat=function stat(p2,cb){var this$1=this;this._wrap(function(interceptCb){this$1._client.stat(p2,interceptCb)},function(err,stat2){if(!err){this$1.updateCachedInfo(p2,stat2)}cb(err,stat2)})};CachedDropboxClient.prototype.readFile=function readFile2(p2,cb){var this$1=this;var cacheInfo=this.getCachedFileInfo(p2);if(cacheInfo!==null&&cacheInfo.contents!==null){this.stat(p2,function(error,stat){if(error){cb(error)}else if(stat.contentHash===cacheInfo.stat.contentHash){cb(error,cacheInfo.contents.slice(0),cacheInfo.stat)}else{this$1.readFile(p2,cb)}})}else{this._wrap(function(interceptCb){this$1._client.readFile(p2,{arrayBuffer:true},interceptCb)},function(err,contents,stat){if(!err){this$1.updateCachedInfo(p2,stat,contents.slice(0))}cb(err,contents,stat)})}};CachedDropboxClient.prototype.writeFile=function writeFile2(p2,contents,cb){var this$1=this;this._wrap(function(interceptCb){this$1._client.writeFile(p2,contents,interceptCb)},function(err,stat){if(!err){this$1.updateCachedInfo(p2,stat,contents.slice(0))}cb(err,stat)})};CachedDropboxClient.prototype.mkdir=function mkdir(p2,cb){var this$1=this;this._wrap(function(interceptCb){this$1._client.mkdir(p2,interceptCb)},function(err,stat){if(!err){this$1.updateCachedInfo(p2,stat,[])}cb(err)})};CachedDropboxClient.prototype._wrap=function _wrap(performOp,cb){var numRun=0;var interceptCb=function(error){var timeoutDuration=2;if(error&&3>++numRun){switch(error.status){case Dropbox.ApiError.SERVER_ERROR:case Dropbox.ApiError.NETWORK_ERROR:case Dropbox.ApiError.RATE_LIMITED:setTimeout(function(){performOp(interceptCb)},timeoutDuration*1e3);break;default:cb.apply(null,arguments);break}}else{cb.apply(null,arguments)}};performOp(interceptCb)};CachedDropboxClient.prototype.getCachedInfo=function getCachedInfo(p2){return this._cache[p2.toLowerCase()]};CachedDropboxClient.prototype.putCachedInfo=function putCachedInfo(p2,cache){this._cache[p2.toLowerCase()]=cache};CachedDropboxClient.prototype.deleteCachedInfo=function deleteCachedInfo(p2){delete this._cache[p2.toLowerCase()]};CachedDropboxClient.prototype.getCachedDirInfo=function getCachedDirInfo(p2){var info=this.getCachedInfo(p2);if(isDirInfo(info)){return info}else{return null}};CachedDropboxClient.prototype.getCachedFileInfo=function getCachedFileInfo(p2){var info=this.getCachedInfo(p2);if(isFileInfo(info)){return info}else{return null}};CachedDropboxClient.prototype.updateCachedDirInfo=function updateCachedDirInfo(p2,stat,contents){if(contents===void 0)contents=null;var cachedInfo=this.getCachedInfo(p2);if(stat.contentHash!==null&&(cachedInfo===void 0||cachedInfo.stat.contentHash!==stat.contentHash)){this.putCachedInfo(p2,{stat,contents})}};CachedDropboxClient.prototype.updateCachedFileInfo=function updateCachedFileInfo(p2,stat,contents){if(contents===void 0)contents=null;var cachedInfo=this.getCachedInfo(p2);if(stat.versionTag!==null&&(cachedInfo===void 0||cachedInfo.stat.versionTag!==stat.versionTag)){this.putCachedInfo(p2,{stat,contents})}};CachedDropboxClient.prototype.updateCachedInfo=function updateCachedInfo(p2,stat,contents){if(contents===void 0)contents=null;if(stat.isFile&&isArrayBuffer(contents)){this.updateCachedFileInfo(p2,stat,contents)}else if(stat.isFolder&&Array.isArray(contents)){this.updateCachedDirInfo(p2,stat,contents)}};var DropboxFile=function(PreloadFile$$1){function DropboxFile2(_fs,_path,_flag,_stat,contents){PreloadFile$$1.call(this,_fs,_path,_flag,_stat,contents)}if(PreloadFile$$1)DropboxFile2.__proto__=PreloadFile$$1;DropboxFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);DropboxFile2.prototype.constructor=DropboxFile2;DropboxFile2.prototype.sync=function sync(cb){var this$1=this;if(this.isDirty()){var buffer$$1=this.getBuffer(),arrayBuffer=buffer2ArrayBuffer(buffer$$1);this._fs._writeFileStrict(this.getPath(),arrayBuffer,function(e){if(!e){this$1.resetDirty()}cb(e)})}else{cb()}};DropboxFile2.prototype.close=function close(cb){this.sync(cb)};return DropboxFile2}(PreloadFile);var DropboxFileSystem=function(BaseFileSystem$$1){function DropboxFileSystem2(client,deprecateMsg){if(deprecateMsg===void 0)deprecateMsg=true;BaseFileSystem$$1.call(this);this._client=new CachedDropboxClient(client);deprecationMessage(deprecateMsg,DropboxFileSystem2.Name,{client:"authenticated dropbox client instance"});constructErrorCodeLookup()}if(BaseFileSystem$$1)DropboxFileSystem2.__proto__=BaseFileSystem$$1;DropboxFileSystem2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);DropboxFileSystem2.prototype.constructor=DropboxFileSystem2;DropboxFileSystem2.Create=function Create(opts,cb){cb(null,new DropboxFileSystem2(opts.client,false))};DropboxFileSystem2.isAvailable=function isAvailable(){return typeof Dropbox!=="undefined"};DropboxFileSystem2.prototype.getName=function getName(){return DropboxFileSystem2.Name};DropboxFileSystem2.prototype.isReadOnly=function isReadOnly(){return false};DropboxFileSystem2.prototype.supportsSymlinks=function supportsSymlinks(){return false};DropboxFileSystem2.prototype.supportsProps=function supportsProps(){return false};DropboxFileSystem2.prototype.supportsSynch=function supportsSynch(){return false};DropboxFileSystem2.prototype.empty=function empty(mainCb){var this$1=this;this._client.readdir("/",function(error,files){if(error){mainCb(this$1.convert(error,"/"))}else{var deleteFile2=function(file,cb){var p2=path.join("/",file);this$1._client.remove(p2,function(err){cb(err?this$1.convert(err,p2):null)})};var finished=function(err){if(err){mainCb(err)}else{mainCb()}};eachLimit(files,deleteFile2,finished)}})};DropboxFileSystem2.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;this._client.move(oldPath,newPath,function(error){if(error){this$1._client.stat(newPath,function(error2,stat){if(error2||stat.isFolder){var missingPath=error.response.error.indexOf(oldPath)>-1?oldPath:newPath;cb(this$1.convert(error,missingPath))}else{this$1._client.remove(newPath,function(error22){if(error22){cb(this$1.convert(error22,newPath))}else{this$1.rename(oldPath,newPath,cb)}})}})}else{cb()}})};DropboxFileSystem2.prototype.stat=function stat(path$$1,isLstat,cb){var this$1=this;this._client.stat(path$$1,function(error,stat2){if(error){cb(this$1.convert(error,path$$1))}else if(stat2&&stat2.isRemoved){cb(ApiError.FileError(ErrorCode.ENOENT,path$$1))}else{var stats=new Stats(this$1._statType(stat2),stat2.size);return cb(null,stats)}})};DropboxFileSystem2.prototype.open=function open(path$$1,flags,mode,cb){var this$1=this;this._client.readFile(path$$1,function(error,content,dbStat){if(error){if(flags.isReadable()){cb(this$1.convert(error,path$$1))}else{switch(error.status){case Dropbox.ApiError.NOT_FOUND:var ab=new ArrayBuffer(0);return this$1._writeFileStrict(path$$1,ab,function(error2,stat){if(error2){cb(error2)}else{var file2=this$1._makeFile(path$$1,flags,stat,arrayBuffer2Buffer(ab));cb(null,file2)}});default:return cb(this$1.convert(error,path$$1))}}}else{var buffer$$1;if(content===null){buffer$$1=emptyBuffer()}else{buffer$$1=arrayBuffer2Buffer(content)}var file=this$1._makeFile(path$$1,flags,dbStat,buffer$$1);return cb(null,file)}})};DropboxFileSystem2.prototype._writeFileStrict=function _writeFileStrict(p2,data,cb){var this$1=this;var parent=path.dirname(p2);this.stat(parent,false,function(error,stat){if(error){cb(ApiError.FileError(ErrorCode.ENOENT,parent))}else{this$1._client.writeFile(p2,data,function(error2,stat2){if(error2){cb(this$1.convert(error2,p2))}else{cb(null,stat2)}})}})};DropboxFileSystem2.prototype._statType=function _statType(stat){return stat.isFile?FileType.FILE:FileType.DIRECTORY};DropboxFileSystem2.prototype._makeFile=function _makeFile(path$$1,flag,stat,buffer$$1){var type=this._statType(stat);var stats=new Stats(type,stat.size);return new DropboxFile(this,path$$1,flag,stats,buffer$$1)};DropboxFileSystem2.prototype._remove=function _remove(path$$1,cb,isFile){var this$1=this;this._client.stat(path$$1,function(error,stat){if(error){cb(this$1.convert(error,path$$1))}else{if(stat.isFile&&!isFile){cb(ApiError.FileError(ErrorCode.ENOTDIR,path$$1))}else if(!stat.isFile&&isFile){cb(ApiError.FileError(ErrorCode.EISDIR,path$$1))}else{this$1._client.remove(path$$1,function(error2){if(error2){cb(this$1.convert(error2,path$$1))}else{cb(null)}})}}})};DropboxFileSystem2.prototype.unlink=function unlink(path$$1,cb){this._remove(path$$1,cb,true)};DropboxFileSystem2.prototype.rmdir=function rmdir(path$$1,cb){this._remove(path$$1,cb,false)};DropboxFileSystem2.prototype.mkdir=function mkdir(p2,mode,cb){var this$1=this;var parent=path.dirname(p2);this._client.stat(parent,function(error,stat){if(error){cb(this$1.convert(error,parent))}else{this$1._client.mkdir(p2,function(error2){if(error2){cb(ApiError.FileError(ErrorCode.EEXIST,p2))}else{cb(null)}})}})};DropboxFileSystem2.prototype.readdir=function readdir(path$$1,cb){var this$1=this;this._client.readdir(path$$1,function(error,files){if(error){return cb(this$1.convert(error))}else{return cb(null,files)}})};DropboxFileSystem2.prototype.convert=function convert(err,path$$1){if(path$$1===void 0)path$$1=null;var errorCode=errorCodeLookup[err.status];if(errorCode===void 0){errorCode=ErrorCode.EIO}if(!path$$1){return new ApiError(errorCode)}else{return ApiError.FileError(errorCode,path$$1)}};return DropboxFileSystem2}(BaseFileSystem);DropboxFileSystem.Name="Dropbox";DropboxFileSystem.Options={client:{type:"object",description:"An *authenticated* Dropbox client. Must be from the 0.10 JS SDK.",validator:function(opt,cb){if(opt.isAuthenticated&&opt.isAuthenticated()){cb()}else{cb(new ApiError(ErrorCode.EINVAL,"\'client\' option must be an authenticated Dropbox client from the v0.10 JS SDK."))}}}};function convertError(e,path$$1){if(path$$1===void 0)path$$1="";var errno=e.errno;var parent=e.node;var paths=[];while(parent){paths.unshift(parent.name);if(parent===parent.parent){break}parent=parent.parent}return new ApiError(errno,ErrorStrings[errno],paths.length>0?"/"+paths.join("/"):path$$1)}var EmscriptenFile=function(BaseFile$$1){function EmscriptenFile2(_fs,_FS,_path,_stream){BaseFile$$1.call(this);this._fs=_fs;this._FS=_FS;this._path=_path;this._stream=_stream}if(BaseFile$$1)EmscriptenFile2.__proto__=BaseFile$$1;EmscriptenFile2.prototype=Object.create(BaseFile$$1&&BaseFile$$1.prototype);EmscriptenFile2.prototype.constructor=EmscriptenFile2;EmscriptenFile2.prototype.getPos=function getPos(){return void 0};EmscriptenFile2.prototype.close=function close(cb){var err=null;try{this.closeSync()}catch(e){err=e}finally{cb(err)}};EmscriptenFile2.prototype.closeSync=function closeSync(){try{this._FS.close(this._stream)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.stat=function stat(cb){try{cb(null,this.statSync())}catch(e){cb(e)}};EmscriptenFile2.prototype.statSync=function statSync(){try{return this._fs.statSync(this._path,false)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.truncate=function truncate(len,cb){var err=null;try{this.truncateSync(len)}catch(e){err=e}finally{cb(err)}};EmscriptenFile2.prototype.truncateSync=function truncateSync(len){try{this._FS.ftruncate(this._stream.fd,len)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.write=function write(buffer$$1,offset,length,position,cb){try{cb(null,this.writeSync(buffer$$1,offset,length,position),buffer$$1)}catch(e){cb(e)}};EmscriptenFile2.prototype.writeSync=function writeSync(buffer$$1,offset,length,position){try{var u8=buffer2Uint8array(buffer$$1);var emPosition=position===null?void 0:position;return this._FS.write(this._stream,u8,offset,length,emPosition)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.read=function read(buffer$$1,offset,length,position,cb){try{cb(null,this.readSync(buffer$$1,offset,length,position),buffer$$1)}catch(e){cb(e)}};EmscriptenFile2.prototype.readSync=function readSync(buffer$$1,offset,length,position){try{var u8=buffer2Uint8array(buffer$$1);var emPosition=position===null?void 0:position;return this._FS.read(this._stream,u8,offset,length,emPosition)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.sync=function sync(cb){cb()};EmscriptenFile2.prototype.syncSync=function syncSync(){};EmscriptenFile2.prototype.chown=function chown(uid,gid,cb){var err=null;try{this.chownSync(uid,gid)}catch(e){err=e}finally{cb(err)}};EmscriptenFile2.prototype.chownSync=function chownSync(uid,gid){try{this._FS.fchown(this._stream.fd,uid,gid)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.chmod=function chmod(mode,cb){var err=null;try{this.chmodSync(mode)}catch(e){err=e}finally{cb(err)}};EmscriptenFile2.prototype.chmodSync=function chmodSync(mode){try{this._FS.fchmod(this._stream.fd,mode)}catch(e){throw convertError(e,this._path)}};EmscriptenFile2.prototype.utimes=function utimes(atime,mtime,cb){var err=null;try{this.utimesSync(atime,mtime)}catch(e){err=e}finally{cb(err)}};EmscriptenFile2.prototype.utimesSync=function utimesSync(atime,mtime){this._fs.utimesSync(this._path,atime,mtime)};return EmscriptenFile2}(BaseFile);var EmscriptenFileSystem=function(SynchronousFileSystem$$1){function EmscriptenFileSystem2(_FS){SynchronousFileSystem$$1.call(this);this._FS=_FS}if(SynchronousFileSystem$$1)EmscriptenFileSystem2.__proto__=SynchronousFileSystem$$1;EmscriptenFileSystem2.prototype=Object.create(SynchronousFileSystem$$1&&SynchronousFileSystem$$1.prototype);EmscriptenFileSystem2.prototype.constructor=EmscriptenFileSystem2;EmscriptenFileSystem2.Create=function Create(opts,cb){cb(null,new EmscriptenFileSystem2(opts.FS))};EmscriptenFileSystem2.isAvailable=function isAvailable(){return true};EmscriptenFileSystem2.prototype.getName=function getName(){return this._FS.DB_NAME()};EmscriptenFileSystem2.prototype.isReadOnly=function isReadOnly(){return false};EmscriptenFileSystem2.prototype.supportsLinks=function supportsLinks(){return true};EmscriptenFileSystem2.prototype.supportsProps=function supportsProps(){return true};EmscriptenFileSystem2.prototype.supportsSynch=function supportsSynch(){return true};EmscriptenFileSystem2.prototype.renameSync=function renameSync(oldPath,newPath){try{this._FS.rename(oldPath,newPath)}catch(e){if(e.errno===ErrorCode.ENOENT){throw convertError(e,this.existsSync(oldPath)?newPath:oldPath)}else{throw convertError(e)}}};EmscriptenFileSystem2.prototype.statSync=function statSync(p2,isLstat){try{var stats=isLstat?this._FS.lstat(p2):this._FS.stat(p2);var itemType=this.modeToFileType(stats.mode);return new Stats(itemType,stats.size,stats.mode,stats.atime,stats.mtime,stats.ctime)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.openSync=function openSync(p2,flag,mode){try{var stream=this._FS.open(p2,flag.getFlagString(),mode);if(this._FS.isDir(stream.node.mode)){this._FS.close(stream);throw ApiError.EISDIR(p2)}return new EmscriptenFile(this,this._FS,p2,stream)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.unlinkSync=function unlinkSync(p2){try{this._FS.unlink(p2)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.rmdirSync=function rmdirSync(p2){try{this._FS.rmdir(p2)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.mkdirSync=function mkdirSync(p2,mode){try{this._FS.mkdir(p2,mode)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.readdirSync=function readdirSync(p2){try{return this._FS.readdir(p2).filter(function(p22){return p22!=="."&&p22!==".."})}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.truncateSync=function truncateSync(p2,len){try{this._FS.truncate(p2,len)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.readFileSync=function readFileSync(p2,encoding,flag){try{var data=this._FS.readFile(p2,{flags:flag.getFlagString()});var buff=uint8Array2Buffer(data);if(encoding){return buff.toString(encoding)}else{return buff}}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.writeFileSync=function writeFileSync(p2,data,encoding,flag,mode){try{if(encoding){data=Buffer2.from(data,encoding)}var u8=buffer2Uint8array(data);this._FS.writeFile(p2,u8,{flags:flag.getFlagString(),encoding:"binary"});this._FS.chmod(p2,mode)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.chmodSync=function chmodSync(p2,isLchmod,mode){try{isLchmod?this._FS.lchmod(p2,mode):this._FS.chmod(p2,mode)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.chownSync=function chownSync(p2,isLchown,uid,gid){try{isLchown?this._FS.lchown(p2,uid,gid):this._FS.chown(p2,uid,gid)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.symlinkSync=function symlinkSync(srcpath,dstpath,type){try{this._FS.symlink(srcpath,dstpath)}catch(e){throw convertError(e)}};EmscriptenFileSystem2.prototype.readlinkSync=function readlinkSync(p2){try{return this._FS.readlink(p2)}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.utimesSync=function utimesSync(p2,atime,mtime){try{this._FS.utime(p2,atime.getTime(),mtime.getTime())}catch(e){throw convertError(e,p2)}};EmscriptenFileSystem2.prototype.modeToFileType=function modeToFileType(mode){if(this._FS.isDir(mode)){return FileType.DIRECTORY}else if(this._FS.isFile(mode)){return FileType.FILE}else if(this._FS.isLink(mode)){return FileType.SYMLINK}else{throw ApiError.EPERM("Invalid mode: "+mode)}};return EmscriptenFileSystem2}(SynchronousFileSystem);EmscriptenFileSystem.Name="EmscriptenFileSystem";EmscriptenFileSystem.Options={FS:{type:"object",description:"The Emscripten file system to use (the `FS` variable)"}};var FolderAdapter=function(BaseFileSystem$$1){function FolderAdapter2(folder,wrapped){BaseFileSystem$$1.call(this);this._folder=folder;this._wrapped=wrapped}if(BaseFileSystem$$1)FolderAdapter2.__proto__=BaseFileSystem$$1;FolderAdapter2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);FolderAdapter2.prototype.constructor=FolderAdapter2;FolderAdapter2.Create=function Create(opts,cb){cb(null,new FolderAdapter2(opts.folder,opts.wrapped))};FolderAdapter2.isAvailable=function isAvailable(){return true};FolderAdapter2.prototype.initialize=function initialize3(cb){var this$1=this;this._wrapped.exists(this._folder,function(exists2){if(exists2){cb()}else if(this$1._wrapped.isReadOnly()){cb(ApiError.ENOENT(this$1._folder))}else{this$1._wrapped.mkdir(this$1._folder,511,cb)}})};FolderAdapter2.prototype.getName=function getName(){return this._wrapped.getName()};FolderAdapter2.prototype.isReadOnly=function isReadOnly(){return this._wrapped.isReadOnly()};FolderAdapter2.prototype.supportsProps=function supportsProps(){return this._wrapped.supportsProps()};FolderAdapter2.prototype.supportsSynch=function supportsSynch(){return this._wrapped.supportsSynch()};FolderAdapter2.prototype.supportsLinks=function supportsLinks(){return false};return FolderAdapter2}(BaseFileSystem);FolderAdapter.Name="FolderAdapter";FolderAdapter.Options={folder:{type:"string",description:"The folder to use as the root directory"},wrapped:{type:"object",description:"The file system to wrap"}};function translateError(folder,e){if(e!==null&&typeof e==="object"){var err=e;var p2=err.path;if(p2){p2="/"+path.relative(folder,p2);err.message=err.message.replace(err.path,p2);err.path=p2}}return e}function wrapCallback(folder,cb){if(typeof cb==="function"){return function(err){if(arguments.length>0){arguments[0]=translateError(folder,err)}cb.apply(null,arguments)}}else{return cb}}function wrapFunction(name2,wrapFirst,wrapSecond){if(name2.slice(name2.length-4)!=="Sync"){return function(){if(arguments.length>0){if(wrapFirst){arguments[0]=path.join(this._folder,arguments[0])}if(wrapSecond){arguments[1]=path.join(this._folder,arguments[1])}arguments[arguments.length-1]=wrapCallback(this._folder,arguments[arguments.length-1])}return this._wrapped[name2].apply(this._wrapped,arguments)}}else{return function(){try{if(wrapFirst){arguments[0]=path.join(this._folder,arguments[0])}if(wrapSecond){arguments[1]=path.join(this._folder,arguments[1])}return this._wrapped[name2].apply(this._wrapped,arguments)}catch(e){throw translateError(this._folder,e)}}}}["diskSpace","stat","statSync","open","openSync","unlink","unlinkSync","rmdir","rmdirSync","mkdir","mkdirSync","readdir","readdirSync","exists","existsSync","realpath","realpathSync","truncate","truncateSync","readFile","readFileSync","writeFile","writeFileSync","appendFile","appendFileSync","chmod","chmodSync","chown","chownSync","utimes","utimesSync","readlink","readlinkSync"].forEach(function(name2){FolderAdapter.prototype[name2]=wrapFunction(name2,true,false)});["rename","renameSync","link","linkSync","symlink","symlinkSync"].forEach(function(name2){FolderAdapter.prototype[name2]=wrapFunction(name2,true,true)});var toExport;if(typeof window!=="undefined"){toExport=window}else if(typeof self!=="undefined"){toExport=self}else{toExport=global2}var global$1=toExport;function isDirectoryEntry(entry){return entry.isDirectory}var _getFS=global$1.webkitRequestFileSystem||global$1.requestFileSystem||null;function _requestQuota(type,size,success,errorCallback){if(typeof navigator["webkitPersistentStorage"]!=="undefined"){switch(type){case global$1.PERSISTENT:navigator.webkitPersistentStorage.requestQuota(size,success,errorCallback);break;case global$1.TEMPORARY:navigator.webkitTemporaryStorage.requestQuota(size,success,errorCallback);break;default:errorCallback(new TypeError("Invalid storage type: "+type));break}}else{global$1.webkitStorageInfo.requestQuota(type,size,success,errorCallback)}}function _toArray(list2){return Array.prototype.slice.call(list2||[],0)}function convertError$1(err,p2,expectedDir){switch(err.name){case"PathExistsError":return ApiError.EEXIST(p2);case"QuotaExceededError":return ApiError.FileError(ErrorCode.ENOSPC,p2);case"NotFoundError":return ApiError.ENOENT(p2);case"SecurityError":return ApiError.FileError(ErrorCode.EACCES,p2);case"InvalidModificationError":return ApiError.FileError(ErrorCode.EPERM,p2);case"TypeMismatchError":return ApiError.FileError(expectedDir?ErrorCode.ENOTDIR:ErrorCode.EISDIR,p2);case"EncodingError":case"InvalidStateError":case"NoModificationAllowedError":default:return ApiError.FileError(ErrorCode.EINVAL,p2)}}var HTML5FSFile=function(PreloadFile$$1){function HTML5FSFile2(fs4,entry,path$$1,flag,stat,contents){PreloadFile$$1.call(this,fs4,path$$1,flag,stat,contents);this._entry=entry}if(PreloadFile$$1)HTML5FSFile2.__proto__=PreloadFile$$1;HTML5FSFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);HTML5FSFile2.prototype.constructor=HTML5FSFile2;HTML5FSFile2.prototype.sync=function sync(cb){var this$1=this;if(!this.isDirty()){return cb()}this._entry.createWriter(function(writer){var buffer$$1=this$1.getBuffer();var blob=new Blob([buffer2ArrayBuffer(buffer$$1)]);var length=blob.size;writer.onwriteend=function(err){writer.onwriteend=null;writer.onerror=null;writer.truncate(length);this$1.resetDirty();cb()};writer.onerror=function(err){cb(convertError$1(err,this$1.getPath(),false))};writer.write(blob)})};HTML5FSFile2.prototype.close=function close(cb){this.sync(cb)};return HTML5FSFile2}(PreloadFile);var HTML5FS=function(BaseFileSystem$$1){function HTML5FS2(size,type,deprecateMsg){if(size===void 0)size=5;if(type===void 0)type=global$1.PERSISTENT;if(deprecateMsg===void 0)deprecateMsg=true;BaseFileSystem$$1.call(this);this.size=1024*1024*size;this.type=type;deprecationMessage(deprecateMsg,HTML5FS2.Name,{size,type})}if(BaseFileSystem$$1)HTML5FS2.__proto__=BaseFileSystem$$1;HTML5FS2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);HTML5FS2.prototype.constructor=HTML5FS2;HTML5FS2.Create=function Create(opts,cb){var fs4=new HTML5FS2(opts.size,opts.type,false);fs4.allocate(function(e){return e?cb(e):cb(null,fs4)},false)};HTML5FS2.isAvailable=function isAvailable(){return!!_getFS};HTML5FS2.prototype.getName=function getName(){return HTML5FS2.Name};HTML5FS2.prototype.isReadOnly=function isReadOnly(){return false};HTML5FS2.prototype.supportsSymlinks=function supportsSymlinks(){return false};HTML5FS2.prototype.supportsProps=function supportsProps(){return false};HTML5FS2.prototype.supportsSynch=function supportsSynch(){return false};HTML5FS2.prototype.allocate=function allocate(cb,deprecateMsg){var this$1=this;if(cb===void 0)cb=function(){};if(deprecateMsg===void 0)deprecateMsg=true;if(deprecateMsg){console.warn("[HTML5FS] HTML5FS.allocate() is deprecated and will be removed in the next major release. Please use \'HTML5FS.Create({type: "+this.type+", size: "+this.size+"}, cb)\' to create and allocate HTML5FS instances.")}var success=function(fs4){this$1.fs=fs4;cb()};var error=function(err){cb(convertError$1(err,"/",true))};if(this.type===global$1.PERSISTENT){_requestQuota(this.type,this.size,function(granted){_getFS(this$1.type,granted,success,error)},error)}else{_getFS(this.type,this.size,success,error)}};HTML5FS2.prototype.empty=function empty(mainCb){this._readdir("/",function(err,entries){if(err){console.error("Failed to empty FS");mainCb(err)}else{var finished=function(er){if(err){console.error("Failed to empty FS");mainCb(err)}else{mainCb()}};var deleteEntry=function(entry,cb){var succ=function(){cb()};var error=function(err2){cb(convertError$1(err2,entry.fullPath,!entry.isDirectory))};if(isDirectoryEntry(entry)){entry.removeRecursively(succ,error)}else{entry.remove(succ,error)}};eachLimit(entries,deleteEntry,finished)}})};HTML5FS2.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;var semaphore=2;var successCount=0;var root2=this.fs.root;var currentPath=oldPath;var error=function(err){if(--semaphore<=0){cb(convertError$1(err,currentPath,false))}};var success=function(file){if(++successCount===2){return cb(new ApiError(ErrorCode.EINVAL,"Something was identified as both a file and a directory. This should never happen."))}if(oldPath===newPath){return cb()}currentPath=path.dirname(newPath);root2.getDirectory(currentPath,{},function(parentDir){currentPath=path.basename(newPath);file.moveTo(parentDir,currentPath,function(entry){cb()},function(err){if(file.isDirectory){currentPath=newPath;this$1.unlink(newPath,function(e){if(e){error(err)}else{this$1.rename(oldPath,newPath,cb)}})}else{error(err)}})},error)};root2.getFile(oldPath,{},success,error);root2.getDirectory(oldPath,{},success,error)};HTML5FS2.prototype.stat=function stat(path$$1,isLstat,cb){var this$1=this;var opts={create:false};var loadAsFile=function(entry){var fileFromEntry=function(file){var stat2=new Stats(FileType.FILE,file.size);cb(null,stat2)};entry.file(fileFromEntry,failedToLoad)};var loadAsDir=function(dir$$1){var size=4096;var stat2=new Stats(FileType.DIRECTORY,size);cb(null,stat2)};var failedToLoad=function(err){cb(convertError$1(err,path$$1,false))};var failedToLoadAsFile=function(){this$1.fs.root.getDirectory(path$$1,opts,loadAsDir,failedToLoad)};this.fs.root.getFile(path$$1,opts,loadAsFile,failedToLoadAsFile)};HTML5FS2.prototype.open=function open(p2,flags,mode,cb){var this$1=this;var error=function(err){if(err.name==="InvalidModificationError"&&flags.isExclusive()){cb(ApiError.EEXIST(p2))}else{cb(convertError$1(err,p2,false))}};this.fs.root.getFile(p2,{create:flags.pathNotExistsAction()===ActionType.CREATE_FILE,exclusive:flags.isExclusive()},function(entry){entry.file(function(file){var reader=new FileReader;reader.onloadend=function(event){var bfsFile=this$1._makeFile(p2,entry,flags,file,reader.result);cb(null,bfsFile)};reader.onerror=function(ev2){error(reader.error)};reader.readAsArrayBuffer(file)},error)},error)};HTML5FS2.prototype.unlink=function unlink(path$$1,cb){this._remove(path$$1,cb,true)};HTML5FS2.prototype.rmdir=function rmdir(path$$1,cb){var this$1=this;this.readdir(path$$1,function(e,files){if(e){cb(e)}else if(files.length>0){cb(ApiError.ENOTEMPTY(path$$1))}else{this$1._remove(path$$1,cb,false)}})};HTML5FS2.prototype.mkdir=function mkdir(path$$1,mode,cb){var opts={create:true,exclusive:true};var success=function(dir$$1){cb()};var error=function(err){cb(convertError$1(err,path$$1,true))};this.fs.root.getDirectory(path$$1,opts,success,error)};HTML5FS2.prototype.readdir=function readdir(path$$1,cb){this._readdir(path$$1,function(e,entries){if(entries){var rv=[];for(var i22=0,list2=entries;i22<list2.length;i22+=1){var entry=list2[i22];rv.push(entry.name)}cb(null,rv)}else{return cb(e)}})};HTML5FS2.prototype._makeFile=function _makeFile(path$$1,entry,flag,stat,data){if(data===void 0)data=new ArrayBuffer(0);var stats=new Stats(FileType.FILE,stat.size);var buffer$$1=arrayBuffer2Buffer(data);return new HTML5FSFile(this,entry,path$$1,flag,stats,buffer$$1)};HTML5FS2.prototype._readdir=function _readdir(path$$1,cb){var error=function(err){cb(convertError$1(err,path$$1,true))};this.fs.root.getDirectory(path$$1,{create:false},function(dirEntry){var reader=dirEntry.createReader();var entries=[];var readEntries=function(){reader.readEntries(function(results){if(results.length){entries=entries.concat(_toArray(results));readEntries()}else{cb(null,entries)}},error)};readEntries()},error)};HTML5FS2.prototype._remove=function _remove(path$$1,cb,isFile){var success=function(entry){var succ=function(){cb()};var err=function(err2){cb(convertError$1(err2,path$$1,!isFile))};entry.remove(succ,err)};var error=function(err){cb(convertError$1(err,path$$1,!isFile))};var opts={create:false};if(isFile){this.fs.root.getFile(path$$1,opts,success,error)}else{this.fs.root.getDirectory(path$$1,opts,success,error)}};return HTML5FS2}(BaseFileSystem);HTML5FS.Name="HTML5FS";HTML5FS.Options={size:{type:"number",optional:true,description:"Storage quota to request, in megabytes. Allocated value may be less. Defaults to 5."},type:{type:"number",optional:true,description:"window.PERSISTENT or window.TEMPORARY. Defaults to PERSISTENT."}};var Inode=function Inode2(id,size,mode,atime,mtime,ctime){this.id=id;this.size=size;this.mode=mode;this.atime=atime;this.mtime=mtime;this.ctime=ctime};Inode.fromBuffer=function fromBuffer(buffer$$1){if(buffer$$1===void 0){throw new Error("NO")}return new Inode(buffer$$1.toString("ascii",30),buffer$$1.readUInt32LE(0),buffer$$1.readUInt16LE(4),buffer$$1.readDoubleLE(6),buffer$$1.readDoubleLE(14),buffer$$1.readDoubleLE(22))};Inode.prototype.toStats=function toStats(){return new Stats((this.mode&61440)===FileType.DIRECTORY?FileType.DIRECTORY:FileType.FILE,this.size,this.mode,new Date(this.atime),new Date(this.mtime),new Date(this.ctime))};Inode.prototype.getSize=function getSize(){return 30+this.id.length};Inode.prototype.toBuffer=function toBuffer(buff){if(buff===void 0)buff=Buffer2.alloc(this.getSize());buff.writeUInt32LE(this.size,0);buff.writeUInt16LE(this.mode,4);buff.writeDoubleLE(this.atime,6);buff.writeDoubleLE(this.mtime,14);buff.writeDoubleLE(this.ctime,22);buff.write(this.id,30,this.id.length,"ascii");return buff};Inode.prototype.update=function update(stats){var hasChanged=false;if(this.size!==stats.size){this.size=stats.size;hasChanged=true}if(this.mode!==stats.mode){this.mode=stats.mode;hasChanged=true}var atimeMs=stats.atime.getTime();if(this.atime!==atimeMs){this.atime=atimeMs;hasChanged=true}var mtimeMs=stats.mtime.getTime();if(this.mtime!==mtimeMs){this.mtime=mtimeMs;hasChanged=true}var ctimeMs=stats.ctime.getTime();if(this.ctime!==ctimeMs){this.ctime=ctimeMs;hasChanged=true}return hasChanged};Inode.prototype.isFile=function isFile(){return(this.mode&61440)===FileType.FILE};Inode.prototype.isDirectory=function isDirectory(){return(this.mode&61440)===FileType.DIRECTORY};var ROOT_NODE_ID="/";var emptyDirNode=null;function getEmptyDirNode(){if(emptyDirNode){return emptyDirNode}return emptyDirNode=Buffer2.from("{}")}function GenerateRandomID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0;var v2=c==="x"?r:r&3|8;return v2.toString(16)})}function noError(e,cb){if(e){cb(e);return false}return true}function noErrorTx(e,tx,cb){if(e){tx.abort(function(){cb(e)});return false}return true}var SimpleSyncRWTransaction=function SimpleSyncRWTransaction2(store){this.store=store;this.originalData={};this.modifiedKeys=[]};SimpleSyncRWTransaction.prototype.get=function get(key){var val=this.store.get(key);this.stashOldValue(key,val);return val};SimpleSyncRWTransaction.prototype.put=function put(key,data,overwrite){this.markModified(key);return this.store.put(key,data,overwrite)};SimpleSyncRWTransaction.prototype.del=function del(key){this.markModified(key);this.store.del(key)};SimpleSyncRWTransaction.prototype.commit=function commit(){};SimpleSyncRWTransaction.prototype.abort=function abort(){var this$1=this;for(var i22=0,list2=this$1.modifiedKeys;i22<list2.length;i22+=1){var key=list2[i22];var value=this$1.originalData[key];if(!value){this$1.store.del(key)}else{this$1.store.put(key,value,true)}}};SimpleSyncRWTransaction.prototype.stashOldValue=function stashOldValue(key,value){if(!this.originalData.hasOwnProperty(key)){this.originalData[key]=value}};SimpleSyncRWTransaction.prototype.markModified=function markModified(key){if(this.modifiedKeys.indexOf(key)===-1){this.modifiedKeys.push(key);if(!this.originalData.hasOwnProperty(key)){this.originalData[key]=this.store.get(key)}}};var SyncKeyValueFile=function(PreloadFile$$1){function SyncKeyValueFile2(_fs,_path,_flag,_stat,contents){PreloadFile$$1.call(this,_fs,_path,_flag,_stat,contents)}if(PreloadFile$$1)SyncKeyValueFile2.__proto__=PreloadFile$$1;SyncKeyValueFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);SyncKeyValueFile2.prototype.constructor=SyncKeyValueFile2;SyncKeyValueFile2.prototype.syncSync=function syncSync(){if(this.isDirty()){this._fs._syncSync(this.getPath(),this.getBuffer(),this.getStats());this.resetDirty()}};SyncKeyValueFile2.prototype.closeSync=function closeSync(){this.syncSync()};return SyncKeyValueFile2}(PreloadFile);var SyncKeyValueFileSystem=function(SynchronousFileSystem$$1){function SyncKeyValueFileSystem2(options){SynchronousFileSystem$$1.call(this);this.store=options.store;this.makeRootDirectory()}if(SynchronousFileSystem$$1)SyncKeyValueFileSystem2.__proto__=SynchronousFileSystem$$1;SyncKeyValueFileSystem2.prototype=Object.create(SynchronousFileSystem$$1&&SynchronousFileSystem$$1.prototype);SyncKeyValueFileSystem2.prototype.constructor=SyncKeyValueFileSystem2;SyncKeyValueFileSystem2.isAvailable=function isAvailable(){return true};SyncKeyValueFileSystem2.prototype.getName=function getName(){return this.store.name()};SyncKeyValueFileSystem2.prototype.isReadOnly=function isReadOnly(){return false};SyncKeyValueFileSystem2.prototype.supportsSymlinks=function supportsSymlinks(){return false};SyncKeyValueFileSystem2.prototype.supportsProps=function supportsProps(){return false};SyncKeyValueFileSystem2.prototype.supportsSynch=function supportsSynch(){return true};SyncKeyValueFileSystem2.prototype.empty=function empty(){this.store.clear();this.makeRootDirectory()};SyncKeyValueFileSystem2.prototype.renameSync=function renameSync(oldPath,newPath){var tx=this.store.beginTransaction("readwrite"),oldParent=path.dirname(oldPath),oldName=path.basename(oldPath),newParent=path.dirname(newPath),newName=path.basename(newPath),oldDirNode=this.findINode(tx,oldParent),oldDirList=this.getDirListing(tx,oldParent,oldDirNode);if(!oldDirList[oldName]){throw ApiError.ENOENT(oldPath)}var nodeId=oldDirList[oldName];delete oldDirList[oldName];if((newParent+"/").indexOf(oldPath+"/")===0){throw new ApiError(ErrorCode.EBUSY,oldParent)}var newDirNode,newDirList;if(newParent===oldParent){newDirNode=oldDirNode;newDirList=oldDirList}else{newDirNode=this.findINode(tx,newParent);newDirList=this.getDirListing(tx,newParent,newDirNode)}if(newDirList[newName]){var newNameNode=this.getINode(tx,newPath,newDirList[newName]);if(newNameNode.isFile()){try{tx.del(newNameNode.id);tx.del(newDirList[newName])}catch(e){tx.abort();throw e}}else{throw ApiError.EPERM(newPath)}}newDirList[newName]=nodeId;try{tx.put(oldDirNode.id,Buffer2.from(JSON.stringify(oldDirList)),true);tx.put(newDirNode.id,Buffer2.from(JSON.stringify(newDirList)),true)}catch(e){tx.abort();throw e}tx.commit()};SyncKeyValueFileSystem2.prototype.statSync=function statSync(p2,isLstat){return this.findINode(this.store.beginTransaction("readonly"),p2).toStats()};SyncKeyValueFileSystem2.prototype.createFileSync=function createFileSync(p2,flag,mode){var tx=this.store.beginTransaction("readwrite"),data=emptyBuffer(),newFile=this.commitNewFile(tx,p2,FileType.FILE,mode,data);return new SyncKeyValueFile(this,p2,flag,newFile.toStats(),data)};SyncKeyValueFileSystem2.prototype.openFileSync=function openFileSync(p2,flag){var tx=this.store.beginTransaction("readonly"),node=this.findINode(tx,p2),data=tx.get(node.id);if(data===void 0){throw ApiError.ENOENT(p2)}return new SyncKeyValueFile(this,p2,flag,node.toStats(),data)};SyncKeyValueFileSystem2.prototype.unlinkSync=function unlinkSync(p2){this.removeEntry(p2,false)};SyncKeyValueFileSystem2.prototype.rmdirSync=function rmdirSync(p2){if(this.readdirSync(p2).length>0){throw ApiError.ENOTEMPTY(p2)}else{this.removeEntry(p2,true)}};SyncKeyValueFileSystem2.prototype.mkdirSync=function mkdirSync(p2,mode){var tx=this.store.beginTransaction("readwrite"),data=Buffer2.from("{}");this.commitNewFile(tx,p2,FileType.DIRECTORY,mode,data)};SyncKeyValueFileSystem2.prototype.readdirSync=function readdirSync(p2){var tx=this.store.beginTransaction("readonly");return Object.keys(this.getDirListing(tx,p2,this.findINode(tx,p2)))};SyncKeyValueFileSystem2.prototype._syncSync=function _syncSync(p2,data,stats){var tx=this.store.beginTransaction("readwrite"),fileInodeId=this._findINode(tx,path.dirname(p2),path.basename(p2)),fileInode=this.getINode(tx,p2,fileInodeId),inodeChanged=fileInode.update(stats);try{tx.put(fileInode.id,data,true);if(inodeChanged){tx.put(fileInodeId,fileInode.toBuffer(),true)}}catch(e){tx.abort();throw e}tx.commit()};SyncKeyValueFileSystem2.prototype.makeRootDirectory=function makeRootDirectory(){var tx=this.store.beginTransaction("readwrite");if(tx.get(ROOT_NODE_ID)===void 0){var currTime=new Date().getTime(),dirInode=new Inode(GenerateRandomID(),4096,511|FileType.DIRECTORY,currTime,currTime,currTime);tx.put(dirInode.id,getEmptyDirNode(),false);tx.put(ROOT_NODE_ID,dirInode.toBuffer(),false);tx.commit()}};SyncKeyValueFileSystem2.prototype._findINode=function _findINode(tx,parent,filename){var this$1=this;var readDirectory=function(inode){var dirList=this$1.getDirListing(tx,parent,inode);if(dirList[filename]){return dirList[filename]}else{throw ApiError.ENOENT(path.resolve(parent,filename))}};if(parent==="/"){if(filename===""){return ROOT_NODE_ID}else{return readDirectory(this.getINode(tx,parent,ROOT_NODE_ID))}}else{return readDirectory(this.getINode(tx,parent+path.sep+filename,this._findINode(tx,path.dirname(parent),path.basename(parent))))}};SyncKeyValueFileSystem2.prototype.findINode=function findINode(tx,p2){return this.getINode(tx,p2,this._findINode(tx,path.dirname(p2),path.basename(p2)))};SyncKeyValueFileSystem2.prototype.getINode=function getINode(tx,p2,id){var inode=tx.get(id);if(inode===void 0){throw ApiError.ENOENT(p2)}return Inode.fromBuffer(inode)};SyncKeyValueFileSystem2.prototype.getDirListing=function getDirListing(tx,p2,inode){if(!inode.isDirectory()){throw ApiError.ENOTDIR(p2)}var data=tx.get(inode.id);if(data===void 0){throw ApiError.ENOENT(p2)}return JSON.parse(data.toString())};SyncKeyValueFileSystem2.prototype.addNewNode=function addNewNode(tx,data){var retries=0;var currId;while(retries<5){try{currId=GenerateRandomID();tx.put(currId,data,false);return currId}catch(e){}}throw new ApiError(ErrorCode.EIO,"Unable to commit data to key-value store.")};SyncKeyValueFileSystem2.prototype.commitNewFile=function commitNewFile(tx,p2,type,mode,data){var parentDir=path.dirname(p2),fname=path.basename(p2),parentNode=this.findINode(tx,parentDir),dirListing=this.getDirListing(tx,parentDir,parentNode),currTime=new Date().getTime();if(p2==="/"){throw ApiError.EEXIST(p2)}if(dirListing[fname]){throw ApiError.EEXIST(p2)}var fileNode;try{var dataId=this.addNewNode(tx,data);fileNode=new Inode(dataId,data.length,mode|type,currTime,currTime,currTime);var fileNodeId=this.addNewNode(tx,fileNode.toBuffer());dirListing[fname]=fileNodeId;tx.put(parentNode.id,Buffer2.from(JSON.stringify(dirListing)),true)}catch(e){tx.abort();throw e}tx.commit();return fileNode};SyncKeyValueFileSystem2.prototype.removeEntry=function removeEntry(p2,isDir){var tx=this.store.beginTransaction("readwrite"),parent=path.dirname(p2),parentNode=this.findINode(tx,parent),parentListing=this.getDirListing(tx,parent,parentNode),fileName=path.basename(p2);if(!parentListing[fileName]){throw ApiError.ENOENT(p2)}var fileNodeId=parentListing[fileName];delete parentListing[fileName];var fileNode=this.getINode(tx,p2,fileNodeId);if(!isDir&&fileNode.isDirectory()){throw ApiError.EISDIR(p2)}else if(isDir&&!fileNode.isDirectory()){throw ApiError.ENOTDIR(p2)}try{tx.del(fileNode.id);tx.del(fileNodeId);tx.put(parentNode.id,Buffer2.from(JSON.stringify(parentListing)),true)}catch(e){tx.abort();throw e}tx.commit()};return SyncKeyValueFileSystem2}(SynchronousFileSystem);var AsyncKeyValueFile=function(PreloadFile$$1){function AsyncKeyValueFile2(_fs,_path,_flag,_stat,contents){PreloadFile$$1.call(this,_fs,_path,_flag,_stat,contents)}if(PreloadFile$$1)AsyncKeyValueFile2.__proto__=PreloadFile$$1;AsyncKeyValueFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);AsyncKeyValueFile2.prototype.constructor=AsyncKeyValueFile2;AsyncKeyValueFile2.prototype.sync=function sync(cb){var this$1=this;if(this.isDirty()){this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),function(e){if(!e){this$1.resetDirty()}cb(e)})}else{cb()}};AsyncKeyValueFile2.prototype.close=function close(cb){this.sync(cb)};return AsyncKeyValueFile2}(PreloadFile);var AsyncKeyValueFileSystem=function(BaseFileSystem$$1){function AsyncKeyValueFileSystem2(){BaseFileSystem$$1.apply(this,arguments)}if(BaseFileSystem$$1)AsyncKeyValueFileSystem2.__proto__=BaseFileSystem$$1;AsyncKeyValueFileSystem2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);AsyncKeyValueFileSystem2.prototype.constructor=AsyncKeyValueFileSystem2;AsyncKeyValueFileSystem2.isAvailable=function isAvailable(){return true};AsyncKeyValueFileSystem2.prototype.init=function init(store,cb){this.store=store;this.makeRootDirectory(cb)};AsyncKeyValueFileSystem2.prototype.getName=function getName(){return this.store.name()};AsyncKeyValueFileSystem2.prototype.isReadOnly=function isReadOnly(){return false};AsyncKeyValueFileSystem2.prototype.supportsSymlinks=function supportsSymlinks(){return false};AsyncKeyValueFileSystem2.prototype.supportsProps=function supportsProps(){return false};AsyncKeyValueFileSystem2.prototype.supportsSynch=function supportsSynch(){return false};AsyncKeyValueFileSystem2.prototype.empty=function empty(cb){var this$1=this;this.store.clear(function(e){if(noError(e,cb)){this$1.makeRootDirectory(cb)}})};AsyncKeyValueFileSystem2.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;var tx=this.store.beginTransaction("readwrite");var oldParent=path.dirname(oldPath),oldName=path.basename(oldPath);var newParent=path.dirname(newPath),newName=path.basename(newPath);var inodes={};var lists={};var errorOccurred=false;if((newParent+"/").indexOf(oldPath+"/")===0){return cb(new ApiError(ErrorCode.EBUSY,oldParent))}var theOleSwitcharoo=function(){if(errorOccurred||!lists.hasOwnProperty(oldParent)||!lists.hasOwnProperty(newParent)){return}var oldParentList=lists[oldParent],oldParentINode=inodes[oldParent],newParentList=lists[newParent],newParentINode=inodes[newParent];if(!oldParentList[oldName]){cb(ApiError.ENOENT(oldPath))}else{var fileId=oldParentList[oldName];delete oldParentList[oldName];var completeRename=function(){newParentList[newName]=fileId;tx.put(oldParentINode.id,Buffer2.from(JSON.stringify(oldParentList)),true,function(e){if(noErrorTx(e,tx,cb)){if(oldParent===newParent){tx.commit(cb)}else{tx.put(newParentINode.id,Buffer2.from(JSON.stringify(newParentList)),true,function(e2){if(noErrorTx(e2,tx,cb)){tx.commit(cb)}})}}})};if(newParentList[newName]){this$1.getINode(tx,newPath,newParentList[newName],function(e,inode){if(noErrorTx(e,tx,cb)){if(inode.isFile()){tx.del(inode.id,function(e2){if(noErrorTx(e2,tx,cb)){tx.del(newParentList[newName],function(e3){if(noErrorTx(e3,tx,cb)){completeRename()}})}})}else{tx.abort(function(e2){cb(ApiError.EPERM(newPath))})}}})}else{completeRename()}}};var processInodeAndListings=function(p2){this$1.findINodeAndDirListing(tx,p2,function(e,node,dirList){if(e){if(!errorOccurred){errorOccurred=true;tx.abort(function(){cb(e)})}}else{inodes[p2]=node;lists[p2]=dirList;theOleSwitcharoo()}})};processInodeAndListings(oldParent);if(oldParent!==newParent){processInodeAndListings(newParent)}};AsyncKeyValueFileSystem2.prototype.stat=function stat(p2,isLstat,cb){var tx=this.store.beginTransaction("readonly");this.findINode(tx,p2,function(e,inode){if(noError(e,cb)){cb(null,inode.toStats())}})};AsyncKeyValueFileSystem2.prototype.createFile=function createFile(p2,flag,mode,cb){var this$1=this;var tx=this.store.beginTransaction("readwrite"),data=emptyBuffer();this.commitNewFile(tx,p2,FileType.FILE,mode,data,function(e,newFile){if(noError(e,cb)){cb(null,new AsyncKeyValueFile(this$1,p2,flag,newFile.toStats(),data))}})};AsyncKeyValueFileSystem2.prototype.openFile=function openFile(p2,flag,cb){var this$1=this;var tx=this.store.beginTransaction("readonly");this.findINode(tx,p2,function(e,inode){if(noError(e,cb)){tx.get(inode.id,function(e2,data){if(noError(e2,cb)){if(data===void 0){cb(ApiError.ENOENT(p2))}else{cb(null,new AsyncKeyValueFile(this$1,p2,flag,inode.toStats(),data))}}})}})};AsyncKeyValueFileSystem2.prototype.unlink=function unlink(p2,cb){this.removeEntry(p2,false,cb)};AsyncKeyValueFileSystem2.prototype.rmdir=function rmdir(p2,cb){var this$1=this;this.readdir(p2,function(err,files){if(err){cb(err)}else if(files.length>0){cb(ApiError.ENOTEMPTY(p2))}else{this$1.removeEntry(p2,true,cb)}})};AsyncKeyValueFileSystem2.prototype.mkdir=function mkdir(p2,mode,cb){var tx=this.store.beginTransaction("readwrite"),data=Buffer2.from("{}");this.commitNewFile(tx,p2,FileType.DIRECTORY,mode,data,cb)};AsyncKeyValueFileSystem2.prototype.readdir=function readdir(p2,cb){var this$1=this;var tx=this.store.beginTransaction("readonly");this.findINode(tx,p2,function(e,inode){if(noError(e,cb)){this$1.getDirListing(tx,p2,inode,function(e2,dirListing){if(noError(e2,cb)){cb(null,Object.keys(dirListing))}})}})};AsyncKeyValueFileSystem2.prototype._sync=function _sync(p2,data,stats,cb){var this$1=this;var tx=this.store.beginTransaction("readwrite");this._findINode(tx,path.dirname(p2),path.basename(p2),function(e,fileInodeId){if(noErrorTx(e,tx,cb)){this$1.getINode(tx,p2,fileInodeId,function(e2,fileInode){if(noErrorTx(e2,tx,cb)){var inodeChanged=fileInode.update(stats);tx.put(fileInode.id,data,true,function(e3){if(noErrorTx(e3,tx,cb)){if(inodeChanged){tx.put(fileInodeId,fileInode.toBuffer(),true,function(e4){if(noErrorTx(e4,tx,cb)){tx.commit(cb)}})}else{tx.commit(cb)}}})}})}})};AsyncKeyValueFileSystem2.prototype.makeRootDirectory=function makeRootDirectory(cb){var tx=this.store.beginTransaction("readwrite");tx.get(ROOT_NODE_ID,function(e,data){if(e||data===void 0){var currTime=new Date().getTime(),dirInode=new Inode(GenerateRandomID(),4096,511|FileType.DIRECTORY,currTime,currTime,currTime);tx.put(dirInode.id,getEmptyDirNode(),false,function(e2){if(noErrorTx(e2,tx,cb)){tx.put(ROOT_NODE_ID,dirInode.toBuffer(),false,function(e3){if(e3){tx.abort(function(){cb(e3)})}else{tx.commit(cb)}})}})}else{tx.commit(cb)}})};AsyncKeyValueFileSystem2.prototype._findINode=function _findINode(tx,parent,filename,cb){var this$1=this;var handleDirectoryListings=function(e,inode,dirList){if(e){cb(e)}else if(dirList[filename]){cb(null,dirList[filename])}else{cb(ApiError.ENOENT(path.resolve(parent,filename)))}};if(parent==="/"){if(filename===""){cb(null,ROOT_NODE_ID)}else{this.getINode(tx,parent,ROOT_NODE_ID,function(e,inode){if(noError(e,cb)){this$1.getDirListing(tx,parent,inode,function(e2,dirList){handleDirectoryListings(e2,inode,dirList)})}})}}else{this.findINodeAndDirListing(tx,parent,handleDirectoryListings)}};AsyncKeyValueFileSystem2.prototype.findINode=function findINode(tx,p2,cb){var this$1=this;this._findINode(tx,path.dirname(p2),path.basename(p2),function(e,id){if(noError(e,cb)){this$1.getINode(tx,p2,id,cb)}})};AsyncKeyValueFileSystem2.prototype.getINode=function getINode(tx,p2,id,cb){tx.get(id,function(e,data){if(noError(e,cb)){if(data===void 0){cb(ApiError.ENOENT(p2))}else{cb(null,Inode.fromBuffer(data))}}})};AsyncKeyValueFileSystem2.prototype.getDirListing=function getDirListing(tx,p2,inode,cb){if(!inode.isDirectory()){cb(ApiError.ENOTDIR(p2))}else{tx.get(inode.id,function(e,data){if(noError(e,cb)){try{cb(null,JSON.parse(data.toString()))}catch(e2){cb(ApiError.ENOENT(p2))}}})}};AsyncKeyValueFileSystem2.prototype.findINodeAndDirListing=function findINodeAndDirListing(tx,p2,cb){var this$1=this;this.findINode(tx,p2,function(e,inode){if(noError(e,cb)){this$1.getDirListing(tx,p2,inode,function(e2,listing){if(noError(e2,cb)){cb(null,inode,listing)}})}})};AsyncKeyValueFileSystem2.prototype.addNewNode=function addNewNode(tx,data,cb){var retries=0,currId;var reroll=function(){if(++retries===5){cb(new ApiError(ErrorCode.EIO,"Unable to commit data to key-value store."))}else{currId=GenerateRandomID();tx.put(currId,data,false,function(e,committed){if(e||!committed){reroll()}else{cb(null,currId)}})}};reroll()};AsyncKeyValueFileSystem2.prototype.commitNewFile=function commitNewFile(tx,p2,type,mode,data,cb){var this$1=this;var parentDir=path.dirname(p2),fname=path.basename(p2),currTime=new Date().getTime();if(p2==="/"){return cb(ApiError.EEXIST(p2))}this.findINodeAndDirListing(tx,parentDir,function(e,parentNode,dirListing){if(noErrorTx(e,tx,cb)){if(dirListing[fname]){tx.abort(function(){cb(ApiError.EEXIST(p2))})}else{this$1.addNewNode(tx,data,function(e2,dataId){if(noErrorTx(e2,tx,cb)){var fileInode=new Inode(dataId,data.length,mode|type,currTime,currTime,currTime);this$1.addNewNode(tx,fileInode.toBuffer(),function(e3,fileInodeId){if(noErrorTx(e3,tx,cb)){dirListing[fname]=fileInodeId;tx.put(parentNode.id,Buffer2.from(JSON.stringify(dirListing)),true,function(e4){if(noErrorTx(e4,tx,cb)){tx.commit(function(e5){if(noErrorTx(e5,tx,cb)){cb(null,fileInode)}})}})}})}})}}})};AsyncKeyValueFileSystem2.prototype.removeEntry=function removeEntry(p2,isDir,cb){var this$1=this;var tx=this.store.beginTransaction("readwrite"),parent=path.dirname(p2),fileName=path.basename(p2);this.findINodeAndDirListing(tx,parent,function(e,parentNode,parentListing){if(noErrorTx(e,tx,cb)){if(!parentListing[fileName]){tx.abort(function(){cb(ApiError.ENOENT(p2))})}else{var fileNodeId=parentListing[fileName];delete parentListing[fileName];this$1.getINode(tx,p2,fileNodeId,function(e2,fileNode){if(noErrorTx(e2,tx,cb)){if(!isDir&&fileNode.isDirectory()){tx.abort(function(){cb(ApiError.EISDIR(p2))})}else if(isDir&&!fileNode.isDirectory()){tx.abort(function(){cb(ApiError.ENOTDIR(p2))})}else{tx.del(fileNode.id,function(e3){if(noErrorTx(e3,tx,cb)){tx.del(fileNodeId,function(e4){if(noErrorTx(e4,tx,cb)){tx.put(parentNode.id,Buffer2.from(JSON.stringify(parentListing)),true,function(e5){if(noErrorTx(e5,tx,cb)){tx.commit(cb)}})}})}})}}})}}})};return AsyncKeyValueFileSystem2}(BaseFileSystem);var InMemoryStore=function InMemoryStore2(){this.store={}};InMemoryStore.prototype.name=function name2(){return InMemoryFileSystem.Name};InMemoryStore.prototype.clear=function clear(){this.store={}};InMemoryStore.prototype.beginTransaction=function beginTransaction(type){return new SimpleSyncRWTransaction(this)};InMemoryStore.prototype.get=function get(key){return this.store[key]};InMemoryStore.prototype.put=function put(key,data,overwrite){if(!overwrite&&this.store.hasOwnProperty(key)){return false}this.store[key]=data;return true};InMemoryStore.prototype.del=function del(key){delete this.store[key]};var InMemoryFileSystem=function(SyncKeyValueFileSystem$$1){function InMemoryFileSystem2(){SyncKeyValueFileSystem$$1.call(this,{store:new InMemoryStore})}if(SyncKeyValueFileSystem$$1)InMemoryFileSystem2.__proto__=SyncKeyValueFileSystem$$1;InMemoryFileSystem2.prototype=Object.create(SyncKeyValueFileSystem$$1&&SyncKeyValueFileSystem$$1.prototype);InMemoryFileSystem2.prototype.constructor=InMemoryFileSystem2;InMemoryFileSystem2.Create=function Create(options,cb){cb(null,new InMemoryFileSystem2)};return InMemoryFileSystem2}(SyncKeyValueFileSystem);InMemoryFileSystem.Name="InMemory";InMemoryFileSystem.Options={};var indexedDB=global$1.indexedDB||global$1.mozIndexedDB||global$1.webkitIndexedDB||global$1.msIndexedDB;function convertError$2(e,message){if(message===void 0)message=e.toString();switch(e.name){case"NotFoundError":return new ApiError(ErrorCode.ENOENT,message);case"QuotaExceededError":return new ApiError(ErrorCode.ENOSPC,message);default:return new ApiError(ErrorCode.EIO,message)}}function onErrorHandler(cb,code,message){if(code===void 0)code=ErrorCode.EIO;if(message===void 0)message=null;return function(e){e.preventDefault();cb(new ApiError(code,message!==null?message:void 0))}}var IndexedDBROTransaction=function IndexedDBROTransaction2(tx,store){this.tx=tx;this.store=store};IndexedDBROTransaction.prototype.get=function get(key,cb){try{var r=this.store.get(key);r.onerror=onErrorHandler(cb);r.onsuccess=function(event){var result=event.target.result;if(result===void 0){cb(null,result)}else{cb(null,arrayBuffer2Buffer(result))}}}catch(e){cb(convertError$2(e))}};var IndexedDBRWTransaction=function(IndexedDBROTransaction2){function IndexedDBRWTransaction2(tx,store){IndexedDBROTransaction2.call(this,tx,store)}if(IndexedDBROTransaction2)IndexedDBRWTransaction2.__proto__=IndexedDBROTransaction2;IndexedDBRWTransaction2.prototype=Object.create(IndexedDBROTransaction2&&IndexedDBROTransaction2.prototype);IndexedDBRWTransaction2.prototype.constructor=IndexedDBRWTransaction2;IndexedDBRWTransaction2.prototype.put=function put(key,data,overwrite,cb){try{var arraybuffer=buffer2ArrayBuffer(data);var r;if(overwrite){r=this.store.put(arraybuffer,key)}else{r=this.store.add(arraybuffer,key)}r.onerror=onErrorHandler(cb);r.onsuccess=function(event){cb(null,true)}}catch(e){cb(convertError$2(e))}};IndexedDBRWTransaction2.prototype.del=function del(key,cb){try{var r=this.store["delete"](key);r.onerror=onErrorHandler(cb);r.onsuccess=function(event){cb()}}catch(e){cb(convertError$2(e))}};IndexedDBRWTransaction2.prototype.commit=function commit(cb){setTimeout(cb,0)};IndexedDBRWTransaction2.prototype.abort=function abort(cb){var _e=null;try{this.tx.abort()}catch(e){_e=convertError$2(e)}finally{cb(_e)}};return IndexedDBRWTransaction2}(IndexedDBROTransaction);var IndexedDBStore=function IndexedDBStore2(cb,storeName){var this$1=this;if(storeName===void 0)storeName="browserfs";this.storeName=storeName;var openReq=indexedDB.open(this.storeName,1);openReq.onupgradeneeded=function(event){var db=event.target.result;if(db.objectStoreNames.contains(this$1.storeName)){db.deleteObjectStore(this$1.storeName)}db.createObjectStore(this$1.storeName)};openReq.onsuccess=function(event){this$1.db=event.target.result;cb(null,this$1)};openReq.onerror=onErrorHandler(cb,ErrorCode.EACCES)};IndexedDBStore.prototype.name=function name2(){return IndexedDBFileSystem.Name+" - "+this.storeName};IndexedDBStore.prototype.clear=function clear(cb){try{var tx=this.db.transaction(this.storeName,"readwrite"),objectStore=tx.objectStore(this.storeName),r=objectStore.clear();r.onsuccess=function(event){setTimeout(cb,0)};r.onerror=onErrorHandler(cb)}catch(e){cb(convertError$2(e))}};IndexedDBStore.prototype.beginTransaction=function beginTransaction(type){if(type===void 0)type="readonly";var tx=this.db.transaction(this.storeName,type),objectStore=tx.objectStore(this.storeName);if(type==="readwrite"){return new IndexedDBRWTransaction(tx,objectStore)}else if(type==="readonly"){return new IndexedDBROTransaction(tx,objectStore)}else{throw new ApiError(ErrorCode.EINVAL,"Invalid transaction type.")}};var IndexedDBFileSystem=function(AsyncKeyValueFileSystem$$1){function IndexedDBFileSystem2(cb,storeName,deprecateMsg){var this$1=this;if(deprecateMsg===void 0)deprecateMsg=true;AsyncKeyValueFileSystem$$1.call(this);this.store=new IndexedDBStore(function(e){if(e){cb(e)}else{this$1.init(this$1.store,function(e2){cb(e2,this$1)})}},storeName);deprecationMessage(deprecateMsg,IndexedDBFileSystem2.Name,{storeName})}if(AsyncKeyValueFileSystem$$1)IndexedDBFileSystem2.__proto__=AsyncKeyValueFileSystem$$1;IndexedDBFileSystem2.prototype=Object.create(AsyncKeyValueFileSystem$$1&&AsyncKeyValueFileSystem$$1.prototype);IndexedDBFileSystem2.prototype.constructor=IndexedDBFileSystem2;IndexedDBFileSystem2.Create=function Create(opts,cb){new IndexedDBFileSystem2(cb,opts.storeName,false)};IndexedDBFileSystem2.isAvailable=function isAvailable(){try{return typeof indexedDB!=="undefined"&&null!==indexedDB.open("__browserfs_test__")}catch(e){return false}};return IndexedDBFileSystem2}(AsyncKeyValueFileSystem);IndexedDBFileSystem.Name="IndexedDB";IndexedDBFileSystem.Options={storeName:{type:"string",optional:true,description:"The name of this file system. You can have multiple IndexedDB file systems operating at once, but each must have a different name."}};var supportsBinaryString=false;var binaryEncoding;try{global$1.localStorage.setItem("__test__",String.fromCharCode(55296));supportsBinaryString=global$1.localStorage.getItem("__test__")===String.fromCharCode(55296)}catch(e){supportsBinaryString=false}binaryEncoding=supportsBinaryString?"binary_string":"binary_string_ie";if(!Buffer2.isEncoding(binaryEncoding)){binaryEncoding="base64"}var LocalStorageStore=function LocalStorageStore2(){};LocalStorageStore.prototype.name=function name2(){return LocalStorageFileSystem.Name};LocalStorageStore.prototype.clear=function clear(){global$1.localStorage.clear()};LocalStorageStore.prototype.beginTransaction=function beginTransaction(type){return new SimpleSyncRWTransaction(this)};LocalStorageStore.prototype.get=function get(key){try{var data=global$1.localStorage.getItem(key);if(data!==null){return Buffer2.from(data,binaryEncoding)}}catch(e){}return void 0};LocalStorageStore.prototype.put=function put(key,data,overwrite){try{if(!overwrite&&global$1.localStorage.getItem(key)!==null){return false}global$1.localStorage.setItem(key,data.toString(binaryEncoding));return true}catch(e){throw new ApiError(ErrorCode.ENOSPC,"LocalStorage is full.")}};LocalStorageStore.prototype.del=function del(key){try{global$1.localStorage.removeItem(key)}catch(e){throw new ApiError(ErrorCode.EIO,"Unable to delete key "+key+": "+e)}};var LocalStorageFileSystem=function(SyncKeyValueFileSystem$$1){function LocalStorageFileSystem2(){SyncKeyValueFileSystem$$1.call(this,{store:new LocalStorageStore})}if(SyncKeyValueFileSystem$$1)LocalStorageFileSystem2.__proto__=SyncKeyValueFileSystem$$1;LocalStorageFileSystem2.prototype=Object.create(SyncKeyValueFileSystem$$1&&SyncKeyValueFileSystem$$1.prototype);LocalStorageFileSystem2.prototype.constructor=LocalStorageFileSystem2;LocalStorageFileSystem2.Create=function Create(options,cb){cb(null,new LocalStorageFileSystem2)};LocalStorageFileSystem2.isAvailable=function isAvailable(){return typeof global$1.localStorage!=="undefined"};return LocalStorageFileSystem2}(SyncKeyValueFileSystem);LocalStorageFileSystem.Name="LocalStorage";LocalStorageFileSystem.Options={};var MountableFileSystem=function(BaseFileSystem$$1){function MountableFileSystem2(){BaseFileSystem$$1.call(this);this.mountList=[];this.mntMap={};this.rootFs=new InMemoryFileSystem}if(BaseFileSystem$$1)MountableFileSystem2.__proto__=BaseFileSystem$$1;MountableFileSystem2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);MountableFileSystem2.prototype.constructor=MountableFileSystem2;MountableFileSystem2.Create=function Create(opts,cb){var fs4=new MountableFileSystem2;Object.keys(opts).forEach(function(mountPoint){fs4.mount(mountPoint,opts[mountPoint])});cb(null,fs4)};MountableFileSystem2.isAvailable=function isAvailable(){return true};MountableFileSystem2.prototype.mount=function mount(mountPoint,fs4){if(mountPoint[0]!=="/"){mountPoint="/"+mountPoint}mountPoint=path.resolve(mountPoint);if(this.mntMap[mountPoint]){throw new ApiError(ErrorCode.EINVAL,"Mount point "+mountPoint+" is already taken.")}mkdirpSync(mountPoint,511,this.rootFs);this.mntMap[mountPoint]=fs4;this.mountList.push(mountPoint);this.mountList=this.mountList.sort(function(a,b){return b.length-a.length})};MountableFileSystem2.prototype.umount=function umount(mountPoint){var this$1=this;if(mountPoint[0]!=="/"){mountPoint="/"+mountPoint}mountPoint=path.resolve(mountPoint);if(!this.mntMap[mountPoint]){throw new ApiError(ErrorCode.EINVAL,"Mount point "+mountPoint+" is already unmounted.")}delete this.mntMap[mountPoint];this.mountList.splice(this.mountList.indexOf(mountPoint),1);while(mountPoint!=="/"){if(this$1.rootFs.readdirSync(mountPoint).length===0){this$1.rootFs.rmdirSync(mountPoint);mountPoint=path.dirname(mountPoint)}else{break}}};MountableFileSystem2.prototype._getFs=function _getFs(path$$1){var this$1=this;var mountList=this.mountList,len=mountList.length;for(var i22=0;i22<len;i22++){var mountPoint=mountList[i22];if(mountPoint.length<=path$$1.length&&path$$1.indexOf(mountPoint)===0){path$$1=path$$1.substr(mountPoint.length>1?mountPoint.length:0);if(path$$1===""){path$$1="/"}return{fs:this$1.mntMap[mountPoint],path:path$$1}}}return{fs:this.rootFs,path:path$$1}};MountableFileSystem2.prototype.getName=function getName(){return MountableFileSystem2.Name};MountableFileSystem2.prototype.diskSpace=function diskSpace(path$$1,cb){cb(0,0)};MountableFileSystem2.prototype.isReadOnly=function isReadOnly(){return false};MountableFileSystem2.prototype.supportsLinks=function supportsLinks(){return false};MountableFileSystem2.prototype.supportsProps=function supportsProps(){return false};MountableFileSystem2.prototype.supportsSynch=function supportsSynch(){return true};MountableFileSystem2.prototype.standardizeError=function standardizeError(err,path$$1,realPath){var index=err.message.indexOf(path$$1);if(index!==-1){err.message=err.message.substr(0,index)+realPath+err.message.substr(index+path$$1.length);err.path=realPath}return err};MountableFileSystem2.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;var fs1rv=this._getFs(oldPath);var fs2rv=this._getFs(newPath);if(fs1rv.fs===fs2rv.fs){return fs1rv.fs.rename(fs1rv.path,fs2rv.path,function(e){if(e){this$1.standardizeError(this$1.standardizeError(e,fs1rv.path,oldPath),fs2rv.path,newPath)}cb(e)})}return _fsMock.readFile(oldPath,function(err,data){if(err){return cb(err)}_fsMock.writeFile(newPath,data,function(err2){if(err2){return cb(err2)}_fsMock.unlink(oldPath,cb)})})};MountableFileSystem2.prototype.renameSync=function renameSync(oldPath,newPath){var fs1rv=this._getFs(oldPath);var fs2rv=this._getFs(newPath);if(fs1rv.fs===fs2rv.fs){try{return fs1rv.fs.renameSync(fs1rv.path,fs2rv.path)}catch(e){this.standardizeError(this.standardizeError(e,fs1rv.path,oldPath),fs2rv.path,newPath);throw e}}var data=_fsMock.readFileSync(oldPath);_fsMock.writeFileSync(newPath,data);return _fsMock.unlinkSync(oldPath)};MountableFileSystem2.prototype.readdirSync=function readdirSync(p2){var fsInfo=this._getFs(p2);var rv=null;if(fsInfo.fs!==this.rootFs){try{rv=this.rootFs.readdirSync(p2)}catch(e){}}try{var rv2=fsInfo.fs.readdirSync(fsInfo.path);if(rv===null){return rv2}else{return rv2.concat(rv.filter(function(val){return rv2.indexOf(val)===-1}))}}catch(e){if(rv===null){throw this.standardizeError(e,fsInfo.path,p2)}else{return rv}}};MountableFileSystem2.prototype.readdir=function readdir(p2,cb){var this$1=this;var fsInfo=this._getFs(p2);fsInfo.fs.readdir(fsInfo.path,function(err,files){if(fsInfo.fs!==this$1.rootFs){try{var rv=this$1.rootFs.readdirSync(p2);if(files){files=files.concat(rv.filter(function(val){return files.indexOf(val)===-1}))}else{files=rv}}catch(e){if(err){return cb(this$1.standardizeError(err,fsInfo.path,p2))}}}else if(err){return cb(this$1.standardizeError(err,fsInfo.path,p2))}cb(null,files)})};MountableFileSystem2.prototype.rmdirSync=function rmdirSync(p2){var fsInfo=this._getFs(p2);if(this._containsMountPt(p2)){throw ApiError.ENOTEMPTY(p2)}else{try{fsInfo.fs.rmdirSync(fsInfo.path)}catch(e){throw this.standardizeError(e,fsInfo.path,p2)}}};MountableFileSystem2.prototype.rmdir=function rmdir(p2,cb){var this$1=this;var fsInfo=this._getFs(p2);if(this._containsMountPt(p2)){cb(ApiError.ENOTEMPTY(p2))}else{fsInfo.fs.rmdir(fsInfo.path,function(err){cb(err?this$1.standardizeError(err,fsInfo.path,p2):null)})}};MountableFileSystem2.prototype._containsMountPt=function _containsMountPt(p2){var mountPoints=this.mountList,len=mountPoints.length;for(var i22=0;i22<len;i22++){var pt=mountPoints[i22];if(pt.length>=p2.length&&pt.slice(0,p2.length)===p2){return true}}return false};return MountableFileSystem2}(BaseFileSystem);MountableFileSystem.Name="MountableFileSystem";MountableFileSystem.Options={};function defineFcn(name2,isSync,numArgs){if(isSync){return function(){var args=[],len=arguments.length;while(len--)args[len]=arguments[len];var path$$1=args[0];var rv=this._getFs(path$$1);args[0]=rv.path;try{return rv.fs[name2].apply(rv.fs,args)}catch(e){this.standardizeError(e,rv.path,path$$1);throw e}}}else{return function(){var this$1=this;var args=[],len=arguments.length;while(len--)args[len]=arguments[len];var path$$1=args[0];var rv=this._getFs(path$$1);args[0]=rv.path;if(typeof args[args.length-1]==="function"){var cb=args[args.length-1];args[args.length-1]=function(){var args2=[],len2=arguments.length;while(len2--)args2[len2]=arguments[len2];if(args2.length>0&&args2[0]instanceof ApiError){this$1.standardizeError(args2[0],rv.path,path$$1)}cb.apply(null,args2)}}return rv.fs[name2].apply(rv.fs,args)}}}var fsCmdMap=[["exists","unlink","readlink"],["stat","mkdir","realpath","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]];for(var i3=0;i3<fsCmdMap.length;i3++){var cmds=fsCmdMap[i3];for(var i$1=0,list=cmds;i$1<list.length;i$1+=1){var fnName=list[i$1];MountableFileSystem.prototype[fnName]=defineFcn(fnName,false,i3+1);MountableFileSystem.prototype[fnName+"Sync"]=defineFcn(fnName+"Sync",true,i3+1)}}var bfsSetImmediate;if(typeof setImmediate!=="undefined"){bfsSetImmediate=setImmediate}else{var gScope=global$1;var timeouts=[];var messageName="zero-timeout-message";var canUsePostMessage=function(){if(typeof gScope.importScripts!=="undefined"||!gScope.postMessage){return false}var postMessageIsAsync=true;var oldOnMessage=gScope.onmessage;gScope.onmessage=function(){postMessageIsAsync=false};gScope.postMessage("","*");gScope.onmessage=oldOnMessage;return postMessageIsAsync};if(canUsePostMessage()){bfsSetImmediate=function(fn){timeouts.push(fn);gScope.postMessage(messageName,"*")};var handleMessage=function(event){if(event.source===self&&event.data===messageName){if(event.stopPropagation){event.stopPropagation()}else{event.cancelBubble=true}if(timeouts.length>0){var fn=timeouts.shift();return fn()}}};if(gScope.addEventListener){gScope.addEventListener("message",handleMessage,true)}else{gScope.attachEvent("onmessage",handleMessage)}}else if(gScope.MessageChannel){var channel=new gScope.MessageChannel;channel.port1.onmessage=function(event){if(timeouts.length>0){return timeouts.shift()()}};bfsSetImmediate=function(fn){timeouts.push(fn);channel.port2.postMessage("")}}else{bfsSetImmediate=function(fn){return setTimeout(fn,0)}}}var setImmediate$3=bfsSetImmediate;var Mutex=function Mutex2(){this._locked=false;this._waiters=[]};Mutex.prototype.lock=function lock(cb){if(this._locked){this._waiters.push(cb);return}this._locked=true;cb()};Mutex.prototype.unlock=function unlock(){if(!this._locked){throw new Error("unlock of a non-locked mutex")}var next=this._waiters.shift();if(next){setImmediate$3(next);return}this._locked=false};Mutex.prototype.tryLock=function tryLock(){if(this._locked){return false}this._locked=true;return true};Mutex.prototype.isLocked=function isLocked(){return this._locked};var LockedFS=function LockedFS2(fs4){this._fs=fs4;this._mu=new Mutex};LockedFS.prototype.getName=function getName(){return"LockedFS<"+this._fs.getName()+">"};LockedFS.prototype.getFSUnlocked=function getFSUnlocked(){return this._fs};LockedFS.prototype.initialize=function initialize3(cb){this._fs.initialize(cb)};LockedFS.prototype.diskSpace=function diskSpace(p2,cb){this._fs.diskSpace(p2,cb)};LockedFS.prototype.isReadOnly=function isReadOnly(){return this._fs.isReadOnly()};LockedFS.prototype.supportsLinks=function supportsLinks(){return this._fs.supportsLinks()};LockedFS.prototype.supportsProps=function supportsProps(){return this._fs.supportsProps()};LockedFS.prototype.supportsSynch=function supportsSynch(){return this._fs.supportsSynch()};LockedFS.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;this._mu.lock(function(){this$1._fs.rename(oldPath,newPath,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.renameSync=function renameSync(oldPath,newPath){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.renameSync(oldPath,newPath)};LockedFS.prototype.stat=function stat(p2,isLstat,cb){var this$1=this;this._mu.lock(function(){this$1._fs.stat(p2,isLstat,function(err,stat2){this$1._mu.unlock();cb(err,stat2)})})};LockedFS.prototype.statSync=function statSync(p2,isLstat){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.statSync(p2,isLstat)};LockedFS.prototype.open=function open(p2,flag,mode,cb){var this$1=this;this._mu.lock(function(){this$1._fs.open(p2,flag,mode,function(err,fd){this$1._mu.unlock();cb(err,fd)})})};LockedFS.prototype.openSync=function openSync(p2,flag,mode){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.openSync(p2,flag,mode)};LockedFS.prototype.unlink=function unlink(p2,cb){var this$1=this;this._mu.lock(function(){this$1._fs.unlink(p2,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.unlinkSync=function unlinkSync(p2){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.unlinkSync(p2)};LockedFS.prototype.rmdir=function rmdir(p2,cb){var this$1=this;this._mu.lock(function(){this$1._fs.rmdir(p2,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.rmdirSync=function rmdirSync(p2){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.rmdirSync(p2)};LockedFS.prototype.mkdir=function mkdir(p2,mode,cb){var this$1=this;this._mu.lock(function(){this$1._fs.mkdir(p2,mode,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.mkdirSync=function mkdirSync(p2,mode){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.mkdirSync(p2,mode)};LockedFS.prototype.readdir=function readdir(p2,cb){var this$1=this;this._mu.lock(function(){this$1._fs.readdir(p2,function(err,files){this$1._mu.unlock();cb(err,files)})})};LockedFS.prototype.readdirSync=function readdirSync(p2){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.readdirSync(p2)};LockedFS.prototype.exists=function exists2(p2,cb){var this$1=this;this._mu.lock(function(){this$1._fs.exists(p2,function(exists3){this$1._mu.unlock();cb(exists3)})})};LockedFS.prototype.existsSync=function existsSync(p2){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.existsSync(p2)};LockedFS.prototype.realpath=function realpath(p2,cache,cb){var this$1=this;this._mu.lock(function(){this$1._fs.realpath(p2,cache,function(err,resolvedPath){this$1._mu.unlock();cb(err,resolvedPath)})})};LockedFS.prototype.realpathSync=function realpathSync(p2,cache){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.realpathSync(p2,cache)};LockedFS.prototype.truncate=function truncate(p2,len,cb){var this$1=this;this._mu.lock(function(){this$1._fs.truncate(p2,len,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.truncateSync=function truncateSync(p2,len){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.truncateSync(p2,len)};LockedFS.prototype.readFile=function readFile2(fname,encoding,flag,cb){var this$1=this;this._mu.lock(function(){this$1._fs.readFile(fname,encoding,flag,function(err,data){this$1._mu.unlock();cb(err,data)})})};LockedFS.prototype.readFileSync=function readFileSync(fname,encoding,flag){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.readFileSync(fname,encoding,flag)};LockedFS.prototype.writeFile=function writeFile2(fname,data,encoding,flag,mode,cb){var this$1=this;this._mu.lock(function(){this$1._fs.writeFile(fname,data,encoding,flag,mode,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.writeFileSync=function writeFileSync(fname,data,encoding,flag,mode){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.writeFileSync(fname,data,encoding,flag,mode)};LockedFS.prototype.appendFile=function appendFile3(fname,data,encoding,flag,mode,cb){var this$1=this;this._mu.lock(function(){this$1._fs.appendFile(fname,data,encoding,flag,mode,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.appendFileSync=function appendFileSync(fname,data,encoding,flag,mode){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.appendFileSync(fname,data,encoding,flag,mode)};LockedFS.prototype.chmod=function chmod(p2,isLchmod,mode,cb){var this$1=this;this._mu.lock(function(){this$1._fs.chmod(p2,isLchmod,mode,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.chmodSync=function chmodSync(p2,isLchmod,mode){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.chmodSync(p2,isLchmod,mode)};LockedFS.prototype.chown=function chown(p2,isLchown,uid,gid,cb){var this$1=this;this._mu.lock(function(){this$1._fs.chown(p2,isLchown,uid,gid,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.chownSync=function chownSync(p2,isLchown,uid,gid){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.chownSync(p2,isLchown,uid,gid)};LockedFS.prototype.utimes=function utimes(p2,atime,mtime,cb){var this$1=this;this._mu.lock(function(){this$1._fs.utimes(p2,atime,mtime,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.utimesSync=function utimesSync(p2,atime,mtime){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.utimesSync(p2,atime,mtime)};LockedFS.prototype.link=function link(srcpath,dstpath,cb){var this$1=this;this._mu.lock(function(){this$1._fs.link(srcpath,dstpath,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.linkSync=function linkSync(srcpath,dstpath){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.linkSync(srcpath,dstpath)};LockedFS.prototype.symlink=function symlink(srcpath,dstpath,type,cb){var this$1=this;this._mu.lock(function(){this$1._fs.symlink(srcpath,dstpath,type,function(err){this$1._mu.unlock();cb(err)})})};LockedFS.prototype.symlinkSync=function symlinkSync(srcpath,dstpath,type){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.symlinkSync(srcpath,dstpath,type)};LockedFS.prototype.readlink=function readlink(p2,cb){var this$1=this;this._mu.lock(function(){this$1._fs.readlink(p2,function(err,linkString){this$1._mu.unlock();cb(err,linkString)})})};LockedFS.prototype.readlinkSync=function readlinkSync(p2){if(this._mu.isLocked()){throw new Error("invalid sync call")}return this._fs.readlinkSync(p2)};var deletionLogPath="/.deletedFiles.log";function makeModeWritable(mode){return 146|mode}function getFlag(f){return FileFlag.getFileFlag(f)}var OverlayFile=function(PreloadFile$$1){function OverlayFile2(fs4,path$$1,flag,stats,data){PreloadFile$$1.call(this,fs4,path$$1,flag,stats,data)}if(PreloadFile$$1)OverlayFile2.__proto__=PreloadFile$$1;OverlayFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);OverlayFile2.prototype.constructor=OverlayFile2;OverlayFile2.prototype.sync=function sync(cb){var this$1=this;if(!this.isDirty()){cb(null);return}this._fs._syncAsync(this,function(err){this$1.resetDirty();cb(err)})};OverlayFile2.prototype.syncSync=function syncSync(){if(this.isDirty()){this._fs._syncSync(this);this.resetDirty()}};OverlayFile2.prototype.close=function close(cb){this.sync(cb)};OverlayFile2.prototype.closeSync=function closeSync(){this.syncSync()};return OverlayFile2}(PreloadFile);var UnlockedOverlayFS=function(BaseFileSystem$$1){function UnlockedOverlayFS2(writable,readable){BaseFileSystem$$1.call(this);this._isInitialized=false;this._initializeCallbacks=[];this._deletedFiles={};this._deleteLog="";this._deleteLogUpdatePending=false;this._deleteLogUpdateNeeded=false;this._deleteLogError=null;this._writable=writable;this._readable=readable;if(this._writable.isReadOnly()){throw new ApiError(ErrorCode.EINVAL,"Writable file system must be writable.")}}if(BaseFileSystem$$1)UnlockedOverlayFS2.__proto__=BaseFileSystem$$1;UnlockedOverlayFS2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);UnlockedOverlayFS2.prototype.constructor=UnlockedOverlayFS2;UnlockedOverlayFS2.isAvailable=function isAvailable(){return true};UnlockedOverlayFS2.prototype.getOverlayedFileSystems=function getOverlayedFileSystems(){return{readable:this._readable,writable:this._writable}};UnlockedOverlayFS2.prototype._syncAsync=function _syncAsync(file,cb){var this$1=this;this.createParentDirectoriesAsync(file.getPath(),function(err){if(err){return cb(err)}this$1._writable.writeFile(file.getPath(),file.getBuffer(),null,getFlag("w"),file.getStats().mode,cb)})};UnlockedOverlayFS2.prototype._syncSync=function _syncSync(file){this.createParentDirectories(file.getPath());this._writable.writeFileSync(file.getPath(),file.getBuffer(),null,getFlag("w"),file.getStats().mode)};UnlockedOverlayFS2.prototype.getName=function getName(){return OverlayFS.Name};UnlockedOverlayFS2.prototype.initialize=function initialize3(cb){var this$1=this;var callbackArray=this._initializeCallbacks;var end=function(e){this$1._isInitialized=!e;this$1._initializeCallbacks=[];callbackArray.forEach(function(cb2){return cb2(e)})};if(this._isInitialized){return cb()}callbackArray.push(cb);if(callbackArray.length!==1){return}this._writable.readFile(deletionLogPath,"utf8",getFlag("r"),function(err,data){if(err){if(err.errno!==ErrorCode.ENOENT){return end(err)}}else{this$1._deleteLog=data}this$1._reparseDeletionLog();end()})};UnlockedOverlayFS2.prototype.isReadOnly=function isReadOnly(){return false};UnlockedOverlayFS2.prototype.supportsSynch=function supportsSynch(){return this._readable.supportsSynch()&&this._writable.supportsSynch()};UnlockedOverlayFS2.prototype.supportsLinks=function supportsLinks(){return false};UnlockedOverlayFS2.prototype.supportsProps=function supportsProps(){return this._readable.supportsProps()&&this._writable.supportsProps()};UnlockedOverlayFS2.prototype.getDeletionLog=function getDeletionLog(){return this._deleteLog};UnlockedOverlayFS2.prototype.restoreDeletionLog=function restoreDeletionLog(log){this._deleteLog=log;this._reparseDeletionLog();this.updateLog("")};UnlockedOverlayFS2.prototype.rename=function rename(oldPath,newPath,cb){var this$1=this;if(!this.checkInitAsync(cb)||this.checkPathAsync(oldPath,cb)||this.checkPathAsync(newPath,cb)){return}if(oldPath===deletionLogPath||newPath===deletionLogPath){return cb(ApiError.EPERM("Cannot rename deletion log."))}if(oldPath===newPath){return cb()}this.stat(oldPath,false,function(oldErr,oldStats){if(oldErr){return cb(oldErr)}return this$1.stat(newPath,false,function(newErr,newStats){var self2=this$1;function copyDirContents(files){var file=files.shift();if(!file){return cb()}var oldFile=path.resolve(oldPath,file);var newFile=path.resolve(newPath,file);self2.rename(oldFile,newFile,function(err){if(err){return cb(err)}copyDirContents(files)})}var mode=511;if(oldStats.isDirectory()){if(newErr){if(newErr.errno!==ErrorCode.ENOENT){return cb(newErr)}return this$1._writable.exists(oldPath,function(exists2){if(exists2){return this$1._writable.rename(oldPath,newPath,cb)}this$1._writable.mkdir(newPath,mode,function(mkdirErr){if(mkdirErr){return cb(mkdirErr)}this$1._readable.readdir(oldPath,function(err,files){if(err){return cb()}copyDirContents(files)})})})}mode=newStats.mode;if(!newStats.isDirectory()){return cb(ApiError.ENOTDIR(newPath))}this$1.readdir(newPath,function(readdirErr,files){if(files&&files.length){return cb(ApiError.ENOTEMPTY(newPath))}this$1._readable.readdir(oldPath,function(err,files2){if(err){return cb()}copyDirContents(files2)})})}if(newStats&&newStats.isDirectory()){return cb(ApiError.EISDIR(newPath))}this$1.readFile(oldPath,null,getFlag("r"),function(err,data){if(err){return cb(err)}return this$1.writeFile(newPath,data,null,getFlag("w"),oldStats.mode,function(err2){if(err2){return cb(err2)}return this$1.unlink(oldPath,cb)})})})})};UnlockedOverlayFS2.prototype.renameSync=function renameSync(oldPath,newPath){var this$1=this;this.checkInitialized();this.checkPath(oldPath);this.checkPath(newPath);if(oldPath===deletionLogPath||newPath===deletionLogPath){throw ApiError.EPERM("Cannot rename deletion log.")}var oldStats=this.statSync(oldPath,false);if(oldStats.isDirectory()){if(oldPath===newPath){return}var mode=511;if(this.existsSync(newPath)){var stats=this.statSync(newPath,false);mode=stats.mode;if(stats.isDirectory()){if(this.readdirSync(newPath).length>0){throw ApiError.ENOTEMPTY(newPath)}}else{throw ApiError.ENOTDIR(newPath)}}if(this._writable.existsSync(oldPath)){this._writable.renameSync(oldPath,newPath)}else if(!this._writable.existsSync(newPath)){this._writable.mkdirSync(newPath,mode)}if(this._readable.existsSync(oldPath)){this._readable.readdirSync(oldPath).forEach(function(name2){this$1.renameSync(path.resolve(oldPath,name2),path.resolve(newPath,name2))})}}else{if(this.existsSync(newPath)&&this.statSync(newPath,false).isDirectory()){throw ApiError.EISDIR(newPath)}this.writeFileSync(newPath,this.readFileSync(oldPath,null,getFlag("r")),null,getFlag("w"),oldStats.mode)}if(oldPath!==newPath&&this.existsSync(oldPath)){this.unlinkSync(oldPath)}};UnlockedOverlayFS2.prototype.stat=function stat(p2,isLstat,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this._writable.stat(p2,isLstat,function(err,stat2){if(err&&err.errno===ErrorCode.ENOENT){if(this$1._deletedFiles[p2]){cb(ApiError.ENOENT(p2))}this$1._readable.stat(p2,isLstat,function(err2,stat3){if(stat3){stat3=stat3.clone();stat3.mode=makeModeWritable(stat3.mode)}cb(err2,stat3)})}else{cb(err,stat2)}})};UnlockedOverlayFS2.prototype.statSync=function statSync(p2,isLstat){this.checkInitialized();try{return this._writable.statSync(p2,isLstat)}catch(e){if(this._deletedFiles[p2]){throw ApiError.ENOENT(p2)}var oldStat=this._readable.statSync(p2,isLstat).clone();oldStat.mode=makeModeWritable(oldStat.mode);return oldStat}};UnlockedOverlayFS2.prototype.open=function open(p2,flag,mode,cb){var this$1=this;if(!this.checkInitAsync(cb)||this.checkPathAsync(p2,cb)){return}this.stat(p2,false,function(err,stats){if(stats){switch(flag.pathExistsAction()){case ActionType.TRUNCATE_FILE:return this$1.createParentDirectoriesAsync(p2,function(err2){if(err2){return cb(err2)}this$1._writable.open(p2,flag,mode,cb)});case ActionType.NOP:return this$1._writable.exists(p2,function(exists2){if(exists2){this$1._writable.open(p2,flag,mode,cb)}else{stats=stats.clone();stats.mode=mode;this$1._readable.readFile(p2,null,getFlag("r"),function(readFileErr,data){if(readFileErr){return cb(readFileErr)}if(stats.size===-1){stats.size=data.length}var f=new OverlayFile(this$1,p2,flag,stats,data);cb(null,f)})}});default:return cb(ApiError.EEXIST(p2))}}else{switch(flag.pathNotExistsAction()){case ActionType.CREATE_FILE:return this$1.createParentDirectoriesAsync(p2,function(err2){if(err2){return cb(err2)}return this$1._writable.open(p2,flag,mode,cb)});default:return cb(ApiError.ENOENT(p2))}}})};UnlockedOverlayFS2.prototype.openSync=function openSync(p2,flag,mode){this.checkInitialized();this.checkPath(p2);if(p2===deletionLogPath){throw ApiError.EPERM("Cannot open deletion log.")}if(this.existsSync(p2)){switch(flag.pathExistsAction()){case ActionType.TRUNCATE_FILE:this.createParentDirectories(p2);return this._writable.openSync(p2,flag,mode);case ActionType.NOP:if(this._writable.existsSync(p2)){return this._writable.openSync(p2,flag,mode)}else{var buf=this._readable.readFileSync(p2,null,getFlag("r"));var stats=this._readable.statSync(p2,false).clone();stats.mode=mode;return new OverlayFile(this,p2,flag,stats,buf)}default:throw ApiError.EEXIST(p2)}}else{switch(flag.pathNotExistsAction()){case ActionType.CREATE_FILE:this.createParentDirectories(p2);return this._writable.openSync(p2,flag,mode);default:throw ApiError.ENOENT(p2)}}};UnlockedOverlayFS2.prototype.unlink=function unlink(p2,cb){var this$1=this;if(!this.checkInitAsync(cb)||this.checkPathAsync(p2,cb)){return}this.exists(p2,function(exists2){if(!exists2){return cb(ApiError.ENOENT(p2))}this$1._writable.exists(p2,function(writableExists){if(writableExists){return this$1._writable.unlink(p2,function(err){if(err){return cb(err)}this$1.exists(p2,function(readableExists){if(readableExists){this$1.deletePath(p2)}cb(null)})})}else{this$1.deletePath(p2);cb(null)}})})};UnlockedOverlayFS2.prototype.unlinkSync=function unlinkSync(p2){this.checkInitialized();this.checkPath(p2);if(this.existsSync(p2)){if(this._writable.existsSync(p2)){this._writable.unlinkSync(p2)}if(this.existsSync(p2)){this.deletePath(p2)}}else{throw ApiError.ENOENT(p2)}};UnlockedOverlayFS2.prototype.rmdir=function rmdir(p2,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}var rmdirLower=function(){this$1.readdir(p2,function(err,files){if(err){return cb(err)}if(files.length){return cb(ApiError.ENOTEMPTY(p2))}this$1.deletePath(p2);cb(null)})};this.exists(p2,function(exists2){if(!exists2){return cb(ApiError.ENOENT(p2))}this$1._writable.exists(p2,function(writableExists){if(writableExists){this$1._writable.rmdir(p2,function(err){if(err){return cb(err)}this$1._readable.exists(p2,function(readableExists){if(readableExists){rmdirLower()}else{cb()}})})}else{rmdirLower()}})})};UnlockedOverlayFS2.prototype.rmdirSync=function rmdirSync(p2){this.checkInitialized();if(this.existsSync(p2)){if(this._writable.existsSync(p2)){this._writable.rmdirSync(p2)}if(this.existsSync(p2)){if(this.readdirSync(p2).length>0){throw ApiError.ENOTEMPTY(p2)}else{this.deletePath(p2)}}}else{throw ApiError.ENOENT(p2)}};UnlockedOverlayFS2.prototype.mkdir=function mkdir(p2,mode,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this.exists(p2,function(exists2){if(exists2){return cb(ApiError.EEXIST(p2))}this$1.createParentDirectoriesAsync(p2,function(err){if(err){return cb(err)}this$1._writable.mkdir(p2,mode,cb)})})};UnlockedOverlayFS2.prototype.mkdirSync=function mkdirSync(p2,mode){this.checkInitialized();if(this.existsSync(p2)){throw ApiError.EEXIST(p2)}else{this.createParentDirectories(p2);this._writable.mkdirSync(p2,mode)}};UnlockedOverlayFS2.prototype.readdir=function readdir(p2,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this.stat(p2,false,function(err,dirStats){if(err){return cb(err)}if(!dirStats.isDirectory()){return cb(ApiError.ENOTDIR(p2))}this$1._writable.readdir(p2,function(err2,wFiles){if(err2&&err2.code!=="ENOENT"){return cb(err2)}else if(err2||!wFiles){wFiles=[]}this$1._readable.readdir(p2,function(err3,rFiles){if(err3||!rFiles){rFiles=[]}var seenMap={};var filtered=wFiles.concat(rFiles.filter(function(fPath){return!this$1._deletedFiles[p2+"/"+fPath]})).filter(function(fPath){var result=!seenMap[fPath];seenMap[fPath]=true;return result});cb(null,filtered)})})})};UnlockedOverlayFS2.prototype.readdirSync=function readdirSync(p2){var this$1=this;this.checkInitialized();var dirStats=this.statSync(p2,false);if(!dirStats.isDirectory()){throw ApiError.ENOTDIR(p2)}var contents=[];try{contents=contents.concat(this._writable.readdirSync(p2))}catch(e){}try{contents=contents.concat(this._readable.readdirSync(p2).filter(function(fPath){return!this$1._deletedFiles[p2+"/"+fPath]}))}catch(e){}var seenMap={};return contents.filter(function(fileP){var result=!seenMap[fileP];seenMap[fileP]=true;return result})};UnlockedOverlayFS2.prototype.exists=function exists2(p2,cb){var this$1=this;this.checkInitialized();this._writable.exists(p2,function(existsWritable){if(existsWritable){return cb(true)}this$1._readable.exists(p2,function(existsReadable){cb(existsReadable&&this$1._deletedFiles[p2]!==true)})})};UnlockedOverlayFS2.prototype.existsSync=function existsSync(p2){this.checkInitialized();return this._writable.existsSync(p2)||this._readable.existsSync(p2)&&this._deletedFiles[p2]!==true};UnlockedOverlayFS2.prototype.chmod=function chmod(p2,isLchmod,mode,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this.operateOnWritableAsync(p2,function(err){if(err){return cb(err)}else{this$1._writable.chmod(p2,isLchmod,mode,cb)}})};UnlockedOverlayFS2.prototype.chmodSync=function chmodSync(p2,isLchmod,mode){var this$1=this;this.checkInitialized();this.operateOnWritable(p2,function(){this$1._writable.chmodSync(p2,isLchmod,mode)})};UnlockedOverlayFS2.prototype.chown=function chown(p2,isLchmod,uid,gid,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this.operateOnWritableAsync(p2,function(err){if(err){return cb(err)}else{this$1._writable.chown(p2,isLchmod,uid,gid,cb)}})};UnlockedOverlayFS2.prototype.chownSync=function chownSync(p2,isLchown,uid,gid){var this$1=this;this.checkInitialized();this.operateOnWritable(p2,function(){this$1._writable.chownSync(p2,isLchown,uid,gid)})};UnlockedOverlayFS2.prototype.utimes=function utimes(p2,atime,mtime,cb){var this$1=this;if(!this.checkInitAsync(cb)){return}this.operateOnWritableAsync(p2,function(err){if(err){return cb(err)}else{this$1._writable.utimes(p2,atime,mtime,cb)}})};UnlockedOverlayFS2.prototype.utimesSync=function utimesSync(p2,atime,mtime){var this$1=this;this.checkInitialized();this.operateOnWritable(p2,function(){this$1._writable.utimesSync(p2,atime,mtime)})};UnlockedOverlayFS2.prototype.deletePath=function deletePath(p2){this._deletedFiles[p2]=true;this.updateLog("d"+p2+"\\n")};UnlockedOverlayFS2.prototype.updateLog=function updateLog(addition){var this$1=this;this._deleteLog+=addition;if(this._deleteLogUpdatePending){this._deleteLogUpdateNeeded=true}else{this._deleteLogUpdatePending=true;this._writable.writeFile(deletionLogPath,this._deleteLog,"utf8",FileFlag.getFileFlag("w"),420,function(e){this$1._deleteLogUpdatePending=false;if(e){this$1._deleteLogError=e}else if(this$1._deleteLogUpdateNeeded){this$1._deleteLogUpdateNeeded=false;this$1.updateLog("")}})}};UnlockedOverlayFS2.prototype._reparseDeletionLog=function _reparseDeletionLog(){var this$1=this;this._deletedFiles={};this._deleteLog.split("\\n").forEach(function(path$$1){this$1._deletedFiles[path$$1.slice(1)]=path$$1.slice(0,1)==="d"})};UnlockedOverlayFS2.prototype.checkInitialized=function checkInitialized(){if(!this._isInitialized){throw new ApiError(ErrorCode.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")}else if(this._deleteLogError!==null){var e=this._deleteLogError;this._deleteLogError=null;throw e}};UnlockedOverlayFS2.prototype.checkInitAsync=function checkInitAsync(cb){if(!this._isInitialized){cb(new ApiError(ErrorCode.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it."));return false}else if(this._deleteLogError!==null){var e=this._deleteLogError;this._deleteLogError=null;cb(e);return false}return true};UnlockedOverlayFS2.prototype.checkPath=function checkPath(p2){if(p2===deletionLogPath){throw ApiError.EPERM(p2)}};UnlockedOverlayFS2.prototype.checkPathAsync=function checkPathAsync(p2,cb){if(p2===deletionLogPath){cb(ApiError.EPERM(p2));return true}return false};UnlockedOverlayFS2.prototype.createParentDirectoriesAsync=function createParentDirectoriesAsync(p2,cb){var parent=path.dirname(p2);var toCreate=[];var self2=this;this._writable.stat(parent,false,statDone);function statDone(err,stat){if(err){toCreate.push(parent);parent=path.dirname(parent);self2._writable.stat(parent,false,statDone)}else{createParents()}}function createParents(){if(!toCreate.length){return cb()}var dir=toCreate.pop();self2._readable.stat(dir,false,function(err,stats){if(!stats){return cb()}self2._writable.mkdir(dir,stats.mode,function(err2){if(err2){return cb(err2)}createParents()})})}};UnlockedOverlayFS2.prototype.createParentDirectories=function createParentDirectories(p2){var this$1=this;var parent=path.dirname(p2),toCreate=[];while(!this._writable.existsSync(parent)){toCreate.push(parent);parent=path.dirname(parent)}toCreate=toCreate.reverse();toCreate.forEach(function(p22){this$1._writable.mkdirSync(p22,this$1.statSync(p22,false).mode)})};UnlockedOverlayFS2.prototype.operateOnWritable=function operateOnWritable(p2,f){if(this.existsSync(p2)){if(!this._writable.existsSync(p2)){this.copyToWritable(p2)}f()}else{throw ApiError.ENOENT(p2)}};UnlockedOverlayFS2.prototype.operateOnWritableAsync=function operateOnWritableAsync(p2,cb){var this$1=this;this.exists(p2,function(exists2){if(!exists2){return cb(ApiError.ENOENT(p2))}this$1._writable.exists(p2,function(existsWritable){if(existsWritable){cb()}else{return this$1.copyToWritableAsync(p2,cb)}})})};UnlockedOverlayFS2.prototype.copyToWritable=function copyToWritable(p2){var pStats=this.statSync(p2,false);if(pStats.isDirectory()){this._writable.mkdirSync(p2,pStats.mode)}else{this.writeFileSync(p2,this._readable.readFileSync(p2,null,getFlag("r")),null,getFlag("w"),this.statSync(p2,false).mode)}};UnlockedOverlayFS2.prototype.copyToWritableAsync=function copyToWritableAsync(p2,cb){var this$1=this;this.stat(p2,false,function(err,pStats){if(err){return cb(err)}if(pStats.isDirectory()){return this$1._writable.mkdir(p2,pStats.mode,cb)}this$1._readable.readFile(p2,null,getFlag("r"),function(err2,data){if(err2){return cb(err2)}this$1.writeFile(p2,data,null,getFlag("w"),pStats.mode,cb)})})};return UnlockedOverlayFS2}(BaseFileSystem);var OverlayFS=function(LockedFS$$1){function OverlayFS2(writable,readable,deprecateMsg){if(deprecateMsg===void 0)deprecateMsg=true;LockedFS$$1.call(this,new UnlockedOverlayFS(writable,readable));deprecationMessage(deprecateMsg,OverlayFS2.Name,{readable:"readable file system",writable:"writable file system"})}if(LockedFS$$1)OverlayFS2.__proto__=LockedFS$$1;OverlayFS2.prototype=Object.create(LockedFS$$1&&LockedFS$$1.prototype);OverlayFS2.prototype.constructor=OverlayFS2;OverlayFS2.Create=function Create(opts,cb){try{var fs4=new OverlayFS2(opts.writable,opts.readable,false);fs4.initialize(function(e){cb(e,fs4)},false)}catch(e){cb(e)}};OverlayFS2.isAvailable=function isAvailable(){return UnlockedOverlayFS.isAvailable()};OverlayFS2.prototype.initialize=function initialize3(cb,deprecateMsg){if(deprecateMsg===void 0)deprecateMsg=true;if(deprecateMsg){console.warn("[OverlayFS] OverlayFS.initialize() is deprecated and will be removed in the next major release. Please use \'OverlayFS.Create({readable: readable file system instance, writable: writable file system instance}, cb)\' to create and initialize OverlayFS instances.")}LockedFS$$1.prototype.initialize.call(this,cb)};OverlayFS2.prototype.getOverlayedFileSystems=function getOverlayedFileSystems(){return LockedFS$$1.prototype.getFSUnlocked.call(this).getOverlayedFileSystems()};OverlayFS2.prototype.unwrap=function unwrap(){return LockedFS$$1.prototype.getFSUnlocked.call(this)};return OverlayFS2}(LockedFS);OverlayFS.Name="OverlayFS";OverlayFS.Options={writable:{type:"object",description:"The file system to write modified files to."},readable:{type:"object",description:"The file system that initially populates this file system."}};var SpecialArgType;(function(SpecialArgType2){SpecialArgType2[SpecialArgType2["CB"]=0]="CB";SpecialArgType2[SpecialArgType2["FD"]=1]="FD";SpecialArgType2[SpecialArgType2["API_ERROR"]=2]="API_ERROR";SpecialArgType2[SpecialArgType2["STATS"]=3]="STATS";SpecialArgType2[SpecialArgType2["PROBE"]=4]="PROBE";SpecialArgType2[SpecialArgType2["FILEFLAG"]=5]="FILEFLAG";SpecialArgType2[SpecialArgType2["BUFFER"]=6]="BUFFER";SpecialArgType2[SpecialArgType2["ERROR"]=7]="ERROR"})(SpecialArgType||(SpecialArgType={}));var CallbackArgumentConverter=function CallbackArgumentConverter2(){this._callbacks={};this._nextId=0};CallbackArgumentConverter.prototype.toRemoteArg=function toRemoteArg(cb){var id=this._nextId++;this._callbacks[id]=cb;return{type:SpecialArgType.CB,id}};CallbackArgumentConverter.prototype.toLocalArg=function toLocalArg(id){var cb=this._callbacks[id];delete this._callbacks[id];return cb};var FileDescriptorArgumentConverter=function FileDescriptorArgumentConverter2(){this._fileDescriptors={};this._nextId=0};FileDescriptorArgumentConverter.prototype.toRemoteArg=function toRemoteArg(fd,p2,flag,cb){var id=this._nextId++;var data;var stat;this._fileDescriptors[id]=fd;fd.stat(function(err,stats){if(err){cb(err)}else{stat=bufferToTransferrableObject(stats.toBuffer());if(flag.isReadable()){fd.read(Buffer2.alloc(stats.size),0,stats.size,0,function(err2,bytesRead,buff){if(err2){cb(err2)}else{data=bufferToTransferrableObject(buff);cb(null,{type:SpecialArgType.FD,id,data,stat,path:p2,flag:flag.getFlagString()})}})}else{cb(null,{type:SpecialArgType.FD,id,data:new ArrayBuffer(0),stat,path:p2,flag:flag.getFlagString()})}}})};FileDescriptorArgumentConverter.prototype.applyFdAPIRequest=function applyFdAPIRequest(request,cb){var this$1=this;var fdArg=request.args[0];this._applyFdChanges(fdArg,function(err,fd){if(err){cb(err)}else{fd[request.method](function(e){if(request.method==="close"){delete this$1._fileDescriptors[fdArg.id]}cb(e)})}})};FileDescriptorArgumentConverter.prototype._applyFdChanges=function _applyFdChanges(remoteFd,cb){var fd=this._fileDescriptors[remoteFd.id],data=transferrableObjectToBuffer(remoteFd.data),remoteStats=Stats.fromBuffer(transferrableObjectToBuffer(remoteFd.stat));var flag=FileFlag.getFileFlag(remoteFd.flag);if(flag.isWriteable()){fd.write(data,0,data.length,flag.isAppendable()?fd.getPos():0,function(e){function applyStatChanges(){fd.stat(function(e2,stats){if(e2){cb(e2)}else{if(stats.mode!==remoteStats.mode){fd.chmod(remoteStats.mode,function(e3){cb(e3,fd)})}else{cb(e2,fd)}}})}if(e){cb(e)}else{if(!flag.isAppendable()){fd.truncate(data.length,function(){applyStatChanges()})}else{applyStatChanges()}}})}else{cb(null,fd)}};function apiErrorLocal2Remote(e){return{type:SpecialArgType.API_ERROR,errorData:bufferToTransferrableObject(e.writeToBuffer())}}function apiErrorRemote2Local(e){return ApiError.fromBuffer(transferrableObjectToBuffer(e.errorData))}function errorLocal2Remote(e){return{type:SpecialArgType.ERROR,name:e.name,message:e.message,stack:e.stack}}function errorRemote2Local(e){var cnstr=global$1[e.name];if(typeof cnstr!=="function"){cnstr=Error}var err=new cnstr(e.message);err.stack=e.stack;return err}function statsLocal2Remote(stats){return{type:SpecialArgType.STATS,statsData:bufferToTransferrableObject(stats.toBuffer())}}function statsRemote2Local(stats){return Stats.fromBuffer(transferrableObjectToBuffer(stats.statsData))}function fileFlagLocal2Remote(flag){return{type:SpecialArgType.FILEFLAG,flagStr:flag.getFlagString()}}function fileFlagRemote2Local(remoteFlag){return FileFlag.getFileFlag(remoteFlag.flagStr)}function bufferToTransferrableObject(buff){return buffer2ArrayBuffer(buff)}function transferrableObjectToBuffer(buff){return arrayBuffer2Buffer(buff)}function bufferLocal2Remote(buff){return{type:SpecialArgType.BUFFER,data:bufferToTransferrableObject(buff)}}function bufferRemote2Local(buffArg){return transferrableObjectToBuffer(buffArg.data)}function isAPIRequest(data){return data&&typeof data==="object"&&data.hasOwnProperty("browserfsMessage")&&data["browserfsMessage"]}function isAPIResponse(data){return data&&typeof data==="object"&&data.hasOwnProperty("browserfsMessage")&&data["browserfsMessage"]}var WorkerFile=function(PreloadFile$$1){function WorkerFile2(_fs,_path,_flag,_stat,remoteFdId,contents){PreloadFile$$1.call(this,_fs,_path,_flag,_stat,contents);this._remoteFdId=remoteFdId}if(PreloadFile$$1)WorkerFile2.__proto__=PreloadFile$$1;WorkerFile2.prototype=Object.create(PreloadFile$$1&&PreloadFile$$1.prototype);WorkerFile2.prototype.constructor=WorkerFile2;WorkerFile2.prototype.getRemoteFdId=function getRemoteFdId(){return this._remoteFdId};WorkerFile2.prototype.toRemoteArg=function toRemoteArg(){return{type:SpecialArgType.FD,id:this._remoteFdId,data:bufferToTransferrableObject(this.getBuffer()),stat:bufferToTransferrableObject(this.getStats().toBuffer()),path:this.getPath(),flag:this.getFlag().getFlagString()}};WorkerFile2.prototype.sync=function sync(cb){this._syncClose("sync",cb)};WorkerFile2.prototype.close=function close(cb){this._syncClose("close",cb)};WorkerFile2.prototype._syncClose=function _syncClose(type,cb){var this$1=this;if(this.isDirty()){this._fs.syncClose(type,this,function(e){if(!e){this$1.resetDirty()}cb(e)})}else{cb()}};return WorkerFile2}(PreloadFile);var WorkerFS=function(BaseFileSystem$$1){function WorkerFS2(worker,deprecateMsg){var this$1=this;if(deprecateMsg===void 0)deprecateMsg=true;BaseFileSystem$$1.call(this);this._callbackConverter=new CallbackArgumentConverter;this._isInitialized=false;this._isReadOnly=false;this._supportLinks=false;this._supportProps=false;this._worker=worker;deprecationMessage(deprecateMsg,WorkerFS2.Name,{worker:"Web Worker instance"});this._worker.addEventListener("message",function(e){var resp=e.data;if(isAPIResponse(resp)){var i22;var args=resp.args;var fixedArgs=new Array(args.length);for(i22=0;i22<fixedArgs.length;i22++){fixedArgs[i22]=this$1._argRemote2Local(args[i22])}this$1._callbackConverter.toLocalArg(resp.cbId).apply(null,fixedArgs)}})}if(BaseFileSystem$$1)WorkerFS2.__proto__=BaseFileSystem$$1;WorkerFS2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);WorkerFS2.prototype.constructor=WorkerFS2;WorkerFS2.Create=function Create(opts,cb){var fs4=new WorkerFS2(opts.worker,false);fs4.initialize(function(){cb(null,fs4)})};WorkerFS2.isAvailable=function isAvailable(){return typeof importScripts!=="undefined"||typeof Worker!=="undefined"};WorkerFS2.attachRemoteListener=function attachRemoteListener(worker){var fdConverter=new FileDescriptorArgumentConverter;function argLocal2Remote(arg,requestArgs,cb){switch(typeof arg){case"object":if(arg instanceof Stats){cb(null,statsLocal2Remote(arg))}else if(arg instanceof ApiError){cb(null,apiErrorLocal2Remote(arg))}else if(arg instanceof BaseFile){cb(null,fdConverter.toRemoteArg(arg,requestArgs[0],requestArgs[1],cb))}else if(arg instanceof FileFlag){cb(null,fileFlagLocal2Remote(arg))}else if(arg instanceof Buffer2){cb(null,bufferLocal2Remote(arg))}else if(arg instanceof Error){cb(null,errorLocal2Remote(arg))}else{cb(null,arg)}break;default:cb(null,arg);break}}function argRemote2Local(arg,fixedRequestArgs){if(!arg){return arg}switch(typeof arg){case"object":if(typeof arg["type"]==="number"){var specialArg=arg;switch(specialArg.type){case SpecialArgType.CB:var cbId=arg.id;return function(){var arguments$1=arguments;var i22;var fixedArgs=new Array(arguments.length);var message,countdown=arguments.length;function abortAndSendError(err){if(countdown>0){countdown=-1;message={browserfsMessage:true,cbId,args:[apiErrorLocal2Remote(err)]};worker.postMessage(message)}}for(i22=0;i22<arguments.length;i22++){(function(i32,arg2){argLocal2Remote(arg2,fixedRequestArgs,function(err,fixedArg){fixedArgs[i32]=fixedArg;if(err){abortAndSendError(err)}else if(--countdown===0){message={browserfsMessage:true,cbId,args:fixedArgs};worker.postMessage(message)}})})(i22,arguments$1[i22])}if(arguments.length===0){message={browserfsMessage:true,cbId,args:fixedArgs};worker.postMessage(message)}};case SpecialArgType.API_ERROR:return apiErrorRemote2Local(specialArg);case SpecialArgType.STATS:return statsRemote2Local(specialArg);case SpecialArgType.FILEFLAG:return fileFlagRemote2Local(specialArg);case SpecialArgType.BUFFER:return bufferRemote2Local(specialArg);case SpecialArgType.ERROR:return errorRemote2Local(specialArg);default:return arg}}else{return arg}default:return arg}}worker.addEventListener("message",function(e){var request=e.data;if(isAPIRequest(request)){var args=request.args,fixedArgs=new Array(args.length);switch(request.method){case"close":case"sync":(function(){var remoteCb=args[1];fdConverter.applyFdAPIRequest(request,function(err){var response={browserfsMessage:true,cbId:remoteCb.id,args:err?[apiErrorLocal2Remote(err)]:[]};worker.postMessage(response)})})();break;case"probe":(function(){var rootFs=_fsMock.getRootFS(),remoteCb=args[1],probeResponse={type:SpecialArgType.PROBE,isReadOnly:rootFs.isReadOnly(),supportsLinks:rootFs.supportsLinks(),supportsProps:rootFs.supportsProps()},response={browserfsMessage:true,cbId:remoteCb.id,args:[probeResponse]};worker.postMessage(response)})();break;default:for(var i22=0;i22<args.length;i22++){fixedArgs[i22]=argRemote2Local(args[i22],fixedArgs)}var rootFS=_fsMock.getRootFS();rootFS[request.method].apply(rootFS,fixedArgs);break}}})};WorkerFS2.prototype.getName=function getName(){return WorkerFS2.Name};WorkerFS2.prototype.initialize=function initialize3(cb){var this$1=this;if(!this._isInitialized){var message={browserfsMessage:true,method:"probe",args:[this._argLocal2Remote(emptyBuffer()),this._callbackConverter.toRemoteArg(function(probeResponse){this$1._isInitialized=true;this$1._isReadOnly=probeResponse.isReadOnly;this$1._supportLinks=probeResponse.supportsLinks;this$1._supportProps=probeResponse.supportsProps;cb()})]};this._worker.postMessage(message)}else{cb()}};WorkerFS2.prototype.isReadOnly=function isReadOnly(){return this._isReadOnly};WorkerFS2.prototype.supportsSynch=function supportsSynch(){return false};WorkerFS2.prototype.supportsLinks=function supportsLinks(){return this._supportLinks};WorkerFS2.prototype.supportsProps=function supportsProps(){return this._supportProps};WorkerFS2.prototype.rename=function rename(oldPath,newPath,cb){this._rpc("rename",arguments)};WorkerFS2.prototype.stat=function stat(p2,isLstat,cb){this._rpc("stat",arguments)};WorkerFS2.prototype.open=function open(p2,flag,mode,cb){this._rpc("open",arguments)};WorkerFS2.prototype.unlink=function unlink(p2,cb){this._rpc("unlink",arguments)};WorkerFS2.prototype.rmdir=function rmdir(p2,cb){this._rpc("rmdir",arguments)};WorkerFS2.prototype.mkdir=function mkdir(p2,mode,cb){this._rpc("mkdir",arguments)};WorkerFS2.prototype.readdir=function readdir(p2,cb){this._rpc("readdir",arguments)};WorkerFS2.prototype.exists=function exists2(p2,cb){this._rpc("exists",arguments)};WorkerFS2.prototype.realpath=function realpath(p2,cache,cb){this._rpc("realpath",arguments)};WorkerFS2.prototype.truncate=function truncate(p2,len,cb){this._rpc("truncate",arguments)};WorkerFS2.prototype.readFile=function readFile2(fname,encoding,flag,cb){this._rpc("readFile",arguments)};WorkerFS2.prototype.writeFile=function writeFile2(fname,data,encoding,flag,mode,cb){this._rpc("writeFile",arguments)};WorkerFS2.prototype.appendFile=function appendFile3(fname,data,encoding,flag,mode,cb){this._rpc("appendFile",arguments)};WorkerFS2.prototype.chmod=function chmod(p2,isLchmod,mode,cb){this._rpc("chmod",arguments)};WorkerFS2.prototype.chown=function chown(p2,isLchown,uid,gid,cb){this._rpc("chown",arguments)};WorkerFS2.prototype.utimes=function utimes(p2,atime,mtime,cb){this._rpc("utimes",arguments)};WorkerFS2.prototype.link=function link(srcpath,dstpath,cb){this._rpc("link",arguments)};WorkerFS2.prototype.symlink=function symlink(srcpath,dstpath,type,cb){this._rpc("symlink",arguments)};WorkerFS2.prototype.readlink=function readlink(p2,cb){this._rpc("readlink",arguments)};WorkerFS2.prototype.syncClose=function syncClose(method,fd,cb){this._worker.postMessage({browserfsMessage:true,method,args:[fd.toRemoteArg(),this._callbackConverter.toRemoteArg(cb)]})};WorkerFS2.prototype._argRemote2Local=function _argRemote2Local(arg){if(!arg){return arg}switch(typeof arg){case"object":if(typeof arg["type"]==="number"){var specialArg=arg;switch(specialArg.type){case SpecialArgType.API_ERROR:return apiErrorRemote2Local(specialArg);case SpecialArgType.FD:var fdArg=specialArg;return new WorkerFile(this,fdArg.path,FileFlag.getFileFlag(fdArg.flag),Stats.fromBuffer(transferrableObjectToBuffer(fdArg.stat)),fdArg.id,transferrableObjectToBuffer(fdArg.data));case SpecialArgType.STATS:return statsRemote2Local(specialArg);case SpecialArgType.FILEFLAG:return fileFlagRemote2Local(specialArg);case SpecialArgType.BUFFER:return bufferRemote2Local(specialArg);case SpecialArgType.ERROR:return errorRemote2Local(specialArg);default:return arg}}else{return arg}default:return arg}};WorkerFS2.prototype._rpc=function _rpc(methodName,args){var this$1=this;var fixedArgs=new Array(args.length);for(var i22=0;i22<args.length;i22++){fixedArgs[i22]=this$1._argLocal2Remote(args[i22])}var message={browserfsMessage:true,method:methodName,args:fixedArgs};this._worker.postMessage(message)};WorkerFS2.prototype._argLocal2Remote=function _argLocal2Remote(arg){if(!arg){return arg}switch(typeof arg){case"object":if(arg instanceof Stats){return statsLocal2Remote(arg)}else if(arg instanceof ApiError){return apiErrorLocal2Remote(arg)}else if(arg instanceof WorkerFile){return arg.toRemoteArg()}else if(arg instanceof FileFlag){return fileFlagLocal2Remote(arg)}else if(arg instanceof Buffer2){return bufferLocal2Remote(arg)}else if(arg instanceof Error){return errorLocal2Remote(arg)}else{return"Unknown argument"}case"function":return this._callbackConverter.toRemoteArg(arg);default:return arg}};return WorkerFS2}(BaseFileSystem);WorkerFS.Name="WorkerFS";WorkerFS.Options={worker:{type:"object",description:"The target worker that you want to connect to, or the current worker if in a worker context.",validator:function(v2,cb){if(v2["postMessage"]){cb()}else{cb(new ApiError(ErrorCode.EINVAL,"option must be a Web Worker instance."))}}}};function asyncDownloadFileModern(p2,type,cb){var req=new XMLHttpRequest;req.open("GET",p2,true);var jsonSupported=true;switch(type){case"buffer":req.responseType="arraybuffer";break;case"json":try{req.responseType="json";jsonSupported=req.responseType==="json"}catch(e){jsonSupported=false}break;default:return cb(new ApiError(ErrorCode.EINVAL,"Invalid download type: "+type))}req.onreadystatechange=function(e){if(req.readyState===4){if(req.status===200){switch(type){case"buffer":return cb(null,req.response?Buffer2.from(req.response):emptyBuffer());case"json":if(jsonSupported){return cb(null,req.response)}else{return cb(null,JSON.parse(req.responseText))}}}else{return cb(new ApiError(req.status,"XHR error."))}}};req.send()}function syncDownloadFileModern(p2,type){var req=new XMLHttpRequest;req.open("GET",p2,false);var data=null;var err=null;req.overrideMimeType("text/plain; charset=x-user-defined");req.onreadystatechange=function(e){if(req.readyState===4){if(req.status===200){switch(type){case"buffer":var text=req.responseText;data=Buffer2.alloc(text.length);for(var i22=0;i22<text.length;i22++){data[i22]=text.charCodeAt(i22)}return;case"json":data=JSON.parse(req.responseText);return}}else{err=new ApiError(req.status,"XHR error.");return}}};req.send();if(err){throw err}return data}function syncDownloadFileIE10(p2,type){var req=new XMLHttpRequest;req.open("GET",p2,false);switch(type){case"buffer":req.responseType="arraybuffer";break;case"json":break;default:throw new ApiError(ErrorCode.EINVAL,"Invalid download type: "+type)}var data;var err;req.onreadystatechange=function(e){if(req.readyState===4){if(req.status===200){switch(type){case"buffer":data=Buffer2.from(req.response);break;case"json":data=JSON.parse(req.response);break}}else{err=new ApiError(req.status,"XHR error.")}}};req.send();if(err){throw err}return data}function getFileSize2(async,p2,cb){var req=new XMLHttpRequest;req.open("HEAD",p2,async);req.onreadystatechange=function(e){if(req.readyState===4){if(req.status===200){try{return cb(null,parseInt(req.getResponseHeader("Content-Length")||"-1",10))}catch(e2){return cb(new ApiError(ErrorCode.EIO,"XHR HEAD error: Could not read content-length."))}}else{return cb(new ApiError(req.status,"XHR HEAD error."))}}};req.send()}var asyncDownloadFile=asyncDownloadFileModern;var syncDownloadFile=isIE&&typeof Blob!=="undefined"?syncDownloadFileIE10:syncDownloadFileModern;function getFileSizeSync(p2){var rv=-1;getFileSize2(false,p2,function(err,size){if(err){throw err}rv=size});return rv}function getFileSizeAsync(p2,cb){getFileSize2(true,p2,cb)}var FileIndex=function FileIndex2(){this._index={};this.addPath("/",new DirInode)};FileIndex.fromListing=function fromListing(listing){var idx=new FileIndex;var rootInode=new DirInode;idx._index["/"]=rootInode;var queue=[["",listing,rootInode]];while(queue.length>0){var inode=void 0;var next=queue.pop();var pwd=next[0];var tree=next[1];var parent=next[2];for(var node in tree){if(tree.hasOwnProperty(node)){var children=tree[node];var name2=pwd+"/"+node;if(children){idx._index[name2]=inode=new DirInode;queue.push([name2,children,inode])}else{inode=new FileInode(new Stats(FileType.FILE,-1,365))}if(parent){parent._ls[node]=inode}}}}return idx};FileIndex.prototype.fileIterator=function fileIterator(cb){var this$1=this;for(var path$$1 in this$1._index){if(this$1._index.hasOwnProperty(path$$1)){var dir=this$1._index[path$$1];var files=dir.getListing();for(var i22=0,list2=files;i22<list2.length;i22+=1){var file=list2[i22];var item=dir.getItem(file);if(isFileInode(item)){cb(item.getData())}}}}};FileIndex.prototype.addPath=function addPath(path$$1,inode){if(!inode){throw new Error("Inode must be specified")}if(path$$1[0]!=="/"){throw new Error("Path must be absolute, got: "+path$$1)}if(this._index.hasOwnProperty(path$$1)){return this._index[path$$1]===inode}var splitPath=this._split_path(path$$1);var dirpath=splitPath[0];var itemname=splitPath[1];var parent=this._index[dirpath];if(parent===void 0&&path$$1!=="/"){parent=new DirInode;if(!this.addPath(dirpath,parent)){return false}}if(path$$1!=="/"){if(!parent.addItem(itemname,inode)){return false}}if(isDirInode(inode)){this._index[path$$1]=inode}return true};FileIndex.prototype.addPathFast=function addPathFast(path$$1,inode){var itemNameMark=path$$1.lastIndexOf("/");var parentPath=itemNameMark===0?"/":path$$1.substring(0,itemNameMark);var itemName=path$$1.substring(itemNameMark+1);var parent=this._index[parentPath];if(parent===void 0){parent=new DirInode;this.addPathFast(parentPath,parent)}if(!parent.addItem(itemName,inode)){return false}if(inode.isDir()){this._index[path$$1]=inode}return true};FileIndex.prototype.removePath=function removePath(path$$1){var this$1=this;var splitPath=this._split_path(path$$1);var dirpath=splitPath[0];var itemname=splitPath[1];var parent=this._index[dirpath];if(parent===void 0){return null}var inode=parent.remItem(itemname);if(inode===null){return null}if(isDirInode(inode)){var children=inode.getListing();for(var i22=0,list2=children;i22<list2.length;i22+=1){var child=list2[i22];this$1.removePath(path$$1+"/"+child)}if(path$$1!=="/"){delete this._index[path$$1]}}return inode};FileIndex.prototype.ls=function ls(path$$1){var item=this._index[path$$1];if(item===void 0){return null}return item.getListing()};FileIndex.prototype.getInode=function getInode(path$$1){var splitPath=this._split_path(path$$1);var dirpath=splitPath[0];var itemname=splitPath[1];var parent=this._index[dirpath];if(parent===void 0){return null}if(dirpath===path$$1){return parent}return parent.getItem(itemname)};FileIndex.prototype._split_path=function _split_path(p2){var dirpath=path.dirname(p2);var itemname=p2.substr(dirpath.length+(dirpath==="/"?0:1));return[dirpath,itemname]};var FileInode=function FileInode2(data){this.data=data};FileInode.prototype.isFile=function isFile(){return true};FileInode.prototype.isDir=function isDir(){return false};FileInode.prototype.getData=function getData(){return this.data};FileInode.prototype.setData=function setData(data){this.data=data};var DirInode=function DirInode2(data){if(data===void 0)data=null;this.data=data;this._ls={}};DirInode.prototype.isFile=function isFile(){return false};DirInode.prototype.isDir=function isDir(){return true};DirInode.prototype.getData=function getData(){return this.data};DirInode.prototype.getStats=function getStats(){return new Stats(FileType.DIRECTORY,4096,365)};DirInode.prototype.getListing=function getListing(){return Object.keys(this._ls)};DirInode.prototype.getItem=function getItem(p2){var item=this._ls[p2];return item?item:null};DirInode.prototype.addItem=function addItem(p2,inode){if(p2 in this._ls){return false}this._ls[p2]=inode;return true};DirInode.prototype.remItem=function remItem(p2){var item=this._ls[p2];if(item===void 0){return null}delete this._ls[p2];return item};function isFileInode(inode){return!!inode&&inode.isFile()}function isDirInode(inode){return!!inode&&inode.isDir()}function tryToString(buff,encoding,cb){try{cb(null,buff.toString(encoding))}catch(e){cb(e)}}var XmlHttpRequest=function(BaseFileSystem$$1){function XmlHttpRequest2(listingUrlOrObj,prefixUrl,deprecateMsg){if(prefixUrl===void 0)prefixUrl="";if(deprecateMsg===void 0)deprecateMsg=true;BaseFileSystem$$1.call(this);if(!listingUrlOrObj){listingUrlOrObj="index.json"}if(prefixUrl.length>0&&prefixUrl.charAt(prefixUrl.length-1)!=="/"){prefixUrl=prefixUrl+"/"}this.prefixUrl=prefixUrl;var listing=null;if(typeof listingUrlOrObj==="string"){listing=this._requestFileSync(listingUrlOrObj,"json");if(!listing){throw new Error("Unable to find listing at URL: ${listingUrlOrObj}")}}else{listing=listingUrlOrObj}deprecationMessage(deprecateMsg,XmlHttpRequest2.Name,{index:typeof listingUrlOrObj==="string"?listingUrlOrObj:"file index as an object",baseUrl:prefixUrl});this._index=FileIndex.fromListing(listing)}if(BaseFileSystem$$1)XmlHttpRequest2.__proto__=BaseFileSystem$$1;XmlHttpRequest2.prototype=Object.create(BaseFileSystem$$1&&BaseFileSystem$$1.prototype);XmlHttpRequest2.prototype.constructor=XmlHttpRequest2;XmlHttpRequest2.Create=function Create(opts,cb){if(opts.index===void 0){opts.index="index.json"}if(typeof opts.index==="string"){XmlHttpRequest2.FromURL(opts.index,cb,opts.baseUrl,false)}else{cb(null,new XmlHttpRequest2(opts.index,opts.baseUrl,false))}};XmlHttpRequest2.isAvailable=function isAvailable(){return typeof XMLHttpRequest!=="undefined"&&XMLHttpRequest!==null};XmlHttpRequest2.FromURL=function FromURL(url2,cb,baseUrl,deprecateMsg){if(baseUrl===void 0)baseUrl=url2.slice(0,url2.lastIndexOf("/")+1);if(deprecateMsg===void 0)deprecateMsg=true;if(deprecateMsg){console.warn(`[XmlHttpRequest] XmlHttpRequest.FromURL() is deprecated and will be removed in the next major release. Please use \'XmlHttpRequest.Create({ index: "`+url2+\'", baseUrl: "\'+baseUrl+`" }, cb)\' instead.`)}asyncDownloadFile(url2,"json",function(e,data){if(e){cb(e)}else{cb(null,new XmlHttpRequest2(data,baseUrl,false))}})};XmlHttpRequest2.prototype.empty=function empty(){this._index.fileIterator(function(file){file.fileData=null})};XmlHttpRequest2.prototype.getName=function getName(){return XmlHttpRequest2.Name};XmlHttpRequest2.prototype.diskSpace=function diskSpace(path$$1,cb){cb(0,0)};XmlHttpRequest2.prototype.isReadOnly=function isReadOnly(){return true};XmlHttpRequest2.prototype.supportsLinks=function supportsLinks(){return false};XmlHttpRequest2.prototype.supportsProps=function supportsProps(){return false};XmlHttpRequest2.prototype.supportsSynch=function supportsSynch(){return true};XmlHttpRequest2.prototype.preloadFile=function preloadFile(path$$1,buffer$$1){var inode=this._index.getInode(path$$1);if(isFileInode(inode)){if(inode===null){throw ApiError.ENOENT(path$$1)}var stats=inode.getData();stats.size=buffer$$1.length;stats.fileData=buffer$$1}else{throw ApiError.EISDIR(path$$1)}};XmlHttpRequest2.prototype.stat=function stat(path$$1,isLstat,cb){var inode=this._index.getInode(path$$1);if(inode===null){return cb(ApiError.ENOENT(path$$1))}var stats;if(isFileInode(inode)){stats=inode.getData();if(stats.size<0){this._requestFileSizeAsync(path$$1,function(e,size){if(e){return cb(e)}stats.size=size;cb(null,stats.clone())})}else{cb(null,stats.clone())}}else if(isDirInode(inode)){stats=inode.getStats();cb(null,stats)}else{cb(ApiError.FileError(ErrorCode.EINVAL,path$$1))}};XmlHttpRequest2.prototype.statSync=function statSync(path$$1,isLstat){var inode=this._index.getInode(path$$1);if(inode===null){throw ApiError.ENOENT(path$$1)}var stats;if(isFileInode(inode)){stats=inode.getData();if(stats.size<0){stats.size=this._requestFileSizeSync(path$$1)}}else if(isDirInode(inode)){stats=inode.getStats()}else{throw ApiError.FileError(ErrorCode.EINVAL,path$$1)}return stats};XmlHttpRequest2.prototype.open=function open(path$$1,flags,mode,cb){if(flags.isWriteable()){return cb(new ApiError(ErrorCode.EPERM,path$$1))}var self2=this;var inode=this._index.getInode(path$$1);if(inode===null){return cb(ApiError.ENOENT(path$$1))}if(isFileInode(inode)){var stats=inode.getData();switch(flags.pathExistsAction()){case ActionType.THROW_EXCEPTION:case ActionType.TRUNCATE_FILE:return cb(ApiError.EEXIST(path$$1));case ActionType.NOP:if(stats.fileData){return cb(null,new NoSyncFile(self2,path$$1,flags,stats.clone(),stats.fileData))}this._requestFileAsync(path$$1,"buffer",function(err,buffer$$1){if(err){return cb(err)}stats.size=buffer$$1.length;stats.fileData=buffer$$1;return cb(null,new NoSyncFile(self2,path$$1,flags,stats.clone(),buffer$$1))});break;default:return cb(new ApiError(ErrorCode.EINVAL,"Invalid FileMode object."))}}else{return cb(ApiError.EISDIR(path$$1))}};XmlHttpRequest2.prototype.openSync=function openSync(path$$1,flags,mode){if(flags.isWriteable()){throw new ApiError(ErrorCode.EPERM,path$$1)}var inode=this._index.getInode(path$$1);if(inode===null){throw ApiError.ENOENT(path$$1)}if(isFileInode(inode)){var stats=inode.getData();switch(flags.pathExistsAction()){case ActionType.THROW_EXCEPTION:case ActionType.TRUNCATE_FILE:throw ApiError.EEXIST(path$$1);case ActionType.NOP:if(stats.fileData){return new NoSyncFile(this,path$$1,flags,stats.clone(),stats.fileData)}var buffer$$1=this._requestFileSync(path$$1,"buffer");stats.size=buffer$$1.length;stats.fileData=buffer$$1;return new NoSyncFile(this,path$$1,flags,stats.clone(),buffer$$1);default:throw new ApiError(ErrorCode.EINVAL,"Invalid FileMode object.")}}else{throw ApiError.EISDIR(path$$1)}};XmlHttpRequest2.prototype.readdir=function readdir(path$$1,cb){try{cb(null,this.readdirSync(path$$1))}catch(e){cb(e)}};XmlHttpRequest2.prototype.readdirSync=function readdirSync(path$$1){var inode=this._index.getInode(path$$1);if(inode===null){throw ApiError.ENOENT(path$$1)}else if(isDirInode(inode)){return inode.getListing()}else{throw ApiError.ENOTDIR(path$$1)}};XmlHttpRequest2.prototype.readFile=function readFile2(fname,encoding,flag,cb){var oldCb=cb;this.open(fname,flag,420,function(err,fd){if(err){return cb(err)}cb=function(err2,arg){fd.close(function(err22){if(!err2){err2=err22}return oldCb(err2,arg)})};var fdCast=fd;var fdBuff=fdCast.getBuffer();if(encoding===null){cb(err,copyingSlice(fdBuff))}else{tryToString(fdBuff,encoding,cb)}})};XmlHttpRequest2.prototype.readFileSync=function readFileSync(fname,encoding,flag){var fd=this.openSync(fname,flag,420);try{var fdCast=fd;var fdBuff=fdCast.getBuffer();if(encoding===null){return copyingSlice(fdBuff)}return fdBuff.toString(encoding)}finally{fd.closeSync()}};XmlHttpRequest2.prototype.getXhrPath=function getXhrPath(filePath){if(filePath.charAt(0)==="/"){filePath=filePath.slice(1)}return this.prefixUrl+filePath};XmlHttpRequest2.prototype._requestFileAsync=function _requestFileAsync(p2,type,cb){asyncDownloadFile(this.getXhrPath(p2),type,cb)};XmlHttpRequest2.prototype._requestFileSync=function _requestFileSync(p2,type){return syncDownloadFile(this.getXhrPath(p2),type)};XmlHttpRequest2.prototype._requestFileSizeAsync=function _requestFileSizeAsync(path$$1,cb){getFileSizeAsync(this.getXhrPath(path$$1),cb)};XmlHttpRequest2.prototype._requestFileSizeSync=function _requestFileSizeSync(path$$1){return getFileSizeSync(this.getXhrPath(path$$1))};return XmlHttpRequest2}(BaseFileSystem);XmlHttpRequest.Name="XmlHttpRequest";XmlHttpRequest.Options={index:{type:["string","object"],optional:true,description:"URL to a file index as a JSON file or the file index object itself, generated with the make_xhrfs_index script. Defaults to `index.json`."},baseUrl:{type:"string",optional:true,description:"Used as the URL prefix for fetched files. Default: Fetch files relative to the index."}};var ExtendedASCII=function ExtendedASCII2(){};ExtendedASCII.str2byte=function str2byte(str3,buf){var length=str3.length>buf.length?buf.length:str3.length;for(var i22=0;i22<length;i22++){var charCode=str3.charCodeAt(i22);if(charCode>127){var charIdx=ExtendedASCII.extendedChars.indexOf(str3.charAt(i22));if(charIdx>-1){charCode=charIdx+128}}buf[charCode]=i22}return length};ExtendedASCII.byte2str=function byte2str(buff){var chars=new Array(buff.length);for(var i22=0;i22<buff.length;i22++){var charCode=buff[i22];if(charCode>127){chars[i22]=ExtendedASCII.extendedChars[charCode-128]}else{chars[i22]=String.fromCharCode(charCode)}}return chars.join("")};ExtendedASCII.byteLength=function byteLength(str3){return str3.length};ExtendedASCII.extendedChars=["\\xC7","\\xFC","\\xE9","\\xE2","\\xE4","\\xE0","\\xE5","\\xE7","\\xEA","\\xEB","\\xE8","\\xEF","\\xEE","\\xEC","\\xC4","\\xC5","\\xC9","\\xE6","\\xC6","\\xF4","\\xF6","\\xF2","\\xFB","\\xF9","\\xFF","\\xD6","\\xDC","\\xF8","\\xA3","\\xD8","\\xD7","\\u0192","\\xE1","\\xED","\\xF3","\\xFA","\\xF1","\\xD1","\\xAA","\\xBA","\\xBF","\\xAE","\\xAC","\\xBD","\\xBC","\\xA1","\\xAB","\\xBB","_","_","_","\\xA6","\\xA6","\\xC1","\\xC2","\\xC0","\\xA9","\\xA6","\\xA6","+","+","\\xA2","\\xA5","+","+","-","-","+","-","+","\\xE3","\\xC3","+","+","-","-","\\xA6","-","+","\\xA4","\\xF0","\\xD0","\\xCA","\\xCB","\\xC8","i","\\xCD","\\xCE","\\xCF","+","+","_","_","\\xA6","\\xCC","_","\\xD3","\\xDF","\\xD4","\\xD2","\\xF5","\\xD5","\\xB5","\\xFE","\\xDE","\\xDA","\\xDB","\\xD9","\\xFD","\\xDD","\\xAF","\\xB4","\\xAD","\\xB1","_","\\xBE","\\xB6","\\xA7","\\xF7","\\xB8","\\xB0","\\xA8","\\xB7","\\xB9","\\xB3","\\xB2","_"," "];var inflateRaw=__webpack_require__(31).inflateRaw;var decompressionMethods={};var ExternalFileAttributeType;(function(ExternalFileAttributeType2){ExternalFileAttributeType2[ExternalFileAttributeType2["MSDOS"]=0]="MSDOS";ExternalFileAttributeType2[ExternalFileAttributeType2["AMIGA"]=1]="AMIGA";ExternalFileAttributeType2[ExternalFileAttributeType2["OPENVMS"]=2]="OPENVMS";ExternalFileAttributeType2[ExternalFileAttributeType2["UNIX"]=3]="UNIX";ExternalFileAttributeType2[ExternalFileAttributeType2["VM_CMS"]=4]="VM_CMS";ExternalFileAttributeType2[ExternalFileAttributeType2["ATARI_ST"]=5]="ATARI_ST";ExternalFileAttributeType2[ExternalFileAttributeType2["OS2_HPFS"]=6]="OS2_HPFS";ExternalFileAttributeType2[ExternalFileAttributeType2["MAC"]=7]="MAC";ExternalFileAttributeType2[ExternalFileAttributeType2["Z_SYSTEM"]=8]="Z_SYSTEM";ExternalFileAttributeType2[ExternalFileAttributeType2["CP_M"]=9]="CP_M";ExternalFileAttributeType2[ExternalFileAttributeType2["NTFS"]=10]="NTFS";ExternalFileAttributeType2[ExternalFileAttributeType2["MVS"]=11]="MVS";ExternalFileAttributeType2[ExternalFileAttributeType2["VSE"]=12]="VSE";ExternalFileAttributeType2[ExternalFileAttributeType2["ACORN_RISC"]=13]="ACORN_RISC";ExternalFileAttributeType2[ExternalFileAttributeType2["VFAT"]=14]="VFAT";ExternalFileAttributeType2[ExternalFileAttributeType2["ALT_MVS"]=15]="ALT_MVS";ExternalFileAttributeType2[ExternalFileAttributeType2["BEOS"]=16]="BEOS";ExternalFileAttributeType2[ExternalFileAttributeType2["TANDEM"]=17]="TANDEM";ExternalFileAttributeType2[ExternalFileAttributeType2["OS_400"]=18]="OS_400";ExternalFileAttributeType2[ExternalFileAttributeType2["OSX"]=19]="OSX"})(ExternalFileAttributeType||(ExternalFileAttributeType={}));var CompressionMethod;(function(CompressionMethod2){CompressionMethod2[CompressionMethod2["STORED"]=0]="STORED";CompressionMethod2[CompressionMethod2["SHRUNK"]=1]="SHRUNK";CompressionMethod2[CompressionMethod2["REDUCED_1"]=2]="REDUCED_1";CompressionMethod2[CompressionMethod2["REDUCED_2"]=3]="REDUCED_2";CompressionMethod2[CompressionMethod2["REDUCED_3"]=4]="REDUCED_3";CompressionMethod2[CompressionMethod2["REDUCED_4"]=5]="REDUCED_4";CompressionMethod2[CompressionMethod2["IMPLODE"]=6]="IMPLODE";CompressionMethod2[CompressionMethod2["DEFLATE"]=8]="DEFLATE";CompressionMethod2[CompressionMethod2["DEFLATE64"]=9]="DEFLATE64";CompressionMethod2[CompressionMethod2["TERSE_OLD"]=10]="TERSE_OLD";CompressionMethod2[CompressionMethod2["BZIP2"]=12]="BZIP2";CompressionMethod2[CompressionMethod2["LZMA"]=14]="LZMA";CompressionMethod2[CompressionMethod2["TERSE_NEW"]=18]="TERSE_NEW";CompressionMethod2[CompressionMethod2["LZ77"]=19]="LZ77";CompressionMethod2[CompressionMethod2["WAVPACK"]=97]="WAVPACK";CompressionMethod2[CompressionMethod2["PPMD"]=98]="PPMD"})(CompressionMethod||(CompressionMethod={}));function msdos2date(time,date){var day=date&31;var month=(date>>5&15)-1;var year=(date>>9)+1980;var second=time&31;var minute=time>>5&63;var hour=time>>11;return new Date(year,month,day,hour,minute,second)}function safeToString(buff,useUTF8,start,length){if(length===0){return""}else if(useUTF8){return buff.toString("utf8",start,start+length)}else{return ExtendedASCII.byte2str(buff.slice(start,start+length))}}var FileHeader=function FileHeader2(data){this.data=data;if(data.readUInt32LE(0)!==67324752){throw new ApiError(ErrorCode.EINVAL,"Invalid Zip file: Local file header has invalid signature: "+this.data.readUInt32LE(0))}};FileHeader.prototype.versionNeeded=function versionNeeded(){return this.data.readUInt16LE(4)};FileHeader.prototype.flags=function flags(){return this.data.readUInt16LE(6)};FileHeader.prototype.compressionMethod=function compressionMethod(){return this.data.readUInt16LE(8)};FileHeader.prototype.lastModFileTime=function lastModFileTime(){return msdos2date(this.data.readUInt16LE(10),this.data.readUInt16LE(12))};FileHeader.prototype.rawLastModFileTime=function rawLastModFileTime(){return this.data.readUInt32LE(10)};FileHeader.prototype.crc32=function crc32(){return this.data.readUInt32LE(14)};FileHeader.prototype.fileNameLength=function fileNameLength(){return this.data.readUInt16LE(26)};FileHeader.prototype.extraFieldLength=function extraFieldLength(){return this.data.readUInt16LE(28)};FileHeader.prototype.fileName=function fileName(){return safeToString(this.data,this.useUTF8(),30,this.fileNameLength())};FileHeader.prototype.extraField=function extraField(){var start=30+this.fileNameLength();return this.data.slice(start,start+this.extraFieldLength())};FileHeader.prototype.totalSize=function totalSize(){return 30+this.fileNameLength()+this.extraFieldLength()};FileHeader.prototype.useUTF8=function useUTF8(){return(this.flags()&2048)===2048};var FileData=function FileData2(header,record,data){this.header=header;this.record=record;this.data=data};FileData.prototype.decompress=function decompress(){var compressionMethod=this.header.compressionMethod();var fcn=decompressionMethods[compressionMethod];if(fcn){return fcn(this.data,this.record.compressedSize(),this.record.uncompressedSize(),this.record.flag())}else{var name2=CompressionMethod[compressionMethod];if(!name2){name2="Unknown: "+compressionMethod}throw new ApiError(ErrorCode.EINVAL,"Invalid compression method on file \'"+this.header.fileName()+"\': "+name2)}};FileData.prototype.getHeader=function getHeader(){return this.header};FileData.prototype.getRecord=function getRecord(){return this.record};FileData.prototype.getRawData=function getRawData(){return this.data};var DataDescriptor=function DataDescriptor2(data){this.data=data};DataDescriptor.prototype.crc32=function crc32(){return this.data.readUInt32LE(0)};DataDescriptor.prototype.compressedSize=function compressedSize(){return this.data.readUInt32LE(4)};DataDescriptor.prototype.uncompressedSize=function uncompressedSize(){return this.data.readUInt32LE(8)};var ArchiveExtraDataRecord=function ArchiveExtraDataRecord2(data){this.data=data;if(this.data.readUInt32LE(0)!==134630224){throw new ApiError(ErrorCode.EINVAL,"Invalid archive extra data record signature: "+this.data.readUInt32LE(0))}};ArchiveExtraDataRecord.prototype.length=function length(){return this.data.readUInt32LE(4)};ArchiveExtraDataRecord.prototype.extraFieldData=function extraFieldData(){return this.data.slice(8,8+this.length())};var DigitalSignature=function DigitalSignature2(data){this.data=data;if(this.data.readUInt32LE(0)!==84233040){throw new ApiError(ErrorCode.EINVAL,"Invalid digital signature signature: "+this.data.readUInt32LE(0))}};DigitalSignature.prototype.size=function size(){return this.data.readUInt16LE(4)};DigitalSignature.prototype.signatureData=function signatureData(){return this.data.slice(6,6+this.size())};var CentralDirectory=function CentralDirectory2(zipData,data){this.zipData=zipData;this.data=data;if(this.data.readUInt32LE(0)!==33639248){throw new ApiError(ErrorCode.EINVAL,"Invalid Zip file: Central directory record has invalid signature: "+this.data.readUInt32LE(0))}this._filename=this.produceFilename()};CentralDirectory.prototype.versionMadeBy=function versionMadeBy(){return this.data.readUInt16LE(4)};CentralDirectory.prototype.versionNeeded=function versionNeeded(){return this.data.readUInt16LE(6)};CentralDirectory.prototype.flag=function flag(){return this.data.readUInt16LE(8)};CentralDirectory.prototype.compressionMethod=function compressionMethod(){return this.data.readUInt16LE(10)};CentralDirectory.prototype.lastModFileTime=function lastModFileTime(){return msdos2date(this.data.readUInt16LE(12),this.data.readUInt16LE(14))};CentralDirectory.prototype.rawLastModFileTime=function rawLastModFileTime(){return this.data.readUInt32LE(12)};CentralDirectory.prototype.crc32=function crc32(){return this.data.readUInt32LE(16)};CentralDirectory.prototype.compressedSize=function compressedSize(){return this.data.readUInt32LE(20)};CentralDirectory.prototype.uncompressedSize=function uncompressedSize(){return this.data.readUInt32LE(24)};CentralDirectory.prototype.fileNameLength=function fileNameLength(){return this.data.readUInt16LE(28)};CentralDirectory.prototype.extraFieldLength=function extraFieldLength(){return this.data.readUInt16LE(30)};CentralDirectory.prototype.fileCommentLength=function fileCommentLength(){return this.data.readUInt16LE(32)};CentralDirectory.prototype.diskNumberStart=function diskNumberStart(){return this.data.readUInt16LE(34)};CentralDirectory.prototype.internalAttributes=function internalAttributes(){return this.data.readUInt16LE(36)};CentralDirectory.prototype.externalAttributes=function externalAttributes(){return this.data.readUInt32LE(38)};CentralDirectory.prototype.headerRelativeOffset=function headerRelativeOffset(){return this.data.readUInt32LE(42)};CentralDirectory.prototype.produceFilename=function produceFilename(){var fileName=safeToString(this.data,this.useUTF8(),46,this.fileNameLength());return fileName.replace(/\\\\/g,"/")};CentralDirectory.prototype.fileName=function fileName(){return this._filename};CentralDirectory.prototype.rawFileName=function rawFileName(){return this.data.slice(46,46+this.fileNameLength())};CentralDirectory.prototype.extraField=function extraField(){var start=44+this.fileNameLength();return this.data.slice(start,start+this.extraFieldLength())};CentralDirectory.prototype.fileComment=function fileComment(){var start=46+this.fileNameLength()+this.extraFieldLength();return safeToString(this.data,this.useUTF8(),start,this.fileCommentLength())};CentralDirectory.prototype.rawFileComment=function rawFileComment(){var start=46+this.fileNameLength()+this.extraFieldLength();return this.data.slice(start,start+this.fileCommentLength())};CentralDirectory.prototype.totalSize=function totalSize(){return 46+this.fileNameLength()+this.extraFieldLength()+this.fileCommentLength()};CentralDirectory.prototype.isDirectory=function isDirectory(){var fileName=this.fileName();return(this.externalAttributes()&16?true:false)||fileName.charAt(fileName.length-1)==="/"};CentralDirectory.prototype.isFile=function isFile(){return!this.isDirectory()};CentralDirectory.prototype.useUTF8=function useUTF8(){return(this.flag()&2048)===2048};CentralDirectory.prototype.isEncrypted=function isEncrypted(){return(this.flag()&1)===1};CentralDirectory.prototype.getFileData=function getFileData(){var start=this.headerRelativeOffset();var header=new FileHeader(this.zipData.slice(start));return new FileData(header,this,this.zipData.slice(start+header.totalSize()))};CentralDirectory.prototype.getData=function getData(){return this.getFileData().decompress()};CentralDirectory.prototype.getRawData=function getRawData(){return this.getFileData().getRawData()};CentralDirectory.prototype.getStats=function getStats(){return new Stats(FileType.FILE,this.uncompressedSize(),365,new Date,this.lastModFileTime())};var EndOfCentralDirectory=function EndOfCentralDirectory2(data){this.data=data;if(this.data.readUInt32LE(0)!==101010256){throw new ApiError(ErrorCode.EINVAL,"Invalid Zip file: End of central directory record has invalid signature: "+this.data.readUInt32LE(0))}};EndOfCentralDirectory.prototype.diskNumber=function diskNumber(){return this.data.readUInt16LE(4)};EndOfCentralDirectory.prototype.cdDiskNumber=function cdDiskNumber(){return this.data.readUInt16LE(6)};EndOfCentralDirectory.prototype.cdDiskEntryCount=function cdDiskEntryCount(){return this.data.readUInt16LE(8)};EndOfCentralDirectory.prototype.cdTotalEntryCount=function cdTotalEntryCount(){return this.data.readUInt16LE(10)};EndOfCentralDirectory.prototype.cdSize=function cdSize(){return this.data.readUInt32LE(12)};EndOfCentralDirectory.prototype.cdOffset=function cdOffset(){return this.data.readUInt32LE(16)};EndOfCentralDirectory.prototype.cdZipCommentLength=function cdZipCommentLength(){return this.data.readUInt16LE(20)};EndOfCentralDirectory.prototype.cdZipComment=function cdZipComment(){return safeToString(this.data,true,22,this.cdZipCommentLength())};EndOfCentralDirectory.prototype.rawCdZipComment=function rawCdZipComment(){return this.data.slice(22,22+this.cdZipCommentLength())};var ZipTOC=function ZipTOC2(index,directoryEntries,eocd,data){this.index=index;this.directoryEntries=directoryEntries;this.eocd=eocd;this.data=data};var ZipFS=function(SynchronousFileSystem$$1){function ZipFS2(input,name2,deprecateMsg){if(name2===void 0)name2="";if(deprecateMsg===void 0)deprecateMsg=true;SynchronousFileSystem$$1.call(this);this.name=name2;this._index=new FileIndex;this._directoryEntries=[];this._eocd=null;deprecationMessage(deprecateMsg,ZipFS2.Name,{zipData:"zip data as a Buffer",name:name2});if(input instanceof ZipTOC){this._index=input.index;this._directoryEntries=input.directoryEntries;this._eocd=input.eocd;this.data=input.data}else{this.data=input;this.populateIndex()}}if(SynchronousFileSystem$$1)ZipFS2.__proto__=SynchronousFileSystem$$1;ZipFS2.prototype=Object.create(SynchronousFileSystem$$1&&SynchronousFileSystem$$1.prototype);ZipFS2.prototype.constructor=ZipFS2;ZipFS2.Create=function Create(opts,cb){try{ZipFS2.computeIndex(opts.zipData,function(zipTOC){var fs4=new ZipFS2(zipTOC,opts.name,false);cb(null,fs4)},false)}catch(e){cb(e)}};ZipFS2.isAvailable=function isAvailable(){return true};ZipFS2.RegisterDecompressionMethod=function RegisterDecompressionMethod(m,fcn){decompressionMethods[m]=fcn};ZipFS2.computeIndex=function computeIndex(data,cb,deprecateMsg){if(deprecateMsg===void 0)deprecateMsg=true;if(deprecateMsg){console.warn("[ZipFS] ZipFS.computeIndex is now deprecated, and will be removed in the next major release. Please update your code to use \'ZipFS.Create({ zipData: zip file as a Buffer}, cb)\' instead.")}var index=new FileIndex;var eocd=ZipFS2.getEOCD(data);if(eocd.diskNumber()!==eocd.cdDiskNumber()){throw new ApiError(ErrorCode.EINVAL,"ZipFS does not support spanned zip files.")}var cdPtr=eocd.cdOffset();if(cdPtr===4294967295){throw new ApiError(ErrorCode.EINVAL,"ZipFS does not support Zip64.")}var cdEnd=cdPtr+eocd.cdSize();ZipFS2.computeIndexResponsive(data,index,cdPtr,cdEnd,cb,[],eocd)};ZipFS2.getEOCD=function getEOCD(data){var startOffset=22;var endOffset=Math.min(startOffset+65535,data.length-1);for(var i22=startOffset;i22<endOffset;i22++){if(data.readUInt32LE(data.length-i22)===101010256){return new EndOfCentralDirectory(data.slice(data.length-i22))}}throw new ApiError(ErrorCode.EINVAL,"Invalid ZIP file: Could not locate End of Central Directory signature.")};ZipFS2.addToIndex=function addToIndex(cd,index){var filename=cd.fileName();if(filename.charAt(0)==="/"){throw new Error("WHY IS THIS ABSOLUTE")}if(filename.charAt(filename.length-1)==="/"){filename=filename.substr(0,filename.length-1)}if(cd.isDirectory()){index.addPathFast("/"+filename,new DirInode(cd))}else{index.addPathFast("/"+filename,new FileInode(cd))}};ZipFS2.computeIndexResponsive=function computeIndexResponsive(data,index,cdPtr,cdEnd,cb,cdEntries,eocd){if(cdPtr<cdEnd){var count=0;while(count++<200&&cdPtr<cdEnd){var cd=new CentralDirectory(data,data.slice(cdPtr));ZipFS2.addToIndex(cd,index);cdPtr+=cd.totalSize();cdEntries.push(cd)}setImmediate$3(function(){ZipFS2.computeIndexResponsive(data,index,cdPtr,cdEnd,cb,cdEntries,eocd)})}else{cb(new ZipTOC(index,cdEntries,eocd,data))}};ZipFS2.prototype.getName=function getName(){return ZipFS2.Name+(this.name!==""?" "+this.name:"")};ZipFS2.prototype.getCentralDirectoryEntry=function getCentralDirectoryEntry(path$$1){var inode=this._index.getInode(path$$1);if(inode===null){throw ApiError.ENOENT(path$$1)}if(isFileInode(inode)){return inode.getData()}else if(isDirInode(inode)){return inode.getData()}else{throw ApiError.EPERM("Invalid inode: "+inode)}};ZipFS2.prototype.getCentralDirectoryEntryAt=function getCentralDirectoryEntryAt(index){var dirEntry=this._directoryEntries[index];if(!dirEntry){throw new RangeError("Invalid directory index: "+index+".")}return dirEntry};ZipFS2.prototype.getNumberOfCentralDirectoryEntries=function getNumberOfCentralDirectoryEntries(){return this._directoryEntries.length};ZipFS2.prototype.getEndOfCentralDirectory=function getEndOfCentralDirectory(){return this._eocd};ZipFS2.prototype.diskSpace=function diskSpace(path$$1,cb){cb(this.data.length,0)};ZipFS2.prototype.isReadOnly=function isReadOnly(){return true};ZipFS2.prototype.supportsLinks=function supportsLinks(){return false};ZipFS2.prototype.supportsProps=function supportsProps(){return false};ZipFS2.prototype.supportsSynch=function supportsSynch(){return true};ZipFS2.prototype.statSync=function statSync(path$$1,isLstat){var inode=this._index.getInode(path$$1);if(inode===null){throw ApiError.ENOENT(path$$1)}var stats;if(isFileInode(inode)){stats=inode.getData().getStats()}else if(isDirInode(inode)){stats=inode.getStats()}else{throw new ApiError(ErrorCode.EINVAL,"Invalid inode.")}return stats};ZipFS2.prototype.openSync=function openSync(path$$1,flags,mode){if(flags.isWriteable()){throw new ApiError(ErrorCode.EPERM,path$$1)}var inode=this._index.getInode(path$$1);if(!inode){throw ApiError.ENOENT(path$$1)}else if(isFileInode(inode)){var cdRecord=inode.getData();var stats=cdRecord.getStats();switch(flags.pathExistsAction()){case ActionType.THROW_EXCEPTION:case ActionType.TRUNCATE_FILE:throw ApiError.EEXIST(path$$1);case ActionType.NOP:return new NoSyncFile(this,path$$1,flags,stats,cdRecord.getData());default:throw new ApiError(ErrorCode.EINVAL,"Invalid FileMode object.")}}else{throw ApiError.EISDIR(path$$1)}};ZipFS2.prototype.readdirSync=function readdirSync(path$$1){var inode=this._index.getInode(path$$1);if(!inode){throw ApiError.ENOENT(path$$1)}else if(isDirInode(inode)){return inode.getListing()}else{throw ApiError.ENOTDIR(path$$1)}};ZipFS2.prototype.readFileSync=function readFileSync(fname,encoding,flag){var fd=this.openSync(fname,flag,420);try{var fdCast=fd;var fdBuff=fdCast.getBuffer();if(encoding===null){return copyingSlice(fdBuff)}return fdBuff.toString(encoding)}finally{fd.closeSync()}};ZipFS2.prototype.populateIndex=function populateIndex(){var this$1=this;var eocd=this._eocd=ZipFS2.getEOCD(this.data);if(eocd.diskNumber()!==eocd.cdDiskNumber()){throw new ApiError(ErrorCode.EINVAL,"ZipFS does not support spanned zip files.")}var cdPtr=eocd.cdOffset();if(cdPtr===4294967295){throw new ApiError(ErrorCode.EINVAL,"ZipFS does not support Zip64.")}var cdEnd=cdPtr+eocd.cdSize();while(cdPtr<cdEnd){var cd=new CentralDirectory(this$1.data,this$1.data.slice(cdPtr));cdPtr+=cd.totalSize();ZipFS2.addToIndex(cd,this$1._index);this$1._directoryEntries.push(cd)}};return ZipFS2}(SynchronousFileSystem);ZipFS.Name="ZipFS";ZipFS.Options={zipData:{type:"object",description:"The zip file as a Buffer object.",validator:bufferValidator},name:{type:"string",optional:true,description:"The name of the zip file (optional)."}};ZipFS.CompressionMethod=CompressionMethod;ZipFS.RegisterDecompressionMethod(CompressionMethod.DEFLATE,function(data,compressedSize,uncompressedSize){return arrayish2Buffer(inflateRaw(data.slice(0,compressedSize),{chunkSize:uncompressedSize}))});ZipFS.RegisterDecompressionMethod(CompressionMethod.STORED,function(data,compressedSize,uncompressedSize){return copyingSlice(data,0,uncompressedSize)});var rockRidgeIdentifier="IEEE_P1282";function getASCIIString(data,startIndex,length){return data.toString("ascii",startIndex,startIndex+length).trim()}function getJolietString(data,startIndex,length){if(length===1){return String.fromCharCode(data[startIndex])}var pairs=Math.floor(length/2);var chars=new Array(pairs);for(var i22=0;i22<pairs;i22++){var pos=startIndex+(i22<<1);chars[i22]=String.fromCharCode(data[pos+1]|data[pos]<<8)}return chars.join("")}function getDate(data,startIndex){var year=parseInt(getASCIIString(data,startIndex,4),10);var mon=parseInt(getASCIIString(data,startIndex+4,2),10);var day=parseInt(getASCIIString(data,startIndex+6,2),10);var hour=parseInt(getASCIIString(data,startIndex+8,2),10);var min=parseInt(getASCIIString(data,startIndex+10,2),10);var sec=parseInt(getASCIIString(data,startIndex+12,2),10);var hundrethsSec=parseInt(getASCIIString(data,startIndex+14,2),10);return new Date(year,mon,day,hour,min,sec,hundrethsSec*100)}function getShortFormDate(data,startIndex){var yearsSince1900=data[startIndex];var month=data[startIndex+1];var day=data[startIndex+2];var hour=data[startIndex+3];var minute=data[startIndex+4];var second=data[startIndex+5];return new Date(yearsSince1900,month-1,day,hour,minute,second)}function constructSystemUseEntry(bigData,i22){var data=bigData.slice(i22);var sue=new SystemUseEntry(data);switch(sue.signatureWord()){case 17221:return new CEEntry(data);case 20548:return new PDEntry(data);case 21328:return new SPEntry(data);case 21332:return new STEntry(data);case 17746:return new EREntry(data);case 17747:return new ESEntry(data);case 20568:return new PXEntry(data);case 20558:return new PNEntry(data);case 21324:return new SLEntry(data);case 20045:return new NMEntry(data);case 17228:return new CLEntry(data);case 20556:return new PLEntry(data);case 21061:return new REEntry(data);case 21574:return new TFEntry(data);case 21318:return new SFEntry(data);case 21074:return new RREntry(data);default:return sue}}function constructSystemUseEntries(data,i22,len,isoData){len=len-4;var entries=new Array;while(i22<len){var entry=constructSystemUseEntry(data,i22);var length=entry.length();if(length===0){return entries}i22+=length;if(entry instanceof STEntry){break}if(entry instanceof CEEntry){entries=entries.concat(entry.getEntries(isoData))}else{entries.push(entry)}}return entries}var VolumeDescriptor=function VolumeDescriptor2(data){this._data=data};VolumeDescriptor.prototype.type=function type(){return this._data[0]};VolumeDescriptor.prototype.standardIdentifier=function standardIdentifier(){return getASCIIString(this._data,1,5)};VolumeDescriptor.prototype.version=function version(){return this._data[6]};VolumeDescriptor.prototype.data=function data(){return this._data.slice(7,2048)};var PrimaryOrSupplementaryVolumeDescriptor=function(VolumeDescriptor2){function PrimaryOrSupplementaryVolumeDescriptor2(data){VolumeDescriptor2.call(this,data);this._root=null}if(VolumeDescriptor2)PrimaryOrSupplementaryVolumeDescriptor2.__proto__=VolumeDescriptor2;PrimaryOrSupplementaryVolumeDescriptor2.prototype=Object.create(VolumeDescriptor2&&VolumeDescriptor2.prototype);PrimaryOrSupplementaryVolumeDescriptor2.prototype.constructor=PrimaryOrSupplementaryVolumeDescriptor2;PrimaryOrSupplementaryVolumeDescriptor2.prototype.systemIdentifier=function systemIdentifier(){return this._getString32(8)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeIdentifier=function volumeIdentifier(){return this._getString32(40)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeSpaceSize=function volumeSpaceSize(){return this._data.readUInt32LE(80)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeSetSize=function volumeSetSize(){return this._data.readUInt16LE(120)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeSequenceNumber=function volumeSequenceNumber(){return this._data.readUInt16LE(124)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.logicalBlockSize=function logicalBlockSize(){return this._data.readUInt16LE(128)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.pathTableSize=function pathTableSize(){return this._data.readUInt32LE(132)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.locationOfTypeLPathTable=function locationOfTypeLPathTable(){return this._data.readUInt32LE(140)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.locationOfOptionalTypeLPathTable=function locationOfOptionalTypeLPathTable(){return this._data.readUInt32LE(144)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.locationOfTypeMPathTable=function locationOfTypeMPathTable(){return this._data.readUInt32BE(148)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.locationOfOptionalTypeMPathTable=function locationOfOptionalTypeMPathTable(){return this._data.readUInt32BE(152)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.rootDirectoryEntry=function rootDirectoryEntry(isoData){if(this._root===null){this._root=this._constructRootDirectoryRecord(this._data.slice(156));this._root.rootCheckForRockRidge(isoData)}return this._root};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeSetIdentifier=function volumeSetIdentifier(){return this._getString(190,128)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.publisherIdentifier=function publisherIdentifier(){return this._getString(318,128)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.dataPreparerIdentifier=function dataPreparerIdentifier(){return this._getString(446,128)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.applicationIdentifier=function applicationIdentifier(){return this._getString(574,128)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.copyrightFileIdentifier=function copyrightFileIdentifier(){return this._getString(702,38)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.abstractFileIdentifier=function abstractFileIdentifier(){return this._getString(740,36)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.bibliographicFileIdentifier=function bibliographicFileIdentifier(){return this._getString(776,37)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeCreationDate=function volumeCreationDate(){return getDate(this._data,813)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeModificationDate=function volumeModificationDate(){return getDate(this._data,830)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeExpirationDate=function volumeExpirationDate(){return getDate(this._data,847)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.volumeEffectiveDate=function volumeEffectiveDate(){return getDate(this._data,864)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.fileStructureVersion=function fileStructureVersion(){return this._data[881]};PrimaryOrSupplementaryVolumeDescriptor2.prototype.applicationUsed=function applicationUsed(){return this._data.slice(883,883+512)};PrimaryOrSupplementaryVolumeDescriptor2.prototype.reserved=function reserved(){return this._data.slice(1395,1395+653)};PrimaryOrSupplementaryVolumeDescriptor2.prototype._getString32=function _getString32(idx){return this._getString(idx,32)};return PrimaryOrSupplementaryVolumeDescriptor2}(VolumeDescriptor);var PrimaryVolumeDescriptor=function(PrimaryOrSupplementaryVolumeDescriptor2){function PrimaryVolumeDescriptor2(data){PrimaryOrSupplementaryVolumeDescriptor2.call(this,data);if(this.type()!==1){throw new ApiError(ErrorCode.EIO,"Invalid primary volume descriptor.")}}if(PrimaryOrSupplementaryVolumeDescriptor2)PrimaryVolumeDescriptor2.__proto__=PrimaryOrSupplementaryVolumeDescriptor2;PrimaryVolumeDescriptor2.prototype=Object.create(PrimaryOrSupplementaryVolumeDescriptor2&&PrimaryOrSupplementaryVolumeDescriptor2.prototype);PrimaryVolumeDescriptor2.prototype.constructor=PrimaryVolumeDescriptor2;PrimaryVolumeDescriptor2.prototype.name=function name2(){return"ISO9660"};PrimaryVolumeDescriptor2.prototype._constructRootDirectoryRecord=function _constructRootDirectoryRecord(data){return new ISODirectoryRecord(data,-1)};PrimaryVolumeDescriptor2.prototype._getString=function _getString(idx,len){return this._getString(idx,len)};return PrimaryVolumeDescriptor2}(PrimaryOrSupplementaryVolumeDescriptor);var SupplementaryVolumeDescriptor=function(PrimaryOrSupplementaryVolumeDescriptor2){function SupplementaryVolumeDescriptor2(data){PrimaryOrSupplementaryVolumeDescriptor2.call(this,data);if(this.type()!==2){throw new ApiError(ErrorCode.EIO,"Invalid supplementary volume descriptor.")}var escapeSequence=this.escapeSequence();var third=escapeSequence[2];if(escapeSequence[0]!==37||escapeSequence[1]!==47||third!==64&&third!==67&&third!==69){throw new ApiError(ErrorCode.EIO,"Unrecognized escape sequence for SupplementaryVolumeDescriptor: "+escapeSequence.toString())}}if(PrimaryOrSupplementaryVolumeDescriptor2)SupplementaryVolumeDescriptor2.__proto__=PrimaryOrSupplementaryVolumeDescriptor2;SupplementaryVolumeDescriptor2.prototype=Object.create(PrimaryOrSupplementaryVolumeDescriptor2&&PrimaryOrSupplementaryVolumeDescriptor2.prototype);SupplementaryVolumeDescriptor2.prototype.constructor=SupplementaryVolumeDescriptor2;SupplementaryVolumeDescriptor2.prototype.name=function name2(){return"Joliet"};SupplementaryVolumeDescriptor2.prototype.escapeSequence=function escapeSequence(){return this._data.slice(88,120)};SupplementaryVolumeDescriptor2.prototype._constructRootDirectoryRecord=function _constructRootDirectoryRecord(data){return new JolietDirectoryRecord(data,-1)};SupplementaryVolumeDescriptor2.prototype._getString=function _getString(idx,len){return getJolietString(this._data,idx,len)};return SupplementaryVolumeDescriptor2}(PrimaryOrSupplementaryVolumeDescriptor);var DirectoryRecord=function DirectoryRecord2(data,rockRidgeOffset){this._suEntries=null;this._fileOrDir=null;this._data=data;this._rockRidgeOffset=rockRidgeOffset};DirectoryRecord.prototype.hasRockRidge=function hasRockRidge(){return this._rockRidgeOffset>-1};DirectoryRecord.prototype.getRockRidgeOffset=function getRockRidgeOffset(){return this._rockRidgeOffset};DirectoryRecord.prototype.rootCheckForRockRidge=function rootCheckForRockRidge(isoData){var dir=this.getDirectory(isoData);this._rockRidgeOffset=dir.getDotEntry(isoData)._getRockRidgeOffset(isoData);if(this._rockRidgeOffset>-1){this._fileOrDir=null}};DirectoryRecord.prototype.length=function length(){return this._data[0]};DirectoryRecord.prototype.extendedAttributeRecordLength=function extendedAttributeRecordLength(){return this._data[1]};DirectoryRecord.prototype.lba=function lba(){return this._data.readUInt32LE(2)*2048};DirectoryRecord.prototype.dataLength=function dataLength(){return this._data.readUInt32LE(10)};DirectoryRecord.prototype.recordingDate=function recordingDate(){return getShortFormDate(this._data,18)};DirectoryRecord.prototype.fileFlags=function fileFlags(){return this._data[25]};DirectoryRecord.prototype.fileUnitSize=function fileUnitSize(){return this._data[26]};DirectoryRecord.prototype.interleaveGapSize=function interleaveGapSize(){return this._data[27]};DirectoryRecord.prototype.volumeSequenceNumber=function volumeSequenceNumber(){return this._data.readUInt16LE(28)};DirectoryRecord.prototype.identifier=function identifier(){return this._getString(33,this._data[32])};DirectoryRecord.prototype.fileName=function fileName(isoData){if(this.hasRockRidge()){var fn=this._rockRidgeFilename(isoData);if(fn!==null){return fn}}var ident=this.identifier();if(this.isDirectory(isoData)){return ident}var versionSeparator=ident.indexOf(";");if(versionSeparator===-1){return ident}else if(ident[versionSeparator-1]==="."){return ident.slice(0,versionSeparator-1)}else{return ident.slice(0,versionSeparator)}};DirectoryRecord.prototype.isDirectory=function isDirectory(isoData){var rv=!!(this.fileFlags()&2);if(!rv&&this.hasRockRidge()){rv=this.getSUEntries(isoData).filter(function(e){return e instanceof CLEntry}).length>0}return rv};DirectoryRecord.prototype.isSymlink=function isSymlink(isoData){return this.hasRockRidge()&&this.getSUEntries(isoData).filter(function(e){return e instanceof SLEntry}).length>0};DirectoryRecord.prototype.getSymlinkPath=function getSymlinkPath(isoData){var p2="";var entries=this.getSUEntries(isoData);var getStr=this._getGetString();for(var i22=0,list2=entries;i22<list2.length;i22+=1){var entry=list2[i22];if(entry instanceof SLEntry){var components=entry.componentRecords();for(var i$12=0,list$1=components;i$12<list$1.length;i$12+=1){var component=list$1[i$12];var flags=component.flags();if(flags&2){p2+="./"}else if(flags&4){p2+="../"}else if(flags&8){p2+="/"}else{p2+=component.content(getStr);if(!(flags&1)){p2+="/"}}}if(!entry.continueFlag()){break}}}if(p2.length>1&&p2[p2.length-1]==="/"){return p2.slice(0,p2.length-1)}else{return p2}};DirectoryRecord.prototype.getFile=function getFile(isoData){if(this.isDirectory(isoData)){throw new Error("Tried to get a File from a directory.")}if(this._fileOrDir===null){this._fileOrDir=isoData.slice(this.lba(),this.lba()+this.dataLength())}return this._fileOrDir};DirectoryRecord.prototype.getDirectory=function getDirectory(isoData){if(!this.isDirectory(isoData)){throw new Error("Tried to get a Directory from a file.")}if(this._fileOrDir===null){this._fileOrDir=this._constructDirectory(isoData)}return this._fileOrDir};DirectoryRecord.prototype.getSUEntries=function getSUEntries(isoData){if(!this._suEntries){this._constructSUEntries(isoData)}return this._suEntries};DirectoryRecord.prototype._rockRidgeFilename=function _rockRidgeFilename(isoData){var nmEntries=this.getSUEntries(isoData).filter(function(e2){return e2 instanceof NMEntry});if(nmEntries.length===0||nmEntries[0].flags()&(2|4)){return null}var str3="";var getString=this._getGetString();for(var i22=0,list2=nmEntries;i22<list2.length;i22+=1){var e=list2[i22];str3+=e.name(getString);if(!(e.flags()&1)){break}}return str3};DirectoryRecord.prototype._constructSUEntries=function _constructSUEntries(isoData){var i22=33+this._data[32];if(i22%2===1){i22++}i22+=this._rockRidgeOffset;this._suEntries=constructSystemUseEntries(this._data,i22,this.length(),isoData)};DirectoryRecord.prototype._getRockRidgeOffset=function _getRockRidgeOffset(isoData){this._rockRidgeOffset=0;var suEntries=this.getSUEntries(isoData);if(suEntries.length>0){var spEntry=suEntries[0];if(spEntry instanceof SPEntry&&spEntry.checkBytesPass()){for(var i22=1;i22<suEntries.length;i22++){var entry=suEntries[i22];if(entry instanceof RREntry||entry instanceof EREntry&&entry.extensionIdentifier()===rockRidgeIdentifier){return spEntry.bytesSkipped()}}}}this._rockRidgeOffset=-1;return-1};var ISODirectoryRecord=function(DirectoryRecord2){function ISODirectoryRecord2(data,rockRidgeOffset){DirectoryRecord2.call(this,data,rockRidgeOffset)}if(DirectoryRecord2)ISODirectoryRecord2.__proto__=DirectoryRecord2;ISODirectoryRecord2.prototype=Object.create(DirectoryRecord2&&DirectoryRecord2.prototype);ISODirectoryRecord2.prototype.constructor=ISODirectoryRecord2;ISODirectoryRecord2.prototype._getString=function _getString(i22,len){return getASCIIString(this._data,i22,len)};ISODirectoryRecord2.prototype._constructDirectory=function _constructDirectory(isoData){return new ISODirectory(this,isoData)};ISODirectoryRecord2.prototype._getGetString=function _getGetString(){return getASCIIString};return ISODirectoryRecord2}(DirectoryRecord);var JolietDirectoryRecord=function(DirectoryRecord2){function JolietDirectoryRecord2(data,rockRidgeOffset){DirectoryRecord2.call(this,data,rockRidgeOffset)}if(DirectoryRecord2)JolietDirectoryRecord2.__proto__=DirectoryRecord2;JolietDirectoryRecord2.prototype=Object.create(DirectoryRecord2&&DirectoryRecord2.prototype);JolietDirectoryRecord2.prototype.constructor=JolietDirectoryRecord2;JolietDirectoryRecord2.prototype._getString=function _getString(i22,len){return getJolietString(this._data,i22,len)};JolietDirectoryRecord2.prototype._constructDirectory=function _constructDirectory(isoData){return new JolietDirectory(this,isoData)};JolietDirectoryRecord2.prototype._getGetString=function _getGetString(){return getJolietString};return JolietDirectoryRecord2}(DirectoryRecord);var SystemUseEntry=function SystemUseEntry2(data){this._data=data};SystemUseEntry.prototype.signatureWord=function signatureWord(){return this._data.readUInt16BE(0)};SystemUseEntry.prototype.signatureWordString=function signatureWordString(){return getASCIIString(this._data,0,2)};SystemUseEntry.prototype.length=function length(){return this._data[2]};SystemUseEntry.prototype.suVersion=function suVersion(){return this._data[3]};var CEEntry=function(SystemUseEntry2){function CEEntry2(data){SystemUseEntry2.call(this,data);this._entries=null}if(SystemUseEntry2)CEEntry2.__proto__=SystemUseEntry2;CEEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);CEEntry2.prototype.constructor=CEEntry2;CEEntry2.prototype.continuationLba=function continuationLba(){return this._data.readUInt32LE(4)};CEEntry2.prototype.continuationLbaOffset=function continuationLbaOffset(){return this._data.readUInt32LE(12)};CEEntry2.prototype.continuationLength=function continuationLength(){return this._data.readUInt32LE(20)};CEEntry2.prototype.getEntries=function getEntries(isoData){if(!this._entries){var start=this.continuationLba()*2048+this.continuationLbaOffset();this._entries=constructSystemUseEntries(isoData,start,this.continuationLength(),isoData)}return this._entries};return CEEntry2}(SystemUseEntry);var PDEntry=function(SystemUseEntry2){function PDEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)PDEntry2.__proto__=SystemUseEntry2;PDEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);PDEntry2.prototype.constructor=PDEntry2;return PDEntry2}(SystemUseEntry);var SPEntry=function(SystemUseEntry2){function SPEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)SPEntry2.__proto__=SystemUseEntry2;SPEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);SPEntry2.prototype.constructor=SPEntry2;SPEntry2.prototype.checkBytesPass=function checkBytesPass(){return this._data[4]===190&&this._data[5]===239};SPEntry2.prototype.bytesSkipped=function bytesSkipped(){return this._data[6]};return SPEntry2}(SystemUseEntry);var STEntry=function(SystemUseEntry2){function STEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)STEntry2.__proto__=SystemUseEntry2;STEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);STEntry2.prototype.constructor=STEntry2;return STEntry2}(SystemUseEntry);var EREntry=function(SystemUseEntry2){function EREntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)EREntry2.__proto__=SystemUseEntry2;EREntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);EREntry2.prototype.constructor=EREntry2;EREntry2.prototype.identifierLength=function identifierLength(){return this._data[4]};EREntry2.prototype.descriptorLength=function descriptorLength(){return this._data[5]};EREntry2.prototype.sourceLength=function sourceLength(){return this._data[6]};EREntry2.prototype.extensionVersion=function extensionVersion(){return this._data[7]};EREntry2.prototype.extensionIdentifier=function extensionIdentifier(){return getASCIIString(this._data,8,this.identifierLength())};EREntry2.prototype.extensionDescriptor=function extensionDescriptor(){return getASCIIString(this._data,8+this.identifierLength(),this.descriptorLength())};EREntry2.prototype.extensionSource=function extensionSource(){return getASCIIString(this._data,8+this.identifierLength()+this.descriptorLength(),this.sourceLength())};return EREntry2}(SystemUseEntry);var ESEntry=function(SystemUseEntry2){function ESEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)ESEntry2.__proto__=SystemUseEntry2;ESEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);ESEntry2.prototype.constructor=ESEntry2;ESEntry2.prototype.extensionSequence=function extensionSequence(){return this._data[4]};return ESEntry2}(SystemUseEntry);var RREntry=function(SystemUseEntry2){function RREntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)RREntry2.__proto__=SystemUseEntry2;RREntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);RREntry2.prototype.constructor=RREntry2;return RREntry2}(SystemUseEntry);var PXEntry=function(SystemUseEntry2){function PXEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)PXEntry2.__proto__=SystemUseEntry2;PXEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);PXEntry2.prototype.constructor=PXEntry2;PXEntry2.prototype.mode=function mode(){return this._data.readUInt32LE(4)};PXEntry2.prototype.fileLinks=function fileLinks(){return this._data.readUInt32LE(12)};PXEntry2.prototype.uid=function uid(){return this._data.readUInt32LE(20)};PXEntry2.prototype.gid=function gid(){return this._data.readUInt32LE(28)};PXEntry2.prototype.inode=function inode(){return this._data.readUInt32LE(36)};return PXEntry2}(SystemUseEntry);var PNEntry=function(SystemUseEntry2){function PNEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)PNEntry2.__proto__=SystemUseEntry2;PNEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);PNEntry2.prototype.constructor=PNEntry2;PNEntry2.prototype.devTHigh=function devTHigh(){return this._data.readUInt32LE(4)};PNEntry2.prototype.devTLow=function devTLow(){return this._data.readUInt32LE(12)};return PNEntry2}(SystemUseEntry);var SLEntry=function(SystemUseEntry2){function SLEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)SLEntry2.__proto__=SystemUseEntry2;SLEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);SLEntry2.prototype.constructor=SLEntry2;SLEntry2.prototype.flags=function flags(){return this._data[4]};SLEntry2.prototype.continueFlag=function continueFlag(){return this.flags()&1};SLEntry2.prototype.componentRecords=function componentRecords(){var this$1=this;var records=new Array;var i22=5;while(i22<this.length()){var record=new SLComponentRecord(this$1._data.slice(i22));records.push(record);i22+=record.length()}return records};return SLEntry2}(SystemUseEntry);var SLComponentRecord=function SLComponentRecord2(data){this._data=data};SLComponentRecord.prototype.flags=function flags(){return this._data[0]};SLComponentRecord.prototype.length=function length(){return 2+this.componentLength()};SLComponentRecord.prototype.componentLength=function componentLength(){return this._data[1]};SLComponentRecord.prototype.content=function content(getString){return getString(this._data,2,this.componentLength())};var NMEntry=function(SystemUseEntry2){function NMEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)NMEntry2.__proto__=SystemUseEntry2;NMEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);NMEntry2.prototype.constructor=NMEntry2;NMEntry2.prototype.flags=function flags(){return this._data[4]};NMEntry2.prototype.name=function name2(getString){return getString(this._data,5,this.length()-5)};return NMEntry2}(SystemUseEntry);var CLEntry=function(SystemUseEntry2){function CLEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)CLEntry2.__proto__=SystemUseEntry2;CLEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);CLEntry2.prototype.constructor=CLEntry2;CLEntry2.prototype.childDirectoryLba=function childDirectoryLba(){return this._data.readUInt32LE(4)};return CLEntry2}(SystemUseEntry);var PLEntry=function(SystemUseEntry2){function PLEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)PLEntry2.__proto__=SystemUseEntry2;PLEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);PLEntry2.prototype.constructor=PLEntry2;PLEntry2.prototype.parentDirectoryLba=function parentDirectoryLba(){return this._data.readUInt32LE(4)};return PLEntry2}(SystemUseEntry);var REEntry=function(SystemUseEntry2){function REEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)REEntry2.__proto__=SystemUseEntry2;REEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);REEntry2.prototype.constructor=REEntry2;return REEntry2}(SystemUseEntry);var TFEntry=function(SystemUseEntry2){function TFEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)TFEntry2.__proto__=SystemUseEntry2;TFEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);TFEntry2.prototype.constructor=TFEntry2;TFEntry2.prototype.flags=function flags(){return this._data[4]};TFEntry2.prototype.creation=function creation(){if(this.flags()&1){if(this._longFormDates()){return getDate(this._data,5)}else{return getShortFormDate(this._data,5)}}else{return null}};TFEntry2.prototype.modify=function modify(){if(this.flags()&2){var previousDates=this.flags()&1?1:0;if(this._longFormDates){return getDate(this._data,5+previousDates*17)}else{return getShortFormDate(this._data,5+previousDates*7)}}else{return null}};TFEntry2.prototype.access=function access(){if(this.flags()&4){var previousDates=this.flags()&1?1:0;previousDates+=this.flags()&2?1:0;if(this._longFormDates){return getDate(this._data,5+previousDates*17)}else{return getShortFormDate(this._data,5+previousDates*7)}}else{return null}};TFEntry2.prototype.backup=function backup(){if(this.flags()&16){var previousDates=this.flags()&1?1:0;previousDates+=this.flags()&2?1:0;previousDates+=this.flags()&4?1:0;if(this._longFormDates){return getDate(this._data,5+previousDates*17)}else{return getShortFormDate(this._data,5+previousDates*7)}}else{return null}};TFEntry2.prototype.expiration=function expiration(){if(this.flags()&32){var previousDates=this.flags()&1?1:0;previousDates+=this.flags()&2?1:0;previousDates+=this.flags()&4?1:0;previousDates+=this.flags()&16?1:0;if(this._longFormDates){return getDate(this._data,5+previousDates*17)}else{return getShortFormDate(this._data,5+previousDates*7)}}else{return null}};TFEntry2.prototype.effective=function effective(){if(this.flags()&64){var previousDates=this.flags()&1?1:0;previousDates+=this.flags()&2?1:0;previousDates+=this.flags()&4?1:0;previousDates+=this.flags()&16?1:0;previousDates+=this.flags()&32?1:0;if(this._longFormDates){return getDate(this._data,5+previousDates*17)}else{return getShortFormDate(this._data,5+previousDates*7)}}else{return null}};TFEntry2.prototype._longFormDates=function _longFormDates(){return!!(this.flags()&&128)};return TFEntry2}(SystemUseEntry);var SFEntry=function(SystemUseEntry2){function SFEntry2(data){SystemUseEntry2.call(this,data)}if(SystemUseEntry2)SFEntry2.__proto__=SystemUseEntry2;SFEntry2.prototype=Object.create(SystemUseEntry2&&SystemUseEntry2.prototype);SFEntry2.prototype.constructor=SFEntry2;SFEntry2.prototype.virtualSizeHigh=function virtualSizeHigh(){return this._data.readUInt32LE(4)};SFEntry2.prototype.virtualSizeLow=function virtualSizeLow(){return this._data.readUInt32LE(12)};SFEntry2.prototype.tableDepth=function tableDepth(){return this._data[20]};return SFEntry2}(SystemUseEntry);var Directory=function Directory2(record,isoData){var this$1=this;this._fileList=[];this._fileMap={};this._record=record;var i22=record.lba();var iLimit=i22+record.dataLength();if(!(record.fileFlags()&2)){var cl=record.getSUEntries(isoData).filter(function(e){return e instanceof CLEntry})[0];i22=cl.childDirectoryLba()*2048;iLimit=Infinity}while(i22<iLimit){var len=isoData[i22];if(len===0){i22++;continue}var r=this$1._constructDirectoryRecord(isoData.slice(i22));var fname=r.fileName(isoData);if(fname!=="\\0"&&fname!==""){if(!r.hasRockRidge()||r.getSUEntries(isoData).filter(function(e){return e instanceof REEntry}).length===0){this$1._fileMap[fname]=r;this$1._fileList.push(fname)}}else if(iLimit===Infinity){iLimit=i22+r.dataLength()}i22+=r.length()}};Directory.prototype.getRecord=function getRecord(name2){return this._fileMap[name2]};Directory.prototype.getFileList=function getFileList(){return this._fileList};Directory.prototype.getDotEntry=function getDotEntry(isoData){return this._constructDirectoryRecord(isoData.slice(this._record.lba()))};var ISODirectory=function(Directory2){function ISODirectory2(record,isoData){Directory2.call(this,record,isoData)}if(Directory2)ISODirectory2.__proto__=Directory2;ISODirectory2.prototype=Object.create(Directory2&&Directory2.prototype);ISODirectory2.prototype.constructor=ISODirectory2;ISODirectory2.prototype._constructDirectoryRecord=function _constructDirectoryRecord(data){return new ISODirectoryRecord(data,this._record.getRockRidgeOffset())};return ISODirectory2}(Directory);var JolietDirectory=function(Directory2){function JolietDirectory2(record,isoData){Directory2.call(this,record,isoData)}if(Directory2)JolietDirectory2.__proto__=Directory2;JolietDirectory2.prototype=Object.create(Directory2&&Directory2.prototype);JolietDirectory2.prototype.constructor=JolietDirectory2;JolietDirectory2.prototype._constructDirectoryRecord=function _constructDirectoryRecord(data){return new JolietDirectoryRecord(data,this._record.getRockRidgeOffset())};return JolietDirectory2}(Directory);var IsoFS=function(SynchronousFileSystem$$1){function IsoFS2(data,name2,deprecateMsg){var this$1=this;if(name2===void 0)name2="";if(deprecateMsg===void 0)deprecateMsg=true;SynchronousFileSystem$$1.call(this);this._data=data;deprecationMessage(deprecateMsg,IsoFS2.Name,{data:"ISO data as a Buffer",name:name2});var vdTerminatorFound=false;var i22=16*2048;var candidateVDs=new Array;while(!vdTerminatorFound){var slice=data.slice(i22);var vd=new VolumeDescriptor(slice);switch(vd.type()){case 1:candidateVDs.push(new PrimaryVolumeDescriptor(slice));break;case 2:candidateVDs.push(new SupplementaryVolumeDescriptor(slice));break;case 255:vdTerminatorFound=true;break}i22+=2048}if(candidateVDs.length===0){throw new ApiError(ErrorCode.EIO,"Unable to find a suitable volume descriptor.")}candidateVDs.forEach(function(v2){if(!this$1._pvd||this$1._pvd.type()!==2){this$1._pvd=v2}});this._root=this._pvd.rootDirectoryEntry(data);this._name=name2}if(SynchronousFileSystem$$1)IsoFS2.__proto__=SynchronousFileSystem$$1;IsoFS2.prototype=Object.create(SynchronousFileSystem$$1&&SynchronousFileSystem$$1.prototype);IsoFS2.prototype.constructor=IsoFS2;IsoFS2.Create=function Create(opts,cb){var fs4;var e;try{fs4=new IsoFS2(opts.data,opts.name,false)}catch(e2){e2=e2}finally{cb(e,fs4)}};IsoFS2.isAvailable=function isAvailable(){return true};IsoFS2.prototype.getName=function getName(){var name2="IsoFS"+this._name+(this._pvd?"-"+this._pvd.name():"");if(this._root&&this._root.hasRockRidge()){name2+="-RockRidge"}return name2};IsoFS2.prototype.diskSpace=function diskSpace(path$$1,cb){cb(this._data.length,0)};IsoFS2.prototype.isReadOnly=function isReadOnly(){return true};IsoFS2.prototype.supportsLinks=function supportsLinks(){return false};IsoFS2.prototype.supportsProps=function supportsProps(){return false};IsoFS2.prototype.supportsSynch=function supportsSynch(){return true};IsoFS2.prototype.statSync=function statSync(p2,isLstat){var record=this._getDirectoryRecord(p2);if(record===null){throw ApiError.ENOENT(p2)}return this._getStats(p2,record)};IsoFS2.prototype.openSync=function openSync(p2,flags,mode){if(flags.isWriteable()){throw new ApiError(ErrorCode.EPERM,p2)}var record=this._getDirectoryRecord(p2);if(!record){throw ApiError.ENOENT(p2)}else if(record.isSymlink(this._data)){return this.openSync(path.resolve(p2,record.getSymlinkPath(this._data)),flags,mode)}else if(!record.isDirectory(this._data)){var data=record.getFile(this._data);var stats=this._getStats(p2,record);switch(flags.pathExistsAction()){case ActionType.THROW_EXCEPTION:case ActionType.TRUNCATE_FILE:throw ApiError.EEXIST(p2);case ActionType.NOP:return new NoSyncFile(this,p2,flags,stats,data);default:throw new ApiError(ErrorCode.EINVAL,"Invalid FileMode object.")}}else{throw ApiError.EISDIR(p2)}};IsoFS2.prototype.readdirSync=function readdirSync(path$$1){var record=this._getDirectoryRecord(path$$1);if(!record){throw ApiError.ENOENT(path$$1)}else if(record.isDirectory(this._data)){return record.getDirectory(this._data).getFileList().slice(0)}else{throw ApiError.ENOTDIR(path$$1)}};IsoFS2.prototype.readFileSync=function readFileSync(fname,encoding,flag){var fd=this.openSync(fname,flag,420);try{var fdCast=fd;var fdBuff=fdCast.getBuffer();if(encoding===null){return copyingSlice(fdBuff)}return fdBuff.toString(encoding)}finally{fd.closeSync()}};IsoFS2.prototype._getDirectoryRecord=function _getDirectoryRecord(path$$1){var this$1=this;if(path$$1==="/"){return this._root}var components=path$$1.split("/").slice(1);var dir=this._root;for(var i22=0,list2=components;i22<list2.length;i22+=1){var component=list2[i22];if(dir.isDirectory(this$1._data)){dir=dir.getDirectory(this$1._data).getRecord(component);if(!dir){return null}}else{return null}}return dir};IsoFS2.prototype._getStats=function _getStats(p2,record){if(record.isSymlink(this._data)){var newP=path.resolve(p2,record.getSymlinkPath(this._data));var dirRec=this._getDirectoryRecord(newP);if(!dirRec){return null}return this._getStats(newP,dirRec)}else{var len=record.dataLength();var mode=365;var date=record.recordingDate();var atime=date;var mtime=date;var ctime=date;if(record.hasRockRidge()){var entries=record.getSUEntries(this._data);for(var i22=0,list2=entries;i22<list2.length;i22+=1){var entry=list2[i22];if(entry instanceof PXEntry){mode=entry.mode()}else if(entry instanceof TFEntry){var flags=entry.flags();if(flags&4){atime=entry.access()}if(flags&2){mtime=entry.modify()}if(flags&1){ctime=entry.creation()}}}}mode=mode&365;return new Stats(record.isDirectory(this._data)?FileType.DIRECTORY:FileType.FILE,len,mode,atime,mtime,ctime)}};return IsoFS2}(SynchronousFileSystem);IsoFS.Name="IsoFS";IsoFS.Options={data:{type:"object",description:"The ISO file in a buffer",validator:bufferValidator}};[AsyncMirror,DropboxFileSystem,EmscriptenFileSystem,FolderAdapter,HTML5FS,InMemoryFileSystem,IndexedDBFileSystem,IsoFS,LocalStorageFileSystem,MountableFileSystem,OverlayFS,WorkerFS,XmlHttpRequest,ZipFS].forEach(function(fsType){var create=fsType.Create;fsType.Create=function(opts,cb){var oneArg=typeof opts==="function";var normalizedCb=oneArg?opts:cb;var normalizedOpts=oneArg?{}:opts;function wrappedCb(e){if(e){normalizedCb(e)}else{create.call(fsType,normalizedOpts,normalizedCb)}}checkOptions(fsType,normalizedOpts,wrappedCb)}});var Backends={AsyncMirror,Dropbox:DropboxFileSystem,Emscripten:EmscriptenFileSystem,FolderAdapter,HTML5FS,InMemory:InMemoryFileSystem,IndexedDB:IndexedDBFileSystem,IsoFS,LocalStorage:LocalStorageFileSystem,MountableFileSystem,OverlayFS,WorkerFS,XmlHttpRequest,ZipFS};if(process["initializeTTYs"]){process["initializeTTYs"]()}function install(obj){obj.Buffer=Buffer2;obj.process=process;var oldRequire=obj.require?obj.require:null;obj.require=function(arg){var rv=BFSRequire2(arg);if(!rv){return oldRequire.apply(null,Array.prototype.slice.call(arguments,0))}else{return rv}}}function registerFileSystem(name2,fs4){Backends[name2]=fs4}function BFSRequire2(module4){switch(module4){case"fs":return _fsMock;case"path":return path;case"buffer":return buffer;case"process":return process;case"bfs_utils":return BFSUtils;default:return Backends[module4]}}function initialize2(rootfs){return _fsMock.initialize(rootfs)}function configure(config,cb){getFileSystem(config,function(e,fs4){if(fs4){initialize2(fs4);cb()}else{cb(e)}})}function getFileSystem(config,cb){var fsName=config["fs"];if(!fsName){return cb(new ApiError(ErrorCode.EPERM,\'Missing "fs" property on configuration object.\'))}var options=config["options"];var waitCount=0;var called=false;function finish(){if(!called){called=true;var fsc=Backends[fsName];if(!fsc){cb(new ApiError(ErrorCode.EPERM,"File system "+fsName+" is not available in BrowserFS."))}else{fsc.Create(options,cb)}}}if(options!==null&&typeof options==="object"){var finishedIterating=false;var props=Object.keys(options).filter(function(k){return k!=="fs"});props.forEach(function(p2){var d2=options[p2];if(d2!==null&&typeof d2==="object"&&d2["fs"]){waitCount++;getFileSystem(d2,function(e,fs4){waitCount--;if(e){if(called){return}called=true;cb(e)}else{options[p2]=fs4;if(waitCount===0&&finishedIterating){finish()}}})}});finishedIterating=true}if(waitCount===0){finish()}}if("ab".substr(-1)!=="b"){String.prototype.substr=function(substr){return function(start,length){if(start<0){start=this.length+start}return substr.call(this,start,length)}}(String.prototype.substr)}if(typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined"){if(!Uint8Array.prototype["slice"]){Uint8Array.prototype.slice=function(start,end){if(start===void 0)start=0;if(end===void 0)end=this.length;var self2=this;if(start<0){start=this.length+start;if(start<0){start=0}}if(end<0){end=this.length+end;if(end<0){end=0}}if(end<start){end=start}return new Uint8Array(self2.buffer,self2.byteOffset+start,end-start)}}}exports2.install=install;exports2.registerFileSystem=registerFileSystem;exports2.BFSRequire=BFSRequire2;exports2.initialize=initialize2;exports2.configure=configure;exports2.getFileSystem=getFileSystem;exports2.EmscriptenFS=BFSEmscriptenFS;exports2.FileSystem=Backends;exports2.Errors=api_error;exports2.setImmediate=setImmediate$3}).call(exports2,__webpack_require__(1),function(){return this}(),__webpack_require__(5)(module22),__webpack_require__(6))},function(module22,exports2,__webpack_require__){module22.exports=__webpack_require__(2).Buffer},function(module22,exports2,__webpack_require__){(function(Buffer2){"use strict";var base64=__webpack_require__(3);var ieee754=__webpack_require__(4);exports2.Buffer=Buffer2;exports2.SlowBuffer=SlowBuffer;exports2.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports2.kMaxLength=K_MAX_LENGTH;Buffer2.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer2.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function typedArraySupport(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return arr.foo()===42}catch(e){return false}}function createBuffer(length){if(length>K_MAX_LENGTH){throw new RangeError("Invalid typed array length")}var buf=new Uint8Array(length);buf.__proto__=Buffer2.prototype;return buf}function Buffer2(arg,encodingOrOffset,length){if(typeof arg==="number"){if(typeof encodingOrOffset==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}if(typeof Symbol!=="undefined"&&Symbol.species&&Buffer2[Symbol.species]===Buffer2){Object.defineProperty(Buffer2,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}Buffer2.poolSize=8192;function from(value,encodingOrOffset,length){if(typeof value==="number"){throw new TypeError(\'"value" argument must not be a number\')}if(isArrayBuffer(value)){return fromArrayBuffer(value,encodingOrOffset,length)}if(typeof value==="string"){return fromString(value,encodingOrOffset)}return fromObject(value)}Buffer2.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)};Buffer2.prototype.__proto__=Uint8Array.prototype;Buffer2.__proto__=Uint8Array;function assertSize(size){if(typeof size!=="number"){throw new TypeError(\'"size" argument must be a number\')}else if(size<0){throw new RangeError(\'"size" argument must not be negative\')}}function alloc(size,fill,encoding){assertSize(size);if(size<=0){return createBuffer(size)}if(fill!==void 0){return typeof encoding==="string"?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill)}return createBuffer(size)}Buffer2.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)};function allocUnsafe(size){assertSize(size);return createBuffer(size<0?0:checked(size)|0)}Buffer2.allocUnsafe=function(size){return allocUnsafe(size)};Buffer2.allocUnsafeSlow=function(size){return allocUnsafe(size)};function fromString(string,encoding){if(typeof encoding!=="string"||encoding===""){encoding="utf8"}if(!Buffer2.isEncoding(encoding)){throw new TypeError(\'"encoding" must be a valid string encoding\')}var length=byteLength(string,encoding)|0;var buf=createBuffer(length);var actual=buf.write(string,encoding);if(actual!==length){buf=buf.slice(0,actual)}return buf}function fromArrayLike(array){var length=array.length<0?0:checked(array.length)|0;var buf=createBuffer(length);for(var i3=0;i3<length;i3+=1){buf[i3]=array[i3]&255}return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError("\'offset\' is out of bounds")}if(array.byteLength<byteOffset+(length||0)){throw new RangeError("\'length\' is out of bounds")}var buf;if(byteOffset===void 0&&length===void 0){buf=new Uint8Array(array)}else if(length===void 0){buf=new Uint8Array(array,byteOffset)}else{buf=new Uint8Array(array,byteOffset,length)}buf.__proto__=Buffer2.prototype;return buf}function fromObject(obj){if(Buffer2.isBuffer(obj)){var len=checked(obj.length)|0;var buf=createBuffer(len);if(buf.length===0){return buf}obj.copy(buf,0,0,len);return buf}if(obj){if(isArrayBufferView(obj)||"length"in obj){if(typeof obj.length!=="number"||numberIsNaN(obj.length)){return createBuffer(0)}return fromArrayLike(obj)}if(obj.type==="Buffer"&&Array.isArray(obj.data)){return fromArrayLike(obj.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes")}return length|0}function SlowBuffer(length){if(+length!=length){length=0}return Buffer2.alloc(+length)}Buffer2.isBuffer=function isBuffer(b){return b!=null&&b._isBuffer===true};Buffer2.compare=function compare(a,b){if(!Buffer2.isBuffer(a)||!Buffer2.isBuffer(b)){throw new TypeError("Arguments must be Buffers")}if(a===b)return 0;var x3=a.length;var y4=b.length;for(var i3=0,len=Math.min(x3,y4);i3<len;++i3){if(a[i3]!==b[i3]){x3=a[i3];y4=b[i3];break}}if(x3<y4)return-1;if(y4<x3)return 1;return 0};Buffer2.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer2.concat=function concat(list,length){if(!Array.isArray(list)){throw new TypeError(\'"list" argument must be an Array of Buffers\')}if(list.length===0){return Buffer2.alloc(0)}var i3;if(length===void 0){length=0;for(i3=0;i3<list.length;++i3){length+=list[i3].length}}var buffer=Buffer2.allocUnsafe(length);var pos=0;for(i3=0;i3<list.length;++i3){var buf=list[i3];if(!Buffer2.isBuffer(buf)){throw new TypeError(\'"list" argument must be an Array of Buffers\')}buf.copy(buffer,pos);pos+=buf.length}return buffer};function byteLength(string,encoding){if(Buffer2.isBuffer(string)){return string.length}if(isArrayBufferView(string)||isArrayBuffer(string)){return string.byteLength}if(typeof string!=="string"){string=""+string}var len=string.length;if(len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer2.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;if(start===void 0||start<0){start=0}if(start>this.length){return""}if(end===void 0||end>this.length){end=this.length}if(end<=0){return""}end>>>=0;start>>>=0;if(end<=start){return""}if(!encoding)encoding="utf8";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer2.prototype._isBuffer=true;function swap(b,n,m){var i3=b[n];b[n]=b[m];b[m]=i3}Buffer2.prototype.swap16=function swap16(){var len=this.length;if(len%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var i3=0;i3<len;i3+=2){swap(this,i3,i3+1)}return this};Buffer2.prototype.swap32=function swap32(){var len=this.length;if(len%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var i3=0;i3<len;i3+=4){swap(this,i3,i3+3);swap(this,i3+1,i3+2)}return this};Buffer2.prototype.swap64=function swap64(){var len=this.length;if(len%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var i3=0;i3<len;i3+=8){swap(this,i3,i3+7);swap(this,i3+1,i3+6);swap(this,i3+2,i3+5);swap(this,i3+3,i3+4)}return this};Buffer2.prototype.toString=function toString(){var length=this.length;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer2.prototype.equals=function equals(b){if(!Buffer2.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer2.compare(this,b)===0};Buffer2.prototype.inspect=function inspect(){var str3="";var max=exports2.INSPECT_MAX_BYTES;if(this.length>0){str3=this.toString("hex",0,max).match(/.{2}/g).join(" ");if(this.length>max)str3+=" ... "}return"<Buffer "+str3+">"};Buffer2.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(!Buffer2.isBuffer(target)){throw new TypeError("Argument must be a Buffer")}if(start===void 0){start=0}if(end===void 0){end=target?target.length:0}if(thisStart===void 0){thisStart=0}if(thisEnd===void 0){thisEnd=this.length}if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError("out of range index")}if(thisStart>=thisEnd&&start>=end){return 0}if(thisStart>=thisEnd){return-1}if(start>=end){return 1}start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x3=thisEnd-thisStart;var y4=end-start;var len=Math.min(x3,y4);var thisCopy=this.slice(thisStart,thisEnd);var targetCopy=target.slice(start,end);for(var i3=0;i3<len;++i3){if(thisCopy[i3]!==targetCopy[i3]){x3=thisCopy[i3];y4=targetCopy[i3];break}}if(x3<y4)return-1;if(y4<x3)return 1;return 0};function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(buffer.length===0)return-1;if(typeof byteOffset==="string"){encoding=byteOffset;byteOffset=0}else if(byteOffset>2147483647){byteOffset=2147483647}else if(byteOffset<-2147483648){byteOffset=-2147483648}byteOffset=+byteOffset;if(numberIsNaN(byteOffset)){byteOffset=dir?0:buffer.length-1}if(byteOffset<0)byteOffset=buffer.length+byteOffset;if(byteOffset>=buffer.length){if(dir)return-1;else byteOffset=buffer.length-1}else if(byteOffset<0){if(dir)byteOffset=0;else return-1}if(typeof val==="string"){val=Buffer2.from(val,encoding)}if(Buffer2.isBuffer(val)){if(val.length===0){return-1}return arrayIndexOf(buffer,val,byteOffset,encoding,dir)}else if(typeof val==="number"){val=val&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(dir){return Uint8Array.prototype.indexOf.call(buffer,val,byteOffset)}else{return Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset)}}return arrayIndexOf(buffer,[val],byteOffset,encoding,dir)}throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1;var arrLength=arr.length;var valLength=val.length;if(encoding!==void 0){encoding=String(encoding).toLowerCase();if(encoding==="ucs2"||encoding==="ucs-2"||encoding==="utf16le"||encoding==="utf-16le"){if(arr.length<2||val.length<2){return-1}indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2}}function read(buf,i22){if(indexSize===1){return buf[i22]}else{return buf.readUInt16BE(i22*indexSize)}}var i3;if(dir){var foundIndex=-1;for(i3=byteOffset;i3<arrLength;i3++){if(read(arr,i3)===read(val,foundIndex===-1?0:i3-foundIndex)){if(foundIndex===-1)foundIndex=i3;if(i3-foundIndex+1===valLength)return foundIndex*indexSize}else{if(foundIndex!==-1)i3-=i3-foundIndex;foundIndex=-1}}}else{if(byteOffset+valLength>arrLength)byteOffset=arrLength-valLength;for(i3=byteOffset;i3>=0;i3--){var found=true;for(var j=0;j<valLength;j++){if(read(arr,i3+j)!==read(val,j)){found=false;break}}if(found)return i3}}return-1}Buffer2.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1};Buffer2.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,true)};Buffer2.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,false)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(strLen%2!==0)throw new TypeError("Invalid hex string");if(length>strLen/2){length=strLen/2}for(var i3=0;i3<length;++i3){var parsed=parseInt(string.substr(i3*2,2),16);if(numberIsNaN(parsed))return i3;buf[offset+i3]=parsed}return i3}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer2.prototype.write=function write(string,offset,length,encoding){if(offset===void 0){encoding="utf8";length=this.length;offset=0}else if(length===void 0&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset>>>0;if(isFinite(length)){length=length>>>0;if(encoding===void 0)encoding="utf8"}else{encoding=length;length=void 0}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var remaining=this.length-offset;if(length===void 0||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer2.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i3=start;while(i3<end){var firstByte=buf[i3];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i3+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte}break;case 2:secondByte=buf[i3+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint}}break;case 3:secondByte=buf[i3+1];thirdByte=buf[i3+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint}}break;case 4:secondByte=buf[i3+1];thirdByte=buf[i3+2];fourthByte=buf[i3+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i3+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}var res="";var i3=0;while(i3<len){res+=String.fromCharCode.apply(String,codePoints.slice(i3,i3+=MAX_ARGUMENTS_LENGTH))}return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i3=start;i3<end;++i3){ret+=String.fromCharCode(buf[i3]&127)}return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i3=start;i3<end;++i3){ret+=String.fromCharCode(buf[i3])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i3=start;i3<end;++i3){out+=toHex(buf[i3])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i3=0;i3<bytes.length;i3+=2){res+=String.fromCharCode(bytes[i3]+bytes[i3+1]*256)}return res}Buffer2.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===void 0?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf=this.subarray(start,end);newBuf.__proto__=Buffer2.prototype;return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer2.prototype.readUIntLE=function readUIntLE(offset,byteLength2,noAssert){offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert)checkOffset(offset,byteLength2,this.length);var val=this[offset];var mul=1;var i3=0;while(++i3<byteLength2&&(mul*=256)){val+=this[offset+i3]*mul}return val};Buffer2.prototype.readUIntBE=function readUIntBE(offset,byteLength2,noAssert){offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert){checkOffset(offset,byteLength2,this.length)}var val=this[offset+--byteLength2];var mul=1;while(byteLength2>0&&(mul*=256)){val+=this[offset+--byteLength2]*mul}return val};Buffer2.prototype.readUInt8=function readUInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer2.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer2.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer2.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer2.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer2.prototype.readIntLE=function readIntLE(offset,byteLength2,noAssert){offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert)checkOffset(offset,byteLength2,this.length);var val=this[offset];var mul=1;var i3=0;while(++i3<byteLength2&&(mul*=256)){val+=this[offset+i3]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength2);return val};Buffer2.prototype.readIntBE=function readIntBE(offset,byteLength2,noAssert){offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert)checkOffset(offset,byteLength2,this.length);var i3=byteLength2;var mul=1;var val=this[offset+--i3];while(i3>0&&(mul*=256)){val+=this[offset+--i3]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength2);return val};Buffer2.prototype.readInt8=function readInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer2.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer2.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer2.prototype.readInt32LE=function readInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer2.prototype.readInt32BE=function readInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer2.prototype.readFloatLE=function readFloatLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer2.prototype.readFloatBE=function readFloatBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer2.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer2.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer2.isBuffer(buf))throw new TypeError(\'"buffer" argument must be a Buffer instance\');if(value>max||value<min)throw new RangeError(\'"value" argument is out of bounds\');if(offset+ext>buf.length)throw new RangeError("Index out of range")}Buffer2.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength2,noAssert){value=+value;offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength2)-1;checkInt(this,value,offset,byteLength2,maxBytes,0)}var mul=1;var i3=0;this[offset]=value&255;while(++i3<byteLength2&&(mul*=256)){this[offset+i3]=value/mul&255}return offset+byteLength2};Buffer2.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength2,noAssert){value=+value;offset=offset>>>0;byteLength2=byteLength2>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength2)-1;checkInt(this,value,offset,byteLength2,maxBytes,0)}var i3=byteLength2-1;var mul=1;this[offset+i3]=value&255;while(--i3>=0&&(mul*=256)){this[offset+i3]=value/mul&255}return offset+byteLength2};Buffer2.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,255,0);this[offset]=value&255;return offset+1};Buffer2.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer2.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer2.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255;return offset+4};Buffer2.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};Buffer2.prototype.writeIntLE=function writeIntLE(value,offset,byteLength2,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength2-1);checkInt(this,value,offset,byteLength2,limit-1,-limit)}var i3=0;var mul=1;var sub=0;this[offset]=value&255;while(++i3<byteLength2&&(mul*=256)){if(value<0&&sub===0&&this[offset+i3-1]!==0){sub=1}this[offset+i3]=(value/mul>>0)-sub&255}return offset+byteLength2};Buffer2.prototype.writeIntBE=function writeIntBE(value,offset,byteLength2,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength2-1);checkInt(this,value,offset,byteLength2,limit-1,-limit)}var i3=byteLength2-1;var mul=1;var sub=0;this[offset+i3]=value&255;while(--i3>=0&&(mul*=256)){if(value<0&&sub===0&&this[offset+i3+1]!==0){sub=1}this[offset+i3]=(value/mul>>0)-sub&255}return offset+byteLength2};Buffer2.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer2.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer2.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer2.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24;return offset+4};Buffer2.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,4,34028234663852886e22,-34028234663852886e22)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer2.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer2.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,8,17976931348623157e292,-17976931348623157e292)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer2.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer2.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer2.prototype.copy=function copy(target,targetStart,start,end){if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;var i3;if(this===target&&start<targetStart&&targetStart<end){for(i3=len-1;i3>=0;--i3){target[i3+targetStart]=this[i3+start]}}else if(len<1e3){for(i3=0;i3<len;++i3){target[i3+targetStart]=this[i3+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart)}return len};Buffer2.prototype.fill=function fill(val,start,end,encoding){if(typeof val==="string"){if(typeof start==="string"){encoding=start;start=0;end=this.length}else if(typeof end==="string"){encoding=end;end=this.length}if(val.length===1){var code=val.charCodeAt(0);if(code<256){val=code}}if(encoding!==void 0&&typeof encoding!=="string"){throw new TypeError("encoding must be a string")}if(typeof encoding==="string"&&!Buffer2.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}}else if(typeof val==="number"){val=val&255}if(start<0||this.length<start||this.length<end){throw new RangeError("Out of range index")}if(end<=start){return this}start=start>>>0;end=end===void 0?this.length:end>>>0;if(!val)val=0;var i3;if(typeof val==="number"){for(i3=start;i3<end;++i3){this[i3]=val}}else{var bytes=Buffer2.isBuffer(val)?val:new Buffer2(val,encoding);var len=bytes.length;for(i3=0;i3<end-start;++i3){this[i3+start]=bytes[i3%len]}}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(str3){str3=str3.trim().replace(INVALID_BASE64_RE,"");if(str3.length<2)return"";while(str3.length%4!==0){str3=str3+"="}return str3}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i3=0;i3<length;++i3){codePoint=string.charCodeAt(i3);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i3+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189)}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str3){var byteArray=[];for(var i3=0;i3<str3.length;++i3){byteArray.push(str3.charCodeAt(i3)&255)}return byteArray}function utf16leToBytes(str3,units){var c,hi,lo;var byteArray=[];for(var i3=0;i3<str3.length;++i3){if((units-=2)<0)break;c=str3.charCodeAt(i3);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str3){return base64.toByteArray(base64clean(str3))}function blitBuffer(src,dst,offset,length){for(var i3=0;i3<length;++i3){if(i3+offset>=dst.length||i3>=src.length)break;dst[i3+offset]=src[i3]}return i3}function isArrayBuffer(obj){return obj instanceof ArrayBuffer||obj!=null&&obj.constructor!=null&&obj.constructor.name==="ArrayBuffer"&&typeof obj.byteLength==="number"}function isArrayBufferView(obj){return typeof ArrayBuffer.isView==="function"&&ArrayBuffer.isView(obj)}function numberIsNaN(obj){return obj!==obj}}).call(exports2,__webpack_require__(1))},function(module22,exports2){"use strict";exports2.byteLength=byteLength;exports2.toByteArray=toByteArray;exports2.fromByteArray=fromByteArray;var lookup=[];var revLookup=[];var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i3=0,len=code.length;i3<len;++i3){lookup[i3]=code[i3];revLookup[code.charCodeAt(i3)]=i3}revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function placeHoldersCount(b64){var len2=b64.length;if(len2%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}return b64[len2-2]==="="?2:b64[len2-1]==="="?1:0}function byteLength(b64){return b64.length*3/4-placeHoldersCount(b64)}function toByteArray(b64){var i22,j,l,tmp,placeHolders,arr;var len2=b64.length;placeHolders=placeHoldersCount(b64);arr=new Arr(len2*3/4-placeHolders);l=placeHolders>0?len2-4:len2;var L2=0;for(i22=0,j=0;i22<l;i22+=4,j+=3){tmp=revLookup[b64.charCodeAt(i22)]<<18|revLookup[b64.charCodeAt(i22+1)]<<12|revLookup[b64.charCodeAt(i22+2)]<<6|revLookup[b64.charCodeAt(i22+3)];arr[L2++]=tmp>>16&255;arr[L2++]=tmp>>8&255;arr[L2++]=tmp&255}if(placeHolders===2){tmp=revLookup[b64.charCodeAt(i22)]<<2|revLookup[b64.charCodeAt(i22+1)]>>4;arr[L2++]=tmp&255}else if(placeHolders===1){tmp=revLookup[b64.charCodeAt(i22)]<<10|revLookup[b64.charCodeAt(i22+1)]<<4|revLookup[b64.charCodeAt(i22+2)]>>2;arr[L2++]=tmp>>8&255;arr[L2++]=tmp&255}return arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}function encodeChunk(uint8,start,end){var tmp;var output=[];for(var i22=start;i22<end;i22+=3){tmp=(uint8[i22]<<16)+(uint8[i22+1]<<8)+uint8[i22+2];output.push(tripletToBase64(tmp))}return output.join("")}function fromByteArray(uint8){var tmp;var len2=uint8.length;var extraBytes=len2%3;var output="";var parts=[];var maxChunkLength=16383;for(var i22=0,len22=len2-extraBytes;i22<len22;i22+=maxChunkLength){parts.push(encodeChunk(uint8,i22,i22+maxChunkLength>len22?len22:i22+maxChunkLength))}if(extraBytes===1){tmp=uint8[len2-1];output+=lookup[tmp>>2];output+=lookup[tmp<<4&63];output+="=="}else if(extraBytes===2){tmp=(uint8[len2-2]<<8)+uint8[len2-1];output+=lookup[tmp>>10];output+=lookup[tmp>>4&63];output+=lookup[tmp<<2&63];output+="="}parts.push(output);return parts.join("")}},function(module22,exports2){exports2.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i3=isLE?nBytes-1:0;var d2=isLE?-1:1;var s=buffer[offset+i3];i3+=d2;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i3],i3+=d2,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i3],i3+=d2,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports2.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i3=isLE?0:nBytes-1;var d2=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i3]=m&255,i3+=d2,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i3]=e&255,i3+=d2,e/=256,eLen-=8){}buffer[offset+i3-d2]|=s*128}},function(module22,exports2){module22.exports=function(module3){if(!module3.webpackPolyfill){module3.deprecate=function(){};module3.paths=[];module3.children=[];module3.webpackPolyfill=1}return module3}},function(module22,exports2,__webpack_require__){"use strict";var Process=__webpack_require__(7);var process=new Process,processProxy={};function defineKey(key2){if(processProxy[key2]){return}if(typeof process[key2]==="function"){processProxy[key2]=function(){return process[key2].apply(process,arguments)}}else{processProxy[key2]=process[key2]}}for(var key in process){defineKey(key)}processProxy.initializeTTYs=function(){if(process.stdin===null){process.initializeTTYs();processProxy.stdin=process.stdin;processProxy.stdout=process.stdout;processProxy.stderr=process.stderr}};process.nextTick(function(){processProxy.initializeTTYs()});module22.exports=processProxy},function(module22,exports2,__webpack_require__){(function(__dirname){"use strict";var __extends=this&&this.__extends||function(d2,b){for(var p2 in b)if(b.hasOwnProperty(p2))d2[p2]=b[p2];function __(){this.constructor=d2}d2.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)};var events=__webpack_require__(8);var path=null;var Item=function(){function Item2(fun,array){this.fun=fun;this.array=array}Item2.prototype.run=function(){this.fun.apply(null,this.array)};return Item2}();var NextTickQueue=function(){function NextTickQueue2(){this._queue=[];this._draining=false;this._currentQueue=null;this._queueIndex=-1}NextTickQueue2.prototype.push=function(item){var _this=this;if(this._queue.push(item)===1&&!this._draining){setTimeout(function(){return _this._drainQueue()},0)}};NextTickQueue2.prototype._cleanUpNextTick=function(){this._draining=false;if(this._currentQueue&&this._currentQueue.length){this._queue=this._currentQueue.concat(this._queue)}else{this._queueIndex=-1}if(this._queue.length){this._drainQueue()}};NextTickQueue2.prototype._drainQueue=function(){var _this=this;if(this._draining){return}var timeout=setTimeout(function(){return _this._cleanUpNextTick()});this._draining=true;var len=this._queue.length;while(len){this._currentQueue=this._queue;this._queue=[];while(++this._queueIndex<len){if(this._currentQueue){this._currentQueue[this._queueIndex].run()}}this._queueIndex=-1;len=this._queue.length}this._currentQueue=null;this._draining=false;clearTimeout(timeout)};return NextTickQueue2}();var Process=function(_super){__extends(Process2,_super);function Process2(){_super.apply(this,arguments);this.startTime=Date.now();this._cwd="/";this.platform="browser";this.argv=[];this.execArgv=[];this.stdout=null;this.stderr=null;this.stdin=null;this.domain=null;this._queue=new NextTickQueue;this.execPath=__dirname;this.env={};this.exitCode=0;this._gid=1;this._uid=1;this.version="v5.0";this.versions={http_parser:"0.0",node:"5.0",v8:"0.0",uv:"0.0",zlib:"0.0",ares:"0.0",icu:"0.0",modules:"0",openssl:"0.0"};this.config={target_defaults:{cflags:[],default_configuration:"Release",defines:[],include_dirs:[],libraries:[]},variables:{clang:0,host_arch:"x32",node_install_npm:false,node_install_waf:false,node_prefix:"",node_shared_cares:false,node_shared_http_parser:false,node_shared_libuv:false,node_shared_zlib:false,node_shared_v8:false,node_use_dtrace:false,node_use_etw:false,node_use_openssl:false,node_shared_openssl:false,strict_aliasing:false,target_arch:"x32",v8_use_snapshot:false,v8_no_strict_aliasing:0,visibility:""}};this.pid=Math.random()*1e3|0;this.title="node";this.arch="x32";this._mask=18;this.connected=void 0}Process2.prototype.chdir=function(dir){if(path===null){path=__webpack_require__(9)}this._cwd=path.resolve(dir)};Process2.prototype.cwd=function(){return this._cwd};Process2.prototype.uptime=function(){return(Date.now()-this.startTime)/1e3|0};Process2.prototype.nextTick=function(fun){var args=[];for(var _i=1;_i<arguments.length;_i++){args[_i-1]=arguments[_i]}this._queue.push(new Item(fun,args))};Process2.prototype.abort=function(){this.emit("abort")};Process2.prototype.exit=function(code){this.exitCode=code;this.emit("exit",[code])};Process2.prototype.getgid=function(){return this._gid};Process2.prototype.setgid=function(gid){if(typeof gid==="number"){this._gid=gid}else{this._gid=1}};Process2.prototype.getuid=function(){return this._uid};Process2.prototype.setuid=function(uid){if(typeof uid==="number"){this._uid=uid}else{this._uid=1}};Process2.prototype.kill=function(pid,signal){this.emit("kill",[pid,signal])};Process2.prototype.memoryUsage=function(){return{rss:0,heapTotal:0,heapUsed:0}};Process2.prototype.umask=function(mask){if(mask===void 0){mask=this._mask}var oldMask=this._mask;this._mask=mask;this.emit("umask",[mask]);return oldMask};Process2.prototype.hrtime=function(){var timeinfo;if(typeof performance!=="undefined"){timeinfo=performance.now()}else if(Date["now"]){timeinfo=Date.now()}else{timeinfo=new Date().getTime()}var secs=timeinfo/1e3|0;timeinfo-=secs*1e3;timeinfo=timeinfo*1e6|0;return[secs,timeinfo]};Process2.prototype.initializeTTYs=function(){if(this.stdout===null){var TTY=__webpack_require__(10);this.stdout=new TTY;this.stderr=new TTY;this.stdin=new TTY}};Process2.prototype.disconnect=function(){};return Process2}(events.EventEmitter);module22.exports=Process}).call(exports2,"/")},function(module22,exports2){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}module22.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=void 0;EventEmitter.prototype._maxListeners=void 0;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i3,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}else{var err=new Error(\'Uncaught, unspecified "error" event. (\'+er+")");err.context=er;throw err}}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction3(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1);handler.apply(this,args)}}else if(isObject(handler)){args=Array.prototype.slice.call(arguments,1);listeners=handler.slice();len=listeners.length;for(i3=0;i3<len;i3++)listeners[i3].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction3(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction3(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction3(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i3;if(!isFunction3(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction3(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i3=length;i3-- >0;){if(list[i3]===listener||list[i3].listener&&list[i3].listener===listener){position=i3;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction3(listeners)){this.removeListener(type,listeners)}else if(listeners){while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction3(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction3(evlistener))return 1;else if(evlistener)return evlistener.length}return 0};EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)};function isFunction3(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},function(module22,exports2,__webpack_require__){(function(process){"use strict";var splitPathRe=/^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;function posixSplitPath(filename){var out=splitPathRe.exec(filename);out.shift();return out}var path=function(){function path2(){}path2.normalize=function(p2){if(p2===""){p2="."}var absolute=p2.charAt(0)===path2.sep;p2=path2._removeDuplicateSeps(p2);var components=p2.split(path2.sep);var goodComponents=[];for(var idx=0;idx<components.length;idx++){var c=components[idx];if(c==="."){continue}else if(c===".."&&(absolute||!absolute&&goodComponents.length>0&&goodComponents[0]!=="..")){goodComponents.pop()}else{goodComponents.push(c)}}if(!absolute&&goodComponents.length<2){switch(goodComponents.length){case 1:if(goodComponents[0]===""){goodComponents.unshift(".")}break;default:goodComponents.push(".")}}p2=goodComponents.join(path2.sep);if(absolute&&p2.charAt(0)!==path2.sep){p2=path2.sep+p2}return p2};path2.join=function(){var paths=[];for(var _i=0;_i<arguments.length;_i++){paths[_i-0]=arguments[_i]}var processed=[];for(var i3=0;i3<paths.length;i3++){var segment=paths[i3];if(typeof segment!=="string"){throw new TypeError("Invalid argument type to path.join: "+typeof segment)}else if(segment!==""){processed.push(segment)}}return path2.normalize(processed.join(path2.sep))};path2.resolve=function(){var paths=[];for(var _i=0;_i<arguments.length;_i++){paths[_i-0]=arguments[_i]}var processed=[];for(var i3=0;i3<paths.length;i3++){var p2=paths[i3];if(typeof p2!=="string"){throw new TypeError("Invalid argument type to path.join: "+typeof p2)}else if(p2!==""){if(p2.charAt(0)===path2.sep){processed=[]}processed.push(p2)}}var resolved=path2.normalize(processed.join(path2.sep));if(resolved.length>1&&resolved.charAt(resolved.length-1)===path2.sep){return resolved.substr(0,resolved.length-1)}if(resolved.charAt(0)!==path2.sep){if(resolved.charAt(0)==="."&&(resolved.length===1||resolved.charAt(1)===path2.sep)){resolved=resolved.length===1?"":resolved.substr(2)}var cwd=process.cwd();if(resolved!==""){resolved=this.normalize(cwd+(cwd!=="/"?path2.sep:"")+resolved)}else{resolved=cwd}}return resolved};path2.relative=function(from,to){var i3;from=path2.resolve(from);to=path2.resolve(to);var fromSegs=from.split(path2.sep);var toSegs=to.split(path2.sep);toSegs.shift();fromSegs.shift();var upCount=0;var downSegs=[];for(i3=0;i3<fromSegs.length;i3++){var seg=fromSegs[i3];if(seg===toSegs[i3]){continue}upCount=fromSegs.length-i3;break}downSegs=toSegs.slice(i3);if(fromSegs.length===1&&fromSegs[0]===""){upCount=0}if(upCount>fromSegs.length){upCount=fromSegs.length}var rv="";for(i3=0;i3<upCount;i3++){rv+="../"}rv+=downSegs.join(path2.sep);if(rv.length>1&&rv.charAt(rv.length-1)===path2.sep){rv=rv.substr(0,rv.length-1)}return rv};path2.dirname=function(p2){p2=path2._removeDuplicateSeps(p2);var absolute=p2.charAt(0)===path2.sep;var sections=p2.split(path2.sep);if(sections.pop()===""&&sections.length>0){sections.pop()}if(sections.length>1||sections.length===1&&!absolute){return sections.join(path2.sep)}else if(absolute){return path2.sep}else{return"."}};path2.basename=function(p2,ext){if(ext===void 0){ext=""}if(p2===""){return p2}p2=path2.normalize(p2);var sections=p2.split(path2.sep);var lastPart=sections[sections.length-1];if(lastPart===""&&sections.length>1){return sections[sections.length-2]}if(ext.length>0){var lastPartExt=lastPart.substr(lastPart.length-ext.length);if(lastPartExt===ext){return lastPart.substr(0,lastPart.length-ext.length)}}return lastPart};path2.extname=function(p2){p2=path2.normalize(p2);var sections=p2.split(path2.sep);p2=sections.pop();if(p2===""&&sections.length>0){p2=sections.pop()}if(p2===".."){return""}var i3=p2.lastIndexOf(".");if(i3===-1||i3===0){return""}return p2.substr(i3)};path2.isAbsolute=function(p2){return p2.length>0&&p2.charAt(0)===path2.sep};path2._makeLong=function(p2){return p2};path2.parse=function(p2){var allParts=posixSplitPath(p2);return{root:allParts[0],dir:allParts[0]+allParts[1].slice(0,-1),base:allParts[2],ext:allParts[3],name:allParts[2].slice(0,allParts[2].length-allParts[3].length)}};path2.format=function(pathObject){if(pathObject===null||typeof pathObject!=="object"){throw new TypeError("Parameter \'pathObject\' must be an object, not "+typeof pathObject)}var root=pathObject.root||"";if(typeof root!=="string"){throw new TypeError("\'pathObject.root\' must be a string or undefined, not "+typeof pathObject.root)}var dir=pathObject.dir?pathObject.dir+path2.sep:"";var base=pathObject.base||"";return dir+base};path2._removeDuplicateSeps=function(p2){p2=p2.replace(this._replaceRegex,this.sep);return p2};path2.sep="/";path2._replaceRegex=new RegExp("//+","g");path2.delimiter=":";path2.posix=path2;path2.win32=path2;return path2}();var _=path;module22.exports=path}).call(exports2,__webpack_require__(6))},function(module22,exports2,__webpack_require__){(function(Buffer2){"use strict";var __extends=this&&this.__extends||function(d2,b){for(var p2 in b)if(b.hasOwnProperty(p2))d2[p2]=b[p2];function __(){this.constructor=d2}d2.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)};var stream=__webpack_require__(11);var TTY=function(_super){__extends(TTY2,_super);function TTY2(){_super.call(this);this.isRaw=false;this.columns=80;this.rows=120;this.isTTY=true;this._bufferedWrites=[];this._waitingForWrites=false}TTY2.prototype.setRawMode=function(mode){if(this.isRaw!==mode){this.isRaw=mode;this.emit("modeChange")}};TTY2.prototype.changeColumns=function(columns){if(columns!==this.columns){this.columns=columns;this.emit("resize")}};TTY2.prototype.changeRows=function(rows){if(rows!==this.rows){this.rows=rows;this.emit("resize")}};TTY2.isatty=function(fd){return fd&&fd instanceof TTY2};TTY2.prototype._write=function(chunk,encoding,cb){var error;try{var data;if(typeof chunk==="string"){data=new Buffer2(chunk,encoding)}else{data=chunk}this._bufferedWrites.push(data);if(this._waitingForWrites){this._read(1024)}}catch(e){error=e}finally{cb(error)}};TTY2.prototype._read=function(size){if(this._bufferedWrites.length===0){this._waitingForWrites=true}else{while(this._bufferedWrites.length>0){this._waitingForWrites=this.push(this._bufferedWrites.shift());if(!this._waitingForWrites){break}}}};return TTY2}(stream.Duplex);module22.exports=TTY}).call(exports2,__webpack_require__(1))},function(module22,exports2,__webpack_require__){module22.exports=Stream;var EE=__webpack_require__(8).EventEmitter;var inherits=__webpack_require__(12);inherits(Stream,EE);Stream.Readable=__webpack_require__(13);Stream.Writable=__webpack_require__(27);Stream.Duplex=__webpack_require__(28);Stream.Transform=__webpack_require__(29);Stream.PassThrough=__webpack_require__(30);Stream.Stream=Stream;function Stream(){EE.call(this)}Stream.prototype.pipe=function(dest,options){var source=this;function ondata(chunk){if(dest.writable){if(false===dest.write(chunk)&&source.pause){source.pause()}}}source.on("data",ondata);function ondrain(){if(source.readable&&source.resume){source.resume()}}dest.on("drain",ondrain);if(!dest._isStdio&&(!options||options.end!==false)){source.on("end",onend);source.on("close",onclose)}var didOnEnd=false;function onend(){if(didOnEnd)return;didOnEnd=true;dest.end()}function onclose(){if(didOnEnd)return;didOnEnd=true;if(typeof dest.destroy==="function")dest.destroy()}function onerror(er){cleanup();if(EE.listenerCount(this,"error")===0){throw er}}source.on("error",onerror);dest.on("error",onerror);function cleanup(){source.removeListener("data",ondata);dest.removeListener("drain",ondrain);source.removeListener("end",onend);source.removeListener("close",onclose);source.removeListener("error",onerror);dest.removeListener("error",onerror);source.removeListener("end",cleanup);source.removeListener("close",cleanup);dest.removeListener("close",cleanup)}source.on("end",cleanup);source.on("close",cleanup);dest.on("close",cleanup);dest.emit("pipe",source);return dest}},function(module22,exports2){if(typeof Object.create==="function"){module22.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}else{module22.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}},function(module22,exports2,__webpack_require__){(function(process){var Stream=function(){try{return __webpack_require__(11)}catch(_){}}();exports2=module22.exports=__webpack_require__(14);exports2.Stream=Stream||exports2;exports2.Readable=exports2;exports2.Writable=__webpack_require__(22);exports2.Duplex=__webpack_require__(21);exports2.Transform=__webpack_require__(25);exports2.PassThrough=__webpack_require__(26);if(!process.browser&&process.env.READABLE_STREAM==="disable"&&Stream){module22.exports=Stream}}).call(exports2,__webpack_require__(6))},function(module22,exports2,__webpack_require__){(function(process){"use strict";module22.exports=Readable;var processNextTick=__webpack_require__(15);var isArray=__webpack_require__(16);var Duplex;Readable.ReadableState=ReadableState;var EE=__webpack_require__(8).EventEmitter;var EElistenerCount=function(emitter,type){return emitter.listeners(type).length};var Stream;(function(){try{Stream=__webpack_require__(11)}catch(_){}finally{if(!Stream)Stream=__webpack_require__(8).EventEmitter}})();var Buffer2=__webpack_require__(2).Buffer;var bufferShim=__webpack_require__(17);var util=__webpack_require__(18);util.inherits=__webpack_require__(12);var debugUtil=__webpack_require__(19);var debug=void 0;if(debugUtil&&debugUtil.debuglog){debug=debugUtil.debuglog("stream")}else{debug=function(){}}var BufferList=__webpack_require__(20);var StringDecoder;util.inherits(Readable,Stream);function prependListener(emitter,event,fn){if(typeof emitter.prependListener==="function"){return emitter.prependListener(event,fn)}else{if(!emitter._events||!emitter._events[event])emitter.on(event,fn);else if(isArray(emitter._events[event]))emitter._events[event].unshift(fn);else emitter._events[event]=[fn,emitter._events[event]]}}function ReadableState(options,stream){Duplex=Duplex||__webpack_require__(21);options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)this.objectMode=this.objectMode||!!options.readableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=hwm||hwm===0?hwm:defaultHwm;this.highWaterMark=~~this.highWaterMark;this.buffer=new BufferList;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.defaultEncoding=options.defaultEncoding||"utf8";this.ranOut=false;this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(options.encoding){if(!StringDecoder)StringDecoder=__webpack_require__(24).StringDecoder;this.decoder=new StringDecoder(options.encoding);this.encoding=options.encoding}}function Readable(options){Duplex=Duplex||__webpack_require__(21);if(!(this instanceof Readable))return new Readable(options);this._readableState=new ReadableState(options,this);this.readable=true;if(options&&typeof options.read==="function")this._read=options.read;Stream.call(this)}Readable.prototype.push=function(chunk,encoding){var state4=this._readableState;if(!state4.objectMode&&typeof chunk==="string"){encoding=encoding||state4.defaultEncoding;if(encoding!==state4.encoding){chunk=bufferShim.from(chunk,encoding);encoding=""}}return readableAddChunk(this,state4,chunk,encoding,false)};Readable.prototype.unshift=function(chunk){var state4=this._readableState;return readableAddChunk(this,state4,chunk,"",true)};Readable.prototype.isPaused=function(){return this._readableState.flowing===false};function readableAddChunk(stream,state4,chunk,encoding,addToFront){var er=chunkInvalid(state4,chunk);if(er){stream.emit("error",er)}else if(chunk===null){state4.reading=false;onEofChunk(stream,state4)}else if(state4.objectMode||chunk&&chunk.length>0){if(state4.ended&&!addToFront){var e=new Error("stream.push() after EOF");stream.emit("error",e)}else if(state4.endEmitted&&addToFront){var _e=new Error("stream.unshift() after end event");stream.emit("error",_e)}else{var skipAdd;if(state4.decoder&&!addToFront&&!encoding){chunk=state4.decoder.write(chunk);skipAdd=!state4.objectMode&&chunk.length===0}if(!addToFront)state4.reading=false;if(!skipAdd){if(state4.flowing&&state4.length===0&&!state4.sync){stream.emit("data",chunk);stream.read(0)}else{state4.length+=state4.objectMode?1:chunk.length;if(addToFront)state4.buffer.unshift(chunk);else state4.buffer.push(chunk);if(state4.needReadable)emitReadable(stream)}}maybeReadMore(stream,state4)}}else if(!addToFront){state4.reading=false}return needMoreData(state4)}function needMoreData(state4){return!state4.ended&&(state4.needReadable||state4.length<state4.highWaterMark||state4.length===0)}Readable.prototype.setEncoding=function(enc){if(!StringDecoder)StringDecoder=__webpack_require__(24).StringDecoder;this._readableState.decoder=new StringDecoder(enc);this._readableState.encoding=enc;return this};var MAX_HWM=8388608;function computeNewHighWaterMark(n){if(n>=MAX_HWM){n=MAX_HWM}else{n--;n|=n>>>1;n|=n>>>2;n|=n>>>4;n|=n>>>8;n|=n>>>16;n++}return n}function howMuchToRead(n,state4){if(n<=0||state4.length===0&&state4.ended)return 0;if(state4.objectMode)return 1;if(n!==n){if(state4.flowing&&state4.length)return state4.buffer.head.data.length;else return state4.length}if(n>state4.highWaterMark)state4.highWaterMark=computeNewHighWaterMark(n);if(n<=state4.length)return n;if(!state4.ended){state4.needReadable=true;return 0}return state4.length}Readable.prototype.read=function(n){debug("read",n);n=parseInt(n,10);var state4=this._readableState;var nOrig=n;if(n!==0)state4.emittedReadable=false;if(n===0&&state4.needReadable&&(state4.length>=state4.highWaterMark||state4.ended)){debug("read: emitReadable",state4.length,state4.ended);if(state4.length===0&&state4.ended)endReadable(this);else emitReadable(this);return null}n=howMuchToRead(n,state4);if(n===0&&state4.ended){if(state4.length===0)endReadable(this);return null}var doRead=state4.needReadable;debug("need readable",doRead);if(state4.length===0||state4.length-n<state4.highWaterMark){doRead=true;debug("length less than watermark",doRead)}if(state4.ended||state4.reading){doRead=false;debug("reading or ended",doRead)}else if(doRead){debug("do read");state4.reading=true;state4.sync=true;if(state4.length===0)state4.needReadable=true;this._read(state4.highWaterMark);state4.sync=false;if(!state4.reading)n=howMuchToRead(nOrig,state4)}var ret;if(n>0)ret=fromList(n,state4);else ret=null;if(ret===null){state4.needReadable=true;n=0}else{state4.length-=n}if(state4.length===0){if(!state4.ended)state4.needReadable=true;if(nOrig!==n&&state4.ended)endReadable(this)}if(ret!==null)this.emit("data",ret);return ret};function chunkInvalid(state4,chunk){var er=null;if(!Buffer2.isBuffer(chunk)&&typeof chunk!=="string"&&chunk!==null&&chunk!==void 0&&!state4.objectMode){er=new TypeError("Invalid non-string/buffer chunk")}return er}function onEofChunk(stream,state4){if(state4.ended)return;if(state4.decoder){var chunk=state4.decoder.end();if(chunk&&chunk.length){state4.buffer.push(chunk);state4.length+=state4.objectMode?1:chunk.length}}state4.ended=true;emitReadable(stream)}function emitReadable(stream){var state4=stream._readableState;state4.needReadable=false;if(!state4.emittedReadable){debug("emitReadable",state4.flowing);state4.emittedReadable=true;if(state4.sync)processNextTick(emitReadable_,stream);else emitReadable_(stream)}}function emitReadable_(stream){debug("emit readable");stream.emit("readable");flow(stream)}function maybeReadMore(stream,state4){if(!state4.readingMore){state4.readingMore=true;processNextTick(maybeReadMore_,stream,state4)}}function maybeReadMore_(stream,state4){var len=state4.length;while(!state4.reading&&!state4.flowing&&!state4.ended&&state4.length<state4.highWaterMark){debug("maybeReadMore read 0");stream.read(0);if(len===state4.length)break;else len=state4.length}state4.readingMore=false}Readable.prototype._read=function(n){this.emit("error",new Error("_read() is not implemented"))};Readable.prototype.pipe=function(dest,pipeOpts){var src=this;var state4=this._readableState;switch(state4.pipesCount){case 0:state4.pipes=dest;break;case 1:state4.pipes=[state4.pipes,dest];break;default:state4.pipes.push(dest);break}state4.pipesCount+=1;debug("pipe count=%d opts=%j",state4.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==false)&&dest!==process.stdout&&dest!==process.stderr;var endFn=doEnd?onend:cleanup;if(state4.endEmitted)processNextTick(endFn);else src.once("end",endFn);dest.on("unpipe",onunpipe);function onunpipe(readable){debug("onunpipe");if(readable===src){cleanup()}}function onend(){debug("onend");dest.end()}var ondrain=pipeOnDrain(src);dest.on("drain",ondrain);var cleanedUp=false;function cleanup(){debug("cleanup");dest.removeListener("close",onclose);dest.removeListener("finish",onfinish);dest.removeListener("drain",ondrain);dest.removeListener("error",onerror);dest.removeListener("unpipe",onunpipe);src.removeListener("end",onend);src.removeListener("end",cleanup);src.removeListener("data",ondata);cleanedUp=true;if(state4.awaitDrain&&(!dest._writableState||dest._writableState.needDrain))ondrain()}var increasedAwaitDrain=false;src.on("data",ondata);function ondata(chunk){debug("ondata");increasedAwaitDrain=false;var ret=dest.write(chunk);if(false===ret&&!increasedAwaitDrain){if((state4.pipesCount===1&&state4.pipes===dest||state4.pipesCount>1&&indexOf(state4.pipes,dest)!==-1)&&!cleanedUp){debug("false write response, pause",src._readableState.awaitDrain);src._readableState.awaitDrain++;increasedAwaitDrain=true}src.pause()}}function onerror(er){debug("onerror",er);unpipe();dest.removeListener("error",onerror);if(EElistenerCount(dest,"error")===0)dest.emit("error",er)}prependListener(dest,"error",onerror);function onclose(){dest.removeListener("finish",onfinish);unpipe()}dest.once("close",onclose);function onfinish(){debug("onfinish");dest.removeListener("close",onclose);unpipe()}dest.once("finish",onfinish);function unpipe(){debug("unpipe");src.unpipe(dest)}dest.emit("pipe",src);if(!state4.flowing){debug("pipe resume");src.resume()}return dest};function pipeOnDrain(src){return function(){var state4=src._readableState;debug("pipeOnDrain",state4.awaitDrain);if(state4.awaitDrain)state4.awaitDrain--;if(state4.awaitDrain===0&&EElistenerCount(src,"data")){state4.flowing=true;flow(src)}}}Readable.prototype.unpipe=function(dest){var state4=this._readableState;if(state4.pipesCount===0)return this;if(state4.pipesCount===1){if(dest&&dest!==state4.pipes)return this;if(!dest)dest=state4.pipes;state4.pipes=null;state4.pipesCount=0;state4.flowing=false;if(dest)dest.emit("unpipe",this);return this}if(!dest){var dests=state4.pipes;var len=state4.pipesCount;state4.pipes=null;state4.pipesCount=0;state4.flowing=false;for(var i3=0;i3<len;i3++){dests[i3].emit("unpipe",this)}return this}var index=indexOf(state4.pipes,dest);if(index===-1)return this;state4.pipes.splice(index,1);state4.pipesCount-=1;if(state4.pipesCount===1)state4.pipes=state4.pipes[0];dest.emit("unpipe",this);return this};Readable.prototype.on=function(ev2,fn){var res=Stream.prototype.on.call(this,ev2,fn);if(ev2==="data"){if(this._readableState.flowing!==false)this.resume()}else if(ev2==="readable"){var state4=this._readableState;if(!state4.endEmitted&&!state4.readableListening){state4.readableListening=state4.needReadable=true;state4.emittedReadable=false;if(!state4.reading){processNextTick(nReadingNextTick,this)}else if(state4.length){emitReadable(this,state4)}}}return res};Readable.prototype.addListener=Readable.prototype.on;function nReadingNextTick(self2){debug("readable nexttick read 0");self2.read(0)}Readable.prototype.resume=function(){var state4=this._readableState;if(!state4.flowing){debug("resume");state4.flowing=true;resume(this,state4)}return this};function resume(stream,state4){if(!state4.resumeScheduled){state4.resumeScheduled=true;processNextTick(resume_,stream,state4)}}function resume_(stream,state4){if(!state4.reading){debug("resume read 0");stream.read(0)}state4.resumeScheduled=false;state4.awaitDrain=0;stream.emit("resume");flow(stream);if(state4.flowing&&!state4.reading)stream.read(0)}Readable.prototype.pause=function(){debug("call pause flowing=%j",this._readableState.flowing);if(false!==this._readableState.flowing){debug("pause");this._readableState.flowing=false;this.emit("pause")}return this};function flow(stream){var state4=stream._readableState;debug("flow",state4.flowing);while(state4.flowing&&stream.read()!==null){}}Readable.prototype.wrap=function(stream){var state4=this._readableState;var paused=false;var self2=this;stream.on("end",function(){debug("wrapped end");if(state4.decoder&&!state4.ended){var chunk=state4.decoder.end();if(chunk&&chunk.length)self2.push(chunk)}self2.push(null)});stream.on("data",function(chunk){debug("wrapped data");if(state4.decoder)chunk=state4.decoder.write(chunk);if(state4.objectMode&&(chunk===null||chunk===void 0))return;else if(!state4.objectMode&&(!chunk||!chunk.length))return;var ret=self2.push(chunk);if(!ret){paused=true;stream.pause()}});for(var i3 in stream){if(this[i3]===void 0&&typeof stream[i3]==="function"){this[i3]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i3)}}var events=["error","close","destroy","pause","resume"];forEach(events,function(ev2){stream.on(ev2,self2.emit.bind(self2,ev2))});self2._read=function(n){debug("wrapped _read",n);if(paused){paused=false;stream.resume()}};return self2};Readable._fromList=fromList;function fromList(n,state4){if(state4.length===0)return null;var ret;if(state4.objectMode)ret=state4.buffer.shift();else if(!n||n>=state4.length){if(state4.decoder)ret=state4.buffer.join("");else if(state4.buffer.length===1)ret=state4.buffer.head.data;else ret=state4.buffer.concat(state4.length);state4.buffer.clear()}else{ret=fromListPartial(n,state4.buffer,state4.decoder)}return ret}function fromListPartial(n,list,hasStrings){var ret;if(n<list.head.data.length){ret=list.head.data.slice(0,n);list.head.data=list.head.data.slice(n)}else if(n===list.head.data.length){ret=list.shift()}else{ret=hasStrings?copyFromBufferString(n,list):copyFromBuffer(n,list)}return ret}function copyFromBufferString(n,list){var p2=list.head;var c=1;var ret=p2.data;n-=ret.length;while(p2=p2.next){var str3=p2.data;var nb=n>str3.length?str3.length:n;if(nb===str3.length)ret+=str3;else ret+=str3.slice(0,n);n-=nb;if(n===0){if(nb===str3.length){++c;if(p2.next)list.head=p2.next;else list.head=list.tail=null}else{list.head=p2;p2.data=str3.slice(nb)}break}++c}list.length-=c;return ret}function copyFromBuffer(n,list){var ret=bufferShim.allocUnsafe(n);var p2=list.head;var c=1;p2.data.copy(ret);n-=p2.data.length;while(p2=p2.next){var buf=p2.data;var nb=n>buf.length?buf.length:n;buf.copy(ret,ret.length-n,0,nb);n-=nb;if(n===0){if(nb===buf.length){++c;if(p2.next)list.head=p2.next;else list.head=list.tail=null}else{list.head=p2;p2.data=buf.slice(nb)}break}++c}list.length-=c;return ret}function endReadable(stream){var state4=stream._readableState;if(state4.length>0)throw new Error(\'"endReadable()" called on non-empty stream\');if(!state4.endEmitted){state4.ended=true;processNextTick(endReadableNT,state4,stream)}}function endReadableNT(state4,stream){if(!state4.endEmitted&&state4.length===0){state4.endEmitted=true;stream.readable=false;stream.emit("end")}}function forEach(xs,f){for(var i3=0,l=xs.length;i3<l;i3++){f(xs[i3],i3)}}function indexOf(xs,x3){for(var i3=0,l=xs.length;i3<l;i3++){if(xs[i3]===x3)return i3}return-1}}).call(exports2,__webpack_require__(6))},function(module22,exports2,__webpack_require__){(function(process){"use strict";if(!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0){module22.exports=nextTick}else{module22.exports=process.nextTick}function nextTick(fn,arg1,arg2,arg3){if(typeof fn!=="function"){throw new TypeError(\'"callback" argument must be a function\')}var len=arguments.length;var args,i3;switch(len){case 0:case 1:return process.nextTick(fn);case 2:return process.nextTick(function afterTickOne(){fn.call(null,arg1)});case 3:return process.nextTick(function afterTickTwo(){fn.call(null,arg1,arg2)});case 4:return process.nextTick(function afterTickThree(){fn.call(null,arg1,arg2,arg3)});default:args=new Array(len-1);i3=0;while(i3<args.length){args[i3++]=arguments[i3]}return process.nextTick(function afterTick(){fn.apply(null,args)})}}}).call(exports2,__webpack_require__(6))},function(module22,exports2){var toString={}.toString;module22.exports=Array.isArray||function(arr){return toString.call(arr)=="[object Array]"}},function(module22,exports2,__webpack_require__){(function(global2){"use strict";var buffer=__webpack_require__(2);var Buffer2=buffer.Buffer;var SlowBuffer=buffer.SlowBuffer;var MAX_LEN=buffer.kMaxLength||2147483647;exports2.alloc=function alloc(size,fill,encoding){if(typeof Buffer2.alloc==="function"){return Buffer2.alloc(size,fill,encoding)}if(typeof encoding==="number"){throw new TypeError("encoding must not be number")}if(typeof size!=="number"){throw new TypeError("size must be a number")}if(size>MAX_LEN){throw new RangeError("size is too large")}var enc=encoding;var _fill=fill;if(_fill===void 0){enc=void 0;_fill=0}var buf=new Buffer2(size);if(typeof _fill==="string"){var fillBuf=new Buffer2(_fill,enc);var flen=fillBuf.length;var i3=-1;while(++i3<size){buf[i3]=fillBuf[i3%flen]}}else{buf.fill(_fill)}return buf};exports2.allocUnsafe=function allocUnsafe(size){if(typeof Buffer2.allocUnsafe==="function"){return Buffer2.allocUnsafe(size)}if(typeof size!=="number"){throw new TypeError("size must be a number")}if(size>MAX_LEN){throw new RangeError("size is too large")}return new Buffer2(size)};exports2.from=function from(value,encodingOrOffset,length){if(typeof Buffer2.from==="function"&&(!global2.Uint8Array||Uint8Array.from!==Buffer2.from)){return Buffer2.from(value,encodingOrOffset,length)}if(typeof value==="number"){throw new TypeError(\'"value" argument must not be a number\')}if(typeof value==="string"){return new Buffer2(value,encodingOrOffset)}if(typeof ArrayBuffer!=="undefined"&&value instanceof ArrayBuffer){var offset=encodingOrOffset;if(arguments.length===1){return new Buffer2(value)}if(typeof offset==="undefined"){offset=0}var len=length;if(typeof len==="undefined"){len=value.byteLength-offset}if(offset>=value.byteLength){throw new RangeError("\'offset\' is out of bounds")}if(len>value.byteLength-offset){throw new RangeError("\'length\' is out of bounds")}return new Buffer2(value.slice(offset,offset+len))}if(Buffer2.isBuffer(value)){var out=new Buffer2(value.length);value.copy(out,0,0,value.length);return out}if(value){if(Array.isArray(value)||typeof ArrayBuffer!=="undefined"&&value.buffer instanceof ArrayBuffer||"length"in value){return new Buffer2(value)}if(value.type==="Buffer"&&Array.isArray(value.data)){return new Buffer2(value.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")};exports2.allocUnsafeSlow=function allocUnsafeSlow(size){if(typeof Buffer2.allocUnsafeSlow==="function"){return Buffer2.allocUnsafeSlow(size)}if(typeof size!=="number"){throw new TypeError("size must be a number")}if(size>=MAX_LEN){throw new RangeError("size is too large")}return new SlowBuffer(size)}}).call(exports2,function(){return this}())},function(module22,exports2,__webpack_require__){(function(Buffer2){function isArray(arg){if(Array.isArray){return Array.isArray(arg)}return objectToString(arg)==="[object Array]"}exports2.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports2.isBoolean=isBoolean;function isNull(arg){return arg===null}exports2.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports2.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports2.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports2.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports2.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports2.isUndefined=isUndefined;function isRegExp(re){return objectToString(re)==="[object RegExp]"}exports2.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports2.isObject=isObject;function isDate(d2){return objectToString(d2)==="[object Date]"}exports2.isDate=isDate;function isError(e){return objectToString(e)==="[object Error]"||e instanceof Error}exports2.isError=isError;function isFunction3(arg){return typeof arg==="function"}exports2.isFunction=isFunction3;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports2.isPrimitive=isPrimitive;exports2.isBuffer=Buffer2.isBuffer;function objectToString(o){return Object.prototype.toString.call(o)}}).call(exports2,__webpack_require__(1))},function(module22,exports2){},function(module22,exports2,__webpack_require__){"use strict";var Buffer2=__webpack_require__(2).Buffer;var bufferShim=__webpack_require__(17);module22.exports=BufferList;function BufferList(){this.head=null;this.tail=null;this.length=0}BufferList.prototype.push=function(v2){var entry={data:v2,next:null};if(this.length>0)this.tail.next=entry;else this.head=entry;this.tail=entry;++this.length};BufferList.prototype.unshift=function(v2){var entry={data:v2,next:this.head};if(this.length===0)this.tail=entry;this.head=entry;++this.length};BufferList.prototype.shift=function(){if(this.length===0)return;var ret=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return ret};BufferList.prototype.clear=function(){this.head=this.tail=null;this.length=0};BufferList.prototype.join=function(s){if(this.length===0)return"";var p2=this.head;var ret=""+p2.data;while(p2=p2.next){ret+=s+p2.data}return ret};BufferList.prototype.concat=function(n){if(this.length===0)return bufferShim.alloc(0);if(this.length===1)return this.head.data;var ret=bufferShim.allocUnsafe(n>>>0);var p2=this.head;var i3=0;while(p2){p2.data.copy(ret,i3);i3+=p2.data.length;p2=p2.next}return ret}},function(module22,exports2,__webpack_require__){"use strict";var objectKeys=Object.keys||function(obj){var keys22=[];for(var key in obj){keys22.push(key)}return keys22};module22.exports=Duplex;var processNextTick=__webpack_require__(15);var util=__webpack_require__(18);util.inherits=__webpack_require__(12);var Readable=__webpack_require__(14);var Writable=__webpack_require__(22);util.inherits(Duplex,Readable);var keys3=objectKeys(Writable.prototype);for(var v2=0;v2<keys3.length;v2++){var method=keys3[v2];if(!Duplex.prototype[method])Duplex.prototype[method]=Writable.prototype[method]}function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options);Writable.call(this,options);if(options&&options.readable===false)this.readable=false;if(options&&options.writable===false)this.writable=false;this.allowHalfOpen=true;if(options&&options.allowHalfOpen===false)this.allowHalfOpen=false;this.once("end",onend)}function onend(){if(this.allowHalfOpen||this._writableState.ended)return;processNextTick(onEndNT,this)}function onEndNT(self2){self2.end()}function forEach(xs,f){for(var i3=0,l=xs.length;i3<l;i3++){f(xs[i3],i3)}}},function(module22,exports2,__webpack_require__){(function(process){"use strict";module22.exports=Writable;var processNextTick=__webpack_require__(15);var asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick;var Duplex;Writable.WritableState=WritableState;var util=__webpack_require__(18);util.inherits=__webpack_require__(12);var internalUtil={deprecate:__webpack_require__(23)};var Stream;(function(){try{Stream=__webpack_require__(11)}catch(_){}finally{if(!Stream)Stream=__webpack_require__(8).EventEmitter}})();var Buffer2=__webpack_require__(2).Buffer;var bufferShim=__webpack_require__(17);util.inherits(Writable,Stream);function nop(){}function WriteReq(chunk,encoding,cb){this.chunk=chunk;this.encoding=encoding;this.callback=cb;this.next=null}function WritableState(options,stream){Duplex=Duplex||__webpack_require__(21);options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)this.objectMode=this.objectMode||!!options.writableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=hwm||hwm===0?hwm:defaultHwm;this.highWaterMark=~~this.highWaterMark;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;var noDecode=options.decodeStrings===false;this.decodeStrings=!noDecode;this.defaultEncoding=options.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(er){onwrite(stream,er)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.bufferedRequestCount=0;this.corkedRequestsFree=new CorkedRequest(this)}WritableState.prototype.getBuffer=function getBuffer(){var current=this.bufferedRequest;var out=[];while(current){out.push(current);current=current.next}return out};(function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(_){}})();var realHasInstance;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){realHasInstance=Function.prototype[Symbol.hasInstance];Object.defineProperty(Writable,Symbol.hasInstance,{value:function(object){if(realHasInstance.call(this,object))return true;return object&&object._writableState instanceof WritableState}})}else{realHasInstance=function(object){return object instanceof this}}function Writable(options){Duplex=Duplex||__webpack_require__(21);if(!realHasInstance.call(Writable,this)&&!(this instanceof Duplex)){return new Writable(options)}this._writableState=new WritableState(options,this);this.writable=true;if(options){if(typeof options.write==="function")this._write=options.write;if(typeof options.writev==="function")this._writev=options.writev}Stream.call(this)}Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function writeAfterEnd(stream,cb){var er=new Error("write after end");stream.emit("error",er);processNextTick(cb,er)}function validChunk(stream,state4,chunk,cb){var valid=true;var er=false;if(chunk===null){er=new TypeError("May not write null values to stream")}else if(typeof chunk!=="string"&&chunk!==void 0&&!state4.objectMode){er=new TypeError("Invalid non-string/buffer chunk")}if(er){stream.emit("error",er);processNextTick(cb,er);valid=false}return valid}Writable.prototype.write=function(chunk,encoding,cb){var state4=this._writableState;var ret=false;var isBuf=Buffer2.isBuffer(chunk);if(typeof encoding==="function"){cb=encoding;encoding=null}if(isBuf)encoding="buffer";else if(!encoding)encoding=state4.defaultEncoding;if(typeof cb!=="function")cb=nop;if(state4.ended)writeAfterEnd(this,cb);else if(isBuf||validChunk(this,state4,chunk,cb)){state4.pendingcb++;ret=writeOrBuffer(this,state4,isBuf,chunk,encoding,cb)}return ret};Writable.prototype.cork=function(){var state4=this._writableState;state4.corked++};Writable.prototype.uncork=function(){var state4=this._writableState;if(state4.corked){state4.corked--;if(!state4.writing&&!state4.corked&&!state4.finished&&!state4.bufferProcessing&&state4.bufferedRequest)clearBuffer(this,state4)}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(encoding){if(typeof encoding==="string")encoding=encoding.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+encoding);this._writableState.defaultEncoding=encoding;return this};function decodeChunk(state4,chunk,encoding){if(!state4.objectMode&&state4.decodeStrings!==false&&typeof chunk==="string"){chunk=bufferShim.from(chunk,encoding)}return chunk}function writeOrBuffer(stream,state4,isBuf,chunk,encoding,cb){if(!isBuf){chunk=decodeChunk(state4,chunk,encoding);if(Buffer2.isBuffer(chunk))encoding="buffer"}var len=state4.objectMode?1:chunk.length;state4.length+=len;var ret=state4.length<state4.highWaterMark;if(!ret)state4.needDrain=true;if(state4.writing||state4.corked){var last=state4.lastBufferedRequest;state4.lastBufferedRequest=new WriteReq(chunk,encoding,cb);if(last){last.next=state4.lastBufferedRequest}else{state4.bufferedRequest=state4.lastBufferedRequest}state4.bufferedRequestCount+=1}else{doWrite(stream,state4,false,len,chunk,encoding,cb)}return ret}function doWrite(stream,state4,writev,len,chunk,encoding,cb){state4.writelen=len;state4.writecb=cb;state4.writing=true;state4.sync=true;if(writev)stream._writev(chunk,state4.onwrite);else stream._write(chunk,encoding,state4.onwrite);state4.sync=false}function onwriteError(stream,state4,sync,er,cb){--state4.pendingcb;if(sync)processNextTick(cb,er);else cb(er);stream._writableState.errorEmitted=true;stream.emit("error",er)}function onwriteStateUpdate(state4){state4.writing=false;state4.writecb=null;state4.length-=state4.writelen;state4.writelen=0}function onwrite(stream,er){var state4=stream._writableState;var sync=state4.sync;var cb=state4.writecb;onwriteStateUpdate(state4);if(er)onwriteError(stream,state4,sync,er,cb);else{var finished=needFinish(state4);if(!finished&&!state4.corked&&!state4.bufferProcessing&&state4.bufferedRequest){clearBuffer(stream,state4)}if(sync){asyncWrite(afterWrite,stream,state4,finished,cb)}else{afterWrite(stream,state4,finished,cb)}}}function afterWrite(stream,state4,finished,cb){if(!finished)onwriteDrain(stream,state4);state4.pendingcb--;cb();finishMaybe(stream,state4)}function onwriteDrain(stream,state4){if(state4.length===0&&state4.needDrain){state4.needDrain=false;stream.emit("drain")}}function clearBuffer(stream,state4){state4.bufferProcessing=true;var entry=state4.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state4.bufferedRequestCount;var buffer=new Array(l);var holder=state4.corkedRequestsFree;holder.entry=entry;var count=0;while(entry){buffer[count]=entry;entry=entry.next;count+=1}doWrite(stream,state4,true,state4.length,buffer,"",holder.finish);state4.pendingcb++;state4.lastBufferedRequest=null;if(holder.next){state4.corkedRequestsFree=holder.next;holder.next=null}else{state4.corkedRequestsFree=new CorkedRequest(state4)}}else{while(entry){var chunk=entry.chunk;var encoding=entry.encoding;var cb=entry.callback;var len=state4.objectMode?1:chunk.length;doWrite(stream,state4,false,len,chunk,encoding,cb);entry=entry.next;if(state4.writing){break}}if(entry===null)state4.lastBufferedRequest=null}state4.bufferedRequestCount=0;state4.bufferedRequest=entry;state4.bufferProcessing=false}Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("_write() is not implemented"))};Writable.prototype._writev=null;Writable.prototype.end=function(chunk,encoding,cb){var state4=this._writableState;if(typeof chunk==="function"){cb=chunk;chunk=null;encoding=null}else if(typeof encoding==="function"){cb=encoding;encoding=null}if(chunk!==null&&chunk!==void 0)this.write(chunk,encoding);if(state4.corked){state4.corked=1;this.uncork()}if(!state4.ending&&!state4.finished)endWritable(this,state4,cb)};function needFinish(state4){return state4.ending&&state4.length===0&&state4.bufferedRequest===null&&!state4.finished&&!state4.writing}function prefinish(stream,state4){if(!state4.prefinished){state4.prefinished=true;stream.emit("prefinish")}}function finishMaybe(stream,state4){var need=needFinish(state4);if(need){if(state4.pendingcb===0){prefinish(stream,state4);state4.finished=true;stream.emit("finish")}else{prefinish(stream,state4)}}return need}function endWritable(stream,state4,cb){state4.ending=true;finishMaybe(stream,state4);if(cb){if(state4.finished)processNextTick(cb);else stream.once("finish",cb)}state4.ended=true;stream.writable=false}function CorkedRequest(state4){var _this=this;this.next=null;this.entry=null;this.finish=function(err){var entry=_this.entry;_this.entry=null;while(entry){var cb=entry.callback;state4.pendingcb--;cb(err);entry=entry.next}if(state4.corkedRequestsFree){state4.corkedRequestsFree.next=_this}else{state4.corkedRequestsFree=_this}}}}).call(exports2,__webpack_require__(6))},function(module22,exports2){(function(global2){module22.exports=deprecate;function deprecate(fn,msg){if(config("noDeprecation")){return fn}var warned=false;function deprecated(){if(!warned){if(config("throwDeprecation")){throw new Error(msg)}else if(config("traceDeprecation")){console.trace(msg)}else{console.warn(msg)}warned=true}return fn.apply(this,arguments)}return deprecated}function config(name2){try{if(!global2.localStorage)return false}catch(_){return false}var val=global2.localStorage[name2];if(null==val)return false;return String(val).toLowerCase()==="true"}}).call(exports2,function(){return this}())},function(module22,exports2,__webpack_require__){var Buffer2=__webpack_require__(2).Buffer;var isBufferEncoding=Buffer2.isEncoding||function(encoding){switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function assertEncoding(encoding){if(encoding&&!isBufferEncoding(encoding)){throw new Error("Unknown encoding: "+encoding)}}var StringDecoder=exports2.StringDecoder=function(encoding){this.encoding=(encoding||"utf8").toLowerCase().replace(/[-_]/,"");assertEncoding(encoding);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2;this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3;this.detectIncompleteChar=base64DetectIncompleteChar;break;default:this.write=passThroughWrite;return}this.charBuffer=new Buffer2(6);this.charReceived=0;this.charLength=0};StringDecoder.prototype.write=function(buffer){var charStr="";while(this.charLength){var available=buffer.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:buffer.length;buffer.copy(this.charBuffer,this.charReceived,0,available);this.charReceived+=available;if(this.charReceived<this.charLength){return""}buffer=buffer.slice(available,buffer.length);charStr=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var charCode=charStr.charCodeAt(charStr.length-1);if(charCode>=55296&&charCode<=56319){this.charLength+=this.surrogateSize;charStr="";continue}this.charReceived=this.charLength=0;if(buffer.length===0){return charStr}break}this.detectIncompleteChar(buffer);var end=buffer.length;if(this.charLength){buffer.copy(this.charBuffer,0,buffer.length-this.charReceived,end);end-=this.charReceived}charStr+=buffer.toString(this.encoding,0,end);var end=charStr.length-1;var charCode=charStr.charCodeAt(end);if(charCode>=55296&&charCode<=56319){var size=this.surrogateSize;this.charLength+=size;this.charReceived+=size;this.charBuffer.copy(this.charBuffer,size,0,size);buffer.copy(this.charBuffer,0,0,size);return charStr.substring(0,end)}return charStr};StringDecoder.prototype.detectIncompleteChar=function(buffer){var i3=buffer.length>=3?3:buffer.length;for(;i3>0;i3--){var c=buffer[buffer.length-i3];if(i3==1&&c>>5==6){this.charLength=2;break}if(i3<=2&&c>>4==14){this.charLength=3;break}if(i3<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=i3};StringDecoder.prototype.end=function(buffer){var res="";if(buffer&&buffer.length)res=this.write(buffer);if(this.charReceived){var cr=this.charReceived;var buf=this.charBuffer;var enc=this.encoding;res+=buf.slice(0,cr).toString(enc)}return res};function passThroughWrite(buffer){return buffer.toString(this.encoding)}function utf16DetectIncompleteChar(buffer){this.charReceived=buffer.length%2;this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(buffer){this.charReceived=buffer.length%3;this.charLength=this.charReceived?3:0}},function(module22,exports2,__webpack_require__){"use strict";module22.exports=Transform;var Duplex=__webpack_require__(21);var util=__webpack_require__(18);util.inherits=__webpack_require__(12);util.inherits(Transform,Duplex);function TransformState(stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data)};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null;this.writeencoding=null}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=false;var cb=ts.writecb;if(!cb)return stream.emit("error",new Error("no writecb in Transform class"));ts.writechunk=null;ts.writecb=null;if(data!==null&&data!==void 0)stream.push(data);cb(er);var rs=stream._readableState;rs.reading=false;if(rs.needReadable||rs.length<rs.highWaterMark){stream._read(rs.highWaterMark)}}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options);this._transformState=new TransformState(this);var stream=this;this._readableState.needReadable=true;this._readableState.sync=false;if(options){if(typeof options.transform==="function")this._transform=options.transform;if(typeof options.flush==="function")this._flush=options.flush}this.once("prefinish",function(){if(typeof this._flush==="function")this._flush(function(er,data){done(stream,er,data)});else done(stream)})}Transform.prototype.push=function(chunk,encoding){this._transformState.needTransform=false;return Duplex.prototype.push.call(this,chunk,encoding)};Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("_transform() is not implemented")};Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb;ts.writechunk=chunk;ts.writeencoding=encoding;if(!ts.transforming){var rs=this._readableState;if(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)this._read(rs.highWaterMark)}};Transform.prototype._read=function(n){var ts=this._transformState;if(ts.writechunk!==null&&ts.writecb&&!ts.transforming){ts.transforming=true;this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)}else{ts.needTransform=true}};function done(stream,er,data){if(er)return stream.emit("error",er);if(data!==null&&data!==void 0)stream.push(data);var ws=stream._writableState;var ts=stream._transformState;if(ws.length)throw new Error("Calling transform done when ws.length != 0");if(ts.transforming)throw new Error("Calling transform done when still transforming");return stream.push(null)}},function(module22,exports2,__webpack_require__){"use strict";module22.exports=PassThrough;var Transform=__webpack_require__(25);var util=__webpack_require__(18);util.inherits=__webpack_require__(12);util.inherits(PassThrough,Transform);function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},function(module22,exports2,__webpack_require__){module22.exports=__webpack_require__(22)},function(module22,exports2,__webpack_require__){module22.exports=__webpack_require__(21)},function(module22,exports2,__webpack_require__){module22.exports=__webpack_require__(25)},function(module22,exports2,__webpack_require__){module22.exports=__webpack_require__(26)},function(module22,exports2,__webpack_require__){"use strict";var zlib_inflate=__webpack_require__(32);var utils=__webpack_require__(33);var strings=__webpack_require__(38);var c=__webpack_require__(39);var msg=__webpack_require__(40);var ZStream=__webpack_require__(41);var GZheader=__webpack_require__(42);var toString=Object.prototype.toString;function Inflate(options){if(!(this instanceof Inflate))return new Inflate(options);this.options=utils.assign({chunkSize:16384,windowBits:0,to:""},options||{});var opt=this.options;if(opt.raw&&opt.windowBits>=0&&opt.windowBits<16){opt.windowBits=-opt.windowBits;if(opt.windowBits===0){opt.windowBits=-15}}if(opt.windowBits>=0&&opt.windowBits<16&&!(options&&options.windowBits)){opt.windowBits+=32}if(opt.windowBits>15&&opt.windowBits<48){if((opt.windowBits&15)===0){opt.windowBits|=15}}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new ZStream;this.strm.avail_out=0;var status=zlib_inflate.inflateInit2(this.strm,opt.windowBits);if(status!==c.Z_OK){throw new Error(msg[status])}this.header=new GZheader;zlib_inflate.inflateGetHeader(this.strm,this.header)}Inflate.prototype.push=function(data,mode){var strm=this.strm;var chunkSize=this.options.chunkSize;var dictionary=this.options.dictionary;var status,_mode;var next_out_utf8,tail,utf8str;var dict;var allowBufError=false;if(this.ended){return false}_mode=mode===~~mode?mode:mode===true?c.Z_FINISH:c.Z_NO_FLUSH;if(typeof data==="string"){strm.input=strings.binstring2buf(data)}else if(toString.call(data)==="[object ArrayBuffer]"){strm.input=new Uint8Array(data)}else{strm.input=data}strm.next_in=0;strm.avail_in=strm.input.length;do{if(strm.avail_out===0){strm.output=new utils.Buf8(chunkSize);strm.next_out=0;strm.avail_out=chunkSize}status=zlib_inflate.inflate(strm,c.Z_NO_FLUSH);if(status===c.Z_NEED_DICT&&dictionary){if(typeof dictionary==="string"){dict=strings.string2buf(dictionary)}else if(toString.call(dictionary)==="[object ArrayBuffer]"){dict=new Uint8Array(dictionary)}else{dict=dictionary}status=zlib_inflate.inflateSetDictionary(this.strm,dict)}if(status===c.Z_BUF_ERROR&&allowBufError===true){status=c.Z_OK;allowBufError=false}if(status!==c.Z_STREAM_END&&status!==c.Z_OK){this.onEnd(status);this.ended=true;return false}if(strm.next_out){if(strm.avail_out===0||status===c.Z_STREAM_END||strm.avail_in===0&&(_mode===c.Z_FINISH||_mode===c.Z_SYNC_FLUSH)){if(this.options.to==="string"){next_out_utf8=strings.utf8border(strm.output,strm.next_out);tail=strm.next_out-next_out_utf8;utf8str=strings.buf2string(strm.output,next_out_utf8);strm.next_out=tail;strm.avail_out=chunkSize-tail;if(tail){utils.arraySet(strm.output,strm.output,next_out_utf8,tail,0)}this.onData(utf8str)}else{this.onData(utils.shrinkBuf(strm.output,strm.next_out))}}}if(strm.avail_in===0&&strm.avail_out===0){allowBufError=true}}while((strm.avail_in>0||strm.avail_out===0)&&status!==c.Z_STREAM_END);if(status===c.Z_STREAM_END){_mode=c.Z_FINISH}if(_mode===c.Z_FINISH){status=zlib_inflate.inflateEnd(this.strm);this.onEnd(status);this.ended=true;return status===c.Z_OK}if(_mode===c.Z_SYNC_FLUSH){this.onEnd(c.Z_OK);strm.avail_out=0;return true}return true};Inflate.prototype.onData=function(chunk){this.chunks.push(chunk)};Inflate.prototype.onEnd=function(status){if(status===c.Z_OK){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=utils.flattenChunks(this.chunks)}}this.chunks=[];this.err=status;this.msg=this.strm.msg};function inflate(input,options){var inflator=new Inflate(options);inflator.push(input,true);if(inflator.err){throw inflator.msg||msg[inflator.err]}return inflator.result}function inflateRaw(input,options){options=options||{};options.raw=true;return inflate(input,options)}exports2.Inflate=Inflate;exports2.inflate=inflate;exports2.inflateRaw=inflateRaw;exports2.ungzip=inflate},function(module22,exports2,__webpack_require__){"use strict";var utils=__webpack_require__(33);var adler32=__webpack_require__(34);var crc32=__webpack_require__(35);var inflate_fast=__webpack_require__(36);var inflate_table=__webpack_require__(37);var CODES=0;var LENS=1;var DISTS=2;var Z_FINISH=4;var Z_BLOCK=5;var Z_TREES=6;var Z_OK=0;var Z_STREAM_END=1;var Z_NEED_DICT=2;var Z_STREAM_ERROR=-2;var Z_DATA_ERROR=-3;var Z_MEM_ERROR=-4;var Z_BUF_ERROR=-5;var Z_DEFLATED=8;var HEAD=1;var FLAGS=2;var TIME=3;var OS=4;var EXLEN=5;var EXTRA=6;var NAME=7;var COMMENT=8;var HCRC=9;var DICTID=10;var DICT=11;var TYPE=12;var TYPEDO=13;var STORED=14;var COPY_=15;var COPY=16;var TABLE=17;var LENLENS=18;var CODELENS=19;var LEN_=20;var LEN=21;var LENEXT=22;var DIST=23;var DISTEXT=24;var MATCH=25;var LIT=26;var CHECK=27;var LENGTH=28;var DONE=29;var BAD=30;var MEM=31;var SYNC=32;var ENOUGH_LENS=852;var ENOUGH_DISTS=592;var MAX_WBITS=15;var DEF_WBITS=MAX_WBITS;function zswap32(q){return(q>>>24&255)+(q>>>8&65280)+((q&65280)<<8)+((q&255)<<24)}function InflateState(){this.mode=0;this.last=false;this.wrap=0;this.havedict=false;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new utils.Buf16(320);this.work=new utils.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function inflateResetKeep(strm){var state4;if(!strm||!strm.state){return Z_STREAM_ERROR}state4=strm.state;strm.total_in=strm.total_out=state4.total=0;strm.msg="";if(state4.wrap){strm.adler=state4.wrap&1}state4.mode=HEAD;state4.last=0;state4.havedict=0;state4.dmax=32768;state4.head=null;state4.hold=0;state4.bits=0;state4.lencode=state4.lendyn=new utils.Buf32(ENOUGH_LENS);state4.distcode=state4.distdyn=new utils.Buf32(ENOUGH_DISTS);state4.sane=1;state4.back=-1;return Z_OK}function inflateReset(strm){var state4;if(!strm||!strm.state){return Z_STREAM_ERROR}state4=strm.state;state4.wsize=0;state4.whave=0;state4.wnext=0;return inflateResetKeep(strm)}function inflateReset2(strm,windowBits){var wrap;var state4;if(!strm||!strm.state){return Z_STREAM_ERROR}state4=strm.state;if(windowBits<0){wrap=0;windowBits=-windowBits}else{wrap=(windowBits>>4)+1;if(windowBits<48){windowBits&=15}}if(windowBits&&(windowBits<8||windowBits>15)){return Z_STREAM_ERROR}if(state4.window!==null&&state4.wbits!==windowBits){state4.window=null}state4.wrap=wrap;state4.wbits=windowBits;return inflateReset(strm)}function inflateInit2(strm,windowBits){var ret;var state4;if(!strm){return Z_STREAM_ERROR}state4=new InflateState;strm.state=state4;state4.window=null;ret=inflateReset2(strm,windowBits);if(ret!==Z_OK){strm.state=null}return ret}function inflateInit(strm){return inflateInit2(strm,DEF_WBITS)}var virgin=true;var lenfix,distfix;function fixedtables(state4){if(virgin){var sym;lenfix=new utils.Buf32(512);distfix=new utils.Buf32(32);sym=0;while(sym<144){state4.lens[sym++]=8}while(sym<256){state4.lens[sym++]=9}while(sym<280){state4.lens[sym++]=7}while(sym<288){state4.lens[sym++]=8}inflate_table(LENS,state4.lens,0,288,lenfix,0,state4.work,{bits:9});sym=0;while(sym<32){state4.lens[sym++]=5}inflate_table(DISTS,state4.lens,0,32,distfix,0,state4.work,{bits:5});virgin=false}state4.lencode=lenfix;state4.lenbits=9;state4.distcode=distfix;state4.distbits=5}function updatewindow(strm,src,end,copy){var dist;var state4=strm.state;if(state4.window===null){state4.wsize=1<<state4.wbits;state4.wnext=0;state4.whave=0;state4.window=new utils.Buf8(state4.wsize)}if(copy>=state4.wsize){utils.arraySet(state4.window,src,end-state4.wsize,state4.wsize,0);state4.wnext=0;state4.whave=state4.wsize}else{dist=state4.wsize-state4.wnext;if(dist>copy){dist=copy}utils.arraySet(state4.window,src,end-copy,dist,state4.wnext);copy-=dist;if(copy){utils.arraySet(state4.window,src,end-copy,copy,0);state4.wnext=copy;state4.whave=state4.wsize}else{state4.wnext+=dist;if(state4.wnext===state4.wsize){state4.wnext=0}if(state4.whave<state4.wsize){state4.whave+=dist}}}return 0}function inflate(strm,flush){var state4;var input,output;var next;var put;var have,left;var hold;var bits;var _in,_out;var copy;var from;var from_source;var here=0;var here_bits,here_op,here_val;var last_bits,last_op,last_val;var len;var ret;var hbuf=new utils.Buf8(4);var opts;var n;var order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!strm||!strm.state||!strm.output||!strm.input&&strm.avail_in!==0){return Z_STREAM_ERROR}state4=strm.state;if(state4.mode===TYPE){state4.mode=TYPEDO}put=strm.next_out;output=strm.output;left=strm.avail_out;next=strm.next_in;input=strm.input;have=strm.avail_in;hold=state4.hold;bits=state4.bits;_in=have;_out=left;ret=Z_OK;inf_leave:for(;;){switch(state4.mode){case HEAD:if(state4.wrap===0){state4.mode=TYPEDO;break}while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(state4.wrap&2&&hold===35615){state4.check=0;hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state4.check=crc32(state4.check,hbuf,2,0);hold=0;bits=0;state4.mode=FLAGS;break}state4.flags=0;if(state4.head){state4.head.done=false}if(!(state4.wrap&1)||(((hold&255)<<8)+(hold>>8))%31){strm.msg="incorrect header check";state4.mode=BAD;break}if((hold&15)!==Z_DEFLATED){strm.msg="unknown compression method";state4.mode=BAD;break}hold>>>=4;bits-=4;len=(hold&15)+8;if(state4.wbits===0){state4.wbits=len}else if(len>state4.wbits){strm.msg="invalid window size";state4.mode=BAD;break}state4.dmax=1<<len;strm.adler=state4.check=1;state4.mode=hold&512?DICTID:TYPE;hold=0;bits=0;break;case FLAGS:while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.flags=hold;if((state4.flags&255)!==Z_DEFLATED){strm.msg="unknown compression method";state4.mode=BAD;break}if(state4.flags&57344){strm.msg="unknown header flags set";state4.mode=BAD;break}if(state4.head){state4.head.text=hold>>8&1}if(state4.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state4.check=crc32(state4.check,hbuf,2,0)}hold=0;bits=0;state4.mode=TIME;case TIME:while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(state4.head){state4.head.time=hold}if(state4.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;hbuf[2]=hold>>>16&255;hbuf[3]=hold>>>24&255;state4.check=crc32(state4.check,hbuf,4,0)}hold=0;bits=0;state4.mode=OS;case OS:while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(state4.head){state4.head.xflags=hold&255;state4.head.os=hold>>8}if(state4.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state4.check=crc32(state4.check,hbuf,2,0)}hold=0;bits=0;state4.mode=EXLEN;case EXLEN:if(state4.flags&1024){while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.length=hold;if(state4.head){state4.head.extra_len=hold}if(state4.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state4.check=crc32(state4.check,hbuf,2,0)}hold=0;bits=0}else if(state4.head){state4.head.extra=null}state4.mode=EXTRA;case EXTRA:if(state4.flags&1024){copy=state4.length;if(copy>have){copy=have}if(copy){if(state4.head){len=state4.head.extra_len-state4.length;if(!state4.head.extra){state4.head.extra=new Array(state4.head.extra_len)}utils.arraySet(state4.head.extra,input,next,copy,len)}if(state4.flags&512){state4.check=crc32(state4.check,input,copy,next)}have-=copy;next+=copy;state4.length-=copy}if(state4.length){break inf_leave}}state4.length=0;state4.mode=NAME;case NAME:if(state4.flags&2048){if(have===0){break inf_leave}copy=0;do{len=input[next+copy++];if(state4.head&&len&&state4.length<65536){state4.head.name+=String.fromCharCode(len)}}while(len&&copy<have);if(state4.flags&512){state4.check=crc32(state4.check,input,copy,next)}have-=copy;next+=copy;if(len){break inf_leave}}else if(state4.head){state4.head.name=null}state4.length=0;state4.mode=COMMENT;case COMMENT:if(state4.flags&4096){if(have===0){break inf_leave}copy=0;do{len=input[next+copy++];if(state4.head&&len&&state4.length<65536){state4.head.comment+=String.fromCharCode(len)}}while(len&&copy<have);if(state4.flags&512){state4.check=crc32(state4.check,input,copy,next)}have-=copy;next+=copy;if(len){break inf_leave}}else if(state4.head){state4.head.comment=null}state4.mode=HCRC;case HCRC:if(state4.flags&512){while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(hold!==(state4.check&65535)){strm.msg="header crc mismatch";state4.mode=BAD;break}hold=0;bits=0}if(state4.head){state4.head.hcrc=state4.flags>>9&1;state4.head.done=true}strm.adler=state4.check=0;state4.mode=TYPE;break;case DICTID:while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}strm.adler=state4.check=zswap32(hold);hold=0;bits=0;state4.mode=DICT;case DICT:if(state4.havedict===0){strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state4.hold=hold;state4.bits=bits;return Z_NEED_DICT}strm.adler=state4.check=1;state4.mode=TYPE;case TYPE:if(flush===Z_BLOCK||flush===Z_TREES){break inf_leave}case TYPEDO:if(state4.last){hold>>>=bits&7;bits-=bits&7;state4.mode=CHECK;break}while(bits<3){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.last=hold&1;hold>>>=1;bits-=1;switch(hold&3){case 0:state4.mode=STORED;break;case 1:fixedtables(state4);state4.mode=LEN_;if(flush===Z_TREES){hold>>>=2;bits-=2;break inf_leave}break;case 2:state4.mode=TABLE;break;case 3:strm.msg="invalid block type";state4.mode=BAD}hold>>>=2;bits-=2;break;case STORED:hold>>>=bits&7;bits-=bits&7;while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if((hold&65535)!==(hold>>>16^65535)){strm.msg="invalid stored block lengths";state4.mode=BAD;break}state4.length=hold&65535;hold=0;bits=0;state4.mode=COPY_;if(flush===Z_TREES){break inf_leave}case COPY_:state4.mode=COPY;case COPY:copy=state4.length;if(copy){if(copy>have){copy=have}if(copy>left){copy=left}if(copy===0){break inf_leave}utils.arraySet(output,input,next,copy,put);have-=copy;next+=copy;left-=copy;put+=copy;state4.length-=copy;break}state4.mode=TYPE;break;case TABLE:while(bits<14){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.nlen=(hold&31)+257;hold>>>=5;bits-=5;state4.ndist=(hold&31)+1;hold>>>=5;bits-=5;state4.ncode=(hold&15)+4;hold>>>=4;bits-=4;if(state4.nlen>286||state4.ndist>30){strm.msg="too many length or distance symbols";state4.mode=BAD;break}state4.have=0;state4.mode=LENLENS;case LENLENS:while(state4.have<state4.ncode){while(bits<3){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.lens[order[state4.have++]]=hold&7;hold>>>=3;bits-=3}while(state4.have<19){state4.lens[order[state4.have++]]=0}state4.lencode=state4.lendyn;state4.lenbits=7;opts={bits:state4.lenbits};ret=inflate_table(CODES,state4.lens,0,19,state4.lencode,0,state4.work,opts);state4.lenbits=opts.bits;if(ret){strm.msg="invalid code lengths set";state4.mode=BAD;break}state4.have=0;state4.mode=CODELENS;case CODELENS:while(state4.have<state4.nlen+state4.ndist){for(;;){here=state4.lencode[hold&(1<<state4.lenbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(here_val<16){hold>>>=here_bits;bits-=here_bits;state4.lens[state4.have++]=here_val}else{if(here_val===16){n=here_bits+2;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;bits-=here_bits;if(state4.have===0){strm.msg="invalid bit length repeat";state4.mode=BAD;break}len=state4.lens[state4.have-1];copy=3+(hold&3);hold>>>=2;bits-=2}else if(here_val===17){n=here_bits+3;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;bits-=here_bits;len=0;copy=3+(hold&7);hold>>>=3;bits-=3}else{n=here_bits+7;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;bits-=here_bits;len=0;copy=11+(hold&127);hold>>>=7;bits-=7}if(state4.have+copy>state4.nlen+state4.ndist){strm.msg="invalid bit length repeat";state4.mode=BAD;break}while(copy--){state4.lens[state4.have++]=len}}}if(state4.mode===BAD){break}if(state4.lens[256]===0){strm.msg="invalid code -- missing end-of-block";state4.mode=BAD;break}state4.lenbits=9;opts={bits:state4.lenbits};ret=inflate_table(LENS,state4.lens,0,state4.nlen,state4.lencode,0,state4.work,opts);state4.lenbits=opts.bits;if(ret){strm.msg="invalid literal/lengths set";state4.mode=BAD;break}state4.distbits=6;state4.distcode=state4.distdyn;opts={bits:state4.distbits};ret=inflate_table(DISTS,state4.lens,state4.nlen,state4.ndist,state4.distcode,0,state4.work,opts);state4.distbits=opts.bits;if(ret){strm.msg="invalid distances set";state4.mode=BAD;break}state4.mode=LEN_;if(flush===Z_TREES){break inf_leave}case LEN_:state4.mode=LEN;case LEN:if(have>=6&&left>=258){strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state4.hold=hold;state4.bits=bits;inflate_fast(strm,_out);put=strm.next_out;output=strm.output;left=strm.avail_out;next=strm.next_in;input=strm.input;have=strm.avail_in;hold=state4.hold;bits=state4.bits;if(state4.mode===TYPE){state4.back=-1}break}state4.back=0;for(;;){here=state4.lencode[hold&(1<<state4.lenbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(here_op&&(here_op&240)===0){last_bits=here_bits;last_op=here_op;last_val=here_val;for(;;){here=state4.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(last_bits+here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=last_bits;bits-=last_bits;state4.back+=last_bits}hold>>>=here_bits;bits-=here_bits;state4.back+=here_bits;state4.length=here_val;if(here_op===0){state4.mode=LIT;break}if(here_op&32){state4.back=-1;state4.mode=TYPE;break}if(here_op&64){strm.msg="invalid literal/length code";state4.mode=BAD;break}state4.extra=here_op&15;state4.mode=LENEXT;case LENEXT:if(state4.extra){n=state4.extra;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.length+=hold&(1<<state4.extra)-1;hold>>>=state4.extra;bits-=state4.extra;state4.back+=state4.extra}state4.was=state4.length;state4.mode=DIST;case DIST:for(;;){here=state4.distcode[hold&(1<<state4.distbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if((here_op&240)===0){last_bits=here_bits;last_op=here_op;last_val=here_val;for(;;){here=state4.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(last_bits+here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=last_bits;bits-=last_bits;state4.back+=last_bits}hold>>>=here_bits;bits-=here_bits;state4.back+=here_bits;if(here_op&64){strm.msg="invalid distance code";state4.mode=BAD;break}state4.offset=here_val;state4.extra=here_op&15;state4.mode=DISTEXT;case DISTEXT:if(state4.extra){n=state4.extra;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state4.offset+=hold&(1<<state4.extra)-1;hold>>>=state4.extra;bits-=state4.extra;state4.back+=state4.extra}if(state4.offset>state4.dmax){strm.msg="invalid distance too far back";state4.mode=BAD;break}state4.mode=MATCH;case MATCH:if(left===0){break inf_leave}copy=_out-left;if(state4.offset>copy){copy=state4.offset-copy;if(copy>state4.whave){if(state4.sane){strm.msg="invalid distance too far back";state4.mode=BAD;break}}if(copy>state4.wnext){copy-=state4.wnext;from=state4.wsize-copy}else{from=state4.wnext-copy}if(copy>state4.length){copy=state4.length}from_source=state4.window}else{from_source=output;from=put-state4.offset;copy=state4.length}if(copy>left){copy=left}left-=copy;state4.length-=copy;do{output[put++]=from_source[from++]}while(--copy);if(state4.length===0){state4.mode=LEN}break;case LIT:if(left===0){break inf_leave}output[put++]=state4.length;left--;state4.mode=LEN;break;case CHECK:if(state4.wrap){while(bits<32){if(have===0){break inf_leave}have--;hold|=input[next++]<<bits;bits+=8}_out-=left;strm.total_out+=_out;state4.total+=_out;if(_out){strm.adler=state4.check=state4.flags?crc32(state4.check,output,_out,put-_out):adler32(state4.check,output,_out,put-_out)}_out=left;if((state4.flags?hold:zswap32(hold))!==state4.check){strm.msg="incorrect data check";state4.mode=BAD;break}hold=0;bits=0}state4.mode=LENGTH;case LENGTH:if(state4.wrap&&state4.flags){while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(hold!==(state4.total&4294967295)){strm.msg="incorrect length check";state4.mode=BAD;break}hold=0;bits=0}state4.mode=DONE;case DONE:ret=Z_STREAM_END;break inf_leave;case BAD:ret=Z_DATA_ERROR;break inf_leave;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}}strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state4.hold=hold;state4.bits=bits;if(state4.wsize||_out!==strm.avail_out&&state4.mode<BAD&&(state4.mode<CHECK||flush!==Z_FINISH)){if(updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out)){state4.mode=MEM;return Z_MEM_ERROR}}_in-=strm.avail_in;_out-=strm.avail_out;strm.total_in+=_in;strm.total_out+=_out;state4.total+=_out;if(state4.wrap&&_out){strm.adler=state4.check=state4.flags?crc32(state4.check,output,_out,strm.next_out-_out):adler32(state4.check,output,_out,strm.next_out-_out)}strm.data_type=state4.bits+(state4.last?64:0)+(state4.mode===TYPE?128:0)+(state4.mode===LEN_||state4.mode===COPY_?256:0);if((_in===0&&_out===0||flush===Z_FINISH)&&ret===Z_OK){ret=Z_BUF_ERROR}return ret}function inflateEnd(strm){if(!strm||!strm.state){return Z_STREAM_ERROR}var state4=strm.state;if(state4.window){state4.window=null}strm.state=null;return Z_OK}function inflateGetHeader(strm,head){var state4;if(!strm||!strm.state){return Z_STREAM_ERROR}state4=strm.state;if((state4.wrap&2)===0){return Z_STREAM_ERROR}state4.head=head;head.done=false;return Z_OK}function inflateSetDictionary(strm,dictionary){var dictLength=dictionary.length;var state4;var dictid;var ret;if(!strm||!strm.state){return Z_STREAM_ERROR}state4=strm.state;if(state4.wrap!==0&&state4.mode!==DICT){return Z_STREAM_ERROR}if(state4.mode===DICT){dictid=1;dictid=adler32(dictid,dictionary,dictLength,0);if(dictid!==state4.check){return Z_DATA_ERROR}}ret=updatewindow(strm,dictionary,dictLength,dictLength);if(ret){state4.mode=MEM;return Z_MEM_ERROR}state4.havedict=1;return Z_OK}exports2.inflateReset=inflateReset;exports2.inflateReset2=inflateReset2;exports2.inflateResetKeep=inflateResetKeep;exports2.inflateInit=inflateInit;exports2.inflateInit2=inflateInit2;exports2.inflate=inflate;exports2.inflateEnd=inflateEnd;exports2.inflateGetHeader=inflateGetHeader;exports2.inflateSetDictionary=inflateSetDictionary;exports2.inflateInfo="pako inflate (from Nodeca project)"},function(module22,exports2){"use strict";var TYPED_OK=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";exports2.assign=function(obj){var sources=Array.prototype.slice.call(arguments,1);while(sources.length){var source=sources.shift();if(!source){continue}if(typeof source!=="object"){throw new TypeError(source+"must be non-object")}for(var p2 in source){if(source.hasOwnProperty(p2)){obj[p2]=source[p2]}}}return obj};exports2.shrinkBuf=function(buf,size){if(buf.length===size){return buf}if(buf.subarray){return buf.subarray(0,size)}buf.length=size;return buf};var fnTyped={arraySet:function(dest,src,src_offs,len,dest_offs){if(src.subarray&&dest.subarray){dest.set(src.subarray(src_offs,src_offs+len),dest_offs);return}for(var i3=0;i3<len;i3++){dest[dest_offs+i3]=src[src_offs+i3]}},flattenChunks:function(chunks){var i3,l,len,pos,chunk,result;len=0;for(i3=0,l=chunks.length;i3<l;i3++){len+=chunks[i3].length}result=new Uint8Array(len);pos=0;for(i3=0,l=chunks.length;i3<l;i3++){chunk=chunks[i3];result.set(chunk,pos);pos+=chunk.length}return result}};var fnUntyped={arraySet:function(dest,src,src_offs,len,dest_offs){for(var i3=0;i3<len;i3++){dest[dest_offs+i3]=src[src_offs+i3]}},flattenChunks:function(chunks){return[].concat.apply([],chunks)}};exports2.setTyped=function(on){if(on){exports2.Buf8=Uint8Array;exports2.Buf16=Uint16Array;exports2.Buf32=Int32Array;exports2.assign(exports2,fnTyped)}else{exports2.Buf8=Array;exports2.Buf16=Array;exports2.Buf32=Array;exports2.assign(exports2,fnUntyped)}};exports2.setTyped(TYPED_OK)},function(module22,exports2){"use strict";function adler32(adler,buf,len,pos){var s1=adler&65535|0,s2=adler>>>16&65535|0,n=0;while(len!==0){n=len>2e3?2e3:len;len-=n;do{s1=s1+buf[pos++]|0;s2=s2+s1|0}while(--n);s1%=65521;s2%=65521}return s1|s2<<16|0}module22.exports=adler32},function(module22,exports2){"use strict";function makeTable(){var c,table=[];for(var n=0;n<256;n++){c=n;for(var k=0;k<8;k++){c=c&1?3988292384^c>>>1:c>>>1}table[n]=c}return table}var crcTable=makeTable();function crc32(crc,buf,len,pos){var t3=crcTable,end=pos+len;crc^=-1;for(var i3=pos;i3<end;i3++){crc=crc>>>8^t3[(crc^buf[i3])&255]}return crc^-1}module22.exports=crc32},function(module22,exports2){"use strict";var BAD=30;var TYPE=12;module22.exports=function inflate_fast(strm,start){var state4;var _in;var last;var _out;var beg;var end;var dmax;var wsize;var whave;var wnext;var s_window;var hold;var bits;var lcode;var dcode;var lmask;var dmask;var here;var op;var len;var dist;var from;var from_source;var input,output;state4=strm.state;_in=strm.next_in;input=strm.input;last=_in+(strm.avail_in-5);_out=strm.next_out;output=strm.output;beg=_out-(start-strm.avail_out);end=_out+(strm.avail_out-257);dmax=state4.dmax;wsize=state4.wsize;whave=state4.whave;wnext=state4.wnext;s_window=state4.window;hold=state4.hold;bits=state4.bits;lcode=state4.lencode;dcode=state4.distcode;lmask=(1<<state4.lenbits)-1;dmask=(1<<state4.distbits)-1;top:do{if(bits<15){hold+=input[_in++]<<bits;bits+=8;hold+=input[_in++]<<bits;bits+=8}here=lcode[hold&lmask];dolen:for(;;){op=here>>>24;hold>>>=op;bits-=op;op=here>>>16&255;if(op===0){output[_out++]=here&65535}else if(op&16){len=here&65535;op&=15;if(op){if(bits<op){hold+=input[_in++]<<bits;bits+=8}len+=hold&(1<<op)-1;hold>>>=op;bits-=op}if(bits<15){hold+=input[_in++]<<bits;bits+=8;hold+=input[_in++]<<bits;bits+=8}here=dcode[hold&dmask];dodist:for(;;){op=here>>>24;hold>>>=op;bits-=op;op=here>>>16&255;if(op&16){dist=here&65535;op&=15;if(bits<op){hold+=input[_in++]<<bits;bits+=8;if(bits<op){hold+=input[_in++]<<bits;bits+=8}}dist+=hold&(1<<op)-1;if(dist>dmax){strm.msg="invalid distance too far back";state4.mode=BAD;break top}hold>>>=op;bits-=op;op=_out-beg;if(dist>op){op=dist-op;if(op>whave){if(state4.sane){strm.msg="invalid distance too far back";state4.mode=BAD;break top}}from=0;from_source=s_window;if(wnext===0){from+=wsize-op;if(op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist;from_source=output}}else if(wnext<op){from+=wsize+wnext-op;op-=wnext;if(op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=0;if(wnext<len){op=wnext;len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist;from_source=output}}}else{from+=wnext-op;if(op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist;from_source=output}}while(len>2){output[_out++]=from_source[from++];output[_out++]=from_source[from++];output[_out++]=from_source[from++];len-=3}if(len){output[_out++]=from_source[from++];if(len>1){output[_out++]=from_source[from++]}}}else{from=_out-dist;do{output[_out++]=output[from++];output[_out++]=output[from++];output[_out++]=output[from++];len-=3}while(len>2);if(len){output[_out++]=output[from++];if(len>1){output[_out++]=output[from++]}}}}else if((op&64)===0){here=dcode[(here&65535)+(hold&(1<<op)-1)];continue dodist}else{strm.msg="invalid distance code";state4.mode=BAD;break top}break}}else if((op&64)===0){here=lcode[(here&65535)+(hold&(1<<op)-1)];continue dolen}else if(op&32){state4.mode=TYPE;break top}else{strm.msg="invalid literal/length code";state4.mode=BAD;break top}break}}while(_in<last&&_out<end);len=bits>>3;_in-=len;bits-=len<<3;hold&=(1<<bits)-1;strm.next_in=_in;strm.next_out=_out;strm.avail_in=_in<last?5+(last-_in):5-(_in-last);strm.avail_out=_out<end?257+(end-_out):257-(_out-end);state4.hold=hold;state4.bits=bits;return}},function(module22,exports2,__webpack_require__){"use strict";var utils=__webpack_require__(33);var MAXBITS=15;var ENOUGH_LENS=852;var ENOUGH_DISTS=592;var CODES=0;var LENS=1;var DISTS=2;var lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78];var dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0];var dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module22.exports=function inflate_table(type,lens,lens_index,codes,table,table_index,work,opts){var bits=opts.bits;var len=0;var sym=0;var min=0,max=0;var root=0;var curr=0;var drop=0;var left=0;var used=0;var huff=0;var incr;var fill;var low;var mask;var next;var base=null;var base_index=0;var end;var count=new utils.Buf16(MAXBITS+1);var offs=new utils.Buf16(MAXBITS+1);var extra=null;var extra_index=0;var here_bits,here_op,here_val;for(len=0;len<=MAXBITS;len++){count[len]=0}for(sym=0;sym<codes;sym++){count[lens[lens_index+sym]]++}root=bits;for(max=MAXBITS;max>=1;max--){if(count[max]!==0){break}}if(root>max){root=max}if(max===0){table[table_index++]=1<<24|64<<16|0;table[table_index++]=1<<24|64<<16|0;opts.bits=1;return 0}for(min=1;min<max;min++){if(count[min]!==0){break}}if(root<min){root=min}left=1;for(len=1;len<=MAXBITS;len++){left<<=1;left-=count[len];if(left<0){return-1}}if(left>0&&(type===CODES||max!==1)){return-1}offs[1]=0;for(len=1;len<MAXBITS;len++){offs[len+1]=offs[len]+count[len]}for(sym=0;sym<codes;sym++){if(lens[lens_index+sym]!==0){work[offs[lens[lens_index+sym]]++]=sym}}if(type===CODES){base=extra=work;end=19}else if(type===LENS){base=lbase;base_index-=257;extra=lext;extra_index-=257;end=256}else{base=dbase;extra=dext;end=-1}huff=0;sym=0;len=min;next=table_index;curr=root;drop=0;low=-1;used=1<<root;mask=used-1;if(type===LENS&&used>ENOUGH_LENS||type===DISTS&&used>ENOUGH_DISTS){return 1}for(;;){here_bits=len-drop;if(work[sym]<end){here_op=0;here_val=work[sym]}else if(work[sym]>end){here_op=extra[extra_index+work[sym]];here_val=base[base_index+work[sym]]}else{here_op=32+64;here_val=0}incr=1<<len-drop;fill=1<<curr;min=fill;do{fill-=incr;table[next+(huff>>drop)+fill]=here_bits<<24|here_op<<16|here_val|0}while(fill!==0);incr=1<<len-1;while(huff&incr){incr>>=1}if(incr!==0){huff&=incr-1;huff+=incr}else{huff=0}sym++;if(--count[len]===0){if(len===max){break}len=lens[lens_index+work[sym]]}if(len>root&&(huff&mask)!==low){if(drop===0){drop=root}next+=min;curr=len-drop;left=1<<curr;while(curr+drop<max){left-=count[curr+drop];if(left<=0){break}curr++;left<<=1}used+=1<<curr;if(type===LENS&&used>ENOUGH_LENS||type===DISTS&&used>ENOUGH_DISTS){return 1}low=huff&mask;table[low]=root<<24|curr<<16|next-table_index|0}}if(huff!==0){table[next+huff]=len-drop<<24|64<<16|0}opts.bits=root;return 0}},function(module22,exports2,__webpack_require__){"use strict";var utils=__webpack_require__(33);var STR_APPLY_OK=true;var STR_APPLY_UIA_OK=true;try{String.fromCharCode.apply(null,[0])}catch(__){STR_APPLY_OK=false}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(__){STR_APPLY_UIA_OK=false}var _utf8len=new utils.Buf8(256);for(var q=0;q<256;q++){_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1}_utf8len[254]=_utf8len[254]=1;exports2.string2buf=function(str3){var buf,c,c2,m_pos,i3,str_len=str3.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++){c=str3.charCodeAt(m_pos);if((c&64512)===55296&&m_pos+1<str_len){c2=str3.charCodeAt(m_pos+1);if((c2&64512)===56320){c=65536+(c-55296<<10)+(c2-56320);m_pos++}}buf_len+=c<128?1:c<2048?2:c<65536?3:4}buf=new utils.Buf8(buf_len);for(i3=0,m_pos=0;i3<buf_len;m_pos++){c=str3.charCodeAt(m_pos);if((c&64512)===55296&&m_pos+1<str_len){c2=str3.charCodeAt(m_pos+1);if((c2&64512)===56320){c=65536+(c-55296<<10)+(c2-56320);m_pos++}}if(c<128){buf[i3++]=c}else if(c<2048){buf[i3++]=192|c>>>6;buf[i3++]=128|c&63}else if(c<65536){buf[i3++]=224|c>>>12;buf[i3++]=128|c>>>6&63;buf[i3++]=128|c&63}else{buf[i3++]=240|c>>>18;buf[i3++]=128|c>>>12&63;buf[i3++]=128|c>>>6&63;buf[i3++]=128|c&63}}return buf};function buf2binstring(buf,len){if(len<65537){if(buf.subarray&&STR_APPLY_UIA_OK||!buf.subarray&&STR_APPLY_OK){return String.fromCharCode.apply(null,utils.shrinkBuf(buf,len))}}var result="";for(var i3=0;i3<len;i3++){result+=String.fromCharCode(buf[i3])}return result}exports2.buf2binstring=function(buf){return buf2binstring(buf,buf.length)};exports2.binstring2buf=function(str3){var buf=new utils.Buf8(str3.length);for(var i3=0,len=buf.length;i3<len;i3++){buf[i3]=str3.charCodeAt(i3)}return buf};exports2.buf2string=function(buf,max){var i3,out,c,c_len;var len=max||buf.length;var utf16buf=new Array(len*2);for(out=0,i3=0;i3<len;){c=buf[i3++];if(c<128){utf16buf[out++]=c;continue}c_len=_utf8len[c];if(c_len>4){utf16buf[out++]=65533;i3+=c_len-1;continue}c&=c_len===2?31:c_len===3?15:7;while(c_len>1&&i3<len){c=c<<6|buf[i3++]&63;c_len--}if(c_len>1){utf16buf[out++]=65533;continue}if(c<65536){utf16buf[out++]=c}else{c-=65536;utf16buf[out++]=55296|c>>10&1023;utf16buf[out++]=56320|c&1023}}return buf2binstring(utf16buf,out)};exports2.utf8border=function(buf,max){var pos;max=max||buf.length;if(max>buf.length){max=buf.length}pos=max-1;while(pos>=0&&(buf[pos]&192)===128){pos--}if(pos<0){return max}if(pos===0){return max}return pos+_utf8len[buf[pos]]>max?pos:max}},function(module22,exports2){"use strict";module22.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(module22,exports2){"use strict";module22.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(module22,exports2){"use strict";function ZStream(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}module22.exports=ZStream},function(module22,exports2){"use strict";function GZheader(){this.text=0;this.time=0;this.xflags=0;this.os=0;this.extra=null;this.extra_len=0;this.name="";this.comment="";this.hcrc=0;this.done=false}module22.exports=GZheader}])})}});var CSV=class{constructor(onOpen=this.onOpen,saveButtonId=null,openButtonId=null){this.onOpen=onOpen;this.notes=[];if(saveButtonId!==null){document.getElementById(saveButtonId).addEventListener("click",this.saveCSV)}if(openButtonId!==null){document.getElementById(openButtonId).addEventListener("click",this.openCSV)}}processArraysForCSV(data=["1|2|3","3|2|1"],delimiter="|",header="a,b,c",saveNotes=false){let csvDat=header+"\\n";let noteIdx=0;data.forEach((line,i3)=>{if(data[i3]==="string"&&delimiter!==","){csvDat+=line.split(delimiter).join(",")}else{csvData+=line.join(",")}if(saveNotes===true){if(this.notes[noteIdx].idx===i3){line+=this.notes[noteIdx].text;noteIdx++}}if(line.indexOf("\\n")<0){csvDat+="\\n"}});return csvDat}static saveCSV(csvDat="a,b,c\\n1,2,3\\n3,2,1\\n",name2=new Date().toISOString()){var hiddenElement=document.createElement("a");hiddenElement.href="data:text/csv;charset=utf-8,"+encodeURI(csvDat);hiddenElement.target="_blank";if(name2!==""){hiddenElement.download=name2}else{hiddenElement.download=new Date().toISOString()+".csv"}hiddenElement.click()}static openCSV(delimiter=",",onOpen=(csvDat,header,path)=>{return csvDat,header,path}){return new Promise((res,rej)=>{var input=document.createElement("input");input.accept=".csv";input.type="file";input.onchange=e=>{var file=e.target.files[0];var reader=new FileReader;reader.onload=event=>{var tempcsvData=event.target.result;var tempcsvArr=tempcsvData.split("\\n");let header=[];var csvDat=[];tempcsvArr.pop();tempcsvArr.forEach((row,i3)=>{if(i3==0){header=row.split(delimiter)}else{var temp=row.split(delimiter);csvDat.push(temp)}});onOpen(csvDat,header,input.value);input.value="";res({data:csvDat,header,filename:input.value})};reader.readAsText(file)};input.click()})}static openCSVRaw(onOpen=(csvDat,path)=>{return csvDat,path}){return new Promise((res,rej)=>{var input=document.createElement("input");input.accept=".csv";input.type="file";input.onchange=e=>{var file=e.target.files[0];var reader=new FileReader;reader.onload=event=>{var tempcsvData=event.target.result;onOpen(tempcsvData,input.value);input.value="";res({data:tempcsvData,filename:input.value})};reader.readAsText(file)};input.click()})}onOpen(csvDat=[],header=[]){console.log("CSV Opened!",header,csvDat)}};var parseCSVData=(data,filename,head,hasend=true,parser=(lines,filename2,head2)=>{let result={filename:filename2};let header=head2;if(typeof head2==="string")header=head2.split(",");result.header=header;for(let i3=0;i3<lines.length;i3++){let line=lines[i3].split(",");for(let j=0;j<line.length;j++){if(!result[header[j]])result[header[j]]=[];result[header[j]].push(line[j])}}return result})=>{let lines;if(data.includes("\\r"))lines=data.split("\\r\\n");else lines=data.split("\\n");if(!head)head=lines[0];lines.shift();if(hasend===false)lines.pop();let result=parser(lines,filename,head);return result};function toISOLocal(d2){d2=new Date(d2);var z3=n=>("0"+n).slice(-2);var zz=n=>("00"+n).slice(-3);var off=d2.getTimezoneOffset();var sign=off<0?"+":"-";off=Math.abs(off);return d2.getFullYear()+"-"+z3(d2.getMonth()+1)+"-"+z3(d2.getDate())+"T"+z3(d2.getHours())+":"+z3(d2.getMinutes())+":"+z3(d2.getSeconds())+"."+zz(d2.getMilliseconds())+"(UTC"+sign+z3(off/60|0)+":00)"}var BrowserFS=__toESM4(require_browserfs());var fsInited=false;var fs2=BrowserFS.BFSRequire("fs");var BFSBuffer=BrowserFS.BFSRequire("buffer").Buffer;var initPromise;var initFS=async(dirs=["data"],oninit=(exists2=[])=>{},onerror=e=>{},filesystem="IndexedDB")=>{if(fsInited){if(initPromise){await initPromise}return true}else{fsInited=true;initPromise=new Promise((resolve,reject)=>{BrowserFS.FileSystem[filesystem].Create({},(e,mountableFileSystem)=>{if(e){reject(e);return}if(!mountableFileSystem){onerror(e);reject(new Error(`Error creating BrowserFS`));return}BrowserFS.initialize(mountableFileSystem);let promises=[];dirs.forEach(async dir=>{promises.push(dirExists(fs2,dir))});Promise.all(promises).then(values=>{oninit(values);resolve(true)})})});return await initPromise}};var exists=async(path="")=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise(resolve=>{fs2.exists("/"+path,function(exists2){resolve(exists2)})})};var readFile=async(path="data")=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise(resolve=>{fs2.readFile("/"+path,function(e,output){resolve(output)})})};async function readFileChunk(path="data",begin=0,end=5120,onread=data=>{}){if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);if(path!=""){return await new Promise(async(resolve,reject)=>{fs2.open("/"+path,"r",(e,fd)=>{if(e){reject(e);return}fs2.read(fd,end,begin,"utf-8",(er,output,bytesRead)=>{if(er){reject(er);return}if(bytesRead!==0){let data=output.toString();fs2.close(fd,()=>{onread(data,path);resolve(data)})}else resolve(void 0)})})})}else{console.error("Path name is not defined");return void 0}}var getFilenames=async(directory="data",onload=directory2=>{})=>{if(!fsInited)await initFS([directory]);else await dirExists(fs2,directory);return await new Promise((resolve,reject)=>{fs2.readdir("/"+directory,(e,dir)=>{if(e){reject(e);return}if(dir){onload(dir);resolve(dir)}else resolve(void 0)})})};var writeFile=async(path,data,onwrite=data2=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise((resolve,reject)=>{fs2.writeFile("/"+path,data,err=>{if(err){reject(err);return}onwrite(data);resolve(true)})})};var appendFile2=async(path,data,onwrite=data2=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise((resolve,reject)=>{fs2.appendFile("/"+path,data,err=>{if(err){reject(err);return}onwrite(data);resolve(true)})})};var deleteFile=async(path="data",ondelete=()=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise(resolve=>{if(path!=""){fs2.unlink("/"+path,e=>{if(e)console.error(e);ondelete();resolve(true)})}else{console.error("Path name is not defined");resolve(false)}})};var readFileAsText=async(path="data",end="end",begin=0,onread=(data,filename)=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise(async(resolve,reject)=>{let size=await getFileSize(path);if(end==="end"){end=size}else if(typeof end==="number"){if(end>size)end=size}fs2.open("/"+path,"r",(e,fd)=>{if(e){reject(e);return}fs2.read(fd,end,begin,"utf-8",(er,output,bytesRead)=>{if(er){reject(er);return}if(bytesRead!==0){let data=output.toString();fs2.close(fd,()=>{onread(data,path);resolve(data)})}else resolve(void 0)})})})};var listFiles=async(dir="data",onload=directory=>{})=>{if(!fsInited)await initFS([dir]);else await dirExists(fs2,dir);return await new Promise((resolve,reject)=>{fs2.readdir("/"+dir,(e,directory)=>{if(e){reject(e);return}if(directory){onload(directory)}resolve(directory)})})};var getFileSize=async(path="data",onread=size=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise((resolve,reject)=>{fs2.stat("/"+path,(e,stats)=>{if(e){reject(e);return}let filesize=stats.size;onread(filesize);resolve(filesize)})})};var getCSVHeader=async(path="data",onopen=(header,filename)=>{})=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise((resolve,reject)=>{fs2.open("/"+path,"r",(e,fd)=>{if(e){reject(e);return}fs2.read(fd,65535,0,"utf-8",(er,output,bytesRead)=>{if(er){reject(er);return}if(bytesRead!==0){let data=output.toString();let lines=data.split("\\n");let header=lines[0];fs2.close(fd,()=>{onopen(header,path);resolve(header)})}else resolve(void 0)})})})};var writeToCSVFromDB=async(path="data",fileSizeLimitMb=10)=>{if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);return await new Promise((resolve,reject)=>{if(path!=""){fs2.stat("/"+path,(e,stats)=>{if(e){reject(e);return}let filesize=stats.size;fs2.open(path,"r",(e2,fd)=>{if(e2){reject(e2);return}let i3=0;let maxFileSize=fileSizeLimitMb*1024*1024;let end=maxFileSize;if(filesize<maxFileSize){end=filesize;fs2.read(fd,end,0,"utf-8",(e3,output,bytesRead)=>{if(e3){reject(e3);return}if(bytesRead!==0)CSV.saveCSV(output.toString(),path.split("/")[1]);fs2.close(fd);resolve(true)})}else{const writeChunkToFile=async()=>{if(i3<filesize){if(i3+end>filesize){end=filesize-i3}let chunk=0;fs2.read(fd,end,i3,"utf-8",(e3,output,bytesRead)=>{if(e3){reject(e3);return}if(bytesRead!==0){CSV.saveCSV(output.toString(),path.split("/")[1]+"_"+chunk);i3+=maxFileSize;chunk++;writeChunkToFile();fs2.close(fd);resolve(true)}})}}}})})}else{console.error("File name is not defined.");resolve(false)}})};async function processCSVChunksFromDB(path="data",onData=(csvdata,start2,end2,size)=>{},maxChunkSize=1e4,start=0,end="end",options={}){let size=await getFileSize(path);let partition=start;return await new Promise((res,rej)=>{let processPartition=()=>{let endChunk=partition+maxChunkSize;if(endChunk>size){endChunk=size}readCSVChunkFromDB(path,partition,endChunk,options).then(async result=>{await onData(result,partition,endChunk,size);partition=endChunk;if(partition!==size){processPartition()}else{res(true)}}).catch(rej)};processPartition()})}async function readCSVChunkFromDB(path="data",start=0,end="end",options={}){if(!fsInited)await initFS([path.split("/")[0]]);else await dirExists(fs2,path.split("/")[0]);const transpose=options.transpose||false;let head=await getCSVHeader(path);if(head)head=head.split(",");else return void 0;let resultLengths=[];let resultNames=[];let results=transpose?[]:{};head.forEach(v2=>{if(v2){resultNames.push(v2);resultLengths.push(1)}else resultLengths[resultLengths.length-1]++});let size=await getFileSize(path);if(end==="end")end=size;else if(end>size){start=size-(end-start);end=size}let data=(await readFileChunk(path,start,end))?.split("\\n").slice(1,-1);let preprocess=value=>{try{value=JSON.parse(value)}catch{}return value};if(data)data.forEach((r,i3)=>{let row=r.split(",");if(transpose){const entry={};if(options.json)row.forEach((v2,idx)=>{if(options.json)entry[resultNames[idx]]=preprocess(v2);else entry[resultNames[idx]]=v2});results.push(entry)}else{row.forEach((v2,i22)=>{const header=resultNames[i22];if(!results[header])results[header]=[];if(options.json)results[header].push(preprocess(v2));else results[header].push(v2)})}});return results}var directories={};var dirExists=async(fs3,directory)=>{if(!fsInited)await initFS([directory]);return await new Promise((resolve,reject)=>{if(!directory)reject(false);if(directories[directory]==="exists"||directories[directory]==="created"){resolve()}else{if(directory[0]==="/")directory=directory.substring(1);if(!directory)reject(false);fs3.exists(`/${directory}`,exists2=>{if(exists2){directories[directory]="exists";resolve()}else if(directories[directory]==="creating"){resolve()}else{directories[directory]="creating";fs3.mkdir(`/${directory}`,1,err=>{if(err){reject(err);return}directories[directory]="created";setTimeout(resolve,500)})}})}})};var BFSRoutes={initFS,dirExists,exists,readFile,readFileChunk,getFilenames,writeFile,appendFile:appendFile2,deleteFile,readFileAsText,getFileSize,getCSVHeader,listFiles};var CSV_REFERENCE={};function lerp(v0,v1,t3){return(1-t3)*v0+t3*v1}function interpolerp(v0,v1,fit,floor=true){if(fit<=2)return[v0,v1];let a=1/fit;let result=new Array(fit);result[0]=v0;for(let i3=1;i3<=fit;i3++){result[i3]=lerp(v0,v1,a*i3);if(floor)result[i3]=Math.floor(result[i3])}return result}var appendCSV=async(newData,filename,header,options)=>{if(!filename){let keys3=Object.keys(CSV_REFERENCE);if(keys3.length>0)filename=keys3[keys3.length-1];else filename=`csv${new Date().toISOString()}`}let csv=CSV_REFERENCE[filename];if(!csv){let keys3=Array.from(Object.keys(newData));if(keys3.indexOf("timestamp")>-1)keys3.splice(keys3.indexOf("timestamp"),1);CSV_REFERENCE[filename]={header:header?header:["timestamp","localized",...keys3],lastX:void 0,buffer:"",buffered:0,bufferSize:options?.bufferSize?options.bufferSize:0,toFixed:options?.toFixed?options.toFixed:0,xIncrement:options?.xIncrement?options.xIncrement:0};csv=CSV_REFERENCE[filename];const existingHeader=await getCSVHeader(filename).catch(()=>null);const isDifferent=!existingHeader||existingHeader!==csv.header.join(",");if(isDifferent)header=csv.header}if(!csv.header||csv.header?.length===0){let keys3=Array.from(Object.keys(newData));if(keys3.indexOf("timestamp")>-1)keys3.splice(keys3.indexOf("timestamp"),1);csv.header=header?header:["timestamp","localized",...keys3]}else if(header)csv.header=header;let maxLen=1;for(const key in newData){const value=newData[key];if(csv.header.indexOf(key)>-1&&value&&Array.isArray(value)&&value?.length>maxLen)maxLen=value?.length}let x3;if(csv.xIncrement){if(!csv.lastX){if(typeof newData[csv.header[0]]!=="undefined"){x3=newData[csv.header[0]]}else if(csv.header[0].toLowerCase().includes("time")||csv.header[0].toLowerCase().includes("unix"))x3=Date.now()}else{if(newData[csv.header[2]]){if(Array.isArray(newData[csv.header[2]]))x3=csv.lastX+csv.xIncrement*newData[csv.header[2]].length;else x3=csv.lastX+csv.xIncrement}else if(newData[csv.header[0]]){if(Array.isArray(newData[csv.header[0]]))x3=csv.lastX+csv.xIncrement*newData[csv.header[0]].length;else x3=csv.lastX+csv.xIncrement}else x3=csv.lastX+csv.xIncrement}}else if(newData[csv.header[0]])x3=newData[csv.header[0]];else x3=Date.now();if(typeof csv.lastX==="undefined")csv.lastX=Array.isArray(x3)?x3[0]:x3;if(typeof x3==="undefined"){if(csv.header[0].includes("time")){let now=Date.now();if(maxLen===1)x3=Date.now();else{x3=interpolerp(csv.lastX,now,maxLen);x3.shift()}}else{let newX=csv.lastX+1;if(maxLen>1){x3=new Array(maxLen).fill("");x3[maxLen-1]=newX}else x3=newX}}else if(maxLen>1&&x3?.length!==maxLen){if(!Array.isArray(x3)||x3.length===1){x3=interpolerp(csv.lastX,x3,maxLen,true);x3.shift()}else{x3=interpolerp(x3[0],x3[x3.length-1],maxLen,true);x3.shift()}}let toAppend=[];if(Array.isArray(x3)){let curIdcs={};for(let i3=0;i3<x3.length;i3++){toAppend.push([]);for(let j=0;j<csv.header.length;j++){let d2=newData[csv.header[j]];if(j===0){toAppend[i3][0]=x3[i3];if(csv.header[j+1]==="localized"){j++;toAppend[i3][j]=toISOLocal(x3[i3])}continue}if(d2===void 0){toAppend[i3][j]=""}else if(Array.isArray(d2)){if(d2.length===x3.length)toAppend[i3][j]=d2[i3];else{if(!(csv.header[j]in curIdcs)){curIdcs[csv.header[j]]=i3;if(d2.length!==1)toAppend[i3][j]=d2[i3]}else{if(d2.length===1&&i3===x3.length-1){toAppend[i3][j]=d2[curIdcs[csv.header[j]]]}else if(Math.floor(d2.length*i3/x3.length)>curIdcs[csv.header[j]]){curIdcs[csv.header[j]]++;toAppend[i3][j]=d2[curIdcs[csv.header[j]]]}else{toAppend[i3][j]=""}}}}else{if(i3===x3.length-1){toAppend[i3][j]=d2}else{toAppend[i3][j]=""}}if(typeof toAppend[i3][j]==="number"&&Math.floor(toAppend[i3][j])!==toAppend[i3][j])toAppend[i3][j]=toAppend[i3][j].toFixed(CSV_REFERENCE[filename].toFixed)}}}else{toAppend.push([]);for(let j=0;j<csv.header.length;j++){if(j===0){toAppend[0][0]=x3;if(csv.header[j+1]==="localized"){j++;toAppend[0][j]=toISOLocal(x3)}continue}if(csv.header[j]in newData)toAppend[0][j]=newData[csv.header[j]];else toAppend[0][j]="";if(typeof toAppend[0][j]==="number"&&Math.floor(toAppend[0][j])!==toAppend[0][j])toAppend[0][j]=toAppend[0][j].toFixed(CSV_REFERENCE[filename].toFixed)}}let csvProcessed="";if(header)csvProcessed+=header.join(",")+"\\n";toAppend.forEach(arr=>{csvProcessed+=(options?.json?arr.map(v2=>JSON.stringify(v2)):arr).join(",")+"\\n";if(csv.bufferSize)csv.buffered++});csv.lastX=toAppend[toAppend.length-1][0];if(csv.bufferSize){csv.buffer+=csvProcessed;if(csv.buffered>csv.bufferSize){let r=new Promise((res,rej)=>{exists(filename).then(fileExists=>{if(!fileExists){writeFile(filename,csv.buffer,written=>{res(written)})}else{appendFile2(filename,csv.buffer,written=>{res(written)})}})});await r;csv.buffer="";csv.buffered=0;return r}else return await Promise.resolve(true)}else{return await new Promise((res,rej)=>{exists(filename).then(fileExists=>{if(!fileExists){writeFile(filename,csvProcessed,written=>{res(written)})}else{appendFile2(filename,csvProcessed,written=>{res(written)})}})})}};var updateCSVHeader=(header,filename)=>{if(CSV_REFERENCE[filename]){CSV_REFERENCE[filename].header=header}};var createCSV=(filename,header,toFixed=5,bufferSize=0,xIncrement)=>{if(!CSV_REFERENCE[filename]){if(header?.indexOf("timestamp")>1){header.splice(header.indexOf("timestamp"),1);header.unshift("timestamp")}if((header?.[0].toLowerCase().includes("time")||header?.[0].toLowerCase().includes("unix"))&&header[1]!=="localized"){header.splice(1,0,"localized")}CSV_REFERENCE[filename]={header,lastX:header[1]==="localized"?Date.now():0,bufferSize,buffer:"",buffered:0,toFixed,xIncrement};return new Promise((res,rej)=>{exists(filename).then(doesExist=>{if(!doesExist){writeFile(filename,CSV_REFERENCE[filename].header?CSV_REFERENCE[filename].header.join(",")+"\\n":"",written=>{res(written)}).catch(rej)}})})}};var visualizeDirectory=(dir,parentNode=document.body)=>{return new Promise(async(res,rej)=>{if(parentNode.querySelector("#bfs"+dir))parentNode.querySelector("#bfs"+dir)?.remove();parentNode.insertAdjacentHTML("beforeend",`<div id=\'bfs${dir}\' class=\'bfs${dir}\'></div>`);let div=parentNode.querySelector("#bfs"+dir);await listFiles(dir).then(directory=>{if(directory.length===0)div.innerHTML="No Files!";else directory.forEach(listing=>{div?.insertAdjacentHTML("beforeend",`<div id=\'${listing}\' class=\'bfsfilediv\'>\n                        <span class=\'bfsfiletitle\'>Data: </span>\n                        <span>${listing}</span>\n                        <button class=\'bfsdownloadbtn\' id=\'download${listing}\'>Download CSV</button>\n                        ${listing.indexOf(".")>-1?`<button class=\'bfsdeletebtn\' id=\'delete${listing}\'>Delete</button>`:""}\n                    </div>`);if(document.getElementById(`delete${listing}`)){document.getElementById(`delete${listing}`).onclick=()=>{deleteFile(dir+"/"+listing,()=>{visualizeDirectory(dir,parentNode)})}}if(document.getElementById(`download${listing}`)){document.getElementById(`download${listing}`).onclick=()=>{writeToCSVFromDB(dir+"/"+listing,10)}}});res(directory)}).catch(rej)})};var csvRoutes={appendCSV,updateCSVHeader,createCSV,visualizeDirectory,openCSV:CSV.openCSV,saveCSV:CSV.saveCSV,openCSVRaw:CSV.openCSVRaw,parseCSVData,getCSVHeader,writeToCSVFromDB,readCSVChunkFromDB,processCSVChunksFromDB,toISOLocal};Object.assign(nodeTemplates,algorithms);if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){globalThis.Devices=Devices;const worker=new WorkerService({roots:{...workerCanvasRoutes,...remoteGraphRoutes,...BFSRoutes,...csvRoutes,...streamWorkerRoutes,...webglPlotRoutes}})}var device_worker_default=self;})();\n/*! Bundled license information:\n\ndevice-decoder/dist/device.frontend.esm.js:\n  (*! Bundled license information:\n  \n  @capacitor/core/dist/index.js:\n    (*! Capacitor: https://capacitorjs.com/ - MIT License *)\n  *)\n\ngraphscript-services.storage/dist/index.storage.services.esm.js:\n  (*! Bundled license information:\n  \n  browserfs/dist/browserfs.js:\n    (*!\n    * The buffer module from node.js, for the browser.\n    *\n    * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n    * @license  MIT\n    *)\n  *)\n*/\n',uPe=URL.createObjectURL(new globalThis.Blob([cPe],{type:"text/javascript"})),$c=uPe;var fPe=Object.defineProperty,dPe=(e,t,r)=>t in e?fPe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Gt=(e,t,r)=>(dPe(e,typeof t!="symbol"?t+"":t,r),r),Ia=class{constructor(){}static genSineWave(e=20,t=1,r=1,n=512,i=0,s=1){for(var a=[],o=[],l=1/n,c=0;c<r;c+=l){var f=Math.sin(2*Math.PI*e*c)*t;f+=Math.sin(2*Math.PI*i*c)*s,a.push(f),o.push(c)}return[o,a]}static getSineAmplitude(e=20,t=1,r=0,n=0){return Math.sin(this.TWO_PI*e*r+n)*t}static mean(e){var t=e.reduce((r,n)=>n+=r);return t/e.length}static median(e){let t=e.slice().sort((n,i)=>n-i),r=Math.floor(t.length/2);return t.length%2===0?(t[r-1]+t[r])/2:t[r]}static mode(e){return e.sort((t,r)=>e.filter(n=>n===t).length-e.filter(n=>n===r).length).pop()}static range(e){return Math.max(...e)-Math.min(...e)}static std(e,t=void 0){let r=t;t||(r=this.mean(e));let n=0;for(let i=0;i<e.length;i++){let s=e[i]-r;n+=s*s}return Math.sqrt(n/e.length)}static relError(e=[],t=[],r=!0){if(e.length!==t.length)throw new Error("Input arrays of same length!");let n=e.length,i=new Array(e.length);for(let s=0;s<n;s++){let a=(e[s]-t[s])/e[s];r&&(a=Math.abs(a)),i[s]=a}return i}static informationEntropy(e=[]){let t=e.length,r=new Array(t);for(let n=0;n<t;n++){let i=e[n]*Math.log(e[n]);isNaN(i)&&(i=0),r[n]=i}return r}static zscore(e){let t=this.mean(e),r=this.std(e,t),n=new Array(e.length);for(let i=0;i<e.length;i++)n[i]=(e[i]-t)/r;return n}static variance(e){var t=this.mean(e);return e.reduce((r,n)=>r+(n-t)**2,0)/e.length}static coeffVariation(e,t){let r=this.mean(e),n=this.std(e,r);return t?n/t:n/r}static coeffDetermination(e,t){let r=this.mean(e),n=e.reduce((s,a)=>s+Math.pow(a-r,2),0);return 1-e.reduce((s,a,o)=>s+Math.pow(a-t[o],2),0)/n}static percentile(e,t){let r=e.slice().sort((i,s)=>i-s),n=Math.ceil(t*(r.length-1));return r[n]}static interquartileRange(e){let t=e.slice().sort((a,o)=>a-o),r=Math.ceil(.25*(t.length-1)),n=Math.ceil(.75*(t.length-1)),i=t[r];return t[n]-i}static skewness(e){let t=e.length,r=this.mean(e),n=this.std(e);return e.reduce((a,o)=>a+Math.pow(o-r,3),0)/(t*Math.pow(n,3))}static kurtosis(e){let t=e.length,r=this.mean(e),n=this.std(e);return e.reduce((a,o)=>a+Math.pow(o-r,4),0)/(t*Math.pow(n,4))-3}static chiSquareTest(e,t){return e.reduce((n,i,s)=>{let a=t[s];return n+Math.pow(i-a,2)/a},0)}static simpleLinearRegression(e,t){let r=e.length,n=e.reduce((c,f)=>c+f,0),i=t.reduce((c,f)=>c+f,0),s=e.reduce((c,f,u)=>c+f*t[u],0),a=e.reduce((c,f)=>c+f*f,0),o=(r*s-n*i)/(r*a-n*n),l=(i-o*n)/r;return{slope:o,intercept:l}}static vecadd(...e){let t=e.length;return e[0].map((r,n)=>{for(let i=1;i<t;i++)r+=e[i][n];return r})}static vecmul(...e){let t=e.length;return e[0].map((r,n)=>{for(let i=1;i<t;i++)r*=e[i][n];return r})}static vecsub(e,t){return e.map((r,n)=>r-t[n])}static vecdiv(e,t){return e.map((r,n)=>r/t[n])}static vecscale(e,t){return e.map((r,n)=>r*t)}static vecaddScalar(e,t){return e.map((r,n)=>r+t)}static vecmulScalar(e,t){return e.map((r,n)=>r*t)}static vecsubScalar(e,t){return e.map((r,n)=>r-t)}static vecdivScalar(e,t){return e.map((r,n)=>r/t)}static dot(e,t){for(var r=0,n=0;n<e.length;n++)r+=e[n]*t[n];return r}static cross3D(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}static sphericalToCartesian(e,t,r){return{x:e*Math.sin(r)*Math.cos(t),y:e*Math.sin(r)*Math.sin(t),z:e*Math.cos(r)}}static cartesianToSpherical(e,t,r){var n=Math.sqrt(e*e+t*t+r*r),i=Math.atan2(t,e),s=Math.acos(r/n);return{r:n,theta:i,phi:s}}static magnitude(e){var t=0;return e.forEach(r=>{t+=r*r}),Math.sqrt(t)}static distance(e,t){var r=0;return e.forEach((n,i)=>{r+=(t[i]-n)*(t[i]-n)}),Math.sqrt(r)}static midpoint(e=[1,2,3],t=[3,4,5]){return e.map((r,n)=>(r+t[n])*.5)}static project(e,t){let r=this.dot(e,t),n=this.magnitude(t)**2;return this.vecmulScalar(t,r/n)}static angleBetween(e,t){let r=this.dot(e,t),n=this.magnitude(e)*this.magnitude(t);return Math.acos(r/n)}static normalize(e){var t=0;t=1/this.magnitude(e);var r=new Array(e.length);return e.forEach((n,i)=>{r[i]=n*t}),r}static normalizeSeries(e=[],t=!0){let r=Math.max(...e),n=Math.min(...e);return t==!1&&(r=Math.max(r,Math.abs(n)),n=0),r-n===0&&(n=0,r===0&&(r=1e-13)),e.map(i=>(i-n)/(r-n))}static quadraticFormula(e,t,r){let n=Math.sqrt(t*t-4*e*r);if(!isNaN(n))return["complex","complex"];let i=1/(2*e);if(n===0)return[t*i];let s=-t;return[(s+n)*i,(s-n)*i]}static newtonsMethod1D(e=s=>Math.pow(s,5)+s*s-s-.2,t=0,r=1,n=.01,i=10){let s=[];for(let a=0;a<i;a++){let o=Math.random()*(r-t),l=e(o),c=e(o+n),f=(c-l)/n,u=o+n;for(;Math.abs(f)>n;){let _=-l/k,w=u+_;l=c,c=e(w);let k=(c-l)/(w-u)}let d,p=s.find((_,w)=>{if(Math.abs(xn1-_)<n)return d=w,!0});p?s[d]=(xn1+p)*.5:s.push(xn1)}return s}static makeVec(e,t){var r=[];return e.forEach((n,i)=>{r.push(t[i]-n)}),r}static getBufferedValueByCoordinates(e=new Array(300).fill(1),t=[10,10,2],r=[1,2,1],n=void 0){let i=(a=0,o=0)=>{if(o===t.length)return a;if(o==0)a+=r[o];else if(t[o]==0)dimsAt0++;else{let l=(c=r[o],f=o-1)=>(c*=t[f],f--,f==0?c:l(c,f));a+=l(r[o]+1,o-1)}return o++,i(a,o)},s=i();if(n){if(r[r.length-1]===0){let a=0,o=0;for(;o!==r.length-1;)r[o]!==0&&(a=o),o++;return e[s-a+n]}return e[s-t.length+n]}else{if(r[r.length-1]===0){let a=0,o=0;for(;o!==r.length-1;)r[o]!==0&&(a=o),o++;return e.slice(s-a,s+1)}return e.slice(s-t.length,s+1)}}static forBufferedMat(e=new Array(100).fill(1),t=[10,10],r=(n,i,s,a)=>n+s+a){let n=[],i=0,s=(o=0,l=o+1)=>{let c=new Array(e.length);for(let f=0;f<t[o];f++)n[o]=f,t[l]?s(l):(c[i]=r(e[i],i,...n),i++);return c},a=(o,l=o+1)=>{let c=new Array(e.length);for(let f=0;f<t[o];f++)if(n[o]=f,t[l])s(l);else for(let u=0;u<t.length;u++)c[i]=r[u](e[i],i,...n),i++;return c};if(typeof r=="function")return s();if(Array.isArray(r))return a()}static mapBufferedMat(e=new Array(100).fill(1),t=[10,10],r=(n,i,s,a)=>(console.log(`value:${n}, idx:${i}, x:${s},y:${a}`),n+s+a)){let n=new Array(t.length).fill(0),i=(o,l=0)=>{if(o[l]>=t[l]){if(o[l]=0,l++,l===t.length)return;i(o,l)}else o[l]++},s=new Array(e.length),a=0;if(typeof r=="function")for(;a<e.length;)s[a]=r(e[a],a,...n),a+=t.length,i(n);else if(Array.isArray(r))for(;a<e.length;)r.forEach(o=>{s[a]=o(e[a],a,...n),a++,i(n)});return s}static combinations(e=["a","b","c"],t=3){var r=[];return t<=0?r.push([]):Ia.combinations(e,t-1).forEach(function(n){e.forEach(function(i){r.push([i].concat(n))})}),r}static generateCoordinateSpace(e=[10,10,10],t=[-10,-10,-10],r=[1,1,1],n=void 0){for(let o=0;o<e.length;o++)if(t[o]>e[o]){let l=e[o];e[o]=t[o],t[o]=l}let i=[],s=[...e],a=s.length-1;for(i.push([...s]);s[0]>=t[0];){let o=c=>{if(s[c]<=t[c]){if(c===0||(s[c]=e[c],c--,c<0))return;typeof r[c]=="function"?s[c]-=r[c](s[c]):s[c]-=r[c],o(c)}},l=a;typeof r[l]=="function"?s[l]-=r[l](s[l]):s[l]-=r[l],i.push([...s]),o(l),n&&(i[i.length-1]=n(i[i.length-1]))}return i}static calcVectorField(e=[[0,0],[0,1],[1,0],[1,1]],t=(r,n)=>[r*10,n*10]){return e.map(r=>t(...r))}static transpose(e){return e[0].map((t,r)=>e.map(n=>n[r]))}static matmul(e,t){for(var r=e.length,n=e[0].length,i=t.length,s=t[0].length,a=new Array(r),o=0;o<r;++o){a[o]=new Array(s);for(var l=0;l<s;++l){a[o][l]=0;for(var c=0;c<n;++c)a[o][l]+=e[o][c]*t[c][l]}}return a}static matscale(e,t){let r=[];for(var n=0;n<e.length;n++){r[n]=[];for(let i=0;i<e[0].length;i++)r[n][i]=e[n][i]*t}return r}static matadd(e,t){let r=[];for(let i=0;i<e.length;i++){r[i]=[];for(var n=0;n<e[0].length;n++)r[i][n]=e[i][n]+t[i][n]}return r}static matsub(e,t){let r=[];for(let i=0;i<e.length;i++){r[i]=[];for(var n=0;n<e[0].length;n++)r[i][n]=e[i][n]-t[i][n]}return r}static histogram(e=[],t=1,r=void 0){let n=[...e];n.sort(function(l,c){return l-c});let i=Math.min(...n);if(typeof r=="number"){let l=Math.max(...n);t=Math.abs((l-i)/(r-1))}let s=i,a=[],o=[];for(let l=0;l<n.length;l++){let c=t*s;if(n[l]>i+c){s++,c+=t;let u=i+c+c*.5;a.push(u),o.push(0)}o[o.length-1]++}return[a,o]}static normalDistribution(e=[],t=!0,r=1e-4){let n=this.mean(e),i=this.variance(e),s=e.length,a=[],o=1/(this.TWO_PI*i),l=1/i,c=0;for(let f=0;f<s;f++){let u=Math.exp(-.5*Math.pow((e[f]-n)*l,2))*o;u<r&&(u=0),a.push(u),c+=u}if(t){let f=1/c;a=a.map(u=>u*f)}return a}static expectedValue(e=[],t=this.normalDistribution(e)){return e.reduce((r,n,i)=>r+n*t[i])}static originMoment(e=[],t=this.normalDistribution(e),r=1){return e.reduce((n,i,s)=>n+Math.pow(i,r)*t[s])}static centralMoment(e=[],t=this.normalDistribution(e),r=1){let n=this.mean(e);return e.reduce((i,s,a)=>i+Math.pow(s-n,r)*t[a]/e.length)}static linearDiscriminantAnalysis(e=[],t=[]){let r=this.mean(e),n=this.mean(t),i=this.cov1d(e,t),s=this.normalDistribution(e),a=[];for(let o=0;o<e.length;o++)a.push(x[o]*i*n-.5*r*i*n+Math.log10(s[o]));return a}static conv1D(e=[],t=[1/3,1/3,1/3],r=Math.floor(t.length*.5)){let n=[],i=1/t.length;if(r>0){let o=new Array(r).fill(0);e=[...o,...e,...o]}let s=Math.floor(t.length*.5),a=e.length-t.length+s;for(let o=s;o<a;o++){let l=0;for(let c=0;c<t.length;c++)l+=e[o-s]*t[c];n.push(l*i)}return n}static conv2D(e=[[],[],[]],t=[[],[],[]],r=0){let n=new Array(e.length-Math.ceil(t.length*.5)).fill([]),i,s=Ia.transpose(s);if(r>0){let w=new Array(r).fill(0);i=Ia.transpose(e);for(let k=0;k<i.length;k++)i[k]=[...w,...i[k],...w];e=Ia.transpose(i);for(let k=0;k<e.length;k++)e[k]=[...w,...e[k],...w]}let a=Math.floor(t[0].length*.5),o=Math.floor(s[0].length*.5),l=e[0].length-t[0].length+a,c=i[0].length-s[0].length+o,f=1/(t[0].length*s[0].length),u=l*c,d=a,p,_=o;for(;d<u;){let w=0;p=d%e[0].length,p===0&&_++;for(let k=0;k<t[0].length;k++){for(let S=0;S<s[0].length;k++)w+=e[_-o+S][p-a+k]*t[S][k];n[_].push(w*f)}d++}return n}static covVec(e,t){let r=this.mean(e),n=this.mean(t);return e.map((i,s)=>(i-r)*(t[s]-n))}static cov1d(e,t){this.mean(this.covVec(e,t))}static cov2d(e){var t=this.transpose(e),r=[],n=[],i=[];e.forEach((_,w)=>{n.push(this.mean(_))}),t.forEach((_,w)=>{i.push(this.mean(_))}),e.forEach((_,w)=>{r.push([]);for(var k=0;k<_.length;k++)r[w].push((e[w][k]-n[w])*(e[w][k]-i[k])/(_.length-1))});for(var s=this.transpose(r),a=r.length,o=r[0].length,l=s.length,c=s[0].length,f=new Array(a),u=0;u<a;++u){f[u]=new Array(c);for(var d=0;d<c;++d){f[u][d]=0;for(var p=0;p<o;++p)f[u][d]+=r[u][p]*s[p][d]/(e[0].length-1)}}return f}static cov3d(e=[],t=[],r=[]){return[[this.cov1d(e,e),this.cov1d(e,t),this.cov1d(e,r)],[this.cov1d(t,e),this.cov1d(t,t),this.cov1d(t,r)],[this.cov1d(r,e),this.cov1d(r,t),this.cov1d(r,r)]]}static covNd(e=[]){let t=[];e.forEach((r,n)=>{t.push([]),e.forEach((i,s)=>{t[n].push(this.cov1d(r,i))})})}static correlationCoeff(e,t){let r=this.cov1d(e,t),n=this.std(e),i=this.std(t);return r/(n*i)}static eigens2x2(e=[[1,2],[3,4]]){let t=e[0][0]*e[1][1]-e[0][1]*e[1][0],r=(e[0][0]+e[1][1])*.5,n=Math.sqrt(r*r-t),i=r+n,s=r-n;return[i,s]}static eigenvectors2x2(e=[[1,2],[3,4]],t=[1,2]){let r=[-e[0][1],e[0][0]-t[0]];r[0]===0&&r[1]===0&&(r[0]=e[1][1]-t[0],r[1]=-e[1][0]);let n=[-e[0][1],e[0][0]-t[1]];return n[0]===0&&n[1]===0&&(n[0]=e[1][1]-t[1],n[1]=-e[1][0]),[r,n]}static fastpca2d(e,t){let r=this.cov2d(e,t),n=this.eigens2x2(r);n[1]>n[0]&&n.reverse();let i=this.eigenvectors2x2(r,n);return[n,i]}static crosscorrelation(e,t,r=!1){let n=e.length,i=t.length,s=[],a=1/Math.sqrt(e.reduce((o,l)=>o+l*l,0)*t.reduce((o,l)=>o+l*l,0));if(r){s.length=e.length;for(let o=0;o<e.length;o++){let l=0;for(let c=0;c<e.length-o;c++)l+=e[c]*t[c+o];s[o]=l*a}return s}else{s.length=i+n;let o=0;for(let l=-i+1;l<n;l++){let c=0;for(let f=0;f<n;f++){let u=f-l;u>=0&&u<i&&(c+=e[f]*t[u])}s[o]=c*a,o++}return s}}static findCorrelationLags(e,t,r=!1,n=!0){let i=[],s=t?1/t:0,a=n?e.length/2:null,o=e.length-1;for(let l=1;l<o;l++)if(e[l]>e[l-1]&&e[l]>e[l+1]){let c={offset:n?l-a:l,value:e[l]};s&&(c.offset*=s),i.push(c)}return r?i.reduce((l,c)=>c.value>l.value?c:l,i[0]):i}static autocorrelation(e){var t=[...e,...Array(e.length).fill(0)],r=this.mean(e),n=e.reduce((c,f)=>c+=Math.pow(f-r,2));n=Math.sqrt(Math.abs(n));let i=n*arr2Est;i===0&&(i=1e-26);for(var s=1/i,a=new Array(e.length).fill(0),o=0;o<e.length;o++){var l=e.reduce((c,f,u)=>c+=(f-r)*(t[o+u]-r));a[o]=l*s}return a}static autocorrelation2dNormalized(e){let t=[];for(let r=0;r<e.length;r++){t.push([]);for(let n=0;n<e[r].length;n++){let i=0,s=0;for(let a=0;a<e.length;a++)for(let o=0;o<e[a].length;o++)i+=e[r][n]*e[e.length-1-a][e[r].length-1-o],s+=e[r][n]*e[e.length-1][e[r].length-1];t[r][n]=i/s-1}}return t}static crosscorrelation2d(e,t){let r=[];for(let n=0;n<e.length;n++){r.push([]);for(let i=0;i<e[n].length;i++){let s=0;for(let a=0;a<t.length;a++)for(let o=0;o<t[a].length;o++)s+=e[n][i]*t[t.length-1-a][t[n].length-1-o];r[n][i]=s}}return r}static crosscorrelation2dNormalized(e,t){let r=[];for(let n=0;n<e.length;n++){r.push([]);for(let i=0;i<e[n].length;i++){let s=0,a=0;for(let o=0;o<t.length;o++)for(let l=0;l<t[o].length;l++)s+=e[n][i]*t[mat2d.length-1-o][t[n].length-1-l],a+=e[n][i]*t[t.length-1][t[n].length-1];r[n][i]=s/a-1}}return r}static correlograms(e=[[],[]]){var t=[];return e.forEach((r,n)=>{e.forEach((i,s)=>{s>=n&&t.push(Ia.crosscorrelation(r,i))})}),t}static dft(e=[]){for(var t=6.283185307179586,r=[],n=[],i=[],s=0;s<e.length;s++){r.push(0),n.push(0);for(var a=0;a<e.length;a++){var o=t*s*a/e.length;r[s]=r[s]+e[a]*Math.cos(o),n[s]=n[s]-e[a]*Math.sin(o)}i.push(Math.sqrt(r[s]*r[s]+n[s]*n[s]))}function l(u){return[...u.slice(Math.ceil(u.length*.5),u.length),...u.slice(0,Math.ceil(u.length*.5))]}i=l(i);let c=i.length*.5,f=i.map((u,d)=>d-c);return{real:r,imag:n,freqs:f,mags:i}}static sma(e=[],t){for(var r=[],n=0;n<e.length;n++)if(n==0)r.push(e[0]);else if(n<t){var i=e.slice(0,n+1);r.push(i.reduce((s,a)=>a+=s)/(n+1))}else{var i=e.slice(n-t,n);r.push(i.reduce((a,o)=>o+=a)/t)}return r}static sum(e=[]){if(e.length>0){var t=e.reduce((r,n)=>n+=r);return t}else return 0}static reduceArrByFactor(e,t=2){return e.filter((n,i)=>i%t===0)}static makeArr(e,t,r){for(var n=[],i=(t-e)/(r-1),s=0;s<r;s++)n.push(e+i*s);return n}static autoscale(e,t=1,r=0,n=!1){if(e?.length===0)return e;let i=Math.max(...e),s=Math.min(...e),a=1/t,o;if(n){let l=Math.max(Math.abs(s),Math.abs(i));return o=a/l,e.map(c=>c*o+(a*(r+1)*2-1-a))}else return o=a/(i-s),e.map(l=>2*((l-s)*o-1/(2*t))+(a*(r+1)*2-1-a))}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t,r=1){if(e.length>t){let n=new Array(t),i=e.length/t,s=e.length-1,a=0,o=0;for(let l=i;l<e.length;l+=i){let c=Math.round(l);c>s&&(c=s);for(let f=a;f<c;f++)n[o]+=e[f];n[o]/=(c-a)*r,o++,a=c}return n}else return e}static interpolateArray(e,t,r=1){var n=function(u,d,p){return(u+(d-u)*p)*r},i=new Array,s=(e.length-1)/(t-1);i[0]=e[0];for(var a=1;a<t-1;a++){var o=a*s,l=Math.floor(o),c=Math.ceil(o),f=o-l;i[a]=n(e[l],e[c],f)}return i[t-1]=e[e.length-1],i}static resample(e,t,r=1){return e.length===t?e:e.length>t?this.downsample(e,t,r):this.upsample(e,t,r)}static lerp(e,t,r){return(1-r)*e+r*t}static isExtrema(e,t="peak"){let r=[...e];if(r.length%2===0&&r.pop(),e.length>1){let n=!0;for(let i=0;i<r.length;i++){let s=r[i];if(t==="peak"){if(i<Math.floor(r.length*.5)&&s>=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&s>=r[Math.floor(r.length*.5)]){n=!1;break}}else if(t==="valley"){if(i<Math.floor(r.length*.5)&&s<=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&s<=r[Math.floor(r.length*.5)]){n=!1;break}}else if(i<Math.floor(r.length*.5)&&s<=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&s<=r[Math.floor(r.length*.5)]){n=!1;break}}if(t!=="peak"&&t!=="valley"&&n===!1){n=!0;for(let i=0;i<r.length;i++){let s=r[i];if(i<Math.floor(r.length*.5)&&s>=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&s>=r[Math.floor(r.length*.5)]){n=!1;break}}}return n}else return}static isCriticalPoint(e,t="peak"){let r=[...e];if(r.length%2===0&&r.pop(),e.length>1){let n=!0;for(let i=0;i<r.length;i++){let s=r[i];if(t==="peak"){if(i<r.length*.5&&s<=0){n=!1;break}else if(i>r.length*.5&&s>0){n=!1;break}}else if(t==="valley"){if(i<r.length*.5&&s>=0){n=!1;break}else if(i>r.length*.5&&s<0){n=!1;break}}else if(i<r.length*.5&&s>=0){n=!1;break}else if(i>r.length*.5&&s<0){n=!1;break}}if(t!=="peak"&&t!=="valley"&&n===!1){n=!0;for(let i=0;i<r.length;i++){let s=r[i];if(i<r.length*.5&&s<=0){n=!1;break}else if(i>r.length*.5&&s>0){n=!1;break}}}return n}else return}static getPeakThreshold(e,t,r){let n,i=e.filter((s,a)=>{if(t.indexOf(a)>-1)return!0});return r===0?n=this.mean(i):n=(r+this.mean(i))*.5,n}static column(e,t){let r=new Array(e.length).fill(0).map(()=>new Array(1).fill(0));for(let n=0;n<e.length;n++)r[n][0]=e[n][t];return r}static flatten_vector(e){let t=[];for(let r=0;r<e.length;r++)t[r]=e[r][0];return t}static squared_difference(e,t){let r=0;for(let n=0;n<e.length;n++)r=r+Math.pow(e[n]-t[n],2);return r}static shift_deflate(e,t,r){let n=Math.sqrt(this.matmul(this.transpose(r),r)),i=this.matscale(r,1/n),s=this.matscale(this.matmul(i,this.transpose(i)),t);return this.matsub(e,s)}static eigenvalue_of_vector(e,t){return ev=this.matmul(this.matmul(this.transpose(t),e),t),ev}static power_iteration(e,t=1e-5,r=1e3){let n=e.length,i=new Array(n).fill(0).map(()=>new Array(1).fill(Math.sqrt(n))),s=this.eigenvalue_of_vector(e,i),a=1,o=0;for(;a>t&&o<r;){let l=JSON.parse(JSON.stringify(s)),c=this.matmul(e,i);i=this.normalize(c),s=this.eigenvalue_of_vector(e,i),a=Math.abs(s-l),o++}return[s,i]}static eigens(e,t=1e-4,r=1e3){let n=[],i=[];for(let s=0;s<e.length;s++){let a=this.power_iteration(e,t,r),o=a[0],l=a[1];n[s]=o,i[s]=this.flatten_vector(l),e=this.shift_deflate(e,o,l)}return[n,i]}static pca(e,t=1e-5){let r=e.length,n=new Array(r),i=new Array(r),s=this.transpose(e);n[0]=this.column(e,0);let a=1,o=0;for(;espilon>t;){o++,i[0]=this.matmul(s,n[0]);let c=this.matmul(this.transpose(n[0]),n[0]);i[0]=this.matscale(i[0],1/c);let f=Math.sqrt(this.matmul(this.transpose(i[0]),i[0]));i[0]=this.matscale(i[0],1/f);let u=this.matmul(e,i[0]),d=this.matmul(this.transpose(i[0]),i[0]);u=this.matscale(u,1/d),a=this.squared_difference(n[0],u),n[0]=JSON.parse(JSON.stringify(u))}return this.matmul(this.transpose(n[0]),n[0])}static circularBuffer(e,t){if(Array.isArray(t))if(t.length<e.length){let r=e.slice(t.length),n=e.length;e.splice(0,n,...r,...t)}else if(t.length>e.length){let r=e.length;e.splice(0,r,t.slice(r-t.length))}else e.splice(0,e.length,...t);else e.push(t),e.shift();return e}static HSLToRGB(e,t,r,n=255){t/=100,r/=100;let i=(1-Math.abs(2*r-1))*t,s=i*(1-Math.abs(e/60%2-1)),a=r-i/2,o=0,l=0,c=0;return 0<=e&&e<60?(o=i,l=s,c=0):60<=e&&e<120?(o=s,l=i,c=0):120<=e&&e<180?(o=0,l=i,c=s):180<=e&&e<240?(o=0,l=s,c=i):240<=e&&e<300?(o=s,l=0,c=i):300<=e&&e<360&&(o=i,l=0,c=s),o=(o+a)*n,l=(l+a)*n,c=(c+a)*n,[o,l,c]}static p300(e=[],t=[],r=[],n=256){let i=Math.floor(n/10),s=this.sma(t,i),a=this.peakDetect(s,"peak",i),o=this.mean(s),l=this.std(s,o),c=0,f=[];return a.length>0&&e.forEach((u,d)=>{for(;r[a[c]]<u+200&&(c++,!!a[c]););let p=0,_=[];for(;r[a[c+p]]<u+600&&(_.push(c+p),p++,!!a[c+p]););if(_.length>1){let w=[];_.forEach(O=>{w.push(s[a[O]])});let k=Math.max(...w),S=_[w.indexOf(k)];f.push({event_timestamp:u,event_index:d,peak_timestamp:r[[a[S]]],signal_index:[a[S]],signal_amplitude:t[[a[S]]],zscore:(s[a[S]]-o)/l})}else _.length===1&&f.push({event_timestamp:u,event_index:d,peak_timestamp:r[a[_[0]]],signal_index:a[_[0]],signal_amplitude:t[[a[_[0]]]],zscore:(s[a[_[0]]]-o)/l})}),f}},$t=Ia;Gt($t,"TWO_PI",Math.PI*2);Gt($t,"C",299792458);Gt($t,"G",66743e-15);Gt($t,"h",662607015e-42);Gt($t,"R",8314.32);Gt($t,"Ra",287);Gt($t,"H",69.3);Gt($t,"kbar",1054571817e-43);Gt($t,"kB",1380649e-29);Gt($t,"ke",89875517923e-1);Gt($t,"me",91093837015e-41);Gt($t,"mp",167262192369e-38);Gt($t,"mn",167492749804e-38);Gt($t,"P0",101325);Gt($t,"T0",288.15);Gt($t,"p0",1.225);Gt($t,"Na",60220978e16);Gt($t,"y",1.405);Gt($t,"M0",28.96643);Gt($t,"g0",9.80665);Gt($t,"Re",6378100);Gt($t,"B",1458e-9);Gt($t,"S",110.4);Gt($t,"Sigma",365e-12);Gt($t,"imgkernels",{edgeDetection:[[-1,-1,-1],[-1,8,-1],[-1,-1,-1]],boxBlur:[[1/9,1/9,1/9],[1/9,1/9,1/9],[1/9,1/9,1/9]],sobelLeft:[[1,0,-1],[2,0,-2],[1,0,-1]],sobelRight:[[-1,0,1],[-2,0,2],[-1,0,1]],sobelTop:[[1,2,1],[0,0,0],[-1,-2,-1]],sobelBottom:[[-1,2,1],[0,0,0],[1,2,1]],identity:[[0,0,0],[0,1,0],[0,0,0]],gaussian3x3:[[1,2,1],[2,4,2],[1,2,1]],guassian7x7:[[0,0,0,5,0,0,0],[0,5,18,32,18,5,0],[0,18,64,100,64,18,0],[5,32,100,100,100,32,5],[0,18,64,100,64,18,0],[0,5,18,32,18,5,0],[0,0,0,5,0,0,0]],emboss:[[-2,-1,0],[-1,1,1],[0,1,2]],sharpen:[[0,-1,0],[-1,5,-1],[0,-1,0]]});Gt($t,"integral",(e=n=>n,t=[0,1],r=.01)=>{let n=0;for(let i=t[0];i<t[1];i+=r){let s=e(i);n+=s*r}return n});Gt($t,"dintegral",(e=(i,s)=>i+s,t=[[0,1],[0,1]],r=.01,n=r)=>{let i=0;for(let s=t[0][0]+r;s<t[0][1];s+=r)for(let a=t[1][0]+n;a<t[1][1];a+=n){let o=e(s,a);i+=o*r*n}return i});Gt($t,"tintegral",(e=(s,a,o)=>s+a+o,t=[[0,1],[0,1],[0,1]],r=.01,n=r,i=r)=>{let s=0;for(let a=t[0][0]+r;a<t[0][1];a+=r)for(let o=t[1][0]+n;o<t[1][1];o+=n)for(let l=t[2][0]+i;l<t[2][1];l+=i){let c=e(a,o,l);s+=c*r*n*i}return s});Gt($t,"pintegral",(e=n=>n,t=[0,1],r=.01)=>{let n=0,i,s;for(let a=t[0];a<t[1];a+=r)i=s,s=e(a),i&&(n+=Ia.distance([0,i],[r,s]));return n});Gt($t,"meshgrid",Ia.generateCoordinateSpace);Gt($t,"autocorrelation2d",e=>{let t=[];for(let r=0;r<e.length;r++){t.push([]);for(let n=0;n<e[r].length;n++){let i=0;for(let s=0;s<e.length;s++)for(let a=0;a<e[s].length;a++)i+=e[r][n]*e[e.length-1-s][e[r].length-1-a];t[r][n]=i}}return t});Gt($t,"upsample",Ia.interpolateArray);Gt($t,"linspace",(e,t,r,n=!1)=>{if(r<=2)return[e,t];let i=1/r,s=new Array(r);s[0]=e;for(let a=1;a<=r;a++)s[a]=Ia.lerp(e,t,i*a),n&&(s[a]=Math.floor(s[a]));return s});Gt($t,"peakDetect",(e,t="peak",r=49)=>{let n=Math.floor(r*.5),i=[];for(let s=0;s<e.length-r;s++)Ia.isExtrema(e.slice(s,s+r),t)&&i.push(s+n-1);return i});Object.assign(Math,$t);var Uc={heg:Rc.addWorker({url:$c}),fnirs:Rc.addWorker({url:$c}),hr:Rc.addWorker({url:$c}),breath:Rc.addWorker({url:$c})},mx=[6,7],pPe={6:"long",7:"short"},ZL=[255,9,30],yx={255:"ambient",30:"red",9:"infrared"},hPe=ZL.filter(e=>e!==255).length,JL=0,gPe=ZL.length,GL=0,yPe=mx.length*gPe,mPe={},YL=e=>yx[e],BQ=e=>pPe[e],XL=["timestamp"],QL={},_i={ambient:0,red:0,infrared:0,heg:0,timestamp:0},dv={};mx.forEach(e=>{let t=BQ(e);ZL.forEach(r=>{let i=YL(r)+"_"+t;QL[i]={sps:20,nSec:10},XL.push(i)})});for(let e in av)av[e].useScaling=!0;var bPe=!0,pl,KL=0,po={};xt.data.csvs={};var gx=[],vPe=40,MQ=async()=>{let e=Rc.addWorker({url:$c}),t=await e.run("loadFromTemplate",["beat_detect","hr",{maxFreq:3,sps:20.833}]),r=o=>{if(o){let l={hr:o.bpm,hrv:o.change,height0:o.height0,height1:o.height1,timestamp:o.timestamp};xt.setValue("hr",l),xt.data.deviceRecording&&(xt.data.csvs.hr||(xt.data.csvs.hr="data/HRV_"+new Date().toISOString()+".csv",Uc.hr.run("createCSV",[xt.data.csvs.hr,["timestamp","hr","hrv","height0","height1"],5,0])),Uc.hr.run("appendCSV",l,xt.data.csvs.hr))}};e.subscribe("hr",o=>{Array.isArray(o)?o.map(r):r(o)});let n=Rc.addWorker({url:$c}),i=await n.run("loadFromTemplate",["beat_detect","breath",{maxFreq:.2,sps:20.833}]),s=o=>{if(o){let l={breath:o.bpm,brv:o.change,timestamp:o.timestamp};xt.setValue("breath",l),xt.data.deviceRecording&&(xt.data.csvs.breath||(xt.data.csvs.breath="data/BREATH_"+new Date().toISOString()+".csv",Uc.breath.run("createCSV",[xt.data.csvs.breath,["timestamp","breath","brv"],3,0])),Uc.breath.run("appendCSV",l,xt.data.csvs.breath))}};n.subscribe("breath",o=>{Array.isArray(o)?o.map(s):s(o)});let a="B";return Mc.BLE.nrf5x.namePrefix=a,Mc.BLE.nrf5x_singleended.namePrefix=a,jQ(Mc.BLE.nrf5x_singleended,{workerUrl:$c,ondecoded:{"0002cafe-b0ba-8bad-f00d-deadbeef0000":o=>{if(o.leds){let l={timestamp:o.timestamp},c=(f,u)=>{let d=(p,_)=>{let w=BQ(p),k=YL(f)+"_"+w,S=YL(pl)+"_"+w;if((!po[k]||f===255&&po[k]>o[p][u]||po[k]<o[p][u])&&(po[k]=o[p][u]),pl&&po[S]&&pl!==f){l[S]||(l[S]=[]);let O;if(pl===255?(_===0&&JL++,JL===hPe&&(O=po[S],l[S].push(O),_+1==mx.length&&(JL=0))):(O=bPe&&KL?po[S]-KL:po[S],l[S].push(O)),mPe[S]=l[S],_i[S]=l[S],dv[S]=l[S],typeof O=="number"&&(yx[pl]==="red"?_i.red+=O:yx[pl]==="infrared"?_i.infrared+=O:yx[pl]==="ambient"&&(_i.ambient+=O),pl===255&&(KL=po[S]),delete po[S],GL++,GL===yPe)){_i.infrared&&(gx.push(_i.red/_i.infrared),gx.length>vPe&&gx.shift(),_i.heg=$t.mean(gx),xt.setValue("heg",_i)),_i.timestamp=o.timestamp[0],xt.data.deviceRecording&&(Object.keys(dv).length===XL.length&&(dv.timestamp=l.timestamp,xt.data.csvs.fnirs||(xt.data.csvs.fnirs="data/FNIRS_"+new Date().toISOString()+".csv",Uc.fnirs.run("createCSV",[xt.data.csvs.fnirs,XL,5,21])),Uc.fnirs.run("appendCSV",dv,xt.data.csvs.fnirs),dv={}),xt.data.csvs.heg||(xt.data.csvs.heg="data/HEG_"+new Date().toISOString()+".csv",Uc.heg.run("createCSV",[xt.data.csvs.heg,["timestamp","heg","red","infrared"],3,50])),Uc.heg.run("appendCSV",_i,xt.data.csvs.heg));let A={raw:_i.heg,timestamp:_i.timestamp};e.post("hr",A),n.post("breath",A),GL=0,_i.red=0,_i.infrared=0,_i.ambient=0}}};mx.forEach(d),pl=f};o.leds.forEach(c),xt.setValue("fnirs",l)}}},ondisconnect:()=>{e.terminate(),n.terminate(),xt.setState({deviceConnected:!1,device:void 0})},onconnect:()=>{xt.setState({deviceConnected:!0})},filterSettings:av}).then(o=>{xt.setState({device:o})}).catch(o=>{e.terminate(),n.terminate(),xt.setState({deviceConnected:!1})})};var _Pe='(()=>{var mouseEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]);var wheelEventHandlerImpl=makeSendPropertiesHandler(["deltaX","deltaY"]);var keydownEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function focusEventHandler(event,sendFn){const data={type:event.type};data.isTrusted=event.isTrusted;data.bubbles=event.bubbles;data.cancelBubble=event.cancelBubble;data.cancelable=event.cancelable;data.composed=event.composed;data.defaultPrevent=event.defaultPrevented;data.eventPhase=event.eventPhase;data.returnValue=event.returnValue;data.currentTarget=event.currentTarget.id?event.currentTarget.id:event.currentTarget.constructor.name;data.target=data.currentTarget;data.srcElement=data.currentTarget;sendFn(data)}function wheelEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();wheelEventHandlerImpl(event,sendFn)}function preventDefaultHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault()}function copyProperties(src,properties,dst){for(const name of properties){dst[name]=src[name]}}function makeSendPropertiesHandler(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties(event,properties,data);sendFn(data)}}function touchEventHandler(event,sendFn,preventDefault){if(preventDefault&&event.preventDefault)event.preventDefault();const touches=[];const data={type:event.type,touches};for(let i2=0;i2<event.touches.length;++i2){const touch=event.touches[i2];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var i=1;var keys={};while(i<222){keys[i]=true;i++}function filteredKeydownEventHandler(event,sendFn,preventDefault){let{keyCode}=event;if(keys[keyCode]){if(preventDefault&&event.preventDefault&&(keyCode<110||keyCode>123))event.preventDefault();keydownEventHandler(event,sendFn)}}var eventHandlers={contextmenu:preventDefaultHandler,mousedown:mouseEventHandler,mousemove:mouseEventHandler,mouseup:mouseEventHandler,pointerdown:mouseEventHandler,pointermove:mouseEventHandler,pointerup:mouseEventHandler,pointerlockchange:mouseEventHandler,webkitpointerlockchange:mouseEventHandler,focus:focusEventHandler,blur:focusEventHandler,pointerout:mouseEventHandler,touchstart:touchEventHandler,touchmove:touchEventHandler,touchend:touchEventHandler,wheel:wheelEventHandler,keydown:filteredKeydownEventHandler,keyup:filteredKeydownEventHandler};function initProxyElement(element,worker,id,preventDefault){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{if(!worker){handleProxyEvent(data,id)}else worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent,preventDefault)})}if(eventHandlers.keydown){globalThis.addEventListener("keydown",function(ev){eventHandlers.keydown(ev,sendEvent,preventDefault)})}if(eventHandlers.keyup){globalThis.addEventListener("keyup",function(ev){eventHandlers.keyup(ev,sendEvent,preventDefault)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher=class{addEventListener(type,listener){if(this.__listeners===void 0)this.__listeners={};const listeners=this.__listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this.__listeners===void 0)return false;const listeners=this.__listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this.__listeners===void 0)return;const listeners=this.__listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i2=0,l=array.length;i2<l;i2++){array[i2].call(this,event)}}}};function noop(){}var ElementProxyReceiver=class extends EventDispatcher{constructor(){super();this.__listeners={};this.style={};this.setPointerCapture=()=>{};this.releasePointerCapture=()=>{};this.getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};this.handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.style.width=this.width+"px";this.proxied.style.height=this.height+"px";this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop;data.stopPropagation=noop;this.dispatchEvent(data,this.proxied)};this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}focus(){}blur(){}};var ProxyManager=class{constructor(){this.targets={};this.makeProxy=(id,addTo=void 0)=>{if(!id)id=`proxyReceiver${Math.floor(Math.random()*1e15)}`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;if(typeof WorkerGlobalScope!=="undefined")addTo.style=proxy.style;if(proxy.width){addTo.style.width=proxy.width+"px";addTo.clientWidth=proxy.width}if(proxy.height){addTo.style.height=proxy.height+"px";addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy);addTo.blur=proxy.blur.bind(proxy)}};this.getProxy=id=>{return this.targets[id]};this.handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0};if(!globalThis.document)globalThis.document={elementFromPoint:(...args)=>{return this.targets[Object.keys(this.targets)[0]].proxied}}}};function makeProxy(id,elm){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;this.__node.graph.ProxyManager.makeProxy(id,elm)}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;globalThis.ProxyManager.makeProxy(id,elm)}return id}function handleProxyEvent(data,id){if(this?.__node?.graph){if(!this.__node.graph.ProxyManager)this.__node.graph.ProxyManager=new ProxyManager;if(this.__node.graph.ProxyManager.handleEvent(data,id))return data}else{if(!globalThis.ProxyManager)globalThis.ProxyManager=new ProxyManager;if(globalThis.ProxyManager.handleEvent(data,id))return data}}var proxyElementWorkerRoutes={initProxyElement,makeProxy,handleProxyEvent};function Renderer(options){if(options.worker){let worker=options.worker;let route=options.route;if(worker instanceof Blob||typeof worker==="string"){worker=new Worker(worker)}delete options.worker;delete options.route;return transferCanvas(worker,options,route)}else{initProxyElement(options.canvas,void 0,options._id,options.preventDefault);return setupCanvas(options)}}function transferCanvas(worker,options,route){if(!options)return void 0;if(!options._id)options._id=`canvas${Math.floor(Math.random()*1e15)}`;let offscreen=options.canvas.transferControlToOffscreen();if(!options.width)options.width=options.canvas.clientWidth;if(!options.height)options.height=options.canvas.clientHeight;let message={route:route?route:"setupCanvas",args:{...options,canvas:offscreen}};if(this?.__node?.graph)this.__node.graph.run("initProxyElement",options.canvas,worker,options._id,options.preventDefault);else initProxyElement(options.canvas,worker,options._id,options.preventDefault);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let tr=[offscreen];if(options.transfer){tr.push(...options.transfer);delete options.transfer}worker.postMessage(message,tr);const canvascontrols={_id:options._id,width:options.width,height:options.height,worker,draw:(props,transfer)=>{worker.postMessage({route:"drawFrame",args:[props,options._id]},transfer)},update:(props,transfer)=>{worker.postMessage({route:"updateCanvas",args:[props,options._id]},transfer)},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:(newDrawProps,transfer)=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]},transfer)},terminate:()=>{worker.terminate()}};return canvascontrols}function setDraw(settings,_id){let canvasopts;if(this?.__node?.graph){if(_id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.__node.graph.CANVASES?.[settings._id];else canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]}else{if(_id)canvasopts=globalThis.CANVASES?.[settings._id];else if(settings._id)canvasopts=globalThis.CANVASES?.[settings._id];else canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]]}if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasopts._id,canvasopts.canvas);else proxyElementWorkerRoutes.makeProxy(canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw.bind(settings)}if(typeof settings.update==="string")settings.update=parseFunctionFromText(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update.bind(settings)}if(typeof settings.init==="string")settings.init=parseFunctionFromText(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init.bind(settings)}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear.bind(settings)}return settings._id}return void 0}function setupCanvas(options){if(this?.__node?.graph){if(!this.__node.graph.CANVASES)this.__node.graph.CANVASES={}}else if(!globalThis.CANVASES)globalThis.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=`canvas${Math.floor(Math.random()*1e15)}`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this?.__node?.graph?.CANVASES[canvasOptions._id]){this.__node.graph.run("setDraw",canvasOptions)}else if(globalThis.CANVASES?.[canvasOptions._id]){setDraw(canvasOptions)}else{if(this?.__node?.graph){canvasOptions.graph=this.__node.graph;if(!canvasOptions.__node){canvasOptions.__node={}}if(!canvasOptions.__node.tag)canvasOptions.__node.tag=canvasOptions._id;canvasOptions=this.__node.graph.add(canvasOptions);canvasOptions.__addOndisconnected=()=>{canvasOptions.stop();delete this.__node.graph.CANVASES[canvasOptions._id]}}if(this?.__node?.graph)this.__node.graph.CANVASES[canvasOptions._id]=canvasOptions;else globalThis.CANVASES[canvasOptions._id]=canvasOptions;if(this?.__node?.graph)this.__node.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);else proxyElementWorkerRoutes.makeProxy(canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText(canvasOptions.draw)}else if(typeof canvasOptions.draw==="function"){canvasOptions.draw=canvasOptions.draw.bind(canvasOptions)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText(canvasOptions.update)}else if(typeof canvasOptions.update==="function"){canvasOptions.update=canvasOptions.update.bind(canvasOptions)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText(canvasOptions.init)}else if(typeof canvasOptions.init==="function"){canvasOptions.init=canvasOptions.init.bind(canvasOptions)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText(canvasOptions.clear)}else if(typeof canvasOptions.clear==="function"){canvasOptions.clear=canvasOptions.clear.bind(canvasOptions)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);canvasOptions.stop=()=>{stopAnim(canvasOptions._id)};canvasOptions.start=draw=>{startAnim(canvasOptions._id,draw)};canvasOptions.set=settings=>{setDraw(settings,canvasOptions._id)};if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)return canvasOptions._id;else{const canvascontrols={_id:options._id,width:options.width,height:options.height,draw:props=>{drawFrame(props,options._id)},update:props=>{updateCanvas(props,options._id)},clear:()=>{clearCanvas(options._id)},init:()=>{initCanvas(options._id)},stop:()=>{stopAnim(options._id)},start:()=>{startAnim(options._id)},set:newDrawProps=>{setDraw(newDrawProps,options._id)},terminate:()=>{if(this.__node?.graph)this.__node.graph.remove(options._id);else{stopAnim(options._id);if(this?.__node?.graph)delete this.__node.graph.CANVASES[canvasOptions._id];else delete globalThis.CANVASES[canvasOptions._id]}}};return canvascontrols}}function drawFrame(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0}function clearCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function initCanvas(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function updateCanvas(input,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0}function setProps(props,_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0}function startAnim(_id,draw){let canvasopts=getCanvas.call(this,_id);canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}function stopAnim(_id){let canvasopts=getCanvas.call(this,_id);if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")requestAnimationFrame(canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context));return _id}return void 0}function getCanvas(_id){let canvasopts;if(this?.__node?.graph){if(!_id)canvasopts=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]];else canvasopts=this.__node.graph.CANVASES?.[_id]}else{if(!_id)canvasopts=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]];else canvasopts=globalThis.CANVASES?.[_id]}return canvasopts}var workerCanvasRoutes={...proxyElementWorkerRoutes,Renderer,transferCanvas,setupCanvas,setDraw,drawFrame,clearCanvas,initCanvas,updateCanvas,setProps,startAnim,stopAnim,getCanvas};function parseFunctionFromText(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var v=class{constructor(e,t,n,o){this.r=e,this.g=t,this.b=n,this.a=o}};var x=class{constructor(){this.scaleX=1,this.scaleY=1,this.offsetX=0,this.offsetY=0,this.loop=false,this._vbuffer=0,this._coord=0,this.visible=true,this.intensity=1,this.xy=new Float32Array([]),this.numPoints=0,this.color=new v(0,0,0,1),this.webglNumPoints=0}};var d=class extends x{constructor(e,t){super(),this.currentIndex=0,this.webglNumPoints=t,this.numPoints=t,this.color=e,this.xy=new Float32Array(2*this.webglNumPoints)}setX(e,t){this.xy[e*2]=t}setY(e,t){this.xy[e*2+1]=t}getX(e){return this.xy[e*2]}getY(e){return this.xy[e*2+1]}lineSpaceX(e,t){for(let n=0;n<this.numPoints;n++)this.setX(n,e+t*n)}arrangeX(){this.lineSpaceX(-1,2/this.numPoints)}constY(e){for(let t=0;t<this.numPoints;t++)this.setY(t,e)}shiftAdd(e){let t=e.length;for(let n=0;n<this.numPoints-t;n++)this.setY(n,this.getY(n+t));for(let n=0;n<t;n++)this.setY(n+this.numPoints-t,e[n])}addArrayY(e){if(this.currentIndex+e.length<=this.numPoints)for(let t=0;t<e.length;t++)this.setY(this.currentIndex,e[t]),this.currentIndex++}replaceArrayY(e){if(e.length==this.numPoints)for(let t=0;t<this.numPoints;t++)this.setY(t,e[t])}};var M=(f,e,t)=>{let n={x:0,y:0};return n.x=f.x+e.x*t,n.y=f.y+e.y*t,n};var _=f=>P(-f.y,f.x);var w=(f,e)=>{let t=R(f,e);return t=S(t),t};var T=(f,e)=>{let t={x:0,y:0};return t.x=f.x+e.x,t.y=f.y+e.y,t};var C=(f,e)=>f.x*e.x+f.y*e.y;var S=f=>{let e={x:0,y:0},t=f.x*f.x+f.y*f.y;return t>0&&(t=1/Math.sqrt(t),e.x=f.x*t,e.y=f.y*t),e};var P=(f,e)=>{let t={x:0,y:0};return t.x=f,t.y=e,t};var R=(f,e)=>{let t={x:0,y:0};return t.x=f.x-e.x,t.y=f.y-e.y,t};var F=f=>{let e,t={x:0,y:0},n={x:0,y:0},o=[],a=(s,r)=>{o.push({vec2:s,miterLength:r})},h=s=>({x:f[s*2],y:f[s*2+1]});t=w(h(1),h(0)),e=_(t),a(e,1);let l=f.length/2;for(let s=1;s<l-1;s++){let r=h(s-1),i2=h(s),u=h(s+1);t=w(i2,r),e=_(t),n=w(u,i2);let c=N(t,n),g=X(t,c,1);a(c,g)}return t=w(h(l-1),h(l-2)),e=_(t),a(e,1),o};var N=(f,e)=>{let t=T(f,e);return t=S(t),P(-t.y,t.x)};var X=(f,e,t)=>{let n=P(-f.y,f.x);return t/C(e,n)};var p=class extends x{constructor(e,t,n){super(),this.currentIndex=0,this._thicknessRequested=0,this._actualThickness=0,this.webglNumPoints=t*2,this.numPoints=t,this.color=e,this._thicknessRequested=n,this._linePoints=new Float32Array(t*2),this.xy=new Float32Array(2*this.webglNumPoints)}convertToTriPoints(){let e=this._actualThickness/2,t=F(this._linePoints);for(let n=0;n<this.numPoints;n++){let o=this._linePoints[2*n],a=this._linePoints[2*n+1],h={x:o,y:a},l=M(h,t[n].vec2,t[n].miterLength*e),s=M(h,t[n].vec2,-t[n].miterLength*e);this.xy[n*4]=l.x,this.xy[n*4+1]=l.y,this.xy[n*4+2]=s.x,this.xy[n*4+3]=s.y}}setX(e,t){this._linePoints[e*2]=t}setY(e,t){this._linePoints[e*2+1]=t}lineSpaceX(e,t){for(let n=0;n<this.numPoints;n++)this.setX(n,e+t*n)}setThickness(e){this._thicknessRequested=e}getThickness(){return this._thicknessRequested}setActualThickness(e){this._actualThickness=e}};var A=class{constructor(e,t){this.debug=false,this.addLine=this.addDataLine,t==null?this.webgl=e.getContext("webgl",{antialias:true,transparent:false}):(this.webgl=e.getContext("webgl",{antialias:t.antialias,transparent:t.transparent,desynchronized:t.deSync,powerPerformance:t.powerPerformance,preserveDrawing:t.preserveDrawing}),this.debug=t.debug==null?false:t.debug),this.log("canvas type is: "+e.constructor.name),this.log(`[webgl-plot]:width=${e.width}, height=${e.height}`),this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[],this.gScaleX=1,this.gScaleY=1,this.gXYratio=1,this.gOffsetX=0,this.gOffsetY=0,this.gLog10X=false,this.gLog10Y=false,this.webgl.clear(this.webgl.COLOR_BUFFER_BIT),this.webgl.viewport(0,0,e.width,e.height),this._progLine=this.webgl.createProgram(),this.initThinLineProgram(),this.webgl.enable(this.webgl.BLEND),this.webgl.blendFunc(this.webgl.SRC_ALPHA,this.webgl.ONE_MINUS_SRC_ALPHA)}get linesData(){return this._linesData}get linesAux(){return this._linesAux}get thickLines(){return this._thickLines}get surfaces(){return this._surfaces}_drawLines(e){let t=this.webgl;e.forEach(n=>{if(n.visible){t.useProgram(this._progLine);let o=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(o,false,new Float32Array([n.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,n.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let a=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(a,new Float32Array([n.offsetX+this.gOffsetX,n.offsetY+this.gOffsetY]));let h=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(h,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let l=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(l,[n.color.r,n.color.g,n.color.b,n.color.a]),t.bufferData(t.ARRAY_BUFFER,n.xy,t.STREAM_DRAW),t.drawArrays(n.loop?t.LINE_LOOP:t.LINE_STRIP,0,n.webglNumPoints)}})}_drawSurfaces(e){let t=this.webgl;e.forEach(n=>{if(n.visible){t.useProgram(this._progLine);let o=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(o,false,new Float32Array([n.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,n.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let a=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(a,new Float32Array([n.offsetX+this.gOffsetX,n.offsetY+this.gOffsetY]));let h=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(h,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let l=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(l,[n.color.r,n.color.g,n.color.b,n.color.a]),t.bufferData(t.ARRAY_BUFFER,n.xy,t.STREAM_DRAW),t.drawArrays(t.TRIANGLE_STRIP,0,n.webglNumPoints)}})}_drawTriangles(e){let t=this.webgl;t.bufferData(t.ARRAY_BUFFER,e.xy,t.STREAM_DRAW),t.useProgram(this._progLine);let n=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(n,false,new Float32Array([e.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,e.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let o=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(o,new Float32Array([e.offsetX+this.gOffsetX,e.offsetY+this.gOffsetY]));let a=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(a,new Int32Array([0,0]));let h=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(h,[e.color.r,e.color.g,e.color.b,e.color.a]),t.drawArrays(t.TRIANGLE_STRIP,0,e.xy.length/2)}_drawThickLines(){this._thickLines.forEach(e=>{if(e.visible){let t=Math.min(this.gScaleX,this.gScaleY);e.setActualThickness(e.getThickness()/t),e.convertToTriPoints(),this._drawTriangles(e)}})}update(){this.clear(),this.draw()}draw(){this._drawLines(this.linesData),this._drawLines(this.linesAux),this._drawThickLines(),this._drawSurfaces(this.surfaces)}clear(){this.webgl.clear(this.webgl.COLOR_BUFFER_BIT)}_addLine(e){e._vbuffer=this.webgl.createBuffer(),this.webgl.bindBuffer(this.webgl.ARRAY_BUFFER,e._vbuffer),this.webgl.bufferData(this.webgl.ARRAY_BUFFER,e.xy,this.webgl.STREAM_DRAW),e._coord=this.webgl.getAttribLocation(this._progLine,"coordinates"),this.webgl.vertexAttribPointer(e._coord,2,this.webgl.FLOAT,false,0,0),this.webgl.enableVertexAttribArray(e._coord)}addDataLine(e){this._addLine(e),this.linesData.push(e)}addAuxLine(e){this._addLine(e),this.linesAux.push(e)}addThickLine(e){this._addLine(e),this._thickLines.push(e)}addSurface(e){this._addLine(e),this.surfaces.push(e)}initThinLineProgram(){let e=`\n      attribute vec2 coordinates;\n      uniform mat2 uscale;\n      uniform vec2 uoffset;\n      uniform ivec2 is_log;\n\n      void main(void) {\n         float x = (is_log[0]==1) ? log(coordinates.x) : coordinates.x;\n         float y = (is_log[1]==1) ? log(coordinates.y) : coordinates.y;\n         vec2 line = vec2(x, y);\n         gl_Position = vec4(uscale*line + uoffset, 0.0, 1.0);\n      }`,t=this.webgl.createShader(this.webgl.VERTEX_SHADER);this.webgl.shaderSource(t,e),this.webgl.compileShader(t);let n=`\n         precision mediump float;\n         uniform highp vec4 uColor;\n         void main(void) {\n            gl_FragColor =  uColor;\n         }`,o=this.webgl.createShader(this.webgl.FRAGMENT_SHADER);this.webgl.shaderSource(o,n),this.webgl.compileShader(o),this._progLine=this.webgl.createProgram(),this.webgl.attachShader(this._progLine,t),this.webgl.attachShader(this._progLine,o),this.webgl.linkProgram(this._progLine)}popDataLine(){this.linesData.pop()}removeAllLines(){this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[]}removeDataLines(){this._linesData=[]}removeAuxLines(){this._linesAux=[]}viewport(e,t,n,o){this.webgl.viewport(e,t,n,o)}log(e){this.debug&&console.log("[webgl-plot]:"+e)}};var y=class{constructor(){this.plots={};this.renderOverlay=(e,t,n,o,a,h=1,l=0)=>{if(typeof n.settings.overlay=="object"&&(o.useOverlay||!("useOverlay"in o))){let s=n.settings.nLines-o.position-1,r=e.height*s/n.settings.nLines,i2=e.height*(s+1)/n.settings.nLines;if(t.clearRect(0,r,e.width,i2),n.settings.mode==="sweep"){t.strokeStyle=n.settings.sweepColor?n.settings.sweepColor:"rgba(0,255,0,0.8)",t.beginPath();let u=e.width*o.ct/o.values.length;t.moveTo(u,r),t.lineTo(u,i2),t.stroke()}if(t.fillStyle=n.settings.overlayColor?n.settings.overlayColor:"white",a&&t.fillText(a,20,e.height*(s+.2)/n.settings.nLines),o.nSec){let u=this.formatTime(o.nSec);t.fillText(`${u}`,n.settings.mode==="sweep"?e.width-35:20,e.height*(s+.9)/n.settings.nLines),t.fillText("0:00",n.settings.mode==="sweep"?20:e.width-35,e.height*(s+.9)/n.settings.nLines)}typeof h=="number"&&t.fillText(`${Math.floor(h)===h?h:h?.toFixed(5)} ${o.units?o.units:""}`,e.width-100,e.height*(s+.2)/n.settings.nLines),typeof l=="number"&&t.fillText(`${Math.floor(l)===l?l:l?.toFixed(5)} ${o.units?o.units:""}`,e.width-100,e.height*(s+.8)/n.settings.nLines)}}}initPlot(e,t){if(t||(t=new A(e.canvas,e.webglOptions)),!e._id)e._id=`plot${Math.floor(Math.random()*1e15)}`;else if(this.plots[e._id]){let r=this.plots[e._id].initial;if(e.lines){for(let i2 in e.lines)if(r.lines[i2]&&Array.isArray(e.lines[i2])){let u=e.lines[i2];e.lines[i2]=r.lines[i2]}}e=Object.assign(r,e)}e.overlay&&(typeof e.overlay!="object"&&(e.overlay=document.createElement("canvas"),e.overlay.style.position="absolute",e.overlay.width=e.canvas.width,e.overlay.height=e.canvas.height,e.canvas.appendChild(e.overlay)),e.overlayCtx||(e.overlayCtx=e.overlay.getContext("2d"))),e.width&&(e.canvas.width=e.width,e.canvas.style&&(e.canvas.style.width=e.width+"px"),typeof e.overlay=="object"&&(e.overlay.width=e.width,e.overlay.style&&(e.overlay.style.width=e.width+"px"))),e.height&&(e.canvas.height=e.height,e.canvas.style&&(e.canvas.style.height=e.height+"px"),typeof e.overlay=="object"&&(e.overlay.height=e.height,e.overlay.style&&(e.overlay.style.height=e.height+"px"))),e.lines?.timestamp&&delete e.lines.timestamp,e.lines||(e.lines={});let n={};for(let r in e.lines)n[r]=Object.assign({},n[r]),"viewing"in e.lines[r]||(e.lines[r].viewing=true),n[r].viewing=e.lines[r].viewing,n[r].sps=e.lines[r].sps,n[r].nSec=e.lines[r].nSec,n[r].nPoints=e.lines[r].nPoints,n[r].ymin=e.lines[r].ymin,n[r].ymax=e.lines[r].ymax,n[r].units=e.lines[r].units;let o={plot:t,settings:e,initial:Object.assign(Object.assign({},e),{lines:n}),anim:()=>{t.update()}};this.plots[e._id]=o;let a=0,h=0;Object.keys(e.lines).forEach(r=>{e.lines[r]?.viewing!==false&&h++}),e.nLines=h;let l,s;typeof e.overlay=="object"&&(l=e.overlay,s=e.overlayCtx,s.clearRect(0,0,e.overlay.width,e.overlay.height),s.font=e.overlayFont?e.overlayFont:"1em Courier",s.fillStyle=e.overlayColor?e.overlayColor:"white");for(let r in e.lines){let i2=e.lines[r];if(Array.isArray(i2)&&(i2={values:i2},e.lines[r]=i2),"viewing"in i2||(i2.viewing=true),i2.color)Array.isArray(i2.color)&&(i2.color=new v(...i2.color));else{let m=y.HSLToRGB(360*(a/h)%360,100,50,1);o.initial.lines[r].color=[...m,1],i2.color=new v(...m,1)}let u;if(i2.nSec&&i2.sps?u=Math.ceil(i2.nSec*i2.sps):i2.nPoints?u=i2.nPoints:i2.points?u=i2.points:e.linePoints?u=e.linePoints:i2.values?u=i2.values.length:u=1e3,i2.points=u,e.lines[r].viewing===false)continue;if((i2.width||e.lineWidth)&&i2.width!==0){let m=e.lineWidth;m||(m=i2.width),i2.width?i2.line=new p(i2.color,u,i2.width):e.lineWidth&&(i2.line=new p(i2.color,u,e.lineWidth)),i2.line.lineSpaceX(-1,2/i2.line.numPoints)}else i2.line=new d(i2.color,u),i2.line.arrangeX();i2.values?.length===i2.points?i2.values.length!==u&&(i2.interpolate?i2.values.length>u?i2.values=y.downsample(i2.values,u):i2.values.length<u&&(i2.values=y.upsample(i2.values,u)):i2.values.length>i2.points?i2.values=i2.values.slice(i2.values.length-i2.points):i2.values=[...new Array(i2.points-i2.values.length).fill(0),...i2.values]):Array.isArray(i2.values)?i2.values.length>u?i2.values=i2.values.slice(i2.values.length-u):i2.values.length<u&&(i2.values=[...new Array(u-i2.values.length).fill(0),...i2.values]):i2.values=new Array(i2.points).fill(0);let c=i2.ymin,g=i2.ymax,b=i2.values.length<=1e5;if(c===g?(g=b?Math.max(...i2.values):1,c=b?Math.min(...i2.values):0):isNaN(g)&&(g=b?Math.max(...i2.values):1),isNaN(c)&&(c=b?Math.min(...i2.values):0),c>g){let m=c;g=c,c=m}let Y=Math.abs(c);if(i2.absmax=Y>g?Y:g,"autoscale"in i2||(i2.autoscale=true),i2.position||(i2.position=e.nLines-a-1),i2.autoscale?i2.autoscale===2?("clamp"in i2||(i2.clamp=true),i2.scaled=y.autoscale(i2.values,i2.position,h,i2.centerZero,c,g,i2.clamp)):(i2.scaled=i2.values,i2.line.scaleY=y.getYScalar(i2.values,h,i2.centerZero,c,g),i2.line.offsetY=y.getYOffset(i2.position,h,c,i2.line.scaleY)):i2.scaled=i2.values,i2.scaled.forEach((m,L)=>i2.line.setY(L,m)),i2.line instanceof p?t.addThickLine(i2.line):i2.line instanceof d&&t.addDataLine(i2.line),"xAxis"in i2||(i2.xAxis=true),i2.xAxis){i2.xColor?Array.isArray(i2.xColor)&&(i2.xColor=new v(...i2.xColor)):i2.xColor=new v(1,1,1,.3);let m=new d(i2.xColor,2),L=i2.autoscale?(a+1)*2/h-1-1/h:0;m.constY(L),m.arrangeX(),m.xy[2]=1,i2.x=m,t.addAuxLine(m)}if(h>1&&i2.autoscale&&a!==h-1){e.dividerColor?Array.isArray(e.dividerColor)&&(e.dividerColor=new v(...e.dividerColor)):e.dividerColor=new v(1,1,1,1);let m=new d(e.dividerColor,2);m.constY(i2.autoscale?(a+1)*2/h-1:1),m.arrangeX(),m.xy[2]=1,i2.divider=m,t.addAuxLine(m)}if(typeof e.overlay=="object"&&(i2.useOverlay||!("useOverlay"in i2))){let m=e.nLines-i2.position-1;s.fillText(r,20,l.height*(m+.2)/e.nLines),s.fillText(`${Math.floor(g)===g?g:g?.toFixed(5)} ${i2.units?i2.units:""}`,l.width-100,l.height*(m+.2)/e.nLines),s.fillText(`${Math.floor(c)===c?c:c?.toFixed(5)} ${i2.units?i2.units:""}`,l.width-100,l.height*(m+.9)/e.nLines)}a++}return requestAnimationFrame(o.anim),this.plots[e._id]}deinitPlot(e){return typeof e=="string"&&(e=this.plots[e]),e.plot.clear(),e.plot.removeAllLines(),true}reinitPlot(e,t){if(typeof e=="string"){let n=e;e=this.plots[e],t._id||(t._id=n)}if(e.plot)return e.plot.clear(),e.plot.removeAllLines(),e.settings.overlayCtx&&e.settings.overlayCtx.clearRect(0,0,e.settings.overlay?.width,e.settings.overlay?.height),this.initPlot(t,e.plot)}getChartSettings(e,t){let n=this.plots[e];if(n){let o=Object.assign({},n.initial);for(let a in n.initial.lines)typeof n.initial.lines[a]?.ymax!="number"&&(o.lines[a].ymax=n.settings.lines[a]?.ymax),typeof n.initial.lines[a]?.ymin!="number"&&(o.lines[a].ymin=n.settings.lines[a]?.ymin),t&&(o.lines[a].values=n.settings.lines[a].values);return delete o.canvas,delete o.overlay,delete o.overlayCtx,o}}update(e,t,n=true){if(typeof e=="string"&&(e=this.plots[e]),!e)return false;let o,a;if(typeof e.settings.overlay=="object"&&(o=e.settings.overlay,a=e.settings.overlayCtx,a.font=e.settings.overlayFont?e.settings.overlayFont:"1em Courier",a.fillStyle=e.settings.overlayColor?e.settings.overlayColor:"white"),t){let h=false;for(let l in t)if(e.settings.lines[l]&&e.settings.lines[l].line){if(e.settings.lines[l]?.viewing===false)continue;let s=e.settings.lines[l];if(s.values){if(e.settings.mode&&e.settings.mode==="sweep"){"ct"in s||(s.ct=0);let g=b=>{s.ct>s.values.length&&(s.ct=0),s.values[s.ct]=b,s.ct++};Array.isArray(t[l])?(s.ct===0&&(s.values=new Array(s.values.length).fill(t[l][t[l].length-1])),t[l].forEach(g)):typeof t[l]=="number"?(s.ct===0&&(s.values=new Array(s.values.length).fill(t[l])),g(t[l])):t[l].values&&(s.ct===0&&(s.values=new Array(s.values.length).fill(t[l].values[t[l].values.length-1])),t[l].values.forEach(g))}else Array.isArray(t[l])&&s.values?.length<1e5?(s.values.length===0?(s.values.length=s.points?s.points:1e3,s.values.fill(t[l][t[l].length-1]),s.firstWrite=true):s.firstWrite||(s.values.fill(t[l][t[l].length-1]),s.firstWrite=true),t[l].length===s.values.length?s.values=t[l]:y.circularBuffer(s.values,t[l])):typeof t[l]=="number"?(s.firstWrite||(s.values.fill(t[l]),s.firstWrite=true),s.values.push(t[l]),s.values.shift()):t[l]?.values&&(s.values.length===0?(s.values.length=s.points?s.points:1e3,s.values.fill(t[l].values[t[l].values.length-1]),s.firstWrite=true):s.firstWrite||(s.values.fill(t[l].values[t[l].values.length-1]),s.firstWrite=true),t[l].values.length===s.values.length?s.values=t[l].values:y.circularBuffer(s.values,t[l].values));s.values.length!==s.points&&(s.interpolate?s.values.length>s.points?s.values=y.downsample(s.values,s.points):s.scaled.length<s.points&&(s.values=y.upsample(s.values,s.points)):s.values.length>s.points?s.values.splice(0,s.values.length-s.points):s.values=new Array(s.points).fill(0).splice(s.points-s.values.length,0,s.values));let r=s.ymin,i2=s.ymax,u=s.values.length<=1e5;if(r===i2?(i2=u?Math.max(...s.values):1,r=u?Math.min(...s.values):0):isNaN(i2)&&(i2=u?Math.max(...s.values):1),isNaN(r)&&(r=u?Math.min(...s.values):0),r>i2){let g=r;i2=r,r=g}let c=Math.abs(r);s.absmax=c>i2?c:i2,s.autoscale?s.autoscale===2?s.scaled=y.autoscale(s.values,s.position,e.settings.nLines,s.centerZero,r,i2,s.clamp):(s.scaled=s.values,s.line.scaleY=y.getYScalar(s.values,e.settings.nLines,s.centerZero,r,i2),s.line.offsetY=y.getYOffset(s.position,e.settings.nLines,r,s.line.scaleY)):s.scaled=s.values,s.scaled.forEach((g,b)=>{!s.autoscale&&s.absmax>1?s.line.setY(b,g/s.absmax):s.line.setY(b,g)}),this.renderOverlay(o,a,e,s,l,i2,r)}}else e.settings.generateNewLines&&!l.includes("timestamp")&&(Array.isArray(t[l])&&(t[l]={values:t[l]}),!t[l].nSec&&!t[l].nPoints&&!e.settings.linePoints&&(t[l].nPoints=1e3),h=true);if(h)return e.settings.cleanGeneration||Object.keys(e.initial.lines).forEach(l=>{t[l]?t[l]=Object.assign(e.initial.lines[l],t[l]):t[l]=e.initial.lines[l]}),this.reinitPlot(e,{_id:e.settings._id,lines:t}),true}else for(let h in e.settings.lines){let l=e.settings.lines[h];this.renderOverlay(o,a,e,l,h,l.ymax,l.ymin)}return n&&requestAnimationFrame(e.anim),true}updateLine(e,t,n,o,a,h,l){return e.numPoints!==t.length&&(n?e.numPoints>t.length?t=y.downsample(t,e.numPoints):e.numPoints<t.length&&(t=y.upsample(t,e.numPoints)):t.length>e.numPoints?t=t.slice(t.length-e.numPoints):t=[...new Array(t.length).fill(0),...t]),o&&(t=y.autoscale(t,a,h,l)),t.forEach((s,r)=>e.setY(r,s)),true}formatTime(e){let t=Math.floor(e/60),n=Math.floor(t/60);t=t%60,e=e%60;let o="";return n>0&&(o+=n+":",t<10&&(o+="0")),o+=t+":",e>0&&(e<10&&(o+="0"),o+=e),o}static autoscale(e,t=0,n=1,o=false,a,h,l){if(e?.length===0)return e;let s=typeof h=="number"?h:e.length<=1e5?Math.max(...e):1,r=typeof a=="number"?a:e.length<=1e5?Math.min(...e):0,i2=1/n,u=1;if(o){let c=Math.max(Math.abs(r),Math.abs(s));return c!==0&&(u=i2/c),e.map(g=>(l&&(g<r&&(g=r),g>s&&(g=s)),g*u+(i2*(t+1)*2-1-i2)))}else return s===r?s!==0?u=i2/s:r!==0&&(u=i2/Math.abs(r)):u=i2/(s-r),e.map(c=>(l&&(c<r&&(c=r),c>s&&(c=s)),2*((c-r)*u-1/(2*n))+(i2*(t+1)*2-1-i2)))}static getYScalar(e,t=1,n=false,o,a){if(e?.length===0)return e;let h=typeof a=="number"?a:e.length<=1e5?Math.max(...e):1,l=typeof o=="number"?o:e.length<=1e5?Math.min(...e):0,s=1/t,r=1;if(n){let i2=Math.max(Math.abs(l),Math.abs(h));return i2!==0&&(r=s/i2),2*r}else return h===l?h!==0?r=s/h:l!==0&&(r=s/Math.abs(l)):r=s/(h-l),2*r}static getYOffset(e=0,t=1,n=0,o=1){let a=1/t,h=a*(e+1)*2-1-a;return n!==0?h-=n*o+1/t:h-=o+1/t,h}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t,n=1){if(e.length>t){let o=new Array(t),a=e.length/t,h=e.length-1,l=0,s=0;for(let r=a;r<e.length;r+=a){let i2=Math.round(r);i2>h&&(i2=h);for(let u=l;u<i2;u++)o[s]+=e[u];o[s]/=(i2-l)*n,s++,l=i2}return o}else return e}static upsample(e,t,n=1){var o=function(c,g,b){return(c+(g-c)*b)*n},a=new Array(t),h=(e.length-1)/(t-1);a[0]=e[0];for(var l=1;l<t-1;l++){var s=l*h,r=Math.floor(s),i2=Math.ceil(s),u=s-r;a[l]=o(e[r],e[i2],u)}return a[t-1]=e[e.length-1],a}static interpolate(e,t,n=1){return e.length>t?y.downsample(e,t,n):e.length<t?y.upsample(e,t,n):e}static HSLToRGB(e,t,n,o=255){t/=100,n/=100;let a=(1-Math.abs(2*n-1))*t,h=a*(1-Math.abs(e/60%2-1)),l=n-a/2,s=0,r=0,i2=0;return 0<=e&&e<60?(s=a,r=h,i2=0):60<=e&&e<120?(s=h,r=a,i2=0):120<=e&&e<180?(s=0,r=a,i2=h):180<=e&&e<240?(s=0,r=h,i2=a):240<=e&&e<300?(s=h,r=0,i2=a):300<=e&&e<360&&(s=a,r=0,i2=h),s=(s+l)*o,r=(r+l)*o,i2=(i2+l)*o,[s,r,i2]}static circularBuffer(e,t){if(t.length<e.length){let n=e.slice(t.length),o=e.length;e.splice(0,o,...n,...t)}else if(t.length>e.length){let n=e.length;e.splice(0,n,...t.slice(t.length-n))}else e.splice(0,e.length,...t);return e}static formatDataForCharts(e,t){if(Array.isArray(e)){if(Array.isArray(e[0])){let n={};if(e.forEach((o,a)=>{n[a]=o}),e=n,isNaN(e[0][0]))return}else if(t){if(e={[t]:e},isNaN(e[t][0]))return}else if(e={0:e},isNaN(e[0][0]))return}else if(typeof e=="object"){for(let n in e)if(typeof e[n]=="number"?e[n]=[e[n]]:e[n]?.values&&typeof e[n].values=="number"&&(e[n].values=[e[n].values]),isNaN(e[n][0]))return}else if(typeof e=="string"){let n;if(e.includes(`\\r\n`)){let o=e.split(`\\r\n`);e={},o.forEach((a,h)=>{a.includes("	")?n=a.split("	"):a.includes(",")?n=a.split(","):a.includes("|")&&(n=a.split("|")),n&&n.forEach((l,s)=>{if(l.includes(":")){let[r,i2]=l.split(":"),u=parseFloat(i2);isNaN(u)||(e[r]=[u])}else{let r=parseFloat(l);isNaN(r)||(e[s]=[r])}})})}else e.includes("	")?n=e.split("	"):e.includes(",")?n=e.split(","):e.includes("|")&&(n=e.split("|"));e={},n&&n.forEach((o,a)=>{if(o.includes(":")){let[h,l]=o.split(":"),s=parseFloat(l);isNaN(s)||(e[h]=[s])}else{let h=parseFloat(o);isNaN(h)||(e[a]=[h])}})}else typeof e=="number"&&(t?e={[t]:[e]}:e={0:[e]});return e}static padTime(e,t,n,o){let a=(e[0]-t)/n/o;return[...new Array(o-e.length).map((l,s)=>t+a*(s+1)),...e]}static interpolateForTime(e,t,n){return y.interpolate(e,Math.ceil(n*t))}};if(typeof WorkerGlobalScope!=="undefined"){globalThis.plotter=new y;const routes={...workerCanvasRoutes};self.onmessage=ev=>{if(ev.data.route){if(Array.isArray(ev.data.args)){routes[ev.data.route](...ev.data.args)}else routes[ev.data.route](ev.data.args)}}}var canvas_worker_default=self;})();\n',wPe=URL.createObjectURL(new globalThis.Blob([_Pe],{type:"text/javascript"})),pv=wPe;var SPe=Object.create,_x=Object.defineProperty,xPe=Object.getOwnPropertyDescriptor,UQ=Object.getOwnPropertyNames,kPe=Object.getPrototypeOf,EPe=Object.prototype.hasOwnProperty,OPe=(e,t,r)=>t in e?_x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,APe=(e=>typeof ar<"u"?ar:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof ar<"u"?ar:t)[r]}):e)(function(e){if(typeof ar<"u")return ar.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),TPe=(e,t)=>function(){return t||(0,e[UQ(e)[0]])((t={exports:{}}).exports,t),t.exports},CPe=(e,t)=>{for(var r in t)_x(e,r,{get:t[r],enumerable:!0})},IPe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of UQ(t))!EPe.call(e,i)&&i!==r&&_x(e,i,{get:()=>t[i],enumerable:!(n=xPe(t,i))||n.enumerable});return e},NPe=(e,t,r)=>(r=e!=null?SPe(kPe(e)):{},IPe(t||!e||!e.__esModule?_x(r,"default",{value:e,enumerable:!0}):r,e)),zQ=(e,t,r)=>(OPe(e,typeof t!="symbol"?t+"":t,r),r),PPe=TPe({"struct/datastructures/bson.cjs"(e){"use strict";var t=5,r=2147483647,n=-2147483648,i=Math.pow(2,63)-1,s=-Math.pow(2,63),a=Math.pow(2,53),o=-Math.pow(2,53),l=1,c=2,f=3,u=4,d=5,p=6,_=7,w=8,k=9,S=10,O=11,A=12,C=13,I=14,D=15,L=16,U=17,te=18,V=19,X=255,Z=127,se=0,pe=4,de=Object.freeze({double:1,string:2,object:3,array:4,binData:5,undefined:6,objectId:7,bool:8,date:9,null:10,regex:11,dbPointer:12,javascript:13,symbol:14,javascriptWithScope:15,int:16,timestamp:17,long:18,decimal:19,minKey:-1,maxKey:127}),F=class extends Error{get bsonError(){return!0}get name(){return"BSONError"}constructor(m){super(m)}static isBSONError(m){return m!=null&&typeof m=="object"&&"bsonError"in m&&m.bsonError===!0&&"name"in m&&"message"in m&&"stack"in m}},H=class extends F{get name(){return"BSONVersionError"}constructor(){super(`Unsupported BSON version, bson types must be from bson ${t}.0 or later`)}},Q=class extends F{get name(){return"BSONRuntimeError"}constructor(m){super(m)}};function R(m){return q.fromNumberArray(Array.from({length:m},()=>Math.floor(Math.random()*256)))}var $=(()=>{try{return APe("crypto").randomBytes}catch{return R}})(),q={toLocalBufferType(m){if(Buffer.isBuffer(m))return m;if(ArrayBuffer.isView(m))return Buffer.from(m.buffer,m.byteOffset,m.byteLength);let N=m?.[Symbol.toStringTag]??Object.prototype.toString.call(m);if(N==="ArrayBuffer"||N==="SharedArrayBuffer"||N==="[object ArrayBuffer]"||N==="[object SharedArrayBuffer]")return Buffer.from(m);throw new F(`Cannot create Buffer from ${String(m)}`)},allocate(m){return Buffer.alloc(m)},equals(m,N){return q.toLocalBufferType(m).equals(N)},fromNumberArray(m){return Buffer.from(m)},fromBase64(m){return Buffer.from(m,"base64")},toBase64(m){return q.toLocalBufferType(m).toString("base64")},fromISO88591(m){return Buffer.from(m,"binary")},toISO88591(m){return q.toLocalBufferType(m).toString("binary")},fromHex(m){return Buffer.from(m,"hex")},toHex(m){return q.toLocalBufferType(m).toString("hex")},fromUTF8(m){return Buffer.from(m,"utf8")},toUTF8(m){return q.toLocalBufferType(m).toString("utf8")},utf8ByteLength(m){return Buffer.byteLength(m,"utf8")},encodeUTF8Into(m,N,K){return q.toLocalBufferType(m).write(N,K,void 0,"utf8")},randomBytes:$};function ie(){let{navigator:m}=globalThis;return typeof m=="object"&&m.product==="ReactNative"}function oe(m){if(m<0)throw new RangeError(`The argument 'byteLength' is invalid. Received ${m}`);return Ee.fromNumberArray(Array.from({length:m},()=>Math.floor(Math.random()*256)))}var fe=(()=>{let{crypto:m}=globalThis;if(m!=null&&typeof m.getRandomValues=="function")return N=>m.getRandomValues(Ee.allocate(N));if(ie()){let{console:N}=globalThis;N?.warn?.("BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.")}return oe})(),_e=/(\d|[a-f])/i,Ee={toLocalBufferType(m){let N=m?.[Symbol.toStringTag]??Object.prototype.toString.call(m);if(N==="Uint8Array")return m;if(ArrayBuffer.isView(m))return new Uint8Array(m.buffer.slice(m.byteOffset,m.byteOffset+m.byteLength));if(N==="ArrayBuffer"||N==="SharedArrayBuffer"||N==="[object ArrayBuffer]"||N==="[object SharedArrayBuffer]")return new Uint8Array(m);throw new F(`Cannot make a Uint8Array from ${String(m)}`)},allocate(m){if(typeof m!="number")throw new TypeError(`The "size" argument must be of type number. Received ${String(m)}`);return new Uint8Array(m)},equals(m,N){if(m.byteLength!==N.byteLength)return!1;for(let K=0;K<m.byteLength;K++)if(m[K]!==N[K])return!1;return!0},fromNumberArray(m){return Uint8Array.from(m)},fromBase64(m){return Uint8Array.from(atob(m),N=>N.charCodeAt(0))},toBase64(m){return btoa(Ee.toISO88591(m))},fromISO88591(m){return Uint8Array.from(m,N=>N.charCodeAt(0)&255)},toISO88591(m){return Array.from(Uint16Array.from(m),N=>String.fromCharCode(N)).join("")},fromHex(m){let N=m.length%2===0?m:m.slice(0,m.length-1),K=[];for(let M=0;M<N.length;M+=2){let ve=N[M],Ie=N[M+1];if(!_e.test(ve)||!_e.test(Ie))break;let Le=Number.parseInt(`${ve}${Ie}`,16);K.push(Le)}return Uint8Array.from(K)},toHex(m){return Array.from(m,N=>N.toString(16).padStart(2,"0")).join("")},fromUTF8(m){return new TextEncoder().encode(m)},toUTF8(m){return new TextDecoder("utf8",{fatal:!1}).decode(m)},utf8ByteLength(m){return Ee.fromUTF8(m).byteLength},encodeUTF8Into(m,N,K){let M=Ee.fromUTF8(N);return m.set(M,K),M.byteLength},randomBytes:fe},Se=typeof Buffer=="function"&&Buffer.prototype?._isBuffer!==!0,le=Se?q:Ee,we=class extends DataView{static fromUint8Array(m){return new DataView(m.buffer,m.byteOffset,m.byteLength)}},W=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,J=m=>typeof m=="string"&&W.test(m),ne=m=>{if(!J(m))throw new F('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');let N=m.replace(/-/g,"");return le.fromHex(N)};function Oe(m,N=!0){return N?[le.toHex(m.subarray(0,4)),le.toHex(m.subarray(4,6)),le.toHex(m.subarray(6,8)),le.toHex(m.subarray(8,10)),le.toHex(m.subarray(10,16))].join("-"):le.toHex(m)}function Ne(m){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(m))}function Ce(m){return Object.prototype.toString.call(m)==="[object Uint8Array]"}function Xe(m){return Object.prototype.toString.call(m)==="[object RegExp]"}function Ze(m){return Object.prototype.toString.call(m)==="[object Map]"}function kt(m){return Object.prototype.toString.call(m)==="[object Date]"}var St=class{get[Symbol.for("@@mdb.bson.version")](){return t}},pt=class extends St{get _bsontype(){return"Binary"}constructor(m,N){if(super(),m!=null&&typeof m!="string"&&!ArrayBuffer.isView(m)&&!(m instanceof ArrayBuffer)&&!Array.isArray(m))throw new F("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=N??pt.BSON_BINARY_SUBTYPE_DEFAULT,m==null?(this.buffer=le.allocate(pt.BUFFER_SIZE),this.position=0):(typeof m=="string"?this.buffer=le.fromISO88591(m):Array.isArray(m)?this.buffer=le.fromNumberArray(m):this.buffer=le.toLocalBufferType(m),this.position=this.buffer.byteLength)}put(m){if(typeof m=="string"&&m.length!==1)throw new F("only accepts single character String");if(typeof m!="number"&&m.length!==1)throw new F("only accepts single character Uint8Array or Array");let N;if(typeof m=="string"?N=m.charCodeAt(0):typeof m=="number"?N=m:N=m[0],N<0||N>255)throw new F("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.byteLength>this.position)this.buffer[this.position++]=N;else{let K=le.allocate(pt.BUFFER_SIZE+this.buffer.length);K.set(this.buffer,0),this.buffer=K,this.buffer[this.position++]=N}}write(m,N){if(N=typeof N=="number"?N:this.position,this.buffer.byteLength<N+m.length){let K=le.allocate(this.buffer.byteLength+m.length);K.set(this.buffer,0),this.buffer=K}if(ArrayBuffer.isView(m))this.buffer.set(le.toLocalBufferType(m),N),this.position=N+m.byteLength>this.position?N+m.length:this.position;else if(typeof m=="string"){let K=le.fromISO88591(m);this.buffer.set(K,N),this.position=N+m.length>this.position?N+m.length:this.position}}read(m,N){return N=N&&N>0?N:this.position,this.buffer.slice(m,m+N)}value(m){return m=!!m,m&&this.buffer.length===this.position?this.buffer:m?this.buffer.slice(0,this.position):le.toISO88591(this.buffer.subarray(0,this.position))}length(){return this.position}toJSON(){return le.toBase64(this.buffer)}toString(m){return m==="hex"?le.toHex(this.buffer):m==="base64"?le.toBase64(this.buffer):m==="utf8"||m==="utf-8"?le.toUTF8(this.buffer):le.toUTF8(this.buffer)}toExtendedJSON(m){m=m||{};let N=le.toBase64(this.buffer),K=Number(this.sub_type).toString(16);return m.legacy?{$binary:N,$type:K.length===1?"0"+K:K}:{$binary:{base64:N,subType:K.length===1?"0"+K:K}}}toUUID(){if(this.sub_type===pt.SUBTYPE_UUID)return new j(this.buffer.slice(0,this.position));throw new F(`Binary sub_type "${this.sub_type}" is not supported for converting to UUID. Only "${pt.SUBTYPE_UUID}" is currently supported.`)}static fromExtendedJSON(m,N){N=N||{};let K,M;if("$binary"in m?N.legacy&&typeof m.$binary=="string"&&"$type"in m?(M=m.$type?parseInt(m.$type,16):0,K=le.fromBase64(m.$binary)):typeof m.$binary!="string"&&(M=m.$binary.subType?parseInt(m.$binary.subType,16):0,K=le.fromBase64(m.$binary.base64)):"$uuid"in m&&(M=4,K=ne(m.$uuid)),!K)throw new F(`Unexpected Binary Extended JSON format ${JSON.stringify(m)}`);return M===pe?new j(K):new pt(K,M)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Binary(Buffer.from("${le.toHex(this.buffer)}", "hex"), ${this.sub_type})`}};pt.BSON_BINARY_SUBTYPE_DEFAULT=0,pt.BUFFER_SIZE=256,pt.SUBTYPE_DEFAULT=0,pt.SUBTYPE_FUNCTION=1,pt.SUBTYPE_BYTE_ARRAY=2,pt.SUBTYPE_UUID_OLD=3,pt.SUBTYPE_UUID=4,pt.SUBTYPE_MD5=5,pt.SUBTYPE_ENCRYPTED=6,pt.SUBTYPE_COLUMN=7,pt.SUBTYPE_USER_DEFINED=128;var ee=16,j=class extends pt{constructor(m){let N,K;if(m==null)N=j.generate();else if(m instanceof j)N=le.toLocalBufferType(new Uint8Array(m.buffer)),K=m.__id;else if(ArrayBuffer.isView(m)&&m.byteLength===ee)N=le.toLocalBufferType(m);else if(typeof m=="string")N=ne(m);else throw new F("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");super(N,pe),this.__id=K}get id(){return this.buffer}set id(m){this.buffer=m,j.cacheHexString&&(this.__id=Oe(m))}toHexString(m=!0){if(j.cacheHexString&&this.__id)return this.__id;let N=Oe(this.id,m);return j.cacheHexString&&(this.__id=N),N}toString(m){return m==="hex"?le.toHex(this.id):m==="base64"?le.toBase64(this.id):this.toHexString()}toJSON(){return this.toHexString()}equals(m){if(!m)return!1;if(m instanceof j)return le.equals(m.id,this.id);try{return le.equals(new j(m).id,this.id)}catch{return!1}}toBinary(){return new pt(this.id,pt.SUBTYPE_UUID)}static generate(){let m=le.randomBytes(ee);return m[6]=m[6]&15|64,m[8]=m[8]&63|128,m}static isValid(m){return m?m instanceof j?!0:typeof m=="string"?J(m):Ce(m)?m.byteLength!==ee?!1:(m[6]&240)===64&&(m[8]&128)===128:!1:!1}static createFromHexString(m){let N=ne(m);return new j(N)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new UUID("${this.toHexString()}")`}},B=class extends St{get _bsontype(){return"Code"}constructor(m,N){super(),this.code=m.toString(),this.scope=N??null}toJSON(){return this.scope!=null?{code:this.code,scope:this.scope}:{code:this.code}}toExtendedJSON(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}}static fromExtendedJSON(m){return new B(m.$code,m.$scope)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){let m=this.toJSON();return`new Code("${String(m.code)}"${m.scope!=null?`, ${JSON.stringify(m.scope)}`:""})`}};function re(m){return m!=null&&typeof m=="object"&&"$id"in m&&m.$id!=null&&"$ref"in m&&typeof m.$ref=="string"&&(!("$db"in m)||"$db"in m&&typeof m.$db=="string")}var ke=class extends St{get _bsontype(){return"DBRef"}constructor(m,N,K,M){super();let ve=m.split(".");ve.length===2&&(K=ve.shift(),m=ve.shift()),this.collection=m,this.oid=N,this.db=K,this.fields=M||{}}get namespace(){return this.collection}set namespace(m){this.collection=m}toJSON(){let m=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(m.$db=this.db),m}toExtendedJSON(m){m=m||{};let N={$ref:this.collection,$id:this.oid};return m.legacy||(this.db&&(N.$db=this.db),N=Object.assign(N,this.fields)),N}static fromExtendedJSON(m){let N=Object.assign({},m);return delete N.$ref,delete N.$id,delete N.$db,new ke(m.$ref,m.$id,m.$db,N)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){let m=this.oid===void 0||this.oid.toString===void 0?this.oid:this.oid.toString();return`new DBRef("${this.namespace}", new ObjectId("${String(m)}")${this.db?`, "${this.db}"`:""})`}},Te=void 0;try{Te=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}var Me=65536,It=1<<24,Dt=Me*Me,Qt=Dt*Dt,Ir=Qt/2,Jt={},ji={},yl=20,ho=/^(\+?0|(\+|-)?[1-9][0-9]*)$/,he=class extends St{get _bsontype(){return"Long"}get __isLong__(){return!0}constructor(m=0,N,K){super(),typeof m=="bigint"?Object.assign(this,he.fromBigInt(m,!!N)):typeof m=="string"?Object.assign(this,he.fromString(m,!!N)):(this.low=m|0,this.high=N|0,this.unsigned=!!K)}static fromBits(m,N,K){return new he(m,N,K)}static fromInt(m,N){let K,M,ve;return N?(m>>>=0,(ve=0<=m&&m<256)&&(M=ji[m],M)?M:(K=he.fromBits(m,(m|0)<0?-1:0,!0),ve&&(ji[m]=K),K)):(m|=0,(ve=-128<=m&&m<128)&&(M=Jt[m],M)?M:(K=he.fromBits(m,m<0?-1:0,!1),ve&&(Jt[m]=K),K))}static fromNumber(m,N){if(isNaN(m))return N?he.UZERO:he.ZERO;if(N){if(m<0)return he.UZERO;if(m>=Qt)return he.MAX_UNSIGNED_VALUE}else{if(m<=-Ir)return he.MIN_VALUE;if(m+1>=Ir)return he.MAX_VALUE}return m<0?he.fromNumber(-m,N).neg():he.fromBits(m%Dt|0,m/Dt|0,N)}static fromBigInt(m,N){return he.fromString(m.toString(),N)}static fromString(m,N,K){if(m.length===0)throw new F("empty string");if(m==="NaN"||m==="Infinity"||m==="+Infinity"||m==="-Infinity")return he.ZERO;if(typeof N=="number"?(K=N,N=!1):N=!!N,K=K||10,K<2||36<K)throw new F("radix");let M;if((M=m.indexOf("-"))>0)throw new F("interior hyphen");if(M===0)return he.fromString(m.substring(1),N,K).neg();let ve=he.fromNumber(Math.pow(K,8)),Ie=he.ZERO;for(let Le=0;Le<m.length;Le+=8){let rt=Math.min(8,m.length-Le),be=parseInt(m.substring(Le,Le+rt),K);if(rt<8){let Qe=he.fromNumber(Math.pow(K,rt));Ie=Ie.mul(Qe).add(he.fromNumber(be))}else Ie=Ie.mul(ve),Ie=Ie.add(he.fromNumber(be))}return Ie.unsigned=N,Ie}static fromBytes(m,N,K){return K?he.fromBytesLE(m,N):he.fromBytesBE(m,N)}static fromBytesLE(m,N){return new he(m[0]|m[1]<<8|m[2]<<16|m[3]<<24,m[4]|m[5]<<8|m[6]<<16|m[7]<<24,N)}static fromBytesBE(m,N){return new he(m[4]<<24|m[5]<<16|m[6]<<8|m[7],m[0]<<24|m[1]<<16|m[2]<<8|m[3],N)}static isLong(m){return m!=null&&typeof m=="object"&&"__isLong__"in m&&m.__isLong__===!0}static fromValue(m,N){return typeof m=="number"?he.fromNumber(m,N):typeof m=="string"?he.fromString(m,N):he.fromBits(m.low,m.high,typeof N=="boolean"?N:m.unsigned)}add(m){he.isLong(m)||(m=he.fromValue(m));let N=this.high>>>16,K=this.high&65535,M=this.low>>>16,ve=this.low&65535,Ie=m.high>>>16,Le=m.high&65535,rt=m.low>>>16,be=m.low&65535,Qe=0,Be=0,Fe=0,Ue=0;return Ue+=ve+be,Fe+=Ue>>>16,Ue&=65535,Fe+=M+rt,Be+=Fe>>>16,Fe&=65535,Be+=K+Le,Qe+=Be>>>16,Be&=65535,Qe+=N+Ie,Qe&=65535,he.fromBits(Fe<<16|Ue,Qe<<16|Be,this.unsigned)}and(m){return he.isLong(m)||(m=he.fromValue(m)),he.fromBits(this.low&m.low,this.high&m.high,this.unsigned)}compare(m){if(he.isLong(m)||(m=he.fromValue(m)),this.eq(m))return 0;let N=this.isNegative(),K=m.isNegative();return N&&!K?-1:!N&&K?1:this.unsigned?m.high>>>0>this.high>>>0||m.high===this.high&&m.low>>>0>this.low>>>0?-1:1:this.sub(m).isNegative()?-1:1}comp(m){return this.compare(m)}divide(m){if(he.isLong(m)||(m=he.fromValue(m)),m.isZero())throw new F("division by zero");if(Te){if(!this.unsigned&&this.high===-2147483648&&m.low===-1&&m.high===-1)return this;let ve=(this.unsigned?Te.div_u:Te.div_s)(this.low,this.high,m.low,m.high);return he.fromBits(ve,Te.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?he.UZERO:he.ZERO;let N,K,M;if(this.unsigned){if(m.unsigned||(m=m.toUnsigned()),m.gt(this))return he.UZERO;if(m.gt(this.shru(1)))return he.UONE;M=he.UZERO}else{if(this.eq(he.MIN_VALUE))return m.eq(he.ONE)||m.eq(he.NEG_ONE)?he.MIN_VALUE:m.eq(he.MIN_VALUE)?he.ONE:(N=this.shr(1).div(m).shl(1),N.eq(he.ZERO)?m.isNegative()?he.ONE:he.NEG_ONE:(K=this.sub(m.mul(N)),M=N.add(K.div(m)),M));if(m.eq(he.MIN_VALUE))return this.unsigned?he.UZERO:he.ZERO;if(this.isNegative())return m.isNegative()?this.neg().div(m.neg()):this.neg().div(m).neg();if(m.isNegative())return this.div(m.neg()).neg();M=he.ZERO}for(K=this;K.gte(m);){N=Math.max(1,Math.floor(K.toNumber()/m.toNumber()));let ve=Math.ceil(Math.log(N)/Math.LN2),Ie=ve<=48?1:Math.pow(2,ve-48),Le=he.fromNumber(N),rt=Le.mul(m);for(;rt.isNegative()||rt.gt(K);)N-=Ie,Le=he.fromNumber(N,this.unsigned),rt=Le.mul(m);Le.isZero()&&(Le=he.ONE),M=M.add(Le),K=K.sub(rt)}return M}div(m){return this.divide(m)}equals(m){return he.isLong(m)||(m=he.fromValue(m)),this.unsigned!==m.unsigned&&this.high>>>31===1&&m.high>>>31===1?!1:this.high===m.high&&this.low===m.low}eq(m){return this.equals(m)}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative())return this.eq(he.MIN_VALUE)?64:this.neg().getNumBitsAbs();let m=this.high!==0?this.high:this.low,N;for(N=31;N>0&&!(m&1<<N);N--);return this.high!==0?N+33:N+1}greaterThan(m){return this.comp(m)>0}gt(m){return this.greaterThan(m)}greaterThanOrEqual(m){return this.comp(m)>=0}gte(m){return this.greaterThanOrEqual(m)}ge(m){return this.greaterThanOrEqual(m)}isEven(){return(this.low&1)===0}isNegative(){return!this.unsigned&&this.high<0}isOdd(){return(this.low&1)===1}isPositive(){return this.unsigned||this.high>=0}isZero(){return this.high===0&&this.low===0}lessThan(m){return this.comp(m)<0}lt(m){return this.lessThan(m)}lessThanOrEqual(m){return this.comp(m)<=0}lte(m){return this.lessThanOrEqual(m)}modulo(m){if(he.isLong(m)||(m=he.fromValue(m)),Te){let N=(this.unsigned?Te.rem_u:Te.rem_s)(this.low,this.high,m.low,m.high);return he.fromBits(N,Te.get_high(),this.unsigned)}return this.sub(this.div(m).mul(m))}mod(m){return this.modulo(m)}rem(m){return this.modulo(m)}multiply(m){if(this.isZero())return he.ZERO;if(he.isLong(m)||(m=he.fromValue(m)),Te){let ut=Te.mul(this.low,this.high,m.low,m.high);return he.fromBits(ut,Te.get_high(),this.unsigned)}if(m.isZero())return he.ZERO;if(this.eq(he.MIN_VALUE))return m.isOdd()?he.MIN_VALUE:he.ZERO;if(m.eq(he.MIN_VALUE))return this.isOdd()?he.MIN_VALUE:he.ZERO;if(this.isNegative())return m.isNegative()?this.neg().mul(m.neg()):this.neg().mul(m).neg();if(m.isNegative())return this.mul(m.neg()).neg();if(this.lt(he.TWO_PWR_24)&&m.lt(he.TWO_PWR_24))return he.fromNumber(this.toNumber()*m.toNumber(),this.unsigned);let N=this.high>>>16,K=this.high&65535,M=this.low>>>16,ve=this.low&65535,Ie=m.high>>>16,Le=m.high&65535,rt=m.low>>>16,be=m.low&65535,Qe=0,Be=0,Fe=0,Ue=0;return Ue+=ve*be,Fe+=Ue>>>16,Ue&=65535,Fe+=M*be,Be+=Fe>>>16,Fe&=65535,Fe+=ve*rt,Be+=Fe>>>16,Fe&=65535,Be+=K*be,Qe+=Be>>>16,Be&=65535,Be+=M*rt,Qe+=Be>>>16,Be&=65535,Be+=ve*Le,Qe+=Be>>>16,Be&=65535,Qe+=N*be+K*rt+M*Le+ve*Ie,Qe&=65535,he.fromBits(Fe<<16|Ue,Qe<<16|Be,this.unsigned)}mul(m){return this.multiply(m)}negate(){return!this.unsigned&&this.eq(he.MIN_VALUE)?he.MIN_VALUE:this.not().add(he.ONE)}neg(){return this.negate()}not(){return he.fromBits(~this.low,~this.high,this.unsigned)}notEquals(m){return!this.equals(m)}neq(m){return this.notEquals(m)}ne(m){return this.notEquals(m)}or(m){return he.isLong(m)||(m=he.fromValue(m)),he.fromBits(this.low|m.low,this.high|m.high,this.unsigned)}shiftLeft(m){return he.isLong(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?he.fromBits(this.low<<m,this.high<<m|this.low>>>32-m,this.unsigned):he.fromBits(0,this.low<<m-32,this.unsigned)}shl(m){return this.shiftLeft(m)}shiftRight(m){return he.isLong(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?he.fromBits(this.low>>>m|this.high<<32-m,this.high>>m,this.unsigned):he.fromBits(this.high>>m-32,this.high>=0?0:-1,this.unsigned)}shr(m){return this.shiftRight(m)}shiftRightUnsigned(m){if(he.isLong(m)&&(m=m.toInt()),m&=63,m===0)return this;{let N=this.high;if(m<32){let K=this.low;return he.fromBits(K>>>m|N<<32-m,N>>>m,this.unsigned)}else return m===32?he.fromBits(N,0,this.unsigned):he.fromBits(N>>>m-32,0,this.unsigned)}}shr_u(m){return this.shiftRightUnsigned(m)}shru(m){return this.shiftRightUnsigned(m)}subtract(m){return he.isLong(m)||(m=he.fromValue(m)),this.add(m.neg())}sub(m){return this.subtract(m)}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){return this.unsigned?(this.high>>>0)*Dt+(this.low>>>0):this.high*Dt+(this.low>>>0)}toBigInt(){return BigInt(this.toString())}toBytes(m){return m?this.toBytesLE():this.toBytesBE()}toBytesLE(){let m=this.high,N=this.low;return[N&255,N>>>8&255,N>>>16&255,N>>>24,m&255,m>>>8&255,m>>>16&255,m>>>24]}toBytesBE(){let m=this.high,N=this.low;return[m>>>24,m>>>16&255,m>>>8&255,m&255,N>>>24,N>>>16&255,N>>>8&255,N&255]}toSigned(){return this.unsigned?he.fromBits(this.low,this.high,!1):this}toString(m){if(m=m||10,m<2||36<m)throw new F("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(he.MIN_VALUE)){let ve=he.fromNumber(m),Ie=this.div(ve),Le=Ie.mul(ve).sub(this);return Ie.toString(m)+Le.toInt().toString(m)}else return"-"+this.neg().toString(m);let N=he.fromNumber(Math.pow(m,6),this.unsigned),K=this,M="";for(;;){let ve=K.div(N),Le=(K.sub(ve.mul(N)).toInt()>>>0).toString(m);if(K=ve,K.isZero())return Le+M;for(;Le.length<6;)Le="0"+Le;M=""+Le+M}}toUnsigned(){return this.unsigned?this:he.fromBits(this.low,this.high,!0)}xor(m){return he.isLong(m)||(m=he.fromValue(m)),he.fromBits(this.low^m.low,this.high^m.high,this.unsigned)}eqz(){return this.isZero()}le(m){return this.lessThanOrEqual(m)}toExtendedJSON(m){return m&&m.relaxed?this.toNumber():{$numberLong:this.toString()}}static fromExtendedJSON(m,N){let{useBigInt64:K=!1,relaxed:M=!0}={...N};if(m.$numberLong.length>yl)throw new F("$numberLong string is too long");if(!ho.test(m.$numberLong))throw new F(`$numberLong string "${m.$numberLong}" is in an invalid format`);if(K){let Ie=BigInt(m.$numberLong);return BigInt.asIntN(64,Ie)}let ve=he.fromString(m.$numberLong);return M?ve.toNumber():ve}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Long("${this.toString()}"${this.unsigned?", true":""})`}};he.TWO_PWR_24=he.fromInt(It),he.MAX_UNSIGNED_VALUE=he.fromBits(-1,-1,!0),he.ZERO=he.fromInt(0),he.UZERO=he.fromInt(0,!0),he.ONE=he.fromInt(1),he.UONE=he.fromInt(1,!0),he.NEG_ONE=he.fromInt(-1),he.MAX_VALUE=he.fromBits(-1,2147483647,!1),he.MIN_VALUE=he.fromBits(0,-2147483648,!1);var Hh=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,Wh=/^(\+|-)?(Infinity|inf)$/i,Jh=/^(\+|-)?NaN$/i,Ae=6111,nt=-6176,Y=6176,ot=34,er=le.fromNumberArray([124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),it=le.fromNumberArray([248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),Un=le.fromNumberArray([120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),at=/^([-+])?(\d+)?$/,zr=31,De=16383,je=30,ml=31;function ur(m){return!isNaN(parseInt(m,10))}function ft(m){let N=he.fromNumber(1e9),K=he.fromNumber(0);if(!m.parts[0]&&!m.parts[1]&&!m.parts[2]&&!m.parts[3])return{quotient:m,rem:K};for(let M=0;M<=3;M++)K=K.shiftLeft(32),K=K.add(new he(m.parts[M],0)),m.parts[M]=K.div(N).low,K=K.modulo(N);return{quotient:m,rem:K}}function go(m,N){if(!m&&!N)return{high:he.fromNumber(0),low:he.fromNumber(0)};let K=m.shiftRightUnsigned(32),M=new he(m.getLowBits(),0),ve=N.shiftRightUnsigned(32),Ie=new he(N.getLowBits(),0),Le=K.multiply(ve),rt=K.multiply(Ie),be=M.multiply(ve),Qe=M.multiply(Ie);return Le=Le.add(rt.shiftRightUnsigned(32)),rt=new he(rt.getLowBits(),0).add(be).add(Qe.shiftRightUnsigned(32)),Le=Le.add(rt.shiftRightUnsigned(32)),Qe=rt.shiftLeft(32).add(new he(Qe.getLowBits(),0)),{high:Le,low:Qe}}function Qs(m,N){let K=m.high>>>0,M=N.high>>>0;if(K<M)return!0;if(K===M){let ve=m.low>>>0,Ie=N.low>>>0;if(ve<Ie)return!0}return!1}function tr(m,N){throw new F(`"${m}" is not a valid Decimal128 string - ${N}`)}var Et=class extends St{get _bsontype(){return"Decimal128"}constructor(m){if(super(),typeof m=="string")this.bytes=Et.fromString(m).bytes;else if(Ce(m)){if(m.byteLength!==16)throw new F("Decimal128 must take a Buffer of 16 bytes");this.bytes=m}else throw new F("Decimal128 must take a Buffer or string")}static fromString(m){let N=!1,K=!1,M=!1,ve=0,Ie=0,Le=0,rt=0,be=0,Qe=[0],Be=0,Fe=0,Ue=0,ut=0,Ge=0,pn=0,zn=new he(0,0),nr=new he(0,0),nn=0,ct=0;if(m.length>=7e3)throw new F(""+m+" not a valid Decimal128 string");let hn=m.match(Hh),vl=m.match(Wh),Jc=m.match(Jh);if(!hn&&!vl&&!Jc||m.length===0)throw new F(""+m+" not a valid Decimal128 string");if(hn){let jt=hn[2],Nt=hn[4],st=hn[5],mt=hn[6];Nt&&mt===void 0&&tr(m,"missing exponent power"),Nt&&jt===void 0&&tr(m,"missing exponent base"),Nt===void 0&&(st||mt)&&tr(m,"missing e before exponent")}if((m[ct]==="+"||m[ct]==="-")&&(N=m[ct++]==="-"),!ur(m[ct])&&m[ct]!=="."){if(m[ct]==="i"||m[ct]==="I")return new Et(N?it:Un);if(m[ct]==="N")return new Et(er)}for(;ur(m[ct])||m[ct]===".";){if(m[ct]==="."){K&&tr(m,"contains multiple periods"),K=!0,ct=ct+1;continue}Be<34&&(m[ct]!=="0"||M)&&(M||(be=Ie),M=!0,Qe[Fe++]=parseInt(m[ct],10),Be=Be+1),M&&(Le=Le+1),K&&(rt=rt+1),Ie=Ie+1,ct=ct+1}if(K&&!Ie)throw new F(""+m+" not a valid Decimal128 string");if(m[ct]==="e"||m[ct]==="E"){let jt=m.substr(++ct).match(at);if(!jt||!jt[2])return new Et(er);Ge=parseInt(jt[0],10),ct=ct+jt[0].length}if(m[ct])return new Et(er);if(Ue=0,!Be)Ue=0,ut=0,Qe[0]=0,Le=1,Be=1,ve=0;else if(ut=Be-1,ve=Le,ve!==1)for(;Qe[be+ve-1]===0;)ve=ve-1;for(Ge<=rt&&rt-Ge>16384?Ge=nt:Ge=Ge-rt;Ge>Ae;){if(ut=ut+1,ut-Ue>ot){if(Qe.join("").match(/^0+$/)){Ge=Ae;break}tr(m,"overflow")}Ge=Ge-1}for(;Ge<nt||Be<Le;){if(ut===0&&ve<Be){Ge=nt,ve=0;break}if(Be<Le?Le=Le-1:ut=ut-1,Ge<Ae)Ge=Ge+1;else{if(Qe.join("").match(/^0+$/)){Ge=Ae;break}tr(m,"overflow")}}if(ut-Ue+1<ve){let jt=Ie;K&&(be=be+1,jt=jt+1),N&&(be=be+1,jt=jt+1);let Nt=parseInt(m[be+ut+1],10),st=0;if(Nt>=5&&(st=1,Nt===5)){for(st=Qe[ut]%2===1?1:0,pn=be+ut+2;pn<jt;pn++)if(parseInt(m[pn],10)){st=1;break}}if(st){let mt=ut;for(;mt>=0;mt--)if(++Qe[mt]>9&&(Qe[mt]=0,mt===0))if(Ge<Ae)Ge=Ge+1,Qe[mt]=1;else return new Et(N?it:Un)}}if(zn=he.fromNumber(0),nr=he.fromNumber(0),ve===0)zn=he.fromNumber(0),nr=he.fromNumber(0);else if(ut-Ue<17){let jt=Ue;for(nr=he.fromNumber(Qe[jt++]),zn=new he(0,0);jt<=ut;jt++)nr=nr.multiply(he.fromNumber(10)),nr=nr.add(he.fromNumber(Qe[jt]))}else{let jt=Ue;for(zn=he.fromNumber(Qe[jt++]);jt<=ut-17;jt++)zn=zn.multiply(he.fromNumber(10)),zn=zn.add(he.fromNumber(Qe[jt]));for(nr=he.fromNumber(Qe[jt++]);jt<=ut;jt++)nr=nr.multiply(he.fromNumber(10)),nr=nr.add(he.fromNumber(Qe[jt]))}let wt=go(zn,he.fromString("100000000000000000"));wt.low=wt.low.add(nr),Qs(wt.low,nr)&&(wt.high=wt.high.add(he.fromNumber(1))),nn=Ge+Y;let et={low:he.fromNumber(0),high:he.fromNumber(0)};wt.high.shiftRightUnsigned(49).and(he.fromNumber(1)).equals(he.fromNumber(1))?(et.high=et.high.or(he.fromNumber(3).shiftLeft(61)),et.high=et.high.or(he.fromNumber(nn).and(he.fromNumber(16383).shiftLeft(47))),et.high=et.high.or(wt.high.and(he.fromNumber(0x7fffffffffff)))):(et.high=et.high.or(he.fromNumber(nn&16383).shiftLeft(49)),et.high=et.high.or(wt.high.and(he.fromNumber(562949953421311)))),et.low=wt.low,N&&(et.high=et.high.or(he.fromString("9223372036854775808")));let dr=le.allocate(16);return ct=0,dr[ct++]=et.low.low&255,dr[ct++]=et.low.low>>8&255,dr[ct++]=et.low.low>>16&255,dr[ct++]=et.low.low>>24&255,dr[ct++]=et.low.high&255,dr[ct++]=et.low.high>>8&255,dr[ct++]=et.low.high>>16&255,dr[ct++]=et.low.high>>24&255,dr[ct++]=et.high.low&255,dr[ct++]=et.high.low>>8&255,dr[ct++]=et.high.low>>16&255,dr[ct++]=et.high.low>>24&255,dr[ct++]=et.high.high&255,dr[ct++]=et.high.high>>8&255,dr[ct++]=et.high.high>>16&255,dr[ct++]=et.high.high>>24&255,new Et(dr)}toString(){let m,N=0,K=new Array(36);for(let ct=0;ct<K.length;ct++)K[ct]=0;let M=0,ve=!1,Ie,Le={parts:[0,0,0,0]},rt,be,Qe=[];M=0;let Be=this.bytes,Fe=Be[M++]|Be[M++]<<8|Be[M++]<<16|Be[M++]<<24,Ue=Be[M++]|Be[M++]<<8|Be[M++]<<16|Be[M++]<<24,ut=Be[M++]|Be[M++]<<8|Be[M++]<<16|Be[M++]<<24,Ge=Be[M++]|Be[M++]<<8|Be[M++]<<16|Be[M++]<<24;M=0,{low:new he(Fe,Ue),high:new he(ut,Ge)}.high.lessThan(he.ZERO)&&Qe.push("-");let zn=Ge>>26&zr;if(zn>>3===3){if(zn===je)return Qe.join("")+"Infinity";if(zn===ml)return"NaN";m=Ge>>15&De,Ie=8+(Ge>>14&1)}else Ie=Ge>>14&7,m=Ge>>17&De;let nr=m-Y;if(Le.parts[0]=(Ge&16383)+((Ie&15)<<14),Le.parts[1]=ut,Le.parts[2]=Ue,Le.parts[3]=Fe,Le.parts[0]===0&&Le.parts[1]===0&&Le.parts[2]===0&&Le.parts[3]===0)ve=!0;else for(be=3;be>=0;be--){let ct=0,hn=ft(Le);if(Le=hn.quotient,ct=hn.rem.low,!!ct)for(rt=8;rt>=0;rt--)K[be*9+rt]=ct%10,ct=Math.floor(ct/10)}if(ve)N=1,K[M]=0;else for(N=36;!K[M];)N=N-1,M=M+1;let nn=N-1+nr;if(nn>=34||nn<=-7||nr>0){if(N>34)return Qe.push("0"),nr>0?Qe.push(`E+${nr}`):nr<0&&Qe.push(`E${nr}`),Qe.join("");Qe.push(`${K[M++]}`),N=N-1,N&&Qe.push(".");for(let ct=0;ct<N;ct++)Qe.push(`${K[M++]}`);Qe.push("E"),nn>0?Qe.push(`+${nn}`):Qe.push(`${nn}`)}else if(nr>=0)for(let ct=0;ct<N;ct++)Qe.push(`${K[M++]}`);else{let ct=N+nr;if(ct>0)for(let hn=0;hn<ct;hn++)Qe.push(`${K[M++]}`);else Qe.push("0");for(Qe.push(".");ct++<0;)Qe.push("0");for(let hn=0;hn<N-Math.max(ct-1,0);hn++)Qe.push(`${K[M++]}`)}return Qe.join("")}toJSON(){return{$numberDecimal:this.toString()}}toExtendedJSON(){return{$numberDecimal:this.toString()}}static fromExtendedJSON(m){return Et.fromString(m.$numberDecimal)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Decimal128("${this.toString()}")`}},kr=class extends St{get _bsontype(){return"Double"}constructor(m){super(),m instanceof Number&&(m=m.valueOf()),this.value=+m}valueOf(){return this.value}toJSON(){return this.value}toString(m){return this.value.toString(m)}toExtendedJSON(m){return m&&(m.legacy||m.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-0.0"}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}}static fromExtendedJSON(m,N){let K=parseFloat(m.$numberDouble);return N&&N.relaxed?K:new kr(K)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Double(${this.toExtendedJSON().$numberDouble})`}},qr=class extends St{get _bsontype(){return"Int32"}constructor(m){super(),m instanceof Number&&(m=m.valueOf()),this.value=+m|0}valueOf(){return this.value}toString(m){return this.value.toString(m)}toJSON(){return this.value}toExtendedJSON(m){return m&&(m.relaxed||m.legacy)?this.value:{$numberInt:this.value.toString()}}static fromExtendedJSON(m,N){return N&&N.relaxed?parseInt(m.$numberInt,10):new qr(m.$numberInt)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Int32(${this.valueOf()})`}},Nr=class extends St{get _bsontype(){return"MaxKey"}toExtendedJSON(){return{$maxKey:1}}static fromExtendedJSON(){return new Nr}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return"new MaxKey()"}},is=class extends St{get _bsontype(){return"MinKey"}toExtendedJSON(){return{$minKey:1}}static fromExtendedJSON(){return new is}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return"new MinKey()"}},yo=new RegExp("^[0-9a-fA-F]{24}$"),rr=null,Pr=Symbol("id"),Ct=class extends St{get _bsontype(){return"ObjectId"}constructor(m){super();let N;if(typeof m=="object"&&m&&"id"in m){if(typeof m.id!="string"&&!ArrayBuffer.isView(m.id))throw new F("Argument passed in must have an id that is of type string or Buffer");"toHexString"in m&&typeof m.toHexString=="function"?N=le.fromHex(m.toHexString()):N=m.id}else N=m;if(N==null||typeof N=="number")this[Pr]=Ct.generate(typeof N=="number"?N:void 0);else if(ArrayBuffer.isView(N)&&N.byteLength===12)this[Pr]=le.toLocalBufferType(N);else if(typeof N=="string")if(N.length===12){let K=le.fromUTF8(N);if(K.byteLength===12)this[Pr]=K;else throw new F("Argument passed in must be a string of 12 bytes")}else if(N.length===24&&yo.test(N))this[Pr]=le.fromHex(N);else throw new F("Argument passed in must be a string of 12 bytes or a string of 24 hex characters or an integer");else throw new F("Argument passed in does not match the accepted types");Ct.cacheHexString&&(this.__id=le.toHex(this.id))}get id(){return this[Pr]}set id(m){this[Pr]=m,Ct.cacheHexString&&(this.__id=le.toHex(m))}toHexString(){if(Ct.cacheHexString&&this.__id)return this.__id;let m=le.toHex(this.id);return Ct.cacheHexString&&!this.__id&&(this.__id=m),m}static getInc(){return Ct.index=(Ct.index+1)%16777215}static generate(m){typeof m!="number"&&(m=Math.floor(Date.now()/1e3));let N=Ct.getInc(),K=le.allocate(12);return we.fromUint8Array(K).setUint32(0,m,!1),rr===null&&(rr=le.randomBytes(5)),K[4]=rr[0],K[5]=rr[1],K[6]=rr[2],K[7]=rr[3],K[8]=rr[4],K[11]=N&255,K[10]=N>>8&255,K[9]=N>>16&255,K}toString(m){return m==="base64"?le.toBase64(this.id):m==="hex"?this.toHexString():this.toHexString()}toJSON(){return this.toHexString()}equals(m){if(m==null)return!1;if(m instanceof Ct)return this[Pr][11]===m[Pr][11]&&le.equals(this[Pr],m[Pr]);if(typeof m=="string"&&Ct.isValid(m)&&m.length===12&&Ce(this.id))return le.equals(this.id,le.fromISO88591(m));if(typeof m=="string"&&Ct.isValid(m)&&m.length===24)return m.toLowerCase()===this.toHexString();if(typeof m=="string"&&Ct.isValid(m)&&m.length===12)return le.equals(le.fromUTF8(m),this.id);if(typeof m=="object"&&"toHexString"in m&&typeof m.toHexString=="function"){let N=m.toHexString(),K=this.toHexString().toLowerCase();return typeof N=="string"&&N.toLowerCase()===K}return!1}getTimestamp(){let m=new Date,N=we.fromUint8Array(this.id).getUint32(0,!1);return m.setTime(Math.floor(N)*1e3),m}static createPk(){return new Ct}static createFromTime(m){let N=le.fromNumberArray([0,0,0,0,0,0,0,0,0,0,0,0]);return we.fromUint8Array(N).setUint32(0,m,!1),new Ct(N)}static createFromHexString(m){if(typeof m>"u"||m!=null&&m.length!==24)throw new F("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new Ct(le.fromHex(m))}static isValid(m){if(m==null)return!1;try{return new Ct(m),!0}catch{return!1}}toExtendedJSON(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}}static fromExtendedJSON(m){return new Ct(m.$oid)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new ObjectId("${this.toHexString()}")`}};Ct.index=Math.floor(Math.random()*16777215);function ei(m,N,K){let M=5;if(Array.isArray(m))for(let ve=0;ve<m.length;ve++)M+=wi(ve.toString(),m[ve],N,!0,K);else{typeof m?.toBSON=="function"&&(m=m.toBSON());for(let ve of Object.keys(m))M+=wi(ve,m[ve],N,!1,K)}return M}function wi(m,N,K=!1,M=!1,ve=!1){switch(typeof N?.toBSON=="function"&&(N=N.toBSON()),typeof N){case"string":return 1+le.utf8ByteLength(m)+1+4+le.utf8ByteLength(N)+1;case"number":return Math.floor(N)===N&&N>=o&&N<=a&&N>=n&&N<=r?(m!=null?le.utf8ByteLength(m)+1:0)+(4+1):(m!=null?le.utf8ByteLength(m)+1:0)+(8+1);case"undefined":return M||!ve?(m!=null?le.utf8ByteLength(m)+1:0)+1:0;case"boolean":return(m!=null?le.utf8ByteLength(m)+1:0)+(1+1);case"object":if(N!=null&&typeof N._bsontype=="string"&&N[Symbol.for("@@mdb.bson.version")]!==t)throw new H;if(N==null||N._bsontype==="MinKey"||N._bsontype==="MaxKey")return(m!=null?le.utf8ByteLength(m)+1:0)+1;if(N._bsontype==="ObjectId")return(m!=null?le.utf8ByteLength(m)+1:0)+(12+1);if(N instanceof Date||kt(N))return(m!=null?le.utf8ByteLength(m)+1:0)+(8+1);if(ArrayBuffer.isView(N)||N instanceof ArrayBuffer||Ne(N))return(m!=null?le.utf8ByteLength(m)+1:0)+(1+4+1)+N.byteLength;if(N._bsontype==="Long"||N._bsontype==="Double"||N._bsontype==="Timestamp")return(m!=null?le.utf8ByteLength(m)+1:0)+(8+1);if(N._bsontype==="Decimal128")return(m!=null?le.utf8ByteLength(m)+1:0)+(16+1);if(N._bsontype==="Code")return N.scope!=null&&Object.keys(N.scope).length>0?(m!=null?le.utf8ByteLength(m)+1:0)+1+4+4+le.utf8ByteLength(N.code.toString())+1+ei(N.scope,K,ve):(m!=null?le.utf8ByteLength(m)+1:0)+1+4+le.utf8ByteLength(N.code.toString())+1;if(N._bsontype==="Binary"){let Ie=N;return Ie.sub_type===pt.SUBTYPE_BYTE_ARRAY?(m!=null?le.utf8ByteLength(m)+1:0)+(Ie.position+1+4+1+4):(m!=null?le.utf8ByteLength(m)+1:0)+(Ie.position+1+4+1)}else{if(N._bsontype==="Symbol")return(m!=null?le.utf8ByteLength(m)+1:0)+le.utf8ByteLength(N.value)+4+1+1;if(N._bsontype==="DBRef"){let Ie=Object.assign({$ref:N.collection,$id:N.oid},N.fields);return N.db!=null&&(Ie.$db=N.db),(m!=null?le.utf8ByteLength(m)+1:0)+1+ei(Ie,K,ve)}else return N instanceof RegExp||Xe(N)?(m!=null?le.utf8ByteLength(m)+1:0)+1+le.utf8ByteLength(N.source)+1+(N.global?1:0)+(N.ignoreCase?1:0)+(N.multiline?1:0)+1:N._bsontype==="BSONRegExp"?(m!=null?le.utf8ByteLength(m)+1:0)+1+le.utf8ByteLength(N.pattern)+1+le.utf8ByteLength(N.options)+1:(m!=null?le.utf8ByteLength(m)+1:0)+ei(N,K,ve)+1}case"function":if(K)return(m!=null?le.utf8ByteLength(m)+1:0)+1+4+le.utf8ByteLength(N.toString())+1}return 0}function Pf(m){return m.split("").sort().join("")}var Bi=class extends St{get _bsontype(){return"BSONRegExp"}constructor(m,N){if(super(),this.pattern=m,this.options=Pf(N??""),this.pattern.indexOf("\0")!==-1)throw new F(`BSON Regex patterns cannot contain null bytes, found: ${JSON.stringify(this.pattern)}`);if(this.options.indexOf("\0")!==-1)throw new F(`BSON Regex options cannot contain null bytes, found: ${JSON.stringify(this.options)}`);for(let K=0;K<this.options.length;K++)if(!(this.options[K]==="i"||this.options[K]==="m"||this.options[K]==="x"||this.options[K]==="l"||this.options[K]==="s"||this.options[K]==="u"))throw new F(`The regular expression option [${this.options[K]}] is not supported`)}static parseOptions(m){return m?m.split("").sort().join(""):""}toExtendedJSON(m){return m=m||{},m.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}}static fromExtendedJSON(m){if("$regex"in m)if(typeof m.$regex!="string"){if(m.$regex._bsontype==="BSONRegExp")return m}else return new Bi(m.$regex,Bi.parseOptions(m.$options));if("$regularExpression"in m)return new Bi(m.$regularExpression.pattern,Bi.parseOptions(m.$regularExpression.options));throw new F(`Unexpected BSONRegExp EJSON object form: ${JSON.stringify(m)}`)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new BSONRegExp(${JSON.stringify(this.pattern)}, ${JSON.stringify(this.options)})`}},mo=class extends St{get _bsontype(){return"BSONSymbol"}constructor(m){super(),this.value=m}valueOf(){return this.value}toString(){return this.value}inspect(){return`new BSONSymbol("${this.value}")`}toJSON(){return this.value}toExtendedJSON(){return{$symbol:this.value}}static fromExtendedJSON(m){return new mo(m.$symbol)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}},Ix=he,Mi=class extends Ix{get _bsontype(){return"Timestamp"}constructor(m){if(m==null)super(0,0,!0);else if(typeof m=="bigint")super(m,!0);else if(he.isLong(m))super(m.low,m.high,!0);else if(typeof m=="object"&&"t"in m&&"i"in m){if(typeof m.t!="number"&&(typeof m.t!="object"||m.t._bsontype!=="Int32"))throw new F("Timestamp constructed from { t, i } must provide t as a number");if(typeof m.i!="number"&&(typeof m.i!="object"||m.i._bsontype!=="Int32"))throw new F("Timestamp constructed from { t, i } must provide i as a number");if(m.t<0)throw new F("Timestamp constructed from { t, i } must provide a positive t");if(m.i<0)throw new F("Timestamp constructed from { t, i } must provide a positive i");if(m.t>4294967295)throw new F("Timestamp constructed from { t, i } must provide t equal or less than uint32 max");if(m.i>4294967295)throw new F("Timestamp constructed from { t, i } must provide i equal or less than uint32 max");super(m.i.valueOf(),m.t.valueOf(),!0)}else throw new F("A Timestamp can only be constructed with: bigint, Long, or { t: number; i: number }")}toJSON(){return{$timestamp:this.toString()}}static fromInt(m){return new Mi(he.fromInt(m,!0))}static fromNumber(m){return new Mi(he.fromNumber(m,!0))}static fromBits(m,N){return new Mi({i:m,t:N})}static fromString(m,N){return new Mi(he.fromString(m,!0,N))}toExtendedJSON(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}}static fromExtendedJSON(m){let N=he.isLong(m.$timestamp.i)?m.$timestamp.i.getLowBitsUnsigned():m.$timestamp.i,K=he.isLong(m.$timestamp.t)?m.$timestamp.t.getLowBitsUnsigned():m.$timestamp.t;return new Mi({t:K,i:N})}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new Timestamp({ t: ${this.getHighBits()}, i: ${this.getLowBits()} })`}};Mi.MAX_VALUE=he.MAX_UNSIGNED_VALUE;var Nx=128,Px=192,Lx=224,Fx=240,Dx=248,jx=192,Bx=224,Mx=240,Rx=128;function vv(m,N,K){let M=0;for(let ve=N;ve<K;ve+=1){let Ie=m[ve];if(M){if((Ie&Px)!==Rx)return!1;M-=1}else if(Ie&Nx)if((Ie&Lx)===jx)M=1;else if((Ie&Fx)===Bx)M=2;else if((Ie&Dx)===Mx)M=3;else return!1}return!M}var $x=he.fromNumber(a),Ux=he.fromNumber(o);function _v(m,N,K){N=N??{};let M=N&&N.index?N.index:0,ve=m[M]|m[M+1]<<8|m[M+2]<<16|m[M+3]<<24;if(ve<5)throw new F(`bson size must be >= 5, is ${ve}`);if(N.allowObjectSmallerThanBufferSize&&m.length<ve)throw new F(`buffer length ${m.length} must be >= bson size ${ve}`);if(!N.allowObjectSmallerThanBufferSize&&m.length!==ve)throw new F(`buffer length ${m.length} must === bson size ${ve}`);if(ve+M>m.byteLength)throw new F(`(bson size ${ve} + options.index ${M} must be <= buffer length ${m.byteLength})`);if(m[M+ve-1]!==0)throw new F("One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00");return Lf(m,M,N,K)}var zx=/^\$ref$|^\$id$|^\$db$/;function Lf(m,N,K,M=!1){let ve=K.fieldsAsRaw==null?null:K.fieldsAsRaw,Ie=K.raw==null?!1:K.raw,Le=typeof K.bsonRegExp=="boolean"?K.bsonRegExp:!1,rt=K.promoteBuffers??!1,be=K.promoteLongs??!0,Qe=K.promoteValues??!0,Be=K.useBigInt64??!1;if(Be&&!Qe)throw new F("Must either request bigint or Long for int64 deserialization");if(Be&&!be)throw new F("Must either request bigint or Long for int64 deserialization");let Fe=K.validation==null?{utf8:!0}:K.validation,Ue=!0,ut,Ge=new Set,pn=Fe.utf8;if(typeof pn=="boolean")ut=pn;else{Ue=!1;let wt=Object.keys(pn).map(function(et){return pn[et]});if(wt.length===0)throw new F("UTF-8 validation setting cannot be empty");if(typeof wt[0]!="boolean")throw new F("Invalid UTF-8 validation option, must specify boolean values");if(ut=wt[0],!wt.every(et=>et===ut))throw new F("Invalid UTF-8 validation option - keys must be all true or all false")}if(!Ue)for(let wt of Object.keys(pn))Ge.add(wt);let zn=N;if(m.length<5)throw new F("corrupt bson message < 5 bytes long");let nr=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(nr<5||nr>m.length)throw new F("corrupt bson message");let nn=M?[]:{},ct=0,hn=!1,vl=M?!1:null,Jc=new DataView(m.buffer,m.byteOffset,m.byteLength);for(;!hn;){let wt=m[N++];if(wt===0)break;let et=N;for(;m[et]!==0&&et<m.length;)et++;if(et>=m.byteLength)throw new F("Bad BSON Document: illegal CString");let dr=M?ct++:le.toUTF8(m.subarray(N,et)),jt=!0;Ue||Ge.has(dr)?jt=ut:jt=!ut,vl!==!1&&dr[0]==="$"&&(vl=zx.test(dr));let Nt;if(N=et+1,wt===c){let st=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(st<=0||st>m.length-N||m[N+st-1]!==0)throw new F("bad string length in bson");Nt=Ff(m,N,N+st-1,jt),N=N+st}else if(wt===_){let st=le.allocate(12);st.set(m.subarray(N,N+12)),Nt=new Ct(st),N=N+12}else if(wt===L&&Qe===!1)Nt=new qr(m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24);else if(wt===L)Nt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;else if(wt===l&&Qe===!1)Nt=new kr(Jc.getFloat64(N,!0)),N=N+8;else if(wt===l)Nt=Jc.getFloat64(N,!0),N=N+8;else if(wt===k){let st=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,mt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;Nt=new Date(new he(st,mt).toNumber())}else if(wt===w){if(m[N]!==0&&m[N]!==1)throw new F("illegal boolean type value");Nt=m[N++]===1}else if(wt===f){let st=N,mt=m[N]|m[N+1]<<8|m[N+2]<<16|m[N+3]<<24;if(mt<=0||mt>m.length-N)throw new F("bad embedded document length in bson");if(Ie)Nt=m.slice(N,N+mt);else{let sr=K;Ue||(sr={...K,validation:{utf8:jt}}),Nt=Lf(m,st,sr,!1)}N=N+mt}else if(wt===u){let st=N,mt=m[N]|m[N+1]<<8|m[N+2]<<16|m[N+3]<<24,sr=K,qn=N+mt;if(ve&&ve[dr]&&(sr={...K,raw:!0}),Ue||(sr={...sr,validation:{utf8:jt}}),Nt=Lf(m,st,sr,!0),N=N+mt,m[N-1]!==0)throw new F("invalid array terminator byte");if(N!==qn)throw new F("corrupted array bson")}else if(wt===p)Nt=void 0;else if(wt===S)Nt=null;else if(wt===te){let st=we.fromUint8Array(m.subarray(N,N+8)),mt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,sr=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,qn=new he(mt,sr);Be?Nt=st.getBigInt64(0,!0):be&&Qe===!0?Nt=qn.lessThanOrEqual($x)&&qn.greaterThanOrEqual(Ux)?qn.toNumber():qn:Nt=qn}else if(wt===V){let st=le.allocate(16);st.set(m.subarray(N,N+16),0),N=N+16,Nt=new Et(st)}else if(wt===d){let st=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,mt=st,sr=m[N++];if(st<0)throw new F("Negative binary type element size found");if(st>m.byteLength)throw new F("Binary type size larger than document size");if(m.slice!=null){if(sr===pt.SUBTYPE_BYTE_ARRAY){if(st=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,st<0)throw new F("Negative binary type element size found for subtype 0x02");if(st>mt-4)throw new F("Binary type with subtype 0x02 contains too long binary size");if(st<mt-4)throw new F("Binary type with subtype 0x02 contains too short binary size")}rt&&Qe?Nt=le.toLocalBufferType(m.slice(N,N+st)):(Nt=new pt(m.slice(N,N+st),sr),sr===pe&&(Nt=Nt.toUUID()))}else{let qn=le.allocate(st);if(sr===pt.SUBTYPE_BYTE_ARRAY){if(st=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24,st<0)throw new F("Negative binary type element size found for subtype 0x02");if(st>mt-4)throw new F("Binary type with subtype 0x02 contains too long binary size");if(st<mt-4)throw new F("Binary type with subtype 0x02 contains too short binary size")}for(et=0;et<st;et++)qn[et]=m[N+et];rt&&Qe?Nt=qn:sr===pe?Nt=new pt(m.slice(N,N+st),sr).toUUID():Nt=new pt(m.slice(N,N+st),sr)}N=N+st}else if(wt===O&&Le===!1){for(et=N;m[et]!==0&&et<m.length;)et++;if(et>=m.length)throw new F("Bad BSON Document: illegal CString");let st=le.toUTF8(m.subarray(N,et));for(N=et+1,et=N;m[et]!==0&&et<m.length;)et++;if(et>=m.length)throw new F("Bad BSON Document: illegal CString");let mt=le.toUTF8(m.subarray(N,et));N=et+1;let sr=new Array(mt.length);for(et=0;et<mt.length;et++)switch(mt[et]){case"m":sr[et]="m";break;case"s":sr[et]="g";break;case"i":sr[et]="i";break}Nt=new RegExp(st,sr.join(""))}else if(wt===O&&Le===!0){for(et=N;m[et]!==0&&et<m.length;)et++;if(et>=m.length)throw new F("Bad BSON Document: illegal CString");let st=le.toUTF8(m.subarray(N,et));for(N=et+1,et=N;m[et]!==0&&et<m.length;)et++;if(et>=m.length)throw new F("Bad BSON Document: illegal CString");let mt=le.toUTF8(m.subarray(N,et));N=et+1,Nt=new Bi(st,mt)}else if(wt===I){let st=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(st<=0||st>m.length-N||m[N+st-1]!==0)throw new F("bad string length in bson");let mt=Ff(m,N,N+st-1,jt);Nt=Qe?mt:new mo(mt),N=N+st}else if(wt===U){let st=m[N++]+m[N++]*256+m[N++]*65536+m[N++]*16777216,mt=m[N++]+m[N++]*256+m[N++]*65536+m[N++]*(1<<24);Nt=new Mi({i:st,t:mt})}else if(wt===X)Nt=new is;else if(wt===Z)Nt=new Nr;else if(wt===C){let st=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(st<=0||st>m.length-N||m[N+st-1]!==0)throw new F("bad string length in bson");let mt=Ff(m,N,N+st-1,jt);Nt=new B(mt),N=N+st}else if(wt===D){let st=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(st<4+4+4+1)throw new F("code_w_scope total size shorter minimum expected length");let mt=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(mt<=0||mt>m.length-N||m[N+mt-1]!==0)throw new F("bad string length in bson");let sr=Ff(m,N,N+mt-1,jt);N=N+mt;let qn=N,Uf=m[N]|m[N+1]<<8|m[N+2]<<16|m[N+3]<<24,zf=Lf(m,qn,K,!1);if(N=N+Uf,st<4+4+Uf+mt)throw new F("code_w_scope total size is too short, truncating scope");if(st>4+4+Uf+mt)throw new F("code_w_scope total size is too long, clips outer document");Nt=new B(sr,zf)}else if(wt===A){let st=m[N++]|m[N++]<<8|m[N++]<<16|m[N++]<<24;if(st<=0||st>m.length-N||m[N+st-1]!==0)throw new F("bad string length in bson");if(Fe!=null&&Fe.utf8&&!vv(m,N,N+st-1))throw new F("Invalid UTF-8 string in BSON document");let mt=le.toUTF8(m.subarray(N,N+st-1));N=N+st;let sr=le.allocate(12);sr.set(m.subarray(N,N+12),0);let qn=new Ct(sr);N=N+12,Nt=new ke(mt,qn)}else throw new F(`Detected unknown BSON type ${wt.toString(16)} for fieldname "${dr}"`);dr==="__proto__"?Object.defineProperty(nn,dr,{value:Nt,writable:!0,enumerable:!0,configurable:!0}):nn[dr]=Nt}if(nr!==N-zn)throw M?new F("corrupt array bson"):new F("corrupt object bson");if(!vl)return nn;if(re(nn)){let wt=Object.assign({},nn);return delete wt.$ref,delete wt.$id,delete wt.$db,new ke(nn.$ref,nn.$id,nn.$db,wt)}return nn}function Ff(m,N,K,M){let ve=le.toUTF8(m.subarray(N,K));if(M){for(let Ie=0;Ie<ve.length;Ie++)if(ve.charCodeAt(Ie)===65533){if(!vv(m,N,K))throw new F("Invalid UTF-8 string in BSON document");break}}return ve}var Df=/\x00/,wv=new Set(["$db","$ref","$id","$clusterTime"]);function Gh(m,N,K,M){m[M++]=c;let ve=le.encodeUTF8Into(m,N,M);M=M+ve+1,m[M-1]=0;let Ie=le.encodeUTF8Into(m,K,M+4);return m[M+3]=Ie+1>>24&255,m[M+2]=Ie+1>>16&255,m[M+1]=Ie+1>>8&255,m[M]=Ie+1&255,M=M+4+Ie,m[M++]=0,M}var bl=new DataView(new ArrayBuffer(8),0,8),qx=new Uint8Array(bl.buffer,0,4),jf=new Uint8Array(bl.buffer,0,8);function Kh(m,N,K,M){let Ie=!Object.is(K,-0)&&Number.isSafeInteger(K)&&K<=r&&K>=n?L:l;Ie===L?bl.setInt32(0,K,!0):bl.setFloat64(0,K,!0);let Le=Ie===L?qx:jf;m[M++]=Ie;let rt=le.encodeUTF8Into(m,N,M);return M=M+rt,m[M++]=0,m.set(Le,M),M+=Le.byteLength,M}function Yh(m,N,K,M){m[M++]=te;let ve=le.encodeUTF8Into(m,N,M);return M+=ve,m[M++]=0,bl.setBigInt64(0,K,!0),m.set(jf,M),M+=jf.byteLength,M}function Vc(m,N,K,M){m[M++]=S;let ve=le.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,M}function Xh(m,N,K,M){m[M++]=w;let ve=le.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,m[M++]=K?1:0,M}function Zh(m,N,K,M){m[M++]=k;let ve=le.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ie=he.fromNumber(K.getTime()),Le=Ie.getLowBits(),rt=Ie.getHighBits();return m[M++]=Le&255,m[M++]=Le>>8&255,m[M++]=Le>>16&255,m[M++]=Le>>24&255,m[M++]=rt&255,m[M++]=rt>>8&255,m[M++]=rt>>16&255,m[M++]=rt>>24&255,M}function Qh(m,N,K,M){m[M++]=O;let ve=le.encodeUTF8Into(m,N,M);if(M=M+ve,m[M++]=0,K.source&&K.source.match(Df)!=null)throw new F("value "+K.source+" must not contain null bytes");return M=M+le.encodeUTF8Into(m,K.source,M),m[M++]=0,K.ignoreCase&&(m[M++]=105),K.global&&(m[M++]=115),K.multiline&&(m[M++]=109),m[M++]=0,M}function eg(m,N,K,M){m[M++]=O;let ve=le.encodeUTF8Into(m,N,M);if(M=M+ve,m[M++]=0,K.pattern.match(Df)!=null)throw new F("pattern "+K.pattern+" must not contain null bytes");M=M+le.encodeUTF8Into(m,K.pattern,M),m[M++]=0;let Ie=K.options.split("").sort().join("");return M=M+le.encodeUTF8Into(m,Ie,M),m[M++]=0,M}function fr(m,N,K,M){K===null?m[M++]=S:K._bsontype==="MinKey"?m[M++]=X:m[M++]=Z;let ve=le.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,M}function tg(m,N,K,M){m[M++]=_;let ve=le.encodeUTF8Into(m,N,M);if(M=M+ve,m[M++]=0,Ce(K.id))m.set(K.id.subarray(0,12),M);else throw new F("object ["+JSON.stringify(K)+"] is not a valid ObjectId");return M+12}function rg(m,N,K,M){m[M++]=d;let ve=le.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ie=K.length;return m[M++]=Ie&255,m[M++]=Ie>>8&255,m[M++]=Ie>>16&255,m[M++]=Ie>>24&255,m[M++]=se,m.set(K,M),M=M+Ie,M}function Bf(m,N,K,M,ve,Ie,Le,rt,be){if(be.has(K))throw new F("Cannot convert circular structure to BSON");be.add(K),m[M++]=Array.isArray(K)?u:f;let Qe=le.encodeUTF8Into(m,N,M);M=M+Qe,m[M++]=0;let Be=Wc(m,K,ve,M,Ie+1,Le,rt,be);return be.delete(K),Be}function Mf(m,N,K,M){m[M++]=V;let ve=le.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,m.set(K.bytes.subarray(0,16),M),M+16}function ng(m,N,K,M){m[M++]=K._bsontype==="Long"?te:U;let ve=le.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ie=K.getLowBits(),Le=K.getHighBits();return m[M++]=Ie&255,m[M++]=Ie>>8&255,m[M++]=Ie>>16&255,m[M++]=Ie>>24&255,m[M++]=Le&255,m[M++]=Le>>8&255,m[M++]=Le>>16&255,m[M++]=Le>>24&255,M}function Hc(m,N,K,M){K=K.valueOf(),m[M++]=L;let ve=le.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,m[M++]=K&255,m[M++]=K>>8&255,m[M++]=K>>16&255,m[M++]=K>>24&255,M}function Rf(m,N,K,M){m[M++]=l;let ve=le.encodeUTF8Into(m,N,M);return M=M+ve,m[M++]=0,bl.setFloat64(0,K.value,!0),m.set(jf,M),M=M+8,M}function $f(m,N,K,M){m[M++]=C;let ve=le.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ie=K.toString(),Le=le.encodeUTF8Into(m,Ie,M+4)+1;return m[M]=Le&255,m[M+1]=Le>>8&255,m[M+2]=Le>>16&255,m[M+3]=Le>>24&255,M=M+4+Le-1,m[M++]=0,M}function ig(m,N,K,M,ve=!1,Ie=0,Le=!1,rt=!0,be){if(K.scope&&typeof K.scope=="object"){m[M++]=D;let Qe=le.encodeUTF8Into(m,N,M);M=M+Qe,m[M++]=0;let Be=M,Fe=K.code;M=M+4;let Ue=le.encodeUTF8Into(m,Fe,M+4)+1;m[M]=Ue&255,m[M+1]=Ue>>8&255,m[M+2]=Ue>>16&255,m[M+3]=Ue>>24&255,m[M+4+Ue-1]=0,M=M+Ue+4;let ut=Wc(m,K.scope,ve,M,Ie+1,Le,rt,be);M=ut-1;let Ge=ut-Be;m[Be++]=Ge&255,m[Be++]=Ge>>8&255,m[Be++]=Ge>>16&255,m[Be++]=Ge>>24&255,m[M++]=0}else{m[M++]=C;let Qe=le.encodeUTF8Into(m,N,M);M=M+Qe,m[M++]=0;let Be=K.code.toString(),Fe=le.encodeUTF8Into(m,Be,M+4)+1;m[M]=Fe&255,m[M+1]=Fe>>8&255,m[M+2]=Fe>>16&255,m[M+3]=Fe>>24&255,M=M+4+Fe-1,m[M++]=0}return M}function sg(m,N,K,M){m[M++]=d;let ve=le.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ie=K.buffer,Le=K.position;return K.sub_type===pt.SUBTYPE_BYTE_ARRAY&&(Le=Le+4),m[M++]=Le&255,m[M++]=Le>>8&255,m[M++]=Le>>16&255,m[M++]=Le>>24&255,m[M++]=K.sub_type,K.sub_type===pt.SUBTYPE_BYTE_ARRAY&&(Le=Le-4,m[M++]=Le&255,m[M++]=Le>>8&255,m[M++]=Le>>16&255,m[M++]=Le>>24&255),m.set(Ie,M),M=M+K.position,M}function ag(m,N,K,M){m[M++]=I;let ve=le.encodeUTF8Into(m,N,M);M=M+ve,m[M++]=0;let Ie=le.encodeUTF8Into(m,K.value,M+4)+1;return m[M]=Ie&255,m[M+1]=Ie>>8&255,m[M+2]=Ie>>16&255,m[M+3]=Ie>>24&255,M=M+4+Ie-1,m[M++]=0,M}function og(m,N,K,M,ve,Ie,Le){m[M++]=f;let rt=le.encodeUTF8Into(m,N,M);M=M+rt,m[M++]=0;let be=M,Qe={$ref:K.collection||K.namespace,$id:K.oid};K.db!=null&&(Qe.$db=K.db),Qe=Object.assign(Qe,K.fields);let Be=Wc(m,Qe,!1,M,ve+1,Ie,!0,Le),Fe=Be-be;return m[be++]=Fe&255,m[be++]=Fe>>8&255,m[be++]=Fe>>16&255,m[be++]=Fe>>24&255,Be}function Wc(m,N,K,M,ve,Ie,Le,rt){if(rt==null){if(N==null)return m[0]=5,m[1]=0,m[2]=0,m[3]=0,m[4]=0,5;if(Array.isArray(N))throw new F("serialize does not support an array as the root input");if(typeof N!="object")throw new F("serialize does not support non-object as the root input");if("_bsontype"in N&&typeof N._bsontype=="string")throw new F("BSON types cannot be serialized as a document");if(kt(N)||Xe(N)||Ce(N)||Ne(N))throw new F("date, regexp, typedarray, and arraybuffer cannot be BSON documents");rt=new Set}rt.add(N);let be=M+4;if(Array.isArray(N))for(let Be=0;Be<N.length;Be++){let Fe=`${Be}`,Ue=N[Be];if(typeof Ue?.toBSON=="function"&&(Ue=Ue.toBSON()),typeof Ue=="string")be=Gh(m,Fe,Ue,be);else if(typeof Ue=="number")be=Kh(m,Fe,Ue,be);else if(typeof Ue=="bigint")be=Yh(m,Fe,Ue,be);else if(typeof Ue=="boolean")be=Xh(m,Fe,Ue,be);else if(Ue instanceof Date||kt(Ue))be=Zh(m,Fe,Ue,be);else if(Ue===void 0)be=Vc(m,Fe,Ue,be);else if(Ue===null)be=Vc(m,Fe,Ue,be);else if(Ce(Ue))be=rg(m,Fe,Ue,be);else if(Ue instanceof RegExp||Xe(Ue))be=Qh(m,Fe,Ue,be);else if(typeof Ue=="object"&&Ue._bsontype==null)be=Bf(m,Fe,Ue,be,K,ve,Ie,Le,rt);else{if(typeof Ue=="object"&&Ue[Symbol.for("@@mdb.bson.version")]!==t)throw new H;if(Ue._bsontype==="ObjectId")be=tg(m,Fe,Ue,be);else if(Ue._bsontype==="Decimal128")be=Mf(m,Fe,Ue,be);else if(Ue._bsontype==="Long"||Ue._bsontype==="Timestamp")be=ng(m,Fe,Ue,be);else if(Ue._bsontype==="Double")be=Rf(m,Fe,Ue,be);else if(typeof Ue=="function"&&Ie)be=$f(m,Fe,Ue,be);else if(Ue._bsontype==="Code")be=ig(m,Fe,Ue,be,K,ve,Ie,Le,rt);else if(Ue._bsontype==="Binary")be=sg(m,Fe,Ue,be);else if(Ue._bsontype==="BSONSymbol")be=ag(m,Fe,Ue,be);else if(Ue._bsontype==="DBRef")be=og(m,Fe,Ue,be,ve,Ie,rt);else if(Ue._bsontype==="BSONRegExp")be=eg(m,Fe,Ue,be);else if(Ue._bsontype==="Int32")be=Hc(m,Fe,Ue,be);else if(Ue._bsontype==="MinKey"||Ue._bsontype==="MaxKey")be=fr(m,Fe,Ue,be);else if(typeof Ue._bsontype<"u")throw new F(`Unrecognized or invalid _bsontype: ${String(Ue._bsontype)}`)}}else if(N instanceof Map||Ze(N)){let Be=N.entries(),Fe=!1;for(;!Fe;){let Ue=Be.next();if(Fe=!!Ue.done,Fe)continue;let ut=Ue.value[0],Ge=Ue.value[1];typeof Ge?.toBSON=="function"&&(Ge=Ge.toBSON());let pn=typeof Ge;if(typeof ut=="string"&&!wv.has(ut)){if(ut.match(Df)!=null)throw new F("key "+ut+" must not contain null bytes");if(K){if(ut[0]==="$")throw new F("key "+ut+" must not start with '$'");if(~ut.indexOf("."))throw new F("key "+ut+" must not contain '.'")}}if(pn==="string")be=Gh(m,ut,Ge,be);else if(pn==="number")be=Kh(m,ut,Ge,be);else if(pn==="bigint")be=Yh(m,ut,Ge,be);else if(pn==="boolean")be=Xh(m,ut,Ge,be);else if(Ge instanceof Date||kt(Ge))be=Zh(m,ut,Ge,be);else if(Ge===null||Ge===void 0&&Le===!1)be=Vc(m,ut,Ge,be);else if(Ce(Ge))be=rg(m,ut,Ge,be);else if(Ge instanceof RegExp||Xe(Ge))be=Qh(m,ut,Ge,be);else if(pn==="object"&&Ge._bsontype==null)be=Bf(m,ut,Ge,be,K,ve,Ie,Le,rt);else{if(typeof Ge=="object"&&Ge[Symbol.for("@@mdb.bson.version")]!==t)throw new H;if(Ge._bsontype==="ObjectId")be=tg(m,ut,Ge,be);else if(pn==="object"&&Ge._bsontype==="Decimal128")be=Mf(m,ut,Ge,be);else if(Ge._bsontype==="Long"||Ge._bsontype==="Timestamp")be=ng(m,ut,Ge,be);else if(Ge._bsontype==="Double")be=Rf(m,ut,Ge,be);else if(Ge._bsontype==="Code")be=ig(m,ut,Ge,be,K,ve,Ie,Le,rt);else if(typeof Ge=="function"&&Ie)be=$f(m,ut,Ge,be);else if(Ge._bsontype==="Binary")be=sg(m,ut,Ge,be);else if(Ge._bsontype==="BSONSymbol")be=ag(m,ut,Ge,be);else if(Ge._bsontype==="DBRef")be=og(m,ut,Ge,be,ve,Ie,rt);else if(Ge._bsontype==="BSONRegExp")be=eg(m,ut,Ge,be);else if(Ge._bsontype==="Int32")be=Hc(m,ut,Ge,be);else if(Ge._bsontype==="MinKey"||Ge._bsontype==="MaxKey")be=fr(m,ut,Ge,be);else if(typeof Ge._bsontype<"u")throw new F(`Unrecognized or invalid _bsontype: ${String(Ge._bsontype)}`)}}}else{if(typeof N?.toBSON=="function"&&(N=N.toBSON(),N!=null&&typeof N!="object"))throw new F("toBSON function did not return an object");for(let Be of Object.keys(N)){let Fe=N[Be];typeof Fe?.toBSON=="function"&&(Fe=Fe.toBSON());let Ue=typeof Fe;if(typeof Be=="string"&&!wv.has(Be)){if(Be.match(Df)!=null)throw new F("key "+Be+" must not contain null bytes");if(K){if(Be[0]==="$")throw new F("key "+Be+" must not start with '$'");if(~Be.indexOf("."))throw new F("key "+Be+" must not contain '.'")}}if(Ue==="string")be=Gh(m,Be,Fe,be);else if(Ue==="number")be=Kh(m,Be,Fe,be);else if(Ue==="bigint")be=Yh(m,Be,Fe,be);else if(Ue==="boolean")be=Xh(m,Be,Fe,be);else if(Fe instanceof Date||kt(Fe))be=Zh(m,Be,Fe,be);else if(Fe===void 0)Le===!1&&(be=Vc(m,Be,Fe,be));else if(Fe===null)be=Vc(m,Be,Fe,be);else if(Ce(Fe))be=rg(m,Be,Fe,be);else if(Fe instanceof RegExp||Xe(Fe))be=Qh(m,Be,Fe,be);else if(Ue==="object"&&Fe._bsontype==null)be=Bf(m,Be,Fe,be,K,ve,Ie,Le,rt);else{if(typeof Fe=="object"&&Fe[Symbol.for("@@mdb.bson.version")]!==t)throw new H;if(Fe._bsontype==="ObjectId")be=tg(m,Be,Fe,be);else if(Ue==="object"&&Fe._bsontype==="Decimal128")be=Mf(m,Be,Fe,be);else if(Fe._bsontype==="Long"||Fe._bsontype==="Timestamp")be=ng(m,Be,Fe,be);else if(Fe._bsontype==="Double")be=Rf(m,Be,Fe,be);else if(Fe._bsontype==="Code")be=ig(m,Be,Fe,be,K,ve,Ie,Le,rt);else if(typeof Fe=="function"&&Ie)be=$f(m,Be,Fe,be);else if(Fe._bsontype==="Binary")be=sg(m,Be,Fe,be);else if(Fe._bsontype==="BSONSymbol")be=ag(m,Be,Fe,be);else if(Fe._bsontype==="DBRef")be=og(m,Be,Fe,be,ve,Ie,rt);else if(Fe._bsontype==="BSONRegExp")be=eg(m,Be,Fe,be);else if(Fe._bsontype==="Int32")be=Hc(m,Be,Fe,be);else if(Fe._bsontype==="MinKey"||Fe._bsontype==="MaxKey")be=fr(m,Be,Fe,be);else if(typeof Fe._bsontype<"u")throw new F(`Unrecognized or invalid _bsontype: ${String(Fe._bsontype)}`)}}}rt.delete(N),m[be++]=0;let Qe=be-M;return m[M++]=Qe&255,m[M++]=Qe>>8&255,m[M++]=Qe>>16&255,m[M++]=Qe>>24&255,be}function Vx(m){return m!=null&&typeof m=="object"&&"_bsontype"in m&&typeof m._bsontype=="string"}var Hx={$oid:Ct,$binary:pt,$uuid:pt,$symbol:mo,$numberInt:qr,$numberDecimal:Et,$numberDouble:kr,$numberLong:he,$minKey:is,$maxKey:Nr,$regex:Bi,$regularExpression:Bi,$timestamp:Mi};function Sv(m,N={}){if(typeof m=="number"){let M=m<=r&&m>=n,ve=m<=i&&m>=s;if(N.relaxed||N.legacy)return m;if(Number.isInteger(m)&&!Object.is(m,-0)){if(M)return new qr(m);if(ve)return N.useBigInt64?BigInt(m):he.fromNumber(m)}return new kr(m)}if(m==null||typeof m!="object")return m;if(m.$undefined)return null;let K=Object.keys(m).filter(M=>M.startsWith("$")&&m[M]!=null);for(let M=0;M<K.length;M++){let ve=Hx[K[M]];if(ve)return ve.fromExtendedJSON(m,N)}if(m.$date!=null){let M=m.$date,ve=new Date;if(N.legacy)if(typeof M=="number")ve.setTime(M);else if(typeof M=="string")ve.setTime(Date.parse(M));else if(typeof M=="bigint")ve.setTime(Number(M));else throw new Q(`Unrecognized type for EJSON date: ${typeof M}`);else if(typeof M=="string")ve.setTime(Date.parse(M));else if(he.isLong(M))ve.setTime(M.toNumber());else if(typeof M=="number"&&N.relaxed)ve.setTime(M);else if(typeof M=="bigint")ve.setTime(Number(M));else throw new Q(`Unrecognized type for EJSON date: ${typeof M}`);return ve}if(m.$code!=null){let M=Object.assign({},m);return m.$scope&&(M.$scope=Sv(m.$scope)),B.fromExtendedJSON(m)}if(re(m)||m.$dbPointer){let M=m.$ref?m:m.$dbPointer;if(M instanceof ke)return M;let ve=Object.keys(M).filter(Le=>Le.startsWith("$")),Ie=!0;if(ve.forEach(Le=>{["$ref","$id","$db"].indexOf(Le)===-1&&(Ie=!1)}),Ie)return ke.fromExtendedJSON(M)}return m}function Wx(m,N){return m.map((K,M)=>{N.seenObjects.push({propertyName:`index ${M}`,obj:null});try{return ea(K,N)}finally{N.seenObjects.pop()}})}function xv(m){let N=m.toISOString();return m.getUTCMilliseconds()!==0?N:N.slice(0,-5)+"Z"}function ea(m,N){if(m instanceof Map||Ze(m)){let K=Object.create(null);for(let[M,ve]of m){if(typeof M!="string")throw new F("Can only serialize maps with string keys");K[M]=ve}return ea(K,N)}if((typeof m=="object"||typeof m=="function")&&m!==null){let K=N.seenObjects.findIndex(M=>M.obj===m);if(K!==-1){let M=N.seenObjects.map(Be=>Be.propertyName),ve=M.slice(0,K).map(Be=>`${Be} -> `).join(""),Ie=M[K],Le=" -> "+M.slice(K+1,M.length-1).map(Be=>`${Be} -> `).join(""),rt=M[M.length-1],be=" ".repeat(ve.length+Ie.length/2),Qe="-".repeat(Le.length+(Ie.length+rt.length)/2-1);throw new F(`Converting circular structure to EJSON:
    ${ve}${Ie}${Le}${rt}
    ${be}\\${Qe}/`)}N.seenObjects[N.seenObjects.length-1].obj=m}if(Array.isArray(m))return Wx(m,N);if(m===void 0)return null;if(m instanceof Date||kt(m)){let K=m.getTime(),M=K>-1&&K<2534023188e5;return N.legacy?N.relaxed&&M?{$date:m.getTime()}:{$date:xv(m)}:N.relaxed&&M?{$date:xv(m)}:{$date:{$numberLong:m.getTime().toString()}}}if(typeof m=="number"&&(!N.relaxed||!isFinite(m))){if(Number.isInteger(m)&&!Object.is(m,-0)){if(m>=n&&m<=r)return{$numberInt:m.toString()};if(m>=s&&m<=i)return{$numberLong:m.toString()}}return{$numberDouble:Object.is(m,-0)?"-0.0":m.toString()}}if(typeof m=="bigint")return N.relaxed?Number(BigInt.asIntN(64,m)):{$numberLong:BigInt.asIntN(64,m).toString()};if(m instanceof RegExp||Xe(m)){let K=m.flags;if(K===void 0){let ve=m.toString().match(/[gimuy]*$/);ve&&(K=ve[0])}return new Bi(m.source,K).toExtendedJSON(N)}return m!=null&&typeof m=="object"?Jx(m,N):m}var kv={Binary:m=>new pt(m.value(),m.sub_type),Code:m=>new B(m.code,m.scope),DBRef:m=>new ke(m.collection||m.namespace,m.oid,m.db,m.fields),Decimal128:m=>new Et(m.bytes),Double:m=>new kr(m.value),Int32:m=>new qr(m.value),Long:m=>he.fromBits(m.low!=null?m.low:m.low_,m.low!=null?m.high:m.high_,m.low!=null?m.unsigned:m.unsigned_),MaxKey:()=>new Nr,MinKey:()=>new is,ObjectId:m=>new Ct(m),BSONRegExp:m=>new Bi(m.pattern,m.options),BSONSymbol:m=>new mo(m.value),Timestamp:m=>Mi.fromBits(m.low,m.high)};function Jx(m,N){if(m==null||typeof m!="object")throw new F("not an object instance");let K=m._bsontype;if(typeof K>"u"){let M={};for(let ve of Object.keys(m)){N.seenObjects.push({propertyName:ve,obj:null});try{let Ie=ea(m[ve],N);ve==="__proto__"?Object.defineProperty(M,ve,{value:Ie,writable:!0,enumerable:!0,configurable:!0}):M[ve]=Ie}finally{N.seenObjects.pop()}}return M}else{if(m!=null&&typeof m=="object"&&typeof m._bsontype=="string"&&m[Symbol.for("@@mdb.bson.version")]!==t)throw new H;if(Vx(m)){let M=m;if(typeof M.toExtendedJSON!="function"){let ve=kv[m._bsontype];if(!ve)throw new F("Unrecognized or invalid _bsontype: "+m._bsontype);M=ve(M)}return K==="Code"&&M.scope?M=new B(M.code,ea(M.scope,N)):K==="DBRef"&&M.oid&&(M=new ke(ea(M.collection,N),ea(M.oid,N),ea(M.db,N),ea(M.fields,N))),M.toExtendedJSON(N)}else throw new F("_bsontype must be a string, but was: "+typeof K)}}function Ev(m,N){let K={useBigInt64:N?.useBigInt64??!1,relaxed:N?.relaxed??!0,legacy:N?.legacy??!1};return JSON.parse(m,(M,ve)=>{if(M.indexOf("\0")!==-1)throw new F(`BSON Document field names cannot contain null bytes, found: ${JSON.stringify(M)}`);return Sv(ve,K)})}function Ov(m,N,K,M){K!=null&&typeof K=="object"&&(M=K,K=0),N!=null&&typeof N=="object"&&!Array.isArray(N)&&(M=N,N=void 0,K=0);let ve=Object.assign({relaxed:!0,legacy:!1},M,{seenObjects:[{propertyName:"(root)",obj:null}]}),Ie=ea(m,ve);return JSON.stringify(Ie,N,K)}function Gx(m,N){return N=N||{},JSON.parse(Ov(m,N))}function Av(m,N){return N=N||{},Ev(JSON.stringify(m),N)}var Pa=Object.create(null);Pa.parse=Ev,Pa.stringify=Ov,Pa.serialize=Gx,Pa.deserialize=Av,Object.freeze(Pa);var lg=1024*1024*17,Es=le.allocate(lg);function Tv(m){Es.length<m&&(Es=le.allocate(m))}function Cv(m,N={}){let K=typeof N.checkKeys=="boolean"?N.checkKeys:!1,M=typeof N.serializeFunctions=="boolean"?N.serializeFunctions:!1,ve=typeof N.ignoreUndefined=="boolean"?N.ignoreUndefined:!0,Ie=typeof N.minInternalBufferSize=="number"?N.minInternalBufferSize:lg;Es.length<Ie&&(Es=le.allocate(Ie));let Le=Wc(Es,m,K,0,0,M,ve,null),rt=le.allocate(Le);return rt.set(Es.subarray(0,Le),0),rt}function cg(m,N,K={}){let M=typeof K.checkKeys=="boolean"?K.checkKeys:!1,ve=typeof K.serializeFunctions=="boolean"?K.serializeFunctions:!1,Ie=typeof K.ignoreUndefined=="boolean"?K.ignoreUndefined:!0,Le=typeof K.index=="number"?K.index:0,rt=Wc(Es,m,M,0,0,ve,Ie,null);return N.set(Es.subarray(0,rt),Le),Le+rt-1}function Iv(m,N={}){return _v(le.toLocalBufferType(m),N)}function ug(m,N={}){N=N||{};let K=typeof N.serializeFunctions=="boolean"?N.serializeFunctions:!1,M=typeof N.ignoreUndefined=="boolean"?N.ignoreUndefined:!0;return ei(m,K,M)}function Nv(m,N,K,M,ve,Ie){let Le=Object.assign({allowObjectSmallerThanBufferSize:!0,index:0},Ie),rt=le.toLocalBufferType(m),be=N;for(let Qe=0;Qe<K;Qe++){let Be=rt[be]|rt[be+1]<<8|rt[be+2]<<16|rt[be+3]<<24;Le.index=be,M[ve+Qe]=_v(rt,Le),be=be+Be}return be}var Kx=Object.freeze({__proto__:null,Code:B,BSONSymbol:mo,DBRef:ke,Binary:pt,ObjectId:Ct,UUID:j,Long:he,Timestamp:Mi,Double:kr,Int32:qr,MinKey:is,MaxKey:Nr,BSONRegExp:Bi,Decimal128:Et,setInternalBufferSize:Tv,serialize:Cv,serializeWithBufferAndIndex:cg,deserialize:Iv,calculateObjectSize:ug,deserializeStream:Nv,BSONValue:St,BSONError:F,BSONVersionError:H,BSONRuntimeError:Q,BSONType:de,EJSON:Pa});e.BSON=Kx,e.BSONError=F,e.BSONRegExp=Bi,e.BSONRuntimeError=Q,e.BSONSymbol=mo,e.BSONType=de,e.BSONValue=St,e.BSONVersionError=H,e.Binary=pt,e.Code=B,e.DBRef=ke,e.Decimal128=Et,e.Double=kr,e.EJSON=Pa,e.Int32=qr,e.Long=he,e.MaxKey=Nr,e.MinKey=is,e.ObjectId=Ct,e.Timestamp=Mi,e.UUID=j,e.calculateObjectSize=ug,e.deserialize=Iv,e.deserializeStream=Nv,e.serialize=Cv,e.serializeWithBufferAndIndex=cg,e.setInternalBufferSize=Tv}}),qQ={};CPe(qQ,{AuthorizationStruct:()=>XQ,ChatroomStruct:()=>tee,CoherenceMap:()=>oF,CoherenceStruct:()=>aF,CommentStruct:()=>ree,Data:()=>FPe,DataStruct:()=>QQ,DateStruct:()=>see,ECGStruct:()=>cF,EDAStruct:()=>WQ,EEGCoordinates:()=>LPe,EEGStruct:()=>zc,EMGStruct:()=>KQ,EventStruct:()=>eee,EyeTrackerStruct:()=>HQ,FNIRSStruct:()=>lF,FrequencyBandsStruct:()=>Sx,GroupStruct:()=>ZQ,HRVStruct:()=>GQ,IMUStruct:()=>VQ,NotificationStruct:()=>nee,PPGStruct:()=>JQ,ProfileStruct:()=>YQ,ScheduleStruct:()=>iee,Struct:()=>$n,eegCoordinates:()=>Cf,setCoordinate:()=>wx,structRegistry:()=>DPe});function $n(e="struct",t={},r={_id:""},n={structType:"struct",_id:""}){function i(a=""){return`${a+Math.floor(Math.random()+Math.random()*Math.random()*1e16)}`}let s={_id:i(e+"defaultId"),structType:e,ownerId:r?._id,timestamp:Date.now(),parent:{structType:n?.structType,_id:n?._id}};return s.ownerId||delete s.ownerId,s?.parent?._id||delete s.parent,Object.keys(t).length>0&&Object.assign(s,t),s}var Cf={FP1:[-21.2,66.9,12.1],FPZ:[1.4,65.1,11.3],FP2:[24.3,66.3,12.5],AF7:[-41.7,52.8,11.3],AF3:[-32.7,48.4,32.8],AFZ:[1.8,54.8,37.9],AF4:[35.1,50.1,31.1],AF8:[43.9,52.7,9.3],F5:[-51.4,26.7,24.7],F3:[-39.7,25.3,44.7],F1:[-22.1,26.8,54.9],FZ:[0,26.8,60.6],F2:[23.6,28.2,55.6],F4:[41.9,27.5,43.9],F6:[52.9,28.7,25.2],F7:[-52.1,28.6,3.8],F8:[53.2,28.4,3.1],FC5:[-59.1,3,26.1],FC3:[-45.5,2.4,51.3],FC1:[-24.7,.3,66.4],FCZ:[1,1,72.8],FC2:[26.1,3.2,66],FC4:[47.5,4.6,49.7],FC6:[60.5,4.9,25.5],FT9:[-53.8,-2.1,-29.1],FT7:[-59.2,3.4,-2.1],FT8:[60.2,4.7,-2.8],FT10:[55,-3.6,-31],T7:[-65.8,-17.8,-2.9],T5:[-61.5,-65.3,1.1],T3:[-70.2,-21.3,-10.7],T4:[71.9,-25.2,-8.2],T6:[59.3,-67.6,3.8],T8:[67.4,-18.5,-3.4],C5:[-63.6,-18.9,25.8],C3:[-49.1,-20.7,53.2],C1:[-25.1,-22.5,70.1],CZ:[.8,-21.9,77.4],C2:[26.7,-20.9,69.5],C4:[50.3,-18.8,53],C6:[65.2,-18,26.4],CP5:[-61.8,-46.2,22.5],CP3:[-46.9,-47.7,49.7],CP1:[-24,-49.1,66.1],CPZ:[.7,-47.9,72.6],CP2:[25.8,-47.1,66],CP4:[49.5,-45.5,50.7],CP6:[62.9,-44.6,24.4],TP9:[-73.6,-46.7,-4],TP7:[-63.6,-44.7,-4],TP8:[64.6,-45.4,-3.7],TP10:[74.6,-47.4,-3.7],P9:[-50.8,-51.3,-37.7],P7:[-55.9,-64.8,0],P5:[-52.7,-67.1,19.9],P3:[-41.4,-67.8,42.4],P1:[-21.6,-71.3,52.6],PZ:[.7,-69.3,56.9],P2:[24.4,-69.9,53.5],P4:[44.2,-65.8,42.7],P6:[54.4,-65.3,20.2],P8:[56.4,-64.4,.1],P10:[51,-53.9,-36.5],PO7:[-44,-81.7,1.6],PO3:[-33.3,-84.3,26.5],POZ:[0,-87.9,33.5],PO4:[35.2,-82.6,26.1],PO8:[43.3,-82,.7],O1:[-25.8,-93.3,7.7],OZ:[.3,-97.1,8.7],O2:[25,-95.2,6.2]};function wx(e,t={}){if(!Cf[e.tag]&&e.position&&(Cf[e.tag]=[e.position.x,e.position.y,e.position.z]),Cf[e.tag]){let r={channel:"",position:{x:Cf[e.tag][0],y:Cf[e.tag][1],z:Cf[e.tag][2]}};return Object.assign(t,r)}else return Object.assign(t,e)}function LPe(e=[],t=!0){let r=[];for(let n of e){let i=zc(n);r.push(i)}return t&&r.push(...oF({channelDicts:e})),r}function Sx(e=[],t={}){let r={scp:[],delta:[],theta:[],alpha1:[],alpha2:[],beta:[],lowgamma:[],highgamma:[]};return e.forEach(n=>r[n]=[]),Object.assign(t,r)}function zc(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i=Sx(),s={tag:e,position:{x:0,y:0,z:0},count:0,times:[],raw:[],filtered:[],fftCount:0,fftTimes:[],ffts:[],slices:JSON.parse(JSON.stringify(i)),means:JSON.parse(JSON.stringify(i)),startTime:Date.now()},a=$n("eeg",s,r,n);return e&&wx(s,a),Object.assign(a,t)}function aF(e={0:zc("FP1"),1:zc("FP2")},t={},r={_id:""},n={structType:"struct",_id:""}){let i=Sx(),s={tag:e[0]?.tag+"::"+e[1]?.tag,x0:e[0]?.position?.x,y0:e[0]?.position?.y,z0:e[0]?.position?.z,x1:e[1]?.position?.x,y1:e[1]?.position?.y,z1:e[1]?.position?.z,fftCount:0,fftTimes:[],ffts:[],slices:JSON.parse(JSON.stringify(i)),means:JSON.parse(JSON.stringify(i)),startTime:Date.now()},a=$n("coherence",s,r,n);return Object.assign(a,t)}function oF(e={channelDicts:[{ch:0,tag:"FP1",analyze:!1},{ch:1,tag:"FP2",analyze:!1}],taggedOnly:!0},t={},r={_id:""},n={structType:"struct",_id:""}){for(var i=[],s=1,a=0,o=0;o<e.channelDicts.length*(e.channelDicts.length+1)/2-e.channelDicts.length;o++){if(e.taggedOnly===!1||e.taggedOnly===!0&&e.channelDicts[a].tag!==null&&e.channelDicts[a+s].tag!==null&&e.channelDicts[a].tag!=="other"&&e.channelDicts[a+s].tag!=="other"&&e.channelDicts[a].analyze===!0&&e.channelDicts[a+s].analyze===!0){var l=zc(e.channelDicts[a].tag),c=zc(e.channelDicts[a+s].tag);i.push(aF({0:l,1:c},{},r,n))}s++,s+a===e.channelDicts.length&&(a++,s=1)}return i}function lF(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,position:{x:0,y:0,z:0},count:0,times:[],red:[],ir:[],ir2:[],ambient:[],ratio:[],temp:[],beat_detect:{beats:[],breaths:[],rir:[],rir2:[],drir_dt:[],localmins:[],localmaxs:[],val_dists:[],peak_dists:[],localmins2:[],localmaxs2:[],val_dists2:[],peak_dists2:[]},startTime:Date.now()},s=$n("fnirs",i,r,n);return e&&wx(i,s),Object.assign(s,t)}function VQ(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,Ax:[],Ay:[],Az:[],Gx:[],Gy:[],Gz:[],startTime:Date.now()},s=$n("imu",i,r,n);return e&&wx(i,s),Object.assign(s,t)}function HQ(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,count:0,times:[],x:[],y:[],smax:[],smay:[],startTime:Date.now()},s=$n("eyetracker",i,r,n);return Object.assign(s,t)}function cF(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,count:0,times:[],raw:[],filtered:[],bpm:[],hrv:[],startTime:Date.now()},s=$n("ecg",i,r,n);return Object.assign(s,t)}function WQ(e="",t={},r={_id:""},n={structType:"struct",_id:""}){}function JQ(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i=lF(e,r,n,t);return i.structType="ppg",i}function GQ(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i=cF(e,r,n,t);return i.structType="hrv",i}function KQ(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i=zc(e,r,n,t);return i.structType="emg",i}function YQ(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let s=$n("profile",{tag:e,name:"",username:"",firstName:"",lastName:"",email:"",phone:"",sex:"",birthday:"",type:"",pictureUrl:"",userRoles:{},socials:{},data:{},hidden:!1,accessToken:"",refreshToken:""},r,n);return Object.assign(s,t)}function XQ(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let s=$n("authorization",{tag:e,authorizedId:"",authorizedName:"",authorizerId:"",authorizerName:"",authorizations:{},structs:{},excluded:{},groups:{},status:"PENDING",expires:!1,associatedAuthId:""},r,n);return Object.assign(s,t)}function ZQ(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let s=$n("group",{tag:e,name:"",details:"",admins:{},peers:{},clients:{},users:{}},r,n);return Object.assign(s,t)}function FPe(e,t){return{type:e,data:t,timestamp:Date.now()}}function QQ(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,title:"",author:"",expires:!1,type:"",data:new Array},s=$n("data",i,r,n);return Object.assign(s,t)}function eee(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,event:"",author:"",startTime:"",endTime:"",grade:void 0,value:void 0,units:void 0,location:void 0,notes:"",attachments:new Array,users:{}},s=$n("event",i,r,n);return Object.assign(s,t)}function tee(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,message:"",topic:"",author:"",attachments:new Array,comments:new Array,replies:new Array,users:{},audioChatActive:!1,videoChatActive:!1},s=$n("chatroom",i,r,n);return Object.assign(s,t)}function ree(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,author:"",replyTo:"",message:"",rating:0,replies:new Array,users:{},attachments:new Array},s=$n("comment",i,r,n);return Object.assign(s,t)}function nee(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let s=$n("notification",{tag:e,note:"",parentUserId:""},r,n);return Object.assign(s,t)}function iee(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,title:"",author:"",attachments:new Array,dates:new Array},s=$n("schedule",i,r,n);return Object.assign(s,t)}function see(e="",t={},r={_id:""},n={structType:"struct",_id:""}){let i={tag:e,timeSet:"",notes:"",recurs:"NEVER",attachments:new Array},s=$n("date",i,r,n);return Object.assign(s,t)}var DPe={Struct:$n,EEGStruct:zc,FNIRSStruct:lF,CoherenceStruct:aF,CoherenceMap:oF,FrequencyBandsStruct:Sx,IMUStruct:VQ,EyeTrackerStruct:HQ,ECGStruct:cF,EDAStruct:WQ,PPGStruct:JQ,HRVStruct:GQ,EMGStruct:KQ,ProfileStruct:YQ,AuthorizationStruct:XQ,GroupStruct:ZQ,DataStruct:QQ,EventStruct:eee,ChatroomStruct:tee,CommentStruct:ree,NotificationStruct:nee,ScheduleStruct:iee,DateStruct:see};var jPe=class{data={};triggers={};ctr=0;constructor(e){typeof e=="object"&&(this.data=e)}setState=e=>{Object.assign(this.data,e);let t=Object.getOwnPropertyNames(e);for(let r of t)this.triggerEvent(r,this.data[r]);if(this.triggers[hv]){let r=i=>{i(e)},n=this.triggers[hv].length;for(let i=n-1;i>=0;i--)r(this.triggers[hv][i].onchange)}return this.data};setValue=(e,t)=>{this.data[e]=t,this.triggerEvent(e,t)};triggerEvent=(e,t)=>{if(this.triggers[e]){let r=i=>{i.onchange(t)},n=this.triggers[e].length;for(let i=n-1;i>=0;i--)r(this.triggers[e][i])}};subscribeState=e=>this.subscribeEvent(hv,e);unsubscribeState=e=>this.unsubscribeEvent(hv,e);subscribeEvent=(e,t,r,n)=>{if(e){r&&n&&!this.triggers[e]&&Object.defineProperty(this.data,e,{get:()=>r[n],set:s=>{r[n]=s},enumerable:!0,configurable:!0}),this.triggers[e]||(this.triggers[e]=[]);let i=this.ctr;return this.ctr++,this.triggers[e].push({sub:i,onchange:t}),i}else return};unsubscribeEvent=(e,t)=>{let r=this.triggers[e];if(r)if(t===void 0)delete this.triggers[e],delete this.data[e];else{let n,i=r.find((s,a)=>{if(s.sub===t)return n=a,!0});return i&&r.splice(n,1),Object.keys(r).length===0&&(delete this.triggers[e],delete this.data[e]),this.onRemoved&&this.onRemoved(i),!0}};subscribeEventOnce=(e,t)=>{let r,n=i=>{t(i),this.unsubscribeEvent(e,r)};return r=this.subscribeEvent(e,n),r};getEvent=(e,t)=>{for(let r in this.triggers[e])if(this.triggers[e][r].sub===t)return this.triggers[e][r]};getSnapshot=()=>{let e={};for(let t in this.data)e[t]=this.data[t]};onRemoved},hv="*s",mtt=new jPe;var btt=Object.getOwnPropertyNames(Object.getPrototypeOf({}));var vtt=NPe(PPe());var eF=qQ.ProfileStruct();for(let e in eF)e==="username"||e==="lastName"||e==="firstName"||e==="name"||e==="_id"||e==="pictureUrl"?eF[e]=1:delete eF[e];var At={collision:{setupEntities:function(e){for(let t in e){let r=e[t];r.components&&!r.components[this.__node.tag]||this.setupEntity(r)}return e},setupEntity:function(e){return"collisionEnabled"in e||(e.collisionEnabled=!0),e.collisionType||(e.collisionType="sphere"),e.collisionRadius||(e.collisionRadius=1),e.collisionBoundsScale||(e.collisionBoundsScale={x:1,y:1,z:1}),e.colliding||(e.colliding={}),e.position||(e.position={x:0,y:0,z:0}),e},__node:{tag:"collision"},__operator:function(e){let t=this.entityKeys;for(let r=0;r<t.length;r++){let n=e[t[r]];if(!(n.components&&(!n.components[this.__node.tag]||!n.collisionEnabled))&&n.collisionEnabled)for(let i=0;i<t.length;i++){if(r===i)continue;let s=e[t[i]];if(s.components&&!s.components[this.__node.tag]||!s.collisionEnabled)continue;let a=At.collision.collisionCheck(n,s);a!==!1&&(n.colliding||(n.colliding={}),s.colliding||(s.colliding={}),n.colliding[s.__node.tag]=a,s.colliding[n.__node.tag]=a)}}return e},collisionCheck:(e,t)=>{if(e.collisionEnabled===!1||t.collisionEnabled===!1)return!1;let r=At.collision.distance(e.position,t.position);if(r<Math.max(...Object.values(e.collisionBoundsScale))*e.collisionRadius+Math.max(...Object.values(t.collisionBoundsScale))*t.collisionRadius){let n=!1;if(e.collisionType==="sphere"?t.collisionType==="sphere"?n=At.collision.sphereCollisionCheck(e,t,r):t.collisionType==="box"?n=At.collision.sphereBoxCollisionCheck(e,t,r):t.collisionType==="point"&&(n=At.collision.isPointInsideSphere(t.position,e,r)):e.collisionType==="box"?t.collisionType==="sphere"?n=At.collision.sphereBoxCollisionCheck(t,e,r):t.collisionType==="box"?n=At.collision.boxCollisionCheck(e,t):t.collisionType==="point"&&(n=At.collision.isPointInsideBox(e.position,e)):e.collisionType==="point"&&(t.collisionType==="sphere"?n=At.collision.isPointInsideSphere(e.position,t,r):t.collisionType==="box"&&(n=At.collision.isPointInsideBox(e.position,t))),n)return r}return!1},sphereCollisionCheck:(e,t,r)=>(r===void 0&&(r=At.collision.distance(e.position,t.position)),r<e.collisionRadius+t.collisionRadius),boxCollisionCheck:(e,t)=>{let r=(e.position.x-e.collisionRadius)*e.collisionBoundsScale.x,n=(e.position.x+e.collisionRadius)*e.collisionBoundsScale.x,i=(e.position.y-e.collisionRadius)*e.collisionBoundsScale.y,s=(e.position.y+e.collisionRadius)*e.collisionBoundsScale.y,a=(e.position.z-e.collisionRadius)*e.collisionBoundsScale.z,o=(e.position.z+e.collisionRadius)*e.collisionBoundsScale.z,l=(t.position.x-t.collisionRadius)*e.collisionBoundsScale.x,c=(t.position.x+t.collisionRadius)*e.collisionBoundsScale.x,f=(t.position.y-t.collisionRadius)*e.collisionBoundsScale.y,u=(t.position.y+t.collisionRadius)*e.collisionBoundsScale.y,d=(t.position.z-t.collisionRadius)*e.collisionBoundsScale.z,p=(t.position.z+t.collisionRadius)*e.collisionBoundsScale.z;return(n<=c&&n>=l||r<=c&&r>=l)&&(s<=u&&s>=f||i<=u&&i>=f)&&(o<=p&&o>=d||a<=p&&a>=d)},sphereBoxCollisionCheck:(e,t,r)=>{let n=(t.position.x-t.collisionRadius)*t.collisionBoundsScale.x,i=(t.position.x+t.collisionRadius)*t.collisionBoundsScale.x,s=(t.position.y-t.collisionRadius)*t.collisionBoundsScale.y,a=(t.position.y+t.collisionRadius)*t.collisionBoundsScale.y,o=(t.position.z-t.collisionRadius)*t.collisionBoundsScale.z,l=(t.position.z+t.collisionRadius)*t.collisionBoundsScale.z,c={x:Math.max(n,Math.min(e.position.x,i)),y:Math.max(s,Math.min(e.position.y,a)),z:Math.max(o,Math.min(e.position.z,l))};return r===void 0&&(r=At.collision.distance(e.position,c)),r>e.collisionRadius},isPointInsideSphere:(e,t,r)=>(r===void 0&&(r=At.collision.distance(e,t.position)),r<t.collisionRadius),isPointInsideBox:(e,t)=>{let r=(t.position.x-t.collisionRadius)*t.collisionBoundsScale.x,n=(t.position.x+t.collisionRadius)*t.collisionBoundsScale.x,i=(t.position.y-t.collisionRadius)*t.collisionBoundsScale.x,s=(t.position.y+t.collisionRadius)*t.collisionBoundsScale.x,a=(t.position.z-t.collisionRadius)*t.collisionBoundsScale.x,o=(t.position.z+t.collisionRadius)*t.collisionBoundsScale.x;return e.x>=r&&e.x<=n&&e.y>=i&&e.y<=s&&e.z>=a&&e.z<=o},closestPointOnLine:(e,t,r)=>{let n={x:r.x-t.x,y:r.y-t.y,z:r.z-t.z},i={x:t.x-e.x,y:t.y-e.y,z:t.z-e.z},s={x:r.x-e.x,y:r.y-e.y,z:r.z-e.z},a=At.collision.dot(i,n);if(a<=0)return t;let o=At.collision.dot(s,n);if(o<=0)return r;let l=1/(a+o);return{x:t.x+(r.x-t.x)*a*l,y:t.y+(r.y-t.y)*a*l,z:t.z+(r.z-t.z)*a*l}},closestPointOnPolygon:(e,t,r,n)=>{let i=At.collision.calcNormal(t,r,n),s=At.collision.dot(e,i)-At.collision.dot(t,i),a=At.collision.vecadd(e,At.collision.vecscale(i,-s)),o=n[0]-t[0],l=n[1]-t[1],c=n[2]-t[2],f=r[0]-t[0],u=r[1]-t[1],d=r[2]-t[2],p=a[0]-t[0],_=a[1]-t[1],w=a[2]-t[2],k=o*o+l*l+c*c,S=o*f+l*u+c*d,O=o*p+l*_+c*w,A=f*f+u*u+d*d,C=f*p+u*_+d*w,I=k*A-S*S;if(Math.abs(I)<1e-30)return;let D=1/I,L=(A*O-S*C)*D,U=(k*C-S*O)*D;if(L>=0&&U>=0&&L+U<1)return a},calcNormal:(e,t,r,n=!0)=>{var i=At.collision.makeVec(e,t),s=At.collision.makeVec(e,r);return n===!0?At.collision.normalize(At.collision.cross3D(i,s)):At.collision.normalize(At.collision.cross3D(s,i))},dot:(e,t)=>{let r=0;for(let n in e)r+=e[n]*t[n];return r},makeVec(e,t){return{x:t.x-e.x,y:t.y-e.y,z:t.z-e.z}},vecadd:(e,t)=>{let r=Object.assign({},e);for(let n in r)r[n]+=t[n];return r},vecsub:(e,t)=>{let r=Object.assign({},e);for(let n in r)r[n]-=t[n];return r},vecmul:(e,t)=>{let r=Object.assign({},e);for(let n in r)r[n]*=t[n];return r},vecdiv:(e,t)=>{let r=Object.assign({},e);for(let n in r)r[n]/=t[n];return r},vecscale:(e,t)=>{let r=Object.assign({},e);for(let n in r)r[n]*=t;return r},distance:(e,t)=>{let r=0;for(let n in e)r+=Math.pow(e[n]-t[n],2);return Math.sqrt(r)},magnitude:e=>{let t=0;for(let r in e)t+=e[r]*e[r];return Math.sqrt(t)},normalize:e=>{let t=At.collision.magnitude(e),r=t?1/t:0,n={};for(let i in e)n[i]=e[i]*r;return n},distance3D(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)+(e.z-t.z)*(e.z-t.z))},cross3D(e,t){return{x:e.y*t.z-e.z*t.y,y:e.z*t.x-e.x*t.z,z:e.x*t.y-e.y*t.x}},nearestNeighborSearch(e,t=1e15){var r={};for(let a in e){let o={tag:a,position:void 0,neighbors:[]};o.position=e[a].position,r[a]=o}for(let a in r){for(let o in r){var n=At.collision.distance3D(r[a].position,r[o].position);if(n<t){var i={tag:o,position:e[o].position,dist:n};r[a].neighbors.push(i);var s={tag:o,position:e[a].position,dist:n};r[o].neighbors.push(s)}}r[a].neighbors.sort(function(o,l){return o.dist-l.dist})}return r},generateBoundingVolumeTree(e,t="octree",r=1e15,n=3){let i={proto:{parent:void 0,children:{},entities:{},collisionType:"box",collisionRadius:1,collisionBoundsScale:{x:1,y:1,z:1},position:{x:0,y:0,z:0}},tree:{}},s,a,o,l=0,c=0,f=0,u={},d=r;for(let k in e){let S=e[k],O=S.position.x+S.collisionRadius*S.collisionBoundsScale.x,A=S.position.y+S.collisionRadius*S.collisionBoundsScale.y,C=S.position.z+S.collisionRadius*S.collisionBoundsScale.z;s<O&&(s=O),l>O&&(l=O),a<A&&(a=A),c>A&&(c=A),o<C&&(o=C),f>C&&(f=C),d>S.collisionRadius&&(d=S.collisionRadius),u[k]=S.position}let p=JSON.parse(JSON.stringify(i.proto)),_={x:(s+l)*.5,y:(a+c)*.5,z:(o+f)*.5},w={x:s-_.x,y:a-_.y,z:o-_.z};if(p.position=_,p.collisionBoundsScale=w,p.entities=e,i.tree=p,d*=2,t==="octree"){let k=function(O,A){let C={x:O.x+A.x,y:O.y+A.y,z:O.z+A.z},I={x:O.x-A.x,y:O.y+A.y,z:O.z+A.z},D={x:O.x+A.x,y:O.y-A.y,z:O.z+A.z},L={x:O.x+A.x,y:O.y+A.y,z:O.z-A.z},U={x:O.x-A.x,y:O.y-A.y,z:O.z+A.z},te={x:O.x-A.x,y:O.y+A.y,z:O.z-A.z},V={x:O.x+A.x,y:O.y-A.y,z:O.z-A.z},X={x:O.x-A.x,y:O.y-A.y,z:O.z-A.z};return[C,I,D,L,U,te,V,X]},S=function(O){let A={x:O.collisionBoundsScale.x*.5,y:O.collisionBoundsScale.y*.5,z:O.collisionBoundsScale.z*.5},C=k(O.position,A),I=Object.assign({},O.bodies);for(let D=0;D<8;D++){let L=Object.assign(JSON.parse(JSON.stringify(i.proto)),{position:C[D],collisionBoundsScale:A});L.parent=O;for(let U in I)At.collision.collisionCheck(I[U],L)&&(L.entities[U]=I[U],delete I[U]);Object.keys(L.entities).length>n-1&&(O.children[D]=L,L.parent=O,Object.keys(L.entities).length>n&&L.collisionRadius*.5>d&&S(L))}};return S(p),p}else{let k=At.collision.nearestNeighborSearch(u,r),S=Object.keys(k),O=S[Math.floor(Math.random()*S.length)],A=!0,C=0,I=(L,U)=>{let te={},V={},X=Object.keys(L);for(;A&&C<X.length;){let Z=L[O],se=0,pe=0,de=u[Z.tag].x-U[Z.tag].collisionBoundsScale.x,F=u[Z.tag].y-U[Z.tag].collisionBoundsScale.y,H=u[Z.tag].z-U[Z.tag].collisionBoundsScale.z,Q=u[Z.tag].x+U[Z.tag].collisionBoundsScale.x,R=u[Z.tag].y+U[Z.tag].collisionBoundsScale.y,$=u[Z.tag].z+U[Z.tag].collisionBoundsScale.z,q=JSON.parse(JSON.stringify(i.proto));q.tag=`bound${Math.floor(Math.random()*1e15)}`,q.children[Z.tag]=U[Z.tag],q.bodies[Z.tag]=e[Z.tag],U[Z.tag].parent=q,V[Z.tag]=!0,se++,pe++;let ie=Object.keys(Z.neighbors);for(;se<ie.length&&pe<3;){if(V[Z.neighbors[se].tag]){se++;continue}let _e=u[Z.neighbors[se].tag].x-U[Z.neighbors[se].tag].collisionBoundsScale.x,Ee=u[Z.neighbors[se].tag].y-U[Z.neighbors[se].tag].collisionBoundsScale.y,Se=u[Z.neighbors[se].tag].z-U[Z.neighbors[se].tag].collisionBoundsScale.z,le=u[Z.neighbors[se].tag].x+U[Z.neighbors[se].tag].collisionBoundsScale.x,we=u[Z.neighbors[se].tag].y+U[Z.neighbors[se].tag].collisionBoundsScale.y,W=u[Z.neighbors[se].tag].z+U[Z.neighbors[se].tag].collisionBoundsScale.z;de>_e&&(de=_e),Q<le&&(Q=le),F>Ee&&(F=Ee),R<we&&(R=we),H>Se&&(H=Se),$<W&&($=W),q.children[Z.neighbors[se].tag]=U[Z.neighbors[se].tag],q.entities[Z.neighbors[se].tag]=e[Z.neighbors[se].tag],U[Z.neighbors[se].tag].parent=q,V[Z.neighbors[se].tag]=!0,se++,pe++}let oe={x:(Q+de)*.5,y:(R+F)*.5,z:($+H)*.5},fe={x:Q-oe.x,y:R-oe.y,z:$-oe.z};for(q.position=oe,q.collisionBoundsScale=fe,q.bodies.length===1&&(q=Z),te[q.tag]=q;se<Z.neighbors.length&&V[Z.neighbors[se].tag];)se++;se<Z.neighbors.length?O=Z.neighbors[se].tag:Object.keys(V).length<Object.keys(L).length?O=S[0]:A=!1,C++}return te},D=I(k,e);for(;Object.keys(D).length>2;){let L=At.collision.nearestNeighborSearch(D,r);D=I(L,D)}return p.children=D,p.children.forEach(L=>{L.parent=p}),p}}},collider:{lastTime:performance.now(),setupEntities:function(e){for(let t in e){let r=e[t];r.components&&!r.components[this.__node.tag]||this.setupEntity(r)}return e},setupEntity:function(e){return"collisionEnabled"in e||At.collision.setupEntity(e),"boundingBox"in e||(e.boundingBox={bot:0,top:100,left:0,right:100,front:0,back:100}),"position"in e||At.movement.setupEntity(e),"restitution"in e||(e.restitution=1),"useBoundingBox"in e||(e.useBoundingBox=!0),!e.position.x&&!e.position.y&&!e.position.z&&(e.position.x=Math.random()*e.boundingBox.right,e.position.y=Math.random()*e.boundingBox.back,e.position.z=Math.random()*e.boundingBox.top),e},__operator:function(e){let t=this.entityKeys;for(let r=0;r<t.length;r++){let n=e[t[r]];if(!(n.components&&(!n.components[this.__node.tag]||!n.collisionEnabled))&&(n.useBoundingBox&&this.checkBoundingBox(n),!!n.collisionEnabled&&n.colliding)){for(let i in n.colliding){let s=e[i];if(n.colliding[i]===!1){delete n.colliding[i],delete s.colliding[n.__node.tag];continue}s.collisionEnabled&&(s.collisionType==="box"?this.resolveBoxCollision(n,s,n.colliding[i]):n.collisionType==="box"?(n.fixed=!0,this.resolveSphereCollisions(n,s,n.colliding[i]),n.fixed=!1):(this.resolveSphereCollisions(n,s,n.colliding[i]),delete s.colliding[n.__node.tag]),delete n.colliding[s.__node.tag])}delete n.colliding}}return e},__node:{tag:"collider"},checkBoundingBox:e=>{let t=e.collisionRadius*e.collisionBoundsScale.x,r=e.collisionRadius*e.collisionBoundsScale.y,n=e.collisionRadius*e.collisionBoundsScale.z;e.position.y-r<=e.boundingBox.front&&(e.velocity.y*=-e.restitution,e.position.y=e.boundingBox.front+r),e.position.y+r>=e.boundingBox.back&&(e.velocity.y*=-e.restitution,e.position.y=e.boundingBox.back-r),e.position.x-t<=e.boundingBox.left&&(e.velocity.x*=-e.restitution,e.position.x=e.boundingBox.left+t),e.position.x+t>=e.boundingBox.right&&(e.velocity.x*=-e.restitution,e.position.x=e.boundingBox.right-t),e.position.z-n<=e.boundingBox.bot&&(e.velocity.z*=-e.restitution,e.position.z=e.boundingBox.bot+n),e.position.z+n>=e.boundingBox.top&&(e.velocity.z*=-e.restitution,e.position.z=e.boundingBox.top-n)},resolveBoxCollision:(e,t,r)=>{let n=At.collision.makeVec(e.position,t.position);var i=Object.values(n);let s,a=1/0,o=-1;i[l]<0&&(o=1),r&&(o=-o);for(let d in e.position){let p=Math.abs(t.position[d]-e.position[d]);p<a&&Math.abs(t.position[d]-e.position[d]+e.velocity[d]*1e-17)<p&&(s=d,a=p)}var l=i.indexOf(s);l===0&&(l="x"),l===1&&(l="y"),l===2&&(l="z"),l===3&&(l="w");let c=t.position[l]+t.collisionRadius*t.collisionBoundsScale[l]*o;if(r){let d=c-e.collisionRadius*e.collisionBoundsScale[l]*o;e.position[l]=d}else{let d=c+e.collisionRadius*e.collisionBoundsScale[l]*o;e.position[l]=d}e.velocity[l]=-e.velocity[l]*e.restitution,r&&(e.force[l]=-e.velocity[l]);var f=At.collision.magnitude(t.acceleration),u=At.collision.normalize(t.acceleration);e.force[l]=-u[l]*f*t.mass,r&&(e.force[l]=-e.force[l])},resolveSphereCollisions:(e,t,r)=>{r===void 0&&(r=At.collision.distance(e.position,t.position));let n=At.collision.normalize(At.collision.makeVec(e.position,t.position)),i=e.mass+t.mass,s=e.mass/i,a=1-s;e.fixed===!1?(e.position.x+=n.x*a*1.01,e.position.y+=n.y*a*1.01,e.position.z+=n.z*a*1.001):(t.position.x-=n.x*1.01,t.position.y-=n.y*1.01,t.position.z-=n.z*1.01),t.fixed===!1?(t.position.x+=n.x*s*1.01,t.position.y+=n.y*s*1.01,t.position.z+=n.z*s*1.01):(e.position.x+=n.x*1.01,e.position.y+=n.y*1.01,e.position.z+=n.z*1.01),r=At.collision.distance(e.position,t.position);let o={x:e.velocity.x-t.velocity.x,y:e.velocity.y-t.velocity.y,z:e.velocity.z-t.velocity.z},l=o.x*n.x+o.y*n.y+o.z*n.z;if(l>0){let c=2*l/i;e.fixed===!1&&(e.velocity.x-=c*n.x*t.mass*e.restitution,e.velocity.y-=c*n.y*t.mass*e.restitution,e.velocity.z-=c*n.z*t.mass*e.restitution),t.fixed===!1&&(t.velocity.x+=c*n.x*t.mass*t.restitution/t.mass,t.velocity.y+=c*n.y*t.mass*t.restitution/t.mass,t.velocity.z+=c*n.z*t.mass*t.restitution/t.mass)}}},nbody:{lastTime:performance.now(),G:6674e-14,setupEntities:function(e){for(let t in e){let r=e[t];r.components&&!r.components[this.__node.tag]||this.setupEntity(r)}return e},setupEntity:function(e){return"collisionEnabled"in e||At.collider.setupEntity(e),e.isAttractor=!0,"attractorGroup"in e||(e.attractorGroup=0),"attractorFrameSearchMax"in e||(e.attractorFrameSearchMax=10),"attractorGroupRules"in e||(e.attractorGroupRules={0:{G:this.G,maxDist:void 0}}),e},__operator:function(e){let t=this.entityKeys;for(let r=0;r<t.length;r++){let n=e[t[r]];if(n.components&&!n.components[this.__node.tag]||!n.mass)continue;let i=0;e:for(let s=0;s<t.length;s++){let a=t[Math.floor(Math.random()*t.length)];i++;let o=e[a];if(o.components&&!o.components[this.__node.tag]||!o.mass||!o.isAttractor)continue e;if(this.attract(n,o,void 0,this.G),i>n.attractorFrameSearchMax)break e}}return e},__node:{tag:"nbody"},attract:function(e,t,r,n=this.G,i){r===void 0&&(r=At.collision.distance3D(e.position,t.position)),i===void 0&&(i=At.collision.normalize(At.collision.makeVec(e.position,t.position)));let s=0;r<.01&&(r=.01),e.attractorGroupRules[t.attractorGroup]?typeof e.attractorGroupRules[t.attractorGroup]=="object"?e.attractorGroupRules[t.attractorGroup].maxDist&&e.attractorGroupRules[t.attractorGroup].maxDist<r||(s=e.attractorGroupRules[t.attractorGroup].G*e.mass*t.mass/(r*r)):s=e.attractorGroupRules[t.attractorGroup]*e.mass*t.mass/(r*r):s=n*e.mass*t.mass/(r*r),e.force.x+=i.x*s,e.force.y+=i.y*s,e.force.z+=i.z*s,t.force.x-=i.x*s,t.force.y-=i.y*s,t.force.z-=i.z*s}},boid:{lastTime:performance.now(),defaultAnchor:{x:Math.random(),y:Math.random(),z:Math.random(),mul:.006},setupEntities:function(e){for(let t in e){let r=e[t];this.setupEntity(r)}return e},setupEntity:function(e){e.position||At.collider.setupEntity(e);let t=Object.assign({},this.defaultAnchor);t.x*=e.boundingBox.right,t.y*=e.boundingBox.back,t.z*=e.boundingBox.top;let r={cohesion:1e-5,separation:1e-4,alignment:.006,swirl:t,attractor:Object.assign(t,{mul:.002}),useCohesion:!0,useSeparation:!0,useAlignment:!0,useSwirl:!0,useAttractor:!0,useAttraction:!1,groupRadius:200,groupSize:5,searchLimit:5};return e.boid?e.boid=Object.assign(r,e.boid):e.boid=r,this.entityKeys.length>1e3&&(e.boid.groupSize=1,e.boid.searchLimit=1),e},__operator:function(e){let t=performance.now(),r=t-this.lastTime;this.lastTime=t;let n=this.entityKeys,i=n.length,s=1/r,a=-1;e:for(let o=0;o<n.length;o++){a++;let l=e[n[o]],c=[],f=[],u=[l.position.x,l.position.y,l.position.z,0,0,0,l.velocity.x,l.velocity.y,l.velocity.z,0,0,0,0,0,0,0,0,0],d=1,p=-1;t:for(let S=0;S<n.length;S++){if(p++,f.length>l.boid.groupSize||p>l.boid.searchLimit)break t;let O=n[Math.floor(Math.random()*i)];if(p===a||O===n[o]||c.indexOf(O)>-1)continue t;{let A=e[O],C=Math.sqrt((l.position.x-A.position.x)*(l.position.x-A.position.x)+(l.position.y-A.position.y)*(l.position.y-A.position.y)+(l.position.z-A.position.z)*(l.position.z-A.position.z));if(C>l.boid.groupRadius)continue t;{f.push(C),c.push(O);let I;if((l.boid.useSeparation||l.boid.useAlignment)&&(I=l.boid.groupRadius/(C*C),I>l.maxSpeed?I=l.maxSpeed:I<-l.maxSpeed&&(I=-l.maxSpeed)),l.boid.useCohesion&&(u[0]+=(A.position.x-l.position.x)*.5*C*s,u[1]+=(A.position.y-l.position.y)*.5*C*s,u[2]+=(A.position.z-l.position.z)*.5*C*s),isNaN(C)||isNaN(u[0])||isNaN(A.position.x)){console.log(C,o,O,l.position,A.position,u),l.position.x=NaN;return}l.boid.useSeparation&&(u[3]=u[3]+(l.position.x-A.position.x)*I,u[4]=u[4]+(l.position.y-A.position.y)*I,u[5]=u[5]+(l.position.z-A.position.z)*I),l.boid.useAttraction&&A.boid.useAttraction&&At.nbody.attract(l,A,C),l.boid.useAlignment&&(u[6]=u[6]+A.velocity.x*I,u[7]=u[7]+A.velocity.y*I,u[8]=u[8]+A.velocity.z*I),d++}}}let _=1/d;l.boid.useCohesion?(u[0]=l.boid.cohesion*(u[0]*_),u[1]=l.boid.cohesion*(u[1]*_),u[2]=l.boid.cohesion*(u[2]*_)):(u[0]=0,u[1]=0,u[2]=0),l.boid.useSeparation?(u[3]=l.boid.separation*u[3],u[4]=l.boid.separation*u[4],u[5]=l.boid.separation*u[5]):(u[3]=0,u[4]=0,u[5]=0),l.boid.useAlignment?(u[6]=-(l.boid.alignment*u[6]*_),u[7]=l.boid.alignment*u[7]*_,u[8]=l.boid.alignment*u[8]*_):(u[6]=0,u[7]=0,u[8]=0);let w=[0,0,0];l.boid.useSwirl==!0&&(u[9]=-(l.position.y-l.boid.swirl.y)*l.boid.swirl.mul,u[10]=(l.position.z-l.boid.swirl.z)*l.boid.swirl.mul,u[11]=(l.position.x-l.boid.swirl.x)*l.boid.swirl.mul);let k=[0,0,0];l.boid.useAttractor==!0&&(u[12]=(l.boid.attractor.x-l.position.x)*l.boid.attractor.mul,(l.position.x>l.boundingBox.left||l.position.x<l.boundingBox.right)&&(u[12]*=3),u[13]=(l.boid.attractor.y-l.position.y)*l.boid.attractor.mul,(l.position.y>l.boundingBox.top||l.position.y<l.boundingBox.bottom)&&(u[13]*=3),u[14]=(l.boid.attractor.z-l.position.z)*l.boid.attractor.mul,(l.position.z>l.boundingBox.front||l.position.z<l.boundingBox.back)&&(u[14]*=3)),l.velocity.x=l.velocity.x+u[0]+u[3]+u[6]+u[9]+u[12]+u[15],l.velocity.y=l.velocity.y+u[1]+u[4]+u[7]+u[10]+u[13]+u[16],l.velocity.z=l.velocity.z+u[2]+u[5]+u[8]+u[11]+u[14]+u[17],isNaN(l.velocity.x)&&console.error(l,o,d,l.position,l.velocity,w,k)}return e},__node:{tag:"boid"}},movement:{__node:{tag:"movement"},lastTime:performance.now(),setupEntities:function(e){for(let t in e){let r=e[t];r.components&&!r.components[this.__node.tag]||this.setupEntity(r)}},setupEntity:function(e){return"mass"in e||(e.mass=1),"fixed"in e||(e.fixed=!1),e.force||(e.force={x:0,y:0,z:0}),"mass"in e||(e.mass=1),"gravity"in e||(e.gravity=-9.81),e.acceleration||(e.acceleration={x:0,y:0,z:0}),e.velocity||(e.velocity={x:0,y:0,z:0}),"maxSpeed"in e||(e.maxSpeed=10),e.position||(e.position={x:0,y:0,z:0}),e},__operator:function(e){let t=performance.now(),r=(t-this.lastTime)*.001;this.lastTime=t;let n=this.entityKeys;for(let i=0;i<n.length;i++){let s=e[n[i]];if(!(s.components&&!s.components[this.__node.tag])&&!s.fixed){if(s.mass&&(s.force.x&&(s.acceleration.x+=s.force.x/s.mass,s.force.x=0),s.force.y&&(s.acceleration.y+=s.force.y/s.mass,s.force.y=0),s.force.z&&(s.acceleration.z+=s.force.z/s.mass+s.gravity,s.force.z=0)),s.drag&&(s.acceleration.x&&(s.acceleration.x-=s.acceleration.x*s.drag*r),s.acceleration.y&&(s.acceleration.y-=s.acceleration.y*s.drag*r),s.acceleration.z&&(s.acceleration.z-=s.acceleration.z*s.drag*r)),s.acceleration.x&&(s.velocity.x+=s.acceleration.x*r),s.acceleration.y&&(s.velocity.y+=s.acceleration.y*r),s.acceleration.z&&(s.velocity.z+=s.acceleration.z*r),s.maxSpeed>0){let a=At.collision.magnitude(s.velocity);if(a>s.maxSpeed){let o=s.maxSpeed/a;s.velocity.x*=o,s.velocity.y*=o,s.velocity.z*=o}}s.velocity.x&&(s.position.x+=s.velocity.x*r),s.velocity.y&&(s.position.y+=s.velocity.y*r),s.velocity.z&&(s.position.z+=s.velocity.z*r)}}return e}}},If=class{constructor(e,t,r,n){this.r=e,this.g=t,this.b=r,this.a=n}},aee=class{constructor(){this.scaleX=1,this.scaleY=1,this.offsetX=0,this.offsetY=0,this.loop=!1,this._vbuffer=0,this._coord=0,this.visible=!0,this.intensity=1,this.xy=new Float32Array([]),this.numPoints=0,this.color=new If(0,0,0,1),this.webglNumPoints=0}},bx=class extends aee{constructor(e,t){super(),this.currentIndex=0,this.webglNumPoints=t,this.numPoints=t,this.color=e,this.xy=new Float32Array(2*this.webglNumPoints)}setX(e,t){this.xy[e*2]=t}setY(e,t){this.xy[e*2+1]=t}getX(e){return this.xy[e*2]}getY(e){return this.xy[e*2+1]}lineSpaceX(e,t){for(let r=0;r<this.numPoints;r++)this.setX(r,e+t*r)}arrangeX(){this.lineSpaceX(-1,2/this.numPoints)}constY(e){for(let t=0;t<this.numPoints;t++)this.setY(t,e)}shiftAdd(e){let t=e.length;for(let r=0;r<this.numPoints-t;r++)this.setY(r,this.getY(r+t));for(let r=0;r<t;r++)this.setY(r+this.numPoints-t,e[r])}addArrayY(e){if(this.currentIndex+e.length<=this.numPoints)for(let t=0;t<e.length;t++)this.setY(this.currentIndex,e[t]),this.currentIndex++}replaceArrayY(e){if(e.length==this.numPoints)for(let t=0;t<this.numPoints;t++)this.setY(t,e[t])}},RQ=(e,t,r)=>{let n={x:0,y:0};return n.x=e.x+t.x*r,n.y=e.y+t.y*r,n},tF=e=>uF(-e.y,e.x),vx=(e,t)=>{let r=RPe(e,t);return r=oee(r),r},BPe=(e,t)=>{let r={x:0,y:0};return r.x=e.x+t.x,r.y=e.y+t.y,r},MPe=(e,t)=>e.x*t.x+e.y*t.y,oee=e=>{let t={x:0,y:0},r=e.x*e.x+e.y*e.y;return r>0&&(r=1/Math.sqrt(r),t.x=e.x*r,t.y=e.y*r),t},uF=(e,t)=>{let r={x:0,y:0};return r.x=e,r.y=t,r},RPe=(e,t)=>{let r={x:0,y:0};return r.x=e.x-t.x,r.y=e.y-t.y,r},$Pe=e=>{let t,r={x:0,y:0},n={x:0,y:0},i=[],s=(l,c)=>{i.push({vec2:l,miterLength:c})},a=l=>({x:e[l*2],y:e[l*2+1]});r=vx(a(1),a(0)),t=tF(r),s(t,1);let o=e.length/2;for(let l=1;l<o-1;l++){let c=a(l-1),f=a(l),u=a(l+1);r=vx(f,c),t=tF(r),n=vx(u,f);let d=UPe(r,n),p=zPe(r,d,1);s(d,p)}return r=vx(a(o-1),a(o-2)),t=tF(r),s(t,1),i},UPe=(e,t)=>{let r=BPe(e,t);return r=oee(r),uF(-r.y,r.x)},zPe=(e,t,r)=>{let n=uF(-e.y,e.x);return r/MPe(t,n)},rF=class extends aee{constructor(e,t,r){super(),this.currentIndex=0,this._thicknessRequested=0,this._actualThickness=0,this.webglNumPoints=t*2,this.numPoints=t,this.color=e,this._thicknessRequested=r,this._linePoints=new Float32Array(t*2),this.xy=new Float32Array(2*this.webglNumPoints)}convertToTriPoints(){let e=this._actualThickness/2,t=$Pe(this._linePoints);for(let r=0;r<this.numPoints;r++){let n=this._linePoints[2*r],i=this._linePoints[2*r+1],s={x:n,y:i},a=RQ(s,t[r].vec2,t[r].miterLength*e),o=RQ(s,t[r].vec2,-t[r].miterLength*e);this.xy[r*4]=a.x,this.xy[r*4+1]=a.y,this.xy[r*4+2]=o.x,this.xy[r*4+3]=o.y}}setX(e,t){this._linePoints[e*2]=t}setY(e,t){this._linePoints[e*2+1]=t}lineSpaceX(e,t){for(let r=0;r<this.numPoints;r++)this.setX(r,e+t*r)}setThickness(e){this._thicknessRequested=e}getThickness(){return this._thicknessRequested}setActualThickness(e){this._actualThickness=e}},qPe=class{constructor(e,t){this.debug=!1,this.addLine=this.addDataLine,t==null?this.webgl=e.getContext("webgl",{antialias:!0,transparent:!1}):(this.webgl=e.getContext("webgl",{antialias:t.antialias,transparent:t.transparent,desynchronized:t.deSync,powerPerformance:t.powerPerformance,preserveDrawing:t.preserveDrawing}),this.debug=t.debug==null?!1:t.debug),this.log("canvas type is: "+e.constructor.name),this.log(`[webgl-plot]:width=${e.width}, height=${e.height}`),this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[],this.gScaleX=1,this.gScaleY=1,this.gXYratio=1,this.gOffsetX=0,this.gOffsetY=0,this.gLog10X=!1,this.gLog10Y=!1,this.webgl.clear(this.webgl.COLOR_BUFFER_BIT),this.webgl.viewport(0,0,e.width,e.height),this._progLine=this.webgl.createProgram(),this.initThinLineProgram(),this.webgl.enable(this.webgl.BLEND),this.webgl.blendFunc(this.webgl.SRC_ALPHA,this.webgl.ONE_MINUS_SRC_ALPHA)}get linesData(){return this._linesData}get linesAux(){return this._linesAux}get thickLines(){return this._thickLines}get surfaces(){return this._surfaces}_drawLines(e){let t=this.webgl;e.forEach(r=>{if(r.visible){t.useProgram(this._progLine);let n=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(n,!1,new Float32Array([r.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,r.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let i=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(i,new Float32Array([r.offsetX+this.gOffsetX,r.offsetY+this.gOffsetY]));let s=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(s,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let a=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(a,[r.color.r,r.color.g,r.color.b,r.color.a]),t.bufferData(t.ARRAY_BUFFER,r.xy,t.STREAM_DRAW),t.drawArrays(r.loop?t.LINE_LOOP:t.LINE_STRIP,0,r.webglNumPoints)}})}_drawSurfaces(e){let t=this.webgl;e.forEach(r=>{if(r.visible){t.useProgram(this._progLine);let n=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(n,!1,new Float32Array([r.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,r.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let i=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(i,new Float32Array([r.offsetX+this.gOffsetX,r.offsetY+this.gOffsetY]));let s=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(s,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let a=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(a,[r.color.r,r.color.g,r.color.b,r.color.a]),t.bufferData(t.ARRAY_BUFFER,r.xy,t.STREAM_DRAW),t.drawArrays(t.TRIANGLE_STRIP,0,r.webglNumPoints)}})}_drawTriangles(e){let t=this.webgl;t.bufferData(t.ARRAY_BUFFER,e.xy,t.STREAM_DRAW),t.useProgram(this._progLine);let r=t.getUniformLocation(this._progLine,"uscale");t.uniformMatrix2fv(r,!1,new Float32Array([e.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,e.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let n=t.getUniformLocation(this._progLine,"uoffset");t.uniform2fv(n,new Float32Array([e.offsetX+this.gOffsetX,e.offsetY+this.gOffsetY]));let i=t.getUniformLocation(this._progLine,"is_log");t.uniform2iv(i,new Int32Array([0,0]));let s=t.getUniformLocation(this._progLine,"uColor");t.uniform4fv(s,[e.color.r,e.color.g,e.color.b,e.color.a]),t.drawArrays(t.TRIANGLE_STRIP,0,e.xy.length/2)}_drawThickLines(){this._thickLines.forEach(e=>{if(e.visible){let t=Math.min(this.gScaleX,this.gScaleY);e.setActualThickness(e.getThickness()/t),e.convertToTriPoints(),this._drawTriangles(e)}})}update(){this.clear(),this.draw()}draw(){this._drawLines(this.linesData),this._drawLines(this.linesAux),this._drawThickLines(),this._drawSurfaces(this.surfaces)}clear(){this.webgl.clear(this.webgl.COLOR_BUFFER_BIT)}_addLine(e){e._vbuffer=this.webgl.createBuffer(),this.webgl.bindBuffer(this.webgl.ARRAY_BUFFER,e._vbuffer),this.webgl.bufferData(this.webgl.ARRAY_BUFFER,e.xy,this.webgl.STREAM_DRAW),e._coord=this.webgl.getAttribLocation(this._progLine,"coordinates"),this.webgl.vertexAttribPointer(e._coord,2,this.webgl.FLOAT,!1,0,0),this.webgl.enableVertexAttribArray(e._coord)}addDataLine(e){this._addLine(e),this.linesData.push(e)}addAuxLine(e){this._addLine(e),this.linesAux.push(e)}addThickLine(e){this._addLine(e),this._thickLines.push(e)}addSurface(e){this._addLine(e),this.surfaces.push(e)}initThinLineProgram(){let e=`
      attribute vec2 coordinates;
      uniform mat2 uscale;
      uniform vec2 uoffset;
      uniform ivec2 is_log;

      void main(void) {
         float x = (is_log[0]==1) ? log(coordinates.x) : coordinates.x;
         float y = (is_log[1]==1) ? log(coordinates.y) : coordinates.y;
         vec2 line = vec2(x, y);
         gl_Position = vec4(uscale*line + uoffset, 0.0, 1.0);
      }`,t=this.webgl.createShader(this.webgl.VERTEX_SHADER);this.webgl.shaderSource(t,e),this.webgl.compileShader(t);let r=`
         precision mediump float;
         uniform highp vec4 uColor;
         void main(void) {
            gl_FragColor =  uColor;
         }`,n=this.webgl.createShader(this.webgl.FRAGMENT_SHADER);this.webgl.shaderSource(n,r),this.webgl.compileShader(n),this._progLine=this.webgl.createProgram(),this.webgl.attachShader(this._progLine,t),this.webgl.attachShader(this._progLine,n),this.webgl.linkProgram(this._progLine)}popDataLine(){this.linesData.pop()}removeAllLines(){this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[]}removeDataLines(){this._linesData=[]}removeAuxLines(){this._linesAux=[]}viewport(e,t,r,n){this.webgl.viewport(e,t,r,n)}log(e){this.debug&&console.log("[webgl-plot]:"+e)}},dn=class{constructor(){this.plots={}}initPlot(e,t){if(t||(t=new qPe(e.canvas,e.webglOptions)),!e._id)e._id=`plot${Math.floor(Math.random()*1e15)}`;else if(this.plots[e._id]){let l=this.plots[e._id].initial;if(e.lines){for(let c in e.lines)if(l.lines[c]&&Array.isArray(e.lines[c])){let f=e.lines[c];e.lines[c]=l.lines[c]}}e=Object.assign(l,e)}e.overlay&&(typeof e.overlay!="object"&&(e.overlay=document.createElement("canvas"),e.overlay.style.position="absolute",e.overlay.width=e.canvas.width,e.overlay.height=e.canvas.height,e.canvas.appendChild(e.overlay)),e.overlayCtx||(e.overlayCtx=e.overlay.getContext("2d"))),e.width&&(e.canvas.width=e.width,e.canvas.style&&(e.canvas.style.width=e.width+"px"),typeof e.overlay=="object"&&(e.overlay.width=e.width,e.overlay.style&&(e.overlay.style.width=e.width+"px"))),e.height&&(e.canvas.height=e.height,e.canvas.style&&(e.canvas.style.height=e.height+"px"),typeof e.overlay=="object"&&(e.overlay.height=e.height,e.overlay.style&&(e.overlay.style.height=e.height+"px"))),e.lines?.timestamp&&delete e.lines.timestamp,e.lines||(e.lines={});let r={};for(let l in e.lines)r[l]=Object.assign({},r[l]),"viewing"in e.lines[l]||(e.lines[l].viewing=!0),r[l].viewing=e.lines[l].viewing,r[l].sps=e.lines[l].sps,r[l].nSec=e.lines[l].nSec,r[l].nPoints=e.lines[l].nPoints,r[l].ymin=e.lines[l].ymin,r[l].ymax=e.lines[l].ymax,r[l].units=e.lines[l].units;let n={plot:t,settings:e,initial:Object.assign(Object.assign({},e),{lines:r}),anim:()=>{t.update()}};this.plots[e._id]=n;let i=0,s=0;Object.keys(e.lines).forEach(l=>{e.lines[l]?.viewing!==!1&&s++}),e.nLines=s;let a,o;typeof e.overlay=="object"&&(a=e.overlay,o=e.overlayCtx,o.clearRect(0,0,e.overlay.width,e.overlay.height),o.font=e.overlayFont?e.overlayFont:"1em Courier",o.fillStyle=e.overlayColor?e.overlayColor:"white");for(let l in e.lines){let c=e.lines[l];if(Array.isArray(c)&&(c={values:c},e.lines[l]=c),"viewing"in c||(c.viewing=!0),c.color)Array.isArray(c.color)&&(c.color=new If(...c.color));else{let w=dn.HSLToRGB(360*(i/s)%360,100,50,1);n.initial.lines[l].color=[...w,1],c.color=new If(...w,1)}let f;if(c.nSec&&c.sps?f=Math.ceil(c.nSec*c.sps):c.nPoints?f=c.nPoints:c.points?f=c.points:e.linePoints?f=e.linePoints:c.values?f=c.values.length:f=1e3,c.points=f,e.lines[l].viewing===!1)continue;if((c.width||e.lineWidth)&&c.width!==0){let w=e.lineWidth;w||(w=c.width),c.width?c.line=new rF(c.color,f,c.width):e.lineWidth&&(c.line=new rF(c.color,f,e.lineWidth)),c.line.lineSpaceX(-1,2/c.line.numPoints)}else c.line=new bx(c.color,f),c.line.arrangeX();c.values?.length===c.points?c.values.length!==f&&(c.interpolate?c.values.length>f?c.values=dn.downsample(c.values,f):c.values.length<f&&(c.values=dn.upsample(c.values,f)):c.values.length>c.points?c.values=c.values.slice(c.values.length-c.points):c.values=[...new Array(c.points-c.values.length).fill(0),...c.values]):Array.isArray(c.values)?c.values.length>f?c.values=c.values.slice(c.values.length-f):c.values.length<f&&(c.values=[...new Array(f-c.values.length).fill(0),...c.values]):c.values=new Array(c.points).fill(0);let u=c.ymin,d=c.ymax,p=c.values.length<=1e5;if(u===d?(d=p?Math.max(...c.values):1,u=p?Math.min(...c.values):0):isNaN(d)&&(d=p?Math.max(...c.values):1),isNaN(u)&&(u=p?Math.min(...c.values):0),u>d){let w=u;d=u,u=w}let _=Math.abs(u);if(c.absmax=_>d?_:d,"autoscale"in c||(c.autoscale=!0),c.position||(c.position=e.nLines-i-1),c.autoscale?c.autoscale===2?("clamp"in c||(c.clamp=!0),c.scaled=dn.autoscale(c.values,c.position,s,c.centerZero,u,d,c.clamp)):(c.scaled=c.values,c.line.scaleY=dn.getYScalar(c.values,s,c.centerZero,u,d),c.line.offsetY=dn.getYOffset(c.position,s,u,c.line.scaleY)):c.scaled=c.values,c.scaled.forEach((w,k)=>c.line.setY(k,w)),c.line instanceof rF?t.addThickLine(c.line):c.line instanceof bx&&t.addDataLine(c.line),"xAxis"in c||(c.xAxis=!0),c.xAxis){c.xColor?Array.isArray(c.xColor)&&(c.xColor=new If(...c.xColor)):c.xColor=new If(1,1,1,.3);let w=new bx(c.xColor,2),k=c.autoscale?(i+1)*2/s-1-1/s:0;w.constY(k),w.arrangeX(),w.xy[2]=1,c.x=w,t.addAuxLine(w)}if(s>1&&c.autoscale&&i!==s-1){e.dividerColor?Array.isArray(e.dividerColor)&&(e.dividerColor=new If(...e.dividerColor)):e.dividerColor=new If(1,1,1,1);let w=new bx(e.dividerColor,2);w.constY(c.autoscale?(i+1)*2/s-1:1),w.arrangeX(),w.xy[2]=1,c.divider=w,t.addAuxLine(w)}if(typeof e.overlay=="object"&&(c.useOverlay||!("useOverlay"in c))){let w=e.nLines-c.position-1;o.fillText(l,20,a.height*(w+.2)/e.nLines),o.fillText(`${Math.floor(d)===d?d:d?.toFixed(5)} ${c.units?c.units:""}`,a.width-100,a.height*(w+.2)/e.nLines),o.fillText(`${Math.floor(u)===u?u:u?.toFixed(5)} ${c.units?c.units:""}`,a.width-100,a.height*(w+.9)/e.nLines)}i++}return requestAnimationFrame(n.anim),this.plots[e._id]}deinitPlot(e){return typeof e=="string"&&(e=this.plots[e]),e.plot.clear(),e.plot.removeAllLines(),!0}reinitPlot(e,t){if(typeof e=="string"){let r=e;e=this.plots[e],t._id||(t._id=r)}if(e.plot)return e.plot.clear(),e.plot.removeAllLines(),e.settings.overlayCtx&&e.settings.overlayCtx.clearRect(0,0,e.settings.overlay?.width,e.settings.overlay?.height),this.initPlot(t,e.plot)}getChartSettings(e,t){let r=this.plots[e];if(r){let n=Object.assign({},r.initial);for(let i in r.initial.lines)typeof r.initial.lines[i]?.ymax!="number"&&(n.lines[i].ymax=r.settings.lines[i]?.ymax),typeof r.initial.lines[i]?.ymin!="number"&&(n.lines[i].ymin=r.settings.lines[i]?.ymin),t&&(n.lines[i].values=r.settings.lines[i].values);return delete n.canvas,delete n.overlay,delete n.overlayCtx,n}}update(e,t,r=!0){if(typeof e=="string"&&(e=this.plots[e]),!e)return!1;if(t){let n=!1,i,s;typeof e.settings.overlay=="object"&&(i=e.settings.overlay,s=e.settings.overlayCtx,s.font=e.settings.overlayFont?e.settings.overlayFont:"1em Courier",s.fillStyle=e.settings.overlayColor?e.settings.overlayColor:"white");for(let a in t)if(e.settings.lines[a]&&e.settings.lines[a].line){if(e.settings.lines[a]?.viewing===!1)continue;let o=e.settings.lines[a];if(o.values){if(e.settings.mode&&e.settings.mode==="sweep"){"ct"in o||(o.ct=0);let d=p=>{o.ct>o.values.length&&(o.ct=0),o.values[o.ct]=p,o.ct++};Array.isArray(t[a])?t[a].forEach(d):typeof t[a]=="number"?d(t[a]):t[a].values&&t[a].values.forEach(d)}else Array.isArray(t[a])&&o.values?.length<1e5?(o.values.length===0&&(o.values.length=o.points?o.points:1e3),t[a].length===o.values.length?o.values=t[a]:dn.circularBuffer(o.values,t[a])):typeof t[a]=="number"?(o.values.push(t[a]),o.values.shift()):t[a]?.values&&(o.values.length===0&&(o.values.length=o.points?o.points:1e3),t[a].values.length===o.values.length?o.values=t[a].values:dn.circularBuffer(o.values,t[a].values));o.values.length!==o.points&&(o.interpolate?o.values.length>o.points?o.values=dn.downsample(o.values,o.points):o.scaled.length<o.points&&(o.values=dn.upsample(o.values,o.points)):o.values.length>o.points?o.values.splice(0,o.values.length-o.points):o.values=new Array(o.points).fill(0).splice(o.points-o.values.length,0,o.values));let l=o.ymin,c=o.ymax,f=o.values.length<=1e5;if(l===c?(c=f?Math.max(...o.values):1,l=f?Math.min(...o.values):0):isNaN(c)&&(c=f?Math.max(...o.values):1),isNaN(l)&&(l=f?Math.min(...o.values):0),l>c){let d=l;c=l,l=d}let u=Math.abs(l);if(o.absmax=u>c?u:c,o.autoscale?o.autoscale===2?o.scaled=dn.autoscale(o.values,o.position,e.settings.nLines,o.centerZero,l,c,o.clamp):(o.scaled=o.values,o.line.scaleY=dn.getYScalar(o.values,e.settings.nLines,o.centerZero,l,c),o.line.offsetY=dn.getYOffset(o.position,e.settings.nLines,l,o.line.scaleY)):o.scaled=o.values,o.scaled.forEach((d,p)=>{!o.autoscale&&o.absmax>1?o.line.setY(p,d/o.absmax):o.line.setY(p,d)}),typeof e.settings.overlay=="object"&&(o.useOverlay||!("useOverlay"in o))){let d=e.settings.nLines-o.position-1,p=i.height*d/e.settings.nLines,_=i.height/e.settings.nLines;if(s.clearRect(0,p,i.width,_),e.settings.mode&&e.settings.mode==="sweep"){s.fillStyle=e.settings.sweepColor?e.settings.sweepColor:"rgba(0,255,0,0.25)",s.beginPath();let w=i.width*o.ct/o.values.length;s.moveTo(w,p),s.lineTo(w,_),s.stroke()}s.fillStyle=e.settings.overlayColor?e.settings.overlayColor:"white",s.fillText(a,20,i.height*(d+.2)/e.settings.nLines),s.fillText(`${Math.floor(c)===c?c:c?.toFixed(5)} ${o.units?o.units:""}`,i.width-100,i.height*(d+.2)/e.settings.nLines),s.fillText(`${Math.floor(l)===l?l:l?.toFixed(5)} ${o.units?o.units:""}`,i.width-100,i.height*(d+.9)/e.settings.nLines)}}}else e.settings.generateNewLines&&!a.includes("timestamp")&&(Array.isArray(t[a])&&(t[a]={values:t[a]}),!t[a].nSec&&!t[a].nPoints&&!e.settings.linePoints&&(t[a].nPoints=1e3),n=!0);if(n)return e.settings.cleanGeneration||Object.keys(e.initial.lines).forEach(a=>{t[a]?t[a]=Object.assign(e.initial.lines[a],t[a]):t[a]=e.initial.lines[a]}),this.reinitPlot(e,{_id:e.settings._id,lines:t}),!0}return r&&requestAnimationFrame(e.anim),!0}updateLine(e,t,r,n,i,s,a){return e.numPoints!==t.length&&(r?e.numPoints>t.length?t=dn.downsample(t,e.numPoints):e.numPoints<t.length&&(t=dn.upsample(t,e.numPoints)):t.length>e.numPoints?t=t.slice(t.length-e.numPoints):t=[...new Array(t.length).fill(0),...t]),n&&(t=dn.autoscale(t,i,s,a)),t.forEach((o,l)=>e.setY(l,o)),!0}static autoscale(e,t=0,r=1,n=!1,i,s,a){if(e?.length===0)return e;let o=typeof s=="number"?s:e.length<=1e5?Math.max(...e):1,l=typeof i=="number"?i:e.length<=1e5?Math.min(...e):0,c=1/r,f=1;if(n){let u=Math.max(Math.abs(l),Math.abs(o));return u!==0&&(f=c/u),e.map(d=>(a&&(d<l&&(d=l),d>o&&(d=o)),d*f+(c*(t+1)*2-1-c)))}else return o===l?o!==0?f=c/o:l!==0&&(f=c/Math.abs(l)):f=c/(o-l),e.map(u=>(a&&(u<l&&(u=l),u>o&&(u=o)),2*((u-l)*f-1/(2*r))+(c*(t+1)*2-1-c)))}static getYScalar(e,t=1,r=!1,n,i){if(e?.length===0)return e;let s=typeof i=="number"?i:e.length<=1e5?Math.max(...e):1,a=typeof n=="number"?n:e.length<=1e5?Math.min(...e):0,o=1/t,l=1;if(r){let c=Math.max(Math.abs(a),Math.abs(s));return c!==0&&(l=o/c),2*l}else return s===a?s!==0?l=o/s:a!==0&&(l=o/Math.abs(a)):l=o/(s-a),2*l}static getYOffset(e=0,t=1,r=0,n=1){let i=1/t,s=i*(e+1)*2-1-i;return r!==0?s-=r*n+1/t:s-=n+1/t,s}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t,r=1){if(e.length>t){let n=new Array(t),i=e.length/t,s=e.length-1,a=0,o=0;for(let l=i;l<e.length;l+=i){let c=Math.round(l);c>s&&(c=s);for(let f=a;f<c;f++)n[o]+=e[f];n[o]/=(c-a)*r,o++,a=c}return n}else return e}static upsample(e,t,r=1){var n=function(u,d,p){return(u+(d-u)*p)*r},i=new Array(t),s=(e.length-1)/(t-1);i[0]=e[0];for(var a=1;a<t-1;a++){var o=a*s,l=Math.floor(o),c=Math.ceil(o),f=o-l;i[a]=n(e[l],e[c],f)}return i[t-1]=e[e.length-1],i}static interpolate(e,t,r=1){return e.length>t?dn.downsample(e,t,r):e.length<t?dn.upsample(e,t,r):e}static HSLToRGB(e,t,r,n=255){t/=100,r/=100;let i=(1-Math.abs(2*r-1))*t,s=i*(1-Math.abs(e/60%2-1)),a=r-i/2,o=0,l=0,c=0;return 0<=e&&e<60?(o=i,l=s,c=0):60<=e&&e<120?(o=s,l=i,c=0):120<=e&&e<180?(o=0,l=i,c=s):180<=e&&e<240?(o=0,l=s,c=i):240<=e&&e<300?(o=s,l=0,c=i):300<=e&&e<360&&(o=i,l=0,c=s),o=(o+a)*n,l=(l+a)*n,c=(c+a)*n,[o,l,c]}static circularBuffer(e,t){if(t.length<e.length){let r=e.slice(t.length),n=e.length;e.splice(0,n,...r,...t)}else if(t.length>e.length){let r=e.length;e.splice(0,r,...t.slice(t.length-r))}else e.splice(0,e.length,...t);return e}static formatDataForCharts(e,t){if(Array.isArray(e)){if(Array.isArray(e[0])){let r={};if(e.forEach((n,i)=>{r[i]=n}),e=r,isNaN(e[0][0]))return}else if(t){if(e={[t]:e},isNaN(e[t][0]))return}else if(e={0:e},isNaN(e[0][0]))return}else if(typeof e=="object"){for(let r in e)if(typeof e[r]=="number"?e[r]=[e[r]]:e[r]?.values&&typeof e[r].values=="number"&&(e[r].values=[e[r].values]),isNaN(e[r][0]))return}else if(typeof e=="string"){let r;if(e.includes(`\r
`)){let n=e.split(`\r
`);e={},n.forEach((i,s)=>{i.includes("	")?r=i.split("	"):i.includes(",")?r=i.split(","):i.includes("|")&&(r=i.split("|")),r&&r.forEach((a,o)=>{if(a.includes(":")){let[l,c]=a.split(":"),f=parseFloat(c);isNaN(f)||(e[l]=[f])}else{let l=parseFloat(a);isNaN(l)||(e[o]=[l])}})})}else e.includes("	")?r=e.split("	"):e.includes(",")?r=e.split(","):e.includes("|")&&(r=e.split("|"));e={},r&&r.forEach((n,i)=>{if(n.includes(":")){let[s,a]=n.split(":"),o=parseFloat(a);isNaN(o)||(e[s]=[o])}else{let s=parseFloat(n);isNaN(s)||(e[i]=[s])}})}else typeof e=="number"&&(t?e={[t]:[e]}:e={0:[e]});return e}static padTime(e,t,r,n){let i=(e[0]-t)/r/n;return[...new Array(n-e.length).map((s,a)=>t+i*(a+1)),...e]}static interpolateForTime(e,t,r){return dn.interpolate(e,Math.ceil(r*t))}};var VPe=Object.defineProperty,HPe=(e,t,r)=>t in e?VPe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Wt=(e,t,r)=>(HPe(e,typeof t!="symbol"?t+"":t,r),r),Na=class{constructor(){}static genSineWave(e=20,t=1,r=1,n=512,i=0,s=1){for(var a=[],o=[],l=1/n,c=0;c<r;c+=l){var f=Math.sin(2*Math.PI*e*c)*t;f+=Math.sin(2*Math.PI*i*c)*s,a.push(f),o.push(c)}return[o,a]}static getSineAmplitude(e=20,t=1,r=0,n=0){return Math.sin(this.TWO_PI*e*r+n)*t}static mean(e){var t=e.reduce((r,n)=>n+=r);return t/e.length}static mode(e){return e.sort((t,r)=>e.filter(n=>n===t).length-e.filter(n=>n===r).length).pop()}static std(e,t=void 0){let r=t;t||(r=this.mean(e));let n=0;for(let i=0;i<e.length;i++){let s=e[i]-r;n+=s*s}return Math.sqrt(n/e.length)}static relError(e=[],t=[],r=!0){if(e.length!==t.length)throw new Error("Input arrays of same length!");let n=e.length,i=new Array(e.length);for(let s=0;s<n;s++){let a=(e[s]-t[s])/e[s];r&&(a=Math.abs(a)),i[s]=a}return i}static informationEntropy(e=[]){let t=e.length,r=new Array(t);for(let n=0;n<t;n++){let i=e[n]*Math.log(e[n]);isNaN(i)&&(i=0),r[n]=i}return r}static zscore(e){let t=this.mean(e),r=this.std(e,t),n=new Array().length(e.length);for(let i=0;i<e.length;i++)n[i]=(e[i]-t)/r;return n}static variance(e){var t=this.mean(e);return e.reduce((r,n)=>r+(n-t)**2,0)/e.length}static dot(e,t){for(var r=0,n=0;n<e.length;n++)r+=e[n]*t[n];return r}static cross3D(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}static magnitude(e){var t=0;return e.forEach(r=>{t+=r*r}),Math.sqrt(t)}static distance(e,t){var r=0;return e.forEach((n,i)=>{r+=(t[i]-n)*(t[i]-n)}),Math.sqrt(r)}static midpoint(e=[1,2,3],t=[3,4,5]){return e.map((r,n)=>(r+t[n])*.5)}static normalize(e){var t=0;t=this.magnitude(e);var r=new Array(e.length);return e.forEach((n,i)=>{r[i]=n*t}),r}static normalizeSeries(e=[],t=!0){let r=Math.max(...e),n=Math.min(...e);return t==!1&&(r=Math.max(r,Math.abs(n)),n=0),r-n===0&&(n=0,r===0&&(r=1e-13)),e.map(i=>(i-n)/(r-n))}static quadraticFormula(e,t,r){let n=Math.sqrt(t*t-4*e*r);if(!isNaN(n))return["complex","complex"];let i=1/(2*e);if(n===0)return[t*i];let s=-t;return[(s+n)*i,(s-n)*i]}static newtonsMethod(e=s=>Math.pow(s,5)+s*s-s-.2,t=0,r=1,n=.01,i=10){let s=[];for(let a=0;a<i;a++){let o=Math.random()*(r-t),l=e(o),c=e(o+n),f=(c-l)/n,u=o+n;for(;Math.abs(f)>n;){let _=-l/k,w=u+_;l=c,c=e(w);let k=(c-l)/(w-u)}let d,p=s.find((_,w)=>{if(Math.abs(xn1-_)<n)return d=w,!0});p?s[d]=(xn1+p)*.5:s.push(xn1)}return s}static makeVec(e,t){var r=[];return e.forEach((n,i)=>{r.push(t[i]-n)}),r}static getBufferedValueByCoordinates(e=new Array(300).fill(1),t=[10,10,2],r=[1,2,1],n=void 0){let i=(a=0,o=0)=>{if(o===t.length)return a;if(o==0)a+=r[o];else if(t[o]==0)dimsAt0++;else{let l=(c=r[o],f=o-1)=>(c*=t[f],f--,f==0?c:l(c,f));a+=l(r[o]+1,o-1)}return o++,i(a,o)},s=i();if(n){if(r[r.length-1]===0){let a=0,o=0;for(;o!==r.length-1;)r[o]!==0&&(a=o),o++;return e[s-a+n]}return e[s-t.length+n]}else{if(r[r.length-1]===0){let a=0,o=0;for(;o!==r.length-1;)r[o]!==0&&(a=o),o++;return e.slice(s-a,s+1)}return e.slice(s-t.length,s+1)}}static forBufferedMat(e=new Array(100).fill(1),t=[10,10],r=(n,i,s,a)=>n+s+a){let n=[],i=0,s=(o=0,l=o+1)=>{let c=new Array(e.length);for(let f=0;f<t[o];f++)n[o]=f,t[l]?s(l):(c[i]=r(e[i],i,...n),i++);return c},a=(o,l=o+1)=>{let c=new Array(e.length);for(let f=0;f<t[o];f++)if(n[o]=f,t[l])s(l);else for(let u=0;u<t.length;u++)c[i]=r[u](e[i],i,...n),i++;return c};if(typeof r=="function")return s();if(Array.isArray(r))return a()}static mapBufferedMat(e=new Array(100).fill(1),t=[10,10],r=(n,i,s,a)=>(console.log(`value:${n}, idx:${i}, x:${s},y:${a}`),n+s+a)){let n=new Array(t.length).fill(0),i=(o,l=0)=>{if(o[l]>=t[l]){if(o[l]=0,l++,l===t.length)return;i(o,l)}else o[l]++},s=new Array(e.length),a=0;if(typeof r=="function")for(;a<e.length;)s[a]=r(e[a],a,...n),a+=t.length,i(n);else if(Array.isArray(r))for(;a<e.length;)r.forEach(o=>{s[a]=o(e[a],a,...n),a++,i(n)});return s}static combinations(e=["a","b","c"],t=3){var r=[];return t<=0?r.push([]):Na.combinations(e,t-1).forEach(function(n){e.forEach(function(i){r.push([i].concat(n))})}),r}static generateCoordinateSpace(e=[10,10,10],t=[-10,-10,-10],r=[1,1,1],n=void 0){for(let o=0;o<e.length;o++)if(t[o]>e[o]){let l=e[o];e[o]=t[o],t[o]=l}let i=[],s=[...e],a=s.length-1;for(i.push([...s]);s[0]>=t[0];){let o=c=>{if(s[c]<=t[c]){if(c===0||(s[c]=e[c],c--,c<0))return;typeof r[c]=="function"?s[c]-=r[c](s[c]):s[c]-=r[c],o(c)}},l=a;typeof r[l]=="function"?s[l]-=r[l](s[l]):s[l]-=r[l],i.push([...s]),o(l),n&&(i[i.length-1]=n(i[i.length-1]))}return i}static calcVectorField(e=[[0,0],[0,1],[1,0],[1,1]],t=(r,n)=>[r*10,n*10]){return e.map(r=>t(...r))}static transpose(e){return e[0].map((t,r)=>e.map(n=>n[r]))}static matmul(e,t){for(var r=e.length,n=e[0].length,i=t.length,s=t[0].length,a=new Array(r),o=0;o<r;++o){a[o]=new Array(s);for(var l=0;l<s;++l){a[o][l]=0;for(var c=0;c<n;++c)a[o][l]+=e[o][c]*t[c][l]}}return a}static matscale(e,t){let r=[];for(var n=0;n<e.length;n++){r[n]=[];for(let i=0;i<e[0].length;i++)r[n][i]=e[n][i]*t}return r}static matadd(e,t){let r=[];for(let i=0;i<e.length;i++){r[i]=[];for(var n=0;n<e[0].length;n++)r[i][n]=e[i][n]+t[i][n]}return r}static matsub(e,t){let r=[];for(let i=0;i<e.length;i++){r[i]=[];for(var n=0;n<e[0].length;n++)r[i][n]=e[i][n]-t[i][n]}return r}static histogram(e=[],t=1,r=void 0){let n=[...e];n.sort(function(l,c){return l-c});let i=Math.min(...n);if(typeof r=="number"){let l=Math.max(...n);t=Math.abs((l-i)/(r-1))}let s=i,a=[],o=[];for(let l=0;l<n.length;l++){let c=t*s;if(n[l]>i+c){s++,c+=t;let u=i+c+c*.5;a.push(u),o.push(0)}o[o.length-1]++}return[a,o]}static normalDistribution(e=[],t=!0,r=1e-4){let n=this.mean(e),i=this.variance(e),s=e.length,a=[],o=1/(this.TWO_PI*i),l=1/i,c=0;for(let f=0;f<s;f++){let u=Math.exp(-.5*Math.pow((e[f]-n)*l,2))*o;u<r&&(u=0),a.push(u),c+=u}if(t){let f=1/c;a=a.map(u=>u*f)}return a}static expectedValue(e=[],t=this.normalDistribution(e)){return e.reduce((r,n,i)=>r+n*t[i])}static originMoment(e=[],t=this.normalDistribution(e),r=1){return e.reduce((n,i,s)=>n+Math.pow(i,r)*t[s])}static centralMoment(e=[],t=this.normalDistribution(e),r=1){let n=this.mean(e);return e.reduce((i,s,a)=>i+Math.pow(s-n,r)*t[a]/e.length)}static linearDiscriminantAnalysis(e=[],t=[]){let r=this.mean(e),n=this.mean(t),i=this.cov1d(e,t),s=this.normalDistribution(e),a=[];for(let o=0;o<e.length;o++)a.push(x[o]*i*n-.5*r*i*n+Math.log10(s[o]));return a}static conv1D(e=[],t=[1/3,1/3,1/3],r=Math.floor(t.length*.5)){let n=[],i=1/t.length;if(r>0){let o=new Array(r).fill(0);e=[...o,...e,...o]}let s=Math.floor(t.length*.5),a=e.length-t.length+s;for(let o=s;o<a;o++){let l=0;for(let c=0;c<t.length;c++)l+=e[o-s]*t[c];n.push(l*i)}return n}static conv2D(e=[[],[],[]],t=[[],[],[]],r=0){let n=new Array(e.length-Math.ceil(t.length*.5)).fill([]),i,s=Na.transpose(s);if(r>0){let w=new Array(r).fill(0);i=Na.transpose(e);for(let k=0;k<i.length;k++)i[k]=[...w,...i[k],...w];e=Na.transpose(i);for(let k=0;k<e.length;k++)e[k]=[...w,...e[k],...w]}let a=Math.floor(t[0].length*.5),o=Math.floor(s[0].length*.5),l=e[0].length-t[0].length+a,c=i[0].length-s[0].length+o,f=1/(t[0].length*s[0].length),u=l*c,d=a,p,_=o;for(;d<u;){let w=0;p=d%e[0].length,p===0&&_++;for(let k=0;k<t[0].length;k++){for(let S=0;S<s[0].length;k++)w+=e[_-o+S][p-a+k]*t[S][k];n[_].push(w*f)}d++}return n}static cov2d(e){var t=this.transpose(e),r=[],n=[],i=[];e.forEach((_,w)=>{n.push(this.mean(_))}),t.forEach((_,w)=>{i.push(this.mean(_))}),e.forEach((_,w)=>{r.push([]);for(var k=0;k<_.length;k++)r[w].push((e[w][k]-n[w])*(e[w][k]-i[k])/(_.length-1))});for(var s=this.transpose(r),a=r.length,o=r[0].length,l=s.length,c=s[0].length,f=new Array(a),u=0;u<a;++u){f[u]=new Array(c);for(var d=0;d<c;++d){f[u][d]=0;for(var p=0;p<o;++p)f[u][d]+=r[u][p]*s[p][d]/(e[0].length-1)}}return f}static cov1d(e=[],t=[]){return this.cov2d([e,t])}static cov3d(e=[],t=[],r=[]){return[[this.cov1d(e,e),this.cov1d(e,t),this.cov1d(e,r)],[this.cov1d(t,e),this.cov1d(t,t),this.cov1d(t,r)],[this.cov1d(r,e),this.cov1d(r,t),this.cov1d(r,r)]]}static covNd(e=[]){let t=[];e.forEach((r,n)=>{t.push([]),e.forEach((i,s)=>{t[n].push(this.cov1d(r,i))})})}static eigens2x2(e=[[1,2],[3,4]]){let t=e[0][0]*e[1][1]-e[0][1]*e[1][0],r=(e[0][0]+e[1][1])*.5,n=Math.sqrt(r*r-t),i=r+n,s=r-n;return[i,s]}static eigenvectors2x2(e=[[1,2],[3,4]],t=[1,2]){let r=[-e[0][1],e[0][0]-t[0]];r[0]===0&&r[1]===0&&(r[0]=e[1][1]-t[0],r[1]=-e[1][0]);let n=[-e[0][1],e[0][0]-t[1]];return n[0]===0&&n[1]===0&&(n[0]=e[1][1]-t[1],n[1]=-e[1][0]),[r,n]}static fastpca2d(e,t){let r=this.cov1d(e,t),n=this.eigens2x2(r);n[1]>n[0]&&n.reverse();let i=this.eigenvectors2x2(r,n);return console.log(n,i),[n,i]}static crosscorrelation(e,t){var r=[...t,...Array(t.length).fill(0)],n=this.mean(e),i=this.mean(t),s=e.reduce((d,p)=>d+=Math.pow(p-n,2));s=Math.sqrt(Math.abs(s));var a=t.reduce((d,p)=>d+=Math.pow(p-n,2));a=Math.sqrt(Math.abs(a));let o=s*a;o===0&&(o=1e-26);for(var l=1/o,c=new Array(e.length).fill(0),f=0;f<e.length;f++){var u=e.reduce((d,p,_)=>d+=(p-n)*(r[f+_]-i));c[f]=u*l}return c}static autocorrelation(e){var t=[...e,...Array(e.length).fill(0)],r=this.mean(e),n=e.reduce((c,f)=>c+=Math.pow(f-r,2));n=Math.sqrt(Math.abs(n));let i=n*arr2Est;i===0&&(i=1e-26);for(var s=1/i,a=new Array(e.length).fill(0),o=0;o<e.length;o++){var l=e.reduce((c,f,u)=>c+=(f-r)*(t[o+u]-r));a[o]=l*s}return a}static autocorrelation2dNormalized(e){let t=[];for(let r=0;r<e.length;r++){t.push([]);for(let n=0;n<e[r].length;n++){let i=0,s=0;for(let a=0;a<e.length;a++)for(let o=0;o<e[a].length;o++)i+=e[r][n]*e[e.length-1-a][e[r].length-1-o],s+=e[r][n]*e[e.length-1][e[r].length-1];t[r][n]=i/s-1}}return t}static crosscorrelation2d(e,t){let r=[];for(let n=0;n<e.length;n++){r.push([]);for(let i=0;i<e[n].length;i++){let s=0;for(let a=0;a<t.length;a++)for(let o=0;o<t[a].length;o++)s+=e[n][i]*t[t.length-1-a][t[n].length-1-o];r[n][i]=s}}return r}static crosscorrelation2dNormalized(e,t){let r=[];for(let n=0;n<e.length;n++){r.push([]);for(let i=0;i<e[n].length;i++){let s=0,a=0;for(let o=0;o<t.length;o++)for(let l=0;l<t[o].length;l++)s+=e[n][i]*t[mat2d.length-1-o][t[n].length-1-l],a+=e[n][i]*t[t.length-1][t[n].length-1];r[n][i]=s/a-1}}return r}static correlograms(e=[[],[]]){var t=[];return e.forEach((r,n)=>{e.forEach((i,s)=>{s>=n&&t.push(Na.crosscorrelation(r,i))})}),t}static dft(e=[]){for(var t=6.283185307179586,r=[],n=[],i=[],s=0;s<e.length;s++){r.push(0),n.push(0);for(var a=0;a<e.length;a++){var o=t*s*a/e.length;r[s]=r[s]+e[a]*Math.cos(o),n[s]=n[s]-e[a]*Math.sin(o)}i.push(Math.sqrt(r[s]*r[s]+n[s]*n[s]))}function l(u){return[...u.slice(Math.ceil(u.length*.5),u.length),...u.slice(0,Math.ceil(u.length*.5))]}i=l(i);let c=i.length*.5,f=i.map((u,d)=>d-c);return{real:r,imag:n,freqs:f,mags:i}}static sma(e=[],t){for(var r=[],n=0;n<e.length;n++)if(n==0)r.push(e[0]);else if(n<t){var i=e.slice(0,n+1);r.push(i.reduce((s,a)=>a+=s)/(n+1))}else{var i=e.slice(n-t,n);r.push(i.reduce((a,o)=>o+=a)/t)}return r}static sum(e=[]){if(e.length>0){var t=e.reduce((r,n)=>n+=r);return t}else return 0}static reduceArrByFactor(e,t=2){return e.filter((n,i)=>i%t===0)}static makeArr(e,t,r){for(var n=[],i=(t-e)/(r-1),s=0;s<r;s++)n.push(e+i*s);return n}static autoscale(e,t=1,r=0,n=!1){if(e?.length===0)return e;let i=Math.max(...e),s=Math.min(...e),a=1/t,o;if(n){let l=Math.max(Math.abs(s),Math.abs(i));return o=a/l,e.map(c=>c*o+(a*(r+1)*2-1-a))}else return o=a/(i-s),e.map(l=>2*((l-s)*o-1/(2*t))+(a*(r+1)*2-1-a))}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t,r=1){if(e.length>t){let n=new Array(t),i=e.length/t,s=e.length-1,a=0,o=0;for(let l=i;l<e.length;l+=i){let c=Math.round(l);c>s&&(c=s);for(let f=a;f<c;f++)n[o]+=e[f];n[o]/=(c-a)*r,o++,a=c}return n}else return e}static interpolateArray(e,t,r=1){var n=function(u,d,p){return(u+(d-u)*p)*r},i=new Array,s=(e.length-1)/(t-1);i[0]=e[0];for(var a=1;a<t-1;a++){var o=a*s,l=Math.floor(o),c=Math.ceil(o),f=o-l;i[a]=n(e[l],e[c],f)}return i[t-1]=e[e.length-1],i}static isExtrema(e,t="peak"){let r=[...e];if(r.length%2===0&&r.pop(),e.length>1){let n=!0;for(let i=0;i<r.length;i++){let s=r[i];if(t==="peak"){if(i<Math.floor(r.length*.5)&&s>=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&s>=r[Math.floor(r.length*.5)]){n=!1;break}}else if(t==="valley"){if(i<Math.floor(r.length*.5)&&s<=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&s<=r[Math.floor(r.length*.5)]){n=!1;break}}else if(i<Math.floor(r.length*.5)&&s<=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&s<=r[Math.floor(r.length*.5)]){n=!1;break}}if(t!=="peak"&&t!=="valley"&&n===!1){n=!0;for(let i=0;i<r.length;i++){let s=r[i];if(i<Math.floor(r.length*.5)&&s>=r[Math.floor(r.length*.5)]){n=!1;break}else if(i>Math.floor(r.length*.5)&&s>=r[Math.floor(r.length*.5)]){n=!1;break}}}return n}else return}static isCriticalPoint(e,t="peak"){let r=[...e];if(r.length%2===0&&r.pop(),e.length>1){let n=!0;for(let i=0;i<r.length;i++){let s=r[i];if(t==="peak"){if(i<r.length*.5&&s<=0){n=!1;break}else if(i>r.length*.5&&s>0){n=!1;break}}else if(t==="valley"){if(i<r.length*.5&&s>=0){n=!1;break}else if(i>r.length*.5&&s<0){n=!1;break}}else if(i<r.length*.5&&s>=0){n=!1;break}else if(i>r.length*.5&&s<0){n=!1;break}}if(t!=="peak"&&t!=="valley"&&n===!1){n=!0;for(let i=0;i<r.length;i++){let s=r[i];if(i<r.length*.5&&s<=0){n=!1;break}else if(i>r.length*.5&&s>0){n=!1;break}}}return n}else return}static getPeakThreshold(e,t,r){let n,i=e.filter((s,a)=>{if(t.indexOf(a)>-1)return!0});return r===0?n=this.mean(i):n=(r+this.mean(i))*.5,n}static column(e,t){let r=new Array(e.length).fill(0).map(()=>new Array(1).fill(0));for(let n=0;n<e.length;n++)r[n][0]=e[n][t];return r}static flatten_vector(e){let t=[];for(let r=0;r<e.length;r++)t[r]=e[r][0];return t}static squared_difference(e,t){let r=0;for(let n=0;n<e.length;n++)r=r+Math.pow(e[n]-t[n],2);return r}static shift_deflate(e,t,r){let n=Math.sqrt(this.matmul(this.transpose(r),r)),i=this.matscale(r,1/n),s=this.matscale(this.matmul(i,this.transpose(i)),t);return this.matsub(e,s)}static eigenvalue_of_vector(e,t){return ev=this.matmul(this.matmul(this.transpose(t),e),t),ev}static power_iteration(e,t=1e-5,r=1e3){let n=e.length,i=new Array(n).fill(0).map(()=>new Array(1).fill(Math.sqrt(n))),s=this.eigenvalue_of_vector(e,i),a=1,o=0;for(;a>t&&o<r;){let l=JSON.parse(JSON.stringify(s)),c=this.matmul(e,i);i=this.normalize(c),s=this.eigenvalue_of_vector(e,i),a=Math.abs(s-l),o++}return[s,i]}static eigens(e,t=1e-4,r=1e3){let n=[],i=[];for(let s=0;s<e.length;s++){let a=this.power_iteration(e,t,r),o=a[0],l=a[1];n[s]=o,i[s]=this.flatten_vector(l),e=this.shift_deflate(e,o,l)}return[n,i]}static pca(e,t=1e-5){let r=e.length,n=new Array(r),i=new Array(r),s=this.transpose(e);n[0]=this.column(e,0);let a=1,o=0;for(;espilon>t;){o++,i[0]=this.matmul(s,n[0]);let c=this.matmul(this.transpose(n[0]),n[0]);i[0]=this.matscale(i[0],1/c);let f=Math.sqrt(this.matmul(this.transpose(i[0]),i[0]));i[0]=this.matscale(i[0],1/f);let u=this.matmul(e,i[0]),d=this.matmul(this.transpose(i[0]),i[0]);u=this.matscale(u,1/d),a=this.squared_difference(n[0],u),n[0]=JSON.parse(JSON.stringify(u))}return this.matmul(this.transpose(n[0]),n[0])}static circularBuffer(e,t){if(Array.isArray(t))if(t.length<e.length){let r=e.slice(t.length),n=e.length;e.splice(0,n,...r,...t)}else if(t.length>e.length){let r=e.length;e.splice(0,r,t.slice(r-t.length))}else e.splice(0,e.length,...t);else e.push(t),e.shift();return e}static HSLToRGB(e,t,r,n=255){t/=100,r/=100;let i=(1-Math.abs(2*r-1))*t,s=i*(1-Math.abs(e/60%2-1)),a=r-i/2,o=0,l=0,c=0;return 0<=e&&e<60?(o=i,l=s,c=0):60<=e&&e<120?(o=s,l=i,c=0):120<=e&&e<180?(o=0,l=i,c=s):180<=e&&e<240?(o=0,l=s,c=i):240<=e&&e<300?(o=s,l=0,c=i):300<=e&&e<360&&(o=i,l=0,c=s),o=(o+a)*n,l=(l+a)*n,c=(c+a)*n,[o,l,c]}static p300(e=[],t=[],r=[],n=256){let i=Math.floor(n/10),s=this.sma(t,i),a=this.peakDetect(s,"peak",i),o=this.mean(s),l=this.std(s,o),c=0,f=[];return a.length>0&&e.forEach((u,d)=>{for(;r[a[c]]<u+200&&(c++,!!a[c]););let p=0,_=[];for(;r[a[c+p]]<u+600&&(_.push(c+p),p++,!!a[c+p]););if(_.length>1){let w=[];_.forEach(O=>{w.push(s[a[O]])});let k=Math.max(...w),S=_[w.indexOf(k)];f.push({event_timestamp:u,event_index:d,peak_timestamp:r[[a[S]]],signal_index:[a[S]],signal_amplitude:t[[a[S]]],zscore:(s[a[S]]-o)/l})}else _.length===1&&f.push({event_timestamp:u,event_index:d,peak_timestamp:r[a[_[0]]],signal_index:a[_[0]],signal_amplitude:t[[a[_[0]]]],zscore:(s[a[_[0]]]-o)/l})}),f}},Ft=Na;Wt(Ft,"TWO_PI",Math.PI*2);Wt(Ft,"C",299792458);Wt(Ft,"G",66743e-15);Wt(Ft,"h",662607015e-42);Wt(Ft,"R",8314.32);Wt(Ft,"Ra",287);Wt(Ft,"H",69.3);Wt(Ft,"kbar",1054571817e-43);Wt(Ft,"kB",1380649e-29);Wt(Ft,"ke",89875517923e-1);Wt(Ft,"me",91093837015e-41);Wt(Ft,"mp",167262192369e-38);Wt(Ft,"mn",167492749804e-38);Wt(Ft,"P0",101325);Wt(Ft,"T0",288.15);Wt(Ft,"p0",1.225);Wt(Ft,"Na",60220978e16);Wt(Ft,"y",1.405);Wt(Ft,"M0",28.96643);Wt(Ft,"g0",9.80665);Wt(Ft,"Re",6378100);Wt(Ft,"B",1458e-9);Wt(Ft,"S",110.4);Wt(Ft,"Sigma",365e-12);Wt(Ft,"imgkernels",{edgeDetection:[[-1,-1,-1],[-1,8,-1],[-1,-1,-1]],boxBlur:[[1/9,1/9,1/9],[1/9,1/9,1/9],[1/9,1/9,1/9]],sobelLeft:[[1,0,-1],[2,0,-2],[1,0,-1]],sobelRight:[[-1,0,1],[-2,0,2],[-1,0,1]],sobelTop:[[1,2,1],[0,0,0],[-1,-2,-1]],sobelBottom:[[-1,2,1],[0,0,0],[1,2,1]],identity:[[0,0,0],[0,1,0],[0,0,0]],gaussian3x3:[[1,2,1],[2,4,2],[1,2,1]],guassian7x7:[[0,0,0,5,0,0,0],[0,5,18,32,18,5,0],[0,18,64,100,64,18,0],[5,32,100,100,100,32,5],[0,18,64,100,64,18,0],[0,5,18,32,18,5,0],[0,0,0,5,0,0,0]],emboss:[[-2,-1,0],[-1,1,1],[0,1,2]],sharpen:[[0,-1,0],[-1,5,-1],[0,-1,0]]});Wt(Ft,"integral",(e=n=>n,t=[],r=.01)=>{let n=0;for(let i=t[0];i<t[1];i+=r){let s=e(i);n+=s*r}return n});Wt(Ft,"dintegral",(e=(i,s)=>i+s,t=[[],[]],r=.01,n=r)=>{let i=0;for(let s=t[0][0]+r;s<t[0][1];s+=r)for(let a=t[1][0]+n;a<t[1][1];a+=n){let o=e(s,a);i+=o*r*n}return i});Wt(Ft,"tintegral",(e=(s,a,o)=>s+a+o,t=[[],[],[]],r=.01,n=r,i=r)=>{let s=0;for(let a=t[0][0]+r;a<t[0][1];a+=r)for(let o=t[1][0]+n;o<t[1][1];o+=n)for(let l=t[2][0]+i;l<t[2][1];l+=i){let c=e(a,o,l);s+=c*r*n*i}return s});Wt(Ft,"pintegral",(e=n=>n,t=[],r=.01)=>{let n=0,i,s;for(let a=t[0];a<t[1];a+=r)i=s,s=e(a),i&&(n+=Na.distance([0,i],[r,s]));return n});Wt(Ft,"meshgrid",Na.generateCoordinateSpace);Wt(Ft,"autocorrelation2d",e=>{let t=[];for(let r=0;r<e.length;r++){t.push([]);for(let n=0;n<e[r].length;n++){let i=0;for(let s=0;s<e.length;s++)for(let a=0;a<e[s].length;a++)i+=e[r][n]*e[e.length-1-s][e[r].length-1-a];t[r][n]=i}}return t});Wt(Ft,"lerp",Na.makeArr);Wt(Ft,"upsample",Na.interpolateArray);Wt(Ft,"lerp",(e,t,r,n=!0)=>{function i(a,o,l){return(1-l)*a+l*o}function s(a,o,l,c=!0){if(l<=2)return[a,o];let f=1/l,u=new Array(l);u[0]=a;for(let d=1;d<=l;d++)u[d]=i(a,o,f*d),c&&(u[d]=Math.floor(u[d]));return u}});Wt(Ft,"peakDetect",(e,t="peak",r=49)=>{let n=Math.floor(r*.5),i=[];for(let s=0;s<e.length-r;s++)Na.isExtrema(e.slice(s,s+r),t)&&i.push(s+n-1);return i});Object.assign(Math,Ft);var WPe={accelConstant:1/8192,gyroConstant:1/65.5,gyroXAngle:0,gyroYAngle:0,gyroZAngle:0,px:0,py:0,pz:0,sps:100,lastAccelTime:Date.now(),lastGyroTime:Date.now(),__operator:function(e){if(!("ax"in e)&&!("gx"in e))return;if(!e.timestamp)if(e.ax&&Array.isArray(e.ax)||e.gx&&Array.isArray(e.gx)){let r=e.ax?e.ax.length:e.gx.length,n=Date.now(),i=[n-r*this.sps*1e3,n];e.timestamp=Ft.upsample(i,r)}else e.timestamp=Date.now();let t;if(e.ax){let r=(n,i,s,a)=>{i=i*this.accelConstant,s=s*this.accelConstant,a=a*this.accelConstant;let o=Math.atan(s/Math.sqrt(i*i)+a*a*180/Math.PI)+this.accelXError,l=Math.atan(-i/Math.sqrt(s*s)+a*a*180/Math.PI)+this.accelYError;return{ax:i,ay:s,az:a,roll:o,pitch:l}};Array.isArray(e.timestamp)?t=e.timestamp.map((n,i)=>r(n,e.ax[i],e.ay[i],e.az[i])):t=r(e.timestamp,e.ax,e.ay,e.az)}if(e.gx){let r=(i,s,a,o)=>{let l=i-this.lastGyroTime;return this.lastGyroTime=i,s=s*this.gyroConstant+this.gyroXError,a=a*this.gyroConstant+this.gyroYError,o=o*this.gyroConstant+this.gyroZError,this.gyroXAngle+=s*l,this.gyroYAngle+=a*l,this.gyroZAngle+=o*l,{gx:s,gy:a,gz:o,roll:this.gyroXAngle,pitch:this.gyroYAngle,yaw:this.gyroZAngle}},n;Array.isArray(e.timestamp)?(n=e.timestamp.map((i,s)=>{if(t){let a=r(i,e.gx[s],e.gy[s],e.gz[s]);t.roll=t.roll*.04+a.roll*.96,t.pitch=t.pitch*.04+a.pitch*.96,t.yaw=n.yaw}else return r(i,e.gx[s],e.gy[s],e.gz[s])}),t||(t=n)):(n=r(e.timestamp,e.gx,e.gy,e.gz),t?(t.roll=t.roll*.04+n.roll*.96,t.pitch=t.pitch*.04+n.pitch*.96,t.yaw=n.yaw):t=n)}else(this.gyroXAngle||this.gyroYAngle||this.gyroZAngle)&&(t.roll=t.roll*.04+this.gyroXAngle*.96,t.pitch=t.pitch*.04+this.gyroYAngle*.96,t.yaw=this.gyroXAngle);if(t.ax){let r=(n,i)=>{let s=n-this.lastAccelTime;return this.lastAccelTime=n,this.px+=i.ax*s*s*Math.cos(this.pitch*Math.PI*.005555555555),this.py+=i.ay*s*s*Math.cos(this.roll*Math.PI*.005555555555),this.pz+=i.az*s*s*Math.sin(this.pitch*Math.PI*.005555555555),i.px=this.px,i.py=this.py,i.pz=this.pz,i};Array.isArray(e.timestamp)?e.timestamp.map((n,i)=>{r(n,t)}):r(e.timestamp,t)}return t}},lee=class{type;freq;sps;Q;dbGain;a0=0;a1=0;a2=0;b0=0;b1=0;b2=0;x1=0;x2=0;y1=0;y2=0;constructor(e,t,r,n=1/Math.sqrt(2),i=0){if(["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"].indexOf(e)<0){console.error("Valid types: 'lowpass','highpass','bandpass','notch','peak','lowshelf','highshelf'");return}this.type=e,this.freq=t,this.sps=r,this.Q=n,this.dbGain=i;let a=Math.pow(10,i/40),o=2*Math.PI*t/r,l=Math.sin(o),c=Math.cos(o),f=l/(2*n),u=Math.sqrt(a+a);this[e](a,l,c,f,u),this.b0/=this.a0,this.b1/=this.a0,this.b2/=this.a0,this.a1/=this.a0,this.a2/=this.a0}lowpass(e,t,r,n,i){this.b0=(1-r)*.5,this.b1=1-r,this.b2=(1-r)*.5,this.a0=1+n,this.a1=-2*r,this.a2=1-n}highpass(e,t,r,n,i){this.b0=(1+r)*.5,this.b1=-(1+r),this.b2=(1+r)*.5,this.a0=1+n,this.a1=-2*r,this.a2=1-n}bandpass(e,t,r,n,i){this.b0=n,this.b1=0,this.b2=-n,this.a0=1+n,this.a1=-2*r,this.a2=1-n}notch(e,t,r,n,i){this.b0=1,this.b1=-2*r,this.b2=1,this.a0=1+n,this.a1=-2*r,this.a2=1-n}peak(e,t,r,n,i){this.b0=1+n*e,this.b1=-2*r,this.b2=1-n*e,this.a0=1+n/e,this.a1=-2*r,this.a2=1-n/e}lowshelf(e,t,r,n,i){this.b0=e*(e+1-(e-1)*r+i*t),this.b1=2*e*(e-1-(e+1)*r),this.b2=e*(e+1-(e-1)*r-i*t),this.a0=e+1+(e+1)*r+i*t,this.a1=2*(e-1+(e+1)*r),this.a2=e+1+(e-1)*r-i*t}highshelf(e,t,r,n,i){this.b0=e*(e+1+(e-1)*r+i*t),this.b1=2*e*(e-1+(e+1)*r),this.b2=e*(e+1-(e-1)*r-i*t),this.a0=e+1-(e+1)*r-i*t,this.a1=2*(e-1-(e+1)*r),this.a2=e+1-(e-1)*r-i*t}applyFilter(e){let t=this.b0*e+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;return this.x2=this.x1,this.x1=e,this.y2=this.y1,this.y1=t,t}zResult(e){try{let t=Math.pow(Math.sin(Math.PI*e*2/(2*this.sps)),2);return(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*t+16*this.b0*this.b2*t*t)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*t+16*this.a2*t*t)}catch{return-200}}static calcCenterFrequency(e,t){return(e+t)/2}static calcBandwidth(e,t){return t-this.calcCenterFrequency(e,t)}static calcBandpassQ(e,t,r=Math.pow(10,Math.floor(Math.log10(e)))){return r*Math.sqrt((e-t)*(e+t))/(2*t)}static calcNotchQ(e,t,r=Math.pow(10,Math.floor(Math.log10(e)))){return r*e*t/Math.sqrt((e-t)*(e+t))}},nF={refdata:[],lowpass:void 0,smoothed:[],timestamp:[],peaks:[],valleys:[],peak_distances:[],valley_distances:[],beats:[],lastPeak:0,lastValley:0,sps:100,maxFreq:4,limit:10,__onconnected:function(){if(!this.lowpass){let e=this.maxFreq;e||(e=1),e>1&&(e*=.5),this.lowpass=new lee("lowpass",this.maxFreq,this.sps),this.peakFinderWindow=Math.floor(this.sps/this.maxFreq),this.peakFinderWindow%2===0&&(this.peakFinderWindow+=1),this.peakFinderWindow<5&&(this.peakFinderWindow=5),this.midpoint=Math.round(this.peakFinderWindow*.5)}},__operator:function(e){if(!("red"in e)&&!("heg"in e)&&!("raw"in e))return;let t=e.red?e.red:e.heg?e.heg:e.raw;if(!("timestamp"in e))if(Array.isArray(t)){let n=Date.now(),i;t&&(i=t.length);let s=[n-t.length*this.sps*1e3,n];e.timestamp=Ft.upsample(s,t.length)}else e.timestamp=Date.now();let r=(n,i)=>{n&&this.refdata.push(n),this.timestamp.push(i);let s;if(this.refdata.length>this.peakFinderWindow&&(this.refdata.shift(),this.timestamp.shift()),this.smoothed.push(this.lowpass.applyFilter(this.refdata[this.refdata.length-1])),this.smoothed.length>this.peakFinderWindow&&this.smoothed.shift(),this.smoothed.length===this.peakFinderWindow&&(Ft.isExtrema(this.smoothed,"valley")?this.valleys.push({value:this.smoothed[this.smoothed.length-this.midpoint?this.midpoint:1],timestamp:this.timestamp[this.timestamp.length-this.midpoint?this.midpoint:1]}):Ft.isExtrema(this.smoothed,"peak")&&this.peaks.push({value:this.smoothed[this.smoothed.length-this.midpoint?this.midpoint:1],timestamp:this.timestamp[this.timestamp.length-this.midpoint?this.midpoint:1]}),this.valleys.length>2&&this.peaks.length>2)){if(this.valleys[this.valleys.length-1].timestamp<this.peaks[this.peaks.length-2].timestamp&&this.peaks.splice(this.peaks.length-1),this.peaks[this.peaks.length-1].timestamp<this.valleys[this.valleys.length-2].timestamp&&this.valleys.splice(this.valleys.length-1),this.valley_distances.push({distance:this.valleys[this.valleys.length-1].timestamp-this.valleys[this.valleys.length-2].timestamp,timestamp:this.valleys[this.valleys.length-1].timestamp,peak0:this.valleys[this.valleys.length-1].value,peak1:this.valleys[this.valleys.length-2].value}),this.peak_distances.push({distance:this.peaks[this.peaks.length-1].timestamp-this.peaks[this.peaks.length-2].timestamp,timestamp:this.peaks[this.peaks.length-1].timestamp,peak0:this.peaks[this.peaks.length-1].value,peak1:this.peaks[this.peaks.length-2].value}),this.peak_distances.length>1&&this.valley_distances.length>1&&this.lastPeak<this.peaks[this.peaks.length-1].timestamp&&this.lastValley<this.peaks[this.peaks.length-1].timestamp)if(this.valley_distances[this.valley_distances.length-1].timestamp>this.peak_distances[this.peak_distances.length-1].timestamp){let a,o=0;this.beats.length<1?a=60/(5e-4*(this.peak_distances[this.peak_distances.length-1].distance+this.valley_distances[this.valley_distances.length-1].distance)):this.beats[this.beats.length-1].timestamp!==this.peak_distances[this.peak_distances.length-1].timestamp&&(a=60/(5e-4*(this.peak_distances[this.peak_distances.length-1].dt+this.valley_distances[this.valley_distances.length-1].dt)),o=Math.abs(a-this.beats[this.beats.length-1].bpm)),s={timestamp:this.peak_distances[this.peak_distances.length-1].timestamp,change:o,bpm:a,height0:this.peak_distances[this.peak_distances.length-1].peak0-this.valley_distances[this.valley_distances.length-1].peak0,height1:this.peak_distances[this.peak_distances.length-1].peak1-this.valley_distances[this.valley_distances.length-1].peak1},this.beats.push(s),this.lastPeak=this.peaks[this.peaks.length-1].timestamp,this.lastValley=this.peaks[this.peaks.length-1].timestamp}else{let a,o=0;this.beats.length<2?a=60/(5e-4*(this.peak_distances[this.peak_distances.length-2].distance+this.valley_distances[this.valley_distances.length-2].distance)):this.beats[this.beats.length-1].timestamp!==this.peak_distances[this.peak_distances.length-2].timestamp&&(a=60/(5e-4*(this.peak_distances[this.peak_distances.length-2].distance+this.valley_distances[this.valley_distances.length-2].distance)),o=Math.abs(a-this.beats[this.beats.length-2].bpm)),s={timestamp:this.peak_distances[this.peak_distances.length-2].timestamp,change:o,bpm:a,height0:this.peak_distances[this.peak_distances.length-2].peak0-this.valley_distances[this.valley_distances.length-2].peak0,height1:this.peak_distances[this.peak_distances.length-2].peak1-this.valley_distances[this.valley_distances.length-2].peak1},Array.isArray(s.timestamp)&&(s.timestamp=s.timestamp[0]),this.beats.push(s),this.lastPeak=this.peaks[this.peaks.length-1].timestamp,this.lastValley=this.peaks[this.peaks.length-1].timestamp}this.peaks.length>this.limit&&this.peaks.shift(),this.valleys.length>this.limit&&this.valleys.shift(),this.peak_distances.length>this.limit&&this.peak_distances.shift(),this.valley_distances.length>this.limit&&this.valley_distances.shift(),this.beats.length>this.limit&&this.beats.shift()}return s};if(e.red){if("ir"in e&&!Array.isArray(e.red))return r(e.red+e.ir,e.timestamp);let n;return e.ir?n=e.red.map((i,s)=>r(i+e.ir[s],e.timestamp[s])).filter(i=>{if(i)return!0}):n=e.red.map((i,s)=>r(i,e.timestamp[s])).filter(i=>{if(i)return!0}),n}else{if(e.raw)return Array.isArray(e.raw)?e.raw.map((i,s)=>r(i,e.timestamp[s])).filter(i=>{if(i)return!0}):r(e.raw,e.timestamp);if(Array.isArray(e.heg))return Array.isArray(e.heg)?e.heg.map((i,s)=>r(i,e.timestamp[s])).filter(i=>{if(i)return!0}):r(e.heg,e.timestamp)}}},JPe={sps:250,intervals:{},watch:["0"],tolerance:.2,__onconnected:e=>{e.watch.forEach(t=>e.intervals[t]={lowpass:new lee("lowpass",20,e.sps),filtered:[],averaged:[]})},__operator:function(e){let t=5,r=50,n={},i=!1,s=(a,o)=>{let l=this.intervals[a].lowpass.applyFilter(o);if(this.intervals[a].filtered.push(l),this.intervals[a].averaged.push(l),this.intervals[a].filtered.length>t)if(this.intervals[a].averaged.length>r){this.intervals[a].averaged.splice(0,t);let c=Ft.mean(this.intervals[a].averaged);Math.abs(Math.min(...this.intervals[a].filtered))>Math.abs(c)+this.tolerance&&(this.intervals[a].filtered.length=0,i=!0,n[a]=!0)}else this.intervals[a].filtered.shift()};for(let a in this.intervals)e[a]&&(Array.isArray(e[a])?e[a].forEach(o=>{s(a,o)}):typeof e[a]=="number"&&s(a,e[a]));if(i)return n}},gv=class{static autoscale(e,t=0,r=1,n=!1,i,s,a){if(e?.length===0)return e;let o=s||Math.max(...e),l=i||Math.min(...e),c=1/r,f=1;if(n){let u=Math.max(Math.abs(l),Math.abs(o));return u!==0&&(f=c/u),e.map(d=>(a&&(d<l&&(d=l),d>o&&(d=o)),d*f+(c*(t+1)*2-1-c)))}else return o===l?o!==0?f=c/o:l!==0&&(f=c/Math.abs(l)):f=c/(o-l),e.map(u=>(a&&(u<l&&(u=l),u>o&&(u=o)),2*((u-l)*f-1/(2*r))+(c*(t+1)*2-1-c)))}static genTimestamps(e,t){let r=Date.now(),n=[r-e*1e3/t,r];return gv.upsample(n,e)}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,t,r=1){if(e.length>t){let n=new Array(t),i=e.length/t,s=e.length-1,a=0,o=0;for(let l=i;l<e.length;l+=i){let c=Math.round(l);c>s&&(c=s);for(let f=a;f<c;f++)n[o]+=e[f];n[o]/=(c-a)*r,o++,a=c}return n}else return e}static upsample(e,t,r=1){var n=function(u,d,p){return(u+(d-u)*p)*r},i=new Array(t),s=(e.length-1)/(t-1);i[0]=e[0];for(var a=1;a<t-1;a++){var o=a*s,l=Math.floor(o),c=Math.ceil(o),f=o-l;i[a]=n(e[l],e[c],f)}return i[t-1]=e[e.length-1],i}static interpolate(e,t,r=1){return e.length>t?gv.downsample(e,t,r):e.length<t?gv.upsample(e,t,r):e}static HSLToRGB(e,t,r,n=255){t/=100,r/=100;let i=(1-Math.abs(2*r-1))*t,s=i*(1-Math.abs(e/60%2-1)),a=r-i/2,o=0,l=0,c=0;return 0<=e&&e<60?(o=i,l=s,c=0):60<=e&&e<120?(o=s,l=i,c=0):120<=e&&e<180?(o=0,l=i,c=s):180<=e&&e<240?(o=0,l=s,c=i):240<=e&&e<300?(o=s,l=0,c=i):300<=e&&e<360&&(o=i,l=0,c=s),o=(o+a)*n,l=(l+a)*n,c=(c+a)*n,[o,l,c]}static circularBuffer(e,t){if(t.length<e.length){let r=e.slice(t.length),n=e.length;e.splice(0,n,...r,...t)}else if(t.length>e.length){let r=e.length;e.splice(0,r,...t.slice(t.length-r))}else e.splice(0,e.length,...t);return e}static reformatData(e,t){if(Array.isArray(e)){if(Array.isArray(e[0])){let r={};if(e.forEach((n,i)=>{r[i]=n}),e=r,isNaN(e[0][0]))return}else if(t){if(e={[t]:e},isNaN(e[t][0]))return}else if(e={0:e},isNaN(e[0][0]))return}else if(typeof e=="object"){for(let r in e)if(typeof e[r]=="number"?e[r]=[e[r]]:e[r]?.values&&typeof e[r].values=="number"&&(e[r].values=[e[r].values]),isNaN(e[r][0]))return}else if(typeof e=="string"){let r;if(e.includes(`\r
`)){let n=e.split(`\r
`);e={},n.forEach((i,s)=>{i.includes("	")?r=i.split("	"):i.includes(",")?r=i.split(","):i.includes("|")&&(r=i.split("|")),Array.isArray(r)&&r.forEach((a,o)=>{if(a.includes(":")){let[l,c]=a.split(":"),f=parseFloat(c);if(f)e[l]=[f];else return}else{let l=parseFloat(a);if(l)e[o]=[l];else return}})})}else e.includes("	")?r=e.split("	"):e.includes(",")?r=e.split(","):e.includes("|")&&(r=e.split("|"));e={},Array.isArray(r)&&r.forEach((n,i)=>{if(n.includes(":")){let[s,a]=n.split(":"),o=parseFloat(a);if(o)e[s]=[o];else return}else{let s=parseFloat(n);if(s)e[i]=[s];else return}})}else typeof e=="number"&&(t?e={[t]:[e]}:e={0:[e]});return e}static padTime(e,t,r,n){let i=(e[0]-t)/r/n;return[...new Array(n-e.length).map((a,o)=>t+i*(o+1)),...e]}static interpolateForTime(e,t,r){return gv.interpolate(e,Math.ceil(r*t))}isTypedArray(e){return ArrayBuffer.isView(e)&&Object.prototype.toString.call(e)!=="[object DataView]"}recursivelyAssign=(e,t)=>{for(let r in t)typeof t[r]=="object"?typeof e[r]=="object"?this.recursivelyAssign(e[r],t[r]):e[r]=this.recursivelyAssign({},t[r]):e[r]=t[r];return e};spliceTypedArray(e,t,r){let n=e.subarray(0,t),i;r&&(i=e.subarray(r+1));let s;return(n.length>0||i?.length>0)&&(s=new e.constructor(n.length+i.length)),n.length>0&&s.set(n),i&&i.length>0&&s.set(i,n.length),s}},cee=gv;zQ(cee,"bufferValues",(e,t,r,n)=>{if(!Array.isArray(r)&&typeof r=="object"&&(r=Object.keys(r)),!n){let s=Object.keys(e);r?n=new Float32Array(s.length*r.length):typeof e[s[0]][t]=="object"?(r=Object.keys(e[s[0]][t]),n=new Float32Array(s.length*r.length)):n=new Float32Array(s.length)}let i=0;for(let s in e)if(e[s][t])if(r)for(let a=0;a<r.length;a++)n[i]=e[s][t][r[a]],i++;else n[i]=e[s][t],i++;return n});var GPe=/^([<>])?(([1-9]\d*)?([xcbB?hHiIfdsp]))*$/,KPe=/([1-9]\d*)?([xcbB?hHiIfdsp])/g,iF=(e,t,r)=>String.fromCharCode(...new Uint8Array(e.buffer,e.byteOffset+t,r)),sF=(e,t,r,n)=>new Uint8Array(e.buffer,e.byteOffset+t,r).set(n.split("").map(i=>i.charCodeAt(0))),YPe=(e,t,r)=>iF(e,t+1,Math.min(e.getUint8(t),r-1)),XPe=(e,t,r,n)=>{e.setUint8(t,n.length),sF(e,t+1,r-1,n)},ZPe=e=>({x:t=>[1,t,0],c:t=>[t,1,r=>({u:n=>iF(n,r,1),p:(n,i)=>sF(n,r,1,i)})],"?":t=>[t,1,r=>({u:n=>!!n.getUint8(r),p:(n,i)=>n.setUint8(r,i)})],b:t=>[t,1,r=>({u:n=>n.getInt8(r),p:(n,i)=>n.setInt8(r,i)})],B:t=>[t,1,r=>({u:n=>n.getUint8(r),p:(n,i)=>n.setUint8(r,i)})],h:t=>[t,2,r=>({u:n=>n.getInt16(r,e),p:(n,i)=>n.setInt16(r,i,e)})],H:t=>[t,2,r=>({u:n=>n.getUint16(r,e),p:(n,i)=>n.setUint16(r,i,e)})],i:t=>[t,4,r=>({u:n=>n.getInt32(r,e),p:(n,i)=>n.setInt32(r,i,e)})],I:t=>[t,4,r=>({u:n=>n.getUint32(r,e),p:(n,i)=>n.setUint32(r,i,e)})],f:t=>[t,4,r=>({u:n=>n.getFloat32(r,e),p:(n,i)=>n.setFloat32(r,i,e)})],d:t=>[t,8,r=>({u:n=>n.getFloat64(r,e),p:(n,i)=>n.setFloat64(r,i,e)})],s:t=>[1,t,r=>({u:n=>iF(n,r,t),p:(n,i)=>sF(n,r,t,i.slice(0,t))})],p:t=>[1,t,r=>({u:n=>YPe(n,r,t),p:(n,i)=>XPe(n,r,t,i.slice(0,t-1))})]}),$Q=new RangeError("Structure larger than remaining buffer"),QPe=new RangeError("Not enough values for structure"),qh=class extends cee{static toDataView(e){if(!(e instanceof DataView))if(typeof e=="string"&&parseInt(e)&&(e=parseInt(e)),typeof e=="string"){let t=new TextEncoder,r={};for(let i in qh.codes)for(;e.indexOf(i)>-1;){let s=e.indexOf(i);e=e.replace(i,""),r[s]=i}let n=Array.from(t.encode(e));for(let i in r)n.splice(parseInt(i),0,qh.codes[r[i]]);e=new DataView(new Uint8Array(n).buffer)}else if(typeof e=="number"){let t=e;e<256?(e=new DataView(new ArrayBuffer(1)),e.setUint8(0,t)):e<65536?(e=new DataView(new ArrayBuffer(2)),e.setInt16(0,t)):(e=new DataView(new ArrayBuffer(4)),e.setUint32(0,t))}else e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer?e=new DataView(e):Array.isArray(e)?e=new DataView(Uint8Array.from(e).buffer):typeof e=="object"&&(e=new TextEncoder().encode(JSON.stringify(e)));return e}static searchBuffer(e,t,r){for(var n=t,i=e,s=qh.boyerMoore(n),a=s.byteLength,o=[],l=s(i);l!==-1&&(o.push(l),!(r&&o.length>=r));l=s(i,l+a));return o}static bytesToInt16(e,t){let r=(255&e)<<8|255&t;return(r&32768)>0?r|=4294901760:r&=65535,r}static bytesToUInt16(e,t){return e*256+t}static Uint16ToBytes(e){return[e&255,e>>8&255]}static bytesToInt24(e,t,r){let n=(255&e)<<16|(255&t)<<8|255&r;return(n&8388608)>0?n|=4278190080:n&=16777215,n}static bytesToUInt24(e,t,r){return e*65536+t*256+r}static Uint24ToBytes(e){return[e&255,e>>8&255,e>>16&255]}static bytesToInt32(e,t,r,n){let i=(255&e)<<24|(255&t)<<16|(255&r)<<8|255&n;return(i&2147483648)>0?i|=0:i&=4294967295,i}static bytesToUInt32(e,t,r,n){return e*16777216+t*65536+r*256+n}static Uint32ToBytes(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]}static get2sCompliment(e,t){return e>4294967296?null:e<<32-t>>32-t}static getSignedInt(...e){let t=0;function r(n){for(var i=0,s=!0;n--;)if(s){let a=e[t++];i+=a&127,a&128&&(i-=128),s=!1}else i*=256,i+=e[t++];return i}return r(e.length)}static asUint8Array(e){if(e instanceof Uint8Array)return e;if(typeof e=="string"){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n>127)throw new TypeError("Only ASCII patterns are supported");t[r]=n}return t}else return new Uint8Array(e)}static boyerMoore(e){var t=qh.asUint8Array(e),r=t.length;if(r===0)throw new TypeError("patternBuffer must be at least 1 byte long");for(var n=256,i=new Int32Array(n),s=0;s<n;s++)i[s]=-1;for(var a=0;a<r;a++)i[t[a]]=a;var o=(l,c,f)=>{var u=qh.asUint8Array(l);c===void 0&&(c=0),f===void 0&&(f=u.length);for(var d=t,p=i,_=f-d.length,w=d.length-1,k,S=c;S<=_;S+=k){k=0;for(var O=w;O>=0;O--){var A=u[S+O];if(d[O]!==A){k=Math.max(1,O-p[A]);break}}if(k===0)return S}return-1};return o.byteLength=t.byteLength,o}static struct(e){let t=[],r=0,n=GPe.exec(e);if(!n)throw new RangeError("Invalid format string");let i=ZPe(n[1]==="<"),s=(u,d)=>i[d](u?parseInt(u,10):1);for(;n=KPe.exec(e);)((u,d,p)=>{for(let _=0;_<u;++_,r+=d)p&&t.push(p(r))})(...s(...n.slice(1)));let a=(u,d)=>{if(u.byteLength<(d|0)+r)throw $Q;let p=new DataView(u,d|0);return t.map(_=>_.u(p))},o=(u,d,...p)=>{if(p.length<t.length)throw QPe;if(u.byteLength<d+r)throw $Q;let _=new DataView(u,d);new Uint8Array(u,d,r).fill(0),t.forEach((w,k)=>w.p(_,p[k]))},l=(...u)=>{let d=new ArrayBuffer(r);return o(d,0,...u),d},c=u=>a(u,0);function*f(u){for(let d=0;d+r<=u.byteLength;d+=r)yield a(u,d)}return Object.freeze({unpack:c,pack:l,unpack_from:a,pack_into:o,iter_unpack:f,format:e,size:r})}},fF=qh;zQ(fF,"codes",{"\\n":10,"\\r":13,"\\t":9,"\\s":32,"\\b":8,"\\f":12,"\\":92});var eLe={sps:250,nSec:1,watch:["0","1","2","3"],data:{},rms:{},__operator:function(e){return this.watch.forEach(t=>{e[t]&&(this.data[t]||(Array.isArray(e[t])?this.data[t]=new Array(Math.floor(this.sps*this.nSec)).fill(e[t][0]):this.data[t]=new Array(Math.floor(this.sps*this.nSec)).fill(e[t])),fF.circularBuffer(this.data[t],e[t]))}),e.timestamp?Array.isArray(e.timestamp)?this.rms.timestamp=e.timestamp[e.timestamp.length-1]:this.rms.timestamp=e.timestamp:this.rms.timestamp=Date.now(),new Promise(async t=>{await Promise.all(this.watch.map(async r=>{this.data[r]?this.rms[r]=Math.sqrt(Math.abs(this.data[r].reduce((n,i,s)=>n+i*i)/this.data[r].length)):delete this.rms[r]})),t(this.rms)})}},tLe={bufferSize:250,watch:["0","1","2","3"],data:{},blocking:!1,__onconnected:function(e){for(let t in e.watch)e.data[t]=new Array(e.bufferSize).fill(0)},__operator:function(e){let t=[];return this.watch.forEach(r=>{e[r]&&(fF.circularBuffer(this.data[r],e[r]),t.push(this.data[r]))}),t}},rLe={beat_detect:nF,accel_gyro:WPe,heartrate:nF,breath:Object.assign({},nF),blink_detect:JPe,rms:eLe,circularBuffer2d:tLe};rLe.breath.maxFreq=.2;var hl=yF(["ctrlKey","metaKey","altKey","shiftKey","button","which","pointerType","clientX","clientY","pageX","pageY","movementX","movementY","x","y","which","timeStamp"]),nLe=yF(["deltaX","deltaY"]),iLe=yF(["ctrlKey","metaKey","shiftKey","altKey","isComposing","keyCode","key","code","repeat","timeStamp"]);function uee(e,t){let r={type:e.type};r.isTrusted=e.isTrusted,r.bubbles=e.bubbles,r.cancelBubble=e.cancelBubble,r.cancelable=e.cancelable,r.composed=e.composed,r.defaultPrevent=e.defaultPrevented,r.eventPhase=e.eventPhase,r.returnValue=e.returnValue,r.currentTarget=e.currentTarget.id?e.currentTarget.id:e.currentTarget.constructor.name,r.target=r.currentTarget,r.srcElement=r.currentTarget,t(r)}function sLe(e,t,r){r&&e.preventDefault&&e.preventDefault(),nLe(e,t)}function aLe(e,t,r){r&&e.preventDefault&&e.preventDefault()}function oLe(e,t,r){for(let n of t)r[n]=e[n]}function yF(e){return function(r,n){let i={type:r.type};oLe(r,e,i),n(i)}}function dF(e,t,r){r&&e.preventDefault&&e.preventDefault();let n=[],i={type:e.type,touches:n};for(let s=0;s<e.touches.length;++s){let a=e.touches[s];n.push({pageX:a.pageX,pageY:a.pageY})}t(i)}var pF=1,pee={};for(;pF<222;)pee[pF]=!0,pF++;function fee(e,t,r){let{keyCode:n}=e;pee[n]&&(r&&e.preventDefault&&(n<110||n>123)&&e.preventDefault(),iLe(e,t))}var yv={contextmenu:aLe,mousedown:hl,mousemove:hl,mouseup:hl,pointerdown:hl,pointermove:hl,pointerup:hl,pointerlockchange:hl,webkitpointerlockchange:hl,focus:uee,blur:uee,pointerout:hl,touchstart:dF,touchmove:dF,touchend:dF,wheel:sLe,keydown:fee,keyup:fee};function xx(e,t,r,n){r||(r="proxy"+Math.floor(Math.random()*1e15));let i=o=>{t?t.postMessage({route:"handleProxyEvent",args:[o,r]}):hee(o,r)},s=Object.entries(yv);for(let[o,l]of s)e.addEventListener(o,function(c){l(c,i,n)});yv.keydown&&globalThis.addEventListener("keydown",function(o){yv.keydown(o,i,n)}),yv.keyup&&globalThis.addEventListener("keyup",function(o){yv.keyup(o,i,n)});let a=()=>{let o=e.getBoundingClientRect();i({type:"resize",left:o.left,top:o.top,width:e.clientWidth,height:e.clientHeight})};return a(),globalThis.addEventListener("resize",a),r}var hF=class{addEventListener(t,r){this.__listeners===void 0&&(this.__listeners={});let n=this.__listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(r)===-1&&n[t].push(r)}hasEventListener(t,r){if(this.__listeners===void 0)return!1;let n=this.__listeners;return n[t]!==void 0&&n[t].indexOf(r)!==-1}removeEventListener(t,r){if(this.__listeners===void 0)return;let i=this.__listeners[t];if(i!==void 0){let s=i.indexOf(r);s!==-1&&i.splice(s,1)}}dispatchEvent(t,r){if(this.__listeners===void 0)return;let i=this.__listeners[t.type];if(i!==void 0){r?t.target=r:t.target=this;let s=i.slice(0);for(let a=0,o=s.length;a<o;a++)s[a].call(this,t)}}};function dee(){}var gF=class extends hF{constructor(){super();this.__listeners={};this.style={};this.setPointerCapture=()=>{};this.releasePointerCapture=()=>{};this.getBoundingClientRect=()=>({left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height});this.handleEvent=r=>{r.type==="resize"&&(this.left=r.left,this.top=r.top,this.width=r.width,this.height=r.height,typeof this.proxied=="object"&&(this.proxied.style.width=this.width+"px",this.proxied.style.height=this.height+"px",this.proxied.clientWidth=this.width,this.proxied.clientHeight=this.height)),r.preventDefault=dee,r.stopPropagation=dee,this.dispatchEvent(r,this.proxied)};this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}focus(){}blur(){}},Vh=class{constructor(){this.targets={};this.makeProxy=(t,r=void 0)=>{t||(t=`proxyReceiver${Math.floor(Math.random()*1e15)}`);let n;this.targets[t]?n=this.targets[t]:(n=new gF,this.targets[t]=n),typeof r=="object"&&(r.proxy=n,n.proxied=r,typeof WorkerGlobalScope<"u"&&(r.style=n.style),n.width&&(r.style.width=n.width+"px",r.clientWidth=n.width),n.height&&(r.style.height=n.height+"px",r.clientHeight=n.height),r.setPointerCapture=n.setPointerCapture.bind(n),r.releasePointerCapture=n.releasePointerCapture.bind(n),r.getBoundingClientRect=n.getBoundingClientRect.bind(n),r.addEventListener=n.addEventListener.bind(n),r.removeEventListener=n.removeEventListener.bind(n),r.handleEvent=n.handleEvent.bind(n),r.dispatchEvent=n.dispatchEvent.bind(n),r.focus=n.focus.bind(n),r.blur=n.blur.bind(n))};this.getProxy=t=>this.targets[t];this.handleEvent=(t,r)=>{if(this.targets[r]||this.makeProxy(r),this.targets[r])return this.targets[r].handleEvent(t),!0};globalThis.document||(globalThis.document={elementFromPoint:(...t)=>this.targets[Object.keys(this.targets)[0]].proxied})}};function lLe(e,t){return this?.__node?.graph?(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new Vh),this.__node.graph.ProxyManager.makeProxy(e,t)):(globalThis.ProxyManager||(globalThis.ProxyManager=new Vh),globalThis.ProxyManager.makeProxy(e,t)),e}function hee(e,t){if(this?.__node?.graph){if(this.__node.graph.ProxyManager||(this.__node.graph.ProxyManager=new Vh),this.__node.graph.ProxyManager.handleEvent(e,t))return e}else if(globalThis.ProxyManager||(globalThis.ProxyManager=new Vh),globalThis.ProxyManager.handleEvent(e,t))return e}var kx={initProxyElement:xx,makeProxy:lLe,handleProxyEvent:hee};function cLe(e){if(e.worker){let t=e.worker,r=e.route;return(t instanceof Blob||typeof t=="string")&&(t=new Worker(t)),delete e.worker,delete e.route,gee(t,e,r)}else return xx(e.canvas,void 0,e._id,e.preventDefault),yee(e)}function gee(e,t,r){if(!t)return;t._id||(t._id=`canvas${Math.floor(Math.random()*1e15)}`);let n=t.canvas.transferControlToOffscreen();t.width||(t.width=t.canvas.clientWidth),t.height||(t.height=t.canvas.clientHeight);let i={route:r||"setupCanvas",args:{...t,canvas:n}};this?.__node?.graph?this.__node.graph.run("initProxyElement",t.canvas,e,t._id,t.preventDefault):xx(t.canvas,e,t._id,t.preventDefault),t.draw&&(typeof t.draw=="function"?i.args.draw=t.draw.toString():i.args.draw=t.draw),t.update&&(typeof t.update=="function"?i.args.update=t.update.toString():i.args.update=t.update),t.init&&(typeof t.init=="function"?i.args.init=t.init.toString():i.args.init=t.init),t.clear&&(typeof t.clear=="function"?i.args.clear=t.clear.toString():i.args.clear=t.clear);let s=[n];return t.transfer&&(s.push(...t.transfer),delete t.transfer),e.postMessage(i,s),{_id:t._id,width:t.width,height:t.height,worker:e,draw:(o,l)=>{e.postMessage({route:"drawFrame",args:[o,t._id]},l)},update:(o,l)=>{e.postMessage({route:"updateCanvas",args:[o,t._id]},l)},clear:()=>{e.postMessage({route:"clearCanvas",args:t._id})},init:()=>{e.postMessage({route:"initCanvas",args:t._id})},stop:()=>{e.postMessage({route:"stopAnim",args:t._id})},start:()=>{e.postMessage({route:"startAnim",args:t._id})},set:(o,l)=>{e.postMessage({route:"setDraw",args:[o,t._id]},l)},terminate:()=>{e.terminate()}}}function Ex(e,t){let r;if(this?.__node?.graph?t?r=this.__node.graph.CANVASES?.[e._id]:e._id?r=this.__node.graph.CANVASES?.[e._id]:r=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:t||e._id?r=globalThis.CANVASES?.[e._id]:r=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],r)return e.canvas&&(r.canvas=e.canvas,this?.__node?.graph?this.__node.graph.run("makeProxy",r._id,r.canvas):kx.makeProxy(r._id,r.canvas)),typeof e.context=="string"?r.context=r.canvas.getContext(e.context):e.context&&(r.context=e.context),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),typeof e.draw=="string"&&(e.draw=gl(e.draw)),typeof e.draw=="function"&&(r.draw=e.draw.bind(e)),typeof e.update=="string"&&(e.update=gl(e.update)),typeof e.update=="function"&&(r.update=e.update.bind(e)),typeof e.init=="string"&&(e.init=gl(e.init)),typeof e.init=="function"&&(r.init=e.init.bind(e)),typeof e.clear=="string"&&(e.clear=gl(e.clear)),typeof e.clear=="function"&&(r.clear=e.clear.bind(e)),e._id}function yee(e){this?.__node?.graph?this.__node.graph.CANVASES||(this.__node.graph.CANVASES={}):globalThis.CANVASES||(globalThis.CANVASES={});let t=e;if(e._id?t._id=e._id:t._id=`canvas${Math.floor(Math.random()*1e15)}`,typeof e.context=="string"?t.context=e.canvas.getContext(e.context):t.context=e.context,"animating"in e?t.animating=e.animating:t.animating=!0,this?.__node?.graph?.CANVASES[t._id])this.__node.graph.run("setDraw",t);else if(globalThis.CANVASES?.[t._id])Ex(t);else if(this?.__node?.graph&&(t.graph=this.__node.graph,t.__node||(t.__node={}),t.__node.tag||(t.__node.tag=t._id),t=this.__node.graph.add(t),t.__addOndisconnected=()=>{t.stop(),delete this.__node.graph.CANVASES[t._id]}),this?.__node?.graph?this.__node.graph.CANVASES[t._id]=t:globalThis.CANVASES[t._id]=t,this?.__node?.graph?this.__node.graph.run("makeProxy",t._id,t.canvas):kx.makeProxy(t._id,t.canvas),e.width&&(t.canvas.width=e.width),e.height&&(t.canvas.height=e.height),typeof t.draw=="string"?t.draw=gl(t.draw):typeof t.draw=="function"&&(t.draw=t.draw.bind(t)),typeof t.update=="string"?t.update=gl(t.update):typeof t.update=="function"&&(t.update=t.update.bind(t)),typeof t.init=="string"?t.init=gl(t.init):typeof t.init=="function"&&(t.init=t.init.bind(t)),typeof t.clear=="string"?t.clear=gl(t.clear):typeof t.clear=="function"&&(t.clear=t.clear.bind(t)),typeof t.init=="function"&&t.init(t,t.canvas,t.context),t.stop=()=>{Ox(t._id)},t.start=r=>{mF(t._id,r)},t.set=r=>{Ex(r,t._id)},typeof t.draw=="function"&&t.animating){let r=(n,i,s)=>{n.animating&&(n.draw(n,i,s),requestAnimationFrame(()=>{r(n,i,s)}))};r(t,t.canvas,t.context)}return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?t._id:{_id:e._id,width:e.width,height:e.height,draw:n=>{mee(n,e._id)},update:n=>{_ee(n,e._id)},clear:()=>{bee(e._id)},init:()=>{vee(e._id)},stop:()=>{Ox(e._id)},start:()=>{mF(e._id)},set:n=>{Ex(n,e._id)},terminate:()=>{this.__node?.graph?this.__node.graph.remove(e._id):(Ox(e._id),this?.__node?.graph?delete this.__node.graph.CANVASES[t._id]:delete globalThis.CANVASES[t._id])}}}function mee(e,t){let r=qc.call(this,t);if(r&&(e&&Object.assign(r,e),r.draw))return r.draw(r,r.canvas,r.context),t}function bee(e){let t=qc.call(this,e);if(t?.clear)return t.clear(t,t.canvas,t.context),e}function vee(e){let t=qc.call(this,e);if(t?.init)return t.init(t,t.canvas,t.context),e}function _ee(e,t){let r=qc.call(this,t);if(r?.update)return r.update(r,r.canvas,r.context,e),t}function uLe(e,t){let r=qc.call(this,t);if(r)return Object.assign(r,e),e.width&&(r.canvas.width=e.width),e.height&&(r.canvas.height=e.height),t}function mF(e,t){let r=qc.call(this,e);if(r.animating=!0,r&&t)return typeof t=="string"&&(t=gl(t)),typeof t=="function"&&(r.draw=t),e;if(typeof r?.draw=="function"){let n=(i,s,a)=>{i.animating&&(i.draw(i,s,a),requestAnimationFrame(()=>{n(i,s,a)}))};return typeof r.clear=="function"&&r.clear(r,r.canvas,r.context),typeof r.init=="function"&&r.init(r,r.canvas,r.context),n(r,r.canvas,r.context),e}}function Ox(e){let t=qc.call(this,e);if(t)return t.animating=!1,typeof t.clear=="function"&&requestAnimationFrame(t.clear(t,t.canvas,t.context)),e}function qc(e){let t;return this?.__node?.graph?e?t=this.__node.graph.CANVASES?.[e]:t=this.__node.graph.CANVASES?.[Object.keys(this.__node.graph.CANVASES)[0]]:e?t=globalThis.CANVASES?.[e]:t=globalThis.CANVASES?.[Object.keys(globalThis.CANVASES)[0]],t}var wee={...kx,Renderer:cLe,transferCanvas:gee,setupCanvas:yee,setDraw:Ex,drawFrame:mee,clearCanvas:bee,initCanvas:vee,updateCanvas:_ee,setProps:uLe,startAnim:mF,stopAnim:Ox,getCanvas:qc};function gl(e=""){let t=a=>a.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),n=(a=>{let o=a.indexOf("=>")+1;return o<=0&&(o=a.indexOf("){")),o<=0&&(o=a.indexOf(") {")),a.slice(0,a.indexOf("{",o)+1)})(e),i=t(e),s;if(n.includes("function")){let a=n.split("(")[1].split(")")[0];s=new Function(a,i)}else if(n.substring(0,6)===i.substring(0,6)){let a=n.split("(")[1].split(")")[0];s=new Function(a,i.substring(i.indexOf("{")+1,i.length-1))}else try{s=(0,eval)(n+i+"}")}catch{}return s}var mv=class{constructor(t){br(this,"plotter",new dn);br(this,"plot");br(this,"options");br(this,"create",(t=this.options)=>{let r=(s,a,o)=>{this.plotter.initPlot(s);let l=c=>{a.clientHeight&&(a.width=a.clientWidth,a.height=a.clientHeight,s.overlay.width=a.clientWidth,s.overlay.height=a.clientHeight,this.plotter.plots[s._id].plot.webgl.viewport(0,0,a.clientWidth,a.clientHeight),this.plotter.plots[s._id].plot.update())};typeof window<"u"?window.addEventListener("resize",l):a.addEventListener("resize",l),setTimeout(()=>{l(a)},10)},n=(s,a,o,l)=>{this.plotter.update(s._id,l)},i=(s,a,o)=>{this.plotter.deinitPlot(s._id)};if(t.init=r,t.update=n,t.clear=i,t.worker&&(t.worker===!0?t.worker=new Worker(pv):(typeof t.worker=="string"||t.worker instanceof Blob)&&(t.worker=new Worker(t.worker)),t.overlay)){let s=t.overlay.transferControlToOffscreen();t.overlay=s,t.transfer=[t.overlay]}return this.plot=wee.Renderer(t),this.plot});br(this,"__operator",t=>{this.plot||this.create(this.options),this.plot.update(t)});t&&(this.options=t,this.create(t))}};var Ax=ae(vt(),1),Nf=class extends Lh{constructor(r){super(r);br(this,"state",{});br(this,"stateKey");br(this,"objectKey");br(this,"sub");br(this,"movingAverage",[]);this.stateKey=r.stateKey,this.objectKey=r.objectKey}componentDidMount(){this.sub=this.__subscribeComponent(this.stateKey),this.state[this.stateKey]=this.statemgr.data[this.stateKey]}componentWillUnmount(){this.__unsubscribeComponent(this.stateKey)}render(){let r=this.objectKey?this.state[this.stateKey]?.[this.objectKey]:this.state[this.stateKey],n=i=>(typeof i=="string"&&(i=parseFloat(i)),typeof i=="number"&&this.props.movingAverage&&(this.movingAverage.push(i),this.movingAverage.length>this.props.movingAverage&&this.movingAverage.shift(),i=this.movingAverage.reduce((a,o)=>a+o,0)/this.movingAverage.length),i);if(Array.isArray(r)&&this.props.movingAverage){let i;r.forEach(s=>{i=n(s)}),r=i}else r=n(r);return(0,Ax.jsx)(Ax.Fragment,{children:typeof r=="number"?r.toFixed(this.props.toFixed?this.props.toFixed:2):r})}};var Vt=ae(vt(),1),Tx=class extends Lh{constructor(){super(...arguments);br(this,"state",{deviceConnected:!1,deviceRecording:!1,device:void 0,files:[]});br(this,"canvas",document.createElement("canvas"));br(this,"overlay",document.createElement("canvas"));br(this,"canvas2",document.createElement("canvas"));br(this,"overlay2",document.createElement("canvas"));br(this,"sub");br(this,"plotter1");br(this,"sub2");br(this,"plotter2")}componentDidMount(){this.canvas.width=800,this.canvas.height=600,this.canvas.style.width="100%",this.canvas.style.height="500px",this.canvas.style.backgroundColor="black",this.overlay.width=800,this.overlay.height=600,this.overlay.style.width="100%",this.overlay.style.height="500px",this.overlay.style.position="absolute",this.overlay.style.zIndex="2",this.overlay.style.transform="translateY(-100%)",this.canvas2.width=800,this.canvas2.height=300,this.canvas2.style.width="100%",this.canvas2.style.height="150px",this.canvas2.style.backgroundColor="black",this.overlay2.width=800,this.overlay2.height=300,this.overlay2.style.width="100%",this.overlay2.style.height="150px",this.overlay2.style.position="absolute",this.overlay2.style.zIndex="2",this.overlay2.style.transform="translateY(-100%)",this.plotter1=new mv({canvas:this.canvas,overlay:this.overlay,lines:QL,generateNewLines:!1,cleanGeneration:!1,worker:pv}),this.sub=xt.subscribeEvent("fnirs",r=>{this.plotter1.__operator(r)}),this.plotter2=new mv({canvas:this.canvas2,overlay:this.overlay2,lines:{heg:{sps:20,nSec:10}},generateNewLines:!1,cleanGeneration:!1,worker:pv}),this.sub2=xt.subscribeEvent("heg",r=>{this.plotter2.__operator(r)}),this.list()}componentWillUnmount(){xt.unsubscribeEvent("fnirs",this.sub),xt.unsubscribeEvent("heg",this.sub2)}async list(){let r=await PO.listFiles("data"),n=[];r.forEach(i=>{let s=async()=>{cR.writeToCSVFromDB("data/"+i,10)},a=()=>{PO.deleteFile("data/"+i).then(()=>{this.list()})};n.push((0,Vt.jsx)("div",{id:i,children:(0,Vt.jsxs)("div",{children:[i,(0,Vt.jsx)("button",{onClick:s,id:"dl",children:"Download"}),(0,Vt.jsx)("button",{onClick:a,id:"del",children:"Delete"})]})}))}),this.setState({files:n})}render(){return(0,Vt.jsxs)(Vt.Fragment,{children:[this.state.deviceConnected?(0,Vt.jsx)("button",{onClick:()=>{this.state.device?.disconnect()},children:"Disconnect"}):(0,Vt.jsx)("button",{onClick:()=>{MQ()},children:"Connect"}),this.state.deviceRecording?(0,Vt.jsx)("button",{onClick:()=>{this.setState({deviceRecording:!1,csvs:{}}),this.list()},children:"Stop Recording"}):(0,Vt.jsx)("button",{onClick:()=>{this.setState({deviceRecording:!0}),this.list()},children:"Record"}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsxs)("span",{children:["HEG: ",(0,Vt.jsx)(Nf,{stateKey:"heg",objectKey:"heg",toFixed:2,movingAverage:10})]}),(0,Vt.jsx)("br",{}),(0,Vt.jsxs)("span",{children:["HR: ",(0,Vt.jsx)(Nf,{stateKey:"hr",objectKey:"hr",toFixed:2,movingAverage:5}),"/ min"]}),(0,Vt.jsx)("br",{}),(0,Vt.jsxs)("span",{children:["HRV: ",(0,Vt.jsx)(Nf,{stateKey:"hr",objectKey:"hrv",toFixed:2,movingAverage:5}),"/ min"]}),(0,Vt.jsx)("br",{}),(0,Vt.jsxs)("span",{children:["Breath: ",(0,Vt.jsx)(Nf,{stateKey:"breath",objectKey:"breath",toFixed:2}),"/ min"]}),(0,Vt.jsx)("br",{}),(0,Vt.jsxs)("span",{children:["Stress Index: ",this.state.deviceConnected?.44:null]})]}),(0,Vt.jsx)("hr",{}),(0,Vt.jsx)("div",{ref:r=>{r?.appendChild(this.canvas2),r?.appendChild(this.overlay2)}}),(0,Vt.jsx)("hr",{}),(0,Vt.jsx)("br",{}),(0,Vt.jsx)("hr",{}),(0,Vt.jsx)("div",{ref:r=>{r?.appendChild(this.canvas),r?.appendChild(this.overlay)}}),(0,Vt.jsx)("hr",{}),(0,Vt.jsxs)("div",{children:["Recordings",(0,Vt.jsx)("br",{}),...this.state.files]})]})}};var vr=ae(vt(),1);function bF(){let e=null;return(0,vr.jsxs)(vr.Fragment,{children:[(0,vr.jsx)(fo,{}),(0,vr.jsx)(Tx,{})]})}function bv(e,t,r,n=[]){let i=[];for(let s in e){let a=e[s],o=t[s],l=[...n,s];if(typeof a=="object"&&o&&typeof o=="object")i.push(...bv(a,o,r,l));else{let c=l.join("-");r(c,o,a),i.push({id:c,latest:o,previous:a})}}return i}var See={};function xee(e,t){let r=JSON.parse(e.data),{provider:n,previously:i,added:s,...a}=r;if(n){let{steamid:o}=n;"steamid"in See||(bv(n,n,(l,c)=>t(l,c),["provider"]),See=n),Object.entries(a).forEach(([l,c])=>{"steamid"in c&&c.steamid!==o||((!i||l in i&&"steamid"in i[l]&&i[l].steamid!==o)&&(i={[l]:c}),i&&bv(i[l],c,(f,u,d)=>t(f,u,i===u?void 0:d),[l]),s&&bv(s[l],c,(f,u)=>{typeof u=="object"?(t(f,u,void 0,!0),bv(u,u,(d,p)=>t(d,p),f.split("-"))):t(f,u)},[l]))})}else console.warn("Non-CS:GO Message",a)}var vF=730;globalThis.commoners=m0;var{url:Eee}=globalThis.commoners.services.csgo,Oee=async()=>fetch(`${Eee}/installed`).then(e=>e.json(e)),_F=new EventSource(`${Eee}/events`),kee={},fLe=(e,t,r,n)=>{kee[e]!==t&&(kee[e]=t,KO({[e]:{value:t,previous:r,isNew:n}}))};function dLe(){console.warn("Event source opened!")}_F.addEventListener("message",e=>xee(e,fLe));_F.addEventListener("error",function(){console.error("Failed to connect to event stream.")},!1);_F.addEventListener("open",dLe);var Aee=ae(Je(),1);var Cx=ae(vt(),1);function wF({children:e="Please wait"}){return(0,Cx.jsxs)(lf,{disabled:!0,children:[(0,Cx.jsx)(xb,{className:"mr-2 h-4 w-4 animate-spin"}),e]})}var Qn=ae(vt(),1);function SF(){let[e,t]=(0,Aee.useState)({});return Object.keys(e).length||Oee().then(n=>setTimeout(()=>t(n),500)),(0,Qn.jsxs)(Qn.Fragment,{children:[(0,Qn.jsx)(fo,{}),(0,Qn.jsx)("div",{className:"flex-col md:flex",children:(0,Qn.jsxs)("div",{className:"flex-1 space-y-4 p-8 pt-6",children:[(0,Qn.jsxs)("div",{className:"flex-1 space-x-2",children:["csgo"in e?(0,Qn.jsx)(Ja,{className:fh({}),to:e.csgo?`steam://launch/${vF}`:`steam://install/${vF}`,children:e.csgo?"Launch CS:GO":"Install CS:GO"}):(0,Qn.jsx)(wF,{children:"Fetching CS:GO Info"}),"steam"in e?(0,Qn.jsx)(Ja,{className:fh({variant:"secondary"}),to:e.steam?"steam://open/main":"https://store.steampowered.com/about/",children:e.steam?"Open Steam":"Install Steam"}):(0,Qn.jsx)(wF,{children:"Fetching Steam Info"})]}),(0,Qn.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,Qn.jsx)(Ss,{name:"App Name",Icon:_b,primaryState:"provider-name",secondaryState:"player-activity"}),(0,Qn.jsx)(Ss,{name:"User",Icon:Eb,primaryState:"player-name",secondaryState:"provider-steamid"}),(0,Qn.jsx)(Ss,{name:"Health",Icon:Sb,primaryState:"player-state-health"})]})]})})]})}var ns=ae(vt(),1);globalThis.commoners=m0;var pLe=!1;pLe&&OR();var Iee=document.createElement("div");document.body.insertAdjacentElement("afterbegin",Iee);Cee.default.createRoot(Iee).render((0,ns.jsx)(Tee.default.StrictMode,{children:(0,ns.jsx)(VR,{children:(0,ns.jsxs)(oA,{children:[(0,ns.jsx)(vu,{path:"/",element:(0,ns.jsx)(tP,{}),errorElement:(0,ns.jsx)(rP,{})}),(0,ns.jsx)(vu,{path:"/devices",element:(0,ns.jsx)(bF,{})}),(0,ns.jsx)(vu,{path:"/plus",element:(0,ns.jsx)(SF,{})}),(0,ns.jsx)(vu,{path:"/settings",element:(0,ns.jsx)(oP,{})})]})})}));})();
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
  (**
   * @license React
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (**
   * @license React
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react/cjs/react-jsx-runtime.production.min.js:
  (**
   * @license React
   * react-jsx-runtime.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

classnames/index.js:
  (*!
  	Copyright (c) 2018 Jed Watson.
  	Licensed under the MIT License (MIT), see
  	http://jedwatson.github.io/classnames
  *)

react-is/cjs/react-is.production.min.js:
  (** @license React v16.13.1
   * react-is.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

decimal.js-light/decimal.js:
  (*! decimal.js-light v2.5.1 https://github.com/MikeMcl/decimal.js-light/LICENCE *)

@capacitor/core/dist/index.js:
  (*! Capacitor: https://capacitorjs.com/ - MIT License *)

graphscript-services.storage/dist/index.storage.services.esm.js:
  (*! Bundled license information:
  
  browserfs/dist/browserfs.js:
    (*!
    * The buffer module from node.js, for the browser.
    *
    * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
    * @license  MIT
    *)
  *)

@remix-run/router/dist/router.js:
  (**
   * @remix-run/router v1.6.2
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

react-router/dist/index.js:
  (**
   * React Router v6.11.2
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

react-router-dom/dist/index.js:
  (**
   * React Router DOM v6.11.2
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

react-resize-detector/build/index.esm.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

device-decoder/dist/device.frontend.esm.js:
  (*! Bundled license information:
  
  @capacitor/core/dist/index.js:
    (*! Capacitor: https://capacitorjs.com/ - MIT License *)
  *)
*/
